<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6022645</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty099</article-id>
    <article-id pub-id-type="publisher-id">bty099</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ViCTree: an automated framework for taxonomic classification from protein sequences</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-8440-885X</contrib-id>
        <name>
          <surname>Modha</surname>
          <given-names>Sejal</given-names>
        </name>
        <xref ref-type="aff" rid="bty099-aff1">1</xref>
        <xref ref-type="corresp" rid="bty099-cor1"/>
        <!--<email>sejal.modha@glasgow.ac.uk</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thanki</surname>
          <given-names>Anil S</given-names>
        </name>
        <xref ref-type="aff" rid="bty099-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cotmore</surname>
          <given-names>Susan F</given-names>
        </name>
        <xref ref-type="aff" rid="bty099-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Davison</surname>
          <given-names>Andrew J</given-names>
        </name>
        <xref ref-type="aff" rid="bty099-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-2556-2563</contrib-id>
        <name>
          <surname>Hughes</surname>
          <given-names>Joseph</given-names>
        </name>
        <xref ref-type="aff" rid="bty099-aff1">1</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Kelso</surname>
          <given-names>Janet</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="bty099-aff1"><label>1</label>MRC-University of Glasgow Centre for Virus Research, Glasgow, UK</aff>
    <aff id="bty099-aff2"><label>2</label>Earlham Institute, Norwich Research Park, Norwich, UK</aff>
    <aff id="bty099-aff3"><label>3</label>Yale University Medical School, New Haven, CT, USA</aff>
    <author-notes>
      <corresp id="bty099-cor1">To whom correspondence should be addressed. <email>sejal.modha@glasgow.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>7</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-02-20">
      <day>20</day>
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>2</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>13</issue>
    <issue-title>ISMB 2018 Proceedings July 6 to July 10, 2018, Chicago, IL, United States</issue-title>
    <fpage>2195</fpage>
    <lpage>2200</lpage>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>7</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>08</day>
        <month>1</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>2</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty099.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The increasing rate of submission of genetic sequences into public databases is providing a growing resource for classifying the organisms that these sequences represent. To aid viral classification, we have developed ViCTree, which automatically integrates the relevant sets of sequences in NCBI GenBank and transforms them into an interactive maximum likelihood phylogenetic tree that can be updated automatically. ViCTree incorporates ViCTreeView, which is a JavaScript-based visualization tool that enables the tree to be explored interactively in the context of pairwise distance data.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>To demonstrate utility, ViCTree was applied to subfamily <italic>Densovirinae</italic> of family <italic>Parvoviridae</italic>. This led to the identification of six new species of insect virus.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>ViCTree is open-source and can be run on any Linux- or Unix-based computer or cluster. A tutorial, the documentation and the source code are available under a GPL3 license, and can be accessed at <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.cvr.ac.uk/victree_web/">http://bioinformatics.cvr.ac.uk/victree_web/</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Medical Research Council</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000265</named-content>
        </funding-source>
        <award-id>MC_UU_12014/12</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The increasing rate at which sequence data are being deposited into public databases is providing a tremendous resource for taxonomic classification throughout biology. Phylogenetic analysis provides a key means of integrating these data and inferring the evolutionary relationships that form the basis of classification. However, preparing datasets for such analyses is often time-consuming, and the phylogenies obtained are typically not easy to update. Consequently, systematic approaches are being developed that automate the various steps involved.</p>
    <p>The Ensembl Compara GeneTree pipeline (<xref rid="bty099-B25" ref-type="bibr">Vilella <italic>et al.</italic>, 2009</xref>) provides a comprehensive gene-orientated phylogenetic resource. It has a powerful analytical backend for classifying genes and gene families on the basis of detecting orthology among the complete genomes available in the Ensembl framework. Automated phylogeny-based classification is also implemented in the mor package (<ext-link ext-link-type="uri" xlink:href="http://www.clarku.edu/faculty/dhibbett/clarkfungaldb/">http://www.clarku.edu/faculty/dhibbett/clarkfungaldb/</ext-link>), which has been applied to fungal taxa by aligning 28S rRNA sequences from GenBank and generating a phylogeny that can be updated by a node-based classification approach (<xref rid="bty099-B8" ref-type="bibr">Hibbett <italic>et al.</italic>, 2005</xref>). The 16S and 18S rRNA sequences can also inform classification, and are employed in tools such as STAP (<xref rid="bty099-B26" ref-type="bibr">Wu <italic>et al.</italic>, 2008</xref>) and EukRef (<ext-link ext-link-type="uri" xlink:href="http://eukref.org/curation-pipeline-overview/">http://eukref.org/curation-pipeline-overview/</ext-link>). A more general approach is implemented in PUmPER (<xref rid="bty099-B9" ref-type="bibr">Izquierdo-Carrasco <italic>et al.</italic>, 2014</xref>), which has been applied to the classification of plants (<ext-link ext-link-type="uri" xlink:href="http://portnoy.iplantcollaborative.org/view/tree/10b17429d13160ac1cd07e30bb42fd9b">http://portnoy.iplantcollaborative.org/view/tree/10b17429d13160ac1cd07e30bb42fd9b</ext-link>). However, PUmPER employs PHLAWD (<xref rid="bty099-B21" ref-type="bibr">Smith <italic>et al.</italic>, 2009</xref>) to collate sequences and build multiple alignments, which in turn relies on GenBank annotations to retrieve nucleotide sequences.</p>
    <p>The tools described above were developed for specific types of non-viral organisms and have limited applications to the classification of viruses. Viruses exhibit an enormous range of sequence diversity and cannot be integrated into a tree of life because they lack genes that are universally conserved in other organisms and that therefore may be used for barcoding (e.g. those encoding rRNAs or enzymes such as cytochrome c oxidase subunit I and ribulose-bisphosphate carboxylase). Also, GenBank annotations of viral genes are often not standardized and are thus unreliable for retrieving sequences. Moreover, none of the tools mentioned above presents both pairwise distances and phylogenies. This dual facility is important in viral classification because precise distance thresholds are frequently stipulated as demarcation criteria, and these may vary widely among families and even among genera due to differences in evolutionary rate.</p>
    <p>Viruses are classified formally by the International Committee on Taxonomy of Viruses (ICTV; <ext-link ext-link-type="uri" xlink:href="http://www.ictvonline.org/">http://www.ictvonline.org/</ext-link>) into three ranks (family, genus and species), and, in some cases, two further ranks (order and subfamily). The huge diversity of viruses has the effect that the criteria used and the relative emphasis placed on each vary widely from family to family. However, sequence-based criteria (typically based on amino acid, rather than nucleotide, sequences) are prominent, and include simple measures of distance and increasingly powerful phylogenetic measures, as in the case of family <italic>Parvoviridae</italic> discussed below (<xref rid="bty099-B5" ref-type="bibr">Cotmore <italic>et al.</italic>, 2014</xref>). The rapidly increasing volume of viral sequence information and the limitations of existing tools in relation to viruses necessitates the development of automated bioinformatic solutions that are suited specifically to viruses (<xref rid="bty099-B20" ref-type="bibr">Simmonds, 2015</xref>; <xref rid="bty099-B19" ref-type="bibr">Simmonds <italic>et al.</italic>, 2017</xref>). At least two tools in this category have been used in viral classification: PASC provides a web-based interface for visualizing distances among automatically aligned sequences (<xref rid="bty099-B4" ref-type="bibr">Bao <italic>et al.</italic>, 2014</xref>), and DEmARC takes a sophisticated approach to identifying taxonomically significant thresholds in the distribution of distance data (<xref rid="bty099-B14" ref-type="bibr">Lauber and Gorbalenya, 2012</xref>). These tools were developed for exploring the pairwise distance criteria used to define species and genus boundaries within a taxon. ViPTree, a web-based classification tool, employs a genome-wide similarity method to classify viral sequences, and generates a static viral proteomic tree to illustrate the phylogenetic relationships among the existing sequences available in the GenomeNet/Virus-Host database (<xref rid="bty099-B17" ref-type="bibr">Nishimura <italic>et al.</italic>, 2017</xref>). Useful as these tools are, none of them presents the results of pairwise distances along with the phylogeny, a feature that is important to viral taxonomists as they transition from using distance-based to phylogeny-based classification methods.</p>
    <p>As an aid to integrating GenBank data into taxonomic analyses that can be updated automatically, we present ViCTree, a pipeline that retrieves the relevant viral sequences from GenBank, aligns and clusters them, and generates a maximum likelihood phylogenetic tree combined with distance data. The results are rendered by using ViCTreeView, which is a Javascript-based tool that enables users to visualize and explore distances in the context of the tree. ViCTree is automated so that the phylogenies are synchronized with the GenBank data, and the results are versioned on GitHub. The pipeline is flexible and broadly applicable to examining the phylogenetic relationships that underpin viral taxa.</p>
  </sec>
  <sec>
    <title>2 Framework</title>
    <p>All modules and tools implemented in ViCTree are open-source. The framework is a combination of a Bash shell script for automatically generating multiple sequence alignments and phylogenetic trees, and JavaScript for visualizing and exploring the trees in combination with the underlying distance data.</p>
    <sec>
      <title>2.1 Phylogeny building</title>
      <p>A curated set of seed protein sequences must be provided that spans the known diversity of a viral taxon. These sequences and the relevant GenBank taxonomic ID (specified at any rank) are submitted to the start of the ViCTree pipeline (<xref ref-type="fig" rid="bty099-F1">Fig. 1</xref>), and all available protein sequences that bear the taxonomic ID are automatically downloaded from GenBank. Rather than filtering on the basis of GenBank sequence annotations, which are sometimes incomplete or incorrect, BLAST (<xref rid="bty099-B3" ref-type="bibr">Altschul <italic>et al.</italic>, 1990</xref>) is used to compare the downloaded sequences with all the seed sequences. Significant matches are extracted from the BLAST output on the basis of user-specified parameters specifying the hit length threshold (the minimum number of amino acid residues in the alignment between the query and subject sequences) and query coverage threshold (the minimum percentage of amino acid residues in the query sequence represented in the alignment). Significant matches are clustered by using CD-HIT (<xref rid="bty099-B7" ref-type="bibr">Fu <italic>et al.</italic>, 2012</xref>) with a user-specified identity threshold, and a representative sequence from each cluster is selected for downstream analysis in order to reduce the size of the tree to a manageable scale. CD-HIT is used to cluster the sequences below species level to generate a manageable sized phylogeny, with the default clustering threshold set to 0.9. CD-HIT picks the longest sequence as representative by default, and processes the classification of the remaining sequences by comparing them to the representatives. This arrangement has the advantage of not influencing the inter-species or inter-generic relationships. An optional parameter enables the user to provide a list of predefined sequences representing the clusters instead of the default sequences derived by using CD-HIT, thus allowing static tips to be maintained in an expanding phylogeny. A multiple sequence alignment and a distance matrix are generated for the final sequence set by using Clustal Omega (<xref rid="bty099-B18" ref-type="bibr">Sievers <italic>et al.</italic>, 2011</xref>), and an evolutionary tree is inferred by using RAxML (<xref rid="bty099-B22" ref-type="bibr">Stamatakis, 2014</xref>) under a user-defined evolutionary model or a default model (PROTGAMMAJTT). The evolutionary tree can then be submitted for automated species delimitation by mPTP (<xref rid="bty099-B10" ref-type="bibr">Kapli <italic>et al.</italic>, 2017</xref>).
</p>
      <fig id="bty099-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>Data processing workflow of the ViCTree pipeline</p>
        </caption>
        <graphic xlink:href="bty099f1"/>
      </fig>
      <p>The output files include the tree in Newick format, the alignment in Fasta format, a distance matrix, a comma-separated list of clustered sequences, and a metadata file with GenBank accession numbers and taxonomic names (species and genus) if known. These files are stored on GitHub in a predefined directory structure, thus allowing previous versions of the alignment and tree to be retrieved and enabling changes to be tracked over time. After an initial setup stage for the viral group of interest, the phylogeny can be updated with little or no manual intervention.</p>
    </sec>
    <sec>
      <title>2.2 Tree visualization</title>
      <p>ViCTreeView was inspired by VEG’s phylotree (<ext-link ext-link-type="uri" xlink:href="https://github.com/veg/phylotree.js">https://github.com/veg/phylotree.js</ext-link>) and enables the tree to be visualized. In ViCTreeView, maximum likelihood phylogenetic trees are rendered directly from the GitHub repository and visualized as a phylogram with bootstrap values. It is possible to visualize the tree in ultrametric representation instead of a phylogram. Different phylogenetic tree instances available in the GitHub repository can be browsed and visualized using by using the example menu. Attributes to increase and decrease distances between branches and a zooming function styled after Google maps are implemented in ViCTreeView, thus enabling users to explore specific parts of the phylogeny in detail. This interactive web tool facilitates an integrated dynamic visualization of the tree and the distance data represented as percentages. When a user-defined distance threshold is specified, sequences that fall within it are highlighted in clusters of different colours. This enables users to study and explore the sequences that generate new clusters when a specific pairwise distance criterion is applied. The highlighted versions of the tree with user-defined thresholds are also available for downloading in SVG and PNG formats. The automated phylogeny generated within ViCTree is mid-point rooted and can be re-rooted to any nodes in the phylogeny. Specific branches can be expanded and collapsed in order to explore large phylogenetic trees in modular fashion. In addition, various features are included to allow manipulation of the tree, including options for labelling the tips by GenBank accession number, taxonomic ID, species name or genus name. These options, along with the alignment files from GitHub repositories, enable users to download the tree files in a specific format, and also facilitate easy incorporation of data for newly discovered viruses into taxonomic proposals. Links are also provided to the NCBI genomes page for representative sequences and to the NCBI proteins page for the representative and non-representative protein sequences clustered in the phylogeny.</p>
      <p>ViCTree can be run on any Linux/Unix or OSX Apple computer. It was tested on an Apple iMac with a 4 GHz Intel Core i7 processor and 32 GB RAM.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Case study</title>
      <p>The example framework (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.cvr.ac.uk/victree/">http://bioinformatics.cvr.ac.uk/victree/</ext-link>) is setup for subfamilies <italic>Densovirinae</italic> and <italic>Parvovirinae</italic> of family <italic>Parvoviridae</italic> and for family <italic>Herpesviridae</italic>, and is updated monthly on an automatic schedule. To illustrate the application of ViCTree, we present the results for subfamily <italic>Densovirinae</italic>.</p>
      <p>Within the family <italic>Parvoviridae</italic>, viruses that infect invertebrates and vertebrates are classified into the two subfamilies <italic>Densovirinae</italic> and <italic>Parvovirinae</italic>, respectively. This division is strongly supported by the protein sequence-based phylogeny of viral non-structural protein 1 (NS1) (<xref rid="bty099-B5" ref-type="bibr">Cotmore <italic>et al.</italic>, 2014</xref>). All viruses within the same species are required to be at least 85% identical to each other in this protein, and at least 15% different from viruses in other species. Viruses within the same genus are required to be monophyletic and to encode NS1 proteins that are at least 30% identical to each other. These demarcation criteria were applied to an analysis of subfamily <italic>Densovirinae</italic> carried out by using ViCTree. The analysis took 552 min 34.983 s real time, 1019 min 38.773 s user time and 29 min 32.492 s system time.</p>
      <p>The analysis of subfamily <italic>Densovirinae</italic> runs automatically every month as a Cron job. In June 2017, 916 protein sequences available under the relevant taxonomic ID (40120) were downloaded automatically from GenBank. A subset of 21 NS1 protein sequences was used as the seed set in a BLAST-based similarity search of all downloaded protein sequences. A subset of 187 sequences was generated when hit length and query coverage thresholds of 100 and 50, respectively, were applied to filter the BLAST output. These sequences grouped into 103 distinct clusters when a CD-HIT clustering threshold of 1.0 was applied. Distance analysis and multiple sequence alignment were performed on the 103 representatives of these clusters, and taxonomic and accession metadata were collected from GenBank. A phylogeny was built for the aligned sequences, and the tree file was submitted with metadata and distance matrix files to ViCTreeView for visualization.</p>
      <p>ViCTree identified all previously classified species and genera in subfamily <italic>Densovirinae</italic> (<xref rid="bty099-B5" ref-type="bibr">Cotmore <italic>et al.</italic>, 2014</xref>), including members of genus <italic>Ambidensovirus</italic> that encode the NS1 protein on the opposite strand from members of the other genera. This success was due to the breadth of diversity in the seed set and to the use of protein sequences in conducting the BLAST search. The analysis identified six new species (<xref rid="bty099-T1" ref-type="table">Table 1</xref>), which were recognized subsequently by the ICTV (<xref rid="bty099-B2" ref-type="bibr">Adams <italic>et al.</italic>, 2017b</xref>) on the basis of proposals made by the ICTV <italic>Parvoviridae</italic> Study Group. Although ViCTree is not a dedicated taxonomic misclassification identification tool such as SATIVA (<xref rid="bty099-B13" ref-type="bibr">Kozlov <italic>et al.</italic>, 2016</xref>) it is able to identify misclassified sequences. Thus, the misclassification of an isolate of Helicoverpa armigera densovirus (GenBank accession number JQ894784) in the NCBI taxonomy was readily identified. This virus is described as being a member of genus <italic>Iteradensovirus</italic>, but in fact belongs to genus <italic>Ambidensovirus</italic> (species <italic>Lepidopteran iteradensovirus 5</italic>).
<table-wrap id="bty099-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>New species identified in subfamily <italic>Densovirinae</italic> by using ViCTree</p></caption><table frame="hsides" rules="groups"><thead><tr><th rowspan="1" colspan="1">Name of new species</th><th rowspan="1" colspan="1">Representative isolate</th><th rowspan="1" colspan="1">Genus</th></tr></thead><tbody><tr><td rowspan="1" colspan="1"><italic>Asteroid ambidensovirus 1</italic></td><td rowspan="1" colspan="1">Sea star-associated densovirus</td><td rowspan="1" colspan="1"><italic>Ambidensovirus</italic></td></tr><tr><td rowspan="1" colspan="1"><italic>Decapod ambidensovirus 1</italic></td><td rowspan="1" colspan="1">Cherax quadricarinatus densovirus</td><td rowspan="1" colspan="1"><italic>Ambidensovirus</italic></td></tr><tr><td rowspan="1" colspan="1"><italic>Hemipteran ambidensovirus 2</italic></td><td rowspan="1" colspan="1">Dysaphis plantaginea densovirus 1</td><td rowspan="1" colspan="1"><italic>Ambidensovirus</italic></td></tr><tr><td rowspan="1" colspan="1"><italic>Hemipteran ambidensovirus 3</italic></td><td rowspan="1" colspan="1">Myzus persicae densovirus 1</td><td rowspan="1" colspan="1"><italic>Ambidensovirus</italic></td></tr><tr><td rowspan="1" colspan="1"><italic>Hymenopteran ambidensovirus 1</italic></td><td rowspan="1" colspan="1">Solenopsis invicta densovirus</td><td rowspan="1" colspan="1"><italic>Ambidensovirus</italic></td></tr><tr><td rowspan="1" colspan="1"><italic>Orthopteran densovirus 1</italic></td><td rowspan="1" colspan="1">Acheta domestica mini ambidensovirus</td><td rowspan="1" colspan="1"><italic>Unassigned</italic></td></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><p><italic>Source</italic>: <ext-link ext-link-type="uri" xlink:href="https://talk.ictvonline.org/ICTV/proposals/2016.003a,bD.A.v1.Densovirinae_6sp.pdf">https://talk.ictvonline.org/ICTV/proposals/2016.003a, bD.A.v1.Densovirinae_6sp.pdf</ext-link></p></fn></table-wrap-foot></table-wrap></p>
      <p>The in-built automated species delimitation using mPTP had identified a total of 25 species from the phylogeny, of which 18 were consistent with the current ICTV classification of subfamily Densovirinae. The automated species delimitation combined <italic>Decapod ambidensovirus 1</italic> and <italic>Asteroid ambidensovirus 1</italic> into a species cluster, and <italic>Lepidopteran iteradensovirus 1</italic>, <italic>Lepidopteran iteradensovirus 2</italic> and <italic>Lepidopteran iteradensovirus 4</italic> into another species cluster. It also identified an additional six new species that are not currently recognized by the ICTV (<xref ref-type="supplementary-material" rid="sup1">Supplementary Appendix S1</xref>). Some of these species are not yet defined as new species by the ICTV as the sequences may be from incomplete genome sequences or may lack multiple sequences from the same species, both of which are requirements for the assignment of new species.</p>
    </sec>
    <sec>
      <title>3.2 Evaluation of accuracy</title>
      <p>The accuracy of the ViCTree was tested by determining the proportion of recognized species that it was capable of identifying in subfamily <italic>Densovirinae</italic> (<xref ref-type="fig" rid="bty099-F2">Fig. 2</xref>). Three parameters were varied: the number of seed sequences (sets of 5, 10 or 20 randomly selected sequences), the hit length threshold, and the query coverage threshold (<xref ref-type="fig" rid="bty099-F3">Fig. 3</xref>). Accuracy increased with the number of seed sequences, and was &gt;95% for all seed sequence sets at a hit length of &lt;400 and a query coverage of &lt;60. Accuracy was compromised by reducing these values, due to increasing numbers of false positives. Hit length and query coverage thresholds of 100 and 50, respectively, were found to be optimal for subfamily <italic>Densovirinae</italic>.
</p>
      <fig id="bty099-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Phylogenetic tree for subfamily <italic>Densovirinae</italic> based on the NS1 protein and visualized in ViCTreeView. Sequences that fall within the 15% pairwise distance criterion are indicated as distinct clusters in different colours. Black arrows indicate new species identified using ViCTree</p>
        </caption>
        <graphic xlink:href="bty099f2"/>
      </fig>
      <fig id="bty099-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Accuracy (<italic>y</italic>-axis) of ViCTree in relation to BLAST query coverage (0–100), BLAST hit length (0–849 amino acid residues) and number of seed sequences (5–20)</p>
        </caption>
        <graphic xlink:href="bty099f3"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>ViCTree is an integrated, automated pipeline for assisting taxonomic classification in an era in which genomic and metagenomic data are being actively accommodated by the ICTV (<xref rid="bty099-B1" ref-type="bibr">Adams <italic>et al.</italic>, 2017a</xref>; <xref rid="bty099-B20" ref-type="bibr">Simmonds, 2015</xref>; <xref rid="bty099-B19" ref-type="bibr">Simmonds <italic>et al.</italic>, 2017</xref>). It is capable of supporting the identification of novel viral species and pinpointing taxonomic errors in public databases. Its automated approach to finding the best reference sequences to represent a viral family or subfamily provides a useful tool for virologists. It implements GitHub-based versioning of alignments and phylogenies of any size, thus allowing users to monitor taxonomic developments incrementally. The built-in visualization tool (ViCTreeView) enables phylogenies to be explored interactively in a web browser. These features will contribute to the establishment and dissemination of standardized phylogenetic and taxonomic data within the virology community.</p>
    <p>The initial setup of ViCTree for a taxonomic group requires several optimization steps, which include setting the thresholds for seed sequences, CD-HIT clustering, and BLAST hit length and query coverage. These parameters were shown to be accurate in the case study of subfamily <italic>Densovirinae</italic>, but will need to be improved iteratively as the taxonomy expands. They will differ for other viral taxa; for example, a single DNA polymerase protein seed sequence was sufficient to identify all species in family <italic>Herpesviridae</italic>. In a wider context, the criteria used to classify viruses vary greatly from family to family, and the flexibility of ViCTree allows appropriate thresholds to be explored interactively. Accuracy determination for a specific viral group of interests is deemed to be an iterative process, as classification parameters depend on the new sequences identified and incorporated into the seed set used as a starting point for ViCTree analysis. The ViCTree GitHub repository provides scripts that enable users to identify optimal BLAST and seed set parameters to study a viral taxonomic group using ViCTree. Novel sequences that are yet to be submitted to GenBank can also be explored using the ViCTree framework, as ViCTree allows the incorporation of these sequences by adding them to the seed sequence set.</p>
    <p>Since ViCTree is a pipeline that integrates a number of existing tools, it will suffer from their limitations. Clustal Omega was incorporated because it can align large numbers of protein sequences quickly and accurately (<xref rid="bty099-B18" ref-type="bibr">Sievers <italic>et al.</italic>, 2011</xref>). However, like other progressive algorithms such as CLUSTAL W (<xref rid="bty099-B23" ref-type="bibr">Thompson <italic>et al.</italic>, 1994</xref>), MAFFT (<xref rid="bty099-B11" ref-type="bibr">Katoh <italic>et al.</italic>, 2002</xref>; <xref rid="bty099-B12" ref-type="bibr">Katoh and Standley, 2013</xref>), MUSCLE (<xref rid="bty099-B6" ref-type="bibr">Edgar, 2004</xref>) and T-COFFEE (<xref rid="bty099-B24" ref-type="bibr">Di Tommaso <italic>et al.</italic>, 2011</xref>), it may suffer from shortcomings in the handling of insertions and deletions. Other phylogeny-aware methods that have been developed for accurately aligning closely related sequences, such as PRANK (<xref rid="bty099-B16" ref-type="bibr">Löytynoja and Goldman, 2005</xref><xref rid="bty099-B15" ref-type="bibr">, 2008</xref>), are less susceptible to these problems and may improve ViCTree in future, particularly for delimiting genotypes within viral species.</p>
    <p>ViCTree adds to a growing number of sequence-based tools that are designed to inform viral classification specifically or that may prove to be adaptable from other areas of biology. Pairwise distance criteria currently being used across the field of viral taxonomy does not provide an objective approach to classify groups of viruses and other methods such as GMYC and PTP/mPTP should be explored further in the context of speciation and identification of novel viral groups. The current version of ViCTree uses protein sequences as input because amino acid sequences are typically used to distinguish taxa from the level of family (or sometimes order) down to species (e.g. <italic>Parvoviridae</italic> and <italic>Herpesviridae</italic>). Although ViCTree was developed with viral classification in mind, it could be used to explore the evolution of any protein.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="bty099_supp.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Dr Quan Gu for testing ViCTree extensively, Dr Richard Orton for providing insightful advice on the manuscript, and other members of the CVR Viral Genomics and Bioinformatics team for offering useful comments.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the Medical Research Council [grant number MC_UU_12014/12].</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bty099-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Adams</surname><given-names>M.J.</given-names></name></person-group><etal>et al</etal> (<year>2017a</year>) 
<article-title>50 years of the International Committee on Taxonomy of Viruses: progress and prospects</article-title>. <source>Arch. Virol</source>., <volume>162</volume>, <fpage>1441</fpage>–<lpage>1446</lpage>.<pub-id pub-id-type="pmid">28078475</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Adams</surname><given-names>M.J.</given-names></name></person-group><etal>et al</etal> (<year>2017b</year>) 
<article-title>Changes to taxonomy and the International Code of Virus Classification and Nomenclature ratified by the International Committee on Taxonomy of Viruses (2017)</article-title>. <source>Arch. Virol</source>., <volume>162</volume>, <fpage>2505</fpage>–<lpage>2538</lpage>.<pub-id pub-id-type="pmid">28434098</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>S.F.</given-names></name></person-group><etal>et al</etal> (<year>1990</year>) 
<article-title>Basic local alignment search tool</article-title>. <source>J. Mol. Biol</source>., <volume>215</volume>, <fpage>403</fpage>–<lpage>410</lpage>.<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bao</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Improvements to pairwise sequence comparison (PASC): a genome-based web tool for virus classification</article-title>. <source>Arch. Virol</source>., <volume>159</volume>, <fpage>3293</fpage>–<lpage>3304</lpage>.<pub-id pub-id-type="pmid">25119676</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cotmore</surname><given-names>S.F.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>The family Parvoviridae</article-title>. <source>Arch. Virol</source>., <volume>159</volume>, <fpage>1239</fpage>–<lpage>1247</lpage>.<pub-id pub-id-type="pmid">24212889</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Edgar</surname><given-names>R.C.</given-names></name></person-group> (<year>2004</year>) 
<article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>. <source>Nucleic Acids Res</source>., <volume>32</volume>, <fpage>1792</fpage>–<lpage>1797</lpage>.<pub-id pub-id-type="pmid">15034147</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fu</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>CD-HIT: accelerated for clustering the next-generation sequencing data</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>3150</fpage>–<lpage>3152</lpage>.<pub-id pub-id-type="pmid">23060610</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hibbett</surname><given-names>D.S.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>Points of View Automated Phylogenetic Taxonomy: an Example in the Homobasidiomycetes (Mushroom-Forming Fungi)</article-title>. <source>Syst. Biol</source>., <volume>54</volume>, <fpage>660</fpage>–<lpage>668</lpage>.<pub-id pub-id-type="pmid">16126660</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Izquierdo-Carrasco</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>PUmPER: phylogenies updated perpetually</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>1476</fpage>–<lpage>1477</lpage>.<pub-id pub-id-type="pmid">24478338</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kapli</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Multi-rate Poisson Tree Processes for single-locus species delimitation under Maximum Likelihood and Markov Chain Monte Carlo</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>btx025</fpage>.</mixed-citation>
    </ref>
    <ref id="bty099-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Katoh</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2002</year>) 
<article-title>MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform</article-title>. <source>Nucleic Acids Res</source>., <volume>30</volume>, <fpage>3059</fpage>–<lpage>3066</lpage>.<pub-id pub-id-type="pmid">12136088</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Katoh</surname><given-names>K.</given-names></name>, <name name-style="western"><surname>Standley</surname><given-names>D.M.</given-names></name></person-group> (<year>2013</year>) 
<article-title>MAFFT Multiple Sequence Alignment Software Version 7: improvements in Performance and Usability</article-title>. <source>Mol. Biol. Evol</source>., <volume>30</volume>, <fpage>772</fpage>–<lpage>780</lpage>.<pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kozlov</surname><given-names>A.M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Phylogeny-aware identification and correction of taxonomically mislabeled sequences</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>5022</fpage>–<lpage>5033</lpage>.<pub-id pub-id-type="pmid">27166378</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lauber</surname><given-names>C.</given-names></name>, <name name-style="western"><surname>Gorbalenya</surname><given-names>A.E.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Partitioning the genetic diversity of a virus family: approach and evaluation through a case study of picornaviruses</article-title>. <source>J. Virol</source>., <volume>86</volume>, <fpage>3890</fpage>–<lpage>3904</lpage>.<pub-id pub-id-type="pmid">22278230</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Löytynoja</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Goldman</surname><given-names>N.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Phylogeny-aware gap placement prevents errors in sequence alignment and evolutionary analysis</article-title>. <source>Science</source>, <volume>320</volume>, <fpage>1632</fpage>–<lpage>1635</lpage>.<pub-id pub-id-type="pmid">18566285</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Löytynoja</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Goldman</surname><given-names>N.</given-names></name></person-group> (<year>2005</year>) 
<article-title>An algorithm for progressive multiple alignment of sequences with insertions</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>102</volume>, <fpage>10557</fpage>–<lpage>10562</lpage>.<pub-id pub-id-type="pmid">16000407</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nishimura</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>ViPTree: the viral proteomic tree server</article-title>. <source>Bioinformatics</source>., <volume>33</volume>, <fpage>2379</fpage>–<lpage>2380</lpage>.<pub-id pub-id-type="pmid">28379287</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sievers</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Fast, scalable generation of high-quality protein multiple sequence alignments using Clustal Omega</article-title>. <source>Mol. Syst. Biol</source>., <volume>7</volume>, <fpage>539</fpage>.<pub-id pub-id-type="pmid">21988835</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Simmonds</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Consensus statement: virus taxonomy in the age of metagenomics</article-title>. <source>Nat. Rev. Microbiol</source>., <volume>15</volume>, <fpage>161</fpage>–<lpage>168</lpage>.<pub-id pub-id-type="pmid">28134265</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Simmonds</surname><given-names>P.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Methods for virus classification and the challenge of incorporating metagenomic sequence data</article-title>. <source>J. Gen. Virol</source>., <volume>96</volume>, <fpage>1193</fpage>–<lpage>1206</lpage>.<pub-id pub-id-type="pmid">26068186</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>S.A.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Mega-phylogeny approach for comparative biology: an alternative to supertree and supermatrix approaches</article-title>. <source>BMC Evol. Biol</source>., <volume>9</volume>, <fpage>37</fpage>.<pub-id pub-id-type="pmid">19210768</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Stamatakis</surname><given-names>A.</given-names></name></person-group> (<year>2014</year>) 
<article-title>RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>1312</fpage>–<lpage>1313</lpage>.<pub-id pub-id-type="pmid">24451623</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Thompson</surname><given-names>J.D.</given-names></name></person-group><etal>et al</etal> (<year>1994</year>) 
<article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title>. <source>Nucleic Acids Res</source>., <volume>22</volume>, <fpage>4673</fpage>–<lpage>4680</lpage>.<pub-id pub-id-type="pmid">7984417</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Di Tommaso</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>T-Coffee: a web server for the multiple sequence alignment of protein and RNA sequences using structural information and homology extension</article-title>. <source>Nucleic Acids Res</source>., <volume>39</volume>, <fpage>W13</fpage>–<lpage>W17</lpage>.<pub-id pub-id-type="pmid">21558174</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vilella</surname><given-names>A.J.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>EnsemblCompara GeneTrees: complete, duplication-aware phylogenetic trees in vertebrates</article-title>. <source>Genome Res</source>., <volume>19</volume>, <fpage>327</fpage>–<lpage>335</lpage>.<pub-id pub-id-type="pmid">19029536</pub-id></mixed-citation>
    </ref>
    <ref id="bty099-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>An Automated Phylogenetic Tree-Based Small Subunit rRNA Taxonomy and Alignment Pipeline (STAP)</article-title>. <source>PLoS One</source>, <volume>3</volume>, <fpage>e2566</fpage>.<pub-id pub-id-type="pmid">18596968</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
