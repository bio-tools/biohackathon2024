<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Brief Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">bib</journal-id>
    <journal-title-group>
      <journal-title>Briefings in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1467-5463</issn>
    <issn pub-type="epub">1477-4054</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8575030</article-id>
    <article-id pub-id-type="pmid">34402866</article-id>
    <article-id pub-id-type="doi">10.1093/bib/bbab326</article-id>
    <article-id pub-id-type="publisher-id">bbab326</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Problem Solving Protocol</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RefRGim: an intelligent reference panel reconstruction method for genotype imputation with convolutional neural networks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Shi</surname>
          <given-names>Shuo</given-names>
        </name>
        <!--shishuo@big.ac.cn-->
        <aff><institution>National Genomics Data Center of Beijing Institute of Genomics</institution>, Chinese Academy of Sciences, Beijing, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Qian</surname>
          <given-names>Qiheng</given-names>
        </name>
        <!--qianqiheng2018m@big.ac.cn-->
        <aff><institution>National Genomics Data Center of Beijing Institute of Genomics</institution>, Chinese Academy of Sciences, Beijing, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yu</surname>
          <given-names>Shuhuan</given-names>
        </name>
        <!--yush@big.ac.cn-->
        <aff><institution>National Genomics Data Center of Beijing Institute of Genomics</institution>, Chinese Academy of Sciences, Beijing, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Qi</given-names>
        </name>
        <!--wangqi17m@foxmail.com-->
        <aff><institution>Qujiang culture finance holding (Group) Co., Ltd</institution>, Xian, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Jinyue</given-names>
        </name>
        <!--wangjinyue@big.ac.cn-->
        <aff><institution>National Genomics Data Center of Beijing Institute of Genomics</institution>, Chinese Academy of Sciences, Beijing, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zeng</surname>
          <given-names>Jingyao</given-names>
        </name>
        <!--zengjy@big.ac.cn-->
        <aff><institution>National Genomics Data Center of Beijing Institute of Genomics</institution>, Chinese Academy of Sciences, Beijing, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Du</surname>
          <given-names>Zhenglin</given-names>
        </name>
        <!--duzhl@big.ac.cn-->
        <xref rid="cor1" ref-type="corresp"/>
        <aff><institution>National Genomics Data Center of Beijing Institute of Genomics</institution>, Chinese Academy of Sciences, Beijing, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8894-3446</contrib-id>
        <name>
          <surname>Xiao</surname>
          <given-names>Jingfa</given-names>
        </name>
        <!--xiaojingfa@big.ac.cn-->
        <xref rid="cor1" ref-type="corresp"/>
        <aff><institution>National Genomics Data Center of Beijing Institute of Genomics</institution>, Chinese Academy of Sciences, Beijing, <country country="CN">China</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Corresponding authors: Jingfa Xiao. Tel.: +86-10-84097443; E-mail: <email>xiaojingfa@big.ac.cn</email>; Zhenglin Du. E-mail: <email>duzhl@big.ac.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>11</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-08-17">
      <day>17</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>8</month>
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <issue>6</issue>
    <elocation-id>bbab326</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>21</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>7</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bbab326.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Genotype imputation is a statistical method for estimating missing genotypes from a denser haplotype reference panel. Existing methods usually performed well on common variants, but they may not be ideal for low-frequency and rare variants. Previous studies showed that the population similarity between study and reference panels is one of the key factors influencing the imputation accuracy. Here, we developed an imputation reference panel reconstruction method (RefRGim) using convolutional neural networks (CNNs), which can generate a study-specified reference panel for each input data based on the genetic similarity of individuals from current study and references. The CNNs were pretrained with single nucleotide polymorphism data from the 1000 Genomes Project. Our evaluations showed that genotype imputation with RefRGim can achieve higher accuracies than original reference panel, especially for low-frequency and rare variants. RefRGim will serve as an efficient reference panel reconstruction method for genotype imputation. RefRGim is freely available via GitHub: <ext-link xlink:href="https://github.com/shishuo16/HGImp" ext-link-type="uri">https://github.com/shishuo16/RefRGim</ext-link></p>
    </abstract>
    <kwd-group>
      <kwd>genotype imputation</kwd>
      <kwd>reference reconstruction</kwd>
      <kwd>deep learning</kwd>
      <kwd>genome-wide association study</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Center for Advanced Study</institution>
            <institution-id institution-id-type="DOI">10.13039/100006296</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Natural Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>2020YFC0848900</award-id>
        <award-id>2017YFC0907503</award-id>
        <award-id>2016YFB0201702</award-id>
        <award-id>31771465</award-id>
        <award-id>31970634</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Chinese Academy of Sciences</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002367</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>XDB38030400</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec3">
    <title>Introduction</title>
    <p>With current genotyping array or sequencing technologies, there is always a certain percentage of variant genotypes that cannot be detected, which seriously affects subsequent analysis. Thus, genotype imputation was introduced to predict missing genotypes, which can significantly boost the power of signal variants in genome-wide association studies [<xref rid="ref1" ref-type="bibr">1</xref>, <xref rid="ref2" ref-type="bibr">2</xref>], provide a high-resolution view of a certain region in fine-mapping study, increase the chance to find causal single nucleotide polymorphisms (SNPs) [<xref rid="ref3" ref-type="bibr">3</xref>] and facilitate meta-analysis for merging multiple genotype data from different genotyping arrays or sequencing depths [<xref rid="ref3" ref-type="bibr">3</xref>, <xref rid="ref4" ref-type="bibr">4</xref>].</p>
    <p>Current popular imputation tools, such as Beagle [<xref rid="ref5" ref-type="bibr">5</xref>] and Impute [<xref rid="ref6" ref-type="bibr">6</xref>], were proposed based on hidden Markov model or its extensions, which were used to model linkage disequilibrium, estimate recombination rates and search for comparable local pattern in references and then impute alleles in reference haplotypes into the samples to create imputed genotypes [<xref rid="ref1" ref-type="bibr">1</xref>]. These methods usually performed well on common variants, nevertheless, it still remains a major challenge in the genotype inference for low-frequency and rare variants [<xref rid="ref7" ref-type="bibr">7</xref>, <xref rid="ref8" ref-type="bibr">8</xref>]. Considering the important roles of these variants in human diseases and other associated studies, the improvement of imputation performance on those variants becomes more necessary [<xref rid="ref9" ref-type="bibr">9</xref>]. Previous studies showed that genetic similarity between individuals in the reference panel and the study affects the imputation performance significantly [<xref rid="ref10" ref-type="bibr">10–12</xref>]. Pasaniuc <italic toggle="yes">et al</italic>. have tried to optimize imputation performance in local region with a weighted reference population by splitting the reference genome [<xref rid="ref13" ref-type="bibr">13</xref>]. Zhang <italic toggle="yes">et al</italic>. have focused on improving imputation accuracies within the European population by identifying the subset of European ancestry reference panel at a given size with maximal phylogenetic diversity [<xref rid="ref14" ref-type="bibr">14</xref>]. In general, existing methods are mainly focused on the short window of the genome or the construction of internal reference panels for specific populations.</p>
    <p>From last decades, a number of high-quality human reference panels have been constructed in different large-scale whole genome sequencing projects [<xref rid="ref15" ref-type="bibr">15</xref>], such as the reference panel from the 1000 Genomes Project with over 80 million SNPs in 2504 individuals from 26 populations across the world [<xref rid="ref16" ref-type="bibr">16</xref>], the UK10K reference panel with 27 million SNPs of 3781 European individuals [<xref rid="ref17" ref-type="bibr">17</xref>], the Haplotype Reference Consortium panel with 39 million SNPs from 32 488 mix population individuals [<xref rid="ref18" ref-type="bibr">18</xref>] and the CASPMI reference panel with 24.85 million SNPs from 597 Chinese individuals [<xref rid="ref19" ref-type="bibr">19</xref>]. Among them, the reference panel from the 1000 Genomes Project used to be one of the most popular choices because of its large sample size, population diversity and open access. Nowadays, with the completion of more and more large-scale whole-genome sequencing projects, the proper selection of reference panels in an imputation study has become very crucial in practice.</p>
    <p>In this paper, we presented RefRGim, a reference panel reconstruction method using convolutional neural networks (CNNs), aiming to improve imputation performance by providing a more genetic similar reference panel for study individuals. RefRGim can rank reference haplotypes by its genetic similarity with the study individuals, select the most comparable haplotype group for each study individual and organize them into a new reference panel for study data specifically.</p>
  </sec>
  <sec id="sec4">
    <title>Materials and methods</title>
    <p>In recent years, with the rise of the CNNs, image recognition and text recognition have been evolving fast and significantly [<xref rid="ref20" ref-type="bibr">20</xref>]. CNNs are the modified versions of artificial neural networks in which the convolution is a specialized kind of linear operation of local variables. In addition, transfer learning is able to reduce the pressure of computational resource consumption when using deep learning algorithms like CNNs [<xref rid="ref21" ref-type="bibr">21</xref>]. With a similar idea, deoxyribonucleic acid (DNA) sequence recognition and comparison can also be accomplished by CNNs, with quantized alleles and proper convolutional (CONV) architecture.</p>
    <p>RefRGim was built with a set of CNNs, which consisted of five CONV layers, three pooling layers inserted in-between the first four CONV layers and one spatial pyramid pooling (SPP) layer located behind the fifth CONV layer, followed by two fully connected layers. The networks take an ordered genotype list from individuals as input, and they output the most genetic comparable haplotype group for each individual (<xref rid="f1" ref-type="fig">Figure 1<bold>A</bold></xref>).</p>
    <fig position="float" id="f1">
      <label>Figure 1</label>
      <caption>
        <p>(<bold>A</bold>) RefRGim’s model architecture. The CNNs model comprises of five CONV layers, three pooling layers, one SPP layer and two fully connected layers. It takes mathematical values transformed from nucleotide bases as input and outputs the most similar haplotype group for each input sample. Different populations are represented by different colors, while those in the same superpopulation are displayed in the same color series (AFR: blue, AMR: purple, EAS: red, EUR: green and SAS: yellow). (<bold>B</bold>) The feature maps of 1KGP individuals in CNNs layers. If there are multiple feature maps in a CONV layer, only the first one is plotted. (<bold>C</bold>) Dimension reduction of raw and processed genotype data of 1KGP individuals using uniform manifold approximation and projection (UMAP). UMAP 1–3 of individuals are plotted as a dot on a three-dimensional (3D) coordinate. A 3D set of light-red triangles with vertices, given UMAP 1–3, are drawn using plotly.mesh3d to trace the 3D positional relationship between individuals.</p>
      </caption>
      <graphic xlink:href="bbab326f1" position="float"/>
    </fig>
    <sec id="sec5">
      <title>Training data</title>
      <p>We downloaded haplotype references of the 1000 Genomes Project (1KGP), which includes 2504 individuals from 26 populations in 5 superpopulations across the world: African (AFR), American (AMR), East Asian (EAS), European (EUR) and South Asian (SAS) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> available online at <ext-link xlink:href="http://bib.oxfordjournals.org/" ext-link-type="uri">http://bib.oxfordjournals.org/</ext-link>). We divided them by its populations and generated 26 haplotype groups. Each group was comprised about 100 high-quality phasing individuals. We performed principle component (PC) analyses on these individuals and filtered those who distributed away from other individuals in the same population (<xref rid="sup3" ref-type="supplementary-material">Supplementary Figure S1</xref> available online at <ext-link xlink:href="http://bib.oxfordjournals.org/" ext-link-type="uri">http://bib.oxfordjournals.org/</ext-link>). To generate high-quality variant set for model training, we only included common variants [minor allele frequency (MAF) &gt; 0.05] on genotyping arrays and filtered those were not significantly different among populations (Chi-squared test: <italic toggle="yes">P</italic> &lt; 1e-8). Finally, 2418 samples with 1.1 million SNPs were left for model training. Then, we transformed the four bases-ATCG to mathematical values (<italic toggle="yes">A</italic> = 0; <italic toggle="yes">T</italic> = 0.1; <italic toggle="yes">C</italic> = 0.3; <italic toggle="yes">G</italic> = 0.7). These assignments were proposed to guarantee each base-pair with a unique value, ranging from 0 to 1.4 (<xref rid="f1" ref-type="fig">Figure 1<bold>A</bold></xref>). Variants were sorted into a list by its positions on chromosomes and every 4000 SNPs of the list was split into fragments, which ranged from 6 to15 Mb in length on chromosomes.</p>
    </sec>
    <sec id="sec6">
      <title>Reference panel reconstruction model</title>
      <p>The CONV layer of CNNs can capture the local sequence linkage information by using the kernel, which is a parameter matrix that moves over the input base-pair value sequence, performs the dot product with its subset region, extracts linkage features from original sequence and gets the output as the matrix of dot products for the next layer. The CONV process is performed as follows: <disp-formula id="deqn01"><tex-math id="M1">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ \mathrm{X}=\left({\mathrm{x}}_1,{\mathrm{x}}_2,{\mathrm{x}}_3,\dots, {\mathrm{x}}_N\right), $$\end{document}</tex-math></disp-formula><disp-formula id="deqn02"><tex-math id="M2">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ \mathrm{W}=\left({\mathrm{w}}_1,{\mathrm{w}}_2,{\mathrm{w}}_3,\dots, {\mathrm{w}}_n\right), $$\end{document}</tex-math></disp-formula><disp-formula id="deqn02aa"><tex-math id="M3">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ {y}_i=\sum_{v=1}^n{\mathrm{w}}_v\cdot{x}_{i+v-1}+b (1\le i\le N), $$\end{document}</tex-math></disp-formula>
where X is one-dimensional input vector shaped 1 × <italic toggle="yes">N</italic>, W is the vector of the kernel shaped 1 × <italic toggle="yes">n</italic>, <italic toggle="yes">b</italic> is bias term, <inline-formula><tex-math id="M4">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${y}_i$\end{document}</tex-math></inline-formula> is an output value summed from multiply results of a length <italic toggle="yes">n</italic> sequence fragment and a length <italic toggle="yes">n</italic> kernel. We set our kernel shaped 1 × 15, and the stride of each sliding is one base. To capture sequence information from different aspects, we used 32 different kernels to learn the sequence at each CONV layer.</p>
      <p>The output data from a CONV layer were batch-normalized for stabilizing the learning process, where</p>
      <p><inline-formula><tex-math id="M5">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\mu =\frac{1}{N}\sum_{i=1}^N{y}_i$\end{document}</tex-math></inline-formula> //batch mean,</p>
      <p><inline-formula><tex-math id="M6">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\sigma}^2=\frac{1}{N}\sum_{i=1}^N{({y}_i-\mu )}^2$\end{document}</tex-math></inline-formula> //batch variance,</p>
      <p><inline-formula><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${\hat{y}}_i=\frac{y_i-\mu }{\sqrt{\sigma^2+\varepsilon }}$\end{document}</tex-math></inline-formula> //normalize,</p>
      <p><inline-formula><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${z}_i=\gamma{\hat{y}}_i+\beta$\end{document}</tex-math></inline-formula> //scale and shift,</p>
      <p>where <inline-formula><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\varepsilon$\end{document}</tex-math></inline-formula>is a constant added to the batch variance for numerical stability, <italic toggle="yes">γ</italic> and <italic toggle="yes">β</italic> are learnable parameters to scale and shift the input that are updated during training iteration. Then, the data were activated using the rectified linear unit (ReLU: <italic toggle="yes">f</italic>(<italic toggle="yes">x</italic>) = max(0, <italic toggle="yes">x</italic>)) function to add non-linearity into the network.</p>
      <p>Pooling layer after each CONV layer was used to reduce the number of parameters and to control overfitting. Pooling layers were proposed for downsampling the feature map by summarizing the presence of features in patches of it. We used max pooling with filter sized 1 × 4 and stride shaped 1 × 4, discarding 75% of the activations.</p>
      <p>SPP layer is a special pooling layer, which is usually added to the transition of CONV layers and fully connected layers [<xref rid="ref22" ref-type="bibr">22</xref>]. SPP adopts spatial pyramid structure as it is not one single pooling procedure but multiple pooling layers with different scales. It can generate a fixed-size output regardless input data size. We set a four-level pooling layer after the fifth CONV layer and our bin sizes were of 1 × 6, 1 × 4, 1 × 2, 1 × 1. The outputs from different pooling layers were merged into one-dimensional data sized 1 × 13 at each feature map. With five CONV layers and four pooling layers, the features of input variant sequence were extracted, and the differences between different populations were emerged step by step (<xref rid="f1" ref-type="fig">Figure 1<bold>B</bold></xref>).</p>
      <p>The output data of all feature maps (shaped 1 × 13 × 128 in our model) from the SPP layer were merged into one-dimensional data shaped 1 × 512 and then that were fed into fully connected layers. Variables in a fully connected layer have full connections to all activations in the previous layer, which is similar as regular neural networks. This approach has been proven very effective in image recognition and classification [<xref rid="ref23" ref-type="bibr">23</xref>]. We set the dropout as 0.5 to make the nodes in the network generally more robust to the inputs. Through two fully connected layers at the end of our model, RefRGim reached to the final classification decision on haplotype group using the softmax function:</p>
      <p><inline-formula><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${P}_i=\sigma{(\overrightarrow{a})}_i=\frac{{\mathrm{e}}^{a_i}}{\sum_{j=1}^M{\mathrm{e}}^{a_j}}(1\le i\le M),$\end{document}</tex-math></inline-formula>where <italic toggle="yes">M</italic> is the number of haplotype groups, <inline-formula><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${a}_i$\end{document}</tex-math></inline-formula>values are the output elements from the last fully connected layer and the term on the bottom of the formula is the normalization term which ensures that all the output values of the function sum to 1, constituting a valid probability distribution.</p>
    </sec>
    <sec id="sec7">
      <title>Model pretraining</title>
      <p>We trained RefRGim using the cross-entropy (negative log likelihood) as the loss function, where we focused on minimizing:<disp-formula id="deqn03"><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$ \mathrm{loss}\ \mathrm{function}=-\frac{1}{K}\sum_{c=1}^K\sum_{i=1}^M{S}_{ci}\cdot \log \left({P}_{ci}\right), $$\end{document}</tex-math></disp-formula>where <italic toggle="yes">K</italic> is sample number; <italic toggle="yes">M</italic> is haplotype group number; <inline-formula><tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${S}_{ci}$\end{document}</tex-math></inline-formula> equals 1 when sample <italic toggle="yes">c</italic> belongs to class <italic toggle="yes">i</italic>, otherwise <inline-formula><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${S}_{ci}$\end{document}</tex-math></inline-formula> equals 0; <inline-formula><tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}${P}_{ci}$\end{document}</tex-math></inline-formula> is the predicted probability of sample <italic toggle="yes">c</italic> belongs to class <italic toggle="yes">i</italic> deduced by the softmax function in the model. Training process was carried out using the Adam optimizer with a learning rate of 1e-5. To accelerate the model’s learning rate and reduce computational resource consumption, we used batch learning with batch size 200 at each iteration. We performed crossvalidation at every 50 iterations and stopped the iteration while both training accuracy and testing accuracy of population prediction were greater than 0.99 (<xref rid="sup4" ref-type="supplementary-material">Supplementary Figure S2</xref> available online at <ext-link xlink:href="http://bib.oxfordjournals.org/" ext-link-type="uri">http://bib.oxfordjournals.org/</ext-link>). After the training process, the model was able to classify 26 groups apart from each other effectively (<xref rid="f1" ref-type="fig">Figure 1<bold>C</bold></xref>).</p>
    </sec>
    <sec id="sec8">
      <title>Model retraining in practice</title>
      <p>As a user-oriented tool, RefRGim was supposed to handle different variant data as input. It would cost enormous computing resource and time if we retrain the CNN model all over again every time when it met a new SNP set. Hence, we introduced transfer learning into our method by reloading parameters and architecture of pretrained CNNs model and only retraining parameters of fully connected layers in practice. As for the unique SNPs in the pretrained model relative to study data, the model would change the SNP genotype to the same as human genome reference. It can achieve rapid progress and improve the performance when retraining the CNNs model for new SNP sets. After retraining step, the model can be used to recommend haplotypes for study individuals. We also provided original code for users to train the model with their own reference panels other than 1KGP.</p>
    </sec>
    <sec id="sec9">
      <title>Study-specified reference panel reconstruction</title>
      <p>After population classification, each study individual was assigned with a most genetic comparable haplotype group, which was used to organize into the study-specified reference panel (SSRP). To avoid the influence of population diversity of study individuals, RefRGim divided these haplotype groups by their superpopulations and organized them to different SSRPs.</p>
    </sec>
    <sec id="sec10">
      <title>Evaluation and computation resource</title>
      <p>Here, we evaluated the performance of RefRGim by comparison of sequence and population similarity of individuals in the study and SSRP and the improvements of imputation accuracy with the SSRP using Begale5.1 [<xref rid="ref5" ref-type="bibr">5</xref>], Impute2 [<xref rid="ref6" ref-type="bibr">6</xref>] and Minimac4 [<xref rid="ref24" ref-type="bibr">24</xref>], respectively. In the imputation process, we divided testing individuals by their superpopulation classification and performed imputation separately. The testing dataset contains 199 individuals from 43 countries in 5 major continental groups: America, Central Asia Siberia, East Asia, South Asia and West Eurasia (<xref rid="f3" ref-type="fig">Figure 3<bold>A</bold></xref>) [<xref rid="ref25" ref-type="bibr">25</xref>].</p>
      <p>RefRGim was tested on Intel(R) Xeon(R) CPU E5-2650 v4 @ 2.20GHz. The running time positively correlated with the missing number of intersected SNPs between the study and reference in the retraining process and the complexity of study populations in abstracting and reconstructing new reference panel process. For instance, when the missing SNP number is 3500 (87.5%), the model retraining time needs 17 min. When the missing SNP number is 2000 (50%), the time is 8 min. As for time cost owing to complexity of study populations in reconstructing new reference panel process, it was less than 120 min based on the reference panels of 1KGP.</p>
    </sec>
    <sec id="sec11">
      <title>Implementation</title>
      <p>RefRGim was implemented using python3 with Tensorflow 1.9 (<ext-link xlink:href="https://www.tensorflow.org/" ext-link-type="uri">https://www.tensorflow.org/</ext-link>) and Numpy 1.14.3 (<ext-link xlink:href="https://numpy.org/" ext-link-type="uri">https://numpy.org/</ext-link>). All relevant codes are available at <ext-link xlink:href="https://github.com/shishuo16/HGImp" ext-link-type="uri">https://github.com/shishuo16/RefRGim</ext-link>.</p>
    </sec>
  </sec>
  <sec id="sec12">
    <title>Results</title>
    <sec id="sec13">
      <title>Performance on sequence similarity comparison</title>
      <p>First, we evaluated our model’s ability to capture sequence information by comparing the consistency of cluster result based on identity by state (IBS) score and population classification result by our model of 63 testing individuals, using a 12.4 Mb length sequence fragment (chr1: 41.0–53.4 Mb). This fragment was selected automatically by our model as this region has the largest intersected SNP number between the input data and pretrained SNP set of our model. IBS score was used to describe two identical segments or sequences of DNA in genetics and it was negative with the similarity degree of two sequences. The five main branches of hierarchical clustering tree based on IBS score were mostly corresponding with different superpopulations classification results, EUR, AMR, SAS, EAS and SAS, respectively (<xref rid="f2" ref-type="fig">Figure 2<bold>A</bold></xref>). Under the main branch, individuals who had smaller IBS scores with each other were classified into same or adjacent populations. The population affiliations of different individuals by RefRGim were correlated with their IBS scores, which demonstrated its capability of sequence information collection and inference. These 63 testing individuals come from five different areas around the world. Our model compared their sequence with the sequences of different haplotype groups in reference panel and divided the testing individuals to different haplotype groups. The Sankey plot of the original sampling location and haplotype group affiliation showed most individuals were parted to similar superpopulations (<xref rid="f2" ref-type="fig">Figure 2<bold>B</bold></xref>). However, some individuals were classified into other superpopulations, like West Eurasia to AMR or SAS. As for Central Asian Siberian testing individuals, which did not have corresponding individuals in the reference panel (<xref rid="f3" ref-type="fig">Figure 3<bold>A</bold></xref>), RefRGim classified them to AMR, EAS and SAS superpopulations separately. We further displayed part of sequence information in this fragment, AGBL4 gene region, in which none, multiallelic or low-frequency (MAF &lt; 0.05) variants sites were omitted and 1336 single nucleotide mutation sites were left to demonstrate [<xref rid="ref26" ref-type="bibr">26</xref>]. The figure showed testing individuals who were divided into the same superpopulation had similar sequence base pattern (<xref rid="f2" ref-type="fig">Figure 2<bold>C</bold></xref>). West Eurasian testing individuals who were classified as AMR or SAS were more similar in sequence base to individuals with AMR or SAS compared to EUR, same as Central Asian Siberian testing individuals.</p>
      <fig position="float" id="f2">
        <label>Figure 2</label>
        <caption>
          <p>(<bold>A</bold>) Hierarchical clustering tree of testing individuals based on IBS score using ‘complete’ agglomeration method. Pie plot represents the percentages of superpopulations of testing individuals classified to in this branch. (<bold>B</bold>) Sample-paired Sankey plot of original sampling location and predicted population group by RefRGim. (<bold>C</bold>) Heatmap of common variant genotypes of corresponding individuals in (<bold>B</bold>) in AGBL4 gene region, where 0, 1 and 2 are the alternative allele dosages.</p>
        </caption>
        <graphic xlink:href="bbab326f2" position="float"/>
      </fig>
      <fig position="float" id="f3">
        <label>Figure 3</label>
        <caption>
          <p>(<bold>A</bold>) Geographical locations of testing individuals and 1KGP individuals. Size of the dot is positive with the number of testing individuals. (<bold>B</bold>) PCs 1 and 2 of the reference and testing individuals. The reference samples in different populations are plotted by different colors and those in the same superpopulation are plotted in the same color series. The study samples are plotted by black triangle. The proportion of variance of each PC is texted. The pie plot shows the population classification results of the study samples from America, Central Asia Siberia, East Asia, South Asia and West Eurasia, deduced by RefRGim.</p>
        </caption>
        <graphic xlink:href="bbab326f3" position="float"/>
      </fig>
    </sec>
    <sec id="sec14">
      <title>Performance on population identification</title>
      <p>First, we performed principal components analysis on variants of 199 testing individuals and the 1KGP individuals to demonstrate the extent of their population distribution (<xref rid="f3" ref-type="fig">Figure 3<bold>B</bold></xref>). The plot of PCs 1 and 2 showed that most of the testing and 1KGP individuals who belonged to similar superpopulations were clustered together. American individuals in the testing set were distributed with AMR individuals in reference. Most of the West Eurasian testing individuals were distributed with EUR individuals except that fewer individuals sporadically gathered with AMR and SAS individuals in reference, which might be owing to lack of corresponding European samples in 1KGP (<xref rid="f3" ref-type="fig">Figure 3<bold>A</bold></xref>). For Central Asia Siberia, which did not have corresponding samples in 1KGP at all, they were gathered with AMR, EAS, EUR and SAS individuals in 1KGP.</p>
      <p>We used RefRGim to perform reference reconstruction on testing individuals, and each individual was assigned with a most genetic similar haplotype group. By comparing RefRGim’s classification result in pie plot with the prior information about population, we found there was a high degree of agreement between them. For 20 American individuals, RefRGim classified 12 of them to PEL (Peruvians from Lima) group, 7 to MXL (Mexican Ancestry from Los Angeles) group and 1 to CLM (Colombians from Medellin) group. As for 71 West Eurasian testing individuals, RefRGim classified 54 of them to EUR superpopulations, including 20 TSI (Toscani in Italia), 10 IBS (Iberian Population in Spain), 5 GBR (British in England and Scotland), 9 FIN (Finnish in Finland) and 10 CEU (Utah Residents (CEPH) with Northern and Western European Ancestry), 13 to AMR superpopulations and 4 to SAS superpopulations, which was also consistent with prior known population information, demonstrating the ability of population identification of RefRGim.</p>
      <p>Considering the uncertainty of SNP size provide by user, we then evaluated the stability of population identification on different percentages of intersected SNP size with our CNNs model (<xref rid="sup5" ref-type="supplementary-material">Supplementary Figure S3</xref> and <xref rid="sup2" ref-type="supplementary-material">Supplementary Table S2</xref> available online at <ext-link xlink:href="http://bib.oxfordjournals.org/" ext-link-type="uri">http://bib.oxfordjournals.org/</ext-link>). The Sankey plot showed RefRGim was more robust on individuals from America and East Asia than other populations. For South Asia, the robustness of RefRGim was slightly lower and its sensitivity to SNP abundance in genome might be caused by the complex genetic background of South Asian testing individuals (<xref rid="f3" ref-type="fig">Figure 3<bold>B</bold></xref>). For Central Asia Siberia, there was some mixture between EAS and SAS. After further investigation on the countries of Central Asian Siberian individuals, we found most interactions happened on the Russian individuals. The lack of Russian samples in 1KGP might be the reason of unstable classification of these individuals. For West Eurasian individuals, the interactions mostly happened between AMR, EUR and SAS groups. The corresponding testing individuals were from 26 countries, including South Asian countries (Iran, Iraq and Yemen), counties adjacent to Asia (Armenia, Jordan and Georgia), Russia and some European countries. High intra-population complexity in West Eurasia and lack of corresponding samples in 1KGP might be the reason for the instability on population classification.</p>
    </sec>
    <sec id="sec15">
      <title>Performance of the SSRP on genotype imputation</title>
      <p>RefRGim can rank reference haplotypes by its genetic similarity with study individuals and select the most comparable haplotype group for each study individual to organize them into SSRP. We further compared the imputation performances of testing individuals with original reference panels (1KGP and its subsets: AFR, AMR, EAS, EUR and SAS) and SSRP generated by RefRGim. The genotype imputation was performed using Beagle5.1 with default parameters and was measured using the squared Pearson correlation between the masked genotypes and the imputed allele dosages. The results showed that the best performance one of the original reference panels for different population testing individuals was different, and the SSRP always kept a high-level performance, especially for low-frequency and rare variants in all five testing populations (<xref rid="f4" ref-type="fig">Figure 4</xref>). For America, using SSRP as reference panel, the average imputation accuracy of low-frequency variants increased from 0.89 to 0.94 and that of rare variants increased from 0.78 to 0.89, comparing with the 1KGP reference panel. For West Eurasia, the imputation accuracy of low-frequency variants and rare variants was improved from 0.86 to 0.90 and from 0.8 to 0.86, respectively. In addition, we have also evaluated the imputation performance using Impute2 and Minimac4, respectively, and observed the same trend in SSRP performance as Beagle 5.1 (<xref rid="sup6" ref-type="supplementary-material">Supplementary Figure S4</xref> available online at <ext-link xlink:href="http://bib.oxfordjournals.org/" ext-link-type="uri">http://bib.oxfordjournals.org/</ext-link>).</p>
      <fig position="float" id="f4">
        <label>Figure 4</label>
        <caption>
          <p>The imputation performance (mean <italic toggle="yes">r</italic>^2) comparison of testing samples with SSRP and six reference panels (1KGP original reference panels and its subsets of AFR, AMR, EAS, EUR and SAS) using Beagle5.1. The <italic toggle="yes">x</italic>-axis represents the MAF of imputed variants in 1KGP.</p>
        </caption>
        <graphic xlink:href="bbab326f4" position="float"/>
      </fig>
      <p>As we know, the population identification of our model is slightly different with various percentages of intersected SNP size between the input data and the model. Therefore, we also evaluated the imputation performances of SSRP under different percentages of intersected SNP size. The results presented that the imputation accuracies with SSRP were still better than the original references even if the intersected SNP size was decreasing (<xref rid="sup7" ref-type="supplementary-material">Supplementary Figure S5</xref> available online at <ext-link xlink:href="http://bib.oxfordjournals.org/" ext-link-type="uri">http://bib.oxfordjournals.org/</ext-link>).</p>
    </sec>
  </sec>
  <sec id="sec16">
    <title>Discussion</title>
    <p>In last decades, a lot of haplotype reference panels had been generated, aiding to accomplish the high-quality genotype imputation process for future studies [<xref rid="ref17" ref-type="bibr">17</xref>, <xref rid="ref27" ref-type="bibr">27</xref>, <xref rid="ref28" ref-type="bibr">28</xref>]. Several studies have shown the effect of the reference panel choice on imputation performance. Therefore, the selection of reference panels for specific studies of genotype imputation is inevitable and critical.</p>
    <p>In this article, we presented a new approach called RefRGim to construct SSRP for each input data from the existing reference panels. RefRGim was designed to compare the sequence similarity between individuals in study and original reference panels and to organize the reference haplotypes which had the top sequence similarities with study individuals to a new reference panel. Compared with existing methods, RefRGim not only captured genetic information of local sequences but also estimated global genetic similarity to construct a universal reference panel for study samples. RefRGim was a common approach that may cope with the genotype imputation studies from different populations. Because of the high sequence and population similarity between SSRP and testing individuals, SSRP was committed to more consistent allele distribution with the study data and to avoiding potential fake linkage events that may be involved in other populations. Using SSRP as reference, genotype imputation can achieve a higher level of performance for study individuals, especially for low-frequency and rare SNPs.</p>
    <p>RefRGim was implemented with CNNs, which can capture the local sequence patterns and find most sequence-similar reference haplotypes for study individuals. It was accelerated by introducing transfer learning into the retraining process in practice [<xref rid="ref29" ref-type="bibr">29</xref>]. The function of sequence similarity calculation and comparison was mainly accomplished by the kernels in the CONV layer in which multiple weighted parameter matrixes acted as learning cubes to slide on the genome sequence and transform pieces of sequence to values, step by step. These processes can capture and process sequence data by its base information along with its location information at the same time. CNN algorithm can utilize a fragment of sequence as input data instead of a single base. This is the advantage of CNN algorithm in sequence information capture field, compared with other traditional machine learning methods, like Regular Neural Network, Random Forest and Support Vector Machines [<xref rid="ref30" ref-type="bibr">30</xref>]. In terms of model applications, RefRGim can help complete the retraining process quickly and accurately by adapting transfer learning algorithm on the last two layers to accommodate different SNP sets. This is another advantage of CNN algorithm, which has high program transferability in sequence base processing.</p>
    <p>So far, we only included 1KGP reference panels as original references in our model. There were still some populations around the world not covered in current existing reference panels. In the future, we will collect and integrate more diverse reference panels in RefRGim to improve its performance. Fortunately, with the embedding of transfer learning function, our model does not need to be trained from the beginning every time it met new data. In an era of rapid growth of large-scale whole genome sequencing data year by year, the continually learning ability of our model will be more and more useful [<xref rid="ref15" ref-type="bibr">15</xref>]. On the other hand, with the fast growing of high-quality human haplotype reference panels, selecting appropriate reference panels for genotype imputation will be a much more urgent problem. Currently, our approach only supports human genotype imputation studies. Based on the same imputation principles as human [<xref rid="ref31" ref-type="bibr">31</xref>], RefRGim may be applied to other species with growing diverse reference panels in the future.</p>
    <boxed-text id="box01" position="float">
      <sec id="sec19">
        <title>Key Points</title>
        <list list-type="bullet">
          <list-item>
            <p>A reference panel reconstruction method with CNNs. RefRGim can provide SSRP to achieve high performance for genotype imputation, especially for low-frequency and rare SNPs.</p>
          </list-item>
          <list-item>
            <p>A population identification classifier based on local pattern and general similarity of sequences. The application of CNNs in this field shows good predictive ability and transportability with enlarged learning data in the future.</p>
          </list-item>
          <list-item>
            <p>An application scenario of CNNs in sequence recognition. The multiple kernels in CONV layer ensures to capture local base linkage pattern from different aspects, promising a comprehensive perception on sequence level.</p>
          </list-item>
        </list>
      </sec>
    </boxed-text>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>Supplementary_Table_1_bbab326</label>
      <media xlink:href="supplementary_table_1_bbab326.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup2" position="float" content-type="local-data">
      <label>Supplementary_Table_2_bbab326</label>
      <media xlink:href="supplementary_table_2_bbab326.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup3" position="float" content-type="local-data">
      <label>Supplementary_Figure_1_bbab326</label>
      <media xlink:href="supplementary_figure_1_bbab326.jpeg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup4" position="float" content-type="local-data">
      <label>Supplementary_Figure_2_bbab326</label>
      <media xlink:href="supplementary_figure_2_bbab326.jpeg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup5" position="float" content-type="local-data">
      <label>Supplementary_Figure_3_bbab326</label>
      <media xlink:href="supplementary_figure_3_bbab326.jpeg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup6" position="float" content-type="local-data">
      <label>Supplementary_Figure_4_bbab326</label>
      <media xlink:href="supplementary_figure_4_bbab326.jpeg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup7" position="float" content-type="local-data">
      <label>Supplementary_Figure_5_bbab326</label>
      <media xlink:href="supplementary_figure_5_bbab326.jpeg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec sec-type="data-availability" id="sec14a">
    <title>Data Availability</title>
    <p>The haplotype data used in this study are from the 1000 Genomes Project, which can be downloaded at <ext-link xlink:href="http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/" ext-link-type="uri">http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/</ext-link>.</p>
  </sec>
  <sec id="sec17">
    <title>Funding</title>
    <p>Strategic Priority Research Program of the Chinese Academy of Sciences (XDB38030400 to J.X.); National Natural Science Foundation of China (31970634 and 31771465 to J.X.); National Key Research Program of China (2016YFB0201702, 2017YFC0907503 and 2020YFC0848900 to J.X.); CAS Key Technology Talent Program (to Z.D.).</p>
  </sec>
  <notes id="AN1">
    <p><bold>Shuo Shi</bold> is a PhD candidate at the National Genomics Data Center of Beijing Institute of Genomics, Chinese Academy of Sciences, Beijing, China. She has been working in the field of human genotype imputation study.</p>
    <p><bold>Qiheng Qian</bold> is a PhD candidate at the National Genomics Data Center of Beijing Institute of Genomics, Chinese Academy of Sciences, Beijing, China.</p>
    <p><bold>Shuhuan Yu</bold> is a master candidate at the National Genomics Data Center of Beijing Institute of Genomics, Chinese Academy of Sciences, Beijing, China.</p>
    <p><bold>Qi Wang</bold> is a management trainee at Qujiang culture finance holding (Group) Co., Ltd, Xian, China.</p>
    <p><bold>Jinyue Wang</bold> is a PhD at the National Genomics Data Center of Beijing Institute of Genomics, Chinese Academy of Sciences, Beijing, China.</p>
    <p><bold>Jingyao Zeng</bold> is an assistant professor at the National Genomics Data Center of Beijing Institute of Genomics, Chinese Academy of Sciences, Beijing, China.</p>
    <p><bold>Zhenglin Du</bold> is a senior engineer at the National Genomics Data Center of Beijing Institute of Genomics, Chinese Academy of Sciences, Beijing, China. His research interest is focused on comparative genomics and bioinformatics.</p>
    <p><bold>Jingfa Xiao</bold> is a professor at the National Genomics Data Center of Beijing Institute of Genomics, Chinese Academy of Sciences, Beijing, China. His research interest is focused on genomics and bioinformatics.</p>
  </notes>
  <ref-list id="bib1">
    <title>References</title>
    <ref id="ref1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marchini</surname><given-names>J</given-names></string-name>, <string-name><surname>Howie</surname><given-names>B</given-names></string-name></person-group>. <article-title>Genotype imputation for genome-wide association studies</article-title>. <source>Nat Rev Genet</source><year>2010</year>; <volume>11</volume>: <fpage>499</fpage>–<lpage>511</lpage>.<pub-id pub-id-type="pmid">20517342</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Spencer</surname><given-names>CC</given-names></string-name>, <string-name><surname>Su</surname><given-names>Z</given-names></string-name>, <string-name><surname>Donnelly</surname><given-names>P</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Designing genome-wide association studies: sample size, power, imputation, and the choice of genotyping chip</article-title>. <source>PLoS Genet</source><year>2009</year>; <volume>5</volume>: <fpage>e1000477</fpage>.<pub-id pub-id-type="pmid">19492015</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>F</given-names></string-name>, <string-name><surname>Chen</surname><given-names>GK</given-names></string-name>, <string-name><surname>Millikan</surname><given-names>RC</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Fine-mapping of breast cancer susceptibility loci characterizes genetic risk in African Americans</article-title>. <source>Hum Mol Genet</source><year>2011</year>; <volume>20</volume>: <fpage>4491</fpage>–<lpage>503</lpage>.<pub-id pub-id-type="pmid">21852243</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Jager</surname><given-names>PL</given-names></string-name>, <string-name><surname>Jia</surname><given-names>X</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Meta-analysis of genome scans and replication identify CD6, IRF8 and TNFRSF1A as new multiple sclerosis susceptibility loci</article-title>. <source>Nat Genet</source><year>2009</year>; <volume>41</volume>: <fpage>776</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">19525953</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Browning</surname><given-names>BL</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Y</given-names></string-name>, <string-name><surname>Browning</surname><given-names>SR</given-names></string-name></person-group>. <article-title>A one-penny imputed genome from next-generation reference panels</article-title>. <source>Am J Hum Genet</source><year>2018</year>; <volume>103</volume>: <fpage>338</fpage>–<lpage>48</lpage>.<pub-id pub-id-type="pmid">30100085</pub-id></mixed-citation>
    </ref>
    <ref id="ref6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Howie</surname><given-names>BN</given-names></string-name>, <string-name><surname>Donnelly</surname><given-names>P</given-names></string-name>, <string-name><surname>Marchini</surname><given-names>J</given-names></string-name></person-group>. <article-title>A flexible and accurate genotype imputation method for the next generation of genome-wide association studies</article-title>. <source>PLoS Genet</source><year>2009</year>; <volume>5</volume>: <fpage>e1000529</fpage>.<pub-id pub-id-type="pmid">19543373</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>HF</given-names></string-name>, <string-name><surname>Rong</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Liu</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Performance of genotype imputation for low frequency and rare variants from the 1000 genomes</article-title>. <source>PLoS One</source><year>2015</year>; <volume>10</volume>: <fpage>e0116487</fpage>.<pub-id pub-id-type="pmid">25621886</pub-id></mixed-citation>
    </ref>
    <ref id="ref8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Howie</surname><given-names>B</given-names></string-name>, <string-name><surname>Marchini</surname><given-names>J</given-names></string-name>, <string-name><surname>Stephens</surname><given-names>M</given-names></string-name></person-group>. <article-title>Genotype imputation with thousands of genomes</article-title>. <source>G3 (Bethesda)</source><year>2011</year>; <volume>1</volume>: <fpage>457</fpage>–<lpage>70</lpage>.<pub-id pub-id-type="pmid">22384356</pub-id></mixed-citation>
    </ref>
    <ref id="ref9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bomba</surname><given-names>L</given-names></string-name>, <string-name><surname>Walter</surname><given-names>K</given-names></string-name>, <string-name><surname>Soranzo</surname><given-names>N</given-names></string-name></person-group>. <article-title>The impact of rare and low-frequency genetic variants in common disease</article-title>. <source>Genome Biol</source><year>2017</year>; <volume>18</volume>: <fpage>77</fpage>.<pub-id pub-id-type="pmid">28449691</pub-id></mixed-citation>
    </ref>
    <ref id="ref10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Browning</surname><given-names>SR</given-names></string-name>, <string-name><surname>Browning</surname><given-names>BL</given-names></string-name></person-group>. <article-title>Haplotype phasing: existing methods and new developments</article-title>. <source>Nat Rev Genet</source><year>2011</year>; <volume>12</volume>: <fpage>703</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">21921926</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shi</surname><given-names>S</given-names></string-name>, <string-name><surname>Yuan</surname><given-names>N</given-names></string-name>, <string-name><surname>Yang</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Comprehensive assessment of genotype imputation performance</article-title>. <source>Hum Hered</source><year>2018</year>; <volume>83</volume>: <fpage>107</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">30669139</pub-id></mixed-citation>
    </ref>
    <ref id="ref12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>L</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y</given-names></string-name>, <string-name><surname>Singleton</surname><given-names>AB</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Genotype-imputation accuracy across worldwide human populations</article-title>. <source>Am J Hum Genet</source><year>2009</year>; <volume>84</volume>: <fpage>235</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">19215730</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name>Pasaniuc B, Avinery R, Gur T</string-name>, <etal>et al.</etal></person-group><article-title>A generic coalescent-based framework for the selection of a reference panel for imputation</article-title>. <source>Genet Epidemiol</source><year>2010</year>; <volume>34</volume>: <fpage>773</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">21058333</pub-id></mixed-citation>
    </ref>
    <ref id="ref14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name>Zhang P, Zhan X, Rosenberg NA</string-name>, <etal>et al.</etal></person-group><article-title>Genotype imputation reference panel selection using maximal phylogenetic diversity</article-title>. <source>Genetics</source><year>2013</year>; <volume>195</volume>: <fpage>319</fpage>–<lpage>330</lpage>.<pub-id pub-id-type="pmid">23934887</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stark</surname><given-names>Z</given-names></string-name>, <string-name><surname>Dolman</surname><given-names>L</given-names></string-name>, <string-name><surname>Manolio</surname><given-names>TA</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Integrating genomics into healthcare: a global responsibility</article-title>. <source>Am J Hum Genet</source><year>2019</year>; <volume>104</volume>: <fpage>13</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">30609404</pub-id></mixed-citation>
    </ref>
    <ref id="ref16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Genomes Project</surname><given-names>C</given-names></string-name>, <string-name><surname>Auton</surname><given-names>A</given-names></string-name>, <string-name><surname>Brooks</surname><given-names>LD</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A global reference for human genetic variation</article-title>. <source>Nature</source><year>2015</year>; <volume>526</volume>: <fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="ref17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>J</given-names></string-name>, <string-name><surname>Howie</surname><given-names>B</given-names></string-name>, <string-name><surname>McCarthy</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Improved imputation of low-frequency and rare variants using the UK10K haplotype reference panel</article-title>. <source>Nat Commun</source><year>2015</year>; <volume>6</volume>: <fpage>8111</fpage>.<pub-id pub-id-type="pmid">26368830</pub-id></mixed-citation>
    </ref>
    <ref id="ref18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McCarthy</surname><given-names>S</given-names></string-name>, <string-name><surname>Das</surname><given-names>S</given-names></string-name>, <string-name><surname>Kretzschmar</surname><given-names>W</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A reference panel of 64,976 haplotypes for genotype imputation</article-title>. <source>Nat Genet</source><year>2016</year>; <volume>48</volume>: <fpage>1279</fpage>–<lpage>83</lpage>.<pub-id pub-id-type="pmid">27548312</pub-id></mixed-citation>
    </ref>
    <ref id="ref19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Du</surname><given-names>Z</given-names></string-name>, <string-name><surname>Ma</surname><given-names>L</given-names></string-name>, <string-name><surname>Qu</surname><given-names>H</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Whole genome analyses of Chinese population and de novo assembly of a northern Han genome</article-title>. <source>Genomics Proteomics Bioinformatics</source><year>2019</year>; <volume>17</volume>: <fpage>229</fpage>–<lpage>47</lpage>.<pub-id pub-id-type="pmid">31494266</pub-id></mixed-citation>
    </ref>
    <ref id="ref20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yamashita</surname><given-names>R</given-names></string-name>, <string-name><surname>Nishio</surname><given-names>M</given-names></string-name>, <string-name><surname>Do</surname><given-names>RKG</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Convolutional neural networks: an overview and application in radiology</article-title>. <source>Insights Imaging</source><year>2018</year>; <volume>9</volume>: <fpage>611</fpage>–<lpage>29</lpage>.<pub-id pub-id-type="pmid">29934920</pub-id></mixed-citation>
    </ref>
    <ref id="ref21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blitzer</surname><given-names>J</given-names></string-name>, <string-name><surname>Dredze</surname><given-names>M</given-names></string-name>, <string-name><surname>Pereira</surname><given-names>F</given-names></string-name></person-group>. <article-title>Biographies, Bollywood, boom-boxes and blenders: domain adaptation for sentiment classification</article-title>. In: <source>Proceedings of the 45th annual meeting of the association of computational linguistics - Prague</source>, Czech Republic: Association for Computational Linguistics. 2007; p. 440–447.</mixed-citation>
    </ref>
    <ref id="ref22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name>He K, Zhang X, Ren S</string-name>, <etal>et al.</etal></person-group><article-title>Spatial pyramid pooling in deep convolutional networks for visual recognition</article-title>. <source>IEEE transactions on pattern analysis and machine intelligence</source><year>2015</year>; <volume>37</volume>: <fpage>1904</fpage>–<lpage>16</lpage>.<pub-id pub-id-type="pmid">26353135</pub-id></mixed-citation>
    </ref>
    <ref id="ref23">
      <label>23.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Mahmon</surname><given-names>NA</given-names></string-name>, <string-name><surname>Ya'acob</surname><given-names>N</given-names></string-name></person-group>. <part-title>A review on classification of satellite image using artificial neural network (ANN)</part-title>. In: <source>2014 IEEE 5th Control and System Graduate Research Colloquium - Shah Alam</source>. Malaysia, U.S.: IEEE New York. 2014; p. 153–157.</mixed-citation>
    </ref>
    <ref id="ref24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Das</surname><given-names>S</given-names></string-name>, <string-name><surname>Forer</surname><given-names>L</given-names></string-name>, <string-name><surname>Schonherr</surname><given-names>S</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Next-generation genotype imputation service and methods</article-title>. <source>Nat Genet</source><year>2016</year>; <volume>48</volume>: <fpage>1284</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">27571263</pub-id></mixed-citation>
    </ref>
    <ref id="ref25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mallick</surname><given-names>S</given-names></string-name>, <string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Lipson</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>The Simons genome diversity project: 300 genomes from 142 diverse populations</article-title>. <source>Nature</source><year>2016</year>; <volume>538</volume>: <fpage>201</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">27654912</pub-id></mixed-citation>
    </ref>
    <ref id="ref26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gu</surname><given-names>Z</given-names></string-name>, <string-name><surname>Eils</surname><given-names>R</given-names></string-name>, <string-name><surname>Schlesner</surname><given-names>M</given-names></string-name></person-group>. <article-title>Complex heatmaps reveal patterns and correlations in multidimensional genomic data</article-title>. <source>Bioinformatics</source><year>2016</year>; <volume>32</volume>: <fpage>2847</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">27207943</pub-id></mixed-citation>
    </ref>
    <ref id="ref27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nagasaki</surname><given-names>M</given-names></string-name>, <string-name><surname>Yasuda</surname><given-names>J</given-names></string-name>, <string-name><surname>Katsuoka</surname><given-names>F</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Rare variant discovery by deep whole-genome sequencing of 1,070 Japanese individuals</article-title>. <source>Nat Commun</source><year>2015</year>; <volume>6</volume>: <fpage>8018</fpage>.<pub-id pub-id-type="pmid">26292667</pub-id></mixed-citation>
    </ref>
    <ref id="ref28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deelen</surname><given-names>P</given-names></string-name>, <string-name><surname>Menelaou</surname><given-names>A</given-names></string-name>, <string-name><prefix>van</prefix><surname>Leeuwen</surname><given-names>EM</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Improved imputation quality of low-frequency and rare variants in European samples using the 'Genome of the Netherlands'</article-title>. <source>Eur J Hum Genet</source><year>2014</year>; <volume>22</volume>: <fpage>1321</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">24896149</pub-id></mixed-citation>
    </ref>
    <ref id="ref29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhuang</surname><given-names>F</given-names></string-name>, <string-name><surname>Qi</surname><given-names>Z</given-names></string-name>, <string-name><surname>Duan</surname><given-names>K</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A comprehensive survey on transfer learning</article-title>. <source>Proc IEEE</source><year>2020</year>; <volume>109</volume>: <fpage>43</fpage>–<lpage>76</lpage>.</mixed-citation>
    </ref>
    <ref id="ref30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Khan</surname><given-names>A</given-names></string-name>, <string-name><surname>Sohail</surname><given-names>A</given-names></string-name>, <string-name><surname>Zahoora</surname><given-names>U</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A survey of the recent architectures of deep convolutional neural networks</article-title>. <source>Artif Intell Rev</source><year>2020</year>; <volume>53</volume>: <fpage>5455</fpage>–<lpage>516</lpage>.</mixed-citation>
    </ref>
    <ref id="ref31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>W</given-names></string-name>, <string-name><surname>Yang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Animal-ImputeDB: a comprehensive database with multiple animal reference panels for genotype imputation</article-title>. <source>Nucleic Acids Res</source><year>2020</year>; <volume>48</volume>: <fpage>D659</fpage>–<lpage>67</lpage>.<pub-id pub-id-type="pmid">31584087</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
