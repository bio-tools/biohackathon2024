<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8825466</article-id>
    <article-id pub-id-type="pmid">34927685</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab842</article-id>
    <article-id pub-id-type="publisher-id">btab842</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>EcoPLOT: dynamic analysis of biogeochemical data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2463-1144</contrib-id>
        <name>
          <surname>Sanchez</surname>
          <given-names>Christopher D</given-names>
        </name>
        <xref rid="btab842-cor1" ref-type="corresp"/>
        <!--cdsanchez@lbl.gov-->
        <aff><institution>Lawrence Berkeley National Laboratory</institution>, Berkeley, CA 94710, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brown</surname>
          <given-names>J Benjamin</given-names>
        </name>
        <aff><institution>Lawrence Berkeley National Laboratory</institution>, Berkeley, CA 94710, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gal-Oz</surname>
          <given-names>Omree</given-names>
        </name>
        <aff><institution>Lawrence Berkeley National Laboratory</institution>, Berkeley, CA 94710, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Singer</surname>
          <given-names>Esther</given-names>
        </name>
        <xref rid="btab842-cor1" ref-type="corresp"/>
        <!--esinger@lbl.gov-->
        <aff><institution>Lawrence Berkeley National Laboratory</institution>, Berkeley, CA 94710, <country country="US">USA</country></aff>
        <aff><institution>DOE Joint Genome Institute</institution>, Berkeley, CA 94720, <country country="US">USA</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Lu</surname>
          <given-names>Zhiyong</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab842-cor1">To whom correspondence should be addressed. <email>cdsanchez@lbl.gov</email> or <email>esinger@lbl.gov</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>3</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-12-20">
      <day>20</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <volume>38</volume>
    <issue>5</issue>
    <fpage>1480</fpage>
    <lpage>1482</lpage>
    <history>
      <date date-type="received">
        <day>02</day>
        <month>6</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>02</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>09</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>14</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="corrected-typeset">
        <day>27</day>
        <month>12</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab842.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>We have created EcoPLOT (parameterized linkage of omics-driven technologies), a web-app for the dynamic, interactive analysis of biogeochemical datasets that combines state-of-the-art analysis tools to statistically and graphically explore environmental, geochemical and microbiome datasets. Using the iterative random forest, a machine learning algorithm, EcoPLOT allows for the <italic toggle="yes">de novo</italic> discovery of drivers which exhibit significant impact on plant, microbial or soil dynamics. </p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>EcoPLOT is built entirely within the R language. It can be accessed through any system where R is installed, including Windows, Mac and most Linux systems. EcoPLOT is free to use and can be accessed at <ext-link xlink:href="https://github.com/cdsanchez18/EcoPLOT" ext-link-type="uri">https://github.com/cdsanchez18/EcoPLOT</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>TWIN Ecostem project led by Lawrence Berkeley National Laboratory</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>U.S. Department of Energy, Office of Science</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DE-AC02-05CH11231</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Microorganisms are involved in global and local biogeochemical cycles and redox reactions that both directly and indirectly affect the functioning of their surroundings (<xref rid="btab842-B5" ref-type="bibr">Maier, 2015</xref>; <xref rid="btab842-B10" ref-type="bibr">Wieder <italic toggle="yes">et al.</italic>, 2015</xref>). In soils, microbes are direct promoters of plant health and development through their participation in a number of redox reactions, promotion of nutrient cycling and conference of resistance to biotic and abiotic stresses (<xref rid="btab842-B7" ref-type="bibr">Miransari, 2014</xref>). Bacterial, archaeal and fungal community compositions are often heterogeneous across soils and are impacted by fluctuations in environmental conditions such as weather and soil chemistry (<xref rid="btab842-B8" ref-type="bibr">Serna-Chavez <italic toggle="yes">et al.</italic>, 2013</xref>). The environmental variability and complexity challenge our understanding of processes such as soil ecosystem functioning.</p>
    <p>To study ecosystem processes, high-throughput molecular techniques, such as DNA/RNA sequencing, metabolomics and soil chemistry analyses, which require destructive sampling, are regularly combined with in situ measuring devices, for example using real-time minimally or non-invasive sensors and cameras (<xref rid="btab842-B9" ref-type="bibr">Singer <italic toggle="yes">et al.</italic>, 2021</xref>). Depending on measurement frequency and choice of instrumentation, these approaches can result in large amounts of data of different formats. The resulting datasets are often large and complex and demand proper data integration as well as iterative, custom and dynamic analysis tools.</p>
    <p>Existing tools for microbial analysis, such as QIIME (<xref rid="btab842-B4" ref-type="bibr">Caporaso <italic toggle="yes">et al.</italic>, 2010</xref>), QIIME 2 (<xref rid="btab842-B3" ref-type="bibr">Bolyen <italic toggle="yes">et al.</italic>, 2019</xref>) and Phyloseq (<xref rid="btab842-B6" ref-type="bibr">McMurdie and Holmes, 2013</xref>), provide reproducible workflows for the analysis of amplicon data and feature the ability to demultiplex sequences, assign taxonomies and perform various downstream statistical analyses. However, customization of functionality is usually limited to the tool developers, while the existing code may not satisfy the unique needs of a study design, hence requiring additional custom scripts. Furthermore, these tools were designed for microbiome-centric studies that do not allow separate analysis of environmental datasets, such as soil chemistry profiles and plant phenotyping data.</p>
    <p>Here, we introduce EcoPLOT (parameterized linkage of omics-driven technologies), a web-based tool for the visualization and analysis of multivariate datasets, as well as its accompanying R package (<xref rid="btab842-B11" ref-type="bibr">R Core Team, 2021</xref>). EcoPLOT features an interactive graphical user interface which provides an analytical workflow that educates users on how to integrate and centrally analyze complex multi-disciplinary datasets, quickly discover significant interactions and trends within multifactorial datasets and to produce publication-ready visualizations. Besides providing an assembly of state-of-the-art analysis tools for biogeochemical datasets based on few established R libraries, EcoPLOT also offers a suggested workflow that educates and introduces users to analysis methods, such as novel application of the iterative random forest (iRF) to microbiome research. Improving our understanding of the reciprocal interactions between microbes, and the environments and hosts they reside in is essential for various environmental missions including improvements in crop yield, carbon sequestration and bioremediation.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>EcoPLOT provides users with state-of-the-art tools for graphical and statistical analysis of datasets that explore plant phenotypes, geochemistry and microbiome community dynamics, separately and in combination with one another. EcoPLOT’s interface is organized into four modules (Plant, Microbiome, Environment and iRF), each of which provide graphics and analysis options specific to the corresponding data type. We explain the unique features of each module, respective data types and a general workflow (<xref rid="btab842-F1" ref-type="fig">Fig.  1</xref>) below. </p>
    <fig position="float" id="btab842-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>EcoPLOT workflow overview. Plant, environment and microbiome modules offer data-specific statistical and graphical analysis tools. Data tables can be merged into any module and be used for combined analysis for discovery of significant drivers using graphical and regression analysis as well as machine learning (iRF)</p>
      </caption>
      <graphic xlink:href="btab842f1" position="float"/>
    </fig>
    <p>The plant module ‘Phenotype Data’ allows import of spatially and temporally resolved plant phenotypic measurements. Within this module users will be able to identify relationships between plant phenotype and experimental design. The imported dataset is automatically summarized and quartiles for each relevant measurement are presented. The user can subset their dataset based on the inherent data ranges or sample factors. Statistical analyses include one-way and two-way ANOVA, Tukey HSD, two sample t-test and Kruskal–Wallis statistical methods. Data visualization includes boxplots, histograms and interactive scatter plots.</p>
    <p>The environmental module ‘Environmental Data’ allows users to investigate spatial and temporal trends of any environmental parameters, including time-stamped sensor data and physical/chemical analyses. For categorical temporal and spatial variables, the same analyses as provided in the plant module can be applied to the environmental module. In addition, users with soil chemistry data can identify their soil type using an interactive soil texture triangle. Trends in plant and environmental modules can help to inform the microbiome data.</p>
    <p>The microbiome module ‘Microbiome Data’ provides users with an extensive toolkit to analyze quality-screened sequence count tables e.g. amplicon sequence variant (ASV) tables, and associated metadata and phylogenetic trees. Data input formats are compatible with QIIME 1&amp;2, Phyloseq, as well as non-formatted files (i.e. text files). Standard phylogenetic tree data formats are also accepted. Users can filter count tables by frequency across samples and # of counts per gene. Alpha (Shannon’s H index, Chao1, observed OTUs/ASVs) and beta (Bray–Curtis, Jaccard, Euclidean, unweighted/weighted unifrac) diversity can be displayed using an array of visualization methods. Statistical analyses, such as differential abundance calculations using DESeq2 (<xref rid="btab842-B1" ref-type="bibr">Anders and Huber, 2010</xref>), Kruskal–Wallis and ADONIS (Analysis of variance using distance matrices) are applied on demand. Datasets are automatically reformatted to meet the requirements of their respective analyses.</p>
    <p>Across all modules graphical analysis of scatter and principal coordinate analysis (PCO) plots is interactive, allowing users to identify outliers and create up to ten different custom group labels which can be accessed in downstream analyses, such as statistical tests or iRF.</p>
    <p>Besides standard regression methods, EcoPLOT offers users the iterative Random Forest (iRF) algorithm (<xref rid="btab842-B2" ref-type="bibr">Basu <italic toggle="yes">et al.</italic>, 2018</xref>) to uncover significant groupings between plant, environment and the microbiome. iRF searches for stable, high order interactions within biological datasets at minimal computational cost, which allows computation on a local computer. EcoPLOT seamlessly integrates user-uploaded data into one large dataset that can be accessed directly through the Machine Learning ‘iRF’ module. After optional data subsetting, response variables can be selected to be tested. Testing and training datasets are created automatically following this selection. Output consists of Variable Importance Plots that display the top factors in descending order as measured by a Random Forest and a list of interacting variables and their corresponding stability score. Users are able to create surface plots to visualize how two interacting variables affect the desired response. EcoPLOT uses default IRF parameters (n.iter = 5, ntree = 500, n.bootstrap = 30), however, they can be changed directly within the R code to fit a given experiment.</p>
    <p>EcoPLOT provides a comprehensive toolbox for the multivariate analysis of biogeochemical datasets and is open source, built almost entirely from R code. Like other shiny apps it can be further customized using HTML, CSS, JavaScript or additional R packages and can easily be expanded to support other types of metadata. Because of its streamlined functionality, data exploration with IRF is simple to set up and can be implemented for data of any size. Based on the parameters defined for iRF, run times may vary, however EcoPLOT can be expanded to support processing over an external server. All EcoPLOT functionality is described in detail in the Instructions and data type specific guides.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This material by the TWIN Ecostem project led by Lawrence Berkeley National Laboratory is based upon work supported by the U.S. Department of Energy, Office of Science, Office of Biological Environmental Research under contract number DE-AC02-05CH11231 and under the LBNL LDRD entitled ‘Improving biofuel crop yield from field to lab under drought stress’ (to E.S.).</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared. </p>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab842-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Anders</surname><given-names>S.</given-names></string-name>, <string-name><surname>Huber</surname><given-names>W.</given-names></string-name></person-group> (<year>2010</year>) <article-title>Differential expression analysis for sequence count data</article-title>. <italic toggle="yes">Genome Biol, </italic>11, R106.</mixed-citation>
    </ref>
    <ref id="btab842-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Basu</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Iterative random forests to discover predictive and stable high-order interactions</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>115</volume>, <fpage>1943</fpage>–<lpage>1948</lpage>.<pub-id pub-id-type="pmid">29351989</pub-id></mixed-citation>
    </ref>
    <ref id="btab842-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bolyen</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Reproducible, interactive, scalable and extensible microbiome data science using QIIME 2</article-title>. <source>Nat. Biotechnol</source>., <volume>37</volume>, <fpage>852</fpage>–<lpage>857</lpage>.<pub-id pub-id-type="pmid">31341288</pub-id></mixed-citation>
    </ref>
    <ref id="btab842-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Caporaso</surname><given-names>J.G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>QIIME allows analysis of high-throughput community sequencing data</article-title>. <source>Nat. Methods</source>, <volume>7</volume>, <fpage>335</fpage>–<lpage>336</lpage>.<pub-id pub-id-type="pmid">20383131</pub-id></mixed-citation>
    </ref>
    <ref id="btab842-B5">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Maier</surname><given-names>R.M.</given-names></string-name></person-group> (<year>2015</year>) <part-title>Biogeochemical cycling</part-title>. <source>Environmental Microbiology: Third Edition, 339–373</source>.</mixed-citation>
    </ref>
    <ref id="btab842-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McMurdie</surname><given-names>P.J.</given-names></string-name>, <string-name><surname>Holmes</surname><given-names>S.</given-names></string-name></person-group> (<year>2013</year>) <article-title>phyloseq: an R package for reproducible interactive analysis and graphics of microbiome census data</article-title>. <source>PLoS One</source>, <volume>8</volume>, <fpage>e61217</fpage>.<pub-id pub-id-type="pmid">23630581</pub-id></mixed-citation>
    </ref>
    <ref id="btab842-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miransari</surname><given-names>M.</given-names></string-name></person-group> (<year>2014</year>) <article-title>Plant growth promoting Rhizobacteria</article-title>. <source>J. Plant Nutr</source>., <volume>37</volume>, <fpage>2227</fpage>–<lpage>2235</lpage>.</mixed-citation>
    </ref>
    <ref id="btab842-B11">
      <mixed-citation publication-type="journal">R Core Team (2021) R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL <ext-link xlink:href="https://github.com/cdsanchez18/EcoPLOT" ext-link-type="uri">https://www.R-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="btab842-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Serna-Chavez</surname><given-names>H.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Global drivers and patterns of microbial abundance in soil</article-title>. <source>Glob. Ecol. Biogeogr</source>., <volume>22</volume>, <fpage>1162</fpage>–<lpage>1172</lpage>.</mixed-citation>
    </ref>
    <ref id="btab842-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Singer</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Novel and emerging capabilities that can provide a holistic understanding of the plant root microbiome</article-title>. <source>Phytobiomes J</source>. 5(2), <fpage>122</fpage>–<lpage>132</lpage>.</mixed-citation>
    </ref>
    <ref id="btab842-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wieder</surname><given-names>W.R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Explicitly representing soil microbial processes in Earth system models: soil microbes in earth system models</article-title>. <source>Glob. Biogeochem. Cycles</source>, <volume>29</volume>, <fpage>1782</fpage>–<lpage>1800</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
