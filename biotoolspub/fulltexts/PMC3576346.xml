<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3576346</article-id>
    <article-id pub-id-type="publisher-id">1471-2164-13-681</article-id>
    <article-id pub-id-type="pmid">23194258</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2164-13-681</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>iASeq: integrative analysis of allele-specificity of protein-DNA interactions in multiple ChIP-seq datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes" id="A1">
        <name>
          <surname>Wei</surname>
          <given-names>Yingying</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>ywei@jhsph.edu</email>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes" id="A2">
        <name>
          <surname>Li</surname>
          <given-names>Xia</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>lixia@big.ac.cn</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Wang</surname>
          <given-names>Qian-fei</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>wangqf@big.ac.cn</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A4">
        <name>
          <surname>Ji</surname>
          <given-names>Hongkai</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>hji@jhsph.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Biostatistics, Johns Hopkins University Bloomberg School of Public Health, 615 North Wolfe StreetBaltimore, Maryland 21205, USA</aff>
    <aff id="I2"><label>2</label>CAS Key Laboratory of Genome Sciences and Information, Beijing Institute of Genomics, Chinese Academy of Sciences, Beijing 100029, P.R. China</aff>
    <aff id="I3"><label>3</label>University of Chinese Academy of Sciences, Beijing 100049, P.R. China</aff>
    <pub-date pub-type="collection">
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>29</day>
      <month>11</month>
      <year>2012</year>
    </pub-date>
    <volume>13</volume>
    <fpage>681</fpage>
    <lpage>681</lpage>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>6</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>11</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2012 Wei et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <copyright-holder>Wei et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2164/13/681"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>ChIP-seq provides new opportunities to study allele-specific protein-DNA binding (ASB). However, detecting allelic imbalance from a single ChIP-seq dataset often has low statistical power since only sequence reads mapped to heterozygote SNPs are informative for discriminating two alleles.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We develop a new method iASeq to address this issue by jointly analyzing multiple ChIP-seq datasets. iASeq uses a Bayesian hierarchical mixture model to learn correlation patterns of allele-specificity among multiple proteins. Using the discovered correlation patterns, the model allows one to borrow information across datasets to improve detection of allelic imbalance. Application of iASeq to 77 ChIP-seq samples from 40 ENCODE datasets and 1 genomic DNA sample in GM12878 cells reveals that allele-specificity of multiple proteins are highly correlated, and demonstrates the ability of iASeq to improve allelic inference compared to analyzing each individual dataset separately.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>iASeq illustrates the value of integrating multiple datasets in the allele-specificity inference and offers a new tool to better analyze ASB.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>Allele-specific binding</kwd>
      <kwd>Transcription factor</kwd>
      <kwd>Histone modification</kwd>
      <kwd>Data integration</kwd>
      <kwd>Next-generation sequencing</kwd>
      <kwd>Statistical model</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>In a diploid organism, each somatic cell has two copies of the genome. At certain genomic loci, gene expression, DNA methylation, transcription factor (TF) binding or histone modification (HM) can be allele-specific. In other words, the two alleles can behave differently. These phenomena, also known as allele-specific expression (ASE), allele-specific DNA methylation (ASM) and allele-specific binding (ASB, including both allele-specific TF binding and allele-specific histone modifications), can contribute to phenotypic diversity and may play important roles in adaptive evolution [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B3">3</xref>]. Many allele-specific (AS) events have been found to correlate with variants in genomic sequences [<xref ref-type="bibr" rid="B4">4</xref>-<xref ref-type="bibr" rid="B11">11</xref>]. Comprehensively characterizing allele-specificity therefore can help with linking genotypes to phenotypes. Abnormal AS events have also been linked to various diseases [<xref ref-type="bibr" rid="B12">12</xref>-<xref ref-type="bibr" rid="B15">15</xref>]. For instance, loss of imprinting in IGF2 has been associated with increased risk of colorectal cancer [<xref ref-type="bibr" rid="B12">12</xref>]. This again highlights the importance of studying allele-specificity.</p>
    <p>Early methods for analyzing AS events rely on low-throughput technologies such as real time quantitative PCR [<xref ref-type="bibr" rid="B1">1</xref>]. Later, application of SNP arrays has made the AS analysis high-throughput [<xref ref-type="bibr" rid="B16">16</xref>-<xref ref-type="bibr" rid="B19">19</xref>]. More recently, the rapidly evolving high-throughput sequencing technologies opened the door to produce digital read-out of AS events genome-wide without being constrained by any specific array design [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B14">14</xref>,<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B20">20</xref>-<xref ref-type="bibr" rid="B24">24</xref>]. This brings many new opportunities as well as analytical challenges.</p>
    <p>ChIP-seq, a technology that couples chromatin immunoprecipitation with high-throughput sequencing, has become the state-of-the-art approach for mapping genome-wide TF binding sites and HMs [<xref ref-type="bibr" rid="B25">25</xref>-<xref ref-type="bibr" rid="B28">28</xref>]. However, so far the value of this technology for studying ASB has not been fully utilized. Detecting ASB from a single ChIP-seq dataset often suffers from low statistical power. This is because only a small fraction of reads in each ChIP-seq sample are mapped to heterozygote SNPs, and only these reads are informative for inferring allele-specificity. To make the ChIP-seq based ASB analysis more useful, it is important to have either experimental or analytical innovations to increase the power for detecting allele-specificity.</p>
    <p>ChIP-seq data in public domains grow rapidly. A recently developed database hmChIP, for instance, has compiled over 450 human and mouse ChIP-seq datasets representing approximately 2000 samples from 140+ different TFs and HMs [<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B30">30</xref>]. The large volume of data provides a new opportunity to improve detection of ASB. Conceptually, an integrative analysis of ChIP-seq data for different TFs and HMs from the same individual and cell type may allow one to discover the synergistic correlation patterns of allele-specificity among different proteins. These correlation patterns can then be utilized to integrate information from multiple datasets to improve the ASB detection. For example, if the allelic imbalance of TF A and HM B always co-occur, then analyzing their ChIP-seq data jointly will increase the effective number of reads available for allelic inference which will then increase the statistical power. Unfortunately, existing data analysis tools cannot deal with this emerging opportunity. Methods available for analyzing ASE or ASB using the next-generation sequencing data are all designed for analyzing one dataset at a time. While a few methods are developed for solving problems such as read mapping biases [<xref ref-type="bibr" rid="B31">31</xref>], construction of individualized genome sequences [<xref ref-type="bibr" rid="B32">32</xref>], and combining multiple SNPs in the same gene to infer ASE [<xref ref-type="bibr" rid="B33">33</xref>], no methods and software tools are available for jointly analyzing multiple ChIP-seq datasets together to discover synergy patterns of allele-specificity among multiple proteins and then use the correlation patterns to increase the power of ASB detection by borrowing information across datasets.</p>
    <p>In this article, we present an integrated solution to this problem by developing a new approach, iASeq, for jointly analyzing allele-specificity in multiple ChIP-seq datasets. iASeq uses a Bayesian hierarchical mixture model to describe unknown correlation patterns of allele-specificity among multiple datasets. These patterns can be discovered automatically from the data by fitting the model using an Expectation-Maximization (EM) algorithm. Using the identified correlation patterns, the model allows one to integrate information from multiple datasets to improve the ASB detection. Applying this approach, we analyzed 40 ENCODE [<xref ref-type="bibr" rid="B34">34</xref>] ChIP-seq datasets in GM12878 cells, representing a total of 77 samples from 34 TFs and HMs. The analysis demonstrates the ability of iASeq to automatically integrate information from multiple datasets to significantly improve the detection of allelic imbalance. iASeq is implemented as an R package which is freely available from Bioconductor [<xref ref-type="bibr" rid="B35">35</xref>].</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Data structure</title>
      <p>Suppose there are <italic>D</italic> ChIP-seq datasets generated using cells from the same individual and the same cell type. Each dataset <italic>d</italic> corresponds to one TF or HM, and has <italic>J</italic><sub><italic>d</italic></sub> replicate samples (Figure <xref ref-type="fig" rid="F1">1</xref>a). Different datasets represent different TFs or HMs, or data generated by different labs. For the individual in question, assume one is interested in analyzing <italic>I</italic> heterozygote SNPs with known genotypes. We want to know whether the two alleles of each SNP behave differently in each dataset, and if possible how the AS events are correlated among datasets. For each SNP, the allele consistent with the reference genome is called the <italic>reference allele</italic>, and the other allele is called the <italic>non-reference allele</italic>.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>The iASeq model. (a)</bold> An example of the data structure. Each row represents a SNP and each column corresponds to either the reference allele (R) or the non-reference allele (N) read counts from a ChIP-seq sample in a dataset. A dataset could be a TF ChIP-seq experiment or a HM ChIP-seq experiment, and can have multiple replicate samples (Rep). iASeq assumes the following data generating process. <bold>(b)</bold> First, SNPs belong to <italic>K</italic> + 1 classes with different ASB patterns. For each SNP, a class label <italic>a</italic><sub><italic>i</italic></sub>is randomly assigned according to a class abundance probability vector <bold><italic>Π</italic></bold>. Given the class label, a configuration [<italic>b</italic><sub><italic>id</italic></sub>,<italic>c</italic><sub><italic>id</italic></sub>] is generated for each SNP in each dataset according to the probabilistic allele-specificity patterns specified by two vectors <bold><italic>V</italic></bold><sub><italic>k</italic></sub>and <bold><italic>W</italic></bold><sub><italic>k</italic></sub>. In the figure, the darkness of each cell in <bold><italic>V</italic></bold> and <bold><italic>W</italic></bold> represents the probability for <italic>b</italic><sub><italic>id</italic></sub>or <italic>c</italic><sub><italic>id</italic></sub>to be 1. <bold>(c)</bold> Next, a skewing probability <italic>p</italic><sub><italic>idj</italic></sub>is generated for each SNP <italic>i</italic>, dataset <italic>d</italic> and replicate sample <italic>j</italic> based on [<italic>b</italic><sub><italic>id</italic></sub>,<italic>c</italic><sub><italic>id</italic></sub>]. The distribution of <italic>p</italic><sub><italic>idj</italic></sub>for NS SNPs in each sample follows a Beta distribution (blue lines). <italic>p</italic><sub><italic>idj</italic></sub>s for SR SNPs are uniformly distributed in the interval [<italic>p</italic><sub><italic>dj</italic>0</sub>,1] where <italic>p</italic><sub><italic>dj</italic>0</sub>is the mean of the background Beta distribution (dark blue lines). <italic>p</italic><sub><italic>idj</italic></sub>s for SN SNPs are uniformly distributed in the interval [0,<italic>p</italic><sub><italic>dj</italic>0</sub>] (light blue lines). <bold>(d)</bold> Finally, given the configuration [<italic>b</italic><sub><italic>id</italic></sub>,<italic>c</italic><sub><italic>id</italic></sub>], skewing probability <italic>p</italic><sub><italic>idj</italic></sub>and a total read count <italic>n</italic><sub><italic>idj</italic></sub>for SNP <italic>i</italic>, dataset <italic>d</italic> and sample <italic>j</italic>, the read count for each allele is generated according to a binomial distribution. The length of the orange bar represents the non-reference allele read count, and the length of the red bar represents the reference allele read count.</p>
        </caption>
        <graphic xlink:href="1471-2164-13-681-1"/>
      </fig>
      <p>After read mapping and data preprocessing (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplemental Methods S.1), we count reads for each allele at each heterozygote SNP. For SNP <italic>i</italic>, dataset <italic>d</italic> and replicate sample <italic>j</italic>, let <italic>x</italic><sub><italic>idj</italic></sub> and <italic>y</italic><sub><italic>idj</italic></sub>be the read counts for the reference allele and non-reference allele respectively. Let <italic>n</italic><sub><italic>idj</italic></sub>=<italic>x</italic><sub><italic>idj</italic></sub> + <italic>y</italic><sub><italic>idj</italic></sub> be the total read count (See Figure <xref ref-type="fig" rid="F1">1</xref>a for a toy example). Protein-DNA binding can be skewed to the reference allele (SR), skewed to the non-reference allele (SN), or not allele-specific (NS). We use a binary variable <italic>b</italic><sub><italic>id</italic></sub> to indicate whether SNP <italic>i</italic> is SR (<italic>b</italic><sub><italic>id</italic></sub>=1) or not (<italic>b</italic><sub><italic>id</italic></sub>=0) in dataset <italic>d</italic>. If <italic>b</italic><sub><italic>id</italic></sub>=1, then SNP <italic>i</italic> is assumed to be SR in all replicate samples in dataset <italic>d</italic>. Similarly, we introduce another binary indicator <italic>c</italic><sub><italic>id</italic></sub> to indicate whether SNP <italic>i</italic> is SN or not in dataset <italic>d</italic>. <italic>b</italic><sub><italic>id</italic></sub>and <italic>c</italic><sub><italic>id</italic></sub> cannot be equal to one at the same time. If <italic>b</italic><sub><italic>id</italic></sub>=0 and <italic>c</italic><sub><italic>id</italic></sub>=0, then SNP <italic>i</italic> is NS in dataset <italic>d</italic>. The configuration at each SNP <italic>i</italic> can be described by two vectors <bold><italic>B</italic></bold><sub><italic>i</italic></sub>=(<italic>b</italic><sub><italic>i</italic>1</sub>,⋯,<italic>b</italic><sub><italic>iD</italic></sub>) and <bold><italic>C</italic></bold><sub><italic>i</italic></sub>=(<italic>c</italic><sub><italic>i</italic>1</sub>,⋯,<italic>c</italic><sub><italic>iD</italic></sub>) (See Figure <xref ref-type="fig" rid="F1">1</xref>d for a cartoon illustration). Based on these notations, (<italic>x</italic><sub><italic>idj</italic></sub>,<italic>y</italic><sub><italic>idj</italic></sub>), or equivalently (<italic>x</italic><sub><italic>idj</italic></sub>,<italic>n</italic><sub><italic>idj</italic></sub>), are the observed data for SNP <italic>i</italic> in sample (<italic>d,j</italic>), whereas the indicators <italic>b</italic><sub><italic>id</italic></sub> and <italic>c</italic><sub><italic>id</italic></sub> are unobserved.</p>
    </sec>
    <sec>
      <title>Main intuition and challenge</title>
      <p>Our primary goal is to infer for each SNP whether there is allelic imbalance in each dataset. This is equivalent to inferring <italic>b</italic><sub><italic>id</italic></sub> and <italic>c</italic><sub><italic>id</italic></sub>. A simple solution to this problem is to analyze each individual dataset separately, but this approach has low statistical power since the counts (<italic>x</italic><sub><italic>idj</italic></sub>,<italic>n</italic><sub><italic>idj</italic></sub>) usually are small.</p>
      <p>If one knows how different datasets are correlated in terms of allelic imbalance, this knowledge may be used to improve the data analysis. For instance, if the allelic imbalance of two proteins A and B are closely correlated, then observing skewed read counts for protein A will provide information for inferring the allelic imbalance of protein B. Integrating the data from both A and B will increase the effective number of reads available for statistical inference, which will then lead to increased statistical power.</p>
      <p>In reality, how different proteins are correlated is usually unknown. However, one may learn it by studying the data from many SNPs. Each SNP has three possible states in each dataset: SR, SN and NS. For <italic>D</italic> datasets, there are 3<sup><italic>D</italic></sup> possible configurations in total. From studying many SNPs, one can know the relative frequencies (or mixing proportions) of these 3<sup><italic>D</italic></sup>configurations. The mixing proportions will tell how different datasets are correlated. For instance, let [<italic>s</italic><sub>1</sub>,<italic>s</italic><sub>2</sub>,⋯,<italic>s</italic><sub><italic>D</italic></sub>] be the skewness configuration of a SNP in the <italic>D</italic> datasets. If the mixing proportions for three configurations [<italic>NS</italic>,<italic>NS</italic>,⋯,<italic>NS</italic>], [<italic>SR</italic>,<italic>SR</italic>,⋯,<italic>SR</italic>] and [<italic>SN</italic>,<italic>SN</italic>,⋯,<italic>SN</italic>] are 0.9, 0.05 and 0.05, then no other configurations exist in the data and all datasets are perfectly correlated in terms of the allelic imbalance. In other words, at a particular SNP, if one dataset is SR, then all the other datasets are also SR. If one is SN, then all the others are also SN. On the other hand, if other configurations have non-zero mixing proportions, then not all datasets are perfectly correlated, and at a particular SNP, one allows the possibility that only a subset of datasets are correlated. For instance, if the mixing proportion for a configuration [<italic>SR</italic>,<italic>SR</italic>,<italic>NS</italic>,⋯,<italic>NS</italic>] is 0.03, then there will be 3% of SNPs that are skewed to the reference allele in the first two datasets but not skewed in the other datasets. Therefore, knowing the mixing proportions of all 3<sup><italic>D</italic></sup>configurations will tell one the correlation structure in the data. This knowledge can then be used to improve statistical inference at each individual SNP by facilitating information sharing across datasets. For example, if the configuration [<italic>SR, SR, SN</italic>] has a much higher mixing proportion than [<italic>SR, SR, NS</italic>], then observing strong skewness towards the reference allele of a SNP in the first two datasets will imply that, a priori, the SNP is highly likely to be skewed to the non-reference allele in the third dataset and has much lower probability to be non-skewed for both alleles. The principle here is the same as the principle represented by the Bayesian hierarchical models in the statistical literature.</p>
      <p>A limitation of this approach is that one has to enumerate all 3<sup><italic>D</italic></sup> AS configurations in order to describe the correlation. As the number of datasets increases, the number of possible configurations increases exponentially. Thus this approach does not scale well with the increasing <italic>D</italic>. Later, in our analysis of GM12878 data, <italic>D</italic>=40 and 3<sup><italic>D</italic></sup>&gt;10<sup>19</sup>. This simple approach is clearly intractable.</p>
      <p>To circumvent the difficulty of documenting the frequencies of all 3<sup><italic>D</italic></sup>configurations, iASeq employs a technique that can describe the major correlation patterns in the data using a few probability vectors whose values vary from 0 to 1 rather than being dichotomous (i.e., 0 or 1). This approach significantly reduces the model complexity but keeps the flexibility to account for all 3<sup><italic>D</italic></sup>configurations. It is easily scalable to increasing dataset number. The correlation structure in the model can then be used to improve the statistical inference of allelic imbalance at each SNP in each individual dataset.</p>
    </sec>
    <sec>
      <title>Probability model</title>
      <p>iASeq is based on the Bayesian hierarchical mixture model below that uses several probability vectors to describe the major correlation patterns among multiple datasets (Figure <xref ref-type="fig" rid="F1">1</xref>). The model assumes that SNPs can be grouped into <italic>K</italic> + 1 classes with different allele-specificity patterns (<italic>K</italic>≪3<sup><italic>D</italic></sup>), and the observed data are viewed as generated as follows: </p>
      <p>● First, a class label <italic>a</italic><sub><italic>i</italic></sub>is randomly assigned to each SNP <italic>i</italic> according to a probability vector <bold><italic>Π</italic></bold>=(<italic>Π</italic><sub>0</sub>,<italic>Π</italic><sub>1</sub>,⋯,<italic>Π</italic><sub><italic>K</italic></sub>). Here, <italic>Π</italic><sub><italic>k</italic></sub>=<italic>Pr</italic>(<italic>a</italic><sub><italic>i</italic></sub>=<italic>k</italic>) is the prior probability to assign a SNP to class <italic>k</italic>. <inline-formula><mml:math id="M1" name="1471-2164-13-681-i1" overflow="scroll"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>Π</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>.</p>
      <p>● If the class label <italic>a</italic><sub><italic>i</italic></sub>=0, then <bold><italic>B</italic></bold><sub><italic>i</italic></sub>=(0,⋯,0) and <bold><italic>C</italic></bold><sub><italic>i</italic></sub>=(0,⋯,0). In other words, all SNPs in class 0 are background SNPs, and they are NS in all datasets. If <italic>a</italic><sub><italic>i</italic></sub>=<italic>k</italic>and <italic>k</italic>≠0, then SNP <italic>i</italic> can be skewed, and its [<italic>b</italic><sub><italic>id</italic></sub>;<italic>c</italic><sub><italic>id</italic></sub>]s in different datasets are generated independently according to the following probabilities: <italic>Pr</italic>(<italic>b</italic><sub><italic>id</italic></sub>=1,<italic>c</italic><sub><italic>id</italic></sub>=0|<italic>a</italic><sub><italic>i</italic></sub>=<italic>k</italic>)=<italic>v</italic><sub><italic>kd</italic></sub>and <italic>Pr</italic>(<italic>b</italic><sub><italic>id</italic></sub>=0,<italic>c</italic><sub><italic>id</italic></sub>=1|<italic>a</italic><sub><italic>i</italic></sub>=<italic>k</italic>)=<italic>w</italic><sub><italic>kd</italic></sub>. We assume <italic>v</italic><sub><italic>kd</italic></sub> + <italic>w</italic><sub><italic>kd</italic></sub>&lt;1, i.e., <italic>Pr</italic>(<italic>b</italic><sub><italic>id</italic></sub>=0,<italic>c</italic><sub><italic>id</italic></sub>=0|<italic>a</italic><sub><italic>i</italic></sub>=<italic>k</italic>)=1−<italic>v</italic><sub><italic>kd</italic></sub>−<italic>w</italic><sub><italic>kd</italic></sub>&gt;0. The model implies that each class is associated with two vectors of probabilities <bold><italic>V</italic></bold><sub><italic>k</italic></sub>=(<italic>v</italic><sub><italic>k</italic>1</sub>,⋯,<italic>v</italic><sub><italic>kD</italic></sub>) and <bold><italic>W</italic></bold><sub><italic>k</italic></sub>=(<italic>w</italic><sub><italic>k</italic>1</sub>,⋯,<italic>w</italic><sub><italic>kD</italic></sub>). For SNPs in class <italic>k</italic>, <bold><italic>B</italic></bold><sub><italic>i</italic></sub>and <bold><italic>C</italic></bold><sub><italic>i</italic></sub>are generated according to the probabilities in <bold><italic>V</italic></bold><sub><italic>k</italic></sub>and <bold><italic>W</italic></bold><sub><italic>k</italic></sub>.</p>
      <p>● Next, the observed read counts are generated based on the AS configurations specified by <bold><italic>B</italic></bold><sub><italic>i</italic></sub>s and <bold><italic>C</italic></bold><sub><italic>i</italic></sub>s. Consider SNP <italic>i</italic> and dataset <italic>d</italic>. If <italic>b</italic><sub><italic>id</italic></sub>=1, then (<italic>x</italic><sub><italic>idj</italic></sub>,<italic>n</italic><sub><italic>idj</italic></sub>) in each replicate sample (<italic>d,j</italic>) is generated according to a probability distribution <italic>Pr</italic>(<italic>x</italic><sub><italic>idj</italic></sub>,<italic>n</italic><sub><italic>idj</italic></sub>|<italic>b</italic><sub><italic>id</italic></sub>=1,<italic>c</italic><sub><italic>id</italic></sub>=0)=<italic>Pr</italic>(<italic>n</italic><sub><italic>idj</italic></sub>|<italic>b</italic><sub><italic>id</italic></sub>=1,<italic>c</italic><sub><italic>id</italic></sub>=0)<italic>Pr</italic>(<italic>x</italic><sub><italic>idj</italic></sub>|<italic>n</italic><sub><italic>idj</italic></sub>,<italic>b</italic><sub><italic>id</italic></sub>=1,<italic>c</italic><sub><italic>id</italic></sub>=0)≡<italic>Pr</italic>(<italic>n</italic><sub><italic>idj</italic></sub>)<italic>f</italic><sub><italic>idj</italic>1</sub>(<italic>x</italic><sub><italic>idj</italic></sub>). Here we assume that the marginal distribution of <italic>n</italic><sub><italic>idj</italic></sub>does not depend on <italic>b</italic><sub><italic>id</italic></sub>and <italic>c</italic><sub><italic>id</italic></sub>, and we use <italic>f</italic><sub><italic>idj</italic>1</sub>(<italic>x</italic><sub><italic>idj</italic></sub>) to denote the conditional distribution <italic>Pr</italic>(<italic>x</italic><sub><italic>idj</italic></sub>|<italic>n</italic><sub><italic>idj</italic></sub>,<italic>b</italic><sub><italic>id</italic></sub>=1,<italic>c</italic><sub><italic>id</italic></sub>=0). Data in different replicate samples are assumed to be generated independently. Similarly, if <italic>c</italic><sub><italic>id</italic></sub>=1, then (<italic>x</italic><sub><italic>idj</italic></sub>,<italic>n</italic><sub><italic>idj</italic></sub>)s are generated according to <italic>Pr</italic>(<italic>x</italic><sub><italic>idj</italic></sub>,<italic>n</italic><sub><italic>idj</italic></sub>|<italic>b</italic><sub><italic>id</italic></sub>=0,<italic>c</italic><sub><italic>id</italic></sub>=1)=<italic>Pr</italic>(<italic>n</italic><sub><italic>idj</italic></sub>)<italic>f</italic><sub><italic>idj</italic>2</sub>(<italic>x</italic><sub><italic>idj</italic></sub>). If <italic>b</italic><sub><italic>id</italic></sub>=0 and <italic>c</italic><sub><italic>id</italic></sub>=0, then (<italic>x</italic><sub><italic>idj</italic></sub>,<italic>n</italic><sub><italic>idj</italic></sub>)s are generated according to <italic>Pr</italic>(<italic>x</italic><sub><italic>idj</italic></sub>,<italic>n</italic><sub><italic>idj</italic></sub>|<italic>b</italic><sub><italic>id</italic></sub>=0,<italic>c</italic><sub><italic>id</italic></sub>=0)=<italic>Pr</italic>(<italic>n</italic><sub><italic>idj</italic></sub>)<italic>f</italic><sub><italic>idj</italic>0</sub>(<italic>x</italic><sub><italic>idj</italic></sub>).</p>
      <p>For SNP <italic>i</italic> and dataset <italic>d</italic>, we organize data from all replicates <italic>j</italic>=1,⋯,<italic>J</italic><sub><italic>d</italic></sub> into <bold><italic>X</italic></bold><sub><italic>id</italic></sub>=(<italic>x</italic><sub><italic>id</italic>1</sub>,⋯,<italic>x</italic><sub><italic>idJ</italic></sub><sub><italic>d</italic></sub>) and <bold><italic>N</italic></bold><sub><italic>id</italic></sub>=(<italic>n</italic><sub><italic>id</italic>1</sub>,⋯,<italic>n</italic><sub><italic>idJ</italic></sub><sub><italic>d</italic></sub>). For SNP <italic>i</italic>, <bold><italic>X</italic></bold><sub><italic>i</italic></sub>=(<bold><italic>X</italic></bold><sub><italic>i</italic>1</sub>,⋯,<bold><italic>X</italic></bold><sub><italic>iD</italic></sub>) and <bold><italic>N</italic></bold><sub><italic>i</italic></sub>=(<bold><italic>N</italic></bold><sub><italic>i</italic>1</sub>,⋯,<bold><italic>N</italic></bold><sub><italic>iD</italic></sub>) contain data from all datasets. The final observed data are <bold><italic>X</italic></bold>=(<bold><italic>X</italic></bold><sub>1</sub>,⋯,<bold><italic>X</italic></bold><sub><italic>I</italic></sub>) and <bold><italic>N</italic></bold>=(<bold><italic>N</italic></bold><sub>1</sub>,⋯,<bold><italic>N</italic></bold><sub><italic>I</italic></sub>) which are the ensemble of data from all SNPs.</p>
      <p>Let <bold><italic>A</italic></bold>=(<italic>a</italic><sub>1</sub>,⋯,<italic>a</italic><sub><italic>I</italic></sub>) be the collection of class membership indictors of all SNPs, and let <bold><italic>B</italic></bold>=(<bold><italic>B</italic></bold><sub>1</sub>,⋯,<bold><italic>B</italic></bold><sub><italic>I</italic></sub>) and <bold><italic>C</italic></bold>=(<bold><italic>C</italic></bold><sub>1</sub>,⋯,<bold><italic>C</italic></bold><sub><italic>I</italic></sub>) be the SR and SN indictors for all SNPs. <bold><italic>A, B</italic></bold> and <bold><italic>C</italic></bold> are the unobserved missing data one wants to infer.</p>
      <p>Organize the probability vectors <bold><italic>V</italic></bold><sub><italic>k</italic></sub>and <bold><italic>W</italic></bold><sub><italic>k</italic></sub> from different classes into two matrices <inline-formula><mml:math id="M2" name="1471-2164-13-681-i2" overflow="scroll"><mml:mfenced><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></inline-formula> and <inline-formula><mml:math id="M3" name="1471-2164-13-681-i3" overflow="scroll"><mml:mfenced><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:mo>×</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></inline-formula>. <bold><italic>V</italic></bold>, <bold><italic>W</italic></bold>, and the probability vector <bold><italic>Π</italic></bold> that describes the class abundance are the unknown model parameters. <italic>K</italic> is assumed to be fixed. The choice of <italic>K</italic> and specification of data generating distributions <italic>Pr</italic>(<italic>n</italic><sub><italic>idj</italic></sub>), <italic>f</italic><sub><italic>idj</italic>0</sub>(<italic>x</italic><sub><italic>idj</italic></sub>), <italic>f</italic><sub><italic>idj</italic>1</sub>(<italic>x</italic><sub><italic>idj</italic></sub>) and <italic>f</italic><sub><italic>idj</italic>2</sub>(<italic>x</italic><sub><italic>idj</italic></sub>) will be discussed later.</p>
      <p>Based on this model, each SNP class <italic>k</italic> (<italic>k</italic>≠0) is associated with two vectors of probabilities <bold><italic>V</italic></bold><sub><italic>k</italic></sub>and <bold><italic>W</italic></bold><sub><italic>k</italic></sub> which characterize the allelic imbalance preferences in different datasets for SNPs belonging to class <italic>k</italic>. For example, if a class has [<bold><italic>V</italic></bold><sub><italic>k</italic></sub>;<bold><italic>W</italic></bold><sub><italic>k</italic></sub>] = [(0.8,0.7,0.1,0.1); (0.1,0.1,0.8,0.1)], then SNPs in this class have high probability to be SR in datasets 1 and 2, and high probability to be SN in dataset 3, but they have low probability to be allele-specific in dataset 4. Since <bold><italic>V</italic></bold><sub><italic>k</italic></sub> and <bold><italic>W</italic></bold><sub><italic>k</italic></sub>are probabilities rather than 0-1 vectors, each class <italic>k</italic> can generate all 3<sup><italic>D</italic></sup> AS configurations. Therefore, SNPs in the same class are not required to have the same AS configuration (e.g., a class can have one SNP with configuration [<italic>SR</italic>,<italic>SR</italic>,<italic>NS</italic>,<italic>NS</italic>] while at the same time another SNP with configuration [<italic>SR</italic>,<italic>NS</italic>,<italic>SR</italic>,<italic>NS</italic>]), although they usually have similar AS configurations because SNPs in the same class are all generated using the same probability vectors. Meanwhile, there are <italic>K</italic> different classes, and each class has a different [<bold><italic>V</italic></bold><sub><italic>k</italic></sub>;<bold><italic>W</italic></bold><sub><italic>k</italic></sub>] which specifies a different preference to generate the skewing configurations. Thus, whereas SNPs in the same class tend to have similar [<bold><italic>B</italic></bold><sub><italic>i</italic></sub>;<bold><italic>C</italic></bold><sub><italic>i</italic></sub>] configurations, SNPs from different classes tend to have very different configurations. Conceptually, this is similar to a model-based clustering analysis in which SNPs are grouped into <italic>K</italic> + 1 clusters based on their [<bold><italic>B</italic></bold><sub><italic>i</italic></sub>;<bold><italic>C</italic></bold><sub><italic>i</italic></sub>] configurations. However, an important difference here is that [<bold><italic>B</italic></bold><sub><italic>i</italic></sub>;<bold><italic>C</italic></bold><sub><italic>i</italic></sub>]s are unknown.</p>
      <p>Our model assumes that [<italic>b</italic><sub><italic>id</italic></sub>;<italic>c</italic><sub><italic>id</italic></sub>]s of the same SNP in different datasets are a priori independent conditional on the class membership <italic>a</italic><sub><italic>i</italic></sub>. However, [<italic>b</italic><sub><italic>id</italic></sub>;<italic>c</italic><sub><italic>id</italic></sub>]s from different datasets are not independent marginally if one integrates out the class label <italic>a</italic><sub><italic>i</italic></sub>. For example, the marginal probability <italic>Pr</italic>([<italic>b</italic><sub><italic>id</italic></sub>;<italic>c</italic><sub><italic>id</italic></sub>]= [1;0])=<inline-formula><mml:math id="M4" name="1471-2164-13-681-i4" overflow="scroll"><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mi>Pr</mml:mi><mml:mo>(</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:mo>[</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mn>0</mml:mn><mml:mo>]</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mi>Pr</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo></mml:math></inline-formula><inline-formula><mml:math id="M5" name="1471-2164-13-681-i5" overflow="scroll"><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Π</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>kd</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. On the other hand, the joint probability <inline-formula><mml:math id="M6" name="1471-2164-13-681-i6" overflow="scroll"><mml:mspace width="0.3em"/><mml:mi>Pr</mml:mi><mml:mo>(</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mspace width="0.3em"/><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.3em"/><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:mspace width="0.3em"/><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>;</mml:mo><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mspace width="0.3em"/><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>)</mml:mo><mml:mspace width="0.3em"/><mml:mo>=</mml:mo><mml:mspace width="0.3em"/><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Π</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>kd</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>, which is clearly different from the product of the marginals <inline-formula><mml:math id="M7" name="1471-2164-13-681-i7" overflow="scroll"><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:mi>Pr</mml:mi><mml:mo>(</mml:mo><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mn>0</mml:mn><mml:mo>]</mml:mo><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>Π</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>kd</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>. This explains why our model can be used to describe the correlation among multiple datasets despite the conditional independence assumption. Intuitively, if one views the model as a clustering analysis of SNPs based on [<bold><italic>B</italic></bold><sub><italic>i</italic></sub>;<bold><italic>C</italic></bold><sub><italic>i</italic></sub>], then each cluster will represent a co-occurrence pattern of allele-specificity across multiple proteins. The marginal correlation among multiple datasets is described by multiple clusters, whereas within each cluster the data in different datasets are generated independently. In real data, a small <italic>K</italic> (i.e., a small number of SNP classes) usually is sufficient to describe the major correlation structure among datasets. Using <bold><italic>Π</italic></bold>, <bold><italic>V</italic></bold> and <bold><italic>W</italic></bold> to describe the correlation among datasets only requires <italic>O</italic>(<italic>KD</italic>) parameters, which is significantly less complex than <italic>O</italic>(3<sup><italic>D</italic></sup>) parameters. At the same time, the iASeq model still provides the flexibility to accommodate all 3<sup><italic>D</italic></sup> possible [<bold><italic>B</italic></bold><sub><italic>i</italic></sub>;<bold><italic>C</italic></bold><sub><italic>i</italic></sub>] configurations as all of them have non-zero probability to occur.</p>
    </sec>
    <sec>
      <title>Data generating distributions</title>
      <p>To fully specify the model, one also needs to specify the data generating distributions <italic>Pr</italic>(<italic>x</italic><sub><italic>idj</italic></sub>,<italic>n</italic><sub><italic>idj</italic></sub>|<italic>b</italic><sub><italic>id</italic></sub>,<italic>c</italic><sub><italic>id</italic></sub>)=<italic>Pr</italic>(<italic>n</italic><sub><italic>idj</italic></sub>)<italic>Pr</italic>(<italic>x</italic><sub><italic>idj</italic></sub>|<italic>n</italic><sub><italic>idj</italic></sub>,<italic>b</italic><sub><italic>id</italic></sub>,<italic>c</italic><sub><italic>id</italic></sub>). The primary goal of iASeq is to infer whether two alleles are different. We assume that information on allele-specificity is only contained in <italic>Pr</italic>(<italic>x</italic><sub><italic>idj</italic></sub>|<italic>n</italic><sub><italic>idj</italic></sub>,<italic>b</italic><sub><italic>id</italic></sub>,<italic>c</italic><sub><italic>id</italic></sub>), and therefore the exact form of <italic>Pr</italic>(<italic>n</italic><sub><italic>idj</italic></sub>), i.e., the marginal probability distribution of the total read count, is irrelevant for our purpose. As such, we mainly focus on modeling the conditional distribution of <italic>x</italic><sub><italic>idj</italic></sub>given <italic>n</italic><sub><italic>idj</italic></sub>, <italic>b</italic><sub><italic>id</italic></sub> and <italic>c</italic><sub><italic>id</italic></sub>, i.e., the three distributions <italic>f</italic><sub><italic>idj</italic>0</sub>(<italic>x</italic>), <italic>f</italic><sub><italic>idj</italic>1</sub>(<italic>x</italic>) and <italic>f</italic><sub><italic>idj</italic>2</sub>(<italic>x</italic>).</p>
      <p>iASeq models these distributions hierarchically in two steps. First, <italic>x</italic><sub><italic>idj</italic></sub> is assumed to follow a binomial distribution <italic>x</italic><sub><italic>idj</italic></sub>|<italic>n</italic><sub><italic>idj</italic></sub>,<italic>p</italic><sub><italic>idj</italic></sub>∼<italic>Bin</italic>(<italic>n</italic><sub><italic>idj</italic></sub>,<italic>p</italic><sub><italic>idj</italic></sub>), where <italic>p</italic><sub><italic>idj</italic></sub> is the probability that a read generated at SNP <italic>i</italic> in sample (<italic>d</italic>,<italic>j</italic>) represents the reference allele. Next, we model <italic>p</italic><sub><italic>idj</italic></sub>depending on the values of <italic>b</italic><sub><italic>id</italic></sub>and <italic>c</italic><sub><italic>id</italic></sub>.</p>
      <p>If <italic>b</italic><sub><italic>id</italic></sub>=0 and <italic>c</italic><sub><italic>id</italic></sub>=0, SNP <italic>i</italic> is NS in dataset <italic>d</italic>. In this case, we assume that <italic>p</italic><sub><italic>idj</italic></sub>follows a Beta distribution <italic>Beta</italic>(<italic>α</italic><sub><italic>dj</italic></sub><italic>β</italic><sub><italic>dj</italic></sub>) with mean <italic>p</italic><sub><italic>dj</italic>0</sub>=<italic>α</italic><sub><italic>dj</italic></sub>/(<italic>α</italic><sub><italic>dj</italic></sub> + <italic>β</italic><sub><italic>dj</italic></sub>). Note that a simpler model for <italic>p</italic><sub><italic>idj</italic></sub> would be to set it to a constant <italic>p</italic><sub><italic>dj</italic>0</sub> which reflects the background ratio of read counts between two alleles. However, previous studies have shown that many background SNPs can have <italic>p</italic><sub><italic>idj</italic></sub> slightly different from the average background <italic>p</italic><sub><italic>dj</italic>0</sub>even though they do not have biologically meaningful allele-specificity [<xref ref-type="bibr" rid="B33">33</xref>]. As a result, a constant <italic>p</italic><sub><italic>dj</italic>0</sub> is not sufficient to describe the background variation. For this reason, we adopt the Beta distribution to describe <italic>p</italic><sub><italic>idj</italic></sub> instead of setting it to a constant (See the blue lines illustrated for <italic>f</italic>(<italic>p</italic><sub><italic>idj</italic></sub>|<italic>b</italic><sub><italic>id</italic></sub>=0,<italic>c</italic><sub><italic>id</italic></sub>=0) in Figure <xref ref-type="fig" rid="F1">1</xref>c). In the ideal world, the mean of the Beta distribution, <italic>p</italic><sub><italic>dj</italic>0</sub>, would be equal to 0.5. However, in reality <italic>p</italic><sub><italic>dj</italic>0</sub>may be slightly different from 0.5 due to various sources of read mapping biases. For example, allowing the same number of mismatches, reads from the reference allele are easier to be mapped back to the reference genome than reads from the non-reference allele. Therefore, in iASeq <italic>p</italic><sub><italic>dj</italic>0</sub>may take values different from 0.5. Indeed, it is determined by the parameters <italic>α</italic><sub><italic>dj</italic></sub> and <italic>β</italic><sub><italic>dj</italic></sub> in the Beta distribution which are estimated from the data using a moment matching approach (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplemental Method S.2). Once estimated, <italic>α</italic><sub><italic>dj</italic></sub>, <italic>β</italic><sub><italic>dj</italic></sub> and <italic>p</italic><sub><italic>dj</italic>0</sub>are treated as fixed and known parameters. Based on the model for <italic>p</italic><sub><italic>idj</italic></sub>, we integrate out all possible values of <italic>p</italic><sub><italic>idj</italic></sub> to obtain the distribution of <italic>x</italic><sub><italic>idj</italic></sub>conditional on <italic>b</italic><sub><italic>id</italic></sub>=0 and <italic>c</italic><sub><italic>id</italic></sub>=0, which is a beta-binomial distribution: </p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <mml:math id="M8" name="1471-2164-13-681-i8" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:mspace width="-14.0pt"/>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>f</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>)</mml:mo>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mi>Pr</mml:mi>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>idj</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>idj</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>id</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>id</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo mathsize="big">∫</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mi>Pr</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>id</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>id</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>)</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mspace width="1em"/>
                  <mml:mo>×</mml:mo>
                  <mml:mi>f</mml:mi>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>idj</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>id</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>id</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mi>d</mml:mi>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>idj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>idj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>B</mml:mi>
                      <mml:mfenced open="(" close=")">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>dj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>β</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>dj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mspace width="0.3em"/>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo mathsize="big">∫</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mspace width="0.3em"/>
                  <mml:mspace width="0.3em"/>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>idj</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mspace width="0.3em"/>
                      <mml:mo>+</mml:mo>
                      <mml:mspace width="0.3em"/>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>α</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>dj</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mspace width="0.3em"/>
                      <mml:mo>−</mml:mo>
                      <mml:mspace width="0.3em"/>
                      <mml:mi>p</mml:mi>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>idj</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>idj</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>β</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>dj</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>−</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mspace width="0.3em"/>
                  <mml:mi>dp</mml:mi>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>idj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>idj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mi>B</mml:mi>
                      <mml:mfenced open="(" close=")">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>idj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>+</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>dj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>idj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>idj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>+</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>β</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>dj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>B</mml:mi>
                      <mml:mfenced open="(" close=")">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>α</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>dj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>β</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>dj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>Here <inline-formula><mml:math id="M9" name="1471-2164-13-681-i9" overflow="scroll"><mml:mfenced><mml:mrow><mml:msubsup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math></inline-formula> is the binomial coefficients “<italic>n</italic> choose <italic>k</italic>”, and <italic>B</italic>(<italic>.</italic><italic>.</italic>) is the beta function.</p>
      <p>If <italic>b</italic><sub><italic>id</italic></sub>=1 and <italic>c</italic><sub><italic>id</italic></sub>=0, SNP <italic>i</italic> is SR in dataset <italic>d</italic>. In this case, we assume that <italic>p</italic><sub><italic>idj</italic></sub> follows a uniform distribution <italic>U</italic>[<italic>p</italic><sub><italic>dj</italic>0</sub>,1](See the dark blue lines illustrated for <italic>f</italic>(<italic>p</italic><sub><italic>idj</italic></sub>|<italic>b</italic><sub><italic>id</italic></sub>=1,<italic>c</italic><sub><italic>id</italic></sub>=0) in Figure <xref ref-type="fig" rid="F1">1</xref>c). Here <italic>p</italic><sub><italic>dj</italic>0</sub>=<italic>α</italic><sub><italic>dj</italic></sub>/(<italic>α</italic><sub><italic>dj</italic></sub> + <italic>β</italic><sub><italic>dj</italic></sub>) is defined as above. After integrating out <italic>p</italic><sub><italic>idj</italic></sub>, the distribution of <italic>x</italic><sub><italic>idj</italic></sub>conditional on <italic>b</italic><sub><italic>id</italic></sub>=1 and <italic>c</italic><sub><italic>id</italic></sub>=0 is </p>
      <p>
        <disp-formula id="bmcM2">
          <label>(2)</label>
          <mml:math id="M10" name="1471-2164-13-681-i10" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:mspace width="-14.0pt"/>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>f</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>)</mml:mo>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mi>Pr</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>id</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>id</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>)</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo mathsize="big">∫</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mi>Pr</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>id</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>id</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>)</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mspace width="1em"/>
                  <mml:mo>×</mml:mo>
                  <mml:mi>f</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>id</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>id</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>)</mml:mo>
                  <mml:mi>d</mml:mi>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>idj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>idj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>dj</mml:mi>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo mathsize="big">∫</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>dj</mml:mi>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>idj</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msup>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:mi>p</mml:mi>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>idj</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>idj</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mi>dp</mml:mi>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>If <italic>b</italic><sub><italic>id</italic></sub>=0 and <italic>c</italic><sub><italic>id</italic></sub>=1, SNP <italic>i</italic> is SN in dataset <italic>d</italic>, and we assume that <italic>p</italic><sub><italic>idj</italic></sub> follows a uniform distribution <italic>U</italic>[0,<italic>p</italic><sub><italic>dj</italic>0</sub>] (See the light blue lines illustrated for <italic>f</italic>(<italic>p</italic><sub><italic>idj</italic></sub>|<italic>b</italic><sub><italic>id</italic></sub>=0,<italic>c</italic><sub><italic>id</italic></sub>=1) in Figure <xref ref-type="fig" rid="F1">1</xref>c). After integrating out <italic>p</italic><sub><italic>idj</italic></sub>, the distribution of <italic>x</italic><sub><italic>idj</italic></sub>conditional on <italic>b</italic><sub><italic>id</italic></sub>=0 and <italic>c</italic><sub><italic>id</italic></sub>=1 is </p>
      <p>
        <disp-formula id="bmcM3">
          <label>(3)</label>
          <mml:math id="M11" name="1471-2164-13-681-i11" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:mspace width="-14.0pt"/>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>f</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>)</mml:mo>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mi>Pr</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>id</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>id</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>)</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo mathsize="big">∫</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mi>f</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>n</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>id</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>id</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>)</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mspace width="1em"/>
                  <mml:mo>×</mml:mo>
                  <mml:mi>f</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>b</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>id</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>id</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>)</mml:mo>
                  <mml:mi>d</mml:mi>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>idj</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>C</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>idj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>x</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>idj</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>dj</mml:mi>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo mathsize="big">∫</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>p</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>dj</mml:mi>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>p</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>idj</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msup>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:mi>p</mml:mi>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>idj</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>idj</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mi>dp</mml:mi>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
    </sec>
    <sec>
      <title>Joint probabilities and model fitting</title>
      <p>Based on the model above, the complete data likelihood can be derived as: </p>
      <p>
        <disp-formula id="bmcM4">
          <label>(4)</label>
          <mml:math id="M12" name="1471-2164-13-681-i12" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:mspace width="-14.0pt"/>
                  <mml:mi>Pr</mml:mi>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>(</mml:mo>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>X</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>A</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>B</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>C</mml:mi>
                  </mml:mstyle>
                  <mml:mo>|</mml:mo>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>Π</mml:mi>
                  </mml:mstyle>
                  <mml:mo>,</mml:mo>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>V</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>W</mml:mi>
                  </mml:mstyle>
                  <mml:mo>)</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mi>Pr</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi mathvariant="bold-italic">N</mml:mi>
                  <mml:mo>)</mml:mo>
                  <mml:mi>Pr</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>X</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>A</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>B</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>C</mml:mi>
                  </mml:mstyle>
                  <mml:mo>|</mml:mo>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>N</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>Π</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>V</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>W</mml:mi>
                  </mml:mstyle>
                  <mml:mo>)</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mi>Pr</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi mathvariant="bold-italic">N</mml:mi>
                  <mml:mo>)</mml:mo>
                  <mml:munderover accentunder="false" accent="false">
                    <mml:mrow>
                      <mml:mo mathsize="big">∏</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>I</mml:mi>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mi>Pr</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">X</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>a</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">B</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">C</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>|</mml:mo>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">N</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:mspace width="0.3em"/>
                  <mml:mstyle mathvariant="bold-italic">
                    <mml:mi>Π</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:mi>V</mml:mi>
                    <mml:mspace width="0.3em"/>
                    <mml:mo>,</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:mi>W</mml:mi>
                  </mml:mstyle>
                  <mml:mo>)</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>Define <inline-formula><mml:math id="M13" name="1471-2164-13-681-i13" overflow="scroll"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>idj</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>idj</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="M14" name="1471-2164-13-681-i14" overflow="scroll"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>idj</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>idj</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="M15" name="1471-2164-13-681-i15" overflow="scroll"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi>idj</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>idj</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>. Define <italic>δ</italic>(<italic>.</italic>) to be an indicator function. <italic>δ</italic>(<italic>.</italic>)=1 if its argument is true, and <italic>δ</italic>(<italic>.</italic>)=0 otherwise. We have </p>
      <p>
        <disp-formula id="bmcM5">
          <label>(5)</label>
          <mml:math id="M16" name="1471-2164-13-681-i16" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mspace width="-14.0pt"/>
                  <mml:mi>Pr</mml:mi>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">X</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">B</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">C</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>Π</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>V</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>W</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mspace width="-14.0pt"/>
                  <mml:mo>=</mml:mo>
                  <mml:mi>Pr</mml:mi>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>|</mml:mo>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>Π</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mspace width="0.3em"/>
                  <mml:munderover accentunder="false" accent="false">
                    <mml:mrow>
                      <mml:mo mathsize="big">∏</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>d</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mspace width="0.3em"/>
                  <mml:mi>Pr</mml:mi>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>id</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>id</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="0.3em"/>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>V</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mspace width="0.3em"/>
                        <mml:mi>W</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mspace width="0.3em"/>
                  <mml:mi>Pr</mml:mi>
                  <mml:mspace width="0.3em"/>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">X</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>id</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>id</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>id</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>id</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mspace width="-14.0pt"/>
                  <mml:mo>=</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mfenced open="{" close="}">
                        <mml:mrow>
                          <mml:mspace width="0.3em"/>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>Π</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>0</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                          <mml:munderover accentunder="false" accent="false">
                            <mml:mrow>
                              <mml:mo mathsize="big">∏</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>d</mml:mi>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>D</mml:mi>
                            </mml:mrow>
                          </mml:munderover>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>L</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>id</mml:mi>
                              <mml:mn>0</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>δ</mml:mi>
                      <mml:mfenced open="(" close=")">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>a</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>=</mml:mo>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                  </mml:msup>
                  <mml:munderover accentunder="false" accent="false">
                    <mml:mrow>
                      <mml:mo mathsize="big">∏</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>K</mml:mi>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mfenced open="{">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>Π</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:munderover accentunder="false" accent="false">
                        <mml:mrow>
                          <mml:mo mathsize="big">∏</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>d</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>D</mml:mi>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mfenced open="[" close="]">
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>v</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>kd</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>L</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>id</mml:mi>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mfenced>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>b</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>id</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mspace width="0.3em"/>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mfenced open="[" close="]">
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>w</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>kd</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>L</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>id</mml:mi>
                                  <mml:mn>2</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mfenced>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>c</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>id</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mspace width="1em"/>
                  <mml:mo>×</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mfenced close="}">
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mfenced open="[" close="]">
                                <mml:mrow>
                                  <mml:mo>(</mml:mo>
                                  <mml:mn>1</mml:mn>
                                  <mml:mo>−</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>v</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>kd</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>−</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>w</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>kd</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>)</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>L</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>id</mml:mi>
                                      <mml:mn>0</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mrow>
                              </mml:mfenced>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>b</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>id</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>c</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>id</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>δ</mml:mi>
                      <mml:mfenced open="(" close=")">
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>a</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>=</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>To infer <bold><italic>Π</italic></bold>, <bold><italic>V</italic></bold> and <bold><italic>W</italic></bold>, we employ a Bayesian approach by imposing a Dirichlet prior <italic>D</italic>(<italic>η</italic>,⋯,<italic>η</italic>) on <bold><italic>Π</italic></bold> and imposing independent Dirichlet priors <italic>D</italic>(<italic>η</italic>,<italic>η</italic>,<italic>η</italic>) on all triplets (<italic>v</italic><sub><italic>kd</italic></sub>,<italic>w</italic><sub><italic>kd</italic></sub>,1−<italic>v</italic><sub><italic>kd</italic></sub>−<italic>w</italic><sub><italic>kd</italic></sub>). The joint posterior distribution of unknown parameters and indicators given the observed data is: </p>
      <p>
        <disp-formula id="bmcM6">
          <label>(6)</label>
          <mml:math id="M17" name="1471-2164-13-681-i17" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:mspace width="-14.0pt"/>
                  <mml:mi>Pr</mml:mi>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>A</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mspace width="0.3em"/>
                        <mml:mi>B</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mspace width="0.3em"/>
                        <mml:mi>C</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mspace width="0.3em"/>
                        <mml:mi>Π</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mspace width="0.3em"/>
                        <mml:mi>V</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mspace width="0.3em"/>
                        <mml:mi>W</mml:mi>
                      </mml:mstyle>
                      <mml:mo>|</mml:mo>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>X</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>N</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mo>∝</mml:mo>
                  <mml:mi>Pr</mml:mi>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>X</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>N</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>A</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>B</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>C</mml:mi>
                      </mml:mstyle>
                      <mml:mo>|</mml:mo>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>Π</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>V</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>W</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mi>f</mml:mi>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>Π</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>V</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>W</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mo>∝</mml:mo>
                  <mml:munderover accentunder="false" accent="false">
                    <mml:mrow>
                      <mml:mo mathsize="big">∏</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>I</mml:mi>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mspace width="0.3em"/>
                  <mml:mi>Pr</mml:mi>
                  <mml:mspace width="0.3em"/>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">X</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">B</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="0.3em"/>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">C</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="0.3em"/>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>Π</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mspace width="0.3em"/>
                        <mml:mi>V</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mspace width="0.3em"/>
                        <mml:mi>W</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mfenced open="{" close="}">
                    <mml:mrow>
                      <mml:munderover accentunder="false" accent="false">
                        <mml:mrow>
                          <mml:mo mathsize="big">∏</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>K</mml:mi>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>Π</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>η</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mspace width="1em"/>
                  <mml:mo>×</mml:mo>
                  <mml:mfenced open="{" close="}">
                    <mml:mrow>
                      <mml:munderover accentunder="false" accent="false">
                        <mml:mrow>
                          <mml:mo mathsize="big">∏</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>K</mml:mi>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:munderover accentunder="false" accent="false">
                        <mml:mrow>
                          <mml:mo mathsize="big">∏</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>d</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>D</mml:mi>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>v</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>kd</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>η</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mspace width="0.3em"/>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>w</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>kd</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>η</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mfenced open="(" close=")">
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>v</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>kd</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>w</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>kd</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:mfenced>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>η</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>Conditional on the observed data, <italic>Pr</italic>(<bold><italic>N</italic></bold>) is a constant that does not contain parameters of interest, therefore it is absorbed into a proportionality constant not shown in the formula above. Using this joint posterior, an EM algorithm can be derived to search for posterior mode <inline-formula><mml:math id="M18" name="1471-2164-13-681-i18" overflow="scroll"><mml:mo>(</mml:mo><mml:mover accent="true"><mml:mrow><mml:mstyle mathvariant="bold-italic"><mml:mi>Π</mml:mi></mml:mstyle></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">V</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math></inline-formula> of <inline-formula><mml:math id="M19" name="1471-2164-13-681-i19" overflow="scroll"><mml:mi>Pr</mml:mi><mml:mo>(</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>Π</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow></mml:munder><mml:mi>Pr</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">C</mml:mi><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>Π</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> in which the missing indictors <bold><italic>A</italic></bold>, <bold><italic>B</italic></bold> and <bold><italic>C</italic></bold> are all integrated out (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplemental Method S.4).</p>
      <p>For the Dirichlet prior, we use <italic>η</italic>=2 (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplemental Method S.3 for a discussion on the choice of parameter for the Dirichlet prior). In the EM algorithm, we assume that the class number <italic>K</italic> is given. In order to choose the optimal <italic>K</italic>, we run the algorithm multiple times using different values of <italic>K</italic>. We choose the best <italic>K</italic> using the Bayesian Information Criterion (BIC) (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplemental Method S.5).</p>
    </sec>
    <sec>
      <title>Statistical inference of allele-specificity</title>
      <p>The estimated <bold><italic>Π</italic></bold>, <bold><italic>V</italic></bold> and <bold><italic>W</italic></bold> can describe the correlation patterns of allele-specificity among datasets. Given <bold><italic>Π</italic></bold>, <bold><italic>V</italic></bold> and <bold><italic>W</italic></bold>, one can infer whether SNP <italic>i</italic> belongs to class <italic>k</italic> based on the posterior probability <italic>Pr</italic>(<italic>a</italic><sub><italic>i</italic></sub> = <italic>k</italic>|<bold><italic>X</italic></bold><sub><italic>i</italic></sub>,<bold><italic>N</italic></bold><sub><italic>i</italic></sub>,<bold><italic>Π</italic></bold>,<bold><italic>V</italic></bold>,<bold><italic>W</italic></bold>) (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplemental Method S.4 equations S.12-S.13). One can then infer whether each SNP <italic>i</italic> is skewed in each individual dataset <italic>d</italic> based on the posterior probability <inline-formula><mml:math id="M20" name="1471-2164-13-681-i20" overflow="scroll"><mml:mi>Pr</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold-italic"><mml:mi>Π</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">W</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mi>Pr</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">N</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math></inline-formula><bold><italic>Π</italic></bold>,<bold><italic>V</italic></bold>,<bold><italic>W</italic></bold>) after summing over all possible values of <italic>a</italic><sub><italic>i</italic></sub>(see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplemental Method S.4 equation S.14). Note that </p>
      <p>
        <disp-formula id="bmcM7">
          <label>(7)</label>
          <mml:math id="M21" name="1471-2164-13-681-i21" overflow="scroll">
            <mml:mspace width="-15.0pt"/>
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>Pr</mml:mi>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>id</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="0.3em"/>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>id</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">X</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="0.3em"/>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="0.3em"/>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>Π</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mspace width="0.3em"/>
                        <mml:mi>V</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mspace width="0.3em"/>
                        <mml:mi>W</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>=</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mo>∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mspace width="0.3em"/>
                  <mml:mi>Pr</mml:mi>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mspace width="0.3em"/>
                      <mml:mo>=</mml:mo>
                      <mml:mspace width="0.3em"/>
                      <mml:mi>k</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">X</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="0.3em"/>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mspace width="0.3em"/>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>Π</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mspace width="0.3em"/>
                        <mml:mi>V</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mspace width="0.3em"/>
                        <mml:mi>W</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mi>Pr</mml:mi>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>b</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>id</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>c</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>id</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>|</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>a</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mspace width="0.3em"/>
                      <mml:mo>=</mml:mo>
                      <mml:mspace width="0.3em"/>
                      <mml:mi>k</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">X</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi mathvariant="bold-italic">N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mstyle mathvariant="bold-italic">
                        <mml:mi>Π</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>V</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>W</mml:mi>
                      </mml:mstyle>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>Define </p>
      <p>
        <disp-formula id="bmcM8">
          <label>(8)</label>
          <mml:math id="M22" name="1471-2164-13-681-i22" overflow="scroll">
            <mml:mtable columnalign="left">
              <mml:mtr>
                <mml:mtd>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mover accent="true">
                        <mml:mrow>
                          <mml:mi>P</mml:mi>
                        </mml:mrow>
                        <mml:mo>~</mml:mo>
                      </mml:mover>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>id</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mi>max</mml:mi>
                  <mml:mfenced open="{">
                    <mml:mrow>
                      <mml:mfenced>
                        <mml:mrow>
                          <mml:mi>Pr</mml:mi>
                          <mml:mfenced open="(" close=")">
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>b</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>id</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>c</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>id</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>=</mml:mo>
                              <mml:mn>0</mml:mn>
                              <mml:mo>|</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi mathvariant="bold-italic">X</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi mathvariant="bold-italic">N</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mi>Π</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>V</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>W</mml:mi>
                              </mml:mstyle>
                            </mml:mrow>
                          </mml:mfenced>
                          <mml:mo>,</mml:mo>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mspace width="6em"/>
                  <mml:mfenced close="}">
                    <mml:mrow>
                      <mml:mfenced>
                        <mml:mrow>
                          <mml:mi>Pr</mml:mi>
                          <mml:mfenced open="(" close=")">
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>b</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>id</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>=</mml:mo>
                              <mml:mn>0</mml:mn>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>c</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>id</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>=</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>|</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi mathvariant="bold-italic">X</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi mathvariant="bold-italic">N</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:mstyle mathvariant="bold-italic">
                                <mml:mi>Π</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>V</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>W</mml:mi>
                              </mml:mstyle>
                            </mml:mrow>
                          </mml:mfenced>
                        </mml:mrow>
                      </mml:mfenced>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>Using <inline-formula><mml:math id="M23" name="1471-2164-13-681-i23" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, SNPs can be rank ordered for biologists to choose candidates to design follow-up studies. For each top ranked SNP, one can determine its skewing direction by comparing <italic>Pr</italic>(<italic>b</italic><sub><italic>id</italic></sub>=1,<italic>c</italic><sub><italic>id</italic></sub>=0|<bold><italic>X</italic></bold><sub><italic>i</italic></sub>,<bold><italic>N</italic></bold><sub><italic>i</italic></sub>,<bold><italic>Π</italic></bold>,<bold><italic>V</italic></bold>,<bold><italic>W</italic></bold>) and <italic>Pr</italic>(<italic>b</italic><sub><italic>id</italic></sub>=0,<italic>c</italic><sub><italic>id</italic></sub>=1|<bold><italic>X</italic></bold><sub><italic>i</italic></sub>,<bold><italic>N</italic></bold><sub><italic>i</italic></sub>,<bold><italic>Π</italic></bold>,<bold><italic>V</italic></bold>,<bold><italic>W</italic></bold>). The one with the larger value determines the direction. Finally, the posterior probabilities of top <italic>N</italic> SNPs can be converted to an estimate of false discovery rate (FDR) using <inline-formula><mml:math id="M24" name="1471-2164-13-681-i24" overflow="scroll"><mml:mi>FDR</mml:mi><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>top</mml:mi><mml:mspace width="2.22198pt"/><mml:mi>N</mml:mi><mml:mspace width="2.22198pt"/><mml:mi>SNPs</mml:mi></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mi>N</mml:mi></mml:math></inline-formula>.</p>
      <p>Formula 7 shows that two types of information contribute to <italic>Pr</italic>(<italic>b</italic><sub><italic>id</italic></sub>,<italic>c</italic><sub><italic>id</italic></sub>|<bold><italic>X</italic></bold><sub><italic>i</italic></sub>,<bold><italic>N</italic></bold><sub><italic>i</italic></sub>,<bold><italic>Π</italic></bold>,<bold><italic>V</italic></bold>,<bold><italic>W</italic></bold>): (1) <italic>Pr</italic>(<italic>a</italic><sub><italic>i</italic></sub>=<italic>k</italic>|<bold><italic>X</italic></bold><sub><italic>i</italic></sub>,<bold><italic>N</italic></bold><sub><italic>i</italic></sub>,<bold><italic>Π</italic></bold>,<bold><italic>V</italic></bold>,<bold><italic>W</italic></bold>), which is determined using information from all <italic>D</italic> datasets, and (2) <italic>Pr</italic>(<italic>b</italic><sub><italic>id</italic></sub>,<italic>c</italic><sub><italic>id</italic></sub>|<italic>a</italic><sub><italic>i</italic></sub>=<italic>k</italic>,<bold><italic>X</italic></bold><sub><italic>i</italic></sub>,<bold><italic>N</italic></bold><sub><italic>i</italic></sub>,<bold><italic>Π</italic></bold>,<bold><italic>V</italic></bold>,<bold><italic>W</italic></bold>), which only uses information specific to dataset <italic>d</italic> conditional on <bold><italic>Π</italic></bold>, <bold><italic>V</italic></bold> and <bold><italic>W</italic></bold>. Thus for each particular dataset <italic>d</italic>, the dataset-specific information is weighted by information obtained from other datasets to determine the SNP ranking. Intuitively, if allelic imbalance in two datasets are correlated, then observing an AS event in one dataset will suggest that a relatively weak skewing event observed at the same SNP in the other dataset is very likely to be a true AS event. In contrast, if no AS event is observed in one dataset, then a relatively weak skewing event observed at the same SNP in the other dataset is likely to be a false positive. This is the underlying nature of using <italic>Pr</italic>(<italic>a</italic><sub><italic>i</italic></sub>=<italic>k</italic>|<bold><italic>X</italic></bold><sub><italic>i</italic></sub>,<bold><italic>N</italic></bold><sub><italic>i</italic></sub>,<bold><italic>Π</italic></bold>,<bold><italic>V</italic></bold>,<bold><italic>W</italic></bold>) to re-weigh information in <italic>Pr</italic>(<italic>b</italic><sub><italic>id</italic></sub>,<italic>c</italic><sub><italic>id</italic></sub>|<italic>a</italic><sub><italic>i</italic></sub>=<italic>k</italic>,<bold><italic>X</italic></bold><sub><italic>i</italic></sub>,<bold><italic>N</italic></bold><sub><italic>i</italic></sub>,<bold><italic>Π</italic></bold>,<bold><italic>V</italic></bold>,<bold><italic>W</italic></bold>), and it provides the foundation for improving SNP ranking by borrowing information across datasets. In real applications, <bold><italic>Π</italic></bold>, <bold><italic>V</italic></bold>,<bold><italic>W</italic></bold> are unknown, and they are replaced by the posterior mode obtained from the EM algorithm.</p>
    </sec>
  </sec>
  <sec sec-type="results">
    <title>Results</title>
    <sec>
      <title>GM12878 data and preprocessing</title>
      <p>We collected 40 ENCODE [<xref ref-type="bibr" rid="B36">36</xref>] ChIP-seq datasets with a total of 77 samples together with a genomic DNA sample in GM12878 lymphoblastoid cells (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: Table S1). GM12878 is a female and is one of the most extensively studied cell lines in ENCODE. Within each dataset, the number of replicate samples varied from 1 to 3. We downloaded the raw sequence reads of all 78 samples and mapped them to human genome (hg18) (see details in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>). We removed repeated sequences from the ChIP-seq datasets to avoid PCR duplicates, which may skew the determination of allelic biases. In other words, if multiple reads have exactly the same sequence, only one copy is retained. We obtained the genotype data for GM12878 from [<xref ref-type="bibr" rid="B37">37</xref>].</p>
      <p>As previously described in [<xref ref-type="bibr" rid="B31">31</xref>], there are two different types of read mapping biases that may affect the analysis of AS events: the reference bias and the inherent bias. The reference bias often occurs when one maps sequence reads to a reference genome. If one allows the same number of mismatches in the alignment, a read from the non-reference allele is less likely to be mapped back to the reference genome compared to a read from the reference allele, since the non-reference read has one more mismatch to the reference genome. This phenomenon is known as the reference bias. This type of bias, if it exists, is automatically taken care of by the iASeq model through the parameter <italic>p</italic><sub><italic>dj</italic>0</sub> which models the background skewing probability and is estimated using all reads mapped to heterozygote SNPs in each sample. If there is reference mapping bias, <italic>p</italic><sub><italic>dj</italic>0</sub>will take a value different from 0.5 to adjust for the bias. One may remove reference bias before the analysis by masking SNPs in the reference genome during the alignment or by aligning reads to a diploid personal genome. This situation will also be automatically recognized by iASeq through the estimation of <italic>p</italic><sub><italic>dj</italic>0</sub> from the data (if there is no bias, <italic>p</italic><sub><italic>dj</italic>0</sub>=0<italic>.</italic>5). Therefore, regardless of whether the reference bias has been removed from the data in the preprocessing or not, the iASeq model is able to automatically handle it and adjust the inference accordingly.</p>
      <p>The intrinsic bias is a different type of bias. As shown by [<xref ref-type="bibr" rid="B31">31</xref>], even if the reference bias is removed (e.g., by masking SNPs in the reference genome), the inherent bias still exists. For example, suppose sequence 1 (e.g., xxxAxxx) and sequence 2(e.g., xxxTxxx) are two reads that differ only in one position (i.e., A/T). It is possible that sequence 1 is easier to be mapped back to its correct location in the genome than sequence 2 if the second sequence has many repeats in the genome. This bias reflects the inherent characteristics of the genome and cannot be removed by masking variants in the reference genome or by mapping reads to a diploid personal genome. In the above example, masking A and T in the original reads is also not a solution, since a priori one does not know which position in a read corresponds to a SNP position and therefore should be masked without first aligning the read to the genome. When a heterozygote SNP has inherent bias, one allele will have higher read counts than the other even if the two alleles have the same binding level. To avoid this bias, we used the approach described in [<xref ref-type="bibr" rid="B22">22</xref>,<xref ref-type="bibr" rid="B31">31</xref>] to remove SNPs with the inherent bias.</p>
      <p>We began with 1,704,166 heterozygote SNPs and filtered out 149,996 (8.8%) SNPs with inherent bias. Next, we eliminated SNPs that were not bound by any TF or associated with any HM in any dataset (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplemental Methods S.1.1, S.1.2 and Additional file <xref ref-type="supplementary-material" rid="S3">3</xref>: Table S2 for details). After applying these filters, 94,519 heterozygote SNPs remained. These 94,519 SNPs were then analyzed by iASeq.</p>
    </sec>
    <sec>
      <title>A simulation study</title>
      <p>Before we apply iASeq to the real data, we first tested its performance in simulations that took into account real data characteristics. Our simulations kept the same design as the real GM12878 ChIP-seq data, with the same number of datasets and the same number of replicates within each dataset, except that the genomic DNA sample was not used here since we knew the truth in the simulations and did not need genomic DNA as a control for potential bias. To create the simulation data, we first applied iASeq to the real GM12878 data to identify 86,353 SNPs that were not skewed in any dataset using <italic>Pr</italic>(<italic>a</italic><sub><italic>i</italic></sub>=0|<bold><italic>X</italic></bold><sub><italic>i</italic></sub>,<bold><italic>N</italic></bold><sub><italic>i</italic></sub>,<bold><italic>Π</italic></bold>,<bold><italic>V</italic></bold>,<bold><italic>W</italic></bold>)&gt;0<italic>.</italic>5 as cutoff. To mimic the real background noise, these SNPs were resampled by a bootstrap procedure to create the background SNPs in the simulations, and we kept the read counts (<italic>x</italic><sub><italic>idj</italic></sub>,<italic>n</italic><sub><italic>idj</italic></sub>) of each background SNP as is in the simulated data. Next, we simulated ASB SNPs and added them to the background. Simulations were carried out under two different scenarios (Figure <xref ref-type="fig" rid="F2">2</xref>). </p>
      <p>● Scenario 1: Two types of ASB SNPs (classes 1 and 2) were created in addition to the background SNPs (class 0). The SNP number for class 0, 1, and 2 was 85,069, 4,725 and 4,725 respectively. Thus the true <italic>Π</italic><sub><italic>k</italic></sub>for the three classes was 0.90, 0.05 and 0.05 respectively. SNPs in class 1 were SR in datasets 1 to 30 (i.e., their <italic>b</italic><sub><italic>id</italic></sub>=1 for <italic>d</italic>=1,⋯,30). SNPs in class 2 were SN in datasets 1 to 30 (i.e., <italic>c</italic><sub><italic>id</italic></sub>=1 for <italic>d</italic>=1,⋯,30). In datasets 31 to 40, no SNPs had allelic imbalance. Class 2 can be viewed as the mirror image of class 1. This symmetric design reflects the symmetry of allele-specificity, that is, the skewing to the reference allele and to the non-reference allele is approximately symmetric. The class abundance (0.90,0.05,0.05) roughly matched the abundance observed in the analysis of real GM12878 data.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Simulation design and patterns discovered by iASeq. (a)</bold> The true ASB patterns in simulation 1. Two patterns were simulated in addition to the background pattern. The two non-background patterns are shown. Each pattern has 4725 SNPs. Each row in the plot represents a SNP class, and each column represents a dataset. Black means skewed, and white means not skewed. <bold>(b)</bold> The BIC values for different class number <italic>K</italic> in simulation 1. The BIC achieves the minimum at <italic>K</italic>=2. <bold>(c)</bold> Patterns discovered by iASeq in simulation 1. The plot shows the estimated <bold><italic>V</italic></bold> and <bold><italic>W</italic></bold> when <italic>K</italic>=2. Each row corresponds to a class. Each column represents a dataset. The color in the cell (<italic>k</italic>,<italic>d</italic>) demonstrates the estimated SR or SN probability in class <italic>k</italic> and dataset <italic>d</italic>. From white to dark, the probability increases from 0 to 1. The numbers shown under <italic>Π</italic>are the estimated number of SNPs in each class (i.e., <inline-formula><mml:math id="M25" name="1471-2164-13-681-i25" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo></mml:math></inline-formula> the total number of SNPs). The numbers shown under <italic>a</italic><sub><italic>i</italic></sub>are the number of SNPs identified for the corresponding class using the posterior probability <italic>Pr</italic>(<italic>a</italic><sub><italic>i</italic></sub>=<italic>k</italic>|<bold><italic>X</italic></bold><sub><italic>i</italic></sub>,<bold><italic>N</italic></bold><sub><italic>i</italic></sub>,<bold><italic>Π</italic></bold>,<bold><italic>V</italic></bold>,<bold><italic>W</italic></bold>)&gt;0<italic>.</italic>9 as cutoff. <bold>(d)</bold> The true ASB patterns in simulation 2. Four patterns were simulated in addition to the background pattern. The four non-background patterns are shown. Each pattern has 2362 SNPs. <bold>(e)</bold> The BIC values for different class number <italic>K</italic> in simulation 2. The BIC achieves the minimum at <italic>K</italic>=4. <bold>(f)</bold> The patterns discovered by iASeq in simulation 2.</p>
        </caption>
        <graphic xlink:href="1471-2164-13-681-2"/>
      </fig>
      <p>● Scenario 2: Four correlation patterns (classes 1-4) were created in addition to the background class (class 0). Class 1 and class 2 were the same as in simulation 1. Classes 3 and 4 were two new patterns. SNPs in class 3 were SR in datasets 21-40, and SN in datasets 1-10. Class 4 was the mirror image of class 3. The abundance of the classes 0 to 4 was (0.90,0.025,0.025,0.025,0.025).</p>
      <p>Given the simulated [<bold><italic>B</italic></bold><sub><italic>i</italic></sub>;<bold><italic>C</italic></bold><sub><italic>i</italic></sub>] configurations, we then simulated the read count data for ASB SNPs as described in detail in Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplemental Methods S.6. Simulations done in this way was able to keep the major characteristics of real data while allowing us to benchmark the performance of different methods since we knew the truth.</p>
      <p>We applied iASeq to both simulations. In both cases, iASeq was able to identify the correct number of SNP classes using BIC (Figures <xref ref-type="fig" rid="F2">2</xref>a,b,d,e). Figures <xref ref-type="fig" rid="F2">2</xref>c and <xref ref-type="fig" rid="F2">2</xref>f show that the ASB patterns reported by iASeq matched the true patterns well. In order to test whether iASeq can improve the statistical power of detecting SNPs with allelic imbalance, we compared the SNP ranking provided by iASeq with rankings provided by five other methods that analyze each dataset separately (Figure <xref ref-type="fig" rid="F3">3</xref>). In iASeq, SNPs were ranked in each dataset <italic>d</italic> according to the posterior probability <inline-formula><mml:math id="M26" name="1471-2164-13-681-i26" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> defined by Formula 8. Since we know the truth, we can count how many of the top <italic>N</italic> SNPs were true positives. Here the true positives were defined as SNPs that were truly allele-specific and also had the skewing direction correctly inferred. The five single-dataset based methods for ranking SNPs include a <italic>deviation statistic d</italic>, <italic>naive z statistic</italic>, <italic>naive Bayes statistic</italic>, <italic>empirical Bayes statistic</italic> and <italic>single dataset EM</italic>. These methods were applied to each individual dataset. For each dataset <italic>d</italic>, we merged data from all replicates to obtain <inline-formula><mml:math id="M27" name="1471-2164-13-681-i27" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>idj</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M28" name="1471-2164-13-681-i28" overflow="scroll"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>J</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>idj</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. We then computed the statistics used for SNP ranking as described below. </p>
      <p>1. <italic>Deviation statistic (d)</italic>: SNPs were ranked based on |<italic>x</italic><sub><italic>id</italic></sub>/<italic>n</italic><sub><italic>id</italic></sub>−<italic>p</italic><sub><italic>d</italic>0</sub>|. Here we estimated <inline-formula><mml:math id="M29" name="1471-2164-13-681-i29" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mo>′</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula>, where <italic>I</italic><sup><italic>′</italic></sup>is the number of SNPs for which <italic>n</italic><sub><italic>id</italic></sub>≠0.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>The Receiver Operating Characteristic (ROC) curves for simulations. (a)-(c)</bold> We plot the number of true allele-specific SNPs (i.e., true positives, TP) among the top <italic>q</italic> ranked SNPs in each dataset against the rank cutoff <italic>q</italic>. Results for different methods in three representative datasets in simulation 1 are shown. Results in all other datasets were similar. <bold>(d)</bold> For each ranking method and each dataset, we computed the area under the ROC curve (AUC) using the 2000 top ranked SNPs. dAUC, the proportion of improvement of AUC brought by iASeq over the best AUC obtained from the single-dataset based methods, was computed for each dataset. <italic>dAUC</italic>&gt;0 means iASeq brings improvement. The distribution of dAUC in all 40 datasets is shown for simulation 1. <bold>(e)</bold>-<bold>(g)</bold> Results in three representative datasets from simulation 2. Results in all other datasets were similar. <bold>(h)</bold> The distribution of dAUC in all 40 datasets is shown for simulation 2.</p>
        </caption>
        <graphic xlink:href="1471-2164-13-681-3"/>
      </fig>
      <p>2. <italic>Naive z statistic (z)</italic>: SNPs were ranked based on <inline-formula><mml:math id="M30" name="1471-2164-13-681-i30" overflow="scroll"><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>∗</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:math></inline-formula>. Here <italic>p</italic><sub><italic>d</italic>0</sub>was estimated as in the <italic>deviation statistic d</italic>.</p>
      <p>3. <italic>Naive Bayes statistic (b)</italic>: SNPs were ranked using <inline-formula><mml:math id="M31" name="1471-2164-13-681-i31" overflow="scroll"><mml:mo>|</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:math></inline-formula>. Here <inline-formula><mml:math id="M32" name="1471-2164-13-681-i32" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>I</mml:mi></mml:mrow></mml:mfrac><mml:munder><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mo>∗</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:math></inline-formula> where <italic>p</italic><sub><italic>d</italic>0</sub>was estimated as in the <italic>deviation statistic d</italic>. The implicit assumption here is that <italic>x</italic><sub><italic>id</italic></sub>|<italic>p</italic><sub><italic>id</italic></sub>∼<italic>Bin</italic>(<italic>n</italic><sub><italic>id</italic></sub>,<italic>p</italic><sub><italic>id</italic></sub>) and <italic>p</italic><sub><italic>id</italic></sub>∼<italic>Beta</italic>(<italic>α</italic><sub><italic>d</italic></sub>,<italic>β</italic><sub><italic>d</italic></sub>) with <inline-formula><mml:math id="M33" name="1471-2164-13-681-i33" overflow="scroll"><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="M34" name="1471-2164-13-681-i34" overflow="scroll"><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>. The posterior mean of <italic>p</italic><sub><italic>id</italic></sub>is used to construct the ranking statistic.</p>
      <p>4. <italic>Empirical Bayes statistic (B)</italic>: SNPs were ranked using <inline-formula><mml:math id="M35" name="1471-2164-13-681-i35" overflow="scroll"><mml:mo>|</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>ˇ</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:math></inline-formula>. We estimated <inline-formula><mml:math id="M36" name="1471-2164-13-681-i36" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>ˇ</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula>. The implicit assumption is the same as the <italic>naive Bayes statistic</italic>, but now we estimate <italic>α</italic><sub><italic>d</italic></sub>and <italic>β</italic><sub><italic>d</italic></sub>based on the observed data using the method of moments as in iASeq (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplemental Method S.2).</p>
      <p>5. <italic>Single dataset EM (singleEM)</italic>: We fitted a mixture model of SR, SN and NS with distributions <italic>f</italic><sub><italic>idjp</italic></sub>(·),<italic>p</italic>=0,1,2 and mixing probabilities <italic>v</italic><sub><italic>d</italic></sub>, <italic>w</italic><sub><italic>d</italic></sub>and 1−<italic>v</italic><sub><italic>d</italic></sub>−<italic>w</italic><sub><italic>d</italic></sub>for each dataset <italic>d</italic> without considering other datasets. SNPs were ranked using a posterior probability similar to <inline-formula><mml:math id="M37" name="1471-2164-13-681-i37" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, but now determined based on information in dataset <italic>d</italic> only (see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Supplemental Method S.7 for details).</p>
      <p>Figure <xref ref-type="fig" rid="F3">3</xref> compares the number of true positives, <italic>T</italic><italic>P</italic><sub><italic>d</italic></sub>(<italic>q</italic>), in the top <italic>q</italic> SNPs reported by each method in each dataset <italic>d</italic>. In Figures <xref ref-type="fig" rid="F3">3</xref>a-c and <xref ref-type="fig" rid="F3">3</xref>e-g, <italic>T</italic><italic>P</italic><sub><italic>d</italic></sub>(<italic>q</italic>) is plotted as a function of <italic>q</italic> in a few representative datasets. These plots show that iASeq outperformed all single-dataset based methods, and it was able to substantially improve the power for detecting allele-specificity.</p>
      <p>In general, the observed differences between iASeq and the <italic>d, z, b</italic> and <italic>B</italic> statistics could be caused by many factors such as use of different statistical models, ranking statistics, or methods for parameter estimation. However, the comparison between iASeq and the single dataset EM represents a well-controlled comparison since these two methods used exactly the same distributional assumptions and parameter estimation methods. The only difference between them was that iASeq used information from multiple datasets whereas <italic>singleEM</italic> was based on one dataset only. This well-controlled comparison shows that jointly modeling multiple datasets is able to improve the allelic inference.</p>
      <p>To examine whether iASeq was able to bring improvement in all datasets, we computed the Area under the Receiver Operating Characteristic (ROC) curves (AUC) for each method in each dataset using the top 2000 ranked SNPs. In each dataset, we computed the proportion of improvement in terms of AUC brought by iASeq over the best single-dataset based ranking method (i.e., <inline-formula><mml:math id="M38" name="1471-2164-13-681-i38" overflow="scroll"><mml:mi>dAUC</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>AU</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">iAseq</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>AU</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bestsingle</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>AU</mml:mi><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">bestsingle</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:math></inline-formula>). <italic>dAUC</italic>&gt;0 means iASeq is able to bring improvement. Figures <xref ref-type="fig" rid="F3">3</xref>d and <xref ref-type="fig" rid="F3">3</xref>h show the distribution of <italic>dAUC</italic> across all 40 datasets as a histogram. The results show that iASeq was able to improve the SNP ranking in almost all datasets.</p>
      <p>In Figure <xref ref-type="fig" rid="F4">4</xref>, we converted the iASeq posterior probabilities of top <italic>N</italic> SNPs to FDR estimates and plotted the estimated FDR against the true FDR. The figure shows that iASeq was able to provide reasonable FDR estimates as well. Shown in the figure are a few representative datasets. Results in all other datasets were similar.</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Estimated FDR against true FDR in simulations. (a)-(d)</bold> Results for four representative datasets in simulation 1. <bold>(e)</bold>-<bold>(h)</bold> Results for four representative datasets in simulation 2. Results for all other datasets were similar.</p>
        </caption>
        <graphic xlink:href="1471-2164-13-681-4"/>
      </fig>
    </sec>
    <sec>
      <title>Analysis of real data</title>
      <p>Our simulation study demonstrates the ability of iASeq to discover correlation patterns of allele-specificity and improve the detection of skewed SNPs. Next, we applied iASeq to analyze the 41 real datasets (78 samples) in GM12878 cells. In real data, we do not have comprehensive knowledge about the truth. Therefore, unlike simulations, we were not able to assess the FDR estimates. For this reason, we mainly focused on analyzing the correlation patterns of allele-specificity and testing whether iASeq can improve the SNP ranking.</p>
      <sec>
        <title>Correlation patterns of allele-specificity</title>
        <p>Figure <xref ref-type="fig" rid="F5">5</xref>a shows the BIC in the real data. Based on BIC, the optimal <italic>K</italic> was 2. In other words, in addition to the background class (<italic>k</italic>=0), iASeq discovered two other SNP classes, representing different allele-specificity patterns. For these two non-background classes, <italic>Π</italic><sub><italic>k</italic></sub>was estimated to be 0.0696 and 0.0691 respectively, suggesting that they cover 6.96% and 6.91% of the analyzed SNPs. Due to the background noises, not all SNPs in these two classes can be confidently detected. At the 0.90 posterior probability cutoff, iASeq reported 1868 and 2138 SNPs for classes 1 and 2 respectively (Figure <xref ref-type="fig" rid="F5">5</xref>b). Note that our simulations had similar settings as the real data analysis, and they showed that iASeq was able to discover more than two patterns if they are supported by the data. Therefore our discovery of two correlation patterns here is likely driven by the data, that is, the information in the data is only sufficient for supporting robust discovery of two patterns.</p>
        <fig id="F5" position="float">
          <label>Figure 5</label>
          <caption>
            <p><bold>Correlation patterns of allele-specificity among different TFs and HMs in GM12878 cells discovered by iASeq. (a)</bold> The BIC values for different class number <italic>K</italic>. The BIC achieves the minimum at <italic>K</italic>=2. <bold>(b)</bold> The estimated <bold><italic>V</italic></bold> and <bold><italic>W</italic></bold> when <italic>K</italic>=2. Each row corresponds to a class. Each column represents a dataset. The color in the cell (<italic>k</italic>,<italic>d</italic>) represents the SR or SN probability in class <italic>k</italic> and dataset <italic>d</italic>. From white to dark, the probability increases from 0 to 1. The bar plot and the numbers shown under <italic>Π</italic>are the estimated number of SNPs in each class (i.e., <inline-formula><mml:math id="M39" name="1471-2164-13-681-i39" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>Π</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>∗</mml:mo></mml:math></inline-formula> the total number of SNPs). The bar plot and the numbers shown under <italic>a</italic><sub><italic>i</italic></sub>are the number of SNPs identified for the corresponding class using the posterior probability <italic>Pr</italic>(<italic>a</italic><sub><italic>i</italic></sub>=<italic>k</italic>|<bold><italic>X</italic></bold><sub><italic>i</italic></sub>,<bold><italic>N</italic></bold><sub><italic>i</italic></sub>,<bold><italic>Π</italic></bold>,<bold><italic>V</italic></bold>,<bold><italic>W</italic></bold>)&gt;0<italic>.</italic>9 as cutoff. <bold>(c)</bold> A closer look at <bold><italic>V</italic></bold> and <bold><italic>W</italic></bold> in a number of representative datasets. The barplots show the estimated SR and SN probabilities <italic>v</italic><sub><italic>kd</italic></sub>and <italic>w</italic><sub><italic>kd</italic></sub>in a number of selected datasets. Left: the skewing probabilities in class 1. Right: the skewing probabilities in class 2. The height of each bar represents the SR or SN probability.</p>
          </caption>
          <graphic xlink:href="1471-2164-13-681-5"/>
        </fig>
        <p>Figures <xref ref-type="fig" rid="F5">5</xref>b and <xref ref-type="fig" rid="F5">5</xref>c show the posterior mode of <bold><italic>V</italic></bold><sub><italic>k</italic></sub>and <bold><italic>W</italic></bold><sub><italic>k</italic></sub> for the two non-background classes. It turned out that these two classes corresponded to two global directions of allele-specificity, SR and SN, respectively. Since the assignment of reference or non-reference allele depends on the reference genome, the assignment <italic>per se</italic> is not of biological interest. However, recall that GM12878 is a single person, therefore at each single SNP, the nucleotide representing the reference or non-reference allele is the same across all datasets analyzed here. Given this fact, what these results essentially tell is that at each single SNP, most TFs and HMs in our analysis were highly correlated in terms of allele-specificity, and if they are skewed, they tend to be skewed toward the same direction (i.e., the same allele). For instance, for SNPs in class 1, both H3K4me3 (from the Broad Institute) and H3K27ac (Broad) had high probability to be SR, with (<italic>v</italic><sub><italic>kd</italic></sub>,<italic>w</italic><sub><italic>kd</italic></sub>) equal to (0.9337,0.0070) and (0.9730,0.0041) respectively (Figure <xref ref-type="fig" rid="F5">5</xref>c). The probability that one is SR and the other one is SN was small. Similarly, for SNPs in class 2, both H3K4me3 and H3K27ac were highly likely to be SN simultaneously ((<italic>v</italic><sub><italic>kd</italic></sub>,<italic>w</italic><sub><italic>kd</italic></sub>)=(0.0061,0.9835) for H3K4me3 (Broad) and (0.0040,0.9897) for H3K27ac (Broad)). While the allelic imbalance of most TFs and HMs were highly correlated, H3K27me3, a HM involved in gene repression, was an exception. In both non-background classes, H3K27me3 had much lower skewing probabilities compared to the other proteins (Figure <xref ref-type="fig" rid="F5">5</xref>c). Within each class, the difference in the skewing probability between the two alleles was also much weaker for H3K27me3 as compared to the other proteins. For instance, in class 1, while most other proteins showed strong preference to be skewed toward the reference allele, H3K27me3 can be skewed to the reference allele at some SNPs and skewed to the non-reference allele at many other SNPs. Therefore, the allelic imbalance in H3K27me3 is not strongly correlated with the allelic imbalance of the other proteins analyzed here. For the genomic DNA which was used as control here, the skewing probabilities (<italic>v</italic><sub><italic>kd</italic></sub>,<italic>w</italic><sub><italic>kd</italic></sub>) in both classes were fairly low as shown in Figure <xref ref-type="fig" rid="F5">5</xref>b-c. In both classes, the probability for not being skewed in the genomic DNA (i.e., 1−<italic>v</italic><sub><italic>kd</italic></sub>−<italic>w</italic><sub><italic>kd</italic></sub>) was bigger than 0.95. This indicates that the high probability of skewing observed in the other datasets was not an artifact.</p>
        <p>The coordinated allelic imbalance of different proteins toward the same allele has also been observed in a recent study [<xref ref-type="bibr" rid="B38">38</xref>]. In that study, the authors analyzed AS of 24 TFs and found that when multiple TFs bind to the same SNP, they frequently bind to the same allele. Moreover, those authors did not observe any pair of TFs that regularly bind the same position on alternate alleles. Our observation here therefore is consistent with their finding.</p>
      </sec>
      <sec>
        <title>Increased power for detecting allele-specificity compared with single dataset analysis</title>
        <p>We ranked SNPs based on the posterior probabilities <inline-formula><mml:math id="M40" name="1471-2164-13-681-i40" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> in each dataset. The iASeq ranking was compared with the rankings provided by the five single-dataset based methods described above. Since we do not know the truth, we used two types of independent information as gold standard to benchmark the ranking results.</p>
        <p>First, we evaluated different methods by counting how many of their top ranked SNPs were located in the non-pseudoautosomal regions of chromosome X (chrX-npa) (Figure <xref ref-type="fig" rid="F6">6</xref>). GM12878 is a female lymphoblastoid cell line. In GM12878, SNPs in chrX-npa are expected to be allele-specific due to cells rapidly become clonal in culture leading to a skewed X-inactivation [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B38">38</xref>,<xref ref-type="bibr" rid="B39">39</xref>]. Therefore, given a fixed number of top SNPs, the more chrX-npa SNPs one can find, the more powerful a method is. Figure <xref ref-type="fig" rid="F6">6</xref> shows that iASeq clearly increased the power for detecting allele-specificity in each dataset compared to the single-dataset based analysis. For example, Figure <xref ref-type="fig" rid="F6">6</xref>a shows that in the H3K27ac dataset generated by the Broad Institute, iASeq was able to identify 122 chrX-npa SNPs among the top 500 SNPs. This represents 126% improvement compared to <italic>singleEM</italic>, the best single-dataset based ranking method in that dataset, which only identified 54 chrX-npa SNPs. Figures <xref ref-type="fig" rid="F6">6</xref>a-g show results in a few representative datasets. Figure <xref ref-type="fig" rid="F6">6</xref>h shows the distribution of <italic>dAUC</italic> (i.e., the proportion of improvement of AUC by iASeq over the best single-dataset based ranking method in each dataset) in all 40 datasets. These plots clearly show that iASeq outperformed all single-dataset based methods in all datasets and the average improvement in AUC was 354%.</p>
        <fig id="F6" position="float">
          <label>Figure 6</label>
          <caption>
            <p><bold>The ROC curves with chrX-npa SNPs as gold standard in the GM12878 analysis.</bold> We plot the number of non-pseudoautosomal region X chromosome SNPs, denoted by <italic>T</italic><italic>P</italic><sub><italic>d</italic></sub>(<italic>q</italic>), among the top <italic>q</italic> ranked SNPs in dataset <italic>d</italic> as a function of the rank cutoff <italic>q</italic> for each method. <bold>(a)</bold>-<bold>(g)</bold> Results in 7 representative datasets. <bold>(h)</bold> In each dataset, we computed the area under the ROC curve (AUC) using the 2000 top ranked SNPs for each method. dAUC, the proportion of improvement of AUC brought by iASeq over the best AUC from the single-dataset based methods, was computed for each dataset. The distribution of dAUC in all 40 datasets is shown.</p>
          </caption>
          <graphic xlink:href="1471-2164-13-681-6"/>
        </fig>
        <p>Second, we evaluated different methods by using independent RNA-seq data. From RNA-seq, one can identify exonic ASE SNPs and use them as gold standard. We collected two RNA-seq datasets in GM12878, one from the California Institute of Technology (Caltech) and the other from the Yale/Stanford University (Yale) (Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: Table S1). From each dataset, we identified the top 400 exonic ASE SNPs using the naive Bayes statistics. Using the other methods to identify the gold standard ASE SNPs produced similar results which, for simplicity, will not be shown here. Based on these exonic ASE SNPs, we defined a SNP in our ChIP-seq analysis as truly allele-specific if there was an exonic ASE SNP in its <italic>X</italic>kb neighborhood. Here we tried both <italic>X</italic>=10kb and <italic>X</italic>=1kb and obtained similar results. Below we illustrate the results using <italic>X</italic>=10kb as an example. The corresponding results for <italic>X</italic>=1kb are shown in Additional file <xref ref-type="supplementary-material" rid="S4">4</xref>: Figures S3-S6. Among the 94,519 SNPs analyzed in the ChIP-seq data, 20,526 had one or more exonic SNPs within its 10kb neighborhood and therefore could potentially be linked to an exonic ASE SNP. Figure <xref ref-type="fig" rid="F7">7</xref> and Additional file <xref ref-type="supplementary-material" rid="S5">5</xref>: Figure S1 compare rankings of these SNPs provided by different methods in terms of how many of the top ranked SNPs are true positives (i.e., associated with ASE). iASeq again outperformed all the other single-dataset based ranking methods. For instance, based on the Caltech gold standard, iASeq on average identified 144% more true positive SNPs among the top 500 SNPs (Figure <xref ref-type="fig" rid="F7">7</xref>a-g). According to the Yale gold standard, iASeq achieved an average of 149% improvement in terms of the true positive rate among top 500 SNPs (Additional file <xref ref-type="supplementary-material" rid="S5">5</xref>: Figure S1). The average improvement in terms of AUC (i.e., <italic>dAUC</italic>) across all 40 datasets was 148% (Figure <xref ref-type="fig" rid="F7">7</xref>h) and 165% (Additional file <xref ref-type="supplementary-material" rid="S5">5</xref>: Figure S1h) for the Caltech and Yale gold standard respectively.</p>
        <fig id="F7" position="float">
          <label>Figure 7</label>
          <caption>
            <p><bold>The ROC curves in GM12878 data using Caltech RNA-seq ASE SNPs as gold standard.</bold> We plot <italic>T</italic><italic>P</italic><sub><italic>d</italic></sub>(<italic>q</italic>), the number of true allele-specific SNPs among the top <italic>q</italic> ranked SNPs in dataset <italic>d</italic>, against the rank cutoff <italic>q</italic> for each method. The true allele-specific SNPs are defined as SNPs that have ≥1 RNA-seq exonic ASE SNPs in their 10kb neighborhood. <bold>(a)</bold>-<bold>(g)</bold> Results in 7 representative datasets. <bold>(h)</bold> In each dataset, we computed the area under the ROC curve (AUC) using the 2000 top ranked SNPs for each method. dAUC, the proportion of improvement of AUC brought by iASeq over the best AUC from the single-dataset based methods, was computed for each dataset. The distribution of dAUC in all 40 datasets is shown.</p>
          </caption>
          <graphic xlink:href="1471-2164-13-681-7"/>
        </fig>
        <p>To ensure that the increased statistical power was not completely attributed to X chromosome SNPs, we repeated the benchmark analysis based on RNA-seq using only SNPs in autosomal chromosomes, and we obtained similar results (Figure <xref ref-type="fig" rid="F8">8</xref>, Additional file <xref ref-type="supplementary-material" rid="S6">6</xref>: Figure S2). This shows that the increased power is not only contributed by chrX SNPs.</p>
        <fig id="F8" position="float">
          <label>Figure 8</label>
          <caption>
            <p><bold>The ROC curves in GM12878 data using Caltech RNA-seq autosomal ASE SNPs as gold standard.</bold> We plot <italic>T</italic><italic>P</italic><sub><italic>d</italic></sub>(<italic>q</italic>), the number of true allele-specific SNPs among the top <italic>q</italic> ranked autosomal SNPs in dataset <italic>d</italic>, against the rank cutoff <italic>q</italic> for each method. The true allele-specific SNPs are defined as autosomal SNPs that have ≥1 RNA-seq exonic ASE SNPs in their 10kb neighborhood. <bold>(a)</bold>-<bold>(g)</bold> Results in 7 representative datasets. <bold>(h)</bold> In each dataset, we computed the area under the ROC curve (AUC) using the 2000 top ranked SNPs for each method. dAUC, the proportion of improvement of AUC brought by iASeq over the best AUC from the single-dataset based methods, was computed for each dataset. The distribution of dAUC in all 40 datasets is shown.</p>
          </caption>
          <graphic xlink:href="1471-2164-13-681-8"/>
        </fig>
      </sec>
      <sec>
        <title>Comparisons with other methods</title>
        <p>Most existing studies on allele-specificity were conducted using in-house data analysis pipelines. A tool developed by Skelly et al. [<xref ref-type="bibr" rid="B33">33</xref>] and AlleleSeq [<xref ref-type="bibr" rid="B32">32</xref>] are two software tools accessible to third-party users for AS analysis. The method proposed by Skelly et al. [<xref ref-type="bibr" rid="B33">33</xref>] is designed for analyzing ASE in RNA-seq data. It first fits a background model using genomic DNA and then feeds the estimated parameters into a Bayesian model that combines information from multiple SNPs within a gene to infer ASE. When we applied this method to analyzing the GM12878 ChIP-seq data, two problems occurred. First, the method uses Markov Chain Monte Carlo (MCMC) to fit the background model from the genomic DNA which, as alerted by [<xref ref-type="bibr" rid="B33">33</xref>], is well-known for its slow speed and difficulties for users to monitor the convergence. Our genomic DNA data had 94,519 SNPs which covered 12,417 genes. Running this algorithm on this data using the parameter settings recommended by [<xref ref-type="bibr" rid="B33">33</xref>] on a machine with 2.7 GHz CPU and 4 Gb RAM took more than 60 days. Second, after feeding the background model parameters obtained from the first step to the inference model in the second step, the algorithm stopped execution after a few iterations. This is because the original model was developed for deeply sequenced RNA-seq rather than ChIP-seq, where the average read count covering a heterozygote SNP in a ChIP-seq dataset is only 0.64. As a result, the model developed in [<xref ref-type="bibr" rid="B33">33</xref>] did not fit the real data in ChIP-seq experiments. This lack-of-fit caused the program to stop early, likely due to the abnormally fitted parameters causing various computation problems (e.g., overflow). For this reason, although the method proposed by [<xref ref-type="bibr" rid="B33">33</xref>] represents an advanced solution for analyzing RNA-seq ASE, it cannot be directly used to analyze ASB in ChIP-seq data without significantly redesigning the model and algorithm. For this reason, it is not further compared here.</p>
        <p>AlleleSeq [<xref ref-type="bibr" rid="B32">32</xref>] is another tool for AS analysis. It has been used to analyze ASB of several TFs in GM12878 [<xref ref-type="bibr" rid="B32">32</xref>]. AlleleSeq is more focused on the preprocessing step. Its pipeline first constructs a diploid personal genome sequence according to family trio data and then maps ChIP-seq reads to this personal genome. After removing various biases, the method then analyzes allele-specificity in each individual ChIP-seq dataset separately. [<xref ref-type="bibr" rid="B32">32</xref>] applied AlleleSeq to analyze 7 different TF datasets in GM12878, among them 5 were also included in our iASeq analysis. We compared iASeq and AlleleSeq using these same 5 datasets. We first obtained the ASB SNPs reported by AlleleSeq from [<xref ref-type="bibr" rid="B32">32</xref>]. Let <italic>T</italic><sub><italic>d</italic></sub>denote the number of reported ASB SNPs for each TF dataset <italic>d</italic>. We next obtained the top <italic>T</italic><sub><italic>d</italic></sub>SNPs ranked by iASeq. We then compared these two methods based on how many of their top <italic>T</italic><sub><italic>d</italic></sub> SNPs were in chrX-npa, and how many of them were associated with exonic ASE SNPs determined by RNA-seq. For the benchmark analysis based on RNA-seq, we associated exonic ASE SNPs with ChIP-seq SNPs using both 10kb and 1kb neighborhood. We also performed the comparison after excluding the chromosome X SNPs. Table <xref ref-type="table" rid="T1">1</xref>, Additional file <xref ref-type="supplementary-material" rid="S7">7</xref>: Table S3, Additional file <xref ref-type="supplementary-material" rid="S4">4</xref>: Tables S4-S5 and Additional file <xref ref-type="supplementary-material" rid="S8">8</xref>: Figure S7 show that iASeq either outperformed or performed comparable to AlleleSeq in all datasets. Sometimes, the improvement was substantial (e.g., YaleMYC in Table <xref ref-type="table" rid="T1">1</xref>).</p>
        <table-wrap position="float" id="T1">
          <label>Table 1</label>
          <caption>
            <p>Comparison of iASeq and AlleleSeq</p>
          </caption>
          <table frame="hsides" rules="groups" border="1">
            <colgroup>
              <col align="left"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
              <col align="center"/>
            </colgroup>
            <thead valign="top">
              <tr>
                <th align="left">
                  <bold>Gold standard</bold>
                </th>
                <th colspan="3" align="left">
                  <bold>ChrX</bold>
                </th>
                <th colspan="3" align="left">
                  <bold>All Caltech ASE exonic SNPs</bold>
                </th>
                <th colspan="3" align="left">
                  <bold>Autosomal Caltech ASE exonic SNPs</bold>
                </th>
              </tr>
            </thead>
            <tbody valign="top">
              <tr>
                <td align="left" valign="bottom">
                  <bold>TF</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>T</bold>
                  <sub>
                    <bold>d</bold>
                  </sub>
                  <hr/>
                </td>
                <td align="center" valign="bottom">
                  <bold>AlleleSeq</bold>
                  <hr/>
                </td>
                <td align="center" valign="bottom">
                  <bold>iASeq</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>T</bold>
                  <sub>
                    <bold>d</bold>
                  </sub>
                  <hr/>
                </td>
                <td align="center" valign="bottom">
                  <bold>AlleleSeq</bold>
                  <hr/>
                </td>
                <td align="center" valign="bottom">
                  <bold>iASeq</bold>
                  <hr/>
                </td>
                <td align="left" valign="bottom">
                  <bold>T</bold>
                  <sub>
                    <bold>d</bold>
                  </sub>
                  <hr/>
                </td>
                <td align="center" valign="bottom">
                  <bold>AlleleSeq</bold>
                  <hr/>
                </td>
                <td align="center" valign="bottom">
                  <bold>iASeq</bold>
                  <hr/>
                </td>
              </tr>
              <tr>
                <td align="left" valign="bottom">YaleCFOS<hr/></td>
                <td align="left" valign="bottom">41<hr/></td>
                <td align="center" valign="bottom">3<hr/></td>
                <td align="center" valign="bottom">4<hr/></td>
                <td align="left" valign="bottom">9<hr/></td>
                <td align="center" valign="bottom">5<hr/></td>
                <td align="center" valign="bottom">3<hr/></td>
                <td align="left" valign="bottom">9<hr/></td>
                <td align="center" valign="bottom">5<hr/></td>
                <td align="center" valign="bottom">3<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">YaleMYC<hr/></td>
                <td align="left" valign="bottom">122<hr/></td>
                <td align="center" valign="bottom">9<hr/></td>
                <td align="center" valign="bottom">22<hr/></td>
                <td align="left" valign="bottom">39<hr/></td>
                <td align="center" valign="bottom">5<hr/></td>
                <td align="center" valign="bottom">10<hr/></td>
                <td align="left" valign="bottom">38<hr/></td>
                <td align="center" valign="bottom">5<hr/></td>
                <td align="center" valign="bottom">10<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">YaleJUND<hr/></td>
                <td align="left" valign="bottom">289<hr/></td>
                <td align="center" valign="bottom">13<hr/></td>
                <td align="center" valign="bottom">31<hr/></td>
                <td align="left" valign="bottom">24<hr/></td>
                <td align="center" valign="bottom">4<hr/></td>
                <td align="center" valign="bottom">8<hr/></td>
                <td align="left" valign="bottom">23<hr/></td>
                <td align="center" valign="bottom">4<hr/></td>
                <td align="center" valign="bottom">7<hr/></td>
              </tr>
              <tr>
                <td align="left" valign="bottom">YaleMAX<hr/></td>
                <td align="left" valign="bottom">105<hr/></td>
                <td align="center" valign="bottom">3<hr/></td>
                <td align="center" valign="bottom">18<hr/></td>
                <td align="left" valign="bottom">18<hr/></td>
                <td align="center" valign="bottom">3<hr/></td>
                <td align="center" valign="bottom">1<hr/></td>
                <td align="left" valign="bottom">18<hr/></td>
                <td align="center" valign="bottom">3<hr/></td>
                <td align="center" valign="bottom">2<hr/></td>
              </tr>
              <tr>
                <td align="left">YalePolIII</td>
                <td align="left">25</td>
                <td align="center">2</td>
                <td align="center">2</td>
                <td align="left">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="left">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>Column 1: TF name. Column 2: <italic>T</italic><sub><italic>d</italic></sub>is the number of AlleleSeq reported ASB SNPs. Columns 3-4: the number of non-pseudoautosomal region X chromosome SNPs among the top <italic>T</italic><sub><italic>d</italic></sub>allele-specific SNPs reported by AlleleSeq and iASeq. Column 5: <italic>T</italic><sub><italic>d</italic></sub>is the number of AlleleSeq reported ASB SNPs that had an exonic SNP within their 10kb neighborhood. Columns 6-7 show among the top <italic>T</italic><sub><italic>d</italic></sub>allele-specific SNPs reported by AlleleSeq and iASeq, how many SNPs had ≥1 exonic ASE SNP in their 10kb neighborhood according to the Caltech RNA-seq experiment. Column 8: <italic>T</italic><sub><italic>d</italic></sub>is the number of AlleleSeq reported autosomal ASB SNPs that had an exonic SNP within their 10kb neighborhood. Columns 9-10 show among the top <italic>T</italic><sub><italic>d</italic></sub>autosomal allele-specific SNPs reported by AlleleSeq and iASeq, how many SNPs had ≥1 exonic ASE SNP in their 10kb neighborhood according to the Caltech RNA-seq experiment. Additional file <xref ref-type="supplementary-material" rid="S7">7</xref>: Table S3 contains similar results using Yale RNA-seq exonic ASE SNPs as gold standard.</p>
          </table-wrap-foot>
        </table-wrap>
      </sec>
    </sec>
  </sec>
  <sec sec-type="discussion">
    <title>Discussion</title>
    <sec>
      <title>Interpretation of the correlation patterns</title>
      <p>When analyzing the real data in GM12878, iASeq found two non-background AS patterns, representing two opposite directions of allelic imbalance. Since the assignment of reference and non-reference allele depends on the reference genome, whether a SNP is skewed toward reference or non-reference allele <italic>per se</italic> does not have direct biological meaning. What these two patterns essentially suggest is that the allelic imbalances of multiple proteins at a single SNP are correlated and have high preference to be skewed toward the same allele. In other words, the two patterns should be viewed as a pair and interpreted together.</p>
      <p>In general, although one may view different allelic imbalance patterns in iASeq as different clusters of SNPs, these clusters only describe the similarities among SNPs in terms of their skewness directions, rather than the similarities in terms of their functions. The direction is defined using the reference/non-reference allele. The reference or non-reference allele for different SNPs can have different meanings (e.g., for one SNP, the maternal allele may be the reference allele, whereas for another SNP the paternal allele may be the reference allele). Therefore within each cluster, even though SNPs have similar skewness pattern, they are not necessarily functionally related to each other. One should not confuse the SNP clusters here with the clusters obtained from the traditional gene expression microarray data analysis, where co-expressed genes in a cluster often have similar functions. In iASeq, the clusters only serve as a tool to describe the correlation structure among different datasets (i.e., proteins), rather than the functional correlation among different SNPs. The correlation patterns among datasets are used by iASeq to inform one how to integrate information across datasets (i.e., which datasets are highly correlated and therefore can borrow information from each other) to improve detection of AS events for each individual SNP and dataset. In order to understand functions of the detected AS events, one needs to further correlate the iASeq results with other information (e.g., one may determine the parent-of-origin of each SNP first and then study various phenomena such as imprinting).</p>
      <p>Our observation that different proteins prefer to be skewed in the same direction is consistent with a recent observation reported in [<xref ref-type="bibr" rid="B38">38</xref>] that AS of 24 different TFs are skewed toward the same allele. A number of factors could contribute to the observed correlation. First, biologically it is plausible that functionally related HMs and TFs have correlated allele-specificity. For instance, both H3K4me2 and H3K4me3 are markers for active transcription. Therefore, for a specific SNP, if the reference allele is associated with a gene with active transcription but the non-reference allele is not, then it is very likely that both H3K4me2 and H3K4me3 will be skewed toward the reference allele. For another SNP, if the non-reference allele is transcribed but the reference allele is not, then both H3K4me2 and H3K4me3 will have high probability to be skewed toward the non-reference allele. In the genome, H3K4me2 and H3K4me3 are skewed toward reference allele for some SNPs, and skewed toward non-reference allele for some other SNPs. Therefore the skewed SNPs could naturally fall into two clusters, representing two opposite AS directions. Second, as pointed out by [<xref ref-type="bibr" rid="B38">38</xref>], the coordinated AS could also occur as a result of the difference in the chromatin landscape between the two alleles. For instance, if the chromatin on one allele is more open and accessible, it could increase the overall binding probability of multiple different proteins, leading to correlated allelic skewing.</p>
      <p>While our results show that most analyzed TFs/HMs tend to be skewed toward the same direction, these results do not imply that these proteins are perfectly correlated in terms of allele-specificity at each and every SNP. In iASeq, the correlation patterns <bold><italic>V</italic></bold><sub><italic>k</italic></sub>and <bold><italic>W</italic></bold><sub><italic>k</italic></sub>are probabilistic patterns rather than 0-1 vectors. Each correlation class <italic>k</italic> can generate all 3<sup><italic>D</italic></sup> AS configurations. For instance, for a class with [<bold><italic>V</italic></bold><sub><italic>k</italic></sub>;<bold><italic>W</italic></bold><sub><italic>k</italic></sub>]= [(0.9,0.9,0.9,0.1); (0.1,0.1,0.1,0.1)], it is possible to have one SNP with configuration [<italic>SR</italic>,<italic>SR</italic>,<italic>NS</italic>,<italic>NS</italic>] and at the same time another SNP with configuration [<italic>SR</italic>,<italic>NS</italic>,<italic>SR</italic>,<italic>NS</italic>]. Therefore, SNPs in the same class are not required to have the same AS configuration, even though they tend to have similar AS configurations. The probabilistic patterns are used here to provide a parsimonious description of the complex correlation structure in the data, so that one can circumvent the difficulty of handling 3<sup><italic>D</italic></sup> AS configurations whose complexity increases exponentially. As a consequence of using this parsimonious model, multiple weak correlation patterns without strong enough data support could be merged into a bigger class. For instance, consider two AS patterns [<bold><italic>V</italic></bold><sub><italic>k</italic></sub>;<bold><italic>W</italic></bold><sub><italic>k</italic></sub>]=[(1,1,0,0);(0,0,0,0)] (i.e., [SR,SR,NS,NS]) and [<bold><italic>V</italic></bold><sub><italic>k</italic></sub>;<bold><italic>W</italic></bold><sub><italic>k</italic></sub>]=[(0,0,1,1);(0,0,0,0)] (i.e., [NS,NS,SR,SR]). Suppose both patterns are equally likely to occur in the data. If each pattern is only associated with a small number of SNPs, then a parsimonious model will prefer merging them together into one single class with [<bold><italic>V</italic></bold><sub><italic>k</italic></sub>;<bold><italic>W</italic></bold><sub><italic>k</italic></sub>]=[(0<italic>.</italic>5,0<italic>.</italic>5,0<italic>.</italic>5,0<italic>.</italic>5);(0,0,0,0)]. For this reason, iASeq only discovers correlation patterns that have sufficient data support so that they can be distinguished from other patterns. It will not report weak patterns, which could be real but do not have enough data support to allow them to be robustly recovered. For users, this means that at the cluster level, they may not be able to see weak but real AS correlation patterns if these patterns are not associated with enough number of SNPs. On the other hand, for the purpose of inferring whether or not each SNP is allele-specific in each dataset, these parsimonious correlation patterns are sufficient for describing the correlation structure in the data and serving as a prior to guide the information sharing across datasets. The information sharing will lead the increased ASB detection power, and the eventual AS configuration at each individual SNP will be determined by the posterior probabilities of (<italic>b</italic><sub><italic>id</italic></sub>,<italic>c</italic><sub><italic>id</italic></sub>) (i.e., <inline-formula><mml:math id="M41" name="1471-2164-13-681-i41" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>id</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) rather than the cluster-level prior probabilities [<bold><italic>V</italic></bold><sub><italic>k</italic></sub>;<bold><italic>W</italic></bold><sub><italic>k</italic></sub>]. Therefore, in the final AS calls, the model still allows each SNP to have its own AS configuration which may not necessarily be the same as the AS configurations of other SNPs from the same cluster.</p>
      <p>Consistent with [<xref ref-type="bibr" rid="B38">38</xref>], in the two non-background AS patterns discovered here, proteins skewed toward the same direction did not always correspond to known protein-protein interactions. As pointed out by [<xref ref-type="bibr" rid="B38">38</xref>], this could happen as a result of allelic imbalances of different proteins being caused by a common underlying factor such as allelic difference in chromatin landscape. It could also reflect unknown protein-protein interactions. For iASeq specifically, there is a third reason, that is, multiple small patterns can be merged into a bigger probabilistic class as described before. For example, because of the use of probabilistic patterns, two patterns [SR,SR,NS,NS] and [NS,NS,SR,SR] may be merged into a single SNP class (e.g., <bold><italic>V</italic></bold><sub><italic>k</italic></sub>;<bold><italic>W</italic></bold><sub><italic>k</italic></sub>=[(0<italic>.</italic>5,0<italic>.</italic>5,0<italic>.</italic>5,0<italic>.</italic>5);(0,0,0,0)]). As a result, only looking at the pattern represented by <bold><italic>V</italic></bold><sub><italic>k</italic></sub>;<bold><italic>W</italic></bold><sub><italic>k</italic></sub>, one cannot tell the details of protein-protein interactions, such as these interactions only exist between datasets 1 and 2, or between 3 and 4, but not between the other pairs of datasets. What one can tell from this merged pattern is that, when the allelic imbalance occurs in these four datasets, they will be skewed toward the same direction, i.e., the reference allele in this example.</p>
      <p>In summary, while the correlation patterns in iASeq provide some insights on the correlation of allelic imbalance among different datasets, one should not over-interpret them. The primary goal of these patterns is to describe the correlation structure in the data so that information from different datasets can be shared in a principled way to increase the power of statistical inference. This also points to an important difference between this study and previous studies that reported coordinated allele-specificity among multiple proteins. The previous studies only reported the correlation as a biological finding, but did not provide a statistical method to further utilize the correlation structure to improve the statistical inference. In contrast, iASeq provides a general and rigorous statistical method that utilizes the automatically discovered correlation patterns to increase the statistical power of AS detection. As such, it represents a novel development for the analysis of allele-specificity.</p>
    </sec>
    <sec>
      <title>Model, algorithm, and possible extensions</title>
      <p>Unlike tools such as AlleleSeq which mainly focus on the preprocessing steps for the AS analysis (e.g., construction of diploid personal genome), iASeq is developed as a general model working downstream of the preprocessing pipelines. The input data for iASeq are the read counts in the format shown in Figure <xref ref-type="fig" rid="F1">1</xref>a. With this design, iASeq can be easily coupled with different data preprocessing protocols. For instance, some investigators may map their reads to a reference genome, while others may map their reads to a diploid personal genome. Both types of investigators can use iASeq to integrate information from multiple datasets once they obtained the allelic read counts.</p>
      <p>In iASeq, we used an EM algorithm to find the posterior mode of parameters and carried out statistical inference accordingly. In principle, one may also use a full Bayesian approach and Markov Chain Monte Carlo (MCMC) to perform the posterior inference. However, since MCMC usually takes much longer to run for a big dataset and it is not easy for users to monitor convergence, we decided to use the posterior mode and EM-based approach in our implementation. For analyzing the GM12878 data with 94,519 SNPs, iASeq took 5 hours to run the EM algorithm to fit a single model with <italic>K</italic>=1 on a machine with 2.7 GHz CPU and 4Gb RAM. To fit a single model with <italic>K</italic>=10 on the same machine, the EM took 16 hours. Running the EM for all 10 <italic>K</italic>s between 1 and 10 on a single core took 4.6 days. However, when we run these 10 jobs in parallel on 10 cluster nodes, we were able to select the best model within 1 day. Therefore, running the algorithm on a single machine is a little time-consuming, but the computation time can be reduced by parallelization. Also, our analysis of GM12878 data indicates that the optimal <italic>K</italic> in that real data was 2. For a <italic>K</italic> not extremely large, even if running the full BIC selection on a single machine takes some time, it usually requires less than a week, which is acceptable compared to the time devoted to preparing samples and generating data.</p>
      <p>In principle, the statistical model developed in iASeq may also be applied to analyze other types of AS events, such as ASE and ASM. In the future, we plan to improve the model by incorporating information from the spatial correlation among closely located SNPs. For example, for the ASE analysis, one may jointly model SNPs from the same gene, similar to [<xref ref-type="bibr" rid="B33">33</xref>].</p>
    </sec>
    <sec>
      <title>Implications on future studies</title>
      <p>The analysis of AS events using the high-throughput sequencing data frequently faces the problem of low statistical power due to the limited amount of information available at heterozygote SNPs. One way to increase the power is to increase the sequencing depth for one data type (e.g., MYC ChIP-seq). An alternative approach is to spend the same amount of money to generate data for multiple different but related data types (e.g., ChIP-seq for MYC, H3K4me1, H3K4me3, etc.), each with a lower coverage. One can then integrate the multiple datasets to increase the statistical power of allele-specificity analysis. The merit of the second approach is that one can collect multiple different types of information which might be useful for other purposes (e.g., in addition to studying MYC binding using MYC ChIP-seq, one may couple H3K4me1 ChIP-seq data with DNA motif information to locate active enhancers and predict binding sites of other TFs in the genome). If the second approach is used in the study design, then iASeq will offer a flexible, powerful and scalable framework for better analyzing the AS events in the data. As ChIP-seq data continue to grow rapidly, this integrative approach will allow us to use the data more efficiently to characterize the allele-specificity.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>In summary, we have proposed a Bayesian hierarchical mixture model iASeq to integrate multiple ChIP-seq datasets for analyzing allele-specificity. The primary goal of iASeq is to increase the statistical power of AS detection, and it does so by taking the advantage of correlations among datasets. Since the correlation structure may not be known before the data analysis, iASeq learns it from the data automatically. Application of iASeq to the ENCODE GM12878 data shows that allelic imbalance of most analyzed TFs and HMs have strong preference to be skewed toward the same direction. Analysis of both the simulated and real data show the effectiveness of iASeq to improve detection of allele-specificity compared to single-dataset based methods.</p>
  </sec>
  <sec>
    <title>Abbreviations</title>
    <p>AS: allele-specific; ASB: allele-specific binding, including both allele-specific TF binding and allele-specific histone modifications; ASE: allele-specific expression; ASM: allele-specific DNA methylation; AUC: area under receiver operating characteristic curve; EM: Expectation-Maximization algorithm; FDR: false discovery rate; HM: histone modification; NS: not allele-specific; ROC: receiver operating characteristic curve; SN: skewed to the non-reference allele; SR: skewed to the reference allele; TF: transcription factor.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>Conceive study: HJ. Develop model: HJ, YW. Implementation: YW. Data collection: XL, QW. Data analysis: YW, XL. Write paper: HJ, YW, XL, QW. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Supplemental Methods.</bold> A PDF file including: data preprocessing procedures; method of moment estimation in the beta distribution; parameter choice for the Dirichlet prior; derivation of the EM algorithm for iASeq; Bayesian Information Criterion for choosing K; data generation procedure in simulation studies; single dataset based EM analysis.</p>
      </caption>
      <media xlink:href="1471-2164-13-681-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>Table S1.</bold> Description of all GM12878 ChIP-seq and RNA-seq studies. An excel file showing the name of TF and HM, the number of replicates for each dataset in GM12878 cells.</p>
      </caption>
      <media xlink:href="1471-2164-13-681-S2.xls" mimetype="application" mime-subtype="vnd.ms-excel">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p><bold>Table S2.</bold> Raw read count data for 94,519 analyzed SNPs.</p>
      </caption>
      <media xlink:href="1471-2164-13-681-S3.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S4">
      <caption>
        <title>Additional file 4</title>
        <p><bold>Supplemental comparison of defining allele-specific SNPs as SNPs that have RNA-seq exonic ASE SNPs in their 1kb neighborhood.</bold> Supplemental Figure <xref ref-type="fig" rid="F3">3</xref> — ROC curves for GM12878 using Caltech Exonic RNA-seq ASE SNPs as gold standard. Supplemental Figure <xref ref-type="fig" rid="F4">4</xref> — ROC curves for GM12878 using Caltech autosomal exonic RNA-seq ASE SNPs as gold standard. Supplemental Figure 5 — ROC curves for GM12878 using Yale Exonic RNA-seq ASE SNPs as gold standard. Supplemental Figure 6 — ROC curves for GM12878 using Yale autosomal exonic RNA-seq ASE SNPs as gold standard. Supplemental Table 4 — Comparison of iASeq and AlleleSeq using Caltech RNA-seq exonic ASE SNPs as gold standard. Supplemental Table 5 — Comparison of iASeq and AlleleSeq using Yale RNA-seq exonic ASE SNPs as gold standard.</p>
      </caption>
      <media xlink:href="1471-2164-13-681-S4.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S5">
      <caption>
        <title>Additional file 5</title>
        <p><bold>Figure S1.</bold> ROC curves for GM12878 using Yale Exonic RNA-seq ASE SNPs as gold standard.</p>
      </caption>
      <media xlink:href="1471-2164-13-681-S5.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S6">
      <caption>
        <title>Additional file 6</title>
        <p><bold>Figure S2.</bold> ROC curves for GM12878 using Yale autosomal exonic RNA-seq ASE SNPs as gold standard.</p>
      </caption>
      <media xlink:href="1471-2164-13-681-S6.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S7">
      <caption>
        <title>Additional file 7</title>
        <p><bold>Table S3.</bold> Comparison of iASeq and AlleleSeq using Yale RNA-seq exonic ASE SNPs as gold standard.</p>
      </caption>
      <media xlink:href="1471-2164-13-681-S7.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S8">
      <caption>
        <title>Additional file 8</title>
        <p><bold>Figure S7.</bold> The ROC curves for comparison between AlleleSeq and iASeq.</p>
      </caption>
      <media xlink:href="1471-2164-13-681-S8.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>This work was supported by the National Institute of Health grant R01HG006841 to HJ, the Strategic Priority Research Program of the Chinese Academy of Sciences, Grant No. XDA01010305 and Hundred Talents Program of the Chinese Academy of Sciences to QW. The authors would like to acknowledge Dr. Joel Rozowsky and Dr. Mark Gerstein for providing AlleleSeq data on GM12878 for the method comparisons.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bell</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Beck</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Advances in the identification and analysis of allele specific expression</article-title>
        <source>Genome Med</source>
        <year>2009</year>
        <volume>1</volume>
        <fpage>56</fpage>
        <pub-id pub-id-type="doi">10.1186/gm56</pub-id>
        <pub-id pub-id-type="pmid">19490587</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Graze</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Novelo</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Amin</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Fear</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Casella</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Nuzhdin</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>McIntyre</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Allelic imbalance in Drosophila hybrid heads: exons, isoforms, and evolution</article-title>
        <source>Mol Biol Evol</source>
        <year>2012</year>
        <volume>29</volume>
        <fpage>1521</fpage>
        <lpage>1532</lpage>
        <pub-id pub-id-type="doi">10.1093/molbev/msr318</pub-id>
        <pub-id pub-id-type="pmid">22319150</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Knight</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Allele-specific gene expression uncovered</article-title>
        <source>Trends Genet</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>113</fpage>
        <lpage>116</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tig.2004.01.001</pub-id>
        <pub-id pub-id-type="pmid">15049300</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chen</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Mias</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Li-Pook-Than</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Jiang</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Lam</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Miriami</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Karczewski</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Hariharan</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Dewey</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Cheng</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Clark</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Im</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Habegger</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Balasubramanian</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>O’Huallachain</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Dudley</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Hillenmeyer</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Haraksingh</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Sharon</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Euskirchen</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Lacroute</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Bettinger</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Boyle</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Kasowski</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Grubert</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Seki</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Garcia</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Whirl-Carrillo</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Gallardo</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Blasco</surname>
          <given-names>M</given-names>
        </name>
        <etal/>
        <article-title>Personal omics profiling reveals dynamic molecular and medical phenotypes</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>148</volume>
        <fpage>1293</fpage>
        <lpage>1307</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.02.009</pub-id>
        <pub-id pub-id-type="pmid">22424236</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>McDaniell</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Song</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Boyle</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Erdos</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Scott</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Morken</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Kucera</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Battenhouse</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Keefe</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Collins</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Willard</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Lieb</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Furey</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Crawford</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Iyer</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Birney</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Heritable individual-specific and allele-specific chromatin signatures in humans</article-title>
        <source>Science</source>
        <year>2010</year>
        <volume>328</volume>
        <fpage>235</fpage>
        <lpage>239</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1184655</pub-id>
        <pub-id pub-id-type="pmid">20299549</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kasowski</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Grubert</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Heffelfinger</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Hariharan</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Asabere</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Waszak</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Habegger</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Rozowsky</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Shi</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Urban</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Hong</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Karczewski</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Huber</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Weissman</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Gerstein</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Korbel</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Snyder</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Variation in transcription factor binding among humans</article-title>
        <source>Science</source>
        <year>2010</year>
        <volume>328</volume>
        <fpage>232</fpage>
        <lpage>235</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1183621</pub-id>
        <pub-id pub-id-type="pmid">20299548</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kerkel</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Spadola</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Yuan</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Kosek</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Jiang</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Hod</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Murty</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Schupf</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Vilain</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Morris</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Haghighi</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Tycko</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Genomic surveys by methylation-sensitive SNP analysis identify sequence-dependent allele-specific DNA methylation</article-title>
        <source>Nat Genet</source>
        <year>2008</year>
        <volume>40</volume>
        <fpage>904</fpage>
        <lpage>908</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.174</pub-id>
        <pub-id pub-id-type="pmid">18568024</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Morley</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Molony</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Weber</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Devlin</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Ewens</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Spielman</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Cheung</surname>
          <given-names>V</given-names>
        </name>
        <article-title>Genetic analysis of genome-wide variation in human gene expression</article-title>
        <source>Nature</source>
        <year>2004</year>
        <volume>430</volume>
        <fpage>743</fpage>
        <lpage>747</lpage>
        <pub-id pub-id-type="doi">10.1038/nature02797</pub-id>
        <pub-id pub-id-type="pmid">15269782</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schilling</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>El Chartouni</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Rehli</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Allele-specific DNA methylation in mouse strains is mainly determined by cis-acting sequences</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>2028</fpage>
        <lpage>2035</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.095562.109</pub-id>
        <pub-id pub-id-type="pmid">19687144</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tycko</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Allele-specific DNA methylation: beyond imprinting</article-title>
        <source>Hum Mol Genet</source>
        <year>2010</year>
        <volume>19</volume>
        <fpage>R210</fpage>
        <lpage>220</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddq376</pub-id>
        <pub-id pub-id-type="pmid">20855472</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhang</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Gao</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Egli</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Xie</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Deng</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Aach</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Leproust</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Eggan</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Church</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Digital RNA allelotyping reveals tissue-specific and allele-specific gene expression in human</article-title>
        <source>Nat Methods</source>
        <year>2009</year>
        <volume>6</volume>
        <fpage>613</fpage>
        <lpage>618</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1357</pub-id>
        <pub-id pub-id-type="pmid">19620972</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cui</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Cruz-Correa</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Giardiello</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Hutcheon</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Kafonek</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Brandenburg</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Wu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>He</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Powe</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Feinberg</surname>
          <given-names>A</given-names>
        </name>
        <article-title>Loss of IGF2 imprinting: a potential marker of colorectal cancer risk</article-title>
        <source>Science</source>
        <year>2003</year>
        <volume>299</volume>
        <fpage>1753</fpage>
        <lpage>1755</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1080902</pub-id>
        <pub-id pub-id-type="pmid">12637750</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Holt</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Binia</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Dixon</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Vandiedonck</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Cookson</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Knight</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Moffatt</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Allele-specific transcription of the asthma-associated PHD finger protein 11 gene (PHF11) modulated by octamer-binding transcription factor 1 (Oct-1)</article-title>
        <source>J Allergy Clin Immunol</source>
        <year>2011</year>
        <volume>127</volume>
        <fpage>1054</fpage>
        <lpage>1062 e 1051–1052</lpage>
        <pub-id pub-id-type="doi">10.1016/j.jaci.2010.12.015</pub-id>
        <pub-id pub-id-type="pmid">21320718</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Heap</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Downes</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Healy</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Hunt</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Bockett</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Franke</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Dubois</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Mein</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Dobson</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Albert</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Rodesch</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Clayton</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Todd</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>van</surname>
          <given-names>HD</given-names>
        </name>
        <name>
          <surname>Plagnol</surname>
          <given-names>V</given-names>
        </name>
        <article-title>Genome-wide analysis of allelic expression imbalance in human primary cells by high-throughput transcriptome resequencing</article-title>
        <source>Human Mol Genet</source>
        <year>2010</year>
        <volume>19</volume>
        <fpage>122</fpage>
        <lpage>134</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddp473</pub-id>
        <pub-id pub-id-type="pmid">19825846</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tuch</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Laborde</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Xu</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Gu</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Chung</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Monighetti</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Stanley</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Olsen</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Kasperbauer</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Moore</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Broomer</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Tan</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Brzoska</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Muller</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Siddiqui</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Asmann</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Sun</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Kuersten</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Barker</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>De</surname>
          <given-names>LVF</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Tumor transcriptome sequencing reveals allelic expression imbalances associated with copy number alterations</article-title>
        <source>PLoS One</source>
        <year>2010</year>
        <volume>5</volume>
        <issue>2</issue>
        <fpage>e9317</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0009317</pub-id>
        <pub-id pub-id-type="pmid">20174472</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ben-David</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Granot-Hershkovitz</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Monderer-Rothkoff</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Lerer</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Levi</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Yaari</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Ebstein</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Yirmiya</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Shifman</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Identification of a functional rare variant in autism using genome-wide screen for monoallelic expression</article-title>
        <source>Hum Mol Genet</source>
        <year>2011</year>
        <volume>20</volume>
        <fpage>3632</fpage>
        <lpage>3641</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddr283</pub-id>
        <pub-id pub-id-type="pmid">21680558</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lo</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Hu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Gere</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Buetow</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Allelic variation in gene expression is common in the human genome</article-title>
        <source>Genome Res</source>
        <year>2003</year>
        <volume>13</volume>
        <fpage>1855</fpage>
        <lpage>1862</lpage>
        <pub-id pub-id-type="pmid">12902379</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Palacios</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Gazave</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Goni</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Piedrafita</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Fernando</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Navarro</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Villoslada</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Allele-specific gene expression is widespread across the genome and biological processes</article-title>
        <source>PLoS One</source>
        <year>2009</year>
        <volume>4</volume>
        <issue>1</issue>
        <fpage>e4150</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0004150</pub-id>
        <pub-id pub-id-type="pmid">19127300</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Serre</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Gurd</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Ge</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Sladek</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Sinnett</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Harmsen</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Bibikova</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Chudin</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Barker</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Dickinson</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Fan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Hudson</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Differential allelic expression in the human genome: a robust approach to identify genetic and epigenetic cis-acting mechanisms regulating gene expression</article-title>
        <source>PLoS Genet</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>e1000006</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.1000006</pub-id>
        <pub-id pub-id-type="pmid">18454203</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chen</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Feng</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Joo</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Jacobsen</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Pellegrini</surname>
          <given-names>M</given-names>
        </name>
        <article-title>A comparative analysis of DNA methylation across human embryonic stem cell lines</article-title>
        <source>Genome Biol</source>
        <year>2011</year>
        <volume>12</volume>
        <fpage>R62</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2011-12-7-r62</pub-id>
        <pub-id pub-id-type="pmid">21733148</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Montgomery</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Sammeth</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Gutierrez-Arcelus</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Lach</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Ingle</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Nisbett</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Guigo</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Dermitzakis</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Transcriptome genetics using second generation sequencing in a Caucasian population</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>464</volume>
        <fpage>773</fpage>
        <lpage>U151</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08903</pub-id>
        <pub-id pub-id-type="pmid">20220756</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Pickrell</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Marioni</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Pai</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Degner</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Engelhardt</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Nkadori</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Veyrieras</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Stephens</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Gilad</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Pritchard</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Understanding mechanisms underlying human gene expression variation with RNA sequencing</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>464</volume>
        <fpage>768</fpage>
        <lpage>772</lpage>
        <pub-id pub-id-type="doi">10.1038/nature08872</pub-id>
        <pub-id pub-id-type="pmid">20220758</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ju</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Hong</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Park</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Shin</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Yu</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Park</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Seo</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Yun</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Yavartanoo</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Kang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Gokcumen</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Govindaraju</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Jung</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Chong</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Yang</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Seo</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Extensive genomic and transcriptional diversity identified through massively parallel DNA and RNA sequencing of eighteen Korean individuals</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>43</volume>
        <fpage>745</fpage>
        <lpage>U747</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.872</pub-id>
        <pub-id pub-id-type="pmid">21725310</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tang</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Barbacioru</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Nordman</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Bao</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Tuch</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Heard</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Lao</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Surani</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Deterministic and stochastic allele specific gene expression in single mouse blastomeres</article-title>
        <source>PLoS One</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>6</issue>
        <fpage>e21208</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0021208</pub-id>
        <pub-id pub-id-type="pmid">21731673</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Barski</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Cuddapah</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Cui</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Roh</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Schones</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Wei</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Chepelev</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>K</given-names>
        </name>
        <article-title>High-resolution profiling of histone methylations in the human genome</article-title>
        <source>Cell</source>
        <year>2007</year>
        <volume>129</volume>
        <fpage>823</fpage>
        <lpage>837</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2007.05.009</pub-id>
        <pub-id pub-id-type="pmid">17512414</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Johnson</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Mortazavi</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Myers</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Wold</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Genome-wide mapping of in vivo protein-DNA interactions</article-title>
        <source>Science</source>
        <year>2007</year>
        <volume>316</volume>
        <fpage>1497</fpage>
        <lpage>1502</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1141319</pub-id>
        <pub-id pub-id-type="pmid">17540862</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mikkelsen</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Ku</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Jaffe</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Issac</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Lieberman</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Giannoukos</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Alvarez</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Brockman</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Koche</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Mendenhall</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>O’Donovan</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Presser</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Russ</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Xie</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Meissner</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Wernig</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Jaenisch</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Nusbaum</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Lander</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Bernstein</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Genome-wide maps of chromatin state in pluripotent and lineage-committed cells</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>448</volume>
        <fpage>553</fpage>
        <lpage>560</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06008</pub-id>
        <pub-id pub-id-type="pmid">17603471</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Robertson</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Hirst</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Bainbridge</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Bilenky</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Zeng</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Euskirchen</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Bernier</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Varhol</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Delaney</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Thiessen</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Griffith</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>He</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Marra</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Snyder</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Jones</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Genome-wide profiles of STAT1 DNA association using chromatin immunoprecipitation and massively parallel sequencing</article-title>
        <source>Nat Methods</source>
        <year>2007</year>
        <volume>4</volume>
        <fpage>651</fpage>
        <lpage>657</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth1068</pub-id>
        <pub-id pub-id-type="pmid">17558387</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chen</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Wu</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Ji</surname>
          <given-names>H</given-names>
        </name>
        <article-title>hmChIP: a database and web server for exploring publicly available human and mouse ChIP-seq and ChIP-chip data</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>1447</fpage>
        <lpage>1448</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr156</pub-id>
        <pub-id pub-id-type="pmid">21450710</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="other">
        <article-title>hmChIP Database</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://jilab.biostat.jhsph.edu/database/cgi-bin/hmChIP.pl">http://jilab.biostat.jhsph.edu/database/cgi-bin/hmChIP.pl</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Degner</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Marioni</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Pai</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Pickrell</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Nkadori</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Gilad</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Pritchard</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Effect of read-mapping biases on detecting allele-specific expression from RNA-sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>3207</fpage>
        <lpage>3212</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp579</pub-id>
        <pub-id pub-id-type="pmid">19808877</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rozowsky</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Abyzov</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Alves</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Raha</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Harmanci</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Leng</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Bjornson</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Kong</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Kitabayashi</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Bhardwaj</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Rubin</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Snyder</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Gerstein</surname>
          <given-names>M</given-names>
        </name>
        <article-title>AlleleSeq: analysis of allele-specific expression and binding in a network framework</article-title>
        <source>Mol Syst Biol</source>
        <year>2011</year>
        <volume>7</volume>
        <fpage>522</fpage>
        <pub-id pub-id-type="pmid">21811232</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Skelly</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Johansson</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Madeoy</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wakefield</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Akey</surname>
          <given-names>J</given-names>
        </name>
        <article-title>A powerful and flexible statistical framework for testing hypotheses of allele-specific gene expression from RNA-seq data</article-title>
        <source>Genome Res</source>
        <year>2011</year>
        <volume>21</volume>
        <fpage>1728</fpage>
        <lpage>1737</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.119784.110</pub-id>
        <pub-id pub-id-type="pmid">21873452</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal">
        <collab>Consortium EP</collab>
        <article-title>The ENCODE (ENCyclopedia Of DNA Elements) Project</article-title>
        <source>Science</source>
        <year>2004</year>
        <volume>306</volume>
        <fpage>636</fpage>
        <lpage>640</lpage>
        <pub-id pub-id-type="pmid">15499007</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="other">
        <comment>Bioconductor iASeq package. [<ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/bioc/html/iASeq.html">http://www.bioconductor.org/packages/release/bioc/html/iASeq.html</ext-link>]</comment>
      </mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal">
        <article-title>The ENCODE Project Consortium. An integrated encyclopedia of DNA elements in the human genome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <fpage>57</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11247</pub-id>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="other">
        <article-title>GM12878 genotype</article-title>
        <ext-link ext-link-type="ftp" xlink:href="ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/pilot_data/release/2010_07/trio/snps">ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/pilot_data/release/2010_07/trio/snps</ext-link>
      </mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Reddy</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Gertz</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Pauli</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Kucera</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Varley</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Newberry</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Marinov</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Mortazavi</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Williams</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Song</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Crawford</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Wod</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Willard</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Myers</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Effects of sequence variation on differential allelic transcription factor occupancy and gene expression</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <fpage>860</fpage>
        <lpage>869</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.131201.111</pub-id>
        <pub-id pub-id-type="pmid">22300769</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kucera</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Reddy</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Pauli</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Gertz</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Logan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Myers</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Willard</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Allele-specific distribution of RNA polymerase II on female X chromosomes</article-title>
        <source>Hum Mol Genet</source>
        <year>2011</year>
        <volume>20</volume>
        <fpage>3964</fpage>
        <lpage>3973</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddr315</pub-id>
        <pub-id pub-id-type="pmid">21791549</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
