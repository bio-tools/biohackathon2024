<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8428605</article-id>
    <article-id pub-id-type="pmid">33693483</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab162</article-id>
    <article-id pub-id-type="publisher-id">btab162</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MixTwice: large-scale hypothesis testing for peptide arrays by variance mixing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8166-0649</contrib-id>
        <name>
          <surname>Zheng</surname>
          <given-names>Zihao</given-names>
        </name>
        <aff><institution>Department of Statistics, University of Wisconsin-Madison</institution>, Madison, WI 53706, <country country="US">USA</country></aff>
        <aff><institution>Department of Medicine, University of Wisconsin-Madison</institution>, Madison, WI 53705, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mergaert</surname>
          <given-names>Aisha M.</given-names>
        </name>
        <aff><institution>Department of Medicine, University of Wisconsin-Madison</institution>, Madison, WI 53705, <country country="US">USA</country></aff>
        <aff><institution>Department of Pathology and Laboratory Medicine, University of Wisconsin-Madison</institution>, Madison, WI 53705-2281, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ong</surname>
          <given-names>Irene M.</given-names>
        </name>
        <aff><institution>Department of Biostatistics and Medical Informatics, University of Wisconsin-Madison</institution>, Madison, WI 53726, <country country="US">USA</country></aff>
        <aff><institution>Department of Obstetrics and Gynecology, University of Wisconsin-Madison</institution>, Madison, WI 53792, <country country="US">USA</country></aff>
        <aff><institution>University of Wisconsin Carbone Comprehensive Cancer Center, University of Wisconsin-Madison</institution>, Madison, WI 53792, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shelef</surname>
          <given-names>Miriam A.</given-names>
        </name>
        <aff><institution>Department of Medicine, University of Wisconsin-Madison</institution>, Madison, WI 53705, <country country="US">USA</country></aff>
        <aff><institution>William S. Middleton Memorial Veterans Hospital</institution>, Madison, WI 53705, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Newton</surname>
          <given-names>Michael A.</given-names>
        </name>
        <xref rid="btab162-cor1" ref-type="corresp"/>
        <aff><institution>Department of Statistics, University of Wisconsin-Madison</institution>, Madison, WI 53706, <country country="US">USA</country></aff>
        <aff><institution>Department of Biostatistics and Medical Informatics, University of Wisconsin-Madison</institution>, Madison, WI 53726, <country country="US">USA</country></aff>
        <aff><institution>University of Wisconsin Carbone Comprehensive Cancer Center, University of Wisconsin-Madison</institution>, Madison, WI 53792, <country country="US">USA</country></aff>
        <!--newton@stat.wisc.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Valencia</surname>
          <given-names>Alfonso</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab162-cor1">To whom correspondence should be addressed. <email>newton@stat.wisc.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-03-08">
      <day>08</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>08</day>
      <month>3</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>17</issue>
    <fpage>2637</fpage>
    <lpage>2643</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>11</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>26</day>
        <month>2</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>05</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab162.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Peptide microarrays have emerged as a powerful technology in immunoproteomics as they provide a tool to measure the abundance of different antibodies in patient serum samples. The high dimensionality and small sample size of many experiments challenge conventional statistical approaches, including those aiming to control the false discovery rate (FDR). Motivated by limitations in reproducibility and power of current methods, we advance an empirical Bayesian tool that computes local FDR statistics and local false sign rate statistics when provided with data on estimated effects and estimated standard errors from all the measured peptides. As the name suggests, the MixTwice tool involves the estimation of two mixing distributions, one on underlying effects and one on underlying variance parameters. Constrained optimization techniques provide for model fitting of mixing distributions under weak shape constraints (unimodality of the effect distribution). Numerical experiments show that MixTwice can accurately estimate generative parameters and powerfully identify non-null peptides. In a peptide array study of rheumatoid arthritis, MixTwice recovers meaningful peptide markers in one case where the signal is weak, and has strong reproducibility properties in one case where the signal is strong.</p>
      </sec>
      <sec id="s2">
        <title>Availabilityand implementation</title>
        <p>MixTwice is available as an R software package <ext-link xlink:href="https://cran.r-project.org/web/packages/MixTwice/" ext-link-type="uri">https://cran.r-project.org/web/packages/MixTwice/</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Peer Reviewed Medical Research Program (US Army Medical Research</institution>
          </institution-wrap>
        </funding-source>
        <award-id>W81XWH1810717</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>University of Wisconsin-Madison, Office of the Vice Chancellor for Research and Graduate Education with funding from the Wisconsin Alumni Research Foundation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01 GM102756</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>P50 DE026787</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NSF</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>1740707</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Clinical and Translational Science Award (CTSA) program</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health National Center for Advancing Translational Sciences (NCATS)</institution>
          </institution-wrap>
        </funding-source>
        <award-id>UL1TR002373</award-id>
        <award-id>KL2TR002374</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Peptide microarray technology is used in biology, medicine and pharmacology to measure various forms of protein interaction. Like other microarrays, a peptide array contains a large number of very small probes arranged on a glass or plastic chip. Each probe occupies a spatial position on the array and is comprised of many molecular copies of a short amino-acid sequence (a peptide) anchored to the surface, perhaps 12–16 amino acids in length, depending on the design. In antibody profiling experiments, the array is exposed to serum derived from a donor’s blood sample; antibodies in the sample that recognize an anchored peptide epitope may bind to the probe. In order to measure these antibody/antigen binding events, a second, fluorescently tagged antibody is applied, which binds to exposed sites on the already-bound antibodies, providing quantitative readout at probes where there has been sufficient binding of serum antibody recognizing the peptide epitopes. High-density peptide microarrays have emerged as a powerful technology in immunoproteomics, as they enable simultaneous antibody binding measurements against millions of peptide epitopes. Such arrays have guided the discovery of markers for viral, bacterial and parasitic infections (<xref rid="btab162-B4" ref-type="bibr">Bailey <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab162-B15" ref-type="bibr">Mishra <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab162-B26" ref-type="bibr">Tokarz et al., 2020</xref>) and have illuminated the serological response to cancer (<xref rid="btab162-B29" ref-type="bibr">Yan et al., 2019</xref>) and cancer immunotherapy (<xref rid="btab162-B11" ref-type="bibr">Hoefges <italic toggle="yes">et al.</italic>, 2020</xref>). The photolithographic design allows for custom arrays, which have benefited studies of autoimmunity, for example, where various forms of post-translational modification (e.g. citrullination) create targets for autoantibodies (<xref rid="btab162-B3" ref-type="bibr">Bailey <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab162-B30" ref-type="bibr">Zheng et al., 2020</xref>).</p>
    <p>The high dimensionality and small sample size of many peptide array experiments challenge conventional statistical approaches. <xref rid="btab162-B30" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> (2020)</xref>, for example, reported a custom peptide array having 172 828 distinct features and array data from 60 human subjects across several disease subsets. This dimensionality is relatively high compared to gene expression studies, but quite low compared to other peptide array studies; arrays that probe the entire human proteome carry over 6 million peptide features, for example. Methods for large-scale hypothesis testing respond to these challenges, often aiming to control the false discovery rate (FDR) (e.g. <xref rid="btab162-B9" ref-type="bibr">Efron, 2012</xref>). FDR-controlling procedures are more forgiving than techniques that control the probability of any type I errors (e.g. Bonferroni correction), but they still extract a high penalty for dimensionality in the peptide array regime involving 10<sup>5</sup>–10<sup>6</sup> features. When additional data are available, it may be possible to further limit penalties associated with large-scale testing.</p>
    <p>Continuing with <xref rid="btab162-B30" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> (2020)</xref>, the authors sought to identify peptides for which antibody binding levels differ between control subjects and rheumatoid arthritis (RA) patients expressing a specific disease marker combination [cyclic citrullinated peptide (CCP)<sup>+</sup> and rheumatoid factor (RF−)]. Sera from 12 subjects in each group were applied to their custom-built array. After pre-processing, a univariate statistic (<italic toggle="yes">t</italic>-statistic) measured statistical changes at each peptide. Peptides with the most extreme statistics (and smallest <italic toggle="yes">P</italic>-values) would be set aside for further validation. In the CCP<sup>+</sup> RF− RA example, no peptides had a FDR-adjusted <italic toggle="yes">P</italic>-value &lt;10% by either the Benjamini–Hochberg (BH) method (<xref rid="btab162-B6" ref-type="bibr">Benjamini and Hochberg, 1995</xref>) or the more sensitive <italic toggle="yes">q</italic>-value method (<xref rid="btab162-B23" ref-type="bibr">Storey, 2003</xref>), although the latter method estimated that 21% of the peptides in fact have differential binding between the two groups.</p>
    <p>Improving power while maintaining robustness and reproducibility is a theme of contemporary large-scale inference that we explore in the peptide array setting. The BH and <italic toggle="yes">q</italic>-value procedures yield no discoveries in the CCP<sup>+</sup> RF− RA example at one conventional FDR level. If this is due to low statistical power, it may not be surprising since these procedures enter quite late in data analysis, after all <italic toggle="yes">P</italic>-values have been computed. Procedures that intervene earlier have access to more information, and thereby may have better overall operating characteristics. Efron’s local FDR approach, locFDR, intervenes on test statistics just prior to <italic toggle="yes">P</italic>-value computation and has improved power properties in some settings (<xref rid="btab162-B10" ref-type="bibr">Efron <italic toggle="yes">et al.</italic>, 2001</xref>). Independent filtering combines a selection statistic, such as marginal sample variance, and then applies an FDR-controlling procedure to the selected peptides (<xref rid="btab162-B7" ref-type="bibr">Bourgon <italic toggle="yes">et al.</italic>, 2010</xref>). Neither locFDR nor independent filtering at 50% yielded any results in the CCP<sup>+</sup> RF− RA example, as it happens. We have the same null finding by independent hypothesis weighting (IHW), which generalizes independent filtering in not requiring a specific selection rate (<xref rid="btab162-B12" ref-type="bibr">Ignatiadis <italic toggle="yes">et al.</italic>, 2016</xref>).</p>
    <p>Adaptive Shrinkage (ASH) is a recent innovation for large-scale testing that intervenes after each peptide yields both an estimated effect and an estimated standard error (<xref rid="btab162-B22" ref-type="bibr">Stephens, 2017</xref>). There are several variations of its empirical Bayesian formulation; when using the <italic toggle="yes">t</italic>-distribution sampling model version of ASH (say ASH-t), we discover 76 peptides to have differential antibody binding in the CCP<sup>+</sup> RF− RA comparison, also at 10% FDR control. This may reflect increased power and is consistent with numerical studies showing increased power of ASH in many settings. A recent report from Professor Stephens’s group points out a technical limitation of ASH-t that could cause FDR inflation. It proposes a two-step ASH procedure that pre-processes the standard error estimates and then follows with the ASH-t procedure on modified input (<xref rid="btab162-B14" ref-type="bibr">Lu and Stephens, 2019</xref>). It happens that we discover 12 peptides with differential binding affinity by two-step ASH at 10% FDR. The different behavior of FDR-controlling procedures in the CCP<sup>+</sup> RF− RA example exposes ongoing practical challenges that are also revealed in comprehensive numerical studies (<xref rid="btab162-B13" ref-type="bibr">Korthauer <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
    <p>Data analysts face many issues as they filter high-dimensional measurements into short lists for experimental follow-up. In studying this problem, we propose and evaluate a flexible empirical Bayesian mixture method that, like ASH, intervenes after effect estimates and standard errors are computed on each testing unit. The proposed MixTwice procedure involves shape-constrained mixture distribution for latent effects and also a separate non-parametric mixture for variance parameters (Section 2). We leverage existing tools for constrained optimization in order to estimate the underlying mixing distributions, and we present a variety of comparative numerical experiments on the operating characteristics of MixTwice. The CCP<sup>+</sup> RF− RA peptide array example happens to yield 44 peptides having significant differential antibody binding at 10% FDR. A closer look at the identified peptides reveals binding patterns consistent with other biological information about RA, and thus provides a measure of confidence that these discoveries are not artifacts. In a second RA example where differential signals are stronger, MixTwice shows a higher level of reproducibility than other approaches when presented with two independent datasets on the same populations.</p>
  </sec>
  <sec>
    <title>2 Mixture model</title>
    <p>We index peptides by <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula> and suppose that the two-group peptide array data have been obtained and pre-processed in order to yield two summary statistics per peptide: (<italic toggle="yes">x<sub>i</sub></italic>, <italic toggle="yes">s<sub>i</sub></italic>). The first component, <italic toggle="yes">x<sub>i</sub></italic>, is an estimated effect. It measures the difference between the two groups, such as a difference in sample means of log-transformed data, and is viewed as statistical estimate of an underlying effect, say <italic toggle="yes">θ<sub>i</sub></italic>. In this view, <italic toggle="yes">x<sub>i</sub></italic> is a random variable having some sampling distribution, which we take to be Gaussian centered at <italic toggle="yes">θ<sub>i</sub></italic>; this is warranted noting the behavior of suitably transformed fluorescence measurements coupled with central-limit effects for modest to large sample sizes. The second component, <italic toggle="yes">s<sub>i</sub></italic>, is an estimated standard error. In the Gaussian sampling model, <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and var<inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> is a sample-based estimate of the variance <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>. We seek inference about the value of <italic toggle="yes">θ<sub>i</sub></italic> using local data (<italic toggle="yes">x<sub>i</sub></italic>, <italic toggle="yes">s<sub>i</sub></italic>) as well as data <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> from all peptides, which informs the distribution of effect and variance parameters across the array.</p>
    <p>Our formulation is common in large-scale inference, and we could infer <italic toggle="yes">θ<sub>i</sub></italic> values in a number of ways. For example, we could produce a peptide-specific <italic toggle="yes">P</italic>-value from the test statistic <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> against the null hypothesis <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. We might refer <italic toggle="yes">t<sub>i</sub></italic> to a Student-<italic toggle="yes">t</italic> distribution, obtain a two-sided <italic toggle="yes">P</italic>-value, and then process the <italic toggle="yes">P</italic>-values through the BH or <italic toggle="yes">q</italic>-value methods to adjust for multiplicity (<xref rid="btab162-B6" ref-type="bibr">Benjamini and Hochberg, 1995</xref>; <xref rid="btab162-B23" ref-type="bibr">Storey, 2003</xref>). Alternatively, we might use the collection <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and model their fluctuations as a discrete mixture of null and non-null cases, as in the locFDR procedure (<xref rid="btab162-B10" ref-type="bibr">Efron <italic toggle="yes">et al.</italic>, 2001</xref>; <xref rid="btab162-B24" ref-type="bibr">Strimmer, 2008</xref>). Both locFDR and <italic toggle="yes">q</italic>-value methods are based upon discrete mixtures; interestingly, the reduction of <italic toggle="yes">t<sub>i’</sub></italic>s to two-sided <italic toggle="yes">P</italic>-values entails a loss of sign information that is enough to reduce statistical power in some settings. A more ambitious approach goes beyond null/non-null mixing to allow a full probability distribution of effects <italic toggle="yes">θ<sub>i</sub></italic> in order to account for fluctuations across all the peptides. ASH is appealing because it acquires robustness through a non-parametric treatment of this distribution, say <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, while using reasonable shape constraints to regularize the estimation (<xref rid="btab162-B22" ref-type="bibr">Stephens, 2017</xref>). Power advantages of ASH over other methods stem in part from its use of more data per peptide.</p>
    <p>In the context of an estimated mixture model there are two useful empirical-Bayesian inference statistics. The first is local FDR (lfdr), <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The term <italic toggle="yes">local</italic> FDR was coined by Professor Efron, and the statistic may be computed in various settings beyond the specific mixture deployed in <xref rid="btab162-B10" ref-type="bibr">Efron <italic toggle="yes">et al.</italic> (2001)</xref>. The list <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> of statistically significant peptides will be <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mi>ℓ</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>c</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> for some threshold <italic toggle="yes">c</italic>. Notably, small <italic toggle="yes">l<sub>i</sub></italic> warrants peptide <italic toggle="yes">i</italic> to be placed in <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>; but the value <italic toggle="yes">l<sub>i</sub></italic> is also the probability (conditional on data) that such placement is erroneous (<xref rid="btab162-B16" ref-type="bibr">Newton <italic toggle="yes">et al.</italic>, 2006</xref>). Given the data, the expected rate of false discoveries in <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mi>ℓ</mml:mi></mml:math></inline-formula> is dominated by <italic toggle="yes">c</italic>. The local false sign rate (lfsr) is analogous to lfdr, but it avoids relying on effects being precisely zero; when the estimated effect is positive, for example, the lfsr is <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Lists controlling lfsr may be constructed in the same way as <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mi>ℓ</mml:mi></mml:math></inline-formula>, and may be slightly smaller for the same value of <italic toggle="yes">c</italic>. (In the CCP<sup>+</sup> RF− RA example in Section 1, ASH lfsr and lfdr lists are the same at the 10% level.)</p>
    <p>With modest sample sizes, differences between estimated standard errors <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and actual standard errors <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> can affect the performance of existing tools for lfdr and lfds. To better account for these differences, we propose an additional mixture layer involving a sampling model <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, which we derive from normal-theory considerations, and a flexible nonparametric mixing distribution <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. For both nonparametric components—<italic toggle="yes">g</italic> on effects <italic toggle="yes">θ<sub>i</sub></italic> and <italic toggle="yes">h</italic> on squared standard errors <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>—we use finite grids and treat each distribution as a vector of probabilities. We estimate <italic toggle="yes">g</italic> and <italic toggle="yes">h</italic> by maximum likelihood, respecting unimodal shape constraints for <italic toggle="yes">g</italic> (as in ASH), but otherwise allowing any distributional forms.</p>
    <p>Suppose that effects take values in a finite, regular grid <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>K</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> where <italic toggle="yes">a</italic><sub>0</sub> is the presumed mode, taken to be <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> in typical applications in which we aim to retain the null hypothesis of no group difference. We use <italic toggle="yes">K </italic>=<italic toggle="yes"> </italic>15 in numerical work reported here. Unimodality of the mixing distribution <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is expressed as a set of ordering constraints: <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. We also set a second regular grid <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> for squared standard errors, and impose no constraints on the mixing distribution <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> aside from the basic nonparametric essentials: <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
    <p>The contribution to the likelihood objective from peptide <italic toggle="yes">i</italic> is <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>|</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>: 
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:mi mathvariant="double-struck">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>ϕ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mo>ν</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>ν</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>ν</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>where <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mo>ϕ</mml:mo></mml:math></inline-formula> is the standard normal probability density, <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>ν</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the density of a chi-square random variable on <italic toggle="yes">ν</italic> degrees of freedom. Under a normal data model, <italic toggle="yes">ν</italic> is determined by design (e.g. total samples minus two in the traditional two-sample comparison). The chi-square model is accurate asymptotically for a wide range of non-normal sampling distributions, however the degrees of freedom needs estimation in these cases (<xref rid="btab162-B17" ref-type="bibr">O’Neill, 2014</xref>).</p>
    <p>To estimate the mixing distributions <italic toggle="yes">h</italic> and <italic toggle="yes">g</italic>, we use the log-likelihood objective function, with terms as in (1). In MixTwice, we solve the constrained optimization: 
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow></mml:munder><mml:mo>−</mml:mo><mml:mi>l</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>|</mml:mo><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>Subject</mml:mtext><mml:mo> </mml:mo><mml:mtext>to:</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo> </mml:mo><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>l</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:munder><mml:mo>∑</mml:mo><mml:mi>k</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>}</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
    <p>The gradient and Hessian of <italic toggle="yes">l</italic>(<italic toggle="yes">g</italic>, <italic toggle="yes">h</italic>) are readily available, and so (2) may be solved efficiently using augmented Lagrangian for constrained optimization, using the Broyden–Fletcher–Goldfarb–Shanno algorithm (BFGS) algorithm for inner loop optimization, which is implemented in the R package alabama (<xref rid="btab162-B27" ref-type="bibr">Varadhan, 2015</xref>). We extract lfdr and lfsr statistics from the peptide-specific posterior distributions at the optimized vectors <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>: <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> 
 <disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>∝</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:munder><mml:mo>∑</mml:mo><mml:mi>l</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>ϕ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mo>ν</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mo>χ</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>ν</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>ν</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
    <p>Proportionality is resolved by summation over the grid <italic toggle="yes">k</italic>, and we get: 
<disp-formula id="E4"><mml:math id="M4" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mtext>lfdr</mml:mtext></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mtext>lfsr</mml:mtext></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>min</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≤</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
    <p>It may be helpful to recognize that in contrast to (3), ASH-normal would entail 
<disp-formula id="E5"><label>(4)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>ϕ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and ASH-<italic toggle="yes">t</italic> would replace the normal density <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mo>ϕ</mml:mo></mml:math></inline-formula> in (4) with a Student <italic toggle="yes">t</italic> density; in both cases, the ASH-estimated mixing density <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> would come not from (2) but from an objective in which mixing over variances is not explicitly accommodated. The initial implementation of MixTwice invokes unimodality shape constraint, but not symmetry, and, for computational convenience, allows that a random subset of the testing units is used in the optimization. We investigate this approximation in <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>.</p>
  </sec>
  <sec>
    <title>3 Simulation study</title>
    <p>We are interested in the performance of MixTwice in scenarios reflecting what might be expected to occur in practice and have performed numerical experiments involving different generative distributions of both effects (<italic toggle="yes">g</italic>) and variances (<italic toggle="yes">h</italic>). Noting the special role of the null value, <italic toggle="yes">θ</italic> = 0, our experiments involve mixtures <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mtext>alt</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="double-struck">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mtext>alt</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> provides various ways to distribute mass away from zero. Following <xref rid="btab162-B22" ref-type="bibr">Stephens (2017)</xref> and <xref rid="btab162-B14" ref-type="bibr">Lu and Stephens (2019)</xref>, we entertain different general shapes, including the so-called <italic toggle="yes">big-variance</italic>, <italic toggle="yes">bi-modal</italic>, <italic toggle="yes">flattop</italic>, <italic toggle="yes">normal</italic> and <italic toggle="yes">spiky</italic>. MixTwice accounts for explicit differences between sample and underlying standard errors, and mixes nonparametrically over these underlying standard errors. Our numerical experiments consider the simplest case in which the data generating <italic toggle="yes">h</italic> is a point mass, a case involving a finite mixture of two values, and also a continuous case of inverse-Gamma-distributed parameters. Patterns in the error of estimation and the hypothesis testing error rates are very comparable across different choices of <italic toggle="yes">h</italic>, and so for simplicity here we report only experiments when this true <italic toggle="yes">h</italic> is a point mass distribution. <xref rid="btab162-F1" ref-type="fig">Figures 1</xref> and <xref rid="btab162-F2" ref-type="fig">2</xref> summarize, respectively, properties of estimation accuracy and testing error rates. Experiments are based on Gaussian samples with unit variance, <italic toggle="yes">m </italic>=<italic toggle="yes"> </italic>1000 peptides, and various sample size settings for the two-group comparison.</p>
    <fig position="float" id="btab162-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Errors in estimation of <italic toggle="yes">π</italic><sub>0</sub>. (<bold>A</bold>) Distributions used for <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mtext>alt</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. (<bold>B</bold>) The estimation of null proportion <italic toggle="yes">π</italic><sub>0</sub> in case of equal samples in each group of 10. Methods are distinguished by color, where we report average parameter estimates from 500 simulated datasets. The identity line (dashed) indicates no bias. ASH-normal is an oracle case in which <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> is provided to the algorithm. (<bold>C</bold>) Error estimation as the number of observations grows, in <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula></p>
      </caption>
      <graphic xlink:href="btab162f1" position="float"/>
    </fig>
    <fig position="float" id="btab162-F2">
      <label>Fig. 2.</label>
      <caption>
        <p>Synthetic data and FDR control: FDRs are shown by different methods (rows) under different alternative distributions <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mtext>alt</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (columns). Empirical FDR (vertical) is the achieved error rate in the simulation; controlled FDR (horizontal) is the rate targeted by the methodology. Results with different <italic toggle="yes">π</italic><sub>0</sub> are coded using different colors. A method tends to inflate FDR over the target level if its curve is greater than the identity line; it is conservative when its curve is dominated by the identity line</p>
      </caption>
      <graphic xlink:href="btab162f2" position="float"/>
    </fig>
    <p>If a method tends to overestimate <italic toggle="yes">π</italic><sub>0</sub>, then power may be reduced; in case of underestimation the FDR may be inflated. <xref rid="btab162-F1" ref-type="fig">Figure 1B</xref> focuses on the estimation of this marginal null frequency for one choice of sample size, namely <italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>10 observations per group. In each setting of <italic toggle="yes">g</italic> (column), 500 datasets are generated, each drawn after its own <italic toggle="yes">π</italic><sub>0</sub> value was uniformly drawn in <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. All methods respond appropriately to changes in <italic toggle="yes">π</italic><sub>0</sub>, though they exhibit different biases; MixTwice tracks the identity line (no bias) case closely in all scenarios except the challenging <italic toggle="yes">spiky</italic> case of <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mtext>alt</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. In contrast, locFDR is conservatively biased, tending to over-estimate <italic toggle="yes">π</italic><sub>0</sub> in most cases. Our experiments include an oracle case, namely ASH-normal, which takes the underlying standard errors as known. This numerical control helps us gage the magnitude of statistical errors induced by estimation error of the variance profile.</p>
    <p><xref rid="btab162-F1" ref-type="fig">Figure 1C</xref> amplifies one case from the second row, when <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula>, and shows how estimation error drops as the sample size per peptide grows. Most methods display a level of convergence in this setting, with MixTwice performing relatively well especially at low sample sizes. Going beyond the estimation of <italic toggle="yes">π</italic><sub>0</sub>, we compared methods by their 1-Wassertstein error in estimating the entire mixture distribution <italic toggle="yes">g</italic>; MixTwice showed relatively small error in this setting also (data not shown). MixTwice shares with other nonparametric mixture methods the identifiability problem that only an upper bound on <italic toggle="yes">π</italic><sub>0</sub> may be reliably estimated from limited data (<xref rid="btab162-B10" ref-type="bibr">Efron <italic toggle="yes">et al.</italic>, 2001</xref>; <xref rid="btab162-B22" ref-type="bibr">Stephens, 2017</xref>). This may be appreciated by considering a single unit, <italic toggle="yes">i</italic>, on which the estimated effect <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is a normal deviation from <italic toggle="yes">θ<sub>i</sub></italic>, say with known variance <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, and ignoring the second level of mixing. If <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mtext>alt</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> concentrates enough mass near <italic toggle="yes">θ </italic>= 0, then the null predictive density <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:mo>ϕ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, of <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, may be partially absorbed by the alternative predictive density: i.e. there may be a <italic toggle="yes">c </italic>&gt;<italic toggle="yes"> </italic>0 such that for all <italic toggle="yes">x</italic>, <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mi>c</mml:mi><mml:mo>ϕ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mrow><mml:mo>∫</mml:mo><mml:mo>ϕ</mml:mo></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mtext>alt</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>θ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mo>θ</mml:mo></mml:mrow></mml:math></inline-formula>, in which case an amount <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:mi>c</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of putatively alternative mass could be swapped into the null component without changing the marginal predictive density. Sampling scenarios that allow for decreasing standard errors for at least a fraction of the units resolve this methodological issue. We can show, for symmetric <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mtext>alt</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for example, that the gap <italic toggle="yes">c</italic> vanishes to zero as the standard error <italic toggle="yes">σ</italic> similarly converges (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>). This is consistent with numerical behavior of MixTwice in large samples (<xref rid="btab162-F1" ref-type="fig">Fig. 1C</xref>), and is also consistent with work on mixture identification as information per unit increases (<xref rid="btab162-B2" ref-type="bibr">Aragam <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab162-B18" ref-type="bibr">Ritchie <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
    <p><xref rid="btab162-F2" ref-type="fig">Figure 2</xref> confirms that most methods are controlling FDR as advertised. The empirical FDR is plotted against the controlled rate; the latter is the nominal target FDR value where we threshold the lfdr’s; the former is what is evident from knowing the simulation states (in other terminology, it is the average, over simulated datasets, of the false discovery proportion). Colored lines are used to distinguish different levels of <italic toggle="yes">π</italic><sub>0</sub>, when the signal is dense (with a lower null proportion <italic toggle="yes">π</italic><sub>0</sub>) or when the signal is sparse (with a higher null proportion <italic toggle="yes">π</italic><sub>0</sub>). Recall we simulated independent datasets each governed by a randomly chosen <italic toggle="yes">π</italic><sub>0</sub> from <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. In order to visualize the results, we stratified datasets into four groups and averaged internally: <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mn>0.625</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>0.625</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mn>0.75</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>0.75</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mn>0.875</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>0.875</mml:mn><mml:mo>≤</mml:mo><mml:msub><mml:mrow><mml:mo>π</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The FDR inflation by ASH-t at high <italic toggle="yes">π</italic><sub>0</sub> is evident in this simulation.</p>
  </sec>
  <sec>
    <title>4 Empirical studies</title>
    <sec>
      <title>4.1 Antibodies in RA</title>
      <p>RA is a chronic autoimmune disease characterized by inflammation and pain, primarily in the joints. RA patients produce autoantibodies against many different ‘self’ proteins. Most famously, they generate antibodies against proteins in which arginine amino acids have been post-translationally modified to citrullines (<xref rid="btab162-B19" ref-type="bibr">Schellekens <italic toggle="yes">et al.</italic>, 1998</xref>), as well as antibodies that bind to antibodies, called RF (<xref rid="btab162-B28" ref-type="bibr">Waaler, 2009</xref>). Both autoantibody types appear to be pathogenic (<xref rid="btab162-B20" ref-type="bibr">Sokolove <italic toggle="yes">et al.</italic>, 2014</xref>) and both are used diagnostically (<xref rid="btab162-B1" ref-type="bibr">Aletaha <italic toggle="yes">et al.</italic>, 2010</xref>), the former detected by the anti-CCP test. Most RA patients make both autoantibody types (CCP<sup>+</sup> RF<sup>+</sup> RA), but some have only one type like in CCP<sup>+</sup> RF− RA. Little is known about why CCP<sup>+</sup> RF<sup>+</sup> versus CCP<sup>+</sup> RF− RA develops. However, a better understanding of the autoantibody repertoires in each RA subset could provide insights, a task for which peptide arrays are perfect.</p>
      <p>The custom high-density peptide array reported in <xref rid="btab162-B30" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> (2020)</xref> probed 172 828 distinct 12 amino acid length peptides derived from 122 human proteins suspected to be involved in RA, including peptides in which all arginines were replaced by citrullines. We reconsider here two distinct comparisons from that study, namely the comparison between CCP<sup>+</sup> RF− RA patients and controls, and a second comparison between CCP<sup>+</sup> RF<sup>+</sup> RA patients and controls, in which differential signals are much stronger. Both comparisons have 12 subjects in each group. To assess reproducibility, we take advantage of a second peptide array dataset derived from an independent set of eight controls and eight CCP<sup>+</sup> RF<sup>+</sup> RA patients.</p>
    </sec>
    <sec>
      <title>4.2 CCP<sup>+</sup>RF− RA: weak signals</title>
      <p>We applied MixTwice to fit the shape-constrained mixture model of Section 2. Fitted mixing distributions are visualized in <xref rid="btab162-F3" ref-type="fig">Figure 3</xref> and provide a measure of the magnitude of changes in mean antibody levels as well as the magnitude of sampling variation. For example, the effect-size distribution estimates no probability for effects larger than 0.037. Also, the median standard error is 0.10 (squared standard error 0.01), which is large compared to the probable effect sizes.</p>
      <fig position="float" id="btab162-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Estimated mixing distributions: for both effect distribution <italic toggle="yes">g</italic> (<bold>A</bold>) and squared-standard-error distribution <italic toggle="yes">h</italic> (<bold>B</bold>), shown are the maximum likelihood estimated mixing distributions as cumulative distribution functions (cdfs) in double natural log scale. The CCP<sup>+</sup> RF− RA example is shown on the left and the two CCP<sup>+</sup> RF<sup>+</sup> RA examples are on the right</p>
        </caption>
        <graphic xlink:href="btab162f3" position="float"/>
      </fig>
      <p>In Section 1, we presented summary counts of peptides identified at 10% FDR that exhibits differential binding between CCP<sup>+</sup> RF− RA patients and non-RA controls. MixTwice, ASH-t and two-step ASH distinguish themselves in being the only methods among many standard large-scale tools to populate nonempty lists of discovered peptides at that FDR level. Recognizing that the magnitude of signal intensities on the peptide array is an important aspect of downstream analysis, <xref rid="btab162-F4" ref-type="fig">Figure 4</xref> shows a summary of the identified peptides by various methods. Notably, MixTwice and two-step ASH detect peptides in this case with higher average signal intensity than ASH-t; these may correspond to higher antibody abundance or affinity and potentially easier validation. ASH-t tends to select peptides with low standard errors, even when the estimated effects are very low.</p>
      <fig position="float" id="btab162-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Signal intensity of differentially abundant peptides: boxplots show averaged signal values on double natural log scale (both CCP<sup>+</sup> RF− RA and control subjects) for peptides found by ASH-t (76 peptides), MixTwice (44 peptides) and two-step ASH (11 peptides) all discovered at 10% FDR</p>
        </caption>
        <graphic xlink:href="btab162f4" position="float"/>
      </fig>
      <p>Interestingly, the 44 peptides found by MixTwice have a strong pattern in their peptide sequences: all are citrulline (<italic toggle="yes">B</italic>)-containing peptides (which would be predicted for CCP<sup>+</sup> RA patients) and contain citrulline next to glycine (<italic toggle="yes">B</italic>-<italic toggle="yes">G</italic> or <italic toggle="yes">G</italic>-<italic toggle="yes">B</italic>), as shown in the motif in <xref rid="btab162-F5" ref-type="fig">Figure 5</xref>. Binding of antigens in which citrulline is next to glycine is consistent with a growing body of literature on the reactivity of anti-citrullinated protein antibodies in RA (e.g. <xref rid="btab162-B8" ref-type="bibr">Burkhardt <italic toggle="yes">et al.</italic>, 2002</xref>; <xref rid="btab162-B21" ref-type="bibr">Steen <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab162-B25" ref-type="bibr">Szarka et al., 2018</xref>; <xref rid="btab162-B30" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
      <fig position="float" id="btab162-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Motif logo for significant peptides in CCP<sup>+</sup> RF− RA: consensus sequences were generated using online software MEME Suite (<xref rid="btab162-B5" ref-type="bibr">Bailey <italic toggle="yes">et al.</italic>, 2009</xref>) and the significant peptides from the different methods: ASH-t (left), MixTwice (middle) and two-step ASH (right). Each position of the motif logo represents the empirical distribution of amino acids at that site, with size proportional to frequency. <italic toggle="yes">B</italic> found in the middle and right panels is citrulline, a post-transitionally modified arginine. The overall height of each stack is an information measure (bits) related to the concentration of the empirical distribution on its support</p>
        </caption>
        <graphic xlink:href="btab162f5" position="float"/>
      </fig>
      <p>As a further negative control calculation, we applied MixTwice to each of 500 permuted datasets obtained by fixing the peptide data and randomly shuffling the 24 subject labels (12 control, 12 CCP<sup>+</sup> RF− RA). In 493 cases, the 10% FDR list is empty; 6 cases find a single peptide and 1 case finds 2 peptides at this threshold.</p>
      <p>Among a number of large-scale testing methods applied to the CCP<sup>+</sup> RF− RA example, MixTwice identifies comparatively a large number of statistically significant peptides. In contrast to other methods, these peptides contain patterns in their amino acid sequences consistent with emerging evidence on this disease, and they correspond to relatively high fluorescence intensity measurements. Together, these observations provide some assurance that the MixTwice findings are not artifacts.</p>
    </sec>
    <sec>
      <title>4.3 CCP<sup>+</sup>RF<sup>+</sup>RA: strong signals</title>
      <p>One of the findings from <xref rid="btab162-B30" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> (2020)</xref> concerns the extensive antibody-profile differences between RA patients who are positive for both biomarkers (CCP<sup>+</sup> RF<sup>+</sup>) and control subjects. Statistically, it represents an interesting nonsparse, large-scale testing situation, and the immunological mechanisms driving this remain only partially understood. To check the reproducibility of peptide array findings, a new experiment was performed using the same procedures and 172 828 peptide array to detect IgG binding as in <xref rid="btab162-B30" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> (2020)</xref>, but with serum samples from 16 different subjects: 8 CCP<sup>+</sup> RF<sup>+</sup> RA and 8 controls. CCP<sup>+</sup> RF<sup>+</sup> RA and control subjects were similar in regards to age, sex, race, ethnicity and overall health. Preprocessing followed the same protocol and provided a dataset (<italic toggle="yes">study 2</italic>) for us to look at reproducibility of large-scale hypothesis testing methods.</p>
      <p>Z-score histograms in <xref rid="btab162-F6" ref-type="fig">Figure 6A</xref> show that both studies reveal extensive increased antibody binding in the CCP<sup>+</sup> RF<sup>+</sup> RA group. The scatterplot in Panel B reveals concordance between the studies on this <italic toggle="yes">z</italic>-score metric. The color-coding highlights discovered peptides at the 0.1% FDR method by MixTwice, both uniquely in one study (green or yellow) and reproducibly in both studies (blue). Of course, MixTwice uses more information than is in the <italic toggle="yes">z</italic>-score summary, but the scatterplot provides a convenient visualization. The lower panels in <xref rid="btab162-F6" ref-type="fig">Figure 6</xref> compare reproducibility statistics of different testing methods at various FDR thresholds. Denoting by <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> the list of significant peptides in study <italic toggle="yes">j</italic> and FDR level <italic toggle="yes">α</italic>, we have <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> as the number of peptides identified in both studies (Panel D) and <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>∩</mml:mo><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>∪</mml:mo><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>α</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> as the common fraction (Panel C). By connecting separate, independent studies of the same group difference, these statistics measure the reproducibility of various large-scale testing methods. MixTwice shows substantially better reproducibility than other testing methods, such as ASH-t, two-step ASH and locFDR in this example.</p>
      <fig position="float" id="btab162-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Reproducibility comparison. (<bold>A</bold>) Empirical z-score distributions for CCP+RF+RA versus control at 172 828 peptides in two independent studies. The scatterplot in (<bold>B</bold>) highlights peptides identified uniquely at 0.1% FDR by MixTwice in either study (yellow, green) and those reproducibly found in both studies (blue). Metrics in (<bold>C</bold>) and (<bold>D</bold>) compare performance of MixTwice as a function of FDR threshold</p>
        </caption>
        <graphic xlink:href="btab162f6" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>5 Discussion</title>
    <p>High-throughput biomedical experiments, such as those involving peptide arrays and immunological studies, continue to provide challenging problems for large-scale hypothesis testing. Readily applied techniques, such as <italic toggle="yes">q</italic>-value, locFDR, IHW and ASH are often very effective at reporting lists of testing units (peptides) showing statistically significant effects at a targeted FDR. In the case of high-density peptide arrays, we find several examples where these tools are deficient. One issue is the number of testing units, which is an order of magnitude larger than what is seen in transcript studies, for example. In the CCP<sup>+</sup> RF− RA comparison, most existing tools exhibit low power, which may stem in part from when they intervene in the data analysis. Methods that intervene earlier have access to more information and thereby may gain some advantage. The risk to intervening early is that more assumptions may be required to deliver relevant testing statistics (e.g. lfdr, lsdr). We rely on external validation, such as on sequence properties of the identified peptides, to assess practical utility. The CCP<sup>+</sup> RF<sup>+</sup> RA example showcases a situation where power is high by all methods, and the differences boil down to how testing units are prioritized. The proposed MixTwice procedure shows impressive reproducibility in this case.</p>
    <p>Structurally, MixTwice is similar to the ASH method for large-scale testing: it aims to estimate a mixing distribution of effects in an empirical Bayesian formulation. It adopts ASH’s non-parametric, shape-constrained model for effects, but deviates from that approach by incorporating a second mixing layer over underlying effect-variance parameters. A number of methodological issues deserve further study. For example, MixTwice treats the sampling model of squared standard errors as chi-square on a design-based degrees of freedom, which is rooted in a normal-data model. We expect that suitable transformation of the original data will make this treatment reasonable; for example, <xref rid="btab162-B30" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> (2020)</xref> proposed a double-log transform to stabilize variance. An interesting alternative is to use a bootstrap scheme to assess the sampling distributions directly, in order to thereby estimate the degrees of freedom that would be justified asymptotically for non-normal cases.</p>
    <p>There are computational issues that warrant further investigation. The objective function (2) may not be convex in the pair of arguments (<italic toggle="yes">g</italic>, <italic toggle="yes">h</italic>). Numerical experiments indicate good performance of the augmented Lagrangian optimization approach in a range of scenarios, though alternative approaches may have benefits. For example, the conditional optimizations of <italic toggle="yes">g</italic> given <italic toggle="yes">h</italic> or <italic toggle="yes">h</italic> given <italic toggle="yes">g</italic> are both convex, though attempts so far to leverage this have been less computationally efficient than the augmented Lagrangian method. Related to this are questions of grid sizes <italic toggle="yes">K</italic> and <italic toggle="yes">L</italic>, which have to balance fidelity to the data and computational efficiency.</p>
    <p>Though our presentation has focused on the classical two-group comparison problem, it should be evident that the core methodology is not restricted to this case. Estimated effects <italic toggle="yes">x<sub>i</sub></italic>, for example, could arise from a contrast of interest after adjusting for blocking variables or other covariates. These will be useful to consider as we expect them to emerge in experiments that further investigate mechanisms of immune-system disregulation.</p>
    <p>Finally, we point out that other forms of information may be usefully integrated with the testing methodology. Peptides tile proteins, though we have treated them as anonymous testing units. More sophisticated peptide prioritization could leverage amino-acid structure, protein content or other features of the immunological context.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Peer Reviewed Medical Research Program (US Army Medical Research, W81XWH1810717) as well as by the University of Wisconsin-Madison, Office of the Vice Chancellor for Research and Graduate Education with funding from the Wisconsin Alumni Research Foundation to M.A.S. and also National Institutes of Health [R01 GM102756], National Institutes of Health [P50 DE026787] and NSF [1740707] supporting M.A.N. I.M.O. acknowledges support by the Clinical and Translational Science Award (CTSA) program, through the National Institutes of Health National Center for Advancing Translational Sciences (NCATS) [UL1TR002373 and KL2TR002374]. This research was also supported by the Data Science Initiative grant from the University of Wisconsin-Madison Office of the Chancellor and the Vice Chancellor for Research and Graduate Education (with funding from the Wisconsin Alumni Research Foundation) (I.M.O.). The authors acknowledge Sean McIlwain for assistance with reproducibility calculations, and thank a referee and Associate editor for extremely useful comments on an earlier draft.</p>
    <p><italic toggle="yes">Conflict of Interest:</italic> none declared. </p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>All data used in this study are available at github.com/wiscstatman/MixTwice/data/</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab162_Supplementary_Data</label>
      <media xlink:href="btab162_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab162-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aletaha</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>2010 rheumatoid arthritis classification criteria: an American college of rheumatology/European league against rheumatism collaborative initiative</article-title>. <source>Arthritis Rheum</source>., <volume>62</volume>, <fpage>2569</fpage>–<lpage>2581</lpage>.<pub-id pub-id-type="pmid">20872595</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aragam</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) 
<article-title>Identifiability of nonparametric mixture models and Bayes optimal clustering</article-title>. <source>Ann. Stat</source>., <volume>48</volume>, <fpage>2277</fpage>–<lpage>2302</lpage>.</mixed-citation>
    </ref>
    <ref id="btab162-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bailey</surname><given-names>A.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>Pegivirus avoids immune recognition but does not attenuate acute-phase disease in a macaque model of HIV infection</article-title>. <source>PLoS Pathog</source>., <volume>13</volume>, <fpage>e1006692</fpage>.<pub-id pub-id-type="pmid">29073258</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bailey</surname><given-names>J.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) 
<article-title>Microarray analyses reveal strain-specific antibody responses to plasmodium falciparum apical membrane antigen 1 variants following natural infection and vaccination</article-title>. <source>Sci. Rep</source>., <volume>10</volume>, <fpage>1</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">31913322</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bailey</surname><given-names>T.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) 
<article-title>Meme suite: tools for motif discovery and searching</article-title>. <source>Nucleic Acids Res</source>., <volume>37</volume>, <fpage>W202</fpage>–<lpage>W208</lpage>.<pub-id pub-id-type="pmid">19458158</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benjamini</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Hochberg</surname><given-names>Y.</given-names></string-name></person-group> (<year>1995</year>) 
<article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>J. R. Stat. Soc. B (Methodological)</source>, <volume>57</volume>, <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="btab162-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bourgon</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>Independent filtering increases detection power for high-throughput experiments</article-title>. <source>Proc. Natl. Acad. Sci</source>., <volume>107</volume>, <fpage>9546</fpage>–<lpage>9551</lpage>.<pub-id pub-id-type="pmid">20460310</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burkhardt</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2002</year>) 
<article-title>Epitope-specific recognition of type II collagen by rheumatoid arthritis antibodies is shared with recognition by antibodies that are arthritogenic in collagen-induced arthritis in the mouse</article-title>. <source>Arthritis Rheum</source>., <volume>46</volume>, <fpage>2339</fpage>–<lpage>2348</lpage>.<pub-id pub-id-type="pmid">12355481</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B9">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Efron</surname><given-names>B.</given-names></string-name></person-group> (<year>2012</year>) <source>Large-Scale Inference: Empirical Bayes Methods for Estimation, Testing, and Prediction</source>, <volume>Vol. 1</volume>. 
<publisher-name>Cambridge University Press</publisher-name>, 
<publisher-loc>Cambridge</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btab162-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Efron</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2001</year>) 
<article-title>Empirical Bayes analysis of a microarray experiment</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>96</volume>, <fpage>1151</fpage>–<lpage>1160</lpage>.</mixed-citation>
    </ref>
    <ref id="btab162-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hoefges</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) 
<article-title>Thousands of new antigens are recognized in mice via endogenous antibodies after being cured of a b78 melanoma via immunotherapy</article-title>. <source>J. Immunother. Cancer</source>, <volume>2020</volume>, <fpage>8</fpage>.</mixed-citation>
    </ref>
    <ref id="btab162-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ignatiadis</surname><given-names>N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Data-driven hypothesis weighting increases detection power in genome-scale multiple testing</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>577</fpage>–<lpage>580</lpage>.<pub-id pub-id-type="pmid">27240256</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Korthauer</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>A practical guide to methods controlling false discoveries in computational biology</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>118</fpage>–<lpage>121</lpage>.<pub-id pub-id-type="pmid">31164141</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lu</surname><given-names>M.</given-names></string-name>, <string-name><surname>Stephens</surname><given-names>M.</given-names></string-name></person-group> (<year>2019</year>) 
<article-title>Empirical Bayes estimation of normal means, accounting for uncertainty in estimated standard errors</article-title>. <source>arXiv Preprint arXiv:1901.10679</source>.</mixed-citation>
    </ref>
    <ref id="btab162-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mishra</surname><given-names>N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Diagnosis of zika virus infection by peptide array and enzyme-linked immunosorbent assay</article-title>. <source>MBio</source>, <volume>9</volume>, <fpage>e00095–18</fpage>.<pub-id pub-id-type="pmid">29511073</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B16">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Newton</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2006</year>) <part-title>Hierarchical mixture models for expression profiles</part-title>. In: Kim-Anh,D, <italic toggle="yes">et al</italic>. (eds) <source>Bayesian Inference for Gene Expression and Proteomics</source>, <volume>Chapter 2</volume>. 
<publisher-name>Cambridge University Press</publisher-name>, 
<publisher-loc>New York</publisher-loc>, pp. <fpage>40</fpage>–<lpage>52</lpage>.</mixed-citation>
    </ref>
    <ref id="btab162-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Neill</surname><given-names>B.</given-names></string-name></person-group> (<year>2014</year>) 
<article-title>Some useful moment results in sampling problems</article-title>. <source>Am. Stat</source>., <volume>68</volume>, <fpage>282</fpage>–<lpage>296</lpage>.</mixed-citation>
    </ref>
    <ref id="btab162-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ritchie</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) 
<article-title>Consistent estimation of identifiable nonparametric mixture models from grouped observations</article-title>. <source>arXiv Preprint arXiv:2006.07459</source>.</mixed-citation>
    </ref>
    <ref id="btab162-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schellekens</surname><given-names>G.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1998</year>) 
<article-title>Citrulline is an essential constituent of antigenic determinants recognized by rheumatoid arthritis-specific autoantibodies</article-title>. <source>J. Clin. Investig</source>., <volume>101</volume>, <fpage>273</fpage>–<lpage>281</lpage>.<pub-id pub-id-type="pmid">9421490</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sokolove</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>Rheumatoid factor as a potentiator of anti-citrullinated protein antibody-mediated inflammation in rheumatoid arthritis</article-title>. <source>Arthritis Rheumatol</source>., <volume>66</volume>, <fpage>813</fpage>–<lpage>821</lpage>.<pub-id pub-id-type="pmid">24757134</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steen</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Recognition of amino acid motifs, rather than specific proteins, by human plasma cell–derived monoclonal antibodies to posttranslationally modified proteins in rheumatoid arthritis</article-title>. <source>Arthritis Rheumatol</source>., <volume>71</volume>, <fpage>196</fpage>–<lpage>209</lpage>.<pub-id pub-id-type="pmid">30152202</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stephens</surname><given-names>M.</given-names></string-name></person-group> (<year>2017</year>) 
<article-title>False discovery rates: a new deal</article-title>. <source>Biostatistics</source>, <volume>18</volume>, <fpage>275</fpage>–<lpage>294</lpage>.<pub-id pub-id-type="pmid">27756721</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Storey</surname><given-names>J.D.</given-names></string-name></person-group> (<year>2003</year>) 
<article-title>The positive false discovery rate: a Bayesian interpretation and the q-value</article-title>. <source>Ann. Stat</source>., <volume>31</volume>, <fpage>2013</fpage>–<lpage>2035</lpage>.</mixed-citation>
    </ref>
    <ref id="btab162-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Strimmer</surname><given-names>K.</given-names></string-name></person-group> (<year>2008</year>) 
<article-title>fdrtool: a versatile r package for estimating local and tail area-based false discovery rates</article-title>. <source>Bioinformatics</source>, <volume>24</volume>, <fpage>1461</fpage>–<lpage>1462</lpage>.<pub-id pub-id-type="pmid">18441000</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Szarka</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Affinity purification and comparative biosensor analysis of citrulline-peptide-specific antibodies in rheumatoid arthritis</article-title>. <source>Int. J. Mol. Sci</source>., <volume>19</volume>, <fpage>326</fpage>.<pub-id pub-id-type="pmid">29361749</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tokarz</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) 
<article-title>Identification of immunoreactive linear epitopes of <italic toggle="yes">Borrelia miyamotoi</italic></article-title>. <source>Ticks Tick Borne Dis</source>., <volume>11</volume>, <fpage>101314</fpage>.<pub-id pub-id-type="pmid">31636001</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B27">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Varadhan</surname><given-names>R.</given-names></string-name></person-group> (<year>2015</year>) <italic toggle="yes">alabama: Constrained Nonlinear Optimization</italic>. R package version 2015.3-1. <ext-link xlink:href="https://CRAN.R-project.org/package=alabama" ext-link-type="uri">https://CRAN.R-project.org/package=alabama</ext-link>.</mixed-citation>
    </ref>
    <ref id="btab162-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Waaler</surname><given-names>E.</given-names></string-name></person-group> (<year>2009</year>) 
<article-title>On the occurrence of a factor in human serum activating the specific agglutination of sheep blood corpuscles</article-title>. <source>Acta Pathol. Microbiol. Scand</source>., <volume>17</volume>, <fpage>172</fpage>–<lpage>188</lpage>.</mixed-citation>
    </ref>
    <ref id="btab162-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yan</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Whole genome-derived tiled peptide arrays detect prediagnostic autoantibody signatures in non–small-cell lung cancer</article-title>. <source>Cancer Res</source>., <volume>79</volume>, <fpage>1549</fpage>–<lpage>1557</lpage>.<pub-id pub-id-type="pmid">30723114</pub-id></mixed-citation>
    </ref>
    <ref id="btab162-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>Z.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) 
<article-title>Disordered antigens and epitope overlap between anti-citrullinated protein antibodies and rheumatoid factor in rheumatoid arthritis</article-title>. <source>Arthritis Rheumatol</source>., <volume>72</volume>, <fpage>262</fpage>–<lpage>272</lpage>.<pub-id pub-id-type="pmid">31397047</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
