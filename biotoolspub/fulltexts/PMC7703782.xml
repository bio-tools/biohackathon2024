<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7703782</article-id>
    <article-id pub-id-type="pmid">31665245</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz804</article-id>
    <article-id pub-id-type="publisher-id">btz804</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ImSpectR: R package to quantify immune repertoire diversity in spectratype and repertoire sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Cordes</surname>
          <given-names>Martijn</given-names>
        </name>
        <xref ref-type="aff" rid="btz804-aff1">1</xref>
        <xref ref-type="aff" rid="btz804-aff2">2</xref>
        <xref ref-type="corresp" rid="btz804-cor1"/>
        <!--<email>m.cordes@lumc.nl</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pike-Overzet</surname>
          <given-names>Karin</given-names>
        </name>
        <xref ref-type="aff" rid="btz804-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>van Eggermond</surname>
          <given-names>Marja</given-names>
        </name>
        <xref ref-type="aff" rid="btz804-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vloemans</surname>
          <given-names>Sandra</given-names>
        </name>
        <xref ref-type="aff" rid="btz804-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Baert</surname>
          <given-names>Miranda R</given-names>
        </name>
        <xref ref-type="aff" rid="btz804-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Garcia-Perez</surname>
          <given-names>Laura</given-names>
        </name>
        <xref ref-type="aff" rid="btz804-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Staal</surname>
          <given-names>Frank J T</given-names>
        </name>
        <xref ref-type="aff" rid="btz804-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Reinders</surname>
          <given-names>Marcel J T</given-names>
        </name>
        <xref ref-type="aff" rid="btz804-aff2">2</xref>
        <xref ref-type="aff" rid="btz804-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>van den Akker</surname>
          <given-names>Erik B</given-names>
        </name>
        <xref ref-type="aff" rid="btz804-aff2">2</xref>
        <xref ref-type="aff" rid="btz804-aff3">3</xref>
        <xref ref-type="aff" rid="btz804-aff4">4</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Birol</surname>
          <given-names>Inanc</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btz804-aff1"><label>1</label><institution>Department of Immunohematology &amp; Blood Transfusion, Leiden University Medical Center</institution>, Leiden, The <country country="NL">Netherlands</country></aff>
    <aff id="btz804-aff2"><label>2</label><institution>Leiden Computational Biology Center, Leiden University Medical Center</institution>, Leiden, The <country country="NL">Netherlands</country></aff>
    <aff id="btz804-aff3"><label>3</label><institution>The Delft Bioinformatics Lab, Delft University of Technology</institution>, Delft, The <country country="NL">Netherlands</country></aff>
    <aff id="btz804-aff4"><label>4</label><institution>Department of Molecular Epidemiology, Leiden University Medical Center</institution>, Leiden, The <country country="NL">Netherlands</country></aff>
    <author-notes>
      <corresp id="btz804-cor1">
        <email>m.cordes@lumc.nl</email>
      </corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-10-30">
      <day>30</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>30</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>6</issue>
    <fpage>1930</fpage>
    <lpage>1932</lpage>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>29</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>25</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz804.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>An effective immune system is characterized by a diverse immune repertoire. There is a strong demand for accurate and quantitative methods to assess the diversity of the immune repertoire for various (pre-)clinical applications, including the diagnosis and prognosis of primary immune deficiencies, or to assess the response to therapy. Current strategies for immune diversity assessment generally comprise the visual inspection of the length distribution of rearranged T- and B-cell receptors. Visual inspections, however, are prone to subjective assessments and thus lead to biases. Here, we introduce <italic>ImSpectR</italic>, a unified approach to quantify immunodiversity using either spectratype, repertoire sequencing or single cell RNA sequencing data. <italic>ImSpectR</italic> scores various types of deviations from the expected length distribution and integrates these into one measure, allowing for robust quantitative comparisons of immune diversity across individuals or conditions.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>R-package is available for download on GitHub at <ext-link ext-link-type="uri" xlink:href="https://github.com/martijn-cordes/ImSpectR">https://github.com/martijn-cordes/ImSpectR</ext-link>.</p>
      </sec>
      <sec id="s3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>ZonMw E-RARE</institution>
          </institution-wrap>
        </funding-source>
        <award-id>113302002</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="3"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The immune repertoire refers to the diversity of T-cell receptors (TCR) and B cell receptors (BCR) on T- and B-lymphocytes each expressing a unique antigen-specific receptor. The most diverse part of the receptor is the third complementarity-determining region 3 (CDR3) that binds a specific antigen. The diversity of the immune repertoire is key in combatting viral infections and other pathogens. Indeed, rare inherited variations that hamper immune cell development generally lead to the development of severe primary immunodeficiencies, as no diverse immune repertoire can be formed. Patients with such primary immunodeficiencies often require hematopoietic stem cell transplantation or gene therapy (<xref rid="btz804-B8" ref-type="bibr">Wiekmeijer <italic>et al.</italic>, 2016</xref>). To monitor immune reconstitution upon treatment, accurate quantification of the immune repertoire diversity is required.</p>
    <p>While deep-sequencing methods have been developed for CDR3 length distribution analyses, spectratyping, i.e. measuring CDR3 lengths of all possible TCR Vβ-Cβ combinations by capillary electrophoresis (<xref rid="btz804-B6" ref-type="bibr">Pannetier <italic>et al.</italic>, 1993</xref>), is still considered to be the gold standard for clinical applications. Existing methods (<xref rid="btz804-B3" ref-type="bibr">Gorochov <italic>et al.</italic>, 1998</xref>; <xref rid="btz804-B4" ref-type="bibr">Long <italic>et al.,</italic> 2006</xref>) for CDR3 length distribution analysis are typically developed to detect gross clonal abnormalities and are therefore generally not accurate enough to detect subtle changes in immunodiversity. Moreover, classical methods typically ignore sequences that result in out-of-frame rearrangements, which lead to non-functional T-cell receptors, and thus miss important information embedded in the complexity of the actual distribution patterns. As a result, CDR3 length distributions are often visually inspected, which is prone to introduce subjective variation and thus may lead to biases.</p>
    <p>Here we present <italic>ImSpectR</italic>, an R package for robust scoring of immunodiversity of TCRs. Our package is able to assess the complexity of the distribution of CDR3 lengths from spectratype, ImmunoSeq repertoire sequencing or single cell RNA sequencing data from either human or mouse by scoring various types of deviations from the expected distribution and integrating these into one score.</p>
  </sec>
  <sec>
    <title>2 Materials and methods </title>
    <p>Briefly, amplification of CDR3 regions, either by spectratyping or sequencing, will produce fragments of different sizes (See <xref ref-type="supplementary-material" rid="sup1">Supplementary Chapter S0</xref>). The distribution of these CDR3 fragment sizes represents the junctional diversity of TCRs and can thus be used to assess the diversity of the T cell repertoire. A density plot of CDR3 fragment sizes (<xref ref-type="fig" rid="btz804-F1">Fig. 1A</xref>), can be used to display the junctional diversity. Peaks in this plot represent CDR3 regions of specific sizes expressed by particular rearranged Vβ segments. Fragments typically display a 3 bp size difference in length, as these constitute the rearranged receptor sequences that are transcribed <italic>in-frame</italic>. The rearrangements leading to CDR3 regions are stochastic, causing the overall CDR3 length distribution in naïve T cells to adhere to a Gaussian distribution. Consequently, <italic>ImSpectR</italic> models the different fragment lengths of <italic>in-frame</italic> CDR3 regions with a mixture of Gaussians. Deviations from this model reflect a skewed or otherwise suboptimal immunodiversity and is used to score CDR3 length patterns (described in <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref>). <italic>ImSpectR</italic> is organized in three different modules (<xref ref-type="fig" rid="btz804-F1">Fig. 1A</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Materials</xref>).</p>
    <fig id="btz804-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>(<bold>A</bold>) Subscores contributing to the peak score. Peak Height Score: Deviation of sample peaks from the overall Gaussian curve. Peak Area Score: Area of the model (light blue) compared to the area of the sample (light green). Residual data penalty: Area subjected to penalties (dark blue) and actual signal outside of the expected model (red). (<bold>B</bold>) CDR3 length distribution plots of Vβ11 and Vβ17 from a WT C57/Bl6 mouse and scored with <italic>ImSpectR</italic>. (<bold>C</bold>) Vβ11 and Vβ17 peak patterns of 12 WT mice scored with <italic>ImSpectR</italic>, χ<sup>2</sup> Goodness-of-Fit (<xref rid="btz804-B3" ref-type="bibr">Gorochov <italic>et al.</italic>, 1998</xref>) and REPERTOIRE (<xref rid="btz804-B4" ref-type="bibr">Long <italic>et al.</italic>, 2006</xref>). (<bold>D</bold>) Heatmap of <italic>ImSpectR</italic> scores per sample (vertical axis) per Vβ family (horizontal axis). Top: Differences in t-tests between WT versus GT1 and WT versus GT2 calculated per Vβ family. Right: Boxplots of scores across all Vβ families, illustrating that GT1 reconstitutes immunodiversity better than GT2 (see also <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S11</xref>)</p>
      </caption>
      <graphic xlink:href="btz804f1"/>
    </fig>
    <p><italic>Preprocessing</italic>: For spectratyping raw intensity FSA files are imported, and the fluorescent peaks are matched to the expected DNA sizes of the provided size-standard ladder. For sequencing data, tables containing CDR3 sequencing lengths annotated to a particular V family are used (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Chapter S1</xref>).</p>
    <p><italic>Peak pattern detection</italic>: Dynamic time warping (<xref rid="btz804-B2" ref-type="bibr">Giorgino, 2009</xref>) is employed to scan for a pattern in the raw spectratypes best matching the expected Gaussian model. From the best match fragment sizes and fragment abundances are extracted and used for scoring (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Chapter S2</xref>).</p>
    <p><italic>Model fitting</italic>: For peak pattern mixture modelling, a mixture of Gaussians is fitted to the matched peak pattern, i.e. for every peak a three basepair-wide Gaussian matching the height of the expected model is fitted to the matched peak pattern. A peak score is calculated by comparing properties (peak heights, peak areas and residual data) of an observed CDR3 length distribution to the expected model resulting in a score between 0 and 100 (<xref ref-type="fig" rid="btz804-F1">Fig. 1A</xref>) (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Chapter S3</xref>).</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We demonstrate the improved accuracy of <italic>ImSpectR</italic> over other existing methods for spectratype analysis, by analyzing Vβ17, a known dysfunctional family in the C57/Bl6 mouse strain (<xref rid="btz804-B5" ref-type="bibr">Louie <italic>et al.</italic>, 1989</xref>) (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Chapter S4</xref>). While the Vβ17a gene in C57/Bl6 mice is rearranged and expressed, Vβ17b will never lead to a full-length and functional Vβ17 cell-surface protein, due to the presence of a premature stop codon in the germ line sequence. Consequently, Vβ17 patterns do not display a typical polyclonal pattern (<xref ref-type="fig" rid="btz804-F1">Fig. 1B</xref>). Since the overall pattern of Vβ17 remains Gaussian shaped (<xref rid="btz804-B1" ref-type="bibr">Gapin <italic>et al.</italic>, 1998</xref>), competing methods for spectratype analysis score spectratypes of the non-functional Vβ17 almost as good as the functional Vβ11 (<xref ref-type="fig" rid="btz804-F1">Fig. 1C</xref>, panel 2 and 3). In contrast, <italic>ImSpectR</italic> penalizes deviations in each individual peak, thus accurately capturing the difference between the non-functional Vβ17 and the functional Vβ11 (<xref ref-type="fig" rid="btz804-F1">Fig. 1C</xref> first panel and <xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S1 and S2</xref>) for full comparison on all Vβ families.</p>
    <p>Next, we illustrate the use of <italic>ImSpectR</italic> by analyzing the diversity of immune reconstitution in Rag-1 deficient mice treated with two different experimental RAG-1 gene therapies (<xref rid="btz804-B7" ref-type="bibr">Pike-Overzet <italic>et al.</italic>, 2011</xref>). We scored 22 Vβ families measured in 3 Rag-1 deficient mice receiving either one of the two types of gene therapy (N<sub>GT1</sub> = 3, N<sub>GT2</sub> = 2), or transplanted wild-type stem cells (N<sub>WT</sub> = 3) as a positive control (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S3–S10</xref>). Our method comprehensively indicates a broader immune diversity in mice receiving GT1 over GT2, indicating an improved immune reconstitution by GT1 over GT2 (<xref ref-type="fig" rid="btz804-F1">Fig. 1D</xref>), which is also supported by flow cytometric analysis and total T cell count (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S12</xref>). In addition, we demonstrate the accuracy of ImSpectR by scoring replicate measurements of C57/Bl6 WT control mice, which showed that the overall score distribution across the different Vβ genes are reproducible (<xref ref-type="supplementary-material" rid="sup1">Supplementary Chapter S3</xref>).</p>
    <p>Finally, we demonstrate the broad applicability of <italic>ImSpectR</italic> by providing workflows and applying it to ImmunoSeq repertoire sequencing or single cell RNA sequencing data in either mouse or human (<xref ref-type="supplementary-material" rid="sup1">Supplementary Chapter S5</xref>).</p>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We present <italic>ImSpectR</italic>, a versatile, novel, quantitative and accurate method tailored to assess immunodiversity using CDR3 lengths from spectratype, or (single cell) RNA sequencing data from human or mouse. <italic>ImSpectR</italic> shows improved accuracy compared to existing methods and we demonstrate its merit by re-analyzing data from pre-clinical gene therapy studies aimed to reconstitute a diverse immune repertoire.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz804_Supplementary_Data</label>
      <media xlink:href="btz804_supplementary_data.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank Allan Thompson for additional lab work as well as, Thies Gehrmann, Amiet Chhatta and Harald Mikkers for fruitful discussions.</p>
    <sec>
      <title>Funding</title>
      <p>This work was funded by ZonMw E-RARE project [113302002 to M.C. and F.S.].</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz804-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gapin</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>1998</year>) 
<article-title>Quantitative analysis of the T cell repertoire selected by a single peptide–major histocompatibility complex</article-title>. <source>J. Exp. Med</source>., <volume>187</volume>, <fpage>1871</fpage>–<lpage>1883</lpage>.<pub-id pub-id-type="pmid">9607927</pub-id></mixed-citation>
    </ref>
    <ref id="btz804-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Giorgino</surname><given-names>T.</given-names></name></person-group> (<year>2009</year>) 
<article-title>Computing and visualizing dynamic time warping alignments in R: the DTW package</article-title>. <source>J. Stat. Softw</source>., <volume>31</volume>, <fpage>1</fpage>–<lpage>24</lpage>.</mixed-citation>
    </ref>
    <ref id="btz804-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gorochov</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>1998</year>) 
<article-title>Perturbation of CD4+ and CD8+ T-cell repertoires during progression to AIDS and regulation of the CD4+ repertoire during antiviral therapy</article-title>. <source>Nat. Med</source>., <volume>4</volume>, <fpage>215</fpage>–<lpage>221</lpage>.<pub-id pub-id-type="pmid">9461196</pub-id></mixed-citation>
    </ref>
    <ref id="btz804-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Long</surname><given-names>S.A.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>Standardized analysis for the quantification of Vbeta CDR3 T-cell receptor diversity</article-title>. <source>J. Immunol. Methods</source>, <volume>317</volume>, <fpage>100</fpage>–<lpage>113</lpage>.<pub-id pub-id-type="pmid">17081557</pub-id></mixed-citation>
    </ref>
    <ref id="btz804-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Louie</surname><given-names>M.C.</given-names></name></person-group><etal>et al</etal> (<year>1989</year>) 
<article-title>Identification and characterization of new murine T cell receptor β chain variable region (Vβ) genes</article-title>. <source>J. Exp. Med</source>., <volume>170</volume>, <fpage>1987</fpage>–<lpage>1998</lpage>.<pub-id pub-id-type="pmid">2531193</pub-id></mixed-citation>
    </ref>
    <ref id="btz804-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pannetier</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>1993</year>) 
<article-title>The sizes of the CDR3 hypervariable regions of the murine T-cell receptor beta chains vary as a function of the recombined germ-line segments</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>90</volume>, <fpage>4319</fpage>–<lpage>4323</lpage>.<pub-id pub-id-type="pmid">8483950</pub-id></mixed-citation>
    </ref>
    <ref id="btz804-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pike-Overzet</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Correction of murine Rag1 deficiency by self-inactivating lentiviral vector-mediated gene transfer</article-title>. <source>Leukemia</source>, <volume>25</volume>, <fpage>1471</fpage>–<lpage>1483</lpage>.<pub-id pub-id-type="pmid">21617701</pub-id></mixed-citation>
    </ref>
    <ref id="btz804-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wiekmeijer</surname><given-names>A.S.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Identification of checkpoints in human T-cell development using severe combined immunodeficiency stem cells</article-title>. <source>J. Allergy Clin. Immunol</source>., <volume>137</volume>, <fpage>517</fpage>–<lpage>526</lpage>.<pub-id pub-id-type="pmid">26441229</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
