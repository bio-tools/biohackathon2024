<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3495771</article-id>
    <article-id pub-id-type="pmid">23152858</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-12-19041</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0049110</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Human Genetics</subject>
            <subj-group>
              <subject>Genetic Association Studies</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genomics</subject>
          <subj-group>
            <subject>Genome Sequencing</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer Science</subject>
        <subj-group>
          <subject>Computerized Simulations</subject>
        </subj-group>
        <subj-group>
          <subject>Software Engineering</subject>
          <subj-group>
            <subject>Software Tools</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Generation of Artificial FASTQ Files to Evaluate the Performance of Next-Generation Sequencing Pipelines</article-title>
      <alt-title alt-title-type="running-head">Artificial FASTQs for NGS Pipeline Evaluation</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Frampton</surname>
          <given-names>Matthew</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Houlston</surname>
          <given-names>Richard</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <addr-line>Division of Genetics and Epidemiology, Institute of Cancer Research, Surrey, United Kingdom</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Badger</surname>
          <given-names>Jonathan H.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>J. Craig Venter Institute, United States of America</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>Matthew.Frampton@icr.ac.uk</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: MF RH. Performed the experiments: MF. Analyzed the data: MF. Contributed reagents/materials/analysis tools: MF. Wrote the paper: MF RH.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>11</month>
      <year>2012</year>
    </pub-date>
    <volume>7</volume>
    <issue>11</issue>
    <elocation-id>e49110</elocation-id>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>6</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>10</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2012 Frampton, Houlston</copyright-statement>
      <copyright-year>2012</copyright-year>
      <copyright-holder>Frampton, Houlston</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Pipelines for the analysis of Next-Generation Sequencing (NGS) data are generally composed of a set of different publicly available software, configured together in order to map short reads of a genome and call variants. The fidelity of pipelines is variable. We have developed <italic>ArtificialFastqGenerator</italic>, which takes a reference genome sequence as input and outputs artificial paired-end FASTQ files containing Phred quality scores. Since these artificial FASTQs are derived from the reference genome, it provides a gold-standard for read-alignment and variant-calling, thereby enabling the performance of any NGS pipeline to be evaluated. The user can customise DNA template/read length, the modelling of coverage based on GC content, whether to use real Phred base quality scores taken from existing FASTQ files, and whether to simulate sequencing errors. Detailed coverage and error summary statistics are outputted. Here we describe <italic>ArtificialFastqGenerator</italic> and illustrate its implementation in evaluating a typical bespoke NGS analysis pipeline under different experimental conditions. <italic>ArtificialFastqGenerator</italic> was released in January 2012. Source code, example files and binaries are freely available under the terms of the GNU General Public License v3.0. from <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/artfastqgen/">https://sourceforge.net/projects/artfastqgen/</ext-link>.</p>
    </abstract>
    <funding-group>
      <funding-statement>Funding provided by Cancer Research UK (C1298/A8362 - Bobby Moore Fund for Cancer Research UK). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="5"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Completion of the human genome project (HGP) coupled with developments in sequencing technologies has allowed rapid sequencing of complete human genomes. Most next-generation sequencing (NGS) systems are broadly based on fragmentation of genomic DNA with the oversampling of reads providing the necessary linking information for whole-genome assembly algorithms.</p>
    <p>One source of error in variant-calling is inherent sequencing error in NGS technology (i.e. incorrect base calls in the reads). These errors are more likely towards the ends of reads, and in the context of certain sequence motifs <xref rid="pone.0049110-Meacham1" ref-type="bibr">[1]</xref>. Read alignment and subsequent variant-calling is performed by a NGS analysis pipeline, typically composed of a set of publicly-available software configured together. The performance of pipelines is variable, hence it is highly desirable to evaluate the proficiency of any pipeline under different conditions (e.g. low versus high sequencing error rate, low versus high coverage), and to identify regions of the genome which are likely to be problematic or refractory to sequencing. To facilitate benchmarking of NGS pipelines we have developed <italic>ArtificialFastqGenerator</italic> software.</p>
    <p>NGS instruments such as the Illumina Genome Analyzer output reads of nucleotide sequences and corresponding base quality scores, the FASTQ format being the standard text-based representation for these data (see <xref ref-type="supplementary-material" rid="pone.0049110.s013">Text S1</xref>). <italic>ArtificialFastqGenerator</italic> takes a reference genome as input and outputs artificial FASTQ files. The user can customise DNA template/read length, gap size between paired-end reads, the modelling of coverage based on GC content, whether to use Phred base quality scores taken from existing FASTQ files, and whether to simulate sequencing errors. Since these artificial FASTQs are derived from the reference genome, the reference genome provides a gold-standard for the variant-calling, enabling evaluation of any pipeline.</p>
    <p><italic>ArtificialFastqGenerator</italic> offers advantages over other bioinformatic software tools which generate artificial Illumina reads such as <italic>ART</italic>
<xref rid="pone.0049110-Huang1" ref-type="bibr">[2]</xref>, <italic>WgSim</italic> from the Samtools package <xref rid="pone.0049110-Li1" ref-type="bibr">[3]</xref>, <italic>Mason</italic>
<xref rid="pone.0049110-Holtgrewe1" ref-type="bibr">[4]</xref>, <italic>SimSeq</italic>
<xref rid="pone.0049110-SimSeq1" ref-type="bibr">[5]</xref> and <italic>pIRS</italic>
<xref rid="pone.0049110-Hu1" ref-type="bibr">[6]</xref>. Firstly, <italic>ArtificialFastqGenerator</italic> provides greater flexibility with respect to modelling coverage based on GC content, because the user can assign relevant parameters, rather than them being learned from resequencing data and hence fixed. Secondly, the software produces detailed coverage and error summary statistics (both regional and overall for coverage). Another distinctive feature is the ability to use real Phred scores taken from existing FASTQ files. By contrast <italic>pIRS</italic> uses an empirical model which predicts the base-call and Phred score based on read cycle, reference base and quality of the previous cycle.</p>
    <p>Here, we describe <italic>ArtificialFastqGenerator</italic> and an evaluation of a typical bespoke NGS analysis pipeline. We investigate how variant-calling results are affected by Phred quality scores and simulated sequencing error in the FASTQs, the presence/absence of different stages in the pipeline, and variant-caller choice.</p>
  </sec>
  <sec id="s2">
    <title>Artificial Fastq Generator</title>
    <p><italic>ArtificialFastqGenerator</italic> is platform-independent software written in Java SE 6, and is available as open-source from the <italic>SourceForge</italic> website: <ext-link ext-link-type="uri" xlink:href="https://sourceforge.net/projects/artfastqgen/">https://sourceforge.net/projects/artfastqgen/</ext-link>. The program takes a reference genome sequence in FASTA format as input and outputs artificial paired-end FASTQ files <xref rid="pone.0049110-Cock1" ref-type="bibr">[7]</xref> which contain Phred base quality scores encoded in the Sanger format (see <xref ref-type="supplementary-material" rid="pone.0049110.s013">Text S1</xref> for more description of the FASTQ format).</p>
    <p>This section mentions user parameters for controlling DNA template/read length, target coverage, whether to take the base quality scores from existing FASTQ files, and whether to simulate sequencing errors based on these scores. <xref ref-type="supplementary-material" rid="pone.0049110.s014">Text S2</xref> describes how to set these parameters and run a test case. In addition to FASTQ files, <italic>ArtificialFastqGenerator</italic> produces a log file of summary statistics for coverage and error generation, and a file documenting start and end indexes in the reference genome of all generated reads.</p>
    <sec id="s2a">
      <title>Read Generation</title>
      <p>We can consider the reference as a sequence of nucleobases stretching from left to right. In order to maintain a small memory footprint, <italic>ArtificialFastqGenerator</italic> generates reads for reference nucleobases which are within a sliding window. The “nucleobaseBufferSize” parameter determines the window's size, and hence also how far right it moves on each occasion.</p>
      <p><italic>ArtificialFastqGenerator</italic> passes through the region inside the window repeatedly, considering pairs of nucleobase sequences for the generation of paired-end reads. Nucleobase <italic>target coverage</italic> constraints dictate that eventually, the program will complete a pass through the region without being able to generate any novel reads, and at this point, the window slides right. A nucleobase's coverage is the number of reads in which it appears, so its target coverage is the upper limit on how many reads it can appear in.</p>
      <p><italic>ArtificialFastqGenerator</italic> can only generate right-end reads for the nucleobases at the right end of the window. Hence when the window slides right, it reaches a point at which these nucleobases are at the left end of the window. This then allows left-end reads including these nucleobases to be generated.</p>
    </sec>
    <sec id="s2b">
      <title>Read length and Gap Size between Paired-end Reads</title>
      <p>In paired-end sequencing both ends of a DNA template are sequenced. If read lengths are constant, which is generally the case, then the distance between the two reads is determined by the template length. <italic>ArtificialFastqGenerator</italic> samples template lengths from a normal distribution. The user can specify the mean and standard deviation of this distribution, and the read length.</p>
    </sec>
    <sec id="s2c">
      <title>Specifying a Nucleobase’s Target Coverage</title>
      <p>To set a nucleobase's target coverage, <italic>ArtificialFastqGenerator</italic> calculates the region's GC content, and then defines and samples from a normal distribution of coverage levels for regions with this GC content. The software calculates the distribution's mean using a Gaussian function of the GC content. The user can customise the function by setting the coverage mean peak (the height of the bell's peak), the GC content at which this peak occurs (the position of the centre of the peak), and how quickly mean coverage decays (the width of the bell). The user can also specify the standard deviation as a multiple of the mean, and the size of the region for which GC content is calculated.</p>
      <p>The default values of these parameters are based on the results of a capture probe experiment in which 4 samples were sequenced by an Illumina Genome Analyzer <xref rid="pone.0049110-Tewhey1" ref-type="bibr">[8]</xref>. <xref ref-type="fig" rid="pone-0049110-g001">Figure 1</xref> shows the expected profile for GC content versus mean target coverage when using these default settings. If a different profile better suits the user's needs, then they can change the settings accordingly. There is also a user parameter for switching off the biasing of coverage based on GC content.</p>
      <fig id="pone-0049110-g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0049110.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>The profile for regional GC content versus mean target coverage, produced by using the default settings for the relevant <italic>ArtificialFastqGenerator</italic> user parameters.</title>
        </caption>
        <graphic xlink:href="pone.0049110.g001"/>
      </fig>
    </sec>
    <sec id="s2d">
      <title>Phred Quality Score and Error Generation</title>
      <p>As the default, <italic>ArtificialFastqGenerator</italic> assigns every base in every read a high Phred quality score of 40, Sanger-encoding “I”.Alternatively the program can use quality scores from pre-existing FASTQ files. If a generated read is a different length to the one whose quality scores are being used, then the sequence of quality scores is lengthened/shortened accordingly by either duplicating or removing the first base quality score(s). By only altering the beginning of the sequence, the trend for quality scores to deteriorate at the end of reads is preserved.</p>
      <p>The error simulator decodes the base's Sanger format encoded Phred quality score (<inline-formula><inline-graphic xlink:href="pone.0049110.e001.jpg"/></inline-formula>), calculating the estimated probability of error (<inline-formula><inline-graphic xlink:href="pone.0049110.e002.jpg"/></inline-formula>) from<disp-formula id="pone.0049110.e003"><graphic xlink:href="pone.0049110.e003.jpg" position="anchor" orientation="portrait"/><label>(1)</label></disp-formula>
</p>
      <p>In the current incarnation of <italic>ArtificialFastqGenerator</italic> the quality score is the sole parameter used for error generation in the program.</p>
      <p>Unknown bases (Ns) cannot be subjected to error simulation, and are always assigned a very low Phred quality score of 2. There is a user parameter for filtering out reads which contain Ns.</p>
    </sec>
    <sec id="s2e">
      <title>Summary Coverage and Error Statistics</title>
      <p><italic>ArtificialFastqGenerator</italic> logs regional and overall summary coverage statistics, and overall error statistics. The overall error statistics include the total number of reads and nucleobase calls, and the number of these nucleobase calls for which an error was simulated.</p>
    </sec>
    <sec id="s2f">
      <title>Speed</title>
      <p><italic>ArtificialFastqGenerator</italic> has a low memory footprint dependent on the user-specified “nucleobaseBufferSize” parameter. On an Intel Xeon X5650 processor (12 M cache, 2.66 GHz, 6.40 gigatransfers per second Intel QuickPath Interconnect), when using real quality scores and simulating sequencing errors, and with the other parameters set to their defaults, it takes around 6 hrs 20 mins to process 1 giga base.</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>Analysis</title>
    <p>To illustrate the use of <italic>ArtificialFastqGenerator</italic> FASTQ files to benchmark the performance of a typical NGS pipeline we subjected to scrutiny our current in-house bioinformatic pipeline which is based on the following components:</p>
    <list list-type="order">
      <list-item>
        <p>Quality control of raw sequences (FASTQ file reads) using <italic>FastQC</italic>
<xref rid="pone.0049110-FastQC1" ref-type="bibr">[9]</xref>, which reports overall GC content, mean base quality score for each position in the reads, distribution of the reads' mean base quality score, and frequency of bases in each read position which are A/C/G/T/N (unknown).</p>
      </list-item>
      <list-item>
        <p>Alignment of reads using <italic>Stampy</italic>
<xref rid="pone.0049110-Lunter1" ref-type="bibr">[10]</xref> which outputs files in the Sequence Alignment/Map (SAM) format <xref rid="pone.0049110-Li1" ref-type="bibr">[3]</xref>.</p>
      </list-item>
      <list-item>
        <p>Local realignment of reads using the <italic>Genome Analysis Toolkit (GATK)</italic>
<xref rid="pone.0049110-McKenna1" ref-type="bibr">[11]</xref>, <xref rid="pone.0049110-DePristo1" ref-type="bibr">[12]</xref>. Local realignment serves to transform regions with misalignments due to InDels, generating a “realigned” BAM file.</p>
      </list-item>
      <list-item>
        <p>Marking/removal of Polymerase Chain Reaction (PCR) duplicates using <italic>Picard</italic>
<xref rid="pone.0049110-Picard1" ref-type="bibr">[13]</xref>.</p>
      </list-item>
      <list-item>
        <p>Recalibration of base quality scores using GATK.</p>
      </list-item>
      <list-item>
        <p>Variant-calling using GATK or alternatively Platypus <xref rid="pone.0049110-Rimmer1" ref-type="bibr">[14]</xref>. Each variant is reported in a <italic>Variant Call Format (VCF)</italic> file along with features which are indicative of its fidelity e.g. mapping quality of the reads, and whether the variation is seen in only one strand. Filtering based on these features can reduce the number of false-positives (FPs).</p>
      </list-item>
    </list>
    <p>To evaluate this NGS pipeline we investigated how variant-calling is influenced by: Phred quality scores; Simulated sequencing errors; Local realignment and recalibration; Variant-caller software (GATK vs. Platypus); Coverage and sequence uniqueness.</p>
    <sec id="s3a">
      <title>Methodology</title>
      <p>Using <italic>ArtificialFastqGenerator</italic> and the human reference genome (build 37 in FASTA format), we generated two pairs of whole genome FASTQs with different Phred quality score/simulated sequencing error (PE) characteristics: high Phred quality scores (40) with no simulated sequencing errors (PE = 00); Phred quality scores from pre-existing FASTQ files with simulated sequencing errors (PE = 11). All other parameters in <italic>ArtificialFastqGenerator</italic> were set to their default values (see <xref ref-type="supplementary-material" rid="pone.0049110.s014">Text S2</xref>). FASTQ files which were used to supply real Phred quality scores were derived from exomes sequenced using an Illumina HiSeq 2000 system.</p>
      <p>To speed up the analysis we generated individual chromosome FASTQs in parallel and then merged them. For each FASTQ file, the number of reads was approximately 562,570,000 and GC content 41%–42%, while for each pair, the average coverage per nucleobase was 29.90 to 2 d.p.s (range 0 to 40). Note that this average is for nucleobases marked as A/C/G/T in the reference genome, not N (unknown). Using the Phred quality scores from the Illumina HiSeq FASTQ data resulted in a simulated sequencing error for approximately 4.5% of all nucleobase calls.</p>
      <p>To investigate the effect of Phred quality scores and simulated sequencing errors on variant calling, we analyzed each pair of whole genome FASTQs using our NGS pipeline. To investigate the effect of local realignment and recalibration, we conducted variant-calling immediately after the alignment stage, and to investigate the effect of variant-caller choice, we used Platypus rather than GATK. We did not implement Syzygy <xref rid="pone.0049110-Rivas1" ref-type="bibr">[15]</xref> as this software is primarily designed for targeted resequencing projects. Note that our variant calling results were filtered. For GATK results, we applied VCF filters as recommended on the Broad Institute wiki: for SNPs, <italic>QualByDepth</italic> &lt; 2.0, <italic>RMS MappingQuality</italic> &lt; 40.0, <italic>FisherStrand</italic> &gt; 60.0, <italic>HaplotypeScore</italic> &gt; 13.0, <italic>MappingQualityRankSumTest</italic> &lt; −12.5, <italic>ReadPosRankSumTest</italic> &lt; −8.0; for InDels, <italic>QualByDepth</italic> &lt; 2.0, <italic>ReadPosRankSumTest</italic> &lt; −20.0, <italic>FisherStrand</italic> &gt; 200.0. Platyus automatically applies a filter for each variant call and records whether it passes in the VCF.</p>
      <p>To examine the basis of genomic regions consistently associated with FP variant calls we investigated the effect of coverage and the level of uniqueness of their composite sequences. Our basic hypothesis was that such regions have reduced coverage and/or reduced sequence uniqueness. To study the effect of coverage, we made use of coverage statistics for every 10000 nucleobases in the reference genome outputted by <italic>ArtificialFastqGenerator</italic>, and to study sequence uniqueness, we used the <italic>Broad alignability track</italic>
<xref rid="pone.0049110-Broad1" ref-type="bibr">[16]</xref>.</p>
    </sec>
  </sec>
  <sec id="s4">
    <title>Results</title>
    <p>Note that FP variant calls are made when PE = 00 and PE = 11. We refer to genomic regions containing FP variant calls as <italic>FP variant regions</italic>.</p>
    <sec id="s4a">
      <title>Rate of False-positive Variant Call Under different Conditions</title>
      <p><xref ref-type="supplementary-material" rid="pone.0049110.s001">Figures S1</xref> and <xref ref-type="supplementary-material" rid="pone.0049110.s002">S2</xref> show the number of FP variant calls for each chromosome after filtering under different experimental conditions. A number of trends are apparent, including a positive correlation between the number of FP SNPs and InDels, and Platypus making more FP variant calls than GATK. For example, when PE = 11 and after RDMR, Platypus calls 10390 SNPs and 2381 InDels genome-wide, while GATK calls 2604 and 1244.</p>
      <p>Imposing real Phred quality scores and simulating sequencing errors is associated with a reduction in FP variant calls. For example, when PE = 00 (and after RDMR), GATK calls 4306 SNPs and 2100 InDels genome-wide, but when PE = 11, it calls 2604 and 1244. While simulating sequencing errors may cause more misaligned reads, fewer are aligned with high confidence, resulting in fewer FP variant calls.</p>
      <p>We are most interested in the importance of Realignment, Duplicate Marking and Recalibration (RDMR) when PE = 11, because this is the much more realistic case. As hoped, RDMR reduces the number of FP SNPs (GATK calls fewer in 23 chromosomes, 2604 versus 2691 genome-wide), but it increases FP InDels (GATK calls more in 23 chromosomes, 1244 versus 953 genome-wide).</p>
    </sec>
    <sec id="s4b">
      <title>Regions Associated with False-positive Variant Calls Under Different Conditions</title>
      <p>While different experimental conditions are associated with an increased/decreased number of FP variant calls, the location of <italic>FP variant regions</italic> seems to remain the same. This point is illustrated by <xref ref-type="supplementary-material" rid="pone.0049110.s003">Figures S3</xref>, <xref ref-type="supplementary-material" rid="pone.0049110.s004">S4</xref>, <xref ref-type="supplementary-material" rid="pone.0049110.s005">S5</xref>, <xref ref-type="supplementary-material" rid="pone.0049110.s006">S6</xref>, <xref ref-type="supplementary-material" rid="pone.0049110.s007">S7</xref>, <xref ref-type="supplementary-material" rid="pone.0049110.s008">S8</xref>, <xref ref-type="supplementary-material" rid="pone.0049110.s009">S9</xref>, and <xref ref-type="supplementary-material" rid="pone.0049110.s010">S10</xref>–histograms which show the distribution (after filtering) of GATK's chromosome 1 FP variant calls under different experimental conditions. In general, the peaks keep occurring in the same regions. This same observation was made for the other chromosomes.</p>
    </sec>
    <sec id="s4c">
      <title>Analysis of Regions Containing False-positive Variant Calls</title>
      <p><xref ref-type="supplementary-material" rid="pone.0049110.s011">Table S1</xref> shows coverage statistics for a sample of regions (10000 nucleobases long) on chromosome 1 which produced a relatively high number of FP variant calls (<inline-formula><inline-graphic xlink:href="pone.0049110.e004.jpg"/></inline-formula>). All nucleobases are A/C/G/T (none are N), and PE = 00. A region's average nucleobase coverage ranges from 29.94 to 32.78 (to 2 d.p.s), which is actually higher than genome-wide (29.90 for As/Cs/Gs/Ts), and minimum coverage for a nucleobase is not very low (9–20). This suggests that it is not possible to predict the presence/number of FP SNPs based on coverage alone.</p>
      <p>The region in <xref ref-type="supplementary-material" rid="pone.0049110.s011">Table S1</xref> with the highest number of FP SNPs is 154420001–154430000. On closer inspection, its FP SNPs seemed to be in 2 clusters–the first, a cluster of 12 in 154421756–154421820 inclusive, and the second, a cluster of 5 in 154428273–154428328. We measured the uniqueness in these FP SNP cluster regions with the <italic>Broad alignability track</italic>, and then also in expanded regions of length 500 and 1000 bases (centered on the original FP cluster region).</p>
      <p><xref ref-type="supplementary-material" rid="pone.0049110.s012">Table S2</xref> shows the level of uniqueness statistics in these regions, and also across the whole chromosome. While the first FP SNP cluster region has a low-level of uniqueness, the second does not. Hence, as for coverage, it will not always be possible to predict the presence/number of FP variant calls in a genomic region based only on its level of sequence uniqueness.</p>
    </sec>
  </sec>
  <sec id="s5">
    <title>Discussion</title>
    <p>Here we have demonstrated that FASTQs generated by <italic>ArtificialFastqGenerator</italic> can be used to evaluate the performance of an NGS analysis pipeline under different conditions and identify which components of a system may be suboptimal. Furthermore, the strategy provides a means of identifying regions of the genome which may be problematic for any pipeline.</p>
    <p>Using our own NGS analysis pipeline we investigated how variant-calling is affected by Phred quality scores, sequencing errors, coverage, local realignment and recalibration, and variant-caller algorithm. We found that the number of false-positive variant calls was higher using Platypus rather than GATK for variant-calling, and lower when we used real Phred quality scores and simulated sequencing error. The number of false-positive SNP calls was also lower after local realignment, duplicate marking and recalibration, but unfortunately, the number of false-positive InDels was higher.</p>
    <p>Although the number of false-positive variant calls varied under different conditions the regions these were associated with were generally the same. We also established that there is no simple straightforward relationship between the presence or absence of false-positive variant calls, and coverage or sequence uniqueness.</p>
    <p>In the current guise <italic>ArtificialFastqGenerator</italic> offers the user control over DNA template/read length, target coverage, whether to use real Phred base quality scores taken from existing FASTQ files, and whether to simulate sequencing errors. Possible future extensions of the software are to offer the user greater choice over quality score generation, and if possible, to improve the accuracy of sequencing error by basing it on more than just the quality scores.</p>
  </sec>
  <sec sec-type="supplementary-material" id="s6">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0049110.s001">
      <label>Figure S1</label>
      <caption>
        <p>
          <bold>Number of false-positive (FP) variant calls after filtering for chromosomes 1–12; S = SNP; I = InDel; PE = 00 means all Phred scores high (40) &amp; no simulated sequencing errors; PE = 11 means Phred scores from real FASTQ files &amp; simulated sequencing errors; RDMR = local realignment, duplicate marking and recalibration; G = GATK; P = Platypus.</bold>
        </p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0049110.s001.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0049110.s002">
      <label>Figure S2</label>
      <caption>
        <p>
          <bold>Number of false-positive (FP) variant calls after filtering for chromosomes 13–22, X and Y; S = SNP; I = InDel; PE = 00 means all Phred scores high (40) &amp; no simulated sequencing errors; PE = 11 means Phred scores from real FASTQ files &amp; simulated sequencing errors; RDMR = local realignment, duplicate marking and recalibration; G = GATK; P = Platypus.</bold>
        </p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0049110.s002.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0049110.s003">
      <label>Figure S3</label>
      <caption>
        <p>
          <bold>GATK chromosome 1 SNP calls for different Phred quality score and sequencing error simulation settings; local realignment, duplicate marking and recalibration (RDMR) are applied, as well as variant-call filtering. PE = 00 means all Phred scores high (40) &amp; no simulated sequencing errors; PE = 11 means Phred scores from real FASTQ files &amp; simulated sequencing errors.</bold>
        </p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0049110.s003.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0049110.s004">
      <label>Figure S4</label>
      <caption>
        <p>
          <bold>GATK chromosome 1 InDel calls for different Phred quality score and sequencing error simulation settings; local realignment, duplicate marking and recalibration (RDMR) are applied, as well as variant-call filtering; PE = 00 means all Phred scores high (40) &amp; no simulated sequencing errors; PE = 11 means Phred scores from real FASTQ files &amp; simulated sequencing errors.</bold>
        </p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0049110.s004.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0049110.s005">
      <label>Figure S5</label>
      <caption>
        <p>
          <bold>GATK chromosome 1 SNP calls for different Phred quality scores and sequencing error simulation settings; local realignment, duplicate marking and recalibration (RDMR) are applied but no variant-call filtering. PE = 00 means all Phred scores high (40) &amp; no simulated sequencing errors; PE = 11 means Phred scores from real FASTQ files &amp; simulated sequencing errors.</bold>
        </p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0049110.s005.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0049110.s006">
      <label>Figure S6</label>
      <caption>
        <p>
          <bold>GATK chromosome 1 InDel calls for different Phred quality score and sequencing error simulation settings; local realignment, duplicate marking and recalibration (RDMR) are applied, but no variant-call filtering. PE = 00 means all Phred scores high (40) &amp; no simulated sequencing errors; PE = 11 means Phred scores from real FASTQ files &amp; simulated sequencing errors.</bold>
        </p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0049110.s006.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0049110.s007">
      <label>Figure S7</label>
      <caption>
        <p>
          <bold>GATK chromosome 1 SNP and InDel calls when all Phred quality scores high (40) &amp; no simulated sequencing error (PE = 00); local realignment, duplicate marking and recalibration (RDMR) are applied, and also variant-call filtering.</bold>
        </p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0049110.s007.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0049110.s008">
      <label>Figure S8</label>
      <caption>
        <p>
          <bold>GATK chromosome 1 SNP and InDel calls when using real Phred quality scores and simulated sequencing errors (PE = 11); local realignment, duplicate marking and recalibration (RDMR) are applied, and also variant-call filtering.</bold>
        </p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0049110.s008.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0049110.s009">
      <label>Figure S9</label>
      <caption>
        <p>
          <bold>GATK chromosome 1 SNP calls after applying local realignment, duplicate marking and recalibration (RDMR) versus not; real Phred quality scores and simulated sequencing errors are used (PE = 11), and variant-call filtering is applied.</bold>
        </p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0049110.s009.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0049110.s010">
      <label>Figure S10</label>
      <caption>
        <p>
          <bold>GATK versus Platypus chromosome 1 SNP calls when using real Phred quality scores and simulated sequencing errors (PE = 11); local realignment, duplicate marking and recalibration (RDMR) are applied, as well as variant-call filtering.</bold>
        </p>
        <p>(TIFF)</p>
      </caption>
      <media xlink:href="pone.0049110.s010.tiff">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0049110.s011">
      <label>Table S1</label>
      <caption>
        <p>
          <bold>Coverage statistics for a sample of regions from chromosome 1 of length 10000 bases which produced a relatively high number of FP variant calls (<inline-formula><inline-graphic xlink:href="pone.0049110.e005.jpg"/></inline-formula>); FP = false-positive; PE = 00.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0049110.s011.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0049110.s012">
      <label>Table S2</label>
      <caption>
        <p>
          <bold>Broad alignability track results for 2 regions containing a cluster of FP SNPs on chromosome 1, and for chromosome 1 as a whole.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0049110.s012.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0049110.s013">
      <label>Text S1</label>
      <caption>
        <p>
          <bold>Short description of the FASTQ format.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0049110.s013.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0049110.s014">
      <label>Text S2</label>
      <caption>
        <p>
          <bold>Description of </bold>
          <bold>
            <italic>ArtificialFastqGenerator's</italic>
          </bold>
          <bold> user parameters, and how to run a test case.</bold>
        </p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0049110.s014.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0049110-Meacham1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Meacham</surname><given-names>F</given-names></name>, <name><surname>Boffelli</surname><given-names>D</given-names></name>, <name><surname>Dhahbi</surname><given-names>J</given-names></name>, <name><surname>Martin</surname><given-names>DI</given-names></name>, <name><surname>Singer</surname><given-names>M</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Identification and correction of systematic error in high-throughput sequence data</article-title>. <source>BMC Bioinformatics</source>
<volume>12</volume>: <fpage>451</fpage>.<pub-id pub-id-type="pmid">22099972</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0049110-Huang1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>W</given-names></name>, <name><surname>Li</surname><given-names>L</given-names></name>, <name><surname>Myers</surname><given-names>JR</given-names></name>, <name><surname>Marth</surname><given-names>GT</given-names></name> (<year>2012</year>) <article-title>ART: a next-generation sequencing read simulator</article-title>. <source>Bioinformatics</source>
<volume>28</volume>: <fpage>593</fpage>–<lpage>594</lpage>.<pub-id pub-id-type="pmid">22199392</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0049110-Li1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>H</given-names></name>, <name><surname>Handsaker</surname><given-names>B</given-names></name>, <name><surname>Wysoker</surname><given-names>A</given-names></name>, <name><surname>Fennell</surname><given-names>T</given-names></name>, <name><surname>Ruan</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>
<volume>25</volume>: <fpage>2078</fpage>–<lpage>79</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0049110-Holtgrewe1">
      <label>4</label>
      <mixed-citation publication-type="other">Holtgrewe M (2010) Mason - a read simulator for second generation sequencing data. Technical report, FU Berlin.</mixed-citation>
    </ref>
    <ref id="pone.0049110-SimSeq1">
      <label>5</label>
      <mixed-citation publication-type="other">SimSeq. Available: <ext-link ext-link-type="uri" xlink:href="https://github.com/jstjohn/SimSeq">https://github.com/jstjohn/SimSeq</ext-link>. Accessed 2012 October 10th.</mixed-citation>
    </ref>
    <ref id="pone.0049110-Hu1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Hu</surname><given-names>X</given-names></name>, <name><surname>Yuan</surname><given-names>J</given-names></name>, <name><surname>Shi</surname><given-names>Y</given-names></name>, <name><surname>Lu</surname><given-names>J</given-names></name>, <name><surname>Liu</surname><given-names>B</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>pIRS: Profile-based Illumina pair-end Reads Simulator</article-title>. <source>Bioinformatics</source>
<volume>28</volume>: <fpage>1533</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">22508794</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0049110-Cock1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Cock</surname><given-names>PJA</given-names></name>, <name><surname>Fields</surname><given-names>CJ</given-names></name>, <name><surname>Goto</surname><given-names>N</given-names></name>, <name><surname>Heuer</surname><given-names>ML</given-names></name>, <name><surname>Rice</surname><given-names>PM</given-names></name> (<year>2009</year>) <article-title>The Sanger FASTQ file format for sequences with quality scores, and the Solexa/Illumina FASTQ variants</article-title>. <source>Nucleic Acids Research</source>
<volume>38</volume>: <fpage>1767</fpage>–<lpage>1771</lpage>.<pub-id pub-id-type="pmid">20015970</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0049110-Tewhey1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Tewhey</surname><given-names>R</given-names></name>, <name><surname>Nakano</surname><given-names>M</given-names></name>, <name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Pabón-Peña</surname><given-names>C</given-names></name>, <name><surname>Novak</surname><given-names>B</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>Enrichment of sequencing targets from the human genome by solution hybridization</article-title>. <source>Genome Biology</source>
<volume>10</volume>: <fpage>R116</fpage>.<pub-id pub-id-type="pmid">19835619</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0049110-FastQC1">
      <label>9</label>
      <mixed-citation publication-type="other">FastQC. Available: <ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.bbsrc.ac.uk/projects/fastqc/">http://www.bioinformatics.bbsrc.ac.uk/projects/fastqc/</ext-link>. Accessed 2012 October 10th.</mixed-citation>
    </ref>
    <ref id="pone.0049110-Lunter1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Lunter</surname><given-names>G</given-names></name>, <name><surname>Goodson</surname><given-names>M</given-names></name> (<year>2011</year>) <article-title>Stampy: A statistical algorithm for sensitive and fast mapping of Illumina sequence reads</article-title>. <source>Genome Research</source>
<volume>201</volume>: <fpage>936</fpage>–<lpage>939</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0049110-McKenna1">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>McKenna</surname><given-names>A</given-names></name>, <name><surname>Hanna</surname><given-names>M</given-names></name>, <name><surname>Sivachenko</surname><given-names>E</given-names></name>, <name><surname>Cibulskis</surname><given-names>K</given-names></name>, <name><surname>Kernytsky</surname><given-names>A</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>The Genome Analysis Toolkit: A MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Research</source>
<volume>20</volume>: <fpage>1297</fpage>–<lpage>303</lpage>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0049110-DePristo1">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>DePristo</surname><given-names>M</given-names></name>, <name><surname>Banks</surname><given-names>E</given-names></name>, <name><surname>Poplin</surname><given-names>R</given-names></name>, <name><surname>Garimella</surname><given-names>K</given-names></name>, <name><surname>Maguire</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nature Genetics</source>
<volume>43</volume>: <fpage>491</fpage>–<lpage>498</lpage>.<pub-id pub-id-type="pmid">21478889</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0049110-Picard1">
      <label>13</label>
      <mixed-citation publication-type="other">Picard. Available: <ext-link ext-link-type="uri" xlink:href="http://picard.sourceforge.net">http://picard.sourceforge.net</ext-link>. Accessed 2012 October 10th.</mixed-citation>
    </ref>
    <ref id="pone.0049110-Rimmer1">
      <label>14</label>
      <mixed-citation publication-type="other">Rimmer A, Mathieson I, Lunter G, McVean G. Platypus: An Integrated Variant Caller. Available: <ext-link ext-link-type="uri" xlink:href="http://www.well.ox.ac.uk/platypus">http://www.well.ox.ac.uk/platypus</ext-link>. Accessed 2012 October 10th.</mixed-citation>
    </ref>
    <ref id="pone.0049110-Rivas1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Rivas</surname><given-names>MA</given-names></name>, <name><surname>Beaudoin</surname><given-names>M</given-names></name>, <name><surname>Gardet</surname><given-names>A</given-names></name>, <name><surname>Stevens</surname><given-names>C</given-names></name>, <name><surname>Sharma</surname><given-names>Y</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Deep resequencing of GWAS loci identifies independent rare variants associated with inammatory bowel disease</article-title>. <source>Nature Genetics</source>
<volume>43</volume>: <fpage>1066</fpage>–<lpage>1073</lpage>.<pub-id pub-id-type="pmid">21983784</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0049110-Broad1">
      <label>16</label>
      <mixed-citation publication-type="other">Broad Alignability Track. Available: <ext-link ext-link-type="uri" xlink:href="http://genome.ucsc.edu/">http://genome.ucsc.edu/</ext-link>. Accessed 2012 October 10th.</mixed-citation>
    </ref>
  </ref-list>
</back>
