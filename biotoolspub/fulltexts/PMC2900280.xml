<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2900280</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-11-346</article-id>
    <article-id pub-id-type="pmid">20576140</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-11-346</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Predicting nucleosome positioning using a duration Hidden Markov Model</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Xi</surname>
          <given-names>Liqun</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>lxi700@northwestern.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Fondufe-Mittendorf</surname>
          <given-names>Yvonne</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>yfondufe@yahoo.com</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Xia</surname>
          <given-names>Lei</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>lxia@northwestern.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Flatow</surname>
          <given-names>Jared</given-names>
        </name>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>jflatow@gmail.com</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A5">
        <name>
          <surname>Widom</surname>
          <given-names>Jonathan</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>j-widom@northwestern.edu</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A6">
        <name>
          <surname>Wang</surname>
          <given-names>Ji-Ping</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>jzwang@northwestern.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Statistics, Northwestern University, Evanston, IL 60208, USA</aff>
    <aff id="I2"><label>2</label>Department of of Biochemistry, Molecular Biology and Cell Biology, Northwestern University, Evanston, IL 60208, USA</aff>
    <aff id="I3"><label>3</label>Department of Electrical Engineering and Computer Science, Evanston, IL 60208, USA</aff>
    <aff id="I4"><label>4</label>Clinical and Translational Sciences Institute, Northwestern University, Chicago, 60611, USA</aff>
    <pub-date pub-type="collection">
      <year>2010</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>6</month>
      <year>2010</year>
    </pub-date>
    <volume>11</volume>
    <fpage>346</fpage>
    <lpage>346</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>4</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>6</month>
        <year>2010</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2010 Xi et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2010</copyright-year>
      <copyright-holder>Xi et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/11/346"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>The nucleosome is the fundamental packing unit of DNAs in eukaryotic cells. Its detailed positioning on the genome is closely related to chromosome functions. Increasing evidence has shown that genomic DNA sequence itself is highly predictive of nucleosome positioning genome-wide. Therefore a fast software tool for predicting nucleosome positioning can help understanding how a genome's nucleosome organization may facilitate genome function.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present a duration Hidden Markov model for nucleosome positioning prediction by explicitly modeling the linker DNA length. The nucleosome and linker models trained from yeast data are re-scaled when making predictions for other species to adjust for differences in base composition. A software tool named NuPoP is developed in three formats for free download.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>Simulation studies show that modeling the linker length distribution and utilizing a base composition re-scaling method both improve the prediction of nucleosome positioning regarding sensitivity and false discovery rate. NuPoP provides a user-friendly software tool for predicting the nucleosome occupancy and the most probable nucleosome positioning map for genomic sequences of any size. When compared with two existing methods, NuPoP shows improved performance in sensitivity.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Most eukaryotic genomic DNA is wrapped in nucleosomes, which occlude and strongly distort the wrapped DNA. Accumulating evidence shows that the DNA sequence itself is highly predictive of nucleosome positioning in vivo [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B7">7</xref>], and that nucleosome positioning is closely related to chromosome functions [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B8">8</xref>-<xref ref-type="bibr" rid="B11">11</xref>]. A fast software tool for predicting nucleosome positioning is highly desirable.</p>
    <p>Several statistical methods for nucleosome positioning prediction have been proposed in the literature. In [<xref ref-type="bibr" rid="B2">2</xref>] a method was proposed based on cross-correlation with a nucleosome DNA sequence signature. In [<xref ref-type="bibr" rid="B1">1</xref>] a Markov model was used together with consideration of steric exclusion and thermodynamic equilibrium. In [<xref ref-type="bibr" rid="B3">3</xref>], a support vector machine (SVM) was trained based on the differential <italic>k</italic>-mer usage between nucleosome and linker DNAs. In [<xref ref-type="bibr" rid="B4">4</xref>], the authors proposed an <italic>N</italic>-score model to discriminate nucleosome and linker DNAs using wavelet energies as covariates in a logistic regression model. In [<xref ref-type="bibr" rid="B5">5</xref>], a web-interface called "nuScore" for estimation of the affinity of histone core to DNA and prediction of nucleosome positioning was developed based on the DNA deformation energy score. In [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>], the model from [<xref ref-type="bibr" rid="B1">1</xref>] was improved by incorporation of differential <italic>k</italic>-mer usage (most notably, poly(dA:dT) tracts, which are strongly disfavored by nucleosomes). This model can be further improved by accounting for nucleosome-nucleosome interaction [<xref ref-type="bibr" rid="B12">12</xref>].</p>
    <p>While the nucleosomal features are universal, eukaryotic genomes vary in nucleosomal repeat length [<xref ref-type="bibr" rid="B13">13</xref>] and base composition. The nucleosomal repeat length is dictated by the length distribution of linker DNAs that separate neighboring nucleosomes, and it determines the overall nucleosome density in the chromatin fiber. The contribution of this paper is a duration Hidden Markov Model and a software tool called NuPoP for genome-wide nucleosome positioning prediction. We show that incorporation of linker length information can achieve better sensitivity in prediction. In addition, we propose a re-scaling method to adjust for base composition variation when using yeast models to make predictions for other species. A relatively superior performance of this approach is established by comparing it with other existing tools.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Model</title>
      <p>The hidden Markov model (HMM) has been known for decades. An excellent and famous tutorial is Rabiner's 1989 paper [<xref ref-type="bibr" rid="B14">14</xref>], in which the model, algorithms, and applications were carefully and thoroughly reviewed. A conventional HMM implicitly assumes a geometric duration distribution for each state, which can be wrong in real applications. Modeling the explicit duration of each state can improve the prediction of HMMs (e.g., [<xref ref-type="bibr" rid="B14">14</xref>-<xref ref-type="bibr" rid="B17">17</xref>]). We model each chromosomal DNA sequence with a duration hidden Markov model (dHMM) of two oscillating states: nucleosome (<italic>N</italic>) and linker (<italic>L</italic>), where the nucleosome state has a fixed length of 147 bp, and the linker state has a variable length. We assume that at the end of each state, the chain must transit to the other state; additionally, a complete chromatin sequence must start with and end in a linker state. We trained a 4th order time-dependent Markov chain for the the <italic>N </italic>state, and a homogeneous 4th order Markov chain for the <italic>L </italic>state to distinguish the <italic>k</italic>-mer usage preferences for <italic>k </italic>up to 5 between the nucleosome and linker states as shown in other methods, e.g., [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B6">6</xref>] (see below for details).</p>
      <p>Let <bold>e </bold>= <italic>e</italic><sub>1</sub>, ..., <italic>e</italic><sub>147 </sub>be a nucleosome DNA sequence. Let <italic>P</italic><sub><italic>N </italic></sub>be the probability of observing <bold>e </bold>as a nucleosome, computed as the product of probabilities for both Watson and Crick strands under the 4th order Markov Chain model. We assume that the linker DNA length of a given species has an unknown distribution <italic>F</italic><sub><italic>L</italic></sub>(<italic>k</italic>) defined for <italic>k </italic>= 1, ..., τ<sub><italic>L </italic></sub>(the maximum linker length we allow). An observed linker DNA sequence <bold>e </bold>= <italic>e</italic><sub>1</sub>, ..., <italic>e</italic><sub><italic>k </italic></sub>carries two pieces of information, the length is <italic>k </italic>bp, and given which, the emitted letters are <italic>e</italic><sub>1</sub>, ..., <italic>e</italic><sub><italic>k</italic></sub>. Let <italic>G</italic><sub><italic>L</italic></sub>(<bold>e</bold>|<italic>k</italic>) denote the homogeneous Markov chain model for the linker DNA (again including both strands). Then observing <bold>e </bold>as a linker DNA has probability<disp-formula><graphic xlink:href="1471-2105-11-346-i1.gif"/></disp-formula></p>
      <p>Suppose <bold>x </bold>= <italic>x</italic><sub>1</sub>, ..., <italic>x</italic><sub><italic>n </italic></sub>is a genomic DNA sequence of length <italic>n</italic>, where <italic>x</italic><sub><italic>i </italic></sub>= <italic>A</italic>/<italic>C</italic>/<italic>G</italic>/<italic>T</italic>. Let <bold>z </bold>= <italic>z</italic><sub>1</sub>, ..., <italic>z</italic><sub><italic>n </italic></sub>be the corresponding hidden state path, where <italic>z</italic><sub><italic>i </italic></sub>= 1 if <italic>x</italic><sub><italic>i </italic></sub>is covered by a nucleosome state, and 0 otherwise. Suppose that the path <bold>z </bold>= <italic>z</italic><sub>1</sub>, ..., <italic>z</italic><sub><italic>n </italic></sub>partitions <bold>x </bold>into <italic>k </italic>consecutive nucleosome or linker state blocks, in which the nucleosome blocks have a uniform length of 147 bp, whereas the length of linker blocks may vary. We denote these blocks as <bold>y </bold>= <bold>y+</bold>, ..., <bold>y<sub>B</sub></bold>, and their state identification as <bold>s </bold>= <italic>s</italic><sub>1</sub>, ..., <italic>s</italic><sub><italic>B</italic></sub>, where <italic>s</italic><sub><italic>i </italic></sub>= 1 if <bold>y</bold><sub><italic>i </italic></sub>is nucleosome state, and 0 otherwise. The probability of observing (<bold>x</bold>, <bold>z</bold>) is given by<disp-formula><graphic xlink:href="1471-2105-11-346-i2.gif"/></disp-formula></p>
      <p>where π<sub>0</sub>(<italic>s</italic><sub>1</sub>) and π<italic>e</italic>(<italic>s</italic><sub><italic>B</italic></sub>) stand for the probabilities that the chain initializes and ends with state <italic>s</italic><sub>1 </sub>and <italic>s</italic><sub><italic>k </italic></sub>respectively, and <italic>I </italic>is an indicator function. Since we assume that a complete chromatin sequence must start with and end in a linker state, π<sub>0</sub>(<italic>s</italic><sub>1 </sub>= 0) = π<sub><italic>e</italic></sub>(<italic>s</italic><sub><italic>B </italic></sub>= 0) = 1. We define the nucleosome occupancy at a specific position <italic>i</italic>, denoted <italic>o</italic><sub><italic>i</italic></sub>, as the posterior probability that <italic>z</italic><sub><italic>i </italic></sub>= 1, i.e.,<disp-formula><graphic xlink:href="1471-2105-11-346-i3.gif"/></disp-formula></p>
      <p>We also define the histone binding affinity score at position <italic>i </italic>as the log likelihood ratio for the region <italic>x</italic><sub><italic>i</italic></sub>-73, ... <italic>x</italic><sub><italic>i</italic></sub>, ..., <italic>x</italic><sub><italic>i</italic></sub>+73 to be a nucleosome vs. a linker, i.e.,<disp-formula><graphic xlink:href="1471-2105-11-346-i4.gif"/></disp-formula></p>
      <p>Given the models <italic>P</italic><sub><italic>N</italic></sub>, <italic>G</italic><sub><italic>L </italic></sub>and <italic>F</italic><sub><italic>L</italic></sub>, the optimal path <bold>z </bold>can be found by the standard Viterbi algorithm, and the nucleosome occupancy score can be estimated using forward and backward algorithms.</p>
    </sec>
    <sec>
      <title>Data and model training</title>
      <p>We utilized the 503,264 yeast nucleosome DNA reads from 454 pyrosequencing published in [<xref ref-type="bibr" rid="B6">6</xref>] for model training and assessment. Among 371,914 reads that each were mapped to a unique region of the yeast genome, we first selected reads of length between 146 and 149 bp. If multiple such reads existed for the same nucleosome, we selected the one with the highest BLAST score. The resulting non-redundant set of 18,547 nucleosome sequences were center aligned to train the nucleosome model <italic>P</italic><sub><italic>N</italic></sub>. The 4th order time dependent Markov chain can be defined by the base composition at the first position <italic>qN</italic>(<italic>x</italic><sub>1</sub>), and the transitional probabilities <italic>qN</italic>(<italic>x</italic><sub>2</sub>|<italic>x</italic><sub>1</sub>), <italic>qN</italic>(<italic>x</italic><sub>3</sub>|<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>), <italic>qN</italic>(<italic>x</italic><sub>4</sub>|<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>, <italic>x</italic><sub>3</sub>), <italic>qN</italic>(<italic>x</italic><sub><italic>k</italic></sub>|<italic>x</italic><sub><italic>k</italic>-4</sub>, <italic>x</italic><sub><italic>k</italic></sub>-3, <italic>x</italic><sub><italic>k</italic>-2</sub>, <italic>x</italic><sub><italic>k</italic>-1</sub>), for <italic>k </italic>= 5, ..., 147, <italic>x</italic><sub><italic>i </italic></sub>= A/C/G/T, <italic>i </italic>= 1, ..., 147, where the subscript <italic>k</italic>, <italic>i </italic>index the positions within a nucleosome. These probabilities are trained using the corresponding observed fractions or conditional fractions based on the center alignment, with a three bp moving average (as explained in [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B18">18</xref>]). We further identified 8,090 reads-free regions of length 7-500 bp to train the linker state model <italic>G</italic><sub><italic>L</italic></sub>. The 4th order homogeneous Markov model for the linker DNAs can be completely defined by the stationary base composition <italic>qL</italic>(<italic>xi</italic>), and the transition probabilities <italic>qL</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>x</italic><sub><italic>i</italic>-1</sub>), <italic>qL</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>x</italic><sub><italic>i</italic>-1</sub>, <italic>x</italic><sub><italic>i</italic>-2</sub>), <italic>qL</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>x</italic><sub><italic>i</italic>-1</sub>, <italic>x</italic><sub><italic>i</italic>-2</sub>, <italic>x</italic><sub><italic>i</italic>-3</sub>), <italic>qL</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>x</italic><sub><italic>i</italic>-1</sub>, <italic>x</italic><sub><italic>i</italic>-2</sub>, <italic>x</italic><sub><italic>i</italic>-3</sub>, <italic>x</italic><sub><italic>i</italic>-4</sub>). By "homogeneous", we mean that these probabilities are all constants as functions of <italic>i</italic>. These probabilities were trained using their observed values as in the nucleosome model. For example, <italic>qL</italic>(<italic>x</italic><sub><italic>i</italic></sub>|<italic>x</italic><sub><italic>i</italic>-1</sub>, <italic>x</italic><sub><italic>i</italic>-2</sub>, <italic>x</italic><sub><italic>i</italic>-3</sub>, <italic>x</italic><sub><italic>i</italic>-4</sub>) was trained by calculating the fraction of occurrences of transitions from any four letters to the fifth letter in the selected putative linker DNA sequences.</p>
      <p>Our initial nucleosome/linker model was trained using the yeast data. A complication arises when predicting nucleosomes for other species because organisms may differ significantly in their DNA base composition. We propose to scale up or down the probabilities in the Markov models by a factor determined by the difference of the base composition between the current species and yeast. For example, in <italic>C. elegans</italic>, the fraction of A plus T bases is 0.645 compared to 0.617 in yeast. For a specific transition probability <italic>qN</italic>(<italic>A</italic>|....) at any specific nucleosomal position defined for yeast, we scaled it up as <italic>qN</italic>(<italic>A</italic>|....) × 0.645/0.617 for the corresponding transition probability at that given position for <italic>C. elegans</italic>. Likewise the transition probabilities for G/C will be scaled down by a factor of 0.355/0.383.</p>
      <p>All the re-scaled probabilities are then normalized. The same re-scaling applies to the linker model. We shall use simulations below to show that re-scaling improves prediction regarding sensitivity and false discovery rate. Using the trained nucleosome model (<italic>P</italic><sub><italic>N</italic></sub>) and linker model (<italic>G</italic><sub><italic>L</italic></sub>), we further train the linker DNA length distribution as follows. We assume that the linker DNAs in any given species or cell type have a maximum length τ<sub><italic>L </italic></sub>= 500 bp.</p>
      <p>This algorithm contains the following steps:</p>
      <p>1. Initialize the algorithm with a uniform distribution for <italic>F</italic><sub><italic>L</italic></sub>(<italic>k</italic>) for <italic>k </italic>= 1, ... τ<sub><italic>L </italic></sub>where τ<sub><italic>L </italic></sub>is the maximum allowable linker length.</p>
      <p>2. Use the forward and backward algorithm to obtain the posterior expectation of <italic>F</italic><sub><italic>L</italic></sub>(<italic>k</italic>) for each <italic>k</italic>. For a sequence <bold>x </bold>= <italic>x</italic><sub>1</sub>, ..., <italic>x</italic><sub><italic>n</italic></sub>, let <italic>n</italic><sub><italic>k </italic></sub>be the number of linker DNAs of length <italic>k</italic>. Then</p>
      <p>for <italic>k </italic>= 1, ..., τ<sub><italic>L </italic></sub>.<disp-formula id="bmcM1"><label>(1)</label><graphic xlink:href="1471-2105-11-346-i5.gif"/></disp-formula></p>
      <p>for <italic>k </italic>= 1, ..., τ<sub><italic>L </italic></sub>.</p>
      <p>3. Update the empirical linker length distribution from step 2 using a kernel smoothing method as follows:<disp-formula id="bmcM2"><label>(2)</label><graphic xlink:href="1471-2105-11-346-i6.gif"/></disp-formula></p>
      <p>where <italic>K </italic>is the standard Gaussian kernel and <italic>h </italic>is the bandwidth parameter optimally chosen by the leave-one cross-validation method as in [<xref ref-type="bibr" rid="B19">19</xref>].</p>
      <p>4. Use the updated linker length distribution from step 3 to compute the nucleosome occupancy and optimal positioning.</p>
      <p>Compared to Viterbi training (i.e., using linker length predicted from the Viterbi algorithm), using the posterior expectation obtained in Eq. (1) combined with the kernel method in Eq. (2) performs overwhelmingly better in minimizing the summed square errors <inline-formula><inline-graphic xlink:href="1471-2105-11-346-i7.gif"/></inline-formula> (unpublished work [<xref ref-type="bibr" rid="B17">17</xref>]). In the developed software tool NuPoP, we have trained the linker DNA length distributions for 11 different species including human, mouse, rat, zebrafish, <italic>D. melanogaster, C. elegans, S. cerevisiae, C. albicans, S. pombe; A. thaliana </italic>and maize. The linker DNA length distribution (F<sub><italic>L</italic></sub>) for each species has been trained by scanning the corresponding genome sequences based on τ <sub><italic>L </italic></sub>= 500. We found that the re-scaled nucleosome and linker profiles, together with the trained linker length distribution, not only roughly recover the genome-wide base compositions, but also the dinucleotide frequencies for different species. The frequency of each single or di-nucleotide in simulated genomes typically differs by ≤ 1% from that observed in the corresponding real genomes (results not shown). As different cell types from the same organism (with the same genome) can exhibit quite different linker DNA length distributions [<xref ref-type="bibr" rid="B13">13</xref>], a useful future refinement would utilize high quality nucleosome maps for the given cell type, when such data become available.</p>
    </sec>
    <sec>
      <title>Software tools</title>
      <p>We have developed a software tool called NuPoP, implemented in three different formats: an R package tested for Windows XP, Linux and Mac OS X; a stand-alone Fortran program; and an NuPoP web server, all available from <ext-link ext-link-type="uri" xlink:href="http://nucleosome.stats.northwestern.edu">http://nucleosome.stats.northwestern.edu</ext-link>. The R package is built upon the Fortran program. It provides additional handy functions to visualize the resulting Viterbi (most probable nucleosome position map) and nucleosome occupancy predictions. Both the R package and Fortran program can handle a genomic sequence of any length with a RAM demand &lt;400 M bytes. The predicted results are stored locally in the working directory. The web server provides an interface through which the user can submit their own sequence up to 500 K bp in length for fast online prediction. When making a prediction, the user is required to specify which species the genomic sequence is from. If the species is not on the list, NuPoP will calculate the base composition of the input DNA sequence and then choose the nucleosome and linker models from a species that has the most similar base composition. An alternative model with a 1st order time-dependent Markov chain for the nucleosome state and a homogeneous 1st order Markov model for the linker state, trained in the same way, is also implemented in NuPoP as an option.</p>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>Updating <italic>F</italic><sub><italic>L </italic></sub>improves prediction</title>
      <p>Updating the linker length distribution not only helps recover the true nucleosome density, but also improves prediction. We demonstrated this by simulation as follows. We simulated 10 genomic sequences with the 4th and 1st order yeast models respectively, each containing 10,000 nucleosomes and 10,001 linkers. The linker DNA length was simulated from a Normal distribution (<italic>μ </italic>= 100, <italic>σ </italic>= 20) and a Gamma distribution (α = 1, β = 1/40). If a nucleosome is predicted within ±35 bp of a true nucleosome, we define it as a correct positive prediction. The rate of the correct positive prediction, referred to as <italic>sensitivity</italic>, is defined as the percentage of the 10,000 nucleosomes that are correctly predicted. In addition, we include the false discovery rate (FDR), defined as the fraction of the predicted nucleosomes that reside &gt; ±35 bp away from any true nucleosomes, as the second measure for model performance. In analogy to statistical hypothesis testing, the sensitivity measures the power of prediction, while the FDR measures the fraction of type I errors in the positive claims. The results are presented in Table <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T2">2</xref>. In both cases, the linker length was initialized as a uniform distribution with τ<sub><italic>L </italic></sub>= 200. Compared to the Gamma distribution, the Normal distribution is relatively flatter. Thereby updating the linker length distribution did not significantly change the total number of predicted nucleosomes (or nucleosome density). The sensitivity increased on average by ~ 4-5% and the FDR dropped by ~ 5% after one update (for both the first and fourth order models). Further updating continued to improve the prediction until it stabilized after four iterations. In contrast, the Gamma model is much more skewed. The uniform linker length distribution resulted in an under-estimation of the total number of nucleosomes. By four updatings, the sensitivity increased by 8%, while FDR remained relatively more stable.</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Updating linker length improves prediction - Normal linker length model</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th/>
              <th/>
              <th align="left">1st order</th>
              <th/>
              <th/>
              <th/>
              <th align="left">4th order</th>
              <th/>
            </tr>
            <tr>
              <th align="left">update</th>
              <th align="left">total</th>
              <th align="left">sensitivity(%)</th>
              <th align="left">FDR(%)</th>
              <th align="left">update</th>
              <th/>
              <th align="left">sensitivity (%)</th>
              <th align="left">FDR(%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="left">10215 (14)</td>
              <td align="left">72 (0.5)</td>
              <td align="left">30 (0.5)</td>
              <td align="left">0</td>
              <td align="left">10253 (15)</td>
              <td align="left">75 (0.4)</td>
              <td align="left">27 (0.4)</td>
            </tr>
            <tr>
              <td align="left">1</td>
              <td align="left">10210 (12)</td>
              <td align="left">76 (0.5)</td>
              <td align="left">25 (0.5)</td>
              <td align="left">1</td>
              <td align="left">10231 (18)</td>
              <td align="left">80 (0.5)</td>
              <td align="left">22 (0.5)</td>
            </tr>
            <tr>
              <td align="left">4</td>
              <td align="left">10120 (19)</td>
              <td align="left">83 (0.7)</td>
              <td align="left">18 (0.8)</td>
              <td align="left">4</td>
              <td align="left">10131 (16)</td>
              <td align="left">85 (0.6)</td>
              <td align="left">16 (0.7)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Total predictions, sensitivity, and false discovery rate (FDR) are the averages (standard deviations in parentheses) based on 10 repeated simulations. For each simulation a genomic sequence consisting of 10000 nucleosomes and 10001 linkers were simulated using the 1st and 4th order yeast models. The linker length distribution was initialized as uniform on 1,..., 200, and was iteratively updated in the dHMM. Results are shown after 0, 1, and 4 updates.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap id="T2" position="float">
        <label>Table 2</label>
        <caption>
          <p>Updating linker length improves prediction - Gamma linker length model</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th/>
              <th/>
              <th align="left">1st order</th>
              <th/>
              <th/>
              <th/>
              <th align="left">4th order</th>
              <th/>
            </tr>
            <tr>
              <th align="left">update</th>
              <th align="left">total</th>
              <th align="left">sensitivity(%)</th>
              <th align="left">FDR(%)</th>
              <th align="left">update</th>
              <th>total</th>
              <th align="left">sensitivity (%)</th>
              <th align="left">FDR(%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">0</td>
              <td align="left">8670 (22)</td>
              <td align="left">59 (0.7)</td>
              <td align="left">32 (0.7)</td>
              <td align="left">0</td>
              <td align="left">8896 (27)</td>
              <td align="left">64 (0.5)</td>
              <td align="left">28 (0.5)</td>
            </tr>
            <tr>
              <td align="left">1</td>
              <td align="left">9347 (25)</td>
              <td align="left">65 (0.8)</td>
              <td align="left">30 (0.7)</td>
              <td align="left">1</td>
              <td align="left">9550 (42)</td>
              <td align="left">70 (0.6)</td>
              <td align="left">26 (0.6)</td>
            </tr>
            <tr>
              <td align="left">4</td>
              <td align="left">9833 (39)</td>
              <td align="left">67 (0.7)</td>
              <td align="left">31 (0.7)</td>
              <td align="left">4</td>
              <td align="left">9880 (35)</td>
              <td align="left">72 (0.5)</td>
              <td align="left">27 (0.6)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Total predictions, sensitivity, and false discovery rate (FDR) are the averages (standard deviations in parentheses) based on 10 repeated simulations. For each simulation a genomic sequence consisting of 10000 nucleosomes and 10001 linkers were simulated using the 1st and 4th order yeast models. The linker length distribution was initialized as uniform on 1,..., 200, and was iteratively updated in the dHMM. Results are shown after 0, 1, and 4 updates.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>We also observe that under the same setting and condition, the fourth order model performs slightly but uniformly better than the first order model in both sensitivity and FDR. This is given that the true models are known and we scan the sequence using the true models. In theory, the first order Markov chain model is nested in the fourth order model. Therefore if the true model is the first order, a well trained fourth order model will have the same prediction power as the first order model, but not vice versa. Since training a higher order Markov chain model requires more data, inadequate training can undermine the prediction power.</p>
    </sec>
    <sec>
      <title>Re-scaling vs. not Re-scaling</title>
      <p>To illustrate the advantages of re-scaling, we re-scaled the yeast profiles according to the base composition of the maize genome (G/C scaling factor in maize is 1.2). Using the re-scaled profiles we simulated 10 genomic sequences that each contain 10,000 nucleosomes and 10,001 linkers. The linker DNA length followed the same two distributions as in Table <xref ref-type="table" rid="T1">1</xref> and <xref ref-type="table" rid="T2">2</xref>. We compare the prediction results from the scaled and non-scaled yeast profiles in Table <xref ref-type="table" rid="T3">3</xref> and <xref ref-type="table" rid="T4">4</xref>. We found using the re-scaled ("correct") profile yields a lower FDR than using the yeast profile. In addition, updating the linker length under the correct profile consistently improves the sensitivity and FDR until prediction stabilizes. In contrast, while using the yeast profile to scan the simulated maize-like genome, the prediction drastically deteriorates as the linker length updating proceeds. The same simulation was repeated on other species including human and <italic>C. elegans</italic>, where the base composition is similar to yeast (A/T scaling factor is 0.96 for <italic>C. elegans</italic>, and 1.03 for human). Unsurprisingly, the results from the scaled yeast profile were still better than those from the original yeast profile in terms of both sensitivity and FDR, while the difference is much smaller than for the maize case (results not shown).</p>
      <table-wrap id="T3" position="float">
        <label>Table 3</label>
        <caption>
          <p>Re-scaling models improves prediction - Normal linker length model</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">model</th>
              <th align="left">update</th>
              <th align="left">re-scaled total</th>
              <th align="left">sensitivity (%)</th>
              <th align="left">FDR(%)</th>
              <th align="left">update</th>
              <th align="left">total</th>
              <th align="left">sensitivity (%)</th>
              <th align="left">FDR(%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">1st</td>
              <td align="left">0</td>
              <td align="left">10266 (12)</td>
              <td align="left">71 (0.4)</td>
              <td align="left">31 (0.4)</td>
              <td align="left">0</td>
              <td align="left">13272 (24)</td>
              <td align="left">59 (0.5)</td>
              <td align="left">55 (0.4)</td>
            </tr>
            <tr>
              <td/>
              <td align="left">1</td>
              <td align="left">10279 (15)</td>
              <td align="left">76 (0.4)</td>
              <td align="left">27 (0.4)</td>
              <td align="left">1</td>
              <td align="left">14803 (25)</td>
              <td align="left">53 (0.4)</td>
              <td align="left">64 (0.3)</td>
            </tr>
            <tr>
              <td/>
              <td align="left">2</td>
              <td align="left">10240 (19)</td>
              <td align="left">79 (0.3)</td>
              <td align="left">23 (0.3)</td>
              <td align="left">2</td>
              <td align="left">15383 (23)</td>
              <td align="left">51 (0.4)</td>
              <td align="left">67 (0.3)</td>
            </tr>
            <tr>
              <td align="left">4th</td>
              <td align="left">0</td>
              <td align="left">10280 (16)</td>
              <td align="left">74 (0.3)</td>
              <td align="left">28 (0.3)</td>
              <td align="left">0</td>
              <td align="left">12785 (28)</td>
              <td align="left">63 (0.4)</td>
              <td align="left">51 (0.4)</td>
            </tr>
            <tr>
              <td/>
              <td align="left">1</td>
              <td align="left">10267 (20)</td>
              <td align="left">79 (0.4)</td>
              <td align="left">24 (0.5)</td>
              <td align="left">1</td>
              <td align="left">14065 (25)</td>
              <td align="left">58 (0.3)</td>
              <td align="left">59 (0.3)</td>
            </tr>
            <tr>
              <td/>
              <td align="left">2</td>
              <td align="left">10220 (24)</td>
              <td align="left">81 (0.4)</td>
              <td align="left">20 (0.5)</td>
              <td align="left">2</td>
              <td align="left">14591 (24)</td>
              <td align="left">55 (0.4)</td>
              <td align="left">62 (0.3)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Total predictions, sensitivity, and false discovery rate (FDR) are the averages (standard deviations in parentheses) based on 10 repeated simulations. For each simulation a maize-like genomic sequence consisting of 10000 nucleosomes and 10001 linkers were simulated using the re-scaled 1st and 4th order yeast models. Each sequence was scanned using the true models (re-scaled, 1st or 4th order) and the yeast models with an initial uniform linker length distribution on 1,..., 200. The results after 0, 1, 2 updates of linker length distribution are compared.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap id="T4" position="float">
        <label>Table 4</label>
        <caption>
          <p>Re-scaling models improves prediction - Gamma linker length mode l</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">model</th>
              <th align="left">update</th>
              <th align="left">re-scaled total</th>
              <th align="left">sensitivity (%)</th>
              <th align="left">FDR(%)</th>
              <th align="left">update</th>
              <th align="left">total</th>
              <th align="left">sensitivity (%)</th>
              <th align="left">FDR(%)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">1st</td>
              <td align="left">0</td>
              <td align="left">8746 (28)</td>
              <td align="left">60 (0.7)</td>
              <td align="left">31 (0.6)</td>
              <td align="left">0</td>
              <td align="left">10640 (19)</td>
              <td align="left">70 (0.3)</td>
              <td align="left">35 (0.3)</td>
            </tr>
            <tr>
              <td/>
              <td align="left">1</td>
              <td align="left">9471 (42)</td>
              <td align="left">67 (0.7)</td>
              <td align="left">30 (0.6)</td>
              <td align="left">1</td>
              <td align="left">11513 (14)</td>
              <td align="left">60 (0.6)</td>
              <td align="left">48 (0.6)</td>
            </tr>
            <tr>
              <td/>
              <td align="left">2</td>
              <td align="left">9787 (38)</td>
              <td align="left">68 (0.5)</td>
              <td align="left">30 (0.4)</td>
              <td align="left">2</td>
              <td align="left">11812 (18)</td>
              <td align="left">55 (0.4)</td>
              <td align="left">53 (0.3)</td>
            </tr>
            <tr>
              <td align="left">4th</td>
              <td align="left">0</td>
              <td align="left">8886 (18)</td>
              <td align="left">63 (0.3)</td>
              <td align="left">29 (0.4)</td>
              <td align="left">0</td>
              <td align="left">10461 (25)</td>
              <td align="left">73 (0.7)</td>
              <td align="left">30 (0.7)</td>
            </tr>
            <tr>
              <td/>
              <td align="left">1</td>
              <td align="left">9533 (26)</td>
              <td align="left">70 (0.8)</td>
              <td align="left">27 (0.8)</td>
              <td align="left">1</td>
              <td align="left">11190 (32)</td>
              <td align="left">66 (0.7)</td>
              <td align="left">41 (0.7)</td>
            </tr>
            <tr>
              <td/>
              <td align="left">2</td>
              <td align="left">9775 (33)</td>
              <td align="left">72 (0.8)</td>
              <td align="left">27 (0.9)</td>
              <td align="left">2</td>
              <td align="left">11443 (26)</td>
              <td align="left">63 (0.5)</td>
              <td align="left">45 (0.5)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Total predictions, sensitivity, and false discovery rate (FDR) are the averages (standard deviations in parentheses) based on 10 repeated simulations. For each simulation a maize-like genomic sequence consisting of 10000 nucleosomes and 10001 linkers were simulated using the re-scaled 1st and 4th order yeast models. Each sequence was scanned using the true models (re-scaled, 1st or 4th order) and the yeast models with an initial uniform linker length distribution on 1,..., 200. The results after 0, 1, 2 updates of linker length distribution are compared.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>NuPoP vs. other software tools</title>
      <p>We briefly assess the prediction performance of NuPoP by comparing it with two existing methods: the N-score method of [<xref ref-type="bibr" rid="B4">4</xref>] (results kindly provided by Dr. G. Yuan, personal communication) and the Markov model/thermodynamic equilibrium method of [<xref ref-type="bibr" rid="B7">7</xref>] (to be called MM/TE method below). As the exact genome-wide nucleosome positioning map is unknown, we utilize the 371,914 454 high-throughput sequence reads to identify well-defined nucleosomes. We first selected sequences of length between 130-160 bp and constructed a reads-based occupancy map. The reads-occupancy score at a specific position is defined as the number of reads that covered this position. Then we calculated the moving average of this reads occupancy score using a 147 bp window. A sharp peak in the average occupancy curve indicates a nucleosome with well-defined positioning. Considering that the average linker DNA length is 20 bp in yeast [<xref ref-type="bibr" rid="B13">13</xref>], we quantified the sharpness of the peak by calculating the slope from the peak point to the up-/down-stream 20 bp point on the average occupancy curve. We set one condition for the peak to be selected as the center of a nucleosome to be that the absolute value of slope from either side should be &gt; 0.01. Secondly, we required that the peak height itself must be ≥ 1.9, i.e., a well-defined nucleosome must be testified by at least two well-overlapped reads. We chose the threshold value as 1.9 instead of 2.0 because the overlap of the two reads can be less than 147 bp, resulting in a peak on the moving average curve slightly lower than 2.0. With these criteria, a total of 20,471 well-defined nucleosomes are selected from the 16 chromosomes of yeast. A snapshot of a region with many selected well-defined nucleosomes is presented in Figure <xref ref-type="fig" rid="F1">1</xref>. Figure <xref ref-type="fig" rid="F2">2</xref> provides a snapshot of nucleosome occupancy predicted by NuPoP together with the reads-occupancy.</p>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p><bold>A plot of the experimentally defined reads occupancy score (red curve) for a region of yeast chromosome 4 showing the selected well-defined nucleosomes (grey shaded bars)</bold>.</p>
        </caption>
        <graphic xlink:href="1471-2105-11-346-1"/>
      </fig>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>A snapshot of predicted nucleosome occupancy from NuPoP (shaded grey) compared with the experimentally obtained reads-occupancy (red)</bold>.</p>
        </caption>
        <graphic xlink:href="1471-2105-11-346-2"/>
      </fig>
      <p>We first assess the sensitivity of predictions from NuPoP using the well-defined control set. If there is a predicted nucleosome within ±<italic>k </italic>bp of any well-defined nucleosomes (center to center), we count this as one correct prediction. We varied <italic>k </italic>from 5, 10, ... 70, 73 to investigate the sensitivity behavior at different precision thresholds. The N-score model predicted 48,394 nucleosomes. The current software tool for MM/TE method does not provide Viterbi predictions, but only the nucleosome occupancy scores. Therefore we calculated the moving average of the occupancy score using a 147 bp moving window. The resulting peaks were treated as the centers of predicted nucleosomes. If two peaks reside within 127 bp, we discarded the one with smaller moving average of occupancy score. This procedure identified 43,979 predicted nucleosomes (if we had required two nucleosomes to be 147 bp away, even fewer nucleosomes would have been identified). Likewise, using the occupancy scores from NuPoP, we identified 52,327 and 51,380 predicted nucleosomes under the 4th and 1st order models respectively. In Figure <xref ref-type="fig" rid="F3">3a</xref>, we compare the sensitivity estimates from the 4th order model of NuPoP with the N-score and MM/TE methods at different threshold values of prediction accuracy (the fourth order model from NuPoP performs better, but very slightly, than the first order model. Hence the latter was omitted in Figure <xref ref-type="fig" rid="F3">3</xref> for better presentation). As the sensitivity tends to increase with an increase in the total predictions, we further selected 43,979 and 48,394 best predictions from NuPoP model (here "best" is in the sense of the largest sum of occupancies over 147 bp) to compare with the N-score method and in Figure <xref ref-type="fig" rid="F3">3b</xref> and <xref ref-type="fig" rid="F3">3c</xref> respectively.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Comparing sensitivity of NuPoP predictions with existing methods</bold>. The sensitivity is assessed based on 20,471 well-defined nucleosomes from 454 nucleosomes reads. We call a prediction correct if a nucleosome is predicted within +/- k bp distance (X-axis) of a well-defined nucleosome (center to center) for k = 5 to 73. (a) Sensitivity plot of NuPoP (black) compared with N-score method (blue), MM/TE method (red), and the duration Hidden Markov Model using a uniform distribution on 1,...,500 (pink). The random expectation curve is not calculated because the total number of predictions varies in different methods. (b) Sensitivity plot of NuPoP (black) compared with MM/TE method (red) and random expectation (green) while controlling the total predictions to be the same as MM/TE method. Green: random expectation. (c) Sensitivity plot of NuPoP (black) compared with N-score method (red) and random expectation (green) while controlling the total predictions to be the same as N-score method.</p>
        </caption>
        <graphic xlink:href="1471-2105-11-346-3"/>
      </fig>
      <p>The sensitivity results suggest that the predictions from NuPoP outperforms the other two methods in two senses. Firstly, the sensitivity from NuPoP is 4.9-8.3% higher than the other two methods at different threshold values (Figure <xref ref-type="fig" rid="F3">3a</xref>). Secondly, while controlling the total predictions to be the same, NuPoP has ~ 3.2-5.3% higher sensitivity than the MM/TE method (Figure <xref ref-type="fig" rid="F3">3b</xref>), when the precision threshold is ≤ ±35. As the precision threshold gets less stringent, the difference attenuates and eventually vanishes. The contrast between NuPoP and the N-score method is even larger as shown in Figure <xref ref-type="fig" rid="F3">3c</xref>.</p>
      <p>As a further comparison, we computed the predictions of the dHMM method under a uniform linker length distribution defined on 1, 2,..., 500. This method predicted 48,334 nucleosomes under the 4th order models, achieving a sensitivity 3.0-6.6% higher than the MM/TE method (Figure <xref ref-type="fig" rid="F3">3a</xref>). When controlling the total predictions to be the same as MM/TE method or N-score method, the resulting sensitivity curve almost perfectly overlaps with that from NuPoP. Therefore we omitted these results from Figure <xref ref-type="fig" rid="F3">3b</xref> and <xref ref-type="fig" rid="F3">3c</xref>.</p>
      <p>One could further attempt to evaluate the false positive rate (FPR), measuring the fraction of linker regions that were falsely classified as nucleosome regions (or similarly the false discovery rate, FDR). This task requires well-defined linker regions. A problem, however, is that the average length of linker DNAs in yeast (20 bp; [<xref ref-type="bibr" rid="B13">13</xref>]) is smaller than the dispersion in lengths of the nucleosome DNAs as isolated biochemically (which is often 30-50 bp full width at half maximum, notwithstanding that the nucleosome as defined crystallographically has precisely 147 bp of DNA). Thus existing nucleosome maps lack the precision needed to define such short linker DNAs. Moreover, various sampling biases such as the DNA sequence preferences of the micrococcal nuclease used to liberate nucleosomes biochemically (which preferentially cleaves A/T rich regions) could yield longer genomic regions that are free of recovered nucleosome DNA reads even if they are actually nucleosome occupied [<xref ref-type="bibr" rid="B20">20</xref>]. Attempts to evaluate the FPR given these problems in the data could result in misleading conclusions. For these reasons, FPR evaluation is not pursued in this paper.</p>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>The duration Hidden Markov model proposed in this paper is a generic model for the oscillating structure of nucleosome and linker DNAs in chromatin fiber. The Markov models can be replaced by any other models for the nucleosome and linker states. The kernel method for linker length training is nonparametric and typically robust. We showed in the simulation that updating the linker length distribution iteratively improves sensitivity and FDR in prediction if appropriate nucleosome and linker models are used. In particular, the first iteration often achieves the most pronounced improvement. In contrast inappropriate nucleosome and linker models could lead to the opposite outcome, as shown in the simulation studies (Table <xref ref-type="table" rid="T3">3</xref> and Table <xref ref-type="table" rid="T4">4</xref>). In reality, the genomic DNAs are complicated by their biological functions. The models trained based on typical nucleosomes or linkers may not well fit some special genomic regions like repeated elements. To avoid possible risks due to such complications, we trained the linker length distribution less greedily by using only one iteration in NuPoP.</p>
    <p>Limitations may still exist in the model training and assessment used in this study. The MNase is known to have strong preference to cleave dinucleotides containing only A/T [<xref ref-type="bibr" rid="B21">21</xref>]. Consequently the MNase-mapped nucleosome sequences can be systematically biased in some regions. This bias could undermine the prediction power because of the dampened signal in the trained nucleosome model. The systematic bias may also exist in the well-defined nucleosomes, causing inaccuracy in sensitivity estimation. A better map of nucleosomes is highly desirable for both purposes. For species other than yeast, we currently lack high-quality genome-wide nucleosome sequence data (e.g., like the 454 reads) for model training and model validation. The advantages of the re-scaling method shown using simulation in this paper need to be further assessed once such high-quality data becomes available. Moreover, the results from different methods in this paper were all based on the default settings. The N-score method was originally trained based on a much smaller set of nucleosome and linker sequences. A better training using a larger set could improve this method's predictions. In addition, different settings in the N-score or MM/TE methods can lead to different predictions, which we did not further investigate here. Finally, the software for MM/TE method only provides the occupancy score. Different ways to call a predicted nucleosome based on the occupancy score might lead to different conclusions.</p>
    <p>Finally, we address the question of which subset of the available 454 reads data might best be used for training the nucleosome model. In NuPoP, we trained the nucleosome model using selected non-redundant nucleosome reads of length within a short range (146-149 bp), to retain strong high resolution nucleosome sequence signatures, e.g., the _10 bp-periodic dinucleotide signals. As comparisons, we trained two additional nucleosome models: one using the selected non-redundant reads of length 122-177 bp (retaining the non-redundancy but yielding far more training data), and the other using all reads of length 122-177 bp. The resulting models both contain the k-mer usage information that distinguishes nucleosomes from linkers (e.g., [<xref ref-type="bibr" rid="B3">3</xref>,<xref ref-type="bibr" rid="B4">4</xref>]), while the dinucleotide signals in these models are much weaker due to poor alignment of these reads. Furthermore, as the reads count at a nucleosome site is heavily biased by the G/C content due to MNase specificity and other effects in the experiment, the model trained from the redundant reads tends to be over-enriched in G/C. When combined with the linker model from NuPoP, the two alternative nucleosome models yielded comparable sensitivity as NuPoP in predicting the approximate positioning of nucleosomes, assessed based on the 20,471 well-defined nucleosomes used above. This comparison, however, is not sensitive to spatial precision of the predictions. Therefore, we asked further, given that a nucleosome is predicted within ±73 of a true nucleosome, which model predicts the location more accurately? To investigate this, we simulated genomic sequences using the nucleosome and linker models from NuPoP. We compared the prediction from the three models and found that the true model with strong signals achieves much better prediction accuracy than the two alternative models. For example, 16.1% of the predictions from the true model were prefect (with 0 bp offset), compared to 8.7% and 5.9% respectively from the other two models (results not shown).</p>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>The dHMM model proposed in this paper is effective in characterizing the oscillating structure of nucleosome and linker DNAs in chromatin fiber. Explicit modeling of linker length improves the prediction of nucleosome positioning regarding sensitivity. The developed software tool NuPoP provides a user-friendly interface for predicting nucleosome occupancy and the most probable nucleosomes positioning map genome-wide.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>NuPoP software tools are freely available from <ext-link ext-link-type="uri" xlink:href="http://nucleosome.stats.northwestern.edu">http://nucleosome.stats.northwestern.edu</ext-link>. The R package shall be made available through bioconductor <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org">http://www.bioconductor.org</ext-link> upon publication. To run the NuPoP Fortran stand-alone program, a Fortran compiler is required. For the NuPoP R package, an R version later than 2.9 is required.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>LXi did all the data analyses. JPW, JW, and LXi wrote the paper. JPW and JW directed the research. YFM conducted all lab work for data generation and validation. JPW and LXi developed the NuPoP software tools. LXia and JF implemented the NuPoP web-server. All authors read and approved the final manuscript.</p>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>The research is supported by NIH grant R01GM075313 and NCI grant U54CA143869. We acknowledge with gratitude the gift of a parallel sequencing run from Roche/454 Life Sciences, and thank Ms. Jolene Osterberger (Roche/454 Life Sciences) and Dr. Nadereh Jafari (Northwestern University) for arranging this. The authors would also like to thank Drs. Eran Segal, Guocheng Yuan, Zhiping Weng and Yutao Fu for help in providing data and their codes.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Segal</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Fondufe-Mittendorf</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Thåström</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Field</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Moore</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>JPZ</given-names>
        </name>
        <name>
          <surname>Widom</surname>
          <given-names>J</given-names>
        </name>
        <article-title>A genomic code for nucleosome positioning</article-title>
        <source>Nature</source>
        <year>2006</year>
        <volume>442</volume>
        <fpage>772</fpage>
        <lpage>778</lpage>
        <pub-id pub-id-type="doi">10.1038/nature04979</pub-id>
        <pub-id pub-id-type="pmid">16862119</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ioshikhes</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Bolshoy</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Derenshteyn</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Borodovsky</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Trifonov</surname>
          <given-names>EN</given-names>
        </name>
        <article-title>Nucleosome DNA Sequence Pattern Revealed by Multiple Alignment of Experimentally Mapped Sequences</article-title>
        <source>J Mol Biol</source>
        <year>1996</year>
        <volume>262</volume>
        <fpage>129</fpage>
        <lpage>139</lpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.1996.0503</pub-id>
        <pub-id pub-id-type="pmid">8831784</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Peckham</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Thurman</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Fu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Stamatoyannopoulos</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Noble</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Struhl</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Weng</surname>
          <given-names>Z</given-names>
        </name>
        <article-title>Nucleosome positioning signals in genomic DNA</article-title>
        <source>Genome Res</source>
        <year>2007</year>
        <volume>17</volume>
        <issue>8</issue>
        <fpage>1170</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.6101007</pub-id>
        <pub-id pub-id-type="pmid">17620451</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Yuan</surname>
          <given-names>GC</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>JS</given-names>
        </name>
        <article-title>Genomic sequence is highly predictive of local nucleosome depletion</article-title>
        <source>PLoS Computational Biology</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>e13</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.0040013</pub-id>
        <pub-id pub-id-type="pmid">18225943</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Tolstorukov</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Choudhary</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Olson</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Zhurkin</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Park</surname>
          <given-names>P</given-names>
        </name>
        <article-title>nuScore: a web-interface for nucleosome positioning predictions</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>28</volume>
        <fpage>1456</fpage>
        <lpage>1458</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn212</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Field</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Kaplan</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Fondufe-Mittendorf</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Moore</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Sharon</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Lubling</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Widom</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Segal</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Distinct modes of regulation by chromatin encoded through nucleosome positioning signals</article-title>
        <source>PLoS Comput Biol</source>
        <year>2008</year>
        <volume>4</volume>
        <issue>9</issue>
        <fpage>e1000175</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000175</pub-id>
        <pub-id pub-id-type="pmid">18787693</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kaplan</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Moore</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Fondufe-Mittendorf</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Gopssett</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Tillo</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Field</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>LeProust</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Hughes</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Lieb</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Widom</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Segal</surname>
          <given-names>E</given-names>
        </name>
        <article-title>The DNA-Encoded Nucleosome Organization of a Eukaryotic Genome</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>458</volume>
        <fpage>362</fpage>
        <lpage>368</lpage>
        <pub-id pub-id-type="doi">10.1038/nature07667</pub-id>
        <pub-id pub-id-type="pmid">19092803</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schones</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Cui</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Cuddapah</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Roh</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Barski</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Wei</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Dynamic regulation of nucleosome positioning in the human genome</article-title>
        <source>Cell</source>
        <year>2008</year>
        <volume>132</volume>
        <issue>5</issue>
        <fpage>887</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2008.02.022</pub-id>
        <pub-id pub-id-type="pmid">18329373</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lee</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Shibata</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Rao</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Strahl</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Lieb</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Evidence for nucleosome depletion at active regulatory regions genome-wide</article-title>
        <source>Nature Genetics</source>
        <year>2004</year>
        <volume>36</volume>
        <fpage>900</fpage>
        <lpage>905</lpage>
        <pub-id pub-id-type="doi">10.1038/ng1400</pub-id>
        <pub-id pub-id-type="pmid">15247917</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lee</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Tillo</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Bray</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Morse</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Davis</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Hughes</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Nislow</surname>
          <given-names>C</given-names>
        </name>
        <article-title>A high-resolution atlas of nucleosome occupancy in yeast</article-title>
        <source>Nature Genetics</source>
        <year>2007</year>
        <volume>39</volume>
        <issue>10</issue>
        <fpage>1235</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1038/ng2117</pub-id>
        <pub-id pub-id-type="pmid">17873876</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Whitehouse</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Tsukiyama</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Antagonistic forces that position nucleosomes in vivo</article-title>
        <source>Nat Struct Mol Biol</source>
        <year>2006</year>
        <volume>13</volume>
        <fpage>633</fpage>
        <lpage>640</lpage>
        <pub-id pub-id-type="doi">10.1038/nsmb1111</pub-id>
        <pub-id pub-id-type="pmid">16819518</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lubliner</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Segal</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Modeling interactions between adjacent nucleosomes improves genome-wide predictions of nucleosome occupancy</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>12</issue>
        <fpage>i348</fpage>
        <comment>i355</comment>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp216</pub-id>
        <pub-id pub-id-type="pmid">19478009</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="book">
        <name>
          <surname>van Holde</surname>
          <given-names>KE</given-names>
        </name>
        <source>Chromatin</source>
        <year>1989</year>
        <publisher-name>Springer-Verlag</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rabiner</surname>
          <given-names>LR</given-names>
        </name>
        <article-title>A tutorial on hidden markov models and selected applications in speech recognition</article-title>
        <source>Proc IEEE</source>
        <year>1989</year>
        <volume>77</volume>
        <fpage>257</fpage>
        <lpage>285</lpage>
        <pub-id pub-id-type="doi">10.1109/5.18626</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rabiner</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Wilpon</surname>
          <given-names>JG</given-names>
        </name>
        <name>
          <surname>Soong</surname>
          <given-names>FK</given-names>
        </name>
        <article-title>High performance connected digit recognition using hidden Markov models</article-title>
        <source>IEEE Transaction on Acoustics, Speech and Signal Processing</source>
        <year>1990</year>
        <volume>37</volume>
        <issue>8</issue>
        <fpage>1214</fpage>
        <lpage>1225</lpage>
        <pub-id pub-id-type="doi">10.1109/29.31269</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Burshtein</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Robust parametric modeling of durations in hidden Markov models</article-title>
        <source>IEEE Transactions on Speech and Audio Processing</source>
        <year>1996</year>
        <volume>4</volume>
        <fpage>240</fpage>
        <lpage>242</lpage>
        <pub-id pub-id-type="doi">10.1109/89.496221</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="other">
        <name>
          <surname>Wang</surname>
          <given-names>JP</given-names>
        </name>
        <name>
          <surname>Xi</surname>
          <given-names>L</given-names>
        </name>
        <article-title>Duration estimation for Hidden Markov Models</article-title>
        <source>unpublished</source>
        <year>2010</year>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wang</surname>
          <given-names>JPZ</given-names>
        </name>
        <name>
          <surname>Widom</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Improved alignment of nucleosome DNA sequences using a mixture model</article-title>
        <source>Nucleic Acids Research</source>
        <year>2005</year>
        <volume>22</volume>
        <issue>22</issue>
        <fpage>6743</fpage>
        <lpage>55</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gki977</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="other">
        <name>
          <surname>Wang</surname>
          <given-names>JP</given-names>
        </name>
        <article-title>Estimating the species richness by a Poisson-compound Gamma model</article-title>
        <source>To Appear in Biometrika</source>
        <year>2010</year>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Valouev</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Ichikawa</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Tonthat</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Stuart</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Ranade</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Peckham</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Zeng</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Malek</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Costa</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>McKernan</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Sidow</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fire</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Johnson</surname>
          <given-names>S</given-names>
        </name>
        <article-title>A high-resolution, nucleosome position map of C. elegans reveals a lack of universal sequence-dictated positioning</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <issue>7</issue>
        <fpage>1051</fpage>
        <lpage>63</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.076463.108</pub-id>
        <pub-id pub-id-type="pmid">18477713</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wang</surname>
          <given-names>JP</given-names>
        </name>
        <name>
          <surname>Fondufe-Mittendorf</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Xi</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Tsai</surname>
          <given-names>GF</given-names>
        </name>
        <name>
          <surname>Segal</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Widom</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Preferentially quantized linker DNA lengths in <italic>Saccharomyces cerevisiae</italic></article-title>
        <source>PLoS Computational Biology</source>
        <year>2008</year>
        <volume>4</volume>
        <issue>9</issue>
        <fpage>e1000175</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000175</pub-id>
        <pub-id pub-id-type="pmid">18787693</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
