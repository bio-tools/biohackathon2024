<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">mSystems</journal-id>
    <journal-id journal-id-type="iso-abbrev">mSystems</journal-id>
    <journal-id journal-id-type="hwp">msys</journal-id>
    <journal-id journal-id-type="publisher-id">mSystems</journal-id>
    <journal-title-group>
      <journal-title>mSystems</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2379-5077</issn>
    <publisher>
      <publisher-name>American Society for Microbiology</publisher-name>
      <publisher-loc>1752 N St., N.W., Washington, DC</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7901478</article-id>
    <article-id pub-id-type="publisher-id">mSystems00917-20</article-id>
    <article-id pub-id-type="doi">10.1128/mSystems.00917-20</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="overline">
        <subject>Host-Microbe Biology</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>FADU: a Quantification Tool for Prokaryotic Transcriptomic Analyses</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9545-523X</contrib-id>
        <name>
          <surname>Chung</surname>
          <given-names>Matthew</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>b</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Adkins</surname>
          <given-names>Ricky S.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mattick</surname>
          <given-names>John S. A.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bradwell</surname>
          <given-names>Katie R.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shetty</surname>
          <given-names>Amol C.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sadzewicz</surname>
          <given-names>Lisa</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tallon</surname>
          <given-names>Luke J.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fraser</surname>
          <given-names>Claire M.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="aff3" ref-type="aff">
          <sup>c</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-7337-7154</contrib-id>
        <name>
          <surname>Rasko</surname>
          <given-names>David A.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>b</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mahurkar</surname>
          <given-names>Anup</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3862-986X</contrib-id>
        <name>
          <surname>Dunning Hotopp</surname>
          <given-names>Julie C.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="aff2" ref-type="aff">
          <sup>b</sup>
        </xref>
        <xref rid="aff4" ref-type="aff">
          <sup>d</sup>
        </xref>
      </contrib>
      <aff id="aff1">
        <label>a</label>
        <addr-line>Institute for Genome Sciences, University of Maryland School of Medicine, Baltimore, Maryland, USA</addr-line>
      </aff>
      <aff id="aff2">
        <label>b</label>
        <addr-line>Department of Microbiology and Immunology, University of Maryland School of Medicine, Baltimore, Maryland, USA</addr-line>
      </aff>
      <aff id="aff3">
        <label>c</label>
        <addr-line>Department of Medicine, University of Maryland School of Medicine, Baltimore, Maryland, USA</addr-line>
      </aff>
      <aff id="aff4">
        <label>d</label>
        <addr-line>Greenebaum Cancer Center, University of Maryland School of Medicine, Baltimore, Maryland, USA</addr-line>
      </aff>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Greene</surname>
          <given-names>Casey S.</given-names>
        </name>
        <role>Editor</role>
        <aff>University of Pennsylvania</aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Address correspondence to Julie C. Dunning Hotopp, <email>jdhotopp@som.umaryland.edu</email>.</corresp>
      <fn fn-type="other">
        <p><bold>Citation</bold> Chung M, Adkins RS, Mattick JSA, Bradwell KR, Shetty AC, Sadzewicz L, Tallon LJ, Fraser CM, Rasko DA, Mahurkar A, Dunning Hotopp JC. 2021. FADU: a quantification tool for prokaryotic transcriptomic analyses. mSystems 6:e00917-20. <ext-link xlink:href="https://doi.org/10.1128/mSystems.00917-20" ext-link-type="uri">https://doi.org/10.1128/mSystems.00917-20</ext-link>.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <season>Jan-Feb</season>
      <year>2021</year>
    </pub-date>
    <volume>6</volume>
    <issue>1</issue>
    <elocation-id>e00917-20</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>11</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2021 Chung et al.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <copyright-holder>Chung et al.</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="mSystems.00917-20.pdf"/>
    <abstract abstract-type="precis">
      <p>Most currently available quantification tools for transcriptomics analyses have been designed for human data sets, in which full-length transcript sequences, including the untranslated regions, are well annotated. In most prokaryotic systems, full-length transcript sequences have yet to be characterized, leading to prokaryotic transcriptomics analyses being performed based on only the coding sequences.</p>
    </abstract>
    <abstract>
      <title>ABSTRACT</title>
      <p>Quantification tools for RNA sequencing (RNA-Seq) analyses are often designed and tested using human transcriptomics data sets, in which full-length transcript sequences are well annotated. For prokaryotic transcriptomics experiments, full-length transcript sequences are seldom known, and coding sequences must instead be used for quantification steps in RNA-Seq analyses. However, operons confound accurate quantification of coding sequences since a single transcript does not necessarily equate to a single gene. Here, we introduce FADU (Feature Aggregate Depth Utility), a quantification tool designed specifically for prokaryotic RNA-Seq analyses. FADU assigns partial count values proportional to the length of the fragment overlapping the target feature. To assess the ability of FADU to quantify genes in prokaryotic transcriptomics analyses, we compared its performance to those of eXpress, featureCounts, HTSeq, kallisto, and Salmon across three paired-end read data sets of (i) <named-content content-type="genus-species">Ehrlichia chaffeensis</named-content>, (ii) <named-content content-type="genus-species">Escherichia coli</named-content>, and (iii) the <italic toggle="yes">Wolbachia</italic> endosymbiont <italic toggle="yes">w</italic>Bm. Across each of the three data sets, we find that FADU can more accurately quantify operonic genes by deriving proportional counts for multigene fragments within operons. FADU is available at <ext-link xlink:href="https://github.com/IGS/FADU" ext-link-type="uri">https://github.com/IGS/FADU</ext-link>.</p>
      <p><bold>IMPORTANCE</bold> Most currently available quantification tools for transcriptomics analyses have been designed for human data sets, in which full-length transcript sequences, including the untranslated regions, are well annotated. In most prokaryotic systems, full-length transcript sequences have yet to be characterized, leading to prokaryotic transcriptomics analyses being performed based on only the coding sequences. In contrast to eukaryotes, prokaryotes contain polycistronic transcripts, and when genes are quantified based on coding sequences instead of transcript sequences, this leads to an increased abundance of improperly assigned ambiguous multigene fragments, specifically those mapping to multiple genes in operons. Here, we describe FADU, a quantification tool for prokaryotic RNA-Seq analyses designed to assign proportional counts with the purpose of better quantifying operonic genes while minimizing the pitfalls associated with improperly assigning fragment counts from ambiguous transcripts.</p>
    </abstract>
    <kwd-group>
      <title>KEYWORDS</title>
      <kwd>bacteria</kwd>
      <kwd>differential expression</kwd>
      <kwd>operon</kwd>
      <kwd>polycistronic transcripts</kwd>
      <kwd>read count</kwd>
      <kwd>software</kwd>
      <kwd>transcriptome</kwd>
      <kwd>transcriptomics</kwd>
    </kwd-group>
    <funding-group>
      <award-group id="award1">
        <funding-source>
          <institution-wrap>
            <institution>HHS | NIH | National Institute of Allergy and Infectious Diseases (NIAID)</institution>
            <institution-id>https://doi.org/10.13039/100000060</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>U19AI110820</award-id>
        <principal-award-recipient>
          <name>
            <surname>Dunning Hotopp</surname>
            <given-names>Julie C.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <counts>
      <count count="3" count-type="supplementary-material"/>
      <fig-count count="7"/>
      <table-count count="2"/>
      <equation-count count="7"/>
      <ref-count count="25"/>
      <page-count count="16"/>
      <word-count count="8848"/>
    </counts>
    <custom-meta-group>
      <custom-meta>
        <meta-name>cover-date</meta-name>
        <meta-value>January/February 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>INTRODUCTION</title>
    <p>Differential expression transcriptomics analyses frequently involve the quantification of the number of paired-end reads, or fragments, that are overlapping each gene. Traditional quantification tools, such as featureCounts (<xref rid="B1" ref-type="bibr">1</xref>) or HTSeq (<xref rid="B2" ref-type="bibr">2</xref>), first require an alignment step, in which paired-end reads are aligned to a reference genome using tools such as Bowtie2 (<xref rid="B3" ref-type="bibr">3</xref>, <xref rid="B4" ref-type="bibr">4</xref>), BWA (<xref rid="B5" ref-type="bibr">5</xref>), or HISAT2 (<xref rid="B6" ref-type="bibr">6</xref>). The subsequent quantification step uses the output alignment file in combination with a GFF/GTF annotation file to quantify the number of sequenced fragments that intersect the coordinates of each target gene. For transcriptomics experiments in which no whole-genome reference is available, a different subset of quantification tools was developed using <italic toggle="yes">de novo</italic> transcriptome assemblies, including the cufflinks suite of tools (<xref rid="B7" ref-type="bibr">7</xref><xref rid="B8" ref-type="bibr">–</xref><xref rid="B10" ref-type="bibr">10</xref>), RSEM (<xref rid="B11" ref-type="bibr">11</xref>), and eXpress (<xref rid="B12" ref-type="bibr">12</xref>). These tools bypass the need for a GFF/GTF annotation file and instead involve an alignment step in which fragments are mapped to reference transcript sequences instead of the whole genome. Most recently, alignment-free tools, such as kallisto (<xref rid="B13" ref-type="bibr">13</xref>) and Salmon (<xref rid="B14" ref-type="bibr">14</xref>), bypass the alignment step altogether and use raw sequencing fragments to directly quantify reference transcript sequences using pseudoalignments and k-mer-based counting approaches (<xref rid="B13" ref-type="bibr">13</xref>, <xref rid="B14" ref-type="bibr">14</xref>).</p>
    <p>All of these approaches work best with a well-annotated reference genome in which full-length transcript sequences have been identified. Each of the above-mentioned quantification tools was developed using human transcriptomics data sets as a template, and because of this, these tools are deficient when used to quantify genes for prokaryotic transcriptomics studies. Under ideal conditions, transcriptomic studies would quantify genes at the transcript level, but the lack of complete transcript annotations for most nonmodel eukaryotic and prokaryotic organisms forces transcriptomic analyses to be conducted at the coding sequence (CDS) level, failing to account for the untranslated regions (UTRs) of transcripts. This can be problematic in genomes with dense coding capacities and overlapping transcripts. It is especially problematic when analyzing prokaryotes due to the abundance of polycistronic transcripts from operons, with there being an estimated 630 to 700 operons in the &gt;5,000 genes found in the <named-content content-type="genus-species">Escherichia coli</named-content> genome (<xref rid="B15" ref-type="bibr">15</xref>).</p>
    <p>At the core of these problems is the method with which ambiguous fragments are quantified. Ambiguous fragments can be divided into two categories: (i) multimapping fragments, in which a fragment maps to multiple genomic regions equally, such as in the case of reads originating from paralogous genes, and (ii) multigene fragments, in which a fragment maps uniquely but overlaps multiple features. Each tool has a different method to quantify these types of ambiguous reads. By default, the genome alignment-based tools featureCounts and HTSeq fail to quantify multimapping fragments and mark them as ambiguous, while some transcript-alignment-based and alignment-free tools, such as cufflinks, eXpress, RSEM, kallisto, and Salmon, apply abundance estimation algorithms to assign partial counts. As an example, RSEM, eXpress, kallisto, and Salmon all apply an expectation maximization (EM) algorithm to ambiguous fragments, in which the number of fragments that unambiguously align to a target transcript is used to estimate the counts from ambiguous fragments originating from that target transcript (<xref rid="B16" ref-type="bibr">16</xref>).</p>
    <p>In the case of quantifying operons in prokaryotic systems, difficulties often stem from the quantification of multigene fragments. By default, featureCounts will assign a multigene fragment to the feature that overlaps the majority of individual paired-end reads in a given fragment and, in the case of a perfect split, marks the read ambiguous (<xref rid="B1" ref-type="bibr">1</xref>). In comparison, HTSeq does not quantify any multigene fragments and instead marks them as ambiguous (<xref rid="B2" ref-type="bibr">2</xref>). Both of these approaches lead to an underestimation of the actual mapped reads for these genes and, by extension, an underestimation of gene expression. Tools such as cufflinks, eXpress, RSEM, kallisto, and Salmon again rely on abundance estimation algorithms to assign proportional counts for both multigene fragments.</p>
    <p>However, the strategies used by these tools are inherently flawed when quantifying prokaryotic genes. For featureCounts and HTSeq, multigene fragments occur frequently in operons. While both of these tools have alternative modes for quantification, in which counts are assigned to all overlapped features, this often leads to an overquantification of features in close proximity that are not transcribed together (<xref rid="fig1" ref-type="fig">Fig. 1A</xref>). When run with default settings, discarding these reads underestimates the abundance of operonic genes, especially smaller genes in the middle of operons (<xref rid="fig1" ref-type="fig">Fig. 1B</xref>). The tools cufflinks, eXpress, kallisto, RSEM, and Salmon all require a reference containing transcript sequences. Because of the absence of full-transcript prokaryotic annotations, CDSs must often be used instead, leading to the discarding of fragments that map primarily to the 5′ or 3′ regions of genes. Additionally, the absence of transcript annotations for operons further complicates the analysis. The use of CDSs as the units for quantification implies that each CDS is a unique observation, which is not the case for operons. For fragments that overlap multiple genes in an operon, this causes the fragment count to be improperly split into multiple genes when it should optimally be equally counted for all genes. Ideally, this issue would be solved by first identifying the full-length transcript sequences for prokaryotes using laboratory techniques such as 5′ and 3′ rapid amplification of cDNA ends (RACE) or direct RNA sequencing (RNA-Seq) preceding transcriptomics-based analyses, but this is currently not practical given the number of different prokaryotic systems being studied.</p>
    <fig position="float" id="fig1">
      <label>FIG 1</label>
      <caption>
        <p>Implementation of FADU. (A) The workflow of FADU uses a BAM file and a GFF annotation file to identify proportional read counts for prokaryotic RNA-Seq analyses. (B) The implementation of FADU differs from those of other similar genome alignment-based quantification tools primarily in the quantification of ambiguous multigene fragments. The three sets of pie charts above a paired-end fragment display how the counts from the fragment are proportionally assigned to its overlapping genes. In the case of two overlapping genes, FADU accounts for only the unique portions of each gene and assigns a proportional count based on the length that the fragment overlaps the feature. (C) In the case of operons, FADU will assign proportional counts to the different genes based on the overlap between the mapping coordinates of the fragment and any overlapping genic features.</p>
      </caption>
      <graphic xlink:href="mSystems.00917-20-f0001" position="anchor"/>
    </fig>
    <p>In this study, we developed FADU (Feature Aggregate Depth Utility), a quantification tool specifically designed for prokaryotic transcriptomics analyses, to address the shortcomings centered around the quantification step of prokaryotic transcriptomics. FADU uses an alignment file generated by aligning reads to a whole-genome assembly and handles ambiguous multigene fragments by proportionally assigning fragment counts. Given a multigene fragment, FADU assesses the proportion of the fragment that overlaps the nonunique positions of each of its overlapped features and assigns a proportional fragment count. By assigning proportional read counts, FADU avoids the pitfalls that other tools have in quantifying operonic genes while minimizing the errors derived from quantifying multigene fragments. Here, we describe the implementation of FADU and compare its performance and utility to those of the alignment-dependent quantification tools featureCounts, HTSeq, and eXpress and the alignment-free quantification tools kallisto and Salmon.</p>
  </sec>
  <sec sec-type="results" id="s2">
    <title>RESULTS</title>
    <sec id="s2.1">
      <title>FADU implements a quantification method based on assigning proportional counts based on fragment overlap.</title>
      <p>FADU was designed with the objective of addressing ambiguous multigene fragments. A multigene fragment is a fragment represented by a read pair whose mapping coordinates overlap multiple features, which occurs in dense coding regions and operons. To properly identify multigene fragments in the absence of robust and rigorous operon predictions, we designed FADU to function using a BAM file aligned to a reference genome.</p>
      <p>For each paired-end fragment, FADU functions by assigning proportional counts based on the length of the different features that the fragment overlaps (<xref rid="fig1" ref-type="fig">Fig. 1C</xref>) as <italic toggle="yes">F<sub>c</sub></italic> = <italic toggle="yes">F<sub>O</sub>/F<sub>L</sub></italic>, where <italic toggle="yes">F<sub>c</sub></italic> represents the proportional fragment count contribution for a given fragment or read for each genic feature, <italic toggle="yes">F<sub>O</sub></italic> represents the number of bases that the fragment overlaps the unique positions of the genic feature, and <italic toggle="yes">F<sub>L</sub></italic> represents the total length of the fragment. In the case of overlapping genes, no proportional count values will be derived from ambiguous positions. For reads that are unable to be processed as read pairs, <italic toggle="yes">F<sub>c</sub></italic> is halved to prevent the contribution of discordant reads or singletons from overestimating the counts of a feature, as these discordant reads could be the result of potentially erroneous mappings. Following the assignment of uniquely mapping counts, using an expectation maximization (EM) approach (<xref rid="B17" ref-type="bibr">17</xref>) implemented similarly in other RNA-Seq quantification tools such as eXpress (<xref rid="B12" ref-type="bibr">12</xref>), kallisto (<xref rid="B13" ref-type="bibr">13</xref>), and Salmon (<xref rid="B14" ref-type="bibr">14</xref>), by default, FADU will derive counts from ambiguous multimapping fragments. After <italic toggle="yes">n</italic> EM iterations, transcripts per million (TPM) values for each genic feature are calculated using their unique positional lengths.</p>
    </sec>
    <sec id="s2.2">
      <title>Comparing the performance of FADU against other quantification tools using a simulated data set.</title>
      <p>We compared the performance of FADU to those of the default modes of several different RNA-Seq quantification tools, including the genome-alignment-based quantification tools featureCounts (<xref rid="B1" ref-type="bibr">1</xref>) and HTSeq, the transcriptome-alignment-based quantification tool eXpress, and the alignment-free quantification tools kallisto and Salmon. In addition to the default modes for each of these tools, we also assessed the derived counts from some of these tools using options designed to optimize the quantification of prokaryotic RNA-Seq data sets. This includes the <italic toggle="yes">-O</italic> and <italic toggle="yes">–fraction</italic> options for featureCounts, which will quantify ambiguous multigene fragments by assigning either a full count value or a proportional count value derived from the number of features that a paired-end fragment overlaps, respectively. We also compared the performance of FADU to those of all three modes of HTSeq, <italic toggle="yes">-m union</italic>, <italic toggle="yes">-m intersection-nonempty</italic>, and <italic toggle="yes">-m intersection strict</italic>, along with <italic toggle="yes">-m unique</italic> with the option <italic toggle="yes">–nonunique all</italic> (<xref rid="B2" ref-type="bibr">2</xref>). Compared to HTSeq <italic toggle="yes">-m union</italic>, HTSeq <italic toggle="yes">-m intersection-nonempty</italic> is liberal in assigning multigene fragments. Given a multigene fragment, HTSeq <italic toggle="yes">-m intersection-nonempty</italic> takes the intersect of the genic features found at each nonempty position, and if only one genic feature is returned, a count is assigned to that genic feature. HTSeq <italic toggle="yes">-m intersection-strict</italic> is more conservative and takes the intersect of the genic features found at all positions rather than the nonempty positions, and again, if only one genic feature is returned, a count is assigned to that genic feature. Additionally, HTSeq <italic toggle="yes">–nonunique all</italic> functions similarly to featureCounts <italic toggle="yes">-O</italic> in that a full count value is assigned to all genes overlapped by a multigene fragment. For eXpress (<xref rid="B12" ref-type="bibr">12</xref>), we assessed the performances of the <italic toggle="yes">-B 10</italic> and <italic toggle="yes">–no-bias-correct</italic> options, which increases the number of EM iterations used in deriving counts from ambiguous fragments and ignores sequence-specific biases, respectively. Finally, for Salmon, we assessed the performances of the <italic toggle="yes">–validateMapping</italic> and <italic toggle="yes">–allowDovetail</italic> options to better quantify genic features with lengths shorter than the paired-end fragment length.</p>
      <p>For these comparisons, we generated a simulated RNA-Seq data set for <named-content content-type="genus-species">Escherichia coli</named-content> K-12 substrain MG1655 using transcript annotations generated from operon predictions from OperonDB (<xref rid="B18" ref-type="bibr">18</xref>). Using each of the different quantification methods, we derived count values from the simulated RNA-Seq data set using CDS annotations, instead of the predicted operon annotations, to best assess the performance of each quantification method in the absence of operon predictions. Using Polyester (<xref rid="B19" ref-type="bibr">19</xref>), four samples were simulated, consisting of two conditions consisting of two replicates each, to simulate a basic minimum differential expression analysis. Totals of 256 and 300 transcripts were simulated to be significantly over and underexpressed, respectively, using the operon predictions from OperonDB. Of these transcripts, 184 and 116 are operonic transcripts, resulting in there being 595 and 678 significantly up- and downregulated CDSs, respectively.</p>
      <p>Using TPM values derived from each quantification method, we conducted a hierarchical clustering analysis to divide the methods into four distinct clusters (<xref rid="fig2" ref-type="fig">Fig. 2</xref>). The first cluster consists of all methods in which a transcriptome-based reference is used, including all three alignment-free quantification methods (green bar on the right of the dendrogram). The second cluster (blue bar) consists of the more conservative genome-alignment-based quantification methods, in that counts are often not derived from multigene fragments as they are instead marked as ambiguous and ignored. In contrast, the third cluster (orange bar) consists of the genome-alignment-based quantification methods that are more liberal in assigning counts from multigene fragments, in which a count value is given to all features that a multigene fragment overlaps. The fourth cluster (yellow bar) contains both methods of FADU, which use an EM approach to quantify ambiguous multimapping fragments while assigning proportional counts for multigene fragments. With FADU, excluding the assignment of multimapping fragments with the <italic toggle="yes">–remove_multimapping</italic> option yields counts most similar to those of the conservative genome-based quantification methods (cluster 2), setting FADU apart as the only genome alignment quantification method that uses an EM-based method to assign multimapping fragments.</p>
      <fig position="float" id="fig2">
        <label>FIG 2</label>
        <caption>
          <p>Performance of FADU in a simulated differential expression analysis. A 100-bootstrap dendrogram was generated using the counts obtained from 9 different RNA-Seq quantification methods on a simulated <named-content content-type="genus-species">E. coli</named-content> data set. The points at the edges of the dendrogram are colored to represent the different tools corresponding to each method. The colored bar at the edge of the dendrogram represents the different clusters of quantification tools.</p>
        </caption>
        <graphic xlink:href="mSystems.00917-20-f0002" position="anchor"/>
      </fig>
      <p>Differential expression analyses were conducted using two differential expression tools, DESeq2 (<xref rid="B20" ref-type="bibr">20</xref>) and edgeR (<xref rid="B21" ref-type="bibr">21</xref>), using the counts derived from each quantification method. Using DESeq2 and edgeR, all methods, with the exception of eXpress run with default settings, were at least able to correctly detect approximately half of the simulated differentially expressed CDSs (<xref rid="fig3" ref-type="fig">Fig. 3b</xref> and <xref rid="fig3" ref-type="fig">c</xref>). With edgeR, all methods except eXpress with default settings were able to correctly detect ∼200 more differentially expressed genes than with DESeq2, although the number of false-positive differentially expressed genes detected was also greater.</p>
      <p>Of the different methods, the cluster consisting of the genome-alignment-based quantification methods that more liberally assign counts from multigene fragments (cluster 1) was able to consistently detect the most differentially expressed genes. However, these methods also consistently have the highest false-positive rates (DESeq2, 0.41 to 0.54%; edgeR, 1.36 to 1.49%) as they incorrectly identify more nondifferentially expressed genes as differentially expressed (<xref rid="tab1" ref-type="table">Tables 1</xref> and <xref rid="tab2" ref-type="table">2</xref>). Of the conservative genome-alignment-based methods (cluster 2), FADU <italic toggle="yes">–remove_multimapping</italic> detects the most differentially expressed genes while retaining a false-positive rate similar to those of the other tools. As the tools in this cluster become more conservative in assigning multigene fragments, fewer differentially expressed genes are able to be detected, partly because more are being excluded from the default DESeq2 and edgeR minimum-expression filters (<xref rid="tab1" ref-type="table">Tables 1</xref> and <xref rid="tab2" ref-type="table">2</xref>). As an example, HTSeq <italic toggle="yes">-m intersection-strict</italic> is the most conservative quantification tool in this study for deriving counts from multigene fragments. As such, it excludes the most genes from these analyses, which include 40 incorrectly assigned differentially expressed genes. The alignment-free quantification methods perform similarly to the FADU methods that implement an EM algorithm for assigning counts from multimapping fragments. However, using DESeq2, FADU is able to detect ∼10 genes more as differentially expressed while having a slightly higher false-positive rate, while with edgeR, only FADU <italic toggle="yes">–em_iterations 10</italic> outperforms the alignment-free methods in detecting differentially expressed genes while keeping a similar false-positive rate (<xref rid="tab1" ref-type="table">Tables 1</xref> and <xref rid="tab2" ref-type="table">2</xref>). Ten EM iterations were chosen as convergence typically occurs within 10 iterations for these prokaryotic genomes and annotations (see <xref rid="figS1" ref-type="supplementary-material">Fig. S1</xref> in the supplemental material).</p>
      <table-wrap position="float" id="tab1">
        <label>TABLE 1</label>
        <caption>
          <p>DESeq2 differential expression statistics<xref rid="ngtab1.1" ref-type="table-fn"><sup><italic toggle="yes">a</italic></sup></xref></p>
        </caption>
        <alternatives>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Quantification <break/>method</th>
                <th rowspan="1" colspan="1">Cluster</th>
                <th rowspan="1" colspan="1">No. of correct DE genes</th>
                <th rowspan="1" colspan="1">No. of correct NDE genes</th>
                <th rowspan="1" colspan="1">No. of missed DE genes</th>
                <th rowspan="1" colspan="1">No. of false-positive DE genes</th>
                <th rowspan="1" colspan="1">Detection rate (%)</th>
                <th rowspan="1" colspan="1">False-positive rate (%)</th>
                <th rowspan="1" colspan="1">No. of DE genes excluded from expression threshold</th>
                <th rowspan="1" colspan="1">No. of NDE genes excluded from expression threshold</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Salmon <break/><italic toggle="yes">–validateMappings</italic>
<break/><italic toggle="yes">–allowDovetail</italic></td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">673</td>
                <td rowspan="1" colspan="1">3,156</td>
                <td rowspan="1" colspan="1">587</td>
                <td rowspan="1" colspan="1">3</td>
                <td rowspan="1" colspan="1">53.41</td>
                <td rowspan="1" colspan="1">0.09</td>
                <td rowspan="1" colspan="1">22</td>
                <td rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Salmon <break/><italic toggle="yes">–validateMappings</italic></td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">674</td>
                <td rowspan="1" colspan="1">3,156</td>
                <td rowspan="1" colspan="1">586</td>
                <td rowspan="1" colspan="1">3</td>
                <td rowspan="1" colspan="1">53.49</td>
                <td rowspan="1" colspan="1">0.09</td>
                <td rowspan="1" colspan="1">22</td>
                <td rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Kallisto</td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">673</td>
                <td rowspan="1" colspan="1">3,150</td>
                <td rowspan="1" colspan="1">587</td>
                <td rowspan="1" colspan="1">9</td>
                <td rowspan="1" colspan="1">53.41</td>
                <td rowspan="1" colspan="1">0.28</td>
                <td rowspan="1" colspan="1">58</td>
                <td rowspan="1" colspan="1">4</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">eXpress <break/><italic toggle="yes">-B10 –no-bias-correct</italic></td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">599</td>
                <td rowspan="1" colspan="1">3,152</td>
                <td rowspan="1" colspan="1">661</td>
                <td rowspan="1" colspan="1">7</td>
                <td rowspan="1" colspan="1">47.54</td>
                <td rowspan="1" colspan="1">0.22</td>
                <td rowspan="1" colspan="1">158</td>
                <td rowspan="1" colspan="1">14</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">eXpress</td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">290</td>
                <td rowspan="1" colspan="1">3,119</td>
                <td rowspan="1" colspan="1">970</td>
                <td rowspan="1" colspan="1">40</td>
                <td rowspan="1" colspan="1">23.02</td>
                <td rowspan="1" colspan="1">1.27</td>
                <td rowspan="1" colspan="1">163</td>
                <td rowspan="1" colspan="1">17</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">featureCounts</td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">694</td>
                <td rowspan="1" colspan="1">3,154</td>
                <td rowspan="1" colspan="1">566</td>
                <td rowspan="1" colspan="1">5</td>
                <td rowspan="1" colspan="1">55.08</td>
                <td rowspan="1" colspan="1">0.16</td>
                <td rowspan="1" colspan="1">97</td>
                <td rowspan="1" colspan="1">15</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">FADU <break/><italic toggle="yes">–remove-multimapped</italic></td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">703</td>
                <td rowspan="1" colspan="1">3,156</td>
                <td rowspan="1" colspan="1">557</td>
                <td rowspan="1" colspan="1">3</td>
                <td rowspan="1" colspan="1">55.79</td>
                <td rowspan="1" colspan="1">0.09</td>
                <td rowspan="1" colspan="1">92</td>
                <td rowspan="1" colspan="1">15</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">HTSeq <break/><italic toggle="yes">-m intersection-nonempty</italic></td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">656</td>
                <td rowspan="1" colspan="1">3,156</td>
                <td rowspan="1" colspan="1">604</td>
                <td rowspan="1" colspan="1">3</td>
                <td rowspan="1" colspan="1">52.06</td>
                <td rowspan="1" colspan="1">0.09</td>
                <td rowspan="1" colspan="1">156</td>
                <td rowspan="1" colspan="1">17</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">HTSeq <break/><italic toggle="yes">-m union</italic></td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">645</td>
                <td rowspan="1" colspan="1">3,158</td>
                <td rowspan="1" colspan="1">615</td>
                <td rowspan="1" colspan="1">3</td>
                <td rowspan="1" colspan="1">51.19</td>
                <td rowspan="1" colspan="1">0.09</td>
                <td rowspan="1" colspan="1">178</td>
                <td rowspan="1" colspan="1">20</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">HTSeq <break/><italic toggle="yes">-m intersection-strict</italic></td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">607</td>
                <td rowspan="1" colspan="1">3,142</td>
                <td rowspan="1" colspan="1">653</td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">48.17</td>
                <td rowspan="1" colspan="1">0.03</td>
                <td rowspan="1" colspan="1">357</td>
                <td rowspan="1" colspan="1">42</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">HTSeq <break/><italic toggle="yes">-m union –nonunique all</italic></td>
                <td rowspan="1" colspan="1">3</td>
                <td rowspan="1" colspan="1">770</td>
                <td rowspan="1" colspan="1">3,142</td>
                <td rowspan="1" colspan="1">490</td>
                <td rowspan="1" colspan="1">17</td>
                <td rowspan="1" colspan="1">61.11</td>
                <td rowspan="1" colspan="1">0.54</td>
                <td rowspan="1" colspan="1">51</td>
                <td rowspan="1" colspan="1">6</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">featureCounts <italic toggle="yes">-O</italic></td>
                <td rowspan="1" colspan="1">3</td>
                <td rowspan="1" colspan="1">776</td>
                <td rowspan="1" colspan="1">3,142</td>
                <td rowspan="1" colspan="1">484</td>
                <td rowspan="1" colspan="1">17</td>
                <td rowspan="1" colspan="1">61.59</td>
                <td rowspan="1" colspan="1">0.54</td>
                <td rowspan="1" colspan="1">55</td>
                <td rowspan="1" colspan="1">6</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">featureCounts <italic toggle="yes">-O –fraction</italic></td>
                <td rowspan="1" colspan="1">3</td>
                <td rowspan="1" colspan="1">735</td>
                <td rowspan="1" colspan="1">3,146</td>
                <td rowspan="1" colspan="1">525</td>
                <td rowspan="1" colspan="1">13</td>
                <td rowspan="1" colspan="1">58.33</td>
                <td rowspan="1" colspan="1">0.41</td>
                <td rowspan="1" colspan="1">52</td>
                <td rowspan="1" colspan="1">6</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">FADU <break/><italic toggle="yes">–em_iterations 10</italic></td>
                <td rowspan="1" colspan="1">4</td>
                <td rowspan="1" colspan="1">686</td>
                <td rowspan="1" colspan="1">3,149</td>
                <td rowspan="1" colspan="1">574</td>
                <td rowspan="1" colspan="1">10</td>
                <td rowspan="1" colspan="1">54.44</td>
                <td rowspan="1" colspan="1">0.32</td>
                <td rowspan="1" colspan="1">52</td>
                <td rowspan="1" colspan="1">10</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">FADU</td>
                <td rowspan="1" colspan="1">4</td>
                <td rowspan="1" colspan="1">684</td>
                <td rowspan="1" colspan="1">3,152</td>
                <td rowspan="1" colspan="1">576</td>
                <td rowspan="1" colspan="1">7</td>
                <td rowspan="1" colspan="1">54.29</td>
                <td rowspan="1" colspan="1">0.22</td>
                <td rowspan="1" colspan="1">53</td>
                <td rowspan="1" colspan="1">9</td>
              </tr>
            </tbody>
          </table>
          <graphic xlink:href="mSystems.00917-20-t0001" position="anchor"/>
        </alternatives>
        <table-wrap-foot>
          <fn fn-type="other" id="ngtab1.1">
            <label>a</label>
            <p>DE, differentially expressed; NDE, nondifferentially expressed.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap position="float" id="tab2">
        <label>TABLE 2</label>
        <caption>
          <p>edgeR differential expression statistics</p>
        </caption>
        <alternatives>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
              <col span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Quantification method</th>
                <th rowspan="1" colspan="1">Cluster</th>
                <th rowspan="1" colspan="1">No. of correct DE genes</th>
                <th rowspan="1" colspan="1">No. of correct NDE genes</th>
                <th rowspan="1" colspan="1">No. of missed DE genes</th>
                <th rowspan="1" colspan="1">No. of false-positive DE genes</th>
                <th rowspan="1" colspan="1">Detection rate (%)</th>
                <th rowspan="1" colspan="1">False-positive rate (%)</th>
                <th rowspan="1" colspan="1">No. of DE genes excluded from expression threshold</th>
                <th rowspan="1" colspan="1">No. of NDE genes excluded from expression threshold</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">Salmon <break/><italic toggle="yes">–validateMappings</italic>
<break/><italic toggle="yes">–allowDovetail</italic></td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">946</td>
                <td rowspan="1" colspan="1">3,115</td>
                <td rowspan="1" colspan="1">314</td>
                <td rowspan="1" colspan="1">44</td>
                <td rowspan="1" colspan="1">75.08</td>
                <td rowspan="1" colspan="1">1.39</td>
                <td rowspan="1" colspan="1">98</td>
                <td rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Salmon <break/><italic toggle="yes">–validateMappings</italic></td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">946</td>
                <td rowspan="1" colspan="1">3,115</td>
                <td rowspan="1" colspan="1">314</td>
                <td rowspan="1" colspan="1">44</td>
                <td rowspan="1" colspan="1">75.08</td>
                <td rowspan="1" colspan="1">1.39</td>
                <td rowspan="1" colspan="1">98</td>
                <td rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">Kallisto</td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">947</td>
                <td rowspan="1" colspan="1">3,116</td>
                <td rowspan="1" colspan="1">313</td>
                <td rowspan="1" colspan="1">43</td>
                <td rowspan="1" colspan="1">75.16</td>
                <td rowspan="1" colspan="1">1.36</td>
                <td rowspan="1" colspan="1">141</td>
                <td rowspan="1" colspan="1">4</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">eXpress <break/><italic toggle="yes">-B10 –no-bias-correct</italic></td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">831</td>
                <td rowspan="1" colspan="1">3,137</td>
                <td rowspan="1" colspan="1">429</td>
                <td rowspan="1" colspan="1">22</td>
                <td rowspan="1" colspan="1">65.95</td>
                <td rowspan="1" colspan="1">0.70</td>
                <td rowspan="1" colspan="1">237</td>
                <td rowspan="1" colspan="1">14</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">eXpress</td>
                <td rowspan="1" colspan="1">1</td>
                <td rowspan="1" colspan="1">53</td>
                <td rowspan="1" colspan="1">3,143</td>
                <td rowspan="1" colspan="1">1,207</td>
                <td rowspan="1" colspan="1">16</td>
                <td rowspan="1" colspan="1">4.21</td>
                <td rowspan="1" colspan="1">0.51</td>
                <td rowspan="1" colspan="1">292</td>
                <td rowspan="1" colspan="1">17</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">featureCounts</td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">936</td>
                <td rowspan="1" colspan="1">3,135</td>
                <td rowspan="1" colspan="1">324</td>
                <td rowspan="1" colspan="1">24</td>
                <td rowspan="1" colspan="1">74.29</td>
                <td rowspan="1" colspan="1">0.76</td>
                <td rowspan="1" colspan="1">169</td>
                <td rowspan="1" colspan="1">15</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">FADU <break/><italic toggle="yes">–remove-multimapped</italic></td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">974</td>
                <td rowspan="1" colspan="1">3,127</td>
                <td rowspan="1" colspan="1">286</td>
                <td rowspan="1" colspan="1">32</td>
                <td rowspan="1" colspan="1">77.30</td>
                <td rowspan="1" colspan="1">1.01</td>
                <td rowspan="1" colspan="1">153</td>
                <td rowspan="1" colspan="1">15</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">HTSeq <break/><italic toggle="yes">-m intersection-nonempty</italic></td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">903</td>
                <td rowspan="1" colspan="1">3,128</td>
                <td rowspan="1" colspan="1">357</td>
                <td rowspan="1" colspan="1">31</td>
                <td rowspan="1" colspan="1">71.67</td>
                <td rowspan="1" colspan="1">0.98</td>
                <td rowspan="1" colspan="1">267</td>
                <td rowspan="1" colspan="1">17</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">HTSeq <break/><italic toggle="yes">-m union</italic></td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">909</td>
                <td rowspan="1" colspan="1">3,119</td>
                <td rowspan="1" colspan="1">351</td>
                <td rowspan="1" colspan="1">40</td>
                <td rowspan="1" colspan="1">72.14</td>
                <td rowspan="1" colspan="1">1.27</td>
                <td rowspan="1" colspan="1">295</td>
                <td rowspan="1" colspan="1">20</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">HTSeq <break/><italic toggle="yes">-m intersection-strict</italic></td>
                <td rowspan="1" colspan="1">2</td>
                <td rowspan="1" colspan="1">802</td>
                <td rowspan="1" colspan="1">3,134</td>
                <td rowspan="1" colspan="1">458</td>
                <td rowspan="1" colspan="1">25</td>
                <td rowspan="1" colspan="1">63.65</td>
                <td rowspan="1" colspan="1">0.79</td>
                <td rowspan="1" colspan="1">499</td>
                <td rowspan="1" colspan="1">42</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">HTSeq <break/><italic toggle="yes">-m union –nonunique all</italic></td>
                <td rowspan="1" colspan="1">3</td>
                <td rowspan="1" colspan="1">1,006</td>
                <td rowspan="1" colspan="1">3,113</td>
                <td rowspan="1" colspan="1">254</td>
                <td rowspan="1" colspan="1">46</td>
                <td rowspan="1" colspan="1">79.84</td>
                <td rowspan="1" colspan="1">1.46</td>
                <td rowspan="1" colspan="1">76</td>
                <td rowspan="1" colspan="1">6</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">featureCounts <italic toggle="yes">-O</italic></td>
                <td rowspan="1" colspan="1">3</td>
                <td rowspan="1" colspan="1">1,008</td>
                <td rowspan="1" colspan="1">3,116</td>
                <td rowspan="1" colspan="1">252</td>
                <td rowspan="1" colspan="1">43</td>
                <td rowspan="1" colspan="1">80.00</td>
                <td rowspan="1" colspan="1">1.36</td>
                <td rowspan="1" colspan="1">80</td>
                <td rowspan="1" colspan="1">6</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">featureCounts <break/><italic toggle="yes">-O –fraction</italic></td>
                <td rowspan="1" colspan="1">3</td>
                <td rowspan="1" colspan="1">1,000</td>
                <td rowspan="1" colspan="1">3,112</td>
                <td rowspan="1" colspan="1">260</td>
                <td rowspan="1" colspan="1">47</td>
                <td rowspan="1" colspan="1">79.37</td>
                <td rowspan="1" colspan="1">1.49</td>
                <td rowspan="1" colspan="1">109</td>
                <td rowspan="1" colspan="1">6</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">FADU <break/><italic toggle="yes">–em_iterations 10</italic></td>
                <td rowspan="1" colspan="1">4</td>
                <td rowspan="1" colspan="1">955</td>
                <td rowspan="1" colspan="1">3,122</td>
                <td rowspan="1" colspan="1">305</td>
                <td rowspan="1" colspan="1">37</td>
                <td rowspan="1" colspan="1">75.79</td>
                <td rowspan="1" colspan="1">1.17</td>
                <td rowspan="1" colspan="1">112</td>
                <td rowspan="1" colspan="1">10</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">FADU</td>
                <td rowspan="1" colspan="1">4</td>
                <td rowspan="1" colspan="1">947</td>
                <td rowspan="1" colspan="1">3,125</td>
                <td rowspan="1" colspan="1">313</td>
                <td rowspan="1" colspan="1">34</td>
                <td rowspan="1" colspan="1">75.16</td>
                <td rowspan="1" colspan="1">1.08</td>
                <td rowspan="1" colspan="1">111</td>
                <td rowspan="1" colspan="1">9</td>
              </tr>
            </tbody>
          </table>
          <graphic xlink:href="mSystems.00917-20-t0002" position="anchor"/>
        </alternatives>
      </table-wrap>
      <supplementary-material position="float" id="figS1" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00917-20.1</object-id>
        <label>FIG S1</label>
        <p>EM convergence on iteration. The convergence of the EM algorithm was measured by taking the absolute value of the difference between the current iteration and the previous iteration for each gene, where the index iteration was 0 and the final iteration was 100. The sum across all genes was plotted for the current iteration for sample 1 of the simulated data (A), <italic toggle="yes">E. chaffeensis</italic> (SRA accession number <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/sra/SRR1188323" ext-link-type="uri" assigning-authority="ncbi:sra">SRR1188323</ext-link>) (B), <named-content content-type="genus-species">E. coli</named-content> (SRA accession number <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/sra/SRR2601722" ext-link-type="uri" assigning-authority="ncbi:sra">SRR2601722</ext-link>) (C), and <italic toggle="yes">Wolbachia</italic> endosymbiont <italic toggle="yes">w</italic>Bm (SRA accession number <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/sra/SRR5192555" ext-link-type="uri" assigning-authority="ncbi:sra">SRR5192555</ext-link>) (D). Download <inline-supplementary-material id="fS1" xlink:href="mSystems.00917-20_sf001.pdf" content-type="local-data">FIG S1, PDF file, 0.08 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2021 Chung et al.</copyright-statement>
          <copyright-year>2021</copyright-year>
          <copyright-holder>Chung et al.</copyright-holder>
          <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <p>For each quantification method, we calculated a log<sub>2</sub> ratio of the quantification-method-derived counts to the simulated counts to assess the accuracy and precision of the counts derived from each of the quantification methods. The ideal quantification method would have a distribution with a log<sub>2</sub> ratio value centered at around zero, indicating that most counts derived for each genic feature are similar to the simulated values, and a low interquartile value, indicating high precision in the quantification-method-derived counts (<xref rid="fig3" ref-type="fig">Fig. 3A</xref> to <xref rid="fig3" ref-type="fig">C</xref>). The transcriptome-based quantification tools of the first cluster all have distributions that are slightly left-skewed, indicating that most features are being undercounted. While this difference is very slight for the kallisto- and Salmon-based methods, the high interquartile range for both eXpress methods indicates low precision in quantifying features in this simulated prokaryotic RNA-Seq data set. In the second cluster, all three HTSeq methods run with the three different modes are similarly left-skewed, again indicative of many features being undercounted, due to fewer count values being derived from multigene fragments. The default featureCounts method and FADU <italic toggle="yes">–remove_multimapped</italic> are the most accurate and precise of the conservative genome-based quantification methods in that they both have low interquartile ranges and their ratio distributions are centered around zero. The increased precision of featureCounts relative to HTSeq lies in how each method quantifies multigene fragments. By default, featureCounts will assign a multigene fragment to the feature that maps to the feature overlapping the majority of the individual reads in a paired-end fragment (<xref rid="B1" ref-type="bibr">1</xref>), while HTSeq derives no counts from all multigene fragments and instead marks them all as ambiguous (<xref rid="B2" ref-type="bibr">2</xref>).</p>
      <fig position="float" id="fig3">
        <label>FIG 3</label>
        <caption>
          <p>Accuracy of FADU in a simulated RNA-Seq data set. (A) For each quantification method, a log<sub>2</sub> ratio was calculated for the counts obtained for each gene in the simulated data set versus the actual counts expected from the simulated data set. The distributions for each of these methods would ideally be normal and centered at zero. (B) Zoomed-in version of the distribution generated from the log<sub>2</sub> ratios. (C) The interquartile ranges for each of the distributions show the precision of each method.</p>
        </caption>
        <graphic xlink:href="mSystems.00917-20-f0003" position="anchor"/>
      </fig>
      <p>The methods in the third cluster, consisting of the genome-alignment-based quantification methods that liberally derive counts from multigene fragments, all have right-skewed distributions, indicating that most features are being overcounted (<xref rid="fig3" ref-type="fig">Fig. 3A</xref> to <xref rid="fig3" ref-type="fig">C</xref>). For a multigene read mapping in an operonic structure, the ideal quantification method should assign an equal count value to all overlapped genic features. While this may result in an inflation of read counts relative to the number of reads mapped, the expression values would be more accurately quantified. However, because of the dense nature of prokaryotic genomes, it becomes difficult to determine whether a multigene fragment is representative of an operonic transcript or overlaps multiple genes due to the high coding density of prokaryotic genomes. The right-skewed nature of all three quantification methods in this cluster is a consequence of overinflating counts due to an overabundance of overlapping or close-proximity nonoperonic genes in the <named-content content-type="genus-species">E. coli</named-content> genome. The fourth cluster consists of both FADU methods that assign counts from multimapping fragments using an EM algorithm. Of all the analyzed methods, both FADU methods run with EM iterations have the lowest interquartile range and a distribution centered at zero, indicating that they most accurately quantify coding sequences in the absence of operon annotations for this simulated data set.</p>
    </sec>
    <sec id="s2.3">
      <title>Comparing the performance of FADU against those of other quantification tools.</title>
      <p>To assess the performance of each of the quantification methods when faced with variation arising from real data, we compared the performances of the same quantification methods on three different transcriptomics data sets consisting of (i) paired-end reads from a standard (i.e., not-strand-specific) library constructed from <named-content content-type="genus-species">Escherichia coli</named-content> RNA, (ii) paired-end reads from a standard library constructed from <named-content content-type="genus-species">Ehrlichia chaffeensis</named-content> RNA, and (iii) paired-end reads from a strand-specific library constructed from RNA isolated from the <italic toggle="yes">Wolbachia</italic> endosymbiont strain <italic toggle="yes">w</italic>Bm from <named-content content-type="genus-species">Brugia malayi</named-content>. For the alignment-based quantification tools, reads were mapped to a genomic reference for FADU, featureCounts, and HTSeq or a coding sequence reference for eXpress. For the alignment-free quantification tools kallisto and Salmon, reads were directly quantified using a coding sequence reference. Across all three data sets, the counts obtained using FADU are correlated with those obtained with the five other quantification tools (<xref rid="figS2" ref-type="supplementary-material">Fig. S2</xref>).</p>
      <supplementary-material position="float" id="figS2" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00917-20.2</object-id>
        <label>FIG S2</label>
        <p>Comparing fragment counts from FADU versus other quantification tools. Across the three prokaryotic transcriptomic data sets of unstranded <named-content content-type="genus-species">E. coli</named-content> (a) and <italic toggle="yes">E. chaffeensis</italic> (b) and stranded <italic toggle="yes">w</italic>Bm (c), a density plot was generated by plotting the fragment counts obtained using the default settings of FADU against the counts obtained using 12 other quantification methods. Download <inline-supplementary-material id="fS2" xlink:href="mSystems.00917-20_sf002.pdf" content-type="local-data">FIG S2, PDF file, 0.8 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2021 Chung et al.</copyright-statement>
          <copyright-year>2021</copyright-year>
          <copyright-holder>Chung et al.</copyright-holder>
          <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
      <p>For pairwise comparisons between FADU and two representative quantification methods from each of the hierarchical clusters in <xref rid="fig2" ref-type="fig">Fig. 2</xref>, MA plots were constructed (<xref rid="fig4" ref-type="fig">Fig. 4</xref>) by calculating the mean average of the log<sub>2</sub> counts (A) and the log<sub>2</sub> ratio counts (M) for each gene. Genes with a log<sub>2</sub> count ratio of ≥2 or ≤2 were defined as being significantly differentially counted between FADU and the compared quantification method. There are 135 unique CDSs in the <italic toggle="yes">w</italic>Bm data set across the five pairwise comparisons that had higher counts by FADU (<xref rid="fig4" ref-type="fig">Fig. 4</xref>). Of the analyzed methods, eXpress -<italic toggle="yes">B10 –no-bias-correct</italic> contains most of these genes, with 122 CDSs (90.3%) having higher counts with FADU. Additionally, Salmon <italic toggle="yes">–validateMappings –allowDovetail</italic>, featureCounts, and HTSeq <italic toggle="yes">-m union</italic> have 68, 67, and 29 CDSs that have higher counts with FADU. In comparison, HTSeq <italic toggle="yes">-m union –nonunique all</italic> and featureCounts <italic toggle="yes">-O –fraction</italic> have at most 2 genes with higher counts using FADU.</p>
      <fig position="float" id="fig4">
        <label>FIG 4</label>
        <caption>
          <p>MA plots comparing <italic toggle="yes">w</italic>Bm fragment counts obtained using FADU against those obtained using other quantification tools. The fragment counts for the stranded <italic toggle="yes">w</italic>Bm data set obtained using FADU were compared to the counts obtained using methods representative of the different clusters of quantification methods. The <italic toggle="yes">x</italic> axis denotes the mean average from the two compared counts (A), while the <italic toggle="yes">y</italic> axis denotes the log<sub>2</sub> ratio of the two compared counts (M) as a scatterplot (left) and a density plot (right). The horizontal orange dotted lines on each plot are drawn at log<sub>2</sub> ratio values of 2 and −2. Points with a log<sub>2</sub> ratio greater than 2 and less than −2 were defined as genes counted differently by FADU relative to its counterpart tool.</p>
        </caption>
        <graphic xlink:href="mSystems.00917-20-f0004" position="anchor"/>
      </fig>
      <p>A total of 36 unique CDSs were identified as having lower counts using FADU than using one of the six analyzed quantification methods. (<xref rid="fig4" ref-type="fig">Fig. 4</xref>). Of the analyzed quantification methods, FADU has the fewest counted genes compared to HTSeq <italic toggle="yes">-m union –nonunique all</italic> and featureCounts <italic toggle="yes">–O –fraction</italic>. As both of these tools derive counts from multigene fragments, FADU produces fewer counts for 28 (77.8%) and 13 (36.1%) CDSs than HTSeq <italic toggle="yes">-m union –nonunique all</italic> and featureCounts <italic toggle="yes">–O –fraction</italic>, respectively. FADU compared to all other methods has fewer counts for &lt;10 CDSs.</p>
      <p>The MA analysis highlights differences in how ambiguous multigene fragments are quantified. High counts with FADU are often found relative to quantification methods that conservatively quantify genes in multigene fragments, while low counts by FADU are often relative to the genome-based quantification methods that derive counts from genes with ambiguous multigene fragments. In total, we observed 24 CDSs with higher counts by FADU than by eXpress <italic toggle="yes">–B10 –no-bias-correct</italic>, Salmon <italic toggle="yes">–validateMappings –allowDovetail</italic>, featureCounts, and HTSeq <italic toggle="yes">-m union</italic>. Of the 24 genes, 3 are within a putative 11-gene operon: Wbm7023, Wbm7024, and Wbm7025 (<xref rid="fig5" ref-type="fig">Fig. 5A</xref>). Within this 11-gene region, based on the depth track, empirically, all genes should have roughly the same count values. Within this operon, we divided the fragment counts for each gene by their respective gene lengths to obtain a fragment count per base pair value for each gene. For each quantification method individually, these fragment count per base pair values were normalized by dividing by the median fragment counts per base pair for all genes in this 11-gene operonic region (<xref rid="fig5" ref-type="fig">Fig. 5B</xref>). Normalized values that are higher than 3 or lower than −3 indicate that the gene is significantly over- or undercounted relative to the rest of the operon.</p>
      <fig position="float" id="fig5">
        <label>FIG 5</label>
        <caption>
          <p>Performance of quantification tools for deriving counts for operons. (A) Using the <italic toggle="yes">w</italic>Bm stranded RNA-Seq data set, the log<sub>2</sub> read depth (orange) was plotted for part of an operon containing 11 genes. Genes labeled and marked in blue are all significantly undercounted (log<sub>2</sub> count ratio of less than −1), as assessed in <xref rid="fig4" ref-type="fig">Fig. 4</xref>. (B) For each quantification tool, the read depth per base pair was calculated for all 11 genes displayed and divided by the median read depth per base pair across the operon for each quantification mode to obtain a normalized relative count value. The log<sub>2</sub>-transformed normalized relative count values are displayed in the individual cells of the table. -Inf is used to denote when the quantification tool returned “0” for the gene such that the ratio cannot be log transformed. Because the 11 genes are transcribed together, we would expect the normalized values obtained for each of the 11 genes to be ∼0. Normalized values in red cells indicate that the gene has a higher count value than the other operonic genes, while blue cells indicate that the gene has a lower count value than the other operonic genes. Tools that discard ambiguous reads spanning two features in close proximity have a tendency to undercount the smaller genes in operons, such as Wbm7023, Wbm7024, and Wbm7025.</p>
        </caption>
        <graphic xlink:href="mSystems.00917-20-f0005" position="anchor"/>
      </fig>
      <p>For Wbm7023, Wbm7024, and Wbm7025, despite all three genes having a fragment depth that appears to be similar to that of the rest of the putative operon (<xref rid="fig5" ref-type="fig">Fig. 5A</xref>), only the FADU-based methods and HTSeq <italic toggle="yes">-m union –nonunique all</italic>, featureCounts <italic toggle="yes">-O</italic>, and featureCounts <italic toggle="yes">-O –fraction</italic> properly assign counts to all three. The difficulty in assigning counts to the three genes stems from their close proximity to adjacent genes combined with their individual small sizes. Similarly, the smaller size of WBM_RS03925 leads to undercounting with eXpress, kallisto, and Salmon. In the case of transcriptome-based aligners, the small sizes of the three genes make it difficult for eXpress to identify reads that mostly map to each of the genes. Similarly, the smaller size makes it difficult for kallisto and Salmon to identify unique k-mers for these genes, leading to both genes being undercounted by the k-mer-based tools (<xref rid="fig5" ref-type="fig">Fig. 5B</xref>).</p>
      <p>By deriving counts from ambiguous multigene fragments, FADU, HTSeq <italic toggle="yes">-m union –nonunique all</italic>, featureCounts <italic toggle="yes">-O</italic>, and featureCounts <italic toggle="yes">-O –fraction</italic> all run the risk of incorrectly assigning counts in instances where fragments originate from monocistronic transcripts that are in close proximity, particularly in the case of gene-dense genomes rather than operons. Because each of these tools assigns fragment counts to all overlapped features, the counts from a fragment that originates from one gene can be mistakenly assigned to another gene overlapped by the fragment. While this is erroneous in the case of monocistronic transcripts, scenarios such as this are difficult to avoid without well-annotated transcripts and without undercounting smaller operonic genes. However, the proportional fragment counts assigned by FADU minimize the errors from such instances. As an example, the <italic toggle="yes">w</italic>Bm gene Wbm7021 is in close proximity to Wbm0608 (<xref rid="fig6" ref-type="fig">Fig. 6A</xref>), separated by 44 bp, such that reads from the unannotated 3′ UTR of Wbm0608 are erroneously being counted for Wbm7021. FADU mitigates this issue by only assigning proportional fragment counts based on the percentage of the fragment’s length that overlaps a feature. While most quantification methods obtain almost no reads for Wbm7021, HTSeq <italic toggle="yes">-m union –nonunique all</italic>, featureCounts <italic toggle="yes">-O</italic>, and featureCounts <italic toggle="yes">-O –fraction</italic> obtain 137, 139, and 70 read counts for Wbm7021, respectively (<xref rid="fig6" ref-type="fig">Fig. 6B</xref>). In comparison, all methods of FADU limit this error and obtain only 1 read count for Wbm7021. Collectively, by assigning proportional counts, FADU is better able to quantify operonic genes while mitigating the issues stemming from quantifying multigene fragments.</p>
      <fig position="float" id="fig6">
        <label>FIG 6</label>
        <caption>
          <p>Improper quantification of fragments that span multiple features. (A) Using the <italic toggle="yes">w</italic>Bm stranded RNA-Seq data set, the log<sub>2</sub> read depth (orange) was plotted across the <italic toggle="yes">w</italic>Bm gene Wbm7023 and its adjacent genes Wbm0608 and Wbm0609. (B) The counts for the three genes as determined by each of the quantification methods were calculated. The counts assigned to Wbm7023 are all derived from fragments that also map to the 3′ end of Wbm0608. Despite the <italic toggle="yes">w</italic>Bm annotation lacking UTRs, these reads likely originate from the 3′ UTR of Wbm0608, indicating that most if not all the reads assigned to Wbm7023 are erroneous.</p>
        </caption>
        <graphic xlink:href="mSystems.00917-20-f0006" position="anchor"/>
      </fig>
    </sec>
    <sec id="s2.4">
      <title>Timing and memory benchmarks.</title>
      <p>We compared the speed (<xref rid="fig7" ref-type="fig">Fig. 7A</xref>; <xref rid="figS3" ref-type="supplementary-material">Fig. S3</xref>) and memory usage (<xref rid="fig7" ref-type="fig">Fig. 7C</xref>) of FADU to those of the 10 other quantification modes for <italic toggle="yes">E. chaffeensis</italic>, <named-content content-type="genus-species">E. coli</named-content>, and <italic toggle="yes">w</italic>Bm data sets run with 1 and 4 threads. For the alignment-based quantification tools eXpress, FADU, featureCounts, and HTSeq, the times for alignment and quantification were individually recorded, while for the alignment-free quantification tools kallisto and Salmon, the times for indexing and quantification were individually recorded. Across all three data sets analyzed, the alignment-free quantification tools kallisto and Salmon perform the fastest and use the least memory, as would have been expected from the methodology. The speed of FADU is either higher than or comparable to those of the other alignment-based quantification tools for the <italic toggle="yes">E. chaffeensis</italic> and <italic toggle="yes">w</italic>Bm data sets (<xref rid="fig7" ref-type="fig">Fig. 7A</xref>). However, when used to analyze the <named-content content-type="genus-species">E. coli</named-content> data set, FADU and HTSeq have longer run times than eXpress and featureCounts. When comparing the maximum memory usage between the different tools, FADU has memory requirements comparable to those of the other alignment-based quantification tools (<xref rid="fig7" ref-type="fig">Fig. 7B</xref>).</p>
      <fig position="float" id="fig7">
        <label>FIG 7</label>
        <caption>
          <p>FADU timing and memory benchmarking. For the unstranded <named-content content-type="genus-species">E. coli</named-content> and <italic toggle="yes">E. chaffeensis</italic> and the stranded <italic toggle="yes">w</italic>Bm data sets, the wall clock speed for the indexing and/or alignment steps and quantification steps using 4 threads (A) along with the maximum memory (max Vmem) used (green) (B) were recorded for all quantification methods analyzed.</p>
        </caption>
        <graphic xlink:href="mSystems.00917-20-f0007" position="anchor"/>
      </fig>
      <supplementary-material position="float" id="figS3" content-type="local-data">
        <object-id pub-id-type="doi">10.1128/mSystems.00917-20.3</object-id>
        <label>FIG S3</label>
        <p>FADU timing and memory benchmarking. For the unstranded <named-content content-type="genus-species">E. coli</named-content> and <italic toggle="yes">E. chaffeensis</italic> and the stranded <italic toggle="yes">w</italic>Bm data sets, the wall clock speed for the indexing and/or alignment steps (red) and quantification steps (blue) using 1 thread was recorded for all quantification methods analyzed. Download <inline-supplementary-material id="fS3" xlink:href="mSystems.00917-20_sf003.pdf" content-type="local-data">FIG S3, PDF file, 0.8 MB</inline-supplementary-material>.</p>
        <permissions>
          <copyright-statement>Copyright © 2021 Chung et al.</copyright-statement>
          <copyright-year>2021</copyright-year>
          <copyright-holder>Chung et al.</copyright-holder>
          <license license-type="open-access" xlink:href="https://creativecommons.org/licenses/by/4.0/">
            <license-p>This content is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International license</ext-link>.</license-p>
          </license>
        </permissions>
      </supplementary-material>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s3">
    <title>DISCUSSION</title>
    <p>In an ideal transcriptomics differential expression analysis, full-length transcript annotation of the reference organism should be used for the alignment and/or quantification steps. In cases where full-length transcripts are available, we believe that ambiguous multigene fragments should be able to be assigned with confidence using abundance estimation strategies such as the EM algorithm (<xref rid="B17" ref-type="bibr">17</xref>). However, in cases where full-length transcripts are not available, CDSs are typically used instead. When CDSs are used, considerations need to be made regarding the shortcomings of quantifying ambiguous multigene fragments, especially in the context of prokaryotic systems, in which operonic structures and dense coding regions could be present.</p>
    <p>Without knowledge of complete transcript sequences, it becomes impossible to determine whether an ambiguous multigene fragment stems from an operonic transcript or overlaps two genes in close proximity that are independent transcriptional units. While operon databases and prediction software are available, they are not comprehensive, and the gold standard for determining the sequences of full-length transcripts is still through laboratory-based studies such as 5′ and 3′ RACE. While advances in long-read sequencing will eventually lead to native-strand RNA sequencing (<xref rid="B22" ref-type="bibr">22</xref>), in which the sequences of full-length transcripts can be obtained easily, current technologies are lacking a robust method to easily annotate full-length nonpolyadenylated transcripts and, as a result, operons.</p>
    <p>In situations where full-length transcript sequences are unavailable, mapping directly to transcript references will fail to quantify a subset of reads that originate primarily from untranslated regions instead of the coding sequence. For cases such as this, genome references perform better for deriving counts from noncoding sequence reads. By using the precise mapping information provided by a genome-based alignment, quantification tools can better infer whether a fragment overlaps a target gene. However, as we have shown, ambiguous reads are often either too conservatively or too liberally assigned, resulting in an under- or overestimation of transcript expression, respectively. FADU was designed for the purpose of optimizing the available alignment information for systems in which full-length transcript annotations are unavailable and CDS-based counting is confounded by operons and/or a high coding density, both of which are significant issues in prokaryote genomes. However, FADU is not splice aware and is thus not suitable for eukaryotic genomes with spliced genes. But by assigning proportional read counts, FADU maximizes the quantification of operonic genes while minimizing the false overquantification of nonoperonic genes in close proximity to one another.</p>
  </sec>
  <sec sec-type="materials|methods" id="s4">
    <title>MATERIALS AND METHODS</title>
    <sec id="s4.1">
      <title>Implementation.</title>
      <p>FADU was written entirely using the Julia programming language v1.0 (<xref rid="B23" ref-type="bibr">23</xref>) and uses the BioAlignments.jl and GenomicFeatures.jl packages. GenomicFeatures.jl is used to parse out record information from GFF files and determine overlaps between alignments and features. BioAlignments.jl is used to quickly parse record information from the BAM file. FADU was tested and benchmarked in the UNIX environment.</p>
      <p>FADU first creates an interval tree-based data structure of the feature annotation (GFF3) input file consisting of the sequence identification (ID), the leftmost coordinate, the rightmost coordinate, the strand, and the feature metadata. This data structure is used to construct a set of all nonoverlapping coordinates per strand, defined as a genomic position that is not overlapped by two or more recorded features. If the BAM alignment input file is unstranded, the set of overlapping coordinates per attribute ID will be strand agnostic.</p>
      <p>The BAM file is read in one alignment record at a time. For each record, validation steps are performed to ensure that the record is mapped, is a primary record, and exceeds the specified minimum mapping quality (default score of 10). If the option <italic toggle="yes">–remove_multimapping</italic> alignments is enabled, records whose “NH” attribute exceeds a value of 1 are also removed. Next, the record is assessed as to whether or not it is part of a fragment by taking into account read pair information. In order to classify a read as part of a fragment, both the template length of the read pair (default, &lt;1,000 bp) and the 0-by-2 bitflag of each record are assessed. Records that do not meet the qualifications to be processed as “fragments” are instead processed as “reads.” For records classified as fragments, only one of the reads of the pair is kept because the coordinate information of the mate pair can be inferred. If the option to keep only properly paired reads is enabled, only records that can be classified as fragments will be kept.</p>
      <p>After validation, each record is classified as either a fragment or a read for downstream processing. Each record is used to create an interval tree-based data structure consisting of the record reference sequence name, the leftmost and rightmost coordinates of the fragment or read, the strand of the fragment or read, and a designation of fragment or read. Once a sufficient number of these data structures is read into memory (the default chunk size is 10,000,000), the overlaps for each alignment record to the specified annotation feature type are processed. If the option <italic toggle="yes">–remove_multimapping</italic> alignments is disabled, alignment records that are multimapped are saved to be processed after all the uniquely mapped records are processed. The overlaps for the multimapped reads are then processed, but the counts overlapping each feature are adjusted via the EM algorithm (<xref rid="B17" ref-type="bibr">17</xref>). For each iteration of the EM algorithm, the contribution of a multimapped record’s overlap to a given annotation feature’s count total is adjusted by the relative abundance of each overlapping feature’s total counts for uniquely mapped records only.</p>
      <p>Once all records have been processed, total counts for every feature ID for the specified attribute type are calculated and used to calculate normalized TPM values for each feature ID. For each feature ID, five tab-delimited fields are written to file: (i) feature ID, (ii) length of nonoverlapping coordinates, (iii) number of alignments to overlap the feature, (iv) total fractionalized alignment counts for the feature, and (v) TPM count for the feature.</p>
    </sec>
    <sec id="s4.2">
      <title>Update equations.</title>
      <p>For each paired-end fragment, FADU functions by assigning proportional counts based on the length of the different features that the fragment overlaps (<xref rid="fig1" ref-type="fig">Fig. 1C</xref>), where <italic toggle="yes">F<sub>c</sub></italic> represents the proportional fragment count contribution for a given fragment or read for each genic feature, <italic toggle="yes">F<sub>O</sub></italic> represents the number of bases that the fragment overlaps the unique positions of the genic feature, <italic toggle="yes">F<sub>L</sub></italic> represents the total length of the fragment, and
<disp-formula id="uFD1"><alternatives><graphic xlink:href="mSystems.00917-20-m0001.jpg" position="float"/><mml:math id="um1" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>O</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>For <italic toggle="yes">f</italic> (feature [e.g., a gene]), <italic toggle="yes">F</italic> (all features), <italic toggle="yes">N<sub>f</sub></italic> (total counts for feature <italic toggle="yes">f</italic>), <italic toggle="yes">N<sub>F</sub></italic> (total counts for all features present), and <italic toggle="yes">a<sub>f</sub></italic> (estimated relative abundance for feature <italic toggle="yes">f</italic> among all features <italic toggle="yes">F</italic>), then
<disp-formula id="uFD2"><alternatives><graphic xlink:href="mSystems.00917-20-m0002.jpg" position="float"/><mml:math id="um2" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo><mml:mrow><mml:msub><mml:mi>F</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="uFD3"><alternatives><graphic xlink:href="mSystems.00917-20-m0003.jpg" position="float"/><mml:math id="um3" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>F</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>For <italic toggle="yes">r</italic> (each record for a fragment [e.g., a pair of reads]), <italic toggle="yes">R</italic> (all alignment records), <italic toggle="yes">r</italic>,<italic toggle="yes">f</italic> (a single feature mapping to record <italic toggle="yes">r</italic>), <italic toggle="yes">r</italic>,<italic toggle="yes">F</italic> (all features mapping to record <italic toggle="yes">r</italic>), <italic toggle="yes">N<sub>r</sub></italic><sub>,</sub><italic toggle="yes"><sub>f</sub></italic> (count for record <italic toggle="yes">r</italic> aligning to feature <italic toggle="yes">f</italic>), <italic toggle="yes">N<sub>r</sub></italic><sub>,</sub><italic toggle="yes"><sub>F</sub></italic> (total counts for all features that align to record <italic toggle="yes">r</italic> [including counts where the record aligns to other features]), and <italic toggle="yes">a<sub>r</sub></italic><sub>,</sub><italic toggle="yes"><sub>f</sub></italic> (relative abundance for feature <italic toggle="yes">f</italic> that mapped to record <italic toggle="yes">r</italic>), then
<disp-formula id="uFD4"><alternatives><graphic xlink:href="mSystems.00917-20-m0004.jpg" position="float"/><mml:math id="um4" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>F</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula>
<disp-formula id="uFD5"><alternatives><graphic xlink:href="mSystems.00917-20-m0005.jpg" position="float"/><mml:math id="um5" display="block" overflow="scroll"><mml:mrow><mml:munderover><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>f</mml:mi><mml:mo>∈</mml:mo><mml:mi>F</mml:mi></mml:mrow><mml:mo> </mml:mo></mml:munderover><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo> </mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>For the EM algorithm, only multimapping records are considered. For <italic toggle="yes">Rmm</italic> (all multimapping alignment records) and <inline-formula id="ui1"><alternatives><inline-graphic xlink:href="mSystems.00917-20-m0007.jpg"/><mml:math id="u1" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">Rmm</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> (total counts for feature <italic toggle="yes">f</italic> from all multimapping records in <italic toggle="yes">Rmm</italic>), then
<disp-formula id="uFD6"><alternatives><graphic xlink:href="mSystems.00917-20-m0006.jpg" position="float"/><mml:math id="um6" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">Rmm</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mstyle displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="italic">Rmm</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>For <italic toggle="yes">k</italic> (EM iteration cycle number), <italic toggle="yes">K</italic> (maximum number of cycles), <italic toggle="yes">N<sub>f</sub></italic><sub>,0</sub> (counts for a given feature not including multimapped records), <inline-formula id="ui2"><alternatives><inline-graphic xlink:href="mSystems.00917-20-m0008.jpg"/><mml:math id="u2" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo> </mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> (adjustment counts for feature <italic toggle="yes">f</italic> based on all multimapped records <italic toggle="yes">R</italic> in EM iteration cycle <italic toggle="yes">k</italic>), and <italic toggle="yes">N<sub>f</sub></italic><sub>,</sub><italic toggle="yes"><sub>k</sub></italic> (updated counts for a feature for EM iteration cycle number <italic toggle="yes">k</italic>), then
<disp-formula id="uFD7"><alternatives><graphic xlink:href="mSystems.00917-20-m0007.jpg" position="float"/><mml:math id="um7" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">Rmm</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mtext> for </mml:mtext><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mtext>1, 2, </mml:mtext><mml:mo>…</mml:mo><mml:mo> </mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:math></alternatives></disp-formula></p>
      <p>All values are recalculated using <italic toggle="yes">N<sub>f</sub></italic><sub>,</sub><italic toggle="yes"><sub>k</sub></italic> to update abundance values for each cycle.</p>
    </sec>
    <sec id="s4.3">
      <title>Quantification method analyses of the simulated data set.</title>
      <p>The strand-specific simulated RNA-Seq data set for <named-content content-type="genus-species">Escherichia coli</named-content> K-12 substrain MG1655 (GenBank accession number <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/nuccore/U00096.3" ext-link-type="uri" assigning-authority="genbank">U00096.3</ext-link>) was generated using Polyester v1.9.7 (<xref rid="B19" ref-type="bibr">19</xref>), using an annotation generated from operon predictions from OperonDB (<xref rid="B18" ref-type="bibr">18</xref>). Four samples were simulated, consisting of two conditions consisting of two replicates each, for conducting differential expression analysis. Totals of 256 and 300 transcripts were simulated to be significantly over- and underexpressed using the operon predictions from OperonDB. For the subsequent quantification steps, genes from the simulated data set were quantified using the original CDS annotations. Simulated reads were aligned using HISAT2 v2.1.0 with the options <italic toggle="yes">–X 1000 –no-spliced alignment -k 200</italic> to either the target genome or transcriptome. Genes were quantified using FADU v1.7 run with default settings and the <italic toggle="yes">–remove_mulitmapping</italic> and <italic toggle="yes">–em_iterations 10</italic> options; eXpress v1.5.1 (<xref rid="B12" ref-type="bibr">12</xref>) run with default settings and the <italic toggle="yes">-B10</italic> and <italic toggle="yes">–no-bias-correct</italic> options; featureCounts (<xref rid="B1" ref-type="bibr">1</xref>) v1.6.4 run with default settings and the <italic toggle="yes">–fraction</italic> and <italic toggle="yes">-O</italic> options; HTSeq v0.11.0 (<xref rid="B2" ref-type="bibr">2</xref>) run with each of the <italic toggle="yes">-m union</italic>, <italic toggle="yes">-m intersection-nonempty</italic>, and -m <italic toggle="yes">intersection-strict</italic> options and <italic toggle="yes">–nonunique all</italic> options; kallisto v0.46.1 (<xref rid="B13" ref-type="bibr">13</xref>) run with default settings; and Salmon v1.1.0 (<xref rid="B14" ref-type="bibr">14</xref>) run with default settings and the <italic toggle="yes">–allowDovetail</italic> and <italic toggle="yes">–validateMappings</italic> options. Hierarchical clustering analyses were conducted using pvclust v2.0-0 using a correlation distance parameter and average cluster method. Differential expression analyses were conducted using DESeq2 (<xref rid="B20" ref-type="bibr">20</xref>) and edgeR (<xref rid="B21" ref-type="bibr">21</xref>), using their respective recommended minimum expression filters of a total of 10 read counts across all samples and a cutoff of 5 counts per million (CPM) in the sample in the data set with the fewest reads sequenced. For DESeq2, differentially expressed genes were identified with <italic toggle="yes">cooksCutoff=T</italic> and a false discovery rate (FDR) of &lt;0.05, while for edgeR, differentially expressed genes were identified using glmQLFit and an FDR of &lt;0.05.</p>
    </sec>
    <sec id="s4.4">
      <title>Quantification tool comparisons on actual data sets.</title>
      <p><italic toggle="yes">E. chaffeensis</italic> Arkansas (GenBank accession number <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/nuccore/NC_007799.1" ext-link-type="uri" assigning-authority="genbank">NC_007799.1</ext-link>), <named-content content-type="genus-species">E. coli</named-content> O127:H6 strain E2348/69 (GenBank accession number <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/nuccore/NC_011601.1" ext-link-type="uri" assigning-authority="genbank">NC_011601.1</ext-link>), and <italic toggle="yes">w</italic>Bm (GenBank accession number <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/nuccore/NC_006833.1" ext-link-type="uri" assigning-authority="genbank">NC_006833.1</ext-link>) data sets were downloaded from the SRA, using SRAtoolkit v2.9.0, under SRA accession numbers <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/sra/SRX485438" ext-link-type="uri" assigning-authority="ncbi:sra">SRX485438</ext-link>, <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/sra/SRX1322474" ext-link-type="uri" assigning-authority="ncbi:sra">SRX1322474</ext-link>, and <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/sra/SRX2508248" ext-link-type="uri" assigning-authority="ncbi:sra">SRX2508248</ext-link>, respectively. The paired-end data sets were each aligned to the genomes or transcriptomes of their respective organisms using HISAT2 v2.1.0 with the options <italic toggle="yes">–X 1000 –no-spliced alignment -k 200</italic>. In the case of <italic toggle="yes">w</italic>Bm, reads were aligned to a combined reference consisting of the <italic toggle="yes">w</italic>Bm genome/transcriptome along with the <named-content content-type="genus-species">Brugia malayi</named-content> (WormBase version WBPS9) genome/transcriptome to minimize erroneous mappings from <italic toggle="yes">Wolbachia-Brugia</italic> lateral gene transfer reads (<xref rid="B24" ref-type="bibr">24</xref>, <xref rid="B25" ref-type="bibr">25</xref>). Genes were quantified for each data set using FADU v1.7 run with default settings and the <italic toggle="yes">–remove_mulitmapping</italic> and <italic toggle="yes">–em_iterations 10</italic> options; eXpress v1.5.1 (<xref rid="B12" ref-type="bibr">12</xref>) run with default settings and the <italic toggle="yes">-B10</italic> and <italic toggle="yes">–no-bias-correct</italic> options; featureCounts (<xref rid="B1" ref-type="bibr">1</xref>) v1.6.4 run with default settings and the <italic toggle="yes">–fraction</italic> and <italic toggle="yes">-O</italic> options; HTSeq v0.11.0 (<xref rid="B2" ref-type="bibr">2</xref>) run with each of the <italic toggle="yes">-m union</italic>, <italic toggle="yes">-m intersection-nonempty</italic>, and -<italic toggle="yes">m intersection-strict</italic> options and <italic toggle="yes">–nonunique all</italic> options; kallisto v0.46.1 (<xref rid="B13" ref-type="bibr">13</xref>) run with default settings; and Salmon v1.1.0 (<xref rid="B14" ref-type="bibr">14</xref>) run with default settings and the <italic toggle="yes">–allowDovetail</italic> and <italic toggle="yes">–validateMappings</italic> options.</p>
      <p>MA plots were generated between FADU and the default modes of eXpress, featureCounts, HTSeq, kallisto, and Salmon. For each plot, the mean average of the log<sub>2</sub> counts (A) was calculated and plotted against the log<sub>2</sub> ratio of counts (M).</p>
    </sec>
    <sec id="s4.5">
      <title>Data availability.</title>
      <p>Three data sets were used in all analyses consisting of RNA-Seq paired-end data from standard, nonstranded libraries originating from <italic toggle="yes">E. chaffeensis</italic> and <named-content content-type="genus-species">E. coli</named-content> and stranded libraries from <italic toggle="yes">w</italic>Bm. The sequencing reads for the three data sets can be found in the NCBI Sequence Read Archive under the following accession numbers: <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/sra/SRX485438" ext-link-type="uri" assigning-authority="ncbi:sra">SRX485438</ext-link>, <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/sra/SRX1322474" ext-link-type="uri" assigning-authority="ncbi:sra">SRX1322474</ext-link>, and <ext-link xlink:href="https://www.ncbi.nlm.nih.gov/sra/SRX2508248" ext-link-type="uri" assigning-authority="ncbi:sra">SRX2508248</ext-link>, respectively. Additional scripts and commands used for analyses and benchmarking are available at <ext-link xlink:href="https://github.com/IGS/FADU" ext-link-type="uri">https://github.com/IGS/FADU</ext-link>.</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGMENT</title>
    <p>This project was funded by federal funds from the National Institute of Allergy and Infectious Diseases, National Institutes of Health, Department of Health and Human Services, under grant number U19AI110820.</p>
  </ack>
  <fn-group>
    <fn fn-type="other">
      <p>For a commentary on this article, see <related-article related-article-type="companion" ext-link-type="doi" id="e01256-20" xlink:href="10.1128/mSystems.01256-20" vol="5">https://doi.org/10.1128/mSystems.01256-20</related-article>.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>GK</given-names></string-name>, <string-name><surname>Shi</surname><given-names>W</given-names></string-name></person-group>. <year>2014</year>. <article-title>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</article-title>. <source>Bioinformatics</source><volume>30</volume>:<fpage>923</fpage>–<lpage>930</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btt656</pub-id>.<pub-id pub-id-type="pmid">24227677</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Anders</surname><given-names>S</given-names></string-name>, <string-name><surname>Pyl</surname><given-names>PT</given-names></string-name>, <string-name><surname>Huber</surname><given-names>W</given-names></string-name></person-group>. <year>2015</year>. <article-title>HTSeq—a Python framework to work with high-throughput sequencing data</article-title>. <source>Bioinformatics</source><volume>31</volume>:<fpage>166</fpage>–<lpage>169</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btu638</pub-id>.<pub-id pub-id-type="pmid">25260700</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Langmead</surname><given-names>B</given-names></string-name>, <string-name><surname>Trapnell</surname><given-names>C</given-names></string-name>, <string-name><surname>Pop</surname><given-names>M</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL</given-names></string-name></person-group>. <year>2009</year>. <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>. <source>Genome Biol</source><volume>10</volume>:<fpage>R25</fpage>. doi:<pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id>.<pub-id pub-id-type="pmid">19261174</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Langmead</surname><given-names>B</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL</given-names></string-name></person-group>. <year>2012</year>. <article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat Methods</source><volume>9</volume>:<fpage>357</fpage>–<lpage>359</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>.<pub-id pub-id-type="pmid">22388286</pub-id></mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Durbin</surname><given-names>R</given-names></string-name></person-group>. <year>2009</year>. <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source><volume>25</volume>:<fpage>1754</fpage>–<lpage>1760</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>D</given-names></string-name>, <string-name><surname>Langmead</surname><given-names>B</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL</given-names></string-name></person-group>. <year>2015</year>. <article-title>HISAT: a fast spliced aligner with low memory requirements</article-title>. <source>Nat Methods</source><volume>12</volume>:<fpage>357</fpage>–<lpage>360</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.3317</pub-id>.<pub-id pub-id-type="pmid">25751142</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trapnell</surname><given-names>C</given-names></string-name>, <string-name><surname>Williams</surname><given-names>BA</given-names></string-name>, <string-name><surname>Pertea</surname><given-names>G</given-names></string-name>, <string-name><surname>Mortazavi</surname><given-names>A</given-names></string-name>, <string-name><surname>Kwan</surname><given-names>G</given-names></string-name>, <string-name><surname>van Baren</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL</given-names></string-name>, <string-name><surname>Wold</surname><given-names>BJ</given-names></string-name>, <string-name><surname>Pachter</surname><given-names>L</given-names></string-name></person-group>. <year>2010</year>. <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>. <source>Nat Biotechnol</source><volume>28</volume>:<fpage>511</fpage>–<lpage>515</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nbt.1621</pub-id>.<pub-id pub-id-type="pmid">20436464</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roberts</surname><given-names>A</given-names></string-name>, <string-name><surname>Trapnell</surname><given-names>C</given-names></string-name>, <string-name><surname>Donaghey</surname><given-names>J</given-names></string-name>, <string-name><surname>Rinn</surname><given-names>JL</given-names></string-name>, <string-name><surname>Pachter</surname><given-names>L</given-names></string-name></person-group>. <year>2011</year>. <article-title>Improving RNA-Seq expression estimates by correcting for fragment bias</article-title>. <source>Genome Biol</source><volume>12</volume>:<fpage>R22</fpage>. doi:<pub-id pub-id-type="doi">10.1186/gb-2011-12-3-r22</pub-id>.<pub-id pub-id-type="pmid">21410973</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roberts</surname><given-names>A</given-names></string-name>, <string-name><surname>Pimentel</surname><given-names>H</given-names></string-name>, <string-name><surname>Trapnell</surname><given-names>C</given-names></string-name>, <string-name><surname>Pachter</surname><given-names>L</given-names></string-name></person-group>. <year>2011</year>. <article-title>Identification of novel transcripts in annotated genomes using RNA-Seq</article-title>. <source>Bioinformatics</source><volume>27</volume>:<fpage>2325</fpage>–<lpage>2329</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btr355</pub-id>.<pub-id pub-id-type="pmid">21697122</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trapnell</surname><given-names>C</given-names></string-name>, <string-name><surname>Hendrickson</surname><given-names>DG</given-names></string-name>, <string-name><surname>Sauvageau</surname><given-names>M</given-names></string-name>, <string-name><surname>Goff</surname><given-names>L</given-names></string-name>, <string-name><surname>Rinn</surname><given-names>JL</given-names></string-name>, <string-name><surname>Pachter</surname><given-names>L</given-names></string-name></person-group>. <year>2013</year>. <article-title>Differential analysis of gene regulation at transcript resolution with RNA-seq</article-title>. <source>Nat Biotechnol</source><volume>31</volume>:<fpage>46</fpage>–<lpage>53</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nbt.2450</pub-id>.<pub-id pub-id-type="pmid">23222703</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>B</given-names></string-name>, <string-name><surname>Dewey</surname><given-names>CN</given-names></string-name></person-group>. <year>2011</year>. <article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title>. <source>BMC Bioinformatics</source><volume>12</volume>:<fpage>323</fpage>. doi:<pub-id pub-id-type="doi">10.1186/1471-2105-12-323</pub-id>.<pub-id pub-id-type="pmid">21816040</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roberts</surname><given-names>A</given-names></string-name>, <string-name><surname>Pachter</surname><given-names>L</given-names></string-name></person-group>. <year>2013</year>. <article-title>Streaming fragment assignment for real-time analysis of sequencing experiments</article-title>. <source>Nat Methods</source><volume>10</volume>:<fpage>71</fpage>–<lpage>73</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.2251</pub-id>.<pub-id pub-id-type="pmid">23160280</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bray</surname><given-names>NL</given-names></string-name>, <string-name><surname>Pimentel</surname><given-names>H</given-names></string-name>, <string-name><surname>Melsted</surname><given-names>P</given-names></string-name>, <string-name><surname>Pachter</surname><given-names>L</given-names></string-name></person-group>. <year>2016</year>. <article-title>Near-optimal probabilistic RNA-seq quantification</article-title>. <source>Nat Biotechnol</source><volume>34</volume>:<fpage>525</fpage>–<lpage>527</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nbt.3519</pub-id>.<pub-id pub-id-type="pmid">27043002</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patro</surname><given-names>R</given-names></string-name>, <string-name><surname>Duggal</surname><given-names>G</given-names></string-name>, <string-name><surname>Love</surname><given-names>MI</given-names></string-name>, <string-name><surname>Irizarry</surname><given-names>RA</given-names></string-name>, <string-name><surname>Kingsford</surname><given-names>C</given-names></string-name></person-group>. <year>2017</year>. <article-title>Salmon provides fast and bias-aware quantification of transcript expression</article-title>. <source>Nat Methods</source><volume>14</volume>:<fpage>417</fpage>–<lpage>419</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.4197</pub-id>.<pub-id pub-id-type="pmid">28263959</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salgado</surname><given-names>H</given-names></string-name>, <string-name><surname>Moreno-Hagelsieb</surname><given-names>G</given-names></string-name>, <string-name><surname>Smith</surname><given-names>TF</given-names></string-name>, <string-name><surname>Collado-Vides</surname><given-names>J</given-names></string-name></person-group>. <year>2000</year>. <article-title>Operons in Escherichia coli: genomic analyses and predictions</article-title>. <source>Proc Natl Acad Sci U S A</source><volume>97</volume>:<fpage>6652</fpage>–<lpage>6657</lpage>. doi:<pub-id pub-id-type="doi">10.1073/pnas.110147297</pub-id>.<pub-id pub-id-type="pmid">10823905</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Si</surname><given-names>Y</given-names></string-name>, <string-name><surname>Liu</surname><given-names>P</given-names></string-name>, <string-name><surname>Li</surname><given-names>P</given-names></string-name>, <string-name><surname>Brutnell</surname><given-names>TP</given-names></string-name></person-group>. <year>2014</year>. <article-title>Model-based clustering for RNA-seq data</article-title>. <source>Bioinformatics</source><volume>30</volume>:<fpage>197</fpage>–<lpage>205</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btt632</pub-id>.<pub-id pub-id-type="pmid">24191069</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patro</surname><given-names>R</given-names></string-name>, <string-name><surname>Mount</surname><given-names>SM</given-names></string-name>, <string-name><surname>Kingsford</surname><given-names>C</given-names></string-name></person-group>. <year>2014</year>. <article-title>Sailfish enables alignment-free isoform quantification from RNA-seq reads using lightweight algorithms</article-title>. <source>Nat Biotechnol</source><volume>32</volume>:<fpage>462</fpage>–<lpage>464</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nbt.2862</pub-id>.<pub-id pub-id-type="pmid">24752080</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pertea</surname><given-names>M</given-names></string-name>, <string-name><surname>Ayanbule</surname><given-names>K</given-names></string-name>, <string-name><surname>Smedinghoff</surname><given-names>M</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>SL</given-names></string-name></person-group>. <year>2009</year>. <article-title>OperonDB: a comprehensive database of predicted operons in microbial genomes</article-title>. <source>Nucleic Acids Res</source><volume>37</volume>:<fpage>D479</fpage>–<lpage>D482</lpage>. doi:<pub-id pub-id-type="doi">10.1093/nar/gkn784</pub-id>.<pub-id pub-id-type="pmid">18948284</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frazee</surname><given-names>AC</given-names></string-name>, <string-name><surname>Jaffe</surname><given-names>AE</given-names></string-name>, <string-name><surname>Langmead</surname><given-names>B</given-names></string-name>, <string-name><surname>Leek</surname><given-names>JT</given-names></string-name></person-group>. <year>2015</year>. <article-title>Polyester: simulating RNA-seq datasets with differential transcript expression</article-title>. <source>Bioinformatics</source><volume>31</volume>:<fpage>2778</fpage>–<lpage>2784</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btv272</pub-id>.<pub-id pub-id-type="pmid">25926345</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Love</surname><given-names>MI</given-names></string-name>, <string-name><surname>Huber</surname><given-names>W</given-names></string-name>, <string-name><surname>Anders</surname><given-names>S</given-names></string-name></person-group>. <year>2014</year>. <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source><volume>15</volume>:<fpage>550</fpage>. doi:<pub-id pub-id-type="doi">10.1186/s13059-014-0550-8</pub-id>.<pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Robinson</surname><given-names>MD</given-names></string-name>, <string-name><surname>McCarthy</surname><given-names>DJ</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>GK</given-names></string-name></person-group>. <year>2010</year>. <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source><volume>26</volume>:<fpage>139</fpage>–<lpage>140</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>.<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Garalde</surname><given-names>DR</given-names></string-name>, <string-name><surname>Snell</surname><given-names>EA</given-names></string-name>, <string-name><surname>Jachimowicz</surname><given-names>D</given-names></string-name>, <string-name><surname>Sipos</surname><given-names>B</given-names></string-name>, <string-name><surname>Lloyd</surname><given-names>JH</given-names></string-name>, <string-name><surname>Bruce</surname><given-names>M</given-names></string-name>, <string-name><surname>Pantic</surname><given-names>N</given-names></string-name>, <string-name><surname>Admassu</surname><given-names>T</given-names></string-name>, <string-name><surname>James</surname><given-names>P</given-names></string-name>, <string-name><surname>Warland</surname><given-names>A</given-names></string-name>, <string-name><surname>Jordan</surname><given-names>M</given-names></string-name>, <string-name><surname>Ciccone</surname><given-names>J</given-names></string-name>, <string-name><surname>Serra</surname><given-names>S</given-names></string-name>, <string-name><surname>Keenan</surname><given-names>J</given-names></string-name>, <string-name><surname>Martin</surname><given-names>S</given-names></string-name>, <string-name><surname>McNeill</surname><given-names>L</given-names></string-name>, <string-name><surname>Wallace</surname><given-names>EJ</given-names></string-name>, <string-name><surname>Jayasinghe</surname><given-names>L</given-names></string-name>, <string-name><surname>Wright</surname><given-names>C</given-names></string-name>, <string-name><surname>Blasco</surname><given-names>J</given-names></string-name>, <string-name><surname>Young</surname><given-names>S</given-names></string-name>, <string-name><surname>Brocklebank</surname><given-names>D</given-names></string-name>, <string-name><surname>Juul</surname><given-names>S</given-names></string-name>, <string-name><surname>Clarke</surname><given-names>J</given-names></string-name>, <string-name><surname>Heron</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Turner</surname><given-names>DJ</given-names></string-name></person-group>. <year>2018</year>. <article-title>Highly parallel direct RNA sequencing on an array of nanopores</article-title>. <source>Nat Methods</source><volume>15</volume>:<fpage>201</fpage>–<lpage>206</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.4577</pub-id>.<pub-id pub-id-type="pmid">29334379</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bezanson</surname><given-names>J</given-names></string-name>, <string-name><surname>Edelman</surname><given-names>A</given-names></string-name>, <string-name><surname>Karpinski</surname><given-names>S</given-names></string-name>, <string-name><surname>Shah</surname><given-names>VB</given-names></string-name></person-group>. <year>2017</year>. <article-title>Julia: a fresh approach to numerical computing</article-title>. <source>SIAM Rev Soc Ind Appl Math</source><volume>59</volume>:<fpage>65</fpage>–<lpage>98</lpage>. doi:<pub-id pub-id-type="doi">10.1137/141000671</pub-id>.</mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Foster</surname><given-names>JM</given-names></string-name>, <string-name><surname>Grote</surname><given-names>A</given-names></string-name>, <string-name><surname>Mattick</surname><given-names>J</given-names></string-name>, <string-name><surname>Tracey</surname><given-names>A</given-names></string-name>, <string-name><surname>Tsai</surname><given-names>Y-C</given-names></string-name>, <string-name><surname>Chung</surname><given-names>M</given-names></string-name>, <string-name><surname>Cotton</surname><given-names>JA</given-names></string-name>, <string-name><surname>Clark</surname><given-names>TA</given-names></string-name>, <string-name><surname>Geber</surname><given-names>A</given-names></string-name>, <string-name><surname>Holroyd</surname><given-names>N</given-names></string-name>, <string-name><surname>Korlach</surname><given-names>J</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y</given-names></string-name>, <string-name><surname>Libro</surname><given-names>S</given-names></string-name>, <string-name><surname>Lustigman</surname><given-names>S</given-names></string-name>, <string-name><surname>Michalski</surname><given-names>ML</given-names></string-name>, <string-name><surname>Paulini</surname><given-names>M</given-names></string-name>, <string-name><surname>Rogers</surname><given-names>MB</given-names></string-name>, <string-name><surname>Teigen</surname><given-names>L</given-names></string-name>, <string-name><surname>Twaddle</surname><given-names>A</given-names></string-name>, <string-name><surname>Welch</surname><given-names>L</given-names></string-name>, <string-name><surname>Berriman</surname><given-names>M</given-names></string-name>, <string-name><surname>Dunning Hotopp</surname><given-names>JC</given-names></string-name>, <string-name><surname>Ghedin</surname><given-names>E</given-names></string-name></person-group>. <year>2020</year>. <article-title>Sex chromosome evolution in parasitic nematodes of humans</article-title>. <source>Nat Commun</source><volume>11</volume>:<fpage>1964</fpage>. doi:<pub-id pub-id-type="doi">10.1038/s41467-020-15654-6</pub-id>.<pub-id pub-id-type="pmid">32327641</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ioannidis</surname><given-names>P</given-names></string-name>, <string-name><surname>Johnston</surname><given-names>KL</given-names></string-name>, <string-name><surname>Riley</surname><given-names>DR</given-names></string-name>, <string-name><surname>Kumar</surname><given-names>N</given-names></string-name>, <string-name><surname>White</surname><given-names>JR</given-names></string-name>, <string-name><surname>Olarte</surname><given-names>KT</given-names></string-name>, <string-name><surname>Ott</surname><given-names>S</given-names></string-name>, <string-name><surname>Tallon</surname><given-names>LJ</given-names></string-name>, <string-name><surname>Foster</surname><given-names>JM</given-names></string-name>, <string-name><surname>Taylor</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Dunning Hotopp</surname><given-names>JC</given-names></string-name></person-group>. <year>2013</year>. <article-title>Extensively duplicated and transcriptionally active recent lateral gene transfer from a bacterial Wolbachia endosymbiont to its host filarial nematode Brugia malayi</article-title>. <source>BMC Genomics</source><volume>14</volume>:<fpage>639</fpage>. doi:<pub-id pub-id-type="doi">10.1186/1471-2164-14-639</pub-id>.<pub-id pub-id-type="pmid">24053607</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
