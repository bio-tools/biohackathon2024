<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8275330</article-id>
    <article-id pub-id-type="pmid">34252956</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab269</article-id>
    <article-id pub-id-type="publisher-id">btab269</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Regulatory and Functional Genomics</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Bayesian information sharing enhances detection of regulatory associations in rare cell types</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Alexander P</given-names>
        </name>
        <aff><institution>Computer Science and Artificial Intelligence Laboratory, MIT</institution>, Cambridge, MA 02139, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Peng</surname>
          <given-names>Jian</given-names>
        </name>
        <aff><institution>Department of Computer Science, University of Illinois at Urbana-Champaign</institution>, Champaign, IL 61801, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2724-7228</contrib-id>
        <name>
          <surname>Berger</surname>
          <given-names>Bonnie</given-names>
        </name>
        <aff><institution>Computer Science and Artificial Intelligence Laboratory, MIT</institution>, Cambridge, MA 02139, <country country="US">USA</country></aff>
        <aff><institution>Department of Mathematics, MIT</institution>, Cambridge, MA 02139, <country country="US">USA</country></aff>
        <aff><institution>Broad Institute of MIT and Harvard</institution>, Cambridge, MA 02142, <country country="US">USA</country></aff>
        <xref rid="btab269-cor1" ref-type="corresp"/>
        <!--bab@mit.edu-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Cho</surname>
          <given-names>Hyunghoon</given-names>
        </name>
        <aff><institution>Broad Institute of MIT and Harvard</institution>, Cambridge, MA 02142, <country country="US">USA</country></aff>
        <xref rid="btab269-cor1" ref-type="corresp"/>
        <!--hhcho@broadinstitute.org-->
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab269-cor1">To whom correspondence should be addressed <email>bab@mit.edu</email> or <email>hhcho@broadinstitute.org</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-07-12">
      <day>12</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>Suppl 1</issue>
    <issue-title>ISMB/ECCB 2021 Proceedings</issue-title>
    <fpage>i349</fpage>
    <lpage>i357</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab269.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Recent advances in single-cell RNA-sequencing (scRNA-seq) technologies promise to enable the study of gene regulatory associations at unprecedented resolution in diverse cellular contexts. However, identifying unique regulatory associations observed only in specific cell types or conditions remains a key challenge; this is particularly so for rare transcriptional states whose sample sizes are too small for existing gene regulatory network inference methods to be effective.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present ShareNet, a Bayesian framework for boosting the accuracy of cell type-specific gene regulatory networks by propagating information across related cell types via an information sharing structure that is adaptively optimized for a given single-cell dataset. The techniques we introduce can be used with a range of general network inference algorithms to enhance the output for each cell type. We demonstrate the enhanced accuracy of our approach on three benchmark scRNA-seq datasets. We find that our inferred cell type-specific networks also uncover key changes in gene associations that underpin the complex rewiring of regulatory networks across cell types, tissues and dynamic biological processes. Our work presents a path toward extracting deeper insights about cell type-specific gene regulation in the rapidly growing compendium of scRNA-seq datasets.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
      <sec id="s1a">
        <title>Availability and implementation</title>
        <p>The code for ShareNet is available at <ext-link xlink:href="http://sharenet.csail.mit.edu" ext-link-type="uri">http://sharenet.csail.mit.edu</ext-link> and <ext-link xlink:href="https://github.com/alexw16/sharenet" ext-link-type="uri">https://github.com/alexw16/sharenet</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIH</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
        <award-id>U01 CA250554</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Schmidt Fellows Program</institution>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NSF CAREER Award</institution>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
        <award-id>1652815</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Understanding the intricate coordination of biomolecules underlying transcriptional regulation, commonly represented as a gene regulatory network (GRN), is key to gaining mechanistic insights into the diversity of cellular functions and phenotypes observed across different cell types and biological states. Single-cell RNA sequencing (scRNA-seq) (<xref rid="btab269-B14" ref-type="bibr">Gawad <italic toggle="yes">et al.</italic>, 2016</xref>) has emerged as a powerful way of profiling the transcriptomes of individual cells, rather than the average of large populations of cells as in traditional bulk sequencing. scRNA-seq has already played a pivotal role in uncovering the rich heterogeneity of gene expression patterns (<xref rid="btab269-B20" ref-type="bibr">Hie <italic toggle="yes">et al.</italic>, 2020</xref>), enabling the decomposition of diverse populations of cells into their component cell types (<xref rid="btab269-B3" ref-type="bibr">Bjorklund <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab269-B5" ref-type="bibr">Buettner <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab269-B18" ref-type="bibr">Hie <italic toggle="yes">et al.</italic>, 2019a</xref>) as well as <italic toggle="yes">de novo</italic> identification of rare cell types (<xref rid="btab269-B10" ref-type="bibr">DeMeo and Berger, 2020</xref>; <xref rid="btab269-B15" ref-type="bibr">Grün <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab269-B19" ref-type="bibr">Hie <italic toggle="yes">et al.</italic>, 2019b</xref>; <xref rid="btab269-B23" ref-type="bibr">Jiang <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab269-B37" ref-type="bibr">Villani <italic toggle="yes">et al.</italic>, 2017</xref>). We reasoned that scRNA-seq could also enhance GRN inference by allowing for more accurate assessment of covarying patterns among genes. The rapid growth of scRNA-seq datasets spanning diverse tissues, organisms and conditions thus provides an enticing opportunity for studying gene regulatory interactions at an unprecedented scale and resolution.</p>
    <p>Despite the large success of cell type identification analyses based on scRNA-seq (<xref rid="btab269-B3" ref-type="bibr">Bjorklund <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab269-B5" ref-type="bibr">Buettner <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab269-B15" ref-type="bibr">Grün <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab269-B23" ref-type="bibr">Jiang <italic toggle="yes">et al.</italic>, 2016</xref>), relatively few efforts have been made to further characterize the cell types by inferring their underlying GRNs. Although numerous methods for general GRN reconstruction exist in the literature, including state-of-the-art tools such as GENIE3 (<xref rid="btab269-B22" ref-type="bibr">Huynh-Thu <italic toggle="yes">et al.</italic>, 2010</xref>) and PIDC (<xref rid="btab269-B8" ref-type="bibr">Chan <italic toggle="yes">et al.</italic>, 2017</xref>), a key challenge in applying these methods in a cell type-specific context has been the severe lack of power when analyzing rare or sparsely sampled cell types (<xref rid="btab269-F1" ref-type="fig">Fig. 1a</xref>). This problem is further compounded by the inherent sparsity of scRNA-seq data stemming from both technical and biological factors (<xref rid="btab269-B2" ref-type="bibr">Angerer <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab269-B9" ref-type="bibr">Choi <italic toggle="yes">et al.</italic>, 2020</xref>), which naturally increases the number of samples needed for accurate inference. Although increasing the number of sequenced cells in a study partially mitigates this issue by obtaining more cells from rare cell types, larger datasets also tend to reveal additional rare cell types to be studied as well as fine-grain transcriptional structure <italic toggle="yes">within</italic> a known cell type; both may still suffer from similar sample size limitations, not to mention the burden of increased experimental cost of sequencing more cells. Since the detection and characterization of rare cell types is a prominent goal for many single-cell studies (<xref rid="btab269-B15" ref-type="bibr">Grün <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab269-B23" ref-type="bibr">Jiang <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btab269-B37" ref-type="bibr">Villani <italic toggle="yes">et al.</italic>, 2017</xref>), these issues present a major hurdle in understanding the regulatory patterns of rare, yet important transcriptional states.</p>
    <fig position="float" id="btab269-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Overview of ShareNet framework. (<bold>a</bold>) Analyzing gene regulatory interactions in individual cell types is challenging when only a small number of cells for a given cell type have been profiled in a single-cell RNA sequencing experiment. (<bold>b</bold>) ShareNet shares information across cell types through a Bayesian framework to enhance the accuracy of predicted regulatory interactions in each cell type. ShareNet adaptively chooses the information sharing structure that best explains the input data. GRN: gene regulatory network</p>
      </caption>
      <graphic xlink:href="btab269f1" position="float"/>
    </fig>
    <p>We introduce ShareNet, a Bayesian information sharing framework for increasing the accuracy of predicting cell type-specific regulatory associations from single-cell transcriptomic data (<xref rid="btab269-F1" ref-type="fig">Fig. 1b</xref>). Our framework draws upon the intuition that many of the regulatory interactions (and non-interactions) are shared across different cell types, due to shared developmental lineages, regulatory programs, or biophysical constraints. Thus, by propagating information across related cell types, we hope to reduce noise and boost the accuracy of inferred GRNs in all cell types. Since we do not have full knowledge of the sharing patterns underlying a given dataset, we designed our framework to adaptively learn a multifactorial, information sharing structure that best explains the data in all the study’s cell types. Importantly, our framework is widely applicable, as it can serve as an additional layer on top of existing state-of-the-art network inference algorithms to enhance their accuracy in estimating the GRNs of all cell types in a dataset.</p>
    <p>In our work, we demonstrate the effectiveness of ShareNet on a range of scRNA-seq datasets at boosting the accuracy of GENIE3 (<xref rid="btab269-B22" ref-type="bibr">Huynh-Thu <italic toggle="yes">et al.</italic>, 2010</xref>) and PIDC (<xref rid="btab269-B8" ref-type="bibr">Chan <italic toggle="yes">et al.</italic>, 2017</xref>), two of the top-performing algorithms from a recent single-cell network inference benchmarking study (<xref rid="btab269-B30" ref-type="bibr">Pratapa <italic toggle="yes">et al.</italic>, 2020</xref>), as well as standard co-expression networks based on Pearson correlation. We also show that ShareNet uncovers cell type-specific gene associations that uniquely characterize the identity of cells within different tissue contexts and across differentiation trajectories.</p>
    <p>As scRNA-seq datasets continue to uncover new rare cell types and transcriptional states, the ability of ShareNet to accurately determine higher-order transcriptional patterns in small subpopulations of cells in a dataset will be increasingly crucial for scientific studies. An open-source implementation of ShareNet is available at: https://github.com/alexw16/sharenet.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Overview of ShareNet</title>
      <p>ShareNet produces improved estimates of regulatory associations by leveraging both the redundancy and diversity of gene regulatory network structures underlying the many transcriptional states observed in a single-cell RNA-seq dataset. At its core is a compact set of cell type-to-cell type sharing patterns that is learned directly from the data. This set of sharing patterns determines the manner by which each edge in a network for a specific cell type propagates information about its presence or absence to the same edge in each of the other cell types’ networks. By learning a collection of sharing patterns rather than a single common pattern, ShareNet is able to adaptively share information across cell types in a manner that spans a broad range of possible cell type-to-cell type relationships rather than being limited to a singular sharing structure. The flexibility offered by this approach is especially useful for inferring networks, as each edge may be specific to a particular cell type, shared across a subset of related cell types or globally shared with all cell types depending on the scope of biological functions with which the edge is associated. Intuitively, ShareNet automatically learns and leverages the specific sharing pattern that is most appropriate for each edge. Furthermore, ShareNet is compatible with a broad range of existing network inference algorithms to boost their accuracy in constructing cell type-specific networks.</p>
    </sec>
    <sec>
      <title>2.2 ShareNet’s Bayesian model for information sharing</title>
      <p>ShareNet minimally requires that the chosen algorithm outputs a continuous score for each putative edge of interest in a network for each cell type. A user would first apply his/her network inference algorithm of choice to each cell type in a dataset to generate an initial estimate of the edge scores for each cell type. ShareNet models these initial network estimates as noisy observations of true underlying edge scores, governed by a hierarchical Bayesian model that induces similarities in predictions between similar cell types.</p>
      <p>In this Bayesian model, the collection of latent cell type-to-cell type information sharing patterns is represented as a mixture of multivariate Gaussian distributions with <italic toggle="yes">K</italic> mixture components.
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Categorical</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold">Σ</mml:mi><mml:msub><mml:mi>u</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:msub><mml:mo>)</mml:mo></mml:math></disp-formula></p>
      <p>Here, <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is a <italic toggle="yes">C</italic>-dimensional vector, where <italic toggle="yes">C</italic> is the number of cell types in a dataset. Each of the <italic toggle="yes">C</italic>-by-<italic toggle="yes">C</italic> covariance matrices <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> represents a unique cell type-to-cell type sharing pattern, with the off-diagonal entries in each covariance matrix capturing potential positive or negative correlations in the predicted edge scores between cell types.</p>
      <p>For regularization, we place a Normal-Wishart (NW) prior over each of the mean <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and the inverse covariance <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">Σ</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> parameters belonging to the <italic toggle="yes">K</italic> sharing patterns.
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">Σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>∼</mml:mo><mml:mtext>NW</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mo>μ</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mo>β</mml:mo><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo mathvariant="bold">Ψ</mml:mo><mml:mo>,</mml:mo><mml:mo>ν</mml:mo><mml:mo>)</mml:mo></mml:math></disp-formula></p>
      <p>Each element of the <italic toggle="yes">C</italic>-dimensional vector <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> then serves as a parameter for a univariate Gaussian distribution that describes the noisy distribution of an edge’s score from the chosen network inference algorithm.
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>Here, <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> represents the observed score for the edge connecting gene <italic toggle="yes">i</italic> to gene <italic toggle="yes">j</italic> in cell type <italic toggle="yes">c</italic>. In this setup, the mean <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> of the Gaussian is a latent variable that represents the true score of the edge in an ideal scenario absent of noise. Note that the noise distribution for each edge score is assumed to be Gaussian, a condition that is approximately satisfied by a range of methods we consider in this work (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig.</xref>  <xref rid="sup1" ref-type="supplementary-material">S</xref><xref rid="sup1" ref-type="supplementary-material">1</xref>). Optionally, one can model the mean of each edge distribution as <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> describes a link function that provides further flexibility for modeling the sharing patterns of edge scores; all of our results are based on the default configuration without this added non-linearity.</p>
      <p>The variance parameter <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> captures the degree of variation in the observed edge score. Importantly, the variation captured by <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> represents the aggregate set of biological, technical and sample size factors that may contribute to noisy estimates of the edge score. A more detailed discussion of this variance term is presented in the next section.</p>
    </sec>
    <sec>
      <title>2.3 Bootstrap estimation of edge-specific noise distribution</title>
      <p>The task of inferring cell type-specific gene regulatory networks from single-cell transcriptomics data is challenging due to a wide array of biological, technical and sample size factors. In our probabilistic model, we characterize the cumulative effect of these factors by estimating the standard deviation for each observed edge score in a network with respect to the network inference algorithm of choice. We empirically estimate the standard deviation by (i) generating a bootstrap sample of cells for a particular cell type <italic toggle="yes">c</italic> that contains the same number of cells as all of the cells in that cell type, (ii) applying the network inference algorithm of choice for the bootstrap sampled set of cells and (iii) repeating (i) and (ii) across <italic toggle="yes">M</italic> trials. This process generates <italic toggle="yes">M</italic> estimates of the network for cell type <italic toggle="yes">c</italic>. We then calculate the sample standard deviation for each edge score across the <italic toggle="yes">M</italic> trials. We denote this quantity as <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> for edge (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>) in cell type <italic toggle="yes">c</italic>. We use these terms in the last layer of our model as an estimate for the standard deviation of the edge distributions. More precisely, we set the <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> term in the Gaussian distribution <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, from which the edge score <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is drawn, to be equal to <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>σ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. Networks inferred for smaller cell type populations display higher edge score standard deviations across various scRNA-seq datasets and network inference algorithms (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig.</xref>  <xref rid="sup1" ref-type="supplementary-material">S</xref><xref rid="sup1" ref-type="supplementary-material">2</xref>), suggesting that inferring networks using existing techniques is indeed underpowered for rare cell types.</p>
    </sec>
    <sec>
      <title>2.4 End-to-end generative model for likelihood analysis</title>
      <p>Although ShareNet models only the predicted edge scores from the network inference method of choice, we sought to further extend the ShareNet model to obtain an end-to-end generative process for calculating the likelihood of observed gene expression levels. We use this full model, which we refer to as BVS (Bayesian variable selection), for holdout likelihood analyses in our benchmark experiments to provide additional evidence for the utility of information sharing. To this end, we frame the task of network inference as a variable selection problem, in which the goal is to identify putative regulators for target genes. In particular, we adapt a Bayesian approach proposed by <xref rid="btab269-B6" ref-type="bibr">Carbonetto and Stephens (2012)</xref> for identifying causal variants in genetic association studies and integrate ShareNet as a prior for variable selection.</p>
      <p>We denote the scRNA-seq expression values for a set of regulator genes for cell type <italic toggle="yes">c</italic> as <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. The expression of the corresponding target genes <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is modeled as a linear combination of the putative regulators plus Gaussian noise:
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="true">(</mml:mo><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:msubsup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mo>ϵ</mml:mo><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="true">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> represents the coefficient of the linear model describing the effect of regulator gene <italic toggle="yes">i</italic> on target gene <italic toggle="yes">j</italic>, and <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is a corresponding binary indicator variable that indicates whether or not regulator gene <italic toggle="yes">i</italic> is to be included in the network model for cell type <italic toggle="yes">c</italic>. We also include the following ‘spike and slab’ priors (<xref rid="btab269-B27" ref-type="bibr">Mitchell and Beauchamp, 1988</xref>) on <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.
<disp-formula id="E6"><label>(6)</label><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mtext>Bernoulli</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E7"><label>(7)</label><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∼</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mo>β</mml:mo><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo> </mml:mo><mml:mtext>otherwise</mml:mtext><mml:mo>,</mml:mo><mml:mo> </mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>·</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denotes the Dirac delta function. Here, <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, like in the previous section, is modeled as a draw from the mixture of multivariate Gaussians describing the set of cell type-to-cell type sharing patterns we seek to leverage in ShareNet. We include the sigmoid function <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in this setting in order to map the Gaussian to a value between 0 and 1 for appropriate use as a Bernoulli parameter. In the scenario where there is no information sharing, the prior over <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is simply a Bernoulli distribution with fixed hyperparameter <italic toggle="yes">π</italic>.</p>
    </sec>
    <sec>
      <title>2.5 Estimating posterior beliefs using variational inference</title>
      <p>Given our model, re-estimating the edge scores based on information sharing reduces to calculating the posterior density of the latent variables given the input data. Although exact inference is intractable, we can leverage variational inference to approximately solve this inference task (<xref rid="btab269-B4" ref-type="bibr">Blei <italic toggle="yes">et al.</italic>, 2017</xref>). Briefly, the standard variational inference approach involves reframing our problem of computing the posterior as an optimization problem, in which we first propose a family of variational distributions for approximating the true posterior. We then identify the distribution within this family that most closely resembles the posterior, using KL divergence as the optimization objective.
<disp-formula id="E8"><label>(8)</label><mml:math id="M8" display="block" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>arg</mml:mi><mml:mi>min</mml:mi></mml:mrow><mml:mi>q</mml:mi></mml:munder><mml:mo> </mml:mo><mml:mtext>KL</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>Here, <italic toggle="yes">p</italic> denotes the true model distribution, <italic toggle="yes">q</italic> denotes the variational distribution and <bold><italic toggle="yes">U</italic></bold> denotes the set of latent variables in our model whose posterior distributions we aim to approximate. In the ShareNet model, we have <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold">Σ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. Following standard techniques, we assume that the variational distribution factorizes as
<disp-formula id="E9"><label>(9)</label><mml:math id="M9" display="block" overflow="scroll"><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold">Σ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">Σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>where each subscript for <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> maps to a unique edge (<italic toggle="yes">i</italic>, <italic toggle="yes">j</italic>). In addition, we restrict each of the factors in our variational distribution to take on the following distributions parameterized by the accompanying variational parameters.
<disp-formula id="E10"><label>(10)</label><mml:math id="M10" display="block" overflow="scroll"><mml:mrow><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">Σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mtext>NW</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">Σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">a</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">B</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ν</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:math></disp-formula>
 <disp-formula id="E11"><label>(11)</label><mml:math id="M11" display="block" overflow="scroll"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">m</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo stretchy="false">˜</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E12"><label>(12)</label><mml:math id="M12" display="block" overflow="scroll"><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mtext>Categorical</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">φ</mml:mi><mml:mo>~</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:math></disp-formula></p>
      <p>For BVS, we include the variables that define the linear model, so <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold">Σ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, and the corresponding model factorizes as
<disp-formula id="E13"><label>(13)</label><mml:math id="M13" display="block" overflow="scroll"><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi mathvariant="bold">Σ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mi mathvariant="bold">Σ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">γ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>C</mml:mi></mml:munderover><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mo>β</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mo>γ</mml:mo><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>c</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula>. We parameterize the variational distributions for this approach in a similar manner as above and also include the following distribution.
<disp-formula id="E14"><label>(14)</label><mml:math id="M14" display="block" overflow="scroll"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">{</mml:mo><mml:mrow><mml:mtable><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi mathvariant="script">N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo> </mml:mo><mml:mtext>if</mml:mtext><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>2.6 Coordinate ascent optimization algorithm</title>
      <p>In seeking to identify the variational distribution that best matches the posterior, we minimize the KL divergence objective equivalently by maximizing the ELBO (evidence lower bound), with respect to the variational parameters. The ELBO objective can be expressed as follows.
<disp-formula id="E15"><label>(15)</label><mml:math id="M15" display="block" overflow="scroll"><mml:mtext>ELBO</mml:mtext><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>[</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi mathvariant="double-struck">E</mml:mi><mml:mi>q</mml:mi></mml:msub><mml:mo>[</mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo><mml:mi>q</mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Σ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">u</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">z</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:math></disp-formula></p>
      <p>We optimize this quantity by coordinate ascent, which entails setting the partial derivative of the ELBO with respect to each variational parameter to zero and then solving for the conditionally optimal update for each variational parameter. The resulting update equations and the full derivation are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Materials</xref>.</p>
      <p>Finally, to extract the enhanced networks from our model, we leverage the variational distributions to approximate key latent variables of interest. Specifically, note that <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> approximates the posterior mean of <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, which represents the true edge score for a chosen network inference algorithm. Hence, we use the learned <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> values as revised edge scores.</p>
    </sec>
    <sec>
      <title>2.7 Datasets and pre-processing</title>
      <p>We analyzed three scRNA-seq datasets that we refer to as the BEELINE (<xref rid="btab269-B30" ref-type="bibr">Pratapa <italic toggle="yes">et al.</italic>, 2020</xref>), Tabula muris (<xref rid="btab269-B32" ref-type="bibr">Schaum <italic toggle="yes">et al</italic>., 2018</xref>) and mouse blood lineage datasets (<xref rid="btab269-B29" ref-type="bibr">Pijuan-Sala <italic toggle="yes">et al.</italic>, 2019</xref>). The pre-processed BEELINE dataset was made available online by the authors, and we made no further modifications to this dataset. For the Tabula muris and mouse blood lineage datasets, we first applied a standard <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>x</mml:mi><mml:mo>/</mml:mo><mml:mn>100</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> transformation to the raw counts data (provided in counts per million [CPM]) and removed genes that were not expressed in at least 10% of cells in any cell type. In inferring networks, we considered the set of genes defined by the union of the set of genes that are annotated as transcription factors in the AnimalTFDB database (<xref rid="btab269-B21" ref-type="bibr">Hu <italic toggle="yes">et al.</italic>, 2019</xref>) and the set of 1000 genes with the highest dispersion for each dataset (<xref rid="btab269-B31" ref-type="bibr">Satija <italic toggle="yes">et al.</italic>, 2015</xref>).</p>
      <p>In order to assess the accuracy of networks inferred using ShareNet, we compared networks estimated with and without ShareNet to a collection of reference networks derived from a range of existing molecular interaction databases. This collection of reference networks included (i) a functional interaction network derived from the STRING database (<xref rid="btab269-B35" ref-type="bibr">Szklarczyk <italic toggle="yes">et al.</italic>, 2018</xref>), (ii) a non-specific ChIP-seq network constructed using ChIP-seq data from the DorothEA (<xref rid="btab269-B13" ref-type="bibr">Garcia-Alonso <italic toggle="yes">et al.</italic>, 2019</xref>), RegNetwork (<xref rid="btab269-B26" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2015</xref>) and TRRUST (<xref rid="btab269-B17" ref-type="bibr">Han <italic toggle="yes">et al.</italic>, 2018</xref>) databases and (iii) multiple cell type-specific ChIP-seq networks derived from ChIP-seq data matched to each of the specific cell types represented in the scRNA-seq dataset that we analyzed. For studying networks inferred from the BEELINE scRNA-seq datasets, the cell type-specific ChIP-seq networks used as reference were built using data from the ENCODE (<xref rid="btab269-B12" ref-type="bibr">ENCODE Project Consortium, 2012</xref>), ChIP-Atlas (<xref rid="btab269-B28" ref-type="bibr">Oki <italic toggle="yes">et al.</italic>, 2018</xref>) and ESCAPE (<xref rid="btab269-B41" ref-type="bibr">Xu <italic toggle="yes">et al.</italic>, 2014</xref>) databases. This set of STRING, non-specific ChIP-seq and cell type-specific ChIP-seq reference networks were obtained from the BEELINE benchmarking study (<xref rid="btab269-B30" ref-type="bibr">Pratapa <italic toggle="yes">et al.</italic>, 2020</xref>). For the remaining scRNA-seq datasets that we analyzed, the cell type-specific ChIP-seq networks were obtained from ChIP-Atlas (<xref rid="btab269-B28" ref-type="bibr">Oki <italic toggle="yes">et al.</italic>, 2018</xref>), and an edge was defined for a transcription factor-target gene pair if a ChIP peak called using MACS2 (<xref rid="btab269-B43" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2008</xref>) (<inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mi>q</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>) for the transcription factor was located within 5 kb of the target gene’s transcription start site.</p>
    </sec>
    <sec>
      <title>2.8 Evaluation strategies</title>
      <p>For each inferred network, we computed the area under the precision-recall curve (AUPRC) relative to each of these three sets of reference networks to quantify the agreement between the predicted network and these reference networks. Similar to the BEELINE benchmarking study, when comparing inferred networks to either of the non-specific or specific ChIP-seq networks, we only considered edges outgoing from transcription factors for which ChIP-seq data was available.</p>
      <p>In the case of our extended BVS model described in Section 2.4, we are also able to evaluate the ability of the model to accurately predict gene expression values for a network’s target genes. The linear predictor in BVS defines the relationship between each target gene and a set of regulator genes, and we evaluated the effectiveness of this predictor on unseen data by calculating the model’s posterior predictive distribution with respect to held out data. To this end, we split each cell type in a dataset into a training set comprising 80% of cells in that cell type and held out the remaining 20% of cells as a test. We trained our model on the training set and then calculated a test log likelihood value for each target gene based on the posterior predictive distribution.</p>
    </sec>
    <sec>
      <title>2.9 Hyperparameter selection</title>
      <p>The use of ShareNet involves the consideration of two hyperparameters, the number of mixture components and the number of bootstrapped samples used to estimate edge score uncertainties. While the number of mixture components can be automatically learned via a nested cross-validation procedure, we found that ShareNet’s performance is generally robust to the number of mixture components, as long as multiple mixture components are used (Supplementary Fig. S3). We also determined that the standard deviation estimates for a majority of edges converge in value upon approximately five bootstrapped samples across Pearson correlation, GENIE3 and PIDC (Supplementary Fig. S4). For the below experiments, we used ten mixture components in our model and five bootstrapped samples for calculating edge score uncertainties.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 ShareNet improves network inference accuracy on a range of scRNA-seq datasets</title>
      <sec>
        <title>3.1.1 BEELINE benchmark single-cell data</title>
        <p>We first evaluated ShareNet on a set of well-defined scRNA-seq datasets introduced in a recent study (<xref rid="btab269-B30" ref-type="bibr">Pratapa <italic toggle="yes">et al.</italic>, 2020</xref>) to benchmark the state-of-the-art network inference algorithms. The evaluation framework used in this study, called BEELINE, leveraged data from five broad categories of mouse cell types: embryonic stem cells, dendritic cells, erythroid cells, granulocyte-monocyte cells and lymphoid cells. We asked whether one could exploit any similarity in the network structures underlying these five cell types to simultaneously improve the accuracy of these networks. To that end, we demonstrated the applicability of ShareNet on three common network inference approaches: GENIE3 (<xref rid="btab269-B22" ref-type="bibr">Huynh-Thu <italic toggle="yes">et al.</italic>, 2010</xref>), PIDC (<xref rid="btab269-B8" ref-type="bibr">Chan <italic toggle="yes">et al.</italic>, 2017</xref>) and Pearson correlation.</p>
        <p>We sought to evaluate the effectiveness of ShareNet in improving the accuracy of networks inferred in small sample size settings. To do so, we simulated various small sample size settings in the BEELINE reference datasets by downsampling the population of dendritic cells to population sizes of 50, 100 and 200 cells, while the other four cell types’ populations were retained in full. For each of the 50, 100 and 200 cell type population sizes, we inferred networks for dendritic cells and for the remaining cell types with and without ShareNet across the various network inference approaches.</p>
        <p>Across all three network inference algorithms, we observed that the inclusion of ShareNet produced networks that achieved higher AUPRC overall compared to the corresponding networks inferred in the setting without ShareNet (<xref rid="btab269-F2" ref-type="fig">Fig. 2</xref>). This improvement in performance was most notable for the scenarios where dendritic cells were downsampled most aggressively. For the 50 cell population size setting, the three network inference algorithms predictably demonstrated worse performance compared to in the larger 100 and 200 cell population size settings. However, when used with ShareNet, the accuracy of networks inferred for the 50 cell population of dendritic cells not only consistently improved but in several instances also exceeded the accuracy of the networks inferred using 100 and 200 cells without ShareNet. This outcome was observed across both the STRING and non-specific ChIP-seq as well as the cell type-specific ChIP-seq networks. The only exception was the slightly decreased accuracy of networks inferred using GENIE3 for cell type population sizes of 50 and 100 when compared with the cell type-specific ChIP-seq network. We hypothesize that this is due to the considerably greater variability of bootstrapped GENIE3 edge scores for these smallest populations of cells (Supplementary Fig. S5). This greater uncertainty increases the degree of information sharing across cell types, thus explaining the simultaneous decrease of accuracy with respect to the cell type-specific ChIP-seq network and increase of accuracy with respect to the STRING and non-specific ChIP-seq networks for these smaller cell type populations.</p>
        <fig position="float" id="btab269-F2">
          <label>Fig. 2.</label>
          <caption>
            <p>ShareNet improves network inference accuracy for small populations of dendritic cells in BEELINE benchmark single-cell RNA-seq datasets. We compared the accuracy of dendritic cell networks generated based on Pearson correlation, GENIE3 and PIDC, with and without ShareNet. Dendritic cell population is downsampled to 50, 100 and 200 cells to assess the effect of undersampling. Inferred networks are compared with reference networks obtained from STRING, non-cell type-specific ChiP-seq data and cell type-specific ChIP-seq data. Overall, ShareNet-augmented methods result in better agreement with reference networks as compared to the original methods</p>
          </caption>
          <graphic xlink:href="btab269f2" position="float"/>
        </fig>
        <p>Overall, these results suggest that ShareNet propagates information across cell types in a manner that benefits the discovery of both cell type-specific and non-specific regulatory associations. Furthermore, even though the remaining four cell types’ populations were not downsampled and were represented by larger numbers of cells, their respective networks also saw increases in accuracy in some cases while consistently avoiding notable deterioration in performance from sharing information with the downsampled dendritic cells (Supplementary Fig. S6).</p>
      </sec>
      <sec>
        <title>3.1.2 Tabula Muris and mouse blood lineage datasets</title>
        <p>To demonstrate ShareNet on a broad range of use cases for single-cell experiments, we tested on two other scRNA-seq datasets: (i) the Tabula Muris dataset containing an extensive collection of cell types isolated from 20 mouse organs and tissues (<xref rid="btab269-B32" ref-type="bibr">Schaum <italic toggle="yes">et al</italic>., 2018</xref>) and (ii) a mouse blood lineage dataset consisting of cells along a differentiation trajectory in early developmental stages that includes rare transitional states (<xref rid="btab269-B29" ref-type="bibr">Pijuan-Sala <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
        <p>Each cell in these datasets was previously assigned cell type annotations based on known markers and genes, and we sought to infer networks for the groups of cells corresponding to these annotations. We inferred networks for each cell type across the three different datasets using GENIE3, PIDC and Pearson correlation. Similar to the benchmarking analyses performed on the BEELINE dataset, we used a variety of reference networks to assess the accuracy of the inferred networks. We used the aforementioned STRING functional interaction network and the non-specific ChIP-seq networks in our analysis. In order to determine the accuracy of the inferred networks in detecting cell type-specific regulatory interactions, we also obtained ChIP-seq data from ChIP-Atlas (<xref rid="btab269-B28" ref-type="bibr">Oki <italic toggle="yes">et al.</italic>, 2018</xref>) for as many of the specific cell types identified in the Tabula Muris and mouse blood lineage datasets as were available.</p>
        <p>We then used these reference networks to compare the accuracy of the cell type-specific networks estimated using the network inference algorithms alone to that of their corresponding networks estimated with the inclusion of ShareNet. For the two datasets and across the three network inference algorithms (six settings in total), we observed that the networks inferred using ShareNet frequently outperformed the baseline networks inferred in the absence of sharing (<xref rid="btab269-F3" ref-type="fig">Fig. 3</xref>). The improvement of ShareNet was statistically significant in all of the settings (one-sided signed-rank test <italic toggle="yes">p</italic> &lt; <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>), with the sole exception of Pearson correlation on the mouse blood lineage dataset. However, we note that Pearson underperforms the other network inference algorithms without ShareNet on this dataset, registering AUPRC ratio values (performance relative to a random predictor) around 1 across the three reference networks, which likely limits the benefits of information sharing.</p>
        <fig position="float" id="btab269-F3">
          <label>Fig. 3.</label>
          <caption>
            <p>ShareNet improves network inference accuracy for (<bold>a</bold>) Tabula Muris and (<bold>b</bold>) mouse blood lineage single-cell RNA-seq datasets. We compared the accuracy of networks generated based on Pearson correlation, GENIE3 and PIDC with (<italic toggle="yes">y</italic>-axis) and without (<italic toggle="yes">x</italic>-axis) ShareNet. Different reference networks used for evaluation are marked by different colors. We plot the ratio of the AUPRC metric relative to the AUPRC associated with a random predictor to map the results from different reference networks onto a common scale. <italic toggle="yes">P</italic>-values indicate the statistical significance of ShareNet’s improvement over the original methods calculated using the one-sided Wilcoxon signed-rank test. ShareNet obtains significant improvement over the original methods in all but one comparison (Pearson on mouse blood lineage)</p>
          </caption>
          <graphic xlink:href="btab269f3" position="float"/>
        </fig>
        <p>For the Tabula Muris dataset, networks inferred using Pearson correlation with ShareNet produced the highest AUPRC ratios, with particularly striking performance gains with respect to the STRING reference, especially given the high AUPRC ratios already attained with Pearson correlation alone. For the mouse blood lineage, the combination of GENIE3 and ShareNet yielded the highest AUPRC ratios. The networks inferred using this method demonstrated consistent improvements in accuracy when compared to the STRING network and non-specific ChIP-seq networks in addition to increased AUPRC ratios for a majority of the cell type-specific ChIP-seq networks.</p>
      </sec>
      <sec>
        <title>3.1.3 Holdout likelihood analysis</title>
        <p>While quantifying agreement with reference networks provides a valuable means to assess the overall quality of predicted regulatory associations, this approach is understandably limited given the lack of comprehensive ground truth associations. As a complementary approach to evaluating the utility of ShareNet, we set out to compare the predictive power of learned networks with and without ShareNet on previously unseen samples. We follow the intuition that, if a model generalizes better to new data, the underlying regulatory associations in the model used for prediction are also more likely to be real associations. To this end, we leveraged BVS, an extended ShareNet model equipped with the ability to calculate the likelihood of observed gene expression levels (see Materials and methods). Note that the network inference methods considered in previous sections (Pearson correlation, GENIE3 and PIDC) cannot be used for this analysis due to their lack of a likelihood model.</p>
        <p>For the BEELINE, Tabula Muris and mouse blood lineage datasets, we trained BVS with and without ShareNet, while holding out 20% of cells in each cell type for test likelihood calculation. We observed that the average test log likelihood values from models trained with ShareNet are consistently greater than or approximately equal to those from the model trained without it in the BEELINE dataset (<xref rid="btab269-F4" ref-type="fig">Fig. 4a</xref>). Higher likelihoods indicate that the model is more effective at explaining gene expression patterns in the test data. The substantial improvement in average test log likelihood observed for mESC is noteworthy considering that mESC, at around 400 cells, is one of the most undersampled among the five cell types.</p>
        <fig position="float" id="btab269-F4">
          <label>Fig. 4.</label>
          <caption>
            <p>ShareNet improves holdout likelihood for (<bold>a</bold>) the BEELINE benchmark scRNA-seq dataset and (<bold>b</bold>) the Tabula Muris and mouse blood lineage scRNA-seq datasets. We compared the test log-likelihood for Bayesian variable selection (BVS) models trained with and without ShareNet. Each dot in a scatterplot (b) corresponds to a cell type in a dataset. Cell types represented by fewer than 200 cells were colored in red to mark undersampled cell types. ShareNet consistently led to higher likelihoods, most notably for cell types with limited sample sizes (mESC in (a) and red dots in (b))</p>
          </caption>
          <graphic xlink:href="btab269f4" position="float"/>
        </fig>
        <p>For the Tabula Muris and mouse blood lineage datasets, which feature more cell types and also a wider range of cell type population sizes, we also observed consistent improvement in the test likelihood across cell types for models trained with ShareNet compared to models trained without it (<xref rid="btab269-F4" ref-type="fig">Fig. 4b</xref>). Notably, for cell types that feature fewer cells, the improvements in the test log likelihood values were the most pronounced. These results suggest that the information transferred across cell types by ShareNet includes meaningful biological patterns that help with the predictive modelling of gene expression.</p>
        <p>We note that BVS may also be used to infer networks by ranking the edges according to the posterior inclusion probability <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mo>γ</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">e</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of a regulator gene <italic toggle="yes">i</italic> in the predictive model for a target gene <italic toggle="yes">j</italic> in cell type <italic toggle="yes">c</italic> (Materials and methods). While BVS trained with and without ShareNet yielded only modest network accuracy results compared to Pearson, GENIE3 and PIDC across all our benchmark datasets, sharing information using ShareNet resulted in consistent accuracy improvements in the Tabula Muris and mouse blood lineage datasets (Supplementary Fig. S7).</p>
      </sec>
    </sec>
    <sec>
      <title>3.2 ShareNet improves comparisons of cell type-specific regulatory associations across cell types and contexts</title>
      <p>ShareNet’s ability to identify cell type-specific regulatory associations with increased accuracy opens the door to a wide range of analyses exploring the unique wiring patterns that underlie cellular identity. We aimed to demonstrate this property on the Tabula Muris dataset, which consists of more than 100,000 cells from 20 organs and tissues (<xref rid="btab269-B32" ref-type="bibr">Schaum <italic toggle="yes">et al</italic>., 2018</xref>). From this vast collection of cells, we isolated all cell types that contained at least 100 cells, resulting in 52 cell types. We applied ShareNet on Pearson correlation networks, which achieved the best performance in our above analyses of this dataset. To understand what types of sharing patterns confer this improved accuracy, we examined the mixture components that are learned by our model and that define the manner in which cell types propagate information to one another. We identified the covariance matrix associated with the highest mixture weight in our model and clustered the cell types according to the corresponding correlation matrix. We observed that cell types that belong to the same broader cell type category based on annotations are clustered together (<xref rid="btab269-F5" ref-type="fig">Fig. 5a</xref>), suggesting that the sharing patterns that are automatically learned by ShareNet capture biologically meaningful similarities among the cell types.</p>
      <fig position="float" id="btab269-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>ShareNet learns meaningful sharing patterns across tissues and identifies regulatory associations specific to tissue-of-origin in the Tabula Muris dataset. (<bold>a</bold>) The learned cell type-cell type correlation matrix for the mixture component with the highest weight. Rows and columns are ordered by the output of hierarchical clustering and colored by the general cell type categories to which the 52 represented cell types belong. Learned sharing pattern is consistent with known cell type categories. (<bold>b</bold>) We compared the top 0.1%, 1% and 10% of edges in networks generated with and without ShareNet and identified edges uniquely associated with each. Enrichment <italic toggle="yes">q</italic> values were calculated for each biological process GO term using genes ranked by occurrence in the uniquely identified edges. Overall, only the edges unique to ShareNet display consistent GO enrichment. (<bold>c</bold>) We compared networks for MSCs isolated from different tissues and performed GO enrichment analysis on genes ranked by occurrence in the set of edges that were unique to each tissue-of-origin. Enriched GO terms are consistent with the corresponding tissues</p>
        </caption>
        <graphic xlink:href="btab269f5" position="float"/>
      </fig>
      <p>In addition to recapitulating known cell type categories, ShareNet enables us to perform more accurate comparisons of related cell types in different resident tissues. The Tabula Muris dataset includes mesenchymal stem cells (MSCs) isolated from the adipose tissue, trachea, limb muscle and diaphragm of mice. We sought to explore the specific differences in networks between these four types of MSCs with different tissues of origin. First, to assess the quality of MSCs networks produced by ShareNet, we examined the differences in the networks reconstructed with ShareNet and in its absence. Across a range of thresholds for retaining the top edges in each network, we identified the set of edges that are uniquely identified when using ShareNet relative to the baseline use case in its absence and vice versa. We then performed gene ontology (GO) enrichment analysis of genes ranked by their occurrence in these sets in an effort to characterize the signals either gained or removed as a result of information sharing (<xref rid="btab269-B11" ref-type="bibr">Eden <italic toggle="yes">et al.</italic>, 2009</xref>). Overall, we observed that the edges that are uniquely identified by ShareNet are consistently enriched for GO biological processes (<xref rid="btab269-F5" ref-type="fig">Fig. 5b</xref>), including terms associated with differentiation and development (Supplementary Fig. S8). In contrast, the edges that are uniquely identified without ShareNet tend to have considerably less functional enrichment, implying that ShareNet omitted edges that are more likely to be spurious rather than functional cell type-specific interactions.</p>
      <p>To compare the MSC networks produced by ShareNet across different tissues of origin, we took the top 1% of edges from each network and retained only the unique edges that were not included in the other MSC networks. GO enrichment analysis of these unique edges revealed significant enrichment for differentiation and development pathways that characterize the matching tissues from which each of the MSC populations were isolated (<xref rid="btab269-F5" ref-type="fig">Fig. 5c</xref>). Notably, three of the four tissue-specific pathway enrichments (fat, limb muscle, diaphragm) could not be detected when using the networks inferred without ShareNet. These results provide further evidence that our method not only reduces the relevance of potential false positive edges in gene regulatory networks but also retains important regulatory associations that uniquely define the specific cell types that they represent.</p>
    </sec>
    <sec>
      <title>3.3 ShareNet uncovers temporal regulatory changes during early mouse blood development</title>
      <p>To demonstrate the utility of ShareNet for studying the rewiring of regulatory associations in dynamic biological processes, we leveraged it to reconstruct cell type-specific networks in the early mouse blood lineage. We used the aforementioned mouse blood lineage dataset, which contains erythroid (Ery), haemato-endothelial (Hae), blood progenitor (BP), endothelial (EC) and mixed mesodermal (Mes) cells collected from whole mouse embryos between the E6.5 and E8.5 stages of early embryonic development (<xref rid="btab269-B29" ref-type="bibr">Pijuan-Sala <italic toggle="yes">et al.</italic>, 2019</xref>) (<xref rid="btab269-F6" ref-type="fig">Fig. 6a</xref>). We used GENIE3 with ShareNet to infer networks for these cell types, as this combination yielded the strongest performance for this dataset in our results above. A closer look at the sharing patterns automatically learned by ShareNet revealed that the captured relationships among cell types cohere with expert-annotated labels based on marker genes and their underlying trajectory (<xref rid="btab269-F6" ref-type="fig">Fig. 6b</xref>). Furthermore, different mixture components captured distinct sharing patterns, which merit further exploration.</p>
      <fig position="float" id="btab269-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>ShareNet enhances the detection of dynamic changes in regulatory associations along the early mouse blood differentiation trajectory. (<bold>a</bold>) Coarse graph abstraction of the mouse blood lineage produced by the PAGA algorithm (<xref rid="btab269-B39" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic>, 2019</xref>). Nodes correspond to specific cell types and are colored by the general cell type categories. Mes: mesodermal cells, Ery: erythrocytes, Mk: megakaryocytes, Hae: haemato-endothelial progenitors, EC: endothelial cells, My: myeloid cells. (<bold>b</bold>) Cell type–cell type sharing patterns learned by ShareNet for the mouse blood lineage dataset. The correlation matrices of the mixture components with the highest mixture weights are depicted. Rows and columns are ordered by hierarchical clustering and colored by general cell type categories to which the 24 represented cell types belong. Learned sharing patterns are consistent with known cell type categories, and different components capture distinct sharing patterns. (<bold>c</bold>) The number of stably added, stably removed and unstable edges along the differentiation path from mesodermal to erythroid cells, for varying proportions of top edges included in the networks. ShareNet enhances the discovery of persistent shifts while suppressing unstable associations that are likely due to noise. (<bold>d</bold>) Temporal trajectories of inferred edge scores along the path from mesodermal to erythroid cells for ShareNet-GENIE3 (top) and GENIE3 without ShareNet (bottom). Displayed set of curves represent a random subset of stably added edges in the ShareNet output. Each trajectory is min-max normalized. ShareNet reveals persistent activation of regulatory associations that are obscured without ShareNet.</p>
        </caption>
        <graphic xlink:href="btab269f6" position="float"/>
      </fig>
      <p>Using the inferred networks, we sought to investigate the regulatory rewiring patterns that define the part of the trajectory spanning the differentiation of Mes cells to Ery cells in the primitive wave of Ery cell formation (<xref rid="btab269-B29" ref-type="bibr">Pijuan-Sala <italic toggle="yes">et al.</italic>, 2019</xref>). To do so, we examined our inferred cell type-specific networks for the 10 cell types along the shortest path between Mes and Ery cells, based on the association graph constructed by the PAGA algorithm (<xref rid="btab269-B39" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
      <p>From this chain of networks, we aimed to identify regulatory interactions that are reliably activated or deactivated during the course of differentiation as a means of detecting persistent shifts in regulatory dynamics that confer cellular identity. We first searched for <italic toggle="yes">stably added</italic> edges in networks that are absent in the earliest Mes cells but emerge in an intermediate cell type along the trajectory, upon which they are stably maintained across the successive cell types until the terminal Ery cells. Across a range of percentage values that determine the proportion of putative edges to retain in each network, we found that the number of edges that meet this criterion is consistently higher in the networks inferred using ShareNet and GENIE3 compared to GENIE3 on its own (<xref rid="btab269-F6" ref-type="fig">Fig. 6c</xref>). In addition, the underlying edge scores associated with this set of stably added edges demonstrated a clear increasing trend along the differentiation path, consistent with the fact that these edges are of increasing relevance to cells as they approach the erythroid lineage (<xref rid="btab269-F6" ref-type="fig">Fig. 6d</xref>). On the contrary, the edge scores for the same set of edges in the GENIE3 networks do not show this trend and change erratically from cell type to cell type. In searching for edges that are <italic toggle="yes">stably removed</italic> across the differentiation trajectory, the set of networks inferred using ShareNet also presented notably more of these edges (<xref rid="btab269-F6" ref-type="fig">Fig. 6c</xref>). Lastly, edges that are <italic toggle="yes">unstable</italic>, which we define to be those that change activity status more than four times over the course of the path of ten cell types, are more highly represented in the set of networks inferred in the absence of ShareNet. Given the limited plausibility of these unstable associations, we believe this observation reflects the higher noise levels in the underpowered GENIE3 networks; ShareNet is noticeably less affected by this potential artifact.</p>
      <p>Furthermore, GO enrichment analysis on genes ranked by their occurrence in the set of stably added edges revealed enrichment for erythrocyte development (GO: 0048821, FDR <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mi>q</mml:mi><mml:mo>=</mml:mo><mml:mn>1.53</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>), while a similar analysis performed on the GENIE3 networks without ShareNet revealed no such enrichment. In exploring the genes that are most implicated in these stably added edges, we found that <italic toggle="yes">Tal1</italic>, <italic toggle="yes">Fam210b</italic> and <italic toggle="yes">Vgll4</italic>, three genes are known to be implicated in erythroid differentiation, are among the top 10 most frequently occurring genes. <italic toggle="yes">Tal1</italic> is an essential transcription factor for erythropoiesis (<xref rid="btab269-B16" ref-type="bibr">Hall <italic toggle="yes">et al.</italic>, 2003</xref>; <xref rid="btab269-B40" ref-type="bibr">Wu <italic toggle="yes">et al.</italic>, 2014</xref>) and is involved in the activation and repression of a number of erythroid-specific target genes (<xref rid="btab269-B25" ref-type="bibr">Lausen <italic toggle="yes">et al.</italic>, 2010</xref>). Similarly, <italic toggle="yes">Fam210b</italic> and <italic toggle="yes">Vgll4</italic> are critical in regulating erythroid heme synthesis in terminal erythropoiesis (<xref rid="btab269-B38" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab269-B42" ref-type="bibr">Yien <italic toggle="yes">et al.</italic>, 2018</xref>). These results suggest that sharing information across cell types enhances our ability to detect meaningful patterns of network rewiring that are informative of the dynamics governing transitions in cellular identity.</p>
    </sec>
    <sec>
      <title>3.4 Runtime and memory usage</title>
      <p>The BEELINE, Tabula muris and mouse blood lineage datasets spanned a broad range of dataset sizes. The average total runtime for ShareNet was 2 min, 116 min and 411 min for the BEELINE, mouse blood lineage and Tabula muris datasets, respectively. Peak memory usage was approximately 664 MB, 11.9 GB and 111 GB for the same three datasets. All methods were run on a 2.40 GHz Intel Xeon E5-2695v2 central processing unit. A more in-depth discussion on the dataset factors affecting runtime and memory usage as well as future optimization strategies for reducing the computational burden can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Materials</xref>.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion and future work</title>
    <p>The growing use of scRNA-seq data to characterize the diversity of cell types and cell states within populations of cells has led to the discovery of many new cell types. An important next step in comprehensively characterizing these cell types beyond their gene expression signatures is the elucidation of the underlying gene regulatory network structures that drive their unique expression profiles. In order to handle the issue of small samples sizes for cell types that are rare and underrepresented, we have presented ShareNet as a framework for automatically leveraging the overlap in network structures across similar cell types to improve estimations of cell type-specific networks. We have demonstrated that propagating information across cell types increases the accuracy of inferred networks in a range of datasets and experimental settings. As a result, we have been able to employ ShareNet to more finely characterize individual cell types from scRNA-seq datasets with respect to gene regulatory networks instead of just gene expression.</p>
    <p>Our work drew inspiration from previous methods that leveraged joint inference of multiple related tasks to increase power for tasks that typically would be underpowered on their own. One domain in which such methods have been developed is statistical genetics. For example, Mash (<xref rid="btab269-B36" ref-type="bibr">Urbut <italic toggle="yes">et al.</italic>, 2019</xref>) is a powerful method for jointly estimating effect sizes for genetic associations across multiple conditions. Similar to our approach, Mash allows for a broad range of patterns of correlation among conditions, albeit restricted to a weighted average of pre-defined sharing patterns. For the task of inferring gene regulatory networks, several approaches have been developed for jointly estimating multiple networks, notably for bulk RNA-seq analysis, by linking networks from different species (<xref rid="btab269-B7" ref-type="bibr">Castro <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab269-B24" ref-type="bibr">Koch <italic toggle="yes">et al.</italic>, 2017</xref>) or different points of time along a linear biological process (<xref rid="btab269-B1" ref-type="bibr">Ahmed and Xing, 2009</xref>; <xref rid="btab269-B34" ref-type="bibr">Song <italic toggle="yes">et al.</italic>, 2009</xref>). For each of these methods, though, the manner in which information is transferred between networks must be pre-specified and/or is highly restrictive. With single-cell datasets, the relationship between cell types is often unknown <italic toggle="yes">a priori</italic>, as many cell types are being detected for the first time. Furthermore, the diversity of cell types that appear in single-cell datasets presents a need to account for a wide range of possible sharing patterns. ShareNet addresses these idiosyncrasies of single-cell datasets, building upon the insights from the aforementioned related works.</p>
    <p>Recent advancements in single-cell technologies have been made to simultaneously measure different biological aspects of individuals cells, including spatial gene expression, chromatin accessibility, and morphology (<xref rid="btab269-B44" ref-type="bibr">Zhu <italic toggle="yes">et al.</italic>, 2020</xref>). The integration of these multi-modal datasets (<xref rid="btab269-B33" ref-type="bibr">Singh <italic toggle="yes">et al.</italic>, 2020</xref>) in a manner similar to ShareNet would serve as an exciting next step for characterizing the intricate relationship between gene regulatory relationships and cellular identity in greater detail.</p>
    <p><italic toggle="yes">Data Availability</italic>: All data used in the study are publicly available. The BEELINE, Tabula muris, and mouse blood lineage datasets can be accessed at the following URLs, respectively: <ext-link xlink:href="https://zenodo.org/record/3701939#.YJIHKy1h1bU" ext-link-type="uri">https://zenodo.org/record/3701939#.YJIHKy1h1bU</ext-link>, https://tabula-muris.ds.czbiohub.org, and <ext-link xlink:href="https://github.com/MarioniLab/EmbryoTimecourse2018" ext-link-type="uri">https://github.com/MarioniLab/EmbryoTimecourse2018</ext-link>.</p>
    <p><italic toggle="yes">Financial Support</italic>: A.P.W. and B.B. are supported by NIH U01 CA250554 (to B.B.). H.C. is supported by Eric and Wendy Schmidt through the Schmidt Fellows Program at the Broad Institute. J.P. is supported by the NSF CAREER Award (1652815). </p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btab269_Supplementary_Data</label>
      <media xlink:href="btab269_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab269-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ahmed</surname><given-names>A.</given-names></string-name>, <string-name><surname>Xing</surname><given-names>E.P.</given-names></string-name></person-group> (<year>2009</year>) <article-title>Recovering time-varying networks of dependencies in social and biological studies</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>106</volume>, <fpage>11878</fpage>–<lpage>11883</lpage>.<pub-id pub-id-type="pmid">19570995</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Angerer</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Single cells make big data: new challenges and opportunities in transcriptomics</article-title>. <source>Curr. Opin. Syst. Biol</source>., <volume>4</volume>, <fpage>85</fpage>–<lpage>91</lpage>.</mixed-citation>
    </ref>
    <ref id="btab269-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bjorklund</surname><given-names>A.K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>The heterogeneity of human CD127+ innate lymphoid cells revealed by single-cell RNA sequencing</article-title>. <source>Nat. Immunol</source>., <volume>17</volume>, <fpage>451</fpage>–<lpage>460</lpage>.<pub-id pub-id-type="pmid">26878113</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blei</surname><given-names>D.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Variational inference: a review for statisticians</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>112</volume>, <fpage>859</fpage>–<lpage>877</lpage>.</mixed-citation>
    </ref>
    <ref id="btab269-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buettner</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title>. <source>Nat. Biotechnol</source>., <volume>33</volume>, <fpage>155</fpage>–<lpage>160</lpage>.<pub-id pub-id-type="pmid">25599176</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carbonetto</surname><given-names>P.</given-names></string-name>, <string-name><surname>Stephens</surname><given-names>M.</given-names></string-name></person-group> (<year>2012</year>) <article-title>Scalable variational inference for Bayesian variable selection in regression, and its accuracy in genetic association studies</article-title>. <source>Bayesian Anal</source>., <volume>7</volume>, <fpage>73</fpage>–<lpage>108</lpage>.</mixed-citation>
    </ref>
    <ref id="btab269-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Castro</surname><given-names>D.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Multi-study inference of regulatory networks for more accurate models of gene regulation</article-title>. <source>PLoS Comput. Biol</source>., <volume>15</volume>, <fpage>e1006591</fpage>.<pub-id pub-id-type="pmid">30677040</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chan</surname><given-names>T.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Gene regulatory network inference from single-cell data using multivariate information measures</article-title>. <source>Cell Syst</source>., <volume>5</volume>, <fpage>251</fpage>–<lpage>267.e3</lpage>.<pub-id pub-id-type="pmid">28957658</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Choi</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Bayesian model selection reveals biological origins of zero inflation in single-cell transcriptomics</article-title>. <source>Genome Biol</source>., <volume>21</volume>, <fpage>183</fpage>.<pub-id pub-id-type="pmid">32718323</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DeMeo</surname><given-names>B.</given-names></string-name>, <string-name><surname>Berger</surname><given-names>B.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Hopper: a mathematically optimal algorithm for sketching biological data</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>i236</fpage>–<lpage>i241</lpage>.<pub-id pub-id-type="pmid">32657375</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eden</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>GOrilla: a tool for discovery and visualization of enriched GO terms in ranked gene lists</article-title>. <source>BMC Bioinformatics</source>, <volume>10</volume>, <fpage>48</fpage>.<pub-id pub-id-type="pmid">19192299</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B12">
      <mixed-citation publication-type="journal">ENCODE Project Consortium. (<year>2012</year>) <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source>, <volume>489</volume>, <fpage>57</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">22955616</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Garcia-Alonso</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Benchmark and integration of resources for the estimation of human transcription factor activities</article-title>. <source>Genome Res</source>., <volume>29</volume>, <fpage>1363</fpage>–<lpage>1375</lpage>.<pub-id pub-id-type="pmid">31340985</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gawad</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Single-cell genome sequencing: current state of the science</article-title>. <source>Nat. Rev. Genet</source>., <volume>17</volume>, <fpage>175</fpage>–<lpage>188</lpage>.<pub-id pub-id-type="pmid">26806412</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grün</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>. <source>Nature</source>, <volume>525</volume>, <fpage>251</fpage>–<lpage>255</lpage>.<pub-id pub-id-type="pmid">26287467</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hall</surname><given-names>M.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2003</year>) <article-title>The critical regulator of embryonic hematopoiesis, SCL, is vital in the adult for megakaryopoiesis, erythropoiesis, and lineage choice in CFU-S12</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>100</volume>, <fpage>992</fpage>–<lpage>997</lpage>.<pub-id pub-id-type="pmid">12552125</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>TRRUST v2: an expanded reference database of human and mouse transcriptional regulatory interactions</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>D380</fpage>–<lpage>D386</lpage>.<pub-id pub-id-type="pmid">29087512</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hie</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019a</year>) <article-title>Efficient integration of heterogeneous single-cell transcriptomes using Scanorama</article-title>. <source>Nat. Biotechnol</source>., <volume>37</volume>, <fpage>685</fpage>–<lpage>691</lpage>.<pub-id pub-id-type="pmid">31061482</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hie</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019b</year>) <article-title>Geometric sketching compactly summarizes the single-cell transcriptomic landscape</article-title>. <source>Cell Syst</source>., <volume>8</volume>, <fpage>483</fpage>–<lpage>493.e7</lpage>.<pub-id pub-id-type="pmid">31176620</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hie</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Computational methods for single-cell RNA sequencing</article-title>. <source>Ann. Rev. Biomed. Data Sci</source>., <volume>3</volume>, <fpage>339</fpage>–<lpage>364</lpage>.</mixed-citation>
    </ref>
    <ref id="btab269-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>AnimalTFDB 3.0: a comprehensive resource for annotation and prediction of animal transcription factors</article-title>. <source>Nucleic Acids Res</source>., <volume>47</volume>, <fpage>D33</fpage>–<lpage>D38</lpage>.<pub-id pub-id-type="pmid">30204897</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huynh-Thu</surname><given-names>V.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>Inferring regulatory networks from expression data using tree-based methods</article-title>. <source>PLoS One</source>, <volume>5</volume>, <fpage>e12776</fpage>.<pub-id pub-id-type="pmid">20927193</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Giniclust: detecting rare cell types from single-cell gene expression data with Gini index</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>144</fpage>.<pub-id pub-id-type="pmid">27368803</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Koch</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Inference and evolutionary analysis of genome-scale regulatory networks in large phylogenies</article-title>. <source>Cell Syst</source>., <volume>4</volume>, <fpage>543</fpage>–<lpage>558.e8</lpage>.<pub-id pub-id-type="pmid">28544882</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lausen</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>Targets of the Tal1 transcription factor in erythrocytes: e2 ubiquitin conjugase regulation by Tal1</article-title>. <source>J. Biol. Chem</source>., <volume>285</volume>, <fpage>5338</fpage>–<lpage>5346</lpage>.<pub-id pub-id-type="pmid">20028976</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Z.P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>RegNetwork: an integrated database of transcriptional and post-transcriptional regulatory networks in human and mouse</article-title>. <source>Database</source>, <volume>2015</volume>, <fpage>bav095</fpage>.<pub-id pub-id-type="pmid">26424082</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mitchell</surname><given-names>T.J.</given-names></string-name>, <string-name><surname>Beauchamp</surname><given-names>J.J.</given-names></string-name></person-group> (<year>1988</year>) <article-title>Bayesian variable selection in linear regression</article-title>. <source>J. Am. Stat. Assoc</source>., <volume>83</volume>, <fpage>1023</fpage>–<lpage>1032</lpage>.</mixed-citation>
    </ref>
    <ref id="btab269-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oki</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>ChIP-Atlas: a data-mining suite powered by full integration of public ChIP-seq data</article-title>. <source>EMBO Rep</source>., <volume>19</volume>, <fpage>e46255</fpage>.<pub-id pub-id-type="pmid">30413482</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pijuan-Sala</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>A single-cell molecular map of mouse gastrulation and early organogenesis</article-title>. <source>Nature</source>, <volume>566</volume>, <fpage>490</fpage>–<lpage>495</lpage>.<pub-id pub-id-type="pmid">30787436</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pratapa</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Benchmarking algorithms for gene regulatory network inference from single-cell transcriptomic data</article-title>. <source>Nat. Methods</source>, <volume>17</volume>, <fpage>147</fpage>–<lpage>154</lpage>.<pub-id pub-id-type="pmid">31907445</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Satija</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Spatial reconstruction of single-cell gene expression data</article-title>. <source>Nat. Biotechnol</source>., <volume>33</volume>, <fpage>495</fpage>–<lpage>502</lpage>.<pub-id pub-id-type="pmid">25867923</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schaum</surname><given-names>N.</given-names></string-name></person-group>  <etal>et al</etal>; The Tabula Muris Consortium, Overall Coordination. (<year>2018</year>) <article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title>. <source>Nature</source>, <volume>562</volume>, <fpage>367</fpage>–<lpage>372</lpage>.<pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B33">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Singh</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) Schema: metric learning enables interpretable synthesis of heterogeneous single-cell modalities <italic toggle="yes"><italic toggle="yes">Genome Biol</italic>.</italic>, 22, 131.</mixed-citation>
    </ref>
    <ref id="btab269-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>KELLER: estimating time-varying interactions between genes</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>i128</fpage>–<lpage>i136</lpage>.<pub-id pub-id-type="pmid">19477978</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Szklarczyk</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>STRING v11: protein–protein association networks with increased coverage, supporting functional discovery in genome-wide experimental datasets</article-title>. <source>Nucleic Acids Res</source>., <volume>47</volume>, <fpage>607</fpage>–<lpage>613</lpage>.</mixed-citation>
    </ref>
    <ref id="btab269-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Urbut</surname><given-names>S.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Flexible statistical methods for estimating and testing effects in genomic studies with multiple conditions</article-title>. <source>Nat. Genet</source>., <volume>51</volume>, <fpage>187</fpage>–<lpage>195</lpage>.<pub-id pub-id-type="pmid">30478440</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Villani</surname><given-names>A.-C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors</article-title>. <source>Science</source>, <volume>356</volume>, <fpage>eaah4573</fpage>.<pub-id pub-id-type="pmid">28428369</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>The NOTCH1-dependent HIF1/VGLL4/IRF2BP2 oxygen sensing pathway triggers erythropoiesis terminal differentiation</article-title>. <source>Redox Biol</source>., <volume>28</volume>, <fpage>101313</fpage>.<pub-id pub-id-type="pmid">31539803</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>F.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>PAGA: graph abstraction reconciles clustering with trajectory inference through a topology preserving map of single cells</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>59</fpage>.<pub-id pub-id-type="pmid">30890159</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Dynamic shifts in occupancy by TAL1 are guided by GATA factors and drive large-scale reprogramming of gene expression during hematopoiesis</article-title>. <source>Genome Res</source>., <volume>24</volume>, <fpage>1945</fpage>–<lpage>1962</lpage>.<pub-id pub-id-type="pmid">25319994</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Construction and validation of a regulatory network for pluripotency and self-renewal of mouse embryonic stem cells</article-title>. <source>PLoS Comput. Biol</source>., <volume>10</volume>, <fpage>e1003777</fpage>.<pub-id pub-id-type="pmid">25122140</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yien</surname><given-names>Y.Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>FAM210B is an erythropoietin target and regulates erythroid heme synthesis by controlling mitochondrial iron import and ferrochelatase activity</article-title>. <source>J. Biol. Chem</source>., <volume>293</volume>, <fpage>19797</fpage>–<lpage>19811</lpage>.<pub-id pub-id-type="pmid">30366982</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>Model-based Analysis of ChIP-Seq (MACS)</article-title>. <source>Genome Biol</source>., <volume>9</volume>, <fpage>R137</fpage>.<pub-id pub-id-type="pmid">18798982</pub-id></mixed-citation>
    </ref>
    <ref id="btab269-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Single-cell multimodal omics: the power of many</article-title>. <source>Nat. Methods</source>, <volume>17</volume>, <fpage>11</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">31907462</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
