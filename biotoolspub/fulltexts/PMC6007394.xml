<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6007394</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/giy059</article-id>
    <article-id pub-id-type="publisher-id">giy059</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>zUMIs - A fast and flexible pipeline to process RNA sequencing data with UMIs</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4826-1651</contrib-id>
        <name>
          <surname>Parekh</surname>
          <given-names>Swati</given-names>
        </name>
        <!--<email>sparekh@age.mpg.de</email>-->
        <xref ref-type="aff" rid="aff1"/>
        <xref ref-type="corresp" rid="cor2"/>
        <xref ref-type="author-notes" rid="afn1"/>
        <xref ref-type="author-notes" rid="afn2"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ziegenhain</surname>
          <given-names>Christoph</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
        <xref ref-type="author-notes" rid="afn1"/>
        <xref ref-type="author-notes" rid="afn3"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Vieth</surname>
          <given-names>Beate</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Enard</surname>
          <given-names>Wolfgang</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-0588-1313</contrib-id>
        <name>
          <surname>Hellmann</surname>
          <given-names>Ines</given-names>
        </name>
        <!--<email>hellmann@bio.lmu.de</email>-->
        <xref ref-type="aff" rid="aff1"/>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
    </contrib-group>
    <aff id="aff1">Anthropology and Human Genomics, Department of Biology II, Ludwig-Maximilians University, Grosshaderner Str. 2, 82152 Martinsried, Germany</aff>
    <author-notes>
      <corresp id="cor1"><bold>Correspondence address</bold>. Ines Hellmann. E-mail: <email>hellmann@bio.lmu.de</email></corresp>
      <corresp id="cor2"><bold>Correspondence address</bold>. Swati Parekh. E-mail: <email>sparekh@age.mpg.de</email></corresp>
      <fn id="afn1">
        <p>Contributed equally.</p>
      </fn>
      <fn id="afn2">
        <p>Present address: Max Planck Institute for Biology of Ageing, 50931 Cologne, Germany.</p>
      </fn>
      <fn id="afn3">
        <p>Present address: Department of Cell &amp; Molecular Biology, Karolinska Institutet, 171 77 Stockholm, Sweden.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-05-26">
      <day>26</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>5</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>7</volume>
    <issue>6</issue>
    <elocation-id>giy059</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>10</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>16</day>
        <month>3</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>15</day>
        <month>5</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="giy059.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="abs1">
        <title>Background</title>
        <p>Single-cell RNA-sequencing (scRNA-seq) experiments typically analyze hundreds or thousands of cells after amplification of the cDNA. The high throughput is made possible by the early introduction of sample-specific bar codes (BCs), and the amplification bias is alleviated by unique molecular identifiers (UMIs). Thus, the ideal analysis pipeline for scRNA-seq data needs to efficiently tabulate reads according to both BC and UMI.</p>
      </sec>
      <sec id="abs2">
        <title>Findings</title>
        <p><italic>zUMIs</italic> is a pipeline that can handle both known and random BCs and also efficiently collapse UMIs, either just for exon mapping reads or for both exon and intron mapping reads. If BC annotation is missing, <italic>zUMIs</italic> can accurately detect intact cells from the distribution of sequencing reads. Another unique feature of <italic>zUMIs</italic> is the adaptive downsampling function that facilitates dealing with hugely varying library sizes but also allows the user to evaluate whether the library has been sequenced to saturation. To illustrate the utility of <italic>zUMIs</italic>, we analyzed a single-nucleus RNA-seq dataset and show that more than 35% of all reads map to introns. Also, we show that these intronic reads are informative about expression levels, significantly increasing the number of detected genes and improving the cluster resolution.</p>
      </sec>
      <sec id="abs3">
        <title>Conclusions</title>
        <p><italic>zUMIs</italic> flexibility makes if possible to accommodate data generated with any of the major scRNA-seq protocols that use BCs and UMIs and is the most feature-rich, fast, and user-friendly pipeline to process such scRNA-seq data.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>
        <italic>single-cell RNA-sequencing</italic>
      </kwd>
      <kwd>
        <italic>digital gene expression</italic>
      </kwd>
      <kwd>
        <italic>unique molecular identifiers</italic>
      </kwd>
      <kwd>
        <italic>pipeline</italic>
      </kwd>
    </kwd-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="sec1">
    <title>Introduction</title>
    <p>The recent development of increasingly sensitive protocols allows for the generation of RNA-sequencing (RNA-seq) libraries of single cells [<xref rid="bib1" ref-type="bibr">1</xref>]. The throughput of such single-cell RNA-seq (scRNA-seq) protocols is rapidly increasing, enabling the profiling of tens of thousands of cells [<xref rid="bib2" ref-type="bibr">2</xref>, <xref rid="bib3" ref-type="bibr">3</xref>] and opening exciting possibilities to analyze cellular identities [<xref rid="bib4" ref-type="bibr">4</xref>, <xref rid="bib5" ref-type="bibr">5</xref>]. As the required amplification from such small starting amounts introduces substantial amounts of noise [<xref rid="bib6" ref-type="bibr">6</xref>], many scRNA-seq protocols incorporate unique molecular identifiers (UMIs) to label individual cDNA molecules with a random nucleotide sequence before amplification [<xref rid="bib7" ref-type="bibr">7</xref>]. This enables the computational removal of amplification noise and thus increases the power to detect expression differences between cells [<xref rid="bib8" ref-type="bibr">8</xref>, <xref rid="bib9" ref-type="bibr">9</xref>]. To increase the throughput, many protocols also incorporate sample-specific bar codes (BCs) to label all cDNA molecules of a single cell with a nucleotide sequence before library generation [<xref rid="bib10" ref-type="bibr">10</xref>]. This allows for early pooling, which further decreases amplification noise [<xref rid="bib6" ref-type="bibr">6</xref>]. Additionally, for cell types such as primary neurons, it has been proven to be more feasible to isolate RNA from single nuclei rather than whole cells [<xref rid="bib11" ref-type="bibr">11</xref>, <xref rid="bib12" ref-type="bibr">12</xref>]. This decreases mRNA amounts further so that it has been suggested to count intron mapping reads originating from nascent RNAs as part of single-cell expression profiles [<xref rid="bib11" ref-type="bibr">11</xref>]. However, the few bioinformatic tools that process RNA-seq data with UMIs and BCs have limitations (Table <xref ref-type="table" rid="tbl1">1</xref>). For example, the Drop-seq-tools is not an open source [<xref rid="bib13" ref-type="bibr">13</xref>]. While Cell Ranger is open, it is exceedingly difficult to adapt the code to new or unknown sample BCs and other library types. Other tools are specifically designed to work with one mapping algorithm and focus mainly on transcriptome references [<xref rid="bib14" ref-type="bibr">14</xref>, <xref rid="bib15" ref-type="bibr">15</xref>]. Furthermore, the only other UMI-RNA-seq pipeline providing the utility to also consider intron mapping reads, dropEst [<xref rid="bib16" ref-type="bibr">16</xref>], is only applicable to droplet-based protocols. Here, we present <italic>zUMIs</italic>, a fast and flexible pipeline that overcomes these limitations.</p>
    <table-wrap id="tbl1" orientation="portrait" position="float">
      <label>Table 1:</label>
      <caption>
        <p>Features of available UMI pipelines for the quantification of gene expression data.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <th align="left" rowspan="1" colspan="1">Name</th>
            <th align="center" rowspan="1" colspan="1">Reference</th>
            <th align="center" rowspan="1" colspan="1">Open source</th>
            <th align="center" rowspan="1" colspan="1">Quality filter</th>
            <th align="center" rowspan="1" colspan="1">UMI collapsing</th>
            <th align="center" rowspan="1" colspan="1">Mapper</th>
            <th align="center" rowspan="1" colspan="1">BC detection</th>
            <th align="center" rowspan="1" colspan="1">Intron</th>
            <th align="center" rowspan="1" colspan="1">Down-sampling</th>
            <th align="center" rowspan="1" colspan="1">Compatible UMI library protocols</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td rowspan="1" colspan="1">Cell Ranger</td>
            <td rowspan="1" colspan="1">[<xref rid="bib2" ref-type="bibr">2</xref>]</td>
            <td rowspan="1" colspan="1">yes</td>
            <td rowspan="1" colspan="1">BC+UMI</td>
            <td rowspan="1" colspan="1">Hamming distance</td>
            <td rowspan="1" colspan="1">STAR</td>
            <td rowspan="1" colspan="1">A</td>
            <td rowspan="1" colspan="1">no</td>
            <td rowspan="1" colspan="1">yes</td>
            <td rowspan="1" colspan="1">[<xref rid="bib2" ref-type="bibr">2</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">CEL-seq</td>
            <td rowspan="1" colspan="1">[<xref rid="bib15" ref-type="bibr">15</xref>]</td>
            <td rowspan="1" colspan="1">yes</td>
            <td rowspan="1" colspan="1">BC+UMI</td>
            <td rowspan="1" colspan="1">Identity only</td>
            <td rowspan="1" colspan="1">bowtie2</td>
            <td rowspan="1" colspan="1">WL</td>
            <td rowspan="1" colspan="1">no</td>
            <td rowspan="1" colspan="1">no</td>
            <td rowspan="1" colspan="1">[<xref rid="bib15" ref-type="bibr">15</xref>, <xref rid="bib46" ref-type="bibr">46</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">dropEst</td>
            <td rowspan="1" colspan="1">[<xref rid="bib16" ref-type="bibr">16</xref>]</td>
            <td rowspan="1" colspan="1">yes</td>
            <td rowspan="1" colspan="1">BC</td>
            <td rowspan="1" colspan="1">Frequency-based</td>
            <td rowspan="1" colspan="1">TopHat2 or Kallisto</td>
            <td rowspan="1" colspan="1">WL,top-n,EM</td>
            <td rowspan="1" colspan="1">yes</td>
            <td rowspan="1" colspan="1">no</td>
            <td rowspan="1" colspan="1">[<xref rid="bib2" ref-type="bibr">2</xref>, <xref rid="bib13" ref-type="bibr">13</xref>, <xref rid="bib19" ref-type="bibr">19</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">Drop-seq-tools</td>
            <td rowspan="1" colspan="1">[<xref rid="bib13" ref-type="bibr">13</xref>]</td>
            <td rowspan="1" colspan="1">no</td>
            <td rowspan="1" colspan="1">BC+UMI</td>
            <td rowspan="1" colspan="1">Hamming distance</td>
            <td rowspan="1" colspan="1">STAR</td>
            <td rowspan="1" colspan="1">WL,top-n</td>
            <td rowspan="1" colspan="1">no</td>
            <td rowspan="1" colspan="1">no</td>
            <td rowspan="1" colspan="1">[<xref rid="bib13" ref-type="bibr">13</xref>, <xref rid="bib15" ref-type="bibr">15</xref>, <xref rid="bib17" ref-type="bibr">17</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">scPipe</td>
            <td rowspan="1" colspan="1">[<xref rid="bib47" ref-type="bibr">47</xref>]</td>
            <td rowspan="1" colspan="1">yes</td>
            <td rowspan="1" colspan="1">BC+UMI</td>
            <td rowspan="1" colspan="1">Hamming distance</td>
            <td rowspan="1" colspan="1">subread</td>
            <td rowspan="1" colspan="1">WL,top-n</td>
            <td rowspan="1" colspan="1">no</td>
            <td rowspan="1" colspan="1">no</td>
            <td rowspan="1" colspan="1">[<xref rid="bib13" ref-type="bibr">13</xref>, <xref rid="bib17" ref-type="bibr">17</xref>, <xref rid="bib18" ref-type="bibr">18</xref>, <xref rid="bib46" ref-type="bibr">46</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">umis</td>
            <td rowspan="1" colspan="1">[<xref rid="bib14" ref-type="bibr">14</xref>]</td>
            <td rowspan="1" colspan="1">yes</td>
            <td rowspan="1" colspan="1">BC</td>
            <td rowspan="1" colspan="1">Frequency-based</td>
            <td rowspan="1" colspan="1">Kallisto</td>
            <td rowspan="1" colspan="1">WL,top-n,EM</td>
            <td rowspan="1" colspan="1">no</td>
            <td rowspan="1" colspan="1">no</td>
            <td rowspan="1" colspan="1">[<xref rid="bib2" ref-type="bibr">2</xref>, <xref rid="bib13" ref-type="bibr">13</xref>, <xref rid="bib17" ref-type="bibr">17–19</xref>, <xref rid="bib46" ref-type="bibr">46</xref>, <xref rid="bib48" ref-type="bibr">48</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">UMI-tools</td>
            <td rowspan="1" colspan="1">[<xref rid="bib25" ref-type="bibr">25</xref>]</td>
            <td rowspan="1" colspan="1">yes</td>
            <td rowspan="1" colspan="1">BC+UMI</td>
            <td rowspan="1" colspan="1">Network-based</td>
            <td rowspan="1" colspan="1">BWA</td>
            <td rowspan="1" colspan="1">WL</td>
            <td rowspan="1" colspan="1">no</td>
            <td rowspan="1" colspan="1">no</td>
            <td rowspan="1" colspan="1">[<xref rid="bib17" ref-type="bibr">17</xref>, <xref rid="bib19" ref-type="bibr">19</xref>]</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1">zUMIs</td>
            <td rowspan="1" colspan="1">This work</td>
            <td rowspan="1" colspan="1">yes</td>
            <td rowspan="1" colspan="1">BC+UMI</td>
            <td rowspan="1" colspan="1">Hamming distance</td>
            <td rowspan="1" colspan="1">STAR</td>
            <td rowspan="1" colspan="1">A,WL,top-n</td>
            <td rowspan="1" colspan="1">yes</td>
            <td rowspan="1" colspan="1">yes</td>
            <td rowspan="1" colspan="1">[<xref rid="bib2" ref-type="bibr">2</xref>, <xref rid="bib3" ref-type="bibr">3</xref>, <xref rid="bib12" ref-type="bibr">12</xref>, <xref rid="bib13" ref-type="bibr">13</xref>, <xref rid="bib15" ref-type="bibr">15</xref>, <xref rid="bib17" ref-type="bibr">17</xref>, <xref rid="bib18" ref-type="bibr">18</xref>, <xref rid="bib21" ref-type="bibr">21</xref>, <xref rid="bib46" ref-type="bibr">46</xref>, <xref rid="bib48" ref-type="bibr">48</xref>]</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <fn id="tbl1fn1">
          <p>We consider whether the pipeline is open source, has sequence quality filters for cell BCs and UMIs, mappers, UMI-collapsing options, options for BC detection (A, automatically infer intact BCs; WL, extract only the given list of known BCs; top-n, order BCs according the number of reads and keep the top n BCs; EM, merge BCs with given edit distance), whether it can count intron mapping reads, whether it offers a utility to make varying library sizes more comparable via downsampling, and finally with which RNA-seq library preparation protocols is it compatible</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec id="sec2">
    <title>Findings</title>
    <p><italic>zUMIs</italic> is a pipeline to process RNA-seq data that were multiplexed using cell BCs and also contain UMIs. Read-pairs are filtered to remove reads with low-quality BCs or UMIs based on sequence and then mapped to a reference genome (Fig.<xref ref-type="fig" rid="fig1">1</xref>). Next, <italic>zUMIs</italic> generates UMI and read count tables for exon and exon+intron counting. We reason that very low input material such as from single nuclei sequencing might profit from including reads that potentially originate from nascent RNAs. Another unique feature of <italic>zUMIs</italic> is that it allows for downsampling of reads before collapsing UMIs, thus enabling the user to assess whether a library was sequenced to saturation or whether deeper sequencing is necessary to depict the full mRNA complexity. Furthermore, <italic>zUMIs</italic> is flexible with respect to the length and sequences of the BCs and UMIs, supporting protocols that have both sequences in one read [<xref rid="bib2" ref-type="bibr">2</xref>, <xref rid="bib3" ref-type="bibr">3</xref>, <xref rid="bib12" ref-type="bibr">12</xref>, <xref rid="bib13" ref-type="bibr">13</xref>, <xref rid="bib15" ref-type="bibr">15</xref>, <xref rid="bib17" ref-type="bibr">17</xref>, <xref rid="bib18" ref-type="bibr">18</xref>] as well as protocols that provide UMI and BC in separate reads [<xref rid="bib19" ref-type="bibr">19–21</xref>]. This makes <italic>zUMIs</italic> the only tool that is easily compatible with all major UMI-based scRNA-seq protocols.</p>
    <fig id="fig1" orientation="portrait" position="float">
      <label>Figure 1:</label>
      <caption>
        <p>Schematic of the zUMIs pipeline. Each of the gray panels from left to right depicts a step of the <italic>zUMIs</italic> pipeline. First, fastq files are filtered according to user-defined bar code (BC) and unique molecular identifier (UMI) quality thresholds. Next, the remaining cDNA reads are mapped to the reference genome using STAR. Gene-wise read and UMI count tables are generated for exon, intron, and exon+intron overlapping reads. To obtain comparable library sizes, reads can be downsampled to a desired range during the counting step. In addition, <italic>zUMIs</italic> also generates data and plots for several quality measures, such as the number of detected genes/UMIs per BCe and distribution of reads into mapping feature categories.</p>
      </caption>
      <graphic xlink:href="giy059fig1"/>
    </fig>
  </sec>
  <sec id="sec3">
    <title>Implementation and Operation</title>
    <sec id="sec3-1">
      <title>Filtering and mapping</title>
      <p>The first step in our pipeline is to filter reads that have low-quality BCs according to a user-defined threshold (Fig.<xref ref-type="fig" rid="fig1">1</xref>). This step eliminates the majority of spurious BCs and thus greatly reduces the number of BCs that need to be considered for counting. Similarly, we also filter low-quality UMIs.</p>
      <p>The remaining reads are then mapped to the genome using the splice-aware aligner <monospace>STAR</monospace> [<xref rid="bib22" ref-type="bibr">22</xref>]. The user is free to customize mapping by using the options of <monospace>STAR</monospace>. Furthermore, if the user wishes to use a different mapper, it is also possible to provide <italic>zUMIs</italic> with an aligned bam file instead of the fastq file with the cDNA sequence, with the sole requirement that only one mapping position per read is reported in the bam file.</p>
    </sec>
    <sec id="sec3-2">
      <title>Transcript counting</title>
      <p>Next, reads are assigned to genes. In order to distinguish exon and intron counts, we generate two mutually exclusive annotation files from the provided gtf, one detailing exon positions, the other introns. Based on those annotations, <monospace>Rsubread featureCounts</monospace> [<xref rid="bib23" ref-type="bibr">23</xref>] is used to first assign reads to exons and afterward to check whether the remaining reads fall into introns, in other words, if a read is overlapping with intronic and exonic sequences, it will be assigned to the exon only. The output is then read into R using <monospace>data.table</monospace> [<xref rid="bib24" ref-type="bibr">24</xref>], generating count tables for UMIs and reads per gene per BC. We then collapse UMIs that were mapped either to the exon or intron of the same gene. Note that only the processing of intron and exon reads together allows for properly collapse of UMIs that can be sampled from the intronic as well as from the exonic part of the same nascent mRNA molecule.</p>
      <p>Per default, we only collapse UMIs by sequence identity. If there is a risk that a large proportion of UMIs remains undercollapsed due to sequence errors, <italic>zUMIs</italic> provides the option to collapse UMIs within a given Hamming distance. We compare the two <italic>zUMIs</italic> UMI-collapsing options to the recommended directional adjacency approach implemented in UMI-tools [<xref rid="bib25" ref-type="bibr">25</xref>] using our in-house example dataset (see Methods section). <italic>zUMIs</italic> identity collapsing yields nearly identical UMI counts per cell as UMI-tools, while Hamming distance yields increasingly fewer UMIs per cell with increasing sequencing depth (Fig.<xref ref-type="fig" rid="fig2">2C</xref>). Smith et al [<xref rid="bib25" ref-type="bibr">25</xref>] suggest that edit distance collapsing without considering the relative frequencies of UMIs might indeed overreach and overcollapse the UMIs. We suspect that this is indeed what happens in our example data, where we find that gene-wise dispersion estimates appear suspiciously truncated as expected if several counts are unduly reduce to one, the minimal number after collapsing (Fig.<xref ref-type="fig" rid="fig2">2D</xref>).</p>
      <fig id="fig2" orientation="portrait" position="float">
        <label>Figure 2:</label>
        <caption>
          <p>Comparison of different UMI collapsing methods. We compared Drop-seq-tools and UMI-tools with zUMIs using our HEK dataset (227 mio reads). <bold>(A)</bold> Run time to count exonic UMIs using zUMIs (hamming distance = 0), UMI-tools (”unique” mode) and Drop-seq-tools (edit distance = 0). <bold>(B)</bold> Box plots of correlation coefficients of gene-wise UMI counts of the same cell generated with different methods. UMI counts generated using zUMIs (quality filter “1 base under phred 17” or hamming distance = 1) were correlated to UMI counts generated using Drop-seq-tools (quality filter “1 base under phred 17” ) and UMI-tools (“directional adjacency” mode). <bold>(C)</bold> Comparison of the total number of UMIs per cell derived from different counting methods to “unfiltered” counts. <bold>(D)</bold> Violin plots of gene-wise dispersion estimates with different quality filtering and UMI collapsing methods.</p>
        </caption>
        <graphic xlink:href="giy059fig2"/>
      </fig>
      <p>However, note that the above-described differences are minor. By and large, there is good agreement between UMI counts obtained by UMI-tools [<xref rid="bib25" ref-type="bibr">25</xref>], the Drop-seq pipeline [<xref rid="bib13" ref-type="bibr">13</xref>], and <italic>zUMIs</italic>. The correlation between gene-wise counts of the same cell is &gt;0.99 for all comparisons (Fig. <xref ref-type="fig" rid="fig2">2B</xref>). In light of this, we consider the &gt;3 times higher processing speed of <italic>zUMIs</italic> to be a decisive advantage (Fig.<xref ref-type="fig" rid="fig2">2A</xref>).</p>
    </sec>
    <sec id="sec3-3">
      <title>Cell BC selection</title>
      <p>In order to be compatible with well-based and droplet-based scRNA-seq methods, <italic>zUMIs</italic> needs to be able to deal with known as well as random BCs. As default behavior, <italic>zUMIs</italic> infers which BCs mark good cells from the data (Fig.<xref ref-type="fig" rid="fig3">3A, 3B</xref>). To this end, we fit a k-dimensional multivariate normal distribution using the R-package <monospace>mclust</monospace> [<xref rid="bib26" ref-type="bibr">26</xref>, <xref rid="bib27" ref-type="bibr">27</xref>] for the number of reads/BC, where k is empirically determined by mclust via the Bayesian information criterion. We reason that only the kth normal distribution with the largest mean contains BCs that identify reads originating from intact cells. We exclude all BCs that fall in the lower 1% tail of this kth normal distribution to exclude spurious BCs. The HEK dataset used here contains 96 cells with known BCs and <italic>zUMIs</italic> identifies 99 BCs as intact, including all the 96 known BCs. Also, for the single-nucleus RNA-seq from Habib et al. [<xref rid="bib12" ref-type="bibr">12</xref>], <italic>zUMIs</italic> identified a reasonable number of cells; Habib et al. report 10,877 nuclei and zUMIs identified 11,013 intact nuclei. However, we recommend to always check the elbow plot generated by zUMIs (Fig.<xref ref-type="fig" rid="fig3">3B</xref>) to confirm that the cutoff used by zUMIs is valid for a given dataset. In cases where the number of BCs or BC sequences are known, it is preferable to use this information. If <italic>zUMIs</italic> is either given the number of expected BCs or is provided with a list of BC sequences, it will use this information and forgo automatic inference.</p>
      <fig id="fig3" orientation="portrait" position="float">
        <label>Figure 3:</label>
        <caption>
          <p>Utilities of zUMIs. Each of the panels shows the utilities of <italic>zUMIs</italic> pipeline. The plots from A–D show the results from the example HEK dataset used here. <bold>(A)</bold> The plot shows a density distribution of reads per BC. Cell BCs with reads right of the blue line are selected. <bold>(B)</bold> The plot shows the cumulative read distribution in the example HEK dataset where the BCs in light blue are the selected cells. <bold>(C)</bold>The bar plot shows the number of reads per selected cell BC with the red lines showing upper and lower median absolute deviation (MAD) cutoffs for adaptive downsampling. Here, the cells below the lower MAD have very low coverage and are discarded in downsampled count tables. <bold>(D)</bold> Cells were downsampled to six depths from 100,000 to 3,000,000 reads. For each sequencing depth, the genes detected per cell are shown. <bold>(E)</bold> Runtime for three datasets with 227, 500, and 1,000 million read-pairs. The runtime is divided in the main steps of the <italic>zUMIs</italic> pipeline as follows: filtering, mapping, counting, and summarizing. Each dataset was processed using 16 threads (“-p 16”).</p>
        </caption>
        <graphic xlink:href="giy059fig3"/>
      </fig>
    </sec>
    <sec id="sec3-4">
      <title>Downsampling</title>
      <p>scRNA-seq library sizes can vary by orders of magnitude, which complicates normalization [<xref rid="bib28" ref-type="bibr">28</xref>, <xref rid="bib29" ref-type="bibr">29</xref>]. A straight-forward solution for this issue is to downsample overrepresented libraries [<xref rid="bib30" ref-type="bibr">30</xref>]. <italic>zUMIs</italic> has an built-in function for downsampling datasets to a user-specified number of reads or a range of reads. By default, <italic>zUMIs</italic> downsamples all selected BCs to be within three absolute deviations from the median number of reads per BC (Fig.<xref ref-type="fig" rid="fig3">3C</xref>). Alternatively, the user can provide a target sequencing depth, and <italic>zUMIs</italic> will downsample to the specified read number or omit the cell from the downsampled count table if fewer reads were present. Furthermore, <italic>zUMIs</italic> also allows the user to specify a multiple target read number at once for downsampling. This feature is helpful if the user wishes to determine whether the RNA-seq library was sequenced to saturation or whether further sequencing would increase the number of detected genes or UMIs enough to justify the extra cost. In our HEK-cell example dataset, the number of detected genes starts leveling off at 1 million reads. Sequencing double that amount would only increase the number of detected genes from 9,000 to 10,600 when counting exon reads (Fig.<xref ref-type="fig" rid="fig3">3D</xref>). In line with previous findings [<xref rid="bib8" ref-type="bibr">8</xref>, <xref rid="bib14" ref-type="bibr">14</xref>], the saturation curve of exon+intron counting runs parallel to the one for exon counting, both indicating that a sequencing depth of 1 million reads per cell is sufficient for these libraries.</p>
    </sec>
    <sec id="sec3-5">
      <title>Output and statistics</title>
      <p><italic>zUMIs</italic> outputs three UMI and three read count tables: gene-wise counts for traditional exon counting, one for intron and one for exon+intron counts. If a user chooses the downsampling option, six additional count tables per target read count are provided. To evaluate library quality, <italic>zUMIs</italic> summarizes the mapping statistics of the reads. While exon and intron mapping reads likely represent mRNA quantities, a high fraction of intergenic and unmapped reads indicates low-quality libraries. Another measure of RNA-seq library quality is the complexity of the library, for which the number of detected genes and the number of identified UMIs are good measures (Fig.<xref ref-type="fig" rid="fig1">1</xref>). We processed 227 million reads with <italic>zUMIs</italic> and quantified expression levels for exon and intron counts on a Unix machine using up to 16 threads, which took less than 3 hours. Increasing the number of reads increases the processing time approximately linearly, where filtering, mapping, and counting each take up roughly one third of the total time (Fig.<xref ref-type="fig" rid="fig3">3E</xref>). We also observed that the peak random access memory usage for processing datasets of 227, 500, and 1,000 million pairs was 42 Gb, 89 Gb, and 172 Gb, respectively. Finally, <italic>zUMIs</italic> could process the largest scRNA-seq dataset reported to date with around 1.3 million brain cells and 30 billion read-pairs generated with 10xGenomics Chromium (see Methods section) on a 22-core processor in only 7 days.</p>
    </sec>
    <sec id="sec3-6">
      <title>Intron counting</title>
      <p>Recently, it has been shown that intron mapping reads in RNA-seq likely originate from nascent mRNAs and are useful for gene expression estimates [<xref rid="bib31" ref-type="bibr">31</xref>, <xref rid="bib32" ref-type="bibr">32</xref>]. Additionally, novel approaches leverage the ratios of intron and exon mapping reads to infer information on transcription dynamics and cell states [<xref rid="bib33" ref-type="bibr">33</xref>]. To address this new aspect of analysis, <italic>zUMIs</italic> also counts and collapses intron-only mapping reads as well as intron and exon mapping reads from the same gene with the same UMI. To assess the information gain from intronic reads to estimate gene expression levels, we analyzed a publicly available DroNc-seq dataset from mouse brain ([<xref rid="bib12" ref-type="bibr">12</xref>]; see Methods section). For the ∼11,000 single nuclei of this dataset, the fraction of intron mapping reads of all reads goes up to 61%. Thus, if intronic reads are considered, the mean number of detected genes per cell increases from 1,041 for exon counts to 1,995 for exon+intron counts. Next, we used the resulting UMI count tables to investigate whether exon+intron counting improves the identification of cell types, as suggested by Lake et al. [<xref rid="bib11" ref-type="bibr">11</xref>]. The validity and accuracy of counting introns for single-nucleus sequencing methods has recently been demonstrated [<xref rid="bib34" ref-type="bibr">34</xref>]. Following the Seurat pipeline to cluster cells [<xref rid="bib35" ref-type="bibr">35</xref>, <xref rid="bib36" ref-type="bibr">36</xref>], we find that using exon+intron counts discriminates 28 clusters, while we could only discriminate 19 clusters using exon counts (Fig.<xref ref-type="fig" rid="fig4">4A, 4B</xref>). The larger number of clusters is not simply due to the increase in the counted UMIs and genes. When we permute the intron counts across cells and add them to the exon counts, the added noise actually reduces the number of identifiable clusters (Fig.<xref ref-type="fig" rid="fig4">4E</xref>).</p>
      <fig id="fig4" orientation="portrait" position="float">
        <label>Figure 4:</label>
        <caption>
          <p>Contribution of intron reads to biological insights. We analyzed published single-nucleus RNA-seq data from mouse prefrontal cortex (PFC) and hippocampus [<xref rid="bib12" ref-type="bibr">12</xref>] to assess the utility of counting intron in addition to exon reads. We processed the raw data with <italic>zUMIs</italic> to obtain expression tables with exon reads as well as exon+intron reads and then used the R-package Seurat [<xref rid="bib35" ref-type="bibr">35</xref>, <xref rid="bib36" ref-type="bibr">36</xref>] to cluster cells. With exon counts, we identified 19 clusters <bold>(A)</bold>, and with exon+intron counts we identified 27 clusters <bold>(B)</bold>. Clusters are represented as t-SNE plots and colored according to the most frequent cell-type assignment in the original article [<xref rid="bib12" ref-type="bibr">12</xref>]: glutamatergic neurons from the prefrontal cortex (exPFC), GABAergic interneurons (GABA), pyramidal neurons from the hippocampal CA region (CA), granule neurons from the hippocampal dentate gyrus region (DG), astrocytes (ASC), microglia (MG), oligodendrocytes (ODC), oligodendrocyte precursor cells (OPC), neuronal stem cells (NSC), smooth muscle cells (SMC) and endothelial cells (END). Different shades of those clusters indicate that multiple clusters had the same major cell type assigned. If we randomly sample counts from the intron data and add them to the exon counting, the noise reduces the number of clusters and the Seurat pipeline can only identify 9–11 clusters <bold>(E)</bold>. The composition of each cluster based on exon+intron is detailed in panel <bold>(C)</bold>, and cells that were not assigned a cell type in [<xref rid="bib12" ref-type="bibr">12</xref>] are displayed as empty. The boxes mark the clusters that were not split when using exon data only. For example, cluster 7 from exon counting, which mainly consists of GABAergic neurons, was split into clusters 7, 24 (506, 66 cells) when using exon+intron counting. In <bold>(D)</bold>, we show the numbers of genes that were differentially expressed (DE) (limma p-adj &lt;0.05) between the clusters found only with exon+intron counts. The panel numbers represent the exon counting cluster numbers and the <italic>y</italic>-axis the exon+intron counting cluster number. The log2-fold changes corresponding to these contrasts are also used in (<bold>G</bold>). Among the genes that were additionally detected to be DE by exon+intron counting was the marker gene Il1rapl2 (limma p-adj = 10<sup>−5</sup>). In <bold>(F)</bold>, we present a violin plot of the normalized counts for Il1rapl2 in cells of the GABAergic subclusters 7 and 24. Log2-fold changes calculated with exon+intron counts correlate well with exon counts <bold>(G)</bold>. Note that for exon counting only, half as many genes could be evaluated as for exon+intron counting and thus only half of the exon+intron genes are depicted in <bold>(G)</bold>. Large log<sub>2</sub> fold changes (LFCs) are found to be significant with both counting strategies (purple points are close to the bisecting line). We conducted simulations based on mean and dispersion measured using exon cluster 0 (1,616 cells, ∼90% exPFC). In <bold>(I)</bold> we show the expected true positive rate and the false discovery rate for a scenario comparing 300 vs 300 cells. Results for exon and exon+intron counting were stratified into five quantiles according to the mean expression of genes, where stratum 1 contains lowly expressed genes and stratum 5 the most highly expressed genes. The numbers of genes falling into each of the bins using exon+intron and exon counting are depicted in <bold>(H)</bold>.</p>
        </caption>
        <graphic xlink:href="giy059fig4"/>
      </fig>
      <p>We continue to further characterize the seven clusters that were subdivided by the addition of intron counts (Fig.<xref ref-type="fig" rid="fig4">4D</xref>). First, we identify DE genes between the newly formed clusters. If we count only exon reads, there appear to be, on average, only 10 DE genes between the subgroups, while exon+intron counting yields ∼10 times more DE genes, thus corroborating the signal found with clustering. The log2-fold changes of those additional DE genes estimated with either counting strategy are generally in good agreement; especially large log2-fold changes are detected with both exon and exon+intron counting (Fig.<xref ref-type="fig" rid="fig4">4F</xref>). Genes that are detected as DE in only one of our counting strategies have small log2-fold changes, and there are more of these small changes detected using exon+intron counting.</p>
      <p>Detecting more genes naturally increases the chance to also detect more informative genes. Here, we cross-reference the gene list with marker genes for transcriptomic subtypes detected for major cell types of the mouse brain [<xref rid="bib37" ref-type="bibr">37</xref>] and find that ∼5% of the additional genes are also marker genes, which corresponds well to the general frequency of marker genes among the detected genes (4%). In the same vein, we also detect proportionally more DE genes with exon+intron counting compared to exon counting. Thus, including introns simply allows us to better detect present transcripts, while leaving the proportions of interest unaltered. Having a closer look at cluster 7, it was split into a bigger (7) and a smaller cluster (24) using exon+intron counting (Fig.<xref ref-type="fig" rid="fig4">4A-C</xref>), we find one marker gene (Il1rapl2) to be DE between the subclusters using exon+intron counting, while Il1rapl2 had only spurious counts using exon counts. Il1rapl2 is a marker for transcriptomic subtypes of GABAergic Pvalb-type neurons [<xref rid="bib37" ref-type="bibr">37</xref>], suggesting that the split of cluster 7 might be biologically meaningful (Fig.<xref ref-type="fig" rid="fig4">4E</xref>).</p>
      <p>In order to evaluate the power gained by exon+intron counting in a more systematic way, we perform power simulations using empirical mean and dispersion distributions from the largest and most uniform cluster (∼1,500 cells) [<xref rid="bib9" ref-type="bibr">9</xref>]. For a fair comparison, we include all detected genes, which is equivalent to the number of genes detected with exon+intron counting. Also, since we call a gene detected as soon as one count is associated, exon counting is necessarily a subset of exon+intron. Thus, there are, on average, 4 times more genes in the lowest expression quantile for exon counting than for exon+intron counting (Fig.<xref ref-type="fig" rid="fig4">4H</xref>). For those genes, expression is too spurious to be used for differential expression analysis; for exon+intron counting, we have, on average, 60% power to detect a DE gene in the first mean expression bin with a well-controlled false discovery rate (FDR) (Fig.<xref ref-type="fig" rid="fig4">4G</xref>). In summary, the increased power for exon+intron counting and probably also the larger number of clusters are due to better detection of lowly expressed genes. Furthermore, we think that although potentially noisy, the large number of additionally detected genes makes exon+intron counting worthwhile, especially for single-nuclei sequencing techniques that are enriched for nuclear nascent RNA transcripts, such as DroNc-seq [<xref rid="bib12" ref-type="bibr">12</xref>]. Additionally, exon+intron counting may help in extracting as much information as possible from low coverage data as generated in the context of high-throughput cell atlas efforts (e.g., 10,000–20,000 reads/cell [<xref rid="bib38" ref-type="bibr">38</xref>, <xref rid="bib39" ref-type="bibr">39</xref>]. Last, users should always exclude the possibility of intronic reads stemming from genomic DNA contamination in the library preparation by confirming low intergenic mapping fractions using the statistics output provided by <italic>zUMIs</italic>.</p>
    </sec>
  </sec>
  <sec sec-type="conclusions" id="sec4">
    <title>Conclusion</title>
    <p><italic>zUMIs</italic> is a fast and flexible pipeline for processing raw reads to obtain count tables for RNA-seq data using UMIs. To our knowledge, it is the only open source pipeline that has a BC and UMI quality filter, allows intron counting, and has an integrated downsampling functionality. These features ensure that <italic>zUMIs</italic> is applicable to most experimental designs of RNA-seq data, including single-nucleus sequencing techniques, droplet-based methods where the BC is unknown, as well as plate-based UMI-methods with known BCs. Finally, <italic>zUMIs</italic> is computationally efficient, user-friendly, and easy to install.</p>
  </sec>
  <sec sec-type="methods" id="sec5">
    <title>Methods</title>
    <sec id="sec5-1">
      <title>Analyzed RNA-seq datasets</title>
      <p>HEK293T cells were cultured in DMEM high glucose with L-glutamine (Biowest) supplemented with 10% fetal bovine serum (Thermo Fisher) and 1% penicillin/streptomycin (Sigma-Aldrich) in a 37°C incubator with 5% carbon dioxide. Cells were passaged and split every 2 or 3 days. For single-cell RNA-seq, HEK293T cells were dissociated by incubation with 0.25% Trypsin (Sigma-Aldrich) for 5 minutes at 37°C. The single-cell suspension was washed twice with phosphate-buffered saline, and dead cells were stained with Zombie Yellow (Biolegend) according to the manufacturer’s protocol. Single cells were sorted into DNA LoBind 96-well polymerase chain reaction (PCR) plates (Eppendorf) containing lysis buffer with a Sony SH-800 cell sorter in 3-drop purity mode using a 100-µmnozzle. Next, single-cell RNA-seq libraries were constructed from one 96-well plate using a slightly modified version of the mcSCRB-seq protocol. Reverse transcription was performed as described previously [<xref rid="bib40" ref-type="bibr">40</xref>], with the only change being the use of KAPA HiFi HotStart enzyme for PCR amplification of cDNA. Resulting libraries were sequenced using an Illumina HiSeq1500 with 16 cycles in Read 1 to decode cell BCs (6 bases) and UMIs (10 bases) and 50 cycles in Read 2 to sequence into the cDNA fragment, obtaining ∼227 million reads. Raw fastq files were processed using <italic>zUMIs</italic>, mapping to the human genome (hg38) and Ensembl gene models (GRCh38.84).</p>
      <p>In addition, we analyzed data from 1.3 million mouse brain cells generated on the 10xGenomics Chromium platform [<xref rid="bib2" ref-type="bibr">2</xref>]. Sequences were downloaded from the National Center for Biotechnology Information Sequence Read Archive under accession number SRP096558. The data consist of 30 billion read-pairs from 133 individual samples. In these data, read 1 contains 16 bp for the cell BC and 10 bp for the UMI and read 2 contains 114 bp of cDNA. <italic>zUMIs</italic> was run using default settings, and we allowed 7 threads per job for a total of up to 42 threads on an Intel Xeon E5-2699 22-core processor.</p>
      <p>Finally, we obtained mouse brain DroNc-seq read data [<xref rid="bib12" ref-type="bibr">12</xref>] from the Broad Institute Single Cell Portal [<xref rid="bib41" ref-type="bibr">41</xref>]. This dataset consists of ∼1,615 million read-pairs from ∼11,000 single nuclei. Read 1 contains a 12 bpcell BC and a 8 bpUMI and read 2 60 bpof cDNA.</p>
      <p>The two mouse datasets were mapped to genome version mm10 and applying Ensembl gene models (GRCm38.75).</p>
    </sec>
    <sec id="sec5-2">
      <title>Power simulations and DE analysis</title>
      <p>We evaluated the power to detect differential expression with the help of the powsimR package [<xref rid="bib9" ref-type="bibr">9</xref>]. For the DroNc-seq dataset, we estimated the parameters of the negative binomial distribution from one of the identified clusters, namely, cluster 0, compromising 1,500 glutamatergic neuronal cells from the prefrontal cortex (Fig.<xref ref-type="fig" rid="fig4">4D</xref>). Since we detect more genes with exon+intron counting (4,433 compared to 1,782), we included this phenomenon in our read count simulation by drawing mean expression values for a total of 4,433 genes. This means that the table includes sparse counts for the exon counting. Log<sub>2</sub>-fold changes were drawn from a gamma distribution with shape equal to 1 and scale equal to 2. In each of the 25 simulation iterations, we draw an equal sample size of 300 cells per group and test for differential expression using limma-trend [<xref rid="bib42" ref-type="bibr">42</xref>] on log<sub>2</sub> counts per million (CPM) values with scran [<xref rid="bib43" ref-type="bibr">43</xref>] library size correction. The true positive rate and FDR are stratified over the empirical mean expression quantile bins.</p>
      <p>For the differential expression analysis between clusters, we use the same DE estimation procedure as in the simulations: scran normalization followed by limma-trend DE-analysis (c.f. [<xref rid="bib44" ref-type="bibr">44</xref>]).</p>
    </sec>
    <sec id="sec5-3">
      <title>Cluster identification</title>
      <p>After processing the DroNc-seq data [<xref rid="bib12" ref-type="bibr">12</xref>] with zUMIs as described above, we cluster cells based on UMI counts derived from exons only and exons+introns reads using the Seurat pipeline [<xref rid="bib35" ref-type="bibr">35</xref>, <xref rid="bib36" ref-type="bibr">36</xref>]. First, cells with fewer than 200 detected genes were filtered out. The filtered data were normalized using the LogNormalize function. We then scale the data by regressing out the effects of the number of transcripts and genes detected per cell using the ScaleData function. The normalized and scaled data are then used to identify the most variable genes by fitting a relationship between mean expression (ExpMean) and dispersion (LogVMR) using the FindVariableGenes function. The identified variable genes are used for principle component analysis, and the top 20 principle components are then used to find clusters using graph-based clustering as implemented in FindClusters. To illustrate that the additional clusters found by counting exon+intron reads are not spurious, we use intron-only UMI counts from the same data to add to the observed exon-only counts. More specifically, to each gene we add scran-size factor-corrected intron counts from the same gene after permuting them across cells. We assessed the cluster numbers from 100 such permutations.</p>
    </sec>
    <sec id="sec5-4">
      <title>Comparison of UMI collapsing strategies</title>
      <p>In order to validate <italic>zUMIs</italic> and compare different UMI collapsing methods, we used the HEK dataset described above. We ran <italic>zUMIs</italic> (1) without quality filtering, (2) filtering for onebase under Phred 17, and (3) collapsing similar UMI sequences within a hamming distance of 1. To compare with other available tools, we ran the same dataset using the Drop-seq-tools version 1.13 [<xref rid="bib13" ref-type="bibr">13</xref>] and quality filter “1 base under Phred 17” without edit distance collapsing. Last, the HEK dataset was used with UMI tools [<xref rid="bib25" ref-type="bibr">25</xref>] in (1) “unique” and (2) “directional adjacency” mode with edit distance set to 1. Also, we compared the output of <italic>zUMIs</italic> from the DroNc-seq dataset when using default parameters (“1 base under Phred 20”) to UMI-tools in (1) “unique,” (2) “directional adjacency,” and (3) “cluster” settings. For each setting and tool combination, we compared per-cell/per-nuclei UMI contents in a linear model fit.</p>
    </sec>
  </sec>
  <sec id="sec6">
    <title>Availability of source code and requirements</title>
    <list list-type="bullet">
      <list-item>
        <p>Project name: zUMIs</p>
      </list-item>
      <list-item>
        <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/sdparekh/zUMIs">https://github.com/sdparekh/zUMIs</ext-link></p>
      </list-item>
      <list-item>
        <p>Operating system(s): UNIX</p>
      </list-item>
      <list-item>
        <p>Programming language: shell, R, perl</p>
      </list-item>
      <list-item>
        <p>Other requirements: STAR &gt;= 2.5.3a, R &gt;= 3.4, Rsubread &gt;= 1.26.1, pigz &gt;= 2.3 &amp; samtools &gt;= 1.1</p>
      </list-item>
      <list-item>
        <p>License: GNU GPLv3.0</p>
      </list-item>
      <list-item>
        <p>Research Resource Identification Initiative ID: SCR_016139</p>
      </list-item>
    </list>
  </sec>
  <sec id="sec7">
    <title>Availability of supporting data</title>
    <p>All data that were generated for this project were submitted to GEO under accession GSE99822. An archival copy of the source code and test data are available via the <italic>GigaScience</italic> repository GigaDB [<xref rid="bib45" ref-type="bibr">45</xref>].</p>
  </sec>
  <sec id="sec8">
    <title>Abbreviations</title>
    <p>BC: barcode; DE: differentially expressed; FDR: false discovery rate; MAD: median absolute deviation; PCR: polymerase chain reaction; PFC: prefrontal cortex; scRNA-seq: single-cell RNA sequencing; UMI: unique molecular identifier.</p>
  </sec>
  <sec id="sec9">
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec id="sec10">
    <title>Funding</title>
    <p>This work has been supported by the Deutsche Forschungsgemeinschaft (DFG) through SFB1243 subprojects A14/A15.</p>
  </sec>
  <sec id="sec11">
    <title>Author contributions</title>
    <p>S.P. and C.Z. designed and implemented the pipeline. B.V. tested the pipeline and helped in power simulations. All authors contributed to writing the manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>GIGA-D-17-00271-Report-Reviewer_2_Attachment.pdf</label>
      <media xlink:href="giy059_giga-d-17-00271-report-reviewer_2_attachment.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>GIGA-D-17-00271_Original_Submission.pdf</label>
      <media xlink:href="giy059_giga-d-17-00271_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>GIGA-D-17-00271_Revision_1.pdf</label>
      <media xlink:href="giy059_giga-d-17-00271_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>GIGA-D-17-00271_Revision_2.pdf</label>
      <media xlink:href="giy059_giga-d-17-00271_revision_2.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>GIGA-D-17-00271_Revision_3.pdf</label>
      <media xlink:href="giy059_giga-d-17-00271_revision_3.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>GIGA-D-17-00271_Revision_4.pdf</label>
      <media xlink:href="giy059_giga-d-17-00271_revision_4.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup7">
      <label>GIGA-D-17-0027_R1-Reviewer_2_Report_(Revision_1)-Attachment.pdf</label>
      <media xlink:href="giy059_giga-d-17-0027_r1-reviewer_2_report_(revision_1)-attachment.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup8">
      <label>Response_to_Reviewer_Comments_Original_Submission.pdf</label>
      <media xlink:href="giy059_response_to_reviewer_comments_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup9">
      <label>Response_to_Reviewer_Comments_Revision_1.pdf</label>
      <media xlink:href="giy059_response_to_reviewer_comments_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup10">
      <label>Response_to_Reviewer_Comments_Revision_2.pdf</label>
      <media xlink:href="giy059_response_to_reviewer_comments_revision_2.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup11">
      <label>Response_to_Reviewer_Comments_Revision_3.pdf</label>
      <media xlink:href="giy059_response_to_reviewer_comments_revision_3.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup12">
      <label>Reviewer_1_Report_(Original_Submission) -- Karthik Shekhar</label>
      <caption>
        <p>10/27/2017 Reviewed</p>
      </caption>
      <media xlink:href="giy059_reviewer_1_report_(original_submission).pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup13">
      <label>Reviewer_2_Report_(Original_Submission) -- Keegan Korthauer</label>
      <caption>
        <p>11/21/2017 Reviewed</p>
      </caption>
      <media xlink:href="giy059_reviewer_2_report_(original_submission).pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup14">
      <label>Reviewer_2_Report_(Revision_1) -- Keegan Korthauer</label>
      <caption>
        <p>3/26/2018 Reviewed</p>
      </caption>
      <media xlink:href="giy059_reviewer_2_report_(revision_1).pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup15">
      <label>Reviewer_2_Report_(Revision_2) -- Keegan Korthauer</label>
      <caption>
        <p>4/19/2018 Reviewed</p>
      </caption>
      <media xlink:href="giy059_reviewer_2_report_(revision_2).pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup16">
      <label>Supplemental Files</label>
      <media xlink:href="giy059_supplemental_files.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sandberg</surname><given-names>R</given-names></name></person-group><article-title>Entering the era of single-cell transcriptomics in biology and medicine</article-title>. <source>Nat Methods</source>. <year>2014</year>;<volume>11</volume>(<issue>1</issue>):<fpage>22</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">24524133</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zheng</surname><given-names>GXY</given-names></name>, <name name-style="western"><surname>Terry</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Belgrader</surname><given-names>P</given-names></name>, <etal/></person-group><article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat Commun</source>. <year>2017</year>;<volume>8</volume>:<fpage>14049</fpage>.<pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rosenberg</surname><given-names>AB</given-names></name>, <name name-style="western"><surname>Roco</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Muscat</surname><given-names>RA</given-names></name>, <etal/></person-group><article-title>Single-cell profiling of the developing mouse brain and spinal cord with split-pool barcoding</article-title>. <source>Science</source>. <year>2018</year>;<volume>360</volume>(<issue>6385</issue>):<fpage>176</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">29545511</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wagner</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Regev</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Yosef</surname><given-names>N</given-names></name></person-group><article-title>Revealing the vectors of cellular identity with single-cell genomics</article-title>. <source>Nat Biotechnol</source>. <year>2016</year>;<volume>34</volume>(<issue>11</issue>):<fpage>1145</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">27824854</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Regev</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Teichmann</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Lander</surname><given-names>ES</given-names></name>, <etal/></person-group><source>The Human Cell Atlas.</source><publisher-name>Elife</publisher-name>, <year>2017; 6</year>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Parekh</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ziegenhain</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Vieth</surname><given-names>B</given-names></name>, <etal/></person-group><article-title>The impact of amplification on differential expression analyses by RNA-seq</article-title>. <source>Sci Rep</source>. <year>2016</year>;<volume>6</volume>:<fpage>25533</fpage>.<pub-id pub-id-type="pmid">27156886</pub-id></mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kivioja</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Vähärautio</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Karlsson</surname><given-names>K</given-names></name>, <etal/></person-group><article-title>Counting absolute numbers of molecules using unique molecular identifiers</article-title>. <source>Nat Methods</source>. <year>2012</year>;<volume>9</volume>(<issue>1</issue>):<fpage>72</fpage>–<lpage>4</lpage>.</mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ziegenhain</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Vieth</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Parekh</surname><given-names>S</given-names></name>, <etal/></person-group><article-title>Comparative analysis of single-cell RNA sequencing methods</article-title>. <source>Mol Cell</source>. <year>2017</year>;<volume>65</volume>(<issue>4</issue>):<fpage>631</fpage>–<lpage>43.e4</lpage>.<pub-id pub-id-type="pmid">28212749</pub-id></mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vieth</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Ziegenhain</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Parekh</surname><given-names>S</given-names></name>, <etal/></person-group><article-title>powsimR: power analysis for bulk and single cell RNA-seq experiments</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>(<issue>21</issue>):<fpage>3486</fpage>–<lpage>3488</lpage>.<pub-id pub-id-type="pmid">29036287</pub-id></mixed-citation>
    </ref>
    <ref id="bib10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ziegenhain</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Vieth</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Parekh</surname></name><etal/></person-group><article-title>Quantitative single-cell transcriptomics</article-title>. <source>Brief Funct Genomics</source>. <year>2018</year>;<comment>doi:10.1093/bfgp/ely009</comment>.</mixed-citation>
    </ref>
    <ref id="bib11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lake</surname><given-names>BB</given-names></name>, <name name-style="western"><surname>Ai</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Kaeser</surname><given-names>GE</given-names></name><etal/></person-group><article-title>Neuronal subtypes and diversity revealed by single-nucleus RNA sequencing of the human brain</article-title>. <source>Science</source>. <year>2016</year>;<volume>352</volume>(<issue>6293</issue>):<fpage>1586</fpage>–<lpage>90</lpage>.<pub-id pub-id-type="pmid">27339989</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Habib</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Avraham-Davidi</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Basu</surname><given-names>A</given-names></name><etal/></person-group><article-title>Massively parallel single-nucleus RNA-seq with DroNc-seq</article-title>. <source>Nat Methods</source>. <year>2017</year>;<volume>14</volume>(<issue>10</issue>):<fpage>955</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">28846088</pub-id></mixed-citation>
    </ref>
    <ref id="bib13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Macosko</surname><given-names>EZ</given-names></name>, <name name-style="western"><surname>Basu</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Satija</surname><given-names>R</given-names></name>, <etal/></person-group><article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>. <source>Cell</source>. <year>2015</year>;<volume>161</volume>(<issue>5</issue>):<fpage>1202</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Svensson</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Natarajan</surname><given-names>KN</given-names></name>, <name name-style="western"><surname>Ly</surname><given-names>LH</given-names></name>, <etal/></person-group><article-title>Power analysis of single-cell RNA-sequencing experiments</article-title>. <source>Nat Methods</source>. <year>2017</year>;<volume>14</volume>(<issue>4</issue>):<fpage>381</fpage>–<lpage>7</lpage>.<pub-id pub-id-type="pmid">28263961</pub-id></mixed-citation>
    </ref>
    <ref id="bib15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hashimshony</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Senderovich</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Avital</surname><given-names>G</given-names></name>, <etal/></person-group><article-title>CEL-Seq2: sensitive highly-multiplexed single-cell RNA-seq</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>77</fpage>.<pub-id pub-id-type="pmid">27121950</pub-id></mixed-citation>
    </ref>
    <ref id="bib16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Petukhov</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Guo</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Baryawno</surname><given-names>N</given-names></name>, <etal/></person-group><article-title>Accurate estimation of molecular counts in droplet-based single-cell RNA-seq experiments</article-title>. <source>bioRxiv</source>. <year>2017</year>;<fpage>p. 171496</fpage>.</mixed-citation>
    </ref>
    <ref id="bib17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Soumillon</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Cacchiarelli</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Semrau</surname><given-names>S</given-names></name><etal/></person-group><article-title>Characterization of directed differentiation by high-throughput single-cell RNA-seq</article-title>. <source>bioRxiv</source>. <year>2014</year>.</mixed-citation>
    </ref>
    <ref id="bib18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jaitin</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Kenigsberg</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Keren-Shaul</surname><given-names>H</given-names></name><etal/></person-group><article-title>Massively parallel single-cell RNA-seq for marker-free decomposition of tissues into cell types</article-title>. <source>Science</source>. <year>2014</year>;<volume>343</volume>(<issue>6172</issue>):<fpage>776</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">24531970</pub-id></mixed-citation>
    </ref>
    <ref id="bib19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Klein</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Mazutis</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Akartuna</surname><given-names>I</given-names></name>, <etal/></person-group><article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>. <source>Cell</source>. <year>2015</year>;<volume>161</volume>(<issue>5</issue>):<fpage>1187</fpage>–<lpage>1201</lpage>.<pub-id pub-id-type="pmid">26000487</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zilionis</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Nainys</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Veres</surname><given-names>A</given-names></name><etal/></person-group><article-title>Single-cell barcoding and sequencing using droplet microfluidics</article-title>. <source>Nat Protoc</source>. <year>2017</year>;<volume>12</volume>(<issue>1</issue>):<fpage>44</fpage>–<lpage>73</lpage>.<pub-id pub-id-type="pmid">27929523</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hochgerner</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Lönnerberg</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Hodge</surname><given-names>R</given-names></name>, <etal/></person-group><article-title>STRT-seq-2i: dual-index 5’ single cell and nucleus RNA-seq on an addressable microwell array</article-title>. <source>Sci Rep</source>. <year>2017</year>;<volume>7</volume>(<issue>1</issue>):<fpage>16327</fpage>.<pub-id pub-id-type="pmid">29180631</pub-id></mixed-citation>
    </ref>
    <ref id="bib22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dobin</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Davis</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Schlesinger</surname><given-names>F</given-names></name><etal/></person-group><article-title>STAR: ultrafast universal RNA-seq aligner</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>1</issue>):<fpage>15</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">23104886</pub-id></mixed-citation>
    </ref>
    <ref id="bib23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liao</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Smyth</surname><given-names>GK</given-names></name>, <name name-style="western"><surname>Shi</surname><given-names>W</given-names></name></person-group><article-title>featureCounts: an efficient general purpose program for assigning sequence reads to genomic features</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>7</issue>):<fpage>923</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">24227677</pub-id></mixed-citation>
    </ref>
    <ref id="bib24">
      <label>24.</label>
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Dowle</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Srinivasan</surname><given-names>A</given-names></name></person-group><source>data.table: Extension of ‘data.frame.''</source>. <year>2017</year>, <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=data.table">https://CRAN.R-project.org/package=data.table</ext-link>, <comment>r package version 1.10.4</comment>.</mixed-citation>
    </ref>
    <ref id="bib25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>TS</given-names></name>, <name name-style="western"><surname>Heger</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sudbery</surname><given-names>I</given-names></name></person-group><article-title>UMI-tools: modelling sequencing errors in unique molecular identifiers to improve quantification accuracy</article-title>. <source>Genome Res.</source><year>2017</year>.</mixed-citation>
    </ref>
    <ref id="bib26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fraley</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Raftery</surname><given-names>AE</given-names></name></person-group><article-title>Model-based clustering, discriminant analysis, and density estimation</article-title>. <source>J Am Stat Assoc</source>. <year>2002</year>;<volume>97</volume>(<issue>458</issue>):<fpage>611</fpage>–<lpage>31</lpage>.</mixed-citation>
    </ref>
    <ref id="bib27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fraley</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Raftery</surname><given-names>AE</given-names></name></person-group><source>Enhanced Model-Based Clustering, Density Estimation and Discriminant Analysis Software: MCLUST.</source>, <source>J. Classification</source>, <year>2003</year>, <volume>20</volume>, <fpage>263</fpage>–<lpage>286</lpage>.</mixed-citation>
    </ref>
    <ref id="bib28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vallejos</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Risso</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Scialdone</surname><given-names>A</given-names></name><etal/></person-group><article-title>Normalizing single-cell RNA sequencing data: challenges and opportunities</article-title>. <source>Nat Methods</source>. <year>2017</year>;<volume>14</volume>(<issue>6</issue>):<fpage>565</fpage>–<lpage>71</lpage>.<pub-id pub-id-type="pmid">28504683</pub-id></mixed-citation>
    </ref>
    <ref id="bib29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Evans</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Hardin</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Stoebel</surname><given-names>DM</given-names></name></person-group><article-title>Selecting between-sample RNA-seq normalization methods from the perspective of their assumptions</article-title>. <source>Brief Bioinform</source>. <year>2017</year>.</mixed-citation>
    </ref>
    <ref id="bib30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Grün</surname><given-names>D</given-names></name>, <name name-style="western"><surname>van Oudenaarden</surname><given-names>A</given-names></name></person-group><article-title>Design and analysis of single-cell sequencing experiments</article-title>. <source>Cell</source>. <year>2015</year>;<volume>163</volume>(<issue>4</issue>):<fpage>799</fpage>–<lpage>810</lpage>.<pub-id pub-id-type="pmid">26544934</pub-id></mixed-citation>
    </ref>
    <ref id="bib31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hendriks</surname><given-names>GJ</given-names></name>, <name name-style="western"><surname>Gaidatzis</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Aeschimann</surname><given-names>F</given-names></name><etal/></person-group><article-title>Extensive oscillatory gene expression during <italic>C. elegans</italic> larval development</article-title>. <source>Mol Cell</source>. <year>2014</year>;<volume>53</volume>(<issue>3</issue>):<fpage>380</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">24440504</pub-id></mixed-citation>
    </ref>
    <ref id="bib32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gaidatzis</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Burger</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Florescu</surname><given-names>M</given-names></name><etal/></person-group><article-title>Analysis of intronic and exonic reads in RNA-seq data characterizes transcriptional and post-transcriptional regulation</article-title>. <source>Nat Biotechnol</source>. <year>2015</year>;<volume>33</volume>(<issue>7</issue>):<fpage>722</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">26098447</pub-id></mixed-citation>
    </ref>
    <ref id="bib33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>La Manno</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Soldatov</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Hochgerner</surname><given-names>H</given-names></name>, <etal/></person-group><article-title>RNA velocity in single cells</article-title>. <source>bioRxiv</source>. <year>2017</year>;<fpage>p. 206052</fpage>.</mixed-citation>
    </ref>
    <ref id="bib34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lake</surname><given-names>BB</given-names></name>, <name name-style="western"><surname>Codeluppi</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Yung</surname><given-names>YC</given-names></name>, <etal/></person-group><article-title>A comparative strategy for single-nucleus and single-cell transcriptomes confirms accuracy in predicted cell-type expression from nuclear RNA</article-title>. <source>Sci Rep</source>. <year>2017</year>;<volume>7</volume>(<issue>1</issue>):<fpage>6031</fpage>.<pub-id pub-id-type="pmid">28729663</pub-id></mixed-citation>
    </ref>
    <ref id="bib35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Satija</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Farrell</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Gennert</surname><given-names>D</given-names></name><etal/></person-group><article-title>Spatial reconstruction of single-cell gene expression data</article-title>. <source>Nat Biotechnol</source>. <year>2015</year>;<volume>33</volume>(<issue>5</issue>):<fpage>495</fpage>–<lpage>502</lpage>.<pub-id pub-id-type="pmid">25867923</pub-id></mixed-citation>
    </ref>
    <ref id="bib36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Butler</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Satija</surname><given-names>R</given-names></name></person-group><article-title>Integrated analysis of single cell transcriptomic data across conditions, technologies, and species</article-title>. <source>bioRxiv</source>. <year>2017</year>;<fpage>p. 164889</fpage>.</mixed-citation>
    </ref>
    <ref id="bib37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tasic</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Menon</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Nguyen</surname><given-names>TN</given-names></name><etal/></person-group><article-title>Adult mouse cortical cell taxonomy revealed by single cell transcriptomics</article-title>. <source>Nat Neurosci</source>. <year>2016</year>;<volume>19</volume>(<issue>2</issue>):<fpage>335</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">26727548</pub-id></mixed-citation>
    </ref>
    <ref id="bib38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>The Tabula Muris Consortium</surname></name>, <name name-style="western"><surname>Quake</surname><given-names>SR</given-names></name>, <name name-style="western"><surname>Wyss-Coray</surname><given-names>T</given-names></name><etal/></person-group><article-title>Single-cell transcriptomic characterization of 20 organs and tissues from individual mice creates a Tabula Muris</article-title>. <source>bioRxiv</source>. <year>2018</year>;<fpage>p. 237446</fpage>.</mixed-citation>
    </ref>
    <ref id="bib39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Han</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Zhou</surname><given-names>Y</given-names></name><etal/></person-group><article-title>Mapping the mouse cell atlas by microwell-seq</article-title>. <source>Cell</source>. <year>2018</year>;<volume>172</volume>(<issue>5</issue>):<fpage>1091</fpage>–<lpage>1107.e17</lpage>.<pub-id pub-id-type="pmid">29474909</pub-id></mixed-citation>
    </ref>
    <ref id="bib40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bagnoli</surname><given-names>JW</given-names></name>, <name name-style="western"><surname>Ziegenhain</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Janjic</surname><given-names>A</given-names></name><etal/></person-group><article-title>mcSCRB-seq: sensitive and powerful single-cell RNA sequencing</article-title>. <source>bioRxiv</source>. <year>2017</year>;<fpage>p. 188367</fpage>.</mixed-citation>
    </ref>
    <ref id="bib41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><collab>Broad Institute Single Cell Portal</collab>. <ext-link ext-link-type="uri" xlink:href="https://portals.broadinstitute.org/single_cell/study/dronc-seq-single-nucleus-rna-seq-on-mouse-archived-brain">https://portals.broadinstitute.org/single_cell/study/dronc-seq-single-nucleus-rna-seq-on-mouse-archived-brain</ext-link>.</mixed-citation>
    </ref>
    <ref id="bib42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Law</surname><given-names>CW</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Shi</surname><given-names>W</given-names></name>, <etal/></person-group><article-title>voom: precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>. <source>Genome Biol</source>. <year>2014</year>;<volume>15</volume>(<issue>2</issue>):<fpage>R29</fpage>.<pub-id pub-id-type="pmid">24485249</pub-id></mixed-citation>
    </ref>
    <ref id="bib43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lun</surname><given-names>ATL</given-names></name>, <name name-style="western"><surname>McCarthy</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Marioni</surname><given-names>JC</given-names></name></person-group><article-title>A step-by-step workflow for low-level analysis of single-cell RNA-seq data with Bioconductor</article-title>. <source>F1000Res</source>. <year>2016</year>;<volume>5</volume>.</mixed-citation>
    </ref>
    <ref id="bib44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Soneson</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Robinson</surname><given-names>MD</given-names></name></person-group><article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title>. <source>Nat Methods</source>. <year>2018</year>;<volume>15</volume>(<issue>4</issue>):<fpage>255</fpage>–<lpage>61</lpage>.<pub-id pub-id-type="pmid">29481549</pub-id></mixed-citation>
    </ref>
    <ref id="bib45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Parekh</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ziegenhain</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Vieth</surname><given-names>B</given-names></name>, <etal/></person-group><article-title>Supporting data for ‘zUMIs - A fast and flexible pipeline to process RNA sequencing data with UMIs.’</article-title>. <source>GigaScience Database</source>. <year>2018</year>;<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.5524/100447">http://dx.doi.org/10.5524/100447</ext-link>.</mixed-citation>
    </ref>
    <ref id="bib46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Grün</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Kester</surname><given-names>L</given-names></name>, <name name-style="western"><surname>van Oudenaarden</surname><given-names>A</given-names></name></person-group><article-title>Validation of noise models for single-cell transcriptomics</article-title>. <source>Nat Methods</source>. <year>2014</year>;<volume>11</volume>(<issue>6</issue>):<fpage>637</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">24747814</pub-id></mixed-citation>
    </ref>
    <ref id="bib47">
      <label>47.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tian</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Su</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Amann-Zalcenstein</surname><given-names>D</given-names></name><etal/></person-group><article-title>scPipe: a flexible data preprocessing pipeline for single-cell RNA-sequencing data</article-title>. <source>bioRxiv</source>. <year>2017</year>;<fpage>p. 175927</fpage>.</mixed-citation>
    </ref>
    <ref id="bib48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Islam</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Zeisel</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Joost</surname><given-names>S</given-names></name><etal/></person-group><article-title>Quantitative single-cell RNA-seq with unique molecular identifiers</article-title>. <source>Nat Methods</source>. <year>2014</year>;<volume>11</volume>(<issue>2</issue>):<fpage>163</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">24363023</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
