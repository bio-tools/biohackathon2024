<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3572422</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-13-238</article-id>
    <article-id pub-id-type="pmid">22988817</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-13-238</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Mapping single molecule sequencing reads using basic local alignment with successive refinement (BLASR): application and theory</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Chaisson</surname>
          <given-names>Mark J</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>mchaisso@gmail.com</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A2">
        <name>
          <surname>Tesler</surname>
          <given-names>Glenn</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>gptesler@math.ucsd.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department Secondary Analysis, Pacific Biosciences, 1005 Hamilton Rd, CA, Menlo Park, USA</aff>
    <aff id="I2"><label>2</label>Department of Mathematics, University of California, San Diego, 9500 Gilman Dr, CA, La Jolla, USA</aff>
    <pub-date pub-type="collection">
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>9</month>
      <year>2012</year>
    </pub-date>
    <volume>13</volume>
    <fpage>238</fpage>
    <lpage>238</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>3</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>9</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2012 Chaisson and Tesler; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <copyright-holder>Chaisson and Tesler; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (
<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/13/238"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Recent methods have been developed to perform high-throughput sequencing of DNA by Single Molecule Sequencing (SMS). While Next-Generation sequencing methods may produce reads up to several hundred bases long, SMS sequencing produces reads up to tens of kilobases long. Existing alignment methods are either too inefficient for high-throughput datasets, or not sensitive enough to align SMS reads, which have a higher error rate than Next-Generation sequencing.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We describe the method BLASR (Basic Local Alignment with Successive Refinement) for mapping Single Molecule Sequencing (SMS) reads that are thousands of bases long, with divergence between the read and genome dominated by insertion and deletion error. The method is benchmarked using both simulated reads and reads from a bacterial sequencing project. We also present a combinatorial model of sequencing error that motivates why our approach is effective.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>The results indicate that it is possible to map SMS reads with high accuracy and speed. Furthermore, the inferences made on the mapability of SMS reads using our combinatorial model of sequencing error are in agreement with the mapping accuracy demonstrated on simulated reads.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>The first step in a resequencing study is to map reads from a sample genome onto a reference, accounting for sample variance and sequencing error. An accurate and sensitive approach is to use Smith-Waterman
[<xref ref-type="bibr" rid="B1">1</xref>] alignment; however, this is computationally infeasible for mapping to nearly any genome. Instead, methods have been created using heuristics and data structures that are appropriate for rapid mapping of the type of read considered. For example, reads produced by Sanger sequencing that are highly accurate and nearly 1000 bases long are successfully mapped using hash-based methods such as MEGABLAST
[<xref ref-type="bibr" rid="B2">2</xref>], cross_match (Green P.,
<ext-link ext-link-type="uri" xlink:href="http://www.phrap.org">http://www.phrap.org</ext-link>, <italic>unpublished</italic>), and BLAT
[<xref ref-type="bibr" rid="B3">3</xref>]. These methods are too inefficient to map read sets from next generation sequencing (NGS) instruments by Illumina (San Diego, CA, USA) and Life Technologies (Carlsbad, CA, USA), since they contain hundreds of millions of short reads. Instead, methods such as Bowtie, Bwa, and Soap2 are used
[<xref ref-type="bibr" rid="B4">4</xref>-<xref ref-type="bibr" rid="B6">6</xref>]. These are based on querying the Burrows-Wheeler Transform Full-text Minute-space index (BWT-FM)
[<xref ref-type="bibr" rid="B7">7</xref>] of a genome. They are able to rapidly align reads when there is little variation between the read and the genome.</p>
    <p>Sequencing methods based on single molecule sequencing (SMS) also produce large datasets that have high computational demands for mapping. SMS datasets do not have the length limitations of NGS or Sanger sequencing, but have a higher number of errors, and the errors are primarily insertions and deletions rather than substitutions. Thus, mapping methods created for NGS sequencing do not extend well to SMS reads. A recent study using the PacBio<italic>RS</italic> platform
[<xref ref-type="bibr" rid="B8">8</xref>] included a large number of reads over 10 kilobases long. As reads become longer, the computational problem begins to resemble the whole genome alignment (WGA) problems that were examined when multiple mammalian genomes were sequenced
[<xref ref-type="bibr" rid="B9">9</xref>-<xref ref-type="bibr" rid="B11">11</xref>]. The problem arises of how to align long (many kilobase) reads with moderate divergence from the genome (up to 20% divergence, concentrated in insertions and deletions) at the speed and sensitivity that NGS alignment methods operate.</p>
    <p>Many alignment methods in similar application areas share related algorithmic approaches or data structures that are tailored to optimize the particular targeted application. The relationship between many existing alignment methods
[<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B3">3</xref>-<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B10">10</xref>-<xref ref-type="bibr" rid="B23">23</xref>] is qualitatively illustrated in Figure
<xref ref-type="fig" rid="F1">1</xref>. We present an approach, Basic Local Alignment via Successive Refinement (BLASR), which maps reads using coarse alignment methods developed during WGA studies, while speeding up these methods by using the advanced data structures employed in many NGS mapping studies.</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p><bold>An illustration of relationships between alignment methods.</bold> The applications / corresponding computational restrictions shown are (green) short pairwise alignment / detailed edit model; (yellow) database search / divergent homology detection; (red) whole genome alignment / alignment of long sequences with structural rearrangements; and (blue) short read mapping / rapid alignment of massive numbers of short sequences. Although solely illustrative, methods with more similar data structures or algorithmic approaches are on closer branches. The BLASR method combines data structures from short read alignment with optimization methods from whole genome alignment.</p>
      </caption>
      <graphic xlink:href="1471-2105-13-238-1"/>
    </fig>
    <p>Advances in isolation and detection of single molecules and reactions have enabled SMS methods
[<xref ref-type="bibr" rid="B24">24</xref>-<xref ref-type="bibr" rid="B26">26</xref>]. These SMS methods monitor processes in real time. The PacBio<italic>RS</italic> instrument produces reads by detecting which fluorescently labeled nucleotides are incorporated into a DNA chain as a template sequence is replicated by DNA polymerase. Other SMS methods have been proposed using detection of cleaved bases that pass through a protein nanopore
[<xref ref-type="bibr" rid="B25">25</xref>], and identifying bases that have translocated through a nanopore fabricated in a graphene membrane
[<xref ref-type="bibr" rid="B27">27</xref>]. In the case of the PacBio<italic>RS</italic> sequencing, a missing or weak signal of nucleotide incorporation results in a deleted base, and nucleotides that give fluorescence signal without being incorporated lead to insertions.</p>
    <p>We propose aligning SMS reads with high indel rates to genomes as follows. First, find clusters of short exact matches between the read and the genome using either a suffix array or BWT-FM index
[<xref ref-type="bibr" rid="B7">7</xref>]. Then, perform a more detailed alignment of the regions where reads are matched to assign the alignment. To investigate the feasibility of doing this in the human genome, we need to determine two metrics: (1) the number of matches of minimal length expected to exist between a read and the genome at a given sequencing accuracy and read length, and (2) the number of false positive clusters the read is expected to have elsewhere in the genome. If the chances of finding a match between the read and the genome are low, or if there are many regions a read may map to incorrectly with high identity, our proposed approach would not be feasible. For a particular read length and accuracy, we present a method to determine the probability that the read contains a sufficient number of anchors to map; this method is based on counting integer compositions. We next examine the repeat structure of the human genome to determine how difficult it is to map to due to the repetitive nature of the genome. Rather than defining repeat content as the amount of sequence sharing high percent identity, we measure a different similarity metric on the human genome, the <italic>anchor similarity</italic>, where sequence similarity is measured as the number of shared anchors between the two sequences from the genome. We find that there are both a high number of expected matches between the read and the genome, and few false positive clusters of matches of the same size elsewhere in the genome, indicating that the proposed approach is feasible for mapping reads to the human genome.</p>
    <p>We implemented our method in a program called BLASR (Basic Local Alignment with Successive Refinement), which combines the data structures used in short read mapping with alignment methods used in whole genome alignment. A BWT-FM index or suffix array of a genome is queried to generate short exact matches that are clustered and give approximate coordinates in the genome for where a read should align. A rough alignment is generated using sparse dynamic programming on a set of short exact matches in the read to the region it maps to, and a final detailed alignment is generated using dynamic programming within an area guided by the sparse dynamic programming alignment.</p>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <p>Our results are broken down into two sections; in the first, we examine characteristics of PacBio<italic>RS</italic> reads, and present theory on how these sequences contain matches that may be used to anchor alignments to the genome. In the next, we present a practical comparison of alignment methods on PacBio<italic>RS</italic> sequences.</p>
    <sec>
      <title>Mapping feasibility</title>
      <p>Our strategy to map SMS reads is to locate a relatively small number of candidate intervals where the read may map and then use detailed pairwise alignments to determine the best candidate. The candidate intervals may be found by locating all exact matches between the read and the genome, and then finding dense clusters of exact matches (anchors) in spans of similar length and the same (or reverse complement) order and orientation in both the genome and read, as described in detail in Methods. The feasibility of the method depends on the balance of having enough anchors to detect the correct interval to align a read to, vs. having so many anchors that clustering takes a prohibitive amount of time.</p>
      <p>One approach to limiting the number of anchors is to limit to a set of anchors of low multiplicity in the genome; this is commonly done by using longer anchors. When the sequencing error rate is <italic>ρ</italic>per position, without positional bias, the average length of an exact match is
<inline-formula><mml:math id="M1" name="1471-2105-13-238-i1" overflow="scroll"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> bases. For <italic>ρ</italic> = 0<italic>.</italic>15, the average length is
<inline-formula><mml:math id="M2" name="1471-2105-13-238-i2" overflow="scroll"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>≈</mml:mo><mml:mn>5</mml:mn><mml:mi>.</mml:mi><mml:mn>67</mml:mn></mml:math></inline-formula>. Every word of length 5 occurs on average over 3 million times in the human genome, far too many times to be suitable as an anchor for rapid alignment. Fortunately, the condition that a sequencing error occurs precisely every ⌊1/<italic>ρ</italic>⌋ bases is worst-case, and is exceedingly rare: for a sequence of length <italic>L</italic> with roughly <italic>E</italic> = <italic>ρL</italic> sequencing errors, this only happens with probability on the order of
<inline-formula><mml:math id="M3" name="1471-2105-13-238-i3" overflow="scroll"><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>E</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:math></inline-formula>. Rather than focusing on the average case, it is more informative to consider the distribution of runs of error-free sequences; for a uniform distribution of errors across a read, this is a geometric distribution. To look at the empirical distribution of error-free sequences, a sample of reads from <italic>Escherichia coli</italic> sequenced by a PacBio<italic>RS</italic> was aligned back to the reference. The resulting distribution of spans of error-free sequences is shown in Figure
<xref ref-type="fig" rid="F2">2</xref>, and closely follows the geometric distribution for over 95% of the data.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>The distribution of lengths of error-free segments of reads.</bold> The line fitted to the points weighted by frequency has slope −0.071, corresponding to a geometric distribution with parameter 0.848, in close agreement with the 84.5% accuracy of the dataset used. Over 95% of segments are of length 20 less.</p>
        </caption>
        <graphic xlink:href="1471-2105-13-238-2"/>
      </fig>
      <p>We may model SMS sequencing as a process that generates a series of error-free words with a geometric length distribution, each separated by a single erroneous base. With this model, it is possible to determine how many words must be sequenced until there is a high probability that a word of length <italic>K</italic> or greater (suitable for use in anchoring an alignment) has been sequenced. Denoting the length of a word as <italic>W </italic>, Pr{<italic>W</italic> = <italic>K</italic>} = (1 − <italic>ρ</italic>)<sup><italic>K</italic></sup><italic>ρ</italic>, and Pr{<italic>W</italic> ≥ <italic>K</italic>} = (1−<italic>ρ</italic>)<sup><italic>K</italic></sup>, where <italic>K</italic>≥0. In order to have a probability of 1 − <italic>ε</italic>that a word of length <italic>K</italic> or greater is sequenced without error, <italic>t</italic> words must be sequenced, where
<inline-formula><mml:math id="M4" name="1471-2105-13-238-i4" overflow="scroll"><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mi>ε</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>log</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>K</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:math></inline-formula>. The <bold>waiting length</bold> is the corresponding number of bases for <italic>t</italic> words, each followed by one incorrect base. The waiting length is </p>
      <p>
        <disp-formula>
          <mml:math id="M5" name="1471-2105-13-238-i5" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd columnalign="left">
                  <mml:mi>t</mml:mi>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mspace width="0.3em"/>
                      <mml:mo>+</mml:mo>
                      <mml:mspace width="0.3em"/>
                      <mml:munderover accentunder="false" accent="false">
                        <mml:mrow>
                          <mml:mi mathsize="big">∑</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>K</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mi>i</mml:mi>
                      <mml:mtext>Pr</mml:mtext>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>W</mml:mi>
                        <mml:mspace width="0.3em"/>
                        <mml:mo>=</mml:mo>
                        <mml:mspace width="0.3em"/>
                        <mml:mi>i</mml:mi>
                        <mml:mo>|</mml:mo>
                        <mml:mi>W</mml:mi>
                        <mml:mspace width="0.3em"/>
                        <mml:mo>&lt;</mml:mo>
                        <mml:mspace width="0.3em"/>
                        <mml:mi>K</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mspace width="0.3em"/>
                </mml:mtd>
                <mml:mtd columnalign="left">
                  <mml:mspace width=".9em"/>
                  <mml:mo>=</mml:mo>
                </mml:mtd>
                <mml:mtd columnalign="left">
                  <mml:mi>t</mml:mi>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>+</mml:mo>
                      <mml:munderover accentunder="false" accent="false">
                        <mml:mrow>
                          <mml:mi mathsize="big">∑</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>K</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mi>i</mml:mi>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>−</mml:mo>
                              <mml:mi>ρ</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mi>ρ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mo>(</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>−</mml:mo>
                              <mml:mi>ρ</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>K</mml:mi>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mo>)</mml:mo>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd/>
                <mml:mtd columnalign="left">
                  <mml:mspace width=".9em"/>
                  <mml:mo>=</mml:mo>
                </mml:mtd>
                <mml:mtd columnalign="left">
                  <mml:mi>t</mml:mi>
                  <mml:mfenced open="(" close=")">
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>ρ</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:mo>−</mml:mo>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>K</mml:mi>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>−</mml:mo>
                              <mml:mi>ρ</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>K</mml:mi>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mo>(</mml:mo>
                              <mml:mn>1</mml:mn>
                              <mml:mo>−</mml:mo>
                              <mml:mi>ρ</mml:mi>
                              <mml:mo>)</mml:mo>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>K</mml:mi>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mspace width="2.77695pt"/>
                  <mml:mi>.</mml:mi>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>The waiting lengths for words of size 15, 20, and 25 are shown for <italic>ε</italic> = 0<italic>.</italic>05 and varying <italic>ρ</italic>in Figure
<xref ref-type="fig" rid="F3">3</xref>. We refer to error-free sequences of length <italic>K</italic> or greater as <bold>anchors</bold>.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Waiting length to sequence a word of length</bold><bold><italic>≥</italic></bold><bold><italic>k</italic></bold><bold>at</bold><bold><italic>ε = 0.05</italic></bold><bold>.</bold> The waiting lengths to sequence a word of length ≥ k at ε = 0.05 at varrying accuracy. This gives an estimate of the number of bases required to sequence before having an error free stretch that may serve as an alignment anchor.</p>
        </caption>
        <graphic xlink:href="1471-2105-13-238-3"/>
      </fig>
      <p>Other alignment methods such as Gapped BLAST
[<xref ref-type="bibr" rid="B28">28</xref>] and BLAT
[<xref ref-type="bibr" rid="B3">3</xref>] have shown that it is useful to initiate alignments at pairs of anchors. The waiting lengths may be used to compute the length of read required to be certain of having at least N anchors. Instead of using waiting lengths, it is possible to directly compute the probability of sequencing a certain number of anchors when the error rate is known. We do this with a model that approximates all errors as point mutations on a scan across a template. Given a fixed template length L, a minimal anchor length K, a number of errors M, and a number of anchors N, define <bold>NumConfigurations</bold><bold><italic>(M,N,K,L)</italic></bold> as the number ways to distribute the positions of M errors when reading from the template such that there are at least N maximal substrings of length ≥ K not interrupted by error. In Appendix 1, we compute this using generating functions, allowing us to apply the result across the read lengths and error profiles found in SMS sequencing. Weese et al.
[<xref ref-type="bibr" rid="B29">29</xref>] considered a similar problem for short reads and low error rates, and set bounds for filtering alignment hits in a q-gram based mapping method by using a dynamic programming approach.</p>
      <p>Assuming all permutations of errors are equally likely,
<inline-formula><mml:math id="M6" name="1471-2105-13-238-i6" overflow="scroll"><mml:mtext>NumConfigurations</mml:mtext><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:math></inline-formula> gives the probability of sequencing at least N anchors. We computed this probability for the parameters L = 1000, and K = 15, 20, and 25, to study the number of anchors to use for mapping. The results are shown in Figure
<xref ref-type="fig" rid="F4">4</xref> for M = 200, 150, 100, and 50, corresponding to read accuracies of 80%, 85%, 90%, and 95%. At an accuracy of 85%, nearly all configurations have at least 10 anchors of length at least 15. This indicates that with minimum anchor size K = 15, one would would expect to find at least 10 anchors at the correctly mapped interval in the genome.</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Values for</bold><inline-formula><mml:math id="M7" name="1471-2105-13-238-i8" overflow="scroll"><mml:mtext mathvariant="bold">NumConfigurations</mml:mtext><mml:mo mathvariant="bold">(</mml:mo><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo mathvariant="bold-italic">,</mml:mo><mml:mi mathvariant="bold-italic">N</mml:mi><mml:mo mathvariant="bold-italic">,</mml:mo><mml:mi mathvariant="bold-italic">K</mml:mi><mml:mo mathvariant="bold-italic">,</mml:mo><mml:mi mathvariant="bold-italic">L</mml:mi><mml:mo mathvariant="bold-italic">)</mml:mo><mml:mo>/</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:math></inline-formula><bold>for parameters similar to SMS sequencing.</bold> The fraction of configurations allowing at least N anchors of length 15, 20, and 25 for N between 0 and 50 are shown for a 1000 base read when placing (<bold>A</bold>) 200, (<bold>B</bold>) 150, (<bold>C</bold>) 100, and (<bold>D</bold>) 50 errors.</p>
        </caption>
        <graphic xlink:href="1471-2105-13-238-4"/>
      </fig>
      <p>When a read is sampled from a repeat in the genome, there are likely to be many dense clusters of anchors mapping the read across the genome. Assuming the repeat is divergent, it is necessary to perform a detailed alignment (Smith-Waterman) to all intervals containing dense clusters of anchors in order to distinguish the correct mapping location from other repeats. For copies of a repeat such as Alu or LINE in the human genome, the computational demands are too prohibitive to align the read against all instances of the repeat. On the other hand, if only a limited number of mapped locations are aligned in detail, the chance of finding the correct location is small. The similarity of repeats in a genome is typically defined by percent identity from a pairwise alignment of the two sequences
[<xref ref-type="bibr" rid="B30">30</xref>]. However, sequences that have a high percent similarity may not share many long stretches of exact matches, which is how they are compared when using anchor-based mapping. To characterize repeats with respect to anchor-based mapping, we introduce an alternative metric: the <bold>anchor similarity</bold> of two sequences is the maximum number of fixed-length, non-overlapping, ordered anchors, shared between two sequences, with certain constraints on anchor spacing. If the anchor similarity is S, we also say the two sequences are <bold><italic>S</italic></bold><bold>-similar</bold>, and <bold><italic>≥</italic></bold><bold><italic>S</italic></bold><bold>-similar</bold> when two sequences have anchor similarity that is at least S. Using fixed-length anchors simplifies the presentation, although the BLASR method uses variable length anchors. Anchor similarity requires two parameters: K, the minimum anchor size; and δ, the indel rate, which may change the spacing between anchors. The constraints reflect the spacing one would expect between anchors of a read with indel errors and a genome. For example, consider a sequence that contains anchors at coordinates a and b, matching anchors at coordinates a<sup>′</sup> and b<sup>′</sup>in another sequence. If the ratio of the gaps between anchors is bounded by
<inline-formula><mml:math id="M8" name="1471-2105-13-238-i9" overflow="scroll"><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo>≤</mml:mo><mml:mfrac><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:math></inline-formula> (consistent with the indel rate), then a and b may be included in the count for the anchor similarity of the two sequences. Further details on computing anchor similarity are given in the Additional file
<xref ref-type="supplementary-material" rid="S1">1</xref>: Text S1, Section 1.1.</p>
      <p>To characterize the repetitiveness by anchor similarity of sequences in the human genome, we took a sample of 1 million random intervals of length L=1 kb in the genome, and computed anchor similarity of each interval with all other intervals up to length (1 + δ)L = 1150 (assuming an indel rate δ = 0.15) in the rest of genome. We used anchors of lengths 15, 20, and 25. For each interval and anchor length, a histogram is generated for the number of times ≥S-similar intervals are found in the genome. A hypothetical sample sequence with K = 15 may have 50 thousand ≥1-similar intervals in the genome; one thousand ≥2-similar intervals; one hundred ≥3-similar sequences; ten ≥4-similar sequences; and one ≥5-similar sequence. This results in one million histograms (for each anchor length). To summarize these, we examined the cumulative distribution of values of all histograms for ≥1, ≥5, ≥10, and ≥20-similar sequences, as shown in Figure
<xref ref-type="fig" rid="F5">5</xref>.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold><italic>≥</italic></bold><bold><italic>S</italic></bold><bold>-similar sequences measured in the human genome.</bold> 1 million query intervals, each 1000 bases long, were randomly sampled from the genome. Each query interval was searched against the human genome to determine the number of non-overlapping 1000 base intervals in the genome that are ≥<italic>S</italic>-similar to the query. The cumulative distribution for the number of target intervals that are (<bold>A</bold>) ≥1-similar, (<bold>B</bold>) ≥5-similar, (<bold>C</bold>) ≥10-similar, and (<bold>D</bold>) ≥20-similar to these 1 million query intervals, is shown. Each panel uses minimum anchor lengths <italic>k</italic> = 15, 20, and 25 and indel rate <italic>δ</italic> = 0<italic>.</italic>15. From this, one may interpret the number of intervals that must be searched when mapping a read using anchors. For example, when mapping with a minimum of a single 25 base match, 80% of the queries match to 100 other intervals in the genome with at least one one 25 base match (point X). On the other extreme, the top 3% of queries map to over 1 million other with at least one matchpoint Y), due to the high repeat content of the genome. This indicates that 80% of sequences may be correctly mapped to the human genome using a single 25 base match by only searching 100 100 candidates, however for full sensitivity many more candidates must be searched. Points P and Q show a contrast of the fraction of intervals that have 100 or fewer matches in the genome when matching using 1 or more anchors versus 20 or more anchors, for an anchor length of 15. Only 20% of the samples are limited to 100 or fewer additional matching intervals with at least 1 anchor (point P), and 97.5% of the samples have 100 or fewer matches when requiring at least 20 anchors in a match (point Q).</p>
        </caption>
        <graphic xlink:href="1471-2105-13-238-5"/>
      </fig>
      <p>We compared the distribution of values of anchor similarity from the human genome with values of
<inline-formula><mml:math id="M9" name="1471-2105-13-238-i10" overflow="scroll"><mml:mtext>NumConfigurations</mml:mtext><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:math></inline-formula> to see how the mapability of sequences compares to the expected distributions of matching anchors. Reads from intervals of a genome that have low anchor-similarity to the rest of the genome are likely to have few spurious matching clusters and are thus likely to be uniquely mapped. Conversely, a read sampled from an interval that has high anchor-similarity with many other intervals likely has many clusters of matches to the genome. Figure
<xref ref-type="fig" rid="F5">5</xref> shows an estimate of the number of intervals that must be searched when using anchor-based seeding to gain a certain degree of sensitivity of finding the true match. For example, when requiring only one or more matches of length 15 to find an interval, 22% of the sequences have up to 100 matching intervals in the genome (Figure
<xref ref-type="fig" rid="F5">5</xref>A, point P). If instead 20 or more matches were required in order to find an interval, 97% of the regions of the regions sampled have up to 100 matching intervals in the genome (Figure
<xref ref-type="fig" rid="F5">5</xref>D, point Q). The combination of the values of
<inline-formula><mml:math id="M10" name="1471-2105-13-238-i11" overflow="scroll"><mml:mtext>NumConfigurations</mml:mtext><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:math></inline-formula> and intuition for the feasibility of mapping sequences at various error rates in the human genome. From Figure
<xref ref-type="fig" rid="F4">4</xref>, for reads sequenced at 85% accuracy, it is very likely there are least 8 anchors of there are least 8 anchors of length 20 or greater in any read. The green points in C show the number of matching intervals when using a similar set of parameters: at least 10 anchors of length 20. Importantly, 95% of the samples match uniquely in the genome.</p>
      <p>To gauge the mapability of sequences to various genomes, we simulated reads from <italic>Escherichia coli</italic>, <italic>Arabidopsis thaliana</italic>, and human, for read lengths that vary from 100 to 10000 bases, and error rates from 20% down to 0%. We mapped them back to their reference genomes with BLASR (see The results are shown in Figure
<xref ref-type="fig" rid="F6">6</xref>. We note for mapping to the human genome, while it is difficult to have precise predictions on the mapability of sequences, the results are in agreement with the inferences drawn from the distributions of number of anchors and anchor-similarity measures. For example, 95% of 1000-base reads from the human genome simulated with a 15% error rate map to the correct location in the genome.</p>
      <fig id="F6" position="float">
        <label>Figure 6</label>
        <caption>
          <p><bold>The mapability of simulated sequences from the</bold><bold><italic>E. coli</italic></bold><bold>,</bold><bold><italic>A. thaliana</italic></bold><bold>, and human genomes.</bold> Mapping accuracy is shown on a Phred scale (
<inline-formula><mml:math id="M11" name="1471-2105-13-238-i12" overflow="scroll"><mml:mo>−</mml:mo><mml:mn>10</mml:mn><mml:mo>log</mml:mo><mml:mfrac><mml:mrow><mml:mtext>missing</mml:mtext><mml:mo>+</mml:mo><mml:mtext>mismapped</mml:mtext></mml:mrow><mml:mrow><mml:mtext>total</mml:mtext></mml:mrow></mml:mfrac></mml:math></inline-formula>) for all three plots. Reads were simulated with base accuracies 1−<italic>ρ</italic> = 80<italic>%</italic>, 85%, … , 100%. In the fraction <italic>ρ</italic>of positions that are erroneous, we simulated 10% substitutions, 62% insertions, and 28% deletions. Missing values have no mismapped reads.</p>
        </caption>
        <graphic xlink:href="1471-2105-13-238-6"/>
      </fig>
      <p>As shown in Figure
<xref ref-type="fig" rid="F4">4</xref>B, a read with a 15% error rate has a 97% chance of having 10 anchors of length 15 or more. The anchor similarity corresponding to these reads uses parameters <italic>δ</italic> = 0<italic>.</italic>15,<italic>L</italic> = 1000, and <italic>k</italic> = 15, and is shown by the red curve in Figure
<xref ref-type="fig" rid="F5">5</xref>A. Over 90% of the sampled intervals only have one location with at least 10 anchors of length 15, indicating they map uniquely under this repeat under this repeat metric. The other two genomes, <italic>E. coli</italic>, and <italic>A. thaliana</italic>, are shown for</p>
    </sec>
    <sec>
      <title>Mapping benchmarks</title>
      <p>We generated three datasets for evaluating mapping speed and accuracy of different aligners on SMS reads (see Table
<xref ref-type="table" rid="T1">1</xref>). For all <italic>E. coli</italic> datasets, reads were aligned to the genome of an isolate of the O104:H4 strain (doi: 10.5524/100001). The source reads are available at
<ext-link ext-link-type="uri" xlink:href="http://bix.ucsd.edu/projects/blasr.">http://bix.ucsd.edu/projects/blasr.</ext-link> Performance was measured additionally with both BLAT and the BWA-SW aligners
[<xref ref-type="bibr" rid="B18">18</xref>]. BWA-SW was the first mapping method written that used both the BWT-FM index used in short read mapping and methods that allow mapping long reads with indel error. This method is very compact (under 5 GB of memory for human genome alignments), and very sensitive to mapping reads with indel error, as compared to other existing methods. Other methods that were tested either did not run or produced insufficient results. This may be expected, as these methods are highly optimized for other types of data that is either short read or whole genome sequences. Of the programs that did not run, Soap2 and Lagan crashed, while Bowtie did not accept the read input due to read length, and the mapping sensitivity was low on reads truncated to the maximum allowed length. The Mosaik (Strömberg M.,
<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.bc.edu/marthlab/Mosaik">http://bioinformatics.bc.edu/marthlab/Mosaik</ext-link>, <italic>unpublished</italic>), Mummer, and RazerS methods did execute, however the first two could only align to one chromosome of the human genome at a time due to space limitations, and were orders of magnitude slower than either BLASR or BWA-SW while finding very few hits. Finally, the RazerS method was only tested on <italic>E. coli</italic> reads, and found few hits across all tested parameters. Because of the low mapping sensitivity, these methods were excluded from benchmarking results. The BLAT method is included as a reference for comparison to methods optimized for mapping Sanger sequences, though it is slower and less sensitive than both BLASR and BWA-SW.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Datasets used in benchmarking</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left">
                <bold>Dataset</bold>
              </th>
              <th align="center">
                <bold>Description</bold>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="bottom"><italic>E. coli</italic>-PacBio<italic>RS</italic><hr/></td>
              <td align="center" valign="bottom"><italic>E. coli</italic> O104:H4 sequenced at 48× coverage by the<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom">Pacific Biosciences-<italic>RS</italic> sequencer.<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"><italic>E. coli</italic>-simulated<hr/></td>
              <td align="center" valign="bottom">50× coverage of reads simulated from <italic>E. coli</italic> O104:H4.<hr/></td>
            </tr>
            <tr>
              <td align="left">
                <italic>H. sapiens</italic>
              </td>
              <td align="center">100 MB of reads simulated from the human genome.</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>The <italic>E. coli</italic>-PacBio<italic>RS</italic> dataset contains 123,246 reads comprising 261.7 M bases after filtering, with lengths and error rate shown in Figure
<xref ref-type="fig" rid="F7">7</xref> (Short Read Archive accession numbers SRR305922, SRR305923, SRR305924, and SRR305925). The reads contain 10.7% insertion, 4.3% deletion, and 0.9% substitution error, though the details are sensitive to alignment penalty summary of the mapping statistics from each of the three programs is shown in Table
<xref ref-type="table" rid="T2">2</xref>. All programs were executed on a single core of a 2.9 GHz Xeon processor. The parameters used for each program are given in Additional file
<xref ref-type="supplementary-material" rid="S2">2</xref>: Table S1.</p>
      <fig id="F7" position="float">
        <label>Figure 7</label>
        <caption>
          <p><bold>Statistics of reads from</bold><bold><italic>E. coli</italic></bold><bold>O104:H4 produced by the PacBio</bold><bold><italic>RS</italic></bold><bold>sequencing platform.</bold> (<italic>Black</italic>) The fraction of reads with length at least <italic>x</italic>. This is roughly the survival curve of an exponential distribution. (<italic>Blue</italic>) The fraction of reads (of length at least <italic>x</italic>) that are correct at position <italic>x</italic>. Accuracy is nearly position independent, so the blue curve is roughly the constant 1−<italic>ρ</italic>, where <italic>ρ</italic>is the error rate per position.</p>
        </caption>
        <graphic xlink:href="1471-2105-13-238-7"/>
      </fig>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>
            <bold>A comparison of the BLASR, BWA-SW, and BLAT methods on</bold>
            <bold>
              <italic>E. coli</italic>
            </bold>
            <bold>reads</bold>
          </p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
            <col align="left"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left">
                <bold>Method</bold>
              </th>
              <th align="left">
                <bold>Number of aligned reads</bold>
              </th>
              <th align="left">
                <bold>Number of aligned bases</bold>
              </th>
              <th align="left">
                <bold>Run time</bold>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="bottom">BLASR-SA<hr/></td>
              <td align="justify" valign="bottom">94057<hr/></td>
              <td align="justify" valign="bottom">230.8 M<hr/></td>
              <td align="left" valign="bottom">20m 54s<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">BLASR-BWT<hr/></td>
              <td align="justify" valign="bottom">94527<hr/></td>
              <td align="justify" valign="bottom">230.1 M<hr/></td>
              <td align="left" valign="bottom">33m 57s<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">BWA-SW<hr/></td>
              <td align="justify" valign="bottom">97729<hr/></td>
              <td align="justify" valign="bottom">132.4 M<hr/></td>
              <td align="left" valign="bottom">434m 5s<hr/></td>
            </tr>
            <tr>
              <td align="left">BLAT</td>
              <td align="justify">99530</td>
              <td align="justify">181.7 M</td>
              <td align="left">4724m 40s</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Each method was used to align 48× coverage of reads from <italic>E. coli</italic> O104:H4. BLASR-SA uses a suffix array index of the genome, while BLASR-BWT uses a BWT-FM index of the genome.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>To test the sensitivity and specificity of mapping, reads were simulated using an empirical model (described in Additional file
<xref ref-type="supplementary-material" rid="S1">1</xref>: Text S1, Section 1.2) based on the measurement of error rates from reads aligned to <italic>E. coli</italic>. The results are shown in Table
<xref ref-type="table" rid="T3">3</xref>. The methods are largely in agreement on the reads that are correctly mapped, as well as in the number of bases from every read, and BLASR is marginally faster. The slight differences in mapping statistics between BLASR-SA and BLASR-BWT are due to implementation differences in the order anchors are generated: using a suffix array, sequences are searched left to right, but for a BWT-FM index, sequences are searched right to left. One difference between BLASR and BWA-SW is that BWA-SW often produces several short alignments of possibly overlapping substrings of a read rather than one contiguous alignment. We consider the number of bases mapped by BWA-SW as the sum of uniquely mapped bases from each read. Usually this does not affect mapping and consensus quality, but occasionally there are subsequences from reads that are incorrectly mapped while the rest of the read is mapped correctly.</p>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>A comparison of the BLASR, and BWA-SW methods on simulated reads</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left" valign="bottom">
                <bold>Method</bold>
                <hr/>
              </th>
              <th colspan="2" align="center" valign="bottom">
                <bold>Correctly mapped</bold>
                <hr/>
              </th>
              <th colspan="2" align="center" valign="bottom">
                <bold>Incorrectly mapped</bold>
                <hr/>
              </th>
              <th align="center" valign="bottom">
                <bold>Skipped</bold>
                <hr/>
              </th>
              <th align="center" valign="bottom">
                <bold>Runtime</bold>
                <hr/>
              </th>
              <th align="center" valign="bottom">
                <bold>Memory </bold>
                <hr/>
              </th>
              <td> </td>
            </tr>
            <tr>
              <th align="left"> </th>
              <th align="center">
                <bold>reads</bold>
              </th>
              <th align="center">
                <bold>bases</bold>
              </th>
              <th align="center">
                <bold>reads</bold>
              </th>
              <th align="center">
                <bold>bases</bold>
              </th>
              <th align="center">
                <bold>reads</bold>
              </th>
              <th align="left"> </th>
              <th align="center">
                <bold>footprint</bold>
              </th>
              <td> </td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" valign="bottom">
                <bold>
                  <italic>E. coli</italic>
                </bold>
                <hr/>
              </td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom">BLASR-SA<hr/></td>
              <td align="center" valign="bottom">108789<hr/></td>
              <td align="center" valign="bottom">266.5M<hr/></td>
              <td align="center" valign="bottom">229<hr/></td>
              <td align="center" valign="bottom">0.38M<hr/></td>
              <td align="center" valign="bottom">3766<hr/></td>
              <td align="center" valign="bottom">48m 18s<hr/></td>
              <td align="center" valign="bottom">202 MB<hr/></td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom">BLASR-BWT<hr/></td>
              <td align="center" valign="bottom">108795<hr/></td>
              <td align="center" valign="bottom">265.3M<hr/></td>
              <td align="center" valign="bottom">259<hr/></td>
              <td align="center" valign="bottom">0.45M<hr/></td>
              <td align="center" valign="bottom">3604<hr/></td>
              <td align="center" valign="bottom">59m 39s<hr/></td>
              <td align="center" valign="bottom">46 MB<hr/></td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom">BWA-SW<hr/></td>
              <td align="center" valign="bottom">111192<hr/></td>
              <td align="center" valign="bottom">261.9M<hr/></td>
              <td align="center" valign="bottom">1835<hr/></td>
              <td align="center" valign="bottom">0.91M<hr/></td>
              <td align="center" valign="bottom">3005<hr/></td>
              <td align="center" valign="bottom">223m 57s<hr/></td>
              <td align="center" valign="bottom">190 MB<hr/></td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom">
                <bold>
                  <italic>H. sapiens</italic>
                </bold>
                <hr/>
              </td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom"> <hr/></td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom">BLASR-SA<hr/></td>
              <td align="center" valign="bottom">41726<hr/></td>
              <td align="center" valign="bottom">102.3M<hr/></td>
              <td align="center" valign="bottom">1074<hr/></td>
              <td align="center" valign="bottom">1.89M<hr/></td>
              <td align="center" valign="bottom">413<hr/></td>
              <td align="center" valign="bottom">92m 26s<hr/></td>
              <td align="center" valign="bottom">14.7 GB<hr/></td>
              <td> </td>
            </tr>
            <tr>
              <td align="left" valign="bottom">BLASR-BWT<hr/></td>
              <td align="center" valign="bottom">41582<hr/></td>
              <td align="center" valign="bottom">101.7M<hr/></td>
              <td align="center" valign="bottom">1159<hr/></td>
              <td align="center" valign="bottom">1.75M<hr/></td>
              <td align="center" valign="bottom">472<hr/></td>
              <td align="center" valign="bottom">53m 26s<hr/></td>
              <td align="center" valign="bottom">8.1 GB<hr/></td>
              <td> </td>
            </tr>
            <tr>
              <td align="left">BWA-SW</td>
              <td align="center">40381</td>
              <td align="center">96.3M</td>
              <td align="center">292</td>
              <td align="center">1.16M</td>
              <td align="center">1554</td>
              <td align="center">105m 24s</td>
              <td align="center">4.2 GB</td>
              <td> </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Reads are simulated from <italic>E. coli</italic> and <italic>H. sapiens</italic> with length and accuracy parameters modeled from real reads from <italic>E. coli</italic>. Skipped reads are either marked as filtered in the SAM output, or missing from the output.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>In addition to the information encoding the alignment, BLASR produces a mapping quality value for every alignment. This value represents the PHRED scale probability that the coordinates the read is aligned to in the genome are incorrect, similar to the mapping quality values produced by Maq
[<xref ref-type="bibr" rid="B20">20</xref>]. To test mapping quality values, we created three datasets of 10M simulated reads sampled from the genome with fixed read lengths of one, two, and three kilobases each. Errors were added to the reads using the empirical read simulator (Additional file
<xref ref-type="supplementary-material" rid="S1">1</xref>: Text S1, Section 1.2). For each mapped read, we classified it as correctly and incorrectly mapped, allowing a measurement of accuracy of mapping quality value. The frequency of computed mapping quality values are shown in Figure
<xref ref-type="fig" rid="F8">8</xref>A. The mapping quality values are largely binary, owing to the fact most reads contain sequences that align uniquely to the genome. The empirical mapping quality values are shown in Figure
<xref ref-type="fig" rid="F8">8</xref>B.</p>
      <fig id="F8" position="float">
        <label>Figure 8</label>
        <caption>
          <p><bold>Mapping quality values of reads simulated from the human genome.</bold> (<bold>A</bold>) The frequency of quality values for alignments of 10<sup>6</sup>simulated 1000, 2000, and 3000 base sequences from the human genome. (<bold>B</bold>) The empirical mapping quality values of the alignments.</p>
        </caption>
        <graphic xlink:href="1471-2105-13-238-8"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusion</title>
    <p>Methods to produce reads through single molecule sequencing were mostly theoretical a decade ago and are now produced in high throughput on an industrial platform. The different characteristics of the sequences produced by SMS relative to Next Generation sequencing (sequences several orders of magnitude longer than previous technologies, at the expense of a higher error rate concentrated in insertions and deletions), require new computational techniques to be efficiently analyzed. Here, we addressed the problem of mapping SMS reads to a reference genome by first examining the feasibility of mapping SMS reads, and then by benchmarking our new alignment method on reads produced by the PacBio<italic>RS</italic> instrument. The source code is available under the BSD license at
<ext-link ext-link-type="uri" xlink:href="https://github.com/PacificBiosciences/blasr">https://github.com/PacificBiosciences/blasr</ext-link> and is the default alignment method available to all running the PacBio<italic>RS</italic>.</p>
    <p>There are many emerging problems for processing SMS sequences. As the length of the reads produced by SMS increases, the computational problem resembles whole genome alignment more than the read mapping problem. This increases the need to have methods that accurately detect structural rearrangements covered by single reads. Furthermore, with the inevitable exponential increase in sequencing throughput, the current methods will not be sufficient to align SMS reads without a large amount of time or computational resources, and further algorithmic improvements will be necessary. We did not address the issue of using multiple sequence alignment to produce a consensus sequence or variant calls. It has been shown that the additional information one may gain by observing the signal from single-molecule events in real time may indicate DNA modifications such as methylation
[<xref ref-type="bibr" rid="B25">25</xref>,<xref ref-type="bibr" rid="B31">31</xref>]. Thus, methods that produce consensus calls from SMS sequences may reveal more information about the sample sequence if this extra information is used. We aim to address many of these problem in subsequent iterations of the BLASR method.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>We use a <italic>successive refinement</italic> approach to map SMS reads. This approach operates in three phases: (1) detecting candidate intervals by clustering short, exact matches; (2) approximate alignment of reads to candidate intervals using sparse dynamic programming; and (3) detailed banded alignment using the sparse dynamic programming alignment as a guide, as shown in Figure
<xref ref-type="fig" rid="F9">9</xref>. It is not until the third step that read base positions are assigned to reference positions.</p>
    <fig id="F9" position="float">
      <label>Figure 9</label>
      <caption>
        <p><bold>Overview of the BLASR method.</bold> (<bold>A</bold>) Candidate intervals are found by mapping short, exact matches as shown by colored arrows. Either a suffix array or BWT-FM index of the genome are used to find the exact matches. Intervals are defined over clusters of matches and are ranked; intervals with score 3, 6, and 4 are shown. (<bold>B</bold>) Matches scoring above a threshold are aligned using sparse dynamic programming on shorter exact matches. (<bold>C</bold>) Alignments that have a high-scoring sparse-dynamic programming score are realigned by dynamic programming over a subset of cells defined using the sparse dynamic programming alignment as a guide.</p>
      </caption>
      <graphic xlink:href="1471-2105-13-238-9"/>
    </fig>
    <sec>
      <title>Detecting candidate intervals</title>
      <p>The input to the BLASR method is a read <italic>r</italic> with nucleotides <italic>r</italic><sub>1</sub>,…,<italic>r</italic><sub><italic>R</italic></sub>; a genome <italic>g</italic> with nucleotides <italic>g</italic><sub>1</sub>,…,<italic>g</italic><sub><italic>G</italic></sub>; and a minimum match length, <italic>K</italic>. Other parameters that modify small details of mapping are introduced in their context later. We find all exact matches of substrings (of length at least <italic>K</italic>) from the read and the genome. An exact match of anchor <italic>a</italic> to the genome may be described by a triplet (Read(<italic>a</italic>), Genome(<italic>a</italic>), <italic>l</italic>(<italic>a</italic>)), where Read(<italic>a</italic>) is the start of the match in the read; Genome(<italic>a</italic>) is the start of the match in the genome; and <italic>l</italic>(<italic>a</italic>) is the length of the match. The set of all matches is
<inline-formula><mml:math id="M12" name="1471-2105-13-238-i13" overflow="scroll"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula>.</p>
      <p>We use either a suffix array (SA) or BWT-FM index on the genome to query for exact matches, depending on time and space requirements. While some NGS alignment methods such as mrFAST and RazerS match using hash tables on fixed width words (<italic>q</italic>-grams)
[<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B32">32</xref>], the SA and BWT-FM index allow matching long exact matches if they exist, and also encode positions of shorter matches if a more sensitive search is required. The two data structures support the same queries: <italic>c</italic> = Count(<italic>q</italic><italic>t</italic>), the number of times a query sequence <italic>r</italic> occurs exactly in a text <italic>g</italic>; and
<inline-formula><mml:math id="M13" name="1471-2105-13-238-i14" overflow="scroll"><mml:mi mathvariant="script">P</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>}</mml:mo><mml:mo>=</mml:mo><mml:mtext>Locate</mml:mtext><mml:mo>(</mml:mo><mml:mi>q</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, the starting positions of all instances of <italic>r</italic> in <italic>g</italic>. Without changing the computational complexity of these queries, they may be modified to answer equivalent queries for counts and locations of the longest common prefix (LCP) between a query and a genome. Let (<italic>c</italic><italic>l</italic>) = COUNTLCP(<italic>q</italic><italic>t</italic>) be the operation that finds the count <italic>c</italic> and length <italic>l</italic> of the LCP between <italic>q</italic> and <italic>t</italic>. We locate anchors by greedily finding matches slightly <italic>shorter</italic> than the LCP (specified by a parameter defaulting to 1 base shorter than the LCP) to increase sensitivity and avoid using an LCP that erroneously ends in a sequencing error. The minimum length anchor that is allowed is of length <italic>K</italic>, where <italic>K</italic> = 12 in most applications. To build
<inline-formula><mml:math id="M14" name="1471-2105-13-238-i15" overflow="scroll"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula>, we scan across all positions in a read <italic>i</italic> ∈ {1,…,<italic>R</italic> − <italic>k</italic>}; we compute (<italic>c</italic><italic>l</italic><sub><italic>i</italic></sub>) = <sc>COUNT</sc><sc>LCP</sc>(<italic>r</italic><sub><italic>i</italic>,…,<italic>R</italic></sub><italic>g</italic>) and
<inline-formula><mml:math id="M15" name="1471-2105-13-238-i16" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>Locate</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>g</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>; and then for all positions
<inline-formula><mml:math id="M16" name="1471-2105-13-238-i17" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula>, we include in
<inline-formula><mml:math id="M17" name="1471-2105-13-238-i18" overflow="scroll"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> a match <italic>a</italic> with Read(<italic>a</italic>)=<italic>i</italic>,
<inline-formula><mml:math id="M18" name="1471-2105-13-238-i19" overflow="scroll"><mml:mfenced><mml:mrow><mml:mtext>Genome</mml:mtext><mml:mo>(</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mfenced></mml:math></inline-formula>, and <italic>l</italic>(<italic>a</italic>) = <italic>l</italic><sub><italic>i</italic></sub>. We choose a parameter <sc>MaxCount</sc>, which specifies the maximum number of times we allow a match to appear to generate an anchor. We exclude positions mapped when
<inline-formula><mml:math id="M19" name="1471-2105-13-238-i20" overflow="scroll"><mml:mo>|</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:mtext mathvariant="normal">MaxCount</mml:mtext></mml:math></inline-formula>, or short matches when <italic>l</italic><sub><italic>i</italic></sub> &lt; <italic>k</italic>.</p>
      <p>Descriptions of the implementation and methods for the Count and Locate queries using suffix arrays are given in
[<xref ref-type="bibr" rid="B33">33</xref>]. Similar descriptions for the BWT-FM index are in
[<xref ref-type="bibr" rid="B7">7</xref>] and
[<xref ref-type="bibr" rid="B4">4</xref>]. The <sc>CountLcp</sc> operation is about 1.5× faster using a suffix array than a BWT-FM index, in our tests searching the human genome and limiting the number of times an LCP occurs to 10,000; however, the space usage for the index on a human genome is 12.8 GB with a suffix array, vs. 4.8 GB in our implementation of a BWT-FM index. Our implementation of the Locate operation is faster for larger genomes using the BWT-FM index than the suffix array when using SIMD hardware optimization. Because either index is shared across many threads, the amortized space usage is modest for both data structures.</p>
      <p>Once the set of anchors
<inline-formula><mml:math id="M20" name="1471-2105-13-238-i21" overflow="scroll"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> is generated, we cluster anchors using global chaining
[<xref ref-type="bibr" rid="B34">34</xref>]. To do so, we first sort
<inline-formula><mml:math id="M21" name="1471-2105-13-238-i22" overflow="scroll"><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula> by position in the genome and then by position in the read. Next, clusters of anchors are found in intervals roughly the length of the read. For every anchor
<inline-formula><mml:math id="M22" name="1471-2105-13-238-i23" overflow="scroll"><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">A</mml:mi></mml:math></inline-formula>, a set
<inline-formula><mml:math id="M23" name="1471-2105-13-238-i24" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is created with
<inline-formula><mml:math id="M24" name="1471-2105-13-238-i25" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="script">A</mml:mi><mml:mo>:</mml:mo><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mspace width="0.3em"/><mml:mtext>Genome</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mo>ł</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mspace width="0.3em"/><mml:mtext>Genome</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>≤</mml:mo><mml:mi>R</mml:mi><mml:mo>}</mml:mo></mml:math></inline-formula>. For every set
<inline-formula><mml:math id="M25" name="1471-2105-13-238-i26" overflow="scroll"><mml:mfenced><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>, we find a maximal subset (using global chaining) of anchors,
<inline-formula><mml:math id="M26" name="1471-2105-13-238-i27" overflow="scroll"><mml:mfenced><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>⊂</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>, that are not overlapping and are increasing in both Read(<italic>a</italic>) and Genome(<italic>a</italic>). For later use in evaluating the mapping quality value of a read, for each cluster, we record the sum of all ł(<italic>a</italic>) values for all anchors in
<inline-formula><mml:math id="M27" name="1471-2105-13-238-i28" overflow="scroll"><mml:mfenced><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p>
      <p>The clusters are assigned a frequency weighted score that is the sum
<inline-formula><mml:math id="M28" name="1471-2105-13-238-i29" overflow="scroll"><mml:mfenced><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder><mml:mtext>log</mml:mtext><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mspace width="0.3em"/><mml:mtext>Freq</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math></inline-formula>, where Freq(<italic>a</italic><sub><italic>j</italic></sub>) is the frequency of the sequence of <italic>a</italic><sub><italic>j</italic></sub> in the genome, and are ranked by this score. Only the top MAXCANDIDATES clusters are retained (typically 10). The original indexing of clusters by anchor position is replaced by indexing by rank of the frequency-weighted score. The subscript notation is dropped and rank of a cluster is indicated by the superscript. The remaining clusters are denoted
<inline-formula><mml:math id="M29" name="1471-2105-13-238-i30" overflow="scroll"><mml:mfenced><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></inline-formula>, where
<inline-formula><mml:math id="M30" name="1471-2105-13-238-i31" overflow="scroll"><mml:mfenced><mml:mrow><mml:mtext>rank</mml:mtext><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>≤</mml:mo><mml:mtext>rank</mml:mtext><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>)</mml:mo><mml:mo>≤</mml:mo><mml:mo>…</mml:mo><mml:mo>≤</mml:mo><mml:mtext>rank</mml:mtext><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math></inline-formula>, and <italic>n</italic> ≤ MAXCANDIDATES.</p>
      <p>While limiting the number of clusters retained may miss alignments to repetitive regions, filtering clusters on this frequency-weighted score was shown to be highly discriminative in our tests.</p>
    </sec>
    <sec>
      <title>Refining alignments</title>
      <p>Each cluster
<inline-formula><mml:math id="M31" name="1471-2105-13-238-i32" overflow="scroll"><mml:mfenced><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></inline-formula> is used to define an interval to which the read is realigned and rescored using sparse dynamic programming (SDP)
[<xref ref-type="bibr" rid="B35">35</xref>]. To help describe how the interval is defined, let <italic>a</italic><sup>FIRST</sup>(<italic>a</italic><sup>LAST</sup>) be the anchors with least (greatest) Genome(<italic>a</italic>) and Read(<italic>a</italic>) coordinates in
<inline-formula><mml:math id="M32" name="1471-2105-13-238-i33" overflow="scroll"><mml:mfenced><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></inline-formula>, ordered by position in genome and then by read. The anchors in
<inline-formula><mml:math id="M33" name="1471-2105-13-238-i34" overflow="scroll"><mml:mfenced><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></inline-formula> frequently do not contain the first and last bases in the read, and the actual starting and ending positions of the read are unknown due to insertion and deletion error in the read. Considering <italic>δ</italic> to be the maximum insertion rate of the instrument, the starting position of the interval aligned from the genome is <italic>s</italic> = Genome(<italic>a</italic><sup>FIRST</sup>) − (1 + <italic>δ</italic>)Read(<italic>a</italic><sup>FIRST</sup>), and ending position <italic>f</italic> = Genome(<italic>a</italic><sup>LAST</sup>) + (1 + <italic>δ</italic>)(<italic>R</italic>−(Read(<italic>a</italic><sup>LAST</sup>) + <italic>l</italic>(<italic>a</italic><sup>LAST</sup>))), of length
<inline-formula><mml:math id="M34" name="1471-2105-13-238-i35" overflow="scroll"><mml:mfenced><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p>
      <p>The read must be quickly aligned to a candidate interval, even if it is many tens of kilobases long. Similar to the method of anchoring the interval to the genome but on a smaller scale, a set of matches are found between the read and the candidate interval. The matches used in SDP are of a short fixed length, <italic>K</italic><sup>SDP</sup> (typically 8–11 bases). Let
<inline-formula><mml:math id="M35" name="1471-2105-13-238-i36" overflow="scroll"><mml:mfenced><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mtext>SDP</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></inline-formula> be the set of anchors of length <italic>K</italic><sup>SDP</sup> that are exact matches between the read and the genome interval <italic>g</italic><sub><italic>s</italic></sub>,…,<italic>g</italic><sub><italic>f</italic></sub>. Sparse dynamic programming finds the largest subset of anchors
<inline-formula><mml:math id="M36" name="1471-2105-13-238-i37" overflow="scroll"><mml:mfenced><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mtext>SDP</mml:mtext></mml:mrow></mml:msup><mml:mo>⊆</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="script">A</mml:mi></mml:mrow><mml:mrow><mml:mtext>SDP</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></inline-formula> that are of increasing Read(<italic>a</italic>) and Genome(<italic>a</italic>) values.</p>
      <p>The SDP alignment does not align all bases in a read, and so it is necessary to realign a final time using banded dynamic programming. For long reads with indels, the size of the band used to contain the entire alignment becomes prohibitively large. The set of anchors
<inline-formula><mml:math id="M37" name="1471-2105-13-238-i38" overflow="scroll"><mml:mfenced><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mtext>SDP</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></inline-formula> forms a guide for performing a banded dynamic programming alignment where the band follows the layout of the anchors in
<inline-formula><mml:math id="M38" name="1471-2105-13-238-i39" overflow="scroll"><mml:mfenced><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow><mml:mrow><mml:mtext>SDP</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></inline-formula>, shown in Figure
<xref ref-type="fig" rid="F9">9</xref>C. The subset of cells included from full
<inline-formula><mml:math id="M39" name="1471-2105-13-238-i40" overflow="scroll"><mml:mfenced><mml:mrow><mml:mi>R</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="script">C</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula> dynamic programming grid include a band of length <italic>b</italic><sup>SDP</sup>centered about the diagonal where there are anchors, as well as a banded alignment of size <italic>b</italic><sup>drift</sup> between anchors where <italic>b</italic><sup>drift</sup> is the off-diagonal distance between adjacent anchors + <italic>b</italic><sup>SDP</sup>.</p>
      <p>In addition to the base sequences produced by the PacBio<italic>RS</italic>, each base in the read is also given three quality values (insertion, deletion, and substitution) and two alternative base calls (substituted base and deleted base). Let
<inline-formula><mml:math id="M40" name="1471-2105-13-238-i41" overflow="scroll"><mml:mfenced><mml:mrow><mml:mi mathvariant="script">I</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>,
<inline-formula><mml:math id="M41" name="1471-2105-13-238-i42" overflow="scroll"><mml:mfenced><mml:mrow><mml:mi mathvariant="script">S</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>,
<inline-formula><mml:math id="M42" name="1471-2105-13-238-i43" overflow="scroll"><mml:mfenced><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> be the insertion, substitution, and deletion quality value arrays for a read, and
<inline-formula><mml:math id="M43" name="1471-2105-13-238-i44" overflow="scroll"><mml:mfenced><mml:mrow><mml:mi>Ŝ</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> and
<inline-formula><mml:math id="M44" name="1471-2105-13-238-i45" overflow="scroll"><mml:mfenced><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="script">D</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mfenced></mml:math></inline-formula> be the deletion and substitution nucleotide arrays. We use these quality values to compute the score of each cell <italic>s</italic><sub><italic>i</italic>,<italic>j</italic></sub> in the dynamic programming matrix according to: </p>
      <p>
        <disp-formula>
          <mml:math id="M45" name="1471-2105-13-238-i46" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mspace width="0.3em"/>
              <mml:mo>=</mml:mo>
              <mml:mspace width="0.3em"/>
              <mml:mo>min</mml:mo>
              <mml:mspace width="0.3em"/>
              <mml:mfenced open="{">
                <mml:mrow>
                  <mml:mspace width="0.3em"/>
                  <mml:mspace width="0.3em"/>
                  <mml:mtable>
                    <mml:mtr>
                      <mml:mtd>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>s</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>,</mml:mo>
                            <mml:mi>j</mml:mi>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mfenced open="{">
                          <mml:mrow>
                            <mml:mtable>
                              <mml:mtr>
                                <mml:mtd columnalign="left">
                                  <mml:mn>0</mml:mn>
                                </mml:mtd>
                                <mml:mtd>
                                  <mml:mspace width="1.5em"/>
                                  <mml:mtext>if</mml:mtext>
                                  <mml:mspace width="1em"/>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>r</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mspace width="0.3em"/>
                                  <mml:mo>=</mml:mo>
                                  <mml:mspace width="0.3em"/>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>g</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mtd>
                              </mml:mtr>
                              <mml:mtr>
                                <mml:mtd columnalign="left">
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi mathvariant="script">S</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mspace width="2em"/>
                                  <mml:mspace width="2em"/>
                                  <mml:mspace width="2em"/>
                                  <mml:mspace width="1em"/>
                                </mml:mtd>
                                <mml:mtd columnalign="left">
                                  <mml:mspace width="1.9em"/>
                                  <mml:mtext>if</mml:mtext>
                                  <mml:mspace width="1em"/>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>r</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mspace width="0.3em"/>
                                  <mml:mo>≠</mml:mo>
                                  <mml:mspace width="0.3em"/>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>g</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>,</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>Ŝ</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mspace width="0.3em"/>
                                  <mml:mo>=</mml:mo>
                                  <mml:mspace width="0.3em"/>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>g</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mtd>
                              </mml:mtr>
                              <mml:mtr>
                                <mml:mtd columnalign="left">
                                  <mml:mtext>MISMATCHPRIOR</mml:mtext>
                                </mml:mtd>
                                <mml:mtd columnalign="left">
                                  <mml:mspace width="2em"/>
                                  <mml:mtext>otherwise</mml:mtext>
                                </mml:mtd>
                              </mml:mtr>
                            </mml:mtable>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>s</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>,</mml:mo>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi mathvariant="script">I</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mspace width="2em"/>
                        <mml:mspace width="2em"/>
                        <mml:mspace width="2em"/>
                        <mml:mspace width="1em"/>
                        <mml:mspace width="2em"/>
                        <mml:mspace width="2em"/>
                        <mml:mspace width="1em"/>
                        <mml:mspace width="1em"/>
                        <mml:mspace width="1em"/>
                        <mml:mspace width="1em"/>
                        <mml:mspace width="1em"/>
                        <mml:mspace width="0.3em"/>
                        <mml:mspace width="0.3em"/>
                        <mml:mspace width="0.3em"/>
                        <mml:mspace width="0.3em"/>
                        <mml:mspace width="0.3em"/>
                        <mml:mspace width="0.3em"/>
                        <mml:mspace width="0.3em"/>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd columnalign="left">
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>s</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>j</mml:mi>
                            <mml:mo>−</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mfenced open="{">
                          <mml:mrow>
                            <mml:mtable>
                              <mml:mtr>
                                <mml:mtd>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi mathvariant="script">D</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mspace width="2em"/>
                                  <mml:mspace width="2em"/>
                                  <mml:mspace width="2em"/>
                                </mml:mtd>
                                <mml:mtd>
                                  <mml:mspace width="1em"/>
                                  <mml:mtext>if</mml:mtext>
                                  <mml:mspace width="1em"/>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mover accent="true">
                                        <mml:mrow>
                                          <mml:mi mathvariant="script">D</mml:mi>
                                        </mml:mrow>
                                        <mml:mo>^</mml:mo>
                                      </mml:mover>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>i</mml:mi>
                                    </mml:mrow>
                                  </mml:msub>
                                  <mml:mo>=</mml:mo>
                                  <mml:msub>
                                    <mml:mrow>
                                      <mml:mi>g</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>j</mml:mi>
                                      <mml:mo>−</mml:mo>
                                      <mml:mn>1</mml:mn>
                                    </mml:mrow>
                                  </mml:msub>
                                </mml:mtd>
                              </mml:mtr>
                              <mml:mtr>
                                <mml:mtd>
                                  <mml:mtext>DELETIONPRIOR</mml:mtext>
                                </mml:mtd>
                                <mml:mtd>
                                  <mml:mspace width="1em"/>
                                  <mml:mtext>otherwise.</mml:mtext>
                                  <mml:mspace width="2em"/>
                                  <mml:mspace width="2em"/>
                                  <mml:mspace width="0.3em"/>
                                  <mml:mspace width="0.3em"/>
                                </mml:mtd>
                              </mml:mtr>
                            </mml:mtable>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mtd>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The MISMATCHPRIOR and DELETIONPRIOR are PHRED scaled penalties that reflect the global mismatch and deletion rates. In practice, MISMATCHPRIOR is 20 and DELETIONPRIOR is 15.</p>
    </sec>
    <sec>
      <title>Mapping quality values</title>
      <p>Due to the repetitive nature of genomes, a read often maps with a high alignment score to many locations. It is informative to calculate the probability that the interval a read is mapped to by an alignment is the correct location in the genome. This probability may be interpreted as a <italic>mapping quality</italic> value
<inline-formula><mml:math id="M46" name="1471-2105-13-238-i47" overflow="scroll"><mml:mfenced><mml:mrow><mml:mi mathvariant="script">Q</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> for an alignment, allowing downstream analysis such as variant calling to filter alignment by quality.</p>
      <p>A Bayesian probability technique was presented in
[<xref ref-type="bibr" rid="B20">20</xref>] to compute the mapping quality for short reads with base calling quality values. We present the formulation in
[<xref ref-type="bibr" rid="B20">20</xref>] using the notation in this paper: we are given read <italic>r</italic> and a position <italic>m</italic> that it is mapped to in a sequence <italic>g</italic>. The <italic>posterior mapping probability</italic> that a read <italic>r</italic> is sampled from <italic>m</italic> is computed as </p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <mml:math id="M47" name="1471-2105-13-238-i48" overflow="scroll">
            <mml:msub>
              <mml:mrow>
                <mml:mtext>Pr</mml:mtext>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>s</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo>(</mml:mo>
            <mml:mi>m</mml:mi>
            <mml:mo>|</mml:mo>
            <mml:mi>r</mml:mi>
            <mml:mo>,</mml:mo>
            <mml:mi>g</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:mo>=</mml:mo>
            <mml:mfrac>
              <mml:mrow>
                <mml:mtext>Pr</mml:mtext>
                <mml:mo>(</mml:mo>
                <mml:mi>r</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>g</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mo>…</mml:mo>
                    <mml:mo>,</mml:mo>
                    <mml:mi>m</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mi>R</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:mtext>Pr</mml:mtext>
                <mml:mo>(</mml:mo>
                <mml:mi>m</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mo mathsize="big">∑</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mtext>Pr</mml:mtext>
                <mml:mo>(</mml:mo>
                <mml:mi>r</mml:mi>
                <mml:mo>|</mml:mo>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>g</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mo>…</mml:mo>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mi>R</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>)</mml:mo>
                <mml:mtext>Pr</mml:mtext>
                <mml:mo>(</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
            </mml:mfrac>
            <mml:mo>,</mml:mo>
            <mml:mspace width="2.77695pt"/>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>i</italic> runs over all positions in the genome. The probability that position <italic>i</italic> is sampled by the sequencer is denoted Pr(<italic>i</italic>), and is considered to be uniform both here and in
[<xref ref-type="bibr" rid="B20">20</xref>]. The quantity Pr(<italic>r</italic>|<italic>g</italic><sub><italic>i</italic>,…,<italic>i</italic> + <italic>R</italic>−1</sub>) is the probability of observing the read <italic>r</italic> if the sequence at positions <italic>i</italic>,…,<italic>i</italic> + <italic>R</italic> − 1 in the genome is read by the sequencer. For reads that include base quality values <italic>q</italic>, let <italic>q</italic><sub><italic>i</italic></sub> denote the probability that a base in a read is incorrect. Then Pr(<italic>r</italic>|<italic>g</italic>) may be replaced by Pr(<italic>r</italic>|<italic>g</italic><italic>q</italic>). In
[<xref ref-type="bibr" rid="B20">20</xref>], Pr(<italic>r</italic>|<italic>g</italic><italic>q</italic>) is rapidly approximated by summing the quality values of bases that mismatch in the ungapped alignment between <italic>r</italic> and <italic>g</italic><sub><italic>i</italic>,…,<italic>i</italic> + <italic>R</italic> − 1</sub>. When there are insertions and deletions in the sequence, the value Pr(<italic>r</italic>|<italic>g</italic><sub><italic>i</italic>,…,<italic>i</italic> + <italic>R</italic> − 1</sub>) may be computed as
<inline-formula><mml:math id="M48" name="1471-2105-13-238-i49" overflow="scroll"><mml:mfenced><mml:mrow><mml:munder><mml:mrow><mml:mtext>Pr</mml:mtext></mml:mrow><mml:mrow><mml:mi>f</mml:mi></mml:mrow></mml:munder><mml:mo>(</mml:mo><mml:mi>r</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>R</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="script">H</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math></inline-formula>; this denotes the forward algorithm probability using a pairwise hidden Markov model (Pair-HMM)
<inline-formula><mml:math id="M49" name="1471-2105-13-238-i50" overflow="scroll"><mml:mfenced><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> that encodes probabilities for substitution, insertion, and deletion at every position.</p>
      <p>The denominator of Equation 1 gives the marginal probability that the read is observed from anywhere in the genome. Evaluating this full sum is computationally infeasible even for short reads and ungapped alignments. Since the probability of observing a read given a template sequence drops geometrically with divergence, most positions in the genome do not contribute significantly to the sum. For short reads, the sum is approximated in
[<xref ref-type="bibr" rid="B20">20</xref>] as the sum of the probability of the top scoring alignment and all second best alignments.</p>
      <p>In BLASR, the mapping quality value is calculated in a similar manner. The sum in Equation 1 is limited to the top <sc>MaxCandidates</sc> alignments, and is then scaled by a factor that reflects the limited sample size by aligning only at most <sc>MaxCandidates</sc> clusters. When the read is sampled from a unique region of the genome, there will be few clusters of high score, and the highest scoring cluster will likely contain the true match to the genome. However, when the read is sampled entirely from a repetitive sequence, there will be many high scoripng clusters. In this case, it is possible the cluster from the correct interval on the genome will not have high enough score to be retained in <sc>MaxCandidates</sc> clusters. To account for this, we assume that the correct interval in the genome may correspond to any significantly highly scoring cluster, and multiply the sum in Equation 1 by the ratio of the number of significant clusters found in the genome to <sc>MaxCandidates</sc>, as long as the number of significantly highly scoring clusters is greater than <sc>MaxCandidates</sc>. The significance of a cluster may be measured by comparing the number of anchors in a cluster to the number of anchors expected at the correctly mapped location. The distributions of numbers of anchors expected to correctly map were found using simulations of error processes for different error rates and read lengths; however, it is possible to model this theoretically (see the next section). The expected number of anchors a read has when mapped to the correct location is genome-independent: it depends only on the error rate, length of the read, and minimum anchor length. We use a slightly different metric, the number of anchor-bases (the total number of bases in all anchors) to measure cluster significance, and this is similarly genome-independent. For efficiency, in BLASR we precompute the expectation and variance for the number of anchor-bases for a range of feasible accuracies, read lengths, and minimum match lengths, and minimum match size. The accuracy of the highest scoring alignment is used as a proxy for the true accuracy of the read. Given the accuracy, the length of the aligned sequence, and the minimum match length, we look up the mean <italic>μ</italic> and variance <italic>σ</italic><sup>2</sup> for number of anchor bases, and count all clusters with more than <italic>μ</italic>−2<italic>σ</italic> anchor bases as significant.</p>
    </sec>
  </sec>
  <sec>
    <title>Appendix 1</title>
    <sec>
      <title>Enumeration of configurations with specified numbers of errors and anchors</title>
      <p>In this section, we will show how to explicitly compute NumConfigurations(<italic>M</italic>,<italic>N</italic>,<italic>K</italic>,<italic>L</italic>).</p>
      <p>Consider a read of length <italic>L</italic> with exactly <italic>M</italic> errors, at positions 1 ≤ <italic>x</italic><sub>1</sub> &lt; <italic>x</italic><sub>2</sub> &lt; … &lt; <italic>x</italic><sub><italic>M</italic></sub> ≤ <italic>L</italic>. Also set <italic>x</italic><sub>0</sub> = 0 and <italic>x</italic><sub><italic>M</italic> + 1</sub> = <italic>L</italic> + 1.</p>
      <p>For the sake of simplicity, we assume all sequencing errors are of length 1, but this can be generalized to insertions and deletions that change the length of the read.</p>
      <p>The error positions split the read into <bold>parts</bold> of sizes <italic>λ</italic> = <italic>x</italic><sub><italic>i</italic></sub> − <italic>x</italic><sub><italic>i</italic>−1</sub> ≥ 1 for <italic>i</italic> = 1,…,<italic>M</italic> + 1. Each part <italic>λ</italic><sub><italic>i</italic></sub> (<italic>i</italic> = 1,…,<italic>M</italic>) consists of <italic>λ</italic><sub><italic>i</italic></sub> − 1 matches followed by one mismatch. The last part consists of <italic>λ</italic><sub><italic>M</italic> + 1</sub> − 1 matches. Note that if there are two consecutive mismatches, there will be a part <italic>λ</italic><sub><italic>i</italic></sub> = 1 corresponding to 0 matches followed by one mismatch.</p>
      <p>Part sizes <italic>λ</italic><sub><italic>i</italic></sub> are related to the notation <italic>W </italic> of the Results section by <italic>λ</italic><sub><italic>i</italic></sub> = <italic>W</italic> + 1. Note that <italic>W </italic> counted only the correct positions, and we did not have a subscript (<italic>W</italic><sub><italic>i</italic></sub>) to specify the word number. In this section, <italic>λ</italic><sub><italic>i</italic></sub> counts the correct bases and also counts one incorrect base at the end, based on our simplification that all sequencing errors are of length one.</p>
      <p>Set <italic>λ</italic> = (<italic>λ</italic><sub>1</sub>,<italic>λ</italic><sub>2</sub>,…,<italic>λ</italic><sub><italic>M</italic> + 1</sub>). These are positive integers that add up to <italic>L</italic> + 1. In Combinatorics, this is called a <bold>strict composition</bold> of <italic>L</italic> + 1 into <italic>M</italic> + 1 parts. Let <italic>K</italic> be the minimum anchor length (a parameter).</p>
      <p>Consecutive errors greater than <italic>K</italic> apart (<italic>λ</italic><sub><italic>i</italic></sub> &gt; <italic>K</italic>) give segments that are <bold>anchors</bold> while consecutive errors shorter than this (<italic>λ</italic> ≤ <italic>K</italic>) give segments called <bold>short matches</bold>.</p>
      <p>In Figure
<xref ref-type="fig" rid="F10">10</xref>, we illustrate a read of length <italic>L</italic> = 7 with <italic>M</italic> = 2 error positions. For a minimum anchor length <italic>K</italic> = 3, there are 6 compositions where the first part is an anchor: </p>
      <p>
        <disp-formula>
          <mml:math id="M50" name="1471-2105-13-238-i51" overflow="scroll">
            <mml:mrow>
              <mml:mo>(</mml:mo>
              <mml:mn>4</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mn>3</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mspace width="2.77695pt"/>
              <mml:mo>(</mml:mo>
              <mml:mn>4</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mn>2</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mn>2</mml:mn>
              <mml:mo>)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mspace width="2.77695pt"/>
              <mml:mo>(</mml:mo>
              <mml:mn>4</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mn>3</mml:mn>
              <mml:mo>)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mspace width="2.77695pt"/>
              <mml:mo>(</mml:mo>
              <mml:mn>5</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mn>2</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mspace width="2.77695pt"/>
              <mml:mo>(</mml:mo>
              <mml:mn>5</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mn>2</mml:mn>
              <mml:mo>)</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mspace width="2.77695pt"/>
              <mml:mo>(</mml:mo>
              <mml:mn>6</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>)</mml:mo>
              <mml:mi>.</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <fig id="F10" position="float">
        <label>Figure 10</label>
        <caption>
          <p><bold>Toy example for counting components.</bold> A read of length <italic>L</italic> = 7 with <italic>M</italic> = 2 errors is shown, with errors in red. In general, <italic>M</italic> errors splits the read into <italic>M</italic> + 1 parts, some of which may be null; in this case, the third part is null. For anchor length threshold <italic>K</italic> = 3 (meaning parts of size &gt;3 are anchors, parts of size ≤3 are not), we have <italic>N</italic> = 1 anchor (the first part).</p>
        </caption>
        <graphic xlink:href="1471-2105-13-238-10"/>
      </fig>
      <p>For reads of length 7 with 2 errors, and minimum anchor length 3, the number of compositions with exactly one anchor (allowing it to be any of the parts, via permutations of these compositions) is 6·3 = 18.</p>
      <p>For arbitrary values of the parameters, we first compute the number of configurations where all <italic>N</italic> anchors come first and all <italic>M</italic> + 1−<italic>N</italic> short parts come last. Then we multiply the count of these by
<inline-formula><mml:math id="M51" name="1471-2105-13-238-i52" overflow="scroll"><mml:mfenced><mml:mrow><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula> to allow any of the <italic>N</italic> parts to be the anchors.</p>
      <p>Let <italic>N</italic> ≥ 0 be an integer. For given parameters <italic>M</italic>,<italic>N</italic>,<italic>K</italic>,<italic>L</italic>, we will enumerate the number of arrangements of error positions that result in exactly <italic>N</italic> anchors. This is equivalent to the combinatorial problem of counting <bold>integer compositions</bold> of <italic>L</italic> + 1 with certain restrictions on the sizes of the parts. We will use generating function techniques from combinatorics to count arrangements of <italic>M</italic> error positions that give exactly <italic>N</italic> anchors (so the other <italic>N</italic> + 1−<italic>M</italic> parts are short fragments). Let <italic>c</italic><sub><italic>M</italic>,<italic>N</italic>,<italic>K</italic></sub>(<italic>L</italic>) denote the number of arrangements of <italic>M</italic> error positions that result in exactly <italic>N</italic> anchors, where the read length is <italic>L</italic> and anchors are defined as parts <italic>λ</italic><sub><italic>i</italic></sub> &gt; <italic>K</italic>. Let
<inline-formula><mml:math id="M52" name="1471-2105-13-238-i53" overflow="scroll"><mml:mfenced><mml:mrow><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math></inline-formula> be the number of arrangements where all the anchors precede all the short parts (<italic>λ</italic><sub>1</sub>,…,<italic>λ</italic><sub><italic>N</italic></sub> &gt; <italic>K</italic>) and <italic>λ</italic><sub><italic>N</italic> + 1</sub>,…,<italic>λ</italic><sub><italic>M</italic> + 1</sub> ≤ <italic>K</italic>). These are related by
<inline-formula><mml:math id="M53" name="1471-2105-13-238-i54" overflow="scroll"><mml:mfenced><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math></inline-formula> since we can select any <italic>N</italic> of the <italic>M</italic> + 1 parts to be the anchors.</p>
      <p>Note that </p>
      <p>
        <disp-formula id="bmcMA1">
          <label>(A1)</label>
          <mml:math id="M54" name="1471-2105-13-238-i55" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:mtext>NumConfigurations</mml:mtext>
                  <mml:mo>(</mml:mo>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>K</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>L</mml:mi>
                  <mml:mo>)</mml:mo>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi mathsize="big">∑</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>′</mml:mi>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>≥</mml:mo>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>M</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>′</mml:mi>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>,</mml:mo>
                      <mml:mi>K</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>(</mml:mo>
                  <mml:mi>L</mml:mi>
                  <mml:mo>)</mml:mo>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>The compositions of <italic>L</italic> + 1 into <italic>M</italic> + 1 parts, where the first <italic>N</italic> parts are anchors and the remaining <italic>M</italic> + 1 − <italic>N</italic> parts are short, have the following constraints: </p>
      <p>• <italic>λ</italic><sub>1</sub>,…,<italic>λ</italic><sub><italic>N</italic></sub> ∈ 1,2,…,<italic>K</italic>(short parts).</p>
      <p>• <italic>λ</italic><sub><italic>N</italic> + 1</sub>,<italic>λ</italic><sub><italic>N</italic> + 2</sub>,…,<italic>λ</italic><sub><italic>M</italic></sub> ∈ <italic>K</italic> + 1,<italic>K</italic> + 2,… (anchors).</p>
      <p>• <italic>λ</italic><sub>1</sub> + ⋯ + <italic>λ</italic><sub><italic>M</italic></sub> = <italic>L</italic> + 1.</p>
      <p>The generating functions for short parts, <italic>S</italic>(<italic>t</italic>), and anchors, <italic>A</italic>(<italic>t</italic>), are </p>
      <p>
        <disp-formula id="bmcMA2">
          <label>(A2)</label>
          <mml:math id="M55" name="1471-2105-13-238-i56" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:mi>S</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi>t</mml:mi>
                  <mml:mo>)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>+</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>+</mml:mo>
                  <mml:mo>⋯</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>K</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                      <mml:mo>(</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>K</mml:mi>
                        </mml:mrow>
                      </mml:msup>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcMA3">
          <label>(A3)</label>
          <mml:math id="M56" name="1471-2105-13-238-i57" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:mi>A</mml:mi>
                  <mml:mo>(</mml:mo>
                  <mml:mi>t</mml:mi>
                  <mml:mo>)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>K</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>+</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>K</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>+</mml:mo>
                  <mml:mo>⋯</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mi>t</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>K</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>Standard methods for enumerating compositions with generating functions give that </p>
      <p>
        <disp-formula id="bmcMA4">
          <label>(A4)</label>
          <mml:math id="M57" name="1471-2105-13-238-i58" overflow="scroll">
            <mml:mi>A</mml:mi>
            <mml:msup>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mi>t</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>N</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mi>S</mml:mi>
            <mml:msup>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mi>t</mml:mi>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>−</mml:mo>
                <mml:mi>N</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>=</mml:mo>
            <mml:munder>
              <mml:mrow>
                <mml:mi mathsize="big">∑</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>L</mml:mi>
              </mml:mrow>
            </mml:munder>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi>c</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mi>K</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>′</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>(</mml:mo>
            <mml:mi>L</mml:mi>
            <mml:mo>)</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi>t</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>L</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msup>
          </mml:math>
        </disp-formula>
      </p>
      <p>where we expand the left side in a MacLaurin series (Taylor series centered at <italic>t</italic> = 0) to obtain the right side. The counts
<inline-formula><mml:math id="M58" name="1471-2105-13-238-i59" overflow="scroll"><mml:mfenced><mml:mrow><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msubsup><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math></inline-formula> are the coefficients in this series. Multiplying this by
<inline-formula><mml:math id="M59" name="1471-2105-13-238-i60" overflow="scroll"><mml:mfenced><mml:mrow><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula> gives </p>
      <p>
        <disp-formula id="bmcMA5">
          <label>(A5)</label>
          <mml:math id="M60" name="1471-2105-13-238-i61" overflow="scroll">
            <mml:mtable class="align" columnalign="left">
              <mml:mtr>
                <mml:mtd class="align-1">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>G</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>M</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>N</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>K</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>(</mml:mo>
                  <mml:mi>t</mml:mi>
                  <mml:mo>)</mml:mo>
                </mml:mtd>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:mfenced open="(" close=")">
                    <mml:mfrac linethickness="0">
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mfenced>
                  <mml:mi>A</mml:mi>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mi>S</mml:mi>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>M</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>−</mml:mo>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd class="align-1"/>
                <mml:mtd class="align-2">
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi mathsize="big">∑</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>L</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>c</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>M</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>N</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>K</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>(</mml:mo>
                  <mml:mi>L</mml:mi>
                  <mml:mo>)</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>t</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>L</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mspace width="2em"/>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>To compute <italic>c</italic><sub><italic>M</italic>,<italic>N</italic>,<italic>K</italic></sub>(<italic>L</italic>), we use Taylor series methods to compute the coefficient of <italic>t</italic><sup><italic>L</italic> + 1</sup>in (A5). We present two methods to do this.</p>
      <p><bold>First Taylor series method:</bold> The coefficient of <italic>t</italic>in (A5) may be determined by polynomial multiplication. We truncate the middle expression in (A3) to terms of degree ≤ <italic>L</italic> + 1, which turns it into a polynomial; the middle expression of (A2) is already a polynomial. We take powers and products of the polynomials, truncating terms of degree &gt; <italic>L</italic> + 1 at intermediate steps. The coefficient of <italic>t</italic><sup><italic>L</italic> + 1</sup> in the result is <italic>c</italic><sub><italic>M</italic>,<italic>N</italic>,<italic>K</italic></sub>(<italic>L</italic>). All intermediate products and sums involve only nonnegative integers.</p>
      <p><bold>Second Taylor series method:</bold> We present an exact closed-form solution. Mathematically, closed-form solutions are usually preferred. However, the first method above may be preferable for computation because intermediate steps of this second method require much higher precision, as discussed in Appendix 2.</p>
      <sec>
        <title>Theorem A1</title>
        <p><italic>For</italic><italic>K</italic> = 0: if <italic>N</italic> = <italic>M</italic> + 1 <italic>then</italic><inline-formula><mml:math id="M61" name="1471-2105-13-238-i62" overflow="scroll"><mml:mfenced><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula>; <italic>otherwise,</italic><italic>c</italic><sub><italic>M</italic>,<italic>N</italic>,<italic>K</italic></sub>(<italic>L</italic>) = 0.</p>
        <p><italic>For</italic><italic>K</italic> ≥ 1, <italic>set</italic><italic>D</italic> = <italic>L</italic> − <italic>NK</italic> − <italic>M</italic><italic>and</italic><italic>i</italic><sub>max</sub> = min(⌈<italic>D</italic>/<italic>K</italic>),<italic>M</italic> + 1−<italic>N</italic>⌉.</p>
        <p><italic>If</italic><italic>D</italic> &lt; 0 <italic>or</italic><italic>i</italic><sub>max</sub> &lt; 0 <italic>then</italic><italic>c</italic><sub><italic>M</italic>,<italic>N</italic>,<italic>K</italic></sub>(<italic>L</italic>) = 0. <italic>Otherwise,</italic></p>
        <p>
          <disp-formula id="bmcMA6">
            <label>(A6)</label>
            <mml:math id="M62" name="1471-2105-13-238-i63" overflow="scroll">
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>c</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>N</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:mi>L</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:mo>=</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                    <mml:munderover>
                      <mml:mrow>
                        <mml:mi mathsize="big">∑</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mtext>max</mml:mtext>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi>D</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mi>iK</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                    <mml:mi>.</mml:mi>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
      </sec>
      <sec>
        <title>Proof</title>
        <p>For <italic>K</italic>=0, there are no short parts; all parts are anchors. This is equivalent to counting the number of strict compositions of <italic>L</italic> + 1 into <italic>M</italic> + 1 parts, which is well-known to be
<inline-formula><mml:math id="M63" name="1471-2105-13-238-i64" overflow="scroll"><mml:mfenced><mml:mrow><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p>
        <p>For <italic>K</italic> ≥ 1, note that we may write </p>
        <p>
          <disp-formula id="bmcMA7">
            <label>(A7)</label>
            <mml:math id="M64" name="1471-2105-13-238-i65" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>N</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                    <mml:mi>A</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>t</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>S</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>t</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>t</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>KN</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mi>M</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>−</mml:mo>
                            <mml:msup>
                              <mml:mrow>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>K</mml:mi>
                              </mml:mrow>
                            </mml:msup>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>−</mml:mo>
                            <mml:mi>N</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>−</mml:mo>
                            <mml:mi>t</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>The binomial theorem and the negative binomial series give </p>
        <p>
          <disp-formula>
            <mml:math id="M65" name="1471-2105-13-238-i66" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>t</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>K</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mi mathsize="big">∑</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>iK</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mspace width="2.8em"/>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>−</mml:mo>
                            <mml:mi>t</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mi mathsize="big">∑</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>∞</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>Plugging these into (A7), we obtain </p>
        <p>
          <disp-formula id="bmcMA8">
            <label>(A8)</label>
            <mml:math id="M66" name="1471-2105-13-238-i67" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>N</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mi mathsize="big">∑</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mi mathsize="big">∑</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>∞</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mspace width="1em"/>
                    <mml:mo>×</mml:mo>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>−</mml:mo>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>KN</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mo>(</mml:mo>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>)</mml:mo>
                        <mml:mo>+</mml:mo>
                        <mml:mi>iK</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>In (A5), the coefficient of <italic>t</italic><sup><italic>L</italic> + 1</sup> is <italic>c</italic><sub><italic>M</italic>,<italic>N</italic>,<italic>K</italic></sub>(<italic>L</italic>). Collecting together the terms in (A8) where the exponent of <italic>t</italic> is <italic>L</italic> + 1 gives (A6). We omit the detailed but straightforward derivation. □</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Appendix 2</title>
    <sec>
      <title>Numerical precision of the closed form solution for the number of anchors</title>
      <p>Theorem A1 (also called the “Second Taylor series method”) gives a closed form expression (A6) to compute <italic>c</italic><sub><italic>M</italic>,<italic>N</italic>,<italic>K</italic></sub>(<italic>L</italic>). This closed form solution has only a small number of terms. However, for practical parameter values, it may require more bits of precision than are available in a finite precision computation, even if the final answer does not overflow the variable size. This is because the expression has an alternating sum with terms of much higher absolute value than the final answer. Consider this part of the summation in Theorem A1, omitting the coefficient
<inline-formula><mml:math id="M67" name="1471-2105-13-238-i68" overflow="scroll"><mml:mfenced><mml:mrow><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula>: </p>
      <p>
        <disp-formula>
          <mml:math id="M68" name="1471-2105-13-238-i69" overflow="scroll">
            <mml:mrow>
              <mml:munderover accentunder="false" accent="false">
                <mml:mrow>
                  <mml:mi mathsize="big">∑</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mtext>max</mml:mtext>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:munderover>
              <mml:msup>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
              </mml:msup>
              <mml:mfenced open="(" close=")">
                <mml:mfrac linethickness="0">
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>−</mml:mo>
                    <mml:mi>N</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mfenced>
              <mml:mfenced open="(" close=")">
                <mml:mfrac linethickness="0">
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mi>D</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mi>iK</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mfenced>
              <mml:mspace width="2.77695pt"/>
              <mml:mi>.</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>For <italic>M</italic> = 75, <italic>N</italic> = 1, <italic>K</italic> = 15, <italic>L</italic> = 1000, this has 61 alternating terms of magnitude between 2<sup>93</sup> and 2<sup>401</sup>, while the value of the sum is much smaller, with magnitude 2<sup>294</sup>. Using high precision floating point, we need at least 110 bits for the mantissa to get the first decimal digit correct. This is significantly more bits than is currently standard: the current standard for floating point, IEEE 754, provides for a 53 bit mantissa in double precision. Alternatively, using high precision integers, we would need 294 bits of integer precision, plus a sign bit. However, software for arbitrary precision integers, such as Maple or Mathematica, will handle this example correctly.</p>
      <p>By contrast, the “First Taylor series method” only involves sums and products of positive integers, each bounded above by the value of <italic>c</italic><sub><italic>M</italic>,<italic>N</italic>,<italic>K</italic></sub>(<italic>L</italic>). Thus, if the integer precision is adequate to store the value of <italic>c</italic><sub><italic>M</italic>,<italic>N</italic>,<italic>K</italic></sub>(<italic>L</italic>), it is also adequate to perform all intermediate calculations.</p>
    </sec>
  </sec>
  <sec>
    <title>Appendix 3</title>
    <sec>
      <title>Statistics of number of anchors</title>
      <p>We may estimate the number of anchors using the following theorem.</p>
      <sec>
        <title>Theorem A2</title>
        <p>Fix <italic>M</italic>,<italic>K</italic>,<italic>L</italic>. Under the uniform distribution on compositions of <italic>L</italic> + 1 into <italic>M</italic> + 1 parts, the mean number of anchors and its variance are given by </p>
        <p>
          <disp-formula id="bmcMA9">
            <label>(A9)</label>
            <mml:math id="M69" name="1471-2105-13-238-i70" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mi>μ</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mi>E</mml:mi>
                    <mml:mo>[</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mo>]</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>)</mml:mo>
                        <mml:mfenced open="(" close=")">
                          <mml:mfrac linethickness="0">
                            <mml:mrow>
                              <mml:mi>L</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mi>K</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mfrac linethickness="0">
                            <mml:mrow>
                              <mml:mi>L</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="bmcMA10">
            <label>(A10)</label>
            <mml:math id="M70" name="1471-2105-13-238-i71" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mtext>Var</mml:mtext>
                    <mml:mo>[</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mo>]</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>(</mml:mo>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>)</mml:mo>
                        <mml:mfenced open="(" close=")">
                          <mml:mfrac linethickness="0">
                            <mml:mrow>
                              <mml:mi>L</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>2</mml:mn>
                              <mml:mi>K</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mfrac linethickness="0">
                            <mml:mrow>
                              <mml:mi>L</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>+</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>)</mml:mo>
                        <mml:mfenced open="(" close=")">
                          <mml:mfrac linethickness="0">
                            <mml:mrow>
                              <mml:mi>L</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mi>K</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mfrac linethickness="0">
                            <mml:mrow>
                              <mml:mi>L</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mspace width="2em"/>
                    <mml:mspace width="2em"/>
                    <mml:mspace width="1em"/>
                    <mml:mspace width="1em"/>
                    <mml:mspace width="1em"/>
                    <mml:mo>−</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mi>M</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>)</mml:mo>
                                <mml:mfenced open="(" close=")">
                                  <mml:mfrac linethickness="0">
                                    <mml:mrow>
                                      <mml:mi>L</mml:mi>
                                      <mml:mo>−</mml:mo>
                                      <mml:mi>K</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>M</mml:mi>
                                    </mml:mrow>
                                  </mml:mfrac>
                                </mml:mfenced>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mfenced open="(" close=")">
                                  <mml:mfrac linethickness="0">
                                    <mml:mrow>
                                      <mml:mi>L</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>M</mml:mi>
                                    </mml:mrow>
                                  </mml:mfrac>
                                </mml:mfenced>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2.83864pt"/>
                    <mml:mi>.</mml:mi>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>For fixed <italic>M</italic> and <italic>K</italic>, consider the two-variable generating function </p>
        <p>
          <disp-formula id="bmcMA11">
            <label>(A11)</label>
            <mml:math id="M71" name="1471-2105-13-238-i72" overflow="scroll">
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd columnalign="left">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>H</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>u</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                  <mml:mtd columnalign="left">
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd columnalign="left">
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mi mathsize="big">∑</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>∞</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:munder>
                      <mml:mrow>
                        <mml:mi mathsize="big">∑</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>L</mml:mi>
                      </mml:mrow>
                    </mml:munder>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>c</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>N</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:mi>L</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>L</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>u</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd/>
                  <mml:mtd columnalign="left">
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd columnalign="left">
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mi mathsize="big">∑</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>∞</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>G</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>N</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>u</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="bmcMA12">
            <label>(A12)</label>
            <mml:math id="M72" name="1471-2105-13-238-i73" overflow="scroll">
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd/>
                  <mml:mtd columnalign="left">
                    <mml:mspace width="2em"/>
                    <mml:mspace width="2em"/>
                    <mml:mspace width="1.5em"/>
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd columnalign="left">
                    <mml:mspace width="2em"/>
                    <mml:mspace width="2em"/>
                    <mml:mspace width="1.5em"/>
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mi mathsize="big">∑</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>∞</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>N</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>K</mml:mi>
                                    <mml:mo>+</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>u</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd/>
                  <mml:mtd columnalign="left">
                    <mml:mspace width="1em"/>
                    <mml:mspace width="2em"/>
                    <mml:mspace width="2em"/>
                    <mml:mspace width="2em"/>
                    <mml:mspace width=".8em"/>
                    <mml:mo>×</mml:mo>
                  </mml:mtd>
                  <mml:mtd columnalign="left">
                    <mml:msup>
                      <mml:mrow>
                        <mml:mspace width="2em"/>
                        <mml:mspace width="2em"/>
                        <mml:mspace width="2em"/>
                        <mml:mspace width="1em"/>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>t</mml:mi>
                                <mml:mo>(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>K</mml:mi>
                                  </mml:mrow>
                                </mml:msup>
                                <mml:mo>)</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd/>
                  <mml:mtd columnalign="left">
                    <mml:mspace width="2em"/>
                    <mml:mspace width="2em"/>
                    <mml:mspace width="1.5em"/>
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd columnalign="left">
                    <mml:msup>
                      <mml:mrow>
                        <mml:mspace width="2em"/>
                        <mml:mspace width="2em"/>
                        <mml:mspace width="1.5em"/>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>u</mml:mi>
                                <mml:mspace width="0.3em"/>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>K</mml:mi>
                                    <mml:mo>+</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                            <mml:mo>+</mml:mo>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>t</mml:mi>
                                <mml:mo>(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>K</mml:mi>
                                  </mml:mrow>
                                </mml:msup>
                                <mml:mo>)</mml:mo>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd/>
                  <mml:mtd columnalign="left">
                    <mml:mspace width="2em"/>
                    <mml:mspace width="2em"/>
                    <mml:mspace width="1.5em"/>
                    <mml:mo>=</mml:mo>
                  </mml:mtd>
                  <mml:mtd columnalign="left">
                    <mml:msup>
                      <mml:mrow>
                        <mml:mspace width="2em"/>
                        <mml:mspace width="2em"/>
                        <mml:mspace width="1.5em"/>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mi>u</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>)</mml:mo>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>K</mml:mi>
                                    <mml:mo>+</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                </mml:msup>
                                <mml:mo>+</mml:mo>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>For fixed <italic>M</italic>,<italic>K</italic>,<italic>L</italic>, the probability of exactly <italic>N</italic> anchors is <italic>c</italic><sub><italic>M</italic>,<italic>N</italic>,<italic>K</italic></sub>(<italic>L</italic>)/<italic>T</italic>, where </p>
        <p>
          <disp-formula>
            <mml:math id="M73" name="1471-2105-13-238-i74" overflow="scroll">
              <mml:mrow>
                <mml:mi>T</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:munderover accentunder="false" accent="false">
                  <mml:mrow>
                    <mml:mi mathsize="big">∑</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>′</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>=</mml:mo>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>∞</mml:mi>
                  </mml:mrow>
                </mml:munderover>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>c</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>′</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo>,</mml:mo>
                    <mml:mi>K</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mi>L</mml:mi>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>Note that <italic>T</italic> counts the total number of compositions of <italic>L</italic> + 1 into <italic>M</italic> + 1 parts, with 0 or more anchors. Thus, it actually counts the total number of compositions of <italic>L</italic> + 1 into <italic>M</italic> + 1 parts, without regard to sizes of parts. So we have: </p>
        <p>
          <disp-formula id="bmcMA13">
            <label>(A13)</label>
            <mml:math id="M74" name="1471-2105-13-238-i75" overflow="scroll">
              <mml:mi>T</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:munderover>
                <mml:mrow>
                  <mml:mi mathsize="big">∑</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>′</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>=</mml:mo>
                  <mml:mn>0</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>∞</mml:mi>
                </mml:mrow>
              </mml:munderover>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>′</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>,</mml:mo>
                  <mml:mi>K</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>(</mml:mo>
              <mml:mi>L</mml:mi>
              <mml:mo>)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mfenced open="(" close=")">
                <mml:mfrac linethickness="0">
                  <mml:mrow>
                    <mml:mi>L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mfenced>
            </mml:math>
          </disp-formula>
        </p>
        <p>and thus the probability of exactly <italic>N</italic> anchors is
<inline-formula><mml:math id="M75" name="1471-2105-13-238-i76" overflow="scroll"><mml:mfenced><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p>
        <p>Next, for fixed <italic>M</italic>,<italic>K</italic>,<italic>L</italic>, we evaluate <italic>E</italic>[<italic>N</italic>], the mean number of anchors under the uniform distribution of compositions of <italic>L</italic> + 1 into <italic>M</italic> + 1 parts. </p>
        <p>
          <disp-formula>
            <mml:math id="M76" name="1471-2105-13-238-i77" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mi>E</mml:mi>
                    <mml:mo>[</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mo>]</mml:mo>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:munder>
                      <mml:mrow>
                        <mml:mi mathsize="big">∑</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:munder>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>c</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>N</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>K</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>(</mml:mo>
                        <mml:mi>L</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mfrac linethickness="0">
                            <mml:mrow>
                              <mml:mi>L</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>·</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>Using standard generating function properties, the numerator
<inline-formula><mml:math id="M77" name="1471-2105-13-238-i78" overflow="scroll"><mml:mfenced><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula> is the coefficient of <italic>t</italic><sup><italic>L</italic> + 1</sup> in the following expression: </p>
        <p>
          <disp-formula id="bmcMA14">
            <label>(A14)</label>
            <mml:math id="M78" name="1471-2105-13-238-i79" overflow="scroll">
              <mml:msub>
                <mml:mrow>
                  <mml:mfenced close="|">
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:mi>∂</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>∂u</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>H</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>K</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>(</mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>u</mml:mi>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>u</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msub>
            </mml:math>
          </disp-formula>
        </p>
        <p>First we evaluate the derivative; second, we plug in <italic>u</italic> = 1; third, we extract the coefficient of <italic>t</italic><sup><italic>L</italic> + 1</sup>; and fourth, we use this to compute <italic>E</italic>[<italic>N</italic>]: </p>
        <p>1. The derivative in Eq. (A14) is </p>
        <p>
          <disp-formula>
            <mml:math id="M79" name="1471-2105-13-238-i80" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi>∂</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>∂u</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>H</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>u</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi>∂</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>∂u</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mi>u</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>)</mml:mo>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>K</mml:mi>
                                    <mml:mo>+</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                </mml:msup>
                                <mml:mo>+</mml:mo>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mo>(</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mspace width="0.3em"/>
                    <mml:mo>+</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mi>u</mml:mi>
                                <mml:mspace width="0.3em"/>
                                <mml:mo>−</mml:mo>
                                <mml:mspace width="0.3em"/>
                                <mml:mn>1</mml:mn>
                                <mml:mo>)</mml:mo>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>K</mml:mi>
                                    <mml:mo>+</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                </mml:msup>
                                <mml:mo>+</mml:mo>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>t</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>K</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>2. Plug in <italic>u</italic> = 1: </p>
        <p>
          <disp-formula>
            <mml:math id="M80" name="1471-2105-13-238-i81" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mfenced close="|">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>∂</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>∂u</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>H</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>M</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>K</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>(</mml:mo>
                            <mml:mi>t</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>u</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>u</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mo>(</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>t</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>K</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mo>(</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>t</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mi>K</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>−</mml:mo>
                            <mml:mi>t</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>3. Expand the Taylor series and extract the coefficient of <italic>t</italic><sup><italic>L</italic> + 1</sup>: </p>
        <p>
          <disp-formula>
            <mml:math id="M81" name="1471-2105-13-238-i82" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mo>(</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mspace width="0.3em"/>
                    <mml:mo>+</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>t</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mi>K</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>−</mml:mo>
                            <mml:mi>t</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mspace width="0.3em"/>
                    <mml:mo>=</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:mo>(</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mspace width="0.3em"/>
                    <mml:mo>+</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mi mathsize="big">∑</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>∞</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>K</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>+</mml:mo>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>The term <italic>t</italic><sup><italic>L</italic> + 1</sup>occurs when <italic>j</italic> = <italic>L</italic> − <italic>M</italic> − <italic>K</italic>.If <italic>j</italic> &lt; 0, this coefficient is 0. If <italic>j</italic> ≥ 0, this coefficient is
<inline-formula><mml:math id="M82" name="1471-2105-13-238-i83" overflow="scroll"><mml:mfenced><mml:mrow><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula>.</p>
        <p>4.Evaluate <italic>E</italic>[<italic>N</italic>] to obtain Equation (A9): </p>
        <p>
          <disp-formula>
            <mml:math id="M83" name="1471-2105-13-238-i84" overflow="scroll">
              <mml:mrow>
                <mml:mi>E</mml:mi>
                <mml:mrow>
                  <mml:mo>[</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo>]</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>L</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mi>K</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>L</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mspace width="2.77695pt"/>
                <mml:mi>.</mml:mi>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p> Note that if <italic>L</italic> − <italic>K</italic> &lt; <italic>M</italic>, then <italic>E</italic>[<italic>N</italic>] = 0.</p>
        <p>Next we compute the variance of N, using a similar generating function technique. The generating function will enable us to compute <italic>E</italic>[<italic>N</italic>(<italic>N</italic> − 1)], so we will compute the variance in the form </p>
        <p>
          <disp-formula>
            <mml:math id="M84" name="1471-2105-13-238-i85" overflow="scroll">
              <mml:mrow>
                <mml:msup>
                  <mml:mrow>
                    <mml:mi>σ</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>=</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mo>[</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mo>(</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>)</mml:mo>
                <mml:mo>]</mml:mo>
                <mml:mo>+</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:mo>[</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mo>]</mml:mo>
                <mml:mo>−</mml:mo>
                <mml:mi>E</mml:mi>
                <mml:msup>
                  <mml:mrow>
                    <mml:mo>[</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mo>]</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p> which is equivalent to the more common formula <italic>σ</italic><sup>2</sup> = <italic>E</italic>[<italic>N</italic><sup>2</sup>] − <italic>E</italic>[<italic>N</italic>]<sup>2</sup>. We have: </p>
        <p>
          <disp-formula>
            <mml:math id="M85" name="1471-2105-13-238-i86" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mi>E</mml:mi>
                    <mml:mo>[</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:mo>]</mml:mo>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:munder>
                      <mml:mrow>
                        <mml:mi mathsize="big">∑</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:munder>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>c</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>N</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>K</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>(</mml:mo>
                        <mml:mi>L</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mfrac linethickness="0">
                            <mml:mrow>
                              <mml:mi>L</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>·</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>The numerator
<inline-formula><mml:math id="M86" name="1471-2105-13-238-i87" overflow="scroll"><mml:mfenced><mml:mrow><mml:munder><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math></inline-formula> is the coefficient of <italic>t</italic><sup><italic>L</italic> + 1</sup>in the following expression: </p>
        <p>
          <disp-formula id="bmcMA15">
            <label>(A15)</label>
            <mml:math id="M87" name="1471-2105-13-238-i88" overflow="scroll">
              <mml:msub>
                <mml:mrow>
                  <mml:mfenced close="|">
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mi>∂</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>∂</mml:mi>
                          <mml:msup>
                            <mml:mrow>
                              <mml:mi>u</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mn>2</mml:mn>
                            </mml:mrow>
                          </mml:msup>
                        </mml:mrow>
                      </mml:mfrac>
                      <mml:msub>
                        <mml:mrow>
                          <mml:mi>H</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>K</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>(</mml:mo>
                      <mml:mi>t</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>u</mml:mi>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>u</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
              </mml:msub>
            </mml:math>
          </disp-formula>
        </p>
        <p>We evaluate this in a fashion similar to <italic>E</italic>[<italic>N</italic>]: </p>
        <p>1. The derivative in Eq. (A15) is </p>
        <p>
          <disp-formula>
            <mml:math id="M88" name="1471-2105-13-238-i89" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>∂</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>∂</mml:mi>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>u</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>H</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:mi>t</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>u</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>∂</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>∂</mml:mi>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>u</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>2</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mi>u</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>)</mml:mo>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>K</mml:mi>
                                    <mml:mo>+</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                </mml:msup>
                                <mml:mo>+</mml:mo>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mi>u</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>)</mml:mo>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>K</mml:mi>
                                    <mml:mo>+</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                </mml:msup>
                                <mml:mo>+</mml:mo>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mspace width="1em"/>
                    <mml:mo>×</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>K</mml:mi>
                                    <mml:mo>+</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mo>−</mml:mo>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>2. Plug in <italic>u</italic> = 1: </p>
        <p>
          <disp-formula>
            <mml:math id="M89" name="1471-2105-13-238-i90" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:msub>
                      <mml:mrow>
                        <mml:mfenced close="|">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi>∂</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mn>2</mml:mn>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>∂</mml:mi>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi>u</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mn>2</mml:mn>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                            </mml:mfrac>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mi>H</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>M</mml:mi>
                                <mml:mo>,</mml:mo>
                                <mml:mi>K</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>(</mml:mo>
                            <mml:mi>t</mml:mi>
                            <mml:mo>,</mml:mo>
                            <mml:mi>u</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>u</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mspace width="0.3em"/>
                    <mml:mo>=</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:mi>M</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mspace width="0.3em"/>
                    <mml:mo>+</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:mspace width="0.3em"/>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mn>1</mml:mn>
                                <mml:mspace width="0.3em"/>
                                <mml:mo>−</mml:mo>
                                <mml:mspace width="0.3em"/>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                            <mml:mspace width="0.3em"/>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>−</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:mspace width="0.3em"/>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:msup>
                                  <mml:mrow>
                                    <mml:mi>t</mml:mi>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mi>K</mml:mi>
                                    <mml:mo>+</mml:mo>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                </mml:msup>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mspace width="0.3em"/>
                                <mml:mo>−</mml:mo>
                                <mml:mspace width="0.3em"/>
                                <mml:mi>t</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                            <mml:mspace width="0.3em"/>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>t</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>+</mml:mo>
                            <mml:mn>2</mml:mn>
                            <mml:mi>K</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>−</mml:mo>
                            <mml:mi>t</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>3. Expand the Taylor series and extract the coefficient of <italic>t</italic><sup><italic>L</italic> + 1</sup>: </p>
        <p>
          <disp-formula>
            <mml:math id="M90" name="1471-2105-13-238-i91" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mi>M</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>t</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>+</mml:mo>
                            <mml:mn>2</mml:mn>
                            <mml:mi>K</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>−</mml:mo>
                            <mml:mi>t</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>M</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mspace width="1em"/>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>+</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mi mathsize="big">∑</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>∞</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:munderover accentunder="false" accent="false">
                      <mml:mrow>
                        <mml:mi mathsize="big">∑</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>0</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>∞</mml:mi>
                      </mml:mrow>
                    </mml:munderover>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>t</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>+</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:mi>K</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>The term <italic>t</italic><sup><italic>L</italic> + 1</sup> occurs when <italic>j</italic> = <italic>L</italic> − (<italic>M</italic> + 2<italic>K</italic>). This coefficient is
<inline-formula><mml:math id="M91" name="1471-2105-13-238-i92" overflow="scroll"><mml:mfenced><mml:mrow><mml:mi>M</mml:mi><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi>L</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula> (which is 0 when <italic>L</italic> − 2<italic>K</italic> &lt; <italic>M</italic>).</p>
        <p>4. Evaluate <italic>E</italic>[<italic>N</italic>(<italic>N</italic> − 1)]: </p>
        <p>
          <disp-formula>
            <mml:math id="M92" name="1471-2105-13-238-i93" overflow="scroll">
              <mml:mrow>
                <mml:mi>E</mml:mi>
                <mml:mo>[</mml:mo>
                <mml:mi>N</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>]</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>+</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>L</mml:mi>
                          <mml:mo>−</mml:mo>
                          <mml:mn>2</mml:mn>
                          <mml:mi>K</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>L</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>5. Evaluate <italic>σ</italic><sup>2</sup> = Var[<italic>N</italic>] to prove Equation (A10): </p>
        <p>
          <disp-formula>
            <mml:math id="M93" name="1471-2105-13-238-i94" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>σ</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mtext>Var</mml:mtext>
                    <mml:mo>[</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mo>]</mml:mo>
                    <mml:mo>=</mml:mo>
                    <mml:mi>E</mml:mi>
                    <mml:mo>[</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mo>(</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>)</mml:mo>
                    <mml:mo>]</mml:mo>
                    <mml:mo>+</mml:mo>
                    <mml:mi>E</mml:mi>
                    <mml:mo>[</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mo>]</mml:mo>
                    <mml:mo>−</mml:mo>
                    <mml:mi>E</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mo>[</mml:mo>
                        <mml:mi>N</mml:mi>
                        <mml:mo>]</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>(</mml:mo>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>)</mml:mo>
                        <mml:mfenced open="(" close=")">
                          <mml:mfrac linethickness="0">
                            <mml:mrow>
                              <mml:mi>L</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>2</mml:mn>
                              <mml:mi>K</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mfrac linethickness="0">
                            <mml:mrow>
                              <mml:mi>L</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mo>+</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>M</mml:mi>
                        <mml:mo>+</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>)</mml:mo>
                        <mml:mfenced open="(" close=")">
                          <mml:mfrac linethickness="0">
                            <mml:mrow>
                              <mml:mi>L</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mi>K</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mfrac linethickness="0">
                            <mml:mrow>
                              <mml:mi>L</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>M</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd class="align-1"/>
                  <mml:mtd class="align-2">
                    <mml:mspace width="1em"/>
                    <mml:mo>−</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mi>M</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo>)</mml:mo>
                                <mml:mfenced open="(" close=")">
                                  <mml:mfrac linethickness="0">
                                    <mml:mrow>
                                      <mml:mi>L</mml:mi>
                                      <mml:mo>−</mml:mo>
                                      <mml:mi>K</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>M</mml:mi>
                                    </mml:mrow>
                                  </mml:mfrac>
                                </mml:mfenced>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mfenced open="(" close=")">
                                  <mml:mfrac linethickness="0">
                                    <mml:mrow>
                                      <mml:mi>L</mml:mi>
                                    </mml:mrow>
                                    <mml:mrow>
                                      <mml:mi>M</mml:mi>
                                    </mml:mrow>
                                  </mml:mfrac>
                                </mml:mfenced>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Appendix 4</title>
    <sec>
      <title>Asymptotic number of anchors</title>
      <sec>
        <title>Theorem A3</title>
        <p>Let <italic>μ</italic>,<italic>σ</italic><sup>2</sup> be given by Theorem A2. For sufficiently large <italic>M</italic>, </p>
        <p>
          <disp-formula id="bmcMA16">
            <label>(A16)</label>
            <mml:math id="M94" name="1471-2105-13-238-i95" overflow="scroll">
              <mml:mspace width="2em"/>
              <mml:mspace width="2em"/>
              <mml:mspace width="2em"/>
              <mml:mspace width="2em"/>
              <mml:mspace width="2.5em"/>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>c</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>M</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>N</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>K</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>(</mml:mo>
              <mml:mi>L</mml:mi>
              <mml:mo>)</mml:mo>
              <mml:mo>≈</mml:mo>
              <mml:mfenced open="(" close=")">
                <mml:mfrac linethickness="0">
                  <mml:mrow>
                    <mml:mi>L</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mfenced>
              <mml:mi>ϕ</mml:mi>
              <mml:mfenced open="(" close=")">
                <mml:mrow>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:mi>μ</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>σ</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:mfenced>
            </mml:math>
          </disp-formula>
        </p>
        <p>
          <disp-formula id="bmcMA17">
            <label>(A17)</label>
            <mml:math id="M95" name="1471-2105-13-238-i96" overflow="scroll">
              <mml:mtable>
                <mml:mtr>
                  <mml:mtd columnalign="left">
                    <mml:mtext>NumConfigurations</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>K</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>L</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                  <mml:mtd columnalign="left">
                    <mml:mo>≈</mml:mo>
                  </mml:mtd>
                  <mml:mtd columnalign="left">
                    <mml:mfenced open="(" close=")">
                      <mml:mfrac linethickness="0">
                        <mml:mrow>
                          <mml:mi>L</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>M</mml:mi>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mfenced>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd/>
                  <mml:mtd/>
                  <mml:mtd columnalign="left">
                    <mml:mo>×</mml:mo>
                    <mml:mfenced open="(" close=")">
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                        <mml:mo>−</mml:mo>
                        <mml:mi>Φ</mml:mi>
                        <mml:mfenced open="(" close=")">
                          <mml:mrow>
                            <mml:mfrac>
                              <mml:mrow>
                                <mml:mi>N</mml:mi>
                                <mml:mo>−</mml:mo>
                                <mml:mfrac>
                                  <mml:mrow>
                                    <mml:mn>1</mml:mn>
                                  </mml:mrow>
                                  <mml:mrow>
                                    <mml:mn>2</mml:mn>
                                  </mml:mrow>
                                </mml:mfrac>
                                <mml:mo>−</mml:mo>
                                <mml:mi>μ</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>σ</mml:mi>
                              </mml:mrow>
                            </mml:mfrac>
                          </mml:mrow>
                        </mml:mfenced>
                      </mml:mrow>
                    </mml:mfenced>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>where
<inline-formula><mml:math id="M96" name="1471-2105-13-238-i97" overflow="scroll"><mml:mfenced><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>(</mml:mo><mml:mi>z</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>Π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></inline-formula> and <italic>Φ</italic>(<italic>z</italic>) are the probability density function and cumulative distribution function of the standard normal distribution.</p>
      </sec>
      <sec>
        <title>Proof</title>
        <p>For fixed <italic>M</italic>,<italic>K</italic>, Eq. (A12) gives the generating function <italic>H</italic><sub><italic>M</italic>,<italic>K</italic></sub>(<italic>t</italic>,<italic>u</italic>) as a rational function in <italic>t</italic>,<italic>u</italic>, raised to the power <italic>M</italic> + 1. When <italic>M</italic> is sufficiently large, the Central Limit Theorem gives that the coefficients <italic>c</italic><sub><italic>M</italic>,<italic>N</italic>,<italic>K</italic></sub>(<italic>L</italic>) in its Taylor series, Eq. (A11), are well-approximated by a bivariate normal distribution. Restricting to the coefficients of <italic>t</italic><sup><italic>L</italic> + 1</sup> for fixed <italic>L</italic> gives that the coefficients of
<inline-formula><mml:math id="M97" name="1471-2105-13-238-i98" overflow="scroll"><mml:mfenced><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mi>u</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo mathsize="big">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>∞</mml:mi></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo><mml:msup><mml:mrow><mml:mi>u</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:math></inline-formula> are approximated by a univariate normal distribution. This represents the distribution of <italic>N</italic> for fixed <italic>M</italic>,<italic>K</italic>,<italic>L</italic>. We computed the parameters <italic>μ</italic>,<italic>σ</italic><sup>2</sup>of this distribution in Theorem A2. By Eq. (A13), the total of the coefficients in <italic>f</italic>(<italic>u</italic>) is
<inline-formula><mml:math id="M98" name="1471-2105-13-238-i99" overflow="scroll"><mml:mfenced><mml:mrow><mml:mi>f</mml:mi><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula>. Note that
<inline-formula><mml:math id="M99" name="1471-2105-13-238-i100" overflow="scroll"><mml:mfenced><mml:mrow><mml:mtext>NumConfigurations</mml:mtext><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:math></inline-formula> is the survival function of <italic>c</italic><sub><italic>M</italic>,<italic>N</italic>,<italic>K</italic></sub>(<italic>L</italic>): </p>
        <p>
          <disp-formula>
            <mml:math id="M100" name="1471-2105-13-238-i101" overflow="scroll">
              <mml:mtable class="align" columnalign="left">
                <mml:mtr>
                  <mml:mtd class="align-1">
                    <mml:mtext>NumConfigurations</mml:mtext>
                    <mml:mo>(</mml:mo>
                    <mml:mi>M</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>N</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>K</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>L</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mtd>
                  <mml:mtd class="align-2">
                    <mml:mo>=</mml:mo>
                    <mml:munder>
                      <mml:mrow>
                        <mml:mi mathsize="big">∑</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>N</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>′</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>≥</mml:mo>
                        <mml:mi>N</mml:mi>
                      </mml:mrow>
                    </mml:munder>
                    <mml:msub>
                      <mml:mrow>
                        <mml:mi>c</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>M</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mi>N</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi>′</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>,</mml:mo>
                        <mml:mi>K</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>(</mml:mo>
                    <mml:mi>L</mml:mi>
                    <mml:mo>)</mml:mo>
                    <mml:mspace width="0.3em"/>
                    <mml:mi>.</mml:mi>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                  <mml:mtd>
                    <mml:mspace width="2em"/>
                  </mml:mtd>
                </mml:mtr>
              </mml:mtable>
            </mml:math>
          </disp-formula>
        </p>
        <p>Thus, we obtain Eqs. (A16) and (A17) as approximations for the coefficients <italic>c</italic><sub><italic>M</italic>,<italic>N</italic>,<italic>K</italic></sub>(<italic>L</italic>) and the survival function NumConfigurations(<italic>M</italic>,<italic>N</italic>,<italic>K</italic>,<italic>L</italic>). In Eq. (A17), note that
<inline-formula><mml:math id="M101" name="1471-2105-13-238-i102" overflow="scroll"><mml:mfenced><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:math></inline-formula> is a continuity correction. □</p>
        <p>In Figure
<xref ref-type="fig" rid="F11">11</xref>, we plot <italic>c</italic><sub><italic>M</italic>,<italic>N</italic>,<italic>K</italic></sub>(<italic>L</italic>) and NumConfigurations(M,N,K,L). The solid markers are the true values computed from the generating function. The curve is the estimate computed by the preceding theorem, and does indeed approximate the true values well.</p>
        <fig id="F11" position="float">
          <label>Figure 11</label>
          <caption>
            <p><bold>The fraction of configurations with exactly and at least</bold><bold><italic>N</italic></bold><bold>anchors.</bold> (<bold>A</bold>) Plot of the fraction of configurations with exactly <italic>N</italic> anchors,
<inline-formula><mml:math id="M102" name="1471-2105-13-238-i103" overflow="scroll"><mml:mfenced><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula>, as <italic>N</italic> varies. An anchor is a run of at least <italic>K</italic> correct bases (shown for <italic>K</italic> = 15, 20, and 25). We assume the read length is <italic>L</italic> = 1000 and the error rate per base is <italic>ρ</italic> = 15<italic>%</italic>(and that there are exactly <italic>M</italic> = 150 error positions). The solid markers are computed by finding exact coefficients <italic>c</italic><sub><italic>M</italic>,<italic>N</italic>,<italic>K</italic></sub>(<italic>L</italic>) in the generating functions. The curve is a normal distribution approximating the exact values (illustrating Theorem A3), where parameters <italic>μ</italic>and <italic>σ</italic><sup>2</sup>are computed by Theorem A2. (<bold>B</bold>) The solid markers are a plot of
<inline-formula><mml:math id="M103" name="1471-2105-13-238-i104" overflow="scroll"><mml:mfenced><mml:mrow><mml:mtext>NumConfigurations</mml:mtext><mml:mo>(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>)</mml:mo><mml:mo>/</mml:mo><mml:mfenced open="(" close=")"><mml:mfrac linethickness="0"><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced></mml:math></inline-formula>, the fraction of configurations with at least <italic>N</italic> anchors, as <italic>N</italic> varies. The parameters are the same as for (A). The curve is the survival function of the normal distribution in (A).</p>
          </caption>
          <graphic xlink:href="1471-2105-13-238-11"/>
        </fig>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>MJC is a full-time employee at Pacific Biosciences, a company commercializing single-molecule, real-time nucleic acid sequencing technologies. GT was partially supported by a grant from the National Institutes of Health, USA (NIH grant 3P41RR024851-02S1). NIH had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
  </sec>
  <sec>
    <title>Author’s contributions</title>
    <p>MJC proposed and implemented the mapping method, performed the analysis, and wrote the manuscript. GT solved and implemented the combinatorial analysis, and wrote the manuscript. Both authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Supplementary Text S1.</bold> The supplementary text contains additional implementation details for the anchor similarity method, and description of the empirical model based read simulator.</p>
      </caption>
      <media xlink:href="1471-2105-13-238-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>Supplementary Table S1.</bold> Supplementary Table S1 gives the command line parameters used to run the benchmarks.</p>
      </caption>
      <media xlink:href="1471-2105-13-238-S2.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>We thank Jon Sorenson, James Bullard, Eric Schadt, and Jonas Korlach for useful comments in writing this manuscript.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Smith</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Waterman</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Identification of Common Molecular Subsequences</article-title>
        <source>J Mol Biol</source>
        <year>1981</year>
        <volume>147</volume>
        <fpage>194</fpage>
        <lpage>197</lpage>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zhang</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Schwartz</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Wagner</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Miller</surname>
          <given-names>W</given-names>
        </name>
        <article-title>A greedy algorithm for aligning DNA sequences</article-title>
        <source>J Comput Biol</source>
        <year>2000</year>
        <volume>7</volume>
        <fpage>203</fpage>
        <lpage>214</lpage>
        <pub-id pub-id-type="doi">10.1089/10665270050081478</pub-id>
        <pub-id pub-id-type="pmid">10890397</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kent</surname>
          <given-names>W</given-names>
        </name>
        <article-title>BLAT–the BLAST-like alignment tool</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>656</fpage>
        <lpage>664</lpage>
        <pub-id pub-id-type="pmid">11932250</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Langmead</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Trapnell</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Pop</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Salzberg</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>
        <source>Genome Biol</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>R25</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2009-10-3-r25</pub-id>
        <pub-id pub-id-type="pmid">19261174</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Yu</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Lam</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Yiu</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Kristiansen</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <article-title>SOAP2: an improved ultrafast tool for short read alignment</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1966</fpage>
        <lpage>1967</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp336</pub-id>
        <pub-id pub-id-type="pmid">19497933</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="other">
        <name>
          <surname>Ferragina</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Manzini</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Opportunistic data structures with applications</article-title>
        <source>Proc. of the 41st IEEE Symp on Found of Comput Sci</source>
        <year>2000</year>
        <fpage>390</fpage>
        <lpage>398</lpage>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rasko</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Webster</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Sahl</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Bashir</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Boisen</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Scheutz</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Paxinos</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Sebra</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Chin</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Iliopoulos</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Klammer</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Peluso</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Kislyuk</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Bullard</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Kasarskis</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Eid</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Rank</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Redman</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Steyert</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Frimodt-Mller</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Struve</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Petersen</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Krogfelt</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Nataro</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Schadt</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Waldor</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Origins of the E. coli strain causing an outbreak of hemolytic-uremic syndrome in Germany</article-title>
        <source>New England J Med</source>
        <year>2011</year>
        <volume>365</volume>
        <fpage>709</fpage>
        <lpage>717</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa1106920</pub-id>
        <pub-id pub-id-type="pmid">21793740</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Brudno</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Poliakov</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Salamov</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Cooper</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Sidow</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Rubin</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Solovyev</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Batzoglou</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Dubchak</surname>
          <given-names>I</given-names>
        </name>
        <article-title>Automated Whole-Genome Multiple Alignment of Rat, Mouse, and Human</article-title>
        <source>Genome Res</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>685</fpage>
        <lpage>692</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.2067704</pub-id>
        <pub-id pub-id-type="pmid">15060011</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schwartz</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Kent</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Smit</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Baertsch</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Hardison</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Haussler</surname>
          <given-names>D</given-names>
          <suffix>Miller</suffix>
        </name>
        <article-title>Human-Mouse Alignments with BLASTZ</article-title>
        <source>Genome Res</source>
        <year>2003</year>
        <volume>13</volume>
        <fpage>103</fpage>
        <lpage>107</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.809403</pub-id>
        <pub-id pub-id-type="pmid">12529312</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kurtz</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Phillippy</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Delcher</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Smoot</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Shumway</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Antonescu</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Salzberg</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Versatile and open software for comparing large genomes</article-title>
        <source>Genome Biol</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R122</fpage>
        <lpage>R129</lpage>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Altschul</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Gish</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Miller</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Myers</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Lipman</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Basic local alignment search tool</article-title>
        <source>J Mol Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lipman</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Pearson</surname>
          <given-names>W</given-names>
        </name>
        <article-title>Rapid and sensitive protein similarity searches</article-title>
        <source>Science</source>
        <year>1985</year>
        <volume>4693</volume>
        <fpage>1435</fpage>
        <lpage>1441</lpage>
        <pub-id pub-id-type="pmid">2983426</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bray</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Dubchak</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Pachter</surname>
          <given-names>L</given-names>
        </name>
        <article-title>AVID: A global alignment program</article-title>
        <source>Genome Res</source>
        <year>2003</year>
        <volume>13</volume>
        <fpage>97</fpage>
        <lpage>102</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.789803</pub-id>
        <pub-id pub-id-type="pmid">12529311</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Darling</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Mau</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Blatter</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Perna</surname>
          <given-names>N</given-names>
        </name>
        <article-title>Mauve: multiple alignment of conserved genomic sequence with rearrangements</article-title>
        <source>Genome Res</source>
        <year>2004</year>
        <volume>14</volume>
        <fpage>1394</fpage>
        <lpage>1403</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.2289704</pub-id>
        <pub-id pub-id-type="pmid">15231754</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Brudno</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Do</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Cooper</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Davydov</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Green</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Sidow</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Batzoglou</surname>
          <given-names>S</given-names>
        </name>
        <article-title>LAGAN and Multi-LAGAN: efficient tools for large-scale multiple alignment of genomic DNA</article-title>
        <source>Genome Res</source>
        <year>2003</year>
        <volume>13</volume>
        <fpage>721</fpage>
        <lpage>731</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.926603</pub-id>
        <pub-id pub-id-type="pmid">12654723</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kent</surname>
          <given-names>WJ</given-names>
        </name>
        <name>
          <surname>Baertsch</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Hinrichs</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Miller</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Haussler</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Evolution’s cauldron: Duplication, deletion, and rearrangement in the mouse and human genomes</article-title>
        <source>Proc Nat Acad Sci</source>
        <year>2003</year>
        <volume>100</volume>
        <fpage>11484</fpage>
        <lpage>11489</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1932072100</pub-id>
        <pub-id pub-id-type="pmid">14500911</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Fast and accurate long-read alignment with Burrows Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <fpage>589</fpage>
        <lpage>595</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp698</pub-id>
        <pub-id pub-id-type="pmid">20080505</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Kristiansen</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>J</given-names>
        </name>
        <article-title>SOAP: short oligonucleotide alignment program</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>713</fpage>
        <lpage>714</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn025</pub-id>
        <pub-id pub-id-type="pmid">18227114</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Ruan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>R</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Mapping short DNA sequencing reads and calling variants using mapping quality scores</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1851</fpage>
        <lpage>1858</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.078212.108</pub-id>
        <pub-id pub-id-type="pmid">18714091</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rumble</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Lacroute</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Dalca</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fiume</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Sidow</surname>
          <given-names>A</given-names>
        </name>
        <etal/>
        <article-title>SHRiMP: Accurate Mapping of Short Color-space Reads</article-title>
        <source>PLoS Comput Biol</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>e1000386</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000386</pub-id>
        <pub-id pub-id-type="pmid">19461883</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="book">
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Eddy</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Krobh</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Mitchison</surname>
          <given-names>G</given-names>
        </name>
        <source>Biol Sequence Anal: Probabilistic Models of Proteins and Nucleic Acids. The Edinburgh Building, Cambridge, CB2 2RU</source>
        <year>1998</year>
        <publisher-name>United Kingdom: Cambridge University Press</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Needleman</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Wunsch</surname>
          <given-names>C</given-names>
        </name>
        <article-title>A general method applicable to the search for similarities in the amino acid sequence of two proteins</article-title>
        <source>J Mol Biol</source>
        <year>1970</year>
        <volume>48</volume>
        <fpage>443</fpage>
        <lpage>453</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-2836(70)90057-4</pub-id>
        <pub-id pub-id-type="pmid">5420325</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Eid</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Fehr</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Korlach</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Turner</surname>
          <given-names>S</given-names>
        </name>
        <etal/>
        <article-title>Real-time DNA sequencing from single polymerase molecules</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>323</volume>
        <fpage>133</fpage>
        <lpage>138</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1162986</pub-id>
        <pub-id pub-id-type="pmid">19023044</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Clarke</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Wu</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Jayasinghe</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Patel</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Reid</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Bayley</surname>
          <given-names>H</given-names>
        </name>
        <article-title>Continuous base identification for single-molecule nanopore DNA sequencing</article-title>
        <source>Nat Nanotechnol</source>
        <year>2009</year>
        <volume>4</volume>
        <fpage>265</fpage>
        <lpage>270</lpage>
        <pub-id pub-id-type="doi">10.1038/nnano.2009.12</pub-id>
        <pub-id pub-id-type="pmid">19350039</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cherf</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Lieberman</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Rashid</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Lam</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Karplus</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Akeson</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Automated forward and reverse ratcheting of DNA in a nanopore at 5-Å precision</article-title>
        <source>Nat Nanotechnol</source>
        <year>2012</year>
        <volume>14</volume>
        <fpage>344</fpage>
        <lpage>348</lpage>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Garaj</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Hubbard</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Reina</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Kong</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Branton</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Golovchenko</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Graphene as a subnanometre trans-electrode membrane</article-title>
        <source>Nature</source>
        <year>2010</year>
        <volume>467</volume>
        <fpage>190</fpage>
        <lpage>193</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09379</pub-id>
        <pub-id pub-id-type="pmid">20720538</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Altschul</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Madden</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Schäffer</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Miller</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Lipman</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>
        <source>Nucleic Acids Res</source>
        <year>1997</year>
        <volume>17</volume>
        <fpage>3389</fpage>
        <lpage>3402</lpage>
        <pub-id pub-id-type="pmid">9254694</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Weese</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Emde</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Rausch</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Döring</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Reinert</surname>
          <given-names>K</given-names>
        </name>
        <article-title>RazerS-fast read mapping with sensitivity control</article-title>
        <source>Genome Res</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>1646</fpage>
        <lpage>1654</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.088823.108</pub-id>
        <pub-id pub-id-type="pmid">19592482</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bao</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Eddy</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Automated de novo identification of repeat sequence families in sequenced genomes</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>1269</fpage>
        <lpage>1276</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.88502</pub-id>
        <pub-id pub-id-type="pmid">12176934</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Flusberg</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Webster</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Travers</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Olivares</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Clark</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Korlach</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>SW</surname>
          <given-names>T</given-names>
        </name>
        <article-title>Direct detection of DNA methylation during single-molecule, real-time sequencing</article-title>
        <source>Nat Methods</source>
        <year>2010</year>
        <volume>7</volume>
        <fpage>461</fpage>
        <lpage>465</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1459</pub-id>
        <pub-id pub-id-type="pmid">20453866</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Alkan</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Kidd</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Marques-Bonet</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Aksay</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Antonacci</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Hormozdiari</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Kitzman</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Baker</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Malig</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Mutlu</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Sahinalp</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Gibbs</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Eichler</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Personalized Copy-Number and Segmental Duplication Maps using Next-Generation Sequencing</article-title>
        <source>Nat Genet</source>
        <year>2009</year>
        <volume>41</volume>
        <fpage>1061</fpage>
        <lpage>1067</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.437</pub-id>
        <pub-id pub-id-type="pmid">19718026</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Myers</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Manber</surname>
          <given-names>U</given-names>
        </name>
        <article-title>Suffix arrays: A new method for on-line string searches</article-title>
        <source>SIAM J Comput</source>
        <year>1993</year>
        <volume>22</volume>
        <fpage>935</fpage>
        <lpage>948</lpage>
        <pub-id pub-id-type="doi">10.1137/0222058</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Abouelhoda</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Ohlebusch</surname>
          <given-names>E</given-names>
        </name>
        <article-title>A Local Chaining Algorithm and its Applications in Comparitive Genomics</article-title>
        <source>Lecture Notes in Comput Sci</source>
        <year>2812</year>
        <volume>2003</volume>
        <fpage>1</fpage>
        <lpage>16</lpage>
      </mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Eppstein</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Galil</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Giancarlo</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Italiano</surname>
          <given-names>G</given-names>
        </name>
        <article-title>Sparse Dynamic Programming I: Linear cost functions</article-title>
        <source>J Assoc Comput Machinery</source>
        <year>1992</year>
        <volume>39</volume>
        <fpage>519</fpage>
        <lpage>545</lpage>
        <pub-id pub-id-type="doi">10.1145/146637.146650</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
