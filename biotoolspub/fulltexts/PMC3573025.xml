<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3573025</article-id>
    <article-id pub-id-type="pmid">23457449</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-12-27874</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0054422</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Genome Analysis Tools</subject>
              <subj-group>
                <subject>Sequence Assembly Tools</subject>
              </subj-group>
            </subj-group>
            <subj-group>
              <subject>Genome Sequencing</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Sequence Analysis</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Genomics</subject>
          <subj-group>
            <subject>Genome Analysis Tools</subject>
            <subj-group>
              <subject>Sequence Assembly Tools</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genome Databases</subject>
            <subj-group>
              <subject>Sequence Databases</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genome Sequencing</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Proteomics</subject>
          <subj-group>
            <subject>Sequence Analysis</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer Science</subject>
        <subj-group>
          <subject>Algorithms</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Increasing Sequence Search Sensitivity with Transitive Alignments</article-title>
      <alt-title alt-title-type="running-head">Sequence Search with Transitive Alignments</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Malde</surname>
          <given-names>Ketil</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Furmanek</surname>
          <given-names>Tomasz</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <addr-line>Institute of Marine Research, Bergen, Norway</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Promponas</surname>
          <given-names>Vasilis J.</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Cyprus, Cyprus</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>ketil.malde@imr.no</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: KM. Performed the experiments: KM TF. Analyzed the data: KM. Wrote the paper: KM.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>14</day>
      <month>2</month>
      <year>2013</year>
    </pub-date>
    <volume>8</volume>
    <issue>2</issue>
    <elocation-id>e54422</elocation-id>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>9</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>12</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2013 Malde, Furmanek</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Malde, Furmanek</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Sequence alignment is an important bioinformatics tool for identifying homology, but searching against the full set of available sequences is likely to result in many hits to poorly annotated sequences providing very little information. Consequently, we often want alignments against a specific subset of sequences: for instance, we are looking for sequences from a particular species, sequences that have known 3d-structures, sequences that have a reliable (curated) function annotation, and so on. Although such subset databases are readily available, they only represent a small fraction of all sequences. Thus, the likelihood of finding close homologs for query sequences is smaller, and the alignments will in general have lower scores. This makes it difficult to distinguish hits to homologous sequences from random hits to unrelated sequences. Here, we propose a method that addresses this problem by first aligning query sequences against a large database representing the corpus of known sequences, and then constructing indirect (or <italic>transitive</italic>) alignments by combining the results with alignments from the large database against the desired target database. We compare the results to direct pairwise alignments, and show that our method gives us higher sensitivity alignments against the target database.</p>
    </abstract>
    <funding-group>
      <funding-statement>This study was funded by the Norwegian Department of Fisheries and Coastal Affairs. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>During the last decade, new developments in sequencing technology have resulted in lower costs and larger sequence volumes. Genome and transcriptome sequencing is now performed almost routinely, and the amount of publicly available sequence data has grown enormously. In contrast, correctly identifying the sequence by experimental means remains expensive, and as sequencing volumes continue to grow exponentially the proportion of sequences that can be analyzed in the lab is quickly diminishing. Thus, accurate and efficient computational methods for correct indentification and annotation of newly produced sequences remains an increasingly important challenge.</p>
    <p>Typically, computational annotation involves searching for similar but known sequences using search tools like BLAST <xref rid="pone.0054422-Altschul1" ref-type="bibr">[1]</xref>. Putative function can then be derived by transferring annotation from matches deemed to be of sufficient reliability, typically using an alignment score threshold or BLAST <inline-formula><inline-graphic xlink:href="pone.0054422.e001.jpg"/></inline-formula>-value. Although a large number of sequence data exists in public databases (as of March 2012, TrEMBL <xref rid="pone.0054422-ODonovan1" ref-type="bibr">[2]</xref> contains close to twenty million proteins, and NCBI's RefSeq <xref rid="pone.0054422-Pruitt1" ref-type="bibr">[3]</xref> almost fifteen million), only a few model organisms can be considered well studied, and most annotation is derived from homology or other automated means. Consequently, many sequences in these databases lack precise and detailed annotations.</p>
    <p>In contrast, curated databases like SwissProt <xref rid="pone.0054422-ODonovan1" ref-type="bibr">[2]</xref> generally provide much better annotations based on experimental study of the proteins in the database. The downside is limited proteome coverage, and although several thousand eukaryote species are represented in SwissProt <xref rid="pone.0054422-ODonovan1" ref-type="bibr">[2]</xref>, only 18 of them are represented with more than 1000 proteins.</p>
    <p>A lack of close homologs tempts the researcher to use lower similarity thresholds, decreasing the reliability of matches and increasing the likelihood of false positives and incorrect annotations. This problem is exacerbated further when the species or process under study is phylogenetically remote from model organisms like human, mouse, or yeast.</p>
    <p>Thus, the dilemma faced by the researcher seeking to identify novel sequences is the choice between <italic>a</italic>) a small, curated database like SwissProt, which would produce precise and detailed descriptions but where low similarity scores would mean that transferred annotations would not necessarily be accurate, or a large database like TrEMBL which would result in higher confidence alignments, but to proteins with less informative and possibly unreliable descriptions.</p>
    <p>Here we propose an approach that combines the sensitivity of searching a large database with the detailed annotation from a curated database. This is achieved by calculating alignments against the curated database <italic>indirectly</italic>, combining hits against a comprehensive database with alignments between the comprehensive database and the curated one.</p>
    <p>Our approach is inspired by algorithms for multiple sequence alignment (MSA), and in particular the <italic>T-Coffee</italic>
<xref rid="pone.0054422-Notredame1" ref-type="bibr">[4]</xref> algorithm, which uses <italic>triplets</italic> of pairwise aligned sequences to increase overall consistency of the multiple alignments by avoiding early local misalignments. These triplets are similar to our transitive alignments, but in contrast to the MSA problem which is NP-complete and therefore must depend on heuristics <xref rid="pone.0054422-Wang1" ref-type="bibr">[5]</xref>, we limit our aim to producing pairwise alignments, and thus we are able to provide an optimal solution.</p>
  </sec>
  <sec sec-type="methods" id="s2">
    <title>Methods</title>
    <p>In the following, we first define and describe the <italic>composition</italic> of two pairwise alignments to produce a <italic>transitive alignment</italic>. We then show how to combine a set of alignments into a consensus alignment, and discuss a scoring scheme and our current implementation.</p>
    <sec id="s2a">
      <title>Composing alignments</title>
      <p>We define an <italic>alignment</italic> of a pair of sequences as a function (<inline-formula><inline-graphic xlink:href="pone.0054422.e002.jpg"/></inline-formula>, say) that maps positions in one sequence to positions in the other. In addition, we require two invariants, first that the mapping is <italic>one-to-one</italic>, that is, given positions <inline-formula><inline-graphic xlink:href="pone.0054422.e003.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0054422.e004.jpg"/></inline-formula>,<disp-formula id="pone.0054422.e005"><graphic xlink:href="pone.0054422.e005.jpg" position="anchor" orientation="portrait"/><label>(1)</label></disp-formula>
</p>
      <p>It follows that the alignment invertible, i.e. there exists a mapping <inline-formula><inline-graphic xlink:href="pone.0054422.e006.jpg"/></inline-formula> back from the second sequence to the first one. Second, the alignment is <italic>monotonic</italic> (or <italic>colinear</italic>), satisfying:<disp-formula id="pone.0054422.e007"><graphic xlink:href="pone.0054422.e007.jpg" position="anchor" orientation="portrait"/><label>(2)</label></disp-formula>
</p>
      <p>(Note that for or nucleotide sequences matches may be against the reverse-complement strand. In this case we represent target positions by their negation, and then the criterion still holds). Given an alignment <inline-formula><inline-graphic xlink:href="pone.0054422.e008.jpg"/></inline-formula> from a sequence <inline-formula><inline-graphic xlink:href="pone.0054422.e009.jpg"/></inline-formula> to a sequence <inline-formula><inline-graphic xlink:href="pone.0054422.e010.jpg"/></inline-formula>, and an alignment <inline-formula><inline-graphic xlink:href="pone.0054422.e011.jpg"/></inline-formula> from <inline-formula><inline-graphic xlink:href="pone.0054422.e012.jpg"/></inline-formula> to a sequence <inline-formula><inline-graphic xlink:href="pone.0054422.e013.jpg"/></inline-formula>, we define the <italic>transitive alignment</italic> to be the function composition <inline-formula><inline-graphic xlink:href="pone.0054422.e014.jpg"/></inline-formula>, i.e. the mapping produced by first applying <inline-formula><inline-graphic xlink:href="pone.0054422.e015.jpg"/></inline-formula> to each position in <inline-formula><inline-graphic xlink:href="pone.0054422.e016.jpg"/></inline-formula> to get a coordinate in <inline-formula><inline-graphic xlink:href="pone.0054422.e017.jpg"/></inline-formula>, and then applying <inline-formula><inline-graphic xlink:href="pone.0054422.e018.jpg"/></inline-formula> to get a coordinate in <inline-formula><inline-graphic xlink:href="pone.0054422.e019.jpg"/></inline-formula>. This is illustrated in <xref ref-type="fig" rid="pone-0054422-g001">Figure 1</xref>. It is easy to see that <inline-formula><inline-graphic xlink:href="pone.0054422.e020.jpg"/></inline-formula> constitutes a valid alignment, as both the one-to-one property and the monotonicity is preserved.</p>
      <fig id="pone-0054422-g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0054422.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>The alignments <inline-formula><inline-graphic xlink:href="pone.0054422.e021.jpg"/></inline-formula> maps position <inline-formula><inline-graphic xlink:href="pone.0054422.e022.jpg"/></inline-formula> in <inline-formula><inline-graphic xlink:href="pone.0054422.e023.jpg"/></inline-formula> to position <inline-formula><inline-graphic xlink:href="pone.0054422.e024.jpg"/></inline-formula> in <inline-formula><inline-graphic xlink:href="pone.0054422.e025.jpg"/></inline-formula> and the alignment <inline-formula><inline-graphic xlink:href="pone.0054422.e026.jpg"/></inline-formula> maps position <inline-formula><inline-graphic xlink:href="pone.0054422.e027.jpg"/></inline-formula> in <inline-formula><inline-graphic xlink:href="pone.0054422.e028.jpg"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0054422.e029.jpg"/></inline-formula> in <inline-formula><inline-graphic xlink:href="pone.0054422.e030.jpg"/></inline-formula>.</title>
          <p>Thus, the composed alignment, <inline-formula><inline-graphic xlink:href="pone.0054422.e031.jpg"/></inline-formula>, maps position <inline-formula><inline-graphic xlink:href="pone.0054422.e032.jpg"/></inline-formula> to position <inline-formula><inline-graphic xlink:href="pone.0054422.e033.jpg"/></inline-formula>.</p>
        </caption>
        <graphic xlink:href="pone.0054422.g001"/>
      </fig>
      <p>Let <inline-formula><inline-graphic xlink:href="pone.0054422.e034.jpg"/></inline-formula> be a set of query sequences, <inline-formula><inline-graphic xlink:href="pone.0054422.e035.jpg"/></inline-formula> be a (large) set of intermediate sequences, and <inline-formula><inline-graphic xlink:href="pone.0054422.e036.jpg"/></inline-formula> be a set of target sequences. Given a set of alignments <inline-formula><inline-graphic xlink:href="pone.0054422.e037.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="pone.0054422.e038.jpg"/></inline-formula>, we can for each <inline-formula><inline-graphic xlink:href="pone.0054422.e039.jpg"/></inline-formula> aligning a sequence <inline-formula><inline-graphic xlink:href="pone.0054422.e040.jpg"/></inline-formula> to a sequence <inline-formula><inline-graphic xlink:href="pone.0054422.e041.jpg"/></inline-formula> find the set of all <inline-formula><inline-graphic xlink:href="pone.0054422.e042.jpg"/></inline-formula> that aligns <inline-formula><inline-graphic xlink:href="pone.0054422.e043.jpg"/></inline-formula> to some sequence <inline-formula><inline-graphic xlink:href="pone.0054422.e044.jpg"/></inline-formula>. We can then construct the set of all transitive alignments <inline-formula><inline-graphic xlink:href="pone.0054422.e045.jpg"/></inline-formula> containing all alignments <inline-formula><inline-graphic xlink:href="pone.0054422.e046.jpg"/></inline-formula>. Note that for any <inline-formula><inline-graphic xlink:href="pone.0054422.e047.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0054422.e048.jpg"/></inline-formula> there may be several values of <inline-formula><inline-graphic xlink:href="pone.0054422.e049.jpg"/></inline-formula>, each representing one particular intermediate sequence. The set of transitive alignments <inline-formula><inline-graphic xlink:href="pone.0054422.e050.jpg"/></inline-formula> may therefore contain more than one alignment of sequences <inline-formula><inline-graphic xlink:href="pone.0054422.e051.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0054422.e052.jpg"/></inline-formula>.</p>
    </sec>
    <sec id="s2b">
      <title>Scoring heuristic</title>
      <p>The preceding description ignores some details for the sake of simplicity. In addition to providing a mapping between positions, alignments are also assumed to have an associated score. In order to calculate a score for transitive alignment, we first distribute the alignment score evenly to each pair of positions in the alignment. I.e., given an alignment of score <inline-formula><inline-graphic xlink:href="pone.0054422.e053.jpg"/></inline-formula> that aligns position pairs (<inline-formula><inline-graphic xlink:href="pone.0054422.e054.jpg"/></inline-formula>,<inline-formula><inline-graphic xlink:href="pone.0054422.e055.jpg"/></inline-formula>) for <inline-formula><inline-graphic xlink:href="pone.0054422.e056.jpg"/></inline-formula>, the alignment score for each position pair is <inline-formula><inline-graphic xlink:href="pone.0054422.e057.jpg"/></inline-formula>. The composition of two alignments uses the minimum of the involved scores, so if, as in <xref ref-type="fig" rid="pone-0054422-g001">Figure 1</xref>, <inline-formula><inline-graphic xlink:href="pone.0054422.e058.jpg"/></inline-formula> maps position <inline-formula><inline-graphic xlink:href="pone.0054422.e059.jpg"/></inline-formula> to position <inline-formula><inline-graphic xlink:href="pone.0054422.e060.jpg"/></inline-formula> with score <inline-formula><inline-graphic xlink:href="pone.0054422.e061.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0054422.e062.jpg"/></inline-formula> maps <inline-formula><inline-graphic xlink:href="pone.0054422.e063.jpg"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0054422.e064.jpg"/></inline-formula> with score <inline-formula><inline-graphic xlink:href="pone.0054422.e065.jpg"/></inline-formula>, the transitive alignment <inline-formula><inline-graphic xlink:href="pone.0054422.e066.jpg"/></inline-formula> maps <inline-formula><inline-graphic xlink:href="pone.0054422.e067.jpg"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0054422.e068.jpg"/></inline-formula> with a score of <inline-formula><inline-graphic xlink:href="pone.0054422.e069.jpg"/></inline-formula>.</p>
      <p>For the entire alignment (e.g., for scoring the consensus alignments), the score is calculated as the sum of scores for each coordinate pair, recovering the original score if the alignment is constructed from a single alignment.</p>
    </sec>
    <sec id="s2c">
      <title>Combining alignments</title>
      <p>Given a set of (transitive) alignments <inline-formula><inline-graphic xlink:href="pone.0054422.e070.jpg"/></inline-formula>, we can for any two sequences <inline-formula><inline-graphic xlink:href="pone.0054422.e071.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0054422.e072.jpg"/></inline-formula> extract the subset <inline-formula><inline-graphic xlink:href="pone.0054422.e073.jpg"/></inline-formula> of alignments from <inline-formula><inline-graphic xlink:href="pone.0054422.e074.jpg"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0054422.e075.jpg"/></inline-formula>. As these alignments are not necessarily consistent with each other, it remains to reconcile these in a single consensus alignment.</p>
      <p>We formulate the problem as follows: given a set of scored alignments <inline-formula><inline-graphic xlink:href="pone.0054422.e076.jpg"/></inline-formula> from <inline-formula><inline-graphic xlink:href="pone.0054422.e077.jpg"/></inline-formula> to <inline-formula><inline-graphic xlink:href="pone.0054422.e078.jpg"/></inline-formula>, construct the combined alignment by choosing the subset of position pairs from all alignments in <inline-formula><inline-graphic xlink:href="pone.0054422.e079.jpg"/></inline-formula> that maximizes the total sum of scores while satisfying <xref ref-type="disp-formula" rid="pone.0054422.e005">Equations 1</xref> and <xref ref-type="disp-formula" rid="pone.0054422.e007">2</xref>.</p>
      <p>Let <inline-formula><inline-graphic xlink:href="pone.0054422.e080.jpg"/></inline-formula> be the maximal alignment score in <inline-formula><inline-graphic xlink:href="pone.0054422.e081.jpg"/></inline-formula> that aligns position <inline-formula><inline-graphic xlink:href="pone.0054422.e082.jpg"/></inline-formula> in sequence <inline-formula><inline-graphic xlink:href="pone.0054422.e083.jpg"/></inline-formula> to position <inline-formula><inline-graphic xlink:href="pone.0054422.e084.jpg"/></inline-formula> in sequence <inline-formula><inline-graphic xlink:href="pone.0054422.e085.jpg"/></inline-formula>. We can then calculate the total score <inline-formula><inline-graphic xlink:href="pone.0054422.e086.jpg"/></inline-formula> for aligning <inline-formula><inline-graphic xlink:href="pone.0054422.e087.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0054422.e088.jpg"/></inline-formula> with the recurrence:<disp-formula id="pone.0054422.e089"><graphic xlink:href="pone.0054422.e089.jpg" position="anchor" orientation="portrait"/><label>(3)</label></disp-formula>
</p>
      <p>This recurrence is analogous to sequence alignment (without gap penalties), with a reward for aligning <inline-formula><inline-graphic xlink:href="pone.0054422.e090.jpg"/></inline-formula> with <inline-formula><inline-graphic xlink:href="pone.0054422.e091.jpg"/></inline-formula> as the maximum alignment score linking these positions (i.e. <inline-formula><inline-graphic xlink:href="pone.0054422.e092.jpg"/></inline-formula>), and we solve it similarly by dynamic programming.</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>Results</title>
    <p>To explore transitive alignments, we used UniRef 50 <xref rid="pone.0054422-Suzek1" ref-type="bibr">[6]</xref> as the intermediate database. Its entries are at most 50% similar on the sequence level, retaining a large variety of proteins while reducing the number of sequences to approximately 4 million – a more manageable number than the full UniProt database, but still about eight times the size of SwissProt, and encompassing a larger variety of proteins. Unless otherwise noted in the text, the following uses the NCBI BLAST suite version 2.2.25 using the default parameters.</p>
    <sec id="s3a">
      <title>Protein structure identification</title>
      <p>The SCOP database <xref rid="pone.0054422-Murzin1" ref-type="bibr">[7]</xref> classifies proteins based on structural alignments. Protein 3D structure is generally considered to be more conserved than protein sequence, and structural alignments is therefore able to identify homology in many cases where sequence comparison fails. At around 25–30% identity we find the <italic>Twilight Zone</italic>, where pairwise sequence alignments start to produce a considerable number of non-homologous hits <xref rid="pone.0054422-Rost1" ref-type="bibr">[8]</xref>.</p>
      <p>We downloaded SCOP 40, version 1.75A. This contains 11 211 proteins from SCOP with at most 40% identity, classified into SCOP's categories of class, fold, superfamily, and family. We used BLASTP to align this set of proteins against itself, and we also generated transitive alignments by using BLASTP to match the SCOP proteins to UniRef 50, and BLASTP alignments from UniRef 50 to SCOP 40, in both cases with an <inline-formula><inline-graphic xlink:href="pone.0054422.e093.jpg"/></inline-formula>-value threshold of 0.1. The results were sorted according to alignment score, and classified as true positives if the query and target had the same classification, false positives if they had different classification. The resulting ROC curves for the SCOP superfamily and fold levels are shown in <xref ref-type="fig" rid="pone-0054422-g002">Figure 2</xref>.</p>
      <fig id="pone-0054422-g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0054422.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>ROC curves of hits from SCOP 40 to itself.</title>
          <p>Hits to the same SCOP classification are considered true positives, hits with different classifications are considered false positives.</p>
        </caption>
        <graphic xlink:href="pone.0054422.g002"/>
      </fig>
      <p>We see that for the same number of false positives, we are able to identify a higher number of true positives using transitive alignments. We also see that as we increase the number of false positives, transitive alignments gain true positives at a higher rate. Using direct BLAST with the default <inline-formula><inline-graphic xlink:href="pone.0054422.e094.jpg"/></inline-formula>-value threshold of 10, we identified a total of 47 908 false and 54 222 true positives at the superfamiliy level. Using transitive alignments with the same number of false positives, we identified 112 718 true positives, more than a twofold improvement. We also attempted the BLAST analysis specifying different substitution matrices, using BLOSUM-90 and BLOSUM-45 instead of the default BLOSUM-62. This did not have any substantial effect on the outcome, and BLOSUM-62 produced marginally better results than the alternatives.</p>
      <p>It is also interesting to compare the results for superfamilies and folds. We see that using the looser criterion of folds only marginally increases the number of true positives for BLASTP, but that there is a substantial improvement for the transitive alignments. For instance, at 500 false positives, we find 36 243 true positives using BLAST at the superfamily level, with an additional 459 (1.3%) hits at the folds level. For transitive alignments, we identify 67 932 true positives at the superfamily level, increasing by 6 419 (9.4%) at the folds level.</p>
    </sec>
    <sec id="s3b">
      <title>Transcript annotation</title>
      <p>The salmon louse <italic>Lepeophtheirus salmonis</italic> is a small crustacean that is parasitic on salmonid fish. It is phylogenetically distant from most well-studied species, with copepods believed to have separated from insects more than 300 million years ago <xref rid="pone.0054422-Selden1" ref-type="bibr">[9]</xref>. In addition, the salmon louse has a specialized life cycle, which adds to the challenge of identifying its proteins.</p>
      <p>As part of the Salmon Louse Genome Project a set of 45 360 putative transcripts have been predicted <italic>ab initio</italic> from a draft genome assembly using Augustus <xref rid="pone.0054422-Stanke1" ref-type="bibr">[10]</xref>. In the following, we will investigate how transitive alignments can be used to annotate these sequences.</p>
      <p>The input sequences were aligned against UniRef 50 using BLASTX and the UniRef 50 sequences were aligned against SwissProt using BLASTP, in both cases using an <inline-formula><inline-graphic xlink:href="pone.0054422.e095.jpg"/></inline-formula>-value threshold of <inline-formula><inline-graphic xlink:href="pone.0054422.e096.jpg"/></inline-formula>. Transitive alignments were then calculated from these sets of BLAST hits, resulting in 23 457 transcripts receiving at least one alignment to a SwissProt sequence.</p>
    </sec>
    <sec id="s3c">
      <title>Sensitivity</title>
      <p>In order to compare our approach to a traditional BLAST analysis, we aligned the putative transcripts directly against SwissProt using BLASTX. Using a maximum <inline-formula><inline-graphic xlink:href="pone.0054422.e097.jpg"/></inline-formula>-value of 1, we were able to align 29 137 (64%) transcripts, but as shown in <xref ref-type="fig" rid="pone-0054422-g003">Figure 3</xref>, the number decreases rapidly with stricter <inline-formula><inline-graphic xlink:href="pone.0054422.e098.jpg"/></inline-formula>-value thresholds, and a large fraction of transcript only have low confidence alignments. To get the same number of aligned transcripts as we found using transitive alignments requires an <inline-formula><inline-graphic xlink:href="pone.0054422.e099.jpg"/></inline-formula>-value threshold of 0.33.</p>
      <fig id="pone-0054422-g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0054422.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>The number of transcripts aligned against the SwissProt database using increasing <inline-formula><inline-graphic xlink:href="pone.0054422.e100.jpg"/></inline-formula>-value threshold.</title>
          <p>For comparison, the total number of transcripts (45 360), and the number of transcripts annotated using transitive alignments with BLAST <inline-formula><inline-graphic xlink:href="pone.0054422.e101.jpg"/></inline-formula>-values of <inline-formula><inline-graphic xlink:href="pone.0054422.e102.jpg"/></inline-formula> (22 162) are also shown.</p>
        </caption>
        <graphic xlink:href="pone.0054422.g003"/>
      </fig>
      <p>A direct alignment of the putative transcripts with an <inline-formula><inline-graphic xlink:href="pone.0054422.e103.jpg"/></inline-formula>-value threshold of <inline-formula><inline-graphic xlink:href="pone.0054422.e104.jpg"/></inline-formula> to SwissProt results in 14 018 (31%) of the sequences matching at least one protein sequence. Aligning the transcripts to UniRef 50 results in 25 034 (55%) sequences matching, and aligning UniRef 50 against SwissProt results in 1.9 million (43%) of the UniRef proteins being aligned. This is summarized in <xref ref-type="fig" rid="pone-0054422-g004">Figure 4</xref>. In light of these numbers, the number (23 457, or 52%) of transitively aligned sequences is high, and sequences in UniRef 50 that are aligned to a transcript also have a higher probability than average of matching a SwissProt sequence.</p>
      <fig id="pone-0054422-g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0054422.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Sequence databases, and the number of query sequences with BLAST hits, using an <inline-formula><inline-graphic xlink:href="pone.0054422.e105.jpg"/></inline-formula>-value threshold of <inline-formula><inline-graphic xlink:href="pone.0054422.e106.jpg"/></inline-formula>.</title>
          <p>Numbers in parentheses indicate the percentage of query sequences with BLAST hits, transitive alignments are represented by the dashed arrow.</p>
        </caption>
        <graphic xlink:href="pone.0054422.g004"/>
      </fig>
    </sec>
    <sec id="s3d">
      <title>Consistency</title>
      <p>SwissProt and UniProt IDs (<italic>entry names</italic>) consist of two parts, a mnemonic protein ID (or <italic>gene symbol</italic>), and a mnemonic species ID. For instance, the protein CYAB_BORPE is the Cyclolysin secretion/processing ATP-binding protein gene (CYAB) found in the species <italic>Bordetella pertussis</italic> (BORPE). For each transcript, we extracted the gene symbol from the best SwissProt hit, and identified the position (rank) of the highest scoring transitive alignment to a protein with the same gene symbol (i.e., ignoring any differences in organism).</p>
      <p>We partitioned the transcripts in categories based on the <inline-formula><inline-graphic xlink:href="pone.0054422.e107.jpg"/></inline-formula>-value for the best direct alignment to SwissProt. <xref ref-type="fig" rid="pone-0054422-g005">Figure 5</xref> shows the fraction of the transcripts in each category receiving an annotation based on transitive alignments. We see that the likelihood of receiving a transitive annotation increases with the quality of the SwissProt alignment. For low <inline-formula><inline-graphic xlink:href="pone.0054422.e108.jpg"/></inline-formula>-values, the consistency is low, and for the transcripts with only weak direct alignments (<inline-formula><inline-graphic xlink:href="pone.0054422.e109.jpg"/></inline-formula>-value <inline-formula><inline-graphic xlink:href="pone.0054422.e110.jpg"/></inline-formula>0.1), only 508 (5.7%) of them were transitively aligned to the same gene symbol as the direct alignment. Interestingly, a much larger number (1 957, 21.8%) received a different annotation.</p>
      <fig id="pone-0054422-g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0054422.g005</object-id>
        <label>Figure 5</label>
        <caption>
          <title>The fraction of all transcripts receiving an annotation using transitive alignment, grouped by e-value threshold of the transcript's best SwissProt match.</title>
          <p>Red bars indicate that the gene symbol of the best SwissProt match is also among the transitive annotations (see also <xref ref-type="fig" rid="pone-0054422-g006">Fig. 6</xref>), green bars that only different proteins were matched.</p>
        </caption>
        <graphic xlink:href="pone.0054422.g005"/>
      </fig>
      <p>A more detailed view on the consistency of the alignments is given in <xref ref-type="fig" rid="pone-0054422-g006">Figure 6</xref>. This shows the rank of the best SwissProt hit among the transitive alignments. We see that the best SwissProt hits are usually at or near the top of the transitive alignments, and that this is more pronounced for transcripts with good direct hits.</p>
      <fig id="pone-0054422-g006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0054422.g006</object-id>
        <label>Figure 6</label>
        <caption>
          <title>The fraction of transcripts with transitive alignments, categorized by the position (rank) of the best SwissProt hit among the transitive alignments.</title>
          <p>Proteins are considered the same if they have the same gene symbol.</p>
        </caption>
        <graphic xlink:href="pone.0054422.g006"/>
      </fig>
      <p>One important caveat is that gene symbols do not provide an unambiguous or even accurate way to identify orthologs, and for historical reasons, orthologous genes are often assigned different gene symbols. Also, members of closely related gene families can be difficult to distinguish, and will often have similar, but not identical, gene symbols. For instance, the transcripts g34 and g35 were annotated based on direct alignments as LCE and NAS4, respectively. Their transitive alignments assigned both to NAS15, which means that for the purposes of our analysis, both transcript were counted as a changed gene symbol. However, both the NASx family and LCE genes are metal-binding proteinases in the peptidase M12A family. A closer inspection of the genome revealed that g34 and g35 were indeed the same gene, and that they were incorrectly predicted to be separate transcripts due to a misassembly of the genome, where a short region had been erroneously duplicated in the scaffolding process.</p>
    </sec>
    <sec id="s3e">
      <title>Improved alignments</title>
      <p>With a more sensitive local alignment algorithm, we expect to see longer alignments in the case where the correct homolog is identified. For each transcript, we calculated the ratio of transitive alignment length to the direct alignment length, both for the highest scoring transitive alignment, and for the same target sequence as the best direct alignment. The results are shown in <xref ref-type="fig" rid="pone-0054422-g007">Figure 7</xref>. We see that for all categories, more than 75% of the sequences produce longer transitive alignments than direct alignments. Here also, we see the tendency of lower improvements for the best alignment category. An example where a longer alignment is discovered using transitive alignments is shown in <xref ref-type="fig" rid="pone-0054422-g008">Figure 8</xref>. Here, the annotation for one transcript is extended through the use of several intermediate matches, resulting in a transitive alignment of length 145 amino acids, in contrast to the direct alignment length of 89 amino acids.</p>
      <fig id="pone-0054422-g007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0054422.g007</object-id>
        <label>Figure 7</label>
        <caption>
          <title>Alignments lengths resulting from transitive alignments divided by the corresponding score for the best direct alignment.</title>
          <p>The plot shows median, quartiles, and 10- and 90-percentile length ratios, for the best transitive alignment (blue), and for the best transitive alignment with the same gene symbol as the best direct alignment (red).</p>
        </caption>
        <graphic xlink:href="pone.0054422.g007"/>
      </fig>
      <fig id="pone-0054422-g008" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0054422.g008</object-id>
        <label>Figure 8</label>
        <caption>
          <title>Using BLASTX to align the transcript (g4) to SwissProt identifies a short match (green) against YK006.</title>
          <p>BLASTX searches against UniRef 50 produces alignments (yellow) to proteins Q1HPJ3 and F4WS09. Both of these also match YK006, and these are used to construct the transitive alignment (blue) that covers almost the complete transcript. (For simplicity, other intermediate hits in UniRef 50 are omitted).</p>
        </caption>
        <graphic xlink:href="pone.0054422.g008"/>
      </fig>
    </sec>
    <sec id="s3f">
      <title>Pfam domains and novel annotations</title>
      <p>Of the transcripts, 16 223 (35.8%) had no direct BLAST hits to SwissProt. Using transitive alignments, we were able to identify an alignment for 2405 of these. The distribution of alignment scores and lengths are given in <xref ref-type="fig" rid="pone-0054422-g009">Figure 9</xref>. As expected, most alignments are short and with low scores, but there are also several transcripts with long or high scoring alignments.</p>
      <fig id="pone-0054422-g009" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0054422.g009</object-id>
        <label>Figure 9</label>
        <caption>
          <title>Length and score of transitive alignments for transcripts that had no direct BLAST match.</title>
          <p>Although not directly comparable, direct alignments with an <inline-formula><inline-graphic xlink:href="pone.0054422.e111.jpg"/></inline-formula>-value of <inline-formula><inline-graphic xlink:href="pone.0054422.e112.jpg"/></inline-formula> have alignment scores averaging 44.4. Data points marked with as <inline-formula><inline-graphic xlink:href="pone.0054422.e113.jpg"/></inline-formula> represent transcripts with an identified Pfam domain.</p>
        </caption>
        <graphic xlink:href="pone.0054422.g009"/>
      </fig>
      <p>SwissProt records are, among other information, annotated with identified protein domains. We therefore compared the transitive alignments to the results of using HMMER with Pfam to identify domains in the sequences. Of the full set of transcripts, HMMER was able to annotate 13 393 (29.5%) with a Pfam domain. (If we limit the <inline-formula><inline-graphic xlink:href="pone.0054422.e114.jpg"/></inline-formula>-value to <inline-formula><inline-graphic xlink:href="pone.0054422.e115.jpg"/></inline-formula> the number of transcripts with an identified domain is 12 985, or 28.6%). For each of the transcripts we examined the SwissProt record of the best transitive alignment hit. We found that for 12 727 (95.0%) transcripts, the highest scoring protein was annotated with the domain identified using HMMER.</p>
      <p>Of the transcripts without direct BLAST hits, only 117 (4.7%) were annotated with a Pfam domain annotation using HMMER, these are shown separately in <xref ref-type="fig" rid="pone-0054422-g009">Figure 9</xref>. Examining the SwissProt records of the highest scoring transitive alignment, we find that 93 (79.5%) of them are annotated with the same Pfam domain as HMMER identifies.</p>
      <p>The most commonly occurring domains in this set, and the corresponding transitive alignments, are listed in <xref ref-type="table" rid="pone-0054422-t001">Table 1</xref>. Here we see that our annotations are quite consistent with the identified domains, for instance: all the THAP domains occur in sequences identified as THAPx variants; the Transposase_1 and HTH_Tnp_Tc3_2 (helix-turn-helix) domains are identified in sequences all annotated as transposases; and POGK, POGZ, TIDG6, and JERKL are all annotated with the DDE_1 endonuclease domain in UniProt.</p>
      <table-wrap id="pone-0054422-t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0054422.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>The most frequent Pfam motifs identified in the novel transcripts.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0054422-t001-1" xlink:href="pone.0054422.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Pfam Motif</td>
                <td align="left" rowspan="1" colspan="1">SwissProt hit</td>
                <td align="left" rowspan="1" colspan="1">Count</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Chitin_bind_3</td>
                <td align="left" rowspan="1" colspan="1">OR92A_DROME</td>
                <td align="left" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">CUE</td>
                <td align="left" rowspan="1" colspan="1">TC1A_CAEEL</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">TCB2_CAEBR</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DDE_Tnp_IS1595</td>
                <td align="left" rowspan="1" colspan="1">Y132A_HAEIN</td>
                <td align="left" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DUF227</td>
                <td align="left" rowspan="1" colspan="1">DHS27_CAEEL</td>
                <td align="left" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DUF659</td>
                <td align="left" rowspan="1" colspan="1">CGBP1_MOUSE</td>
                <td align="left" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">MTTB</td>
                <td align="left" rowspan="1" colspan="1">MTTB_DESHY</td>
                <td align="left" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Peptidase_A17</td>
                <td align="left" rowspan="1" colspan="1">POL4_DROME</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">TAAR4_MOUSE</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">RVP</td>
                <td align="left" rowspan="1" colspan="1">YRD6_CAEEL</td>
                <td align="left" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">rve</td>
                <td align="left" rowspan="1" colspan="1">YRD6_CAEEL</td>
                <td align="left" rowspan="1" colspan="1">3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">RVT_1</td>
                <td align="left" rowspan="1" colspan="1">LIN1_NYCCO</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">PO11_NASVI</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">RTJK_DROME</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Zona_pellucida</td>
                <td align="left" rowspan="1" colspan="1">CUT1_CAEEL</td>
                <td align="left" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">ELDP2_LOTGI</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DDE_1</td>
                <td align="left" rowspan="1" colspan="1">POGK_HUMAN</td>
                <td align="left" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">POGK_MOUSE</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">POGZ_MOUSE</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">TIGD6_HUMAN</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">JERKL_MOUSE</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">THAP</td>
                <td align="left" rowspan="1" colspan="1">HAP2_HUMAN</td>
                <td align="left" rowspan="1" colspan="1">3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">THAP4_BOVIN</td>
                <td align="left" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">THAP2_MOUSE</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">THAP1_DANRE</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">THAP9_HUMAN</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Transposase_1</td>
                <td align="left" rowspan="1" colspan="1">MOS1T_DROMA</td>
                <td align="left" rowspan="1" colspan="1">11</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">SETMR_HUMAN</td>
                <td align="left" rowspan="1" colspan="1">2</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HTH_Tnp_Tc3_2</td>
                <td align="left" rowspan="1" colspan="1">TCB1_CAEBR</td>
                <td align="left" rowspan="1" colspan="1">5</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">TCB2_CAEBR</td>
                <td align="left" rowspan="1" colspan="1">4</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">TC1A_CAEEL</td>
                <td align="left" rowspan="1" colspan="1">3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">TC3A_CAEEL</td>
                <td align="left" rowspan="1" colspan="1">3</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">SETMR_HUMAN</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">MOS1T_DROMA</td>
                <td align="left" rowspan="1" colspan="1">1</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>An example of a novel annotation is shown in <xref ref-type="fig" rid="pone-0054422-g010">Figure 10</xref>, where the transcript is aligned via two different UniRef 50 sequences. Both sequences map consistently to a SwissProt sequence, but with little overlap. The transitive alignment thus covers the whole transcript, and it can be unambiguously annotated as a fragment of a gene similar to mariner transposase <xref rid="pone.0054422-Demattei1" ref-type="bibr">[11]</xref>.</p>
      <fig id="pone-0054422-g010" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0054422.g010</object-id>
        <label>Figure 10</label>
        <caption>
          <title>The g117 transcript had no significant BLASTX hits to SwissProt, nor any annotated Pfam domains.</title>
          <p>Again, by using hits against two UniRef 50 sequences, we can calculate a transitive alignment that covers the entire transcript sequence. Interestingly, the SETMR gene is primate specific, and consists of a Histone-lysine N-methyl transferase (SET domain, EC 2.1.1.43) with an inserted transposase (Hsmar1, EC 3.1), and it also has one isoform without the transposase. The transitive alignment of g117 is against the transposase domain, and the alignments of the intermediate proteins also match this part almost exactly, so in all likelihood, the SET domain is irrelevant for g117. Nevertheless, the annotation of F4WD00 in UniProt is as a methyl transferase. An annotation based on this would thus be incorrect, illustrating the dangers of using an uncurated database.</p>
        </caption>
        <graphic xlink:href="pone.0054422.g010"/>
      </fig>
    </sec>
  </sec>
  <sec id="s4">
    <title>Discussion</title>
    <p>There are now vast amounts of easily available sequence data, and although large resources are committed to curation and experimental validation, the proportion of uncurated data is large and growing. As the raw data becomes cheaper to produce, we need automatic methods that can exploit the raw data directly. The method we present here use uncurated sequence data to provide a context for sequence alignments, and is able use this context to construct alignments with higher sensitivity than direct, pairwise alignments.</p>
    <p>As a typical transcript annotation experiment, we aligned transcripts to SwissProt, and found that using transitive alignments with a relatively conservative <inline-formula><inline-graphic xlink:href="pone.0054422.e116.jpg"/></inline-formula>-value threshold identified alignments for a larger fraction of the query sequences than direct alignments with similar parameters. Also, the alignments identified transitively are substantially longer, indicating higher sensitivity. We also see that we are able to find identified Pfam domains from transitively aligned protein matches.</p>
    <p>Perhaps the most significant result is the identification of SCOP folds and superfamilies. Here we see that not only does transitive alignment identify the known SCOP relationships more accurately than direct BLAST, but while BLAST mainly find superfamily relationships, transitive alignments are also able to identify many relationships at the more distant fold level. This is perhaps the clearest evidence that our method offers substantial improvement over direct BLAST.</p>
    <sec id="s4a">
      <title>Related work</title>
      <p>Perhaps the best known tool for identifying distantly related homologs is PSI-BLAST <xref rid="pone.0054422-Altschul1" ref-type="bibr">[1]</xref>. It uses the result of an initial BLASTP query against a database to build a position-specific scoring matrix (PSSM), which is then used to search the database again to identify more matching sequences, and this process is then iterated.</p>
      <p>Similar to the PSSMs generated by PSI-BLAST, it is possible to identify functionally related proteins through shared motifs or domains, often described using hidden Markov models. Typically, motif or domain databases (e.g. Pfam <xref rid="pone.0054422-Punta1" ref-type="bibr">[12]</xref> or SMART <xref rid="pone.0054422-Schultz1" ref-type="bibr">[13]</xref>) are derived from collections of proteins, and used with search programs like HMMER <xref rid="pone.0054422-Eddy1" ref-type="bibr">[14]</xref> to search the candidate sequences.</p>
      <p>Although these tools share the goal of identifying homology, they differ from our approach in several important respects. First, although we also make use of multiple sequences to strengthen the results, our aim is to identify individual homologs. Thus, our method serves as a drop-in replacement for regular BLAST, and the method is simpler both to understand and to use as it avoids stochastic models of sequences or sequence fragments. In contrast to PSI-BLAST, our method can be used to annotate nucleotide query sequences directly, and where PSI-BLAST results in a cluster of related sequences, our method results in a set of individual sequences in a specific target database.</p>
      <p>Combining or post-processing pairwise BLAST results is not a new approach, and e.g. taking the best alignment score between groups of sequences has been shown to identify protein family relationships with a higher sensitivity than using stochastic models, at least for small groups of sequences <xref rid="pone.0054422-Grundy1" ref-type="bibr">[15]</xref>. Our method differs in that it does not depend on any <italic>a priori</italic> grouping or classification, and that it produces the alignment of sequence positions, and not just a similarity score.</p>
    </sec>
    <sec id="s4b">
      <title>Future Directions</title>
      <p>In our analyses we have kept the intermediate and target databases separate. This serves to distinguish the effect of transitive alignments from direct alignments, but will lead to inferior results in some cases when the sequences in the intermediate database match neither query or target sequence well. In practice, this is easily avoided by merging the seqeunces from the target database into the intermediate database.</p>
      <p>In our current experiment, we have used BLAST-based transitive alignments from nucleotide sequences to proteins, and from proteins to proteins. It is of course possible to use different combinations of sequence databases, or to use different alignment software. It is also possible to extend the chain of databases by introducing more intermediate databases.</p>
      <p>Similarly, the method is not limited to traditional sequence alignments. For instance, SwissProt contains annotated features for many of its sequences, and one could extract sequence-to-feature “alignments” to identify conserved domains. Functional annotation with Gene Ontology terms <xref rid="pone.0054422-Ashburner1" ref-type="bibr">[16]</xref> is often derived from protein alignments <xref rid="pone.0054422-Conesa1" ref-type="bibr">[17]</xref>, but as is illustrated by the example in <xref ref-type="fig" rid="pone-0054422-g010">Figure 10</xref>, this runs the risk of one conserved domain leading to an incorrect annotation with terms belonging to a different domain that happens to occur on the same sequence in the database.</p>
      <p>Here we have used a simplistic scoring model for an alignment, distributing BLAST scores uniformly over the aligned region, and summing the scores for all aligned position pairs. This scheme has the property that it preserves the original BLAST score, but other schemes are certainly conceivable. The consensus calculation could for instance be modified to use affine gap penalties, and differentiate between global and local alignments. We have not studied transitive alignment scores in detail, and consequently, the alignment score is not interpreted beyond ranking alignments. More work is needed before we can give alignment scores any meaningful interpretation, for instance in terms of <inline-formula><inline-graphic xlink:href="pone.0054422.e117.jpg"/></inline-formula>- or <inline-formula><inline-graphic xlink:href="pone.0054422.e118.jpg"/></inline-formula>-values.</p>
    </sec>
  </sec>
  <sec id="s5">
    <title>Conclusion</title>
    <p>The choice of databases to use for sequence alignment is often a compromise between accuracy and precision. By using transitive alignments, we can leverage searches against large databases that give high sensitivity and produce stronger hits against a curated database than one would get directly, and thus make this compromise less severe.</p>
    <p>The method is conceptually simple, and relies only on standard alignment software and sequence databases. Addition of new sequences to the databases and improvements in sensitivity in the alignment software (e.g., <xref rid="pone.0054422-Biegert1" ref-type="bibr">[18]</xref>–<xref rid="pone.0054422-Ma1" ref-type="bibr">[20]</xref>) will therefore improve the results. Also, as the output is similar to BLAST output, transitive alignments can be used directly in existing analysis pipelines. In contrast to using precalculated patterns, motifs or classes, transitive alignments rely only on sequence databases. We therefore believe transitive alignments provides a useful and easy to use method, and a valuable addition to the molecular biology toolset.</p>
    <sec id="s5a">
      <title>Availability</title>
      <p>We have implemented transitive alignments in Haskell, using version 7.4.1 of the GHC compiler. The source code is available under a GPL license from <ext-link ext-link-type="uri" xlink:href="http://malde.org/ketil/biohaskell/transalign">http://malde.org/ketil/biohaskell/transalign</ext-link>.</p>
    </sec>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0054422-Altschul1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Altschul</surname><given-names>SF</given-names></name>, <name><surname>Madden</surname><given-names>TL</given-names></name>, <name><surname>Schäffer</surname><given-names>AA</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>Z</given-names></name>, <etal>et al</etal> (<year>1997</year>) <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Research</source>
<volume>25</volume>: <fpage>3389</fpage>–<lpage>3402</lpage>.<pub-id pub-id-type="pmid">9254694</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0054422-ODonovan1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>O'Donovan</surname><given-names>C</given-names></name>, <name><surname>Martin</surname><given-names>MJ</given-names></name>, <name><surname>Gattiker</surname><given-names>A</given-names></name>, <name><surname>Gasteiger</surname><given-names>E</given-names></name>, <name><surname>Bairoch</surname><given-names>A</given-names></name>, <etal>et al</etal> (<year>2002</year>) <article-title>High-quality protein knowledge resource: SWISS-PROT and TrEMBL</article-title>. <source>Briefings in Bioinformatics</source>
<volume>3</volume>: <fpage>275</fpage>–<lpage>84</lpage>.<pub-id pub-id-type="pmid">12230036</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0054422-Pruitt1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Pruitt</surname><given-names>KD</given-names></name>, <name><surname>Tatusova</surname><given-names>T</given-names></name>, <name><surname>Maglott</surname><given-names>DR</given-names></name> (<year>2005</year>) <article-title>NCBI Reference Sequence (RefSeq): a curated nonredundant sequence database of genomes, transcripts and proteins</article-title>. <source>Nucleic Acids Research</source>
<volume>33</volume>: <fpage>D501</fpage>–<lpage>D504</lpage>.<pub-id pub-id-type="pmid">15608248</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0054422-Notredame1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Notredame</surname><given-names>C</given-names></name>, <name><surname>Higgins</surname><given-names>DG</given-names></name>, <name><surname>Heringa</surname><given-names>J</given-names></name> (<year>2000</year>) <article-title>T-Coffee: A novel method for fast and accurate multiple sequence alignment</article-title>. <source>Journal of Molecular Biology</source>
<volume>302</volume>: <fpage>205</fpage>–<lpage>217</lpage>.<pub-id pub-id-type="pmid">10964570</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0054422-Wang1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>L</given-names></name>, <name><surname>Jiang</surname><given-names>T</given-names></name> (<year>1994</year>) <article-title>On the complexity of multiple sequence alignment</article-title>. <source>Journal of Computational Biology</source>
<volume>1</volume>: <fpage>337</fpage>–<lpage>348</lpage>.<pub-id pub-id-type="pmid">8790475</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0054422-Suzek1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Suzek</surname><given-names>BE</given-names></name>, <name><surname>Huang</surname><given-names>H</given-names></name>, <name><surname>McGarvey</surname><given-names>P</given-names></name>, <name><surname>Mazumder</surname><given-names>R</given-names></name>, <name><surname>Wu</surname><given-names>CH</given-names></name> (<year>2007</year>) <article-title>UniRef: comprehensive and non-redundant UniProt reference clusters</article-title>. <source>Bioinformatics</source>
<volume>23</volume>: <fpage>1282</fpage>–<lpage>1288</lpage>.<pub-id pub-id-type="pmid">17379688</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0054422-Murzin1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Murzin</surname><given-names>AG</given-names></name>, <name><surname>Brenner</surname><given-names>SE</given-names></name>, <name><surname>Hubbard</surname><given-names>T</given-names></name>, <name><surname>Chothia</surname><given-names>C</given-names></name> (<year>1995</year>) <article-title>SCOP: a structural classification of proteins database for the investigation of sequences and structures</article-title>. <source>Journal of Molecular Biology</source>
<volume>247</volume>: <fpage>536</fpage>–<lpage>540</lpage>.<pub-id pub-id-type="pmid">7723011</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0054422-Rost1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Rost</surname><given-names>B</given-names></name> (<year>1999</year>) <article-title>Twilight zone of protein sequence alignments</article-title>. <source>Protein Engineering</source>
<volume>12</volume>: <fpage>85</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">10195279</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0054422-Selden1">
      <label>9</label>
      <mixed-citation publication-type="other">Selden PA, Huys R, Stephenson MH, Heward AP, Taylor PN (2010) Crustaceans from bitumen clast in Carboniferous glacial diamictite extend fossil record of copepods. Nature Communications 1.</mixed-citation>
    </ref>
    <ref id="pone.0054422-Stanke1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Stanke</surname><given-names>M</given-names></name>, <name><surname>Tzvetkova</surname><given-names>A</given-names></name>, <name><surname>Morgenstern</surname><given-names>B</given-names></name> (<year>2006</year>) <article-title>AUGUSTUS at EGASP: using EST, protein and genomic alignments for improved gene prediction in the human genome</article-title>. <source>BMC Genome Biology</source>
<volume>7</volume>: <fpage>S11</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0054422-Demattei1">
      <label>11</label>
      <mixed-citation publication-type="other">Demattei MV, Hedhili S, Sinzelle L, Bressac C, Casteret S, <etal>et al</etal>. (2011) Nuclear importation of <italic>Mariner</italic> transposases among eukaryotes: Motif requirements and homo-protein interactions. PLoS ONE 6.</mixed-citation>
    </ref>
    <ref id="pone.0054422-Punta1">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Punta</surname><given-names>M</given-names></name>, <name><surname>Coggill</surname><given-names>PC</given-names></name>, <name><surname>Eberhardt</surname><given-names>RY</given-names></name>, <name><surname>Mistry</surname><given-names>J</given-names></name>, <name><surname>Tate</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>The pfam protein families database</article-title>. <source>Nucleic Acids Research</source>
<volume>40</volume>: <fpage>D290</fpage>–<lpage>D301</lpage>.<pub-id pub-id-type="pmid">22127870</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0054422-Schultz1">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Schultz</surname><given-names>J</given-names></name>, <name><surname>Milpetz</surname><given-names>F</given-names></name>, <name><surname>Bork</surname><given-names>P</given-names></name>, <name><surname>Ponting</surname><given-names>CP</given-names></name> (<year>1998</year>) <article-title>SMART, a simple modular architecture research tool: Identification of signaling domains</article-title>. <source>PNAS</source>
<volume>95</volume>: <fpage>5857</fpage>–<lpage>5864</lpage>.<pub-id pub-id-type="pmid">9600884</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0054422-Eddy1">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Eddy</surname><given-names>SR</given-names></name> (<year>1998</year>) <article-title>Profile hidden markov models</article-title>. <source>Bioinformatics</source>
<volume>14</volume>: <fpage>755</fpage>–<lpage>763</lpage>.<pub-id pub-id-type="pmid">9918945</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0054422-Grundy1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Grundy</surname><given-names>WN</given-names></name> (<year>1998</year>) <article-title>Homology detection via family pairwise search</article-title>. <source>Journal of Computational Biology</source>
<volume>5</volume>: <fpage>479</fpage>–<lpage>492</lpage>.<pub-id pub-id-type="pmid">9773344</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0054422-Ashburner1">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Ashburner</surname><given-names>M</given-names></name> (<year>2000</year>) <article-title>Gene ontology: Tool for the unification of biology</article-title>. <source>Nature Genetics</source>
<volume>25</volume>: <fpage>25</fpage>–<lpage>29</lpage>.<pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0054422-Conesa1">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Conesa</surname><given-names>A</given-names></name>, <name><surname>Götz</surname><given-names>S</given-names></name>, <name><surname>García-Gómez</surname><given-names>JM</given-names></name>, <name><surname>Talón</surname><given-names>JTM</given-names></name>, <name><surname>Robles</surname><given-names>M</given-names></name> (<year>2005</year>) <article-title>Blast2go: a universal tool for annotation, visualization and analysis in functional genomics research</article-title>. <source>Bioinformatics</source>
<volume>21</volume>: <fpage>3674</fpage>–<lpage>3676</lpage>.<pub-id pub-id-type="pmid">16081474</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0054422-Biegert1">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Biegert</surname><given-names>A</given-names></name>, <name><surname>Söding</surname><given-names>J</given-names></name> (<year>2009</year>) <article-title>Sequence context-specific profiles for homology searching</article-title>. <source>PNAS</source>
<volume>106</volume>: <fpage>3770</fpage>–<lpage>3775</lpage>.<pub-id pub-id-type="pmid">19234132</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0054422-Malde1">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Malde</surname><given-names>K</given-names></name> (<year>2008</year>) <article-title>The effect of sequence quality on sequence alignment</article-title>. <source>Bioinformatics</source>
<volume>24</volume>: <fpage>897</fpage>–<lpage>900</lpage>.<pub-id pub-id-type="pmid">18296747</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0054422-Ma1">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Ma</surname><given-names>B</given-names></name>, <name><surname>Tromp</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name> (<year>2002</year>) <article-title>Patternhunter – faster and more sensitive homology search</article-title>. <source>Bioinformatics</source>
<volume>18</volume>: <fpage>440</fpage>–<lpage>445</lpage>.<pub-id pub-id-type="pmid">11934743</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
