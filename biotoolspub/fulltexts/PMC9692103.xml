<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName nlm2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Physiol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Physiol</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Physiol.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Physiology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-042X</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9692103</article-id>
    <article-id pub-id-type="publisher-id">1020458</article-id>
    <article-id pub-id-type="doi">10.3389/fphys.2022.1020458</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Physiology</subject>
        <subj-group>
          <subject>Technology and Code</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>vital_sqi: A Python package for physiological signal quality control</article-title>
      <alt-title alt-title-type="left-running-head">Le et al.</alt-title>
      <alt-title alt-title-type="right-running-head">
        <ext-link xlink:href="https://doi.org/10.3389/fphys.2022.1020458" ext-link-type="uri">10.3389/fphys.2022.1020458</ext-link>
      </alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Le</surname>
          <given-names>Van-Khoa D.</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <xref rid="c001" ref-type="corresp">*</xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1306717/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ho</surname>
          <given-names>Hai Bich</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/2038831/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Karolcik</surname>
          <given-names>Stefan</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1965247/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hernandez</surname>
          <given-names>Bernard</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/457985/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Greeff</surname>
          <given-names>Heloise</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">
          <sup>3</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1146296/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nguyen</surname>
          <given-names>Van Hao</given-names>
        </name>
        <xref rid="aff4" ref-type="aff">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Phan</surname>
          <given-names>Nguyen Quoc Khanh</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Le</surname>
          <given-names>Thanh Phuong</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thwaites</surname>
          <given-names>Louise</given-names>
        </name>
        <xref rid="aff1" ref-type="aff">
          <sup>1</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/1109739/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Georgiou</surname>
          <given-names>Pantelis</given-names>
        </name>
        <xref rid="aff2" ref-type="aff">
          <sup>2</sup>
        </xref>
        <uri xlink:href="https://loop.frontiersin.org/people/34347/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Clifton</surname>
          <given-names>David</given-names>
        </name>
        <xref rid="aff3" ref-type="aff">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <collab>the Vietnam ICU Translational Applications Laboratory (VITAL) Investigators</collab>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Oxford University Clinicial Research Unit</institution>, <addr-line>Ho Chi Minh City</addr-line>, <country>Vietnam</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Department of Electrical and Electronic Engineering</institution>, <institution>Imperial College London, South Kensington Campus</institution>, <addr-line>London</addr-line>, <country>United Kingdom</country></aff>
    <aff id="aff3"><sup>3</sup><institution>Department of Engineering Science</institution>, <institution>Institute of Biomedical Engineering</institution>, <institution>University of Oxford</institution>, <addr-line>Oxford</addr-line>, <country>United Kingdom</country></aff>
    <aff id="aff4"><sup>4</sup><institution>Hospital of Tropical Diseases</institution>, <institution>University of Medicine and Pharmacy</institution>, <addr-line>Ho Chi Minh City</addr-line>, <country>Vietnam</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p><bold>Edited by:</bold><ext-link xlink:href="https://loop.frontiersin.org/people/1461594/overview" ext-link-type="uri">Jinseok Lee</ext-link>, Kyung Hee University, South Korea</p>
      </fn>
      <fn fn-type="edited-by">
        <p><bold>Reviewed by:</bold><ext-link xlink:href="https://loop.frontiersin.org/people/1739270/overview" ext-link-type="uri">Mohamed Abdelazez</ext-link>, Carleton University, Canada</p>
        <p><ext-link xlink:href="https://loop.frontiersin.org/people/1165671/overview" ext-link-type="uri">Chenxi Yang</ext-link>, Southeast University, China</p>
      </fn>
      <corresp id="c001">*Correspondence: Van-Khoa D. Le, <email>khoaldv@oucru.org</email>
</corresp>
      <fn fn-type="other">
        <p>This article was submitted to Computational Physiology and Medicine, a section of the journal Frontiers in Physiology</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>11</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>13</volume>
    <elocation-id>1020458</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>07</day>
        <month>10</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2022 Le, Ho, Karolcik, Hernandez, Greeff, Nguyen, Phan, Le, Thwaites, Georgiou and Clifton.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>Le, Ho, Karolcik, Hernandez, Greeff, Nguyen, Phan, Le, Thwaites, Georgiou and Clifton</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Electrocardiogram (ECG) and photoplethysmogram (PPG) are commonly used to determine the vital signs of heart rate, respiratory rate, and oxygen saturation in patient monitoring. In addition to simple observation of those summarized indexes, waveform signals can be analyzed to provide deeper insights into disease pathophysiology and support clinical decisions. Such data, generated from continuous patient monitoring from both conventional bedside and low-cost wearable monitors, are increasingly accessible. However, the recorded waveforms suffer from considerable noise and artifacts and, hence, are not necessarily used prior to certain quality control (QC) measures, especially by those with limited programming experience. Various signal quality indices (SQIs) have been proposed to indicate signal quality. To facilitate and harmonize a wider usage of SQIs in practice, we present a Python package, named vital_sqi, which provides a unified interface to the state-of-the-art SQIs for ECG and PPG signals. The vital_sqi package provides with seven different peak detectors and access to more than 70 SQIs by using different settings. The vital_sqi package is designed with pipelines and graphical user interfaces to enable users of various programming fluency to use the package. Multiple SQI extraction pipelines can take the PPG and ECG waveforms and generate a bespoke SQI table. As these SQI scores represent the signal features, they can be input in any quality classifier. The package provides functions to build simple rule-based decision systems for signal segment quality classification using user-defined SQI thresholds. An experiment with a carefully annotated PPG dataset suggests thresholds for relevant PPG SQIs.</p>
    </abstract>
    <kwd-group>
      <kwd>signal quality index</kwd>
      <kwd>electrocardiogram</kwd>
      <kwd>photoplethysmogram</kwd>
      <kwd>vital signs</kwd>
      <kwd>continuous monitoring</kwd>
      <kwd>open-source</kwd>
      <kwd>Python toolbox</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source id="cn001">
          <institution-wrap>
            <institution>Wellcome Trust
</institution>
            <institution-id institution-id-type="doi">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>1 Introduction</title>
    <p>Continuous monitoring in ambulatory (<xref rid="B19" ref-type="bibr">Sana et al., 2020)</xref> and limited-resourced settings (<xref rid="B13" ref-type="bibr">Nantume et al., 2021)</xref> with medical-grade wearables is becoming increasingly widespread as increasing numbers of low-cost devices are available to provide continuously streamed data for long periods of time. Conventionally, physiological signals are recorded continuously for hours, but only the numerals, i.e., the summarized numbers, are reported and used in most analyses. Although powerful insights into disease processes and prognosis have been gained from such methodology, deeper understanding could also be learnt from the signal waveforms themselves as they contain significantly greater information concerning the underlying cardiovascular physiology. Machine-learning and deep-learning technologies now provide us with the ability to analyze these complex waveform data and, hence, the potential to use the electrocardiogram (ECG) and photoplethysmogram (PPG) waveforms to provide pathophysiological insights (<xref rid="B3" ref-type="bibr">Becker, 2006</xref>; <xref rid="B6" ref-type="bibr">Elgendi, 2012</xref>; <xref rid="B15" ref-type="bibr">Pereira et al., 2020)</xref>, predict disease progression (<xref rid="B24" ref-type="bibr">Tadesse et al., 2020</xref>; <xref rid="B1" ref-type="bibr">Akbilgic et al., 2021</xref>; <xref rid="B18" ref-type="bibr">Raghunath et al., 2020)</xref>, or detect abnormality (<xref rid="B2" ref-type="bibr">Badawi et al., 2021)</xref>. Analysis of data from low-cost wearable devices, especially in ambulatory patients, can be limited by poor signal quality and noise. Simple-to-use tools to evaluate quality and select appropriate data for analysis are required in order to optimize the potential for devices in improving patient outcomes.</p>
    <p>The ECG represents the heart’s electrical activity, transmitted through the body and recorded by electrodes placed on the skin of the torso and limbs. The resulting pattern consists of a baseline and waves, i.e., positive and negative deflections from the baseline depending on depolarization and repolarization activity in the heart. These deflections are named as the P wave, QRS complex (Q wave, R wave, and S wave), and T wave. The PPG records the changes in peripheral blood volume, also in the waveform pattern, by measuring the light intensity (through or reflected) using a sensor placed on the skin of various body parts such as the ear or fingertip. The PPG waveform contains a pulsatile (“AC”) component attributed to change of blood volume with each heartbeat and a baseline component (“DC”) varying at low frequency attributed to autonomic nervous system activity. Both ECG and PPG, recorded by either bedside monitors or low-cost wearable devices, are prone to noise and artifacts. The main causes can be categorized as physiological, (e.g., skin movement or muscle contraction) and non-physiological (e.g., ongoing electrical stimuli, device displacement or signal loss due to Bluetooth disconnection) (<xref rid="B12" ref-type="bibr">Nagai et al., 2017</xref>; <xref rid="B9" ref-type="bibr">Lee et al., 2020</xref>; <xref rid="B16" ref-type="bibr">Pollreisz, 2022</xref>; <xref rid="B22" ref-type="bibr">Seok et al., 2021)</xref>. In our experience using both finger tip oximeter and patch ECG monitor, loose sensor contact and Bluetooth disconnection, are among the most frequent causes. The timely identification of noisy segments is essential for both monitoring and downstream analyses.</p>
    <p>Although many signal quality indices (SQIs) and methodologies have been reported for both PPG and ECG (refer to <xref rid="T1" ref-type="table">Table 1</xref>), an open-source unified access to a wide range of SQIs does not exist yet. In addition, a powerful toolbox such as the Cardiovascular Signal Toolbox published in PhysioNet is only released in MATLAB. Furthermore, the Toolbox’s scope does not concentrate on deriving the SQI scores but extracting features for analysis.</p>
    <table-wrap position="float" id="T1">
      <label>TABLE 1</label>
      <caption>
        <p>List of well-known SQIs available in the vital_sqi Python package.</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead valign="top">
          <tr>
            <th align="left" rowspan="1" colspan="1">SQI name</th>
            <th align="left" rowspan="1" colspan="1">Type</th>
            <th align="left" rowspan="1" colspan="1">Signal</th>
            <th align="left" rowspan="1" colspan="1">Equation or brief description</th>
            <th align="left" rowspan="1" colspan="1">Per segment</th>
            <th align="left" rowspan="1" colspan="1">Per beat</th>
            <th align="left" rowspan="1" colspan="1">Introduced as SQI in</th>
          </tr>
        </thead>
        <tbody valign="top">
          <tr>
            <td align="left" rowspan="1" colspan="1">Perfusion</td>
            <td align="left" rowspan="1" colspan="1">Stats</td>
            <td align="left" rowspan="1" colspan="1">PPG</td>
            <td align="left" rowspan="1" colspan="1">
              <inline-formula id="inf1">
                <mml:math id="m1" overflow="scroll">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="italic">SQI</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>y</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>max</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:mo>−</mml:mo>
                          <mml:msub>
                            <mml:mrow>
                              <mml:mi>y</mml:mi>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>min</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mo stretchy="false">|</mml:mo>
                      <mml:mrow>
                        <mml:mover accent="true">
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mo>¯</mml:mo>
                        </mml:mover>
                      </mml:mrow>
                      <mml:mo stretchy="false">|</mml:mo>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>×</mml:mo>
                  <mml:mn>100</mml:mn>
                </mml:math>
              </inline-formula>
            </td>
            <td align="left" rowspan="1" colspan="1">Y</td>
            <td align="left" rowspan="1" colspan="1">N</td>
            <td align="left" rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Kurtosis</td>
            <td align="left" rowspan="1" colspan="1">Stats</td>
            <td align="left" rowspan="1" colspan="1">PPG</td>
            <td align="left" rowspan="1" colspan="1">
              <inline-formula id="inf2">
                <mml:math id="m2" overflow="scroll">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>K</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="italic">SQI</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo movablelimits="false" form="prefix">∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>x</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>μ</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>x</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>¯</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>σ</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                        <mml:mo stretchy="false">]</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>4</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                </mml:math>
              </inline-formula>
            </td>
            <td align="left" rowspan="1" colspan="1">Y</td>
            <td align="left" rowspan="1" colspan="1">Y</td>
            <td align="left" rowspan="1" colspan="1">
              <xref rid="B21" ref-type="bibr">Selvaraj et al. (2011)</xref>
            </td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Skewness</td>
            <td align="left" rowspan="1" colspan="1">Stats</td>
            <td align="left" rowspan="1" colspan="1">PPG</td>
            <td align="left" rowspan="1" colspan="1">
              <inline-formula id="inf3">
                <mml:math id="m3" overflow="scroll">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>S</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="italic">SQI</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo movablelimits="false" form="prefix">∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">[</mml:mo>
                        <mml:mrow>
                          <mml:mfrac>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mrow>
                                  <mml:mi>x</mml:mi>
                                </mml:mrow>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>−</mml:mo>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mrow>
                                    <mml:msub>
                                      <mml:mrow>
                                        <mml:mi>μ</mml:mi>
                                      </mml:mrow>
                                      <mml:mrow>
                                        <mml:mi>x</mml:mi>
                                      </mml:mrow>
                                    </mml:msub>
                                  </mml:mrow>
                                  <mml:mo>¯</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                            </mml:mrow>
                            <mml:mrow>
                              <mml:mi>σ</mml:mi>
                            </mml:mrow>
                          </mml:mfrac>
                        </mml:mrow>
                        <mml:mo stretchy="false">]</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>3</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                </mml:math>
              </inline-formula>
            </td>
            <td align="left" rowspan="1" colspan="1">Y</td>
            <td align="left" rowspan="1" colspan="1">Y</td>
            <td align="left" rowspan="1" colspan="1">
              <xref rid="B8" ref-type="bibr">Krishnan et al. (2010)</xref>
            </td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Entropy</td>
            <td align="left" rowspan="1" colspan="1">Stats</td>
            <td align="left" rowspan="1" colspan="1">PPG</td>
            <td align="left" rowspan="1" colspan="1">
              <inline-formula id="inf4">
                <mml:math id="m4" overflow="scroll">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>E</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="italic">SQI</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:msubsup>
                    <mml:mrow>
                      <mml:mo movablelimits="false" form="prefix">∑</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mi>x</mml:mi>
                  <mml:msup>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mrow>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mi>l</mml:mi>
                  <mml:mi>o</mml:mi>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>g</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>e</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                      <mml:msup>
                        <mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mrow>
                              <mml:mi>n</mml:mi>
                            </mml:mrow>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msup>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:math>
              </inline-formula>
            </td>
            <td align="left" rowspan="1" colspan="1">Y</td>
            <td align="left" rowspan="1" colspan="1">Y</td>
            <td align="left" rowspan="1" colspan="1">
              <xref rid="B21" ref-type="bibr">Selvaraj et al. (2011)</xref>
            </td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">SNR</td>
            <td align="left" rowspan="1" colspan="1">Stats</td>
            <td align="left" rowspan="1" colspan="1">PPG and ECG</td>
            <td align="left" rowspan="1" colspan="1">
              <inline-formula id="inf5">
                <mml:math id="m5" overflow="scroll">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>N</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="italic">SQI</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="italic">signal</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mi>σ</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="italic">noise</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:math>
              </inline-formula>
            </td>
            <td align="left" rowspan="1" colspan="1">Y</td>
            <td align="left" rowspan="1" colspan="1">N</td>
            <td align="left" rowspan="1" colspan="1">
              <xref rid="B7" ref-type="bibr">Elgendi (2016)</xref>
            </td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Relative power</td>
            <td align="left" rowspan="1" colspan="1">Stats</td>
            <td align="left" rowspan="1" colspan="1">PPG and ECG</td>
            <td align="left" rowspan="1" colspan="1">
              <inline-formula id="inf6">
                <mml:math id="m6" overflow="scroll">
                  <mml:msub>
                    <mml:mrow>
                      <mml:mi>R</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi mathvariant="italic">SQI</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo movablelimits="false" form="prefix">∑</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>2.25</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mi>P</mml:mi>
                      <mml:mi>S</mml:mi>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mrow>
                          <mml:mo movablelimits="false" form="prefix">∑</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>f</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>0</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mn>8</mml:mn>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mi>P</mml:mi>
                      <mml:mi>S</mml:mi>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:math>
              </inline-formula>
            </td>
            <td align="left" rowspan="1" colspan="1">Y</td>
            <td align="left" rowspan="1" colspan="1">N</td>
            <td align="left" rowspan="1" colspan="1">
              <xref rid="B7" ref-type="bibr">Elgendi (2016)</xref>
            </td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Mean crossing</td>
            <td align="left" rowspan="1" colspan="1">Stats</td>
            <td align="left" rowspan="1" colspan="1">PPG</td>
            <td align="left" rowspan="1" colspan="1">Number of mean crossings within the signal segment</td>
            <td align="left" rowspan="1" colspan="1">Y</td>
            <td align="left" rowspan="1" colspan="1">N</td>
            <td align="left" rowspan="1" colspan="1"/>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Zero crossing</td>
            <td align="left" rowspan="1" colspan="1">Stats</td>
            <td align="left" rowspan="1" colspan="1">PPG and ECG</td>
            <td align="left" rowspan="1" colspan="1">Number of zero crossings within the signal segment</td>
            <td align="left" rowspan="1" colspan="1">Y</td>
            <td align="left" rowspan="1" colspan="1">N</td>
            <td align="left" rowspan="1" colspan="1">
              <xref rid="B7" ref-type="bibr">Elgendi (2016)</xref>
            </td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">MSQ</td>
            <td align="left" rowspan="1" colspan="1">Morph</td>
            <td align="left" rowspan="1" colspan="1">PPG</td>
            <td align="left" rowspan="1" colspan="1">Degree of agreement between two distinct peak detector algorithms</td>
            <td align="left" rowspan="1" colspan="1">Y</td>
            <td align="left" rowspan="1" colspan="1">N</td>
            <td align="left" rowspan="1" colspan="1">
              <xref rid="B7" ref-type="bibr">Elgendi (2016)</xref>
            </td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Correlogram</td>
            <td align="left" rowspan="1" colspan="1">Stats</td>
            <td align="left" rowspan="1" colspan="1">PPG and ECG</td>
            <td align="left" rowspan="1" colspan="1">Location and prominence of peaks of the signal segment correlogram</td>
            <td align="left" rowspan="1" colspan="1">Y</td>
            <td align="left" rowspan="1" colspan="1">N</td>
            <td align="left" rowspan="1" colspan="1">
              <xref rid="B17" ref-type="bibr">Pradhan et al. (2017)</xref>
            </td>
          </tr>
          <tr>
            <td align="left" rowspan="1" colspan="1">Dynamic time warping</td>
            <td align="left" rowspan="1" colspan="1">Morph</td>
            <td align="left" rowspan="1" colspan="1">PPG and ECG</td>
            <td align="left" rowspan="1" colspan="1">Template matching of a single period with a mathematically described ideal period</td>
            <td align="left" rowspan="1" colspan="1">N</td>
            <td align="left" rowspan="1" colspan="1">Y</td>
            <td align="left" rowspan="1" colspan="1">
              <xref rid="B10" ref-type="bibr">Li and Clifford (2012)</xref>
            </td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
    <p>Thus these challenges have provided the motivation for the development of a SQI package that allows multiple options for practioners, especially in Python. The package we have developed concentrates on the assessment of signal quality. Consequently our work increases the available tools for computing SQI. In addition, the SQI is well-categorized into specific groups. We also design a simple user interface for non-expert practitioners to select their preferred settings. In this study, we focus on the ECG and PPG waveforms derived from wearable devices, where noise and artifact are likely to be highest.</p>
    <p>For automated signal quality control, we implemented the 74 state-of-the-art SQIs in a lightweight open-source Python package called vital_sqi. The package is used to help researchers obtain signals suitable for analysis of HRV and training of machine-learning models. The package also provides pipelines to execute end-to-end SQI extraction and classification and graphical user interfaces (GUIs) for users of different programming fluency.</p>
  </sec>
  <sec id="s2">
    <title>2 The vital_sqi package</title>
    <sec id="s2-1">
      <title>2.1 Installation and requirements</title>
      <p>The package is built for Python 3.7 and 3.8, which is released through PyPi, and it is can to be installed through Python Package Manager PIP. The requirements include a number of popular Python packages such as NumPy, Pandas, and SciPy for signal processing; pyEDFlib and WFDB for reading/writing waveform formats such as “EDF” and “MIT (<ext-link xlink:href="http://Physio.net" ext-link-type="uri">Physio.net</ext-link>).” We also inherit R-peak detection and heart rate variability (HRV) computation from py-ecg-detectors, HRV analysis (<xref rid="B27" ref-type="bibr">Champseix et al., 2018</xref>), and HeartPy (<xref rid="B29" ref-type="bibr">van Gent et al., 2019</xref>). Further installation instruction and requirements can be found in the source at GitHub and the documentation at Read the Docs.</p>
    </sec>
    <sec id="s2-2">
      <title>2.2 Structure and modules</title>
      <p>The package is structured as a combination of modules for different functionalities as shown in <xref rid="F1" ref-type="fig">Figure 1</xref>. The main workflow contains three steps: data preprocessing, SQI computation, and rule-based decision of signal quality. The modules are designed corresponding to these steps. At any step, the users can introduce results from external computation to use within vital_sqi. To further facilitate flexible use, we provide access to these modules individually and complete pipelines from raw waveform to either 1) SQI table or 2) signal quality classification. All parameters of SQI extraction functions and those ofthe rule-based classification are configurable through SQI and rule dictionaries in the JSON format, allowing clear organization when running quality control experiments.</p>
      <fig position="float" id="F1">
        <label>FIGURE 1</label>
        <caption>
          <p>All core SQI functions are implemented in the SQI module. The pipeline module includes functions to load data, preprocess data, and define rules as shown in their respective modules. The pipeline module builds on top of the package to provide general flow from raw waveform to the final result.</p>
        </caption>
        <graphic xlink:href="fphys-13-1020458-g001" position="float"/>
      </fig>
      <p>At the core of the package is the SQI module, in which the 74 selected SQIs are divided into four groups (details in <xref rid="s2-3" ref-type="sec">Section 2.3</xref>):<list list-type="simple"><list-item><p>• Statistical SQIs such as kurtosis, skewness, and entropy.</p></list-item><list-item><p>• Heart rate variability (HRV)-based SQIs such as SDNN, SDSD, and RMSSD.</p></list-item><list-item><p>• RR interval-based SQIs such as ectopic, correlogram, and MSQ.</p></list-item><list-item><p>• Waveform-based SQIs such as DTW, qrs_energy, and qrs_a.</p></list-item></list>
</p>
      <p>The usage is built around three classes in <italic>data</italic> and <italic>rule</italic> modules.<list list-type="simple"><list-item><p>• Signal SQI object has attributes for the raw signal, SQI table, and rule-based classification setup. The object is initialized by reading waveforms and is updated at each step.</p></list-item><list-item><p>• Rule object is constructed for each SQI with user-defined thresholds to classify a signal segment as ‘accept’ or ‘reject.’ A number of rule objects are initialized by reading in SQI dictionary from a JSON file.</p></list-item><list-item><p>• Ruleset is a group of rule objects to be executed in order on the extracted SQI table. It is a lightweight, yet efficient, approach to signal quality classification (shown in our experiments in 3.5). The ruleset object is also initialized from a JSON file. Templates of these JSON configuration files, with our recommended thresholds, are provided in the <italic>resource</italic> module.</p></list-item></list>
</p>
      <p>The two modules of <italic>Preprocess</italic> and <italic>Common</italic> feature share supporting functions to prepare the signal for SQI extraction such as filtering, trimming, or R-peak detection. Last, we provide a web-based GUI, which can easily be used to construct rule and ruleset and execute them on an input SQI table. Coupled with the provided pipelines in the <italic>Pipeline</italic> module for SQI extraction, this <italic>Application</italic> module allows users to quickly obtain quality indices and separate accepted and rejected signal segments.</p>
    </sec>
    <sec id="s2-3">
      <title>2.3 Signal quality indices</title>
      <p>Aiming to separate usable from unusable signal segments, the SQIs implemented in this work have been selected to allow flexible usage, suitable for classification of signals both before and after preprocessing. Therefore, the first step is signal segmentation either by signal duration or by beat, i.e., each segment is equivalent to a cycle (PPG) or QRS complex (ECG). The package features seven peak detectors as shown in Table 2.3.1. The available SQIs are divided into four categories, corresponding to four modules as explained later.</p>
      <sec id="s2-3-1">
        <title>2.3.1 Peak detectors</title>
        <p>A total of seven different peak detectors are available for selection when processing data using the vital_sqi package. These are briefly summarized in the table as follows:</p>
        <table-wrap position="float" id="udT1">
          <table frame="hsides" rules="groups">
            <thead valign="top">
              <tr>
                <th align="left" rowspan="1" colspan="1">Algorithm ID</th>
                <th align="left" rowspan="1" colspan="1">Peak detector name</th>
                <th align="left" rowspan="1" colspan="1">Input parameter</th>
                <th align="left" rowspan="1" colspan="1">Source</th>
              </tr>
            </thead>
            <tbody valign="top">
              <tr>
                <td align="left" rowspan="1" colspan="1">1</td>
                <td align="left" rowspan="1" colspan="1">Adaptive threshold</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <xref rid="B23" ref-type="bibr">Shin et al. (2009)</xref>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">2</td>
                <td align="left" rowspan="1" colspan="1">Count origin</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <xref rid="B20" ref-type="bibr">Schäfer and Kratky (2008)</xref>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">3</td>
                <td align="left" rowspan="1" colspan="1">Clustering</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">4</td>
                <td align="left" rowspan="1" colspan="1">Slope sum</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <xref rid="B26" ref-type="bibr">Zong et al. (2003)</xref>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">5</td>
                <td align="left" rowspan="1" colspan="1">Moving average</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <xref rid="B5" ref-type="bibr">Elgendi et al. (2013)</xref>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">6</td>
                <td align="left" rowspan="1" colspan="1">Default SciPy</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <xref rid="B25" ref-type="bibr">Virtanen et al. (2020)</xref>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">7</td>
                <td align="left" rowspan="1" colspan="1">Billauer algorithm</td>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <xref rid="B4" ref-type="bibr">Billauer (2009)</xref>
                </td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <p>Users are encouraged to experiment with different peak detectors when working with a particularly noisy datasets. The performance of each detector is influenced by the type and extent of prior preprocessing of the dataset.</p>
      </sec>
      <sec id="s2-3-2">
        <title>2.3.2 Statistical SQIs</title>
        <p>Statistical SQIs analyze the signal trends within the segment, providing features of the underlying probability distribution. The implemented SQIs were built on the previous work of <xref rid="B7" ref-type="bibr">Elgendi (2016)</xref>. The utilization of statistical SQIs to determine PPG signal quality has been significantly researched in the last decade, showing promising performance when distinguishing between the acceptable and unfit signal segments (<xref rid="B21" ref-type="bibr">Selvaraj et al., 2011</xref>; <xref rid="B8" ref-type="bibr">Krishnan et al., 2010</xref>; <xref rid="B7" ref-type="bibr">Elgendi, 2016)</xref>. Combining the statistical SQIs with other SQIs provided in this package further improves their cited performance and allows researchers to fine-tune their signal quality selection criteria. For the full list of available statistics-based SQIs, refer to <xref rid="T1" ref-type="table">Table 1</xref>.</p>
      </sec>
      <sec id="s2-3-3">
        <title>2.3.3 Heart rate variability-based and RR interval-based SQIs</title>
        <p>In other modes of operation, the accuracy to identify serial R waves (for ECG) or systolic peaks (PPG) within the signal is examined. RR interval-based SQIs obtain consensus between different methods of detecting RR peaks.</p>
        <p>Beyond pure SQI calculation, the HRV indices are calculated from the RR signal, which can allow inference regarding the functionality and control of the heart and nervous system. Using the package, HRV is derived by a sequence of processes: filtering, resampling, peak detection, removing false peaks, and extracting features. These steps are necessary as poor signal quality can lead to inaccurate labeling of R waves and inaccurate HRV indices. Specifically, HRV features in the frequency domain and time domain are distinguishable between normal and ill patient and non-observable in human, which refers to bad quality.</p>
      </sec>
      <sec id="s2-3-4">
        <title>2.3.4 Waveform-based SQIs</title>
        <p>In computing these indices, the signal patterns are compared with the standard ECG and PPG patterns. The dynamic time wrapping method uses the distance cost as a similarity score between a single period of the ECG/PPG signal and the generated period <xref rid="B14" ref-type="bibr">Orphanidou et al. (2014)</xref>. The package also implements other SQIs which evaluate the power energy on the bands of the QRS complex <xref rid="B11" ref-type="bibr">Marco et al. (2012)</xref>. Other SQIs mentioned in this section evaluate the peak-to-nadir amplitude in the ECG and the systolic-diastolic amplitude ratio in the PPG.</p>
      </sec>
    </sec>
    <sec id="s2-4">
      <title>2.4 Decision ruleset</title>
      <p>As vital signals can be collected from different devices with different modes of operation, a winner-take-it-all method is unfeasible in making signal quality decisions. In practice, the statistical SQIs are appropriate to the longer segments of the signal but highly sensitive to noise and artifacts, which makes selection of the optimal length important. On the other hand, morphology-based SQIs are useful for observing the shorter segments, but the results can be misleading if the underlying waveform is not well-segmented. Our package is advantageous in that it allows flexibility in creating a ruleset by combining various SQIs scores and, thus, can be adapted for multiple scenarios. User-defined rules are set as a chain of SQIs scores using a simple-to-use graphical interface.</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>3 Recommended workflow and experiments</title>
    <p>In this section, we present a step-by-step demonstration of the package. This workflow is already designed in the “high-level” module. Users can either get the SQIs list immediately by importing this module or design their own flow using the other modules. The vital-sqi package is composed of the following steps: preprocessing, segmentation, sqi computation, and rule definition. Both ECG and PPG data are used for this demonstration.</p>
    <sec id="s3-1">
      <title>3.1 Preprocessing</title>
      <p>The main objective of this step is to transform the raw data to match with a standard template of ECG/PPG. First, the signal is checked to remove any missing data or invalid data when reading a given file format. Noise removal is performed by applying the bandpass filter with the appropriate methodology. The Butterworth is the default approach as it provides a good baseline performance and significantly enhances the complex. <xref rid="F2" ref-type="fig">Figure 2</xref> shows the output using the bandpass method from the package on both ECG and PPG.</p>
      <fig position="float" id="F2">
        <label>FIGURE 2</label>
        <caption>
          <p>vital_sqi filtering signal using different bandpass techniques on ECG upper and PPG lower.</p>
        </caption>
        <graphic xlink:href="fphys-13-1020458-g002" position="float"/>
      </fig>
      <p>In addition to the bandpass filter function, the preprocessing module also implements other techniques to sharpen and expose the signal further such as tapering and resampling. This recommended workflow only filters the signal and removes the missing data. Other preprocessing functions will only be employed later in the SQI computation steps. At the end of the preprocessing process, the package marks chunks of certainly invalid signals. The package considers any available values, unchanged sequences, and zero-unit values as invalid signals. Only chunks of valid signals are used for computation of SQI scores.</p>
    </sec>
    <sec id="s3-2">
      <title>3.2 Segmentation</title>
      <p>Once clean data are obtained, the signal is split into chunks of shorter intervals. Depending on user preference, the segmentation length can be defined in minutes or seconds. Based on our sample data, we recommend a segment length of 30 s as long enough to compute HRV features while maintaining the SQI scores less vulnerable to noise and artefacts compared to long segments. In addition, using shorter signal chunks improves the accuracy of the subsequent peak detection algorithms.</p>
      <p>From this point, users can manipulate the signal further with preprocessing methods such as resampling to enhance the single waveforms. Alternatively, peak detection can be performed in advance to get the local minima, which maps to the troughs of the signal and can serve as splitting points. However, it is not recommended at this stage because of the heavy computational load and ineffectiveness when processing long data sequences. Furthermore, peak detection will be employed later for SQI computation.</p>
    </sec>
    <sec id="s3-3">
      <title>3.3 SQI computation</title>
      <p>As explained in <xref rid="s2" ref-type="sec">Section 2</xref>, the SQI can be computed either using the entire segment or single beats. This step produces a matrix of SQI scores of each segment by applying all possible SQI computations. The SQI module implements all of the reviewed methods and categorizes them into hrv_sqi, standard_sqi, and rpeaks_sqi submodules. Since computing all of the available SQIs is time-consuming, users can select a smaller subset of indices. However, we strongly encourage using at least two SQI techniques from each of these subpackages and at least two that use single beats to preserve the accuracy.</p>
      <p>In case of a single-beat algorithm, the mean and standard deviation of all beats within the segment are calculated to contribute to the matrix scores. In detail, the peak detection methods on ECG or PPG are applied in each chunk to extract beats. The extracted beats are transformed by resampling, tapering, and smoothing window techniques to enhance and unify the beat baseline. <xref rid="F3" ref-type="fig">Figure 3</xref> indicates the importance of enhancing beats before computing SQIs. Particularly, the HRV SQIs are highly sensitive to the appearance of any abnormal spikes. By enhancing the signal, critical points are easier to detect and, hence, increase the accuracy. In addition, the zero crossing rate, mean crossing rate, and dynamic template indices also require unification of the baseline. The computed matrix is then input to the final decision ruleset.</p>
      <fig position="float" id="F3">
        <label>FIGURE 3</label>
        <caption>
          <p>ight-hand side figures illustrate the output of the entire segment when applying the smoothing window with ECG and PPG. The left-hand side indicates a clearer beat morphology of PPG when applying the tapering technique and smoothing windows.</p>
        </caption>
        <graphic xlink:href="fphys-13-1020458-g003" position="float"/>
      </fig>
    </sec>
    <sec id="s3-4">
      <title>3.4 Rule definition</title>
      <p>The package defines the ruleset in the JSON format with the key node being the same as the SQI method. Each child node describes the acceptance threshold, score, and relevant decision. The sample JSON format in <xref rid="F4" ref-type="fig">Figure 4</xref> represents the rule definition using the kurtosis, skewness, and entropy scores as the decision node. The order of selected SQIs can be modified through the JSON file accordingly. In this package, we also provide the recommended threshold for specific SQI scores. The recommended JSON is located in the test_data module, and the values given are derived from our real dataset. When applying numerous SQI scores, modifying JSON can be time-consuming and impractical, and therefore, we have developed a GUI for ruleset modifications.</p>
      <fig position="float" id="F4">
        <label>FIGURE 4</label>
        <caption>
          <p>Sample rule definition in the JSON format.</p>
        </caption>
        <graphic xlink:href="fphys-13-1020458-g004" position="float"/>
      </fig>
      <p>The GUI is launched as a local web-based application using the DASH framework and Plotly for visualization. The interface is designed using three main dashboards. The home page is used to read the input SQI matrix and the saved ruleset. The uploaded matrix is displayed on the first dashboard, while the loaded ruleset is presented on the second.</p>
      <p>Based on user preference, some or all SQI scores can be selected by toggling the rule name button. Each SQI score can have multiple thresholds, different orders and combinations of rules. The final decision will be verified in the third dashboard that will also output the final decision.</p>
    </sec>
    <sec id="s3-5">
      <title>3.5 Experiment</title>
      <p>The experiment aims to demonstrate how the package could be used to label the signal. With an in-house curated dataset, we derived suggestive thresholds for the included SQIs and evaluated the performance of simple rules in signal quality classification.</p>
      <sec id="s3-5-1">
        <title>3.5.1 Dataset</title>
        <p>The learning dataset contains the PPG waveforms collected from patients with tetanus treated in the Intensive care unit, lying in a supine position. The device used was the SmartCare oximeter. The study was approved by the ethics committee of the Hospital of Tropical Diseases, Ho Chi Minh City, Vietnam. From 70 long recordings for an an average 20 h, we randomly selected 383 30-s segments. These were double-annotated by doctors as accept or reject based on visual appearance of the waveforms. In the training set, we have a list of criteria to determine the quality of the data segment. The data are annotated by a tool as demonstrated in <xref rid="F5" ref-type="fig">Figure 5</xref>. In this tool, besides the percentage of recognizable peaks, the tool also requires the doctor to mark if the amplitude, width, and trend are abnormal. The annotation process was composed of two rounds. Any uncertain segment in the first round was reserved for the second round. After the first round, 72% of the segments were labeled. In the second round, the opposite decision was made in less than 10% of labeled segments. Most of the changed segments occurred in the initial segments, when the doctor was unfamiliar with the dataset. Although the multi-criterion tool assured high quality annotation, it is time-consuming and also annotates unused factors.</p>
        <fig position="float" id="F5">
          <label>FIGURE 5</label>
          <caption>
            <p>Annotation tool for PPG. The tool indicates multiple factors and the final classification label.</p>
          </caption>
          <graphic xlink:href="fphys-13-1020458-g005" position="float"/>
        </fig>
        <p>Consequently, from the list of well-annotated segments, the waveform-based criteria were simplified to possessing visible systolic and diastolic peaks and the presence of artifacts as presented in <xref rid="F6" ref-type="fig">Figure 6</xref>. The resultant dataset included 273 accepted (A) and 114 rejected segments (NG). The rejected segments were further divided into two groups based on the percentage of cycles with unrecognizable peaks: more than 50% (NG1, 47 segments) and less than 50% (NG2, 67 segments). The same simplified format is applied for the test dataset. This test dataset was composed of 900 accepted segments and 279 rejected segments (210 in NG1 and 69 in NG2).</p>
        <fig position="float" id="F6">
          <label>FIGURE 6</label>
          <caption>
            <p>ample segment of the accepted and rejected groups (NG1 and NG2). The red dots indicate the peaks, detected by vitalsqi, while the green dots define the troughs.</p>
          </caption>
          <graphic xlink:href="fphys-13-1020458-g006" position="float"/>
        </fig>
        <p>This training data were then used to determine the thresholds for each SQI. The threshold is defined by a greedy search process, in which the step size is 0.1 quantile unit. The experiments followed the previously described pipeline to obtain the list of relevant SQI scores. Although users can decide the SQIs based on their experience, this package introduces an intuitive yet efficient approach to derive the thresholds. Specifically, the distributions are examined to mark the potential SQI and the appropriate threshold.</p>
      </sec>
      <sec id="s3-5-2">
        <title>3.5.2 Settings</title>
        <p>We conducted two experiments, as follows:<list list-type="simple"><list-item><p>1) SQI threshold derivation: For each SQI implemented in the package, we use two methods to determine a threshold that differentiates accept and reject segments. First, the threshold is set as the 95th percentile of the accept histograms. Second, the threshold is determined by a brute force search (step is 0.05 on the quantile) for the most discriminative of the accept and reject segments.</p></list-item><list-item><p>2) Rule building: We searched for the combinations of SQIs that best differentiate the accept and reject segments from the SQIs with the best performances identified earlier; our aim being to show that the combination SQIs (even only two), in a simple rule-based decision approach, result in reasonably good quality assignment.</p></list-item></list>
</p>
      </sec>
      <sec id="s3-5-3">
        <title>3.5.3 Results</title>
        <p>Using the recommendation in the aforementioned pipeline, we conducted the experiments using a single SQI and a combination of two SQIs. A greedy search was used to verify the performance of all combinations. The final result of the best 10 combinations is illustrated in the table.</p>
        <p>As presented in <xref rid="F7" ref-type="fig">Figure 7</xref>, a list of SQIs which compute both per beat and per segment are selected. Looking further into the nominated SQIs, the interpretation is explained as follows:<list list-type="simple"><list-item><p>1) Entropy: This indicates the probability of the appearance of the signal at certain levels. The normal signal of the heart rate is distributed in a normal distribution. In case of an invalid signal, the probability of the appearance of the signal at a certain level is adjusted. Regions that appear rarely can be observed, and it reduces the probability of the normal range. Hence, the information entropy is discriminatory.</p></list-item><list-item><p>2) Mean_nni: This score indicates the mean value of the normal to normal interval (i.e., successive beats). The nni is computed from specific ECG or PPG data. Hence, the result will be extremely vulnerable to any noise and artifacts. In general, the distribution is a normal distribution, and when there is noise, the distribution becomes uniform.</p></list-item><list-item><p>3) MSQ: This SQI computes the consistency of the peak detection algorithm. The signal is shifted n-seconds forward and performs the same peak detection. Assuming the signal is of good quality, the location of the n-second later peak does not vary significantly. However, noise will cause multiple spikes, which potentially result in misreading of the peak and hence inconsistency.</p></list-item><list-item><p>4) Pnn_50: This shows the ratio between NN50 and the total number of heartbeat intervals. NN50 is the number of times successive heartbeat intervals exceed 50 ms, and is believed to be associated with parasympathetic nervous system activity. A bad quality signal leads to increase of the score.</p></list-item><list-item><p>5) SDNN: Among many HRV features, SDNN is the most representative. The score represents the standard deviation of beat-to-beat intervals. Some medical sources use this as the main indicator of HRV, and it is defined that the normal range of HRV is 20–60. As the signal is heavily damaged by the artifact, the SDNN results in greater scores that exceed the normal range.</p></list-item></list>
</p>
        <fig position="float" id="F7">
          <label>FIGURE 7</label>
          <caption>
            <p>Distribution of different SQI scores with respect to the normal and invalid groups.</p>
          </caption>
          <graphic xlink:href="fphys-13-1020458-g007" position="float"/>
        </fig>
        <p>Following the greedy search process, the results were as follows. According to the distribution, the SQI score differs significantly between the per-beat and per-segment calculation. In terms of the rejection rate, the performance of SQIs per segment is more accurate. Since per-beat analysis mainly depends on beat segmentation, the longer the sequence is, the less accurate the SQI computes. By experimenting with different time lengths, the 30-s segment was observed to be the most appropriate duration. Within this interval, the sequence is long enough to derive meaningful clinical features such as HRV and is also efficient to split by beat.</p>
        <p>In summary, using a single SQI as in <xref rid="T2" ref-type="table">Table 2</xref>, the best 10 combinations using two SQIs compute in per segment, and the rest computes in HRV (which refers to both per beat and per segment). The SQIs are ranked by the AUC rather as the package aims to eliminate as many invalid signals as possible, while retaining a large amount of good-quality signals for later analysis. Generally, all SQIs are effective at identifying the severely distorted signals (R2 group) showing accuracy of above 80%, with most of them (SVSD, SDNN, RMSSD, and SDSD) above 88%. However, the SQIs differ when validating the quality of the R1 group. Most of the SQIs performed with only 60–65% accuracy. Only one SQI (CVSD) reached 70%, while the worst performing SQI (heart rate standard deviation) has only 50% accuracy. Importantly, however, in terms of retaining good-quality signals, all SQIs performed well and retain approximately 90% of valid signals.</p>
        <table-wrap position="float" id="T2">
          <label>TABLE 2</label>
          <caption>
            <p>Performance of each sqi in classifying a good-quality segment.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead valign="top">
              <tr>
                <th align="left" rowspan="1" colspan="1">Rule</th>
                <th align="left" rowspan="1" colspan="1">Good accuracy</th>
                <th align="left" rowspan="1" colspan="1">R1 accuracy</th>
                <th align="left" rowspan="1" colspan="1">R2 accuracy</th>
                <th align="left" rowspan="1" colspan="1">Accuracy</th>
                <th align="left" rowspan="1" colspan="1">Brier</th>
                <th align="left" rowspan="1" colspan="1">Roc</th>
                <th align="left" rowspan="1" colspan="1">Fbeta</th>
              </tr>
            </thead>
            <tbody valign="top">
              <tr>
                <td align="left" rowspan="1" colspan="1">CVSD</td>
                <td align="char" char="." rowspan="1" colspan="1">0.9067</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7095</td>
                <td align="char" char="." rowspan="1" colspan="1">0.942</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8024</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1264</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8368</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8761</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SDNN</td>
                <td align="char" char="." rowspan="1" colspan="1">0.9067</td>
                <td align="char" char="." rowspan="1" colspan="1">0.6667</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8986</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7973</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1366</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8153</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8644</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">RMSSD</td>
                <td align="char" char="." rowspan="1" colspan="1">0.9078</td>
                <td align="char" char="." rowspan="1" colspan="1">0.6571</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8986</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7981</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1374</td>
                <td align="char" char="." rowspan="1" colspan="1">0.81 23</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8631</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SDSD</td>
                <td align="char" char="." rowspan="1" colspan="1">0.9156</td>
                <td align="char" char="." rowspan="1" colspan="1">0.6429</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8696</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8007</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1357</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8072</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8632</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Entropy STD</td>
                <td align="char" char="." rowspan="1" colspan="1">0.9356</td>
                <td align="char" char="." rowspan="1" colspan="1">0.619</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8406</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8126</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1264</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8047</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8699</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Power</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8889</td>
                <td align="char" char="." rowspan="1" colspan="1">0.6571</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8841</td>
                <td align="char" char="." rowspan="1" colspan="1">0.782</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1527</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8011</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8505</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">CVNNI</td>
                <td align="char" char="." rowspan="1" colspan="1">0.9144</td>
                <td align="char" char="." rowspan="1" colspan="1">0.6333</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8116</td>
                <td align="char" char="." rowspan="1" colspan="1">0.793</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1416</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7959</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8566</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">LF</td>
                <td align="char" char="." rowspan="1" colspan="1">0.88</td>
                <td align="char" char="." rowspan="1" colspan="1">0.6571</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8261</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7684</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1629</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7895</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8411</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">HF</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8489</td>
                <td align="char" char="." rowspan="1" colspan="1">0.6619</td>
                <td align="char" char="." rowspan="1" colspan="1">0.9275</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7566</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1798</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7882</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8314</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Heart rate STD</td>
                <td align="char" char="." rowspan="1" colspan="1">0.9189</td>
                <td align="char" char="." rowspan="1" colspan="1">0.5286</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8696</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8032</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1535</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7659</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8415</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <p>In case of combined SQIs described in <xref rid="T3" ref-type="table">Table 3</xref>, the rejected cases were significantly higher. The 10 most successful combinations detected more than 90% of invalid signals in the R2 group. With the R1 group, the rejected cases were increased, and all of the combinations obtained more than 70% accuracy, with one combination obtaining approximately 80% accuracy. However, this increased performance occurred at the expense of a decrease in accuracy in the good-quality group, where accuracy decreased from 89% to 83%. It is worth noting that the discard rate in the second invalid group was higher than that in the first invalid group, which reflects the fact that signals in the second group are much more distorted.</p>
        <table-wrap position="float" id="T3">
          <label>TABLE 3</label>
          <caption>
            <p>Performance of the best 10 combinations in classifying the good-quality segment.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead valign="top">
              <tr>
                <th align="left" rowspan="1" colspan="1">Rule</th>
                <th align="left" rowspan="1" colspan="1">Good accuracy</th>
                <th align="left" rowspan="1" colspan="1">R1 accuracy</th>
                <th align="left" rowspan="1" colspan="1">R2 accuracy</th>
                <th align="left" rowspan="1" colspan="1">Accuracy</th>
                <th align="left" rowspan="1" colspan="1">Brier</th>
                <th align="left" rowspan="1" colspan="1">Roc</th>
                <th align="left" rowspan="1" colspan="1">Fbeta</th>
              </tr>
            </thead>
            <tbody valign="top">
              <tr>
                <td align="left" rowspan="1" colspan="1">Entropy STD + CVSD</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8978</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7381</td>
                <td align="char" char="." rowspan="1" colspan="1">0.971</td>
                <td align="char" char="." rowspan="1" colspan="1">0.799</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1264</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8467</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8785</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">MSQ + CVSD</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8489</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7762</td>
                <td align="char" char="." rowspan="1" colspan="1">1</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7651</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1552</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8402</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8604</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Entropy + CVSD</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8367</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7905</td>
                <td align="char" char="." rowspan="1" colspan="1">1</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7557</td>
                <td align="char" char="." rowspan="1" colspan="1">0.162</td>
                <td align="char" char="." rowspan="1" colspan="1">0.839</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8569</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SDNN + CVSD</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8967</td>
                <td align="char" char="." rowspan="1" colspan="1">0.719</td>
                <td align="char" char="." rowspan="1" colspan="1">0.9565</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7964</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1315</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8372</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8729</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Kurtosis mean + CVSD</td>
                <td align="char" char="." rowspan="1" colspan="1">0.9044</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7095</td>
                <td align="char" char="." rowspan="1" colspan="1">0.942</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8007</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1281</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8357</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8747</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Correlogram + CVSD</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8933</td>
                <td align="char" char="." rowspan="1" colspan="1">0.719</td>
                <td align="char" char="." rowspan="1" colspan="1">0.9565</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7939</td>
                <td align="char" char="." rowspan="1" colspan="1">0.134</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8356</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8709</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">RMSSD + CVSD</td>
                <td align="char" char="." rowspan="1" colspan="1">0.9</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7143</td>
                <td align="char" char="." rowspan="1" colspan="1">0.942</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7973</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1306</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8353</td>
                <td align="char" char="." rowspan="1" colspan="1">0.873</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Zero crossing rate + CVSD</td>
                <td align="char" char="." rowspan="1" colspan="1">0.9033</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7095</td>
                <td align="char" char="." rowspan="1" colspan="1">0.942</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7998</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1289</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8352</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8741</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Kurtosis median + CVSD</td>
                <td align="char" char="." rowspan="1" colspan="1">0.9033</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7095</td>
                <td align="char" char="." rowspan="1" colspan="1">0.942</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7998</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1289</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8352</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8741</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">CVSD + CVNNI</td>
                <td align="char" char="." rowspan="1" colspan="1">0.9033</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7095</td>
                <td align="char" char="." rowspan="1" colspan="1">0.942</td>
                <td align="char" char="." rowspan="1" colspan="1">0.7998</td>
                <td align="char" char="." rowspan="1" colspan="1">0.1289</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8352</td>
                <td align="char" char="." rowspan="1" colspan="1">0.8741</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <p>Examining the cases of misclassification, the waveform morphology of PPG signals did not fully match with the standard PPG since the diastolic peaks were indistinct. It is worth noting that these still have utility as the heart rate can still be calculated from these as it is still feasible to identify the start and the end of a cycle. This observation is supported by the fact that the selected waveform focuses on per segment, which is not different in this case and resulted in the score of per segment surpassing the threshold. Finally, the use of a very small cutoff quantile indicates the superiority of the selected SQI and feasibility of this package.</p>
        <p>In terms of validating the implementation, our package is limited as the original descriptions validated individual SQIs in diverse datasets. Consequently, each group of SQIs had a specific and different approach to validation. As the statistical SQI group is based on statistics algorithms (eg., skewness and kurtosis), these can be sufficiently validated by computing the values correctly on standard distributions. With HRV-based SQIs, were validated by comparing the values computed from other packages (R-HRV and HRV analyses). For the case of waveform-based and RR interval-based SQIs, the validities were evaluated by comparing a sequence of standard waveforms and the same sequence with additive noise.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="conclusion" id="s4">
    <title>4 Conclusion</title>
    <p>The vital-sqi package has been carefully designed to assist health researchers of different backgrounds in carrying out SQI evaluation. The package provides an end-to-end solution from preprocessing to estimation of SQI scores and definitions of the quality of any ECG and PPG segments. This package concentrates on the estimation of various SQIs; yet, it is also flexible for users with different aims, enabling derivation of HRV features, pre-processing of data or detection of peaks.</p>
    <p>Our experiment indicates the feasibility of categorizing the valid signals using the package. Instead of requiring users’ deep domain knowledge, the package provides a simple-to-use pipeline with pre-search thresholds for the classification of invalid signals.</p>
    <p>Furthermore, this package also allows users to define SQI rules. The good results described on a real-world dataset indicate the feasibility of the package as applying for other clinical trial setup.</p>
    <p>The future work maintains the package up-to-date with modern SQIs and enhances the user interface. Although some SQIs describe the characteristics of the waveform or part of the segment, later versions of the package do not redirect to any vital sign analysis. Instead, the package will cooperate with other well-known libraries such as HeartPy or HRV analysis to retrieve the user needs.</p>
  </sec>
</body>
<back>
  <ack>
    <p>We would like to thank the <bold>Vietnam ICU Translational Applications Laboratory (VITAL) investigators</bold>, <bold>OUCRU inclusive authorship list in Vietnam</bold> (alphabetic order by surname): Dang Phuong Thao, Dang Trung Kien, Doan Bui Xuan Thy, Dong Huu Khanh Trinh, Du Hong Duc, Ronald Geskus, Ho Bich Hai, Ho Quang Chanh, Ho Van Hien, Huynh Trung Trieu, Evelyne Kestelyn, Lam Minh Yen, Le Dinh Van Khoa, Le Thanh Phuong, Le Thuy Thuy Khanh, Luu Hoai Bao Tran, Luu Phuoc An, Angela Mcbride, Nguyen Lam Vuong, Ngan Nguyen Lyle, Nguyen Quang Huy, Nguyen Than Ha Quyen, Nguyen Thanh Ngoc, Nguyen Thi Giang, Nguyen Thi Diem Trinh, Nguyen Thi Le Thanh, Nguyen Thi Phuong Dung, Nguyen Thi Phuong Thao, Ninh Thi Thanh Van, Pham Tieu Kieu, Phan Nguyen Quoc Khanh, Phung Khanh Lam, Phung Tran Huy Nhat, Guy Thwaites, Louise Thwaites, Tran Minh Duc, Trinh Manh Hung, Hugo Turner, Jennifer Ilo Van Nuil, Vo Tan Hoang, Vu Ngo Thanh Huyen, Sophie Yacoub, <bold>Hospital for Tropical Diseases, Ho Chi Minh City</bold> (alphabetic order by surname): Cao Thi Tam, Duong Bich Thuy, Ha Thi Hai Duong, Ho Dang Trung Nghia, Le Buu Chau, Le Mau Toan, Le Ngoc Minh Thu, Le Thi Mai Thao, Luong Thi Hue Tai, Nguyen Hoan Phu, Nguyen Quoc Viet, Nguyen Thanh Dung, Nguyen Thanh Nguyen, Nguyen Thanh Phong, Nguyen Thi Kim Anh, Nguyen Van Hao, Nguyen Van Thanh Duoc, Pham Kieu Nguyet Oanh, Phan Thi Hong Van, Phan Tu Qui, Phan Vinh Tho, Truong Thi Phuong Thao, <bold>University of Oxford</bold> (alphabetic order by surname): Natasha Ali, David Clifton, Mike English, Jannis Hagenah, Ping Lu, Jacob McKnight, Chris Paton, Tingting Zhu, <bold>Imperial College London</bold> (alphabetic order by surname): Pantelis Georgiou, Bernard Hernandez Perez, Kerri Hill-Cawthorne, Alison Holmes, Stefan Karolcik, Damien Ming, Nicolas Moser, Jesus Rodriguez Manzano, <bold>King’s College London</bold> (alphabetic order by surname): Liane Canas, Alberto Gomez, Hamideh Kerdegari, Andrew King, Marc Modat, Reza Razavi, Miguel Xochicale, <bold>University of Ulm</bold> (alphabetic order by surname): Walter Karlen, <bold>The University of Melbourne</bold> (alphabetic order by surname): Linda Denehy, Thomas Rollinson, and <bold>Mahidol Oxford Tropical Medicine Research Unit (MORU)</bold> (alphabetic order by surname): Luigi Pisani, Marcus Schultz.</p>
  </ack>
  <sec sec-type="data-availability" id="s5">
    <title>Data availability statement</title>
    <p>The datasets presented in this study can be found in online repositories. The names of the repository/repositories and accession number(s) can be found at: <ext-link xlink:href="https://pypi.org/project/vital-sqi/" ext-link-type="uri">https://pypi.org/project/vital-sqi/</ext-link>.</p>
  </sec>
  <sec id="s6">
    <title>Author contributions</title>
    <p>Conceptualization, V-KL, HH, SK, BH, LT, HG, DC, and PG; formal analysis, V-KL, HH, and SK; funding acquisition, LT and DC; methodology, V-KL, HH, SK, BH, and DC; supervision, LT, DC, and PG; writing—original draft, V-KL, LT and HH; writing—review and editing, LT, DC, and PG; data collection, LT, VHN, NQKP and TPL; data annotation, NQKP. All authors have read and agreed to the published version of the manuscript.</p>
  </sec>
  <sec id="s7">
    <title>Funding</title>
    <p>This research was supported by the Wellcome Trust under grant WT217650/Z/19/Z. D.A.C was supported in part by the National Institute for Health Research (NIHR) Oxford Biomedical Research Centre; an InnoHK Project at the Hong Kong Centre for Cerebro-cardiovascular Health Engineering; and the Pandemic Sciences Institute, University of Oxford, Oxford, United Kingdom.</p>
  </sec>
  <sec sec-type="COI-statement" id="s8">
    <title>Conflict of interest</title>
    <p>The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
  </sec>
  <sec sec-type="disclaimer" id="s9">
    <title>Publisher’s note</title>
    <p>All claims expressed in this article are solely those of the authors and do not necessarily represent those of their affiliated organizations, or those of the publisher, the editors, and the reviewers. Any product that may be evaluated in this article, or claim that may be made by its manufacturer, is not guaranteed or endorsed by the publisher.</p>
  </sec>
  <sec id="s10">
    <title>Supplementary material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link xlink:href="https://www.frontiersin.org/articles/10.3389/fphys.2022.1020458/full#supplementary-material" ext-link-type="uri">https://www.frontiersin.org/articles/10.3389/fphys.2022.1020458/full#supplementary-material</ext-link>
</p>
    <supplementary-material id="SM1" position="float" content-type="local-data">
      <media xlink:href="DataSheet1.PDF">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Akbilgic</surname><given-names>O.</given-names></name><name><surname>Butler</surname><given-names>L.</given-names></name><name><surname>Karabayir</surname><given-names>I.</given-names></name><name><surname>Chang</surname><given-names>P. P.</given-names></name><name><surname>Kitzman</surname><given-names>D. W.</given-names></name><name><surname>Alonso</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2021</year>). <article-title>ECG-AI: Electrocardiographic artificial intelligence model for prediction of heart failure</article-title>. <source>Eur. Heart J. Digit. Health</source>
<volume>2</volume>, <fpage>626</fpage>–<lpage>634</lpage>. <pub-id pub-id-type="doi">10.1093/ehjdh/ztab080</pub-id>
<pub-id pub-id-type="pmid">34993487</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Badawi</surname><given-names>A. A.</given-names></name><name><surname>Badr</surname><given-names>A.</given-names></name><name><surname>Elgazzar</surname><given-names>K.</given-names></name></person-group> (<year>2021</year>). “<article-title>Ecg real-time monitoring and heart anomaly detection reimagined</article-title>,” in <conf-name>2021 IEEE 7th World Forum on Internet of Things (WF-IoT)</conf-name>, <fpage>326</fpage>–<lpage>331</lpage>. <pub-id pub-id-type="doi">10.1109/WF-IoT51360.2021.9595639</pub-id>
</mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Becker</surname><given-names>D.</given-names></name></person-group> (<year>2006</year>). <article-title>Fundamentals of electrocardiography interpretation</article-title>. <source>Anesth. Prog.</source>
<volume>53</volume>, <fpage>53</fpage>–<lpage>63</lpage>. <comment>quiz 64</comment>. <pub-id pub-id-type="doi">10.2344/0003-3006(2006)53[53:FOEI]2.0.CO;2</pub-id>
<pub-id pub-id-type="pmid">16863387</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Billauer</surname><given-names>E.</given-names></name></person-group> (<year>2009</year>). <source>peakdet: Peak detection using matlab</source>. <comment><italic>my tech blog</italic> Accessed: 2022-12-05</comment>.</mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elgendi</surname><given-names>M.</given-names></name><name><surname>Norton</surname><given-names>I.</given-names></name><name><surname>Brearley</surname><given-names>M.</given-names></name><name><surname>Abbott</surname><given-names>D.</given-names></name><name><surname>Schuurmans</surname><given-names>D.</given-names></name></person-group> (<year>2013</year>). <article-title>Systolic peak detection in acceleration photoplethysmograms measured from emergency responders in tropical conditions</article-title>. <source>PLoS ONE</source>
<volume>8</volume>, <fpage>765855</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0076585</pub-id>
</mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elgendi</surname><given-names>M.</given-names></name></person-group> (<year>2012</year>). <article-title>On the analysis of fingertip photoplethysmogram signals</article-title>. <source>Curr. Cardiol. Rev.</source>
<volume>8</volume>, <fpage>14</fpage>–<lpage>25</lpage>. <pub-id pub-id-type="doi">10.2174/157340312801215782</pub-id>
<pub-id pub-id-type="pmid">22845812</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Elgendi</surname><given-names>M.</given-names></name></person-group> (<year>2016</year>). <article-title>Optimal signal quality index for photoplethysmogram signals</article-title>. <source>Bioengineering</source>
<volume>3</volume>, <fpage>E21</fpage>. <pub-id pub-id-type="doi">10.3390/bioengineering3040021</pub-id>
</mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Krishnan</surname><given-names>R.</given-names></name><name><surname>Natarajan</surname><given-names>B.</given-names></name><name><surname>Warren</surname><given-names>S.</given-names></name></person-group> (<year>2010</year>). <article-title>Two-stage approach for detection and reduction of motion artifacts in photoplethysmographic data</article-title>. <source>IEEE Trans. Biomed. Eng.</source>
<volume>57</volume>, <fpage>1867</fpage>–<lpage>1876</lpage>. <pub-id pub-id-type="doi">10.1109/TBME.2009.2039568</pub-id>
<pub-id pub-id-type="pmid">20172800</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lee</surname><given-names>J.</given-names></name><name><surname>Kim</surname><given-names>M.</given-names></name><name><surname>Park</surname><given-names>H.-K.</given-names></name><name><surname>Kim</surname><given-names>I. Y.</given-names></name></person-group> (<year>2020</year>). <article-title>Motion artifact reduction in wearable photoplethysmography based on multi-channel sensors with multiple wavelengths</article-title>. <source>Sensors (Basel)</source>
<volume>20</volume>, <fpage>1493</fpage>. <pub-id pub-id-type="doi">10.3390/s20051493</pub-id>
<pub-id pub-id-type="pmid">32182772</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>Q.</given-names></name><name><surname>Clifford</surname><given-names>G. D.</given-names></name></person-group> (<year>2012</year>). <article-title>Dynamic time warping and machine learning for signal quality assessment of pulsatile signals</article-title>. <source>Physiol. Meas.</source>
<volume>33</volume>, <fpage>1491</fpage>–<lpage>1501</lpage>. <pub-id pub-id-type="doi">10.1088/0967-3334/33/9/1491</pub-id>
<pub-id pub-id-type="pmid">22902950</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Marco</surname><given-names>L.</given-names></name><name><surname>Duan</surname><given-names>W.</given-names></name><name><surname>Bojarnejad</surname><given-names>M.</given-names></name><name><surname>Zheng</surname><given-names>D.</given-names></name><name><surname>King</surname><given-names>S.</given-names></name><name><surname>Murray</surname><given-names>A.</given-names></name><etal/></person-group> (<year>2012</year>). <article-title>Evaluation of an algorithm based on single-condition decision rules for binary classification of 12-lead ambulatory ecg recording quality</article-title>. <source>Physiol. Meas.</source>
<volume>33</volume>, <fpage>1435</fpage>–<lpage>1448</lpage>. <pub-id pub-id-type="doi">10.1088/0967-3334/33/9/1435</pub-id>
<pub-id pub-id-type="pmid">22902810</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nagai</surname><given-names>S.</given-names></name><name><surname>Anzai</surname><given-names>D.</given-names></name><name><surname>Wang</surname><given-names>J.</given-names></name></person-group> (<year>2017</year>). <article-title>Motion artefact removals for wearable ECG using stationary wavelet transform</article-title>. <source>Healthc. Technol. Lett.</source>
<volume>4</volume>, <fpage>138</fpage>–<lpage>141</lpage>. <pub-id pub-id-type="doi">10.1049/htl.2016.0100</pub-id>
<pub-id pub-id-type="pmid">28868151</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nantume</surname><given-names>A.</given-names></name><name><surname>Shah</surname><given-names>S.</given-names></name><name><surname>Cauvel</surname><given-names>T.</given-names></name><name><surname>Tomback</surname><given-names>M.</given-names></name><name><surname>Kilpatrick</surname><given-names>R.</given-names></name><name><surname>Afzal</surname><given-names>B.</given-names></name><etal/></person-group> (<year>2021</year>). <article-title>Developing medical technologies for low-resource settings: Lessons from a wireless wearable vital signs monitor-neoGuard</article-title>. <source>Front. Digit. Health</source>
<volume>3</volume>, <fpage>730951</fpage>. <pub-id pub-id-type="doi">10.3389/fdgth.2021.730951</pub-id>
<pub-id pub-id-type="pmid">34723242</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Orphanidou</surname><given-names>C.</given-names></name><name><surname>Bonnici</surname><given-names>T.</given-names></name><name><surname>Charlton</surname><given-names>P.</given-names></name><name><surname>Clifton</surname><given-names>D.</given-names></name><name><surname>Vallance</surname><given-names>D.</given-names></name><name><surname>Tarassenko</surname><given-names>L.</given-names></name></person-group> (<year>2014</year>). <article-title>Signal-quality indices for the electrocardiogram and photoplethysmogram: Derivation and applications to wireless monitoring</article-title>. <source>IEEE J. Biomed. Health Inf.</source>
<volume>19</volume>, <fpage>832</fpage>–<lpage>838</lpage>. <pub-id pub-id-type="doi">10.1109/JBHI.2014.2338351</pub-id>
</mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pereira</surname><given-names>T.</given-names></name><name><surname>Tran</surname><given-names>N.</given-names></name><name><surname>Gadhoumi</surname><given-names>K.</given-names></name><name><surname>Pelter</surname><given-names>M. M.</given-names></name><name><surname>Do</surname><given-names>D. H.</given-names></name><name><surname>Lee</surname><given-names>R. J.</given-names></name><etal/></person-group> (<year>2020</year>). <article-title>Photoplethysmography based atrial fibrillation detection: A review</article-title>. <source>NPJ Digit. Med.</source>
<volume>3</volume>, <fpage>3</fpage>. <pub-id pub-id-type="doi">10.1038/s41746-019-0207-9</pub-id>
<pub-id pub-id-type="pmid">31934647</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pollreisz</surname><given-names>T. N., D.</given-names></name><name><surname>TaheriNejad</surname><given-names>N.</given-names></name></person-group> (<year>2022</year>). <article-title>Detection and removal of motion artifacts in ppg signals</article-title>. <source>Mob. Netw. Appl.</source>
<volume>27</volume>, <fpage>728</fpage>–<lpage>738</lpage>. <pub-id pub-id-type="doi">10.1007/s11036-019-01323-6</pub-id>
</mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="confproc"><person-group person-group-type="author"><name><surname>Pradhan</surname><given-names>N.</given-names></name><name><surname>Rajan</surname><given-names>S.</given-names></name><name><surname>Adler</surname><given-names>A.</given-names></name><name><surname>Redpath</surname><given-names>C.</given-names></name></person-group> (<year>2017</year>). “<article-title>Classification of the quality of wristband-based photoplethysmography signals</article-title>,” in <conf-name>2017 IEEE International Symposium on Medical Measurements and Applications (MeMeA)</conf-name>, <fpage>269</fpage>–<lpage>274</lpage>. <pub-id pub-id-type="doi">10.1109/MeMeA.2017.7985887</pub-id>
</mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Raghunath</surname><given-names>S.</given-names></name><name><surname>Ulloa Cerna</surname><given-names>A. E.</given-names></name><name><surname>Jing</surname><given-names>L.</given-names></name><name><surname>vanMaanen</surname><given-names>D. P.</given-names></name><name><surname>Stough</surname><given-names>J.</given-names></name><name><surname>Hartzel</surname><given-names>D. N.</given-names></name><etal/></person-group> (<year>2020</year>). <article-title>Prediction of mortality from 12-lead electrocardiogram voltage data using a deep neural network</article-title>. <source>Nat. Med.</source>
<volume>26</volume>, <fpage>886</fpage>–<lpage>891</lpage>. <pub-id pub-id-type="doi">10.1038/s41591-020-0870-z</pub-id>
<pub-id pub-id-type="pmid">32393799</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="webpage"><person-group person-group-type="author"><name><surname>Champseix</surname><given-names>R.</given-names></name></person-group> (<year>2018</year>). <article-title>HRV analysis: Heart rate variability analysis</article-title>. <comment>Available at: <ext-link xlink:href="https://github.com/Aura-healthcare/hrv-analysis" ext-link-type="uri">https://github.com/Aura-healthcare/hrv-analysis</ext-link>
</comment> (<comment>Accessed March 14, 2022</comment>).</mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sana</surname><given-names>F.</given-names></name><name><surname>Isselbacher</surname><given-names>E. M.</given-names></name><name><surname>Singh</surname><given-names>J. P.</given-names></name><name><surname>Heist</surname><given-names>E. K.</given-names></name><name><surname>Pathik</surname><given-names>B.</given-names></name><name><surname>Armoundas</surname><given-names>A. A.</given-names></name></person-group> (<year>2020</year>). <article-title>Wearable devices for ambulatory cardiac monitoring: JACC state-of-the-art review</article-title>. <source>J. Am. Coll. Cardiol.</source>
<volume>75</volume>, <fpage>1582</fpage>–<lpage>1592</lpage>. <pub-id pub-id-type="doi">10.1016/j.jacc.2020.01.046</pub-id>
<pub-id pub-id-type="pmid">32241375</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Schäfer</surname><given-names>A.</given-names></name><name><surname>Kratky</surname><given-names>K.</given-names></name></person-group> (<year>2008</year>). <article-title>Estimation of breathing rate from respiratory sinus arrhythmia: Comparison of various methods</article-title>. <source>Ann. Biomed. Eng.</source>
<volume>36</volume>, <fpage>476</fpage>–<lpage>485</lpage>. <pub-id pub-id-type="doi">10.1007/s10439-007-9428-1</pub-id>
<pub-id pub-id-type="pmid">18188703</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Selvaraj</surname><given-names>N.</given-names></name><name><surname>Mendelson</surname><given-names>Y.</given-names></name><name><surname>Shelley</surname><given-names>K. H.</given-names></name><name><surname>Silverman</surname><given-names>D. G.</given-names></name><name><surname>Chon</surname><given-names>K. H.</given-names></name></person-group> (<year>2011</year>). <article-title>Statistical approach for the detection of motion/noise artifacts in Photoplethysmogram</article-title>. <source>Annu. Int. Conf. IEEE Eng. Med. Biol. Soc.</source>
<volume>2011</volume>, <fpage>4972</fpage>–<lpage>4975</lpage>. <pub-id pub-id-type="doi">10.1109/IEMBS.2011.6091232</pub-id>
<pub-id pub-id-type="pmid">22255454</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Seok</surname><given-names>D.</given-names></name><name><surname>Lee</surname><given-names>S.</given-names></name><name><surname>Kim</surname><given-names>M.</given-names></name><name><surname>Cho</surname><given-names>J.</given-names></name><name><surname>Kim</surname><given-names>C.</given-names></name></person-group> (<year>2021</year>). <article-title>Motion artifact removal techniques for wearable eeg and ppg sensor systems</article-title>. <source>Front. Electron.</source>
<volume>2</volume>. <pub-id pub-id-type="doi">10.3389/felec.2021.685513</pub-id>
</mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shin</surname><given-names>H. S.</given-names></name><name><surname>Lee</surname><given-names>C.</given-names></name><name><surname>Lee</surname><given-names>M.</given-names></name></person-group> (<year>2009</year>). <article-title>Adaptive threshold method for the peak detection of photoplethysmographic waveform</article-title>. <source>Comput. Biol. Med.</source>
<volume>39</volume>, <fpage>1145</fpage>–<lpage>1152</lpage>. <pub-id pub-id-type="doi">10.1016/j.compbiomed.2009.10.006</pub-id>
<pub-id pub-id-type="pmid">19883905</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tadesse</surname><given-names>G. A.</given-names></name><name><surname>Zhu</surname><given-names>T.</given-names></name><name><surname>Le Nguyen Thanh</surname><given-names>N.</given-names></name><name><surname>Hung</surname><given-names>N. T.</given-names></name><name><surname>Duong</surname><given-names>H. T. H.</given-names></name><name><surname>Khanh</surname><given-names>T. H.</given-names></name><etal/></person-group> (<year>2020</year>). <article-title>Severity detection tool for patients with infectious disease</article-title>. <source>Healthc. Technol. Lett.</source>
<volume>7</volume>, <fpage>45</fpage>–<lpage>50</lpage>. <pub-id pub-id-type="doi">10.1049/htl.2019.0030</pub-id>
<pub-id pub-id-type="pmid">32431851</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Gent</surname><given-names>P.</given-names></name><name><surname>Farah</surname><given-names>H.</given-names></name><name><surname>van Nes</surname><given-names>N.</given-names></name><name><surname>van Arem</surname><given-names>B.</given-names></name></person-group> (<year>2019</year>). <article-title>Analysing noisy driver physiology real-time using off-the-shelf sensors: Heart rate analysis software from the taking the fast lane project</article-title>. <source>J. Open Res. Softw.</source>
<volume>7</volume> (<issue>1</issue>), <fpage>32</fpage>. <pub-id pub-id-type="doi">10.5334/jors.241</pub-id>
</mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>van Gent</surname><given-names>P.</given-names></name><name><surname>Farah</surname><given-names>H.</given-names></name><name><surname>van Nes</surname><given-names>N.</given-names></name><name><surname>van Arem</surname><given-names>B.</given-names></name></person-group> (<year>2019</year>). <article-title>HeartPy: A novel heart rate algorithm for the analysis of noisy signals</article-title>. <source>Transp. Res. F: Traffic Psychol. Behav.</source>
<volume>66</volume>, <fpage>368</fpage>–<lpage>378</lpage>. <pub-id pub-id-type="doi">10.1016/j.trf.2019.09.015</pub-id>
</mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Virtanen</surname><given-names>P.</given-names></name><name><surname>Gommers</surname><given-names>R.</given-names></name><name><surname>Oliphant</surname><given-names>T. E.</given-names></name><name><surname>Haberland</surname><given-names>M.</given-names></name><name><surname>Reddy</surname><given-names>T.</given-names></name><name><surname>Cournapeau</surname><given-names>D.</given-names></name><etal/></person-group> (<year>2020</year>). <article-title>SciPy 1.0: Fundamental algorithms for scientific computing in Python</article-title>. <source>Nat. Methods</source>
<volume>17</volume>, <fpage>261</fpage>–<lpage>272</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>
<pub-id pub-id-type="pmid">32015543</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zong</surname><given-names>W.</given-names></name><name><surname>Heldt</surname><given-names>T.</given-names></name><name><surname>Moody</surname><given-names>G.</given-names></name><name><surname>Mark</surname><given-names>R.</given-names></name></person-group> (<year>2003</year>). <article-title>An open-source algorithm to detect onset of arterial blood pressure pulses</article-title>. <source>Comput. Cardiol.</source>
<volume>30</volume>, <fpage>259</fpage>–<lpage>262</lpage>. <pub-id pub-id-type="doi">10.1109/CIC.2003.1291140</pub-id>
</mixed-citation>
    </ref>
  </ref-list>
</back>
