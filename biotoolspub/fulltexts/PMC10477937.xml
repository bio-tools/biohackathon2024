<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10477937</article-id>
    <article-id pub-id-type="pmid">37610325</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad521</article-id>
    <article-id pub-id-type="publisher-id">btad521</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Databases and Ontologies</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CellAnn: a comprehensive, super-fast, and user-friendly single-cell annotation web server</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9996-826X</contrib-id>
        <name>
          <surname>Lyu</surname>
          <given-names>Pin</given-names>
        </name>
        <aff><institution>Department of Ophthalmology, Johns Hopkins University School of Medicine</institution>, Baltimore, MD 21287, <country country="US">United States</country></aff>
        <xref rid="btad521-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhai</surname>
          <given-names>Yijie</given-names>
        </name>
        <aff><institution>Department of Ophthalmology, Johns Hopkins University School of Medicine</institution>, Baltimore, MD 21287, <country country="US">United States</country></aff>
        <xref rid="btad521-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6624-9293</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Taibo</given-names>
        </name>
        <aff><institution>Department of Biomedical Engineering, Johns Hopkins University School of Medicine</institution>, Baltimore, MD 21218, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0476-3596</contrib-id>
        <name>
          <surname>Qian</surname>
          <given-names>Jiang</given-names>
        </name>
        <aff><institution>Department of Ophthalmology, Johns Hopkins University School of Medicine</institution>, Baltimore, MD 21287, <country country="US">United States</country></aff>
        <xref rid="btad521-cor1" ref-type="corresp"/>
        <!--jiang.qian@jhmi.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Robinson</surname>
          <given-names>Peter</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad521-cor1">Corresponding author. Department of Ophthalmology, Johns Hopkins University School of Medicine, Baltimore, MD 21287, United States. E-mail: <email>jiang.qian@jhmi.edu</email> (J.Q.)</corresp>
      <fn id="btad521-FM1">
        <p>Pin Lyu, Yijie Zhai. Equal contribution.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-08-23">
      <day>23</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>9</issue>
    <elocation-id>btad521</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>17</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>16</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>05</day>
        <month>9</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad521.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single-cell sequencing technology has become a routine in studying many biological problems. A core step of analyzing single-cell data is the assignment of cell clusters to specific cell types. Reference-based methods are proposed for predicting cell types for single-cell clusters. However, the scalability and lack of preprocessed reference datasets prevent them from being practical and easy to use.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we introduce a reference-based cell annotation web server, CellAnn, which is super-fast and easy to use. CellAnn contains a comprehensive reference database with 204 human and 191 mouse single-cell datasets. These reference datasets cover 32 organs. Furthermore, we developed a cluster-to-cluster alignment method to transfer cell labels from the reference to the query datasets, which is superior to the existing methods with higher accuracy and higher scalability. Finally, CellAnn is an online tool that integrates all the procedures in cell annotation, including reference searching, transferring cell labels, visualizing results, and harmonizing cell annotation labels. Through the user-friendly interface, users can identify the best annotation by cross-validating with multiple reference datasets. We believe that CellAnn can greatly facilitate single-cell sequencing data analysis.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The web server is available at <ext-link xlink:href="http://www.cellann.io" ext-link-type="uri">www.cellann.io</ext-link>, and the source code is available at <ext-link xlink:href="https://github.com/Pinlyu3/CellAnn_shinyapp" ext-link-type="uri">https://github.com/Pinlyu3/CellAnn_shinyapp</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01EY029548</award-id>
        <award-id>P30EY00176</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell RNA-sequencing (scRNA-seq) is a genomic method to detect gene expression levels at the single-cell level. Even though it was invented &lt;10 years ago, it has been widely used to identify novel cell types and cell heterogeneity during development and disease (<xref rid="btad521-B27" ref-type="bibr">Saliba <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="btad521-B33" ref-type="bibr">Wen and Tang 2016</xref>; <xref rid="btad521-B4" ref-type="bibr">Baslan and Hicks 2017</xref>; <xref rid="btad521-B23" ref-type="bibr">Ofengeim <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="btad521-B26" ref-type="bibr">Rozenblatt-Rosen <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="btad521-B25" ref-type="bibr">Potter 2018</xref>). The common practice in scRNA-seq data analysis is first to cluster the cells based on the similarity of the gene expression profiles in each cell. The next step is cell annotation, assigning the specific cell types to the clusters. Even though cell annotation is essential to understand the biological properties of the cells, it is challenging because it requires domain knowledge in specific cells or tissues.</p>
    <p>Two major approaches exist for cell annotation. One approach utilizes the known marker genes for specific cell types. Marker genes can be found in online databases such as CellMarker (<xref rid="btad521-B38" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2019b</xref>) and PanglaoDB (<xref rid="btad521-B6" ref-type="bibr">Franzén <italic toggle="yes">et al.</italic> 2019</xref>). Popular methods in this category include ScType (<xref rid="btad521-B14" ref-type="bibr">Ianevski <italic toggle="yes">et al.</italic> 2022</xref>), scSorter (<xref rid="btad521-B9" ref-type="bibr">Guo and Li 2021</xref>), CellAssign (<xref rid="btad521-B37" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2019a</xref>), and scCATCH (<xref rid="btad521-B28" ref-type="bibr">Shao <italic toggle="yes">et al.</italic> 2020</xref>). However, this approach is not always successful due to the limited knowledge of marker genes of some cell types. For example, some poorly studied cell types have very few or no marker genes. In addition, some known marker genes might not be specific to a cell type as expected. The second type of cell annotation approach is based on the reference datasets. Several methods have been developed for this purpose, including scClassify (<xref rid="btad521-B19" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2020</xref>), Scibet (<xref rid="btad521-B18" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2020</xref>), singleCellNet (<xref rid="btad521-B30" ref-type="bibr">Tan and Cahan 2019</xref>), scMAGIC (<xref rid="btad521-B39" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2022</xref>), and singleR (<xref rid="btad521-B3" ref-type="bibr">Aran <italic toggle="yes">et al.</italic> 2019</xref>). This type of approach takes advantage of the published datasets that were carefully studied by domain experts. Instead of explicitly extracting the marker genes associated with each cluster, the cell types are characterized by the gene expression profiles defined by many variable genes. By comparing the expression profiles of query clusters and annotated reference datasets, the cell types can be “borrowed” from the reference datasets if the gene expression profiles of the query and reference are similar enough.</p>
    <p>A good reference-based cell annotation system should have the following desirable features. First, we need a large set of preprocessed reference datasets, which makes it easy for the users to find the relevant reference datasets for their query dataset. Unfortunately, most available tools rely on the users to identify, download and process the reference dataset before the users can perform the analysis. Second, a good annotation system should not require sophisticated computational skills to run the task. However, most reference-based methods require users to install the tools on their computers. Some tools are only available in specific computational languages such as Python or R. Third, an ideal method should run fast even with large reference or query datasets, and it should not require a large computer memory. Some advanced methods, such as those employing deep learning approaches, have been developed and have a good performance [scBERT (<xref rid="btad521-B35" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2022</xref>), scDeepSort (<xref rid="btad521-B29" ref-type="bibr">Shao <italic toggle="yes">et al.</italic> 2021</xref>), ACTINN (<xref rid="btad521-B22" ref-type="bibr">Ma and Pellegrini 2020</xref>), sigGCN (<xref rid="btad521-B32" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2021</xref>), scIAE (<xref rid="btad521-B36" ref-type="bibr">Yin <italic toggle="yes">et al.</italic> 2022</xref>), scNym (<xref rid="btad521-B41" ref-type="bibr">Kimmel and Kelley, 2021</xref>), SuperCT (<xref rid="btad521-B34" ref-type="bibr">Xie <italic toggle="yes">et al.</italic> 2019</xref>), and EnClaSC (<xref rid="btad521-B5" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2020</xref>)]. However, these methods are often slow and require large memories and computing resources, making them not suitable for an online tool. Furthermore, many single-cell datasets are generated from droplet-based platforms, which typically include cells on the scale of hundreds of thousands or larger (<xref rid="btad521-B21" ref-type="bibr">Macosko <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="btad521-B40" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2017</xref>). The runtime required by several widely used tools to analyze datasets of &lt;10k cells can range from tens of seconds to several days, especially for those that predict the cell types at the single-cell level rather than at the cluster level (<xref rid="btad521-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic> 2019</xref>; <xref rid="btad521-B13" ref-type="bibr">Huang <italic toggle="yes">et al.</italic> 2021</xref>).</p>
    <p>In this work, we present a new cell annotation system, CellAnn. The system includes more than 350 preprocessed reference datasets, including the major tissue types in human and mouse. Users can easily search the relevant reference datasets for comparison. Furthermore, a newly designed algorithm can produce the results with high accuracy and high speed. Our algorithm assigns the cell types to single-cell clusters, and therefore, the analysis can be done very fast. We assessed the performance of our algorithm and showed it is superior to existing methods. Finally, all the analyses are done on a user-friendly online web server, which is available at <ext-link xlink:href="http://www.cellann.io" ext-link-type="uri">www.cellann.io</ext-link>.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Data structure</title>
      <p>The usage of CellAnn is straightforward. First, users can upload the average gene expression for each cluster (gene by cluster matrix) to the system (<xref rid="btad521-F1" ref-type="fig">Fig. 1</xref>; Step 1). Then users can search the CellAnn database for one or multiple references within the selected tissue type(s), such as “retina” or “liver” (Step 2). The system will then compare the query dataset to the selected reference dataset(s), and the cell annotation results will be generated and made available for download (Step 3). If users wish to visualize the results, they may upload a single-cell coordinate file. The results of the cell annotation and marked gene expression patterns can then be viewed and examined (Step 4).</p>
      <fig position="float" id="btad521-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Schematic diagram of the CellAnn workflow. CellAnn has four major steps. (A) uploading the gene expression profile of the query clusters, (B) selecting references in the CellAnn database, (C) predicting cell types based on the selected references, and (D) checking marker gene expression patterns, harmonizing multiple predicted cell type labels, and downloading the final result.</p>
        </caption>
        <graphic xlink:href="btad521f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Source of CellAnn database</title>
      <p>We downloaded the raw gene expression matrix and author-annotated cell type information from UCSC Cell Browser (cells.ucsc.edu), Single Cell Portal (singlecell.broadinstitute.org), CELLxGENE (cellxgene.cziscience.com), and GEO (Gene Expression Omnibus). We also collected single-cell atlas datasets from HCL (<ext-link xlink:href="https://db.cngb.org/HCL/" ext-link-type="uri">https://db.cngb.org/HCL/</ext-link>) and MCL (<ext-link xlink:href="https://bis.zju.edu.cn/MCA/" ext-link-type="uri">https://bis.zju.edu.cn/MCA/</ext-link>). We selected a diverse set of data that covered as many tissue types as possible. For a given tissue type, we preferred large datasets with many cell types. We did not include the datasets from diseased samples (e.g. cancers) in the current version.</p>
    </sec>
    <sec>
      <title>2.3 CellAnn query dataset preparation</title>
      <p>To calculate the average gene expression profiles for each user-defined cluster, we summed up the raw gene expression counts of all cells for each cluster, normalized the gene expression by total counts, multiplied by a scale factor of 1e5, and took the natural logarithm of the obtained values [log(<italic toggle="yes">x</italic> + 1)]. We also provide tutorials and source code on the GitHub page of CellAnn for both Seurat and Scanpy users (<ext-link xlink:href="https://github.com/Pinlyu3/CellAnn_shinyapp" ext-link-type="uri">https://github.com/Pinlyu3/CellAnn_shinyapp</ext-link>).</p>
    </sec>
    <sec>
      <title>2.4 CellAnn reference dataset preparation</title>
      <p>All the references in the CellAnn database are processed with the following steps:</p>
      <list list-type="alpha-lower">
        <list-item>
          <p>Preprocessing: First, after downloading the expression matrix and annotation, we split some huge single-cell atlas (e.g. “HCL,” “Tabula Muris”) into several smaller datasets by tissue types. Next, we harmonized the gene names for each dataset. If the gene names are not the official gene symbol, we convert them to the GENCODE 42 (Human) and GENCODE M31 (Mouse) gene annotations. Then, we normalize the gene expression values of each cell by its total expression, multiply the result by a scale factor (1e5), and take the natural logarithm of the obtained values (log(<italic toggle="yes">x</italic>+1)).</p>
        </list-item>
        <list-item>
          <p>Preparing the reference-specific background reference dataset: We introduce the background reference because it can be used to calibrate the similarity between the query dataset and selected reference datasets. For each reference dataset, we integrate it with single-cell atlas datasets (i.e. background) to obtain more specific marker genes and comparable expression values across all tissues. For human references, we used the “HCL” or “Tabula Sapiens” datasets as a background, and for mouse references, we used the “MCL” or “Tabula Muris” datasets as a background.</p>
          <p>Since our analysis will be performed at the cluster level, we calculate the average gene expression level for the clusters in the background and the reference dataset. First, we used the “scVI” software (<xref rid="btad521-B20" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic> 2018</xref>) from scvi-tools (<xref rid="btad521-B8" ref-type="bibr">Gayoso et al.</xref>) to remove the batch effect between the reference and background datasets at the single-cell level. After integration, we obtained a combined dimension space and a combined, corrected cell-by-gene matrix that included all the single cells from the given reference and the background.</p>
          <p>Next, we obtain new clusters with all cells from both background and a reference dataset on the combined “scVI” dimension space using “FindNeighbors” and “FindClusters” functions from Seurat. We then calculated the average expression matrix of these new clusters using the combined, corrected single-cell gene expression matrix. The average expression matrix of the new clusters is denoted as Eb, in which rows represent genes and columns represent combined clusters.</p>
          <p>Next, we calculate the corrected average expression values of all the cell types in the selected reference datasets based on the combined clusters. For some cell types in the reference, the cells might be distributed to different clusters after the new clustering. For each given cell type in the reference, we calculate the percentage of cells in the new clusters and obtain a matrix of percentage, Wb, in which rows represent background clusters and columns represent the cell types in reference. Then, we calculate the cross product of matrix Eb and Wb to obtain the corrected expression matrix, Er, in which rows are genes and columns are the cell types in reference.</p>
          <p>Finally, we used the “COSG” package to identify marker genes across all the background clusters (denoted as bg-Markers), which will be used to calculate the correlation coefficient of gene expression between query and reference-specific background.</p>
        </list-item>
        <list-item>
          <p>Preparing the refined references: In some studies, authors may label multiple adjacent clusters as a single major cell type. Therefore, using the average expression of these major cell types may ignore the variance of the sub-cell types and confuse downstream analyses. To improve the sensitivity of our analysis, we first split the entire reference dataset by major cell types with the function “SplitObject.” Then, we re-performed clustering analysis for each split dataset using author-provided cell similarity graphs such as “UMAP” or “t-SNE.” If the authors do not provide the coordinate information, we calculate the UMAPs by the standard Seurat workflow. Next, we use the “FindNeighbors” and “FindClusters” functions with a resolution parameter of 0.3 to obtain refined clusters and label them as sub-cell types. Next, we get the average expression matrix (denoted as Ersub) by summing the raw counts in each sub-cluster and normalizing the expression value as described before. Finally, we calculate marker genes for original clusters (denoted as main-Markers) and sub-clusters (denoted as sub-Markers) using the “COSG” package.</p>
        </list-item>
      </list>
    </sec>
    <sec>
      <title>2.5 Harmonize gene names between species</title>
      <p>CellAnn enables users to perform cell type prediction across species. After uploading a gene expression matrix, CellAnn employs a predictive algorithm to determine the species from which the query dataset originates. This is accomplished by computing the overlap ratio of gene symbols between the input matrix and human or mouse gene annotations obtained from GENCODE 42 and GENCODE M31, respectively. If the ratio of overlapping genes exceeds 50% for either human or mouse gene symbols, CellAnn will label the query data with the corresponding species. If fewer than 50% of genes overlap, CellAnn will issue a “Warning” message, prompting the user to review their input files. In cases where the query data and reference datasets are from different species, CellAnn automatically converts gene names in the query data to enable compatibility with the reference datasets. The orthologous genes file is downloaded from the database (<ext-link xlink:href="http://www.informatics.jax.org" ext-link-type="uri">http://www.informatics.jax.org</ext-link>).</p>
    </sec>
    <sec>
      <title>2.6 Comparison algorithm of CellAnn</title>
      <p>We develop an algorithm to compare a query dataset and a selected reference dataset. The algorithm consists of 3 modules (<xref rid="btad521-F2" ref-type="fig">Fig. 2A</xref>).</p>
      <fig position="float" id="btad521-F2">
        <label>Figure 2.</label>
        <caption>
          <p>The algorithm design of CellAnn. (A) The CellAnn algorithm consists of three modules: (1) Module 1: CellAnn calculates the correlations between query clusters and clusters in reference and background. The cutoff is estimated based on the correlation between query clusters and background references. (2) Module 2: CellAnn calculates the correlations and estimates correlation cutoffs between the query data and sub-clusters in reference datasets. (3) Module 3: CellAnn performs the Wilcoxon rank-sum test to determine cell types further if a query cluster is similar to multiple sub-clusters in the reference.</p>
        </caption>
        <graphic xlink:href="btad521f2" position="float"/>
      </fig>
      <p>Module 1. We first determine a cutoff from the comparison of background and query datasets. To do so, we compute correlations between the query clusters (Eq) and background reference datasets (Eb) with the expression value of bg-Markers. We obtain nb *nq coefficient values, where nb and nq equal the number of clusters in the background and query, respectively. We then obtain a distribution of the nb *nq correlation coefficients. Since the background reference contains a diverse set of tissue types, most query cluster-background cluster pairs are from different cell types. We assume that the observed distribution composes a negative distribution (from pairs with different cell types) and a positive distribution (from pairs with the same cell types).</p>
      <p>Based on the assumption, we decompose the density distribution into one to three Gaussian distributions using the mclust package in R. If the observed distribution is better fitted by only one Gaussian distribution, the distribution is considered from different cell types. We then set the correlation cutoff as the point whose cumulative probability exceeds 0.75 in the distribution. If two or three Gaussian distributions can better explain the observed distribution, the distribution with the largest μ is considered from the same cell types, and the remaining distributions are considered from different cell types. For two Gaussian distributions, we set the intersection point as cutoff. For three Gaussian distributions, we set the cutoff as the point whose cumulative probability exceeds 0.75 in the second distribution. Finally, to avoid the extreme cutoff values, we set the minimal and maximal cutoff values to 0.4 and 0.6, respectively, if the obtained cutoff falls out the range of 0.4–0.6.</p>
      <p>We then calculate the correlations between the query clusters (Eq) and reference datasets (Er) according to the expression value of bg-Markers. For a given query cluster, if all its correlations with reference cell types are lower than the cutoff, we label it as an “unassigned” cluster. Otherwise, we go to next Module.</p>
      <p>Module 2. We next calculate the pairwise correlation coefficients between the query clusters (Eq) and the sub-clusters (Er-sub) in the reference (<xref rid="btad521-F2" ref-type="fig">Fig. 2A</xref>, step 2) according to the expression value of main-Markers. We then obtain a distribution of the coefficients. Similar to the above module, we fit the distribution with one to three Gaussian distributions and determine a cutoff for this specific query dataset. For each query cluster, if the maximal coefficient with the sub-clusters in the selected reference is below the cutoff, the query cluster will be assigned as “unassigned.” If only one correlation coefficient for a given query cluster is above the cutoff, the query cluster is assigned to the cell type associated with the sub-cluster in the reference. If more than one coefficient is above the cutoff, especially if the matched sub-clusters belong to different cell types in the original annotation, we go to next Module.</p>
      <p>Module 3. We perform additional statistical tests to determine the cell type of the query cluster. First, we select the top three sub-clusters whose correlations are larger than the cutoff. Next, we extract the marker genes of the top three sub-clusters from the sub-Markers list. Then, we use the Wilcoxon Rank-Sum test to make pairwise comparisons among these three groups of marker genes to check whether their expression values are significantly higher than the others in the query cluster. Based on the statistical results, we assign the cell type of the sub-cluster with the highest significance as the predicted cell type of the given query cluster.</p>
    </sec>
    <sec>
      <title>2.7 Evaluation of computational scalability</title>
      <p>To measure the computational resources required for running CellAnn and other comparable methods, we simulate a query and several reference samples with different sizes from the PBMC datasets. We first downloaded PBMC data from the single-cell portal (SCP424). The original datasets contain a total of 31 021 cells from 8 different sequencing libraries. We use the “inDrops” PBMC datasets as the query datasets. For reference datasets, we perform downsampling from entire dataset with sizes of 1k, 5k, 10k, 15k, 20k, and 25k.</p>
      <p>We use the function “system.time()” in R to evaluate the running time of all the methods. In addition, we use the R package “Bench” to measure the maximum memory usage when running all the software. All the efficiency tests were performed on a Linux server with Intel(R) Xeon(R) Gold 6126 CPU processors and 790 GB physical memory.</p>
    </sec>
    <sec>
      <title>2.8 Comparison with other cell annotation methods</title>
      <p>We compare CellAnn with five competing methods, including scmap, CHETAH, scClassify, scPred, and Seurat v4. To compare the methods, we have prepared a total of 52 benchmark tests using the “Tabula Muris” single-cell atlas dataset. The “Tabula Muris” single-cell atlas contains single-cell data from different tissues that were sequenced using two different platforms: fluorescence-activated cell sorting (FACS) and droplet-based sequencing (droplet). We often use datasets from one platform as a reference and predict the cell types in datasets generated from another platform.</p>
      <p>We prepared both cell- and cluster-based inputs for these competing methods as follows. For CHETAH, scClassify, scPred, and Seurat v4, both the query and reference datasets are single-cell datasets. We use the log-normalized raw-counts matrix as the cell-based expression profiles for both query and reference datasets in these methods. For scmap, the query datasets are cluster-based expression profiles, while the reference datasets are single-cell-based expression profiles. To prepare the cluster-based inputs, we re-performed clustering analysis with Seurat for each cell type in the query dataset and calculated the average expression profile of all the new clusters. For CellAnn, the query and reference datasets are both cluster-based expression profiles. The background of the query dataset is “Tabula Muris” datasets.</p>
      <p>We used the following parameters for these methods. In scmap-cluster, we set the similarity threshold to 0.5, and cells with a predicted score below this threshold were labeled as “unassigned.” In Seurat V4, default settings were used to find anchors between the query and reference datasets. The number of principal components was set to 50, and cells with a predicted score &lt; 0.5 were also categorized as “unassigned.” For scClassify, we constructed the hierarchical tree using the “HC” method and classified the ensemble model using the “WKNN” method. The “limma” method was used to select genes, and both the “Pearson” and “cosine” methods were employed to measure the similarity between single cells. In CHETAH, we used all default parameters to train the model and make predictions for the query datasets. In scPred, we trained the reference datasets using the “svmRadial” model and set the threshold for probabilities to classify cells into groups at 0.55; cells below this threshold were labeled as “unassigned.” Finally, in CellAnn, we did not adjust any parameters during comparison, and default settings were used.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Reference dataset collection</title>
      <p>Cellann database contains 204 and 191 nonredundant scRNA-seq datasets for humans and mice, respectively. The number of associated studies (papers) of these datasets in CellAnn is significantly larger than other reference-based annotation tools (<xref rid="btad521-F3" ref-type="fig">Fig. 3A and B</xref>). For example, CellAnn contains single datasets from more than 109 (36) papers in Human (Mouse). However, scClassify, Scibet, singleCellNet, and singleR, four representative reference-based cell annotation databases, include only 11(5), 31(17), 6(6), and 19(26) papers, respectively (<xref rid="btad521-F3" ref-type="fig">Fig. 3A</xref>).</p>
      <fig position="float" id="btad521-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Reference datasets included in CellAnn. The bar plot compares the available datasets for each organ type in human (A) and mouse (B) included in the CellAnn database and other reference-based cell annotation web services. The <italic toggle="yes">x</italic>-axis represents different organs, and the <italic toggle="yes">y</italic>-axis represents the number of papers related to the corresponding organs.</p>
        </caption>
        <graphic xlink:href="btad521f3" position="float"/>
      </fig>
      <p>The reference datasets cover most of the major tissue types in the two species. Some tissue types are well-studied, such as the brain, blood, airway, and lung. Therefore, more datasets were obtained from these tissues. Most of the collected tissue types have more than one single-cell datasets, allowing for multiple-reference comparison with the query dataset.</p>
    </sec>
    <sec>
      <title>3.2 Algorithm performance</title>
      <p>We first evaluate the performance of our comparison algorithm (<xref rid="btad521-F4" ref-type="fig">Fig. 4</xref>). Using annotation in the reference dataset as ground truth, we have six outcomes: correctly classified, partially correctly classified, correctly unclassified, failed classified, wrongly classified, and wrongly unclassified (<xref rid="btad521-F4" ref-type="fig">Fig. 4A</xref>). The first three are considered correct predictions, while the latter three are wrong predictions.</p>
      <fig position="float" id="btad521-F4">
        <label>Figure 4.</label>
        <caption>
          <p>The performance and scalability of CellAnn. (A) Evaluation framework of CellAnn. According to the author’s annotation, predictions are classified into “Correct Classified,” “Correct Classified (Partially),” “Wrong Classified,” “Failed Classified,” “Wrong Unclassified,” or “Correct Unclassified.” (B) The benchmark results of 56 testing pairs for 6 different methods. Each bar indicates the composition of predicted cell types. Based on the overlapping of cell types between query and reference datasets, we divided these test pairs into four groups: type 1, type 2, type 3, and type 4. The Venn diagrams on the left show the relationships of type 1–type 4. (C) The bar plots indicate the composition of predicted categories of the average performance in a collection of reference–testing pairs. (D) Benchmarking the efficiency of CellAnn. Left: the line plot shows the running time under the default settings of each algorithm. Right: the line plot shows the peak memory usage of each algorithm. The <italic toggle="yes">x</italic>-axis is labeled by the number of cells and the clusters in the references. The curves are truncated if a method is not scalable to a certain size of the references.</p>
        </caption>
        <graphic xlink:href="btad521f4" position="float"/>
      </fig>
      <p>To comprehensively assess the performance of our method, we tested four types of situations (<xref rid="btad521-F4" ref-type="fig">Fig. 4B</xref>). In Type 1, the cell types in the query and reference datasets are exactly the same but from different platforms. In Type 2, the cell types in the query are the subset of the cell types in the reference. For the first two types, we expect, in the ideal situation, to find all the cell types for the query clusters. In Type 3, the cell types in the reference are the subset of the cell types in the query. Some query clusters are not expected to have an assignment (i.e. unclassified). In Type 4, the cell types in the query and reference are not overlapped. All the query clusters should be unassigned. The performance in Types 3 and 4 comparison is critical for a database search because the users might select remotely similar or even irrelevant datasets as references.</p>
      <p>We compared our algorithm with popular cell annotation methods, including Scmap-cluster (<xref rid="btad521-B17" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2018</xref>), CHEATAH (<xref rid="btad521-B15" ref-type="bibr">de Kanter <italic toggle="yes">et al.</italic> 2019</xref>), Seurat (<xref rid="btad521-B11" ref-type="bibr">Hao <italic toggle="yes">et al.</italic> 2021</xref>), SCPred (<xref rid="btad521-B2" ref-type="bibr">Alquicira-Hernandez <italic toggle="yes">et al.</italic> 2019</xref>), and scClassify (<xref rid="btad521-B19" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2020</xref>) (<xref rid="btad521-F4" ref-type="fig">Fig. 4B and C</xref>). The performance of our algorithm in Type I comparison is comparable with Seurat, SCPred, and scClassify. They all achieved ∼0.99 correct predictions. However, Scmap-cluster and CHEATAH have lower success rates of 0.90 and 0.71, respectively. In Type 2, CellAnn reached a success rate of 0.94, outperforming other methods. Furthermore, for types 3 and 4, CellAnn still has a good success rate. However, CHEATAH, which has worse performance in the types 1 and 2 comparisons, has a relatively good success rate in types 3 and 4. This might be due to a more stringent cutoff selection for CHEATAH. In contrast, CellAnn uses an automatic query-specific cutoff selection, which might be the reason for a high success rate in all types of comparisons.</p>
    </sec>
    <sec>
      <title>3.3 Speed and memory use</title>
      <p>We then assess the speed and memory used for CellAnn and other existing methods. We use the reference datasets with different cell numbers and different numbers of clusters, ranging from 1k to 25k cells and from 28 to 61 cell clusters (<xref rid="btad521-F4" ref-type="fig">Fig. 4D</xref>). CellAnn is the fastest and finishes the jobs within 10 s, making it suitable for an online cell annotation tool. Seurat and Scmap-cluster are also fast, finishing the jobs within minutes. The other three methods, CHETAH, scClassify, and scPred are suitable small reference datasets.</p>
      <p>Similarly, CellAnn is also efficient in memory use because it is a cluster-based, rather than a cell-based approach (<xref rid="btad521-F4" ref-type="fig">Fig. 4D</xref>). The peak memory required for Cell Ann is around 1 GB with the largest dataset (25k cells). Seurat requires around 5 GB for the largest reference dataset. The memory needed for other methods easily exceeds 10 GB if the reference datasets contain more than 25k cells.</p>
    </sec>
    <sec>
      <title>3.4 Case study</title>
      <p>Multiple reference datasets can provide a more confident annotation. Here we use an example to demonstrate its usage. We used one published human retina dataset as input (<xref rid="btad521-B31" ref-type="bibr">Voigt <italic toggle="yes">et al.</italic> 2019</xref>), which included 43 clusters (<xref rid="btad521-F5" ref-type="fig">Fig. 5A</xref>). We then selected four relevant datasets as references (<xref rid="btad521-B10" ref-type="bibr">Han <italic toggle="yes">et al.</italic> 2020</xref>; <xref rid="btad521-B12" ref-type="bibr">Hoang <italic toggle="yes">et al.</italic> 2020</xref>; <xref rid="btad521-B24" ref-type="bibr">Orozco <italic toggle="yes">et al.</italic> 2020</xref>; <xref rid="btad521-B7" ref-type="bibr">Gautam <italic toggle="yes">et al.</italic> 2021</xref>) (<xref rid="btad521-F5" ref-type="fig">Fig. 5B</xref>). The references have three datasets from the human retina or eye and one dataset from mouse retina. Using default parameters, we obtained the predicted cell annotation for the 43 input clusters (<xref rid="btad521-F5" ref-type="fig">Fig. 5C</xref>). The cell type labels from the four datasets could be different. For example, both “bipolar” and “BP” refer to the same cell type, while “Muller glia,” “Muller,” and “Resting MG” are the Muller glia cell type. Overall, the annotation from different references is consistent, increasing our confidence level in the cell annotation. However, some clusters have inconsistent annotations (see highlighted blue boxes in <xref rid="btad521-F5" ref-type="fig">Fig. 5C</xref>). The top marker genes of the clusters obtained from the reference can be used to choose the winners of the annotations for the input clusters. The second to the last column is our summary annotation after integrating the prediction from the four references, while the last column shows the original annotation from the published input dataset. The agreement between the prediction and the original annotation suggested the high quality of the predicted annotation.</p>
      <fig position="float" id="btad521-F5">
        <label>Figure 5.</label>
        <caption>
          <p>A case study on cell type annotation with multiple references using CellAnn. (A) The UMAP plots show the query data and four different reference datasets. The cells in the query data are colored by clusters, and the cells in the reference datasets are colored based on the author's cell type annotation. (B) The comparisons of alignment results by CellAnn with the author's annotation in the query datasets. The left panel displays a table that shows the predicted cell type labels by CellAnn. The right panel displays UMAP plots of the query datasets, with the predicted annotation and the author's original annotation. (C) The marker gene expression levels in both query and reference datasets, help the users to select the cell type when the results from multiple reference datasets are inconsistent.</p>
        </caption>
        <graphic xlink:href="btad521f5" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.5 User interface</title>
      <p>We have designed an interactive web server for CellAnn (<ext-link xlink:href="http://www.cellann.io" ext-link-type="uri">www.cellann.io</ext-link>). To use the server, users first perform clustering analysis using other methods (e.g. Seurat), and calculate the average expression profiles for the clusters. Users can then upload the cluster versus gene matrix to the server (<xref rid="btad521-F6" ref-type="fig">Fig. 6</xref>). The server will automatically check the number of clusters, genes, and species based on the user's input file. If the user's input is correct, users will be able to proceed to the next step. Otherwise, a warning message will be shown.</p>
      <fig position="float" id="btad521-F6">
        <label>Figure 6.</label>
        <caption>
          <p>Example webpages associated with each step of the analysis. (A) Step 1: a window for uploading expression profiles of query data (1). (B) Step 2: a table for searching and selecting datasets in CellAnn (2), and a table for reviewing the selected datasets (3). (C) Step 3: a window for running CellAnn and tuning parameters (4). a table for downloading predicted cell types (5). (D) Step 4: a window for uploading coordinate profiles (6), a search window for alignment results and related marker genes (7), UMAPs for query and reference data that are colored by cluster, predicted cell type, author's annotation (for reference), and gene expression values (8), and a downloadable and editable table that users can review to see predictions and add their own custom annotations (9).</p>
        </caption>
        <graphic xlink:href="btad521f6" position="float"/>
      </fig>
      <p>Users are able to select one or more relevant datasets as references. The current version of CellAnn contains 204 human and 191 mouse single-cell datasets, respectively. To facilitate the identification of relevant datasets, we have organized the datasets into 32 organs. Users can search for the relevant datasets by organ. We also provide a preview button for each dataset, allowing users to preview the dimension plot for each study and check which cell types are included in the reference dataset.</p>
      <p>The users can then run the analysis. While the whole analysis procedure is automatic, users also have the option to set the range of cutoff values in the user interface. The default range for the cutoff value is 0.4 to 0.6. The analysis results will be presented in a table format.</p>
      <p>The final step is optional. If users upload an additional file with the cell clustering coordinates, we will provide the visualization of the annotation analysis. As an independent validation, users can also select marker genes for a particular cluster from reference clusters and examine the expression level of the genes in query clusters.</p>
      <p>CellAnn is a freely accessible web server available at <ext-link xlink:href="http://www.cellann.io" ext-link-type="uri">www.cellann.io</ext-link>. The help page of the web server provides brief documentation. CellAnn is compatible with all commonly used web browsers, including Safari, Chrome, Opera, Firefox, and Microsoft Edge. The underlying data of CellAnn is also freely accessible on the GitHub page of the web server.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We develop a method, CellAnn, for single-cell annotation. The method has the following unique advantages. First, it is a cluster-based algorithm. Compared to cell-based methods, it is very fast. This is important, especially if we want to compare multiple reference datasets. Second, it contains many preprocessed single-cell datasets as references. The large collection of references makes it convenient to use and saves a lot of time for the users. Third, the performance of our algorithm is robust. One reason for the robustness is that we introduce a background reference and use it to calibrate the choice of the cutoff.</p>
    <p>One interesting question is whether the cell types are discrete or continuous. A cell type will undergo transcriptomic changes under certain conditions, such as disease and aging. Should we consider them as the same cell types or annotate them as distinct diseased- or aged-cell types? In the current version of CellAnn, we did not include the datasets with diseases (e.g. cancers). We plan to include more datasets in the next version so that the users will obtain not only the predicted cell types but also the associated conditions.</p>
    <p>If users selected multiple reference datasets, we presented the predicted cell types from each reference dataset and did not provide a consensus score or an “averaged” result from the multiple reference datasets. There are several practical issues for this approach. First, we do not want to adopt a voting strategy to provide an averaged result because the quality of the datasets is not the same. Second, the reference datasets might use different cell type nomenclatures and make it difficult to “average” the results. For example, “Muller glia,” “Muller,” and “MG” are the same cell type, and “photoreceptor,” “rods,” and “cones” could be the same cell type, too. To make things more complicated, “MG-1,” “MG-resting,” and “MG-activated” could be the Muller glia at different conditions. Therefore, we decided to keep the original annotation from the publications and not try to standardize the cell-type annotation.</p>
    <p>One potential problem for the reference-based methods is that the methods rely on the quality of reference datasets and the query dataset. The low quality of the query dataset or incorrect annotation in the reference datasets will cause false predictions. We will keep updating the database when new datasets become available and believe that adding new datasets will make CellAnn even more powerful.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Drs Ming-wen Hu, Yang Jin, and Seth Blachshaw for suggestions and comments.</p>
  </ack>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Institutes of Health [R01EY029548, P30EY00176 to J.Q.].</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad521-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdelaal</surname><given-names>T</given-names></string-name>, <string-name><surname>Michielsen</surname><given-names>L</given-names></string-name>, <string-name><surname>Cats</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>194</fpage>.<pub-id pub-id-type="pmid">31500660</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alquicira-Hernandez</surname><given-names>J</given-names></string-name>, <string-name><surname>Sathe</surname><given-names>A</given-names></string-name>, <string-name><surname>Ji</surname><given-names>HP</given-names></string-name></person-group><etal>et al</etal><article-title>scPred: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>264</fpage>.<pub-id pub-id-type="pmid">31829268</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname><given-names>D</given-names></string-name>, <string-name><surname>Looney</surname><given-names>AP</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat Immunol</source><year>2019</year>;<volume>20</volume>:<fpage>163</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baslan</surname><given-names>T</given-names></string-name>, <string-name><surname>Hicks</surname><given-names>J.</given-names></string-name></person-group><article-title>Unravelling biology and shifting paradigms in cancer with single-cell sequencing</article-title>. <source>Nat Rev Cancer</source><year>2017</year>;<volume>17</volume>:<fpage>557</fpage>–<lpage>69</lpage>.<pub-id pub-id-type="pmid">28835719</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>EnClaSC: a novel ensemble approach for accurate and robust cell-type classification of single-cell transcriptomes</article-title>. <source>BMC Bioinformatics</source><year>2020</year>;<volume>21</volume>:<fpage>392</fpage>.<pub-id pub-id-type="pmid">32938367</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Franzén</surname><given-names>O</given-names></string-name>, <string-name><surname>Gan</surname><given-names>L-M</given-names></string-name>, <string-name><surname>Björkegren</surname><given-names>JLM</given-names></string-name></person-group><etal>et al</etal><article-title>PanglaoDB: a web server for exploration of mouse and human single-cell RNA sequencing data</article-title>. <source>Database</source><year>2019</year>;<volume>2019</volume>:<fpage>baz046</fpage>.<pub-id pub-id-type="pmid">30951143</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gautam</surname><given-names>P</given-names></string-name>, <string-name><surname>Hamashima</surname><given-names>K</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Multi-species single-cell transcriptomic analysis of ocular compartment regulons</article-title>. <source>Nat Commun</source><year>2021</year>;<volume>12</volume>:<fpage>5675</fpage>.<pub-id pub-id-type="pmid">34584087</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gayoso</surname><given-names>A</given-names></string-name>, <string-name><surname>Lopez</surname><given-names>R</given-names></string-name>, <string-name><surname>Xing</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> A Python library for probabilistic analysis of single-cell omics data. <source>Nature Biotechnol</source><year>2022</year>;<volume>40</volume>(<issue>2</issue>):<fpage>163</fpage>–<lpage>166</lpage>.<pub-id pub-id-type="pmid">35132262</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>H</given-names></string-name>, <string-name><surname>Li</surname><given-names>J.</given-names></string-name></person-group><article-title>scSorter: assigning cells to known cell types according to marker genes</article-title>. <source>Genome Biol</source><year>2021</year>;<volume>22</volume>:<fpage>69</fpage>.<pub-id pub-id-type="pmid">33618746</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Z</given-names></string-name>, <string-name><surname>Fei</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Construction of a human cell landscape at single-cell level</article-title>. <source>Nature</source><year>2020</year>;<volume>581</volume>:<fpage>303</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">32214235</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Hao</surname><given-names>S</given-names></string-name>, <string-name><surname>Andersen-Nissen</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Integrated analysis of multimodal single-cell data</article-title>. <source>Cell</source><year>2021</year>;<volume>184</volume>:<fpage>3573</fpage>–<lpage>87.e29</lpage>.<pub-id pub-id-type="pmid">34062119</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hoang</surname><given-names>T</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Boyd</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Gene regulatory networks controlling vertebrate retinal regeneration</article-title>. <source>Science</source><year>2020</year>;<volume>370</volume>:<fpage>eabb8598</fpage>.<pub-id pub-id-type="pmid">33004674</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>Q</given-names></string-name>, <string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Du</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Evaluation of cell type annotation R packages on single-cell RNA-seq data</article-title>. <source>Genomics Proteomics Bioinf</source><year>2021</year>;<volume>19</volume>:<fpage>267</fpage>–<lpage>81</lpage>.</mixed-citation>
    </ref>
    <ref id="btad521-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ianevski</surname><given-names>A</given-names></string-name>, <string-name><surname>Giri</surname><given-names>AK</given-names></string-name>, <string-name><surname>Aittokallio</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Fully-automated and ultra-fast cell-type identification using specific marker combinations from single-cell transcriptomic data</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>1246</fpage>.<pub-id pub-id-type="pmid">35273156</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Kanter</surname><given-names>JK</given-names></string-name></person-group><etal>et al</etal><article-title>CHETAH: a selective, hierarchical cell type identification method for single-cell RNA sequencing</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>e95</fpage>.<pub-id pub-id-type="pmid">31226206</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kimmel</surname><given-names>JC</given-names></string-name>, <string-name><surname>Kelley</surname><given-names>DR</given-names></string-name></person-group>. <article-title>Semi-supervised adversarial neural networks for single-cell classification</article-title>. <source>Genome research</source><year>2021</year>;<volume>31</volume>(<issue>10</issue>):<fpage>1781</fpage>-<lpage>1793</lpage>.<pub-id pub-id-type="pmid">33627475</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Yiu</surname><given-names>A</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Scmap: projection of single-cell RNA-seq data across data sets</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>359</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">29608555</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>C</given-names></string-name>, <string-name><surname>Liu</surname><given-names>B</given-names></string-name>, <string-name><surname>Kang</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>SciBet as a portable and fast single cell type identifier</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>1818</fpage>.<pub-id pub-id-type="pmid">32286268</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Y</given-names></string-name>, <string-name><surname>Cao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Kim</surname><given-names>HJ</given-names></string-name></person-group><etal>et al</etal><article-title>scClassify: sample size estimation and multiscale classification of cells using single and multiple reference</article-title>. <source>Mol Syst Biol</source><year>2020</year>;<volume>16</volume>:<fpage>e9389</fpage>.<pub-id pub-id-type="pmid">32567229</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lopez</surname><given-names>R</given-names></string-name>, <string-name><surname>Regier</surname><given-names>J</given-names></string-name>, <string-name><surname>Cole</surname><given-names>MB</given-names></string-name></person-group><etal>et al</etal><article-title>Deep generative modeling for single-cell transcriptomics</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>1053</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30504886</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Macosko</surname><given-names>EZ</given-names></string-name>, <string-name><surname>Basu</surname><given-names>A</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>. <source>Cell</source><year>2015</year>;<volume>161</volume>:<fpage>1202</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>F</given-names></string-name>, <string-name><surname>Pellegrini</surname><given-names>M.</given-names></string-name></person-group><article-title>ACTINN: automated identification of cell types in single cell RNA sequencing</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>533</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">31359028</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ofengeim</surname><given-names>D</given-names></string-name>, <string-name><surname>Giagtzoglou</surname><given-names>N</given-names></string-name>, <string-name><surname>Huh</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell RNA sequencing: unraveling the brain one cell at a time</article-title>. <source>Trends Mol Med</source><year>2017</year>;<volume>23</volume>:<fpage>563</fpage>–<lpage>76</lpage>.<pub-id pub-id-type="pmid">28501348</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Orozco</surname><given-names>LD</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H-H</given-names></string-name>, <string-name><surname>Cox</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Integration of eQTL and a single-cell atlas in the human eye identifies causal genes for age-related macular degeneration</article-title>. <source>Cell Rep</source><year>2020</year>;<volume>30</volume>:<fpage>1246</fpage>–<lpage>59.e6</lpage>.<pub-id pub-id-type="pmid">31995762</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Potter</surname><given-names>SS.</given-names></string-name></person-group><article-title>Single-cell RNA sequencing for the study of development, physiology and disease</article-title>. <source>Nat Rev Nephrol</source><year>2018</year>;<volume>14</volume>:<fpage>479</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">29789704</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rozenblatt-Rosen</surname><given-names>O</given-names></string-name>, <string-name><surname>Stubbington</surname><given-names>MJT</given-names></string-name>, <string-name><surname>Regev</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>The human cell atlas: from vision to reality</article-title>. <source>Nature</source><year>2017</year>;<volume>550</volume>:<fpage>451</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">29072289</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saliba</surname><given-names>A-E</given-names></string-name>, <string-name><surname>Westermann</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Gorski</surname><given-names>SA</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell RNA-seq: advances and future challenges</article-title>. <source>Nucleic Acids Res</source><year>2014</year>;<volume>42</volume>:<fpage>8845</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">25053837</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shao</surname><given-names>X</given-names></string-name>, <string-name><surname>Liao</surname><given-names>J</given-names></string-name>, <string-name><surname>Lu</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><article-title>scCATCH: automatic annotation on cell types of clusters from single-cell RNA sequencing data</article-title>. <source>iScience</source><year>2020</year>;<volume>23</volume>:<fpage>100882</fpage>.<pub-id pub-id-type="pmid">32062421</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shao</surname><given-names>X</given-names></string-name>, <string-name><surname>Yang</surname><given-names>H</given-names></string-name>, <string-name><surname>Zhuang</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><article-title>scDeepSort: a pre-trained cell-type annotation method for single-cell transcriptomics using deep learning with a weighted graph neural network</article-title>. <source>Nucleic Acids Res</source><year>2021</year>;<volume>49</volume>:<fpage>e122</fpage>.<pub-id pub-id-type="pmid">34500471</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Cahan</surname><given-names>P.</given-names></string-name></person-group><article-title>SingleCellNet: a computational tool to classify single cell RNA-Seq data across platforms and across species</article-title>. <source>Cell Syst</source><year>2019</year>;<volume>9</volume>:<fpage>207</fpage>–<lpage>13.e2</lpage>.<pub-id pub-id-type="pmid">31377170</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Voigt</surname><given-names>AP</given-names></string-name>, <string-name><surname>Whitmore</surname><given-names>SS</given-names></string-name>, <string-name><surname>Flamme-Wiese</surname><given-names>MJ</given-names></string-name></person-group><etal>et al</etal><article-title>Molecular characterization of foveal versus peripheral human retina by single-cell RNA sequencing</article-title>. <source>Exp Eye Res</source><year>2019</year>;<volume>184</volume>:<fpage>234</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">31075224</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>T</given-names></string-name>, <string-name><surname>Bai</surname><given-names>J</given-names></string-name>, <string-name><surname>Nabavi</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell classification using graph convolutional networks</article-title>. <source>BMC Bioinformatics</source><year>2021</year>;<volume>22</volume>:<fpage>364</fpage>.<pub-id pub-id-type="pmid">34238220</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wen</surname><given-names>L</given-names></string-name>, <string-name><surname>Tang</surname><given-names>F.</given-names></string-name></person-group><article-title>Single-cell sequencing in stem cell biology</article-title>. <source>Genome Biol</source><year>2016</year>;<volume>17</volume>:<fpage>71</fpage>.<pub-id pub-id-type="pmid">27083874</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xie</surname><given-names>P</given-names></string-name>, <string-name><surname>Gao</surname><given-names>M</given-names></string-name>, <string-name><surname>Wang</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>SuperCT: a supervised-learning framework for enhanced characterization of single-cell transcriptomic profiles</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>e48</fpage>.<pub-id pub-id-type="pmid">30799483</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>F</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Wang</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>scBERT as a large-scale pretrained deep language model for cell type annotation of single-cell RNA-seq data</article-title>. <source>Nat Mach Intell</source><year>2022</year>;<volume>4</volume>:<fpage>852</fpage>–<lpage>66</lpage>.</mixed-citation>
    </ref>
    <ref id="btad521-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yin</surname><given-names>Q</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Guan</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>scIAE: an integrative autoencoder-based ensemble classification framework for single-cell RNA-seq data</article-title>. <source>Brief. Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>bbab508</fpage>.<pub-id pub-id-type="pmid">34913057</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>AW</given-names></string-name>, <string-name><surname>O'Flanagan</surname><given-names>C</given-names></string-name>, <string-name><surname>Chavez</surname><given-names>EA</given-names></string-name></person-group><etal>et al</etal><article-title>Probabilistic cell-type assignment of single-cell RNA-seq for tumor microenvironment profiling</article-title>. <source>Nat Methods</source><year>2019a</year>;<volume>16</volume>:<fpage>1007</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">31501550</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>X</given-names></string-name>, <string-name><surname>Lan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>CellMarker: a manually curated resource of cell markers in human and mouse</article-title>. <source>Nucleic Acids Res</source><year>2019b</year>;<volume>47</volume>:<fpage>D721</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30289549</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>F</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>scMAGIC: accurately annotating single cells using two rounds of reference-based classification</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>e43</fpage>.<pub-id pub-id-type="pmid">34986249</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>GXY</given-names></string-name>, <string-name><surname>Terry</surname><given-names>JM</given-names></string-name>, <string-name><surname>Belgrader</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat Commun</source><year>2017</year>;<volume>8</volume>:<fpage>14049</fpage>.<pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10477937</article-id>
    <article-id pub-id-type="pmid">37610325</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btad521</article-id>
    <article-id pub-id-type="publisher-id">btad521</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Databases and Ontologies</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CellAnn: a comprehensive, super-fast, and user-friendly single-cell annotation web server</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9996-826X</contrib-id>
        <name>
          <surname>Lyu</surname>
          <given-names>Pin</given-names>
        </name>
        <aff><institution>Department of Ophthalmology, Johns Hopkins University School of Medicine</institution>, Baltimore, MD 21287, <country country="US">United States</country></aff>
        <xref rid="btad521-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhai</surname>
          <given-names>Yijie</given-names>
        </name>
        <aff><institution>Department of Ophthalmology, Johns Hopkins University School of Medicine</institution>, Baltimore, MD 21287, <country country="US">United States</country></aff>
        <xref rid="btad521-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6624-9293</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Taibo</given-names>
        </name>
        <aff><institution>Department of Biomedical Engineering, Johns Hopkins University School of Medicine</institution>, Baltimore, MD 21218, <country country="US">United States</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0476-3596</contrib-id>
        <name>
          <surname>Qian</surname>
          <given-names>Jiang</given-names>
        </name>
        <aff><institution>Department of Ophthalmology, Johns Hopkins University School of Medicine</institution>, Baltimore, MD 21287, <country country="US">United States</country></aff>
        <xref rid="btad521-cor1" ref-type="corresp"/>
        <!--jiang.qian@jhmi.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Robinson</surname>
          <given-names>Peter</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btad521-cor1">Corresponding author. Department of Ophthalmology, Johns Hopkins University School of Medicine, Baltimore, MD 21287, United States. E-mail: <email>jiang.qian@jhmi.edu</email> (J.Q.)</corresp>
      <fn id="btad521-FM1">
        <p>Pin Lyu, Yijie Zhai. Equal contribution.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-08-23">
      <day>23</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <volume>39</volume>
    <issue>9</issue>
    <elocation-id>btad521</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>17</day>
        <month>7</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>16</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>8</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>05</day>
        <month>9</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btad521.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single-cell sequencing technology has become a routine in studying many biological problems. A core step of analyzing single-cell data is the assignment of cell clusters to specific cell types. Reference-based methods are proposed for predicting cell types for single-cell clusters. However, the scalability and lack of preprocessed reference datasets prevent them from being practical and easy to use.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we introduce a reference-based cell annotation web server, CellAnn, which is super-fast and easy to use. CellAnn contains a comprehensive reference database with 204 human and 191 mouse single-cell datasets. These reference datasets cover 32 organs. Furthermore, we developed a cluster-to-cluster alignment method to transfer cell labels from the reference to the query datasets, which is superior to the existing methods with higher accuracy and higher scalability. Finally, CellAnn is an online tool that integrates all the procedures in cell annotation, including reference searching, transferring cell labels, visualizing results, and harmonizing cell annotation labels. Through the user-friendly interface, users can identify the best annotation by cross-validating with multiple reference datasets. We believe that CellAnn can greatly facilitate single-cell sequencing data analysis.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The web server is available at <ext-link xlink:href="http://www.cellann.io" ext-link-type="uri">www.cellann.io</ext-link>, and the source code is available at <ext-link xlink:href="https://github.com/Pinlyu3/CellAnn_shinyapp" ext-link-type="uri">https://github.com/Pinlyu3/CellAnn_shinyapp</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institutes of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01EY029548</award-id>
        <award-id>P30EY00176</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell RNA-sequencing (scRNA-seq) is a genomic method to detect gene expression levels at the single-cell level. Even though it was invented &lt;10 years ago, it has been widely used to identify novel cell types and cell heterogeneity during development and disease (<xref rid="btad521-B27" ref-type="bibr">Saliba <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="btad521-B33" ref-type="bibr">Wen and Tang 2016</xref>; <xref rid="btad521-B4" ref-type="bibr">Baslan and Hicks 2017</xref>; <xref rid="btad521-B23" ref-type="bibr">Ofengeim <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="btad521-B26" ref-type="bibr">Rozenblatt-Rosen <italic toggle="yes">et al.</italic> 2017</xref>; <xref rid="btad521-B25" ref-type="bibr">Potter 2018</xref>). The common practice in scRNA-seq data analysis is first to cluster the cells based on the similarity of the gene expression profiles in each cell. The next step is cell annotation, assigning the specific cell types to the clusters. Even though cell annotation is essential to understand the biological properties of the cells, it is challenging because it requires domain knowledge in specific cells or tissues.</p>
    <p>Two major approaches exist for cell annotation. One approach utilizes the known marker genes for specific cell types. Marker genes can be found in online databases such as CellMarker (<xref rid="btad521-B38" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2019b</xref>) and PanglaoDB (<xref rid="btad521-B6" ref-type="bibr">Franzén <italic toggle="yes">et al.</italic> 2019</xref>). Popular methods in this category include ScType (<xref rid="btad521-B14" ref-type="bibr">Ianevski <italic toggle="yes">et al.</italic> 2022</xref>), scSorter (<xref rid="btad521-B9" ref-type="bibr">Guo and Li 2021</xref>), CellAssign (<xref rid="btad521-B37" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2019a</xref>), and scCATCH (<xref rid="btad521-B28" ref-type="bibr">Shao <italic toggle="yes">et al.</italic> 2020</xref>). However, this approach is not always successful due to the limited knowledge of marker genes of some cell types. For example, some poorly studied cell types have very few or no marker genes. In addition, some known marker genes might not be specific to a cell type as expected. The second type of cell annotation approach is based on the reference datasets. Several methods have been developed for this purpose, including scClassify (<xref rid="btad521-B19" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2020</xref>), Scibet (<xref rid="btad521-B18" ref-type="bibr">Li <italic toggle="yes">et al.</italic> 2020</xref>), singleCellNet (<xref rid="btad521-B30" ref-type="bibr">Tan and Cahan 2019</xref>), scMAGIC (<xref rid="btad521-B39" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic> 2022</xref>), and singleR (<xref rid="btad521-B3" ref-type="bibr">Aran <italic toggle="yes">et al.</italic> 2019</xref>). This type of approach takes advantage of the published datasets that were carefully studied by domain experts. Instead of explicitly extracting the marker genes associated with each cluster, the cell types are characterized by the gene expression profiles defined by many variable genes. By comparing the expression profiles of query clusters and annotated reference datasets, the cell types can be “borrowed” from the reference datasets if the gene expression profiles of the query and reference are similar enough.</p>
    <p>A good reference-based cell annotation system should have the following desirable features. First, we need a large set of preprocessed reference datasets, which makes it easy for the users to find the relevant reference datasets for their query dataset. Unfortunately, most available tools rely on the users to identify, download and process the reference dataset before the users can perform the analysis. Second, a good annotation system should not require sophisticated computational skills to run the task. However, most reference-based methods require users to install the tools on their computers. Some tools are only available in specific computational languages such as Python or R. Third, an ideal method should run fast even with large reference or query datasets, and it should not require a large computer memory. Some advanced methods, such as those employing deep learning approaches, have been developed and have a good performance [scBERT (<xref rid="btad521-B35" ref-type="bibr">Yang <italic toggle="yes">et al.</italic> 2022</xref>), scDeepSort (<xref rid="btad521-B29" ref-type="bibr">Shao <italic toggle="yes">et al.</italic> 2021</xref>), ACTINN (<xref rid="btad521-B22" ref-type="bibr">Ma and Pellegrini 2020</xref>), sigGCN (<xref rid="btad521-B32" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> 2021</xref>), scIAE (<xref rid="btad521-B36" ref-type="bibr">Yin <italic toggle="yes">et al.</italic> 2022</xref>), scNym (<xref rid="btad521-B41" ref-type="bibr">Kimmel and Kelley, 2021</xref>), SuperCT (<xref rid="btad521-B34" ref-type="bibr">Xie <italic toggle="yes">et al.</italic> 2019</xref>), and EnClaSC (<xref rid="btad521-B5" ref-type="bibr">Chen <italic toggle="yes">et al.</italic> 2020</xref>)]. However, these methods are often slow and require large memories and computing resources, making them not suitable for an online tool. Furthermore, many single-cell datasets are generated from droplet-based platforms, which typically include cells on the scale of hundreds of thousands or larger (<xref rid="btad521-B21" ref-type="bibr">Macosko <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="btad521-B40" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2017</xref>). The runtime required by several widely used tools to analyze datasets of &lt;10k cells can range from tens of seconds to several days, especially for those that predict the cell types at the single-cell level rather than at the cluster level (<xref rid="btad521-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic> 2019</xref>; <xref rid="btad521-B13" ref-type="bibr">Huang <italic toggle="yes">et al.</italic> 2021</xref>).</p>
    <p>In this work, we present a new cell annotation system, CellAnn. The system includes more than 350 preprocessed reference datasets, including the major tissue types in human and mouse. Users can easily search the relevant reference datasets for comparison. Furthermore, a newly designed algorithm can produce the results with high accuracy and high speed. Our algorithm assigns the cell types to single-cell clusters, and therefore, the analysis can be done very fast. We assessed the performance of our algorithm and showed it is superior to existing methods. Finally, all the analyses are done on a user-friendly online web server, which is available at <ext-link xlink:href="http://www.cellann.io" ext-link-type="uri">www.cellann.io</ext-link>.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Data structure</title>
      <p>The usage of CellAnn is straightforward. First, users can upload the average gene expression for each cluster (gene by cluster matrix) to the system (<xref rid="btad521-F1" ref-type="fig">Fig. 1</xref>; Step 1). Then users can search the CellAnn database for one or multiple references within the selected tissue type(s), such as “retina” or “liver” (Step 2). The system will then compare the query dataset to the selected reference dataset(s), and the cell annotation results will be generated and made available for download (Step 3). If users wish to visualize the results, they may upload a single-cell coordinate file. The results of the cell annotation and marked gene expression patterns can then be viewed and examined (Step 4).</p>
      <fig position="float" id="btad521-F1">
        <label>Figure 1.</label>
        <caption>
          <p>Schematic diagram of the CellAnn workflow. CellAnn has four major steps. (A) uploading the gene expression profile of the query clusters, (B) selecting references in the CellAnn database, (C) predicting cell types based on the selected references, and (D) checking marker gene expression patterns, harmonizing multiple predicted cell type labels, and downloading the final result.</p>
        </caption>
        <graphic xlink:href="btad521f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Source of CellAnn database</title>
      <p>We downloaded the raw gene expression matrix and author-annotated cell type information from UCSC Cell Browser (cells.ucsc.edu), Single Cell Portal (singlecell.broadinstitute.org), CELLxGENE (cellxgene.cziscience.com), and GEO (Gene Expression Omnibus). We also collected single-cell atlas datasets from HCL (<ext-link xlink:href="https://db.cngb.org/HCL/" ext-link-type="uri">https://db.cngb.org/HCL/</ext-link>) and MCL (<ext-link xlink:href="https://bis.zju.edu.cn/MCA/" ext-link-type="uri">https://bis.zju.edu.cn/MCA/</ext-link>). We selected a diverse set of data that covered as many tissue types as possible. For a given tissue type, we preferred large datasets with many cell types. We did not include the datasets from diseased samples (e.g. cancers) in the current version.</p>
    </sec>
    <sec>
      <title>2.3 CellAnn query dataset preparation</title>
      <p>To calculate the average gene expression profiles for each user-defined cluster, we summed up the raw gene expression counts of all cells for each cluster, normalized the gene expression by total counts, multiplied by a scale factor of 1e5, and took the natural logarithm of the obtained values [log(<italic toggle="yes">x</italic> + 1)]. We also provide tutorials and source code on the GitHub page of CellAnn for both Seurat and Scanpy users (<ext-link xlink:href="https://github.com/Pinlyu3/CellAnn_shinyapp" ext-link-type="uri">https://github.com/Pinlyu3/CellAnn_shinyapp</ext-link>).</p>
    </sec>
    <sec>
      <title>2.4 CellAnn reference dataset preparation</title>
      <p>All the references in the CellAnn database are processed with the following steps:</p>
      <list list-type="alpha-lower">
        <list-item>
          <p>Preprocessing: First, after downloading the expression matrix and annotation, we split some huge single-cell atlas (e.g. “HCL,” “Tabula Muris”) into several smaller datasets by tissue types. Next, we harmonized the gene names for each dataset. If the gene names are not the official gene symbol, we convert them to the GENCODE 42 (Human) and GENCODE M31 (Mouse) gene annotations. Then, we normalize the gene expression values of each cell by its total expression, multiply the result by a scale factor (1e5), and take the natural logarithm of the obtained values (log(<italic toggle="yes">x</italic>+1)).</p>
        </list-item>
        <list-item>
          <p>Preparing the reference-specific background reference dataset: We introduce the background reference because it can be used to calibrate the similarity between the query dataset and selected reference datasets. For each reference dataset, we integrate it with single-cell atlas datasets (i.e. background) to obtain more specific marker genes and comparable expression values across all tissues. For human references, we used the “HCL” or “Tabula Sapiens” datasets as a background, and for mouse references, we used the “MCL” or “Tabula Muris” datasets as a background.</p>
          <p>Since our analysis will be performed at the cluster level, we calculate the average gene expression level for the clusters in the background and the reference dataset. First, we used the “scVI” software (<xref rid="btad521-B20" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic> 2018</xref>) from scvi-tools (<xref rid="btad521-B8" ref-type="bibr">Gayoso et al.</xref>) to remove the batch effect between the reference and background datasets at the single-cell level. After integration, we obtained a combined dimension space and a combined, corrected cell-by-gene matrix that included all the single cells from the given reference and the background.</p>
          <p>Next, we obtain new clusters with all cells from both background and a reference dataset on the combined “scVI” dimension space using “FindNeighbors” and “FindClusters” functions from Seurat. We then calculated the average expression matrix of these new clusters using the combined, corrected single-cell gene expression matrix. The average expression matrix of the new clusters is denoted as Eb, in which rows represent genes and columns represent combined clusters.</p>
          <p>Next, we calculate the corrected average expression values of all the cell types in the selected reference datasets based on the combined clusters. For some cell types in the reference, the cells might be distributed to different clusters after the new clustering. For each given cell type in the reference, we calculate the percentage of cells in the new clusters and obtain a matrix of percentage, Wb, in which rows represent background clusters and columns represent the cell types in reference. Then, we calculate the cross product of matrix Eb and Wb to obtain the corrected expression matrix, Er, in which rows are genes and columns are the cell types in reference.</p>
          <p>Finally, we used the “COSG” package to identify marker genes across all the background clusters (denoted as bg-Markers), which will be used to calculate the correlation coefficient of gene expression between query and reference-specific background.</p>
        </list-item>
        <list-item>
          <p>Preparing the refined references: In some studies, authors may label multiple adjacent clusters as a single major cell type. Therefore, using the average expression of these major cell types may ignore the variance of the sub-cell types and confuse downstream analyses. To improve the sensitivity of our analysis, we first split the entire reference dataset by major cell types with the function “SplitObject.” Then, we re-performed clustering analysis for each split dataset using author-provided cell similarity graphs such as “UMAP” or “t-SNE.” If the authors do not provide the coordinate information, we calculate the UMAPs by the standard Seurat workflow. Next, we use the “FindNeighbors” and “FindClusters” functions with a resolution parameter of 0.3 to obtain refined clusters and label them as sub-cell types. Next, we get the average expression matrix (denoted as Ersub) by summing the raw counts in each sub-cluster and normalizing the expression value as described before. Finally, we calculate marker genes for original clusters (denoted as main-Markers) and sub-clusters (denoted as sub-Markers) using the “COSG” package.</p>
        </list-item>
      </list>
    </sec>
    <sec>
      <title>2.5 Harmonize gene names between species</title>
      <p>CellAnn enables users to perform cell type prediction across species. After uploading a gene expression matrix, CellAnn employs a predictive algorithm to determine the species from which the query dataset originates. This is accomplished by computing the overlap ratio of gene symbols between the input matrix and human or mouse gene annotations obtained from GENCODE 42 and GENCODE M31, respectively. If the ratio of overlapping genes exceeds 50% for either human or mouse gene symbols, CellAnn will label the query data with the corresponding species. If fewer than 50% of genes overlap, CellAnn will issue a “Warning” message, prompting the user to review their input files. In cases where the query data and reference datasets are from different species, CellAnn automatically converts gene names in the query data to enable compatibility with the reference datasets. The orthologous genes file is downloaded from the database (<ext-link xlink:href="http://www.informatics.jax.org" ext-link-type="uri">http://www.informatics.jax.org</ext-link>).</p>
    </sec>
    <sec>
      <title>2.6 Comparison algorithm of CellAnn</title>
      <p>We develop an algorithm to compare a query dataset and a selected reference dataset. The algorithm consists of 3 modules (<xref rid="btad521-F2" ref-type="fig">Fig. 2A</xref>).</p>
      <fig position="float" id="btad521-F2">
        <label>Figure 2.</label>
        <caption>
          <p>The algorithm design of CellAnn. (A) The CellAnn algorithm consists of three modules: (1) Module 1: CellAnn calculates the correlations between query clusters and clusters in reference and background. The cutoff is estimated based on the correlation between query clusters and background references. (2) Module 2: CellAnn calculates the correlations and estimates correlation cutoffs between the query data and sub-clusters in reference datasets. (3) Module 3: CellAnn performs the Wilcoxon rank-sum test to determine cell types further if a query cluster is similar to multiple sub-clusters in the reference.</p>
        </caption>
        <graphic xlink:href="btad521f2" position="float"/>
      </fig>
      <p>Module 1. We first determine a cutoff from the comparison of background and query datasets. To do so, we compute correlations between the query clusters (Eq) and background reference datasets (Eb) with the expression value of bg-Markers. We obtain nb *nq coefficient values, where nb and nq equal the number of clusters in the background and query, respectively. We then obtain a distribution of the nb *nq correlation coefficients. Since the background reference contains a diverse set of tissue types, most query cluster-background cluster pairs are from different cell types. We assume that the observed distribution composes a negative distribution (from pairs with different cell types) and a positive distribution (from pairs with the same cell types).</p>
      <p>Based on the assumption, we decompose the density distribution into one to three Gaussian distributions using the mclust package in R. If the observed distribution is better fitted by only one Gaussian distribution, the distribution is considered from different cell types. We then set the correlation cutoff as the point whose cumulative probability exceeds 0.75 in the distribution. If two or three Gaussian distributions can better explain the observed distribution, the distribution with the largest μ is considered from the same cell types, and the remaining distributions are considered from different cell types. For two Gaussian distributions, we set the intersection point as cutoff. For three Gaussian distributions, we set the cutoff as the point whose cumulative probability exceeds 0.75 in the second distribution. Finally, to avoid the extreme cutoff values, we set the minimal and maximal cutoff values to 0.4 and 0.6, respectively, if the obtained cutoff falls out the range of 0.4–0.6.</p>
      <p>We then calculate the correlations between the query clusters (Eq) and reference datasets (Er) according to the expression value of bg-Markers. For a given query cluster, if all its correlations with reference cell types are lower than the cutoff, we label it as an “unassigned” cluster. Otherwise, we go to next Module.</p>
      <p>Module 2. We next calculate the pairwise correlation coefficients between the query clusters (Eq) and the sub-clusters (Er-sub) in the reference (<xref rid="btad521-F2" ref-type="fig">Fig. 2A</xref>, step 2) according to the expression value of main-Markers. We then obtain a distribution of the coefficients. Similar to the above module, we fit the distribution with one to three Gaussian distributions and determine a cutoff for this specific query dataset. For each query cluster, if the maximal coefficient with the sub-clusters in the selected reference is below the cutoff, the query cluster will be assigned as “unassigned.” If only one correlation coefficient for a given query cluster is above the cutoff, the query cluster is assigned to the cell type associated with the sub-cluster in the reference. If more than one coefficient is above the cutoff, especially if the matched sub-clusters belong to different cell types in the original annotation, we go to next Module.</p>
      <p>Module 3. We perform additional statistical tests to determine the cell type of the query cluster. First, we select the top three sub-clusters whose correlations are larger than the cutoff. Next, we extract the marker genes of the top three sub-clusters from the sub-Markers list. Then, we use the Wilcoxon Rank-Sum test to make pairwise comparisons among these three groups of marker genes to check whether their expression values are significantly higher than the others in the query cluster. Based on the statistical results, we assign the cell type of the sub-cluster with the highest significance as the predicted cell type of the given query cluster.</p>
    </sec>
    <sec>
      <title>2.7 Evaluation of computational scalability</title>
      <p>To measure the computational resources required for running CellAnn and other comparable methods, we simulate a query and several reference samples with different sizes from the PBMC datasets. We first downloaded PBMC data from the single-cell portal (SCP424). The original datasets contain a total of 31 021 cells from 8 different sequencing libraries. We use the “inDrops” PBMC datasets as the query datasets. For reference datasets, we perform downsampling from entire dataset with sizes of 1k, 5k, 10k, 15k, 20k, and 25k.</p>
      <p>We use the function “system.time()” in R to evaluate the running time of all the methods. In addition, we use the R package “Bench” to measure the maximum memory usage when running all the software. All the efficiency tests were performed on a Linux server with Intel(R) Xeon(R) Gold 6126 CPU processors and 790 GB physical memory.</p>
    </sec>
    <sec>
      <title>2.8 Comparison with other cell annotation methods</title>
      <p>We compare CellAnn with five competing methods, including scmap, CHETAH, scClassify, scPred, and Seurat v4. To compare the methods, we have prepared a total of 52 benchmark tests using the “Tabula Muris” single-cell atlas dataset. The “Tabula Muris” single-cell atlas contains single-cell data from different tissues that were sequenced using two different platforms: fluorescence-activated cell sorting (FACS) and droplet-based sequencing (droplet). We often use datasets from one platform as a reference and predict the cell types in datasets generated from another platform.</p>
      <p>We prepared both cell- and cluster-based inputs for these competing methods as follows. For CHETAH, scClassify, scPred, and Seurat v4, both the query and reference datasets are single-cell datasets. We use the log-normalized raw-counts matrix as the cell-based expression profiles for both query and reference datasets in these methods. For scmap, the query datasets are cluster-based expression profiles, while the reference datasets are single-cell-based expression profiles. To prepare the cluster-based inputs, we re-performed clustering analysis with Seurat for each cell type in the query dataset and calculated the average expression profile of all the new clusters. For CellAnn, the query and reference datasets are both cluster-based expression profiles. The background of the query dataset is “Tabula Muris” datasets.</p>
      <p>We used the following parameters for these methods. In scmap-cluster, we set the similarity threshold to 0.5, and cells with a predicted score below this threshold were labeled as “unassigned.” In Seurat V4, default settings were used to find anchors between the query and reference datasets. The number of principal components was set to 50, and cells with a predicted score &lt; 0.5 were also categorized as “unassigned.” For scClassify, we constructed the hierarchical tree using the “HC” method and classified the ensemble model using the “WKNN” method. The “limma” method was used to select genes, and both the “Pearson” and “cosine” methods were employed to measure the similarity between single cells. In CHETAH, we used all default parameters to train the model and make predictions for the query datasets. In scPred, we trained the reference datasets using the “svmRadial” model and set the threshold for probabilities to classify cells into groups at 0.55; cells below this threshold were labeled as “unassigned.” Finally, in CellAnn, we did not adjust any parameters during comparison, and default settings were used.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Reference dataset collection</title>
      <p>Cellann database contains 204 and 191 nonredundant scRNA-seq datasets for humans and mice, respectively. The number of associated studies (papers) of these datasets in CellAnn is significantly larger than other reference-based annotation tools (<xref rid="btad521-F3" ref-type="fig">Fig. 3A and B</xref>). For example, CellAnn contains single datasets from more than 109 (36) papers in Human (Mouse). However, scClassify, Scibet, singleCellNet, and singleR, four representative reference-based cell annotation databases, include only 11(5), 31(17), 6(6), and 19(26) papers, respectively (<xref rid="btad521-F3" ref-type="fig">Fig. 3A</xref>).</p>
      <fig position="float" id="btad521-F3">
        <label>Figure 3.</label>
        <caption>
          <p>Reference datasets included in CellAnn. The bar plot compares the available datasets for each organ type in human (A) and mouse (B) included in the CellAnn database and other reference-based cell annotation web services. The <italic toggle="yes">x</italic>-axis represents different organs, and the <italic toggle="yes">y</italic>-axis represents the number of papers related to the corresponding organs.</p>
        </caption>
        <graphic xlink:href="btad521f3" position="float"/>
      </fig>
      <p>The reference datasets cover most of the major tissue types in the two species. Some tissue types are well-studied, such as the brain, blood, airway, and lung. Therefore, more datasets were obtained from these tissues. Most of the collected tissue types have more than one single-cell datasets, allowing for multiple-reference comparison with the query dataset.</p>
    </sec>
    <sec>
      <title>3.2 Algorithm performance</title>
      <p>We first evaluate the performance of our comparison algorithm (<xref rid="btad521-F4" ref-type="fig">Fig. 4</xref>). Using annotation in the reference dataset as ground truth, we have six outcomes: correctly classified, partially correctly classified, correctly unclassified, failed classified, wrongly classified, and wrongly unclassified (<xref rid="btad521-F4" ref-type="fig">Fig. 4A</xref>). The first three are considered correct predictions, while the latter three are wrong predictions.</p>
      <fig position="float" id="btad521-F4">
        <label>Figure 4.</label>
        <caption>
          <p>The performance and scalability of CellAnn. (A) Evaluation framework of CellAnn. According to the author’s annotation, predictions are classified into “Correct Classified,” “Correct Classified (Partially),” “Wrong Classified,” “Failed Classified,” “Wrong Unclassified,” or “Correct Unclassified.” (B) The benchmark results of 56 testing pairs for 6 different methods. Each bar indicates the composition of predicted cell types. Based on the overlapping of cell types between query and reference datasets, we divided these test pairs into four groups: type 1, type 2, type 3, and type 4. The Venn diagrams on the left show the relationships of type 1–type 4. (C) The bar plots indicate the composition of predicted categories of the average performance in a collection of reference–testing pairs. (D) Benchmarking the efficiency of CellAnn. Left: the line plot shows the running time under the default settings of each algorithm. Right: the line plot shows the peak memory usage of each algorithm. The <italic toggle="yes">x</italic>-axis is labeled by the number of cells and the clusters in the references. The curves are truncated if a method is not scalable to a certain size of the references.</p>
        </caption>
        <graphic xlink:href="btad521f4" position="float"/>
      </fig>
      <p>To comprehensively assess the performance of our method, we tested four types of situations (<xref rid="btad521-F4" ref-type="fig">Fig. 4B</xref>). In Type 1, the cell types in the query and reference datasets are exactly the same but from different platforms. In Type 2, the cell types in the query are the subset of the cell types in the reference. For the first two types, we expect, in the ideal situation, to find all the cell types for the query clusters. In Type 3, the cell types in the reference are the subset of the cell types in the query. Some query clusters are not expected to have an assignment (i.e. unclassified). In Type 4, the cell types in the query and reference are not overlapped. All the query clusters should be unassigned. The performance in Types 3 and 4 comparison is critical for a database search because the users might select remotely similar or even irrelevant datasets as references.</p>
      <p>We compared our algorithm with popular cell annotation methods, including Scmap-cluster (<xref rid="btad521-B17" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic> 2018</xref>), CHEATAH (<xref rid="btad521-B15" ref-type="bibr">de Kanter <italic toggle="yes">et al.</italic> 2019</xref>), Seurat (<xref rid="btad521-B11" ref-type="bibr">Hao <italic toggle="yes">et al.</italic> 2021</xref>), SCPred (<xref rid="btad521-B2" ref-type="bibr">Alquicira-Hernandez <italic toggle="yes">et al.</italic> 2019</xref>), and scClassify (<xref rid="btad521-B19" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2020</xref>) (<xref rid="btad521-F4" ref-type="fig">Fig. 4B and C</xref>). The performance of our algorithm in Type I comparison is comparable with Seurat, SCPred, and scClassify. They all achieved ∼0.99 correct predictions. However, Scmap-cluster and CHEATAH have lower success rates of 0.90 and 0.71, respectively. In Type 2, CellAnn reached a success rate of 0.94, outperforming other methods. Furthermore, for types 3 and 4, CellAnn still has a good success rate. However, CHEATAH, which has worse performance in the types 1 and 2 comparisons, has a relatively good success rate in types 3 and 4. This might be due to a more stringent cutoff selection for CHEATAH. In contrast, CellAnn uses an automatic query-specific cutoff selection, which might be the reason for a high success rate in all types of comparisons.</p>
    </sec>
    <sec>
      <title>3.3 Speed and memory use</title>
      <p>We then assess the speed and memory used for CellAnn and other existing methods. We use the reference datasets with different cell numbers and different numbers of clusters, ranging from 1k to 25k cells and from 28 to 61 cell clusters (<xref rid="btad521-F4" ref-type="fig">Fig. 4D</xref>). CellAnn is the fastest and finishes the jobs within 10 s, making it suitable for an online cell annotation tool. Seurat and Scmap-cluster are also fast, finishing the jobs within minutes. The other three methods, CHETAH, scClassify, and scPred are suitable small reference datasets.</p>
      <p>Similarly, CellAnn is also efficient in memory use because it is a cluster-based, rather than a cell-based approach (<xref rid="btad521-F4" ref-type="fig">Fig. 4D</xref>). The peak memory required for Cell Ann is around 1 GB with the largest dataset (25k cells). Seurat requires around 5 GB for the largest reference dataset. The memory needed for other methods easily exceeds 10 GB if the reference datasets contain more than 25k cells.</p>
    </sec>
    <sec>
      <title>3.4 Case study</title>
      <p>Multiple reference datasets can provide a more confident annotation. Here we use an example to demonstrate its usage. We used one published human retina dataset as input (<xref rid="btad521-B31" ref-type="bibr">Voigt <italic toggle="yes">et al.</italic> 2019</xref>), which included 43 clusters (<xref rid="btad521-F5" ref-type="fig">Fig. 5A</xref>). We then selected four relevant datasets as references (<xref rid="btad521-B10" ref-type="bibr">Han <italic toggle="yes">et al.</italic> 2020</xref>; <xref rid="btad521-B12" ref-type="bibr">Hoang <italic toggle="yes">et al.</italic> 2020</xref>; <xref rid="btad521-B24" ref-type="bibr">Orozco <italic toggle="yes">et al.</italic> 2020</xref>; <xref rid="btad521-B7" ref-type="bibr">Gautam <italic toggle="yes">et al.</italic> 2021</xref>) (<xref rid="btad521-F5" ref-type="fig">Fig. 5B</xref>). The references have three datasets from the human retina or eye and one dataset from mouse retina. Using default parameters, we obtained the predicted cell annotation for the 43 input clusters (<xref rid="btad521-F5" ref-type="fig">Fig. 5C</xref>). The cell type labels from the four datasets could be different. For example, both “bipolar” and “BP” refer to the same cell type, while “Muller glia,” “Muller,” and “Resting MG” are the Muller glia cell type. Overall, the annotation from different references is consistent, increasing our confidence level in the cell annotation. However, some clusters have inconsistent annotations (see highlighted blue boxes in <xref rid="btad521-F5" ref-type="fig">Fig. 5C</xref>). The top marker genes of the clusters obtained from the reference can be used to choose the winners of the annotations for the input clusters. The second to the last column is our summary annotation after integrating the prediction from the four references, while the last column shows the original annotation from the published input dataset. The agreement between the prediction and the original annotation suggested the high quality of the predicted annotation.</p>
      <fig position="float" id="btad521-F5">
        <label>Figure 5.</label>
        <caption>
          <p>A case study on cell type annotation with multiple references using CellAnn. (A) The UMAP plots show the query data and four different reference datasets. The cells in the query data are colored by clusters, and the cells in the reference datasets are colored based on the author's cell type annotation. (B) The comparisons of alignment results by CellAnn with the author's annotation in the query datasets. The left panel displays a table that shows the predicted cell type labels by CellAnn. The right panel displays UMAP plots of the query datasets, with the predicted annotation and the author's original annotation. (C) The marker gene expression levels in both query and reference datasets, help the users to select the cell type when the results from multiple reference datasets are inconsistent.</p>
        </caption>
        <graphic xlink:href="btad521f5" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.5 User interface</title>
      <p>We have designed an interactive web server for CellAnn (<ext-link xlink:href="http://www.cellann.io" ext-link-type="uri">www.cellann.io</ext-link>). To use the server, users first perform clustering analysis using other methods (e.g. Seurat), and calculate the average expression profiles for the clusters. Users can then upload the cluster versus gene matrix to the server (<xref rid="btad521-F6" ref-type="fig">Fig. 6</xref>). The server will automatically check the number of clusters, genes, and species based on the user's input file. If the user's input is correct, users will be able to proceed to the next step. Otherwise, a warning message will be shown.</p>
      <fig position="float" id="btad521-F6">
        <label>Figure 6.</label>
        <caption>
          <p>Example webpages associated with each step of the analysis. (A) Step 1: a window for uploading expression profiles of query data (1). (B) Step 2: a table for searching and selecting datasets in CellAnn (2), and a table for reviewing the selected datasets (3). (C) Step 3: a window for running CellAnn and tuning parameters (4). a table for downloading predicted cell types (5). (D) Step 4: a window for uploading coordinate profiles (6), a search window for alignment results and related marker genes (7), UMAPs for query and reference data that are colored by cluster, predicted cell type, author's annotation (for reference), and gene expression values (8), and a downloadable and editable table that users can review to see predictions and add their own custom annotations (9).</p>
        </caption>
        <graphic xlink:href="btad521f6" position="float"/>
      </fig>
      <p>Users are able to select one or more relevant datasets as references. The current version of CellAnn contains 204 human and 191 mouse single-cell datasets, respectively. To facilitate the identification of relevant datasets, we have organized the datasets into 32 organs. Users can search for the relevant datasets by organ. We also provide a preview button for each dataset, allowing users to preview the dimension plot for each study and check which cell types are included in the reference dataset.</p>
      <p>The users can then run the analysis. While the whole analysis procedure is automatic, users also have the option to set the range of cutoff values in the user interface. The default range for the cutoff value is 0.4 to 0.6. The analysis results will be presented in a table format.</p>
      <p>The final step is optional. If users upload an additional file with the cell clustering coordinates, we will provide the visualization of the annotation analysis. As an independent validation, users can also select marker genes for a particular cluster from reference clusters and examine the expression level of the genes in query clusters.</p>
      <p>CellAnn is a freely accessible web server available at <ext-link xlink:href="http://www.cellann.io" ext-link-type="uri">www.cellann.io</ext-link>. The help page of the web server provides brief documentation. CellAnn is compatible with all commonly used web browsers, including Safari, Chrome, Opera, Firefox, and Microsoft Edge. The underlying data of CellAnn is also freely accessible on the GitHub page of the web server.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We develop a method, CellAnn, for single-cell annotation. The method has the following unique advantages. First, it is a cluster-based algorithm. Compared to cell-based methods, it is very fast. This is important, especially if we want to compare multiple reference datasets. Second, it contains many preprocessed single-cell datasets as references. The large collection of references makes it convenient to use and saves a lot of time for the users. Third, the performance of our algorithm is robust. One reason for the robustness is that we introduce a background reference and use it to calibrate the choice of the cutoff.</p>
    <p>One interesting question is whether the cell types are discrete or continuous. A cell type will undergo transcriptomic changes under certain conditions, such as disease and aging. Should we consider them as the same cell types or annotate them as distinct diseased- or aged-cell types? In the current version of CellAnn, we did not include the datasets with diseases (e.g. cancers). We plan to include more datasets in the next version so that the users will obtain not only the predicted cell types but also the associated conditions.</p>
    <p>If users selected multiple reference datasets, we presented the predicted cell types from each reference dataset and did not provide a consensus score or an “averaged” result from the multiple reference datasets. There are several practical issues for this approach. First, we do not want to adopt a voting strategy to provide an averaged result because the quality of the datasets is not the same. Second, the reference datasets might use different cell type nomenclatures and make it difficult to “average” the results. For example, “Muller glia,” “Muller,” and “MG” are the same cell type, and “photoreceptor,” “rods,” and “cones” could be the same cell type, too. To make things more complicated, “MG-1,” “MG-resting,” and “MG-activated” could be the Muller glia at different conditions. Therefore, we decided to keep the original annotation from the publications and not try to standardize the cell-type annotation.</p>
    <p>One potential problem for the reference-based methods is that the methods rely on the quality of reference datasets and the query dataset. The low quality of the query dataset or incorrect annotation in the reference datasets will cause false predictions. We will keep updating the database when new datasets become available and believe that adding new datasets will make CellAnn even more powerful.</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We thank Drs Ming-wen Hu, Yang Jin, and Seth Blachshaw for suggestions and comments.</p>
  </ack>
  <sec sec-type="COI-statement">
    <title>Conflict of interest</title>
    <p>None declared.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the National Institutes of Health [R01EY029548, P30EY00176 to J.Q.].</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btad521-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdelaal</surname><given-names>T</given-names></string-name>, <string-name><surname>Michielsen</surname><given-names>L</given-names></string-name>, <string-name><surname>Cats</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>A comparison of automatic cell identification methods for single-cell RNA sequencing data</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>194</fpage>.<pub-id pub-id-type="pmid">31500660</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alquicira-Hernandez</surname><given-names>J</given-names></string-name>, <string-name><surname>Sathe</surname><given-names>A</given-names></string-name>, <string-name><surname>Ji</surname><given-names>HP</given-names></string-name></person-group><etal>et al</etal><article-title>scPred: accurate supervised method for cell-type classification from single-cell RNA-seq data</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>:<fpage>264</fpage>.<pub-id pub-id-type="pmid">31829268</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname><given-names>D</given-names></string-name>, <string-name><surname>Looney</surname><given-names>AP</given-names></string-name>, <string-name><surname>Liu</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat Immunol</source><year>2019</year>;<volume>20</volume>:<fpage>163</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baslan</surname><given-names>T</given-names></string-name>, <string-name><surname>Hicks</surname><given-names>J.</given-names></string-name></person-group><article-title>Unravelling biology and shifting paradigms in cancer with single-cell sequencing</article-title>. <source>Nat Rev Cancer</source><year>2017</year>;<volume>17</volume>:<fpage>557</fpage>–<lpage>69</lpage>.<pub-id pub-id-type="pmid">28835719</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>X</given-names></string-name>, <string-name><surname>Chen</surname><given-names>S</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>EnClaSC: a novel ensemble approach for accurate and robust cell-type classification of single-cell transcriptomes</article-title>. <source>BMC Bioinformatics</source><year>2020</year>;<volume>21</volume>:<fpage>392</fpage>.<pub-id pub-id-type="pmid">32938367</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Franzén</surname><given-names>O</given-names></string-name>, <string-name><surname>Gan</surname><given-names>L-M</given-names></string-name>, <string-name><surname>Björkegren</surname><given-names>JLM</given-names></string-name></person-group><etal>et al</etal><article-title>PanglaoDB: a web server for exploration of mouse and human single-cell RNA sequencing data</article-title>. <source>Database</source><year>2019</year>;<volume>2019</volume>:<fpage>baz046</fpage>.<pub-id pub-id-type="pmid">30951143</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gautam</surname><given-names>P</given-names></string-name>, <string-name><surname>Hamashima</surname><given-names>K</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Multi-species single-cell transcriptomic analysis of ocular compartment regulons</article-title>. <source>Nat Commun</source><year>2021</year>;<volume>12</volume>:<fpage>5675</fpage>.<pub-id pub-id-type="pmid">34584087</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gayoso</surname><given-names>A</given-names></string-name>, <string-name><surname>Lopez</surname><given-names>R</given-names></string-name>, <string-name><surname>Xing</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> A Python library for probabilistic analysis of single-cell omics data. <source>Nature Biotechnol</source><year>2022</year>;<volume>40</volume>(<issue>2</issue>):<fpage>163</fpage>–<lpage>166</lpage>.<pub-id pub-id-type="pmid">35132262</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guo</surname><given-names>H</given-names></string-name>, <string-name><surname>Li</surname><given-names>J.</given-names></string-name></person-group><article-title>scSorter: assigning cells to known cell types according to marker genes</article-title>. <source>Genome Biol</source><year>2021</year>;<volume>22</volume>:<fpage>69</fpage>.<pub-id pub-id-type="pmid">33618746</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Z</given-names></string-name>, <string-name><surname>Fei</surname><given-names>L</given-names></string-name></person-group><etal>et al</etal><article-title>Construction of a human cell landscape at single-cell level</article-title>. <source>Nature</source><year>2020</year>;<volume>581</volume>:<fpage>303</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">32214235</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Hao</surname><given-names>S</given-names></string-name>, <string-name><surname>Andersen-Nissen</surname><given-names>E</given-names></string-name></person-group><etal>et al</etal><article-title>Integrated analysis of multimodal single-cell data</article-title>. <source>Cell</source><year>2021</year>;<volume>184</volume>:<fpage>3573</fpage>–<lpage>87.e29</lpage>.<pub-id pub-id-type="pmid">34062119</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hoang</surname><given-names>T</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Boyd</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Gene regulatory networks controlling vertebrate retinal regeneration</article-title>. <source>Science</source><year>2020</year>;<volume>370</volume>:<fpage>eabb8598</fpage>.<pub-id pub-id-type="pmid">33004674</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>Q</given-names></string-name>, <string-name><surname>Liu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Du</surname><given-names>Y</given-names></string-name></person-group><etal>et al</etal><article-title>Evaluation of cell type annotation R packages on single-cell RNA-seq data</article-title>. <source>Genomics Proteomics Bioinf</source><year>2021</year>;<volume>19</volume>:<fpage>267</fpage>–<lpage>81</lpage>.</mixed-citation>
    </ref>
    <ref id="btad521-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ianevski</surname><given-names>A</given-names></string-name>, <string-name><surname>Giri</surname><given-names>AK</given-names></string-name>, <string-name><surname>Aittokallio</surname><given-names>T</given-names></string-name></person-group><etal>et al</etal><article-title>Fully-automated and ultra-fast cell-type identification using specific marker combinations from single-cell transcriptomic data</article-title>. <source>Nat Commun</source><year>2022</year>;<volume>13</volume>:<fpage>1246</fpage>.<pub-id pub-id-type="pmid">35273156</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Kanter</surname><given-names>JK</given-names></string-name></person-group><etal>et al</etal><article-title>CHETAH: a selective, hierarchical cell type identification method for single-cell RNA sequencing</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>e95</fpage>.<pub-id pub-id-type="pmid">31226206</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kimmel</surname><given-names>JC</given-names></string-name>, <string-name><surname>Kelley</surname><given-names>DR</given-names></string-name></person-group>. <article-title>Semi-supervised adversarial neural networks for single-cell classification</article-title>. <source>Genome research</source><year>2021</year>;<volume>31</volume>(<issue>10</issue>):<fpage>1781</fpage>-<lpage>1793</lpage>.<pub-id pub-id-type="pmid">33627475</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>VY</given-names></string-name>, <string-name><surname>Yiu</surname><given-names>A</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>M</given-names></string-name></person-group><etal>et al</etal><article-title>Scmap: projection of single-cell RNA-seq data across data sets</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>359</fpage>–<lpage>62</lpage>.<pub-id pub-id-type="pmid">29608555</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>C</given-names></string-name>, <string-name><surname>Liu</surname><given-names>B</given-names></string-name>, <string-name><surname>Kang</surname><given-names>B</given-names></string-name></person-group><etal>et al</etal><article-title>SciBet as a portable and fast single cell type identifier</article-title>. <source>Nat Commun</source><year>2020</year>;<volume>11</volume>:<fpage>1818</fpage>.<pub-id pub-id-type="pmid">32286268</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>Y</given-names></string-name>, <string-name><surname>Cao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Kim</surname><given-names>HJ</given-names></string-name></person-group><etal>et al</etal><article-title>scClassify: sample size estimation and multiscale classification of cells using single and multiple reference</article-title>. <source>Mol Syst Biol</source><year>2020</year>;<volume>16</volume>:<fpage>e9389</fpage>.<pub-id pub-id-type="pmid">32567229</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lopez</surname><given-names>R</given-names></string-name>, <string-name><surname>Regier</surname><given-names>J</given-names></string-name>, <string-name><surname>Cole</surname><given-names>MB</given-names></string-name></person-group><etal>et al</etal><article-title>Deep generative modeling for single-cell transcriptomics</article-title>. <source>Nat Methods</source><year>2018</year>;<volume>15</volume>:<fpage>1053</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30504886</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Macosko</surname><given-names>EZ</given-names></string-name>, <string-name><surname>Basu</surname><given-names>A</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R</given-names></string-name></person-group><etal>et al</etal><article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>. <source>Cell</source><year>2015</year>;<volume>161</volume>:<fpage>1202</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>F</given-names></string-name>, <string-name><surname>Pellegrini</surname><given-names>M.</given-names></string-name></person-group><article-title>ACTINN: automated identification of cell types in single cell RNA sequencing</article-title>. <source>Bioinformatics</source><year>2020</year>;<volume>36</volume>:<fpage>533</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">31359028</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ofengeim</surname><given-names>D</given-names></string-name>, <string-name><surname>Giagtzoglou</surname><given-names>N</given-names></string-name>, <string-name><surname>Huh</surname><given-names>D</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell RNA sequencing: unraveling the brain one cell at a time</article-title>. <source>Trends Mol Med</source><year>2017</year>;<volume>23</volume>:<fpage>563</fpage>–<lpage>76</lpage>.<pub-id pub-id-type="pmid">28501348</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Orozco</surname><given-names>LD</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H-H</given-names></string-name>, <string-name><surname>Cox</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>Integration of eQTL and a single-cell atlas in the human eye identifies causal genes for age-related macular degeneration</article-title>. <source>Cell Rep</source><year>2020</year>;<volume>30</volume>:<fpage>1246</fpage>–<lpage>59.e6</lpage>.<pub-id pub-id-type="pmid">31995762</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Potter</surname><given-names>SS.</given-names></string-name></person-group><article-title>Single-cell RNA sequencing for the study of development, physiology and disease</article-title>. <source>Nat Rev Nephrol</source><year>2018</year>;<volume>14</volume>:<fpage>479</fpage>–<lpage>92</lpage>.<pub-id pub-id-type="pmid">29789704</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rozenblatt-Rosen</surname><given-names>O</given-names></string-name>, <string-name><surname>Stubbington</surname><given-names>MJT</given-names></string-name>, <string-name><surname>Regev</surname><given-names>A</given-names></string-name></person-group><etal>et al</etal><article-title>The human cell atlas: from vision to reality</article-title>. <source>Nature</source><year>2017</year>;<volume>550</volume>:<fpage>451</fpage>–<lpage>3</lpage>.<pub-id pub-id-type="pmid">29072289</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saliba</surname><given-names>A-E</given-names></string-name>, <string-name><surname>Westermann</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Gorski</surname><given-names>SA</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell RNA-seq: advances and future challenges</article-title>. <source>Nucleic Acids Res</source><year>2014</year>;<volume>42</volume>:<fpage>8845</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">25053837</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shao</surname><given-names>X</given-names></string-name>, <string-name><surname>Liao</surname><given-names>J</given-names></string-name>, <string-name><surname>Lu</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><article-title>scCATCH: automatic annotation on cell types of clusters from single-cell RNA sequencing data</article-title>. <source>iScience</source><year>2020</year>;<volume>23</volume>:<fpage>100882</fpage>.<pub-id pub-id-type="pmid">32062421</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shao</surname><given-names>X</given-names></string-name>, <string-name><surname>Yang</surname><given-names>H</given-names></string-name>, <string-name><surname>Zhuang</surname><given-names>X</given-names></string-name></person-group><etal>et al</etal><article-title>scDeepSort: a pre-trained cell-type annotation method for single-cell transcriptomics using deep learning with a weighted graph neural network</article-title>. <source>Nucleic Acids Res</source><year>2021</year>;<volume>49</volume>:<fpage>e122</fpage>.<pub-id pub-id-type="pmid">34500471</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Cahan</surname><given-names>P.</given-names></string-name></person-group><article-title>SingleCellNet: a computational tool to classify single cell RNA-Seq data across platforms and across species</article-title>. <source>Cell Syst</source><year>2019</year>;<volume>9</volume>:<fpage>207</fpage>–<lpage>13.e2</lpage>.<pub-id pub-id-type="pmid">31377170</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Voigt</surname><given-names>AP</given-names></string-name>, <string-name><surname>Whitmore</surname><given-names>SS</given-names></string-name>, <string-name><surname>Flamme-Wiese</surname><given-names>MJ</given-names></string-name></person-group><etal>et al</etal><article-title>Molecular characterization of foveal versus peripheral human retina by single-cell RNA sequencing</article-title>. <source>Exp Eye Res</source><year>2019</year>;<volume>184</volume>:<fpage>234</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">31075224</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>T</given-names></string-name>, <string-name><surname>Bai</surname><given-names>J</given-names></string-name>, <string-name><surname>Nabavi</surname><given-names>S</given-names></string-name></person-group><etal>et al</etal><article-title>Single-cell classification using graph convolutional networks</article-title>. <source>BMC Bioinformatics</source><year>2021</year>;<volume>22</volume>:<fpage>364</fpage>.<pub-id pub-id-type="pmid">34238220</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wen</surname><given-names>L</given-names></string-name>, <string-name><surname>Tang</surname><given-names>F.</given-names></string-name></person-group><article-title>Single-cell sequencing in stem cell biology</article-title>. <source>Genome Biol</source><year>2016</year>;<volume>17</volume>:<fpage>71</fpage>.<pub-id pub-id-type="pmid">27083874</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xie</surname><given-names>P</given-names></string-name>, <string-name><surname>Gao</surname><given-names>M</given-names></string-name>, <string-name><surname>Wang</surname><given-names>C</given-names></string-name></person-group><etal>et al</etal><article-title>SuperCT: a supervised-learning framework for enhanced characterization of single-cell transcriptomic profiles</article-title>. <source>Nucleic Acids Res</source><year>2019</year>;<volume>47</volume>:<fpage>e48</fpage>.<pub-id pub-id-type="pmid">30799483</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>F</given-names></string-name>, <string-name><surname>Wang</surname><given-names>W</given-names></string-name>, <string-name><surname>Wang</surname><given-names>F</given-names></string-name></person-group><etal>et al</etal><article-title>scBERT as a large-scale pretrained deep language model for cell type annotation of single-cell RNA-seq data</article-title>. <source>Nat Mach Intell</source><year>2022</year>;<volume>4</volume>:<fpage>852</fpage>–<lpage>66</lpage>.</mixed-citation>
    </ref>
    <ref id="btad521-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yin</surname><given-names>Q</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Guan</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>scIAE: an integrative autoencoder-based ensemble classification framework for single-cell RNA-seq data</article-title>. <source>Brief. Bioinform</source><year>2022</year>;<volume>23</volume>:<fpage>bbab508</fpage>.<pub-id pub-id-type="pmid">34913057</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>AW</given-names></string-name>, <string-name><surname>O'Flanagan</surname><given-names>C</given-names></string-name>, <string-name><surname>Chavez</surname><given-names>EA</given-names></string-name></person-group><etal>et al</etal><article-title>Probabilistic cell-type assignment of single-cell RNA-seq for tumor microenvironment profiling</article-title>. <source>Nat Methods</source><year>2019a</year>;<volume>16</volume>:<fpage>1007</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">31501550</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>X</given-names></string-name>, <string-name><surname>Lan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J</given-names></string-name></person-group><etal>et al</etal><article-title>CellMarker: a manually curated resource of cell markers in human and mouse</article-title>. <source>Nucleic Acids Res</source><year>2019b</year>;<volume>47</volume>:<fpage>D721</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">30289549</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>F</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Z</given-names></string-name></person-group><etal>et al</etal><article-title>scMAGIC: accurately annotating single cells using two rounds of reference-based classification</article-title>. <source>Nucleic Acids Res</source><year>2022</year>;<volume>50</volume>:<fpage>e43</fpage>.<pub-id pub-id-type="pmid">34986249</pub-id></mixed-citation>
    </ref>
    <ref id="btad521-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>GXY</given-names></string-name>, <string-name><surname>Terry</surname><given-names>JM</given-names></string-name>, <string-name><surname>Belgrader</surname><given-names>P</given-names></string-name></person-group><etal>et al</etal><article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat Commun</source><year>2017</year>;<volume>8</volume>:<fpage>14049</fpage>.<pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
