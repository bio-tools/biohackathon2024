<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">J Cheminform</journal-id>
    <journal-id journal-id-type="iso-abbrev">J Cheminform</journal-id>
    <journal-title-group>
      <journal-title>Journal of Cheminformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1758-2946</issn>
    <publisher>
      <publisher-name>Springer International Publishing</publisher-name>
      <publisher-loc>Cham</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5688056</article-id>
    <article-id pub-id-type="publisher-id">244</article-id>
    <article-id pub-id-type="doi">10.1186/s13321-017-0244-9</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>An efficient computer-aided structural elucidation strategy for mixtures using an iterative dynamic programming algorithm</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Su</surname>
          <given-names>Bo-Han</given-names>
        </name>
        <address>
          <email>suborhang@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Shen</surname>
          <given-names>Meng-Yu</given-names>
        </name>
        <address>
          <email>tcgarita@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Harn</surname>
          <given-names>Yeu-Chern</given-names>
        </name>
        <address>
          <email>duke3d.harn@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>San-Yuan</given-names>
        </name>
        <address>
          <email>sanyuan731@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schurz</surname>
          <given-names>Alioune</given-names>
        </name>
        <address>
          <email>alioune.schurz@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Chieh</given-names>
        </name>
        <address>
          <email>jessica1338@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Olivia A.</given-names>
        </name>
        <address>
          <email>olivia22lin@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Tseng</surname>
          <given-names>Yufeng J.</given-names>
        </name>
        <address>
          <email>yjtseng@csie.ntu.edu.tw</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0546 0241</institution-id><institution-id institution-id-type="GRID">grid.19188.39</institution-id><institution>Department of Computer Science and Information Engineering, </institution><institution>National Taiwan University, </institution></institution-wrap>No. 1 Sec. 4, Roosevelt Road, Taipei, 106 Taiwan </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0546 0241</institution-id><institution-id institution-id-type="GRID">grid.19188.39</institution-id><institution>Graduate Institute of Networking and Multimedia, </institution><institution>National Taiwan University, </institution></institution-wrap>No. 1 Sec. 4, Roosevelt Road, Taipei, 106 Taiwan </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 0546 0241</institution-id><institution-id institution-id-type="GRID">grid.19188.39</institution-id><institution>Graduate Institute of Biomedical Electronics and Bioinformatics, </institution><institution>National Taiwan University, </institution></institution-wrap>No. 1 Sec. 4, Roosevelt Road, Taipei, 106 Taiwan </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>15</day>
      <month>11</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>11</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2017</year>
    </pub-date>
    <volume>9</volume>
    <elocation-id>57</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>8</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>11</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2017</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">
The identification of chemical structures in natural product mixtures is an important task in drug discovery but is still a challenging problem, as structural elucidation is a time-consuming process and is limited by the available mass spectra of known natural products. Computer-aided structure elucidation (CASE) strategies seek to automatically propose a list of possible chemical structures in mixtures by utilizing chromatographic and spectroscopic methods. However, current CASE tools still cannot automatically solve structures for experienced natural product chemists. Here, we formulated the structural elucidation of natural products in a mixture as a computational problem by extending a list of scaffolds using a weighted side chain list after analyzing a collection of 243,130 natural products and designed an efficient algorithm to precisely identify the chemical structures. The complexity of such a problem is NP-complete. A dynamic programming (DP) algorithm can solve this NP-complete problem in pseudo-polynomial time after converting floating point molecular weights into integers. However, the running time of the DP algorithm degrades exponentially as the precision of the mass spectrometry experiment grows. To ideally solve in polynomial time, we proposed a novel iterative DP algorithm that can quickly recognize the chemical structures of natural products. By utilizing this algorithm to elucidate the structures of four natural products that were experimentally and structurally determined, the algorithm can search the exact solutions, and the time performance was shown to be in polynomial time for average cases. The proposed method improved the speed of the structural elucidation of natural products and helped broaden the spectrum of available compounds that could be applied as new drug candidates. A web service built for structural elucidation studies is freely accessible via the following link (<ext-link ext-link-type="uri" xlink:href="http://csccp.cmdm.tw/">http://csccp.cmdm.tw/</ext-link>).</p>
      <sec>
        <title>Electronic supplementary material</title>
        <p>The online version of this article (10.1186/s13321-017-0244-9) contains supplementary material, which is available to authorized users.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>CASE</kwd>
      <kwd>Natural products</kwd>
      <kwd>Dynamic programming</kwd>
      <kwd>Polynomial time</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100004663</institution-id>
            <institution>Ministry of Science and Technology, Taiwan</institution>
          </institution-wrap>
        </funding-source>
        <award-id>105-3011-F-002-010-</award-id>
        <award-id>105-2812-8-002-001-MY2</award-id>
        <award-id>106-2622-B-002-008-</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tseng</surname>
            <given-names>Yufeng J.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100006477</institution-id>
            <institution>National Taiwan University</institution>
          </institution-wrap>
        </funding-source>
        <award-id>NTU-ERP-106R880803</award-id>
        <principal-award-recipient>
          <name>
            <surname>Tseng</surname>
            <given-names>Yufeng J.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2017</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Examining natural and therapeutic products is crucial for drug development because many chemically synthesized compounds have potentially serious toxicity and adverse effects, while less toxic compounds extracted from natural products could possibly be developed into new drug candidates [<xref ref-type="bibr" rid="CR1">1</xref>]. In addition, natural products often open new chemical spaces not explored by synthetic compounds produced by combinatorial chemistry and can further expand the diversity and novelty of molecules by extracting different natural sources, such as the deep and cold seas [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR3">3</xref>]. A review by Newman and Cragg [<xref ref-type="bibr" rid="CR2">2</xref>] indicated that 47% of new anti-cancer drugs from 1950 to 2006 were originally from or derived from natural products. Recently, Butler et al. [<xref ref-type="bibr" rid="CR3">3</xref>] reviewed 100 natural products and natural products-derived compounds that were either evaluated in clinical trials or in registration at the end of 2013. They concluded that 50% of the compounds were natural products or semi-synthetic natural products, while the remaining compounds were classified as natural products-derived compounds. The exploration of new lead compounds from natural products and their successful development into clinical trials will continue to be a significant trend in drug discovery over the next few years.</p>
    <p id="Par3">However, natural products-based drug discovery faces many challenges [<xref ref-type="bibr" rid="CR4">4</xref>], and the exploration of natural products for new drug development was actually disfavored by the pharmaceutical industry in the 2000s [<xref ref-type="bibr" rid="CR5">5</xref>]. One of the major hurdles is the extremely time-consuming processes involved in the isolation and structural elucidation of bioactive compounds from natural products composed of complicated mixtures. Because the magnitude of the natural products database is limited, high-throughput screening methods cannot be used to effectively identify potential natural products drugs. Many advances in mass spectrometry (MS) and nuclear magnetic resonance (NMR) automation techniques over the last two decades have accelerated structural elucidation processes for complex natural products mixtures. MS is a common tool used to identify elemental constituents of a molecule. MS data can provide the molecular weight, fragmentation pattern, and molecular formula, which can then be matched to structures. Current advances in MS instruments can provide high-resolution molecular weight measurements [<xref ref-type="bibr" rid="CR6">6</xref>] and reduce the total number of overlapping m/z values. However, MS data itself is insufficient to determine the structure of a partially or completely unknown compound [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>]. On the other hand, NMR methods can give a spectroscopic overview of compounds. Although high-resolution and high-dimensional NMR methods have undergone continual advancement [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref>], NMR still cannot independently elucidate novel chemical structures unless co-eluting compounds can be completely separated [<xref ref-type="bibr" rid="CR8">8</xref>]. Even though LC–NMR–MS [<xref ref-type="bibr" rid="CR13">13</xref>] and LC–UV–solid-phase extraction–NMR–MS [<xref ref-type="bibr" rid="CR9">9</xref>] have proven to be effective methods to elucidate compound structures in natural products extracts, the successful structural elucidation of unknown compounds still greatly depends on the development of computational systems to help evaluate the mass spectral data [<xref ref-type="bibr" rid="CR14">14</xref>].</p>
    <p id="Par4">Computer-aided structure elucidation (CASE), developed 40 years ago [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR18">18</xref>], is a well-known computational approach that can accelerate the process of identifying possible chemical constituents based on expert systems. To fully automate structural elucidation via MS and NMR techniques, different advanced algorithms have been applied in CASE [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR23">23</xref>]. However, the many limitations [<xref ref-type="bibr" rid="CR24">24</xref>] of CASE expert systems still hinder the creation of fully automatic processes for structural elucidation [<xref ref-type="bibr" rid="CR25">25</xref>]. One of the major restrictions is the requirement of 2D NMR data as input in these CASE systems [<xref ref-type="bibr" rid="CR26">26</xref>]. 2D NMR experiments are intrinsically insensitive [<xref ref-type="bibr" rid="CR27">27</xref>] and extremely time-consuming, especially for the extraction of <sup>13</sup>C nucleus peak shifts [<xref ref-type="bibr" rid="CR25">25</xref>]. Moreover, inaccurate structural elucidation may result from the co-elution of compounds that cannot be completely separated. Therefore, current traditional CASE tools based on 2D NMR spectra still cannot meet the structure-solving needs of experienced natural product chemists [<xref ref-type="bibr" rid="CR4">4</xref>]. Using MS to develop CASE systems can provide more significant benefits than NMR-based CASE systems, as MS is more sensitive, and the amount of unknown structures in the mixtures needed for analysis is smaller. Furthermore, MS is not usually affected by impurities in the input mixture [<xref ref-type="bibr" rid="CR28">28</xref>].</p>
    <p id="Par5">Harn et al. [<xref ref-type="bibr" rid="CR29">29</xref>] proposed a novel CASE algorithm, known as <italic>NP</italic>-<italic>StructurePredictor</italic>, to predict individual components in an natural product mixture strictly using information obtained from LC–MS experiments. The purpose of <italic>NP</italic>-<italic>StructurePredictor</italic> is to generate possible chemical structures to aid in the identification or structural elucidation of unknown natural products. This can be achieved by matching a list of known scaffolds with a list of weighted side chains to produce a list of possible compounds under specified structural constraints. In this study, we convert this structural elucidation problem to a formal mathematic formula and refer to the problem as the <italic>Chemical Substituents</italic>-<italic>Core Combinatorial Problem</italic> (<italic>CSCCP</italic>). Since the computational complexity of the <italic>CSCCP</italic> is NP-complete, the search for optimal solutions (valid structures) in the <italic>CSCCP</italic> must be executed in exponential time complexity for any deterministic algorithms without a loss of generality. Thus, using brute force (BF) algorithms, which search all possible answers, to solve the <italic>CSCCP</italic> cannot be finished in a reasonable timeframe. In <italic>NP</italic>-<italic>StructurePredictor</italic>, a branch and bound (BB) strategy was applied to search for and generate a set of optimal solutions. Nevertheless, the BB strategy has its limitations as well: [<xref ref-type="bibr" rid="CR1">1</xref>] although the execution time is shorter, in many cases, the algorithm still cannot be finished in a reasonable timeframe, [<xref ref-type="bibr" rid="CR2">2</xref>] it is difficult to analyze the stability and accuracy of the BB method, and [<xref ref-type="bibr" rid="CR3">3</xref>] the experimental execution time in real cases is unstable and poor for complex mixtures and sometimes even as slow as the BF algorithm. The BB algorithm used in <italic>NP</italic>-<italic>StructurePredictor</italic> still limits the number of combinatorial candidates of the side chains for each scaffold so that the program can be finished in a reasonable execution time. In such cases, <italic>Structure Hunter</italic> cannot find the optimal solutions.</p>
    <p id="Par6">In this study, to further promote the performance of searching for all optimal solutions of the <italic>CSCCP</italic> problem, we first present a pseudo-polynomial time algorithm based on classical dynamic programming (DP) strategies that can effectively and accurately search for all correct structures in a natural product mixture. The DP strategy is based on the method used by Ibarra and Kim [<xref ref-type="bibr" rid="CR30">30</xref>]. However, because this is a pseudo-polynomial time algorithm, the time performance is limited by the required precision of the molecular weight, which is between four and six decimal places. We then propose another iterative DP algorithm that can be executed in polynomial time for the average case. Four complex herbs with verified structures were applied in the study of <italic>NP</italic>-<italic>StructurePredictor</italic>, and all were successfully predicted by this method. We compared the time performance of our algorithm in <italic>NP</italic>-<italic>StructurePredictor</italic>. For all cases, our iterative DP algorithm outperformed the BF algorithm, classical DP algorithm, and the BB program in <italic>NP</italic>-<italic>StructurePredictor</italic> and also could run to completion in a reasonable time and provide optimal solutions. We developed a new, efficient CASE strategy that can accurately predict the possible structures of compounds in mixtures based only on information obtained from LC–MS experiments.</p>
  </sec>
  <sec id="Sec2">
    <title>Results and discussion</title>
    <p id="Par7">The identification or prediction of the main chemical components present in an natural product mixture with traditional chromatographic methods is time-consuming. The limited compound references also make identification or prediction more difficult for each constituent in a mixture. Hence, an efficient algorithm to solve the <italic>CSCCP</italic> is needed.</p>
    <p id="Par8">This section reports the simulation results of the DP algorithms developed in this paper. Two other traditional methods were implemented and compared with the DP algorithms in terms of quality and time performance. All four of the algorithms were implemented in Java (JDK version 7) and tested on a Linux PC with an Intel Xeon(R) CPU 2.40 GHz with 32 GB of memory. Four types of natural products were used in our simulation: <italic>Cuscuta chinensis</italic> (<italic>C. chinensis</italic>), <italic>Ophiopogon japonicus</italic> (<italic>O. japonicus</italic>), <italic>Polygonum multiflorum</italic> (<italic>P. multiflorum</italic>), and <italic>Angelica</italic> sp. According to the experimental identification procedures from the Natural Product Laboratory of the Taiwan Medical and Pharmaceutical Industry Technology and Development Center as well as investigations from earlier publications, the main structures of each herb have been established and were used as a validation set for the evaluation of our simulation results. The time complexity analysis of our new CASE algorithms, quality of the search results, and running time performance compared to those of the traditional methods for the four cases were also discussed in the last sections.</p>
    <p id="Par9">Targeted MWs and seed scaffolds are necessary input information in our algorithm. To obtain possible targeted MWs, LC–MS experiments for the tested natural products were performed beforehand. Targeted MWs can then be retrieved from peak tables generated in LC–MS experiments. In our cases, we used MAVEN [<xref ref-type="bibr" rid="CR31">31</xref>] or XCMS [<xref ref-type="bibr" rid="CR32">32</xref>] to extract peak tables and then retrieved all possible molecular weights as input targeted MWs. To identify the main structures of each tested natural products, the obtained data including parent and daughter ions pattern were compared with the compounds spectra of similar medicinal herbs in earlier publications or databases. This step resulted in the preliminary identification of top five high intensity peaks in our cases. These peaks can be validated with known standard compounds analyzed under the same LC conditions, by comparing and matching the retention times and MS/MS spectra. These identified main structures were used as our validation sets. The remaining core structures can be used directly as the seed scaffolds in our tested cases after all terminal side chains of the identified structures were eliminated. The input targeted MWs and seed scaffolds of the four natural products were listed in the following sections.</p>
    <p id="Par10">The choice of the <italic>seed scaffolds</italic> is likely to influence the outcome of the structural elucidation. In real cases, users can roughly identify the similar structures of natural products, in which compound spectra are similar to all high intensity peaks measured in the preliminary LC–MS experiments. Because those identified structures can be regarded as potential candidates of individual component in test materials, the core structures of these candidates can be directly used as seed scaffolds in our algorithm. Furthermore, when users cannot provide the seed scaffolds of the test material, our algorithm is capable of performing a full search on all our collected 83,242 possible scaffolds. The full searching strategy can automatically generate suitable candidates and run to completion in a reasonable timeframe.</p>
    <sec id="Sec3">
      <title>Structural elucidation of the four natural products using the iterative DP algorithm</title>
      <p id="Par11">
To identify the main structures in an natural product mixture using the iterative DP algorithm, users must first provide the program with a list of target molecular weights (<italic>targeted MWs</italic>) in a tested natural product obtained from the LC–MS spectra as well as <italic>seed scaffolds</italic> if the user has prior knowledge of the potential structural category for compounds in the natural products. In this study, the <italic>targeted MWs</italic> extracted from the mass spectra of the four natural products are listed in Table <xref rid="Tab1" ref-type="table">1</xref>. <italic>C. chinensis</italic> and <italic>O. japonicus</italic> have four <italic>targeted MWs</italic> each, and <italic>P. multiflorum</italic> contains six <italic>targeted MWs</italic>. For <italic>Angelica</italic> sp., 35 <italic>targeted MWs</italic> are given, and thus, the computational time for <italic>Angelica</italic> sp. is much longer than that for the other tested herbs. In Fig. <xref rid="Fig1" ref-type="fig">1</xref>, we illustrate the known <italic>seed scaffolds</italic> considered in the four natural products. <italic>Angelica</italic> sp. has the highest number of <italic>seed scaffolds</italic>. In the DP algorithm, we elucidate unknown chemical structures by extending appropriate side chains on the given <italic>seed scaffolds</italic>. When the program analyzes which side chains can be linked to the <italic>seed scaffolds</italic>, we must also consider the possible sets of positions on the scaffold that can be linked by the side chains. Given one <italic>targeted MW</italic> and <italic>seed scaffold</italic>, our algorithm will output a set of optimal structures identified by applying each possible set of positions on the scaffold to the searching procedure of the DP algorithm. Therefore, a <italic>CSCCP</italic> program needs to be executed <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ N_{c} \times N_{p} \times N_{k} $$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>p</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq1.gif"/></alternatives></inline-formula> times to identify the main structures for an natural product, where <italic>N</italic>
<sub><italic>c</italic></sub> is the number of given <italic>seed scaffolds</italic>, <italic>N</italic>
<sub><italic>p</italic></sub> denotes the number of given <italic>target MWs</italic>, and <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ N_{k} $$\end{document}</tex-math><mml:math id="M4"><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq2.gif"/></alternatives></inline-formula> represents an average number of possible sets of positions on the <italic>seed scaffolds</italic>. From the statistics of the collected database compounds, the average <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ N_{k} $$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq3.gif"/></alternatives></inline-formula> is approximately 5. The number of different types of possible sets of positions (<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ N_{k} $$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq4.gif"/></alternatives></inline-formula>) in the four tested natural products is listed in Table <xref rid="Tab2" ref-type="table">2</xref>. Among the four herbs, <italic>C. chinensis</italic> in scaffold 1 has the maximum <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ N_{k} $$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq5.gif"/></alternatives></inline-formula> of 13, and in scaffold 2, <italic>C. chinensis</italic> has the maximum <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ N_{k} $$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mi>N</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq6.gif"/></alternatives></inline-formula> of 231. Since four different <italic>targeted MWs</italic> of <italic>C. chinensis</italic> were considered in this study, in total 4 × (231 + 13) = 976 <italic>CSCCPs</italic> must be executed to elucidate the main structures in <italic>C. chinensis</italic>.<table-wrap id="Tab1"><label>Table 1</label><caption><p>List of the target molecular weights for the four tested natural products</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Case name</th><th align="left">Target weight lists</th></tr></thead><tbody><tr><td align="left"><italic>C. chinensis</italic></td><td align="left">286.24, 302.24, 354.31, 478.41</td></tr><tr><td align="left"><italic>O. japonicus</italic></td><td align="left">328.32, 342.35, 356.33, 370.36</td></tr><tr><td align="left"><italic>P. multiflorum</italic></td><td align="left">270.24, 284.27, 290.27, 406.39, 432.38, 578.53</td></tr><tr><td align="left"><italic>Angelica</italic> sp.</td><td align="left">162.03, 186.03, 192.04, 202.03, 216.04, 230.09, 244.11, 246.05, 246.09, 246.09, 270.09, 286.08, 288.10, 300.10, 316.09, 328.13, 334.11, 354.15, 360.08, 360.16, 366.22, 374.14, 376.15, 378.17, 386.14, 388.15, 402.13, 414.17, 414.20, 426.17, 426.17, 428.18, 546.26, 574.29</td></tr></tbody></table></table-wrap>
<fig id="Fig1"><label>Fig. 1</label><caption><p>The seed scaffolds used for structural elucidation of the four tested natural products in our DP algorithms: <bold>a</bold>
<italic>C. chinensis</italic>, <bold>b</bold>
<italic>O. japonicus</italic>, <bold>c</bold>
<italic>P. multiflorum</italic>, and <bold>d</bold>
<italic>Angelica</italic> sp.</p></caption><graphic xlink:href="13321_2017_244_Fig1_HTML" id="MO1"/></fig>
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Number of different types of possible sets of substituted positions (<inline-formula id="IEq151"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\mathbf{N}}_{{\mathbf{k}}} $$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi mathvariant="bold">N</mml:mi><mml:mi mathvariant="bold">k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq151.gif"/></alternatives></inline-formula>) for each tested natural product</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Case name</th><th align="left">(Scaffold number, <inline-formula id="IEq152"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\text{N}}_{\text{k}} $$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mtext>N</mml:mtext><mml:mtext>k</mml:mtext></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq152.gif"/></alternatives></inline-formula>)</th></tr></thead><tbody><tr><td align="left"><italic>C. chinensis</italic></td><td align="left">(1, 13), (2, 231)</td></tr><tr><td align="left"><italic>O. japonicus</italic></td><td align="left">(1, 4), (2, 6), (3, 31)</td></tr><tr><td align="left"><italic>P. multiflorum</italic></td><td align="left">(1, 68), (2, 28), (3, 68), (4, 81)</td></tr><tr><td align="left"><italic>Angelica sp</italic>.</td><td align="left">(1, 58), (5, 28), (3, 8), (4, 15), (5, 11)</td></tr></tbody></table></table-wrap>
</p>
      <p id="Par12">We took <italic>C. chinensis</italic> with a <italic>targeted MW</italic> of 286.24 as an example to demonstrate the identification of the main structures using the <italic>IDPforCSCCP</italic> algorithm. We executed the <italic>CSCCP</italic> algorithm 231 times using different sets of possible substituted positions on the second scaffold of <italic>C. chinensis</italic> and obtained 2310 recognized structures. The top 10 ranking results among the 2310 structures are presented in Table <xref rid="Tab3" ref-type="table">3</xref>. The first column in Table <xref rid="Tab3" ref-type="table">3</xref> provides the ranks according to the probabilities (<inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \prod\nolimits_{i = 1}^{n} {P_{{i,x_{i} }} } $$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq7.gif"/></alternatives></inline-formula>) of potential combinations of the scaffolds and side chains analyzed from our large collections of natural products in descending order. The second column gives the identified main structures in <italic>C. chinensis</italic> with a <italic>targeted MW</italic> of 286.24. The numbers shown below the structures provide the molecular weight and probability, <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \prod\nolimits_{i = 1}^{n} {P_{{ix_{i} }} } $$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq8.gif"/></alternatives></inline-formula>, of the identified structure. The highest two identified structures (rank 1 and rank 2 structures) are precisely the same as the main structures validated by experimental methods. The two main structures in <italic>C. chinensis</italic> with a <italic>targeted MW</italic> of 286.24 were correctly predicted with the highest ranks using the <italic>IDPforCSCCP</italic> algorithm. The predicted results that match the validated structures of <italic>C. chinensis</italic> for all considered <italic>targeted MWs</italic> are also given in Table <xref rid="Tab4" ref-type="table">4</xref>. The first two columns in Table <xref rid="Tab4" ref-type="table">4</xref> provide the molecular weights of the predicted structures and the corresponding <italic>seed scaffolds</italic>. The third column provides the identified structures that are equal to the validated structures, and their ranks are provided in the last column. All validated main structures in <italic>C. chinensis</italic> are correctly predicted to be in the top 10 ranks. The predicted results for <italic>O. japonicus</italic>, <italic>P. multiflorum</italic>, and <italic>Angelica</italic> sp. are also listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1–S3. In Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3, the <italic>seed scaffolds</italic> and the predicted structures are omitted, and the second column only provides the <italic>seed scaffold</italic> number as denoted in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. In the “rank” column of Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3, “Non” indicates that the expected main structures cannot be identified by our program because the correct side chains that link the <italic>seed scaffold</italic>s were not present in our database. Only 9 out of 62 validated main structures in the four tested natural products cannot be automatically identified by our CASE method. Furthermore, the ranks of the predicted structures listed in Table <xref rid="Tab4" ref-type="table">4</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1–S3 confirmed the accuracy of our algorithm. Among the four tested natural products, the predicted ranks of all the validated structures ranged from 1 to 83, and the average value of the predicted ranks is 8. In our DP algorithm, <italic>DPforCSCCP</italic>, we can thus tentatively set <italic>R</italic> equal to 10 because we can elucidate most of the correct main structures in the four tested natural products using our novel DP CASE algorithm, <italic>IDPforCSCCP,</italic> when <italic>R</italic> is set to 10. The four case studies demonstrated that the structural elucidation functionality of <italic>IDPforCSCCP</italic> is applicable and reliable. Moreover, our ranking methodology was reasonable to reduce false positive identifications because our predicted structures that matched with validated compounds all resulted in high rankings.<table-wrap id="Tab3"><label>Table 3</label><caption><p>The top ten optimal results from <italic>seed scaffold</italic> 2 with a given weight of 286.24 for <italic>C. chinensis</italic>
</p></caption><graphic xlink:href="13321_2017_244_Tab3_HTML" id="MO2"/></table-wrap>
<table-wrap id="Tab4"><label>Table 4</label><caption><p>The identified structures that match the baseline data for <italic>C. chinensis</italic>. The last column indicates the ranks determined by our DP algorithm</p></caption><graphic xlink:href="13321_2017_244_Tab4_HTML" id="MO3"/></table-wrap>
</p>
    </sec>
    <sec id="Sec4">
      <title>Analysis of time complexity in the DP and iterative DP algorithms</title>
      <p id="Par13">First, we analyzed the time complexity of the DP algorithm described in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. Initially, the starting condition of <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(s,w,r) $$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq9.gif"/></alternatives></inline-formula> executes completely in <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ O\left( {W_{0}^{{\prime }} R} \right) $$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mi>R</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq10.gif"/></alternatives></inline-formula> time. The next four for-loops execute in <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ O\left( {\sum\nolimits_{i = 1}^{n} {W_{0}^{{\prime }} K_{i} R} } \right) $$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>R</mml:mi></mml:mrow></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq11.gif"/></alternatives></inline-formula> time, and each iteration of the four for-loops requires <inline-formula id="IEq12"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ O\left( 1 \right) $$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="("><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq12.gif"/></alternatives></inline-formula> for the side chain information assignments and <inline-formula id="IEq13"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ O\left( {K_{i} R\log K_{i} R} \right) $$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>R</mml:mi><mml:mo>log</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>R</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq13.gif"/></alternatives></inline-formula> for the max (in Lemma 3) function, which is applied by a quick-sort algorithm. Thus, the time complexity of <italic>DPforCSCCP</italic> is<disp-formula id="Equa"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ O\left( {W_{0} \mathop \sum \limits_{i = 1}^{n} \left( {K_{i} R + K_{i} R\log K_{i} R} \right)} \right) = O\left( {W_{0}^{{\prime }} R\left[ {\mathop \sum \limits_{i = 1}^{n} \left( {K_{i} \log K_{i} R} \right)} \right]} \right). $$\end{document}</tex-math><mml:math id="M32" display="block"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>R</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>R</mml:mi><mml:mo>log</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>R</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mi>R</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>log</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>R</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="13321_2017_244_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>
</p>
      <p id="Par14">In real cases, <italic>R</italic> is a constant. If <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ K^{{\prime }} = max_{i = 1..n} K_{i} $$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq14.gif"/></alternatives></inline-formula>, the total time complexity can be converted to <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ O\left( {nW_{0}^{{\prime }} K^{{\prime }} {\text{Rlog}}K^{{\prime }} R} \right) $$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>n</mml:mi><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:msup><mml:mi>K</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mtext>Rlog</mml:mtext><mml:msup><mml:mi>K</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>R</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq15.gif"/></alternatives></inline-formula> by setting <inline-formula id="IEq16"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ K_{i} $$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq16.gif"/></alternatives></inline-formula> equal to <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ K^{{\prime }} $$\end{document}</tex-math><mml:math id="M40"><mml:msup><mml:mi>K</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq17.gif"/></alternatives></inline-formula>. However, <italic>DPforCSCCP</italic> is not a real polynomial time algorithm. Because each <inline-formula id="IEq18"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0} $$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq18.gif"/></alternatives></inline-formula> is converted into an integer by multiplying by 10<sup>6</sup> in the DP algorithm, the complexity becomes <inline-formula id="IEq19"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ O\left( {10^{6} \times nW_{0} K^{{\prime }} R\log K^{{\prime }} R} \right) $$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup><mml:mo>×</mml:mo><mml:mi>n</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mi>K</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>R</mml:mi><mml:mo>log</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>R</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq19.gif"/></alternatives></inline-formula>. Although <inline-formula id="IEq20"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0}^{{\prime }} $$\end{document}</tex-math><mml:math id="M46"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq20.gif"/></alternatives></inline-formula> is a single integer number, the actual input <inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ 10^{6} W_{0} $$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq21.gif"/></alternatives></inline-formula> may be exponentially times greater than <inline-formula id="IEq22"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ nK^{{\prime }} $$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi>n</mml:mi><mml:msup><mml:mi>K</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq22.gif"/></alternatives></inline-formula>. Therefore, the main time complexity of <italic>DPforCSCCP</italic> is the cost on the input <inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ 10^{6} W_{0} $$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq23.gif"/></alternatives></inline-formula>, and <italic>DPforCSCCP</italic> is a pseudo-polynomial time algorithm.</p>
      <p id="Par15">We then analyzed the time complexity of the <italic>IDPforCSCCP</italic> algorithm. As shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, the while loop in the program is the same as that in the <italic>DPforCSCCP</italic> algorithm, and it executes completely in <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ O\left( {nW^{{\prime \prime }} R\bar{K}\log R\bar{K}} \right) $$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>n</mml:mi><mml:msup><mml:mi>W</mml:mi><mml:mo>″</mml:mo></mml:msup><mml:mi>R</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>log</mml:mo><mml:mi>R</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq24.gif"/></alternatives></inline-formula> time, where <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \bar{K} $$\end{document}</tex-math><mml:math id="M56"><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq25.gif"/></alternatives></inline-formula> is the average of <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ K_{i} $$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq26.gif"/></alternatives></inline-formula>. Herein, we estimate the average value of the target weight of the natural products. In our collected natural products database, a total of 82,847 natural products contain ring structures, and only these compounds were considered in this study. The average total molecular weight of all possible maximal substituents in each compound is <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ 89.42 $$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mn>89.42</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq27.gif"/></alternatives></inline-formula>, where for a given scaffold, the maximal substituent is the side chain with the maximal molecular weight. On average, we can assume that the variable <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W^{{\prime \prime }} $$\end{document}</tex-math><mml:math id="M62"><mml:msup><mml:mi>W</mml:mi><mml:mo>″</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq28.gif"/></alternatives></inline-formula> is a constant. Therefore, in an average case, the time complexity in the while loop of <italic>IDPforCSCCP</italic> reduces to <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ O(89nR\bar{K}\log R\bar{K}) $$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>89</mml:mn><mml:mi>n</mml:mi><mml:mi>R</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>log</mml:mo><mml:mi>R</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq29.gif"/></alternatives></inline-formula>. The rest of the while loop in <italic>IDPforCSCCP</italic> requires only <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ O(R) $$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq30.gif"/></alternatives></inline-formula> to check the size and the weight, and thus, we can ignore this step. Finally, we considered the number of executed while loops. For each while loop, <italic>R</italic> is multiplied by 10. In the first while loop, the program executes in <inline-formula id="IEq31"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ O(89n10R^{{\prime }} \bar{K}\log 10R^{{\prime }} \bar{K}) $$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>89</mml:mn><mml:mi>n</mml:mi><mml:mn>10</mml:mn><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>log</mml:mo><mml:mn>10</mml:mn><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq31.gif"/></alternatives></inline-formula>; in the second while loop, the program executes in <inline-formula id="IEq32"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ O(89n10^{2} R^{{\prime }} \bar{K}\log 10^{2} R^{{\prime }} \bar{K}) $$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>89</mml:mn><mml:mi>n</mml:mi><mml:msup><mml:mn>10</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>log</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq32.gif"/></alternatives></inline-formula>; and so on. Assuming that the while loop is executed <italic>L</italic> times, the total time complexity of <italic>IDPforCSCCP</italic> then becomes <inline-formula id="IEq33"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathop \sum \nolimits_{i = 1}^{L} \left( {89n10^{i} R\bar{K}\log 10^{i} R\bar{K}} \right) $$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:msubsup><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>89</mml:mn><mml:mi>n</mml:mi><mml:msup><mml:mn>10</mml:mn><mml:mi>i</mml:mi></mml:msup><mml:mi>R</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>log</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mi>i</mml:mi></mml:msup><mml:mi>R</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq33.gif"/></alternatives></inline-formula> for the average case. When <italic>L</italic> is sufficiently small, the <italic>CSCCP</italic> can be ideally solved in polynomial time, on average, using our iterative DP algorithm, <italic>IDPforCSCCP</italic>. We will discuss the value of <italic>L</italic> in the subsequent section. We noted that in the previous <italic>DPforCSCCP</italic> algorithm, even if <inline-formula id="IEq34"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W^{{\prime }} $$\end{document}</tex-math><mml:math id="M74"><mml:msup><mml:mi>W</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq34.gif"/></alternatives></inline-formula> is set to <inline-formula id="IEq35"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ 89 \times 10^{D} $$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mn>89</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq35.gif"/></alternatives></inline-formula>, the time complexity is still near exponential. Because <inline-formula id="IEq36"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W^{{\prime }} $$\end{document}</tex-math><mml:math id="M78"><mml:msup><mml:mi>W</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq36.gif"/></alternatives></inline-formula> has to be converted into an integer number and the precision number <italic>D</italic> is typically set to at least 6, the time complexity of the <italic>DPforCSCCP</italic> algorithm can only be reduced to <inline-formula id="IEq37"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ O\left( {10^{6} \times 89nR\bar{K}\log R\bar{K}} \right) $$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msup><mml:mn>10</mml:mn><mml:mn>6</mml:mn></mml:msup><mml:mo>×</mml:mo><mml:mn>89</mml:mn><mml:mi>n</mml:mi><mml:mi>R</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>log</mml:mo><mml:mi>R</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq37.gif"/></alternatives></inline-formula> for the average case.</p>
      <p id="Par16">The number of while loop iterations (<italic>L</italic>) is the main factor that improves the time performance of the <italic>IDPforCSCCP</italic> algorithm over the <italic>DPforCSCCP</italic> algorithm. We used while loops to overcome the limitation of the number of decimal places of the mass (D) in the <italic>DPforCSCCP</italic> algorithm. According to the analysis of the time complexity in <italic>IDPforCSCCP</italic>, <italic>L</italic> is a dominant factor affecting the time performance of the algorithm. In Table <xref rid="Tab5" ref-type="table">5</xref>, we list the values of <italic>L</italic> executed by the <italic>IDPforCSCCP</italic> algorithm in the four tested natural products. Because the <italic>IDPforCSCCP</italic> algorithm can finish within three loops for all tested cases, three situations in Table <xref rid="Tab5" ref-type="table">5</xref> are considered: the first situation involves cases in which the <italic>IDPforCSCCP</italic> algorithm finished in only one while loop, the second one involves cases in which the <italic>IDPforCSCCP</italic> algorithm ran to completion in exactly two while loops, and the last represents cases in which the <italic>IDPforCSCCP</italic> algorithm finished in exactly three while loops. The second to fourth columns in Table <xref rid="Tab5" ref-type="table">5</xref> list the number of executed <italic>CSCCPs</italic> in each tested case based on the three situations. The percentages of the numbers occurring in the three situations are indicated in parentheses. In 99% of the situations, the <italic>IDPforCSCCP</italic> algorithm finished in only one loop. Only a few cases required two or three loops for calculation, and no cases required more than three loops. The <italic>IDPforCSCCP</italic> breaks in the first while loop only when the number of current solutions in which the total weights match to the <inline-formula id="IEq38"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W^{{\prime \prime }} $$\end{document}</tex-math><mml:math id="M82"><mml:msup><mml:mi>W</mml:mi><mml:mo>″</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq38.gif"/></alternatives></inline-formula> in the first loop are less than <italic>R</italic>, or when more than <italic>R</italic> optimal solutions was found in the first loop. The main idea behind <italic>IDPforCSCCP</italic> for acceleration of structural elucidation is by removing all decimal digits of molecular weight. In the low incidence of cases where the <italic>IDPforCSCCP</italic> required more than one loop indicates the elimination of decimal digits is unlikely to affect the precision of structure elucidation or the search for optimal solutions. Therefore, the two breaking conditions are satisfied with high incidence in the end of the first while loop.<table-wrap id="Tab5"><label>Table 5</label><caption><p>Running iterations of the while loop executed using the <italic>IDPforCSCCP</italic> algorithm for our four tested herbs</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Tested herbs</th><th align="left"># of running iterations executed within one loop</th><th align="left"># of running iterations executed in exactly 2 loops</th><th align="left"># of running iterations executed in exactly 3 loops</th></tr></thead><tbody><tr><td align="left"><italic>C. chinensis</italic></td><td char="(" align="char">975 (99.9%)</td><td char="(" align="char">1 (0.1%)</td><td char="(" align="char">0 (0%)</td></tr><tr><td align="left"><italic>O. japonicus</italic></td><td char="(" align="char">164 (100%)</td><td char="(" align="char">0 (0%)</td><td char="(" align="char">0 (0%)</td></tr><tr><td align="left"><italic>P. multiflorum</italic></td><td char="(" align="char">1338 (98.5%)</td><td char="(" align="char">16 (1.2%)</td><td char="(" align="char">4 (0.3%)</td></tr><tr><td align="left"><italic>Angelica</italic> sp.</td><td char="(" align="char">4084 (100%)</td><td char="(" align="char">0 (0%)</td><td char="(" align="char">0 (0%)</td></tr></tbody></table><table-wrap-foot><p>The numbers in parentheses are the percentage of occurrence of the three situations listed in the second to fourth columns</p></table-wrap-foot></table-wrap>
</p>
      <p id="Par17">Assuming that the number of while loop iterations is only 1, the time complexity of the entire <italic>IDPforCSCCP</italic> algorithm only requires <inline-formula id="IEq39"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ O\left( {89n\bar{K}R^{{\prime }} \log \bar{K}R^{{\prime }} } \right) $$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>89</mml:mn><mml:mi>n</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>log</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq39.gif"/></alternatives></inline-formula> time for the average case, where <inline-formula id="IEq40"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \bar{K} = (\mathop \sum \nolimits_{i = 1}^{n} K_{i} )/n $$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ R^{{\prime }} $$\end{document}</tex-math><mml:math id="M88"><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq41.gif"/></alternatives></inline-formula> is 100. Thus, the time complexity of <italic>IDPforCSCCP</italic> can be further reduced to <inline-formula id="IEq42"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ O\left( {8900n\bar{K}\log 100\bar{K}} \right) $$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>O</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mn>8900</mml:mn><mml:mi>n</mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover><mml:mo>log</mml:mo><mml:mn>100</mml:mn><mml:mover accent="true"><mml:mrow><mml:mi>K</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">¯</mml:mo></mml:mrow></mml:mover></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq42.gif"/></alternatives></inline-formula> for the average case. Therefore, our novel CASE procedure developed using the iterative DP algorithm can automatically elucidate the unknown structures in complex mixtures within reasonable polynomial time for the average case.</p>
    </sec>
    <sec id="Sec5">
      <title>Time performance comparison with traditional algorithms</title>
      <p id="Par18">In this section, the time performances of the <italic>DPforCSCCP</italic> and <italic>IDPforCSCCP</italic> algorithms were compared with those of traditional methods, including the brute force (BF) method and the branch and bound (BB) strategy. The total execution times of the BF, BB, <italic>DPforCSCCP</italic> and <italic>IDPforCSCCP</italic> algorithms for the elucidation of the main structures in the four natural products are listed in Table <xref rid="Tab6" ref-type="table">6</xref>. The first column represents the tested natural products. The second to fifth columns give the execution time (in seconds) for the BF, BB, <italic>DPforCSCCP</italic>, <italic>and IDPforCSCCP</italic> algorithms, respectively. In <italic>DPforCSCCP</italic>, we set the number of decimal places of the mass (<inline-formula id="IEq43"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ D $$\end{document}</tex-math><mml:math id="M92"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq43.gif"/></alternatives></inline-formula>) to 2 because the main structures of the four natural products predicted from <italic>DPforCSCCP</italic> were all matched to the validated structures when the parameter <italic>D</italic> was set to at least 2. More than 3 years of computation time would be required to finish structural elucidation in the <italic>CSCCP</italic> using the BF algorithm for <italic>C. chinensis</italic>, and more than 6 years would be required using the BF algorithm for <italic>P. multiflorum</italic>. The execution times of the BF algorithm for <italic>C. chinensis</italic> and <italic>P. multiflorum</italic> were both extremely large. The main reason for such long execution times was that the BF searching method requires the examination of all combinations of <italic>seed scaffolds</italic> and side chains. The maximal numbers of side chain combinations (<inline-formula id="IEq44"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \prod\nolimits_{i = 1}^{n} {K_{i} } $$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq44.gif"/></alternatives></inline-formula>) in <italic>CSCCP</italic> for <italic>C. chinensis</italic> and <italic>P. multiflorum</italic> are 41,249,161,384,704 and 2,429,941,913,502,481. Note that the numbers of <italic>seed scaffolds</italic>, <italic>targeted MWs</italic>, and possible sets of positions on the seed scaffolds were not considered in the maximal numbers. Obviously, the thousands of trillions of calculations in the BF algorithm resulted in an unreasonable execution time for structural elucidation in these two cases. Even if parallel programming is applied to solve the BF algorithm, the method still cannot finish within a reasonable time. The traditional BB method can obviously improve the time performance in the four tested cases. However, the BB algorithm still required more than 1 day for the structural identification of <italic>P. multiflorum</italic> and <italic>Angelica</italic> sp.<table-wrap id="Tab6"><label>Table 6</label><caption><p>Time performance comparison between the BF, BB, <italic>DPforCSCCP</italic> and <italic>IDPforCSCCP</italic> algorithms</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Cases</th><th align="left" colspan="4">Execution time<break/>seconds (min)</th></tr><tr><th align="left">BF</th><th align="left">BB</th><th align="left"><italic>DPfor CSCCP</italic></th><th align="left"><italic>IDPfor CSCCP</italic></th></tr></thead><tbody><tr><td align="left"><italic>C. chinensis</italic></td><td align="left">&gt; 3 years</td><td align="left">914 (15.2)</td><td char="(" align="char">3757 (62.6)</td><td char="(" align="char">17 (0.3)</td></tr><tr><td align="left"><italic>O. japonicus</italic></td><td align="left">177 (3.0)</td><td align="left">141 (2.4)</td><td char="(" align="char">12 (0.2)</td><td char="(" align="char">0.75 (0.01)</td></tr><tr><td align="left"><italic>P. multiflorum</italic></td><td align="left">&gt; 6 years</td><td align="left">&gt; 1 days</td><td char="(" align="char">1079 (18.0)</td><td char="(" align="char">67 (1.1)</td></tr><tr><td align="left"><italic>Angelica</italic> sp.</td><td align="left">&gt; 80 days</td><td align="left">~ 1 days</td><td char="(" align="char">3919 (65.3)</td><td char="(" align="char">188 (3.1)</td></tr></tbody></table></table-wrap>
</p>
      <p id="Par19">In our <italic>DPforCSCCP</italic> algorithm, the program finished within 1.5 h for all cases. In the case of <italic>P. multiflorum</italic>, which is the most complex example, our DP algorithm reduced the execution from 6 years by BF to 1079 s (18 min). The execution time of the DP algorithm is also much faster than the BB algorithm for all tested cases, except <italic>C. chinensis</italic>. The time performance of the BB algorithm for <italic>C. chinensis</italic> is 4 times faster than that of the <italic>DPforCSCCP</italic> algorithm, whereas the time performance of <italic>DPforCSCC</italic>P algorithm for <italic>O. japonicus</italic>, <italic>P. multiflorum</italic>, and <italic>Angelica</italic> sp. is 12–80 times faster than that of the BB algorithm. For the extreme case of <italic>P. multiflorum</italic>, the execution time of the BB algorithm requires over 1 day, whereas for the <italic>DPforCSCCP</italic> algorithm, only 1079 s (18 min) are needed. This result confirms that our developed <italic>DPforCSCCP</italic> algorithm can be executed in polynomial time for an average case and is faster than the BB algorithm. However, as <inline-formula id="IEq45"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ D $$\end{document}</tex-math><mml:math id="M96"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq45.gif"/></alternatives></inline-formula> increases, the execution time for <italic>DPforCSCCP</italic> may become lower than that for the BB algorithm or even the BF algorithm (Lemma 5). The iterative DP algorithm, <italic>IDPforCSCCP</italic>, can perform the structural elucidation without setting the parameter <italic>D</italic>. To confirm that the <italic>IDPforCSCCP</italic> algorithm outperforms the <italic>DPforCSCCP</italic> algorithm in the four tested cases, we present the execution time of the <italic>IDPforCSCCP</italic> algorithm for the four natural products in Table <xref rid="Tab6" ref-type="table">6</xref>. The execution times range from 12.18 to 3919.70 s (0.2–65.3 min) for <italic>DPforCSCCP</italic> and from 0. 75 to 188.44 s (0.01–3.1 min) for <italic>IDPforCSCCP</italic>. <italic>IDPforCSCCP</italic> finished within 3 min in all cases. On average, the time performance of <italic>IDPforCSCCP</italic> is 67 times better than that of <italic>DPforCSCCP</italic>. For the extreme case of <italic>P. multiflorum</italic>, the <italic>IDPforCSCCP</italic> algorithm reduced the execution time from 6 years by BF to close to 1 min. Our iterative DP algorithm is much more efficient than the BF, BB, and our original DP algorithms.</p>
      <p id="Par20">Several approaches including the BF, BB, <italic>DPforCSCCP</italic> and <italic>IDPforCSCCP</italic> algorithms were applied to solve the CASE problem in this study. The BF and BB algorithms blindly check all combinatorial candidates for the substituted positions in the scaffold, while the two DP algorithms, <italic>DPforCSCCP</italic> and <italic>IDPforCSCCP</italic>, formulate the <italic>CSCCP</italic> in terms of a cost equation and save each solution of each sub-problem for the effective generation of optimal solutions. The <italic>IDPforCSCCP</italic> algorithm can reduce a large number of combinations of side chains to identify the main structures in natural products without the limitation of the number of decimal places of the mass, thus further accelerating the identification procedures. <italic>IDPforCSCCP</italic> would realize the spectroscopist’s dream of fully automated structural elucidation.</p>
    </sec>
    <sec id="Sec6">
      <title>Improvement in the structural elucidation results using the iterative DP algorithm</title>
      <p id="Par21">Using the iterative DP algorithm, we can search for optimal solutions for structural elucidation without any limitations, compared to the previous study by Harn [<xref ref-type="bibr" rid="CR29">29</xref>]. A large number of possible sets of positions (<italic>N</italic>
<sub><italic>k</italic></sub>) that can be linked by the side chains on the <italic>seed scaffolds</italic> could result in an unreasonable execution time for structural elucidation. To reduce the execution time when applying the BB algorithm, the parameter <italic>N</italic>
<sub><italic>k</italic></sub> was limited to 5, at most, in Harn’s CASE tool [<xref ref-type="bibr" rid="CR29">29</xref>]. Thus, the structures identified using Harn’s algorithm may be trapped in a local optimum. In the iterative DP algorithm, the variable <italic>N</italic>
<sub><italic>k</italic></sub> does not need to be limited, as our algorithm is much more efficient than the BB algorithm. We took the herb <italic>C. chinensis</italic> as an example to demonstrate the differentiation between our global optimal results and local optimal results determined by the BB algorithm. Table <xref rid="Tab7" ref-type="table">7</xref> gives the number of structures identified with the BB and <italic>IDPforCSCCP</italic> algorithms for the different <italic>targeted MWs</italic> of <italic>C. chinensis</italic> with the given <italic>seed scaffolds.</italic> The number of structures identified by the BB algorithm ranged from 3 to 18 for scaffold 1 and from 149 to 300 for scaffold 2, while the number identified by <italic>IDPforCSCCP</italic> ranged from 4 to 116 for scaffold 1 and from 1802 to 2006 for scaffold 2. Eight times more structures were recognized by the <italic>IDPforCSCCP</italic> algorithm than by the BB method in this example because <italic>IDPforCSCCP</italic> can maximize the chemical searching space in the <italic>CSCCP</italic>. We also show the top-ranking structures identified by Harn’s method with the limitation of <italic>N</italic>
<sub><italic>k</italic></sub> = 5 in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a and that identified by the <italic>IDPforCSCCP</italic> algorithm without limitation of <italic>N</italic>
<sub><italic>k</italic></sub> in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b for the <italic>targeted MW</italic> of 354.31 in <italic>C. chinensis</italic> with <italic>seed scaffold</italic> 1. The estimated probabilities of the potential main structures in <italic>C. chinensis</italic> are also shown below each structure. The <italic>IDPforCSCCP</italic> algorithm can identify a top-ranked structure with higher probability than the BB method. When the value of <italic>N</italic>
<sub><italic>k</italic></sub> was limited, the program cannot search all side chain combinations to recognize the optimal structure for a given <italic>targeted MW</italic>. High-performance computing by <italic>IDPforCSCCP</italic> enables complete structure searches without limitation of <italic>N</italic>
<sub><italic>k</italic></sub> for identification of the correct main structures in natural products.
<table-wrap id="Tab7"><label>Table 7</label><caption><p>Number of structures identified by the branch and bound and <italic>IDPforCSCCP</italic> algorithm for the four different <italic>targeted MWs</italic> of <italic>C. chinensis</italic> with the given <italic>seed scaffold</italic>s</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2"><italic>Targeted MWs</italic></th><th align="left" colspan="2">Number of identified structures (Brach and bound (<italic>N</italic>
<sub><italic>k</italic></sub> = 5), <italic>IDPforCSCCP)</italic>
</th></tr><tr><th align="left">Scaffold 1</th><th align="left">Scaffold 2</th></tr></thead><tbody><tr><td align="left">286.24</td><td align="left">(3, 4)</td><td align="left">(149, 1936)</td></tr><tr><td align="left">302.24</td><td align="left">(12, 24)</td><td align="left">(196, 1802)</td></tr><tr><td align="left">354.31</td><td align="left">(3, 29)</td><td align="left">(300, 2006)</td></tr><tr><td align="left">478.41</td><td align="left">(18, 116)</td><td align="left">(300, 1995)</td></tr></tbody></table><table-wrap-foot><p>Each cell contains two numbers. The first is the number of structures identified by the branch and bound method (<italic>N</italic>
<sub><italic>k</italic></sub> = 5), and the second is for the number of structures identified by the <italic>IDPforCSCCP</italic> algorithm without limitation of <italic>N</italic>
<sub><italic>k</italic></sub>
</p></table-wrap-foot></table-wrap>
<fig id="Fig2"><label>Fig. 2</label><caption><p>The top-ranking results identified by the branch and bound method with the limitation of <italic>N</italic>
<sub><italic>k</italic></sub> = 5 (<bold>a</bold>) and the <italic>IDPforCSCCP</italic> algorithm without limitation of <italic>N</italic>
<sub><italic>k</italic></sub> (<bold>b</bold>) for the <italic>targeted MW</italic> of 354.31 in <italic>C. chinensis</italic> with <italic>seed scaffold</italic> 1</p></caption><graphic xlink:href="13321_2017_244_Fig2_HTML" id="MO5"/></fig>
</p>
      <p id="Par22">To demonstrate the actual improvement in the structural elucidation results using the iterative DP algorithm, we compared the identification results of the structural elucidation of <italic>Angelica</italic> sp. Harn’s CASE tool cannot correctly predict twelve structures out of a total of forty-five main compounds in this case. In fact, the overall prediction rate for our <italic>IDPforCSCCP</italic> algorithm increased to 82%. Four additional structures, including Imperatorin, Isoimperatorin, Umbelliprenin, and Ostruthol, were further correctly identified in our study (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3). <italic>IDPforCSCCP</italic> indeed improved both the time performance and prediction accuracy for the structural elucidation of natural products. In fact, <italic>IDPforCSCCP</italic> still failed to predict some main structures since our system can only utilize the collected side chains to construct possible structures on the scaffolds. If additional common or structurally related side chains were manually input to our database, <italic>IDPforCSCCP</italic> would be able to correctly predict these failed structures.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Conclusions</title>
    <p id="Par23">For the structural elucidation of complex natural products, we defined a new <italic>CSCCP</italic> problem based only on the information obtained from MS spectra. Theoretically, to solve the <italic>CSCCP</italic>, exponential time should be required in the worst-case scenario. We designed a novel CASE algorithm by applying a classical DP algorithm to search for the optimal solutions, and the time complexity was in pseudo-polynomial time. However, the higher precision of the molecular weight required, the higher the time complexity of our DP algorithm, even reaching exponential time. We thus developed an iterative DP algorithm that can be executed in polynomial time for the average case. Four real natural products, <italic>C. chinensis</italic>, <italic>O. japonicus</italic>, <italic>P. multiflorum</italic>, and <italic>Angelica</italic> sp., were applied in our study to verify the results and time performance of our algorithm. The execution time was compared with that of the BF and BB algorithms. Our iterative DP algorithm outperformed the BF and BB programs. In addition, we could really elucidate the correct structures in herbs derived from a previous study. Because the time performance of our algorithm is more efficient than those of the other algorithms, we could search for the real optimal solutions in an acceptable time in the four tested cases without the limitation described in previous studies of the number of combinatorial candidates of the substituted positions in each scaffold. The proposed efficient algorithm provides a new tool for spectroscopists to aid in the structural elucidation of unknown complex mixtures when only MS spectral information is known. A web service built for structural elucidation is freely accessible (<ext-link ext-link-type="uri" xlink:href="http://csccp.cmdm.tw/">http://csccp.cmdm.tw/</ext-link>).</p>
  </sec>
  <sec id="Sec8">
    <title>Methods</title>
    <sec id="Sec9">
      <title>Data Set</title>
      <p id="Par24">Four types of herbs were used to validate the accuracy and time efficiency of our prediction method: <italic>Cuscuta chinensis</italic> (<italic>C. chinensis</italic>), <italic>Ophiopogon japonicus</italic> (<italic>O. japonicus</italic>), <italic>Polygonum multiflorum</italic> (<italic>P. multiflorum</italic>), and <italic>Angelica sp</italic>. A list of possible scaffolds (<italic>seed scaffolds</italic>) for the tested herbs obtained from the preliminary LC–MS identification procedures from the Natural Product Laboratory of the Taiwan Medical and Pharmaceutical Industry Technology and Development Center (PITDC) is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. A preliminary identification of the high-intensity mass peaks was also performed, and the possible molecular weights (<italic>targeted MWs</italic>) of the tested herbs derived from the peak tables are listed in Table <xref rid="Tab1" ref-type="table">1</xref>. The possible <italic>seed scaffolds</italic> and the list of <italic>targeted MWs</italic> were used as input in our new CASE program. The procedure is used to elucidate the possible main chemical structures in herbs containing the list of possible <italic>seed scaffolds</italic> to match the peaks corresponding to the given <italic>targeted MWs</italic>. To combine different side chains on the <italic>seed scaffolds</italic> for identification of most of the possible main structures in the herbs, a database containing a list of possible side chains that can attach on the <italic>seed scaffolds</italic> from natural products was generated. The collected natural product database included the Dictionary of Natural Products (DNP) [<xref ref-type="bibr" rid="CR33">33</xref>], “ZINC natural products” subset of ZINC [<xref ref-type="bibr" rid="CR34">34</xref>], and the Traditional Chinese Medicine Database (TCMD, updated on 2010-07-14) [<xref ref-type="bibr" rid="CR35">35</xref>]. The number of natural products that contain ring structures is 82,847, and only these compounds were considered. Furthermore, the Natural Product Laboratory of PITDC has identified a list of main structures of each herb with their LC–MS/MS procedures. The verified main structures of each herb were provided in the results and discussion section and were used as a baseline for the evaluation of our prediction results.</p>
    </sec>
    <sec id="Sec10">
      <title>Definitions of the structural elucidation problem</title>
      <p id="Par25">Our new CASE system identified main structures that matched the <italic>targeted MWs</italic> of herbs by combining the known <italic>seed scaffolds</italic> with a list of possible side chains. The procedure was defined as a Chemical Substituents-Core Combinatorial Problem (<italic>CSCCP</italic>) in the studies. The scaffold (core) of the compounds represented a common substructure of molecules that may have similar biological activities, and a side chain (substituent) denoted a chemical group that is attached to the scaffold. The position of an atom between the scaffold and a side chain is called a substituted position. A compound may have many different substituted positions, and each substituted position on a scaffold can also be linked by many different attached side chains. For each <italic>seed scaffold</italic>, according to the analysis of the relationship between the scaffolds and side chains from our collected natural product database, we can compute the attaching probabilities of the side chains that can link to each substituted positions of that scaffold. The main procedure of our new CASE method utilized this information to elucidate chemical structures, and the formal definition of the <italic>CSCCP</italic> (Definition 1) was as follows.</p>
      <sec id="FPar1">
        <title>
          <bold>Definition 1</bold>
        </title>
        <p id="Par26">Given a chemical scaffold with n possible substituted positions, let <inline-formula id="IEq46"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ s \in \{ 1,2, \ldots ,n\} $$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq46.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq47"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ s $$\end{document}</tex-math><mml:math id="M100"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq47.gif"/></alternatives></inline-formula> is a variable representing only the considered substituted positions from <inline-formula id="IEq48"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ 1,2, \ldots , s $$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq48.gif"/></alternatives></inline-formula>. <italic>X</italic>
<sub><italic>s</italic></sub> is all sets of possible side chains from position <inline-formula id="IEq49"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ 1,2, \ldots , s $$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq49.gif"/></alternatives></inline-formula>. Let <inline-formula id="IEq50"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ i \in \{ 1,2, \ldots ,s\} $$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq50.gif"/></alternatives></inline-formula>, where <italic>i</italic> represents the <italic>i</italic>th substituted position when the substituted positions from <inline-formula id="IEq51"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ 1,2, \ldots , s $$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq51.gif"/></alternatives></inline-formula> are considered. <inline-formula id="IEq52"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ K_{i} $$\end{document}</tex-math><mml:math id="M110"><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq52.gif"/></alternatives></inline-formula> is the number of side chains that can be linked to the scaffold at position <inline-formula id="IEq53"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ i $$\end{document}</tex-math><mml:math id="M112"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq53.gif"/></alternatives></inline-formula>. Therefore, <inline-formula id="IEq54"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \left| {X_{s} } \right| = K_{1} K_{2} \ldots K_{s} . $$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mfenced close="|" open="|" separators=""><mml:msub><mml:mi>X</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>K</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq54.gif"/></alternatives></inline-formula> The <inline-formula id="IEq55"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ x_{i} $$\end{document}</tex-math><mml:math id="M116"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq55.gif"/></alternatives></inline-formula>th substituent at position <inline-formula id="IEq56"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ i $$\end{document}</tex-math><mml:math id="M118"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq56.gif"/></alternatives></inline-formula> of the scaffold, where <inline-formula id="IEq57"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ x_{i} \in \{ 1,2, \ldots ,K_{i} \} $$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq57.gif"/></alternatives></inline-formula>, has a known probability <inline-formula id="IEq58"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ p_{{i,x_{i} }} \in [0, 1] $$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq58.gif"/></alternatives></inline-formula>, representing its frequency of occurrence in nature, and a molecular weight <inline-formula id="IEq59"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ m_{{i,x_{i} }} $$\end{document}</tex-math><mml:math id="M124"><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq59.gif"/></alternatives></inline-formula>, which is a nonzero positive floating point number. The problem is the generation of chemical structures that extend a set of possible substituents to the scaffold while satisfying [<xref ref-type="bibr" rid="CR1">1</xref>] the condition that the product of the probabilities of all extending substituents is maximized and [<xref ref-type="bibr" rid="CR2">2</xref>] the total molecular weight of the extending substituents is equal to a specified target molecular weight, <inline-formula id="IEq60"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0} $$\end{document}</tex-math><mml:math id="M126"><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq60.gif"/></alternatives></inline-formula>. Furthermore, the top <italic>R</italic> optimal solutions of this optimization problem were the output predicted structures of this problem. When <italic>R</italic> is 1, the optimal solution only includes the highest <inline-formula id="IEq61"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \prod\nolimits_{i = 1}^{n} {p_{{i,x_{i} }} } $$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq61.gif"/></alternatives></inline-formula> value in which the total weight is equal to <inline-formula id="IEq62"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0} $$\end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq62.gif"/></alternatives></inline-formula>. R is an integer parameter in the system. Each substituted position on the scaffold can only be extended by one side chain. The CSCCP can be defined as the following floating point linear programming formulation:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathop {\hbox{max} }\limits_{top R} \mathop \prod \limits_{i = 1}^{n} p_{{i,x_{i} }} $$\end{document}</tex-math><mml:math id="M132" display="block"><mml:mrow><mml:munder><mml:mtext>max</mml:mtext><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mi>R</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><graphic xlink:href="13321_2017_244_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathop \sum \limits_{i = 1}^{n} m_{{i,x_{i} }} = W_{0} $$\end{document}</tex-math><mml:math id="M134" display="block"><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><graphic xlink:href="13321_2017_244_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>
<disp-formula id="Equb"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ x_{i} \in \left\{ {1,2, \ldots ,K_{i} } \right\},\forall i \in \left\{ {1,2, \ldots ,n} \right\} $$\end{document}</tex-math><mml:math id="M136" display="block"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="13321_2017_244_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>
</p>
        <p>Figure <xref rid="Fig3" ref-type="fig">3</xref> provides an example illustrating the <italic>CSCCP</italic> optimization problem. Here, given a <italic>seed scaffold</italic> with three substituted positions (<italic>n</italic> = 3), the side chain list for each substituted position (<italic>K</italic>
<sub>1</sub> = 2, <italic>K</italic>
<sub><italic>2</italic></sub> = 2, <italic>K</italic>
<sub>3</sub> = 2), and a target molecular weight (<inline-formula id="IEq63"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0} $$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq63.gif"/></alternatives></inline-formula> = 98), each side chain has a pair of molecular weight and occurrence probability values (<italic>m</italic>
<sub>1,1</sub> = 15, <italic>m</italic>
<sub>1,2</sub> = 17, <italic>m</italic>
<sub>2,1</sub> = 17, <italic>m</italic>
<sub>2,2</sub> = 62, <italic>m</italic>
<sub>3,1</sub> = 17, <italic>m</italic>
<sub>3,2</sub> = 62; <italic>p</italic>
<sub>1,1</sub> = 0.2, <italic>p</italic>
<sub>1,2</sub> = 0.8, <italic>p</italic>
<sub>2,1</sub> = 0.8, <italic>p</italic>
<sub>2,2</sub> = 0.2, <italic>p</italic>
<sub>3,1</sub> = 0.2, <italic>p</italic>
<sub>3,2</sub> = 0.8). Two out of a total of eight combinations of side chains generates the structures with the total molecular weight of 98 in this example. The first optimal solution has the highest <inline-formula id="IEq64"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \prod\nolimits_{i = 1}^{n} {p_{{i,x_{i} }} } $$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq64.gif"/></alternatives></inline-formula> value of 0.512, and the second optimal solution has the second highest <inline-formula id="IEq65"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \prod\nolimits_{i = 1}^{n} {p_{{i,x_{i} }} } $$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq65.gif"/></alternatives></inline-formula> value of 0.032. When R is 1, the first optimal solution is the result of predicted structure. In fact, to identify the correct main structures in the natural product, more than one possible <italic>seed scaffold</italic> should be given. Moreover, for a given <italic>seed scaffold</italic>, all combinations of side chains derived from sets of different substituted positions should be considered to generate possible compound candidates. For example, a scaffold has a set of possible substituted positions (for example, in Fig. <xref rid="Fig1" ref-type="fig">1</xref>) for R1, R2, and R3 and may have different candidates for other positions. Therefore, the complexity of these conditions makes the <italic>CSCCP</italic> difficult to be completed in a reasonable time.<fig id="Fig3"><label>Fig. 3</label><caption><p>An example structural elucidation defined in our <italic>CSCCP</italic> problem</p></caption><graphic xlink:href="13321_2017_244_Fig3_HTML" id="MO9"/></fig>
</p>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>DP algorithm</title>
      <p id="Par28">In this study, we first proposed a DP algorithm as our new CASE strategy that can be executed in pseudo-polynomial time complexity to find the optimal solutions in the <italic>CSCCP</italic>. The optimization problem of <italic>CSCCP</italic> has been defined in Definition 1 by Eqs. <xref rid="Equ1" ref-type="">1</xref>
<xref rid="Equ1" ref-type="">1</xref> and <xref rid="Equ2" ref-type="">2</xref>. The <italic>CSCCP</italic> can also be represented by a cost function defined as follows:</p>
      <sec id="FPar2">
        <title>
          <bold>Definition 2</bold>
        </title>
        <p id="Par29">(<italic>CSCCP cost function, C</italic>) In the CSCCP, <inline-formula id="IEq66"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ n $$\end{document}</tex-math><mml:math id="M144"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq66.gif"/></alternatives></inline-formula> denotes the number of substituted positions on a given seed scaffold, and <inline-formula id="IEq67"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0} $$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq67.gif"/></alternatives></inline-formula> is the targeted MW, as defined in Definition 1. A CSCCP cost function <inline-formula id="IEq68"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C:\left\{ {s|1 \le s \le n,s \in N} \right\} \times \left\{ {w|1 \le w \le W_{0} ,w \in N} \right\} \times \{ r|1 \le r \le R,r \in N\} \to \left[ {0, 1} \right] $$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:mi>C</mml:mi><mml:mo>:</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mi>s</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>s</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>w</mml:mi><mml:mo>≤</mml:mo></mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfenced><mml:mo>×</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>r</mml:mi><mml:mo>≤</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo stretchy="false">→</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq68.gif"/></alternatives></inline-formula>, is defined such that <inline-formula id="IEq69"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(s,w,r) $$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq69.gif"/></alternatives></inline-formula> represents the highest <inline-formula id="IEq70"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ r $$\end{document}</tex-math><mml:math id="M152"><mml:mi>r</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq70.gif"/></alternatives></inline-formula>th value of <inline-formula id="IEq71"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \prod\nolimits_{i = 1}^{s} {p_{{i,x_{i} }} } $$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq71.gif"/></alternatives></inline-formula> when only <italic>s</italic> out of <italic>n</italic> positions are substituted by side chains and the total weight of the selected side chains is equal to <italic>w</italic>
<inline-formula id="IEq72"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ (\sum\nolimits_{i = 1}^{s} {m_{{i,x_{i} }} } = w) $$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>w</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq72.gif"/></alternatives></inline-formula>, where <italic>w</italic> is an integer number. If the original molecular weights <inline-formula id="IEq73"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0} $$\end{document}</tex-math><mml:math id="M158"><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq73.gif"/></alternatives></inline-formula> and <inline-formula id="IEq74"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ m_{{i,x_{i} }} $$\end{document}</tex-math><mml:math id="M160"><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq74.gif"/></alternatives></inline-formula> are floating point numbers, they are transformed to integers for the following analysis. Therefore, <inline-formula id="IEq75"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(s,w,r) $$\end{document}</tex-math><mml:math id="M162"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq75.gif"/></alternatives></inline-formula> corresponds to a sub-problem of the CSCCP since only <italic>s</italic> substituted positions are considered. The <italic>r</italic> highest values of <inline-formula id="IEq76"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \prod\nolimits_{i = 1}^{s} {p_{{i,x_{i} }} } ,x_{i} \in \left\{ {1,2, \ldots ,K_{i} } \right\},\forall i \in \left\{ {1,2, \ldots ,s} \right\} $$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq76.gif"/></alternatives></inline-formula> are denoted as <inline-formula id="IEq77"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(s,w,1:r) $$\end{document}</tex-math><mml:math id="M166"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq77.gif"/></alternatives></inline-formula>, where “1:<italic>r</italic>” denotes “from 1 to <italic>r</italic>”. The goal of the CSCCP is to find the <italic>R</italic> highest values <inline-formula id="IEq78"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(n,W_{0} ,1:R) $$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq78.gif"/></alternatives></inline-formula> of <inline-formula id="IEq79"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \prod\nolimits_{i = 1}^{n} {p_{{i,x_{i} }} } $$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq79.gif"/></alternatives></inline-formula> satisfying <inline-formula id="IEq80"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \sum\nolimits_{i = 1}^{n} {m_{{i,x_{i} }} } = W_{0} , $$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq80.gif"/></alternatives></inline-formula> where <inline-formula id="IEq81"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hbox{``}1:R\hbox{''} $$\end{document}</tex-math><mml:math id="M174"><mml:mrow><mml:mtext>``</mml:mtext><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>R</mml:mi><mml:mtext>''</mml:mtext></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq81.gif"/></alternatives></inline-formula> denotes “from 1 to <italic>R</italic>”.</p>
        <p>Therefore, the problem of finding the optimal solutions in the <italic>CSCCP</italic> can be regarded as solving a mathematical procedure of the cost function <inline-formula id="IEq82"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C\left( {n,W_{0} ,1:R} \right) $$\end{document}</tex-math><mml:math id="M176"><mml:mrow><mml:mi>C</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq82.gif"/></alternatives></inline-formula>. To compute the cost function, we first need to set the initial configurations of the cost function. The initial condition of <inline-formula id="IEq83"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(s,w,r) $$\end{document}</tex-math><mml:math id="M178"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq83.gif"/></alternatives></inline-formula> obeys the following Lemma 1.</p>
      </sec>
      <sec id="FPar3">
        <title>
          <bold>Lemma 1</bold>
        </title>
        <p id="Par31">
          <italic>In</italic>
          <inline-formula id="IEq84">
            <alternatives>
              <tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(0,w,r) $$\end{document}</tex-math>
              <mml:math id="M180">
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mi>w</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>r</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:math>
              <inline-graphic xlink:href="13321_2017_244_Article_IEq84.gif"/>
            </alternatives>
          </inline-formula>
          <italic>, for any values of w and r,</italic>
          <inline-formula id="IEq85">
            <alternatives>
              <tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(0,w,r) $$\end{document}</tex-math>
              <mml:math id="M182">
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mi>w</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>r</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:math>
              <inline-graphic xlink:href="13321_2017_244_Article_IEq85.gif"/>
            </alternatives>
          </inline-formula>
          <italic>is 0, except for the case of</italic>
          <inline-formula id="IEq86">
            <alternatives>
              <tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C\left( {0,0,1} \right), $$\end{document}</tex-math>
              <mml:math id="M184">
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mfenced close=")" open="(" separators="">
                    <mml:mrow>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:math>
              <inline-graphic xlink:href="13321_2017_244_Article_IEq86.gif"/>
            </alternatives>
          </inline-formula>
          <italic>in which</italic>
          <inline-formula id="IEq87">
            <alternatives>
              <tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(0,0,1) $$\end{document}</tex-math>
              <mml:math id="M186">
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:math>
              <inline-graphic xlink:href="13321_2017_244_Article_IEq87.gif"/>
            </alternatives>
          </inline-formula>
          <italic>is equal to 1.</italic>
        </p>
        <p>Next, we utilized the dynamic programming strategy to iteratively compute the cost function based on the initial condition defined in Lemma 1. The main concept of the DP method is based on the principle of optimality: for any initial conditions and decisions, the decisions selected over the remaining period must be optimal for the remaining problem, with the states resulting from the previous decisions acting as the initial condition [<xref ref-type="bibr" rid="CR30">30</xref>]. Therefore, to solve the entire <italic>CSCCP</italic> problem, <inline-formula id="IEq88"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(n,W_{0} ,1:R) $$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq88.gif"/></alternatives></inline-formula>, we must compute the sequence of the sub-problems, <inline-formula id="IEq89"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(s,w,1:R) $$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq89.gif"/></alternatives></inline-formula> for <inline-formula id="IEq90"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ s = 1, 2, \ldots , n $$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq90.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq91"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ w = 1,2, \ldots ,W_{0} $$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq91.gif"/></alternatives></inline-formula>. We used Lemma 2 to represent the relationship between the sub-problems.</p>
      </sec>
      <sec id="FPar4">
        <title>
          <bold>Lemma 2</bold>
        </title>
        <p id="Par33">
          <italic>Given the values of</italic>
          <inline-formula id="IEq92">
            <alternatives>
              <tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C\left( {s - 1, 1:w, 1} \right) $$\end{document}</tex-math>
              <mml:math id="M196">
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mfenced close=")" open="(" separators="">
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                      <mml:mo>-</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>:</mml:mo>
                      <mml:mi>w</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:mfenced>
                </mml:mrow>
              </mml:math>
              <inline-graphic xlink:href="13321_2017_244_Article_IEq92.gif"/>
            </alternatives>
          </inline-formula>
          <italic>, we can infer the value of</italic>
          <inline-formula id="IEq93">
            <alternatives>
              <tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(s, w, 1) $$\end{document}</tex-math>
              <mml:math id="M198">
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>s</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>w</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:math>
              <inline-graphic xlink:href="13321_2017_244_Article_IEq93.gif"/>
            </alternatives>
          </inline-formula>
          <italic>using the equation below:</italic>
          <disp-formula id="Equc">
            <alternatives>
              <tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C\left( {s, w, 1} \right) = \mathop {\hbox{max} }\limits_{{x_{s} \in \{ 1,2, \ldots ,K_{s} \} }} \{ p_{{s,x_{s} }} \times C(s - 1, w - m_{{s,x_{s} }} ,1)\} $$\end{document}</tex-math>
              <mml:math id="M200" display="block">
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mfenced close=")" open="(" separators="">
                    <mml:mrow>
                      <mml:mi>s</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>w</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mtext>max</mml:mtext>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mi>s</mml:mi>
                      </mml:msub>
                      <mml:mo>∈</mml:mo>
                      <mml:mrow>
                        <mml:mo stretchy="false">{</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mn>2</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:mo>…</mml:mo>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mi>K</mml:mi>
                          <mml:mi>s</mml:mi>
                        </mml:msub>
                        <mml:mo stretchy="false">}</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mrow>
                    <mml:mo stretchy="false">{</mml:mo>
                    <mml:msub>
                      <mml:mi>p</mml:mi>
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mi>s</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mo>×</mml:mo>
                    <mml:mi>C</mml:mi>
                    <mml:mrow>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mi>s</mml:mi>
                      <mml:mo>-</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mi>w</mml:mi>
                      <mml:mo>-</mml:mo>
                      <mml:msub>
                        <mml:mi>m</mml:mi>
                        <mml:mrow>
                          <mml:mi>s</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mi>s</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>,</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo stretchy="false">)</mml:mo>
                    </mml:mrow>
                    <mml:mo stretchy="false">}</mml:mo>
                  </mml:mrow>
                </mml:mrow>
              </mml:math>
              <graphic xlink:href="13321_2017_244_Article_Equc.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p>According to the principle of DP, the optimal solution of <inline-formula id="IEq94"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(s, w, 1) $$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq94.gif"/></alternatives></inline-formula> can be decided by the optimal solutions in the previous step, <inline-formula id="IEq95"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C\left( {s - 1, 1:w, 1} \right). $$\end{document}</tex-math><mml:math id="M204"><mml:mrow><mml:mi>C</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq95.gif"/></alternatives></inline-formula> In other words, the highest values of <inline-formula id="IEq96"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \prod\nolimits_{i = 1}^{s - 1} {p_{{i,x_{i} }} } $$\end{document}</tex-math><mml:math id="M206"><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq96.gif"/></alternatives></inline-formula> matching the molecular weights from 1 to <inline-formula id="IEq97"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ w $$\end{document}</tex-math><mml:math id="M208"><mml:mi>w</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq97.gif"/></alternatives></inline-formula> were obtained when the positions from 1 to <inline-formula id="IEq98"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ s - 1 $$\end{document}</tex-math><mml:math id="M210"><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq98.gif"/></alternatives></inline-formula> on the scaffold were linked by the appropriate side chains derived from the computation of the DP algorithm. Thus, we can directly evaluate the optimal solutions of <inline-formula id="IEq99"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C\left( {s, w, 1} \right) $$\end{document}</tex-math><mml:math id="M212"><mml:mrow><mml:mi>C</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq99.gif"/></alternatives></inline-formula> based on the known <inline-formula id="IEq100"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C\left( {s - 1, 1:w, 1} \right) $$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:mi>C</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq100.gif"/></alternatives></inline-formula> in Lemma 2. Next, we extend Lemma 2 into Lemma 3 to calculate the <italic>highest R optimal solutions</italic>.</p>
      </sec>
      <sec id="FPar5">
        <title>
          <bold>Lemma 3</bold>
        </title>
        <p id="Par35"><italic>If</italic><inline-formula id="IEq101"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(s,w,1:R $$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq101.gif"/></alternatives></inline-formula>) <italic>are the highest R optimal solutions, with</italic><inline-formula id="IEq102"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ s \in \{ 1,2, \ldots ,n\} $$\end{document}</tex-math><mml:math id="M218"><mml:mrow><mml:mi>s</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq102.gif"/></alternatives></inline-formula><italic>and</italic><inline-formula id="IEq103"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ w \in \{ 0,1, \ldots ,W_{0} \} $$\end{document}</tex-math><mml:math id="M220"><mml:mrow><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq103.gif"/></alternatives></inline-formula><italic>, then:</italic><inline-formula id="IEq104"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C\left( {s, w, 1:{\text{R}}} \right) = \mathop {\hbox{max} }\limits_{{top R, x_{s} \in \left\{ {1,2 \ldots ,K_{s} } \right\},r \in \{ 1,2 \ldots ,R\} }} \{ p_{{s,x_{s} }} \times C\left( {s - 1, w - m_{{s,x_{s} }} ,{\text{r}}} \right)\} $$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:mi>C</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mtext>R</mml:mtext></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:munder><mml:mtext>max</mml:mtext><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>p</mml:mi><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{" separators=""><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:mi>C</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext>r</mml:mtext></mml:mrow></mml:mfenced><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq104.gif"/></alternatives></inline-formula>, <italic>where K</italic><sub><italic>s</italic></sub><italic>is the number of possible side chains at the sth substituted position on the given seed scaffold and</italic><inline-formula id="IEq105"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ m_{{s,x_{s} }} $$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq105.gif"/></alternatives></inline-formula><italic>and</italic><inline-formula id="IEq106"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ p_{{s,x_{s} }} $$\end{document}</tex-math><mml:math id="M226"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq106.gif"/></alternatives></inline-formula><italic>are the molecular weight and probability of the</italic><inline-formula id="IEq107"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ x_{s}^{th} $$\end{document}</tex-math><mml:math id="M228"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq107.gif"/></alternatives></inline-formula><italic>side chain that can be linked on the sth substituted position.</italic></p>
        <p>Note that the order of the positions used to iteratively calculate the sub-problem, <inline-formula id="IEq108"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C\left( {s, w, 1:{\text{R}}} \right) $$\end{document}</tex-math><mml:math id="M230"><mml:mrow><mml:mi>C</mml:mi><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mtext>R</mml:mtext></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq108.gif"/></alternatives></inline-formula>, will not affect the results of the optimal solutions according to our proven Lemma 4.</p>
      </sec>
      <sec id="FPar6">
        <title>
          <bold>Lemma 4</bold>
        </title>
        <p id="Par37">
          <italic>If we select any arbitrary order of s substituted positions to calculate</italic>
          <inline-formula id="IEq109">
            <alternatives>
              <tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(s,w,1:R) $$\end{document}</tex-math>
              <mml:math id="M232">
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>s</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>w</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>:</mml:mo>
                  <mml:mi>R</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:math>
              <inline-graphic xlink:href="13321_2017_244_Article_IEq109.gif"/>
            </alternatives>
          </inline-formula>
          <italic>, the solutions of</italic>
          <inline-formula id="IEq110">
            <alternatives>
              <tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(s,w,1:R) $$\end{document}</tex-math>
              <mml:math id="M234">
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>s</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>w</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>:</mml:mo>
                  <mml:mi>R</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:math>
              <inline-graphic xlink:href="13321_2017_244_Article_IEq110.gif"/>
            </alternatives>
          </inline-formula>
          <italic>are unchanged.</italic>
        </p>
        <p>Considering Lemmas 1–4, we can reasonably conclude Theorem 1.</p>
      </sec>
      <sec id="FPar7">
        <title>
          <bold>Theorem 1</bold>
        </title>
        <p id="Par39">
          <italic>The highest R optimal solutions in the CSCCP,</italic>
          <inline-formula id="IEq111">
            <alternatives>
              <tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(n,W_{0} ,1:R) $$\end{document}</tex-math>
              <mml:math id="M236">
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>n</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mi>W</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>:</mml:mo>
                  <mml:mi>R</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:math>
              <inline-graphic xlink:href="13321_2017_244_Article_IEq111.gif"/>
            </alternatives>
          </inline-formula>
          <italic>, can be solved by iteratively finding the optimal solutions of</italic>
          <inline-formula id="IEq112">
            <alternatives>
              <tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(s,w,1:R) $$\end{document}</tex-math>
              <mml:math id="M238">
                <mml:mrow>
                  <mml:mi>C</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>s</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mi>w</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>:</mml:mo>
                  <mml:mi>R</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:math>
              <inline-graphic xlink:href="13321_2017_244_Article_IEq112.gif"/>
            </alternatives>
          </inline-formula>
          <italic>for the position s from 1 to n and the molecular weight w from 0 to</italic>
          <inline-formula id="IEq113">
            <alternatives>
              <tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0} $$\end{document}</tex-math>
              <mml:math id="M240">
                <mml:msub>
                  <mml:mi>W</mml:mi>
                  <mml:mn>0</mml:mn>
                </mml:msub>
              </mml:math>
              <inline-graphic xlink:href="13321_2017_244_Article_IEq113.gif"/>
            </alternatives>
          </inline-formula>
          <italic>based on the initial condition of Lemma 1.</italic>
        </p>
        <p>From the above discussions, we designed a new CASE tool to solve the <italic>CSCCP.</italic> The pseudocode of the DP procedure<italic>, DPforCSCCP,</italic> is presented in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. According to Lemma 1, lines 1–4 initialize the cost function. Lines 5–16 are the code required to iteratively calculate the cost function of the <italic>CSCCP</italic> for the positions on the <italic>seed scaffold</italic> from 1 to <italic>n</italic> and the molecular weight from 1 to <inline-formula id="IEq114"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0}^{'} $$\end{document}</tex-math><mml:math id="M242"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq114.gif"/></alternatives></inline-formula> based on Lemmas 2–4, where <inline-formula id="IEq115"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0}^{'} $$\end{document}</tex-math><mml:math id="M244"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq115.gif"/></alternatives></inline-formula> is the integer format of <inline-formula id="IEq116"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0} $$\end{document}</tex-math><mml:math id="M246"><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq116.gif"/></alternatives></inline-formula>. To preserve the precision of the set of optimal solutions determined by the DP algorithm, all molecular weights in <inline-formula id="IEq117"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\text{\{ }}m_{{i,x_{i} }} | i = 1,2, \ldots ,n, x_{i} = 1,2, \ldots ,K_{i} \} $$\end{document}</tex-math><mml:math id="M248"><mml:mrow><mml:mrow><mml:mtext>\{</mml:mtext><mml:mspace width="0.333333em"/></mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq117.gif"/></alternatives></inline-formula> as well as <inline-formula id="IEq118"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0} $$\end{document}</tex-math><mml:math id="M250"><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq118.gif"/></alternatives></inline-formula> were scaled to integer numbers by multiplying by an appropriate number, <italic>λ</italic>, in order of magnitude. If the number of mass decimal places in <italic>W</italic>
<sub>0</sub> is <italic>D</italic>, we set <italic>λ as</italic> 10<sup><italic>D</italic></sup>. The default value of <italic>D</italic> was 6 in our DP algorithm. Then, <inline-formula id="IEq119"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0}^{'} = W_{0} *10^{D} $$\end{document}</tex-math><mml:math id="M252"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow/><mml:mo>∗</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mi>D</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq119.gif"/></alternatives></inline-formula> will retain all the floating point information of the original <italic>W</italic>
<sub>0</sub>. Lines 10–11 consider the boundary condition when the molecular weight of the selected side chain is greater than the value of <italic>w</italic>. Lines 9–15 correspond to the calculation of the cost function, <inline-formula id="IEq120"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ max $$\end{document}</tex-math><mml:math id="M254"><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq120.gif"/></alternatives></inline-formula>, defined in the formula in Lemma 3. The symbol <italic>C</italic> refers to a look-up table of the cost function, which is a 3D matrix in which the index of the weight is in integer format. When followed by brackets, such as in <inline-formula id="IEq121"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C[s,w,r] $$\end{document}</tex-math><mml:math id="M256"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq121.gif"/></alternatives></inline-formula>, <inline-formula id="IEq122"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C $$\end{document}</tex-math><mml:math id="M258"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq122.gif"/></alternatives></inline-formula> will refer to the look-up table, while when followed by parenthesis, such as in <inline-formula id="IEq123"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C(s,w,r) $$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>w</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq123.gif"/></alternatives></inline-formula>, <inline-formula id="IEq124"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C $$\end{document}</tex-math><mml:math id="M262"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq124.gif"/></alternatives></inline-formula> will refer to the previously defined cost function. Another 3D matrix of <italic>L</italic> was used to store the selected side chain information derived from the results of the cost function in line 16. At the end of the DP algorithm, the top <italic>R</italic> highest products of the probabilities from the combinations of the linked side chains were obtained in <inline-formula id="IEq125"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C\left[ {n,W_{0} ,1:R} \right] $$\end{document}</tex-math><mml:math id="M264"><mml:mrow><mml:mi>C</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq125.gif"/></alternatives></inline-formula>, where the total molecular weight of the linked side chains was equal to <inline-formula id="IEq126"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\text{W}}_{0} $$\end{document}</tex-math><mml:math id="M266"><mml:msub><mml:mtext>W</mml:mtext><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq126.gif"/></alternatives></inline-formula>. The corresponding identified R structures can be generated from the information in matrix <italic>L</italic>.<fig id="Fig4"><label>Fig. 4</label><caption><p>The dynamic programming algorithm for the computation of the Chemical Substituents-Core Combinatorial Problem (CSCCP)</p></caption><graphic xlink:href="13321_2017_244_Fig4_HTML" id="MO11"/></fig>
</p>
        <p>In the <italic>DPforCSCCP</italic> algorithm, when <italic>D</italic> is too large, the time complexity must be in exponential time. The following lemma shows the lower bound of <italic>D</italic> in this case.</p>
      </sec>
      <sec id="FPar8">
        <title>
          <bold>Lemma 5</bold>
        </title>
        <p id="Par42"><italic>When the number of mass decimal places D is greater than</italic><inline-formula id="IEq127"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \log_{10} \left( {\prod\nolimits_{i = 1}^{n} {K_{i} } } \right)/W_{0} $$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:msub><mml:mo>log</mml:mo><mml:mn>10</mml:mn></mml:msub><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mo stretchy="false">/</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq127.gif"/></alternatives></inline-formula>, <italic>the time complexity of DPforCSCCP is greater than that of the BF algorithm for the CSCCP.</italic></p>
      </sec>
    </sec>
    <sec id="Sec12">
      <title>Iterative DP algorithm</title>
      <p id="Par43">According to Lemma 5, a larger <italic>D</italic> results in a worse time performance for <italic>DPforCSCCP</italic> that could be even slower than the brute force algorithm. To improve the <italic>DPforCSCCP</italic> algorithm, we introduce in this section a modified algorithm without the limitation of <italic>D</italic>. First, we derived Theorem 2:</p>
      <sec id="FPar9">
        <title>
          <bold>Theorem 2</bold>
        </title>
        <p id="Par44"><italic>Let us assume that all molecular weights</italic><inline-formula id="IEq128"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ m_{{i,x_{i} }} \in {\mathbb{R}} $$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq128.gif"/></alternatives></inline-formula><italic>are converted into integers</italic><inline-formula id="IEq129"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ m_{{i,x_{i} }}^{{\prime \prime }} = m_{{i,x_{i} }} + 0.5 \in {\mathbb{N}} $$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow><mml:mo>″</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq129.gif"/></alternatives></inline-formula>, <inline-formula id="IEq130"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0} \in {\mathbb{R}} $$\end{document}</tex-math><mml:math id="M274"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq130.gif"/></alternatives></inline-formula><italic>is converted to</italic><inline-formula id="IEq131"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0}^{{\prime \prime }} = W_{0} + 0.5 \in {\mathbb{N}} $$\end{document}</tex-math><mml:math id="M276"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>″</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn><mml:mo>∈</mml:mo><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq131.gif"/></alternatives></inline-formula><italic>, and</italic><inline-formula id="IEq132"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ R $$\end{document}</tex-math><mml:math id="M278"><mml:mi>R</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq132.gif"/></alternatives></inline-formula><italic>is changed to</italic><inline-formula id="IEq133"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ R^{{\prime }} &gt; R $$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>&gt;</mml:mo><mml:mi>R</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq133.gif"/></alternatives></inline-formula><italic>. Let</italic><inline-formula id="IEq134"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C $$\end{document}</tex-math><mml:math id="M282"><mml:mi>C</mml:mi></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq134.gif"/></alternatives></inline-formula><italic>be the look</italic>-<italic>up table used by DPforCSCCP when the targeted MW is</italic><inline-formula id="IEq135"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0}^{{\prime }} = 10^{D} *W_{0} $$\end{document}</tex-math><mml:math id="M284"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mn>10</mml:mn><mml:mi>D</mml:mi></mml:msup><mml:mrow/><mml:mo>∗</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq135.gif"/></alternatives></inline-formula><italic>and</italic><inline-formula id="IEq136"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C^{{\prime }} $$\end{document}</tex-math><mml:math id="M286"><mml:msup><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq136.gif"/></alternatives></inline-formula><italic>be the look</italic>-<italic>up table used by IDPforCSCCP when the targeted MW is</italic><inline-formula id="IEq137"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0}^{{\prime \prime }} $$\end{document}</tex-math><mml:math id="M288"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>″</mml:mo></mml:msubsup></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq137.gif"/></alternatives></inline-formula><italic>. Then, if</italic><inline-formula id="IEq138"><alternatives><tex-math id="M289">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ R^{{\prime }} $$\end{document}</tex-math><mml:math id="M290"><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq138.gif"/></alternatives></inline-formula><italic>is sufficiently large, the set</italic><inline-formula id="IEq139"><alternatives><tex-math id="M291">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C^{{\prime }} \left[ {n, W_{0}^{{\prime \prime }} - 0.5n : W_{0}^{{\prime \prime }} + 0.5(n + 1),R^{{\prime }} } \right] $$\end{document}</tex-math><mml:math id="M292"><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>″</mml:mo></mml:msubsup><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn><mml:mi>n</mml:mi><mml:mo>:</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>″</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq139.gif"/></alternatives></inline-formula><italic>contains all of the values in</italic><inline-formula id="IEq140"><alternatives><tex-math id="M293">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C[n,W_{0}^{{\prime }} ,R] $$\end{document}</tex-math><mml:math id="M294"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq140.gif"/></alternatives></inline-formula><italic>calculated by DPforCSCCP.</italic></p>
        <p>Theorem 2 concludes that when a new sufficiently large number <inline-formula id="IEq141"><alternatives><tex-math id="M295">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ R^{{\prime }} $$\end{document}</tex-math><mml:math id="M296"><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq141.gif"/></alternatives></inline-formula> is assigned in the DP algorithm, all the optimal solutions of the <italic>CSCCP</italic> still can be evaluated without considering <italic>D</italic>. According to Theorem 2, we proposed the iterative dynamic programming algorithm (<italic>IDPforCSCCP</italic>) depicted in Fig. <xref rid="Fig5" ref-type="fig">5</xref> to efficiently identify the main structures in natural products. Both the <italic>targeted MWs</italic> and molecular weights of the side chains are first directly converted into integer format by truncating all of the floating point information. For example, if <inline-formula id="IEq142"><alternatives><tex-math id="M297">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0} = 400.03 $$\end{document}</tex-math><mml:math id="M298"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>400.03</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq142.gif"/></alternatives></inline-formula>, then <inline-formula id="IEq143"><alternatives><tex-math id="M299">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0}^{{\prime \prime }} = 400 $$\end{document}</tex-math><mml:math id="M300"><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>″</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mn>400</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq143.gif"/></alternatives></inline-formula>. Because the main procedure of the DP algorithm for the calculation of the cost function was not modified, the code from line 3 to line 16 in <italic>IDPforCSCCP</italic> is the same as the code in <italic>DPforCSCCP</italic>. However, the code from line 3 to 16 is enclosed by a new while loop to evaluate the cost function based on different ranges of <inline-formula id="IEq144"><alternatives><tex-math id="M301">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ R^{{\prime }} $$\end{document}</tex-math><mml:math id="M302"><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq144.gif"/></alternatives></inline-formula>. In the while loop starting from line 1 of the <italic>IDPforCSCCP</italic> algorithm, the value of <italic>R’</italic> in the first iteration is set to <italic>R</italic> × 10, and for the following iterations, <italic>R’</italic> is iteratively multiplied by 10 until <inline-formula id="IEq145"><alternatives><tex-math id="M303">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ R^{{\prime }} $$\end{document}</tex-math><mml:math id="M304"><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq145.gif"/></alternatives></inline-formula> is greater than <inline-formula id="IEq146"><alternatives><tex-math id="M305">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \prod\nolimits_{i = 1}^{n} {K_{i} } $$\end{document}</tex-math><mml:math id="M306"><mml:mrow><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq146.gif"/></alternatives></inline-formula>. The code from line 17 to 18 is used to store the values of the cost function and the corresponding side chains. In line 19 and 20, <italic>C</italic>
<sub><italic>tmp</italic></sub> and <italic>L</italic>
<sub><italic>tmp</italic></sub> are one-dimensional arrays storing all of the elements in <inline-formula id="IEq147"><alternatives><tex-math id="M307">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ C[n,W_{0}^{{\prime \prime }} - 0.5n:W_{0}^{{\prime \prime }} + 0.5(n + 1),1:R^{{\prime }} ] $$\end{document}</tex-math><mml:math id="M308"><mml:mrow><mml:mi>C</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>″</mml:mo></mml:msubsup><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn><mml:mi>n</mml:mi><mml:mo>:</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>″</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq147.gif"/></alternatives></inline-formula> and <inline-formula id="IEq148"><alternatives><tex-math id="M309">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ L\left[ {n,W_{0}^{{\prime \prime }} - 0.5n:W_{0}^{{\prime \prime }} + 0.5\left( {n + 1} \right),1:R^{{\prime }} } \right], $$\end{document}</tex-math><mml:math id="M310"><mml:mrow><mml:mi>L</mml:mi><mml:mfenced close="]" open="[" separators=""><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>″</mml:mo></mml:msubsup><mml:mo>-</mml:mo><mml:mn>0.5</mml:mn><mml:mi>n</mml:mi><mml:mo>:</mml:mo><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mo>″</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:mn>0.5</mml:mn><mml:mfenced close=")" open="(" separators=""><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq148.gif"/></alternatives></inline-formula> respectively. Because we ignore the number of mass decimal places in the <italic>targeted MW</italic> in <italic>IDPforCSCCP</italic>, we use the function <italic>realWEqualToW</italic>
<sub>0</sub> in line 21 to evaluate whether the molecular weights of the identified solutions in floating point format are equal to the original <italic>targeted MW</italic>, <inline-formula id="IEq149"><alternatives><tex-math id="M311">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0} $$\end{document}</tex-math><mml:math id="M312"><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq149.gif"/></alternatives></inline-formula>. The composite function <italic>indexesOf(realWEqualToW</italic>
<sub><italic>0</italic></sub>
<italic>())</italic> in line 21 returns the indexes of the correct optimal solutions in which the real weight is equal to <inline-formula id="IEq150"><alternatives><tex-math id="M313">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ W_{0} $$\end{document}</tex-math><mml:math id="M314"><mml:msub><mml:mi>W</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13321_2017_244_Article_IEq150.gif"/></alternatives></inline-formula>. When the number of correct optimal solutions in the while loop is greater than <italic>R</italic>, as coded in line 24, the while loop is broken in line 25 because the top <italic>R</italic> optimal solutions have already been identified. In line 24 of Fig. <xref rid="Fig5" ref-type="fig">5</xref>, the <italic>nonZeroValues</italic> function takes an array as input and returns the same array without zero values, while the <italic>size</italic> function returns the size of the array. In <italic>IDPforCSCCP</italic>, we should also consider another boundary condition derived from the following Lemma 6.<fig id="Fig5"><label>Fig. 5</label><caption><p>The iterative dynamic programming algorithm for computation of the Chemical Substituents-Core Combinatorial Problem (CSCCP)</p></caption><graphic xlink:href="13321_2017_244_Fig5_HTML" id="MO12"/></fig>
</p>
      </sec>
      <sec id="FPar10">
        <title>
          <bold>Lemma 6</bold>
        </title>
        <p id="Par46">
          <italic>In the IDPforCSCCP algorithm, if the number of optimal solutions searched in the first iteration is less than R, the set of the searched optimal solutions will not be updated in subsequent iterations.</italic>
        </p>
        <p>According to Lemma 6, we designed the boundary condition in lines 22–23. If the size of the searched optimal solutions is less than <italic>R</italic>, the while loop is also broken. The proofs for Lemmas 1–6 and Theorems 1–2 are all given in the Additional file <xref rid="MOESM1" ref-type="media">1</xref>. The source code of the <italic>IDPforCSCCP</italic> algorithm programming in Java was provided in the Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Additional files</title>
    <sec id="Sec13">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13321_2017_244_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1.</bold> Proof of Lemma 1 to Theorem 6, Tables S1–S4, and a discussion for Table S4. The detailed proofs for Lemma 1, Lemma 2, Lemma 3, Lemma 4, Theorem 1, Lemma 5, Theorem 2, and Lemma 6 are given. <bold>Table S1</bold> The identified structures that match the baseline data for <italic>O. japonicus</italic>. The last column indicates the ranks determined by our DP algorithm. <bold>Table S2</bold> The identified structures that match the baseline data for <italic>P. multiflorum</italic>. The last column indicates the ranks determined by our DP algorithm. <bold>Table S3</bold> The identified structures that match the baseline data for <italic>Angelica</italic> sp. The last column indicates the ranks determined by our DP algorithm. <bold>Table S4</bold> Numbers of searched optimal solutions for <italic>C. chinensis</italic>. Each cell contains two numbers. The first number is that determined when the number of combinatorial candidates for the substituted positions is 5, and the second the value determined in the case without limitation.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13321_2017_244_MOESM2_ESM.zip">
            <caption>
              <p><bold>Additional file 2.</bold> The source code of the <italic>IDPforCSCCP</italic> algorithm. The java source code of the <italic>IDPforCSCCP</italic> algorithm was provided in the file.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Electronic supplementary material</bold>
      </p>
      <p>The online version of this article (10.1186/s13321-017-0244-9) contains supplementary material, which is available to authorized users.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Authors’ contributions</title>
    <p>BHS conceived and designed the algorithms, built the models, analyzed the results, and drafted the manuscript. YCH gathered the dataset and prepared the scaffold and MS spectral information. MYS, SYW, AS, and CL provided scientific comments. MYS, YCH, SYW, AS, CL, and OAL revised the manuscript. YJT conceived and supervised the study, assisted in experiment analysis and manuscript writing. All authors read and approved the final manuscript.</p>
    <sec id="FPar11">
      <title>Acknowledgements</title>
      <p id="Par48">Resources of the Laboratory of Computational Molecular Design and Metabolomics and the Department of Computer Science and Information Engineering of National Taiwan University were used in performing these studies.</p>
    </sec>
    <sec id="FPar12">
      <title>Competing interests</title>
      <p id="Par49">The authors declare that they have no competing interests.</p>
    </sec>
    <sec id="FPar13">
      <title>Availability of data and materials</title>
      <p id="Par50">The four testing datasets including the scaffold structures and targeted molecular weights are available for download at <ext-link ext-link-type="uri" xlink:href="http://csccp.cmdm.tw/testingMaterial.rar">http://csccp.cmdm.tw/testingMaterial.rar</ext-link>.</p>
    </sec>
    <sec id="FPar02">
      <title>Ethics approval and consent to participate</title>
      <p id="Par045">Not applicable.</p>
    </sec>
    <sec id="FPar14">
      <title>Funding</title>
      <p id="Par51">This work was funded by the Ministry of Science and Technology, Taiwan, Grant Numbers 105-3011-F-002-010-, 105-2812-8-002-001-MY2, and 106-2622-B-002-008 -, and National Taiwan University, Grant Number NTU-ERP-106R880803.</p>
    </sec>
    <sec id="FPar40">
      <title>Publisher’s Note</title>
      <p id="Par74">Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </sec>
  </ack>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cragg</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Newman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Natural products: a continuing source of novel drug leads</article-title>
        <source>Biochim Biophys Acta</source>
        <year>2013</year>
        <volume>1830</volume>
        <issue>6</issue>
        <fpage>3670</fpage>
        <lpage>3695</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bbagen.2013.02.008</pub-id>
        <pub-id pub-id-type="pmid">23428572</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newman</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Cragg</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Natural products as sources of new drugs over the last 25 years</article-title>
        <source>J Nat Prod</source>
        <year>2007</year>
        <volume>70</volume>
        <issue>3</issue>
        <fpage>461</fpage>
        <lpage>477</lpage>
        <pub-id pub-id-type="doi">10.1021/np068054v</pub-id>
        <pub-id pub-id-type="pmid">17309302</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Robertson</surname>
            <given-names>AA</given-names>
          </name>
          <name>
            <surname>Cooper</surname>
            <given-names>MA</given-names>
          </name>
        </person-group>
        <article-title>Natural product and natural product derived drugs in clinical trials</article-title>
        <source>Nat Prod Rep</source>
        <year>2014</year>
        <volume>31</volume>
        <issue>11</issue>
        <fpage>1612</fpage>
        <lpage>1661</lpage>
        <pub-id pub-id-type="doi">10.1039/C4NP00064A</pub-id>
        <pub-id pub-id-type="pmid">25204227</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Butler</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>The role of natural product chemistry in drug discovery</article-title>
        <source>J Nat Prod</source>
        <year>2004</year>
        <volume>67</volume>
        <issue>12</issue>
        <fpage>2141</fpage>
        <lpage>2153</lpage>
        <pub-id pub-id-type="doi">10.1021/np040106y</pub-id>
        <pub-id pub-id-type="pmid">15620274</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kingston</surname>
            <given-names>DGI</given-names>
          </name>
        </person-group>
        <article-title>Modern natural products drug discovery and its relevance to biodiversity conservation</article-title>
        <source>J Nat Prod</source>
        <year>2011</year>
        <volume>74</volume>
        <issue>3</issue>
        <fpage>496</fpage>
        <lpage>511</lpage>
        <pub-id pub-id-type="doi">10.1021/np100550t</pub-id>
        <pub-id pub-id-type="pmid">21138324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moco</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bino</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>De Vos</surname>
            <given-names>RCH</given-names>
          </name>
          <name>
            <surname>Vervoort</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Metabolomics technologies and metabolite identification</article-title>
        <source>Trends Analyt Chem</source>
        <year>2007</year>
        <volume>26</volume>
        <issue>9</issue>
        <fpage>855</fpage>
        <lpage>866</lpage>
        <pub-id pub-id-type="doi">10.1016/j.trac.2007.08.003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corcoran</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Mortensen</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Hansen</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Troke</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Nicholson</surname>
            <given-names>JK</given-names>
          </name>
        </person-group>
        <article-title>HPLC/1H NMR spectroscopic studies of the reactive alpha-1-<italic>O</italic>-acyl isomer formed during acyl migration of <italic>S</italic>-naproxen beta-1-<italic>O</italic>-acyl glucuronide</article-title>
        <source>Chem Res Toxicol</source>
        <year>2001</year>
        <volume>14</volume>
        <issue>10</issue>
        <fpage>1363</fpage>
        <lpage>1370</lpage>
        <pub-id pub-id-type="doi">10.1021/tx010015q</pub-id>
        <pub-id pub-id-type="pmid">11599927</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corcoran</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Spraul</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>LC–NMR–MS in drug discovery</article-title>
        <source>Drug Discov Today</source>
        <year>2003</year>
        <volume>8</volume>
        <issue>14</issue>
        <fpage>624</fpage>
        <lpage>631</lpage>
        <pub-id pub-id-type="doi">10.1016/S1359-6446(03)02749-1</pub-id>
        <pub-id pub-id-type="pmid">12867148</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van der Hooft</surname>
            <given-names>JJJ</given-names>
          </name>
          <name>
            <surname>Mihaleva</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>de Vos</surname>
            <given-names>RCH</given-names>
          </name>
          <name>
            <surname>Bino</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Vervoort</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>A strategy for fast structural elucidation of metabolites in small volume plant extracts using automated MS-guided LC–MS–SPE–NMR</article-title>
        <source>Magn Reson Chem</source>
        <year>2011</year>
        <volume>49</volume>
        <fpage>S55</fpage>
        <lpage>S60</lpage>
        <pub-id pub-id-type="doi">10.1002/mrc.2833</pub-id>
        <pub-id pub-id-type="pmid">22290710</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Freeman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>GA</given-names>
          </name>
        </person-group>
        <article-title>Two-dimensional Fourier transformation in NMR</article-title>
        <source>Bull Magn Res</source>
        <year>1979</year>
        <volume>1</volume>
        <fpage>1</fpage>
        <lpage>26</lpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bax</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aszalos</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dinya</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Sudo</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Structure elucidation of the antibiotic desertomycin through the use of new two-dimensional NMR techniques</article-title>
        <source>J Am Chem Soc</source>
        <year>1986</year>
        <volume>108</volume>
        <issue>25</issue>
        <fpage>8056</fpage>
        <lpage>8063</lpage>
        <pub-id pub-id-type="doi">10.1021/ja00285a029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwalbe</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kessler</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>The 900 MHZ NMR spectrometer in Munich and Frankfurt</article-title>
        <source>Nachr Chem</source>
        <year>2003</year>
        <volume>51</volume>
        <issue>4</issue>
        <fpage>412</fpage>
        <lpage>417</lpage>
        <pub-id pub-id-type="doi">10.1002/nadc.20030510406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Koehn</surname>
            <given-names>FE</given-names>
          </name>
          <name>
            <surname>Carter</surname>
            <given-names>GT</given-names>
          </name>
        </person-group>
        <article-title>The evolving role of natural products in drug discovery</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2005</year>
        <volume>4</volume>
        <issue>3</issue>
        <fpage>206</fpage>
        <lpage>220</lpage>
        <pub-id pub-id-type="doi">10.1038/nrd1657</pub-id>
        <pub-id pub-id-type="pmid">15729362</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kind</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Fiehn</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <article-title>Advances in structure elucidation of small molecules using mass spectrometry</article-title>
        <source>Bioanal Rev</source>
        <year>2010</year>
        <volume>2</volume>
        <issue>1–4</issue>
        <fpage>23</fpage>
        <lpage>60</lpage>
        <pub-id pub-id-type="doi">10.1007/s12566-010-0015-9</pub-id>
        <pub-id pub-id-type="pmid">21289855</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nelson</surname>
            <given-names>DB</given-names>
          </name>
          <name>
            <surname>Munk</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Gash</surname>
            <given-names>KB</given-names>
          </name>
          <name>
            <surname>Herald</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <article-title>Alanylactinobicyclone. Application of computer techniques to structure elucidation</article-title>
        <source>J Org Chem</source>
        <year>1969</year>
        <volume>34</volume>
        <issue>12</issue>
        <fpage>3800</fpage>
        <lpage>3805</lpage>
        <pub-id pub-id-type="doi">10.1021/jo01264a014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lederberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sutherland</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Buchanan</surname>
            <given-names>BG</given-names>
          </name>
          <name>
            <surname>Feigenbaum</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Robertson</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Duffield</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Applications of artificial intelligence for chemical inference. I. The number of possible organic compounds. Acyclic structures containing C, H, O, and N</article-title>
        <source>J Am Chem Soc</source>
        <year>1969</year>
        <volume>91</volume>
        <fpage>2973</fpage>
        <lpage>2976</lpage>
        <pub-id pub-id-type="doi">10.1021/ja01039a025</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sasaki</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Abe</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ouki</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sakamoto</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ochiai</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Automated structure elucidation of several kinds of aliphatic and alicyclic compounds</article-title>
        <source>Anal Chem</source>
        <year>1968</year>
        <volume>40</volume>
        <issue>14</issue>
        <fpage>2220</fpage>
        <lpage>2223</lpage>
        <pub-id pub-id-type="doi">10.1021/ac50158a061</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elyashberg</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Gribov</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Formal–logical method for interpreting infrared spectra from characteristic frequencies</article-title>
        <source>Appl Spectrosc</source>
        <year>1968</year>
        <volume>8</volume>
        <issue>2</issue>
        <fpage>189</fpage>
        <lpage>191</lpage>
        <pub-id pub-id-type="doi">10.1007/BF00604681</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Christie</surname>
            <given-names>BD</given-names>
          </name>
          <name>
            <surname>Munk</surname>
            <given-names>ME</given-names>
          </name>
        </person-group>
        <article-title>The role of 2-dimensional nuclear-magnetic-resonance spectroscopy in computer-enhanced structure elucidation</article-title>
        <source>J Am Chem Soc</source>
        <year>1991</year>
        <volume>113</volume>
        <issue>10</issue>
        <fpage>3750</fpage>
        <lpage>3757</lpage>
        <pub-id pub-id-type="doi">10.1021/ja00010a018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peng</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>CZ</given-names>
          </name>
          <name>
            <surname>Hui</surname>
            <given-names>YZ</given-names>
          </name>
        </person-group>
        <article-title>Efficient application of 2d NMR correlation information in computer-assisted structure elucidation of complex natural-products</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>1994</year>
        <volume>34</volume>
        <issue>4</issue>
        <fpage>805</fpage>
        <lpage>813</lpage>
        <pub-id pub-id-type="doi">10.1021/ci00020a013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lindel</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Junker</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kock</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>2D-NMR-guided constitutional analysis of organic compounds employing the computer program COCON</article-title>
        <source>Eur J Org Chem</source>
        <year>1999</year>
        <volume>3</volume>
        <fpage>573</fpage>
        <lpage>577</lpage>
        <pub-id pub-id-type="doi">10.1002/(SICI)1099-0690(199903)1999:3&lt;573::AID-EJOC573&gt;3.0.CO;2-N</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blinov</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Carlson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Elyashberg</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Martirosian</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Molodtsov</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computer-assisted structure elucidation of natural products with limited 2D NMR data: application of the StrucEluc system</article-title>
        <source>Magn Reson Chem</source>
        <year>2003</year>
        <volume>41</volume>
        <issue>5</issue>
        <fpage>359</fpage>
        <lpage>372</lpage>
        <pub-id pub-id-type="doi">10.1002/mrc.1187</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elyashberg</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Blinov</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Molodtsov</surname>
            <given-names>SG</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Martirosian</surname>
            <given-names>ER</given-names>
          </name>
        </person-group>
        <article-title>Structure elucidator: a versatile expert system for molecular structure elucidation from 1D and 2D NMR data and molecular fragments</article-title>
        <source>J Chem Inf Comput Sci</source>
        <year>2004</year>
        <volume>44</volume>
        <issue>3</issue>
        <fpage>771</fpage>
        <lpage>792</lpage>
        <pub-id pub-id-type="doi">10.1021/ci0341060</pub-id>
        <pub-id pub-id-type="pmid">15154743</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elyashberg</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>GE</given-names>
          </name>
        </person-group>
        <article-title>Computer-assisted structure verification and elucidation tools in NMR-based structure elucidation</article-title>
        <source>Prog Nucl Magn Reson Spectrosc</source>
        <year>2008</year>
        <volume>53</volume>
        <issue>1–2</issue>
        <fpage>1</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="doi">10.1016/j.pnmrs.2007.04.003</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elyashberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Blinov</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Molodtsov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Elucidating ‘undecipherable’ chemical structures using computer-assisted structure elucidation approaches</article-title>
        <source>Magn Reson Chem</source>
        <year>2012</year>
        <volume>50</volume>
        <issue>1</issue>
        <fpage>22</fpage>
        <lpage>27</lpage>
        <pub-id pub-id-type="doi">10.1002/mrc.2849</pub-id>
        <pub-id pub-id-type="pmid">22259196</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elyashberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Blinov</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Molodtsov</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Smurnyy</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Churanova</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Computer-assisted methods for molecular structure elucidation: realizing a spectroscopist’s dream</article-title>
        <source>J Cheminform</source>
        <year>2009</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>3</fpage>
        <pub-id pub-id-type="doi">10.1186/1758-2946-1-3</pub-id>
        <pub-id pub-id-type="pmid">20142986</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Codina</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ryan</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Joyce</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Richards</surname>
            <given-names>DS</given-names>
          </name>
        </person-group>
        <article-title>Identification of multiple impurities in a pharmaceutical matrix using preparative gas chromatography and computer-assisted structure elucidation</article-title>
        <source>Anal Chem</source>
        <year>2010</year>
        <volume>82</volume>
        <issue>21</issue>
        <fpage>9127</fpage>
        <lpage>9133</lpage>
        <pub-id pub-id-type="doi">10.1021/ac102151g</pub-id>
        <pub-id pub-id-type="pmid">20942391</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>von Bargen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Hubner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cramer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Rzeppa</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Humpf</surname>
            <given-names>HU</given-names>
          </name>
        </person-group>
        <article-title>Systematic approach for structure elucidation of polyphenolic compounds using a bottom-up approach combining ion trap experiments and accurate mass measurements</article-title>
        <source>J Agric Food Chem</source>
        <year>2012</year>
        <volume>60</volume>
        <issue>45</issue>
        <fpage>11274</fpage>
        <lpage>11282</lpage>
        <pub-id pub-id-type="doi">10.1021/jf3030369</pub-id>
        <pub-id pub-id-type="pmid">23101583</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Harn Y-C. Structure hunter: prediction of novel chemical structures in a mixture [Master dissertation]. Taipei, Taiwan: National Taiwan University; 2011</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ibarra</surname>
            <given-names>OH</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>Fast approximation algorithms for the knapsack and sum of subset problems</article-title>
        <source>J ACM</source>
        <year>1975</year>
        <volume>22</volume>
        <fpage>463</fpage>
        <lpage>468</lpage>
        <pub-id pub-id-type="doi">10.1145/321906.321909</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <mixed-citation publication-type="other">Clasquin MF, Melamud E, Rabinowitz JD. LC-MS data processing with MAVEN: a metabolomic analysis and visualization engine. In: Baxevanis AD et al, editors. Current protocols in bioinformatics/editoral board, Chapter 14. 2012; Unit14 1</mixed-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Want</surname>
            <given-names>EJ</given-names>
          </name>
          <name>
            <surname>O’Maille</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Abagyan</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Siuzdak</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>XCMS: processing mass spectrometry data for metabolite profiling using nonlinear peak alignment, matching, and identification</article-title>
        <source>Anal Chem</source>
        <year>2006</year>
        <volume>78</volume>
        <issue>3</issue>
        <fpage>779</fpage>
        <lpage>787</lpage>
        <pub-id pub-id-type="doi">10.1021/ac051437y</pub-id>
        <pub-id pub-id-type="pmid">16448051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <mixed-citation publication-type="other">The Dictionary of Natural Products database is available from Chapman &amp; Hall/CRC. <ext-link ext-link-type="uri" xlink:href="http://dnp.chemnetbase.com">http://dnp.chemnetbase.com</ext-link>. 2010 cited 2010-07-10</mixed-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Irwin</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Shoichet</surname>
            <given-names>BK</given-names>
          </name>
        </person-group>
        <article-title>ZINC—a free database of commercially available compounds for virtual screening</article-title>
        <source>J Chem Inf Model</source>
        <year>2004</year>
        <volume>45</volume>
        <issue>1</issue>
        <fpage>177</fpage>
        <lpage>182</lpage>
        <pub-id pub-id-type="doi">10.1021/ci049714+</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>CYC</given-names>
          </name>
        </person-group>
        <article-title>TCM Database@Taiwan: the world’s largest traditional chinese medicine database for drug screening in silico</article-title>
        <source>PLoS ONE</source>
        <year>2011</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>15939</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0015939</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
