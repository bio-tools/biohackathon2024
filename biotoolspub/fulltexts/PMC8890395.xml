<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD with OASIS Tables with MathML3 v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archive-oasis-article1-mathml3.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats-oasis2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Oncoimmunology</journal-id>
    <journal-id journal-id-type="iso-abbrev">Oncoimmunology</journal-id>
    <journal-title-group>
      <journal-title>Oncoimmunology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">2162-4011</issn>
    <issn pub-type="epub">2162-402X</issn>
    <publisher>
      <publisher-name>Taylor &amp; Francis</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8890395</article-id>
    <article-id pub-id-type="doi">10.1080/2162402X.2022.2043662</article-id>
    <article-id pub-id-type="publisher-id">2043662</article-id>
    <article-version vocab="JAV" vocab-identifier="http://www.niso.org/publications/rp/RP-8-2008.pdf" vocab-term="Version of Record" article-version-type="VoR">Version of Record</article-version>
    <article-categories>
      <subj-group subj-group-type="article-type">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Original Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Deep learning using bulk RNA-seq data expands cell landscape identification in tumor microenvironment</article-title>
      <alt-title alt-title-type="left-running-head">X. WANG ET AL.</alt-title>
      <alt-title alt-title-type="right-running-head">ONCOIMMUNOLOGY</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xin</given-names>
        </name>
        <xref rid="aff0001" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="aff0002" ref-type="aff">
          <sup>b</sup>
        </xref>
        <xref rid="aff0003" ref-type="aff">
          <sup>c</sup>
        </xref>
        <xref rid="an0002" ref-type="author-notes">
          <sup>#</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Hongjiu</given-names>
        </name>
        <xref rid="aff0001" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="aff0002" ref-type="aff">
          <sup>b</sup>
        </xref>
        <xref rid="an0002" ref-type="author-notes">
          <sup>#</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Dan</given-names>
        </name>
        <xref rid="aff0003" ref-type="aff">
          <sup>c</sup>
        </xref>
        <xref rid="an0002" ref-type="author-notes">
          <sup>#</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Na</given-names>
        </name>
        <xref rid="aff0002" ref-type="aff">
          <sup>b</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>He</surname>
          <given-names>Danni</given-names>
        </name>
        <xref rid="aff0002" ref-type="aff">
          <sup>b</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Zheyu</given-names>
        </name>
        <xref rid="aff0002" ref-type="aff">
          <sup>b</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Xu</given-names>
        </name>
        <xref rid="aff0001" ref-type="aff">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wen</surname>
          <given-names>Xiaoling</given-names>
        </name>
        <xref rid="aff0001" ref-type="aff">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Xuhua</given-names>
        </name>
        <xref rid="aff0001" ref-type="aff">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Jin</given-names>
        </name>
        <xref rid="aff0001" ref-type="aff">
          <sup>a</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Zhenzhen</given-names>
        </name>
        <xref rid="aff0001" ref-type="aff">
          <sup>a</sup>
        </xref>
        <xref rid="aff0002" ref-type="aff">
          <sup>b</sup>
        </xref>
        <xref rid="an0001" ref-type="corresp"/>
      </contrib>
      <aff id="aff0001"><label>a</label>Key Laboratory of Tropical Translational Medicine of Ministry of Education, College of Biomedical Information and Engineering, <institution-wrap><institution>Hainan Medical University</institution></institution-wrap>, <city>Haikou</city>, <country>China</country></aff>
      <aff id="aff0002"><label>b</label>College of Bioinformatics Science and Technology, <institution-wrap><institution>Harbin Medical University</institution></institution-wrap>, <city>Harbin</city>,<country>China</country></aff>
      <aff id="aff0003"><label>c</label>The First Affiliated Hospital, <institution-wrap><institution>Sun Yat-sen University</institution></institution-wrap>, <city>Guangzhou</city>, <country>China</country></aff>
    </contrib-group>
    <author-notes>
      <corresp id="an0001">CONTACT Zhenzhen Wang <email xlink:href="mailto:wangzhenzhen@hainmc.edu.cn">wangzhenzhen@hainmc.edu.cn</email>
<institution-wrap><institution>Key Laboratory of Tropical Translational Medicine of Ministry of Education, School of Biomedical Information and Engineering, Hainan Medical University</institution></institution-wrap>, <addr-line>Xueyuan Road, Longhua District</addr-line>, <city>Haikou</city>, <state>Hainan</state>, <country>PR China</country></corresp>
      <fn id="an0002">
        <label>#</label>
        <p>These authors contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date date-type="pub" publication-format="electronic">
      <day>25</day>
      <month>2</month>
      <year>2022</year>
    </pub-date>
    <pub-date date-type="collection" publication-format="electronic">
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>25</day>
      <month>2</month>
      <year>2022</year>
    </pub-date>
    <volume>11</volume>
    <issue>1</issue>
    <elocation-id seq="55">2043662</elocation-id>
    <pub-history>
      <event event-type="tagger">
        <event-desc>Integra</event-desc>
        <date>
          <day>24</day>
          <month>2</month>
          <year>2022</year>
        </date>
      </event>
      <event event-type="final">
        <event-desc>Integra</event-desc>
        <date>
          <day>24</day>
          <month>2</month>
          <year>2022</year>
        </date>
      </event>
      <event event-type="received">
        <date>
          <day>13</day>
          <month>10</month>
          <year>2021</year>
        </date>
      </event>
      <event event-type="revised">
        <date>
          <day>28</day>
          <month>1</month>
          <year>2022</year>
        </date>
      </event>
      <event event-type="accepted">
        <date>
          <day>14</day>
          <month>2</month>
          <year>2022</year>
        </date>
      </event>
    </pub-history>
    <permissions>
      <copyright-statement>© 2022 The Author(s). Published with license by Taylor &amp; Francis Group, LLC.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <copyright-holder>The Author(s)</copyright-holder>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="KONI_11_2043662.pdf"/>
    <abstract>
      <title>ABSTRACT</title>
      <p>The tumor microenvironment (TME) profoundly influences tumor progression and affects immunotherapy responses and resistance. Understanding its heterogeneity is the key for developing immunotherapy. However, the available methods can only partially portray the TME heterogeneity with a small number of cell types. Here, we developed a deep learning-based frame with a design visible, DCNet, that embeds the relationships between cells and their marker genes in the neural network, and can infer the cell landscape with more than 400 cell types based on bulk RNA-seq data. DCNet accurately recapitulated the cell landscape of multiple single cell RNA-seq datasets, which showed better robustness and stability. Based on the cell landscape of TCGA patients, which was built with DCNet, the patients were divided into two groups with significant differences in survival time and distinct cell-type populations. DCNet provides a foundation for decoding TME heterogeneity. The source code of DCNet can be found on GitHub: <ext-link xlink:href="https://github.com/xindd/DCNet" ext-link-type="uri">https://github.com/xindd/DCNet</ext-link>.</p>
    </abstract>
    <kwd-group kwd-group-type="author">
      <title>KEYWORDS</title>
      <kwd>Tumor microenvironment</kwd>
      <kwd>deep learning</kwd>
      <kwd>cell landscape</kwd>
    </kwd-group>
    <support-group>
      <funding-group>
        <award-group>
          <funding-source>
            <institution-wrap>
              <institution>Natural Science Foundation of</institution>
              <institution-id institution-id-type="open-funder-registry">10.13039/501100001809</institution-id>
            </institution-wrap>
          </funding-source>
          <award-id>No.821MS045</award-id>
          <award-id>821MS0777</award-id>
          <award-id>621MS041</award-id>
        </award-group>
        <award-group>
          <funding-source>
            <institution-wrap>
              <institution>National Natural Science Foundation of</institution>
            </institution-wrap>
          </funding-source>
          <award-id>No.31701159</award-id>
        </award-group>
        <award-group>
          <funding-source>
            <institution-wrap>
              <institution>Major Science and Technology Program of Hainan Province</institution>
            </institution-wrap>
          </funding-source>
          <award-id>No.ZDKJ202003</award-id>
        </award-group>
        <funding-statement>This work was supported by the Natural Science Foundation of Hainan Province [No.821MS045, 821MS0777, 621MS041]; National Natural Science Foundation of China [No.3170115932160179]; Major Science and Technology Program of Hainan Province [No.ZDKJ202003].</funding-statement>
      </funding-group>
    </support-group>
    <counts>
      <fig-count count="6"/>
      <ref-count count="39"/>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" disp-level="1" id="s0001">
    <title>Introduction</title>
    <p>Immunotherapy has achieved remarkable success in treating advanced tumors.<sup><xref rid="cit0001" ref-type="bibr">1</xref></sup> But because of the highly heterogeneous TME, only a relatively small fraction of patients obtain clinical benefit. The TME, comprising numerous and heterogeneous cell types counting fibroblats, immune cells, adipocytes, endothelial cells, becomes the hotspot of research in this field in the next few years and is being further explored by novel techniques.<sup><xref rid="cit0002" ref-type="bibr">2</xref>,<xref rid="cit0003" ref-type="bibr">3</xref></sup> Single-cell transcriptome sequencing (scRNA-seq) as a novel sequencing technique can quantify transcripts in individual cells and provides a comprehensive cell landscape of the TME.<sup><xref rid="cit0004" ref-type="bibr">4</xref>,<xref rid="cit0005" ref-type="bibr">5</xref></sup> But it is difficult for the generating of scRNA-seq data in a large population of patients for its high cost and technical challenges.</p>
    <p>Bulk RNA-seq data source is a good choice for the identification of TME as a large amount of patient high-throughput sequencing data is available. Several methods have been developed for deconvolution of bulk gene expression to evaluate cell landscape in bulk RNA-seq samples, such as CIBERSORTx,<sup><xref rid="cit0006" ref-type="bibr">6</xref></sup> EPIC,<sup><xref rid="cit0007" ref-type="bibr">7</xref></sup> MCP-counter,<sup><xref rid="cit0008" ref-type="bibr">8</xref></sup> quanTIseq,<sup><xref rid="cit0009" ref-type="bibr">9</xref></sup> TIMER,<sup><xref rid="cit0010" ref-type="bibr">10</xref></sup> and xCell.<sup><xref rid="cit0011" ref-type="bibr">11</xref></sup> These methods expand the application direction of expression profile generated by the bulk RNA-seq and make it possible for researchers to identify the TME from bulk RNA-seq data. Bogdan A. Luca et al. have proposed the ECOTyper method, a new machine learning framework for analyzing cell states and ecosystems, which used Cibersortx and NMF methods to evaluate the 12 major cell lineages abundance of bulk samples in tumors and defined 69 cell states in TME.<sup><xref rid="cit0012" ref-type="bibr">12</xref></sup> But the existing methods usually focus on a very limited number of cell types and those methods are prone to different deviations for the dependent selection of marker genes. Recently, some deep learning methods such as multi-layer perceptrons (MLP), convolutional neural networks (CNN), long and short-term memory networks (LSTM), and autoencoders (AE) have been applied in the field of bioinformatics<sup><xref rid="cit0013" ref-type="bibr">13–17</xref></sup> and shown more improvement and progress. However, as a black box model, due to their multilayer nonlinear structure, the deep learning methods are often considered to be nontransparent and their predictions not traceable. Many researchers try to “light up the black box” from different angles of analysis and visualization.<sup><xref rid="cit0018" ref-type="bibr">18</xref>,<xref rid="cit0019" ref-type="bibr">19</xref></sup> For example, the structural relationships of GO (Gene Ontology) terms are embedded in an ANN (artificial neural network), enabling interpretation of gene functional relationship networks.<sup><xref rid="cit0018" ref-type="bibr">18</xref></sup> It provides a new angle for the application of neural networks in biology.</p>
    <p>In this study, we present DCNet, an interpretable deep learning method, that embeds the relationships between 434 cell types and their marker genes into the structure of the ANN. It can identify the cell landscapes with better robustness and accuracy than other methods such as TIMER. Then 10,176 tumor patient cell landscapes of TCGA were obtained using the method of DCNet, and the patients was divided into two subtypes with significant differences in survival time and TME characteristics. Then four survival-related network modules were identified through the analysis of the cell co-expression network in TME. The patients were categorized into high risk and low risk group according the average expression value of genes in the survival-related network modules. Cell landscapes of non-small cell lung cancer in TCGA shows that there is significantly different in TME infiltration between the lung adenocarcinoma and squamous cell carcinoma. The significantly different cell types were identified between two subtypes, and a support vector machine (SVM) classifier was constructed using those significantly different cell types to predict lung cancer subtypes, and the precision of the SVM classifier was 0.975, as indicated in the ROC curve.</p>
  </sec>
  <sec disp-level="1" id="s0002">
    <title>Result</title>
    <sec disp-level="2" id="s0002-s2001">
      <title>Design of DCNet</title>
      <p>Based on the AE neural network, we designed a deep learning model, called DCNet, with biologically meaning, that can identify the abundance of cell types from bulk RNA-seq data. It was designed to embed the relationships between 434 cell types and their marker genes in the ANN, which makes DCNet contain a specific biological network structure between two layers of neural networks [Detail in method]. The processing of DCNet is as follows: According to the relationships among cell types, the hierarchical structure of cell types in the patient TME was built, which bases on OBO database (Cell Ontology database) and CellMarker database [Supplementary Table 1], and 434 cells all located on the leaf node. For example, we combine the content of B cells, T cells, etc. to characterize the content of immune cells, and the relationships between cell and their marker genes were shown [<xref rid="f0001" ref-type="fig">Figure 1a</xref>]. Here we used marker genes expression in bulk tumors and the relationships between cells and their marker genes to infer the abundance of cells. Gene expression levels were considered as the input and output neurons in DCNet. Here expression levels of 9078 marker genes and all (21,136) genes are used as input and output neurons, respectively [<xref rid="f0001" ref-type="fig">Figure 1b</xref>]. Finally, the encode layer and latent layer (434 neurons) of the neural network are transferred, and the activation value of the latent layer represents the abundance of cells [<xref rid="f0001" ref-type="fig">Figure 1c</xref>].
<fig position="float" id="f0001" fig-type="figure"><label>Figure 1.</label><caption><p><bold>DCNet architecture and design process</bold>. (a) Different cell types in the tissue, such as stromal cells, red blood cells, macrophages, T cells, B cells, neuronal cells, etc. These cells can be further divided into different cell types, which has a corresponding marker gene. (b) The basic structure of the DCNet model. The input is the expression levels of marker genes in bulk RNA-seq, and the output is the expression levels of all genes. The middle layer artificial neural network. (c) The gray neurons are activated neurons, and the white ones are inactive neurons. The first level relationship of the DCNet model is the corresponding relationship between cells and marker genes. The middle layer of the DCNet model represents the relative content of cells.</p></caption><alternatives><graphic xlink:href="KONI_A_2043662_F0001_OC" content-type="color" specific-use="web-only" position="float"/><graphic xlink:href="KONI_A_2043662_F0001_PB" content-type="black-white" specific-use="print-only" position="float"/></alternatives></fig></p>
    </sec>
    <sec disp-level="2" id="s0002-s2002">
      <title>Training and selection of DCNet</title>
      <p>Considering the incompleteness of the input data, DCNet model was trained and tested over various dropout rates (0.00, 0.01, 0.03, 0.05, 0.07, 0.1, 0.3, 0.5) for TCGA dataset. The independent dataset (CRC) was used to evaluate the generalization performance of the DCNet model. Here root mean square error (RMSE) of neurons was used as the evaluation index to describe DCNet model fitting. The training results of the DCNet models indicate that the RMSE value of AE gradually decreases as the number of neurons increases from 64 to 4096 (power of 2), and when the number of neurons reaches 2048, its RMSE value is the lowest relative to other AE models. The RMSE value of Full-DCNet increases significantly in training and test dataset of TCGA [<xref rid="f0002" ref-type="fig">Figure 2a</xref>]. The RMSE value gradually increases (DCNet-D0, DCNet-D01, DCNet-D03, DCNet-D05, DCNet-D07, DCNet-D10, DCNet-D30, DCNet-D50) with the increase of dropout rate. Meanwhile, the RMSE distribution of all genes in DCNet has a smaller fluctuation range, which is superior to other models. Overall, AE2048 and DCNet models showed better performance.
<fig position="float" id="f0002" fig-type="figure"><label>Figure 2.</label><caption><p><bold>DCNet model determination and performance evaluation</bold>. (a) The root mean square error distribution of different models in the training set and test set in the TCGA sample. <italic toggle="yes">y</italic> is the root mean square error, and <italic toggle="yes">x</italic> is different neural network models. AE64~ AE4096 are three-layer autoencoders with 64 ~ 4096 neurons in each layer. Full-DCNet is similar to the DCNet architecture, but there is a fully connected neural network between neurons. DCNet-D0 means that the input data is not randomly censored, and DCNet-D01, DCNet-D03, DCNet-D05,DCNet-D07, DCNet-D10, DCNet-D30, and DCNet-D50 means that the input data is randomly censored by 1%, 3%, 5%, 7%, 10%, 30%, and 50%, respectively. Blue is the training set and red is the test set. (b) The root mean square error distribution of different models in the CRC sample. <italic toggle="yes">y</italic> is the root mean square error, and x is different neural network models, same as Figure A. (c) For samples of different cancer types, the DCNet predicted value is correlated with the true value. The left ordinate is the correlation distribution value, the right ordinate is the number of samples, the abscissa is the cancer type, and the gray dashed line is the correlation 0.5. (d) Draw the ROC curve of the marker gene in single-cell levels, the red is the network without fine-tuning, the blue is the network after the fine-tuning, the abscissa is the false positive rate, and the ordinate is the true positive rate. (e) Frequency distribution diagram of ROC value calculated by gene. The abscissa is the ROC value, and the ordinate is the frequency distribution of the corresponding ROC value.</p></caption><alternatives><graphic xlink:href="KONI_A_2043662_F0002_OC" content-type="color" specific-use="web-only" position="float"/><graphic xlink:href="KONI_A_2043662_F0002_PB" content-type="black-white" specific-use="print-only" position="float"/></alternatives></fig></p>
      <p>In CRC independent dataset, different neural network models show great differences in the distribution of error values [<xref rid="f0002" ref-type="fig">Figure 2b</xref>]. The RMSE value of the Full-DCNet increases higher, and the RMSE distribution range of all genes becomes larger. DCNet shows higher prediction accuracy and better prediction effect of the samples with the increase of dropout rate. When the input sample data is missing more than 10% (dropout rate&gt;0.1), it may cause too much missing information, such a sample may be a meaningless sample. In summary, here we recommend to choose DCNet model with dropout (dropout rate = 0.1).</p>
      <p>Another important factor that affects the classification performance of neural networks is the distribution of the class labels in the training and test data set. If the class labels of the samples in training data set is not uniform, it will lead to the bias of the prediction. We used oversampling method to reduce the imbalance of class labels in the training dataset. We also checked the effect of sample size on classification accuracy for different types of cancer patients in training data set. The correlation coefficients between the output of DCNet and the real cell abundance were calculated for each cancer [<xref rid="f0002" ref-type="fig">Figure 2c</xref>]. As the sample size increases, the predicted correlation of patients does not increase or decrease significantly, which represents the sample size has little effect on the model’s predictions. Interestingly, the correlation of normal patients is the highest, with an average level of over 0.9. This is not difficult to understand based on the characteristics of neural networks. During the training process, the neural network tried to find the generalization characteristics of all samples. All cells of TCGA patient originated from normal tissue, so this leads to higher prediction performance of the network for normal patients.</p>
      <p>We designed a fine-tuning network to update the network weights of the first and second layers with learning rates of 1e-6 and 1e-4. The ROC curve is drawn to show that the AUC level reaches up to 0.78 [<xref rid="f0002" ref-type="fig">Figure 2d</xref>]. After fine-tuning the model, the loss function of the network is significantly improved, and the ROC of the second-level weight is higher [<xref rid="f0002" ref-type="fig">Figure 2e</xref>]. The AUC value of 80% of the genes is greater than 0.5. Therefore, for different samples, fine-tuning the network can improve the performance of the model.</p>
    </sec>
    <sec disp-level="2" id="s0002-s2003">
      <title>DCNet portrayed the cell landscapes accurately</title>
      <p>DCNet is a neural network model with a specific biological network structure, and its input layer and the intermediate layer are connected according to the relationships between cells and their marker genes. The intermediate layer neurons are composed of 434 cell types. In the intermediate layer, the ReLU activation function is used to ensure that the activation value of the neuron is greater than zero, and the activation value of intermediate layer neurons is used to represent the abundance of the cell. It means that given the gene expression level of the sample, 434 cells abundance can be inferred from the activation value of the intermediate layer neurons.</p>
      <p>Two single-cell sequencing datasets (GSE81861, GSE72056) were downloaded from GEO database and were used as the validation datasets to verify whether the intermediate layer neurons could infer the abundance of cells. There are six cell types including B cells, endothelial cell, epithelial cell, fibroblast cell, macrophage cell, mast cell in the GSE81861 dataset, and 6 cell types including B cells, CAFs cell, endothelial cell, macrophage cell, NK cell, and T cell in the GSE72056 dataset. The number of cells is considered as cell abundance, and the cumulative sum of gene expression levels in all single cells is used as bulk gene expression. Using a trained DCNet model, we predicted the abundance of 434 cells expressed by the activation value of the intermediate layer. We respectively calculated the cell abundance of B cell, endothelial cell, epithelial cell, fibroblast cell, macrophage cell, mast cell, and T cell with the methods of Marker_sum, CIBERSORTx, EPIC, MCP-counter, quanTIseq, Timer, xCell. We checked whether the intermediate layer activation value of DCNet can accurately characterize the abundance of the cell through the correlation between the predicted value and the true value. In the CRC dataset, the correlation values are 0.95 for T cells, while just −0.09 for macrophage cells in xCell method. The similar results were got for MCP-counter method, where the correlation values are 0.96 and 0.98 for B cells and T cells, while just 0.30 for NK cell and endothelial cell in the melanoma dataset. The correlation value of T cells and B cells can also reach 0.80 and 0.98 in the melanoma sample (Marker_sum). However, the correlation of B cells in CRC samples is −0.13, and the evaluation of other cells also fluctuates greatly. Although DCNet’s evaluation results for T cells and B cells are not the highest (0.81, 0.95 in the melanoma sample), its correlation values for all types of cells are stable. Those results show that the predicted cell abundance values of DCNet are positively correlated with the sum of the cell abundance in each sample, which is considered as actual cell abundance in all cell types (all correlation coefficient values&gt;0.7), but the correlation results showed instability in EPIC, TIMER, CIBERSORT, MCP-counter [<xref rid="f0003" ref-type="fig">Figure 3a</xref>]. The reliability of those methods tends to depend on the accuracy of marker gene screening. However, DCNet portrays the relationships between marker genes and cells, which avoids the contribution of individual marker genes to cell content. The 1000 cells simulation data generated using R package(immunedeconv) was used to analyze the correlation between DCNet and other methods in T cell and B cell. In T cells, the correlation between the DCNet method and the true value is 0.97, and the correlation with other methods exceeds 0.9, except for TIMER and CIBERSORTx, which have lower correlation with other software [<xref rid="f0003" ref-type="fig">Figure 3b</xref>]. And in B cells, all methods show high consistency [Supplementary Figure 1].
<fig position="float" id="f0003" fig-type="figure"><label>Figure 3.</label><caption><p><bold>Comparison of cell content assessed by DCNet with other methods</bold>. (a) Heatmaps of the correlation between the estimated and true levels of cells on CRC samples and Melanoma samples by different methods. The left side is the CRC sample, and the right side is the Melanoma sample. The redder the color, the closer the correlation level is to 1. The methods include DCNet, Marker_sum (the expression value of marker genes screened in this topic), CIBERSORTx, EPIC, MCP-counter, quanTIseq, TIMER, xCell. The longitudinal direction indicates different cell types. Gray represents that this cell type can not be identified by the corresponding deconvolution method. (b) In the simulation data, the consistency analysis of different methods. The scatter chart shows the distribution of 1000 simulation samples among different methods, and the pie chart shows the level of correlation. The redder the color, the higher the correlation. The diagonal lines are the names of different models, and TRUE is the true level of cell content. (c) The correlation between the predicted value of the DCNet model and the true level. The abscissa is the true cell content, and the ordinate is the cell content predicted by DCNet. The upper part represents FGC cells and the lower part represents Somatic cells. (d) Cell ontology hierarchical relationships among FGC cell, somatic cell, and cell subclasses of those cells, each node represents a cell ontology identity. Highlighted red indicates the cell types recognized by DCNet. (e) enriched cell types evaluated by DCNet shows a big difference in cell abundance levels of human embryos at the developmental stage. The redder the color, the higher the level of cell abundance. The <italic toggle="yes">y</italic>-axis of the histogram (at the top of 3E) is the sum of the overall cell abundance level of human embryos at each week.</p></caption><alternatives><graphic xlink:href="KONI_A_2043662_F0003_OC" content-type="color" specific-use="web-only" position="float"/><graphic xlink:href="KONI_A_2043662_F0003_PB" content-type="black-white" specific-use="print-only" position="float"/></alternatives></fig></p>
      <p>Next, we tested the capability of DCNet to identify the cell abundance of other cells, not just immune cells. A single cell RNA-seq data set (GSE86146) was obtained from the GEO database. It provides the cell abundance information of human embryonic germ cells (FGC) and stomatic cells, during the development for human germline cells. We obtained the FGC cell and somatic cell abundance by using DCNet and calculated the correlation coefficient between the predicted and actual cell abundance of FGC and somatic cells respectively. The values of the correlation coefficient show high consistency with 0.87 in FGC cells and 0.79 in somatic cell (<italic toggle="yes">p</italic> &lt; .01), which suggests that DCNet can identify the cell abundance accurately for FGC and somatic cell accurately [<xref rid="f0003" ref-type="fig">Figure 3c</xref>]. The DCNet can not only estimate the abundance of FGC cell and somatic cell, but also the abundance of cell subclasses of those cells such as ciliated cells, epithelial cells, pre-meiotic embryonic germ cells, and embryonic germ cells. According to the cell ontology [<xref rid="f0003" ref-type="fig">Figure 3d</xref>], these cells have hierarchical relationship which come from OBO database. For example, somatic cell (CL:000237) were divided into ciliated cells, epithelial cells, B cell and so on. Germ cell (CL:0000586) were further divided into spermatogonium and oocyte. This result shows that DCNet has the ability to identify cell types that are closer to leaf nodes of the cell ontology structure.</p>
      <p>It can be seen that the overall trend of those cells abundance increases gradually from 4 to 14 weeks of pregnancy, and the cell abundance remains relatively high level after 14 weeks [<xref rid="f0003" ref-type="fig">Figure 3e</xref>, Supplementary table 2]. By the second and third months of embryonic development, the primordia of almost all organs have basically been formed. This is followed by the internal cell proliferation and increase in volume. This phenomenon may be related to the cells maintaining a high level and active state after 14 weeks. These cells play an important role in the process of development and overall development. These breakthroughs span several stages of development, which is consistent with previous research.<sup><xref rid="cit0020" ref-type="bibr">20</xref>,<xref rid="cit0021" ref-type="bibr">21</xref></sup> The above result shows that DCNet can not only predict the cell abundance of the common immune cells mentioned above but also quantify the cell abundance of other cell types.</p>
    </sec>
    <sec disp-level="2" id="s0002-s2004">
      <title>The patients from TCGA cohort exhibits two significantly different types of TME</title>
      <p>To further study the potential of DCNet to evaluate the TME, we built the cell abundance landscapes of 434 cell types for 10,176 tumor samples of TCGA using DCNet. Based on the information of the cell abundance landscapes, two TME cancer subtypes with obvious difference in the cell abundance, named immunoprotective subtype (IPS) and nonimmune protective subtype (NIPS), were identified by using the consensus clustering method.<sup><xref rid="cit0022" ref-type="bibr">22</xref></sup> There are more samples in IPS, and there are more cancer types than NIPS [<xref rid="f0004" ref-type="fig">Figure 4a</xref>]. There is a statistical difference in survival time between two TME cancer subtype group (log-rank test, <italic toggle="yes">p</italic> &lt; .0001) [<xref rid="f0004" ref-type="fig">Figure 4b</xref>]. Patients in the cancer IPS group have better survival than patients in the cancer NIPS group.
<fig position="float" id="f0004" fig-type="figure"><label>Figure 4.</label><caption><p><bold>Recognition of cancer subtypes based on DCNet method and mining of cell interaction networks</bold>. (a) tSNE distribution map, <italic toggle="yes">x</italic> is tSNE_1, <italic toggle="yes">y</italic> is tSNE_2. Each dot represents a sample, and the text represents the type of cancer. Red is IPS and blue is NIPS. (b) Survival curve of IPS and NIPS. The abscissa is the survival time, and the ordinate is the survival rate. (c) and (d) respectively represent IPS and NIPS. The left side of the two graphs is the cell interaction network. The size of the dot is the expression level of the cell. The redder the color, the higher the risk (HR), and the green line is positive Correlation, the black line is negative correlation, triangles represent nonimmune cells, circles represent immune cells, and squares are tumor cells. The middle list of (c) and (d) shows the cell composition information of the four motifs, and the right list shows the survival curves of the high- and low-risk groups according to the four modules.</p></caption><alternatives><graphic xlink:href="KONI_A_2043662_F0004_OC" content-type="color" specific-use="web-only" position="float"/><graphic xlink:href="KONI_A_2043662_F0004_PB" content-type="black-white" specific-use="print-only" position="float"/></alternatives></fig></p>
      <p>To investigate the cell abundance characteristics of two cancer subtypes in the TME, we analyzed the differences in cell-type composition, cell abundance, and hazard risk for each cancer subtype. For each cell, the patients were divided into two groups according to the median of this cell abundance and the hazard ratio of each cell was calculated in each cancer subtype respectively. Then the correlations between cells were calculated by using the cell abundance co-expression level (see the detail in the method section). Based on information of the hazard risk for each cell and the correlations between cells, the cell-cell related networks were constructed for each cancer subtype. The cell-cell related network describes biological interactions among cells and provides a systematic understanding of the TME [<xref rid="f0004" ref-type="fig">Figures 4C</xref>, D, left panel]. From a global perspective, it represents the different TME between NIPS and IPS. The patients of IPS have more immune cells and low hazard cells infiltration, and stronger connections between cells, in which the number of edges in the cell-cell related networks for cancer IPS and NIPS is 1528 and 1266. Two network modules (motifs) for the IPS were discovered by using MCODE method respectively [<xref rid="f0004" ref-type="fig">Figures 4C</xref>, D, middle panel]. In motif-1, there are fewer cell types, but more abundant of T cells and B cells. In motif-2, it shows there are more connections between immune cells and cancer cells, which is more likely to occur in the killing process of tumor cells. But for the patients of NIPS, they have more nonimmune cells and high-risk cells, which may contribute to the worse prognosis of those patients. Two network modules (motifs) were also discovered in NIPS, most of cells in motif-1 are nonimmune cells, and not communicate with tumor cells.</p>
      <p>According to the mean HR of different motifs, patients are divided into high and low risk groups, all of which have a large difference in survival (log-rank <italic toggle="yes">p</italic> &lt; .0001). These four motifs can be used as markers for dividing sample risks [<xref rid="f0004" ref-type="fig">Figures 4C</xref>, D, right panel].</p>
      <p>It is difficult to measure the cell abundance landscapes in the process of clinical diagnosis and treatment, which causes the difficult in identifying the patients’subtype. But several gene expression signatures are easy to be detected in routine clinical practice. We further identified the TME specific genes as diagnostic markers. First, we analyzed the differentially expressed cell types based on the cell abundance of the two subtypes, and obtained top 1500 differentially expressed marker genes of these cells. Single and multiple Cox’s proportional-hazards regressions were fitted on differentially expressed marker gene expression and, and we identified 33 gene signatures whose risk score was confirmed to be an independent prognostic factor [<xref rid="f0005" ref-type="fig">Figure 5a</xref>]. GO function enrichment analysis of the prognostic signature was performed and these 33 genes are significantly enriched in functions linked to binding for post-transcriptional gene silencing, mRNA binding participates in post-transcriptional gene silencing, and other functions [<xref rid="f0005" ref-type="fig">Figure 5b</xref>].
<fig position="float" id="f0005" fig-type="figure"><label>Figure 5.</label><caption><p><bold>PD1 response samples verify cancer subtypes</bold>. (a) A heatmap of the expression level of differential genes. The darker the color, the higher the expression level of the gene. The upper band represents the type of cancer pressure type, red is IPS, and blue is NIPS. (b) Gene function enrichment, the abscissa is -Log10P level, and the ordinate is the function name. Blue is Canonical pathway, green is KEGG pathway, Orange is GO biological process, and purple is response group gene combination. (c) Survival curves of PD1 response and non-response samples. (d) The risk of PD1 response and non-response samples are compared. NR is the non-response group, R is the response group, and the ordinate is the risk score.</p></caption><alternatives><graphic xlink:href="KONI_A_2043662_F0005_OC" content-type="color" specific-use="web-only" position="float"/><graphic xlink:href="KONI_A_2043662_F0005_PB" content-type="black-white" specific-use="print-only" position="float"/></alternatives></fig></p>
      <p>Next, those genes were gathered as a signal prognostic signature, which may be a potential biomarker for the prognosis of patients. The risk score was calculated to evaluate the predictive value of those genes. According to risk score values, we have divided the PD1 immune response patients into low risk group (risk score lower), and high risk group (risk score higher). Then survival curve analysis demonstrated that the overall survival rate of high risk patients was significantly poorer than that of low risk patients (<italic toggle="yes">p</italic> &lt; .05) [<xref rid="f0005" ref-type="fig">Figure 5c</xref>]. We analyzed the difference in risk scores between PD1 response and non-response patients groups, and found that the risk of non-responders was significantly higher than the risk scores of patients in the response group (<italic toggle="yes">p</italic> = .00051) [<xref rid="f0005" ref-type="fig">Figure 5d</xref>]. All in all, our results suggest that the cell abundance landscapes evaluated by DCNet can be used to describe the TME accurately and to to identify the TME-specific gene markers, which is meaningful for clinical applications. There are many communications between nonimmune cells and tumor cells, which may be contributed to understand the role of immune cells in the TME.</p>
    </sec>
    <sec disp-level="2" id="s0002-s2005">
      <title>Lung cancer subtypes show significant differences in cell landscape</title>
      <p>We analyzed the abundance difference of cells between the two subtypes of non-small cell lung cancer (LUAD and LUSC in TCGA). The cells with a significant difference in abundance of LUAD and LUSC are identified (log2(Fold Change+1)&gt;1, log2(Fold Change+1)&lt;-1, <italic toggle="yes">p</italic> &lt; .01) in comparison to normal patients. Further, lung-specific and immune cell types were retained. There are 15 deferentially expressed cells in LUSC and 18 deferentially expressed cells in LUAD, and 12 common deferentially expressed cell types in both cancer subtypes, which presents that LUAD and LUSC have significant differences in TME of lung cancer [<xref rid="f0006" ref-type="fig">Figure 6a</xref>, Supplementary table 3]. Among them, the cell abundance of Neuroepithelial cell, Myofibroblast and Basal cell were significantly higher in LUSC than in LUAD [<xref rid="f0006" ref-type="fig">Figure 6b</xref>]. However, the content of Granulocyte, Alveolar cell, Leukocyte, Secretory cell, Myeloid-derived suppressor cell, Ciliated cell is higher in LUAD [<xref rid="f0006" ref-type="fig">Figure 6c</xref>]. This reflects the difference between LUAD and LUSC in the TME. Here, we consulted the literature and found that all these cell types were specifically related to lung cancer subtypes.<sup><xref rid="cit0023" ref-type="bibr">23–31</xref></sup> For example, basal cell is a candidate cell of origin for LUSC. More importantly, distinct basal cell lineage trajectories may be involved in homeostasis and injury repair.<sup><xref rid="cit0025" ref-type="bibr">25</xref></sup> Isaeva, O.I. et al. found that tumor-infiltrating B-cells were significantly associated with LUAD prognosis, and the main mechanism was that the positive effect of IgG4 was related to the activation of the myeloid suppressor cell, thereby avoiding immunosuppression.<sup><xref rid="cit0030" ref-type="bibr">30</xref></sup>
<fig position="float" id="f0006" fig-type="figure"><label>Figure 6.</label><caption><p><bold>Predict cell types involved in the tumor microenvironment</bold>. (a) Differential cells of non-small cell lung cancer. Blue is the number of LUAD differential cells, Orange is the number of LUSC differential cells, green is the number of cells verified in the paper. (b) The content of LUAD specific cell types is compared with LUSC, where <italic toggle="yes">x</italic> is the cell type and <italic toggle="yes">y</italic> is the cell content evaluated by DCNet (<italic toggle="yes">t</italic> test ***, <italic toggle="yes">p</italic> &lt; .001). (c) The content of LUSC specific cell types is compared with LUAD, where <italic toggle="yes">x</italic> is the cell type and <italic toggle="yes">y</italic> is the cell content evaluated by DCNet (<italic toggle="yes">t</italic> test ***, <italic toggle="yes">p</italic> &lt; .001). (d) ROC curve, <italic toggle="yes">x</italic> is sensitivity, <italic toggle="yes">y</italic> is specificity.</p></caption><alternatives><graphic xlink:href="KONI_A_2043662_F0006_OC" content-type="color" specific-use="web-only" position="float"/><graphic xlink:href="KONI_A_2043662_F0006_PB" content-type="black-white" specific-use="print-only" position="float"/></alternatives></fig></p>
      <p>Based on these different cells, we constructed a SVM classifier to distinguish the patients of LUAD and LUSC, with AUC = 0.87 for the ROC value [<xref rid="f0006" ref-type="fig">Figure 6d</xref>], which reflects the accuracy of subtype specific cell recognition and further proves that these cells are significantly related to non-small cell lung cancer subtype.</p>
    </sec>
  </sec>
  <sec disp-level="1" id="s0003">
    <title>Discussion</title>
    <p>Here, the new method DCNet is proposed for portraying the TME based on the relationships between 434 cell types and 9078 marker genes, using the deep learning method. It can evaluate the cell abundance landscapes of patients from bulk RNA-seq sequencing data. The design purpose of the DCNet method is to try to summarize the relationship between marker genes and cells, and to avoid the contribution of individual marker genes to cell types. In the assessment of the content of 434 cells, the analysis results of immune cell types are more stable and more robust than existing methods. Similarly, in the nonimmune cell types, it also shows higher accuracy and important biological significance. Furthermore, based on the DCNet method, we identified two cancer subtypes and found four modules in the cell-cell interaction network. The TME-specific biomarker genes were identified, that can divided the patients into lower risk group and higher risk group. Cell types that may participate in the microenvironment of lung cancer have been found. In actual application, we recommend choosing DCNet with a dropout of 0.1, and fine-tuning the DCNet model in the sample data set. This can improve the accuracy of DCNet’s evaluation. Because DCNet method covers all cell types currently available, it is recommended that researchers chose the appropriate or top ranked cell types to analysis according the purpose of research and the dataset used.</p>
    <p>In general, we provide an important neural network model method DCNet, which can evaluate the cell abundance landscapes of patients from bulk RNA-seq data. The performance of DCNet is better than other existing methods, and it is a comprehensive and accurate method for analyzing the cell abundance landscapes. It has been verified in practical applications.</p>
  </sec>
  <sec disp-level="1" id="s0004">
    <title>Data and methods</title>
    <sec disp-level="2" id="s0004-s2001">
      <title>Data Available</title>
      <p>From the GDC database (<ext-link xlink:href="https://portal.gdc.cancer.gov/projects" ext-link-type="uri">https://portal.gdc.cancer.gov/projects</ext-link>) downloaded 32 kinds of cancer samples and normal samples, a total of 10,906 patients’ RNA-seq expression profiles and clinical data. Two subtypes of non-small cell lung cancer data were used separately: lung adenocarcinoma (LUAD) and lung squamous cell carcinoma (LUSC). Download five sets of data from the GEO database (<ext-link xlink:href="https://www.ncbi.nlm.nih.gov/geo/" ext-link-type="uri">https://www.ncbi.nlm.nih.gov/geo/</ext-link>). GSE81861 (CRC): 11 samples of colorectal cancer patients, 7 cell types.<sup><xref rid="cit0032" ref-type="bibr">32</xref></sup> GSE75688 (BC): Single-cell sequencing data of 11 breast cancer cells and lymph node metastases.<sup><xref rid="cit0033" ref-type="bibr">33</xref></sup> It is including 515 single cell RNA-sequencing data, which was sequenced with Illumina HiSeq 2500. The gene expression level is represented as TPM (Transcript per million), which are already normalized and can be comparable across samples in the next analysis. GSE86146 (FGC): 2167 individual PGCs and their gonadal niche cells, covering the developmental stages of female and male human embryos from 4 to 26 weeks after pregnancy.<sup><xref rid="cit0021" ref-type="bibr">21</xref></sup> GSE72056 (Melanoma): 31 melanoma samples and their 6 cell types.<sup><xref rid="cit0034" ref-type="bibr">34</xref></sup> GSE78220 (PD1): Transcriptome samples and corresponding clinical data of 38 melanoma biopsy specimens before anti-PD-1 treatment.<sup><xref rid="cit0035" ref-type="bibr">35</xref></sup> The cell types and corresponding marker gene are obtained from the CellMarker<sup><xref rid="cit0036" ref-type="bibr">36</xref></sup> database (<ext-link xlink:href="http://bio-bigdata.hrbmu.edu.cn/CellMarker/" ext-link-type="uri">http://bio-bigdata.hrbmu.edu.cn/CellMarker/</ext-link>).</p>
    </sec>
    <sec disp-level="2" id="s0004-s2002">
      <title>CellMarker data preprocessing</title>
      <p>We downloaded 13,605 marker genes across 467 cell types in 158 human tissues from the CellMarker database. The data was processed as follows: As some cells and their marker genes repeatedly appear in different human tissues, tissue-specific duplications were deleted, keeping only one cell and its marker genes as representative of the duplicated group. The marker genes which not detected in TCGA gene sets were also deleted for the purpose of the DCNet model trainning [detail in TCGA data preprocessing], then 33 cell types were discarded because none of marker-genes were detected. Finally, 434 cell types including immune cells, cancer cells, stromal cells and so on, and their corresponding 9078 marker genes were kept for further analysis. The cell abundance for major cell types was calculated by integrating the category information of the cellmarker database (<ext-link xlink:href="http://biocc.hrbmu.edu.cn/CellMarker/" ext-link-type="uri">http://biocc.hrbmu.edu.cn/CellMarker/</ext-link>) and Cell Ontology database (OBO: <ext-link xlink:href="http://www.obofoundry.org/ontology/cl.html" ext-link-type="uri">http://www.obofoundry.org/ontology/cl.html</ext-link>). In the 434 cell types identified by DCNet, there were 77 cell types without Cell Ontology IDs, and 137 cell types have no owns Cell Ontology IDs but were assigned to its parent’s term IDs, and 220 cell types have owned Cell Ontology IDs in the OBO database. For the cell types without Cell Ontology IDs or only with its parents Cell Ontology IDs, the hierarchical relationship information between the cell types was obatined from the CellMarker database. For the cell types with owns Cell Ontology IDs, the ontology structure information between the cell types was downloaded from the cell OBO database. Integrating those information, the Supplementary Table 1 was created and it includes information of the parent and child cell type name, the cell ontology ids of parent and child cell type, the data source database (CellMarker or OBO).</p>
      <p>The cell abundance of parent cell types was calculated by the accumulation of the cell abundance of its child cell types for the CellMarker database and its leaf node in the cell ontology structure for OBO database.</p>
    </sec>
    <sec disp-level="2" id="s0004-s2003">
      <title>TCGA data preprocessing</title>
      <p>For the expression profile data of TCGA, the genes whose expression level is 0 in more than 1/3 samples were deleted, 21,136 genes were retained, and log normalization was performed. We divided the gene expression of each sample into input data (expression level of 9078 marker genes) and output data (expression level of 21,136 genes). Due to the uneven distribution of cancer samples, we adopted an oversampling method to enlarge the number of samples while balancing the sample categories. In addition, during the experimental measurement process, some genes cannot be detected due to the low expression intensity of some genes or experimental errors, which will cause the input dimension of the model to not match the marker gene dimension. In order to solve this problem, the input data was randomly deleted with the probability of 0.1, 0.3, 0.5 (0 fill), which could not only increase the training sample, but also reduce the risk of overfitting. Finally, all samples were divided into training set and test set with a ratio of 80% and 20%.</p>
      <p>We also obtained clinical data of 1487 patients with tumor metastasis and drug treatment information from TCGA cohorts using the TCGAbiolink<sup><xref rid="cit0037" ref-type="bibr">37</xref></sup> package. If the number of patients under treatment with a certain drug is less than 48, then the information of this drugs and the patients was deleted. Finally, a total of 7 drugs and 740 patients were kept.</p>
    </sec>
    <sec disp-level="2" id="s0004-s2004">
      <title>DCNet neural network construction and training</title>
      <p>DCNet model trains a deep neural network, which embeds the relationships between cells and their marker genes, to predict more than 400 cell types proportion within bulk seq dataset. The depth of DCNet model is three layers including input layer, hidden layer and output layer. Each cell type is represented by a hidden neuron in the DCNet model. The number of neurons in DCNet is determined based on the corresponding relationships between cells and their marker genes [Supplementary Figure 2A]. The number of neurons in the input layer is equal to the number of total marker genes (9078), the number of neurons in the hidden layer is equal to the number of cell types (434), and the number of neurons in the output layer is equal to the number of TCGA genes (21,136). The construction and training details of the model are described as follows:</p>
      <p>First, DCNet model is constructed based on the autoencoder neural network. For the input layer, DCNet input training data set is denoted as <inline-formula id="ilm0001"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0001.jpg"/><mml:math id="MATH0001"><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo fence="false" stretchy="false">}</mml:mo></mml:math></alternatives></inline-formula>, and <inline-formula id="ilm0002"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0002.jpg"/><mml:math id="MATH0002"><mml:mi>N</mml:mi></mml:math></alternatives></inline-formula> is the number of patients. For each patient <inline-formula id="ilm0003"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0003.jpg"/><mml:math id="MATH0003"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>, <inline-formula id="ilm0004"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0004.jpg"/><mml:math id="MATH0004"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> represents an expression vector for expression of total marker genes, and the dimension is the number of marker genes <inline-formula id="ilm0005"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0005.jpg"/><mml:math id="MATH0005"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="ilm0006"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0006.jpg"/><mml:math id="MATH0006"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> represents an expression vector for the observed expression of total TCGA genes. For the hidden layer, the neurons <inline-formula id="ilm0007"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0007.jpg"/><mml:math id="MATH0007"><mml:mi>C</mml:mi></mml:math></alternatives></inline-formula> denotes the hidden layer and its activation value is used to characterize cell proportion in tumor microenvironment, the dimension is the number of cell types <inline-formula id="ilm0008"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0008.jpg"/><mml:math id="MATH0008"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> [Supplementary Figure 2B]. For the output layer, <inline-formula id="ilm0009"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0009.jpg"/><mml:math id="MATH0009"><mml:mi>O</mml:mi></mml:math></alternatives></inline-formula> denotes the ouput vector and it represents an expression vector for the prediction expression of all TCGA genes, <inline-formula id="ilm0010"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0010.jpg"/><mml:math id="MATH0010"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>O</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> represents the number of all TCGA genes.</p>
      <p>The neurons are not fully connected between the input layer and the hidden layer. The connection matrix is defined as <inline-formula id="ilm0011"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0011.jpg"/><mml:math id="MATH0011"><mml:mi>P</mml:mi></mml:math></alternatives></inline-formula>, where <inline-formula id="ilm0012"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0012.jpg"/><mml:math id="MATH0012"><mml:mi>P</mml:mi></mml:math></alternatives></inline-formula> is one-zero matrix with size <inline-formula id="ilm0013"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0013.jpg"/><mml:math id="MATH0013"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. <inline-formula id="ilm0014"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0014.jpg"/><mml:math id="MATH0014"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:math></alternatives></inline-formula> indicates that there is a connection relationship between the ith marker gene(the <inline-formula id="ilm0015"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0015.jpg"/><mml:math id="MATH0015"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula> th neuron in the input layer) and the <inline-formula id="ilm0016"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0016.jpg"/><mml:math id="MATH0016"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula> th cell type (the <inline-formula id="ilm0017"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0017.jpg"/><mml:math id="MATH0017"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula> th neuron in the hidden layer) and <inline-formula id="ilm0018"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0018.jpg"/><mml:math id="MATH0018"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></alternatives></inline-formula> indicates that there no connection relationship [Supplementary Figure 2C]. The neurons are fully connected between the hidden layer and the output layer.</p>
      <p>In order to ensure that the output values of the hidden layer and the output layer are positive, the rectified linear activation function (RELU) is chosen as the constraint function between those layers. For the input layer and the hidden layer, RELU definition is shown as follows:
<disp-formula-group><disp-formula id="um0001"><alternatives><graphic xlink:href="KONI_A_2043662_UM0001.jpg" position="float"/><mml:math id="MATH0019"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:munderover></mml:mrow><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></disp-formula></disp-formula-group></p>
      <p>Here <inline-formula id="ilm0019"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0019.jpg"/><mml:math id="MATH0020"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> represents the activation value of neurons <inline-formula id="ilm0020"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0020.jpg"/><mml:math id="MATH0021"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula> in the hidden layer, which denotes cell <inline-formula id="ilm0021"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0021.jpg"/><mml:math id="MATH0022"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula> proportion. <inline-formula id="ilm0022"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0022.jpg"/><mml:math id="MATH0023"><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> represents the number of corresponding marker genes of cell <inline-formula id="ilm0023"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0023.jpg"/><mml:math id="MATH0024"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula>. The initialization weight matrix is defined as <inline-formula id="ilm0024"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0024.jpg"/><mml:math id="MATH0025"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>=</mml:mo><mml:mi>W</mml:mi><mml:mo>⋅</mml:mo><mml:mi>P</mml:mi></mml:math></alternatives></inline-formula>, <inline-formula id="ilm0025"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0025.jpg"/><mml:math id="MATH0026"><mml:mi>W</mml:mi></mml:math></alternatives></inline-formula> is a random weight matrix with size <inline-formula id="ilm0026"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0026.jpg"/><mml:math id="MATH0027"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mo>×</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>C</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. <inline-formula id="ilm0027"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0027.jpg"/><mml:math id="MATH0028"><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> represents only those edges between cell type and their marker gens are connected and weighted. <inline-formula id="ilm0028"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0028.jpg"/><mml:math id="MATH0029"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the weight of the relationship between the neuron <inline-formula id="ilm0029"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0029.jpg"/><mml:math id="MATH0030"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula> in the hidden layer and neuron <inline-formula id="ilm0030"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0030.jpg"/><mml:math id="MATH0031"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula> the input layer. <inline-formula id="ilm0031"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0031.jpg"/><mml:math id="MATH0032"><mml:mi>m</mml:mi><mml:msub><mml:mrow><mml:mi> </mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is input neuron <inline-formula id="ilm0032"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0032.jpg"/><mml:math id="MATH0033"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>, which represents expression value of marker gene <inline-formula id="ilm0033"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0033.jpg"/><mml:math id="MATH0034"><mml:mi>i</mml:mi></mml:math></alternatives></inline-formula>. <inline-formula id="ilm0034"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0034.jpg"/><mml:math id="MATH0035"><mml:msubsup><mml:mi>β</mml:mi><mml:mi>j</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> represents the bias of the <inline-formula id="ilm0035"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0035.jpg"/><mml:math id="MATH0036"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula> th neuron in the hidden layer.</p>
      <p>For the hidden layer and the output layer, RELU definition is shown as follows:
<disp-formula-group><disp-formula id="um0002"><alternatives><graphic xlink:href="KONI_A_2043662_UM0002.jpg" position="float"/><mml:math id="MATH0037"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:mi>L</mml:mi><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:munderover></mml:mrow><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>+</mml:mo><mml:msubsup><mml:mi>β</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives></disp-formula></disp-formula-group></p>
      <p>Here <inline-formula id="ilm0036"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0036.jpg"/><mml:math id="MATH0038"><mml:mrow><mml:msub><mml:mi>o</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> represents the output value of neurons <italic toggle="yes">v</italic> in the output layer, which represents the prediction expression of the <inline-formula id="ilm0037"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0037.jpg"/><mml:math id="MATH0039"><mml:mi>v</mml:mi></mml:math></alternatives></inline-formula> th TCGA gene. <inline-formula id="ilm0038"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0038.jpg"/><mml:math id="MATH0040"><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> is the weight of the relationship between neurons <inline-formula id="ilm0039"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0039.jpg"/><mml:math id="MATH0041"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula> in the hidden layer and neurons <inline-formula id="ilm0040"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0040.jpg"/><mml:math id="MATH0042"><mml:mi>v</mml:mi></mml:math></alternatives></inline-formula> in the output layer, which denotes the expression level of the <italic toggle="yes">v</italic> th gene in the <inline-formula id="ilm0041"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0041.jpg"/><mml:math id="MATH0043"><mml:mi>j</mml:mi></mml:math></alternatives></inline-formula> th cell., and <inline-formula id="ilm0042"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0042.jpg"/><mml:math id="MATH0044"><mml:msubsup><mml:mi>β</mml:mi><mml:mi>v</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> represents the bias of neurons <inline-formula id="ilm0043"><alternatives><inline-graphic xlink:href="KONI_A_2043662_ILM0043.jpg"/><mml:math id="MATH0045"><mml:mi>v</mml:mi></mml:math></alternatives></inline-formula> in the output layer.</p>
      <p>To train the DCNet model, its parameters are set as adam optimizer, relu activation function, L2loss loss function, learning rate 1e-4, number of iterations 600, 256 samples per batch, cpu training respectively. DCNet model were coded using the mxnet framework in python and its source code has been uploaded to GitHub (<ext-link xlink:href="http://github.com/xindd/DCNet" ext-link-type="uri">http://github.com/xindd/DCNet</ext-link>).</p>
    </sec>
    <sec disp-level="2" id="s0004-s2005">
      <title>Other neural network methods for comparison</title>
      <p>In addition, in order to verify that the performance of the structured neural network for DCNet, we built and trained other neural networks for comparison. First, we designed five deep autoencoder models (AE), the encoding layer and the decoding layer are both two layers, the number of neurons increases by the power of 2, from 64 to 1024 (named: AE64, AE128, AE256, AE512, AE1024). Second, we designed a fully connected neural network with three layers (Full-DCNet). and the number of neurons is same as DCNet model. Its neurons are fully connected, which is different from the structured neural network of DCNet. Finally, 0.00, 0.01, 0.03, 0.05, 0.07, 0.1, 0.3, 0.5 dropout ratio parameters were set to train DCNet model respectively (DCNet-D0, DCNet-D01, DCNet-D03, DCNet-D05, DCNet-D07, DCNet-D10, DCNet-D30, DCNet-D50). All neutral network were coded using the mxnet framework in python, and the parmameters are same to the training of DCNet.</p>
    </sec>
    <sec disp-level="2" id="s0004-s2006">
      <title>Comparison with other methods</title>
      <p>For the datasets used in this study, we evaluated their cell abundance profiles by used CIBERSORTx (Cell Frections module, <ext-link xlink:href="https://cibersort.stanford.edu/index.php" ext-link-type="uri">https://cibersort.stanford.edu/index.php</ext-link>), EPIC (<ext-link xlink:href="http://epic.gfellerlab.org/" ext-link-type="uri">http://epic.gfellerlab.org/</ext-link>), MCP-Counter (<ext-link xlink:href="https://github.com/ebecht/MCPcoun" ext-link-type="uri">https://github.com/ebecht/MCPcoun</ext-link></p>
      <p>ter), quanTIseq (<ext-link xlink:href="https://icbi.i-med.ac.at/software/quantiseq/doc/index.html" ext-link-type="uri">https://icbi.i-med.ac.at/software/quantiseq/doc/index.html</ext-link>), TIMER (<ext-link xlink:href="https://cistrome.shinyapps.io/timer/" ext-link-type="uri">https://cistrome.shinyapps.io/timer/</ext-link>) and xCell (<ext-link xlink:href="https://xcell.ucsf.edu/" ext-link-type="uri">https://xcell.ucsf.edu/</ext-link>) respectively. Each method is set to default parameters.The immuneconv package<sup><xref rid="cit0038" ref-type="bibr">38</xref></sup> of the R language, which is a comprehensive method to estimate the cell abundance by integrating methods of CIBERSORT, EPIC, MCP-Counter, quanTIseq, TIMER and xCell. We used it to construct simulation data of bulk RNA-seq expression profiles based on BC samples for comparison with other models.</p>
    </sec>
    <sec disp-level="2" id="s0004-s2007">
      <title>Related statistical analysis</title>
      <p>Marker genes should be cell-specific high expression in the corresponding cell type. It means that the relationships between the cell of the hidden layer and its marker gene of output layer should have higher weight. We used relationships’weight value bewteen the hidden layer and ourput layer as genes score vector, and created a vector containing the values 0, 1 based on whether the gene is a cell marker gene. We calculated the AUC value with the above two vector. The value of ROC curves is higher means that the marker genes are cell-specific higher expression.</p>
      <p>FGC dataset was analyzed by DCNet, and the abundance of 434 cell types were obtained. Sort the cell type in descending order according to the abundance of each cell type and select the top 20 cell types as enriched cell types in FGC dataset, and then only cell types with cell ontology identity were kept for further analysis. We used an R package ontoProc (<ext-link xlink:href="https://github.com/vjcitn/ontoProc" ext-link-type="uri">https://github.com/vjcitn/ontoProc</ext-link>) to visualize structure of cell ontology of those cell types.</p>
      <p>The R package of ConsensusCluster,<sup><xref rid="cit0022" ref-type="bibr">22</xref></sup> which provides a consensus clustering approach was used to classify pancancer patients into different cancer subtypes according the cell landscape identified by DCNet model. In brief, using a manhattan distance, the cluster method of partition around medoids (PAM) was resampled by 0.8% from all cell type features in 1000 iterations. The result is a co-classification matrix with the matrix element value equal to the frequency at which each pair of samples was found in the same cluster in the 1000 iterations. The consensus cluster result was obtained by a final k-mean clustering. In order to select the number of clusters K, the cophenetic correlation coefficient was calculated and the optimal number of consensus cluster was selected as K preceding the largest drop in the cophenetic correlation coefficient.</p>
      <p>To identify differentially enrichment cell types, foldchange&gt;2 or foldchange&lt;0.5 and <italic toggle="yes">q</italic>-value&lt;0.01 were used as standards by using limma package. Univariate and multivariate Cox regression models are used for cell type risk assessment. <italic toggle="yes">T</italic> test was used to identify differentially expressed genes (DEGs) between cancer subtypes. Function enrichment analyses of DEGs were performed using Metascape (<ext-link xlink:href="http://metascape.org" ext-link-type="uri">http://metascape.org</ext-link>).</p>
      <p>A risk model was constructed with the formula: Risk score = Σ(log10(HR)×genes expression), and the patients were divide into high-risk and low-risk groups based on the median risk score. Kaplan-Meier plots were used to compare survival curves of high risk and low risk groups.</p>
      <p>Cell-cell interactions network was constructed and analyzed by using cytoscape software (<ext-link xlink:href="https://cytoscape.org/" ext-link-type="uri">https://cytoscape.org/</ext-link>). Network motifs were identified by MCODE (Molecular Complex Detection), which is a cytoscape plugin and it can detect subnetworks in an interactome.<sup><xref rid="cit0039" ref-type="bibr">39</xref></sup></p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="SM7241" position="float" content-type="local-data">
      <caption>
        <title>Supplemental Material</title>
      </caption>
      <media xlink:href="KONI_A_2043662_SM7241.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec sec-type="COI-statement" disp-level="1" id="s0005">
    <title>Disclosure statement</title>
    <p>No potential conflict of interest was reported by the author(s).</p>
  </sec>
  <sec sec-type="supplementary-material" disp-level="1" id="s0006">
    <title>Supplementary material</title>
    <p>Supplemental data for this article can be accessed on the <ext-link xlink:href="https://doi.org/10.1080/2162402X.2022.2043662" ext-link-type="uri">publisher’s website</ext-link></p>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="cit0001">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Riley</surname><given-names>RS</given-names></string-name>, <string-name><surname>June</surname><given-names>CH</given-names></string-name>, <string-name><surname>Langer</surname><given-names>R</given-names></string-name>, <string-name><surname>Mitchell</surname><given-names>MJ.</given-names></string-name></person-group><article-title>Delivery technologies for cancer immunotherapy</article-title>. <source>Nat Rev Drug Discov</source>. <year>2019</year>;<volume>18</volume>(<issue>3</issue>):<fpage>175</fpage>–<lpage>12</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41573-018-0006-z</pub-id>.<pub-id pub-id-type="pmid">30622344</pub-id></mixed-citation>
    </ref>
    <ref id="cit0002">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hui</surname><given-names>L</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y.</given-names></string-name></person-group><article-title>Tumor microenvironment: sanctuary of the devil</article-title>. <source>Cancer Lett</source>. <year>2015</year>;<volume>368</volume>(<issue>1</issue>):<fpage>7</fpage>–<lpage>13</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.canlet.2015.07.039</pub-id>.<pub-id pub-id-type="pmid">26276713</pub-id></mixed-citation>
    </ref>
    <ref id="cit0003">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hinshaw</surname><given-names>DC</given-names></string-name>, <string-name><surname>Shevde</surname><given-names>LA</given-names></string-name></person-group>. <article-title>The tumor microenvironment innately modulates cancer progression</article-title>. <source>Cancer Res</source>. <year>2019</year>;<volume>79</volume>(<issue>18</issue>):<fpage>4557</fpage>–<lpage>4566</lpage>. doi:<pub-id pub-id-type="doi">10.1158/0008-5472.CAN-18-3962</pub-id>.<pub-id pub-id-type="pmid">31350295</pub-id></mixed-citation>
    </ref>
    <ref id="cit0004">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>X</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>Z</given-names></string-name>, <string-name><surname>Fei</surname><given-names>L</given-names></string-name>, <string-name><surname>Sun</surname><given-names>H</given-names></string-name>, <string-name><surname>Wang</surname><given-names>R</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name>, <string-name><surname>Tang</surname><given-names>H</given-names></string-name>, <string-name><surname>Ge</surname><given-names>W</given-names></string-name></person-group>. <article-title>Construction of a human cell landscape at single-cell level</article-title>. <source>Nature</source>. <year>2020</year>;<volume>581</volume>(<issue>7808</issue>):<fpage>303</fpage>–<lpage>309</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41586-020-2157-4</pub-id>.<pub-id pub-id-type="pmid">32214235</pub-id></mixed-citation>
    </ref>
    <ref id="cit0005">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Quail</surname><given-names>DF</given-names></string-name>, <string-name><surname>Joyce</surname><given-names>JA</given-names></string-name></person-group>. <article-title>The microenvironmental landscape of brain tumors</article-title>. <source>Cancer Cell</source>. <year>2017</year>;<volume>31</volume>(<issue>3</issue>):<fpage>326</fpage>–<lpage>341</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.ccell.2017.02.009</pub-id>.<pub-id pub-id-type="pmid">28292436</pub-id></mixed-citation>
    </ref>
    <ref id="cit0006">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Newman</surname><given-names>AM</given-names></string-name>, <string-name><surname>Steen</surname><given-names>CB</given-names></string-name>, <string-name><surname>Liu</surname><given-names>CL</given-names></string-name>, <string-name><surname>Gentles</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Chaudhuri</surname><given-names>AA</given-names></string-name>, <string-name><surname>Scherer</surname><given-names>F</given-names></string-name>, <string-name><surname>Khodadoust</surname><given-names>MS</given-names></string-name>, <string-name><surname>Esfahani</surname><given-names>MS</given-names></string-name>, <string-name><surname>Luca</surname><given-names>BA</given-names></string-name>, <string-name><surname>Steiner</surname><given-names>D</given-names></string-name>, et al</person-group>. <article-title>Determining cell type abundance and expression from bulk tissues with digital cytometry</article-title>. <source>Nat Biotechnol</source>. <year>2019</year>;<volume>37</volume>(<issue>7</issue>):<fpage>773</fpage>–<lpage>782</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41587-019-0114-2</pub-id>.<pub-id pub-id-type="pmid">31061481</pub-id></mixed-citation>
    </ref>
    <ref id="cit0007">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Racle</surname><given-names>J</given-names></string-name>, <string-name><surname>de Jonge</surname>, <given-names>K</given-names></string-name>, <string-name><surname>Baumgaertner</surname>, <given-names>P</given-names></string-name>, <string-name><surname>Speiser</surname> , <given-names>DE</given-names></string-name>, <string-name><surname>Gfeller</surname>, <given-names>D</given-names></string-name></person-group>. <article-title>Simultaneous enumeration of cancer and immune cell types from bulk tumor gene expression data</article-title>. <source>Elife</source>. <year>2017</year>;<fpage>6</fpage>:e26476. doi:<pub-id pub-id-type="doi">10.7554/eLife.26476</pub-id></mixed-citation>
    </ref>
    <ref id="cit0008">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Becht</surname><given-names>E</given-names></string-name></person-group>,Giraldo NA, Lacroix L, Buttard B, Elarouci N, Petitprez F, Selves J, Laurent-Puig P, Sautès-Fridman C, Fridman WH, de Reyniès A . <article-title>Estimating the population abundance of tissue-infiltrating immune and stromal cell populations using gene expression</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>218</fpage>. doi:<pub-id pub-id-type="doi">10.1186/s13059-016-1070-5</pub-id>.<pub-id pub-id-type="pmid">27765066</pub-id></mixed-citation>
    </ref>
    <ref id="cit0009">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Finotello</surname><given-names>F</given-names></string-name></person-group>, Mayer C, Plattner C, Laschober G, Rieder D, Hackl H, Krogsdam A, Loncova Z, Posch W, Wilflingseder D, Sopper S, Ijsselsteijn M, Brouwer TP, Johnson D, Xu Y, Wang Y, Sanders ME, Estrada MV, Ericsson-Gonzalez P, Charoentong P, Balko J, de Miranda NFDCC, Trajanoski Z. <article-title>Molecular and pharmacological modulators of the tumor immune contexture revealed by deconvolution of RNA-seq data</article-title>. <source>Genome Med</source>. <year>2019</year>;<volume>11</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>20</lpage>. doi:<pub-id pub-id-type="doi">10.1186/s13073-018-0611-9</pub-id>.<pub-id pub-id-type="pmid">30609936</pub-id></mixed-citation>
    </ref>
    <ref id="cit0010">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>B</given-names></string-name>, <string-name><surname>Severson</surname><given-names>E</given-names></string-name>, <string-name><surname>Pignon</surname><given-names>J-C</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>H</given-names></string-name>, <string-name><surname>Li</surname><given-names>T</given-names></string-name>, <string-name><surname>Novak</surname><given-names>J</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>P</given-names></string-name>, <string-name><surname>Shen</surname><given-names>H</given-names></string-name>, <string-name><surname>Aster</surname><given-names>JC</given-names></string-name>, and <string-name><surname>Rodig</surname><given-names>S</given-names></string-name>, et al</person-group>. <article-title>Comprehensive analyses of tumor immunity: implications for cancer immunotherapy</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>174</fpage>. doi:<pub-id pub-id-type="doi">10.1186/s13059-016-1028-7</pub-id>.<pub-id pub-id-type="pmid">27549193</pub-id></mixed-citation>
    </ref>
    <ref id="cit0011">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname><given-names>D</given-names></string-name>, <string-name><surname>Hu</surname><given-names>Z</given-names></string-name>, <string-name><surname>Butte</surname><given-names>AJ</given-names></string-name></person-group>. <article-title>xCell: digitally portraying the tissue cellular heterogeneity landscape</article-title>. <source>Genome Biol</source>. <year>2017</year>;<volume>18</volume>(<issue>1</issue>):<fpage>220</fpage>. doi:<pub-id pub-id-type="doi">10.1186/s13059-017-1349-1</pub-id>.<pub-id pub-id-type="pmid">29141660</pub-id></mixed-citation>
    </ref>
    <ref id="cit0012">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luca</surname><given-names>BA</given-names></string-name>, <string-name><surname>Steen</surname><given-names>CB</given-names></string-name>, <string-name><surname>Matusiak</surname><given-names>M</given-names></string-name>, <string-name><surname>Azizi</surname><given-names>A</given-names></string-name>, <string-name><surname>Varma</surname><given-names>S</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>C</given-names></string-name>, <string-name><surname>Przybyl</surname><given-names>J</given-names></string-name>, <string-name><surname>Espín-Pérez</surname><given-names>A</given-names></string-name>, <string-name><surname>Diehn</surname><given-names>M</given-names></string-name>, <string-name><surname>Alizadeh</surname><given-names>AA</given-names></string-name>, et al</person-group>. <article-title>Atlas of clinically distinct cell states and ecosystems across human solid tumors</article-title>. <source>Cell</source>. <year>2021</year>;<volume>184</volume>(<issue>21</issue>):<fpage>5482</fpage>–<lpage>5496 e28</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.cell.2021.09.014</pub-id>.<pub-id pub-id-type="pmid">34597583</pub-id></mixed-citation>
    </ref>
    <ref id="cit0013">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Coudray</surname><given-names>N</given-names></string-name>, <string-name><surname>Ocampo</surname><given-names>PS</given-names></string-name>, <string-name><surname>Sakellaropoulos</surname><given-names>T</given-names></string-name>, <string-name><surname>Narula</surname><given-names>N</given-names></string-name>, <string-name><surname>Snuderl</surname><given-names>M</given-names></string-name>, <string-name><surname>Fenyö</surname><given-names>D</given-names></string-name>, <string-name><surname>Moreira</surname><given-names>AL</given-names></string-name>, <string-name><surname>Razavian</surname><given-names>N</given-names></string-name>, <string-name><surname>Tsirigos</surname><given-names>A</given-names></string-name></person-group>. <article-title>Classification and mutation prediction from non-small cell lung cancer histopathology images using deep learning</article-title>. <source>Nat Med</source>. <year>2018</year>;<volume>24</volume>(<issue>10</issue>):<fpage>1559</fpage>–<lpage>1567</lpage>. doi:<pub-id pub-id-type="doi">10.1038/s41591-018-0177-5</pub-id>.<pub-id pub-id-type="pmid">30224757</pub-id></mixed-citation>
    </ref>
    <ref id="cit0014">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schmauch</surname><given-names>B</given-names></string-name>, <string-name><surname>Romagnoni</surname><given-names>A</given-names></string-name>, <string-name><surname>Pronier</surname><given-names>E</given-names></string-name>, <string-name><surname>Saillard</surname><given-names>C</given-names></string-name>, <string-name><surname>Maillé</surname><given-names>P</given-names></string-name>, <string-name><surname>Calderaro</surname><given-names>J</given-names></string-name>, <string-name><surname>Kamoun</surname><given-names>A</given-names></string-name>, <string-name><surname>Sefta</surname><given-names>M</given-names></string-name>, <string-name><surname>Toldo</surname><given-names>S</given-names></string-name>, <string-name><surname>Zaslavskiy</surname><given-names>M</given-names></string-name></person-group>. <article-title>A deep learning model to predict RNA-Seq expression of tumours from whole slide images</article-title>. <source>Nat Commun</source>. <year>2020</year>;<volume>11</volume>(<issue>1</issue>):<fpage>3877</fpage>. doi:<pub-id pub-id-type="doi">10.1038/s41467-020-17678-4</pub-id>.<pub-id pub-id-type="pmid">32747659</pub-id></mixed-citation>
    </ref>
    <ref id="cit0015">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saltz</surname><given-names>J</given-names></string-name>, <string-name><surname>Gupta</surname><given-names>R</given-names></string-name>, <string-name><surname>Hou</surname><given-names>L</given-names></string-name>, <string-name><surname>Kurc</surname><given-names>T</given-names></string-name>, <string-name><surname>Singh</surname><given-names>P</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>V</given-names></string-name>, <string-name><surname>Samaras</surname><given-names>D</given-names></string-name>, <string-name><surname>Shroyer</surname><given-names>KR</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>T</given-names></string-name>, <string-name><surname>Batiste</surname><given-names>R</given-names></string-name>, et al</person-group>. <article-title>Spatial organization and molecular correlation of tumor-infiltrating lymphocytes using deep learning on pathology images</article-title>. <source>Cell Rep</source>. <year>2018</year>;<volume>23</volume>(<issue>1</issue>):<fpage>181</fpage>–<lpage>193.e7</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.celrep.2018.03.086</pub-id>.<pub-id pub-id-type="pmid">29617659</pub-id></mixed-citation>
    </ref>
    <ref id="cit0016">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dwivedi</surname><given-names>SK</given-names></string-name>, <string-name><surname>Tjärnberg</surname><given-names>A</given-names></string-name>, <string-name><surname>Tegnér</surname><given-names>J</given-names></string-name>, <string-name><surname>Gustafsson</surname><given-names>M</given-names></string-name></person-group>. <article-title>Deriving disease modules from the compressed transcriptional space embedded in a deep autoencoder</article-title>. <source>Nat Commun</source>. <year>2020</year>;<volume>11</volume>(<issue>1</issue>):<fpage>856</fpage>. doi:<pub-id pub-id-type="doi">10.1038/s41467-020-14666-6</pub-id>.<pub-id pub-id-type="pmid">32051402</pub-id></mixed-citation>
    </ref>
    <ref id="cit0017">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>HH</given-names></string-name>, <string-name><surname>Chiu</surname><given-names>Y-C</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>T</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>S</given-names></string-name>, <string-name><surname>Huang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y</given-names></string-name></person-group>. <article-title>GSAE: an autoencoder with embedded gene-set nodes for genomics functional characterization</article-title>. <source>BMC Syst Biol</source>. <year>2018</year>;<volume>12</volume>(<issue>Suppl 8</issue>):<fpage>142</fpage>. doi:<pub-id pub-id-type="doi">10.1186/s12918-018-0642-2</pub-id>.<pub-id pub-id-type="pmid">30577835</pub-id></mixed-citation>
    </ref>
    <ref id="cit0018">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>J</given-names></string-name></person-group>, Yu MK, Fong S, Ono K, Sage E, Demchak B, Sharan R, Ideker T. <article-title>Using deep learning to model the hierarchical structure and function of a cell</article-title>. <source>Nat Methods</source>. <year>2018</year>;<volume>15</volume>(<issue>4</issue>):<fpage>290</fpage>–<lpage>298</lpage>. doi:<pub-id pub-id-type="doi">10.1038/nmeth.4627</pub-id>.<pub-id pub-id-type="pmid">29505029</pub-id></mixed-citation>
    </ref>
    <ref id="cit0019">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Azodi</surname><given-names>CB</given-names></string-name>, <string-name><surname>Tang</surname><given-names>J</given-names></string-name>, <string-name><surname>Shiu</surname><given-names>SH</given-names></string-name></person-group>. <article-title>Opening the black box: interpretable machine learning for geneticists</article-title>. <source>Trends Genet</source>. <year>2020</year>;<volume>36</volume>(<issue>6</issue>):<fpage>442</fpage>–<lpage>455</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.tig.2020.03.005</pub-id>.<pub-id pub-id-type="pmid">32396837</pub-id></mixed-citation>
    </ref>
    <ref id="cit0020">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>La</surname><given-names>H</given-names></string-name>, <string-name><surname>Yoo</surname><given-names>H</given-names></string-name>, <string-name><surname>Lee</surname><given-names>EJ</given-names></string-name>, <string-name><surname>Thang</surname><given-names>NX</given-names></string-name>, <string-name><surname>Choi</surname><given-names>HJ</given-names></string-name>, <string-name><surname>Oh</surname><given-names>J</given-names></string-name>, <string-name><surname>Park</surname><given-names>JH</given-names></string-name>, <string-name><surname>Hong</surname><given-names>K</given-names></string-name></person-group>. <article-title>Insights from the applications of single-cell transcriptomic analysis in germ cell development and reproductive medicine</article-title>. <source>Int J Mol Sci</source>. <year>2021</year>;<volume>22</volume>(<issue>2</issue>):<fpage>823</fpage>. doi:<pub-id pub-id-type="doi">10.3390/ijms22020823</pub-id>.</mixed-citation>
    </ref>
    <ref id="cit0021">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>L</given-names></string-name>, <string-name><surname>Dong</surname><given-names>J</given-names></string-name>, <string-name><surname>Yan</surname><given-names>L</given-names></string-name>, <string-name><surname>Yong</surname><given-names>J</given-names></string-name>, <string-name><surname>Liu</surname><given-names>X</given-names></string-name>, <string-name><surname>Hu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Fan</surname><given-names>X</given-names></string-name>, <string-name><surname>Wu</surname><given-names>X</given-names></string-name>, <string-name><surname>Guo</surname><given-names>H</given-names></string-name>, <string-name><surname>Wang</surname><given-names>X</given-names></string-name>, et al</person-group>. <article-title>Single-Cell RNA-Seq analysis maps development of human germline cells and gonadal niche interactions</article-title>. <source>Cell Stem Cell</source>. <year>2017</year>;<volume>20</volume>(<issue>6</issue>):<fpage>858</fpage>–<lpage>873.e4</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.stem.2017.03.007</pub-id>.<pub-id pub-id-type="pmid">28457750</pub-id></mixed-citation>
    </ref>
    <ref id="cit0022">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wilkerson</surname><given-names>MD</given-names></string-name>, <string-name><surname>Hayes</surname><given-names>DN</given-names></string-name></person-group>. <article-title>ConsensusClusterPlus: a class discovery tool with confidence assessments and item tracking</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>12</issue>):<fpage>1572</fpage>–<lpage>1573</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btq170</pub-id>.<pub-id pub-id-type="pmid">20427518</pub-id></mixed-citation>
    </ref>
    <ref id="cit0023">
      <label>23.</label>
      <mixed-citation publication-type="journal"><article-title>Rare neuroepithelial stem cells may underlie small-cell lung cancer</article-title>. <source>Cancer Discov</source>. <year>2019</year>;<volume>9</volume>(<issue>12</issue>):<fpage>1641</fpage>. doi:<pub-id pub-id-type="doi">10.1158/2159-8290.CD-RW2019-154</pub-id></mixed-citation>
    </ref>
    <ref id="cit0024">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karvonen</surname><given-names>HM</given-names></string-name>, <string-name><surname>Lehtonen</surname><given-names>ST</given-names></string-name>, <string-name><surname>Sormunen</surname><given-names>RT</given-names></string-name>, <string-name><surname>Lappi-Blanco</surname><given-names>E</given-names></string-name>, <string-name><surname>Sköld</surname><given-names>CM</given-names></string-name>, <string-name><surname>Kaarteenaho</surname><given-names>RL</given-names></string-name></person-group>. <article-title>Lung cancer-associated myofibroblasts reveal distinctive ultrastructure and function</article-title>. <source>J Thorac Oncol</source>. <year>2014</year>;<volume>9</volume>(<issue>5</issue>):<fpage>664</fpage>–<lpage>674</lpage>. doi:<pub-id pub-id-type="doi">10.1097/JTO.0000000000000149</pub-id>.<pub-id pub-id-type="pmid">24662457</pub-id></mixed-citation>
    </ref>
    <ref id="cit0025">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hynds</surname><given-names>RE</given-names></string-name>, <string-name><surname>Janes</surname><given-names>SM</given-names></string-name></person-group>. <article-title>Airway Basal Cell Heterogeneity and Lung Squamous Cell Carcinoma</article-title>. <source>Cancer Prev Res</source>. <year>2017</year>;<volume>10</volume>(<issue>9</issue>):<fpage>491</fpage>–<lpage>493</lpage>. doi:<pub-id pub-id-type="doi">10.1158/1940-6207.CAPR-17-0202</pub-id>.</mixed-citation>
    </ref>
    <ref id="cit0026">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Cheng</surname><given-names>B</given-names></string-name>, <string-name><surname>Shao</surname><given-names>N</given-names></string-name>, <string-name><surname>Jia</surname><given-names>Y</given-names></string-name>, <string-name><surname>Song</surname><given-names>Q</given-names></string-name>, <string-name><surname>Tan</surname><given-names>B</given-names></string-name>, <string-name><surname>Wang</surname><given-names>J</given-names></string-name></person-group>. <article-title>Prognostic value of immune-related genes in the tumor microenvironment of lung adenocarcinoma and lung squamous cell carcinoma</article-title>. <source>Aging</source>. <year>2020</year>;<volume>12</volume>(<issue>6</issue>):<fpage>4757</fpage>–<lpage>4777</lpage>. doi:<pub-id pub-id-type="doi">10.18632/aging.102871</pub-id>.<pub-id pub-id-type="pmid">32209727</pub-id></mixed-citation>
    </ref>
    <ref id="cit0027">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>K</given-names></string-name>, <string-name><surname>Wang</surname><given-names>C</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>L</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>L</given-names></string-name>, <string-name><surname>Yang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Luo</surname><given-names>W</given-names></string-name>, <string-name><surname>Qiao</surname><given-names>W</given-names></string-name>, <string-name><surname>Wang</surname><given-names>G</given-names></string-name></person-group>. <article-title>Deciphering cell lineage specification of human lung adenocarcinoma with single-cell RNA sequencing</article-title>. <source>Nat Commun</source>. <year>2021</year>;<volume>12</volume>(<issue>1</issue>):<fpage>6500</fpage>. doi:<pub-id pub-id-type="doi">10.1038/s41467-021-26770-2</pub-id>.<pub-id pub-id-type="pmid">34764257</pub-id></mixed-citation>
    </ref>
    <ref id="cit0028">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Khadirnaikar</surname><given-names>S</given-names></string-name>, <string-name><surname>Chatterjee</surname><given-names>A</given-names></string-name>, <string-name><surname>Shukla</surname><given-names>SK</given-names></string-name></person-group>. <article-title>Genetic and epigenetic landscape of leukocyte infiltration identifies an immune prognosticator in lung adenocarcinoma</article-title>. <source>Cancer Biomark</source>. <year>2021</year>;<volume>32</volume>(<issue>4</issue>):<fpage>505</fpage>–<lpage>517</lpage>. doi:<pub-id pub-id-type="doi">10.3233/CBM-203071</pub-id>.<pub-id pub-id-type="pmid">34275893</pub-id></mixed-citation>
    </ref>
    <ref id="cit0029">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yao</surname><given-names>E</given-names></string-name>, <string-name><surname>Lin</surname><given-names>C</given-names></string-name>, <string-name><surname>Wu</surname><given-names>Q</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>K</given-names></string-name>, <string-name><surname>Song</surname><given-names>H</given-names></string-name>, <string-name><surname>Chuang</surname><given-names>P-T</given-names></string-name></person-group>. <article-title>Notch Signaling Controls Transdifferentiation of Pulmonary Neuroendocrine Cells in Response to Lung Injury</article-title>. <source>Stem Cells</source>. <year>2018</year>;<volume>36</volume>(<issue>3</issue>):<fpage>377</fpage>–<lpage>391</lpage>. doi:<pub-id pub-id-type="doi">10.1002/stem.2744</pub-id>.<pub-id pub-id-type="pmid">29148109</pub-id></mixed-citation>
    </ref>
    <ref id="cit0030">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Isaeva</surname><given-names>OI</given-names></string-name>, <string-name><surname>Sharonov</surname><given-names>GV</given-names></string-name>, <string-name><surname>Serebrovskaya</surname><given-names>EO</given-names></string-name>, <string-name><surname>Turchaninova</surname><given-names>MA</given-names></string-name>, <string-name><surname>Zaretsky</surname><given-names>AR</given-names></string-name>, <string-name><surname>Shugay</surname><given-names>M</given-names></string-name>, <string-name><surname>Chudakov</surname><given-names>DM</given-names></string-name></person-group>. <article-title>Intratumoral immunoglobulin isotypes predict survival in lung adenocarcinoma subtypes</article-title>. <source>J Immunother Cancer</source>. <year>2019</year>;<volume>7</volume>(<issue>1</issue>):<fpage>279</fpage>. doi:<pub-id pub-id-type="doi">10.1186/s40425-019-0747-1</pub-id>.<pub-id pub-id-type="pmid">31665076</pub-id></mixed-citation>
    </ref>
    <ref id="cit0031">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Park</surname><given-names>WY</given-names></string-name>, <string-name><surname>Kim</surname><given-names>MH</given-names></string-name>, <string-name><surname>Shin</surname><given-names>DH</given-names></string-name>, <string-name><surname>Lee</surname><given-names>JH</given-names></string-name>, <string-name><surname>Choi</surname><given-names>KU</given-names></string-name>, <string-name><surname>Kim</surname><given-names>JY</given-names></string-name>, <string-name><surname>Park</surname><given-names>DY</given-names></string-name>, <string-name><surname>Lee</surname><given-names>CH</given-names></string-name>, <string-name><surname>Sol</surname><given-names>MY</given-names></string-name></person-group>. <article-title>Ciliated adenocarcinomas of the lung: a tumor of non-terminal respiratory unit origin</article-title>. <source>Mod Pathol</source>. <year>2012</year>;<volume>25</volume>(<issue>9</issue>):<fpage>1265</fpage>–<lpage>1274</lpage>. doi:<pub-id pub-id-type="doi">10.1038/modpathol.2012.76</pub-id>.<pub-id pub-id-type="pmid">22555174</pub-id></mixed-citation>
    </ref>
    <ref id="cit0032">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Courtois</surname><given-names>ET</given-names></string-name>, <string-name><surname>Sengupta</surname><given-names>D</given-names></string-name>, <string-name><surname>Tan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname><given-names>KH</given-names></string-name>, <string-name><surname>Goh</surname><given-names>JJL</given-names></string-name>, <string-name><surname>Kong</surname><given-names>SL</given-names></string-name>, <string-name><surname>Chua</surname><given-names>C</given-names></string-name>, <string-name><surname>Hon</surname><given-names>LK</given-names></string-name>, <string-name><surname>Tan</surname><given-names>WS</given-names></string-name></person-group>. <article-title>Reference component analysis of single-cell transcriptomes elucidates cellular heterogeneity in human colorectal tumors</article-title>. <source>Nat Genet</source>. <year>2017</year>;<volume>49</volume>(<issue>5</issue>):<fpage>708</fpage>–<lpage>718</lpage>. doi:<pub-id pub-id-type="doi">10.1038/ng.3818</pub-id>.<pub-id pub-id-type="pmid">28319088</pub-id></mixed-citation>
    </ref>
    <ref id="cit0033">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chung</surname><given-names>W</given-names></string-name>, <string-name><surname>Eum</surname><given-names>HH</given-names></string-name>, <string-name><surname>Lee</surname><given-names>H-O</given-names></string-name>, <string-name><surname>Lee</surname><given-names>K-M</given-names></string-name>, <string-name><surname>Lee</surname><given-names>H-B</given-names></string-name>, <string-name><surname>Kim</surname><given-names>K-T</given-names></string-name>, <string-name><surname>Ryu</surname><given-names>HS</given-names></string-name>, <string-name><surname>Kim</surname><given-names>S</given-names></string-name>, <string-name><surname>Lee</surname><given-names>JE</given-names></string-name>, <string-name><surname>Park</surname><given-names>YH</given-names></string-name>, et al</person-group>. <article-title>Single-cell RNA-seq enables comprehensive tumour and immune cell profiling in primary breast cancer</article-title>. <source>Nat Commun</source>. <year>2017</year>;<volume>8</volume>(<issue>1</issue>):<fpage>15081</fpage>. doi:<pub-id pub-id-type="doi">10.1038/ncomms15081</pub-id>.<pub-id pub-id-type="pmid">28474673</pub-id></mixed-citation>
    </ref>
    <ref id="cit0034">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tirosh</surname><given-names>I</given-names></string-name>, <string-name><surname>Izar</surname><given-names>B</given-names></string-name>, <string-name><surname>Prakadan</surname><given-names>SM</given-names></string-name>, <string-name><surname>Wadsworth</surname><given-names>MH</given-names></string-name>, <string-name><surname>Treacy</surname><given-names>D</given-names></string-name>, <string-name><surname>Trombetta</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Rotem</surname><given-names>A</given-names></string-name>, <string-name><surname>Rodman</surname><given-names>C</given-names></string-name>, <string-name><surname>Lian</surname><given-names>C</given-names></string-name>, <string-name><surname>Murphy</surname><given-names>G</given-names></string-name>, et al</person-group>. <article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title>. <source>Science</source>. <year>2016</year>;<volume>352</volume>(<issue>6282</issue>):<fpage>189</fpage>–<lpage>196</lpage>. doi:<pub-id pub-id-type="doi">10.1126/science.aad0501</pub-id>.<pub-id pub-id-type="pmid">27124452</pub-id></mixed-citation>
    </ref>
    <ref id="cit0035">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hugo</surname><given-names>W</given-names></string-name>, <string-name><surname>Zaretsky</surname><given-names>JM</given-names></string-name>, <string-name><surname>Sun</surname><given-names>L</given-names></string-name>, <string-name><surname>Song</surname><given-names>C</given-names></string-name>, <string-name><surname>Moreno</surname><given-names>BH</given-names></string-name>, <string-name><surname>Hu-Lieskovan</surname><given-names>S</given-names></string-name>, <string-name><surname>Berent-Maoz</surname><given-names>B</given-names></string-name>, <string-name><surname>Pang</surname><given-names>J</given-names></string-name>, <string-name><surname>Chmielowski</surname><given-names>B</given-names></string-name>, <string-name><surname>Cherry</surname><given-names>G</given-names></string-name>, et al</person-group>. <article-title>Genomic and Transcriptomic Features of Response to Anti-PD-1 Therapy in Metastatic Melanoma</article-title>. <source>Cell</source>. <year>2016</year>;<volume>165</volume>(<issue>1</issue>):<fpage>35</fpage>–<lpage>44</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.cell.2016.02.065</pub-id>.<pub-id pub-id-type="pmid">26997480</pub-id></mixed-citation>
    </ref>
    <ref id="cit0036">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>X</given-names></string-name>, <string-name><surname>Lan</surname><given-names>Y</given-names></string-name>, <string-name><surname>Xu</surname><given-names>J</given-names></string-name>, <string-name><surname>Quan</surname><given-names>F</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>E</given-names></string-name>, <string-name><surname>Deng</surname><given-names>C</given-names></string-name>, <string-name><surname>Luo</surname><given-names>T</given-names></string-name>, <string-name><surname>Xu</surname><given-names>L</given-names></string-name>, <string-name><surname>Liao</surname><given-names>G</given-names></string-name>, <string-name><surname>Yan</surname><given-names>M</given-names></string-name>, et al</person-group>. <article-title>CellMarker: a manually curated resource of cell markers in human and mouse</article-title>. <source>Nucleic Acids Res</source>. <year>2018</year>;<volume>47</volume>(<issue>D1</issue>):<fpage>D721</fpage>–<lpage>D728</lpage>. doi:<pub-id pub-id-type="doi">10.1093/nar/gky900</pub-id>.</mixed-citation>
    </ref>
    <ref id="cit0037">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Colaprico</surname><given-names>A</given-names></string-name>, <string-name><surname>Silva</surname><given-names>TC</given-names></string-name>, <string-name><surname>Olsen</surname><given-names>C</given-names></string-name>, <string-name><surname>Garofano</surname><given-names>L</given-names></string-name>, <string-name><surname>Cava</surname><given-names>C</given-names></string-name>, <string-name><surname>Garolini</surname><given-names>D</given-names></string-name>, <string-name><surname>Sabedot</surname><given-names>TS</given-names></string-name>, <string-name><surname>Malta</surname><given-names>TM</given-names></string-name>, <string-name><surname>Pagnotta</surname><given-names>SM</given-names></string-name>, <string-name><surname>Castiglioni</surname><given-names>I</given-names></string-name>, et al</person-group>. <article-title>TCGAbiolinks: an R/Bioconductor package for integrative analysis of TCGA data</article-title>. <source>Nucleic Acids Res</source>. <year>2016</year>;<volume>44</volume>(<issue>8</issue>):<fpage>e71</fpage>. doi:<pub-id pub-id-type="doi">10.1093/nar/gkv1507</pub-id>.<pub-id pub-id-type="pmid">26704973</pub-id></mixed-citation>
    </ref>
    <ref id="cit0038">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sturm</surname><given-names>G</given-names></string-name>, <string-name><surname>Finotello</surname><given-names>F</given-names></string-name>, <string-name><surname>Petitprez</surname><given-names>F</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>JD</given-names></string-name>, <string-name><surname>Baumbach</surname><given-names>J</given-names></string-name>, <string-name><surname>Fridman</surname><given-names>WH</given-names></string-name>, <string-name><surname>List</surname><given-names>M</given-names></string-name>, <string-name><surname>Aneichyk</surname><given-names>T</given-names></string-name></person-group>. <article-title>Comprehensive evaluation of transcriptome-based cell-type quantification methods for immuno-oncology</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>(<issue>14</issue>):<fpage>i436</fpage>–<lpage>i445</lpage>. doi:<pub-id pub-id-type="doi">10.1093/bioinformatics/btz363</pub-id>.<pub-id pub-id-type="pmid">31510660</pub-id></mixed-citation>
    </ref>
    <ref id="cit0039">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bader</surname><given-names>GD</given-names></string-name>, <string-name><surname>Hogue</surname><given-names>CW</given-names></string-name></person-group>. <article-title>An automated method for finding molecular complexes in large protein interaction networks</article-title>. <source>BMC Bioinform</source>. <year>2003</year>;<volume>4</volume>(<issue>1</issue>):<fpage>2</fpage>. doi:<pub-id pub-id-type="doi">10.1186/1471-2105-4-2</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
