<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10265787</article-id>
    <article-id pub-id-type="pmid">37312038</article-id>
    <article-id pub-id-type="publisher-id">5367</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05367-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RegCloser: a robust regression approach to closing genome gaps</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Cao</surname>
          <given-names>Shenghao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Li</surname>
          <given-names>Mengtian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Li</surname>
          <given-names>Lei M.</given-names>
        </name>
        <address>
          <email>lilei@amss.ac.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.9227.e</institution-id><institution-id institution-id-type="ISNI">0000000119573309</institution-id><institution>National Center of Mathematics and Interdisciplinary Sciences, Academy of Mathematics and Systems Science, </institution><institution>Chinese Academy of Sciences, </institution></institution-wrap>Beijing, 100190 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.410726.6</institution-id><institution-id institution-id-type="ISNI">0000 0004 1797 8419</institution-id><institution>University of Chinese Academy of Sciences, </institution></institution-wrap>Beijing, 100049 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>249</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Closing gaps in draft genomes leads to more complete and continuous genome assemblies. The ubiquitous genomic repeats are challenges to the existing gap-closing methods, based on either the k-mer representation by the de Bruijn graph or the overlap-layout-consensus paradigm. Besides, chimeric reads will cause erroneous k-mers in the former and false overlaps of reads in the latter.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We propose a novel local assembly approach to gap closing, called RegCloser. It represents read coordinates and their overlaps respectively by parameters and observations in a linear regression model. The optimal overlap is searched only in the restricted range consistent with insert sizes. Under this linear regression framework, the local DNA assembly becomes a robust parameter estimation problem. We solved the problem by a customized robust regression procedure that resists the influence of false overlaps by optimizing a convex global Huber loss function. The global optimum is obtained by iteratively solving the sparse system of linear equations. On both simulated and real datasets, RegCloser outperformed other popular methods in accurately resolving the copy number of tandem repeats, and achieved superior completeness and contiguity. Applying RegCloser to a plateau zokor draft genome that had been improved by long reads further increased contig N50 to 3-fold long. We also tested the robust regression approach on layout generation of long reads.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">RegCloser is a competitive gap-closing tool. The software is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/csh3/RegCloser">https://github.com/csh3/RegCloser</ext-link>. The robust regression approach has a prospect to be incorporated into the layout module of long read assemblers.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05367-0.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Genome assembly</kwd>
      <kwd>Closing gaps</kwd>
      <kwd>Robust regression</kwd>
      <kwd>Tandem repeat</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Key Research and Development Program of China</institution>
        </funding-source>
        <award-id>2022YFA1004801</award-id>
        <award-id>2022YFA1004801</award-id>
        <award-id>2022YFA1004801</award-id>
        <principal-award-recipient>
          <name>
            <surname>Cao</surname>
            <given-names>Shenghao</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Mengtian</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Lei M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Natural Science Foundation of China</institution>
        </funding-source>
        <award-id>11871462</award-id>
        <award-id>11871462</award-id>
        <award-id>11871462</award-id>
        <principal-award-recipient>
          <name>
            <surname>Cao</surname>
            <given-names>Shenghao</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Mengtian</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Lei M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Strategic Priority Research Program of the Chinese Academy of Sciences</institution>
        </funding-source>
        <award-id>XDB13040600</award-id>
        <award-id>XDB13040600</award-id>
        <award-id>XDB13040600</award-id>
        <principal-award-recipient>
          <name>
            <surname>Cao</surname>
            <given-names>Shenghao</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Mengtian</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Lei M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100019795</institution-id>
            <institution>National Center for Mathematics and Interdisciplinary Sciences, Chinese Academy of Sciences</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Key Laboratory of Systems and Control, Chinese Academy of Sciences</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Closing gaps in draft genomes, as an important step in the de novo assembly pipeline, remains a challenge due to the ubiquitous repetitive elements in genomes. Repetitive elements, as well as chimeric reads, cause ambiguities such as false alignments that disrupt the local assembly in gaps. Particularly, it is very difficult to resolve the copy number of a tandem repeat whenever it occurs [<xref ref-type="bibr" rid="CR1">1</xref>]. Third Generation Sequencing (TGS) technology is expected to resolve the repeat problem if its long reads can span the repeat regions. Nevertheless, many genomes have been or are still sequenced, partially or fully, by Second Generation Sequencing (SGS) technology [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR5">5</xref>], due to its high accuracy, low cost, and wide availability. It is desirable to reconstruct, at least some, regions of repetitive elements by the SGS reads. Notably, the insert size of paired-end or mate-pair reads carries genomic information that can be utilized to facilitate assembly.</p>
    <p id="Par5">Most existing gap-closing methods including Sealer [<xref ref-type="bibr" rid="CR6">6</xref>], GapCloser [<xref ref-type="bibr" rid="CR7">7</xref>], and GapFiller [<xref ref-type="bibr" rid="CR8">8</xref>] are based on the de Bruijn graph (DBG) approach. Although DBG-based methods are computationally efficient, they cut reads into k-mers so that some genomic information in raw reads are lost. In contrast, the overlap-layout-consensus (OLC) approach such as Phrap [<xref ref-type="bibr" rid="CR9">9</xref>] directly aligns the original reads to detect overlaps. But finding a Hamiltonian cycle in the overlap graph is generally NP-complete [<xref ref-type="bibr" rid="CR10">10</xref>], and heuristic algorithms are error-prone to false overlaps caused by either repeats or chimeric reads.</p>
    <p id="Par6">In this paper, we propose a new local assembly approach, referred to as RegCloser, to closing gaps. When it searches overlaps between reads from a gap region, insert-size information is utilized to guide the pairwise alignment to reduce the ambiguities caused by repeats as well as the time complexities. Then, RegCloser adopts a linear regression model to represent the detected overlaps. The motivation is to assign a coordinate axis to the DNA sequence due to its natural linear structure. Thus, read positions on the genome are represented as coordinates to be estimated and overlaps are represented as observations on the read coordinates’ differences.</p>
    <p id="Par7">Under the linear regression framework, the local DNA assembly is formalized as a parameter estimation problem. The estimation can be solved by well-established robust statistical methods [<xref ref-type="bibr" rid="CR11">11</xref>]. In RegCloser, we customize a two-step robust regression procedure. In Step 1, it finds the read locations and detects false overlaps simultaneously by computing a robust M-estimate, which minimizes the Huber loss function. The loss function is convex so that its global optimum can be achieved by an iterative algorithm. Each iteration is to solve a sparse system of linear equations. In the M-estimation, the influence function of any outlier is bounded. In Step 2, RegCloser eliminates the influences of the false overlaps by a trimmed least squares estimate.</p>
    <p id="Par8">We will illustrate how RegCloser resolves tandem repeats by a real data example. Tests on simulated and real sequence data show that RegCloser outperforms several other popular gap-closing methods, especially in the presence of tandem repeats. Its applicability to TGS data is shown as well.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Overview of RegCloser</title>
      <p id="Par9">The scheme of RegCloser is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. RegCloser starts off by mapping input reads, SGS paired-end or mate-pair reads, onto the draft genome. Then, it collects reads from each gap region (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a), and performs local assembly to close gaps (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b–e). RegCloser tackles the problem of false overlaps resulted from repeats or chimeric reads by two key ideas. First, in the context of gap closing, each read from the gap region has a prior genomic position inferred from the insert size. Rather than an all-against-all pairwise alignment, RegCloser utilizes the prior positions to guide pairwise alignment (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b) for overlap detection. In this way, false overlaps in the collecting step are substantially reduced. Second, RegCloser adopts a robust regression approach to estimate the reads’ genomic positions, which can detect the remaining false overlaps and eliminate their influences (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c, d). Then, the reads are placed at their estimated positions in the gap, resulting in a multiple sequence alignment on which the consensus sequence in the gap is determined (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e).<fig id="Fig1"><label>Fig. 1</label><caption><p>Pipeline of RegCloser. <bold>a</bold> Align the input paired-end or mate-pair reads onto the draft genome, and collect the reads falling in the gap regions. <bold>b</bold> An illustrative example of insert-size guided pairwise alignment for overlap detection in a gap containing a triple tandem repeat ‘GAACCCT’. First, on the axis corresponding to the DNA sequence in the gap, the collected reads are placed at their prior positions, which are inferred from their mate position and the insert size. The prior positions of reads ④ and ⑤ are 11 and 16. Notably, two pseudo reads, ① and ⑨, generated from the contig ends flanking the gap are added. Then, a pair of reads are aligned only when their prior positions are close, taking into account the variation of insert sizes. If an alignment is statistically significant, it is marked by yellow parallel lines between bases as well as by double-headed arrows between reads. The tandem repeat causes a false overlap between reads ④ and ⑥, as indicated by the red double-headed arrow, resulting in an outlier in the latter regression model. The repeat also leads to two different significant alignments between reads ④ and ⑤, respectively marked by the yellow solid and dotted lines. In this case, RegCloser will select the alignment more compatible with the prior positions (solid line), rather than the highest-scoring one (dotted line). <bold>c</bold> The linear regression model of genome assembly. The reads’ real positions on the gap axis are represented as parameters <inline-formula id="IEq106"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}\ (1\le i\le n)$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="4pt"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq106.gif"/></alternatives></inline-formula> to be estimated. Each detected overlap between reads <inline-formula id="IEq107"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M4"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq107.gif"/></alternatives></inline-formula> and <inline-formula id="IEq108"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M6"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq108.gif"/></alternatives></inline-formula> provides an observation on the difference between <inline-formula id="IEq109"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq109.gif"/></alternatives></inline-formula> and <inline-formula id="IEq110"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{j}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq110.gif"/></alternatives></inline-formula>: <inline-formula id="IEq111"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}^{(i,j)}={\beta }_{j}-{\beta }_{i}+{\varepsilon }^{(i,j)}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq111.gif"/></alternatives></inline-formula>. <inline-formula id="IEq112"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varepsilon }^{(i,j)}$$\end{document}</tex-math><mml:math id="M14"><mml:msup><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq112.gif"/></alternatives></inline-formula> is the observational error, which is normally caused by sequencing errors on the DNA fragment between <inline-formula id="IEq113"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq113.gif"/></alternatives></inline-formula> and <inline-formula id="IEq114"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{j}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq114.gif"/></alternatives></inline-formula>. False overlaps cause outliers, which have abnormally large <inline-formula id="IEq115"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{\varepsilon }^{\left(i,j\right)}|$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq115.gif"/></alternatives></inline-formula>. All the observations in a gap are integrated into the matrix form <inline-formula id="IEq116"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Y}}={\varvec{X}}{\varvec{\beta}}+{\varvec{\varepsilon}}$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq116.gif"/></alternatives></inline-formula>. <bold>d</bold> A two-step robust regression estimation of the model parameters. <inline-formula id="IEq117"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rho }_{H}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq117.gif"/></alternatives></inline-formula> is the Huber loss function. <inline-formula id="IEq118"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{o}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>I</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq118.gif"/></alternatives></inline-formula> is the index set of observations with large residuals and identified as potential outliers. <bold>e</bold> Generate multiple sequence alignment of the collected reads by their estimated positions, and determine the gap sequence as the consensus between the two pseudo reads ① and ⑨. As a result, the triple tandem repeat is recovered by RegCloser</p></caption><graphic xlink:href="12859_2023_5367_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Preprocessing</title>
      <p id="Par10">In the preprocessing stage, RegCloser first maps paired sequencing reads onto the draft genome using BWA [<xref ref-type="bibr" rid="CR12">12</xref>]. Then, the mapped positions of the paired reads on adjacent contigs are used to estimate gap sizes. Next, RegCloser collects reads that are inferred to originate from the gap regions (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a), and estimates their prior positions in the gap by the insert size. Specifically, let <inline-formula id="IEq1"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu$$\end{document}</tex-math><mml:math id="M28"><mml:mi>μ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v$$\end{document}</tex-math><mml:math id="M30"><mml:mi>v</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq2.gif"/></alternatives></inline-formula> be respectively the mean and standard deviation of the library insert size. For a read pair, if the left (respectively right) read is uniquely mapped within <inline-formula id="IEq3"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu +3v$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>v</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq3.gif"/></alternatives></inline-formula> bases from the left (respectively right) breakpoint of a gap, the mate read is inferred to come from the gap region with high confidence and is thus collected. In what follows, RegCloser assembles the collected reads from each gap in parallel.</p>
    </sec>
    <sec id="Sec5">
      <title>Overlap detection by insert-size guided pairwise alignment</title>
      <p id="Par11">We first set a coordinate axis along the gap from left to right, and the left breakpoint of the gap is defined as the origin (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, c). Then we represent the genomic position of read <inline-formula id="IEq4"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{i}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq4.gif"/></alternatives></inline-formula> (<inline-formula id="IEq5"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le i\le n$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq5.gif"/></alternatives></inline-formula>) by the coordinate of its ending base, denoted by <inline-formula id="IEq6"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq6.gif"/></alternatives></inline-formula>. Although the true value of <inline-formula id="IEq7"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq7.gif"/></alternatives></inline-formula> is an unknown parameter, its prior genomic position, denoted by <inline-formula id="IEq8"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{i}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq8.gif"/></alternatives></inline-formula>, can be inferred from the insert size and the mapping position of the mate read on the flanking contig (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). The prior genomic positions guide the pairwise alignment to obtain more accurate and efficient overlap detection (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b) in two aspects:</p>
      <p id="Par12">(i) RegCloser aligns two reads <inline-formula id="IEq9"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{i}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq9.gif"/></alternatives></inline-formula> and <inline-formula id="IEq10"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{j}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq10.gif"/></alternatives></inline-formula> only if their prior genomic positions are close to each other, i.e., <inline-formula id="IEq11"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{p}_{i}-{p}_{j}|&lt;\Delta d$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq11.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq12"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta d$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq12.gif"/></alternatives></inline-formula> is a threshold depending on the standard deviation of the insert size (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S1). By choosing an appropriate <inline-formula id="IEq13"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta d$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq13.gif"/></alternatives></inline-formula>, we not only avoid false overlaps between reads that come from distant regions on the genome, but also reduce the time complexity of pairwise alignments from quadratic to linear (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S2). In the illustrative example shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, where reads ①–⑨ are placed along the gap axis at their prior genomic positions, we set <inline-formula id="IEq14"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta d=11$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq14.gif"/></alternatives></inline-formula>. That is, two reads are aligned only if their prior genomic positions are within a distance of 11 bp. Consequently, the false overlap “AACCC” between reads ② and ⑦ is avoided, and the total number of pairwise alignments is reduced to 14 from 36, which is required by the all-against-all strategy.</p>
      <p id="Par13">(ii) Two overlapping reads may have more than one significant alignment, particularly when they come from tandem repeats. RegCloser implements an extended Smith &amp; Waterman algorithm [<xref ref-type="bibr" rid="CR13">13</xref>] to find all the significant overlap patterns between two reads, and selects the one most compatible with the reads’ prior genomic positions. In the example shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, the two reads ④ and ⑤ actually come from a triple tandem repeat and can be aligned in two ways. RegCloser selects the correct alignment indicated by the solid line, which is closer to the relative position of <inline-formula id="IEq15"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{4}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>p</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{5}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>p</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq16.gif"/></alternatives></inline-formula>, rather than the dotted one, even though it has a higher alignment score.</p>
      <p id="Par14">A real example in “Section <xref rid="Sec12" ref-type="sec">RegCloser’s rationale of resolving the tandem repeat</xref>” will show that the above insert-size guided pairwise alignment indeed greatly reduces false overlaps.</p>
    </sec>
    <sec id="Sec6">
      <title>Representation of detected overlaps by linear regression model</title>
      <p id="Par15">In the coordinate axis along the gap, we aim to solve the true values of the reads’ genomic positions, <inline-formula id="IEq17"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq17.gif"/></alternatives></inline-formula> (<inline-formula id="IEq18"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le i\le n$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq18.gif"/></alternatives></inline-formula>), to form a layout. If a pair of reads <inline-formula id="IEq19"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{i}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq19.gif"/></alternatives></inline-formula> and <inline-formula id="IEq20"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{j}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq20.gif"/></alternatives></inline-formula> overlap, the alignment provides an observation on the difference of <inline-formula id="IEq21"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq21.gif"/></alternatives></inline-formula> and <inline-formula id="IEq22"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{j}$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq22.gif"/></alternatives></inline-formula>. Denote the observed genomic distance from <inline-formula id="IEq23"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{i}$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq23.gif"/></alternatives></inline-formula> to <inline-formula id="IEq24"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{j}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq24.gif"/></alternatives></inline-formula> as <inline-formula id="IEq25"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}^{\left(i,j\right)}$$\end{document}</tex-math><mml:math id="M76"><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq25.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c), then<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y^{{\left( {i,j} \right)}} = \beta_{j} - \beta_{i} + \varepsilon^{{\left( {i,j} \right)}} ,$$\end{document}</tex-math><mml:math id="M78" display="block"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>ε</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq26"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varepsilon }^{(i,j)}$$\end{document}</tex-math><mml:math id="M80"><mml:msup><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq26.gif"/></alternatives></inline-formula> denotes the observational error. In normal cases, <inline-formula id="IEq27"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{\varepsilon }^{\left(i,j\right)}\}$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq27.gif"/></alternatives></inline-formula> are the random errors caused by sequencing, and are mostly zeros for Illumina short reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S3). In the case of a false overlap, <inline-formula id="IEq28"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{\varepsilon }^{\left(i,j\right)}|$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq28.gif"/></alternatives></inline-formula> will be abnormally large, and the observation will be regarded as an outlier (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). For example, reads ④ and ⑥ in Fig. <xref rid="Fig1" ref-type="fig">1</xref>e come from different repeat units, so a false overlap is detected between them, causing an outlier marked by the red double-headed arrow in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b.</p>
      <p id="Par16">Supposing totally <inline-formula id="IEq29"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M86"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq29.gif"/></alternatives></inline-formula> overlaps are detected in the gap, we integrate them into one linear regression model in the matrix form as below,<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Y}} = \user2{X\beta } + {\varvec{\varepsilon}} = \left( {\begin{array}{*{20}c} {\begin{array}{*{20}c} {{\varvec{x}}_{1}^{T} } \\ {{\varvec{x}}_{2}^{T} } \\ \end{array} } \\ {\begin{array}{*{20}c} \vdots \\ {{\varvec{x}}_{{\varvec{m}}}^{T} } \\ \end{array} } \\ \end{array} } \right){\varvec{\beta}} + {\varvec{\varepsilon}},$$\end{document}</tex-math><mml:math id="M88" display="block"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq30"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta}}={({\beta }_{1}, {\beta }_{2}, \cdots , {\beta }_{n})}^{T}$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq30.gif"/></alternatives></inline-formula> denotes the vector of reads’ genomic positions; <inline-formula id="IEq31"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}={({{\varvec{x}}}_{1}, {{\varvec{x}}}_{2}, \cdots , {{\varvec{x}}}_{{\varvec{m}}})}^{T}\in {\mathbb{R}}^{m\times n}$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq31.gif"/></alternatives></inline-formula> denotes the design matrix, which is sparse as illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>c; each row of <inline-formula id="IEq32"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq32.gif"/></alternatives></inline-formula> has only two non-zero elements, − 1 and 1, which are signed indicators of two overlapping reads. The corresponding term in <inline-formula id="IEq33"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Y}}$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq33.gif"/></alternatives></inline-formula> represents their genomic distance’s observation obtained from a detected overlap as in (<xref rid="Equ1" ref-type="disp-formula">1</xref>); <inline-formula id="IEq34"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Y}}={({y}_{1}, {y}_{2}, \cdots , {y}_{m})}^{T}$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq34.gif"/></alternatives></inline-formula> denotes the vector of all the observed genomic distances. Our aim is to estimate the reads’ genomic positions <inline-formula id="IEq35"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta}}$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq35.gif"/></alternatives></inline-formula> in the linear regression model.</p>
      <p id="Par17">Note that the design matrix <inline-formula id="IEq36"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq36.gif"/></alternatives></inline-formula> in (<xref rid="Equ2" ref-type="disp-formula">2</xref>) is actually the oriented incidence matrix of the overlap graph, where each read corresponds to a vertex and each overlap creates a directed edge connecting two vertices. The overlap graph may have multiple weakly connected components, each of which corresponds to one contig. Accordingly, we can re-arrange the rows and columns of <inline-formula id="IEq37"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq37.gif"/></alternatives></inline-formula> in (<xref rid="Equ2" ref-type="disp-formula">2</xref>) so that it takes a block-diagonal form as below,<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {\begin{array}{*{20}c} {\begin{array}{*{20}c} {\begin{array}{*{20}c} {\begin{array}{*{20}c} {{\varvec{X}}^{\left[ 1 \right]} } \\ 0 \\ \end{array} } \\ {\begin{array}{*{20}c} \vdots \\ 0 \\ \end{array} } \\ \end{array} } &amp; {\begin{array}{*{20}c} {\begin{array}{*{20}c} 0 \\ {{\varvec{X}}^{\left[ 2 \right]} } \\ \end{array} } \\ {\begin{array}{*{20}c} \vdots \\ 0 \\ \end{array} } \\ \end{array} } \\ \end{array} } &amp; {\begin{array}{*{20}c} {\begin{array}{*{20}c} {\begin{array}{*{20}c} \cdots \\ \cdots \\ \end{array} } \\ {\begin{array}{*{20}c} \ddots \\ \cdots \\ \end{array} } \\ \end{array} } &amp; {\begin{array}{*{20}c} {\begin{array}{*{20}c} 0 \\ 0 \\ \end{array} } \\ {\begin{array}{*{20}c} \vdots \\ {{\varvec{X}}^{{\left[ {\varvec{s}} \right]}} } \\ \end{array} } \\ \end{array} } \\ \end{array} } \\ \end{array} } \right),$$\end{document}</tex-math><mml:math id="M106" display="block"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>1</mml:mn></mml:mfenced></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>2</mml:mn></mml:mfenced></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>⋯</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>⋯</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:mfenced></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where all the blocks except the principal diagonal are zero matrices (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S4). Each diagonal submatrix <inline-formula id="IEq38"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{X}}}^{[{\varvec{i}}]}\in {\mathbb{R}}^{{m}_{i}\times {n}_{i}}$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq38.gif"/></alternatives></inline-formula> (<inline-formula id="IEq39"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le i\le s$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq39.gif"/></alternatives></inline-formula>, <inline-formula id="IEq40"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum_{i=1}^{s}{m}_{i}=m$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq40.gif"/></alternatives></inline-formula>, <inline-formula id="IEq41"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum_{i=1}^{s}{n}_{i}=n$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq41.gif"/></alternatives></inline-formula>) is the oriented incidence matrix of one weakly connected component, and <inline-formula id="IEq42"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{rank}({{\varvec{X}}}^{[{\varvec{i}}]}){=n}_{i}-1$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi mathvariant="normal">rank</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq42.gif"/></alternatives></inline-formula>. Next, we can re-arrange the rows of <inline-formula id="IEq43"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta}}$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq43.gif"/></alternatives></inline-formula>, <inline-formula id="IEq44"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Y}}$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq44.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq45"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\varepsilon}}$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq45.gif"/></alternatives></inline-formula> in (<xref rid="Equ2" ref-type="disp-formula">2</xref>) in accordance with that in <inline-formula id="IEq46"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq46.gif"/></alternatives></inline-formula>. Consequently, model (<xref rid="Equ2" ref-type="disp-formula">2</xref>) is decomposed into <inline-formula id="IEq47"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M126"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq47.gif"/></alternatives></inline-formula> sub-models, i.e.,<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {\begin{array}{*{20}c} {\begin{array}{*{20}c} {{\varvec{Y}}^{\left[ 1 \right]} = {\varvec{X}}^{\left[ 1 \right]} {\varvec{\beta}}^{\left[ 1 \right]} + {\varvec{\varepsilon}}^{\left[ 1 \right]} } \\ {{\varvec{Y}}^{\left[ 2 \right]} = {\varvec{X}}^{\left[ 2 \right]} {\varvec{\beta}}^{\left[ 2 \right]} + {\varvec{\varepsilon}}^{\left[ 2 \right]} } \\ \end{array} } \\ {\begin{array}{*{20}c} \vdots \\ {{\varvec{Y}}^{{\left[ {\varvec{s}} \right]}} = {\varvec{X}}^{{\left[ {\varvec{s}} \right]}} {\varvec{\beta}}^{{\left[ {\varvec{s}} \right]}} + {\varvec{\varepsilon}}^{{\left[ {\varvec{s}} \right]}} } \\ \end{array} } \\ \end{array} } \right.,$$\end{document}</tex-math><mml:math id="M128" display="block"><mml:mrow><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>1</mml:mn></mml:mfenced></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>1</mml:mn></mml:mfenced></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>1</mml:mn></mml:mfenced></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>1</mml:mn></mml:mfenced></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>2</mml:mn></mml:mfenced></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>2</mml:mn></mml:mfenced></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>2</mml:mn></mml:mfenced></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>2</mml:mn></mml:mfenced></mml:msup></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:mfenced></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:mfenced></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:mfenced></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:mfenced></mml:msup></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq48"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\beta}}}^{[{\varvec{i}}]}\in {\mathbb{R}}^{{n}_{i}\times 1}$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq48.gif"/></alternatives></inline-formula>, <inline-formula id="IEq49"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{Y}}}^{[{\varvec{i}}]}\in {\mathbb{R}}^{{m}_{i}\times 1}$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq49.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq50"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\varepsilon}}}^{[{\varvec{i}}]}\in {\mathbb{R}}^{{m}_{i}\times 1}$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq50.gif"/></alternatives></inline-formula>.</p>
      <p id="Par18">Each sub-model <inline-formula id="IEq51"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{Y}}}^{[{\varvec{i}}]}={{\varvec{X}}}^{[{\varvec{i}}]}{{\varvec{\beta}}}^{[{\varvec{i}}]}+{{\varvec{\varepsilon}}}^{[{\varvec{i}}]}$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq51.gif"/></alternatives></inline-formula> in (<xref rid="Equ4" ref-type="disp-formula">4</xref>) represents one weakly connected component, i.e., one contig, and the vector <inline-formula id="IEq52"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\beta}}}^{[{\varvec{i}}]}$$\end{document}</tex-math><mml:math id="M138"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq52.gif"/></alternatives></inline-formula> denotes the genomic positions of the reads in this contig. Since <inline-formula id="IEq53"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{X}}}^{[{\varvec{i}}]}$$\end{document}</tex-math><mml:math id="M140"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq53.gif"/></alternatives></inline-formula> is not full-rank in column, namely, <inline-formula id="IEq54"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{rank}({{\varvec{X}}}^{[{\varvec{i}}]}){=n}_{i}-1&lt;{n}_{i}$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mi mathvariant="normal">rank</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq54.gif"/></alternatives></inline-formula>, we can only estimate the parameters <inline-formula id="IEq55"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\beta}}}^{[{\varvec{i}}]}$$\end{document}</tex-math><mml:math id="M144"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq55.gif"/></alternatives></inline-formula> in the sub-model up to a shift. Although the relative positions of reads are sufficient to determine a layout uniquely, technically we add an initial position of one read to each sub-model to make <inline-formula id="IEq56"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{X}}}^{[{\varvec{i}}]}$$\end{document}</tex-math><mml:math id="M146"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq56.gif"/></alternatives></inline-formula> full-rank in column so that <inline-formula id="IEq57"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\beta}}}^{[{\varvec{i}}]}$$\end{document}</tex-math><mml:math id="M148"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq57.gif"/></alternatives></inline-formula> is identifiable (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S4).</p>
      <p id="Par19">Estimating <inline-formula id="IEq58"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta}}$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq58.gif"/></alternatives></inline-formula> in (<xref rid="Equ2" ref-type="disp-formula">2</xref>) is equivalent to respectively estimating <inline-formula id="IEq59"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\beta}}}^{[{\varvec{i}}]}$$\end{document}</tex-math><mml:math id="M152"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq59.gif"/></alternatives></inline-formula>(<inline-formula id="IEq60"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le i\le s$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq60.gif"/></alternatives></inline-formula>) in (<xref rid="Equ4" ref-type="disp-formula">4</xref>). Hence without loss of generality, we suppose the linear model (<xref rid="Equ2" ref-type="disp-formula">2</xref>) represents one contig and the design matrix <inline-formula id="IEq61"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq61.gif"/></alternatives></inline-formula> is full-rank in column hereafter.</p>
      <p id="Par20">It is noted that the presentation (<xref rid="Equ3" ref-type="disp-formula">3</xref>) and (<xref rid="Equ4" ref-type="disp-formula">4</xref>) is for the sake of rigorous mathematical formulation. In practice, as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, the two pseudo reads that are cut from the flanking sequences of a gap were incorporated into overlap detection and the linear model (<xref rid="Equ2" ref-type="disp-formula">2</xref>). Consequently, we only need to consider the typical scenarios shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2. First, if the two pseudo reads are contained in one component, then the gap is filled and other floating contigs are skipped. Second, if the two pseudo reads are in two components that cannot be connected, then each flanking contig is extended by the corresponding regression component. Contigs generated from regression components other than these two major ones could be from the unfilled gap, or from elsewhere due to uncertain factors such as incorrect read mapping. In the current implementation, we leave them out for the sake of reliability.</p>
    </sec>
    <sec id="Sec7">
      <title>Estimation of the reads’ genomic positions by a two-step robust regression procedure</title>
      <p id="Par21">Although the false overlaps are significantly reduced by imposing constraint on pairwise alignment, a fraction of outliers may still exist, and even a single outlier can break down the ordinary least squares (OLS) estimate [<xref ref-type="bibr" rid="CR14">14</xref>]. Thus, RegCloser adopts a two-step robust regression procedure (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d) to estimate the parameters <inline-formula id="IEq62"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta}}$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq62.gif"/></alternatives></inline-formula> in (<xref rid="Equ2" ref-type="disp-formula">2</xref>). Note that we first relax <inline-formula id="IEq63"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta}}$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq63.gif"/></alternatives></inline-formula> from integers to be continuous values.</p>
      <p id="Par22"><bold>Step 1:</bold> RegCloser detects outliers using the robust M-estimate [<xref ref-type="bibr" rid="CR11">11</xref>]. That is, minimize the sum of a loss function over all observations as below,<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\user2{\beta}}^{M} = \arg \mathop {\min }\limits_{{\varvec{\beta}}} \mathop \sum \limits_{i = 1}^{m} \rho \left( {\varepsilon_{i} } \right) = \arg \mathop {\min }\limits_{{\varvec{\beta}}} \mathop \sum \limits_{i = 1}^{m} \rho \left( {y_{i} - {\varvec{x}}_{{\varvec{i}}}^{T} {\varvec{\beta}}} \right).$$\end{document}</tex-math><mml:math id="M162" display="block"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo>arg</mml:mo><mml:munder><mml:mo movablelimits="false">min</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>ε</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mo>arg</mml:mo><mml:munder><mml:mo movablelimits="false">min</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq64"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho (\bullet )$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>∙</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq64.gif"/></alternatives></inline-formula> takes the Huber loss function,<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho_{H} \left( \varepsilon \right) = \left\{ {\begin{array}{*{20}c} {\varepsilon^{2} /2} \\ {c\left| \varepsilon \right| - c^{2} /2} \\ \end{array} } \right.{ }\begin{array}{*{20}c} {\left| \varepsilon \right| \le c} \\ {\left| \varepsilon \right| &gt; c} \\ \end{array} .$$\end{document}</tex-math><mml:math id="M166" display="block"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>ε</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>ε</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mi>c</mml:mi><mml:mfenced close="|" open="|"><mml:mi>ε</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfenced close="|" open="|"><mml:mi>ε</mml:mi></mml:mfenced><mml:mo>≤</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mfenced close="|" open="|"><mml:mi>ε</mml:mi></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par23">It is noted <inline-formula id="IEq65"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rho }_{H}\left(\varepsilon \right)$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>ε</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq65.gif"/></alternatives></inline-formula> equals to the loss of squares when the observational error is small (<inline-formula id="IEq66"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\varepsilon |\le c$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>ε</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>≤</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq66.gif"/></alternatives></inline-formula>). But for large errors, <inline-formula id="IEq67"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rho }_{H}\left(\varepsilon \right)$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>ε</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq67.gif"/></alternatives></inline-formula> takes absolute error loss instead (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a) to avoid being overly influenced by the outliers. The value <inline-formula id="IEq68"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M174"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq68.gif"/></alternatives></inline-formula> in (<xref rid="Equ6" ref-type="disp-formula">6</xref>) is a tuning constant balancing robustness and statistical efficiency. Smaller values of <inline-formula id="IEq69"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M176"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq69.gif"/></alternatives></inline-formula> produce more resistance to outliers, but at the expense of larger variance of the estimate [<xref ref-type="bibr" rid="CR11">11</xref>]. It is set to 2 by default in RegCloser.<fig id="Fig2"><label>Fig. 2</label><caption><p>IRLS algorithm for computing the robust M-estimate. <bold>a</bold> The Huber loss function used in the M-estimation. Since it is convex, any local optimum is global. <bold>b</bold> The Huber <inline-formula id="IEq119"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi$$\end{document}</tex-math><mml:math id="M178"><mml:mi>ψ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq119.gif"/></alternatives></inline-formula>-function, namely, the derivative of the Huber loss function. It shows the influence of any outlier is bounded. <bold>c</bold> The Huber weight function. Beyond a threshold, the weight of an observation drops gradually as the error goes to large. <bold>d</bold> Pseudocode of the iteratively reweighted least squares (IRLS) algorithm. The inputs comprise the design matrix <inline-formula id="IEq120"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq120.gif"/></alternatives></inline-formula>, response vector <inline-formula id="IEq121"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Y}}$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq121.gif"/></alternatives></inline-formula> of the linear regression model, the tuning constant <inline-formula id="IEq122"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M184"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq122.gif"/></alternatives></inline-formula>, the convergence threshold <inline-formula id="IEq123"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M186"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq123.gif"/></alternatives></inline-formula>, and the iteration limit <inline-formula id="IEq124"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M188"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq124.gif"/></alternatives></inline-formula>. The output is the robust M-estimate of the model parameters, which minimizes the Huber loss function</p></caption><graphic xlink:href="12859_2023_5367_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par24">The robustness of the M-estimate can be quantified by the influence function (IF), which measures the effect of infinitesimal perturbation of one data point on the estimate [<xref ref-type="bibr" rid="CR11">11</xref>]. The influence function of the M-estimate (<xref rid="Equ5" ref-type="disp-formula">5</xref>) at an observation <inline-formula id="IEq70"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({{\varvec{x}}}_{0},{y}_{0})$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq70.gif"/></alternatives></inline-formula> is given by<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{IF}}\left( {{\varvec{x}}_{0} ,y_{0} } \right) = \left( {\frac{{\psi_{H} \left( {y_{0} - {\varvec{x}}_{0}^{T} {\varvec{\beta}}} \right)}}{{{\text{E}}[\psi_{H}^{^{\prime}} \left( \varepsilon \right)]}}} \right)\left( {{\text{E}}\left[ {{\varvec{xx}}^{T} } \right]^{{.^{ - 1} }} {\varvec{x}}_{0} }\right),$$\end{document}</tex-math><mml:math id="M192" display="block"><mml:mrow><mml:mtext>IF</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext>E</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>ε</mml:mi></mml:mfenced><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mtext>E</mml:mtext><mml:msup><mml:mfenced close="]" open="["><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">xx</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mfenced><mml:msup><mml:mo>.</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq71"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\psi }_{H}(\bullet )$$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∙</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq71.gif"/></alternatives></inline-formula> is the derivative of the Huber loss function (<xref rid="Equ6" ref-type="disp-formula">6</xref>). The first factor of (<xref rid="Equ7" ref-type="disp-formula">7</xref>) measures the influence from the <italic>y</italic>-direction, and it is bounded since <inline-formula id="IEq72"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\psi }_{H}(\bullet )$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∙</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq72.gif"/></alternatives></inline-formula> is bounded (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). The second factor of (<xref rid="Equ7" ref-type="disp-formula">7</xref>) measures the influence from the <inline-formula id="IEq73"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{x}}$$\end{document}</tex-math><mml:math id="M198"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq73.gif"/></alternatives></inline-formula>-direction, and it is also bounded since <inline-formula id="IEq74"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{x}}}_{0}$$\end{document}</tex-math><mml:math id="M200"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq74.gif"/></alternatives></inline-formula> only consists of 0 and <inline-formula id="IEq75"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm 1$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:mo>±</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq75.gif"/></alternatives></inline-formula>. Putting together, the influence function (<xref rid="Equ7" ref-type="disp-formula">7</xref>) is bounded so that any outlier would not deviate the estimate from the true values much.</p>
      <p id="Par25">Yet we can further improve the accuracy of estimate by completely excluding the outliers. Denote the observations with large residuals by<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{o} = \{ i:\left| {y_{i} - {\varvec{x}}_{{\varvec{i}}}^{T} \hat{\user2{\beta }}^{M} } \right| &gt; r_{o} \} ,$$\end{document}</tex-math><mml:math id="M204" display="block"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>and they are identified as potential outliers. The value <inline-formula id="IEq76"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{o}$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq76.gif"/></alternatives></inline-formula> in (<xref rid="Equ8" ref-type="disp-formula">8</xref>) is the residual threshold with a default value 10. A smaller value of <inline-formula id="IEq77"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{o}$$\end{document}</tex-math><mml:math id="M208"><mml:msub><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq77.gif"/></alternatives></inline-formula> gives more protection on robustness at the risk of losing some contiguity of the assembly.</p>
      <p id="Par26"><bold>Step 2:</bold> RegCloser solves the OLS estimate on the observations excluding the potential outliers, i.e.,<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\user2{\beta }} = \arg \mathop {\min }\limits_{{\varvec{\beta}}} \mathop \sum \limits_{{i \notin I_{o} }} \left( {y_{i} - {\varvec{x}}_{{\varvec{i}}}^{T} {\varvec{\beta}}} \right)^{2} .$$\end{document}</tex-math><mml:math id="M210" display="block"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>arg</mml:mo><mml:munder><mml:mo movablelimits="false">min</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∉</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par27">Note that one contig may be further decomposed into several contigs after excluding the potential outliers. We deal with each contig separately as described in “Section <xref rid="Sec6" ref-type="sec">Representation of detected overlaps by linear regression model</xref>”. Finally, RegCloser obtains the estimated genomic positions of reads by rounding off <inline-formula id="IEq78"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{\beta }}_{i}$$\end{document}</tex-math><mml:math id="M212"><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq78.gif"/></alternatives></inline-formula> (<inline-formula id="IEq79"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le i\le n$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq79.gif"/></alternatives></inline-formula>) to the nearest integers. Placing the reads at their estimated positions on the coordinate axis forms a layout. In “Section <xref rid="Sec12" ref-type="sec">RegCloser’s rationale of resolving the tandem repeat</xref>”, a real example will show the superiority of the two-step robust regression procedure over the direct OLS regression in terms of the layout quality.</p>
    </sec>
    <sec id="Sec8">
      <title>Solving the robust M-estimate by an iteratively reweighted least squares (IRLS) algorithm</title>
      <p id="Par28">In Step 1 of the two-step robust regression, an IRLS algorithm (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d) is used to solve the robust M-estimate, i.e., the minimum of the objective function in (<xref rid="Equ5" ref-type="disp-formula">5</xref>). The IRLS algorithm starts with an initial estimate <inline-formula id="IEq80"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{{\varvec{\beta}}}}^{(0)}$$\end{document}</tex-math><mml:math id="M216"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq80.gif"/></alternatives></inline-formula>, such as the OLS estimate. Then it iteratively computes the weighted least squares (WLS) estimate as follows,<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{{\varvec{\beta}}}}^{(k+1)}=\mathrm{arg}\underset{{\varvec{\beta}}}{\mathrm{min}}\sum_{i=1}^{m}{w}_{i}^{(k+1)}{\left({y}_{i}-{{\varvec{x}}}_{{\varvec{i}}}^{T}{\varvec{\beta}}\right)}^{2},$$\end{document}</tex-math><mml:math id="M218" display="block"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">arg</mml:mi><mml:munder><mml:mi mathvariant="normal">min</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>until <inline-formula id="IEq81"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\parallel {\hat{{\varvec{\beta}}}}^{\left(k+1\right)}-{\hat{{\varvec{\beta}}}}^{(k)}\parallel }_{\infty }&lt;\alpha$$\end{document}</tex-math><mml:math id="M220"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mfenced close=")" open="("><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mi>∞</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq81.gif"/></alternatives></inline-formula> (<inline-formula id="IEq82"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =2$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq82.gif"/></alternatives></inline-formula> by default), where <inline-formula id="IEq83"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\parallel \bullet \parallel }_{\infty }$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mo>∙</mml:mo><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mi>∞</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq83.gif"/></alternatives></inline-formula> denotes the infinite norm. <inline-formula id="IEq84"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{i}^{(k+1)}$$\end{document}</tex-math><mml:math id="M226"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq84.gif"/></alternatives></inline-formula> is the weight assigned to the <inline-formula id="IEq85"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M228"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq85.gif"/></alternatives></inline-formula>-th observation, and relies on the residual from the previous iteration. Specifically, <inline-formula id="IEq86"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{i}^{(k+1)}={w}_{H}({\hat{\varepsilon }}_{i}^{(k)})$$\end{document}</tex-math><mml:math id="M230"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>ε</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq86.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq87"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\varepsilon }}_{i}^{(k)}={y}_{i}-{{\varvec{x}}}_{{\varvec{i}}}^{T}{\hat{{\varvec{\beta}}}}^{(k)}$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ε</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq87.gif"/></alternatives></inline-formula> is the residual, and <inline-formula id="IEq88"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{H}(\bullet )$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∙</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq88.gif"/></alternatives></inline-formula> is the weight function induced by the Huber loss function, i.e.,<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{H}\left(\varepsilon \right)=\frac{{\rho }_{H}^{\mathrm{^{\prime}}}(\varepsilon )}{\varepsilon }=\frac{{\psi }_{H}\left(\varepsilon \right)}{\varepsilon }=\left\{\begin{array}{c}1\\ c\ /\left|\varepsilon \right|\end{array}\right. \begin{array}{c}|\varepsilon |\le c\\ \left|\varepsilon \right|&gt;c\end{array}.$$\end{document}</tex-math><mml:math id="M236" display="block"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>ε</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ε</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>ε</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>ε</mml:mi></mml:mfenced></mml:mrow><mml:mi>ε</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>c</mml:mi><mml:mspace width="4pt"/><mml:mo stretchy="false">/</mml:mo><mml:mfenced close="|" open="|"><mml:mi>ε</mml:mi></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>ε</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>≤</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mfenced close="|" open="|"><mml:mi>ε</mml:mi></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par29">When the residuals are small (<inline-formula id="IEq89"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le c$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mo>≤</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq89.gif"/></alternatives></inline-formula>), the weights for the observations are 1. When the residual exceeds the threshold <inline-formula id="IEq90"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M240"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq90.gif"/></alternatives></inline-formula>, the weight gradually drops down (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). Intuitively, the IRLS algorithm assigns outliers small weights to reduce their influences on the M-estimate. Since the Huber loss function is convex and differentiable, the IRLS algorithm converges to the global minimum [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
      <p id="Par30">In each iteration of IRLS, solving the WLS estimate in (<xref rid="Equ10" ref-type="disp-formula">10</xref>) is equivalent to solving a system of linear equations, i.e.,<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}^{T} {\varvec{W}}^{\left( k \right)} \user2{X\beta } = {\varvec{X}}^{T} {\varvec{W}}^{\left( k \right)} {\varvec{Y}}.$$\end{document}</tex-math><mml:math id="M242" display="block"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow></mml:mrow><mml:mfenced close=")" open="("><mml:mi>k</mml:mi></mml:mfenced></mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow></mml:mrow><mml:mfenced close=")" open="("><mml:mi>k</mml:mi></mml:mfenced></mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par31">The coefficient matrix <inline-formula id="IEq91"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{X}}}^{T}{{\varvec{W}}}^{\left(k\right)}{\varvec{X}}$$\end{document}</tex-math><mml:math id="M244"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow></mml:mrow><mml:mfenced close=")" open="("><mml:mi>k</mml:mi></mml:mfenced></mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq91.gif"/></alternatives></inline-formula> is highly sparse (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S5). A series of efficient numerical algorithms have been developed for solving this kind of sparse linear systems. In RegCloser, a kind of accelerated restarted Krylov subspace method, LGMRES [<xref ref-type="bibr" rid="CR16">16</xref>], is used to solve (<xref rid="Equ12" ref-type="disp-formula">12</xref>), and the matrix manipulation is implemented in the sparse format for efficiency.</p>
      <p id="Par32">When the input includes multiple libraries with different insert sizes, RegCloser has an option ‘-w’ that assigns an initial weight to each overlap observation, which corresponds to a detected overlap. The initial weight depends on the standard deviation of the library where the overlapping reads come from. The smaller standard deviation induces a larger weight.</p>
    </sec>
    <sec id="Sec9">
      <title>Gap sequence determination</title>
      <p id="Par33">For each layout of reads, a multiple sequence alignment is constructed by sequentially aligning the next read with the current alignment. A consensus is determined by selecting the nucleotide at each base site with the largest Bayesian posterior probability (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S6). The probabilities are converted into Phred scores and output to the fastq file with the nucleotide sequence. Finally, the two pseudo reads, which are cut from the flanking sequences of a gap in the overlap stage (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b), are used to anchor the consensus into the gap (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). If the two pseudo reads are contained in the layout, the consensus sequence between them is taken to close the gap. Else if only one of the two pseudo reads is contained in the layout, RegCloser takes the consensus sequence after the left pseudo read to extend the left-flanking contig, or the consensus sequence before the right pseudo read to extend the right-flanking contig.</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Results</title>
    <sec id="Sec11">
      <title>Benchmarking on a GAGE dataset</title>
      <p id="Par34">We compared RegCloser with GapCloser, GapFiller, Sealer, and Phrap on the <italic>Staphylococcus aureus</italic> sequencing dataset from GAGE [<xref ref-type="bibr" rid="CR17">17</xref>]. A draft assembly was generated by SOAPdenovo2 (version 2.04) [<xref ref-type="bibr" rid="CR7">7</xref>]. A paired-end library whose insert size has an average of 415 bp and a standard deviation of 105 bp was added for closing gaps on the draft genome. The density plot of its insert size distribution is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3a. The read length was 101 bp and the read coverage was 84X. Quality assessment was performed through comparison with the known reference genome using QUAST (version 5.2.0) [<xref ref-type="bibr" rid="CR18">18</xref>]. The results are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. Sealer did not finish after running for more than 72 h. RegCloser achieved the largest contig N50 with the fewest mis-assemblies and local mis-assemblies. GapCloser achieved the largest genome fraction (98.927%) but RegCloser is close to it (98.917%). The command lines for running the five methods are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S7, and their runtime and memory usage are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5.</p>
      <p id="Par35">Tandem repeats are ubiquitous in both prokaryote and eukaryote genomes. They are distributed in both noncoding and coding regions, and can carry important biological functions [<xref ref-type="bibr" rid="CR19">19</xref>]. However, tandem repeats remain challenges in DNA assembly. It is particularly difficult to resolve the copy number of a tandem repeat [<xref ref-type="bibr" rid="CR1">1</xref>]. In the evaluation of the <italic>S. aureus</italic> assembly, we found a gap spanned by a tandem repeat as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>a. The tandem repeat was 201 bp long, with a unit size of 69 bp repeated about 2.9 times. The gap starts from the 32nd base of the first repeat unit, and ends exactly after the whole tandem repeat. All the five methods reported that they closed the gap, and the result of Sealer was obtained by running the software on the single scaffold containing the gap. However, only RegCloser resolved the copy number accurately (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). GapFiller, Sealer, and Phrap underestimated the copy number, while GapCloser overestimated the copy number. The result from GapFiller had 0.9 copy, those from Sealer and Phrap both had 1.9 copies, and that from GapCloser had 7.9 copies. In the next subsection, we will dissect the procedure of RegCloser and show its rationale of resolving the tandem repeat.<fig id="Fig3"><label>Fig. 3</label><caption><p>Closing a gap containing a tandem repeat. <bold>a</bold> Comparison of the closing results from five methods on a gap containing a triple tandem repeat. The repeat unit is shaded in yellow, and the copy number is 2.9. The gap starts at the middle of the first copy and ends at the repeat end. The sequences flanking the gap are shaded in blue. Existing tools including Phrap, GapCloser, GapFiller, and Sealer make mistakes on the copy number; only RegCloser resolves the tandem repeat correctly. <bold>b</bold> An illustration of the two different alignments between two reads from the tandem repeat. The position ① is mapped by the green and red alignments respectively to positions ② and ③, which differ in a shift of 69 bp, i.e., the size of the repeat unit. <bold>c</bold> Violin plots for the observational errors of overlaps detected by all-against-all pairwise alignment (left) versus by insert-size guided pairwise alignment (right). The observational error of an overlap between reads <inline-formula id="IEq125"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M246"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq125.gif"/></alternatives></inline-formula> and <inline-formula id="IEq126"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M248"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq126.gif"/></alternatives></inline-formula> refers to the difference between <inline-formula id="IEq127"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}^{(i,j)}$$\end{document}</tex-math><mml:math id="M250"><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq127.gif"/></alternatives></inline-formula> and (<inline-formula id="IEq128"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{j}-{\beta }_{i}$$\end{document}</tex-math><mml:math id="M252"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq128.gif"/></alternatives></inline-formula>), where <inline-formula id="IEq129"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq129.gif"/></alternatives></inline-formula> and <inline-formula id="IEq130"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{j}$$\end{document}</tex-math><mml:math id="M256"><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq130.gif"/></alternatives></inline-formula> are true read positions. The insert-size guided strategy gets rid of the large errors around 138 bp and substantially reduces the moderate errors around 69 bp, thus generating a higher-quality dataset for the regression. <bold>d</bold> Variation of the residual distribution along the process of the two-step robust regression. In Step 1, as the iteration increases in the IRLS algorithm for computing the robust M-estimate, most residuals converge towards 0 bp, while a fraction of residuals are still between 0 and 69 bp. In Step 2, the read coordinates are estimated by OLS on the data excluding the subset of outliers identified in Step 1. The final residuals of all data are clustered into two peaks exactly at 0 and 69 bp, which means the outliers have been separated out. <bold>e</bold> Screenshots of the layouts generated respectively from the OLS estimate and the two-step robust estimate of the reads’ genomic positions. The former layout is unclean and the latter layout is well aligned</p></caption><graphic xlink:href="12859_2023_5367_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>RegCloser’s rationale of resolving the tandem repeat</title>
      <p id="Par36">In essence, the difficulty of solving tandem repeats is that the reads from different repeat units are hard to discriminate. False overlaps between reads from different units can lead to incorrect copy number. The analysis of the tandem repeat example shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> explains how RegCloser overcomes the difficulty efficiently.</p>
      <p id="Par37">In the overlap stage, RegCloser reduced the proportion of false overlaps significantly by insert-size guided pairwise alignment. On the one hand, rather than all-against-all pairwise alignment, RegCloser detected the overlaps only between reads whose prior positions were close, and the number of pairwise alignments were reduced from 140,185 to 39,106. Consequently, the overlaps between distant repeat units were avoided from the beginning. In other words, the large observational errors (the peak of 138 bp in Fig. <xref rid="Fig3" ref-type="fig">3</xref>c) were eliminated from the insert-size guided overlap results (the right panel in Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). On the other hand, when two reads from adjoining repeat units are aligned in two ways (see the example in Fig. <xref rid="Fig3" ref-type="fig">3</xref>b), RegCloser selected the alignment closer to the prior genomic positions. In this way, the middle observational errors (the peak of 69 bp in Fig. <xref rid="Fig3" ref-type="fig">3</xref>c) were further reduced substantially, with the proportion from <inline-formula id="IEq92"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$34.16\mathrm{\%}$$\end{document}</tex-math><mml:math id="M258"><mml:mrow><mml:mn>34.16</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq92.gif"/></alternatives></inline-formula> to <inline-formula id="IEq93"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$12.97\mathrm{\%}$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:mn>12.97</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq93.gif"/></alternatives></inline-formula>. Overall, the proportion of nonzero observational errors was reduced from <inline-formula id="IEq94"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$48.38\mathrm{\%}$$\end{document}</tex-math><mml:math id="M262"><mml:mrow><mml:mn>48.38</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq94.gif"/></alternatives></inline-formula> to <inline-formula id="IEq95"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$14.40\mathrm{\%}$$\end{document}</tex-math><mml:math id="M264"><mml:mrow><mml:mn>14.40</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq95.gif"/></alternatives></inline-formula>.</p>
      <p id="Par38">In the robust regression stage, RegCloser detected and eliminated the influence of the remaining false overlaps. Figure <xref rid="Fig3" ref-type="fig">3</xref>d shows the variation of the residual distribution along the process of the two-step robust regression. In Step 1, the IRLS algorithm started with the OLS estimate, and converged after 8 iterations. The proportion of zero residuals increased from <inline-formula id="IEq96"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5.54\mathrm{\%}$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:mn>5.54</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq96.gif"/></alternatives></inline-formula> to <inline-formula id="IEq97"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$27.20\mathrm{\%}$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:mn>27.20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq97.gif"/></alternatives></inline-formula>, and the proportion of residuals no larger than <inline-formula id="IEq98"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq98.gif"/></alternatives></inline-formula> bp increased from 21.56% to 58.73%. The overlaps with residuals larger than <inline-formula id="IEq99"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10$$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq99.gif"/></alternatives></inline-formula> bp were identified as potential outliers. In Step 2, the read positions were again estimated by OLS on the data excluding the subset of potential outliers. The proportion of zero residuals further increased from <inline-formula id="IEq100"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$27.20\mathrm{\%}$$\end{document}</tex-math><mml:math id="M274"><mml:mrow><mml:mn>27.20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq100.gif"/></alternatives></inline-formula> to 85.60 <inline-formula id="IEq101"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\%}$$\end{document}</tex-math><mml:math id="M276"><mml:mo>%</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq101.gif"/></alternatives></inline-formula>, and the residuals were clustered into two peaks respectively at 0 and 69 bp (the last subplot in Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). As illustrated in Fig. <xref rid="Fig3" ref-type="fig">3</xref>e, the layout resulted from the OLS estimate was full of misplacement. In contrast, the two-step robust regression in RegCloser produced a well aligned layout.</p>
    </sec>
    <sec id="Sec13">
      <title>Complete and accurate reconstruction of <italic>E. coli</italic> genome with simulated data</title>
      <p id="Par39">We also tested the performance of RegCloser on simulated data. Six Illumina libraries were simulated from the <italic>Escherichia coli</italic> reference genome (strain K-12 MG1655) using ART (version 2.5.8) [<xref ref-type="bibr" rid="CR20">20</xref>]. The detailed information of the six libraries is listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2, and the density plots of their insert size distributions are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3b.</p>
      <p id="Par40">A draft genome was first assembled using SOAPdenovo2 (version 2.04). The draft genome contained only one scaffold of 4,637,015 bp with 136 gaps. Five libraries with insert sizes of 300, 500, 800, 2 k, and 5 k were used to close the gaps. We ran RegCloser in an iterative way that the output genome served as the input of the next iteration. Merely after two iterations the 136 gaps were fully closed. The gap-closed genome was evaluated by QUAST (version 5.2.0). No mis-assemblies or local mis-assemblies were found, and the genome fraction was 100%. That is, a complete and accurate <italic>E. coli</italic> genome was reconstructed.</p>
      <p id="Par41">We compared the performance with the other four gap-closing methods. Similarly, they were run in an iterative way until no more gaps could be closed. The command lines are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S7, and the runtime and memory usage are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5. The results are shown in Table <xref rid="Tab1" ref-type="table">1</xref>. Only Sealer yielded one mis-assembly, while all the four methods yielded multiple local mis-assemblies. Their genome fractions were all lower than 100%. Even though GapCloser produced one contig, it contained the most local mis-assemblies. To further validate how many gaps were correctly closed, we aligned each “closed” gap sequence to the “true” gap sequence. If they were well aligned (by default, 15 bp soft-clip on both ends are allowed), the gap would be viewed as correctly closed. Table <xref rid="Tab1" ref-type="table">1</xref> demonstrates that RegCloser correctly closed all the 136 gaps, followed by GapCloser with 112/136, Phrap with 108/136, GapFiller with 103/136, and Sealer with 57/136.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of the five methods on the <italic>E. coli</italic> simulation data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Methods</th><th align="left">Draft</th><th align="left">GapCloser</th><th align="left">GapFiller</th><th align="left">Sealer</th><th align="left">Phrap</th><th align="left">RegCloser</th></tr></thead><tbody><tr><td align="left">Contig length</td><td align="left">4,531,075</td><td align="left">4,642,829</td><td align="left">4,631,201</td><td align="left">4,542,679</td><td align="left">4,641,796</td><td align="left">4,641,652</td></tr><tr><td align="left">Contig number</td><td align="left">137</td><td align="left">1</td><td align="left">26</td><td align="left">59</td><td align="left">7</td><td align="left">1</td></tr><tr><td align="left">Contig N50</td><td align="left">78,557</td><td align="left">4,642,829</td><td align="left">331,261</td><td align="left">174,037</td><td align="left">1,334,246</td><td align="left">4,641,652</td></tr><tr><td align="left">Genome fraction</td><td align="left">97.532%</td><td align="left">99.924%</td><td align="left">99.687%</td><td align="left">97.851%</td><td align="left">99.892%</td><td align="left"><bold>100%</bold></td></tr><tr><td align="left"># mis-assemblies</td><td align="left">0</td><td align="left"><bold>0</bold></td><td align="left"><bold>0</bold></td><td align="left">1</td><td align="left"><bold>0</bold></td><td align="left"><bold>0</bold></td></tr><tr><td align="left"># local mis-assemblies</td><td align="left">0</td><td align="left">25</td><td align="left">7</td><td align="left">20</td><td align="left">23</td><td align="left"><bold>0</bold></td></tr><tr><td align="left"># mismatches</td><td align="left">0</td><td align="left">245</td><td align="left"><bold>43</bold></td><td align="left">55</td><td align="left">313</td><td align="left">51</td></tr><tr><td align="left"># indels</td><td align="left">0</td><td align="left">32</td><td align="left">13</td><td align="left">17</td><td align="left">42</td><td align="left"><bold>12</bold></td></tr><tr><td align="left"># closed gaps (# total gaps = 136)</td><td align="left"/><td align="left"><bold>136</bold></td><td align="left">111</td><td align="left">78</td><td align="left">130</td><td align="left"><bold>136</bold></td></tr><tr><td align="left"># correctly closed gaps</td><td align="left"/><td align="left">112</td><td align="left">103</td><td align="left">57</td><td align="left">108</td><td align="left"><bold>136</bold></td></tr><tr><td align="left"># closed TRs (# total TRs = 26)</td><td align="left"/><td align="left"><bold>26</bold></td><td align="left">12</td><td align="left">25</td><td align="left">24</td><td align="left"><bold>26</bold></td></tr><tr><td align="left"># correctly closed TRs</td><td align="left"/><td align="left">8</td><td align="left">4</td><td align="left">6</td><td align="left">6</td><td align="left"><bold>26</bold></td></tr><tr><td align="left"># incorrectly closed TRs/ # incorrectly closed gaps</td><td align="left"/><td align="left">18/24</td><td align="left">8/8</td><td align="left">19/21</td><td align="left">18/22</td><td align="left"><bold>0/0</bold></td></tr></tbody></table><table-wrap-foot><p>The assemblies are aligned to the reference genome using QUAST 5.2.0. Genome fraction is the percentage of the reference genome covered by assembled contigs. Mis-assemblies are locations on assembled contigs where the left and right flanking sequences align over 1 kb away, or they overlap by &gt; 1 kb, or they align on opposite strands. Local mis-assemblies are positions on contigs where the flanking sequences have a gap or overlap &lt; 1 kbp and &gt; 80 bp on the same strand of the reference. The best values of each quality metric are highlighted in bold. RegCloser correctly closes all the 136 gaps including the 26 tandem repeat (TR)-related gaps, and leads to a complete genome with 100% genome fraction and no mis-assemblies or local mis-assemblies. For the other four methods, the TR-related gaps account for most of the incorrectly closed gaps</p></table-wrap-foot></table-wrap></p>
      <p id="Par42">We paid special attention to the correctness of the tandem repeat (TR)-related gap closing. We first used the program Tandem Repeats Finder [<xref ref-type="bibr" rid="CR21">21</xref>] to locate tandem repeats on the reference genome, and found 26 out of the 136 gap regions intersected with certain tandem repeats. Furthermore, we found these tandem repeats accounted for most of the incorrectly closed gaps by the four methods. Specifically, 100%, <inline-formula id="IEq102"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$90.48\mathrm{\%}$$\end{document}</tex-math><mml:math id="M278"><mml:mrow><mml:mn>90.48</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq102.gif"/></alternatives></inline-formula>, <inline-formula id="IEq103"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$81.82\mathrm{\%}$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:mn>81.82</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq103.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq104"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$75\mathrm{\%}$$\end{document}</tex-math><mml:math id="M282"><mml:mrow><mml:mn>75</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq104.gif"/></alternatives></inline-formula> of the total gaps incorrectly closed by GapFiller, Sealer, Phrap and GapCloser were TR-related respectively (Table <xref rid="Tab1" ref-type="table">1</xref>).</p>
      <p id="Par43">The detailed information of the 26 TR-related gaps and their closure results are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3. RegCloser correctly closed all the 26 TR-related gaps, followed by GapCloser with 8, Phrap with 6, Sealer with 6, and GapFiller with 4. These simulation results demonstrate that RegCloser outperformed other methods, especially in resolving tandem repeats.</p>
    </sec>
    <sec id="Sec14">
      <title>Closing gaps of the plateau zokor draft genome that has been improved by long reads</title>
      <p id="Par44">To understand how the plateau zokor (<italic>Myospalax baileyi</italic>) adapts to the environment of high altitude and low oxygen, our collaborators from Kunming Institute of Zoology, CAS, initiated a sequencing project of plateau zokor, the complete genome size of which is about 3.17 Gbp [<xref ref-type="bibr" rid="CR22">22</xref>]. The sequence data contain 22 Illumina libraries with insert sizes ranging from 180 bp to 10 kbp, and the total sequence coverage is 130.5 X. In addition, 10X PacBio long reads were sequenced [<xref ref-type="bibr" rid="CR23">23</xref>]. The published draft genome was initially assembled with the Illumina short reads using SOAPdenovo2, and then was improved with the PacBio long reads using PBJelly. However, the improved genome still contained 99,434 gaps.</p>
      <p id="Par45">We run RegCloser and the other four methods to close the gaps by two rounds, and the command lines are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S7. The results are shown in Table <xref rid="Tab2" ref-type="table">2</xref>. In the first round, three paired-end libraries with insert sizes of 300, 500, and 800 bp were used for gap closing. In the second round, a mate-pair library with a long insert size of 3000 bp was added. The detailed information of the four libraries is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4, and the density plots of their insert size distributions are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3c. The runtime and memory usage of the five methods are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison of the five methods on closing gaps of the plateau zokor draft genome</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Methods</th><th align="left">Draft</th><th align="left">GapCloser</th><th align="left">GapFiller</th><th align="left">Sealer</th><th align="left">Phrap</th><th align="left">RegCloser</th></tr></thead><tbody><tr><td align="left" colspan="7"><bold>3 paired-end libraries</bold></td></tr><tr><td align="left">Contig length</td><td align="left">2,527,528,914</td><td align="left">2,538,745,631</td><td align="left">2,530,456,764</td><td align="left">2,528,744,942</td><td align="left">2,528,100,353</td><td align="left">2,527,758,194</td></tr><tr><td align="left">Contig number</td><td align="left">113,835</td><td align="left">97,906</td><td align="left">96,181</td><td align="left">102,260</td><td align="left">71,066</td><td align="left">69,093</td></tr><tr><td align="left">Contig N50 (bp)</td><td align="left">67,378</td><td align="left">76,359</td><td align="left">88,200</td><td align="left">73,199</td><td align="left">130,114</td><td align="left"><bold>143,871</bold></td></tr><tr><td align="left"># closed gaps</td><td align="left"/><td align="left">15,929</td><td align="left">17,654</td><td align="left">11,575</td><td align="left">42,769</td><td align="left"><bold>44,742</bold></td></tr><tr><td align="left">BUSCO</td><td align="left">95.1%</td><td align="left"><bold>95.2%</bold></td><td align="left">95.1%</td><td align="left"><bold>95.2%</bold></td><td align="left"><bold>95.2%</bold></td><td align="left"><bold>95.2%</bold></td></tr><tr><td align="left">Mapping rate</td><td align="left">79.1%</td><td align="left">79.4%</td><td align="left">79.3%</td><td align="left">79.2%</td><td align="left">79.7%</td><td align="left"><bold>79.9%</bold></td></tr><tr><td align="left" colspan="7"><bold>3 paired-end + 1 mate-pair libraries</bold></td></tr><tr><td align="left">Contig length</td><td align="left">2,527,528,914</td><td align="left">2,541,442,324</td><td align="left">2,532,550,654</td><td align="left">2,528,949,290</td><td align="left">2,526,621,405</td><td align="left">2,524,372,994</td></tr><tr><td align="left">Contig number</td><td align="left">113,835</td><td align="left">96,437</td><td align="left">92,755</td><td align="left">100,611</td><td align="left">65,445</td><td align="left">62,766</td></tr><tr><td align="left">Contig N50 (bp)</td><td align="left">67,378</td><td align="left">77,295</td><td align="left">93,380</td><td align="left">74,852</td><td align="left">146,599</td><td align="left"><bold>173,542</bold></td></tr><tr><td align="left"># closed gaps</td><td align="left"/><td align="left">17,398</td><td align="left">21,080</td><td align="left">13,224</td><td align="left">48,390</td><td align="left"><bold>51,069</bold></td></tr><tr><td align="left">BUSCO</td><td align="left">95.1%</td><td align="left"><bold>95.2%</bold></td><td align="left">95.1%</td><td align="left"><bold>95.2%</bold></td><td align="left"><bold>95.2%</bold></td><td align="left"><bold>95.2%</bold></td></tr><tr><td align="left">Mapping rate</td><td align="left">79.1%</td><td align="left">79.5%</td><td align="left">79.4%</td><td align="left">79.2%</td><td align="left">79.7%</td><td align="left"><bold>80.1%</bold></td></tr></tbody></table><table-wrap-foot><p>The draft genome is initially assembled with high coverage short reads, and then improved with long reads. Two rounds of gap closing are performed. In the first round, three paired-end libraries with insert sizes of 300, 500, and 800 bp are used. In the second round, a mate-pair library with a long insert size of 3000 bp is added. Mapping rate is measured by mapping the reads of an independent library to the assembly. Contig N50 assesses the contiguity of genome assemblies. BUSCO and mapping rate assess the completeness of genome assemblies. The best values of each quality metric are highlighted in bold. After both rounds, RegCloser closes the most gaps, and achieves the highest contig N50, BUSCO, and mapping rate</p></table-wrap-foot></table-wrap></p>
      <p id="Par46">After the first round, RegCloser closed 44,742 (45.0%) gaps, and the contig N50 increased from 67.4 kbp to 143.9 kbp, exceeding all the other four methods. After the second round, RegCloser closed 6,327 more gaps, and the contig N50 further increased to 173.5 kbp. We used REAPR (version 1.0.18) [<xref ref-type="bibr" rid="CR24">24</xref>] to identify potential assembly mistakes, at which the genome would be broken. The broken contig N50 for RegCloser was 156.3 kbp, even outperforming the unbroken contig N50 for the other four methods (Table <xref rid="Tab2" ref-type="table">2</xref>). It indicated RegCloser achieved the highest contiguity with high accuracy.</p>
      <p id="Par47">BUSCO (version 5.4.2) [<xref ref-type="bibr" rid="CR25">25</xref>] was used to evaluate the completeness of assemblies with conserved single-copy orthologs in Glires. After both rounds, the BUSCO value increased from 95.1% to 95.2% for all the methods except GapFiller. Alternatively, the mapping rate of reads also measures the completeness of genome assemblies. We used the mapping tool, SEME [<xref ref-type="bibr" rid="CR26">26</xref>] with a strict criterion, to map the reads of an independent library to the assemblies. After both rounds, RegCloser achieved the highest mapping rate (Table <xref rid="Tab2" ref-type="table">2</xref>), which increased from 79.1% to 79.9% after the first round and further increased to 80.1% after the second round.</p>
      <p id="Par48">RegCloser provides an iterative scaffolding and gap closing mode like that in BAUM [<xref ref-type="bibr" rid="CR27">27</xref>]. The mode is specified by the option “-rs” (re-scaffolding). It uses the existing scaffolding tool to re-build scaffolds before gap closing in every iteration. In this mode, contig extension and gap closing provide more information for constructing longer and more accurate scaffolds, which further benefits the gap closing in the next iteration. We successively input the 7 libraries with insert sizes of respectively 300, 500, 800, 3 k, 5 k, 8 k, and 10 k bp, and ran 7 iterations in the re-scaffolding mode. The detailed information of the 7 libraries is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4, and the density plots of their insert size distributions are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3c. After 7 iterations, the final contig N50 reached 204 kbp, more than 3 folds of that in the published draft. Even after broken by REAPR with both short and long insert size libraries, the contig N50 still remained 179 kbp.</p>
    </sec>
    <sec id="Sec15">
      <title>The robust regression approach to generating an optimal layout of TGS long reads</title>
      <p id="Par49">We tested the applicability of the robust regression approach to layout generation in de novo assembly of long reads using a PacBio HiFi dataset of <italic>E. coli</italic>. The read length ranges from 10 to 17 kbp and the sequence coverage utilized in this assembly case was about 20X. To detect overlaps, we implemented an all-against-all pairwise alignment by BLASR [<xref ref-type="bibr" rid="CR28">28</xref>], restricting the hanging-out length to a maximum of 50 bp. Then we filtered out the suspicious chimeric reads using the information of the detected overlaps. In de novo assembly, the read orientations, namely, the strands from which the reads originate in the target genomic DNA, are unknown. Thus we first used a heuristic algorithm reported in RegScaf [<xref ref-type="bibr" rid="CR29">29</xref>] to orientate all reads, <italic>c.f.</italic> Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S8.</p>
      <p id="Par50">After orientating reads, we considered only one of the DNA double strands, and all reads from the other strand were transformed by reverse complement. Then these reads along with their orientation-supported alignments were input into the linear regression model described in “Section <xref rid="Sec6" ref-type="sec">Representation of detected overlaps by linear regression model</xref>”, as depicted in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a. The two-step robust regression procedure described in “Section <xref rid="Sec7" ref-type="sec">Estimation of the reads’ genomic positions by a two-step robust regression procedure</xref>” was used to generate an optimal layout. The trimming step may split the resulted layout into multiple unconnected layouts. Next, we further constructed a layout-level graph in which each layout corresponds to a vertex and overlaps between layouts correspond to edges. Then the only path in the new graph led to the final layout. Its length was 4.6 M, nearly the length of the complete genome of <italic>E. coli</italic>.<fig id="Fig4"><label>Fig. 4</label><caption><p>Generating an optimal layout of TGS long reads by the robust regression approach. <bold>a</bold> Illustration of the regression representation. In the linear axis corresponding to the real genome, the position of each TGS long read is represented by a parameter <inline-formula id="IEq131"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M284"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq131.gif"/></alternatives></inline-formula> to be estimated. Each overlap, marked by the yellow double-headed arrow, provides an observation on the difference between two reads’ positions. However, chimeric reads, as well as repeats from distant regions in either the same or reverse strain of the genome, will bring in false overlaps, as those marked by red crossings, where ① indicates a false overlap caused by a chimeric read, ② indicates one caused by a repeat in the same strain, and ③ indicates one caused by a repeat in the reverse strain. All the overlap observations are integrated into the linear regression model <inline-formula id="IEq132"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Y}}={\varvec{X}}{\varvec{\beta}}+{\varvec{\varepsilon}}$$\end{document}</tex-math><mml:math id="M286"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq132.gif"/></alternatives></inline-formula>. Then the two-step robust regression procedure gives a globally optimal estimate of the read positions, which lead to a layout. Meanwhile, it detects the outliers, which correspond to the false overlaps. <bold>b</bold> Boxplot of the differences between the estimated and true positions of the reads in the layout that was generated by RegCloser for de novo assembly of the <italic>E. coli</italic> genome using a HiFi dataset</p></caption><graphic xlink:href="12859_2023_5367_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par51">We assessed the accuracy of the final layout by aligning all long reads to the reference genome and comparing their estimates in layouts with their real positions. The layout was shifted by a constant so that the median of errors is zero. Figure <xref rid="Fig4" ref-type="fig">4</xref>b is the box-plot of the errors of the estimated read positions. It shows that all reads were positioned near their true loci with a standard deviation of 451 bp.</p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Discussion and conclusions</title>
    <p id="Par52">In this article, we propose a new local assembly approach, RegCloser, for closing gaps in draft genomes. On the one hand, it utilizes the insert size information in the SGS paired sequencing reads to guide the pairwise alignment, thereby reducing both the computing cost and ambiguities caused by repeats in overlap detection. On the other hand, RegCloser represents the detected overlaps by a linear regression model, which regards the false overlaps caused by repeats or sequencing errors as outliers. This representation transforms the sequence assembly into a statistically robust estimation problem.</p>
    <p id="Par53">Note that if we take the Hamiltonian graph representation in the OLC paradigm, finding an optimal layout in the overlap graph is NP-complete. Hitherto the existing OLC methods generate layouts by greedy search. Here with the linear regression representation, the global optimal layout under the Huber loss function is achievable by the IRLS algorithm, which is to iteratively solve the sparse system of linear equations. Statistically, the influence function, a robustness measure, of the Huber M-estimator is bounded in both <inline-formula id="IEq105"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{x}}$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq105.gif"/></alternatives></inline-formula>- and <italic>y</italic>-directions.</p>
    <p id="Par54">The aim and approach of RegCloser are different from those of the scaffolding method RegScaf we recently proposed [<xref ref-type="bibr" rid="CR29">29</xref>], although the linear model is used in both problems. RegScaf focuses on the scaffolding problem, which is to order contigs and estimate gap sizes, while RegCloser focuses on the gap-closing problem, which is to locally assemble short reads into contigs. Technically, RegScaf adopts the least trimmed squares (LTS) estimator. Although no efficient algorithm for computing the exact LTS solution is available in the multiple regression, an approximation is sufficiently good for the accuracy required by scaffolding. In comparison, the layout generation in the assembly problem needs more accurate estimation of read positions. Therefore, RegCloser adopts the more efficient robust estimator, the Huber M-estimator, whose exact solution can be computed. RegCloser can be used to improve genome assemblies in combination with any scaffolding methods.</p>
    <p id="Par55">When the repeat unit size is beyond the length of sequencing reads, the repeat structure can hardly be resolved by SGS data alone. However, we demonstrated that making full use of the library insert size information combined with robust regression can resolve some tandem repeats successfully. The insert-size guided pairwise alignment helps distinguish repeats from different units, and the two-step robust regression lays out reads at the right places. Compared with existing gap-closing methods, RegCloser closes more gaps and achieves higher contiguity and completeness, especially outperforms at gaps containing tandem repeats. The simulation results and the quality assessment by REAPR indicate that the gaps closed by RegCloser are of high quality.</p>
    <p id="Par56">The results on the plateau zokor draft genome suggest that RegCloser is scalable to large genomes. The zokor draft genome was initially assembled from SGS data, then long reads were applied to improve its contig N50 to 67 kbp. RegCloser further increased the contig N50 to 204 kbp based on the iterative scaffolding and gap closing strategy, which indicates that RegCloser can still improve on the basis of the results from long reads.
</p>
    <p id="Par57">Conceptually, the robust regression approach is a general assembly framework that is applicable to de novo assembly of both SGS and TGS data. We tested it on the layout generation for TGS long reads. Despite the long read length of TGS technology, issues like chimeric reads and indistinguishable repeats of a longer unit size still exist. Our results suggest that these issues can be partly solved by robust regression. Therefore, the proposed robust regression approach has a prospect to be incorporated into the layout module of long read assemblers.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec17">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5367_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1. </bold>Supplementary Figs. S1-S3, Notes S1-S8, and Tables S1-S5. </p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Shenghao Cao and Mengtian Li: Joint first authors</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Kunming Institute of Zoology, Chinese Academy of Sciences (CAS) for providing us with the sequence data of the plateau zokor genome project. We thank Zhanyu Wang for his patient guidance on useful experience.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>LML conceived the study and proposed the notion of linear regression representation and robust estimation of genome assembly. SC developed the linear model representation of overlap graph, proposed to use the Huber M-estimator, the IRLS algorithm, and demonstrated its robustness. ML, LML, and SC proposed the one-step trimmed least squares. ML and SC developed the insert-size guided pairwise alignment. SC implemented the majority code of RegCloser. ML carefully read, revised and supplemented the code. SC and ML tested RegCloser and the other tools on different datasets, and SC analyzed the results. ML proposed to orientate the long reads in de novo assembly, and implemented the algorithm. SC provided the draft code of layout generation. ML modified the code, tuned the parameters for the genome assembly of <italic>E. coli</italic> using long reads, and analyzed the results. SC prepared Figs. <xref rid="Fig1" ref-type="fig">1</xref>–<xref rid="Fig3" ref-type="fig">3</xref> and Tables <xref rid="Tab1" ref-type="table">1</xref>–<xref rid="Tab2" ref-type="table">2</xref>. ML prepared Fig. <xref rid="Fig4" ref-type="fig">4</xref>. The three authors revised the figures. SC prepared the majority of the supplementary materials, and ML revised and supplemented them. The three authors wrote and revised the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>National Key Research and Development Program of China, grant number 2022YFA1004801; National Natural Science Foundation of China, grant numbers 32170679, 11871462, and 91530105; Strategic Priority Research Program of the Chinese Academy of Sciences, grant number XDB13040600; National Center for Mathematics and Interdisciplinary Sciences, Chinese Academy of Sciences; Key Laboratory of Systems and Control, Chinese Academy of Sciences.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The <italic>S. aureus</italic> GAGE dataset is available at <ext-link ext-link-type="uri" xlink:href="http://gage.cbcb.umd.edu/data">http://gage.cbcb.umd.edu/data</ext-link>. The <italic>S. aureus</italic> paired-end sequence data are available in the Sequence Read Archive (SRA) in National Center for Biotechnology Information (NCBI, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov">https://www.ncbi.nlm.nih.gov</ext-link>) under the accession number SRR5244695. The <italic>S. aureus</italic> reference genome is available in the Assembly database in NCBI under the accession number GCF_000017085.1. The <italic>E. coli</italic> simulated sequence data can be downloaded from our github site at <ext-link ext-link-type="uri" xlink:href="https://github.com/csh3/RegCloser">https://github.com/csh3/RegCloser</ext-link>. The <italic>E. coli</italic> reference genome is available in the Assembly database in NCBI under the accession number GCF_000005845.2. The plateau zokor draft genome was retrieved from the Genome Warehouse (GWH) in National Genomics Data Center (NGDC, <ext-link ext-link-type="uri" xlink:href="https://ngdc.cncb.ac.cn">https://ngdc.cncb.ac.cn</ext-link>) under the accession number GWHABJZ00000000. The raw Illumina sequence data of plateau zokor are accessible in the Genome Sequence Archive (GSA) in NGDC under accession numbers ranging from CRX003877 to CRX003883, and from CRX004479 to CRX004484. The plateau zokor genome improved by RegCloser has been deposited in the GWH in NGDC under the accession number GWHBOZX00000000. The PacBio HiFi dataset of <italic>E. coli</italic> is available in the SRA in NCBI under the accession number SRR10971019.</p>
    <p>The software details are listed below</p>
    <p>Project name: RegCloser</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/csh3/RegCloser">https://github.com/csh3/RegCloser</ext-link></p>
    <p>Operating system: Linux</p>
    <p>Programming language: Python</p>
    <p>Other requirements: BWA, Python3 with modules os, sys, re, argparse, biopython, numpy, math, networkx, scipy, collections, datetime, multiprocessing</p>
    <p>License: GNU General Public License v3.0 only</p>
    <p>Any restrictions to use by non-academics: licence needed</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par58">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par59">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par60">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tørresen</surname>
            <given-names>OK</given-names>
          </name>
          <name>
            <surname>Star</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mier</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Andrade-Navarro</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jarnot</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gruca</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grynberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kajava</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Promponas</surname>
            <given-names>VJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tandem repeats lead to sequence assembly errors and impose multi-level challenges for genome and protein databases</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>21</issue>
        <fpage>10994</fpage>
        <lpage>11006</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz841</pub-id>
        <?supplied-pmid 31584084?>
        <pub-id pub-id-type="pmid">31584084</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolivar-Torres</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Marín-Paredes</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ramos-Madrigal</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Servín-Garcidueñas</surname>
            <given-names>LE</given-names>
          </name>
        </person-group>
        <article-title>Metagenome-assembled genome of acidibrevibacterium fodinaquatile FLA01 from fumarole sediments from the Los Azufres Geothermal Field</article-title>
        <source>Microbiol Resource Announc</source>
        <year>2022</year>
        <volume>11</volume>
        <issue>10</issue>
        <fpage>e00823</fpage>
        <lpage>e1822</lpage>
        <pub-id pub-id-type="doi">10.1128/mra.00823-22</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Tahir J, Crowhurst R, Deroles S, Hilario E, Schaffer R, Le Lievre L, Brendolise C, Chagne D, Gardiner SE, Knaebel M. First chromosome-scale assembly and deep floral-bud transcriptome of a male kiwifruit. Front Genet. 2022;961.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hammond</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Vandervalk</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Kucuk</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gibb</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Pandoh</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kirk</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The North American bullfrog draft genome provides insight into hormonal regulation of long noncoding RNA</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>1433</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-01316-7</pub-id>
        <?supplied-pmid 29127278?>
        <pub-id pub-id-type="pmid">29127278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gold</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Katsuki</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Regulski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ibberson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Holstein</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Steele</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Jacobs</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Greenspan</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>The genome of the jellyfish Aurelia and the evolution of animal complexity</article-title>
        <source>Nat Ecol Evolut</source>
        <year>2019</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>96</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="doi">10.1038/s41559-018-0719-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paulino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Vandervalk</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Raymond</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jackman</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Birol</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Sealer: a scalable gap-closing application for finishing draft genomes</article-title>
        <source>BMC Bioinform</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>230</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0663-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SOAPdenovo2: an empirically improved memory-efficient short-read de novo assembler</article-title>
        <source>Gigascience</source>
        <year>2012</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>18</fpage>
        <pub-id pub-id-type="doi">10.1186/2047-217X-1-18</pub-id>
        <?supplied-pmid 23587118?>
        <pub-id pub-id-type="pmid">23587118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boetzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pirovano</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Toward almost closed genomes with GapFiller</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>6</issue>
        <fpage>R56</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-6-r56</pub-id>
        <?supplied-pmid 22731987?>
        <pub-id pub-id-type="pmid">22731987</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Green P: PHRAP documentation. <ext-link ext-link-type="uri" xlink:href="http://www.phrap.org">http://www.phrap.org</ext-link> (13 September 2022, date last accessed). 1994.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Skiena</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <source>The algorithm design manual</source>
        <year>2008</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Maronna</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Yohai</surname>
            <given-names>VJ</given-names>
          </name>
        </person-group>
        <source>Robust statistics: theory and methods</source>
        <year>2006</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>14</issue>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <?supplied-pmid 19451168?>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Eggert</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A new algorithm for best subsequence alignments with application to tRNA-rRNA comparisons</article-title>
        <source>J Mol Biol</source>
        <year>1987</year>
        <volume>197</volume>
        <issue>4</issue>
        <fpage>723</fpage>
        <lpage>728</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-2836(87)90478-5</pub-id>
        <?supplied-pmid 2448477?>
        <pub-id pub-id-type="pmid">2448477</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Yohai VJ: High breakdown-point and high efficiency robust estimates for regression. Ann Stat 1987;15(2):642–656, 615.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Aftab K, Hartley R. Convergence of iteratively re-weighted least squares to robust M-estimators. In: Proceedings of the 2015 IEEE winter conference on applications of computer vision. IEEE Computer Society 2015: 480–487.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baker</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Jessup</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Manteuffel</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>A technique for accelerating the convergence of restarted GMRES</article-title>
        <source>SIAM J Matrix Anal Appl</source>
        <year>2005</year>
        <volume>26</volume>
        <fpage>962</fpage>
        <lpage>984</lpage>
        <pub-id pub-id-type="doi">10.1137/S0895479803422014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Zimin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Puiu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Magoc</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Treangen</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GAGE: a critical evaluation of genome assemblies and assembly algorithms</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>3</issue>
        <fpage>557</fpage>
        <lpage>567</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.131383.111</pub-id>
        <?supplied-pmid 22147368?>
        <pub-id pub-id-type="pmid">22147368</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gurevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Saveliev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vyahhi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>QUAST: quality assessment tool for genome assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>8</issue>
        <fpage>1072</fpage>
        <lpage>1075</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt086</pub-id>
        <?supplied-pmid 23422339?>
        <pub-id pub-id-type="pmid">23422339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Usdin</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>The biological effects of simple tandem repeats: lessons from the repeat expansion diseases</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <issue>7</issue>
        <fpage>1011</fpage>
        <lpage>1019</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.070409.107</pub-id>
        <?supplied-pmid 18593815?>
        <pub-id pub-id-type="pmid">18593815</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>GT</given-names>
          </name>
        </person-group>
        <article-title>ART: a next-generation sequencing read simulator</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id>
        <?supplied-pmid 22199392?>
        <pub-id pub-id-type="pmid">22199392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benson</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Tandem repeats finder: a program to analyze DNA sequences</article-title>
        <source>Nucleic Acids Res</source>
        <year>1999</year>
        <volume>27</volume>
        <issue>2</issue>
        <fpage>573</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/27.2.573</pub-id>
        <?supplied-pmid 9862982?>
        <pub-id pub-id-type="pmid">9862982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lei</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single mutation underlying phenotypic convergence for hypoxia adaptation on the Qinghai-Tibetan Plateau</article-title>
        <source>Cell Res</source>
        <year>2021</year>
        <volume>31</volume>
        <issue>9</issue>
        <fpage>1032</fpage>
        <lpage>1035</lpage>
        <pub-id pub-id-type="doi">10.1038/s41422-021-00517-6</pub-id>
        <?supplied-pmid 34099886?>
        <pub-id pub-id-type="pmid">34099886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>YT</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>ZZ</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>TZ</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Nevo</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phenotypic and genomic adaptations to the extremely high elevation in plateau zokor (Myospalax baileyi)</article-title>
        <source>Mol Ecol</source>
        <year>2021</year>
        <volume>30</volume>
        <issue>22</issue>
        <fpage>5765</fpage>
        <lpage>5779</lpage>
        <pub-id pub-id-type="doi">10.1111/mec.16174</pub-id>
        <?supplied-pmid 34510615?>
        <pub-id pub-id-type="pmid">34510615</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hunt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kikuchi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sanders</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Newbold</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Berriman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Otto</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <article-title>REAPR: a universal tool for genome assembly evaluation</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>5</issue>
        <fpage>R47</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-5-r47</pub-id>
        <?supplied-pmid 23710727?>
        <pub-id pub-id-type="pmid">23710727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simão</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Waterhouse</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Ioannidis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kriventseva</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Zdobnov</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>BUSCO: assessing genome assembly and annotation completeness with single-copy orthologs</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>19</issue>
        <fpage>3210</fpage>
        <lpage>3212</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv351</pub-id>
        <?supplied-pmid 26059717?>
        <pub-id pub-id-type="pmid">26059717</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>SEME: a fast mapper of Illumina sequencing reads with statistical evaluation</article-title>
        <source>J Comput Biol</source>
        <year>2013</year>
        <volume>20</volume>
        <issue>11</issue>
        <fpage>847</fpage>
        <lpage>860</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2013.0111</pub-id>
        <?supplied-pmid 24195707?>
        <pub-id pub-id-type="pmid">24195707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>BAUM: improving genome assembly by adaptive unique mapping and local overlap-layout-consensus approach</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>12</issue>
        <fpage>2019</fpage>
        <lpage>2028</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty020</pub-id>
        <?supplied-pmid 29346504?>
        <pub-id pub-id-type="pmid">29346504</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaisson</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Mapping single molecule sequencing reads using basic local alignment with successive refinement (BLASR): application and theory</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>238</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-238</pub-id>
        <?supplied-pmid 22988817?>
        <pub-id pub-id-type="pmid">22988817</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>RegScaf: a regression approach to scaffolding</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <issue>10</issue>
        <fpage>2675</fpage>
        <lpage>2682</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac174</pub-id>
        <?supplied-pmid 35561180?>
        <pub-id pub-id-type="pmid">35561180</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10265787</article-id>
    <article-id pub-id-type="pmid">37312038</article-id>
    <article-id pub-id-type="publisher-id">5367</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05367-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>RegCloser: a robust regression approach to closing genome gaps</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Cao</surname>
          <given-names>Shenghao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Li</surname>
          <given-names>Mengtian</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Li</surname>
          <given-names>Lei M.</given-names>
        </name>
        <address>
          <email>lilei@amss.ac.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.9227.e</institution-id><institution-id institution-id-type="ISNI">0000000119573309</institution-id><institution>National Center of Mathematics and Interdisciplinary Sciences, Academy of Mathematics and Systems Science, </institution><institution>Chinese Academy of Sciences, </institution></institution-wrap>Beijing, 100190 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.410726.6</institution-id><institution-id institution-id-type="ISNI">0000 0004 1797 8419</institution-id><institution>University of Chinese Academy of Sciences, </institution></institution-wrap>Beijing, 100049 China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>13</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>249</elocation-id>
    <history>
      <date date-type="received">
        <day>1</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Closing gaps in draft genomes leads to more complete and continuous genome assemblies. The ubiquitous genomic repeats are challenges to the existing gap-closing methods, based on either the k-mer representation by the de Bruijn graph or the overlap-layout-consensus paradigm. Besides, chimeric reads will cause erroneous k-mers in the former and false overlaps of reads in the latter.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We propose a novel local assembly approach to gap closing, called RegCloser. It represents read coordinates and their overlaps respectively by parameters and observations in a linear regression model. The optimal overlap is searched only in the restricted range consistent with insert sizes. Under this linear regression framework, the local DNA assembly becomes a robust parameter estimation problem. We solved the problem by a customized robust regression procedure that resists the influence of false overlaps by optimizing a convex global Huber loss function. The global optimum is obtained by iteratively solving the sparse system of linear equations. On both simulated and real datasets, RegCloser outperformed other popular methods in accurately resolving the copy number of tandem repeats, and achieved superior completeness and contiguity. Applying RegCloser to a plateau zokor draft genome that had been improved by long reads further increased contig N50 to 3-fold long. We also tested the robust regression approach on layout generation of long reads.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">RegCloser is a competitive gap-closing tool. The software is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/csh3/RegCloser">https://github.com/csh3/RegCloser</ext-link>. The robust regression approach has a prospect to be incorporated into the layout module of long read assemblers.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05367-0.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Genome assembly</kwd>
      <kwd>Closing gaps</kwd>
      <kwd>Robust regression</kwd>
      <kwd>Tandem repeat</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Key Research and Development Program of China</institution>
        </funding-source>
        <award-id>2022YFA1004801</award-id>
        <award-id>2022YFA1004801</award-id>
        <award-id>2022YFA1004801</award-id>
        <principal-award-recipient>
          <name>
            <surname>Cao</surname>
            <given-names>Shenghao</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Mengtian</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Lei M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Natural Science Foundation of China</institution>
        </funding-source>
        <award-id>11871462</award-id>
        <award-id>11871462</award-id>
        <award-id>11871462</award-id>
        <principal-award-recipient>
          <name>
            <surname>Cao</surname>
            <given-names>Shenghao</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Mengtian</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Lei M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Strategic Priority Research Program of the Chinese Academy of Sciences</institution>
        </funding-source>
        <award-id>XDB13040600</award-id>
        <award-id>XDB13040600</award-id>
        <award-id>XDB13040600</award-id>
        <principal-award-recipient>
          <name>
            <surname>Cao</surname>
            <given-names>Shenghao</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Mengtian</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Lei M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100019795</institution-id>
            <institution>National Center for Mathematics and Interdisciplinary Sciences, Chinese Academy of Sciences</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Key Laboratory of Systems and Control, Chinese Academy of Sciences</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par4">Closing gaps in draft genomes, as an important step in the de novo assembly pipeline, remains a challenge due to the ubiquitous repetitive elements in genomes. Repetitive elements, as well as chimeric reads, cause ambiguities such as false alignments that disrupt the local assembly in gaps. Particularly, it is very difficult to resolve the copy number of a tandem repeat whenever it occurs [<xref ref-type="bibr" rid="CR1">1</xref>]. Third Generation Sequencing (TGS) technology is expected to resolve the repeat problem if its long reads can span the repeat regions. Nevertheless, many genomes have been or are still sequenced, partially or fully, by Second Generation Sequencing (SGS) technology [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR5">5</xref>], due to its high accuracy, low cost, and wide availability. It is desirable to reconstruct, at least some, regions of repetitive elements by the SGS reads. Notably, the insert size of paired-end or mate-pair reads carries genomic information that can be utilized to facilitate assembly.</p>
    <p id="Par5">Most existing gap-closing methods including Sealer [<xref ref-type="bibr" rid="CR6">6</xref>], GapCloser [<xref ref-type="bibr" rid="CR7">7</xref>], and GapFiller [<xref ref-type="bibr" rid="CR8">8</xref>] are based on the de Bruijn graph (DBG) approach. Although DBG-based methods are computationally efficient, they cut reads into k-mers so that some genomic information in raw reads are lost. In contrast, the overlap-layout-consensus (OLC) approach such as Phrap [<xref ref-type="bibr" rid="CR9">9</xref>] directly aligns the original reads to detect overlaps. But finding a Hamiltonian cycle in the overlap graph is generally NP-complete [<xref ref-type="bibr" rid="CR10">10</xref>], and heuristic algorithms are error-prone to false overlaps caused by either repeats or chimeric reads.</p>
    <p id="Par6">In this paper, we propose a new local assembly approach, referred to as RegCloser, to closing gaps. When it searches overlaps between reads from a gap region, insert-size information is utilized to guide the pairwise alignment to reduce the ambiguities caused by repeats as well as the time complexities. Then, RegCloser adopts a linear regression model to represent the detected overlaps. The motivation is to assign a coordinate axis to the DNA sequence due to its natural linear structure. Thus, read positions on the genome are represented as coordinates to be estimated and overlaps are represented as observations on the read coordinates’ differences.</p>
    <p id="Par7">Under the linear regression framework, the local DNA assembly is formalized as a parameter estimation problem. The estimation can be solved by well-established robust statistical methods [<xref ref-type="bibr" rid="CR11">11</xref>]. In RegCloser, we customize a two-step robust regression procedure. In Step 1, it finds the read locations and detects false overlaps simultaneously by computing a robust M-estimate, which minimizes the Huber loss function. The loss function is convex so that its global optimum can be achieved by an iterative algorithm. Each iteration is to solve a sparse system of linear equations. In the M-estimation, the influence function of any outlier is bounded. In Step 2, RegCloser eliminates the influences of the false overlaps by a trimmed least squares estimate.</p>
    <p id="Par8">We will illustrate how RegCloser resolves tandem repeats by a real data example. Tests on simulated and real sequence data show that RegCloser outperforms several other popular gap-closing methods, especially in the presence of tandem repeats. Its applicability to TGS data is shown as well.</p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Overview of RegCloser</title>
      <p id="Par9">The scheme of RegCloser is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. RegCloser starts off by mapping input reads, SGS paired-end or mate-pair reads, onto the draft genome. Then, it collects reads from each gap region (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a), and performs local assembly to close gaps (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b–e). RegCloser tackles the problem of false overlaps resulted from repeats or chimeric reads by two key ideas. First, in the context of gap closing, each read from the gap region has a prior genomic position inferred from the insert size. Rather than an all-against-all pairwise alignment, RegCloser utilizes the prior positions to guide pairwise alignment (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b) for overlap detection. In this way, false overlaps in the collecting step are substantially reduced. Second, RegCloser adopts a robust regression approach to estimate the reads’ genomic positions, which can detect the remaining false overlaps and eliminate their influences (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c, d). Then, the reads are placed at their estimated positions in the gap, resulting in a multiple sequence alignment on which the consensus sequence in the gap is determined (Fig. <xref rid="Fig1" ref-type="fig">1</xref>e).<fig id="Fig1"><label>Fig. 1</label><caption><p>Pipeline of RegCloser. <bold>a</bold> Align the input paired-end or mate-pair reads onto the draft genome, and collect the reads falling in the gap regions. <bold>b</bold> An illustrative example of insert-size guided pairwise alignment for overlap detection in a gap containing a triple tandem repeat ‘GAACCCT’. First, on the axis corresponding to the DNA sequence in the gap, the collected reads are placed at their prior positions, which are inferred from their mate position and the insert size. The prior positions of reads ④ and ⑤ are 11 and 16. Notably, two pseudo reads, ① and ⑨, generated from the contig ends flanking the gap are added. Then, a pair of reads are aligned only when their prior positions are close, taking into account the variation of insert sizes. If an alignment is statistically significant, it is marked by yellow parallel lines between bases as well as by double-headed arrows between reads. The tandem repeat causes a false overlap between reads ④ and ⑥, as indicated by the red double-headed arrow, resulting in an outlier in the latter regression model. The repeat also leads to two different significant alignments between reads ④ and ⑤, respectively marked by the yellow solid and dotted lines. In this case, RegCloser will select the alignment more compatible with the prior positions (solid line), rather than the highest-scoring one (dotted line). <bold>c</bold> The linear regression model of genome assembly. The reads’ real positions on the gap axis are represented as parameters <inline-formula id="IEq106"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}\ (1\le i\le n)$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mspace width="4pt"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq106.gif"/></alternatives></inline-formula> to be estimated. Each detected overlap between reads <inline-formula id="IEq107"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M4"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq107.gif"/></alternatives></inline-formula> and <inline-formula id="IEq108"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M6"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq108.gif"/></alternatives></inline-formula> provides an observation on the difference between <inline-formula id="IEq109"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq109.gif"/></alternatives></inline-formula> and <inline-formula id="IEq110"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{j}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq110.gif"/></alternatives></inline-formula>: <inline-formula id="IEq111"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}^{(i,j)}={\beta }_{j}-{\beta }_{i}+{\varepsilon }^{(i,j)}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq111.gif"/></alternatives></inline-formula>. <inline-formula id="IEq112"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varepsilon }^{(i,j)}$$\end{document}</tex-math><mml:math id="M14"><mml:msup><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq112.gif"/></alternatives></inline-formula> is the observational error, which is normally caused by sequencing errors on the DNA fragment between <inline-formula id="IEq113"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq113.gif"/></alternatives></inline-formula> and <inline-formula id="IEq114"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{j}$$\end{document}</tex-math><mml:math id="M18"><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq114.gif"/></alternatives></inline-formula>. False overlaps cause outliers, which have abnormally large <inline-formula id="IEq115"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{\varepsilon }^{\left(i,j\right)}|$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq115.gif"/></alternatives></inline-formula>. All the observations in a gap are integrated into the matrix form <inline-formula id="IEq116"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Y}}={\varvec{X}}{\varvec{\beta}}+{\varvec{\varepsilon}}$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq116.gif"/></alternatives></inline-formula>. <bold>d</bold> A two-step robust regression estimation of the model parameters. <inline-formula id="IEq117"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rho }_{H}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>H</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq117.gif"/></alternatives></inline-formula> is the Huber loss function. <inline-formula id="IEq118"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${I}_{o}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>I</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq118.gif"/></alternatives></inline-formula> is the index set of observations with large residuals and identified as potential outliers. <bold>e</bold> Generate multiple sequence alignment of the collected reads by their estimated positions, and determine the gap sequence as the consensus between the two pseudo reads ① and ⑨. As a result, the triple tandem repeat is recovered by RegCloser</p></caption><graphic xlink:href="12859_2023_5367_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Preprocessing</title>
      <p id="Par10">In the preprocessing stage, RegCloser first maps paired sequencing reads onto the draft genome using BWA [<xref ref-type="bibr" rid="CR12">12</xref>]. Then, the mapped positions of the paired reads on adjacent contigs are used to estimate gap sizes. Next, RegCloser collects reads that are inferred to originate from the gap regions (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a), and estimates their prior positions in the gap by the insert size. Specifically, let <inline-formula id="IEq1"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu$$\end{document}</tex-math><mml:math id="M28"><mml:mi>μ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq1.gif"/></alternatives></inline-formula> and <inline-formula id="IEq2"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v$$\end{document}</tex-math><mml:math id="M30"><mml:mi>v</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq2.gif"/></alternatives></inline-formula> be respectively the mean and standard deviation of the library insert size. For a read pair, if the left (respectively right) read is uniquely mapped within <inline-formula id="IEq3"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu +3v$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>+</mml:mo><mml:mn>3</mml:mn><mml:mi>v</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq3.gif"/></alternatives></inline-formula> bases from the left (respectively right) breakpoint of a gap, the mate read is inferred to come from the gap region with high confidence and is thus collected. In what follows, RegCloser assembles the collected reads from each gap in parallel.</p>
    </sec>
    <sec id="Sec5">
      <title>Overlap detection by insert-size guided pairwise alignment</title>
      <p id="Par11">We first set a coordinate axis along the gap from left to right, and the left breakpoint of the gap is defined as the origin (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, c). Then we represent the genomic position of read <inline-formula id="IEq4"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{i}$$\end{document}</tex-math><mml:math id="M34"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq4.gif"/></alternatives></inline-formula> (<inline-formula id="IEq5"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le i\le n$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq5.gif"/></alternatives></inline-formula>) by the coordinate of its ending base, denoted by <inline-formula id="IEq6"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq6.gif"/></alternatives></inline-formula>. Although the true value of <inline-formula id="IEq7"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq7.gif"/></alternatives></inline-formula> is an unknown parameter, its prior genomic position, denoted by <inline-formula id="IEq8"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{i}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq8.gif"/></alternatives></inline-formula>, can be inferred from the insert size and the mapping position of the mate read on the flanking contig (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). The prior genomic positions guide the pairwise alignment to obtain more accurate and efficient overlap detection (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b) in two aspects:</p>
      <p id="Par12">(i) RegCloser aligns two reads <inline-formula id="IEq9"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{i}$$\end{document}</tex-math><mml:math id="M44"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq9.gif"/></alternatives></inline-formula> and <inline-formula id="IEq10"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{j}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq10.gif"/></alternatives></inline-formula> only if their prior genomic positions are close to each other, i.e., <inline-formula id="IEq11"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{p}_{i}-{p}_{j}|&lt;\Delta d$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq11.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq12"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta d$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq12.gif"/></alternatives></inline-formula> is a threshold depending on the standard deviation of the insert size (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S1). By choosing an appropriate <inline-formula id="IEq13"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta d$$\end{document}</tex-math><mml:math id="M52"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq13.gif"/></alternatives></inline-formula>, we not only avoid false overlaps between reads that come from distant regions on the genome, but also reduce the time complexity of pairwise alignments from quadratic to linear (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S2). In the illustrative example shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, where reads ①–⑨ are placed along the gap axis at their prior genomic positions, we set <inline-formula id="IEq14"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\Delta d=11$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>11</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq14.gif"/></alternatives></inline-formula>. That is, two reads are aligned only if their prior genomic positions are within a distance of 11 bp. Consequently, the false overlap “AACCC” between reads ② and ⑦ is avoided, and the total number of pairwise alignments is reduced to 14 from 36, which is required by the all-against-all strategy.</p>
      <p id="Par13">(ii) Two overlapping reads may have more than one significant alignment, particularly when they come from tandem repeats. RegCloser implements an extended Smith &amp; Waterman algorithm [<xref ref-type="bibr" rid="CR13">13</xref>] to find all the significant overlap patterns between two reads, and selects the one most compatible with the reads’ prior genomic positions. In the example shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, the two reads ④ and ⑤ actually come from a triple tandem repeat and can be aligned in two ways. RegCloser selects the correct alignment indicated by the solid line, which is closer to the relative position of <inline-formula id="IEq15"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{4}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>p</mml:mi><mml:mn>4</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq15.gif"/></alternatives></inline-formula> and <inline-formula id="IEq16"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${p}_{5}$$\end{document}</tex-math><mml:math id="M58"><mml:msub><mml:mi>p</mml:mi><mml:mn>5</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq16.gif"/></alternatives></inline-formula>, rather than the dotted one, even though it has a higher alignment score.</p>
      <p id="Par14">A real example in “Section <xref rid="Sec12" ref-type="sec">RegCloser’s rationale of resolving the tandem repeat</xref>” will show that the above insert-size guided pairwise alignment indeed greatly reduces false overlaps.</p>
    </sec>
    <sec id="Sec6">
      <title>Representation of detected overlaps by linear regression model</title>
      <p id="Par15">In the coordinate axis along the gap, we aim to solve the true values of the reads’ genomic positions, <inline-formula id="IEq17"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M60"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq17.gif"/></alternatives></inline-formula> (<inline-formula id="IEq18"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le i\le n$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq18.gif"/></alternatives></inline-formula>), to form a layout. If a pair of reads <inline-formula id="IEq19"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{i}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq19.gif"/></alternatives></inline-formula> and <inline-formula id="IEq20"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{j}$$\end{document}</tex-math><mml:math id="M66"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq20.gif"/></alternatives></inline-formula> overlap, the alignment provides an observation on the difference of <inline-formula id="IEq21"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M68"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq21.gif"/></alternatives></inline-formula> and <inline-formula id="IEq22"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{j}$$\end{document}</tex-math><mml:math id="M70"><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq22.gif"/></alternatives></inline-formula>. Denote the observed genomic distance from <inline-formula id="IEq23"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{i}$$\end{document}</tex-math><mml:math id="M72"><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq23.gif"/></alternatives></inline-formula> to <inline-formula id="IEq24"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{j}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>r</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq24.gif"/></alternatives></inline-formula> as <inline-formula id="IEq25"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}^{\left(i,j\right)}$$\end{document}</tex-math><mml:math id="M76"><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq25.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c), then<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y^{{\left( {i,j} \right)}} = \beta_{j} - \beta_{i} + \varepsilon^{{\left( {i,j} \right)}} ,$$\end{document}</tex-math><mml:math id="M78" display="block"><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mi>ε</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq26"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varepsilon }^{(i,j)}$$\end{document}</tex-math><mml:math id="M80"><mml:msup><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq26.gif"/></alternatives></inline-formula> denotes the observational error. In normal cases, <inline-formula id="IEq27"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\{{\varepsilon }^{\left(i,j\right)}\}$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq27.gif"/></alternatives></inline-formula> are the random errors caused by sequencing, and are mostly zeros for Illumina short reads (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S3). In the case of a false overlap, <inline-formula id="IEq28"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|{\varepsilon }^{\left(i,j\right)}|$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi>ε</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mfenced></mml:msup><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq28.gif"/></alternatives></inline-formula> will be abnormally large, and the observation will be regarded as an outlier (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). For example, reads ④ and ⑥ in Fig. <xref rid="Fig1" ref-type="fig">1</xref>e come from different repeat units, so a false overlap is detected between them, causing an outlier marked by the red double-headed arrow in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b.</p>
      <p id="Par16">Supposing totally <inline-formula id="IEq29"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M86"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq29.gif"/></alternatives></inline-formula> overlaps are detected in the gap, we integrate them into one linear regression model in the matrix form as below,<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Y}} = \user2{X\beta } + {\varvec{\varepsilon}} = \left( {\begin{array}{*{20}c} {\begin{array}{*{20}c} {{\varvec{x}}_{1}^{T} } \\ {{\varvec{x}}_{2}^{T} } \\ \end{array} } \\ {\begin{array}{*{20}c} \vdots \\ {{\varvec{x}}_{{\varvec{m}}}^{T} } \\ \end{array} } \\ \end{array} } \right){\varvec{\beta}} + {\varvec{\varepsilon}},$$\end{document}</tex-math><mml:math id="M88" display="block"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq30"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta}}={({\beta }_{1}, {\beta }_{2}, \cdots , {\beta }_{n})}^{T}$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq30.gif"/></alternatives></inline-formula> denotes the vector of reads’ genomic positions; <inline-formula id="IEq31"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}={({{\varvec{x}}}_{1}, {{\varvec{x}}}_{2}, \cdots , {{\varvec{x}}}_{{\varvec{m}}})}^{T}\in {\mathbb{R}}^{m\times n}$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq31.gif"/></alternatives></inline-formula> denotes the design matrix, which is sparse as illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>c; each row of <inline-formula id="IEq32"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq32.gif"/></alternatives></inline-formula> has only two non-zero elements, − 1 and 1, which are signed indicators of two overlapping reads. The corresponding term in <inline-formula id="IEq33"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Y}}$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq33.gif"/></alternatives></inline-formula> represents their genomic distance’s observation obtained from a detected overlap as in (<xref rid="Equ1" ref-type="disp-formula">1</xref>); <inline-formula id="IEq34"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Y}}={({y}_{1}, {y}_{2}, \cdots , {y}_{m})}^{T}$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq34.gif"/></alternatives></inline-formula> denotes the vector of all the observed genomic distances. Our aim is to estimate the reads’ genomic positions <inline-formula id="IEq35"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta}}$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq35.gif"/></alternatives></inline-formula> in the linear regression model.</p>
      <p id="Par17">Note that the design matrix <inline-formula id="IEq36"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq36.gif"/></alternatives></inline-formula> in (<xref rid="Equ2" ref-type="disp-formula">2</xref>) is actually the oriented incidence matrix of the overlap graph, where each read corresponds to a vertex and each overlap creates a directed edge connecting two vertices. The overlap graph may have multiple weakly connected components, each of which corresponds to one contig. Accordingly, we can re-arrange the rows and columns of <inline-formula id="IEq37"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq37.gif"/></alternatives></inline-formula> in (<xref rid="Equ2" ref-type="disp-formula">2</xref>) so that it takes a block-diagonal form as below,<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left( {\begin{array}{*{20}c} {\begin{array}{*{20}c} {\begin{array}{*{20}c} {\begin{array}{*{20}c} {{\varvec{X}}^{\left[ 1 \right]} } \\ 0 \\ \end{array} } \\ {\begin{array}{*{20}c} \vdots \\ 0 \\ \end{array} } \\ \end{array} } &amp; {\begin{array}{*{20}c} {\begin{array}{*{20}c} 0 \\ {{\varvec{X}}^{\left[ 2 \right]} } \\ \end{array} } \\ {\begin{array}{*{20}c} \vdots \\ 0 \\ \end{array} } \\ \end{array} } \\ \end{array} } &amp; {\begin{array}{*{20}c} {\begin{array}{*{20}c} {\begin{array}{*{20}c} \cdots \\ \cdots \\ \end{array} } \\ {\begin{array}{*{20}c} \ddots \\ \cdots \\ \end{array} } \\ \end{array} } &amp; {\begin{array}{*{20}c} {\begin{array}{*{20}c} 0 \\ 0 \\ \end{array} } \\ {\begin{array}{*{20}c} \vdots \\ {{\varvec{X}}^{{\left[ {\varvec{s}} \right]}} } \\ \end{array} } \\ \end{array} } \\ \end{array} } \\ \end{array} } \right),$$\end{document}</tex-math><mml:math id="M106" display="block"><mml:mrow><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>1</mml:mn></mml:mfenced></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>2</mml:mn></mml:mfenced></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>⋯</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mo>⋯</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:mfenced></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where all the blocks except the principal diagonal are zero matrices (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S4). Each diagonal submatrix <inline-formula id="IEq38"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{X}}}^{[{\varvec{i}}]}\in {\mathbb{R}}^{{m}_{i}\times {n}_{i}}$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq38.gif"/></alternatives></inline-formula> (<inline-formula id="IEq39"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le i\le s$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq39.gif"/></alternatives></inline-formula>, <inline-formula id="IEq40"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum_{i=1}^{s}{m}_{i}=m$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq40.gif"/></alternatives></inline-formula>, <inline-formula id="IEq41"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sum_{i=1}^{s}{n}_{i}=n$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq41.gif"/></alternatives></inline-formula>) is the oriented incidence matrix of one weakly connected component, and <inline-formula id="IEq42"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{rank}({{\varvec{X}}}^{[{\varvec{i}}]}){=n}_{i}-1$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi mathvariant="normal">rank</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq42.gif"/></alternatives></inline-formula>. Next, we can re-arrange the rows of <inline-formula id="IEq43"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta}}$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq43.gif"/></alternatives></inline-formula>, <inline-formula id="IEq44"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Y}}$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq44.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq45"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\varepsilon}}$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq45.gif"/></alternatives></inline-formula> in (<xref rid="Equ2" ref-type="disp-formula">2</xref>) in accordance with that in <inline-formula id="IEq46"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq46.gif"/></alternatives></inline-formula>. Consequently, model (<xref rid="Equ2" ref-type="disp-formula">2</xref>) is decomposed into <inline-formula id="IEq47"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M126"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq47.gif"/></alternatives></inline-formula> sub-models, i.e.,<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left\{ {\begin{array}{*{20}c} {\begin{array}{*{20}c} {{\varvec{Y}}^{\left[ 1 \right]} = {\varvec{X}}^{\left[ 1 \right]} {\varvec{\beta}}^{\left[ 1 \right]} + {\varvec{\varepsilon}}^{\left[ 1 \right]} } \\ {{\varvec{Y}}^{\left[ 2 \right]} = {\varvec{X}}^{\left[ 2 \right]} {\varvec{\beta}}^{\left[ 2 \right]} + {\varvec{\varepsilon}}^{\left[ 2 \right]} } \\ \end{array} } \\ {\begin{array}{*{20}c} \vdots \\ {{\varvec{Y}}^{{\left[ {\varvec{s}} \right]}} = {\varvec{X}}^{{\left[ {\varvec{s}} \right]}} {\varvec{\beta}}^{{\left[ {\varvec{s}} \right]}} + {\varvec{\varepsilon}}^{{\left[ {\varvec{s}} \right]}} } \\ \end{array} } \\ \end{array} } \right.,$$\end{document}</tex-math><mml:math id="M128" display="block"><mml:mrow><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>1</mml:mn></mml:mfenced></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>1</mml:mn></mml:mfenced></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>1</mml:mn></mml:mfenced></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>1</mml:mn></mml:mfenced></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>2</mml:mn></mml:mfenced></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>2</mml:mn></mml:mfenced></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>2</mml:mn></mml:mfenced></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mn>2</mml:mn></mml:mfenced></mml:msup></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:mfenced></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:mfenced></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:mfenced></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi></mml:mrow></mml:mfenced></mml:msup></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq48"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\beta}}}^{[{\varvec{i}}]}\in {\mathbb{R}}^{{n}_{i}\times 1}$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq48.gif"/></alternatives></inline-formula>, <inline-formula id="IEq49"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{Y}}}^{[{\varvec{i}}]}\in {\mathbb{R}}^{{m}_{i}\times 1}$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq49.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq50"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\varepsilon}}}^{[{\varvec{i}}]}\in {\mathbb{R}}^{{m}_{i}\times 1}$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq50.gif"/></alternatives></inline-formula>.</p>
      <p id="Par18">Each sub-model <inline-formula id="IEq51"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{Y}}}^{[{\varvec{i}}]}={{\varvec{X}}}^{[{\varvec{i}}]}{{\varvec{\beta}}}^{[{\varvec{i}}]}+{{\varvec{\varepsilon}}}^{[{\varvec{i}}]}$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq51.gif"/></alternatives></inline-formula> in (<xref rid="Equ4" ref-type="disp-formula">4</xref>) represents one weakly connected component, i.e., one contig, and the vector <inline-formula id="IEq52"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\beta}}}^{[{\varvec{i}}]}$$\end{document}</tex-math><mml:math id="M138"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq52.gif"/></alternatives></inline-formula> denotes the genomic positions of the reads in this contig. Since <inline-formula id="IEq53"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{X}}}^{[{\varvec{i}}]}$$\end{document}</tex-math><mml:math id="M140"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq53.gif"/></alternatives></inline-formula> is not full-rank in column, namely, <inline-formula id="IEq54"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{rank}({{\varvec{X}}}^{[{\varvec{i}}]}){=n}_{i}-1&lt;{n}_{i}$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mi mathvariant="normal">rank</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo>=</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq54.gif"/></alternatives></inline-formula>, we can only estimate the parameters <inline-formula id="IEq55"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\beta}}}^{[{\varvec{i}}]}$$\end{document}</tex-math><mml:math id="M144"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq55.gif"/></alternatives></inline-formula> in the sub-model up to a shift. Although the relative positions of reads are sufficient to determine a layout uniquely, technically we add an initial position of one read to each sub-model to make <inline-formula id="IEq56"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{X}}}^{[{\varvec{i}}]}$$\end{document}</tex-math><mml:math id="M146"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq56.gif"/></alternatives></inline-formula> full-rank in column so that <inline-formula id="IEq57"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\beta}}}^{[{\varvec{i}}]}$$\end{document}</tex-math><mml:math id="M148"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq57.gif"/></alternatives></inline-formula> is identifiable (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S4).</p>
      <p id="Par19">Estimating <inline-formula id="IEq58"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta}}$$\end{document}</tex-math><mml:math id="M150"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq58.gif"/></alternatives></inline-formula> in (<xref rid="Equ2" ref-type="disp-formula">2</xref>) is equivalent to respectively estimating <inline-formula id="IEq59"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{\beta}}}^{[{\varvec{i}}]}$$\end{document}</tex-math><mml:math id="M152"><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq59.gif"/></alternatives></inline-formula>(<inline-formula id="IEq60"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le i\le s$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq60.gif"/></alternatives></inline-formula>) in (<xref rid="Equ4" ref-type="disp-formula">4</xref>). Hence without loss of generality, we suppose the linear model (<xref rid="Equ2" ref-type="disp-formula">2</xref>) represents one contig and the design matrix <inline-formula id="IEq61"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq61.gif"/></alternatives></inline-formula> is full-rank in column hereafter.</p>
      <p id="Par20">It is noted that the presentation (<xref rid="Equ3" ref-type="disp-formula">3</xref>) and (<xref rid="Equ4" ref-type="disp-formula">4</xref>) is for the sake of rigorous mathematical formulation. In practice, as shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>b, the two pseudo reads that are cut from the flanking sequences of a gap were incorporated into overlap detection and the linear model (<xref rid="Equ2" ref-type="disp-formula">2</xref>). Consequently, we only need to consider the typical scenarios shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2. First, if the two pseudo reads are contained in one component, then the gap is filled and other floating contigs are skipped. Second, if the two pseudo reads are in two components that cannot be connected, then each flanking contig is extended by the corresponding regression component. Contigs generated from regression components other than these two major ones could be from the unfilled gap, or from elsewhere due to uncertain factors such as incorrect read mapping. In the current implementation, we leave them out for the sake of reliability.</p>
    </sec>
    <sec id="Sec7">
      <title>Estimation of the reads’ genomic positions by a two-step robust regression procedure</title>
      <p id="Par21">Although the false overlaps are significantly reduced by imposing constraint on pairwise alignment, a fraction of outliers may still exist, and even a single outlier can break down the ordinary least squares (OLS) estimate [<xref ref-type="bibr" rid="CR14">14</xref>]. Thus, RegCloser adopts a two-step robust regression procedure (Fig. <xref rid="Fig1" ref-type="fig">1</xref>d) to estimate the parameters <inline-formula id="IEq62"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta}}$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq62.gif"/></alternatives></inline-formula> in (<xref rid="Equ2" ref-type="disp-formula">2</xref>). Note that we first relax <inline-formula id="IEq63"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{\beta}}$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq63.gif"/></alternatives></inline-formula> from integers to be continuous values.</p>
      <p id="Par22"><bold>Step 1:</bold> RegCloser detects outliers using the robust M-estimate [<xref ref-type="bibr" rid="CR11">11</xref>]. That is, minimize the sum of a loss function over all observations as below,<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\user2{\beta}}^{M} = \arg \mathop {\min }\limits_{{\varvec{\beta}}} \mathop \sum \limits_{i = 1}^{m} \rho \left( {\varepsilon_{i} } \right) = \arg \mathop {\min }\limits_{{\varvec{\beta}}} \mathop \sum \limits_{i = 1}^{m} \rho \left( {y_{i} - {\varvec{x}}_{{\varvec{i}}}^{T} {\varvec{\beta}}} \right).$$\end{document}</tex-math><mml:math id="M162" display="block"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo>arg</mml:mo><mml:munder><mml:mo movablelimits="false">min</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>ε</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mo>arg</mml:mo><mml:munder><mml:mo movablelimits="false">min</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mi>ρ</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq64"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho (\bullet )$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>∙</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq64.gif"/></alternatives></inline-formula> takes the Huber loss function,<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\rho_{H} \left( \varepsilon \right) = \left\{ {\begin{array}{*{20}c} {\varepsilon^{2} /2} \\ {c\left| \varepsilon \right| - c^{2} /2} \\ \end{array} } \right.{ }\begin{array}{*{20}c} {\left| \varepsilon \right| \le c} \\ {\left| \varepsilon \right| &gt; c} \\ \end{array} .$$\end{document}</tex-math><mml:math id="M166" display="block"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>ε</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>ε</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mi>c</mml:mi><mml:mfenced close="|" open="|"><mml:mi>ε</mml:mi></mml:mfenced><mml:mo>-</mml:mo><mml:msup><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow/><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfenced close="|" open="|"><mml:mi>ε</mml:mi></mml:mfenced><mml:mo>≤</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mfenced close="|" open="|"><mml:mi>ε</mml:mi></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par23">It is noted <inline-formula id="IEq65"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rho }_{H}\left(\varepsilon \right)$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>ε</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq65.gif"/></alternatives></inline-formula> equals to the loss of squares when the observational error is small (<inline-formula id="IEq66"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$|\varepsilon |\le c$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>ε</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>≤</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq66.gif"/></alternatives></inline-formula>). But for large errors, <inline-formula id="IEq67"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\rho }_{H}\left(\varepsilon \right)$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>ε</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq67.gif"/></alternatives></inline-formula> takes absolute error loss instead (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a) to avoid being overly influenced by the outliers. The value <inline-formula id="IEq68"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M174"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq68.gif"/></alternatives></inline-formula> in (<xref rid="Equ6" ref-type="disp-formula">6</xref>) is a tuning constant balancing robustness and statistical efficiency. Smaller values of <inline-formula id="IEq69"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M176"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq69.gif"/></alternatives></inline-formula> produce more resistance to outliers, but at the expense of larger variance of the estimate [<xref ref-type="bibr" rid="CR11">11</xref>]. It is set to 2 by default in RegCloser.<fig id="Fig2"><label>Fig. 2</label><caption><p>IRLS algorithm for computing the robust M-estimate. <bold>a</bold> The Huber loss function used in the M-estimation. Since it is convex, any local optimum is global. <bold>b</bold> The Huber <inline-formula id="IEq119"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\psi$$\end{document}</tex-math><mml:math id="M178"><mml:mi>ψ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq119.gif"/></alternatives></inline-formula>-function, namely, the derivative of the Huber loss function. It shows the influence of any outlier is bounded. <bold>c</bold> The Huber weight function. Beyond a threshold, the weight of an observation drops gradually as the error goes to large. <bold>d</bold> Pseudocode of the iteratively reweighted least squares (IRLS) algorithm. The inputs comprise the design matrix <inline-formula id="IEq120"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}$$\end{document}</tex-math><mml:math id="M180"><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq120.gif"/></alternatives></inline-formula>, response vector <inline-formula id="IEq121"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Y}}$$\end{document}</tex-math><mml:math id="M182"><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq121.gif"/></alternatives></inline-formula> of the linear regression model, the tuning constant <inline-formula id="IEq122"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M184"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq122.gif"/></alternatives></inline-formula>, the convergence threshold <inline-formula id="IEq123"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M186"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq123.gif"/></alternatives></inline-formula>, and the iteration limit <inline-formula id="IEq124"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M188"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq124.gif"/></alternatives></inline-formula>. The output is the robust M-estimate of the model parameters, which minimizes the Huber loss function</p></caption><graphic xlink:href="12859_2023_5367_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par24">The robustness of the M-estimate can be quantified by the influence function (IF), which measures the effect of infinitesimal perturbation of one data point on the estimate [<xref ref-type="bibr" rid="CR11">11</xref>]. The influence function of the M-estimate (<xref rid="Equ5" ref-type="disp-formula">5</xref>) at an observation <inline-formula id="IEq70"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$({{\varvec{x}}}_{0},{y}_{0})$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq70.gif"/></alternatives></inline-formula> is given by<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{IF}}\left( {{\varvec{x}}_{0} ,y_{0} } \right) = \left( {\frac{{\psi_{H} \left( {y_{0} - {\varvec{x}}_{0}^{T} {\varvec{\beta}}} \right)}}{{{\text{E}}[\psi_{H}^{^{\prime}} \left( \varepsilon \right)]}}} \right)\left( {{\text{E}}\left[ {{\varvec{xx}}^{T} } \right]^{{.^{ - 1} }} {\varvec{x}}_{0} }\right),$$\end{document}</tex-math><mml:math id="M192" display="block"><mml:mrow><mml:mtext>IF</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mtext>E</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mfenced close=")" open="("><mml:mi>ε</mml:mi></mml:mfenced><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mfrac></mml:mfenced><mml:mfenced close=")" open="("><mml:mrow><mml:mtext>E</mml:mtext><mml:msup><mml:mfenced close="]" open="["><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">xx</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mfenced><mml:msup><mml:mo>.</mml:mo><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq71"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\psi }_{H}(\bullet )$$\end{document}</tex-math><mml:math id="M194"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∙</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq71.gif"/></alternatives></inline-formula> is the derivative of the Huber loss function (<xref rid="Equ6" ref-type="disp-formula">6</xref>). The first factor of (<xref rid="Equ7" ref-type="disp-formula">7</xref>) measures the influence from the <italic>y</italic>-direction, and it is bounded since <inline-formula id="IEq72"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\psi }_{H}(\bullet )$$\end{document}</tex-math><mml:math id="M196"><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∙</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq72.gif"/></alternatives></inline-formula> is bounded (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). The second factor of (<xref rid="Equ7" ref-type="disp-formula">7</xref>) measures the influence from the <inline-formula id="IEq73"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{x}}$$\end{document}</tex-math><mml:math id="M198"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq73.gif"/></alternatives></inline-formula>-direction, and it is also bounded since <inline-formula id="IEq74"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{x}}}_{0}$$\end{document}</tex-math><mml:math id="M200"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq74.gif"/></alternatives></inline-formula> only consists of 0 and <inline-formula id="IEq75"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pm 1$$\end{document}</tex-math><mml:math id="M202"><mml:mrow><mml:mo>±</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq75.gif"/></alternatives></inline-formula>. Putting together, the influence function (<xref rid="Equ7" ref-type="disp-formula">7</xref>) is bounded so that any outlier would not deviate the estimate from the true values much.</p>
      <p id="Par25">Yet we can further improve the accuracy of estimate by completely excluding the outliers. Denote the observations with large residuals by<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I_{o} = \{ i:\left| {y_{i} - {\varvec{x}}_{{\varvec{i}}}^{T} \hat{\user2{\beta }}^{M} } \right| &gt; r_{o} \} ,$$\end{document}</tex-math><mml:math id="M204" display="block"><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mfenced close="|" open="|"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>M</mml:mi></mml:msup></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>and they are identified as potential outliers. The value <inline-formula id="IEq76"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{o}$$\end{document}</tex-math><mml:math id="M206"><mml:msub><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq76.gif"/></alternatives></inline-formula> in (<xref rid="Equ8" ref-type="disp-formula">8</xref>) is the residual threshold with a default value 10. A smaller value of <inline-formula id="IEq77"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${r}_{o}$$\end{document}</tex-math><mml:math id="M208"><mml:msub><mml:mi>r</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq77.gif"/></alternatives></inline-formula> gives more protection on robustness at the risk of losing some contiguity of the assembly.</p>
      <p id="Par26"><bold>Step 2:</bold> RegCloser solves the OLS estimate on the observations excluding the potential outliers, i.e.,<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hat{\user2{\beta }} = \arg \mathop {\min }\limits_{{\varvec{\beta}}} \mathop \sum \limits_{{i \notin I_{o} }} \left( {y_{i} - {\varvec{x}}_{{\varvec{i}}}^{T} {\varvec{\beta}}} \right)^{2} .$$\end{document}</tex-math><mml:math id="M210" display="block"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>arg</mml:mo><mml:munder><mml:mo movablelimits="false">min</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:munder><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∉</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:munder><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par27">Note that one contig may be further decomposed into several contigs after excluding the potential outliers. We deal with each contig separately as described in “Section <xref rid="Sec6" ref-type="sec">Representation of detected overlaps by linear regression model</xref>”. Finally, RegCloser obtains the estimated genomic positions of reads by rounding off <inline-formula id="IEq78"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{\beta }}_{i}$$\end{document}</tex-math><mml:math id="M212"><mml:msub><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq78.gif"/></alternatives></inline-formula> (<inline-formula id="IEq79"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\le i\le n$$\end{document}</tex-math><mml:math id="M214"><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>i</mml:mi><mml:mo>≤</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq79.gif"/></alternatives></inline-formula>) to the nearest integers. Placing the reads at their estimated positions on the coordinate axis forms a layout. In “Section <xref rid="Sec12" ref-type="sec">RegCloser’s rationale of resolving the tandem repeat</xref>”, a real example will show the superiority of the two-step robust regression procedure over the direct OLS regression in terms of the layout quality.</p>
    </sec>
    <sec id="Sec8">
      <title>Solving the robust M-estimate by an iteratively reweighted least squares (IRLS) algorithm</title>
      <p id="Par28">In Step 1 of the two-step robust regression, an IRLS algorithm (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d) is used to solve the robust M-estimate, i.e., the minimum of the objective function in (<xref rid="Equ5" ref-type="disp-formula">5</xref>). The IRLS algorithm starts with an initial estimate <inline-formula id="IEq80"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{{\varvec{\beta}}}}^{(0)}$$\end{document}</tex-math><mml:math id="M216"><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq80.gif"/></alternatives></inline-formula>, such as the OLS estimate. Then it iteratively computes the weighted least squares (WLS) estimate as follows,<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{{\varvec{\beta}}}}^{(k+1)}=\mathrm{arg}\underset{{\varvec{\beta}}}{\mathrm{min}}\sum_{i=1}^{m}{w}_{i}^{(k+1)}{\left({y}_{i}-{{\varvec{x}}}_{{\varvec{i}}}^{T}{\varvec{\beta}}\right)}^{2},$$\end{document}</tex-math><mml:math id="M218" display="block"><mml:mrow><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">arg</mml:mi><mml:munder><mml:mi mathvariant="normal">min</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:munder><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula>until <inline-formula id="IEq81"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\parallel {\hat{{\varvec{\beta}}}}^{\left(k+1\right)}-{\hat{{\varvec{\beta}}}}^{(k)}\parallel }_{\infty }&lt;\alpha$$\end{document}</tex-math><mml:math id="M220"><mml:mrow><mml:msub><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mfenced close=")" open="("><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:msup><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mi>∞</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq81.gif"/></alternatives></inline-formula> (<inline-formula id="IEq82"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =2$$\end{document}</tex-math><mml:math id="M222"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq82.gif"/></alternatives></inline-formula> by default), where <inline-formula id="IEq83"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\parallel \bullet \parallel }_{\infty }$$\end{document}</tex-math><mml:math id="M224"><mml:msub><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mo>∙</mml:mo><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mi>∞</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq83.gif"/></alternatives></inline-formula> denotes the infinite norm. <inline-formula id="IEq84"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{i}^{(k+1)}$$\end{document}</tex-math><mml:math id="M226"><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq84.gif"/></alternatives></inline-formula> is the weight assigned to the <inline-formula id="IEq85"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M228"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq85.gif"/></alternatives></inline-formula>-th observation, and relies on the residual from the previous iteration. Specifically, <inline-formula id="IEq86"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{i}^{(k+1)}={w}_{H}({\hat{\varepsilon }}_{i}^{(k)})$$\end{document}</tex-math><mml:math id="M230"><mml:mrow><mml:msubsup><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>ε</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq86.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq87"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\hat{\varepsilon }}_{i}^{(k)}={y}_{i}-{{\varvec{x}}}_{{\varvec{i}}}^{T}{\hat{{\varvec{\beta}}}}^{(k)}$$\end{document}</tex-math><mml:math id="M232"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ε</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">i</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq87.gif"/></alternatives></inline-formula> is the residual, and <inline-formula id="IEq88"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{H}(\bullet )$$\end{document}</tex-math><mml:math id="M234"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>∙</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq88.gif"/></alternatives></inline-formula> is the weight function induced by the Huber loss function, i.e.,<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${w}_{H}\left(\varepsilon \right)=\frac{{\rho }_{H}^{\mathrm{^{\prime}}}(\varepsilon )}{\varepsilon }=\frac{{\psi }_{H}\left(\varepsilon \right)}{\varepsilon }=\left\{\begin{array}{c}1\\ c\ /\left|\varepsilon \right|\end{array}\right. \begin{array}{c}|\varepsilon |\le c\\ \left|\varepsilon \right|&gt;c\end{array}.$$\end{document}</tex-math><mml:math id="M236" display="block"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>ε</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>ε</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mi>ε</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi>ε</mml:mi></mml:mfenced></mml:mrow><mml:mi>ε</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mi>c</mml:mi><mml:mspace width="4pt"/><mml:mo stretchy="false">/</mml:mo><mml:mfenced close="|" open="|"><mml:mi>ε</mml:mi></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mi>ε</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mo>≤</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mfenced close="|" open="|"><mml:mi>ε</mml:mi></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par29">When the residuals are small (<inline-formula id="IEq89"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\le c$$\end{document}</tex-math><mml:math id="M238"><mml:mrow><mml:mo>≤</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq89.gif"/></alternatives></inline-formula>), the weights for the observations are 1. When the residual exceeds the threshold <inline-formula id="IEq90"><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$c$$\end{document}</tex-math><mml:math id="M240"><mml:mi>c</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq90.gif"/></alternatives></inline-formula>, the weight gradually drops down (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). Intuitively, the IRLS algorithm assigns outliers small weights to reduce their influences on the M-estimate. Since the Huber loss function is convex and differentiable, the IRLS algorithm converges to the global minimum [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
      <p id="Par30">In each iteration of IRLS, solving the WLS estimate in (<xref rid="Equ10" ref-type="disp-formula">10</xref>) is equivalent to solving a system of linear equations, i.e.,<disp-formula id="Equ12"><label>12</label><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{X}}^{T} {\varvec{W}}^{\left( k \right)} \user2{X\beta } = {\varvec{X}}^{T} {\varvec{W}}^{\left( k \right)} {\varvec{Y}}.$$\end{document}</tex-math><mml:math id="M242" display="block"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow></mml:mrow><mml:mfenced close=")" open="("><mml:mi>k</mml:mi></mml:mfenced></mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow></mml:mrow><mml:mfenced close=")" open="("><mml:mi>k</mml:mi></mml:mfenced></mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5367_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par31">The coefficient matrix <inline-formula id="IEq91"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${{\varvec{X}}}^{T}{{\varvec{W}}}^{\left(k\right)}{\varvec{X}}$$\end{document}</tex-math><mml:math id="M244"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow></mml:mrow><mml:mfenced close=")" open="("><mml:mi>k</mml:mi></mml:mfenced></mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq91.gif"/></alternatives></inline-formula> is highly sparse (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S5). A series of efficient numerical algorithms have been developed for solving this kind of sparse linear systems. In RegCloser, a kind of accelerated restarted Krylov subspace method, LGMRES [<xref ref-type="bibr" rid="CR16">16</xref>], is used to solve (<xref rid="Equ12" ref-type="disp-formula">12</xref>), and the matrix manipulation is implemented in the sparse format for efficiency.</p>
      <p id="Par32">When the input includes multiple libraries with different insert sizes, RegCloser has an option ‘-w’ that assigns an initial weight to each overlap observation, which corresponds to a detected overlap. The initial weight depends on the standard deviation of the library where the overlapping reads come from. The smaller standard deviation induces a larger weight.</p>
    </sec>
    <sec id="Sec9">
      <title>Gap sequence determination</title>
      <p id="Par33">For each layout of reads, a multiple sequence alignment is constructed by sequentially aligning the next read with the current alignment. A consensus is determined by selecting the nucleotide at each base site with the largest Bayesian posterior probability (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S6). The probabilities are converted into Phred scores and output to the fastq file with the nucleotide sequence. Finally, the two pseudo reads, which are cut from the flanking sequences of a gap in the overlap stage (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b), are used to anchor the consensus into the gap (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). If the two pseudo reads are contained in the layout, the consensus sequence between them is taken to close the gap. Else if only one of the two pseudo reads is contained in the layout, RegCloser takes the consensus sequence after the left pseudo read to extend the left-flanking contig, or the consensus sequence before the right pseudo read to extend the right-flanking contig.</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Results</title>
    <sec id="Sec11">
      <title>Benchmarking on a GAGE dataset</title>
      <p id="Par34">We compared RegCloser with GapCloser, GapFiller, Sealer, and Phrap on the <italic>Staphylococcus aureus</italic> sequencing dataset from GAGE [<xref ref-type="bibr" rid="CR17">17</xref>]. A draft assembly was generated by SOAPdenovo2 (version 2.04) [<xref ref-type="bibr" rid="CR7">7</xref>]. A paired-end library whose insert size has an average of 415 bp and a standard deviation of 105 bp was added for closing gaps on the draft genome. The density plot of its insert size distribution is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3a. The read length was 101 bp and the read coverage was 84X. Quality assessment was performed through comparison with the known reference genome using QUAST (version 5.2.0) [<xref ref-type="bibr" rid="CR18">18</xref>]. The results are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1. Sealer did not finish after running for more than 72 h. RegCloser achieved the largest contig N50 with the fewest mis-assemblies and local mis-assemblies. GapCloser achieved the largest genome fraction (98.927%) but RegCloser is close to it (98.917%). The command lines for running the five methods are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S7, and their runtime and memory usage are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5.</p>
      <p id="Par35">Tandem repeats are ubiquitous in both prokaryote and eukaryote genomes. They are distributed in both noncoding and coding regions, and can carry important biological functions [<xref ref-type="bibr" rid="CR19">19</xref>]. However, tandem repeats remain challenges in DNA assembly. It is particularly difficult to resolve the copy number of a tandem repeat [<xref ref-type="bibr" rid="CR1">1</xref>]. In the evaluation of the <italic>S. aureus</italic> assembly, we found a gap spanned by a tandem repeat as shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>a. The tandem repeat was 201 bp long, with a unit size of 69 bp repeated about 2.9 times. The gap starts from the 32nd base of the first repeat unit, and ends exactly after the whole tandem repeat. All the five methods reported that they closed the gap, and the result of Sealer was obtained by running the software on the single scaffold containing the gap. However, only RegCloser resolved the copy number accurately (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). GapFiller, Sealer, and Phrap underestimated the copy number, while GapCloser overestimated the copy number. The result from GapFiller had 0.9 copy, those from Sealer and Phrap both had 1.9 copies, and that from GapCloser had 7.9 copies. In the next subsection, we will dissect the procedure of RegCloser and show its rationale of resolving the tandem repeat.<fig id="Fig3"><label>Fig. 3</label><caption><p>Closing a gap containing a tandem repeat. <bold>a</bold> Comparison of the closing results from five methods on a gap containing a triple tandem repeat. The repeat unit is shaded in yellow, and the copy number is 2.9. The gap starts at the middle of the first copy and ends at the repeat end. The sequences flanking the gap are shaded in blue. Existing tools including Phrap, GapCloser, GapFiller, and Sealer make mistakes on the copy number; only RegCloser resolves the tandem repeat correctly. <bold>b</bold> An illustration of the two different alignments between two reads from the tandem repeat. The position ① is mapped by the green and red alignments respectively to positions ② and ③, which differ in a shift of 69 bp, i.e., the size of the repeat unit. <bold>c</bold> Violin plots for the observational errors of overlaps detected by all-against-all pairwise alignment (left) versus by insert-size guided pairwise alignment (right). The observational error of an overlap between reads <inline-formula id="IEq125"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M246"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq125.gif"/></alternatives></inline-formula> and <inline-formula id="IEq126"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M248"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq126.gif"/></alternatives></inline-formula> refers to the difference between <inline-formula id="IEq127"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${y}^{(i,j)}$$\end{document}</tex-math><mml:math id="M250"><mml:msup><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq127.gif"/></alternatives></inline-formula> and (<inline-formula id="IEq128"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{j}-{\beta }_{i}$$\end{document}</tex-math><mml:math id="M252"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq128.gif"/></alternatives></inline-formula>), where <inline-formula id="IEq129"><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M254"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq129.gif"/></alternatives></inline-formula> and <inline-formula id="IEq130"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{j}$$\end{document}</tex-math><mml:math id="M256"><mml:msub><mml:mi>β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq130.gif"/></alternatives></inline-formula> are true read positions. The insert-size guided strategy gets rid of the large errors around 138 bp and substantially reduces the moderate errors around 69 bp, thus generating a higher-quality dataset for the regression. <bold>d</bold> Variation of the residual distribution along the process of the two-step robust regression. In Step 1, as the iteration increases in the IRLS algorithm for computing the robust M-estimate, most residuals converge towards 0 bp, while a fraction of residuals are still between 0 and 69 bp. In Step 2, the read coordinates are estimated by OLS on the data excluding the subset of outliers identified in Step 1. The final residuals of all data are clustered into two peaks exactly at 0 and 69 bp, which means the outliers have been separated out. <bold>e</bold> Screenshots of the layouts generated respectively from the OLS estimate and the two-step robust estimate of the reads’ genomic positions. The former layout is unclean and the latter layout is well aligned</p></caption><graphic xlink:href="12859_2023_5367_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>RegCloser’s rationale of resolving the tandem repeat</title>
      <p id="Par36">In essence, the difficulty of solving tandem repeats is that the reads from different repeat units are hard to discriminate. False overlaps between reads from different units can lead to incorrect copy number. The analysis of the tandem repeat example shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref> explains how RegCloser overcomes the difficulty efficiently.</p>
      <p id="Par37">In the overlap stage, RegCloser reduced the proportion of false overlaps significantly by insert-size guided pairwise alignment. On the one hand, rather than all-against-all pairwise alignment, RegCloser detected the overlaps only between reads whose prior positions were close, and the number of pairwise alignments were reduced from 140,185 to 39,106. Consequently, the overlaps between distant repeat units were avoided from the beginning. In other words, the large observational errors (the peak of 138 bp in Fig. <xref rid="Fig3" ref-type="fig">3</xref>c) were eliminated from the insert-size guided overlap results (the right panel in Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). On the other hand, when two reads from adjoining repeat units are aligned in two ways (see the example in Fig. <xref rid="Fig3" ref-type="fig">3</xref>b), RegCloser selected the alignment closer to the prior genomic positions. In this way, the middle observational errors (the peak of 69 bp in Fig. <xref rid="Fig3" ref-type="fig">3</xref>c) were further reduced substantially, with the proportion from <inline-formula id="IEq92"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$34.16\mathrm{\%}$$\end{document}</tex-math><mml:math id="M258"><mml:mrow><mml:mn>34.16</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq92.gif"/></alternatives></inline-formula> to <inline-formula id="IEq93"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$12.97\mathrm{\%}$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:mn>12.97</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq93.gif"/></alternatives></inline-formula>. Overall, the proportion of nonzero observational errors was reduced from <inline-formula id="IEq94"><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$48.38\mathrm{\%}$$\end{document}</tex-math><mml:math id="M262"><mml:mrow><mml:mn>48.38</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq94.gif"/></alternatives></inline-formula> to <inline-formula id="IEq95"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$14.40\mathrm{\%}$$\end{document}</tex-math><mml:math id="M264"><mml:mrow><mml:mn>14.40</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq95.gif"/></alternatives></inline-formula>.</p>
      <p id="Par38">In the robust regression stage, RegCloser detected and eliminated the influence of the remaining false overlaps. Figure <xref rid="Fig3" ref-type="fig">3</xref>d shows the variation of the residual distribution along the process of the two-step robust regression. In Step 1, the IRLS algorithm started with the OLS estimate, and converged after 8 iterations. The proportion of zero residuals increased from <inline-formula id="IEq96"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$5.54\mathrm{\%}$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:mn>5.54</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq96.gif"/></alternatives></inline-formula> to <inline-formula id="IEq97"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$27.20\mathrm{\%}$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:mn>27.20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq97.gif"/></alternatives></inline-formula>, and the proportion of residuals no larger than <inline-formula id="IEq98"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2$$\end{document}</tex-math><mml:math id="M270"><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq98.gif"/></alternatives></inline-formula> bp increased from 21.56% to 58.73%. The overlaps with residuals larger than <inline-formula id="IEq99"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$10$$\end{document}</tex-math><mml:math id="M272"><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq99.gif"/></alternatives></inline-formula> bp were identified as potential outliers. In Step 2, the read positions were again estimated by OLS on the data excluding the subset of potential outliers. The proportion of zero residuals further increased from <inline-formula id="IEq100"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$27.20\mathrm{\%}$$\end{document}</tex-math><mml:math id="M274"><mml:mrow><mml:mn>27.20</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq100.gif"/></alternatives></inline-formula> to 85.60 <inline-formula id="IEq101"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{\%}$$\end{document}</tex-math><mml:math id="M276"><mml:mo>%</mml:mo></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq101.gif"/></alternatives></inline-formula>, and the residuals were clustered into two peaks respectively at 0 and 69 bp (the last subplot in Fig. <xref rid="Fig3" ref-type="fig">3</xref>d). As illustrated in Fig. <xref rid="Fig3" ref-type="fig">3</xref>e, the layout resulted from the OLS estimate was full of misplacement. In contrast, the two-step robust regression in RegCloser produced a well aligned layout.</p>
    </sec>
    <sec id="Sec13">
      <title>Complete and accurate reconstruction of <italic>E. coli</italic> genome with simulated data</title>
      <p id="Par39">We also tested the performance of RegCloser on simulated data. Six Illumina libraries were simulated from the <italic>Escherichia coli</italic> reference genome (strain K-12 MG1655) using ART (version 2.5.8) [<xref ref-type="bibr" rid="CR20">20</xref>]. The detailed information of the six libraries is listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2, and the density plots of their insert size distributions are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3b.</p>
      <p id="Par40">A draft genome was first assembled using SOAPdenovo2 (version 2.04). The draft genome contained only one scaffold of 4,637,015 bp with 136 gaps. Five libraries with insert sizes of 300, 500, 800, 2 k, and 5 k were used to close the gaps. We ran RegCloser in an iterative way that the output genome served as the input of the next iteration. Merely after two iterations the 136 gaps were fully closed. The gap-closed genome was evaluated by QUAST (version 5.2.0). No mis-assemblies or local mis-assemblies were found, and the genome fraction was 100%. That is, a complete and accurate <italic>E. coli</italic> genome was reconstructed.</p>
      <p id="Par41">We compared the performance with the other four gap-closing methods. Similarly, they were run in an iterative way until no more gaps could be closed. The command lines are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S7, and the runtime and memory usage are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5. The results are shown in Table <xref rid="Tab1" ref-type="table">1</xref>. Only Sealer yielded one mis-assembly, while all the four methods yielded multiple local mis-assemblies. Their genome fractions were all lower than 100%. Even though GapCloser produced one contig, it contained the most local mis-assemblies. To further validate how many gaps were correctly closed, we aligned each “closed” gap sequence to the “true” gap sequence. If they were well aligned (by default, 15 bp soft-clip on both ends are allowed), the gap would be viewed as correctly closed. Table <xref rid="Tab1" ref-type="table">1</xref> demonstrates that RegCloser correctly closed all the 136 gaps, followed by GapCloser with 112/136, Phrap with 108/136, GapFiller with 103/136, and Sealer with 57/136.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Comparison of the five methods on the <italic>E. coli</italic> simulation data</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Methods</th><th align="left">Draft</th><th align="left">GapCloser</th><th align="left">GapFiller</th><th align="left">Sealer</th><th align="left">Phrap</th><th align="left">RegCloser</th></tr></thead><tbody><tr><td align="left">Contig length</td><td align="left">4,531,075</td><td align="left">4,642,829</td><td align="left">4,631,201</td><td align="left">4,542,679</td><td align="left">4,641,796</td><td align="left">4,641,652</td></tr><tr><td align="left">Contig number</td><td align="left">137</td><td align="left">1</td><td align="left">26</td><td align="left">59</td><td align="left">7</td><td align="left">1</td></tr><tr><td align="left">Contig N50</td><td align="left">78,557</td><td align="left">4,642,829</td><td align="left">331,261</td><td align="left">174,037</td><td align="left">1,334,246</td><td align="left">4,641,652</td></tr><tr><td align="left">Genome fraction</td><td align="left">97.532%</td><td align="left">99.924%</td><td align="left">99.687%</td><td align="left">97.851%</td><td align="left">99.892%</td><td align="left"><bold>100%</bold></td></tr><tr><td align="left"># mis-assemblies</td><td align="left">0</td><td align="left"><bold>0</bold></td><td align="left"><bold>0</bold></td><td align="left">1</td><td align="left"><bold>0</bold></td><td align="left"><bold>0</bold></td></tr><tr><td align="left"># local mis-assemblies</td><td align="left">0</td><td align="left">25</td><td align="left">7</td><td align="left">20</td><td align="left">23</td><td align="left"><bold>0</bold></td></tr><tr><td align="left"># mismatches</td><td align="left">0</td><td align="left">245</td><td align="left"><bold>43</bold></td><td align="left">55</td><td align="left">313</td><td align="left">51</td></tr><tr><td align="left"># indels</td><td align="left">0</td><td align="left">32</td><td align="left">13</td><td align="left">17</td><td align="left">42</td><td align="left"><bold>12</bold></td></tr><tr><td align="left"># closed gaps (# total gaps = 136)</td><td align="left"/><td align="left"><bold>136</bold></td><td align="left">111</td><td align="left">78</td><td align="left">130</td><td align="left"><bold>136</bold></td></tr><tr><td align="left"># correctly closed gaps</td><td align="left"/><td align="left">112</td><td align="left">103</td><td align="left">57</td><td align="left">108</td><td align="left"><bold>136</bold></td></tr><tr><td align="left"># closed TRs (# total TRs = 26)</td><td align="left"/><td align="left"><bold>26</bold></td><td align="left">12</td><td align="left">25</td><td align="left">24</td><td align="left"><bold>26</bold></td></tr><tr><td align="left"># correctly closed TRs</td><td align="left"/><td align="left">8</td><td align="left">4</td><td align="left">6</td><td align="left">6</td><td align="left"><bold>26</bold></td></tr><tr><td align="left"># incorrectly closed TRs/ # incorrectly closed gaps</td><td align="left"/><td align="left">18/24</td><td align="left">8/8</td><td align="left">19/21</td><td align="left">18/22</td><td align="left"><bold>0/0</bold></td></tr></tbody></table><table-wrap-foot><p>The assemblies are aligned to the reference genome using QUAST 5.2.0. Genome fraction is the percentage of the reference genome covered by assembled contigs. Mis-assemblies are locations on assembled contigs where the left and right flanking sequences align over 1 kb away, or they overlap by &gt; 1 kb, or they align on opposite strands. Local mis-assemblies are positions on contigs where the flanking sequences have a gap or overlap &lt; 1 kbp and &gt; 80 bp on the same strand of the reference. The best values of each quality metric are highlighted in bold. RegCloser correctly closes all the 136 gaps including the 26 tandem repeat (TR)-related gaps, and leads to a complete genome with 100% genome fraction and no mis-assemblies or local mis-assemblies. For the other four methods, the TR-related gaps account for most of the incorrectly closed gaps</p></table-wrap-foot></table-wrap></p>
      <p id="Par42">We paid special attention to the correctness of the tandem repeat (TR)-related gap closing. We first used the program Tandem Repeats Finder [<xref ref-type="bibr" rid="CR21">21</xref>] to locate tandem repeats on the reference genome, and found 26 out of the 136 gap regions intersected with certain tandem repeats. Furthermore, we found these tandem repeats accounted for most of the incorrectly closed gaps by the four methods. Specifically, 100%, <inline-formula id="IEq102"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$90.48\mathrm{\%}$$\end{document}</tex-math><mml:math id="M278"><mml:mrow><mml:mn>90.48</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq102.gif"/></alternatives></inline-formula>, <inline-formula id="IEq103"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$81.82\mathrm{\%}$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:mn>81.82</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq103.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq104"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$75\mathrm{\%}$$\end{document}</tex-math><mml:math id="M282"><mml:mrow><mml:mn>75</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq104.gif"/></alternatives></inline-formula> of the total gaps incorrectly closed by GapFiller, Sealer, Phrap and GapCloser were TR-related respectively (Table <xref rid="Tab1" ref-type="table">1</xref>).</p>
      <p id="Par43">The detailed information of the 26 TR-related gaps and their closure results are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3. RegCloser correctly closed all the 26 TR-related gaps, followed by GapCloser with 8, Phrap with 6, Sealer with 6, and GapFiller with 4. These simulation results demonstrate that RegCloser outperformed other methods, especially in resolving tandem repeats.</p>
    </sec>
    <sec id="Sec14">
      <title>Closing gaps of the plateau zokor draft genome that has been improved by long reads</title>
      <p id="Par44">To understand how the plateau zokor (<italic>Myospalax baileyi</italic>) adapts to the environment of high altitude and low oxygen, our collaborators from Kunming Institute of Zoology, CAS, initiated a sequencing project of plateau zokor, the complete genome size of which is about 3.17 Gbp [<xref ref-type="bibr" rid="CR22">22</xref>]. The sequence data contain 22 Illumina libraries with insert sizes ranging from 180 bp to 10 kbp, and the total sequence coverage is 130.5 X. In addition, 10X PacBio long reads were sequenced [<xref ref-type="bibr" rid="CR23">23</xref>]. The published draft genome was initially assembled with the Illumina short reads using SOAPdenovo2, and then was improved with the PacBio long reads using PBJelly. However, the improved genome still contained 99,434 gaps.</p>
      <p id="Par45">We run RegCloser and the other four methods to close the gaps by two rounds, and the command lines are provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S7. The results are shown in Table <xref rid="Tab2" ref-type="table">2</xref>. In the first round, three paired-end libraries with insert sizes of 300, 500, and 800 bp were used for gap closing. In the second round, a mate-pair library with a long insert size of 3000 bp was added. The detailed information of the four libraries is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4, and the density plots of their insert size distributions are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3c. The runtime and memory usage of the five methods are listed in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5.<table-wrap id="Tab2"><label>Table 2</label><caption><p>Comparison of the five methods on closing gaps of the plateau zokor draft genome</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Methods</th><th align="left">Draft</th><th align="left">GapCloser</th><th align="left">GapFiller</th><th align="left">Sealer</th><th align="left">Phrap</th><th align="left">RegCloser</th></tr></thead><tbody><tr><td align="left" colspan="7"><bold>3 paired-end libraries</bold></td></tr><tr><td align="left">Contig length</td><td align="left">2,527,528,914</td><td align="left">2,538,745,631</td><td align="left">2,530,456,764</td><td align="left">2,528,744,942</td><td align="left">2,528,100,353</td><td align="left">2,527,758,194</td></tr><tr><td align="left">Contig number</td><td align="left">113,835</td><td align="left">97,906</td><td align="left">96,181</td><td align="left">102,260</td><td align="left">71,066</td><td align="left">69,093</td></tr><tr><td align="left">Contig N50 (bp)</td><td align="left">67,378</td><td align="left">76,359</td><td align="left">88,200</td><td align="left">73,199</td><td align="left">130,114</td><td align="left"><bold>143,871</bold></td></tr><tr><td align="left"># closed gaps</td><td align="left"/><td align="left">15,929</td><td align="left">17,654</td><td align="left">11,575</td><td align="left">42,769</td><td align="left"><bold>44,742</bold></td></tr><tr><td align="left">BUSCO</td><td align="left">95.1%</td><td align="left"><bold>95.2%</bold></td><td align="left">95.1%</td><td align="left"><bold>95.2%</bold></td><td align="left"><bold>95.2%</bold></td><td align="left"><bold>95.2%</bold></td></tr><tr><td align="left">Mapping rate</td><td align="left">79.1%</td><td align="left">79.4%</td><td align="left">79.3%</td><td align="left">79.2%</td><td align="left">79.7%</td><td align="left"><bold>79.9%</bold></td></tr><tr><td align="left" colspan="7"><bold>3 paired-end + 1 mate-pair libraries</bold></td></tr><tr><td align="left">Contig length</td><td align="left">2,527,528,914</td><td align="left">2,541,442,324</td><td align="left">2,532,550,654</td><td align="left">2,528,949,290</td><td align="left">2,526,621,405</td><td align="left">2,524,372,994</td></tr><tr><td align="left">Contig number</td><td align="left">113,835</td><td align="left">96,437</td><td align="left">92,755</td><td align="left">100,611</td><td align="left">65,445</td><td align="left">62,766</td></tr><tr><td align="left">Contig N50 (bp)</td><td align="left">67,378</td><td align="left">77,295</td><td align="left">93,380</td><td align="left">74,852</td><td align="left">146,599</td><td align="left"><bold>173,542</bold></td></tr><tr><td align="left"># closed gaps</td><td align="left"/><td align="left">17,398</td><td align="left">21,080</td><td align="left">13,224</td><td align="left">48,390</td><td align="left"><bold>51,069</bold></td></tr><tr><td align="left">BUSCO</td><td align="left">95.1%</td><td align="left"><bold>95.2%</bold></td><td align="left">95.1%</td><td align="left"><bold>95.2%</bold></td><td align="left"><bold>95.2%</bold></td><td align="left"><bold>95.2%</bold></td></tr><tr><td align="left">Mapping rate</td><td align="left">79.1%</td><td align="left">79.5%</td><td align="left">79.4%</td><td align="left">79.2%</td><td align="left">79.7%</td><td align="left"><bold>80.1%</bold></td></tr></tbody></table><table-wrap-foot><p>The draft genome is initially assembled with high coverage short reads, and then improved with long reads. Two rounds of gap closing are performed. In the first round, three paired-end libraries with insert sizes of 300, 500, and 800 bp are used. In the second round, a mate-pair library with a long insert size of 3000 bp is added. Mapping rate is measured by mapping the reads of an independent library to the assembly. Contig N50 assesses the contiguity of genome assemblies. BUSCO and mapping rate assess the completeness of genome assemblies. The best values of each quality metric are highlighted in bold. After both rounds, RegCloser closes the most gaps, and achieves the highest contig N50, BUSCO, and mapping rate</p></table-wrap-foot></table-wrap></p>
      <p id="Par46">After the first round, RegCloser closed 44,742 (45.0%) gaps, and the contig N50 increased from 67.4 kbp to 143.9 kbp, exceeding all the other four methods. After the second round, RegCloser closed 6,327 more gaps, and the contig N50 further increased to 173.5 kbp. We used REAPR (version 1.0.18) [<xref ref-type="bibr" rid="CR24">24</xref>] to identify potential assembly mistakes, at which the genome would be broken. The broken contig N50 for RegCloser was 156.3 kbp, even outperforming the unbroken contig N50 for the other four methods (Table <xref rid="Tab2" ref-type="table">2</xref>). It indicated RegCloser achieved the highest contiguity with high accuracy.</p>
      <p id="Par47">BUSCO (version 5.4.2) [<xref ref-type="bibr" rid="CR25">25</xref>] was used to evaluate the completeness of assemblies with conserved single-copy orthologs in Glires. After both rounds, the BUSCO value increased from 95.1% to 95.2% for all the methods except GapFiller. Alternatively, the mapping rate of reads also measures the completeness of genome assemblies. We used the mapping tool, SEME [<xref ref-type="bibr" rid="CR26">26</xref>] with a strict criterion, to map the reads of an independent library to the assemblies. After both rounds, RegCloser achieved the highest mapping rate (Table <xref rid="Tab2" ref-type="table">2</xref>), which increased from 79.1% to 79.9% after the first round and further increased to 80.1% after the second round.</p>
      <p id="Par48">RegCloser provides an iterative scaffolding and gap closing mode like that in BAUM [<xref ref-type="bibr" rid="CR27">27</xref>]. The mode is specified by the option “-rs” (re-scaffolding). It uses the existing scaffolding tool to re-build scaffolds before gap closing in every iteration. In this mode, contig extension and gap closing provide more information for constructing longer and more accurate scaffolds, which further benefits the gap closing in the next iteration. We successively input the 7 libraries with insert sizes of respectively 300, 500, 800, 3 k, 5 k, 8 k, and 10 k bp, and ran 7 iterations in the re-scaffolding mode. The detailed information of the 7 libraries is provided in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4, and the density plots of their insert size distributions are shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3c. After 7 iterations, the final contig N50 reached 204 kbp, more than 3 folds of that in the published draft. Even after broken by REAPR with both short and long insert size libraries, the contig N50 still remained 179 kbp.</p>
    </sec>
    <sec id="Sec15">
      <title>The robust regression approach to generating an optimal layout of TGS long reads</title>
      <p id="Par49">We tested the applicability of the robust regression approach to layout generation in de novo assembly of long reads using a PacBio HiFi dataset of <italic>E. coli</italic>. The read length ranges from 10 to 17 kbp and the sequence coverage utilized in this assembly case was about 20X. To detect overlaps, we implemented an all-against-all pairwise alignment by BLASR [<xref ref-type="bibr" rid="CR28">28</xref>], restricting the hanging-out length to a maximum of 50 bp. Then we filtered out the suspicious chimeric reads using the information of the detected overlaps. In de novo assembly, the read orientations, namely, the strands from which the reads originate in the target genomic DNA, are unknown. Thus we first used a heuristic algorithm reported in RegScaf [<xref ref-type="bibr" rid="CR29">29</xref>] to orientate all reads, <italic>c.f.</italic> Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Note S8.</p>
      <p id="Par50">After orientating reads, we considered only one of the DNA double strands, and all reads from the other strand were transformed by reverse complement. Then these reads along with their orientation-supported alignments were input into the linear regression model described in “Section <xref rid="Sec6" ref-type="sec">Representation of detected overlaps by linear regression model</xref>”, as depicted in Fig. <xref rid="Fig4" ref-type="fig">4</xref>a. The two-step robust regression procedure described in “Section <xref rid="Sec7" ref-type="sec">Estimation of the reads’ genomic positions by a two-step robust regression procedure</xref>” was used to generate an optimal layout. The trimming step may split the resulted layout into multiple unconnected layouts. Next, we further constructed a layout-level graph in which each layout corresponds to a vertex and overlaps between layouts correspond to edges. Then the only path in the new graph led to the final layout. Its length was 4.6 M, nearly the length of the complete genome of <italic>E. coli</italic>.<fig id="Fig4"><label>Fig. 4</label><caption><p>Generating an optimal layout of TGS long reads by the robust regression approach. <bold>a</bold> Illustration of the regression representation. In the linear axis corresponding to the real genome, the position of each TGS long read is represented by a parameter <inline-formula id="IEq131"><alternatives><tex-math id="M283">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{i}$$\end{document}</tex-math><mml:math id="M284"><mml:msub><mml:mi>β</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq131.gif"/></alternatives></inline-formula> to be estimated. Each overlap, marked by the yellow double-headed arrow, provides an observation on the difference between two reads’ positions. However, chimeric reads, as well as repeats from distant regions in either the same or reverse strain of the genome, will bring in false overlaps, as those marked by red crossings, where ① indicates a false overlap caused by a chimeric read, ② indicates one caused by a repeat in the same strain, and ③ indicates one caused by a repeat in the reverse strain. All the overlap observations are integrated into the linear regression model <inline-formula id="IEq132"><alternatives><tex-math id="M285">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Y}}={\varvec{X}}{\varvec{\beta}}+{\varvec{\varepsilon}}$$\end{document}</tex-math><mml:math id="M286"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">ε</mml:mi></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq132.gif"/></alternatives></inline-formula>. Then the two-step robust regression procedure gives a globally optimal estimate of the read positions, which lead to a layout. Meanwhile, it detects the outliers, which correspond to the false overlaps. <bold>b</bold> Boxplot of the differences between the estimated and true positions of the reads in the layout that was generated by RegCloser for de novo assembly of the <italic>E. coli</italic> genome using a HiFi dataset</p></caption><graphic xlink:href="12859_2023_5367_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par51">We assessed the accuracy of the final layout by aligning all long reads to the reference genome and comparing their estimates in layouts with their real positions. The layout was shifted by a constant so that the median of errors is zero. Figure <xref rid="Fig4" ref-type="fig">4</xref>b is the box-plot of the errors of the estimated read positions. It shows that all reads were positioned near their true loci with a standard deviation of 451 bp.</p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Discussion and conclusions</title>
    <p id="Par52">In this article, we propose a new local assembly approach, RegCloser, for closing gaps in draft genomes. On the one hand, it utilizes the insert size information in the SGS paired sequencing reads to guide the pairwise alignment, thereby reducing both the computing cost and ambiguities caused by repeats in overlap detection. On the other hand, RegCloser represents the detected overlaps by a linear regression model, which regards the false overlaps caused by repeats or sequencing errors as outliers. This representation transforms the sequence assembly into a statistically robust estimation problem.</p>
    <p id="Par53">Note that if we take the Hamiltonian graph representation in the OLC paradigm, finding an optimal layout in the overlap graph is NP-complete. Hitherto the existing OLC methods generate layouts by greedy search. Here with the linear regression representation, the global optimal layout under the Huber loss function is achievable by the IRLS algorithm, which is to iteratively solve the sparse system of linear equations. Statistically, the influence function, a robustness measure, of the Huber M-estimator is bounded in both <inline-formula id="IEq105"><alternatives><tex-math id="M287">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{x}}$$\end{document}</tex-math><mml:math id="M288"><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5367_Article_IEq105.gif"/></alternatives></inline-formula>- and <italic>y</italic>-directions.</p>
    <p id="Par54">The aim and approach of RegCloser are different from those of the scaffolding method RegScaf we recently proposed [<xref ref-type="bibr" rid="CR29">29</xref>], although the linear model is used in both problems. RegScaf focuses on the scaffolding problem, which is to order contigs and estimate gap sizes, while RegCloser focuses on the gap-closing problem, which is to locally assemble short reads into contigs. Technically, RegScaf adopts the least trimmed squares (LTS) estimator. Although no efficient algorithm for computing the exact LTS solution is available in the multiple regression, an approximation is sufficiently good for the accuracy required by scaffolding. In comparison, the layout generation in the assembly problem needs more accurate estimation of read positions. Therefore, RegCloser adopts the more efficient robust estimator, the Huber M-estimator, whose exact solution can be computed. RegCloser can be used to improve genome assemblies in combination with any scaffolding methods.</p>
    <p id="Par55">When the repeat unit size is beyond the length of sequencing reads, the repeat structure can hardly be resolved by SGS data alone. However, we demonstrated that making full use of the library insert size information combined with robust regression can resolve some tandem repeats successfully. The insert-size guided pairwise alignment helps distinguish repeats from different units, and the two-step robust regression lays out reads at the right places. Compared with existing gap-closing methods, RegCloser closes more gaps and achieves higher contiguity and completeness, especially outperforms at gaps containing tandem repeats. The simulation results and the quality assessment by REAPR indicate that the gaps closed by RegCloser are of high quality.</p>
    <p id="Par56">The results on the plateau zokor draft genome suggest that RegCloser is scalable to large genomes. The zokor draft genome was initially assembled from SGS data, then long reads were applied to improve its contig N50 to 67 kbp. RegCloser further increased the contig N50 to 204 kbp based on the iterative scaffolding and gap closing strategy, which indicates that RegCloser can still improve on the basis of the results from long reads.
</p>
    <p id="Par57">Conceptually, the robust regression approach is a general assembly framework that is applicable to de novo assembly of both SGS and TGS data. We tested it on the layout generation for TGS long reads. Despite the long read length of TGS technology, issues like chimeric reads and indistinguishable repeats of a longer unit size still exist. Our results suggest that these issues can be partly solved by robust regression. Therefore, the proposed robust regression approach has a prospect to be incorporated into the layout module of long read assemblers.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec17">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5367_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1. </bold>Supplementary Figs. S1-S3, Notes S1-S8, and Tables S1-S5. </p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Shenghao Cao and Mengtian Li: Joint first authors</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Kunming Institute of Zoology, Chinese Academy of Sciences (CAS) for providing us with the sequence data of the plateau zokor genome project. We thank Zhanyu Wang for his patient guidance on useful experience.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>LML conceived the study and proposed the notion of linear regression representation and robust estimation of genome assembly. SC developed the linear model representation of overlap graph, proposed to use the Huber M-estimator, the IRLS algorithm, and demonstrated its robustness. ML, LML, and SC proposed the one-step trimmed least squares. ML and SC developed the insert-size guided pairwise alignment. SC implemented the majority code of RegCloser. ML carefully read, revised and supplemented the code. SC and ML tested RegCloser and the other tools on different datasets, and SC analyzed the results. ML proposed to orientate the long reads in de novo assembly, and implemented the algorithm. SC provided the draft code of layout generation. ML modified the code, tuned the parameters for the genome assembly of <italic>E. coli</italic> using long reads, and analyzed the results. SC prepared Figs. <xref rid="Fig1" ref-type="fig">1</xref>–<xref rid="Fig3" ref-type="fig">3</xref> and Tables <xref rid="Tab1" ref-type="table">1</xref>–<xref rid="Tab2" ref-type="table">2</xref>. ML prepared Fig. <xref rid="Fig4" ref-type="fig">4</xref>. The three authors revised the figures. SC prepared the majority of the supplementary materials, and ML revised and supplemented them. The three authors wrote and revised the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>National Key Research and Development Program of China, grant number 2022YFA1004801; National Natural Science Foundation of China, grant numbers 32170679, 11871462, and 91530105; Strategic Priority Research Program of the Chinese Academy of Sciences, grant number XDB13040600; National Center for Mathematics and Interdisciplinary Sciences, Chinese Academy of Sciences; Key Laboratory of Systems and Control, Chinese Academy of Sciences.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The <italic>S. aureus</italic> GAGE dataset is available at <ext-link ext-link-type="uri" xlink:href="http://gage.cbcb.umd.edu/data">http://gage.cbcb.umd.edu/data</ext-link>. The <italic>S. aureus</italic> paired-end sequence data are available in the Sequence Read Archive (SRA) in National Center for Biotechnology Information (NCBI, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov">https://www.ncbi.nlm.nih.gov</ext-link>) under the accession number SRR5244695. The <italic>S. aureus</italic> reference genome is available in the Assembly database in NCBI under the accession number GCF_000017085.1. The <italic>E. coli</italic> simulated sequence data can be downloaded from our github site at <ext-link ext-link-type="uri" xlink:href="https://github.com/csh3/RegCloser">https://github.com/csh3/RegCloser</ext-link>. The <italic>E. coli</italic> reference genome is available in the Assembly database in NCBI under the accession number GCF_000005845.2. The plateau zokor draft genome was retrieved from the Genome Warehouse (GWH) in National Genomics Data Center (NGDC, <ext-link ext-link-type="uri" xlink:href="https://ngdc.cncb.ac.cn">https://ngdc.cncb.ac.cn</ext-link>) under the accession number GWHABJZ00000000. The raw Illumina sequence data of plateau zokor are accessible in the Genome Sequence Archive (GSA) in NGDC under accession numbers ranging from CRX003877 to CRX003883, and from CRX004479 to CRX004484. The plateau zokor genome improved by RegCloser has been deposited in the GWH in NGDC under the accession number GWHBOZX00000000. The PacBio HiFi dataset of <italic>E. coli</italic> is available in the SRA in NCBI under the accession number SRR10971019.</p>
    <p>The software details are listed below</p>
    <p>Project name: RegCloser</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://github.com/csh3/RegCloser">https://github.com/csh3/RegCloser</ext-link></p>
    <p>Operating system: Linux</p>
    <p>Programming language: Python</p>
    <p>Other requirements: BWA, Python3 with modules os, sys, re, argparse, biopython, numpy, math, networkx, scipy, collections, datetime, multiprocessing</p>
    <p>License: GNU General Public License v3.0 only</p>
    <p>Any restrictions to use by non-academics: licence needed</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par58">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par59">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par60">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tørresen</surname>
            <given-names>OK</given-names>
          </name>
          <name>
            <surname>Star</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Mier</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Andrade-Navarro</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jarnot</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Gruca</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grynberg</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kajava</surname>
            <given-names>AV</given-names>
          </name>
          <name>
            <surname>Promponas</surname>
            <given-names>VJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tandem repeats lead to sequence assembly errors and impose multi-level challenges for genome and protein databases</article-title>
        <source>Nucleic Acids Res</source>
        <year>2019</year>
        <volume>47</volume>
        <issue>21</issue>
        <fpage>10994</fpage>
        <lpage>11006</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkz841</pub-id>
        <?supplied-pmid 31584084?>
        <pub-id pub-id-type="pmid">31584084</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bolivar-Torres</surname>
            <given-names>HH</given-names>
          </name>
          <name>
            <surname>Marín-Paredes</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Ramos-Madrigal</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Servín-Garcidueñas</surname>
            <given-names>LE</given-names>
          </name>
        </person-group>
        <article-title>Metagenome-assembled genome of acidibrevibacterium fodinaquatile FLA01 from fumarole sediments from the Los Azufres Geothermal Field</article-title>
        <source>Microbiol Resource Announc</source>
        <year>2022</year>
        <volume>11</volume>
        <issue>10</issue>
        <fpage>e00823</fpage>
        <lpage>e1822</lpage>
        <pub-id pub-id-type="doi">10.1128/mra.00823-22</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <mixed-citation publication-type="other">Tahir J, Crowhurst R, Deroles S, Hilario E, Schaffer R, Le Lievre L, Brendolise C, Chagne D, Gardiner SE, Knaebel M. First chromosome-scale assembly and deep floral-bud transcriptome of a male kiwifruit. Front Genet. 2022;961.</mixed-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hammond</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Vandervalk</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Kucuk</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Gibb</surname>
            <given-names>EA</given-names>
          </name>
          <name>
            <surname>Pandoh</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kirk</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The North American bullfrog draft genome provides insight into hormonal regulation of long noncoding RNA</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>1433</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-017-01316-7</pub-id>
        <?supplied-pmid 29127278?>
        <pub-id pub-id-type="pmid">29127278</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gold</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Katsuki</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Regulski</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ibberson</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Holstein</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Steele</surname>
            <given-names>RE</given-names>
          </name>
          <name>
            <surname>Jacobs</surname>
            <given-names>DK</given-names>
          </name>
          <name>
            <surname>Greenspan</surname>
            <given-names>RJ</given-names>
          </name>
        </person-group>
        <article-title>The genome of the jellyfish Aurelia and the evolution of animal complexity</article-title>
        <source>Nat Ecol Evolut</source>
        <year>2019</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>96</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="doi">10.1038/s41559-018-0719-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Paulino</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Warren</surname>
            <given-names>RL</given-names>
          </name>
          <name>
            <surname>Vandervalk</surname>
            <given-names>BP</given-names>
          </name>
          <name>
            <surname>Raymond</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jackman</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Birol</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Sealer: a scalable gap-closing application for finishing draft genomes</article-title>
        <source>BMC Bioinform</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>230</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-015-0663-4</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SOAPdenovo2: an empirically improved memory-efficient short-read de novo assembler</article-title>
        <source>Gigascience</source>
        <year>2012</year>
        <volume>1</volume>
        <issue>1</issue>
        <fpage>18</fpage>
        <pub-id pub-id-type="doi">10.1186/2047-217X-1-18</pub-id>
        <?supplied-pmid 23587118?>
        <pub-id pub-id-type="pmid">23587118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boetzer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pirovano</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Toward almost closed genomes with GapFiller</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>6</issue>
        <fpage>R56</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-6-r56</pub-id>
        <?supplied-pmid 22731987?>
        <pub-id pub-id-type="pmid">22731987</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <mixed-citation publication-type="other">Green P: PHRAP documentation. <ext-link ext-link-type="uri" xlink:href="http://www.phrap.org">http://www.phrap.org</ext-link> (13 September 2022, date last accessed). 1994.</mixed-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Skiena</surname>
            <given-names>SS</given-names>
          </name>
        </person-group>
        <source>The algorithm design manual</source>
        <year>2008</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Maronna</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Yohai</surname>
            <given-names>VJ</given-names>
          </name>
        </person-group>
        <source>Robust statistics: theory and methods</source>
        <year>2006</year>
        <publisher-loc>New York</publisher-loc>
        <publisher-name>Wiley</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>14</issue>
        <fpage>1754</fpage>
        <lpage>1760</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp324</pub-id>
        <?supplied-pmid 19451168?>
        <pub-id pub-id-type="pmid">19451168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Eggert</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A new algorithm for best subsequence alignments with application to tRNA-rRNA comparisons</article-title>
        <source>J Mol Biol</source>
        <year>1987</year>
        <volume>197</volume>
        <issue>4</issue>
        <fpage>723</fpage>
        <lpage>728</lpage>
        <pub-id pub-id-type="doi">10.1016/0022-2836(87)90478-5</pub-id>
        <?supplied-pmid 2448477?>
        <pub-id pub-id-type="pmid">2448477</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Yohai VJ: High breakdown-point and high efficiency robust estimates for regression. Ann Stat 1987;15(2):642–656, 615.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Aftab K, Hartley R. Convergence of iteratively re-weighted least squares to robust M-estimators. In: Proceedings of the 2015 IEEE winter conference on applications of computer vision. IEEE Computer Society 2015: 480–487.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baker</surname>
            <given-names>AH</given-names>
          </name>
          <name>
            <surname>Jessup</surname>
            <given-names>ER</given-names>
          </name>
          <name>
            <surname>Manteuffel</surname>
            <given-names>TA</given-names>
          </name>
        </person-group>
        <article-title>A technique for accelerating the convergence of restarted GMRES</article-title>
        <source>SIAM J Matrix Anal Appl</source>
        <year>2005</year>
        <volume>26</volume>
        <fpage>962</fpage>
        <lpage>984</lpage>
        <pub-id pub-id-type="doi">10.1137/S0895479803422014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salzberg</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Phillippy</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Zimin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Puiu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Magoc</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Koren</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Treangen</surname>
            <given-names>TJ</given-names>
          </name>
          <name>
            <surname>Schatz</surname>
            <given-names>MC</given-names>
          </name>
          <name>
            <surname>Delcher</surname>
            <given-names>AL</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GAGE: a critical evaluation of genome assemblies and assembly algorithms</article-title>
        <source>Genome Res</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>3</issue>
        <fpage>557</fpage>
        <lpage>567</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.131383.111</pub-id>
        <?supplied-pmid 22147368?>
        <pub-id pub-id-type="pmid">22147368</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gurevich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Saveliev</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Vyahhi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>QUAST: quality assessment tool for genome assemblies</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>8</issue>
        <fpage>1072</fpage>
        <lpage>1075</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt086</pub-id>
        <?supplied-pmid 23422339?>
        <pub-id pub-id-type="pmid">23422339</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Usdin</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>The biological effects of simple tandem repeats: lessons from the repeat expansion diseases</article-title>
        <source>Genome Res</source>
        <year>2008</year>
        <volume>18</volume>
        <issue>7</issue>
        <fpage>1011</fpage>
        <lpage>1019</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.070409.107</pub-id>
        <?supplied-pmid 18593815?>
        <pub-id pub-id-type="pmid">18593815</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Marth</surname>
            <given-names>GT</given-names>
          </name>
        </person-group>
        <article-title>ART: a next-generation sequencing read simulator</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr708</pub-id>
        <?supplied-pmid 22199392?>
        <pub-id pub-id-type="pmid">22199392</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Benson</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Tandem repeats finder: a program to analyze DNA sequences</article-title>
        <source>Nucleic Acids Res</source>
        <year>1999</year>
        <volume>27</volume>
        <issue>2</issue>
        <fpage>573</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/27.2.573</pub-id>
        <?supplied-pmid 9862982?>
        <pub-id pub-id-type="pmid">9862982</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lei</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single mutation underlying phenotypic convergence for hypoxia adaptation on the Qinghai-Tibetan Plateau</article-title>
        <source>Cell Res</source>
        <year>2021</year>
        <volume>31</volume>
        <issue>9</issue>
        <fpage>1032</fpage>
        <lpage>1035</lpage>
        <pub-id pub-id-type="doi">10.1038/s41422-021-00517-6</pub-id>
        <?supplied-pmid 34099886?>
        <pub-id pub-id-type="pmid">34099886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>YT</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>ZZ</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>TZ</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>RW</given-names>
          </name>
          <name>
            <surname>Nevo</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phenotypic and genomic adaptations to the extremely high elevation in plateau zokor (Myospalax baileyi)</article-title>
        <source>Mol Ecol</source>
        <year>2021</year>
        <volume>30</volume>
        <issue>22</issue>
        <fpage>5765</fpage>
        <lpage>5779</lpage>
        <pub-id pub-id-type="doi">10.1111/mec.16174</pub-id>
        <?supplied-pmid 34510615?>
        <pub-id pub-id-type="pmid">34510615</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hunt</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kikuchi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sanders</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Newbold</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Berriman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Otto</surname>
            <given-names>TD</given-names>
          </name>
        </person-group>
        <article-title>REAPR: a universal tool for genome assembly evaluation</article-title>
        <source>Genome Biol</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>5</issue>
        <fpage>R47</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2013-14-5-r47</pub-id>
        <?supplied-pmid 23710727?>
        <pub-id pub-id-type="pmid">23710727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Simão</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Waterhouse</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Ioannidis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Kriventseva</surname>
            <given-names>EV</given-names>
          </name>
          <name>
            <surname>Zdobnov</surname>
            <given-names>EM</given-names>
          </name>
        </person-group>
        <article-title>BUSCO: assessing genome assembly and annotation completeness with single-copy orthologs</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>31</volume>
        <issue>19</issue>
        <fpage>3210</fpage>
        <lpage>3212</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv351</pub-id>
        <?supplied-pmid 26059717?>
        <pub-id pub-id-type="pmid">26059717</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>SEME: a fast mapper of Illumina sequencing reads with statistical evaluation</article-title>
        <source>J Comput Biol</source>
        <year>2013</year>
        <volume>20</volume>
        <issue>11</issue>
        <fpage>847</fpage>
        <lpage>860</lpage>
        <pub-id pub-id-type="doi">10.1089/cmb.2013.0111</pub-id>
        <?supplied-pmid 24195707?>
        <pub-id pub-id-type="pmid">24195707</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>BAUM: improving genome assembly by adaptive unique mapping and local overlap-layout-consensus approach</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>12</issue>
        <fpage>2019</fpage>
        <lpage>2028</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty020</pub-id>
        <?supplied-pmid 29346504?>
        <pub-id pub-id-type="pmid">29346504</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chaisson</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Tesler</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Mapping single molecule sequencing reads using basic local alignment with successive refinement (BLASR): application and theory</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>238</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-238</pub-id>
        <?supplied-pmid 22988817?>
        <pub-id pub-id-type="pmid">22988817</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>LM</given-names>
          </name>
        </person-group>
        <article-title>RegScaf: a regression approach to scaffolding</article-title>
        <source>Bioinformatics</source>
        <year>2022</year>
        <volume>38</volume>
        <issue>10</issue>
        <fpage>2675</fpage>
        <lpage>2682</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btac174</pub-id>
        <?supplied-pmid 35561180?>
        <pub-id pub-id-type="pmid">35561180</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
