<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7931820</article-id>
    <article-id pub-id-type="pmid">33594436</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/giab007</article-id>
    <article-id pub-id-type="publisher-id">giab007</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00960</subject>
        <subject>AcademicSubjects/SCI02254</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HTSlib: C library for reading/writing high-throughput sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6447-4112</contrib-id>
        <name>
          <surname>Bonfield</surname>
          <given-names>James K</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
        <xref ref-type="author-notes" rid="afn1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1216-5457</contrib-id>
        <name>
          <surname>Marshall</surname>
          <given-names>John</given-names>
        </name>
        <aff><institution>Wolfson Wohl Cancer Research Centre, Institute of Cancer Sciences, University of Glasgow</institution>, Switchback Road, Glasgow, G61 1QH, <country country="GB">UK</country></aff>
        <xref ref-type="author-notes" rid="afn1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4159-1666</contrib-id>
        <name>
          <surname>Danecek</surname>
          <given-names>Petr</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
        <xref ref-type="author-notes" rid="afn1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4874-2874</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <aff><institution>Department of Data Sciences, Dana-Farber Cancer Institute, 450 Brookline Avenue</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Informatics, Harvard Medical School, 10 Shattuck Street</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0532-6021</contrib-id>
        <name>
          <surname>Ohan</surname>
          <given-names>Valeriu</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8117-400X</contrib-id>
        <name>
          <surname>Whitwham</surname>
          <given-names>Andrew</given-names>
        </name>
        <!--<email>samtools@sanger.ac.uk</email>-->
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7532-6898</contrib-id>
        <name>
          <surname>Keane</surname>
          <given-names>Thomas</given-names>
        </name>
        <aff><institution>EMBL-EBI, Wellcome Genome Campus, Hinxton, Cambridgeshire</institution>, CB10 1SD, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9983-1378</contrib-id>
        <name>
          <surname>Davies</surname>
          <given-names>Robert M</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><bold>Correspondence address</bold>. Andrew Whitwham, Wellcome Sanger Institute, Wellcome Genome Campus, Hinxton, Cambridgeshire, CB10 1SA, UK. Tel: +44 (0)1223 834244; E-mail: <email>samtools@sanger.ac.uk</email></corresp>
      <fn id="afn1">
        <p>Contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub" iso-8601-date="2021-02-16">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>10</volume>
    <issue>2</issue>
    <elocation-id>giab007</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press GigaScience.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="giab007.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="abs1">
        <title>Background</title>
        <p>Since the original publication of the VCF and SAM formats, an explosion of software tools have been created to process these data files. To facilitate this a library was produced out of the original SAMtools implementation, with a focus on performance and robustness. The file formats themselves have become international standards under the jurisdiction of the Global Alliance for Genomics and Health.</p>
      </sec>
      <sec id="abs2">
        <title>Findings</title>
        <p>We present a software library for providing programmatic access to sequencing alignment and variant formats. It was born out of the widely used SAMtools and BCFtools applications. Considerable improvements have been made to the original code plus many new features including newer access protocols, the addition of the CRAM file format, better indexing and iterators, and better use of threading.</p>
      </sec>
      <sec id="abs3">
        <title>Conclusion</title>
        <p>Since the original Samtools release, performance has been considerably improved, with a BAM read-write loop running 5 times faster and BAM to SAM conversion 13 times faster (both using 16 threads, compared to Samtools 0.1.19). Widespread adoption has seen HTSlib downloaded &gt;1 million times from GitHub and conda. The C library has been used directly by an estimated 900 GitHub projects and has been incorporated into Perl, Python, Rust, and R, significantly expanding the number of uses via other languages. HTSlib is open source and is freely available from <ext-link ext-link-type="uri" xlink:href="http://htslib.org/">htslib.org</ext-link> under MIT/BSD license.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>samtools</kwd>
      <kwd>bcftools</kwd>
      <kwd>high-throughput sequencing</kwd>
      <kwd>next generation sequencing</kwd>
      <kwd>variant calling</kwd>
      <kwd>data analysis</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>206194</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Background</title>
    <p>When the 1000 Genomes Project [<xref rid="bib1" ref-type="bibr">1</xref>] was launched in early 2008, there were many short-read aligners and variant callers. Each of them had its own input or output format for limited use cases, and interoperability was a major challenge. Users were forced to implement bespoke format converters to bridge tools, and because formats encoded different information, this was time consuming, laborious, and sometimes impossible. This fragmented ecosystem hampered the collaboration between the participants of the project and delayed the development of advanced data analysis algorithms.</p>
    <p>In a conference call on 21 October 2008, the 1000 Genomes Project analysis subgroup decided to take on the issue by unifying a variety of short-read alignment formats into the Sequence Alignment/Map format (SAM). Towards the end of 2008 the subgroup announced the first SAM specification, detailing a text-based SAM format and its binary representation, the BAM format [<xref rid="bib2" ref-type="bibr">2</xref>]. SAM/BAM quickly replaced all the other short-read alignment formats and became the <italic>de facto</italic> standard in the analysis of high-throughput sequence data. In 2010, a Variant Call Format (VCF) was introduced for storing genetic variation [<xref rid="bib3" ref-type="bibr">3</xref>]. Later, in 2011, as the number of sequenced samples increased and the text format proved too slow to parse, a binary version BCF (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Fig. S1</xref>) was developed [<xref rid="bib4" ref-type="bibr">4</xref>].</p>
    <p>The SAM/BAM format originally came with a reference implementation, SAMtools [<xref rid="bib2" ref-type="bibr">2</xref>, <xref rid="bib5" ref-type="bibr">5</xref>], and VCF/BCF with VCFtools [<xref rid="bib3" ref-type="bibr">3</xref>] and BCFtools (then part of the SAMtools package) [<xref rid="bib6" ref-type="bibr">6</xref>]. Numerous other tools have been developed since then in a wide variety of programming languages. For example, HTSJDK is the Java equivalent [<xref rid="bib7" ref-type="bibr">7</xref>] and is used extensively in Java applications; Sambamba [<xref rid="bib8" ref-type="bibr">8</xref>] is written in the D language and focuses primarily on efficient multi-threaded work; Scramble [<xref rid="bib9" ref-type="bibr">9</xref>] has BAM and SAM capability and is the primary source for experimental CRAM [<xref rid="bib10" ref-type="bibr">10</xref>, <xref rid="bib11" ref-type="bibr">11</xref>] development; and JBrowse [<xref rid="bib12" ref-type="bibr">12</xref>] implements read-only support for multiple formats in JavaScript.</p>
    <p>While the original implementation of SAMtools and BCFtools provided APIs to parse the files, it mixed these APIs with application code. This did not guarantee long-term stability and made it difficult to interface in other programs. To solve this, in 2013 the decision was taken to separate the API from the command line tools and to produce HTSlib as a dedicated programming library that processes common data formats used in high-throughput sequencing. Support for the European Bioinformatics Institute's CRAM format was added and in 2014 the first official release (1.0) was published. This library implements stable and robust APIs that other programs can rely on. It enables efficient access to SAM/BAM/CRAM, VCF/BCF, FASTA, FASTQ, block-gzip compressed data, and indexes. It can be used natively in C/C++ code and has bindings to many other popular programming languages, such as Python, Rust, and R, boosting the development of sequence analysis tools.</p>
    <p>HTSlib is not merely a separation; it also brought numerous improvements to SAMtools, BCFtools, and other third-party programs depending on it. HTSlib is linked into ∼900 GitHub projects (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S2</xref>), and HTSlib itself has been forked &gt;300 times. HTSlib has been installed via bioconda &gt;1 million times, and there are ∼10,000 GitHub projects using it via Pysam. The library is freely available for commercial and non-commercial use (the MIT/BSD compatible license) from <ext-link ext-link-type="uri" xlink:href="http://htslib.org">htslib.org</ext-link> and GitHub [<xref rid="bib13" ref-type="bibr">13</xref>].</p>
  </sec>
  <sec id="sec2">
    <title>Findings</title>
    <sec id="sec2-1">
      <title>Implementation</title>
      <p>The main purpose of HTSlib is to provide access to genomic information files, both alignment data (SAM, BAM, and CRAM formats) and variant data (VCF and BCF formats). The library also provides interfaces to access and index genome reference data in FASTA format and tab-delimited files with genomic coordinates.</p>
      <p>Given the typical file sizes of genomic data, compression is necessary for efficient storage of data. HTSlib supports the GZIP-compatible format BGZF (Blocked GNU Zip Format), which limits the size of compressed blocks, thus allowing indexing and random access to the compressed files. HTSlib includes 2 stand-alone programs that work with BGZF; bgzip is a general-purpose compression tool while tabix works on tab-delimited genome coordinate files (e.g., BED and GFF) and provides indexing and random access. BGZF compression is also used for BAM, BCF, and compressed FASTA files. The CRAM format uses column-specific compression methods including gzip, rANS [<xref rid="bib14" ref-type="bibr">14</xref>], LZMA, and bzip2. The CRAM implementation in HTSlib learns the best-performing compression method on the fly (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S3</xref>).</p>
      <p>The HTSlib library is structured as follows: the media access layer (Fig. <xref ref-type="fig" rid="fig1">1a</xref>) is a collection of low-level system and library (libcurl, knet) functions, which facilitate access to files on different storage environments (disk, memory, network) and over multiple protocols to various online storage providers (AWS S3, Google Cloud, GA4GH htsget [<xref rid="bib15" ref-type="bibr">15</xref>]; Fig. <xref ref-type="fig" rid="fig1">1b</xref>). This functionality is transparently available through a unified low-level stream interface hFILE (Fig. <xref ref-type="fig" rid="fig1">1c</xref>). All file formats (Fig. <xref ref-type="fig" rid="fig1">1d</xref> and <xref ref-type="fig" rid="fig1">e</xref>) are accessible through a higher-level file format–agnostic htsFILE interface, which provides functions to detect file types and set write options and provides common code for file iterators. Building on this layer are specializations for alignment (SAM, BAM, and CRAM) and variant (VCF and BCF) files and various auxiliary functions (Fig. <xref ref-type="fig" rid="fig1">1f</xref> and <xref ref-type="fig" rid="fig1">g</xref>).</p>
      <fig id="fig1" orientation="portrait" position="float">
        <label>Figure 1:</label>
        <caption>
          <p>Htslib design.</p>
        </caption>
        <graphic xlink:href="giab007fig1"/>
      </fig>
      <p>This API (Fig. <xref ref-type="fig" rid="fig1">1f</xref> and <xref ref-type="fig" rid="fig1">g</xref>) can be roughly divided into several classes:</p>
      <list list-type="order">
        <list-item>
          <p>The File Access API has basic methods for opening and closing alignment and variant files, as well as reading and writing records to a file. HTSlib automatically determines the input file type by its contents and output type by filename. Further explicit control is provided for format, data layout (in CRAM), and file compression levels. Data sorted in genomic order may also be indexed at the time of writing (for alignment data) or at a later post-writing stage.</p>
        </list-item>
        <list-item>
          <p>The Header API is a collection of methods that enables extensive control of SAM and VCF headers, including reading, writing, and parsing the header, accessing and updating individual tags, and adding and removing header lines.</p>
        </list-item>
        <list-item>
          <p>The Data API provides methods for parsing, updating, and retrieving information from individual record fields on both alignment and variant data. The library also includes the ability to read multiple VCF and BCF files in parallel, transparently merging their contents, so that the reader can easily process records with matching genomic positions and alleles.</p>
        </list-item>
        <list-item>
          <p>The Index/Iterator API offers the ability to extract information from the various index formats specific to genomic data (BAI, CSI, CRAI, TBI), and to create iterators for genomic files. The original BAI and TBI indices were limited to 512 Mb and were replaced by CSI allowing ≤2<sup>44</sup> bp.</p>
          <p>Both sequence alignment and variant call formats have millions of records that can be indexed by genomic location. An iterator groups a list of target genomic regions into a list of file offsets and contains the stepping and filtering logic to allow the file reader to extract only the information of interest. Additionally, the library provides the regidx API, which allows the user to efficiently search and intersect regions from arbitrary row-oriented text formats.</p>
        </list-item>
        <list-item>
          <p>The Mpileup API performs a data pivot. Alignment data in SAM, BAM, and CRAM are retrieved in row-oriented format, record by record. Data rotation (merging ≥1 input files) presents the sequence data in a column-oriented form per reference position. This information can be used for single-nucleotide polymorphism and indel calling, consensus generation, and to make alignment viewers. Mpileup can also optionally calculate base alignment quality scores for each read [<xref rid="bib16" ref-type="bibr">16</xref>]. The base alignment quality scores can be used to reduce false-positive single-nucleotide polymorphism calls by lowering the confidence scores at locations where the read alignment may be incorrect.</p>
        </list-item>
        <list-item>
          <p>HTSlib also includes various utility convenience functions such as hash tables, string manipulation, linked lists, heaps, sorting, and logging, and ensures portability between big- and little-endian platforms. Many of these originate from Klib [<xref rid="bib17" ref-type="bibr">17</xref>]. A thread pool interface is provided for general multi-threading.</p>
        </list-item>
      </list>
    </sec>
    <sec id="sec2-2">
      <title>Benchmarks of sequence alignment formats</title>
      <p>Given the widespread use of the library, performance and low memory requirements are paramount, which means that even relatively small improvements can lead to time and energy savings when analyzing large amounts of data.</p>
      <p>To test maximum throughput for alignment data, elapsed times were obtained for each file type using both 1 main thread and also 16 additional worker threads. Not all tools supported indexing of all formats, and only in more recent HTSlib versions is there support for indexing and random access of BGZF-compressed SAM files. Full benchmarks are in <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S5</xref>, with a summary for BAM shown here in Fig. <xref ref-type="fig" rid="fig2">2</xref>.</p>
      <fig id="fig2" orientation="portrait" position="float">
        <label>Figure 2:</label>
        <caption>
          <p>BAM elapsed read/write times, with up to 16 threads available.</p>
        </caption>
        <graphic xlink:href="giab007fig2"/>
      </fig>
      <p>The tests were performed on a RAM disk (/dev/shm) so represent maximum I/O rates for this system.</p>
      <p>Figure <xref ref-type="fig" rid="fig2">2</xref> shows read and write elapsed timings for the BAM format on chromosome 1 of ENA accession ERR3239276. Note that “samtools 2013” refers to SAMtools version 0.1.19 and not the current SAMtools release. Other tool versions are HTSlib 1.10.2–32-ga22a0af, HTSJDK 2.22.0, Sambamba 0.7.1, and Scramble 1.14.13. These use up to 16 threads, but the HTSJDK times are with only 1 additional thread per file. SAMtools 0.1.19 has multi-threaded writing only, so the speed is limited by the reading portion. (See <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S4</xref> for full single-threaded and multi-threaded timings, along with benchmarks for the SAM and CRAM formats.)</p>
      <p>HTSlib was the only tool tested capable of multi-threaded SAM decoding and encoding, which is important when processing output from a fast multi-threaded aligner. The use of the faster compression library libdeflate [<xref rid="bib18" ref-type="bibr">18</xref>] over Zlib [<xref rid="bib19" ref-type="bibr">19</xref>] is also a major contributing factor in BAM performance, meaning that BAM to BAM transcoding with 16 threads is 5 times faster than the original SAMtools 0.1.19 and BAM to SAM is 13 times faster.</p>
      <p>File sizes also differ slightly for BAM, owing to differing Deflate implementations (Zlib, Libdeflate, and Intel deflate). HTSlib's CRAM size is 24% smaller than HTSJDK, while being 4 times faster (with a single thread), although the files remain compatible (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S5</xref>).</p>
      <p>To compare the random access capabilities of HTSlib we chose gene and exon regions from the Ensembl database across chromosome 1 and measured the time and I/O statistics to retrieve all alignments overlapping those regions. HTSlib, HTSJDK, and Sambamba all support a multi-region iterator that is able to optimize I/O for many regions, reporting alignments that overlap multiple regions once only. SAMtools 0.1.19 and Scramble have no such feature; hence, regions that overlap will report some records multiple times and the same block may be read more than once.</p>
      <p>The exon list had 58,160 regions (many overlapping each other) covering 5.5% of the chromosome. Figure <xref ref-type="fig" rid="fig3">3</xref> shows the random access efficiency, in both time and number of bytes read, for the exon list with BAM input. HTSlib is the fastest and requires less I/O to retrieve the same records.</p>
      <fig id="fig3" orientation="portrait" position="float">
        <label>Figure 3:</label>
        <caption>
          <p>Time and megabytes of data read, for exon list in BAM.</p>
        </caption>
        <graphic xlink:href="giab007fig3"/>
      </fig>
    </sec>
    <sec id="sec2-3">
      <title>Benchmarks of variant formats</title>
      <p>The only common format supported between current HTSlib/BCFtools and HTSJDK is BGZF-compressed VCF. Figure <xref ref-type="fig" rid="fig4">4</xref> shows the time to read and read/write this format on a 929-sample test set [<xref rid="bib20" ref-type="bibr">20</xref>] (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S8</xref>). The source file is hgdp_wgs.20 190 516.full.chr20.vcf.gz, aligned and called from ENA PRJEB6463. Only single thread times are shown because currently multi-threading is suboptimal in BCFtools and not available in HTSJDK.</p>
      <fig id="fig4" orientation="portrait" position="float">
        <label>Figure 4:</label>
        <caption>
          <p>VCF.gz and BCF read and read/write times, 929 samples.</p>
        </caption>
        <graphic xlink:href="giab007fig4"/>
      </fig>
      <p>HTSlib also supports the BGZF-compressed BCF format, a binary variant of VCF. This performs considerably better than the compressed VCF, being 5 times faster to decode and nearly 3 times faster to encode (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Tables S10 and S11</xref> for details and more complete results).</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec3">
    <title>Discussion</title>
    <p>Over the lifetime of HTSlib the cost of sequencing has decreased by ∼100-fold, with a corresponding increase in data volume [<xref rid="bib21" ref-type="bibr">21</xref>]. New sequencing technologies have also been developed that produce much longer reads. The alignment and variant file formats have moved on from being group-led research to being maintained by the File Formats subgroup of the Global Alliance for Genomics and Health [<xref rid="bib22" ref-type="bibr">22</xref>]. Over the years various improvements and modifications have been made to the specifications. Together these have been and will continue to be a driving force for continued development.</p>
    <p>Since HTSlib 1.0, there have been 11 major releases and &gt;1,600 code commits, more than doubling the number of lines of C code [<xref rid="bib15" ref-type="bibr">15</xref>]. It has gained support for the CRAM file format, better indexing, extended APIs, more transfer protocols (S3, Google Cloud, Htsget), and improved threading and speed. Through the use of automated tests, static analysis tools, and fuzz testing it has been made much more reliable (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S12</xref>).</p>
    <p>Some of the existing limitations in HTSlib come from the design of the underlying file formats, e.g., BAM, CRAM, and BCF limit the maximum reference length to 2 Gb (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S13</xref>). We expect future standards development to include improvements leading to better scaling of many-sample VCF, additional support for structural variation, better handling of very long sequencing reads, large genomes, and support for base modifications. Further plans include speeding up both the VCF parser and mpileup, improved documentation, and better support for BED files.</p>
  </sec>
  <sec id="sec4">
    <title>Availability of Supporting Source Code and Requirements</title>
    <p>Project name: HTSlib</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/htslib">https://github.com/samtools/htslib</ext-link></p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: C</p>
    <p>License: A mix of Modified 2-Clause BSD (CRAM) and MIT/Expat (everything else)</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_002105">RRID:SCR_002105</ext-link>
    </p>
    <p>biotools: htslib</p>
  </sec>
  <sec sec-type="data-availability" id="sec5">
    <title>Data Availability</title>
    <p>The data set supporting the benchmarking results of this article is available in the ENA (ERR3239276 and PRJEB6463) and via FTP [<xref rid="bib23" ref-type="bibr">23</xref>]. Snapshots of the code are also available via the <italic>GigaScience</italic> GigaDB repository [<xref rid="bib24" ref-type="bibr">24</xref>].</p>
  </sec>
  <sec id="sec6">
    <title>Editors Note</title>
    <p>An accompanying article describing the latest versions of SAMtools and BCFtools is published alongside this article [<xref rid="bib25" ref-type="bibr">25</xref>].</p>
  </sec>
  <sec id="sec7">
    <title>Additional Files</title>
    <p>Supplementary Figure S1: Binary BCF vs VCF format</p>
    <p>Supplementary Section S2: Estimated number of HTSlib source code clones</p>
    <p>Supplementary Section S3: CRAM compression algorithm</p>
    <p>Supplementary Section S4: Performance of HTSlib's SAM, BAM, CRAM implementations</p>
    <p>Supplementary Table S5: Read and read/write timings for tools and file formats</p>
    <p>Supplementary Table S6: Random access times and data volumes, single thread</p>
    <p>Supplementary Table S7: Random access times and data volumes, 8 threads</p>
    <p>Supplementary Section S8. Performance of HTSlib's VCF, BCF implementations</p>
    <p>Supplementary Figure S9: VCF and BCF read and read/write speeds</p>
    <p>Supplementary Table S10: Multi-sample VCF and BCF performance</p>
    <p>Supplementary Table S11: Single-sample VCF and BCF performance</p>
    <p>Supplementary Section S12: Automatic testing</p>
    <p>Supplementary Section S13: The format size limitations</p>
  </sec>
  <sec id="sec8">
    <title>Abbreviations</title>
    <p>API: Application Programming Interface; BAM: Binary sequence Alignment/MAP; bp: base pairs; BCF: Binary variant Call Format; BGZF: Blocked GNU Zip Format; ENA: European Nucleotide Archive; Gb: gigabase pairs; Mb: megabase pairs; RAM: random access memory; SAM: Sequence Alignment/Map; VCF: Variant Call Format.</p>
  </sec>
  <sec id="sec9">
    <title>Competing Interests</title>
    <p>The authors declare they have no competing interests.</p>
  </sec>
  <sec id="sec10">
    <title>Funding</title>
    <p>This work was supported by the Wellcome Trust grant (206194).</p>
  </sec>
  <sec id="sec11">
    <title>Authors' contributions</title>
    <p>J.K.B., P.D., R.M.D., H.L., J.M., V.O., and A.W. wrote the software. R.M.D., T.K., and J.M. supervised the project. J.K.B., P.D., R.M.D., and A.W. wrote the original draft of the manuscript with all authors reviewing.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>giab007_GIGA-D-20-00368_Original_Submission</label>
      <media xlink:href="giab007_giga-d-20-00368_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>giab007_GIGA-D-20-00368_Revision_1</label>
      <media xlink:href="giab007_giga-d-20-00368_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>giab007_Response_to_Reviewer_Comments_Original_Submission</label>
      <media xlink:href="giab007_response_to_reviewer_comments_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>giab007_Reviewer_1_Report_Original_Submission</label>
      <caption>
        <p>Kai Ye -- 12/31/2020 Reviewed</p>
      </caption>
      <media xlink:href="giab007_reviewer_1_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>giab007_Reviewer_2_Report_Original_Submission</label>
      <caption>
        <p>Chris Chang -- 1/5/2021 Reviewed</p>
      </caption>
      <media xlink:href="giab007_reviewer_2_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>giab007_Supplemental_File</label>
      <media xlink:href="giab007_supplemental_file.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>The 1000 Genomes Project Consortium</collab>.</person-group>  <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>. <year>2015</year>;<volume>526</volume>:<fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Handsaker</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Wysoker</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>2078</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Auton</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Abecasis</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2156</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2987</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><comment>SAMtools, Version 1.11</comment>  <year>2020</year>
<ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/samtools/releases/tag/1.11">https://github.com/samtools/samtools/releases/tag/1.11</ext-link>. <comment>Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><comment>BCFtools, Version 1.11</comment><year>2020</year><ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/bcftools/releases/tag/1.11">https://github.com/samtools/bcftools/releases/tag/1.11</ext-link>. <comment> Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><comment>HTSJDK, Version 2.23.0.</comment>  <year>2020</year>
<comment><ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/htsjdk">https://github.com/samtools/htsjdk</ext-link>. Accessed 4 May 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarasov</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Vilella</surname>  <given-names>AJ</given-names></string-name>, <string-name><surname>Cuppen</surname>  <given-names>E</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Sambamba: fast processing of NGS alignment formats</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>:<fpage>2032</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">25697820</pub-id></mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name></person-group><article-title>The Scramble conversion tool</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>:<fpage>2818</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">24930138</pub-id></mixed-citation>
    </ref>
    <ref id="bib10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hsi-Yang Fritz</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Leinonen</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Cochrane</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Efficient storage of high throughput DNA sequencing data using reference-based compression</article-title>. <source>Genome Res</source>. <year>2011</year>;<volume>21</volume>:<fpage>734</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">21245279</pub-id></mixed-citation>
    </ref>
    <ref id="bib11">
      <label>11.</label>
      <mixed-citation publication-type="journal">
        <comment>CRAM homepage</comment>
        <year>2020</year>
        <comment><ext-link ext-link-type="uri" xlink:href="https://www.ga4gh.org/cram/">https://www.ga4gh.org/cram/</ext-link>. Accessed 6 November 2020.</comment>
      </mixed-citation>
    </ref>
    <ref id="bib12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buels</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Yao</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Diesh</surname>  <given-names>CM</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>JBrowse: a dynamic web platform for genome visualization and analysis</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>:<fpage>66</fpage>, doi:<pub-id pub-id-type="doi">10.1186/s13059-016-0924-1</pub-id>.<pub-id pub-id-type="pmid">27072794</pub-id></mixed-citation>
    </ref>
    <ref id="bib13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <comment>HTSlib, Version 1.11.</comment>  <year>2020</year>
<ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/htslib/releases/tag/1.11">https://github.com/samtools/htslib/releases/tag/1.11</ext-link>. <comment> Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duda</surname>  <given-names>J</given-names></string-name></person-group><article-title>Asymmetric numeral systems: entropy coding combining speed of Huffman coding with compression rate of arithmetic coding</article-title>. <comment>arXiv</comment>  <year>2013</year>: 1311.2540.</mixed-citation>
    </ref>
    <ref id="bib15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kelleher</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Lin</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Albach</surname>  <given-names>CH</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>htsget: a protocol for securely streaming genomic data</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>:<fpage>119</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">29931085</pub-id></mixed-citation>
    </ref>
    <ref id="bib16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>Improving SNP discovery by base alignment quality</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>1157</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21320865</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <label>17.</label>
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <string-name><surname>Li</surname>  <given-names>H</given-names></string-name>
        </person-group>
        <comment>Klib</comment>
        <year>2013</year>
        <comment><ext-link ext-link-type="uri" xlink:href="https://github.com/attractivechaos/klib">https://github.com/attractivechaos/klib</ext-link>. Accessed 27 November 2020.</comment>
      </mixed-citation>
    </ref>
    <ref id="bib18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Biggers</surname>  <given-names>E</given-names></string-name></person-group><comment>libdeflate, Version 1.7.</comment>  <year>2020</year>
<ext-link ext-link-type="uri" xlink:href="https://github.com/ebiggers/libdeflate">https://github.com/ebiggers/libdeflate</ext-link>.<comment> Accessed 6 November 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deutsch</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Gailly</surname>  <given-names>J-L</given-names></string-name></person-group><comment>ZLIB Compressed Data Format Specification version 3.3</comment><year>1996</year><pub-id pub-id-type="doi">10.17487/RFC1950</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bergström</surname>  <given-names>A</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>Hui</surname>  <given-names>R</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Insights into human genetic variation and population history from 929 diverse genomes</article-title>. <source>Science</source>. <year>2020</year>;<volume>367</volume>:<fpage>eaay5012</fpage>.<pub-id pub-id-type="pmid">32193295</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>National Human Genome Research Institute</collab>.</person-group>  <comment>DNA Sequencing Costs: Data.</comment>  <year>2020</year>
<ext-link ext-link-type="uri" xlink:href="https://www.genome.gov/about-genomics/fact-sheets/DNA-Sequencing-Costs-Data">https://www.genome.gov/about-genomics/fact-sheets/DNA-Sequencing-Costs-Data</ext-link>.<comment>Accessed 23 September 2020</comment>.</mixed-citation>
    </ref>
    <ref id="bib22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Birney</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Vamathevan</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Goodhand</surname>  <given-names>P</given-names></string-name></person-group><comment>Genomics in healthcare: GA4GH looks to 2022. bioRxiv</comment>  <year>2017</year>:<pub-id pub-id-type="doi">10.1101/203554</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib23">
      <label>23.</label>
      <mixed-citation publication-type="journal">
        <comment>Source file for hgdp_wgs.20190516.full.chr20. <ext-link ext-link-type="ftp" xlink:href="ftp://ngs.sanger.ac.uk/production/hgdp/hgdp_wgs.20190516/hgdp_wgs.20190516.full.chr20.vcf.gz">ftp://ngs.sanger.ac.uk/production/hgdp/hgdp_wgs.20190516/hgdp_wgs.20190516.full.chr20.vcf.gz</ext-link>. Accessed 27 November 2020.</comment>
      </mixed-citation>
    </ref>
    <ref id="bib24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Marshall</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Supporting data for “HTSlib - C library for reading/writing high-throughput sequencing data.”</article-title>. <source>GigaScience Database</source>. <year>2021</year>
<pub-id pub-id-type="doi">10.5524/100867</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Liddle</surname>  <given-names>J</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Twelve years of SAMtools and BCFtools</article-title>. <source>GigaScience</source>. <year>2021</year>;<bold>10</bold>(2): doi:10.1093/gigascience/giab008</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7931820</article-id>
    <article-id pub-id-type="pmid">33594436</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/giab007</article-id>
    <article-id pub-id-type="publisher-id">giab007</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00960</subject>
        <subject>AcademicSubjects/SCI02254</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HTSlib: C library for reading/writing high-throughput sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6447-4112</contrib-id>
        <name>
          <surname>Bonfield</surname>
          <given-names>James K</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
        <xref ref-type="author-notes" rid="afn1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1216-5457</contrib-id>
        <name>
          <surname>Marshall</surname>
          <given-names>John</given-names>
        </name>
        <aff><institution>Wolfson Wohl Cancer Research Centre, Institute of Cancer Sciences, University of Glasgow</institution>, Switchback Road, Glasgow, G61 1QH, <country country="GB">UK</country></aff>
        <xref ref-type="author-notes" rid="afn1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4159-1666</contrib-id>
        <name>
          <surname>Danecek</surname>
          <given-names>Petr</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
        <xref ref-type="author-notes" rid="afn1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4874-2874</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <aff><institution>Department of Data Sciences, Dana-Farber Cancer Institute, 450 Brookline Avenue</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Informatics, Harvard Medical School, 10 Shattuck Street</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0532-6021</contrib-id>
        <name>
          <surname>Ohan</surname>
          <given-names>Valeriu</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8117-400X</contrib-id>
        <name>
          <surname>Whitwham</surname>
          <given-names>Andrew</given-names>
        </name>
        <!--<email>samtools@sanger.ac.uk</email>-->
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7532-6898</contrib-id>
        <name>
          <surname>Keane</surname>
          <given-names>Thomas</given-names>
        </name>
        <aff><institution>EMBL-EBI, Wellcome Genome Campus, Hinxton, Cambridgeshire</institution>, CB10 1SD, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9983-1378</contrib-id>
        <name>
          <surname>Davies</surname>
          <given-names>Robert M</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><bold>Correspondence address</bold>. Andrew Whitwham, Wellcome Sanger Institute, Wellcome Genome Campus, Hinxton, Cambridgeshire, CB10 1SA, UK. Tel: +44 (0)1223 834244; E-mail: <email>samtools@sanger.ac.uk</email></corresp>
      <fn id="afn1">
        <p>Contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub" iso-8601-date="2021-02-16">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>10</volume>
    <issue>2</issue>
    <elocation-id>giab007</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press GigaScience.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="giab007.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="abs1">
        <title>Background</title>
        <p>Since the original publication of the VCF and SAM formats, an explosion of software tools have been created to process these data files. To facilitate this a library was produced out of the original SAMtools implementation, with a focus on performance and robustness. The file formats themselves have become international standards under the jurisdiction of the Global Alliance for Genomics and Health.</p>
      </sec>
      <sec id="abs2">
        <title>Findings</title>
        <p>We present a software library for providing programmatic access to sequencing alignment and variant formats. It was born out of the widely used SAMtools and BCFtools applications. Considerable improvements have been made to the original code plus many new features including newer access protocols, the addition of the CRAM file format, better indexing and iterators, and better use of threading.</p>
      </sec>
      <sec id="abs3">
        <title>Conclusion</title>
        <p>Since the original Samtools release, performance has been considerably improved, with a BAM read-write loop running 5 times faster and BAM to SAM conversion 13 times faster (both using 16 threads, compared to Samtools 0.1.19). Widespread adoption has seen HTSlib downloaded &gt;1 million times from GitHub and conda. The C library has been used directly by an estimated 900 GitHub projects and has been incorporated into Perl, Python, Rust, and R, significantly expanding the number of uses via other languages. HTSlib is open source and is freely available from <ext-link ext-link-type="uri" xlink:href="http://htslib.org/">htslib.org</ext-link> under MIT/BSD license.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>samtools</kwd>
      <kwd>bcftools</kwd>
      <kwd>high-throughput sequencing</kwd>
      <kwd>next generation sequencing</kwd>
      <kwd>variant calling</kwd>
      <kwd>data analysis</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>206194</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Background</title>
    <p>When the 1000 Genomes Project [<xref rid="bib1" ref-type="bibr">1</xref>] was launched in early 2008, there were many short-read aligners and variant callers. Each of them had its own input or output format for limited use cases, and interoperability was a major challenge. Users were forced to implement bespoke format converters to bridge tools, and because formats encoded different information, this was time consuming, laborious, and sometimes impossible. This fragmented ecosystem hampered the collaboration between the participants of the project and delayed the development of advanced data analysis algorithms.</p>
    <p>In a conference call on 21 October 2008, the 1000 Genomes Project analysis subgroup decided to take on the issue by unifying a variety of short-read alignment formats into the Sequence Alignment/Map format (SAM). Towards the end of 2008 the subgroup announced the first SAM specification, detailing a text-based SAM format and its binary representation, the BAM format [<xref rid="bib2" ref-type="bibr">2</xref>]. SAM/BAM quickly replaced all the other short-read alignment formats and became the <italic>de facto</italic> standard in the analysis of high-throughput sequence data. In 2010, a Variant Call Format (VCF) was introduced for storing genetic variation [<xref rid="bib3" ref-type="bibr">3</xref>]. Later, in 2011, as the number of sequenced samples increased and the text format proved too slow to parse, a binary version BCF (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Fig. S1</xref>) was developed [<xref rid="bib4" ref-type="bibr">4</xref>].</p>
    <p>The SAM/BAM format originally came with a reference implementation, SAMtools [<xref rid="bib2" ref-type="bibr">2</xref>, <xref rid="bib5" ref-type="bibr">5</xref>], and VCF/BCF with VCFtools [<xref rid="bib3" ref-type="bibr">3</xref>] and BCFtools (then part of the SAMtools package) [<xref rid="bib6" ref-type="bibr">6</xref>]. Numerous other tools have been developed since then in a wide variety of programming languages. For example, HTSJDK is the Java equivalent [<xref rid="bib7" ref-type="bibr">7</xref>] and is used extensively in Java applications; Sambamba [<xref rid="bib8" ref-type="bibr">8</xref>] is written in the D language and focuses primarily on efficient multi-threaded work; Scramble [<xref rid="bib9" ref-type="bibr">9</xref>] has BAM and SAM capability and is the primary source for experimental CRAM [<xref rid="bib10" ref-type="bibr">10</xref>, <xref rid="bib11" ref-type="bibr">11</xref>] development; and JBrowse [<xref rid="bib12" ref-type="bibr">12</xref>] implements read-only support for multiple formats in JavaScript.</p>
    <p>While the original implementation of SAMtools and BCFtools provided APIs to parse the files, it mixed these APIs with application code. This did not guarantee long-term stability and made it difficult to interface in other programs. To solve this, in 2013 the decision was taken to separate the API from the command line tools and to produce HTSlib as a dedicated programming library that processes common data formats used in high-throughput sequencing. Support for the European Bioinformatics Institute's CRAM format was added and in 2014 the first official release (1.0) was published. This library implements stable and robust APIs that other programs can rely on. It enables efficient access to SAM/BAM/CRAM, VCF/BCF, FASTA, FASTQ, block-gzip compressed data, and indexes. It can be used natively in C/C++ code and has bindings to many other popular programming languages, such as Python, Rust, and R, boosting the development of sequence analysis tools.</p>
    <p>HTSlib is not merely a separation; it also brought numerous improvements to SAMtools, BCFtools, and other third-party programs depending on it. HTSlib is linked into ∼900 GitHub projects (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S2</xref>), and HTSlib itself has been forked &gt;300 times. HTSlib has been installed via bioconda &gt;1 million times, and there are ∼10,000 GitHub projects using it via Pysam. The library is freely available for commercial and non-commercial use (the MIT/BSD compatible license) from <ext-link ext-link-type="uri" xlink:href="http://htslib.org">htslib.org</ext-link> and GitHub [<xref rid="bib13" ref-type="bibr">13</xref>].</p>
  </sec>
  <sec id="sec2">
    <title>Findings</title>
    <sec id="sec2-1">
      <title>Implementation</title>
      <p>The main purpose of HTSlib is to provide access to genomic information files, both alignment data (SAM, BAM, and CRAM formats) and variant data (VCF and BCF formats). The library also provides interfaces to access and index genome reference data in FASTA format and tab-delimited files with genomic coordinates.</p>
      <p>Given the typical file sizes of genomic data, compression is necessary for efficient storage of data. HTSlib supports the GZIP-compatible format BGZF (Blocked GNU Zip Format), which limits the size of compressed blocks, thus allowing indexing and random access to the compressed files. HTSlib includes 2 stand-alone programs that work with BGZF; bgzip is a general-purpose compression tool while tabix works on tab-delimited genome coordinate files (e.g., BED and GFF) and provides indexing and random access. BGZF compression is also used for BAM, BCF, and compressed FASTA files. The CRAM format uses column-specific compression methods including gzip, rANS [<xref rid="bib14" ref-type="bibr">14</xref>], LZMA, and bzip2. The CRAM implementation in HTSlib learns the best-performing compression method on the fly (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S3</xref>).</p>
      <p>The HTSlib library is structured as follows: the media access layer (Fig. <xref ref-type="fig" rid="fig1">1a</xref>) is a collection of low-level system and library (libcurl, knet) functions, which facilitate access to files on different storage environments (disk, memory, network) and over multiple protocols to various online storage providers (AWS S3, Google Cloud, GA4GH htsget [<xref rid="bib15" ref-type="bibr">15</xref>]; Fig. <xref ref-type="fig" rid="fig1">1b</xref>). This functionality is transparently available through a unified low-level stream interface hFILE (Fig. <xref ref-type="fig" rid="fig1">1c</xref>). All file formats (Fig. <xref ref-type="fig" rid="fig1">1d</xref> and <xref ref-type="fig" rid="fig1">e</xref>) are accessible through a higher-level file format–agnostic htsFILE interface, which provides functions to detect file types and set write options and provides common code for file iterators. Building on this layer are specializations for alignment (SAM, BAM, and CRAM) and variant (VCF and BCF) files and various auxiliary functions (Fig. <xref ref-type="fig" rid="fig1">1f</xref> and <xref ref-type="fig" rid="fig1">g</xref>).</p>
      <fig id="fig1" orientation="portrait" position="float">
        <label>Figure 1:</label>
        <caption>
          <p>Htslib design.</p>
        </caption>
        <graphic xlink:href="giab007fig1"/>
      </fig>
      <p>This API (Fig. <xref ref-type="fig" rid="fig1">1f</xref> and <xref ref-type="fig" rid="fig1">g</xref>) can be roughly divided into several classes:</p>
      <list list-type="order">
        <list-item>
          <p>The File Access API has basic methods for opening and closing alignment and variant files, as well as reading and writing records to a file. HTSlib automatically determines the input file type by its contents and output type by filename. Further explicit control is provided for format, data layout (in CRAM), and file compression levels. Data sorted in genomic order may also be indexed at the time of writing (for alignment data) or at a later post-writing stage.</p>
        </list-item>
        <list-item>
          <p>The Header API is a collection of methods that enables extensive control of SAM and VCF headers, including reading, writing, and parsing the header, accessing and updating individual tags, and adding and removing header lines.</p>
        </list-item>
        <list-item>
          <p>The Data API provides methods for parsing, updating, and retrieving information from individual record fields on both alignment and variant data. The library also includes the ability to read multiple VCF and BCF files in parallel, transparently merging their contents, so that the reader can easily process records with matching genomic positions and alleles.</p>
        </list-item>
        <list-item>
          <p>The Index/Iterator API offers the ability to extract information from the various index formats specific to genomic data (BAI, CSI, CRAI, TBI), and to create iterators for genomic files. The original BAI and TBI indices were limited to 512 Mb and were replaced by CSI allowing ≤2<sup>44</sup> bp.</p>
          <p>Both sequence alignment and variant call formats have millions of records that can be indexed by genomic location. An iterator groups a list of target genomic regions into a list of file offsets and contains the stepping and filtering logic to allow the file reader to extract only the information of interest. Additionally, the library provides the regidx API, which allows the user to efficiently search and intersect regions from arbitrary row-oriented text formats.</p>
        </list-item>
        <list-item>
          <p>The Mpileup API performs a data pivot. Alignment data in SAM, BAM, and CRAM are retrieved in row-oriented format, record by record. Data rotation (merging ≥1 input files) presents the sequence data in a column-oriented form per reference position. This information can be used for single-nucleotide polymorphism and indel calling, consensus generation, and to make alignment viewers. Mpileup can also optionally calculate base alignment quality scores for each read [<xref rid="bib16" ref-type="bibr">16</xref>]. The base alignment quality scores can be used to reduce false-positive single-nucleotide polymorphism calls by lowering the confidence scores at locations where the read alignment may be incorrect.</p>
        </list-item>
        <list-item>
          <p>HTSlib also includes various utility convenience functions such as hash tables, string manipulation, linked lists, heaps, sorting, and logging, and ensures portability between big- and little-endian platforms. Many of these originate from Klib [<xref rid="bib17" ref-type="bibr">17</xref>]. A thread pool interface is provided for general multi-threading.</p>
        </list-item>
      </list>
    </sec>
    <sec id="sec2-2">
      <title>Benchmarks of sequence alignment formats</title>
      <p>Given the widespread use of the library, performance and low memory requirements are paramount, which means that even relatively small improvements can lead to time and energy savings when analyzing large amounts of data.</p>
      <p>To test maximum throughput for alignment data, elapsed times were obtained for each file type using both 1 main thread and also 16 additional worker threads. Not all tools supported indexing of all formats, and only in more recent HTSlib versions is there support for indexing and random access of BGZF-compressed SAM files. Full benchmarks are in <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S5</xref>, with a summary for BAM shown here in Fig. <xref ref-type="fig" rid="fig2">2</xref>.</p>
      <fig id="fig2" orientation="portrait" position="float">
        <label>Figure 2:</label>
        <caption>
          <p>BAM elapsed read/write times, with up to 16 threads available.</p>
        </caption>
        <graphic xlink:href="giab007fig2"/>
      </fig>
      <p>The tests were performed on a RAM disk (/dev/shm) so represent maximum I/O rates for this system.</p>
      <p>Figure <xref ref-type="fig" rid="fig2">2</xref> shows read and write elapsed timings for the BAM format on chromosome 1 of ENA accession ERR3239276. Note that “samtools 2013” refers to SAMtools version 0.1.19 and not the current SAMtools release. Other tool versions are HTSlib 1.10.2–32-ga22a0af, HTSJDK 2.22.0, Sambamba 0.7.1, and Scramble 1.14.13. These use up to 16 threads, but the HTSJDK times are with only 1 additional thread per file. SAMtools 0.1.19 has multi-threaded writing only, so the speed is limited by the reading portion. (See <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S4</xref> for full single-threaded and multi-threaded timings, along with benchmarks for the SAM and CRAM formats.)</p>
      <p>HTSlib was the only tool tested capable of multi-threaded SAM decoding and encoding, which is important when processing output from a fast multi-threaded aligner. The use of the faster compression library libdeflate [<xref rid="bib18" ref-type="bibr">18</xref>] over Zlib [<xref rid="bib19" ref-type="bibr">19</xref>] is also a major contributing factor in BAM performance, meaning that BAM to BAM transcoding with 16 threads is 5 times faster than the original SAMtools 0.1.19 and BAM to SAM is 13 times faster.</p>
      <p>File sizes also differ slightly for BAM, owing to differing Deflate implementations (Zlib, Libdeflate, and Intel deflate). HTSlib's CRAM size is 24% smaller than HTSJDK, while being 4 times faster (with a single thread), although the files remain compatible (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S5</xref>).</p>
      <p>To compare the random access capabilities of HTSlib we chose gene and exon regions from the Ensembl database across chromosome 1 and measured the time and I/O statistics to retrieve all alignments overlapping those regions. HTSlib, HTSJDK, and Sambamba all support a multi-region iterator that is able to optimize I/O for many regions, reporting alignments that overlap multiple regions once only. SAMtools 0.1.19 and Scramble have no such feature; hence, regions that overlap will report some records multiple times and the same block may be read more than once.</p>
      <p>The exon list had 58,160 regions (many overlapping each other) covering 5.5% of the chromosome. Figure <xref ref-type="fig" rid="fig3">3</xref> shows the random access efficiency, in both time and number of bytes read, for the exon list with BAM input. HTSlib is the fastest and requires less I/O to retrieve the same records.</p>
      <fig id="fig3" orientation="portrait" position="float">
        <label>Figure 3:</label>
        <caption>
          <p>Time and megabytes of data read, for exon list in BAM.</p>
        </caption>
        <graphic xlink:href="giab007fig3"/>
      </fig>
    </sec>
    <sec id="sec2-3">
      <title>Benchmarks of variant formats</title>
      <p>The only common format supported between current HTSlib/BCFtools and HTSJDK is BGZF-compressed VCF. Figure <xref ref-type="fig" rid="fig4">4</xref> shows the time to read and read/write this format on a 929-sample test set [<xref rid="bib20" ref-type="bibr">20</xref>] (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S8</xref>). The source file is hgdp_wgs.20 190 516.full.chr20.vcf.gz, aligned and called from ENA PRJEB6463. Only single thread times are shown because currently multi-threading is suboptimal in BCFtools and not available in HTSJDK.</p>
      <fig id="fig4" orientation="portrait" position="float">
        <label>Figure 4:</label>
        <caption>
          <p>VCF.gz and BCF read and read/write times, 929 samples.</p>
        </caption>
        <graphic xlink:href="giab007fig4"/>
      </fig>
      <p>HTSlib also supports the BGZF-compressed BCF format, a binary variant of VCF. This performs considerably better than the compressed VCF, being 5 times faster to decode and nearly 3 times faster to encode (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Tables S10 and S11</xref> for details and more complete results).</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec3">
    <title>Discussion</title>
    <p>Over the lifetime of HTSlib the cost of sequencing has decreased by ∼100-fold, with a corresponding increase in data volume [<xref rid="bib21" ref-type="bibr">21</xref>]. New sequencing technologies have also been developed that produce much longer reads. The alignment and variant file formats have moved on from being group-led research to being maintained by the File Formats subgroup of the Global Alliance for Genomics and Health [<xref rid="bib22" ref-type="bibr">22</xref>]. Over the years various improvements and modifications have been made to the specifications. Together these have been and will continue to be a driving force for continued development.</p>
    <p>Since HTSlib 1.0, there have been 11 major releases and &gt;1,600 code commits, more than doubling the number of lines of C code [<xref rid="bib15" ref-type="bibr">15</xref>]. It has gained support for the CRAM file format, better indexing, extended APIs, more transfer protocols (S3, Google Cloud, Htsget), and improved threading and speed. Through the use of automated tests, static analysis tools, and fuzz testing it has been made much more reliable (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S12</xref>).</p>
    <p>Some of the existing limitations in HTSlib come from the design of the underlying file formats, e.g., BAM, CRAM, and BCF limit the maximum reference length to 2 Gb (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S13</xref>). We expect future standards development to include improvements leading to better scaling of many-sample VCF, additional support for structural variation, better handling of very long sequencing reads, large genomes, and support for base modifications. Further plans include speeding up both the VCF parser and mpileup, improved documentation, and better support for BED files.</p>
  </sec>
  <sec id="sec4">
    <title>Availability of Supporting Source Code and Requirements</title>
    <p>Project name: HTSlib</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/htslib">https://github.com/samtools/htslib</ext-link></p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: C</p>
    <p>License: A mix of Modified 2-Clause BSD (CRAM) and MIT/Expat (everything else)</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_002105">RRID:SCR_002105</ext-link>
    </p>
    <p>biotools: htslib</p>
  </sec>
  <sec sec-type="data-availability" id="sec5">
    <title>Data Availability</title>
    <p>The data set supporting the benchmarking results of this article is available in the ENA (ERR3239276 and PRJEB6463) and via FTP [<xref rid="bib23" ref-type="bibr">23</xref>]. Snapshots of the code are also available via the <italic>GigaScience</italic> GigaDB repository [<xref rid="bib24" ref-type="bibr">24</xref>].</p>
  </sec>
  <sec id="sec6">
    <title>Editors Note</title>
    <p>An accompanying article describing the latest versions of SAMtools and BCFtools is published alongside this article [<xref rid="bib25" ref-type="bibr">25</xref>].</p>
  </sec>
  <sec id="sec7">
    <title>Additional Files</title>
    <p>Supplementary Figure S1: Binary BCF vs VCF format</p>
    <p>Supplementary Section S2: Estimated number of HTSlib source code clones</p>
    <p>Supplementary Section S3: CRAM compression algorithm</p>
    <p>Supplementary Section S4: Performance of HTSlib's SAM, BAM, CRAM implementations</p>
    <p>Supplementary Table S5: Read and read/write timings for tools and file formats</p>
    <p>Supplementary Table S6: Random access times and data volumes, single thread</p>
    <p>Supplementary Table S7: Random access times and data volumes, 8 threads</p>
    <p>Supplementary Section S8. Performance of HTSlib's VCF, BCF implementations</p>
    <p>Supplementary Figure S9: VCF and BCF read and read/write speeds</p>
    <p>Supplementary Table S10: Multi-sample VCF and BCF performance</p>
    <p>Supplementary Table S11: Single-sample VCF and BCF performance</p>
    <p>Supplementary Section S12: Automatic testing</p>
    <p>Supplementary Section S13: The format size limitations</p>
  </sec>
  <sec id="sec8">
    <title>Abbreviations</title>
    <p>API: Application Programming Interface; BAM: Binary sequence Alignment/MAP; bp: base pairs; BCF: Binary variant Call Format; BGZF: Blocked GNU Zip Format; ENA: European Nucleotide Archive; Gb: gigabase pairs; Mb: megabase pairs; RAM: random access memory; SAM: Sequence Alignment/Map; VCF: Variant Call Format.</p>
  </sec>
  <sec id="sec9">
    <title>Competing Interests</title>
    <p>The authors declare they have no competing interests.</p>
  </sec>
  <sec id="sec10">
    <title>Funding</title>
    <p>This work was supported by the Wellcome Trust grant (206194).</p>
  </sec>
  <sec id="sec11">
    <title>Authors' contributions</title>
    <p>J.K.B., P.D., R.M.D., H.L., J.M., V.O., and A.W. wrote the software. R.M.D., T.K., and J.M. supervised the project. J.K.B., P.D., R.M.D., and A.W. wrote the original draft of the manuscript with all authors reviewing.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>giab007_GIGA-D-20-00368_Original_Submission</label>
      <media xlink:href="giab007_giga-d-20-00368_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>giab007_GIGA-D-20-00368_Revision_1</label>
      <media xlink:href="giab007_giga-d-20-00368_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>giab007_Response_to_Reviewer_Comments_Original_Submission</label>
      <media xlink:href="giab007_response_to_reviewer_comments_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>giab007_Reviewer_1_Report_Original_Submission</label>
      <caption>
        <p>Kai Ye -- 12/31/2020 Reviewed</p>
      </caption>
      <media xlink:href="giab007_reviewer_1_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>giab007_Reviewer_2_Report_Original_Submission</label>
      <caption>
        <p>Chris Chang -- 1/5/2021 Reviewed</p>
      </caption>
      <media xlink:href="giab007_reviewer_2_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>giab007_Supplemental_File</label>
      <media xlink:href="giab007_supplemental_file.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>The 1000 Genomes Project Consortium</collab>.</person-group>  <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>. <year>2015</year>;<volume>526</volume>:<fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Handsaker</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Wysoker</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>2078</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Auton</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Abecasis</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2156</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2987</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><comment>SAMtools, Version 1.11</comment>  <year>2020</year>
<ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/samtools/releases/tag/1.11">https://github.com/samtools/samtools/releases/tag/1.11</ext-link>. <comment>Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><comment>BCFtools, Version 1.11</comment><year>2020</year><ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/bcftools/releases/tag/1.11">https://github.com/samtools/bcftools/releases/tag/1.11</ext-link>. <comment> Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><comment>HTSJDK, Version 2.23.0.</comment>  <year>2020</year>
<comment><ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/htsjdk">https://github.com/samtools/htsjdk</ext-link>. Accessed 4 May 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarasov</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Vilella</surname>  <given-names>AJ</given-names></string-name>, <string-name><surname>Cuppen</surname>  <given-names>E</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Sambamba: fast processing of NGS alignment formats</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>:<fpage>2032</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">25697820</pub-id></mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name></person-group><article-title>The Scramble conversion tool</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>:<fpage>2818</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">24930138</pub-id></mixed-citation>
    </ref>
    <ref id="bib10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hsi-Yang Fritz</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Leinonen</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Cochrane</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Efficient storage of high throughput DNA sequencing data using reference-based compression</article-title>. <source>Genome Res</source>. <year>2011</year>;<volume>21</volume>:<fpage>734</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">21245279</pub-id></mixed-citation>
    </ref>
    <ref id="bib11">
      <label>11.</label>
      <mixed-citation publication-type="journal">
        <comment>CRAM homepage</comment>
        <year>2020</year>
        <comment><ext-link ext-link-type="uri" xlink:href="https://www.ga4gh.org/cram/">https://www.ga4gh.org/cram/</ext-link>. Accessed 6 November 2020.</comment>
      </mixed-citation>
    </ref>
    <ref id="bib12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buels</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Yao</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Diesh</surname>  <given-names>CM</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>JBrowse: a dynamic web platform for genome visualization and analysis</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>:<fpage>66</fpage>, doi:<pub-id pub-id-type="doi">10.1186/s13059-016-0924-1</pub-id>.<pub-id pub-id-type="pmid">27072794</pub-id></mixed-citation>
    </ref>
    <ref id="bib13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <comment>HTSlib, Version 1.11.</comment>  <year>2020</year>
<ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/htslib/releases/tag/1.11">https://github.com/samtools/htslib/releases/tag/1.11</ext-link>. <comment> Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duda</surname>  <given-names>J</given-names></string-name></person-group><article-title>Asymmetric numeral systems: entropy coding combining speed of Huffman coding with compression rate of arithmetic coding</article-title>. <comment>arXiv</comment>  <year>2013</year>: 1311.2540.</mixed-citation>
    </ref>
    <ref id="bib15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kelleher</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Lin</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Albach</surname>  <given-names>CH</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>htsget: a protocol for securely streaming genomic data</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>:<fpage>119</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">29931085</pub-id></mixed-citation>
    </ref>
    <ref id="bib16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>Improving SNP discovery by base alignment quality</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>1157</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21320865</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <label>17.</label>
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <string-name><surname>Li</surname>  <given-names>H</given-names></string-name>
        </person-group>
        <comment>Klib</comment>
        <year>2013</year>
        <comment><ext-link ext-link-type="uri" xlink:href="https://github.com/attractivechaos/klib">https://github.com/attractivechaos/klib</ext-link>. Accessed 27 November 2020.</comment>
      </mixed-citation>
    </ref>
    <ref id="bib18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Biggers</surname>  <given-names>E</given-names></string-name></person-group><comment>libdeflate, Version 1.7.</comment>  <year>2020</year>
<ext-link ext-link-type="uri" xlink:href="https://github.com/ebiggers/libdeflate">https://github.com/ebiggers/libdeflate</ext-link>.<comment> Accessed 6 November 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deutsch</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Gailly</surname>  <given-names>J-L</given-names></string-name></person-group><comment>ZLIB Compressed Data Format Specification version 3.3</comment><year>1996</year><pub-id pub-id-type="doi">10.17487/RFC1950</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bergström</surname>  <given-names>A</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>Hui</surname>  <given-names>R</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Insights into human genetic variation and population history from 929 diverse genomes</article-title>. <source>Science</source>. <year>2020</year>;<volume>367</volume>:<fpage>eaay5012</fpage>.<pub-id pub-id-type="pmid">32193295</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>National Human Genome Research Institute</collab>.</person-group>  <comment>DNA Sequencing Costs: Data.</comment>  <year>2020</year>
<ext-link ext-link-type="uri" xlink:href="https://www.genome.gov/about-genomics/fact-sheets/DNA-Sequencing-Costs-Data">https://www.genome.gov/about-genomics/fact-sheets/DNA-Sequencing-Costs-Data</ext-link>.<comment>Accessed 23 September 2020</comment>.</mixed-citation>
    </ref>
    <ref id="bib22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Birney</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Vamathevan</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Goodhand</surname>  <given-names>P</given-names></string-name></person-group><comment>Genomics in healthcare: GA4GH looks to 2022. bioRxiv</comment>  <year>2017</year>:<pub-id pub-id-type="doi">10.1101/203554</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib23">
      <label>23.</label>
      <mixed-citation publication-type="journal">
        <comment>Source file for hgdp_wgs.20190516.full.chr20. <ext-link ext-link-type="ftp" xlink:href="ftp://ngs.sanger.ac.uk/production/hgdp/hgdp_wgs.20190516/hgdp_wgs.20190516.full.chr20.vcf.gz">ftp://ngs.sanger.ac.uk/production/hgdp/hgdp_wgs.20190516/hgdp_wgs.20190516.full.chr20.vcf.gz</ext-link>. Accessed 27 November 2020.</comment>
      </mixed-citation>
    </ref>
    <ref id="bib24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Marshall</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Supporting data for “HTSlib - C library for reading/writing high-throughput sequencing data.”</article-title>. <source>GigaScience Database</source>. <year>2021</year>
<pub-id pub-id-type="doi">10.5524/100867</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Liddle</surname>  <given-names>J</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Twelve years of SAMtools and BCFtools</article-title>. <source>GigaScience</source>. <year>2021</year>;<bold>10</bold>(2): doi:10.1093/gigascience/giab008</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7931820</article-id>
    <article-id pub-id-type="pmid">33594436</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/giab007</article-id>
    <article-id pub-id-type="publisher-id">giab007</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00960</subject>
        <subject>AcademicSubjects/SCI02254</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>HTSlib: C library for reading/writing high-throughput sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6447-4112</contrib-id>
        <name>
          <surname>Bonfield</surname>
          <given-names>James K</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
        <xref ref-type="author-notes" rid="afn1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1216-5457</contrib-id>
        <name>
          <surname>Marshall</surname>
          <given-names>John</given-names>
        </name>
        <aff><institution>Wolfson Wohl Cancer Research Centre, Institute of Cancer Sciences, University of Glasgow</institution>, Switchback Road, Glasgow, G61 1QH, <country country="GB">UK</country></aff>
        <xref ref-type="author-notes" rid="afn1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4159-1666</contrib-id>
        <name>
          <surname>Danecek</surname>
          <given-names>Petr</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
        <xref ref-type="author-notes" rid="afn1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4874-2874</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <aff><institution>Department of Data Sciences, Dana-Farber Cancer Institute, 450 Brookline Avenue</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Informatics, Harvard Medical School, 10 Shattuck Street</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0532-6021</contrib-id>
        <name>
          <surname>Ohan</surname>
          <given-names>Valeriu</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8117-400X</contrib-id>
        <name>
          <surname>Whitwham</surname>
          <given-names>Andrew</given-names>
        </name>
        <!--<email>samtools@sanger.ac.uk</email>-->
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7532-6898</contrib-id>
        <name>
          <surname>Keane</surname>
          <given-names>Thomas</given-names>
        </name>
        <aff><institution>EMBL-EBI, Wellcome Genome Campus, Hinxton, Cambridgeshire</institution>, CB10 1SD, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9983-1378</contrib-id>
        <name>
          <surname>Davies</surname>
          <given-names>Robert M</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><bold>Correspondence address</bold>. Andrew Whitwham, Wellcome Sanger Institute, Wellcome Genome Campus, Hinxton, Cambridgeshire, CB10 1SA, UK. Tel: +44 (0)1223 834244; E-mail: <email>samtools@sanger.ac.uk</email></corresp>
      <fn id="afn1">
        <p>Contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub" iso-8601-date="2021-02-16">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>10</volume>
    <issue>2</issue>
    <elocation-id>giab007</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press GigaScience.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="giab007.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="abs1">
        <title>Background</title>
        <p>Since the original publication of the VCF and SAM formats, an explosion of software tools have been created to process these data files. To facilitate this a library was produced out of the original SAMtools implementation, with a focus on performance and robustness. The file formats themselves have become international standards under the jurisdiction of the Global Alliance for Genomics and Health.</p>
      </sec>
      <sec id="abs2">
        <title>Findings</title>
        <p>We present a software library for providing programmatic access to sequencing alignment and variant formats. It was born out of the widely used SAMtools and BCFtools applications. Considerable improvements have been made to the original code plus many new features including newer access protocols, the addition of the CRAM file format, better indexing and iterators, and better use of threading.</p>
      </sec>
      <sec id="abs3">
        <title>Conclusion</title>
        <p>Since the original Samtools release, performance has been considerably improved, with a BAM read-write loop running 5 times faster and BAM to SAM conversion 13 times faster (both using 16 threads, compared to Samtools 0.1.19). Widespread adoption has seen HTSlib downloaded &gt;1 million times from GitHub and conda. The C library has been used directly by an estimated 900 GitHub projects and has been incorporated into Perl, Python, Rust, and R, significantly expanding the number of uses via other languages. HTSlib is open source and is freely available from <ext-link ext-link-type="uri" xlink:href="http://htslib.org/">htslib.org</ext-link> under MIT/BSD license.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>samtools</kwd>
      <kwd>bcftools</kwd>
      <kwd>high-throughput sequencing</kwd>
      <kwd>next generation sequencing</kwd>
      <kwd>variant calling</kwd>
      <kwd>data analysis</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>206194</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Background</title>
    <p>When the 1000 Genomes Project [<xref rid="bib1" ref-type="bibr">1</xref>] was launched in early 2008, there were many short-read aligners and variant callers. Each of them had its own input or output format for limited use cases, and interoperability was a major challenge. Users were forced to implement bespoke format converters to bridge tools, and because formats encoded different information, this was time consuming, laborious, and sometimes impossible. This fragmented ecosystem hampered the collaboration between the participants of the project and delayed the development of advanced data analysis algorithms.</p>
    <p>In a conference call on 21 October 2008, the 1000 Genomes Project analysis subgroup decided to take on the issue by unifying a variety of short-read alignment formats into the Sequence Alignment/Map format (SAM). Towards the end of 2008 the subgroup announced the first SAM specification, detailing a text-based SAM format and its binary representation, the BAM format [<xref rid="bib2" ref-type="bibr">2</xref>]. SAM/BAM quickly replaced all the other short-read alignment formats and became the <italic>de facto</italic> standard in the analysis of high-throughput sequence data. In 2010, a Variant Call Format (VCF) was introduced for storing genetic variation [<xref rid="bib3" ref-type="bibr">3</xref>]. Later, in 2011, as the number of sequenced samples increased and the text format proved too slow to parse, a binary version BCF (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Fig. S1</xref>) was developed [<xref rid="bib4" ref-type="bibr">4</xref>].</p>
    <p>The SAM/BAM format originally came with a reference implementation, SAMtools [<xref rid="bib2" ref-type="bibr">2</xref>, <xref rid="bib5" ref-type="bibr">5</xref>], and VCF/BCF with VCFtools [<xref rid="bib3" ref-type="bibr">3</xref>] and BCFtools (then part of the SAMtools package) [<xref rid="bib6" ref-type="bibr">6</xref>]. Numerous other tools have been developed since then in a wide variety of programming languages. For example, HTSJDK is the Java equivalent [<xref rid="bib7" ref-type="bibr">7</xref>] and is used extensively in Java applications; Sambamba [<xref rid="bib8" ref-type="bibr">8</xref>] is written in the D language and focuses primarily on efficient multi-threaded work; Scramble [<xref rid="bib9" ref-type="bibr">9</xref>] has BAM and SAM capability and is the primary source for experimental CRAM [<xref rid="bib10" ref-type="bibr">10</xref>, <xref rid="bib11" ref-type="bibr">11</xref>] development; and JBrowse [<xref rid="bib12" ref-type="bibr">12</xref>] implements read-only support for multiple formats in JavaScript.</p>
    <p>While the original implementation of SAMtools and BCFtools provided APIs to parse the files, it mixed these APIs with application code. This did not guarantee long-term stability and made it difficult to interface in other programs. To solve this, in 2013 the decision was taken to separate the API from the command line tools and to produce HTSlib as a dedicated programming library that processes common data formats used in high-throughput sequencing. Support for the European Bioinformatics Institute's CRAM format was added and in 2014 the first official release (1.0) was published. This library implements stable and robust APIs that other programs can rely on. It enables efficient access to SAM/BAM/CRAM, VCF/BCF, FASTA, FASTQ, block-gzip compressed data, and indexes. It can be used natively in C/C++ code and has bindings to many other popular programming languages, such as Python, Rust, and R, boosting the development of sequence analysis tools.</p>
    <p>HTSlib is not merely a separation; it also brought numerous improvements to SAMtools, BCFtools, and other third-party programs depending on it. HTSlib is linked into ∼900 GitHub projects (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S2</xref>), and HTSlib itself has been forked &gt;300 times. HTSlib has been installed via bioconda &gt;1 million times, and there are ∼10,000 GitHub projects using it via Pysam. The library is freely available for commercial and non-commercial use (the MIT/BSD compatible license) from <ext-link ext-link-type="uri" xlink:href="http://htslib.org">htslib.org</ext-link> and GitHub [<xref rid="bib13" ref-type="bibr">13</xref>].</p>
  </sec>
  <sec id="sec2">
    <title>Findings</title>
    <sec id="sec2-1">
      <title>Implementation</title>
      <p>The main purpose of HTSlib is to provide access to genomic information files, both alignment data (SAM, BAM, and CRAM formats) and variant data (VCF and BCF formats). The library also provides interfaces to access and index genome reference data in FASTA format and tab-delimited files with genomic coordinates.</p>
      <p>Given the typical file sizes of genomic data, compression is necessary for efficient storage of data. HTSlib supports the GZIP-compatible format BGZF (Blocked GNU Zip Format), which limits the size of compressed blocks, thus allowing indexing and random access to the compressed files. HTSlib includes 2 stand-alone programs that work with BGZF; bgzip is a general-purpose compression tool while tabix works on tab-delimited genome coordinate files (e.g., BED and GFF) and provides indexing and random access. BGZF compression is also used for BAM, BCF, and compressed FASTA files. The CRAM format uses column-specific compression methods including gzip, rANS [<xref rid="bib14" ref-type="bibr">14</xref>], LZMA, and bzip2. The CRAM implementation in HTSlib learns the best-performing compression method on the fly (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S3</xref>).</p>
      <p>The HTSlib library is structured as follows: the media access layer (Fig. <xref ref-type="fig" rid="fig1">1a</xref>) is a collection of low-level system and library (libcurl, knet) functions, which facilitate access to files on different storage environments (disk, memory, network) and over multiple protocols to various online storage providers (AWS S3, Google Cloud, GA4GH htsget [<xref rid="bib15" ref-type="bibr">15</xref>]; Fig. <xref ref-type="fig" rid="fig1">1b</xref>). This functionality is transparently available through a unified low-level stream interface hFILE (Fig. <xref ref-type="fig" rid="fig1">1c</xref>). All file formats (Fig. <xref ref-type="fig" rid="fig1">1d</xref> and <xref ref-type="fig" rid="fig1">e</xref>) are accessible through a higher-level file format–agnostic htsFILE interface, which provides functions to detect file types and set write options and provides common code for file iterators. Building on this layer are specializations for alignment (SAM, BAM, and CRAM) and variant (VCF and BCF) files and various auxiliary functions (Fig. <xref ref-type="fig" rid="fig1">1f</xref> and <xref ref-type="fig" rid="fig1">g</xref>).</p>
      <fig id="fig1" orientation="portrait" position="float">
        <label>Figure 1:</label>
        <caption>
          <p>Htslib design.</p>
        </caption>
        <graphic xlink:href="giab007fig1"/>
      </fig>
      <p>This API (Fig. <xref ref-type="fig" rid="fig1">1f</xref> and <xref ref-type="fig" rid="fig1">g</xref>) can be roughly divided into several classes:</p>
      <list list-type="order">
        <list-item>
          <p>The File Access API has basic methods for opening and closing alignment and variant files, as well as reading and writing records to a file. HTSlib automatically determines the input file type by its contents and output type by filename. Further explicit control is provided for format, data layout (in CRAM), and file compression levels. Data sorted in genomic order may also be indexed at the time of writing (for alignment data) or at a later post-writing stage.</p>
        </list-item>
        <list-item>
          <p>The Header API is a collection of methods that enables extensive control of SAM and VCF headers, including reading, writing, and parsing the header, accessing and updating individual tags, and adding and removing header lines.</p>
        </list-item>
        <list-item>
          <p>The Data API provides methods for parsing, updating, and retrieving information from individual record fields on both alignment and variant data. The library also includes the ability to read multiple VCF and BCF files in parallel, transparently merging their contents, so that the reader can easily process records with matching genomic positions and alleles.</p>
        </list-item>
        <list-item>
          <p>The Index/Iterator API offers the ability to extract information from the various index formats specific to genomic data (BAI, CSI, CRAI, TBI), and to create iterators for genomic files. The original BAI and TBI indices were limited to 512 Mb and were replaced by CSI allowing ≤2<sup>44</sup> bp.</p>
          <p>Both sequence alignment and variant call formats have millions of records that can be indexed by genomic location. An iterator groups a list of target genomic regions into a list of file offsets and contains the stepping and filtering logic to allow the file reader to extract only the information of interest. Additionally, the library provides the regidx API, which allows the user to efficiently search and intersect regions from arbitrary row-oriented text formats.</p>
        </list-item>
        <list-item>
          <p>The Mpileup API performs a data pivot. Alignment data in SAM, BAM, and CRAM are retrieved in row-oriented format, record by record. Data rotation (merging ≥1 input files) presents the sequence data in a column-oriented form per reference position. This information can be used for single-nucleotide polymorphism and indel calling, consensus generation, and to make alignment viewers. Mpileup can also optionally calculate base alignment quality scores for each read [<xref rid="bib16" ref-type="bibr">16</xref>]. The base alignment quality scores can be used to reduce false-positive single-nucleotide polymorphism calls by lowering the confidence scores at locations where the read alignment may be incorrect.</p>
        </list-item>
        <list-item>
          <p>HTSlib also includes various utility convenience functions such as hash tables, string manipulation, linked lists, heaps, sorting, and logging, and ensures portability between big- and little-endian platforms. Many of these originate from Klib [<xref rid="bib17" ref-type="bibr">17</xref>]. A thread pool interface is provided for general multi-threading.</p>
        </list-item>
      </list>
    </sec>
    <sec id="sec2-2">
      <title>Benchmarks of sequence alignment formats</title>
      <p>Given the widespread use of the library, performance and low memory requirements are paramount, which means that even relatively small improvements can lead to time and energy savings when analyzing large amounts of data.</p>
      <p>To test maximum throughput for alignment data, elapsed times were obtained for each file type using both 1 main thread and also 16 additional worker threads. Not all tools supported indexing of all formats, and only in more recent HTSlib versions is there support for indexing and random access of BGZF-compressed SAM files. Full benchmarks are in <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S5</xref>, with a summary for BAM shown here in Fig. <xref ref-type="fig" rid="fig2">2</xref>.</p>
      <fig id="fig2" orientation="portrait" position="float">
        <label>Figure 2:</label>
        <caption>
          <p>BAM elapsed read/write times, with up to 16 threads available.</p>
        </caption>
        <graphic xlink:href="giab007fig2"/>
      </fig>
      <p>The tests were performed on a RAM disk (/dev/shm) so represent maximum I/O rates for this system.</p>
      <p>Figure <xref ref-type="fig" rid="fig2">2</xref> shows read and write elapsed timings for the BAM format on chromosome 1 of ENA accession ERR3239276. Note that “samtools 2013” refers to SAMtools version 0.1.19 and not the current SAMtools release. Other tool versions are HTSlib 1.10.2–32-ga22a0af, HTSJDK 2.22.0, Sambamba 0.7.1, and Scramble 1.14.13. These use up to 16 threads, but the HTSJDK times are with only 1 additional thread per file. SAMtools 0.1.19 has multi-threaded writing only, so the speed is limited by the reading portion. (See <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S4</xref> for full single-threaded and multi-threaded timings, along with benchmarks for the SAM and CRAM formats.)</p>
      <p>HTSlib was the only tool tested capable of multi-threaded SAM decoding and encoding, which is important when processing output from a fast multi-threaded aligner. The use of the faster compression library libdeflate [<xref rid="bib18" ref-type="bibr">18</xref>] over Zlib [<xref rid="bib19" ref-type="bibr">19</xref>] is also a major contributing factor in BAM performance, meaning that BAM to BAM transcoding with 16 threads is 5 times faster than the original SAMtools 0.1.19 and BAM to SAM is 13 times faster.</p>
      <p>File sizes also differ slightly for BAM, owing to differing Deflate implementations (Zlib, Libdeflate, and Intel deflate). HTSlib's CRAM size is 24% smaller than HTSJDK, while being 4 times faster (with a single thread), although the files remain compatible (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S5</xref>).</p>
      <p>To compare the random access capabilities of HTSlib we chose gene and exon regions from the Ensembl database across chromosome 1 and measured the time and I/O statistics to retrieve all alignments overlapping those regions. HTSlib, HTSJDK, and Sambamba all support a multi-region iterator that is able to optimize I/O for many regions, reporting alignments that overlap multiple regions once only. SAMtools 0.1.19 and Scramble have no such feature; hence, regions that overlap will report some records multiple times and the same block may be read more than once.</p>
      <p>The exon list had 58,160 regions (many overlapping each other) covering 5.5% of the chromosome. Figure <xref ref-type="fig" rid="fig3">3</xref> shows the random access efficiency, in both time and number of bytes read, for the exon list with BAM input. HTSlib is the fastest and requires less I/O to retrieve the same records.</p>
      <fig id="fig3" orientation="portrait" position="float">
        <label>Figure 3:</label>
        <caption>
          <p>Time and megabytes of data read, for exon list in BAM.</p>
        </caption>
        <graphic xlink:href="giab007fig3"/>
      </fig>
    </sec>
    <sec id="sec2-3">
      <title>Benchmarks of variant formats</title>
      <p>The only common format supported between current HTSlib/BCFtools and HTSJDK is BGZF-compressed VCF. Figure <xref ref-type="fig" rid="fig4">4</xref> shows the time to read and read/write this format on a 929-sample test set [<xref rid="bib20" ref-type="bibr">20</xref>] (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S8</xref>). The source file is hgdp_wgs.20 190 516.full.chr20.vcf.gz, aligned and called from ENA PRJEB6463. Only single thread times are shown because currently multi-threading is suboptimal in BCFtools and not available in HTSJDK.</p>
      <fig id="fig4" orientation="portrait" position="float">
        <label>Figure 4:</label>
        <caption>
          <p>VCF.gz and BCF read and read/write times, 929 samples.</p>
        </caption>
        <graphic xlink:href="giab007fig4"/>
      </fig>
      <p>HTSlib also supports the BGZF-compressed BCF format, a binary variant of VCF. This performs considerably better than the compressed VCF, being 5 times faster to decode and nearly 3 times faster to encode (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Tables S10 and S11</xref> for details and more complete results).</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec3">
    <title>Discussion</title>
    <p>Over the lifetime of HTSlib the cost of sequencing has decreased by ∼100-fold, with a corresponding increase in data volume [<xref rid="bib21" ref-type="bibr">21</xref>]. New sequencing technologies have also been developed that produce much longer reads. The alignment and variant file formats have moved on from being group-led research to being maintained by the File Formats subgroup of the Global Alliance for Genomics and Health [<xref rid="bib22" ref-type="bibr">22</xref>]. Over the years various improvements and modifications have been made to the specifications. Together these have been and will continue to be a driving force for continued development.</p>
    <p>Since HTSlib 1.0, there have been 11 major releases and &gt;1,600 code commits, more than doubling the number of lines of C code [<xref rid="bib15" ref-type="bibr">15</xref>]. It has gained support for the CRAM file format, better indexing, extended APIs, more transfer protocols (S3, Google Cloud, Htsget), and improved threading and speed. Through the use of automated tests, static analysis tools, and fuzz testing it has been made much more reliable (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S12</xref>).</p>
    <p>Some of the existing limitations in HTSlib come from the design of the underlying file formats, e.g., BAM, CRAM, and BCF limit the maximum reference length to 2 Gb (see <xref ref-type="supplementary-material" rid="sup6">Supplementary Section S13</xref>). We expect future standards development to include improvements leading to better scaling of many-sample VCF, additional support for structural variation, better handling of very long sequencing reads, large genomes, and support for base modifications. Further plans include speeding up both the VCF parser and mpileup, improved documentation, and better support for BED files.</p>
  </sec>
  <sec id="sec4">
    <title>Availability of Supporting Source Code and Requirements</title>
    <p>Project name: HTSlib</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/htslib">https://github.com/samtools/htslib</ext-link></p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: C</p>
    <p>License: A mix of Modified 2-Clause BSD (CRAM) and MIT/Expat (everything else)</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_002105">RRID:SCR_002105</ext-link>
    </p>
    <p>biotools: htslib</p>
  </sec>
  <sec sec-type="data-availability" id="sec5">
    <title>Data Availability</title>
    <p>The data set supporting the benchmarking results of this article is available in the ENA (ERR3239276 and PRJEB6463) and via FTP [<xref rid="bib23" ref-type="bibr">23</xref>]. Snapshots of the code are also available via the <italic>GigaScience</italic> GigaDB repository [<xref rid="bib24" ref-type="bibr">24</xref>].</p>
  </sec>
  <sec id="sec6">
    <title>Editors Note</title>
    <p>An accompanying article describing the latest versions of SAMtools and BCFtools is published alongside this article [<xref rid="bib25" ref-type="bibr">25</xref>].</p>
  </sec>
  <sec id="sec7">
    <title>Additional Files</title>
    <p>Supplementary Figure S1: Binary BCF vs VCF format</p>
    <p>Supplementary Section S2: Estimated number of HTSlib source code clones</p>
    <p>Supplementary Section S3: CRAM compression algorithm</p>
    <p>Supplementary Section S4: Performance of HTSlib's SAM, BAM, CRAM implementations</p>
    <p>Supplementary Table S5: Read and read/write timings for tools and file formats</p>
    <p>Supplementary Table S6: Random access times and data volumes, single thread</p>
    <p>Supplementary Table S7: Random access times and data volumes, 8 threads</p>
    <p>Supplementary Section S8. Performance of HTSlib's VCF, BCF implementations</p>
    <p>Supplementary Figure S9: VCF and BCF read and read/write speeds</p>
    <p>Supplementary Table S10: Multi-sample VCF and BCF performance</p>
    <p>Supplementary Table S11: Single-sample VCF and BCF performance</p>
    <p>Supplementary Section S12: Automatic testing</p>
    <p>Supplementary Section S13: The format size limitations</p>
  </sec>
  <sec id="sec8">
    <title>Abbreviations</title>
    <p>API: Application Programming Interface; BAM: Binary sequence Alignment/MAP; bp: base pairs; BCF: Binary variant Call Format; BGZF: Blocked GNU Zip Format; ENA: European Nucleotide Archive; Gb: gigabase pairs; Mb: megabase pairs; RAM: random access memory; SAM: Sequence Alignment/Map; VCF: Variant Call Format.</p>
  </sec>
  <sec id="sec9">
    <title>Competing Interests</title>
    <p>The authors declare they have no competing interests.</p>
  </sec>
  <sec id="sec10">
    <title>Funding</title>
    <p>This work was supported by the Wellcome Trust grant (206194).</p>
  </sec>
  <sec id="sec11">
    <title>Authors' contributions</title>
    <p>J.K.B., P.D., R.M.D., H.L., J.M., V.O., and A.W. wrote the software. R.M.D., T.K., and J.M. supervised the project. J.K.B., P.D., R.M.D., and A.W. wrote the original draft of the manuscript with all authors reviewing.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>giab007_GIGA-D-20-00368_Original_Submission</label>
      <media xlink:href="giab007_giga-d-20-00368_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>giab007_GIGA-D-20-00368_Revision_1</label>
      <media xlink:href="giab007_giga-d-20-00368_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>giab007_Response_to_Reviewer_Comments_Original_Submission</label>
      <media xlink:href="giab007_response_to_reviewer_comments_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>giab007_Reviewer_1_Report_Original_Submission</label>
      <caption>
        <p>Kai Ye -- 12/31/2020 Reviewed</p>
      </caption>
      <media xlink:href="giab007_reviewer_1_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>giab007_Reviewer_2_Report_Original_Submission</label>
      <caption>
        <p>Chris Chang -- 1/5/2021 Reviewed</p>
      </caption>
      <media xlink:href="giab007_reviewer_2_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>giab007_Supplemental_File</label>
      <media xlink:href="giab007_supplemental_file.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>The 1000 Genomes Project Consortium</collab>.</person-group>  <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>. <year>2015</year>;<volume>526</volume>:<fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Handsaker</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Wysoker</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>2078</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Auton</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Abecasis</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2156</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2987</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><comment>SAMtools, Version 1.11</comment>  <year>2020</year>
<ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/samtools/releases/tag/1.11">https://github.com/samtools/samtools/releases/tag/1.11</ext-link>. <comment>Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><comment>BCFtools, Version 1.11</comment><year>2020</year><ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/bcftools/releases/tag/1.11">https://github.com/samtools/bcftools/releases/tag/1.11</ext-link>. <comment> Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><comment>HTSJDK, Version 2.23.0.</comment>  <year>2020</year>
<comment><ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/htsjdk">https://github.com/samtools/htsjdk</ext-link>. Accessed 4 May 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarasov</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Vilella</surname>  <given-names>AJ</given-names></string-name>, <string-name><surname>Cuppen</surname>  <given-names>E</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Sambamba: fast processing of NGS alignment formats</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>:<fpage>2032</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">25697820</pub-id></mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name></person-group><article-title>The Scramble conversion tool</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>:<fpage>2818</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">24930138</pub-id></mixed-citation>
    </ref>
    <ref id="bib10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hsi-Yang Fritz</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Leinonen</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Cochrane</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Efficient storage of high throughput DNA sequencing data using reference-based compression</article-title>. <source>Genome Res</source>. <year>2011</year>;<volume>21</volume>:<fpage>734</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">21245279</pub-id></mixed-citation>
    </ref>
    <ref id="bib11">
      <label>11.</label>
      <mixed-citation publication-type="journal">
        <comment>CRAM homepage</comment>
        <year>2020</year>
        <comment><ext-link ext-link-type="uri" xlink:href="https://www.ga4gh.org/cram/">https://www.ga4gh.org/cram/</ext-link>. Accessed 6 November 2020.</comment>
      </mixed-citation>
    </ref>
    <ref id="bib12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buels</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Yao</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Diesh</surname>  <given-names>CM</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>JBrowse: a dynamic web platform for genome visualization and analysis</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>:<fpage>66</fpage>, doi:<pub-id pub-id-type="doi">10.1186/s13059-016-0924-1</pub-id>.<pub-id pub-id-type="pmid">27072794</pub-id></mixed-citation>
    </ref>
    <ref id="bib13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <comment>HTSlib, Version 1.11.</comment>  <year>2020</year>
<ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/htslib/releases/tag/1.11">https://github.com/samtools/htslib/releases/tag/1.11</ext-link>. <comment> Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duda</surname>  <given-names>J</given-names></string-name></person-group><article-title>Asymmetric numeral systems: entropy coding combining speed of Huffman coding with compression rate of arithmetic coding</article-title>. <comment>arXiv</comment>  <year>2013</year>: 1311.2540.</mixed-citation>
    </ref>
    <ref id="bib15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kelleher</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Lin</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Albach</surname>  <given-names>CH</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>htsget: a protocol for securely streaming genomic data</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>:<fpage>119</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">29931085</pub-id></mixed-citation>
    </ref>
    <ref id="bib16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>Improving SNP discovery by base alignment quality</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>1157</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21320865</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <label>17.</label>
      <mixed-citation publication-type="journal">
        <person-group person-group-type="author">
          <string-name><surname>Li</surname>  <given-names>H</given-names></string-name>
        </person-group>
        <comment>Klib</comment>
        <year>2013</year>
        <comment><ext-link ext-link-type="uri" xlink:href="https://github.com/attractivechaos/klib">https://github.com/attractivechaos/klib</ext-link>. Accessed 27 November 2020.</comment>
      </mixed-citation>
    </ref>
    <ref id="bib18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Biggers</surname>  <given-names>E</given-names></string-name></person-group><comment>libdeflate, Version 1.7.</comment>  <year>2020</year>
<ext-link ext-link-type="uri" xlink:href="https://github.com/ebiggers/libdeflate">https://github.com/ebiggers/libdeflate</ext-link>.<comment> Accessed 6 November 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deutsch</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Gailly</surname>  <given-names>J-L</given-names></string-name></person-group><comment>ZLIB Compressed Data Format Specification version 3.3</comment><year>1996</year><pub-id pub-id-type="doi">10.17487/RFC1950</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bergström</surname>  <given-names>A</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>Hui</surname>  <given-names>R</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Insights into human genetic variation and population history from 929 diverse genomes</article-title>. <source>Science</source>. <year>2020</year>;<volume>367</volume>:<fpage>eaay5012</fpage>.<pub-id pub-id-type="pmid">32193295</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>National Human Genome Research Institute</collab>.</person-group>  <comment>DNA Sequencing Costs: Data.</comment>  <year>2020</year>
<ext-link ext-link-type="uri" xlink:href="https://www.genome.gov/about-genomics/fact-sheets/DNA-Sequencing-Costs-Data">https://www.genome.gov/about-genomics/fact-sheets/DNA-Sequencing-Costs-Data</ext-link>.<comment>Accessed 23 September 2020</comment>.</mixed-citation>
    </ref>
    <ref id="bib22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Birney</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Vamathevan</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Goodhand</surname>  <given-names>P</given-names></string-name></person-group><comment>Genomics in healthcare: GA4GH looks to 2022. bioRxiv</comment>  <year>2017</year>:<pub-id pub-id-type="doi">10.1101/203554</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib23">
      <label>23.</label>
      <mixed-citation publication-type="journal">
        <comment>Source file for hgdp_wgs.20190516.full.chr20. <ext-link ext-link-type="ftp" xlink:href="ftp://ngs.sanger.ac.uk/production/hgdp/hgdp_wgs.20190516/hgdp_wgs.20190516.full.chr20.vcf.gz">ftp://ngs.sanger.ac.uk/production/hgdp/hgdp_wgs.20190516/hgdp_wgs.20190516.full.chr20.vcf.gz</ext-link>. Accessed 27 November 2020.</comment>
      </mixed-citation>
    </ref>
    <ref id="bib24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Marshall</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Supporting data for “HTSlib - C library for reading/writing high-throughput sequencing data.”</article-title>. <source>GigaScience Database</source>. <year>2021</year>
<pub-id pub-id-type="doi">10.5524/100867</pub-id>.</mixed-citation>
    </ref>
    <ref id="bib25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Liddle</surname>  <given-names>J</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Twelve years of SAMtools and BCFtools</article-title>. <source>GigaScience</source>. <year>2021</year>;<bold>10</bold>(2): doi:10.1093/gigascience/giab008</mixed-citation>
    </ref>
  </ref-list>
</back>
