<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5870678</article-id>
    <article-id pub-id-type="pmid">28633385</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx377</article-id>
    <article-id pub-id-type="publisher-id">btx377</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Data and Text Mining</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TIminer: NGS data mining pipeline for cancer immunology and immunotherapy</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tappeiner</surname>
          <given-names>Elias</given-names>
        </name>
        <xref ref-type="aff" rid="btx377-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Finotello</surname>
          <given-names>Francesca</given-names>
        </name>
        <xref ref-type="aff" rid="btx377-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Charoentong</surname>
          <given-names>Pornpimol</given-names>
        </name>
        <xref ref-type="aff" rid="btx377-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mayer</surname>
          <given-names>Clemens</given-names>
        </name>
        <xref ref-type="aff" rid="btx377-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Rieder</surname>
          <given-names>Dietmar</given-names>
        </name>
        <xref ref-type="aff" rid="btx377-aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Trajanoski</surname>
          <given-names>Zlatko</given-names>
        </name>
        <xref ref-type="corresp" rid="btx377-cor1"/>
        <xref ref-type="aff" rid="btx377-aff1"/>
        <!--<email>zlatko.trajanoski@i-med.ac.at</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Wren</surname>
          <given-names>Jonathan</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx377-aff1">Division of Bioinformatics, Biocenter, Medical University of Innsbruck, Innsbruck, Austria</aff>
    <author-notes>
      <corresp id="btx377-cor1">To whom correspondence should be addressed. Email: <email>zlatko.trajanoski@i-med.ac.at</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-06-15">
      <day>15</day>
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>15</day>
      <month>6</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>19</issue>
    <fpage>3140</fpage>
    <lpage>3141</lpage>
    <history>
      <date date-type="received">
        <day>22</day>
        <month>2</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>28</day>
        <month>4</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>08</day>
        <month>6</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/" license-type="cc-by">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx377.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="S1">
        <title>Summary</title>
        <p>Recently, a number of powerful computational tools for dissecting tumor-immune cell interactions from next-generation sequencing data have been developed. However, the assembly of analytical pipelines and execution of multi-step workflows are laborious and involve a large number of intermediate steps with many dependencies and parameter settings. Here we present TIminer, an easy-to-use computational pipeline for mining tumor-immune cell interactions from next-generation sequencing data. TIminer enables integrative immunogenomic analyses, including: human leukocyte antigens typing, neoantigen prediction, characterization of immune infiltrates and quantification of tumor immunogenicity.</p>
      </sec>
      <sec id="S2">
        <title>Availability and implementation</title>
        <p>TIminer is freely available at <ext-link ext-link-type="uri" xlink:href="http://icbi.i-med.ac.at/software/timiner/timiner.shtml">http://icbi.i-med.ac.at/software/timiner/timiner.shtml</ext-link>.</p>
      </sec>
      <sec id="S3">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Austrian Science Fund</named-content>
          <named-content content-type="funder-identifier">10.13039/501100002428</named-content>
        </funding-source>
        <award-id>W1101-B18</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Austrian National Bank</named-content>
          <named-content content-type="funder-identifier">10.13039/501100004061</named-content>
        </funding-source>
        <award-id>16534</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Recent breakthroughs in cancer immunotherapy and decreasing costs of next-generation sequencing (NGS) technologies sparked intensive research into tumor-immune cell interactions using genomic tools. The wealth of the generated data and the added complexity pose considerable challenges and require computational tools to process, analyze and visualize the data. Recently, several tools and analytical pipelines have been developed and used to effectively mine tumor immunologic and genomic data and extract information relevant for cancer immunology and immunotherapy that includes: human leukocyte antigens (HLAs) typing, prediction of neoantigens (non-self tumor antigens predicted from somatic mutations binding specific HLA types), tumor-infiltrating immune cells estimated from RNA-sequencing (RNA-seq) data, and expression levels of key molecules like immune checkpoints (e.g. cytotoxic T-lymphocyte-associated antigen 4 (CTLA4) and programmed cell death protein 1 (PD1) and major histocompatibility complex molecules (see our recent review (<xref rid="btx377-B5" ref-type="bibr">Hackl <italic>et al.</italic>, 2016</xref>)). However, to the best of our knowledge, there is currently no easy-to-use analytical pipeline to perform integrative immunogenomic analyses. Several tools have been recently published but provide only limited functionality like the identification of tumor neoantigens (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>). Moreover, assembly of such analytical pipelines and execution of multi-step workflows are laborious and involves a large number of intermediate steps with many dependencies and parameter settings.</p>
    <p>We therefore developed TIminer (Tumor Immunology miner), an analytical pipeline to perform integrative immunogenomic analyses using NGS data that is easy to install and use. TIminer integrates state-of-the-art bioinformatics tools to analyze single-sample RNA-seq data and somatic DNA mutations to characterize the tumor-immune interface including: (i) genotyping of HLAs from NGS data, (ii) prediction of tumor neoantigens using mutation data and HLA types, (iii) characterization of tumor-infiltrating immune cells from bulk RNA-seq data; and (iv) quantification of tumor immunogenicity from expression data.</p>
  </sec>
  <sec>
    <title>2 Tool description</title>
    <p>TIminer considers RNA-seq reads and somatic DNA mutations to perform immunogenomic analyses (<xref ref-type="fig" rid="btx377-F1">Fig. 1</xref>). RNA-seq reads must be provided as FASTQ files, whereas files of somatic DNA mutations should follow the Variant Call Format. The different analyses, together with their input and output data, are described in the following.
</p>
    <fig id="btx377-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>The scheme illustrates the different computational tools integrated in TIminer, the input/output data, and the data flow between the tools</p>
      </caption>
      <graphic xlink:href="btx377f1"/>
    </fig>
    <list list-type="bullet">
      <list-item>
        <p>RNA-seq FASTQ files are used to quantify gene expression with Kallisto (<xref rid="btx377-B3" ref-type="bibr">Bray <italic>et al.</italic>, 2016</xref>) as: gene-specific counts, transcripts per millions (TPM), and normalized log<sub>2</sub>(TPM+1).</p>
      </list-item>
      <list-item>
        <p>FASTQ files are analyzed with Optitype (<xref rid="btx377-B9" ref-type="bibr">Szolek <italic>et al.</italic>, 2014</xref>) to predict class-I HLA types. The output reports the four-digit predictions of the HLA-A, HLA-B and HLA-C alleles.</p>
      </list-item>
      <list-item>
        <p>Normalized log<sub>2</sub>(TPM+1) are used to estimate the enrichment of tumor-infiltrating immune cell types through gene set enrichment analysis (<xref rid="btx377-B8" ref-type="bibr">Subramanian <italic>et al.</italic>, 2005</xref>) selecting between three different gene-set schemes (<xref rid="btx377-B1" ref-type="bibr">Angelova <italic>et al.</italic>, 2015</xref>; <xref rid="btx377-B2" ref-type="bibr">Aran <italic>et al.</italic>, 2017</xref>; <xref rid="btx377-B4" ref-type="bibr">Charoentong <italic>et al.</italic>, 2017</xref>) or providing a file with custom gene sets. The output files report the normalized enrichment scores and the associated false discovery rate (FDR)-corrected <italic>P</italic>-values.</p>
      </list-item>
      <list-item>
        <p>Normalized log<sub>2</sub>(TPM+1) are also used to depict the major determinants of tumor immunogenicity through an immonophenogram and to compute the immunophenoscore, representing the overall tumor immunogenicity (<xref rid="btx377-B4" ref-type="bibr">Charoentong <italic>et al.</italic>, 2017</xref>).</p>
      </list-item>
      <list-item>
        <p>Single-nucleotide DNA mutations affecting coding regions are annotated by VEP (<xref rid="btx377-B6" ref-type="bibr">McLaren <italic>et al.</italic>, 2016</xref>) and used to predict the sequences of the affected proteins.</p>
      </list-item>
      <list-item>
        <p>The mutated proteins arising from missense mutations, together with the predicted class-I HLA types, are subjected to NetMHCpan (<xref rid="btx377-B7" ref-type="bibr">Nielsen and Andreatta, 2016</xref>) to predict mutated peptides binding to HLA molecules.</p>
      </list-item>
      <list-item>
        <p>Binding peptides are filtered considering TPM to select only candidate neoantigens arising from expressed genes. Alternatively, sensitive filtering of neoantigens can be performed considering allele-specific gene expression (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).</p>
      </list-item>
    </list>
  </sec>
  <sec>
    <title>3 Implementation</title>
    <p>The computational tools performing the immunogenomic analyses integrated in the pipeline have different dependencies, interfaces, and input/output data formats. The installation and assembly of such tools is very laborious and time consuming. TIminer was explicitly designed and implemented to overcome these drawbacks.</p>
    <p>The software was pre-built into a ready-to-use Docker image to speed up and simplify the installation process, thereby preventing possible dependency issues and version conflicts. The TIminer framework can be installed on Unix operating systems, including Mac OS, using a one-click installer. In order to simplify the access to the individual tools, we provide a unified Python application programming interface (API). The TIminerAPI wraps the tool calls into the Docker image, introduces parallel execution traces to optimize the computation, and handles all required data pre- and post-processing steps. The single tools are accessible over the TIminerAPI individually or can be run together as part of the full pipeline, available as a python script. In addition, TIminer encloses a graphical user interface that enables single-patient data analysis on standard desktop computer.</p>
    <p>Given the size of NGS input data, we recommend analysis of large cohorts of patients with TIminer on computing cluster units, which are available in many institutions. Single-patient data can be analyzed on desktop computers or laptops. Example files, provided within the TIminer package, can be used to test the full pipeline (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).</p>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>We present here TIminer, the first analytical pipeline that performs integrative immunogenomic analyses from NGS data including HLA typing, neoantigen prediction, characterization of immune infiltrates, and quantification of tumor immunogenicity. Moreover, the pre-built and ready-to-use Docker image enables simple installation procedure. Hence, TIminer represents a valuable tool for basic and translational research in cancer immunology and can expedite the development of precision immuno-oncology. Although developed for cancer immunology and immunotherapy, TIminer provides the means to study also autoimmune, inflammatory, or infectious diseases.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the Austrian Science Fund (FWF): W1101-B18 (DK Molecular Cell Biology and Oncology), the European Union's Horizon 2020 research and innovation program under grant agreement No. 633592 (project APERIM: Advanced Bioinformatics Tools for Personalised Cancer Immunotherapy), and the Austrian National Bank (Jubiläumsfondsprojekt No. 16534).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Material</label>
      <media xlink:href="supplementary_material_btx377.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btx377-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Angelova</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Characterization of the immunophenotypes and antigenomes of colorectal cancers reveals distinct tumor escape mechanisms and novel targets for immunotherapy</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>64</fpage>.<pub-id pub-id-type="pmid">25853550</pub-id></mixed-citation>
    </ref>
    <ref id="btx377-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Aran</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>xcell: digitally portraying the tissue cellular heterogeneity landscape</article-title>. bioRxiv, Jun. 2017. doi: https://doi.org/10.1101/114165.</mixed-citation>
    </ref>
    <ref id="btx377-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bray</surname><given-names>N.L.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Near-optimal probabilistic RNA-seq quantification</article-title>. <source>Nat. Biotechnol</source>., <volume>34</volume>, <fpage>525</fpage>–<lpage>527</lpage>.<pub-id pub-id-type="pmid">27043002</pub-id></mixed-citation>
    </ref>
    <ref id="btx377-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Charoentong</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Pan-cancer immunogenomic analyses reveal genotype-immunophenotype relationships and predictors of response to checkpoint blockade</article-title>. <source>Cell Rep</source>., <volume>18</volume>, <fpage>248</fpage>–<lpage>262</lpage>.<pub-id pub-id-type="pmid">28052254</pub-id></mixed-citation>
    </ref>
    <ref id="btx377-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hackl</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Computational genomics tools for dissecting tumour-immune cell interactions</article-title>. <source>Nat. Rev. Genet</source>., <volume>17</volume>, <fpage>441</fpage>–<lpage>458</lpage>.<pub-id pub-id-type="pmid">27376489</pub-id></mixed-citation>
    </ref>
    <ref id="btx377-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McLaren</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>The Ensembl variant effect predictor</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>122.</fpage><pub-id pub-id-type="pmid">27268795</pub-id></mixed-citation>
    </ref>
    <ref id="btx377-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nielsen</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Andreatta</surname><given-names>M.</given-names></name></person-group> (<year>2016</year>) 
<article-title>NetMHCpan-3.0; improved prediction of binding to MHC class I molecules integrating information from multiple receptor and peptide length datasets</article-title>. <source>Genome Med</source>., <volume>8</volume>, <fpage>33.</fpage><pub-id pub-id-type="pmid">27029192</pub-id></mixed-citation>
    </ref>
    <ref id="btx377-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Subramanian</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>102</volume>, <fpage>15545</fpage>–<lpage>15550</lpage>.<pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="btx377-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Szolek</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>OptiType: precision HLA typing from next-generation sequencing data</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>3310</fpage>–<lpage>3316</lpage>.<pub-id pub-id-type="pmid">25143287</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
