<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4528625</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv193</article-id>
    <article-id pub-id-type="publisher-id">btv193</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>EBSeq-HMM: a Bayesian approach for identifying gene-expression changes in ordered RNA-seq experiments</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Leng</surname>
          <given-names>Ning</given-names>
        </name>
        <xref ref-type="aff" rid="btv193-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btv193-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Yuan</given-names>
        </name>
        <xref ref-type="aff" rid="btv193-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McIntosh</surname>
          <given-names>Brian E.</given-names>
        </name>
        <xref ref-type="aff" rid="btv193-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nguyen</surname>
          <given-names>Bao Kim</given-names>
        </name>
        <xref ref-type="aff" rid="btv193-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Duffin</surname>
          <given-names>Bret</given-names>
        </name>
        <xref ref-type="aff" rid="btv193-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tian</surname>
          <given-names>Shulan</given-names>
        </name>
        <xref ref-type="aff" rid="btv193-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Thomson</surname>
          <given-names>James A.</given-names>
        </name>
        <xref ref-type="aff" rid="btv193-AFF2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="btv193-AFF3">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="btv193-AFF4">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dewey</surname>
          <given-names>Colin N.</given-names>
        </name>
        <xref ref-type="aff" rid="btv193-AFF5">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stewart</surname>
          <given-names>Ron</given-names>
        </name>
        <xref ref-type="aff" rid="btv193-AFF2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kendziorski</surname>
          <given-names>Christina</given-names>
        </name>
        <xref ref-type="aff" rid="btv193-AFF5">
          <sup>5</sup>
        </xref>
        <xref ref-type="corresp" rid="btv193-COR1">*</xref>
      </contrib>
      <aff id="btv193-AFF1"><sup>1</sup>Department of Statistics, University of Wisconsin, Madison, WI, USA,</aff>
      <aff id="btv193-AFF2"><sup>2</sup>Regenerative Biology, Morgridge Institute for Research, Madison, WI, USA,</aff>
      <aff id="btv193-AFF3"><sup>3</sup>Department of Cell and Regenerative Biology, University of Wisconsin School of Medicine and Public Health, Madison, WI, USA,</aff>
      <aff id="btv193-AFF4"><sup>4</sup>Department of Molecular, Cellular, and Developmental Biology, University of California, Santa Barbara, CA, USA and</aff>
      <aff id="btv193-AFF5"><sup>5</sup>Department of Biostatistics and Medical Informatics, University of Wisconsin, Madison, WI, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btv193-COR1">*To whom correspondence should be addressed.</corresp>
      <fn id="FN1">
        <p>Associate Editor: Inanc Birol</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>8</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>05</day>
      <month>4</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>4</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>31</volume>
    <issue>16</issue>
    <fpage>2614</fpage>
    <lpage>2622</lpage>
    <history>
      <date date-type="received">
        <day>14</day>
        <month>10</month>
        <year>2014</year>
      </date>
      <date date-type="rev-recd">
        <day>23</day>
        <month>2</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>3</month>
        <year>2015</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> With improvements in next-generation sequencing technologies and reductions in price, ordered RNA-seq experiments are becoming common. Of primary interest in these experiments is identifying genes that are changing over time or space, for example, and then characterizing the specific expression changes. A number of robust statistical methods are available to identify genes showing differential expression among multiple conditions, but most assume conditions are exchangeable and thereby sacrifice power and precision when applied to ordered data.</p>
      <p><bold>Results:</bold> We propose an empirical Bayes mixture modeling approach called EBSeq-HMM. In EBSeq-HMM, an auto-regressive hidden Markov model is implemented to accommodate dependence in gene expression across ordered conditions. As demonstrated in simulation and case studies, the output proves useful in identifying differentially expressed genes and in specifying gene-specific expression paths. EBSeq-HMM may also be used for inference regarding isoform expression.</p>
      <p><bold>Availability and implementation:</bold> An R package containing examples and sample datasets is available at Bioconductor.</p>
      <p>
        <bold>Contact:</bold>
        <email>kendzior@biostat.wisc.edu</email>
      </p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv193/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>With improvements in next-generation sequencing technologies and reductions in price, ordered RNA-seq experiments are becoming common. Of primary interest in these experiments is characterizing how genes are changing over some factor with ordered levels (for example, ordered in time, in space, along a gradient, etc). For simplicity, we refer to any ordered RNA-seq experiment as a time-course experiment, noting that other similar designs may be analyzed within this framework; and we restrict attention to time-course data collected within a single biological condition.</p>
    <p>In a time-course RNA-seq experiment, an investigator may be interested in genes that are monotonically increasing or decreasing, that increase initially then decrease, that increase initially then remain unchanged and so on. We refer to these types of changes in expression hereinafter as <italic>expression paths</italic>, and we consider three broad types: (i) constant paths: expression remains unchanged, or equally expressed (EE), over all time points; (ii) sporadic paths: expression shows some change between at least one pair of time points, but remains unchanged between at least one other pair and (iii) dynamic paths: expression changes continuously. With respect to the examples listed earlier, the first few (expression is monotonically increasing, monotonically decreasing, increasing then decreasing) are instances of dynamic paths. The last (increase initially then remain unchanged) is an example of a sporadic path.</p>
    <p>A number of robust statistical methods are available for identifying differentially expressed (DE) genes [EBSeq (<xref rid="btv193-B17" ref-type="bibr">Leng <italic>et</italic>
<italic>al.</italic>, 2013</xref>), DESeq2 (<xref rid="btv193-B19" ref-type="bibr">Love <italic>et</italic>
<italic>al.</italic>, 2014</xref>), edgeR (<xref rid="btv193-B26" ref-type="bibr">Robinson <italic>et</italic>
<italic>al.</italic>, 2010</xref>), voom (<xref rid="btv193-B16" ref-type="bibr">Law <italic>et</italic>
<italic>al.</italic>, 2014</xref>), baySeq (<xref rid="btv193-B13" ref-type="bibr">Hardcastle and Kelly, 2010</xref>), Cuffdiff2 (<xref rid="btv193-B30" ref-type="bibr">Trapnell <italic>et</italic>
<italic>al.</italic>, 2012</xref>)] as well as isoforms [EBSeq, rSeqDiff (<xref rid="btv193-B28" ref-type="bibr">Shi and Jiang, 2013</xref>), Cuffdiff2, BitSeq (<xref rid="btv193-B11" ref-type="bibr">Glaus <italic>et</italic>
<italic>al.</italic>, 2012</xref>)] in a static RNA-seq experiment; and most of these methods accommodate time-course experiments by considering time as a factor with multiple, unordered, levels (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv193/-/DC1">Supplementary Section S7</ext-link> provides details). The statistical tests employed are designed to identify a gene as DE if it shows a change at least one time point; and, consequently, non-constant genes are detected collectively. Multiple steps of subsequent analyses are required if an investigator wants to distinguish sporadic paths from dynamic ones, to classify genes into distinct paths and to assess the associated classification uncertainty—for example, perform model fitting multiple times with different design matrices and then adjust for multiple testing. In addition, as these approaches were not designed specifically for time-course experiments, they do not accommodate dependence over time and consequently sacrifice power if applied in this setting.</p>
    <p>These same issues were addressed in the context of microarray time-course experiments, and a number of methods are available for analyzing (<xref rid="btv193-B7" ref-type="bibr">Conesa <italic>et</italic>
<italic>al</italic><italic>.</italic>, 2006</xref>; <xref rid="btv193-B10" ref-type="bibr">Filkov <italic>et</italic>
<italic>al</italic><italic>.</italic>, 2002</xref>; <xref rid="btv193-B21" ref-type="bibr">Ma <italic>et</italic>
<italic>al</italic><italic>.</italic>, 2009</xref>; <xref rid="btv193-B32" ref-type="bibr">Yuan and Kendziorski, 2006</xref>) and clustering (<xref rid="btv193-B9" ref-type="bibr">Ernst <italic>et</italic>
<italic>al</italic><italic>.</italic>, 2005</xref>; <xref rid="btv193-B20" ref-type="bibr">Luan and Li, 2003</xref>) time-course microarray data. These methods are not directly applicable to RNA-seq studies since they do not accommodate count data, the unequal variabilities in measurements or the dependence of isoforms within genes. To address this, the approach developed by <xref rid="btv193-B7" ref-type="bibr">Conesa <italic>et</italic>
<italic>al.</italic> (2006)</xref>, maSigPro, originally developed for microarray time-course analysis, was recently extended to accommodate ordered RNA-seq count data (<xref rid="btv193-B22" ref-type="bibr">Nueda <italic>et</italic>
<italic>al.</italic>, 2014</xref>). Like DESeq2 and edgeR, maSigPro-GLM is based on a negative binomial (NB) generalized linear model (GLM); but unlike previous approaches, maSigPro-GLM defines gene-specific expected expression by a time-dependent polynomial to accommodate dependence over time. Once significant genes are selected, a second regression is conducted for each gene to identify the time points at which it shows expression differences. Clustering algorithms are then applied to the resulting regression coefficients and/or expression values to identify groups of genes with similar expression profiles. Although useful the two step procedure makes it challenging to determine appropriate thresholds for false discovery rate (FDR) control, and suggested thresholds are conservative in many settings (<xref rid="btv193-B22" ref-type="bibr">Nueda <italic>et</italic>
<italic>al.</italic>, 2014</xref>). In addition, identified gene groups are subject to limitations inherent in clustering algorithms; namely, the number of groups as well as group membership are determined by user-defined cutoffs, there is no probabilistic information associated with a given gene’s membership within a group, and it is not clear how to classify gene groups into expression paths.</p>
    <p>To address these considerations, we have developed an empirical Bayes auto-regressive hidden Markov model (HMM) based approach called EBSeq-HMM. The model extends our previous work, EBSeq, for identifying DE genes and isoforms across two or more biological conditions (<xref rid="btv193-B17" ref-type="bibr">Leng <italic>et</italic>
<italic>al.</italic>, 2013</xref>). As detailed in Methods, an auto-regressive process describes changes in expression over time, and a hidden Markov component is used to accommodate dependence. EBSeq-HMM allows users to identify genes with non-constant expression over multiple ordered conditions, and simultaneously classify them into expression paths. Results from a simulation study, detailed in Section 3.1, suggest that EBSeq-HMM has increased power over competing approaches for identifying genes following non-constant paths, especially for those genes showing subtle yet consistent changes over time. EBSeq-HMM also provides improved accuracy in classifying genes into expression paths. Similar results are demonstrated in a case study of the adult mouse limb presented in Section 3.2.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <sec>
      <title>2.1 EBSeq-HMM: an empirical Bayes auto-regressive Hidden Markov model</title>
      <p>EBSeq-HMM requires estimates of gene or isoform expression collected over three or more ordered levels of a factor. The general model is presented for gene-level analysis; the isoform-level model is discussed in Section 2.3. To simplify the presentation, we refer to ordered levels as time points denoted by <inline-formula><mml:math id="MM1"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>, noting that the method directly accommodates other ordered data structures (e.g. ordered in space, along a gradient, etc.).</p>
      <p>Let <inline-formula><mml:math id="MM2"><mml:mrow><mml:msub><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> be a <inline-formula><mml:math id="MM3"><mml:mrow><mml:mi>G</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> matrix of expression values for <italic>G</italic> genes in <italic>N<sub>t</sub></italic> samples at time <italic>t.</italic> The full set of observed expression values is then denoted by <inline-formula><mml:math id="MM4"><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. With a slight abuse of notation, let <inline-formula><mml:math id="MM5"><mml:mrow><mml:msub><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denote one row of this matrix containing data for gene <italic>g</italic> over time; <italic>X<sub>gtn</sub></italic> denotes expression values for gene <italic>g</italic> at time <italic>t</italic> in sample <italic>n.</italic> Of interest are changes in the latent mean expression levels for gene <italic>g</italic>: <inline-formula><mml:math id="MM6"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. We allow for three possibilities, or states, to describe such changes: Up, Down, EE. If <inline-formula><mml:math id="MM7"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, we define state <inline-formula><mml:math id="MM8"><mml:mrow><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> as Up; if <inline-formula><mml:math id="MM9"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is Down and <inline-formula><mml:math id="MM10"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> defines <inline-formula><mml:math id="MM11"><mml:mrow><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> as EE. The main goals in an ordered RNA-seq experiment—identifying genes that change over time, and specifying each genes’ expression path—can be restated as questions about these underlying states. In short, for each gene <italic>g</italic> and each transition between <italic>t</italic>−1 and <italic>t</italic>, we would like to estimate the probability of each state. A gene is said to follow a non-constant path if at least one state is not EE. We would also like to estimate the most likely expression path, which is given by the configuration of expression states over time (<inline-formula><mml:math id="MM12"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mn>3</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>), noting that the most likely configuration of states need not equal the collection of states that define <inline-formula><mml:math id="MM13"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> marginally at each <italic>t</italic> (an example is provided in Section 3.1).</p>
      <p>To make inference regarding these states, we propose a model for the set of expression measurements taken on a gene <italic>g.</italic> We make the common and well-supported assumption that gene expression in an RNA-seq experiment is well described by a NB distribution (<xref rid="btv193-B2" ref-type="bibr">Anders and Huber, 2010</xref>; <xref rid="btv193-B13" ref-type="bibr">Hardcastle and Kelly, 2010</xref>; <xref rid="btv193-B19" ref-type="bibr">Love <italic>et al.</italic>, 2014</xref>; <xref rid="btv193-B22" ref-type="bibr">Nueda <italic>et</italic>
<italic>al.</italic>, 2014</xref>; <xref rid="btv193-B26" ref-type="bibr">Robinson <italic>et al.</italic>, 2010</xref>; <xref rid="btv193-B30" ref-type="bibr">Trapnell <italic>et</italic>
<italic>al.</italic>, 2012</xref>). Were we to consider time <italic>t</italic> in isolation, this implies <inline-formula><mml:math id="MM14"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> where the NB distribution may be parameterized such that <inline-formula><mml:math id="MM15"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. For simplicity of notation, we assume equal library sizes. Details on adjustments for unequal library sizes are given in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv193/-/DC1">Supplementary Section S2</ext-link>.</p>
      <p>Because our interest here is in quantifying changes in <inline-formula><mml:math id="MM16"><mml:mrow><mml:msub><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> over time, we assume expression at time <italic>t</italic> depends on that at <italic>t</italic>−1 through parameters <italic>r</italic> and <italic>q.</italic> Specifically, <inline-formula><mml:math id="MM17"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>NB</mml:mtext><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msubsup><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="MM18"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula> if <italic>s</italic> is Up; <inline-formula><mml:math id="MM19"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:math></inline-formula> if <italic>s</italic> is Down and <inline-formula><mml:math id="MM20"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if <italic>s</italic> is EE. The data dependent parameter <italic>c</italic> specifies the expected change associated with each state. For example, if <italic>c</italic> = 2, then <inline-formula><mml:math id="MM21"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> = Up refers to a 2-fold increase in expression between <italic>t</italic>−1 and <italic>t.</italic> Although <italic>c</italic> may be defined by a user, we suggest estimation by maximum likelihood (see the next section). We further model fluctuations in μ<italic><sub>gt</sub></italic> by defining a prior distribution for <inline-formula><mml:math id="MM22"><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for all <italic>g</italic> and <italic>t</italic> &gt; 1. Given this set-up, when <italic>t</italic> &gt; 1, the marginal predictive conditional distribution describing expression (or emissions) for each state is Beta-NB: <inline-formula><mml:math id="MM23"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>Θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>Beta–NB</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="MM24"><mml:mrow><mml:mi>Θ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The expected mean is then defined as <inline-formula><mml:math id="MM25"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (<xref rid="btv193-B29" ref-type="bibr">Teerapabolarn, 2008</xref>). When <italic>t</italic> = 1, the prior distribution for <inline-formula><mml:math id="MM26"><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is defined as <inline-formula><mml:math id="MM27"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for all <italic>g</italic>, and the marginal predictive distribution is <inline-formula><mml:math id="MM28"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>1</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>Θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>Beta–NB </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      <p>For genes with dynamic paths, each state <inline-formula><mml:math id="MM29"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> is dependent on the prior state <inline-formula><mml:math id="MM30"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> since these genes represent continuous changes over time. To accommodate this dependence, we assume that the state process is described by a Markov chain. The constant and sporadic genes do not show continuous changes over time, and consequently we assume that states are independent, although we note that dependence among expression levels is still accommodated via the auto-regressive component.</p>
      <p>In summary, the time-course <inline-formula><mml:math id="MM31"><mml:mrow><mml:msub><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>X</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>g</mml:mi></mml:mstyle></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for a dynamic gene is governed by two interrelated probabilistic mechanisms: the conditional distribution (emissions model) at each time and the process describing the evolution of states over time. Initially, we assume that the observed expression vector can be characterized by the Beta-NB model described earlier and that the state process can be described by a Markov chain. Were it the case that dependence among measurements is fully captured by the state process, the proposed model would be a standard HMM. However, this last assumption does not hold, given that <italic>X<sub>t</sub></italic> for dynamic genes depends not only on the state <inline-formula><mml:math id="MM32"><mml:mrow><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> but also on <inline-formula><mml:math id="MM33"><mml:mrow><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> through <inline-formula><mml:math id="MM34"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Consequently, the model for dynamic genes is given by a Markov-switching auto-regressive model, as in <xref rid="btv193-B12" ref-type="bibr">Hamilton (1989)</xref> and <xref rid="btv193-B1" ref-type="bibr">Ailliot and Monbet (2012)</xref> (<xref ref-type="fig" rid="btv193-F1">Fig. 1</xref>). For constant and sporadic genes, we assume the same emissions model, but do not assume the state process is Markov. Taken together, since we do not know the expression path type a priori, the model for the full set of expression measurements is a two-component mixture over the sporadic/constant and dynamic genes.
<fig id="btv193-F1" position="float"><label>Fig. 1.</label><caption><p>(<bold>a</bold>) An auto-regressive hidden Markov component models dynamic paths. (<bold>b</bold>) An auto-regressive non-hidden Markov component models constant and sporadic paths</p></caption><graphic xlink:href="btv193f1p"/></fig></p>
    </sec>
    <sec>
      <title>2.2 Parameter estimation</title>
      <p>In the emissions distributions, the unknown parameters (<italic>r</italic>’s, α and β) are estimated using the method of moments (<italic>r</italic>’s are estimated within time point while α and β are estimated using all samples); <italic>c</italic> is estimated via maximum likelihood. Recall that EBSeq-HMM assumes a mixture model with a Markov component <italic>m</italic>1 and a non-Markov component <italic>m</italic>2. We assume equal prior probabilities of being in each mixture component.</p>
      <p>In Markov chain <italic>m</italic>1, the Baum-Welch algorithm is used to estimate initial <inline-formula><mml:math id="MM35"><mml:mrow><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>m</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and state transition probabilities <inline-formula><mml:math id="MM36"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>d</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for <inline-formula><mml:math id="MM37"><mml:mrow><mml:mi>t</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula>. Here, we assume a non-homogeneous Markov chain for the hidden states so <inline-formula><mml:math id="MM38"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>’s are different for different <italic>t</italic>’s. Denote the vector of initial probabilities and the state transition matrices estimated from the last step as <inline-formula><mml:math id="MM39"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>∼</mml:mo></mml:mrow></mml:mover></mml:mstyle><mml:mo>,</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>∼</mml:mo></mml:mrow></mml:mover></mml:mstyle></mml:mrow></mml:mrow></mml:math></inline-formula>. Given parameter estimates <inline-formula><mml:math id="MM40"><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mo>∼</mml:mo></mml:mrow></mml:mover></mml:mstyle><mml:mo>,</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>∼</mml:mo></mml:mrow></mml:mover></mml:mstyle></mml:mrow></mml:mrow></mml:math></inline-formula>, define <inline-formula><mml:math id="MM41"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>π</mml:mi><mml:mo>∼</mml:mo></mml:mover></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>A</mml:mi><mml:mo>∼</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM42"><mml:mrow><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The forward and backward steps of the Baum-Welch algorithm are then defined as follows:
<disp-formula><mml:math id="MM43"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>d</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>a</mml:mi><mml:mo>∼</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mspace width="0.5em"/><mml:mo>∝</mml:mo><mml:malignmark/><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>m</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mspace width="0.8em"/><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:malignmark/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>d</mml:mi></mml:munder><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>a</mml:mi><mml:mo>∼</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:mspace width="3.6em"/><mml:mo>∝</mml:mo><mml:malignmark/><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
The initial and state transition probabilities are updated by:
<disp-formula><mml:math id="MM44"><mml:mtable><mml:mtr><mml:mtd><mml:maligngroup/><mml:msubsup><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:malignmark/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:munder><mml:mi>P</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>J</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>π</mml:mi><mml:mo>∼</mml:mo></mml:mover></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>A</mml:mi><mml:mo>∼</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mi>P</mml:mi></mml:mstyle></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>π</mml:mi><mml:mo>∼</mml:mo></mml:mover></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>A</mml:mi><mml:mo>∼</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>a</mml:mi><mml:mo>∼</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>D</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:mover><mml:mi>a</mml:mi><mml:mo>∼</mml:mo></mml:mover></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msubsup><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="0.3em"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mrow><mml:mi>J</mml:mi></mml:mrow></mml:msub><mml:malignmark/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:munder><mml:mi>P</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>J</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>π</mml:mi><mml:mo>∼</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mi>P</mml:mi></mml:mstyle></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mn>1</mml:mn><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mstyle displaystyle="true"><mml:mover><mml:mi>π</mml:mi><mml:mo>∼</mml:mo></mml:mover></mml:mstyle><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:maligngroup/><mml:malignmark/><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>J</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>g</mml:mi></mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mrow><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mfrac><mml:mspace width="4.9em"/></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p>
      <p>Parameters are estimated by fixing expected fold-change (FC) <italic>c</italic> at 1.2. The process is then repeated for <italic>c</italic> in (1.4, 1.6, … , 3); and the parameter set with maximum likelihood is used in the final model.</p>
    </sec>
    <sec>
      <title>2.3 Inference at the isoform level</title>
      <p>The model detailed in the previous section applies to gene counts. To apply the approach to isoforms, the uncertainty inherent in isoform expression estimation should be accommodated. In short, estimating expression at the gene-level is a relatively easy task in RNA-seq as all reads mapping to a gene’s constituent exons may be used. The same holds true for estimating expression for an isoform unique to its parent gene. However, for genes with multiple isoforms, the problem is more challenging as reads mapping to overlapping exons (exons present in more than one isoform) must be allocated to isoforms in a way that is consistent with their expression. Consequently, there is increased uncertainty (on average) in expression estimates for isoforms with multiple overlapping exons, referred to as complex isoforms; and the uncertainty has been shown to have a substantial effect on downstream analysis methods (<xref rid="btv193-B17" ref-type="bibr">Leng <italic>et</italic>
<italic>al.</italic>, 2013</xref>).</p>
      <p>Specifically, define an isoform of gene <italic>g</italic> as belonging to the <italic>I<sub>g</sub></italic> = <italic>k</italic> group, for example, where <italic>k</italic> = 1, 2 or 3, if the total number of isoforms from gene <italic>g</italic> is <italic>k</italic> (the <italic>I<sub>g</sub></italic> = 3 group contains all isoforms from genes having 3 or more isoforms). <xref rid="btv193-B17" ref-type="bibr">Leng <italic>et</italic>
<italic>al.</italic> (2013)</xref> demonstrated that there is decreased variability in the <italic>I<sub>g</sub></italic> = 1 group, but increased variability in the others, due to the relative increase in uncertainty inherent in estimating isoform expression when multiple isoforms of a given gene are present. This observation is not specific to the dataset and/or the method used for isoform expression estimation; it is also not specific to the particular method used for quantifying isoform complexity.</p>
      <p>To adjust for the increased uncertainty inherent in complex isoform expression estimates, we allow the Beta prior to depend on isoform group: <inline-formula><mml:math id="MM45"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>q</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mrow><mml:mi>C</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">|</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup><mml:mo>∼</mml:mo><mml:mi>B</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>I</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The hyperparameter α is shared across isoforms, but here β depends on <italic>I<sub>g</sub></italic>, accommodating the systematic differences in variability among the <italic>I<sub>g</sub></italic> groups. <italic>I<sub>g</sub></italic> quantifies a measure of isoform complexity and may be defined by the user as the number of isoforms from a gene, as described earlier. It could also be defined by an isoform’s mappability score or credibility interval as provided by <xref rid="btv193-B14" ref-type="bibr">Koehler <italic>et</italic>
<italic>al.</italic> (2011)</xref>, <xref rid="btv193-B18" ref-type="bibr">Li and Dewey (2011)</xref> or <xref rid="btv193-B8" ref-type="bibr">Derrien <italic>et</italic>
<italic>al.</italic> (2012)</xref>.</p>
    </sec>
    <sec>
      <title>2.4 Simulated data</title>
      <p>We followed the simulation setup of <xref rid="btv193-B25" ref-type="bibr">Robinson and Smyth (2007)</xref> by defining counts as NB with gene-specific mean in sample <italic>n</italic> and time point <italic>t</italic> given by μ<italic><sub>gt</sub></italic> and variance <inline-formula><mml:math id="MM46"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The (μ<italic><sub>gt</sub></italic>, <inline-formula><mml:math id="MM47"><mml:mrow><mml:msub><mml:mrow><mml:mi>ϕ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>)’s were sampled as pairs from the mouse limb case study data described in the next section. Paired sampling was done to preserve the mean-variance relationship observed in most RNA-seq datasets. Each simulated dataset contains 10 000 genes and 15 samples which represent three biological replicates at each of five time points. One hundred datasets were considered for each simulation scenario.</p>
      <sec>
        <title>2.4.1 Sim I</title>
        <p>Sim I considers dynamic changes over time for 60% of the genes, which matches the percentage in the case study data. For these genes, paths were generated from an HMM. With five conditions, there are four states in the hidden chain (as shown in <xref ref-type="fig" rid="btv193-F1">Fig. 1</xref>), so three state transition matrices were used. We defined the initial probabilities as 0.5 and the state transition matrices as <inline-formula><mml:math id="MM48"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.9</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.2</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.8</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>, <inline-formula><mml:math id="MM49"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.9</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.8</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.2</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM50"><mml:mrow><mml:mo stretchy="true">(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.9</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.9</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>, which resulted in Up-Up-Down-Down and Down-Down-Up-Up being the two most frequent expression paths. Note that other paths were realized as well, although with fewer genes. Once a gene’s particular path (collection of states) was generated, <inline-formula><mml:math id="MM51"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> was simulated as μ<italic><sub>gt</sub></italic> multiplied (divided) by δ if <inline-formula><mml:math id="MM52"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>Δ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> was Up (Down). For one-half of the dynamic genes, we simulated strong effects, with δ sampled from empirical FCs between 1.3 and 1.4 calculated using case study data. The other one-half represent weak effects with δ sampled from empirical FCs between 1.2 and 1.3. The remaining 40% of genes were simulated as constant meaning the latent level of expression remains unchanged across conditions. To simulate genes following constant paths, we only took the genes whose simulated empirical FC of medians between any two adjacent time points was within (1/1.2, 1.2).</p>
      </sec>
      <sec>
        <title>2.4.2 Sim II</title>
        <p>For this simulation scenario, 40% of the 10 000 genes were simulated as dynamic as in Sim I and another 20% were simulated as sporadic. For dynamic genes, paths were generated from an HMM as described in Sim I; half were simulated as strong effects and the other half were with weak effects. For the sporadic genes, a time point <italic>t</italic> was chosen at random and μ<italic><sub>gt</sub></italic> was defined as <inline-formula><mml:math id="MM53"><mml:mrow><mml:msub><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>g</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo>*</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math></inline-formula>, where δ was sampled from empirical FCs between 1.3 and 1.4. The remaining 40% of genes were simulated as constant, again as described in Sim I.</p>
      </sec>
    </sec>
    <sec sec-type="cases">
      <title>2.5 Case study data</title>
      <p>Of interest in our case study, detailed below, is RNA-seq data from the James Thomson Lab at the Morgridge Institute for Research. We evaluated gene expression from seven positions along the mouse limb: proximal stylopod, distal stylopod, elbow, proximal zeugopod, distal zeugopod, autopod and digit. Three 12-week old C57BL/6J female mice were euthanized by cervical dislocation, followed by the extraction of the right forelimb. The tissues were treated with RNAlater (Sigma), per manufacturers instructions, dissected using a SteREO Discovery.V8 microscope (Zeiss), and stored at −20°C. The tissues were homogenized and lysed using a variable speed rotor stator homogenizer and Qiazol (Qiagen). Total RNA was extracted from the homogenized tissue samples using Qiagen’s RNeasy Lipid Tissue Mini (digits) and Midi (all other) Kits. A total of 21 samples were sequenced using Illumina’s Directional mRNA-Seq protocol (Part # 15018460 Rev. A). The reads are single-end with read length 42-bp. Each sample was run on one lane of an Illumina GAII in a randomized order to reduce batch effects. Alignment was done using Bowtie (<xref rid="btv193-B15" ref-type="bibr">Langmead <italic>et</italic>
<italic>al.</italic>, 2010</xref>) with the hg19 RefSeq annotation. Expression estimates were obtained from RSEM (<xref rid="btv193-B18" ref-type="bibr">Li and Dewey, 2011</xref>) and library size factors were obtained using median-of-ratios normalization (<xref rid="btv193-B2" ref-type="bibr">Anders and Huber, 2010</xref>). See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv193/-/DC1">Supplementary Section S7</ext-link> for package versions and further details.</p>
    </sec>
    <sec>
      <title>2.6 Identification of DE genes and classification</title>
      <p>EBSeq-HMM is compared with EBSeq, DESeq2, edgeR, voom, maSigPro and a naive method based on FC. See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv193/-/DC1">Supplementary Section S7</ext-link> for package versions and further details. Two tasks are of interest: identifying DE genes, defined as those showing any change across conditions; and assigning DE genes into their most likely expression path.</p>
      <sec>
        <title>2.6.1 Identification of DE genes</title>
        <p>To identify a list of DE genes with FDR α via EBSeq-HMM or EBSeq, we take those genes for which the posterior probability (PP) of being constant is less than or equal to α.</p>
        <p>Both DESeq2 and edgeR implement a generalized-linear model to test <italic>H0:</italic> data ∼ intercept versus <italic>H1:</italic> data ∼ intercept + condition with derived <italic>P</italic>-values adjusted for multiplicities using <xref rid="btv193-B3" ref-type="bibr">Benjamini and Hochberg (1995)</xref>. To construct a list of DE genes with target FDR α, we consider those genes with adjusted <italic>P</italic>-values less than or equal to α. As detailed in <xref rid="btv193-B16" ref-type="bibr">Law <italic>et</italic>
<italic>al.</italic> (2014)</xref>, the voom approach first estimates the precision weights based on the inverse variance, then applies the limma empirical Bayes pipeline taking the precision weights as prior information to account for the unequal variabilities in RNA-seq data. A similar hypothesis test was performed as in DESeq2 and edgeR, and the <italic>P</italic>-values were adjusted using Benjamini-Hochberg as well. Genes with adjusted <italic>P</italic>-values less than or equal to α were considered.</p>
        <p>As suggested in the maSigPro user manual, we applied the GLM method in the maSigPro package with the NB family and default parameter settings. We also considered two additional settings. Specifically, maSigPro uses an <italic>R</italic><sup>2</sup> value to obtain a sorted gene list. However, it is not clear how to pick an <italic>R</italic><sup>2</sup> threshold that gives a gene list with FDR controlled at some target level. The authors suggest 0.7 as the default <italic>R</italic><sup>2</sup> value. In addition to this default setting, we also considered <italic>R</italic><sup>2</sup> thresholds of 0.5 and 0.3 to evaluate maSigPro more thoroughly.</p>
        <p>For the naive FC method, denote <inline-formula><mml:math id="MM54"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mtext>med</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> as the median expression of gene <italic>g</italic> at time point <italic>t.</italic> A gene <italic>g</italic> is called Up (Down) between <italic>t</italic> and <italic>t</italic> + 1 if <inline-formula><mml:math id="MM55"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mtext>med</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mtext>med</mml:mtext></mml:mrow></mml:mrow><mml:mrow><mml:mi>g</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> is greater than (less than) <italic>K</italic>; otherwise, it is EE. We evaluate five values of <italic>K</italic>: 1.2, 1.3, 1.5, 2 and 2.5. A gene is defined as DE if it is non-EE at any transition.</p>
      </sec>
      <sec>
        <title>2.6.2 Classification of genes into expression paths</title>
        <p>Recall that EBSeq-HMM provides gene-specific posterior probabilities associated with each expression path. For EBSeq-HMM, a DE gene is classified into a specific expression path if its PP of being in that path exceeds 0.5. Selecting genes with PP &gt; 0.5 ensures that the posterior maximizing class always minimizes the Bayes risk regardless of choice of the metric loss function (<xref rid="btv193-B27" ref-type="bibr">Schlüter <italic>et</italic>
<italic>al.</italic>, 2005</xref>), although we note that there may be reasons to consider different thresholds in some situations (Section 4). For EBSeq, DESeq2, edgeR, voom and maSigPro, classifying DE genes into expression paths is not of interest, and no clear guidelines on how to do so is provided. Consequently, these methods are not evaluated for expression path classification. Finally, since no uncertainty measure of assignment is available using FC, for the FC analysis a gene is classified into the path defined by the Up/Down/EE calls across transitions.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Simulation results</title>
      <p>Simulation studies were conducted to investigate the operating characteristics of EBSeq-HMM and to assess how it compares with EBSeq, DESeq2, edgeR, voom, maSigPro and FC analysis. As detailed in Methods, each simulated dataset derives counts from a NB model. Like EBSeq-HMM, EBSeq, DESeq2, edgeR and maSigPro also assume that counts are distributed as NB, and consequently, this assumption should not provide advantage, or lack thereof, to any one method in particular. As the form of the variance is that assumed in edgeR, there may be a slight advantage given to that method. Parameter estimates were derived from case study data to help ensure that many features of real data are preserved in the simulation (e.g. mean/variance relationship and magnitude of FCs; Section 2.4 and the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv193/-/DC1">Supplement Section S3</ext-link> for more details).</p>
      <p><xref ref-type="table" rid="btv193-T1">Table 1</xref> shows the power and FDR for identifying dynamic genes in Sim I, where the target FDR is controlled at 5%. In addition to showing power overall, it is also shown separately for strong and weak effects (FDR is not shown for each subgroup because false discoveries are discoveries of EE genes and therefore cannot be classified as strong or weak). EBSeq-HMM has higher power than EBSeq, DESeq2, edgeR and voom, which is largely due to its ability to identify genes showing subtle, yet consistent, changes over time. Specifically, the power of the five methods is comparable for genes with strong effects, but EBSeq-HMM shows advantage in identifying genes where changes between any two points are relatively small. An example of two genes identified exclusively by EBSeq-HMM is shown in <xref ref-type="fig" rid="btv193-F2">Figure 2</xref> [panels (a) and (b)]. It is clear from the figure that the change between any two points is small (FC &lt; 1.3) and in some cases these changes would not be identified by a marginal analysis between adjacent time points [e.g. time points 1 and 2 in <xref ref-type="fig" rid="btv193-F2">Fig. 2</xref>b], but EBSeq-HMM identifies the genes as dynamic given the consistent changes over time.
<table-wrap id="btv193-T1" position="float"><label>Table 1.</label><caption><p>Operating characteristics for identifying changes in Sim I</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Power (%)</th><th rowspan="1" colspan="1">FDR (%)</th><th rowspan="1" colspan="1">F1 score (%)</th><th rowspan="1" colspan="1">Power (strong) (%)</th><th rowspan="1" colspan="1">Power (weak) (%)</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">EBSeqHMM</td><td align="char" char="." rowspan="1" colspan="1">98.6</td><td align="char" char="." rowspan="1" colspan="1">4.3</td><td align="char" char="." rowspan="1" colspan="1">97.1</td><td align="char" char="." rowspan="1" colspan="1">99.7</td><td align="char" char="." rowspan="1" colspan="1">97.5</td></tr><tr><td rowspan="1" colspan="1">EBSeq</td><td align="char" char="." rowspan="1" colspan="1">90.0</td><td align="char" char="." rowspan="1" colspan="1">0.1</td><td align="char" char="." rowspan="1" colspan="1">94.7</td><td align="char" char="." rowspan="1" colspan="1">93.9</td><td align="char" char="." rowspan="1" colspan="1">86.1</td></tr><tr><td rowspan="1" colspan="1">DESeq2</td><td align="char" char="." rowspan="1" colspan="1">92.4</td><td align="char" char="." rowspan="1" colspan="1">0</td><td align="char" char="." rowspan="1" colspan="1">96.1</td><td align="char" char="." rowspan="1" colspan="1">95.4</td><td align="char" char="." rowspan="1" colspan="1">89.4</td></tr><tr><td rowspan="1" colspan="1">edgeR</td><td align="char" char="." rowspan="1" colspan="1">92.5</td><td align="char" char="." rowspan="1" colspan="1">0.1</td><td align="char" char="." rowspan="1" colspan="1">96.1</td><td align="char" char="." rowspan="1" colspan="1">96.1</td><td align="char" char="." rowspan="1" colspan="1">89.4</td></tr><tr><td rowspan="1" colspan="1">voom</td><td align="char" char="." rowspan="1" colspan="1">91.9</td><td align="char" char="." rowspan="1" colspan="1">0</td><td align="char" char="." rowspan="1" colspan="1">95.8</td><td align="char" char="." rowspan="1" colspan="1">95.1</td><td align="char" char="." rowspan="1" colspan="1">88.6</td></tr><tr><td rowspan="1" colspan="1">maSigPro (0.7)</td><td align="char" char="." rowspan="1" colspan="1">46.8</td><td align="char" char="." rowspan="1" colspan="1">0</td><td align="char" char="." rowspan="1" colspan="1">63.8</td><td align="char" char="." rowspan="1" colspan="1">56.1</td><td align="char" char="." rowspan="1" colspan="1">37.5</td></tr><tr><td rowspan="1" colspan="1">maSigPro (0.5)</td><td align="char" char="." rowspan="1" colspan="1">76.1</td><td align="char" char="." rowspan="1" colspan="1">0.1</td><td align="char" char="." rowspan="1" colspan="1">86.4</td><td align="char" char="." rowspan="1" colspan="1">81.5</td><td align="char" char="." rowspan="1" colspan="1">70.6</td></tr><tr><td rowspan="1" colspan="1">maSigPro (0.3)</td><td align="char" char="." rowspan="1" colspan="1">86.9</td><td align="char" char="." rowspan="1" colspan="1">0.5</td><td align="char" char="." rowspan="1" colspan="1">92.8</td><td align="char" char="." rowspan="1" colspan="1">90.6</td><td align="char" char="." rowspan="1" colspan="1">83.2</td></tr><tr><td rowspan="1" colspan="1">FC (2.5)</td><td align="char" char="." rowspan="1" colspan="1">0.6</td><td align="char" char="." rowspan="1" colspan="1">0.2</td><td align="char" char="." rowspan="1" colspan="1">1.2</td><td align="char" char="." rowspan="1" colspan="1">0.8</td><td align="char" char="." rowspan="1" colspan="1">0.5</td></tr><tr><td rowspan="1" colspan="1">FC (2)</td><td align="char" char="." rowspan="1" colspan="1">3.4</td><td align="char" char="." rowspan="1" colspan="1">1.4</td><td align="char" char="." rowspan="1" colspan="1">6.6</td><td align="char" char="." rowspan="1" colspan="1">4.3</td><td align="char" char="." rowspan="1" colspan="1">2.6</td></tr><tr><td rowspan="1" colspan="1">FC (1.5)</td><td align="char" char="." rowspan="1" colspan="1">42.1</td><td align="char" char="." rowspan="1" colspan="1">3.5</td><td align="char" char="." rowspan="1" colspan="1">58.7</td><td align="char" char="." rowspan="1" colspan="1">55.7</td><td align="char" char="." rowspan="1" colspan="1">28.6</td></tr><tr><td rowspan="1" colspan="1">FC (1.3)</td><td align="char" char="." rowspan="1" colspan="1">90.0</td><td align="char" char="." rowspan="1" colspan="1">8.5</td><td align="char" char="." rowspan="1" colspan="1">90.7</td><td align="char" char="." rowspan="1" colspan="1">97.5</td><td align="char" char="." rowspan="1" colspan="1">82.4</td></tr><tr><td rowspan="1" colspan="1">FC (1.2)</td><td align="char" char="." rowspan="1" colspan="1">98.6</td><td align="char" char="." rowspan="1" colspan="1">19.7</td><td align="char" char="." rowspan="1" colspan="1">88.6</td><td align="char" char="." rowspan="1" colspan="1">99.8</td><td align="char" char="." rowspan="1" colspan="1">97.9</td></tr></tbody></table><table-wrap-foot><fn id="btv193-TF1"><p>The first three columns show the average power, FDR and F1 score for detecting DE genes in Sim I. Power within the strong and weak groups is further evaluated in columns 4 and 5. Averages are calculated over 100 Sim I simulations. The standard errors (not shown) for EBSeq-HMM, EBSeq, DESeq2, edgeR, voom and maSigPro (and in most cases FC) were <inline-formula><mml:math id="MM56"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.005</mml:mn></mml:mrow></mml:math></inline-formula>.</p></fn></table-wrap-foot></table-wrap>
<fig id="btv193-F2" position="float"><label>Fig. 2.</label><caption><p>Shown are two genes identified exclusively by EBSeq-HMM in Sim I data (upper) and in case study data (lower). The <italic>x</italic>-axis shows time points (upper) and positions on mouse limb (lower), and the <italic>y</italic>-axis shows median gene expression adjusted for library sizes</p></caption><graphic xlink:href="btv193f2p"/></fig></p>
      <p>Note that although EBSeq-HMM has the highest empirical FDR among these five methods, it is still well-controlled under the 5% target FDR. In fact, among all approaches, the empirical FDR from EBSeq-HMM is closest to the target FDR. To better understand the overall performance of each method, the third column in <xref ref-type="table" rid="btv193-T1">Table 1</xref> shows the F1 score. The F1 score measures a test’s accuracy accounting for both power and false discoveries, where an F1 score reaches its best value at 1 and worst at 0. EBSeq-HMM has the highest F1 score among all approaches.</p>
      <p>In addition, <xref ref-type="table" rid="btv193-T1">Table 1</xref> shows that [consistent with other studies (<xref rid="btv193-B22" ref-type="bibr">Nueda <italic>et</italic>
<italic>al.</italic>, 2014</xref>)], the suggested threshold of maSigPro (<inline-formula><mml:math id="MM57"><mml:mrow><mml:msup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>0.7</mml:mn></mml:mrow></mml:math></inline-formula>) is conservative and provides lower power than EBSeq-HMM, EBSeq, DESeq2, edgeR and voom. The power is improved by relaxing the threshold, but is still lower than others. The FC analysis works best at threshold 1.3, but is still inferior to the other methods.</p>
      <p><xref ref-type="table" rid="btv193-T2">Table 2</xref> shows the power, FDR and F1 score for identifying DE genes (either dynamic or sporadic) in Sim II where, again, the target FDR is controlled at 5%. The increased power of EBSeq-HMM in identifying dynamic genes that was demonstrated in Sim I persists when sporadic genes are present, and EBSeq-HMM also shows advantage for identifying sporadic genes.
<table-wrap id="btv193-T2" position="float"><label>Table 2.</label><caption><p>Operating characteristics for identifying changes in Sim II</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">Power (%)</th><th rowspan="1" colspan="1">FDR (%)</th><th rowspan="1" colspan="1">F1 score (%)</th><th rowspan="1" colspan="1">Power (strong) (%)</th><th rowspan="1" colspan="1">Power (weak) (%)</th><th rowspan="1" colspan="1">Power (sporadic) (%)</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">EBSeqHMM</td><td align="char" char="." rowspan="1" colspan="1">94.5</td><td align="char" char="." rowspan="1" colspan="1">4.5</td><td align="char" char="." rowspan="1" colspan="1">95.0</td><td align="char" char="." rowspan="1" colspan="1">99.7</td><td align="char" char="." rowspan="1" colspan="1">97.4</td><td align="char" char="." rowspan="1" colspan="1">86.4</td></tr><tr><td rowspan="1" colspan="1">EBSeq</td><td align="char" char="." rowspan="1" colspan="1">81.4</td><td align="char" char="." rowspan="1" colspan="1">0.1</td><td align="char" char="." rowspan="1" colspan="1">89.7</td><td align="char" char="." rowspan="1" colspan="1">93.9</td><td align="char" char="." rowspan="1" colspan="1">86.1</td><td align="char" char="." rowspan="1" colspan="1">64.2</td></tr><tr><td rowspan="1" colspan="1">DESeq2</td><td align="char" char="." rowspan="1" colspan="1">84.1</td><td align="char" char="." rowspan="1" colspan="1">0</td><td align="char" char="." rowspan="1" colspan="1">91.4</td><td align="char" char="." rowspan="1" colspan="1">95.2</td><td align="char" char="." rowspan="1" colspan="1">89.3</td><td align="char" char="." rowspan="1" colspan="1">67.9</td></tr><tr><td rowspan="1" colspan="1">edgeR</td><td align="char" char="." rowspan="1" colspan="1">84.4</td><td align="char" char="." rowspan="1" colspan="1">0</td><td align="char" char="." rowspan="1" colspan="1">91.6</td><td align="char" char="." rowspan="1" colspan="1">95.4</td><td align="char" char="." rowspan="1" colspan="1">89.5</td><td align="char" char="." rowspan="1" colspan="1">68.3</td></tr><tr><td rowspan="1" colspan="1">voom</td><td align="char" char="." rowspan="1" colspan="1">83.2</td><td align="char" char="." rowspan="1" colspan="1">0</td><td align="char" char="." rowspan="1" colspan="1">90.8</td><td align="char" char="." rowspan="1" colspan="1">95.0</td><td align="char" char="." rowspan="1" colspan="1">88.7</td><td align="char" char="." rowspan="1" colspan="1">65.9</td></tr><tr><td rowspan="1" colspan="1">maSigPro (0.7)</td><td align="char" char="." rowspan="1" colspan="1">33.1</td><td align="char" char="." rowspan="1" colspan="1">0</td><td align="char" char="." rowspan="1" colspan="1">49.7</td><td align="char" char="." rowspan="1" colspan="1">56.0</td><td align="char" char="." rowspan="1" colspan="1">37.8</td><td align="char" char="." rowspan="1" colspan="1">5.5</td></tr><tr><td rowspan="1" colspan="1">maSigPro (0.5)</td><td align="char" char="." rowspan="1" colspan="1">56.8</td><td align="char" char="." rowspan="1" colspan="1">0.1</td><td align="char" char="." rowspan="1" colspan="1">72.4</td><td align="char" char="." rowspan="1" colspan="1">81.6</td><td align="char" char="." rowspan="1" colspan="1">70.6</td><td align="char" char="." rowspan="1" colspan="1">18.2</td></tr><tr><td rowspan="1" colspan="1">maSigPro (0.3)</td><td align="char" char="." rowspan="1" colspan="1">67.4</td><td align="char" char="." rowspan="1" colspan="1">0.5</td><td align="char" char="." rowspan="1" colspan="1">80.4</td><td align="char" char="." rowspan="1" colspan="1">89.9</td><td align="char" char="." rowspan="1" colspan="1">82.3</td><td align="char" char="." rowspan="1" colspan="1">30.0</td></tr><tr><td rowspan="1" colspan="1">FC (2.5)</td><td align="char" char="." rowspan="1" colspan="1">0.4</td><td align="char" char="." rowspan="1" colspan="1">0.4</td><td align="char" char="." rowspan="1" colspan="1">0.8</td><td align="char" char="." rowspan="1" colspan="1">0.7</td><td align="char" char="." rowspan="1" colspan="1">0.4</td><td align="char" char="." rowspan="1" colspan="1">0.1</td></tr><tr><td rowspan="1" colspan="1">FC (2)</td><td align="char" char="." rowspan="1" colspan="1">2.5</td><td align="char" char="." rowspan="1" colspan="1">1.9</td><td align="char" char="." rowspan="1" colspan="1">4.9</td><td align="char" char="." rowspan="1" colspan="1">4.2</td><td align="char" char="." rowspan="1" colspan="1">2.5</td><td align="char" char="." rowspan="1" colspan="1">0.8</td></tr><tr><td rowspan="1" colspan="1">FC (1.5)</td><td align="char" char="." rowspan="1" colspan="1">36.1</td><td align="char" char="." rowspan="1" colspan="1">4.0</td><td align="char" char="." rowspan="1" colspan="1">52.5</td><td align="char" char="." rowspan="1" colspan="1">55.9</td><td align="char" char="." rowspan="1" colspan="1">28.6</td><td align="char" char="." rowspan="1" colspan="1">23.9</td></tr><tr><td rowspan="1" colspan="1">FC (1.3)</td><td align="char" char="." rowspan="1" colspan="1">83.0</td><td align="char" char="." rowspan="1" colspan="1">9.0</td><td align="char" char="." rowspan="1" colspan="1">86.8</td><td align="char" char="." rowspan="1" colspan="1">97.4</td><td align="char" char="." rowspan="1" colspan="1">82.5</td><td align="char" char="." rowspan="1" colspan="1">69.2</td></tr><tr><td rowspan="1" colspan="1">FC (1.2)</td><td align="char" char="." rowspan="1" colspan="1">95.8</td><td align="char" char="." rowspan="1" colspan="1">20.1</td><td align="char" char="." rowspan="1" colspan="1">87.1</td><td align="char" char="." rowspan="1" colspan="1">99.8</td><td align="char" char="." rowspan="1" colspan="1">97.9</td><td align="char" char="." rowspan="1" colspan="1">89.6</td></tr></tbody></table><table-wrap-foot><fn id="btv193-TF2"><p>The first three columns show the average power, FDR and F1 score for detecting DE genes in Sim II. For dynamic genes, the power within the strong and weak groups is further evaluated in columns 4 and 5. Power within the sporadic group is evaluated in column 6. Averages are calculated over 100 Sim II simulations. The standard errors (not shown) for EBSeq-HMM, EBSeq, DESeq2, edgeR, voom and maSigPro (and in most cases FC) were <inline-formula><mml:math id="MM58"><mml:mrow><mml:mo>≤</mml:mo><mml:mn>0.005</mml:mn></mml:mrow></mml:math></inline-formula>.</p></fn></table-wrap-foot></table-wrap></p>
      <p>In spite of this advantage, we note that all methods show reduced power for identifying sporadic genes. This is because in the simulation (and in our case study data upon which the simulation is based), the range of expression differences in sporadic genes is smaller, in general, than in dynamic genes. For example, consider dynamic genes having fold changes at each transition between 1.3 and 1.4. On average, for a dynamic gene that is monotonically increasing, the range in expression would be <inline-formula><mml:math id="MM59"><mml:mrow><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>135</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mn>332</mml:mn></mml:mrow></mml:math></inline-formula> over all conditions (for a weak dynamic gene, the range would be <inline-formula><mml:math id="MM60"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>2.44</mml:mn></mml:mrow></mml:math></inline-formula>). However, in a sporadic gene, the range would be <inline-formula><mml:math id="MM61"><mml:mrow><mml:mo>∼</mml:mo><mml:mn>1.35</mml:mn></mml:mrow></mml:math></inline-formula> since only one condition differs from the others.</p>
      <p>In addition to identification of DE genes, we also evaluated the ability of EBSeq-HMM and FC to classify genes into distinct expression paths (EBSeq, DESeq2, edgeR, voom and maSigPro were not evaluated as they were not developed for this purpose; Section 2.6). <xref ref-type="fig" rid="btv193-F3">Figure 3</xref> shows results for eight dynamic paths simulated in Sim I; these eight were chosen as they contain the most genes among all simulated paths. The ground truth shows the number of genes simulated in each expression path. Also shown are the average number classified into each path by EBSeq-HMM and by FC analysis at FC threshold <italic>K</italic> = 1.2 and 1.3 (averages are calculated over 100 Sim I datasets). Correct classifications are shown in blue; incorrect are shown in red. For FC analysis, we chose 1.2 and 1.3 as they performed best under all thresholds considered. As shown, EBSeq-HMM identified more true positives than FC, while the FDR is well below 5%. Similar results were observed in Sim II data (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv193/-/DC1">Supplementary Fig. S2</ext-link>).
<fig id="btv193-F3" position="float"><label>Fig. 3.</label><caption><p>Shown are the number of genes (ground truth) simulated in Sim I as being in each of eight dynamic paths (these eight are shown as they contain the most genes among all simulated paths). Also shown are the average number classified into each path by EBSeq-HMM and by FC analysis at thresholds 1.2 and 1.3 (averages are calculated over 100 Sim I datasets). Correct classifications are shown in blue (first bar); incorrect are shown in red (second bar)</p></caption><graphic xlink:href="btv193f3p"/></fig></p>
    </sec>
    <sec sec-type="cases">
      <title>3.2 Case study results</title>
      <p>An important problem in regenerative biology is understanding the connection between gene expression patterns and the positional identities of cells throughout development. Once humans and other mammals reach adulthood, they possess a very limited ability to regenerate body parts like limb structures; and it has been hypothesized that a loss of positional identity information is at least partially responsible for the reduction in regenerative capacity. However, a few studies (<xref rid="btv193-B6" ref-type="bibr">Chang, 2009</xref>; <xref rid="btv193-B23" ref-type="bibr">Rinn <italic>et</italic>
<italic>al.</italic>, 2006</xref>; <xref rid="btv193-B31" ref-type="bibr">Wang <italic>et</italic>
<italic>al.</italic>, 2009</xref>) have demonstrated that some aspects of positional identity in mammals are retained into adulthood. Understanding the changes in gene expression across limb positions in mammals is an essential first step in gaining a better understanding of these processes. Toward this end, we conducted RNA-seq experiments to study gene expression changes over seven positions (proximal to distal) along the limbs of adult mice.</p>
      <p>EBSeq-HMM, EBSeq, DESeq2, edgeR and voom identified 14 817, 12 825, 11 517, 9520 and 10 259 DE genes at a 5% target FDR, and there is substantial overlap among the lists. Specifically, EBSeq-HMM identified over 90% of the genes identified by the other approaches. maSigPro identified 2479, 6919 and 10 727 DE genes using <italic>R</italic><sup>2</sup> threshold 0.7, 0.5 and 0.3 and FC analyses identified 4225, 6500, 10 881, 14 016 and 15 877 genes for <inline-formula><mml:math id="MM62"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo></mml:mrow></mml:math></inline-formula> 2.5, 2, 1.5, 1.3 and 1.2, respectively. These identifications showed substantially lower overlap with other methods.</p>
      <p>Given that the majority of genes identified by EBSeq, DESeq2, edgeR and voom are also identified by EBSeq-HMM, we focus initially on genes that are identified exclusively by EBSeq-HMM. <xref ref-type="fig" rid="btv193-F2">Figure 2</xref>c and d shows two examples. As in the simulated data [shown in (a) and (b)], these genes have subtle but consistent changes over the seven limb positions, again demonstrating that by accommodating dependence, EBSeq-HMM has increased power to identify genes showing relatively weak, but consistent, changes. <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv193/-/DC1">Supplementary Figure S3</ext-link> shows similar results for other genes identified exclusively by EBSeq-HMM.</p>
      <p>Although the simulation and case study results suggest that EBSeq-HMM has increased power for identifying DE genes, the main advantage of EBSeq-HMM over other approaches is in its ability to classify genes into particular expression paths. To illustrate, we consider Hox genes, a set of genes that are of primary interest here as they are well-known to play an important role in maintaining positional identity in adult cells (<xref rid="btv193-B23" ref-type="bibr">Rinn <italic>et</italic><italic> al.</italic>, 2006</xref>; <xref rid="btv193-B31" ref-type="bibr">Wang <italic>et</italic>
<italic>al.</italic>, 2009</xref>). In our case study data, 33 out of 39 Hox genes were identified as DE by EBSeq-HMM. <xref ref-type="fig" rid="btv193-F4">Figure 4</xref> shows expression levels of the 33 genes along with their most likely expression paths. Although the positional changes for most Hox genes are not well-known, it is known that Hoxb4 and Hoxb8 have up-regulated expression in proximal sites (<xref rid="btv193-B23" ref-type="bibr">Rinn <italic>et</italic>
<italic>al.</italic>, 2006</xref>; <xref rid="btv193-B31" ref-type="bibr">Wang <italic>et </italic><italic>al.</italic>, 2009</xref>). The EBSeq-HMM paths for these genes are consistent with these prior studies and provide further information as they characterize changes across the seven positions. In addition, the overall pattern of Hox gene expression found here demonstrates that, in general, higher numbered Hox genes are up-regulated distally and lower numbered Hox genes are up-regulated proximally. This is in agreement with existing data and models of proximal-distal patterning of the limb (<xref rid="btv193-B33" ref-type="bibr">Zakany and Duboule, 2007</xref>).
<fig id="btv193-F4" position="float"><label>Fig. 4.</label><caption><p>Shown are median expression levels of 33 Hox genes identified as DE by EBSeq-HMM. The expression values were adjusted for library size and further scaled to mean 0 and standard deviation 1 for each gene; median expression over three replicates is shown. Genes were clustered via hierarchical clustering using Euclidean distance and complete linkage. The <italic>x</italic>-axis shows seven positions over the mouse limb</p></caption><graphic xlink:href="btv193f4p"/></fig></p>
      <p>To explore other genes beyond the Hox family that may be involved in positional identity, we considered 2347 genes that are classified by EBSeq-HMM into one of 64 possible dynamic paths. Among the 64 clusters formed by these dynamic genes, the two largest are Up-Down-Up-Down-Down-Down (827) and Down-Up-Down-Up-Up-Up (218). <xref ref-type="fig" rid="btv193-F5">Figure 5</xref>a and b shows median expression of each position for each of these genes. As these groups each contain Hox genes but also previously unknown genes showing similar dynamics across position, the novel identifications define candidates for further study.
<fig id="btv193-F5" position="float"><label>Fig. 5.</label><caption><p>(<bold>a</bold>), (<bold>b</bold>) Shown are genes classified as following an Up-Down-Up-Down-Down-Down (left panel, 827 genes) or Down-Up-Down-Up-Up-Up (right panel, 218 genes) expression path in the case study data. Each line indicates one gene. The <italic>x</italic>-axis shows seven positions over the mouse limb; the <italic>y</italic>-axis shows median scaled expression within each position</p></caption><graphic xlink:href="btv193f5p"/></fig></p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We have developed an approach called EBSeq-HMM for analysis of ordered RNA-seq experiments. EBSeq-HMM may be used to identify genes that are DE across a set of ordered conditions and to classify genes into their most likely expression paths. There are a number of methods available for identifying DE genes that may be used when data from multiple conditions is available. EBSeq-HMM has two main advantages over these approaches. First, it accommodates dependence across ordered conditions and consequently has increased power to identify genes showing subtle, yet consistent, changes. Second, for every gene, EBSeq-HMM calculates the gene-specific PP associated with each possible expression path and in doing so allows for genes to be classified into distinct expression paths with a pre-specified FDR. Put another way, EBSeq-HMM not only identifies genes that change across conditions, but can be used to specify how they change.</p>
    <p>Simulations demonstrated the power of EBSeq-HMM over other approaches to identify DE genes. In particular, results showed that DESeq2, edgeR and voom perform well in detecting trends and/or changes are relatively strong, but that EBSeq-HMM has increased power to identify genes showing weaker changes. EBSeq-HMM also worked well for identifying genes showing sporadic changes (where there is no dependence across ordered conditions as for some genes in Sim II). Applying maSigPro-GLM with its default cutoff for calling DE genes gave significantly reduced power than other approaches. Relaxing the cutoff improved its power, but it was still inferior to the others.</p>
    <p>In addition to DE gene identification, EBSeq-HMM performed well for classifying genes into expression paths. We defined a gene as being in a particular path if the gene was classified as DE at FDR 5% (PP of EE was less than 0.05) and the PP of being in that path exceeded 0.5. Given the two step process, observed mis-classification rates were conservatively controlled. Note that in some cases, a DE gene may not be classified to any particular path. For example, if the last time point of a four-condition experiment is known to be noisy, a gene that is initially increasing may have equal PP, say one-third, of being Up-Up-Up, Up-Up-EE, and Up-Up-Down. This gene would be called DE with 5% FDR since PP(EE-EE-EE) &lt; 0.05, but it would not be assigned into a particular expression path if threshold 0.5 was used. In some cases, a user may want to modify these thresholds. If a false negative classification was considered more serious than a false positive, this threshold could be adjusted. Motivation for doing so under varying loss functions is discussed in (<xref rid="btv193-B4" ref-type="bibr">Berger, 1985</xref>).</p>
  </sec>
  <sec>
    <title>5 Implementation</title>
    <p>EBSeq-HMM is implemented as an R package (EBSeqHMM), currently available at Bioconductor: <ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/devel/bioc/html/EBSeqHMM.html">www.bioconductor.org/packages/devel/bioc/html/EBSeqHMM.html</ext-link>. EBSeq-HMM requires estimates of gene or isoform expression, but is not specific to any particular estimation method. To estimate library sizes, EBSeq-HMM defaults to median-of-ratios normalization (<xref rid="btv193-B2" ref-type="bibr">Anders and Huber, 2010</xref>); TMM (<xref rid="btv193-B24" ref-type="bibr">Robinson and Oshlack, 2010</xref>) and Upper Quartile Normalization (<xref rid="btv193-B5" ref-type="bibr">Bullard <italic>et</italic>
<italic>al.</italic>, 2010</xref>) are also available in the package.</p>
    <p>Like most methods, EBSeq-HMM makes assumptions regarding the distribution governing expression measurements. Consequently, poor performance may result if there are strong departures from these assumptions. Model diagnostics are implemented in EBSeq-HMM to ensure that assumptions can be easily checked. They should be considered with each application and results should not be used if serious departures from model assumptions are observed. A typical diagnostic summary for the case study data is shown in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btv193/-/DC1">Supplementary Figure S4</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_31_16_2614__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btv193_ebhmm.supp.rv.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Michael Newton and Ming Yuan for comments that helped improve the manuscript. This work was supported by <funding-source>NIH</funding-source>
<award-id>GM102756</award-id>, <award-id>NIH U54 AI117924</award-id>, <award-id>NSF DMS-12-65203</award-id> and <award-id>UL1 RR025011</award-id>.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btv193-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ailliot</surname><given-names>P.</given-names></name><name><surname>Monbet</surname><given-names>V.</given-names></name></person-group> (<year>2012</year>) <article-title>Markov-switching autoregressive models for wind time series</article-title>. <source>Environ. Model. Softw.</source>, <volume>30</volume>, <fpage>92</fpage>–<lpage>101</lpage>.</mixed-citation>
    </ref>
    <ref id="btv193-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S.</given-names></name><name><surname>Huber</surname><given-names>W.</given-names></name></person-group> (<year>2010</year>) <article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biol.</source>, <volume>11</volume>, <fpage>R106</fpage>.<pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname><given-names>Y.</given-names></name><name><surname>Hochberg</surname><given-names>Y.</given-names></name></person-group> (<year>1995</year>) <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>J. R. Stat. Soc.Ser. B (Methodological)</source>, <volume>57</volume>, <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="btv193-B4">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Berger</surname><given-names>J.O.</given-names></name></person-group> (<year>1985</year>) <source>Statistical Decision Theory and Bayesian Analysis</source><italic>.</italic>
<publisher-name>Springer Science &amp; Business Media</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btv193-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bullard</surname><given-names>J.H.</given-names></name><etal/></person-group><italic>.</italic> (<year>2010</year>) <article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-seq experiments</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>94</fpage>.<pub-id pub-id-type="pmid">20167110</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chang</surname><given-names>H.</given-names></name></person-group> (<year>2009</year>) <article-title>Anatomic demarcation of cells: genes to patterns</article-title>. <source>Science</source>, <volume>326</volume>, <fpage>1206</fpage>–<lpage>1207</lpage>.<pub-id pub-id-type="pmid">19965461</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Conesa</surname><given-names>A.</given-names></name><etal/></person-group><italic>.</italic> (<year>2006</year>) <article-title>maSigPro: a method to identify significantly differential expression profiles in time-course microarray experiments</article-title>. <source>Bioinformatics</source>, <volume>22</volume>, <fpage>1096</fpage>–<lpage>1102</lpage>.<pub-id pub-id-type="pmid">16481333</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Derrien</surname><given-names>T.</given-names></name><etal/></person-group><italic>.</italic> (<year>2012</year>) <article-title>Fast computation and applications of genome mappability</article-title>. <source>PLoS One</source>, <volume>7</volume>, <fpage>e30377</fpage>.<pub-id pub-id-type="pmid">22276185</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ernst</surname><given-names>J.</given-names></name><etal/></person-group><italic>.</italic> (<year>2005</year>) <article-title>Clustering short time series gene expression data</article-title>. <source>Bioinformatics</source>, <volume>21</volume>(<issue>Suppl. 1</issue>), <fpage>i159</fpage>–<lpage>i168</lpage>.<pub-id pub-id-type="pmid">15961453</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Filkov</surname><given-names>V.</given-names></name><etal/></person-group><italic>.</italic> (<year>2002</year>) <article-title>Analysis techniques for microarray time-series data</article-title>. <source>J. Comput. Biol.</source>, <volume>9</volume>, <fpage>317</fpage>–<lpage>330</lpage>.<pub-id pub-id-type="pmid">12015884</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Glaus</surname><given-names>P.</given-names></name><etal/></person-group><italic>.</italic> (<year>2012</year>) <article-title>Identifying differentially expressed transcripts from RNA-seq data with biological variation</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>1721</fpage>–<lpage>1728</lpage>.<pub-id pub-id-type="pmid">22563066</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamilton</surname><given-names>J.D.</given-names></name></person-group> (<year>1989</year>) <article-title>A new approach to the economic analysis of nonstationary time series and the business cycle</article-title>. <source>Econometrica</source>, <fpage>357</fpage>–<lpage>384</lpage>.</mixed-citation>
    </ref>
    <ref id="btv193-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hardcastle</surname><given-names>T.J.</given-names></name><name><surname>Kelly</surname><given-names>K.A.</given-names></name></person-group> (<year>2010</year>) <article-title>baySeq: empirical Bayesian methods for identifying differential expression in sequence count data</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>422</fpage>.<pub-id pub-id-type="pmid">20698981</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koehler</surname><given-names>R.</given-names></name><etal/></person-group><italic>.</italic> (<year>2011</year>) <article-title>The uniqueome: a mappability resource for short-tag sequencing</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>272</fpage>–<lpage>274</lpage>.<pub-id pub-id-type="pmid">21075741</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Langmead</surname><given-names>B.</given-names></name><etal/></person-group><italic>.</italic> (<year>2010</year>) <article-title>Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</article-title>. <source>Genome Biol.</source>, <volume>10</volume>, <fpage>R25</fpage>.<pub-id pub-id-type="pmid">19261174</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Law</surname><given-names>C.W.</given-names></name><etal/></person-group><italic>.</italic> (<year>2014</year>) <article-title>Voom: precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>. <source>Genome Biol.</source>, <volume>15</volume>, <fpage>R29</fpage>.<pub-id pub-id-type="pmid">24485249</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leng</surname><given-names>N.</given-names></name><etal/></person-group><italic>.</italic> (<year>2013</year>) <article-title>EBSeq: an empirical Bayes hierarchical model for inference in RNA-seq experiments</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>1035</fpage>–<lpage>1043</lpage>.<pub-id pub-id-type="pmid">23428641</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>B.</given-names></name><name><surname>Dewey</surname><given-names>C.N.</given-names></name></person-group> (<year>2011</year>) <article-title>RSEM: accurate transcript quantification from RNA-seq data with or without a reference genome</article-title>. <source>BMC Bioinformatics</source>, <volume>12</volume>, <fpage>323</fpage>.<pub-id pub-id-type="pmid">21816040</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Love</surname><given-names>M.I.</given-names></name><etal/></person-group><italic>.</italic> (<year>2014</year>) <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol.</source>, <volume>15</volume>, <fpage>550</fpage>.<pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luan</surname><given-names>Y.</given-names></name><name><surname>Li</surname><given-names>H.</given-names></name></person-group> (<year>2003</year>) <article-title>Clustering of time-course gene expression data using a mixed-effects model with b-splines</article-title>. <source>Bioinformatics</source>, <volume>19</volume>, <fpage>474</fpage>–<lpage>482</lpage>.<pub-id pub-id-type="pmid">12611802</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ma</surname><given-names>P.</given-names></name><etal/></person-group><italic>.</italic> (<year>2009</year>) <article-title>Identifying differentially expressed genes in time course microarray data</article-title>. <source>Stat. Biosciences</source>, <volume>1</volume>, <fpage>144</fpage>–<lpage>159</lpage>.</mixed-citation>
    </ref>
    <ref id="btv193-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nueda</surname><given-names>M.J.</given-names></name><etal/></person-group><italic>.</italic> (<year>2014</year>) <article-title>Next maSigPro: updating maSigPro bioconductor package for RNA-seq time series</article-title>. <source>Bioinformatics.</source>, <volume>30</volume>, <fpage>2598</fpage>–<lpage>2602</lpage>.<pub-id pub-id-type="pmid">24894503</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rinn</surname><given-names>J.</given-names></name><etal/></person-group><italic>.</italic> (<year>2006</year>) <article-title>Anatomic demarcation by positional variation in fibroblast gene expression programs</article-title>. <source>PLoS Genet.</source>, <volume>2</volume>, <fpage>e119</fpage>.<pub-id pub-id-type="pmid">16895450</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>M.D.</given-names></name><name><surname>Oshlack</surname><given-names>A.</given-names></name></person-group> (<year>2010</year>) <article-title>A scaling normalization method for differential expression analysis of RNA-seq data</article-title>. <source>Genome Biol.</source>, <volume>11</volume>, <fpage>R25</fpage>.<pub-id pub-id-type="pmid">20196867</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>M.D.</given-names></name><name><surname>Smyth</surname><given-names>G.K.</given-names></name></person-group> (<year>2007</year>) <article-title>Moderated statistical tests for assessing differences in tag abundance</article-title>. <source>Bioinformatics</source>, <volume>23</volume>, <fpage>2881</fpage>–<lpage>2887</lpage>.<pub-id pub-id-type="pmid">17881408</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>M.D.</given-names></name><etal/></person-group><italic>.</italic> (<year>2010</year>) <article-title>edgeR: a bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>139</fpage>–<lpage>140</lpage>.<pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B27">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Schlüter</surname><given-names>R.</given-names></name><etal/></person-group> (<year>2005</year>) <article-title>Bayes risk minimization using metric loss functions</article-title>. In: <source>INTERSPEECH</source>, pp. <fpage>1449</fpage>–<lpage>1452</lpage>.</mixed-citation>
    </ref>
    <ref id="btv193-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shi</surname><given-names>Y.</given-names></name><name><surname>Jiang</surname><given-names>H.</given-names></name></person-group> (<year>2013</year>) <article-title>rSeqDiff: detecting differential isoform expression from RNA-seq data using hierarchical likelihood ratio test</article-title>. <source>PLoS One</source>, <volume>8</volume>, <fpage>e79448</fpage>.<pub-id pub-id-type="pmid">24260225</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Teerapabolarn</surname><given-names>K.</given-names></name></person-group> (<year>2008</year>) <article-title>On the negative binomial approximation to the beta-negative binomial distribution</article-title>. <source>Int. J. Contemp. Math. Sci.</source>, <volume>3</volume>, <fpage>1213</fpage>–<lpage>1216</lpage>.</mixed-citation>
    </ref>
    <ref id="btv193-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Trapnell</surname><given-names>C.</given-names></name><etal/></person-group><italic>.</italic> (<year>2012</year>) <article-title>Differential analysis of gene regulation at transcript resolution with RNA-seq</article-title>. <source>Nat. Biotechnol.</source>, <volume>31</volume>, <fpage>46</fpage>–<lpage>53</lpage>.<pub-id pub-id-type="pmid">23222703</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>K.</given-names></name><etal/></person-group><italic>.</italic> (<year>2009</year>) <article-title>Regeneration, repair and remembering identity: the three Rs of Hox gene expression</article-title>. <source>Trends Cell Biol.</source>, <volume>19</volume>, <fpage>268</fpage>–<lpage>275</lpage>.<pub-id pub-id-type="pmid">19428253</pub-id></mixed-citation>
    </ref>
    <ref id="btv193-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yuan</surname><given-names>M.</given-names></name><name><surname>Kendziorski</surname><given-names>C.</given-names></name></person-group> (<year>2006</year>) <article-title>Hidden Markov models for microarray time course data in multiple biological conditions</article-title>. <source>J. Am. Stat. Assoc.</source>, <volume>101</volume>, <fpage>1323</fpage>–<lpage>1332</lpage>.</mixed-citation>
    </ref>
    <ref id="btv193-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zakany</surname><given-names>J.</given-names></name><name><surname>Duboule</surname><given-names>D.</given-names></name></person-group> (<year>2007</year>) <article-title>The role of Hox genes during vertebrate limb development</article-title>. <source>Curr. Opin. Genet. Dev.</source>, <volume>17</volume>, <fpage>359</fpage>–<lpage>366</lpage>.<pub-id pub-id-type="pmid">17644373</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
