<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1523218</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-7-189</article-id>
    <article-id pub-id-type="pmid">16597327</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-7-189</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Algorithms for incorporating prior topological information in HMMs: application to transmembrane proteins</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Bagos</surname>
          <given-names>Pantelis G</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>pbagos@biol.uoa.gr</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Liakopoulos</surname>
          <given-names>Theodore D</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>liakop@biol.uoa.gr</email>
      </contrib>
      <contrib id="A3" corresp="yes" contrib-type="author">
        <name>
          <surname>Hamodrakas</surname>
          <given-names>Stavros J</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>shamodr@biol.uoa.gr</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Cell Biology and Biophysics, Faculty of Biology, University of Athens, Athens 157 01, Greece</aff>
    <pub-date pub-type="collection">
      <year>2006</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>4</month>
      <year>2006</year>
    </pub-date>
    <volume>7</volume>
    <fpage>189</fpage>
    <lpage>189</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/7/189"/>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>1</month>
        <year>2006</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>4</month>
        <year>2006</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2006 Bagos et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2006</copyright-year>
      <copyright-holder>Bagos et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Bagos
               G
               Pantelis
               
               pbagos@biol.uoa.gr
            </dc:author><dc:title>
            Algorithms for incorporating prior topological information in HMMs: application to transmembrane proteins
         </dc:title><dc:date>2006</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 7(1): 189-. (2006)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2006)7:1&#x0003c;189&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Hidden Markov Models (HMMs) have been extensively used in computational molecular biology, for modelling protein and nucleic acid sequences. In many applications, such as transmembrane protein topology prediction, the incorporation of limited amount of information regarding the topology, arising from biochemical experiments, has been proved a very useful strategy that increased remarkably the performance of even the top-scoring methods. However, no clear and formal explanation of the algorithms that retains the probabilistic interpretation of the models has been presented so far in the literature.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present here, a simple method that allows incorporation of prior topological information concerning the sequences at hand, while at the same time the HMMs retain their full probabilistic interpretation in terms of conditional probabilities. We present modifications to the standard Forward and Backward algorithms of HMMs and we also show explicitly, how reliable predictions may arise by these modifications, using all the algorithms currently available for decoding HMMs. A similar procedure may be used in the training procedure, aiming at optimizing the labels of the HMM's classes, especially in cases such as transmembrane proteins where the labels of the membrane-spanning segments are inherently misplaced. We present an application of this approach developing a method to predict the transmembrane regions of alpha-helical membrane proteins, trained on crystallographically solved data. We show that this method compares well against already established algorithms presented in the literature, and it is extremely useful in practical applications.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The algorithms presented here, are easily implemented in any kind of a Hidden Markov Model, whereas the prediction method (HMM-TM) is freely available for academic users at <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.biol.uoa.gr/HMM-TM"/>, offering the most advanced decoding options currently available.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Hidden Markov Models (HMMs) are probabilistic models [<xref ref-type="bibr" rid="B1">1</xref>], commonly used during the last years for applications in bioinformatics [<xref ref-type="bibr" rid="B2">2</xref>]. These tasks include gene finding [<xref ref-type="bibr" rid="B3">3</xref>], multiple alignments [<xref ref-type="bibr" rid="B4">4</xref>] and database searches [<xref ref-type="bibr" rid="B5">5</xref>], prediction of signal peptides [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>], prediction of protein secondary structure [<xref ref-type="bibr" rid="B8">8</xref>], prediction of transmembrane protein topology [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B10">10</xref>], as well as joint prediction of transmembrane helices and signal peptides [<xref ref-type="bibr" rid="B11">11</xref>]. Especially in the case of transmembrane proteins, HMMs have been found to perform significantly better compared to other sophisticated Machine-Learning techniques such as Neural Networks (NNs) or Support Vector Machines (SVMs). This is the case irrespective to which class of transmembrane proteins we refer to, since it has been shown that the best currently available predictors for alpha-helical membrane proteins [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>] as well as for beta-barrel outer membrane proteins [<xref ref-type="bibr" rid="B14">14</xref>], are methods based on HMMs.</p>
    <p>Experimental techniques are routinely used to partially uncover the transmembrane topology of membrane proteins (in contrast to the more expensive and difficult method of crystallography with which the detailed three-dimensional structure is elucidated). Such methods include the use of various reporter fusions [<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B16">16</xref>], chemical labelling [<xref ref-type="bibr" rid="B17">17</xref>], epitope tagging [<xref ref-type="bibr" rid="B18">18</xref>], antibodies [<xref ref-type="bibr" rid="B19">19</xref>] and Cysteine scanning mutagenesis [<xref ref-type="bibr" rid="B20">20</xref>]. The gene fusion approach seems to be the most effective method and the reporters used, include alkaline phosphatase (PhoA), beta-galactosidase (LacZ) [<xref ref-type="bibr" rid="B21">21</xref>], beta-lactamase (BlaM) [<xref ref-type="bibr" rid="B22">22</xref>] as well as various fluorescent proteins [<xref ref-type="bibr" rid="B23">23</xref>]. With the development of fast and reliable methods to utilise gene fusion technology in order to determine the location of a protein's C-terminus, it has been shown that incorporating topological information into the prediction methods improves largely the performance of even the top-scoring methods, making easy to screen newly sequenced genomes [<xref ref-type="bibr" rid="B24">24</xref>,<xref ref-type="bibr" rid="B25">25</xref>]. This has been demonstrated, using experimentally derived information regarding <italic>E. coli </italic>[<xref ref-type="bibr" rid="B26">26</xref>] and <italic>S. cerevisiae </italic>[<xref ref-type="bibr" rid="B27">27</xref>] protein datasets. More recently, a global topological analysis of the <italic>E. coli </italic>inner membrane proteins was performed, providing reliable models for more than 600 membrane proteins [<xref ref-type="bibr" rid="B28">28</xref>].</p>
    <p>Among the top-scoring HMM predictors currently available, HMMTOP [<xref ref-type="bibr" rid="B29">29</xref>] provides the user the option to incorporate such information. TMHMM is currently not supporting such an option in its standard web-server, and the users have to turn the TMHMMfix server [<xref ref-type="bibr" rid="B30">30</xref>] or to the joint prediction of transmembrane helices and signal peptides offered by Phobius [<xref ref-type="bibr" rid="B11">11</xref>]. Lately, Bernsel and von Heijne [<xref ref-type="bibr" rid="B31">31</xref>], used a similar idea that consisted of treating the occurrence (in a membrane protein) of soluble protein domains with known localisation, as experimentally determined topology. This way, they implemented a modified version of the HMM described by Viklund and Elofsson [<xref ref-type="bibr" rid="B13">13</xref>], in order to apply constrained predictions. However, even in this work the algorithmic details were not presented nor the prediction method became available to the public.</p>
    <p>Moreover, no effort has been made in the literature in order to completely and accurately describe the mathematical details of the algorithms that allow the arbitrary incorporation of such prior knowledge, in a way that prevents HMMs from loosing their probabilistic interpretation. The nature of HMMs, allows some brute conditioning; for instance, setting transition probabilities from a particular state to the end state to zero will allow the fixation of the C-terminus in the desired topology. Similarly, having knowledge of the presence of a signal peptide, after removing it, one may force the HMM to consider as allowed transitions from the begin state only those with direction to the extracellular loop states of the model. Unfortunately, the probabilistic interpretation of these results will be lost. Thus, it would be useful to have a method that enables us to arbitrarily fix any part of the sequence in a specified topology, while at the same time retaining the probabilistic interpretation of the algorithms used for decoding the HMM.</p>
    <p>In this work, we present some trivial modifications to the standard algorithms used in HMMs, namely the Forward and Backward algorithms [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>]. These modifications are very similar with those used on training HMMs with labelled sequences [<xref ref-type="bibr" rid="B32">32</xref>], but here they are considered in the context of models' decoding. We also show, that the likelihoods derived when applying these modified algorithms, can be expressed as posterior probabilities of the prior experimental information given the sequences and the model parameters, thus retaining this way the probabilistic interpretation of the results. We also introduce similar trivial modifications to all known algorithms used for decoding an HMM. In particular, we present modified versions of the standard Viterbi algorithm [<xref ref-type="bibr" rid="B2">2</xref>], which finds the most probable path of states, of the 1-best algorithm [<xref ref-type="bibr" rid="B33">33</xref>], which tries to find the optimal labelling of a sequence, giving always a labelling with equal or greater probability compared to the Viterbi decoding. Similar modifications follow for the "a-posteriori" decoding method [<xref ref-type="bibr" rid="B2">2</xref>], which in many applications, and under certain conditions, provides better prediction [<xref ref-type="bibr" rid="B34">34</xref>], as well as to the newly developed Posterior-Viterbi method [<xref ref-type="bibr" rid="B35">35</xref>] and the Optimal Accuracy Posterior Decoding method [<xref ref-type="bibr" rid="B36">36</xref>], that both combine elements of Viterbi and Posterior decoding.</p>
    <p>Finally, we present an application of these algorithms, training a HMM to predict the transmembrane segments of alpha-helical membrane proteins. The model is trained in a discriminative manner with the Conditional Maximum Likelihood (CML) criterion, using a dataset of proteins with structures known at atomic resolution, and it is shown (in cross-validation as well as in independent tests) to compare well against the top-scoring algorithms currently available. The method, HMM-TM, is freely available for academic users at <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.biol.uoa.gr/HMM-TM"/>, where the user may choose any of the four above mentioned algorithms for decoding, an option not currently available in any other prediction method.</p>
  </sec>
  <sec>
    <title>Results</title>
    <p>In Table <xref ref-type="table" rid="T1">1</xref>, we list the results obtained on the training set with our method (using the Optimal Accuracy Posterior Decoding), both on a self-consistency test and on a 9-fold cross-validation procedure. In the same table, for the sake of comparison, the results obtained on the same dataset are listed also, using the other available HMM and HMM-like predictors TMHMM [<xref ref-type="bibr" rid="B9">9</xref>], HMMTOP [<xref ref-type="bibr" rid="B29">29</xref>], MEMSAT [<xref ref-type="bibr" rid="B37">37</xref>], Phobius [<xref ref-type="bibr" rid="B11">11</xref>], UMDHMM<sup>TMHP </sup>[<xref ref-type="bibr" rid="B38">38</xref>], and the newly developed S-TMHMM, PRO-TMHMM and PRODIV-TMHMM [<xref ref-type="bibr" rid="B13">13</xref>]. All methods are using single sequence information except from PRO-TMHMM and PRODIV-TMHMM that use evolutionary information derived from multiple alignments. The recently published and very successful method of Martelli et al [<xref ref-type="bibr" rid="B39">39</xref>], was not considered in the current evaluation for several reasons. Firstly, the particular method is currently not available to the public. Secondly and more importantly, this method is based in an Ensemble network combining the results of two independent HMM modules with these of a Neural Network predictor, using a dynamic programming algorithm that filters the prediction in a last step. Thus, this method even though uses HMMs it cannot be benefited directly by the currently proposed methodology. Other popular and successful methods such as PHDhtm [<xref ref-type="bibr" rid="B40">40</xref>,<xref ref-type="bibr" rid="B41">41</xref>] and TopPred [<xref ref-type="bibr" rid="B42">42</xref>], were also not consider in this evaluation since on the one hand our intention was to evaluate only the HMM and HMM-like predictors that are amenable to incorporate the modifications presented here, and, on the other hand, due to their lower accuracy in general [<xref ref-type="bibr" rid="B13">13</xref>], as also as on the particular datasets [<xref ref-type="bibr" rid="B26">26</xref>]. For measures of accuracy, we chose the fraction of the correctly predicted residues (Q), the correlation coefficient (C), the segments overlap (SOV), as well as the fraction of proteins with correctly predicted transmembrane segments and correctly predicted topology [<xref ref-type="bibr" rid="B43">43</xref>,<xref ref-type="bibr" rid="B44">44</xref>].</p>
    <p>The differences in Q, C, SOV and in the number correctly predicted transmembrane segments among the methods compared here were not statistically significant (p-value&gt;0.05 in all cases; see Materials and methods). Only an overall difference in the number of correctly predicted topologies could be detected (p-value = 0.008), which is attributable to the large discrepancies between the high-scoring methods (those using evolutionary information) and the low-scoring ones (in this case TMHMM, HMMTOP and MEMSAT). However, even this should be questionable due to the presence in the set used for training PRO-TMHMM, PRODIV-TMHMM of proteins similar to the ones we compare here.</p>
    <p>Even though some of the proteins present in the training set were also included in the sets used for training the other predictors, HMM-TM as tested in the cross-validation test, performs better compared to methods that use single sequences. The superiority is visible (although not statistically significant) in almost all measured attributes, but it is more evident in the number of correctly predicted topologies. We have to assume that the combination of the quality of the training dataset, the CML training scheme and the label optimisation procedure that was performed using the above-mentioned algorithms, is responsible for this result, even though the training set is the one of the smallest that has ever been used for alpha-helical membrane proteins. HMM-TM, when trained and tested on the whole dataset of 72 proteins clearly outperforms also, the algorithmically simpler HMM method UMDHMM<sup>TMHP </sup>that is trained on the same dataset (SOV = 0.978 and 0.933 respectively, correctly predicted topologies 94.4% and 84.7%, respectively). Compared against the methods that utilise multiple alignments, HMM-TM performs slightly worse, something already expected [<xref ref-type="bibr" rid="B13">13</xref>]. However the superiority of the two multiple alignment-based methods is not in the extent previously believed, considering also the presence of homologous sequences in the set used to train these methods, and the non-significant result of the Kruskal-Wallis test. The Optimal Accuracy Posterior Decoding, the Posterior decoding with the dynamic programming and the Posterior-Viterbi decoding, perform equally well, and both are superior to the 1-best and Viterbi algorithms, results which, at least for this case, are in partial agreement with those reported in [<xref ref-type="bibr" rid="B35">35</xref>,<xref ref-type="bibr" rid="B36">36</xref>].</p>
    <p>When the performance of the methods was tested in the independent test set of 26 proteins (see Materials and methods section), similar results were obtained (Table <xref ref-type="table" rid="T2">2</xref>). All methods (perhaps with the exception of MEMSAT) seem to perform equally well, and in all cases the performance of the topology prediction lies within the expected range.</p>
    <p>No statistically significant differences could be found concerning Q, C, SOV and the number of correctly predicted transmembrane segments among the different methods (p &gt; 0.05 in all cases). However, when comparing the number of correctly predicted topologies, there was a marginally significant difference with a p-value of 0.052. When excluding the three worst performing methods (Phobius, MEMSAT and PRO-TMHMM), no overall differences could be detected (p-value = 0.208). In the pairwise comparisons of HMM-TM against these three methods (without however adjusting for multiple testing), HMM-TM performs better than MEMSAT and Phobius (p-value = 0.021) and marginally better than PRO-TMHMM (p-value = 0.074). Overall, HMM-TM performs slightly better than both TMHMM and HMMTOP, and it is interesting that UMDHMM<sup>TMHP </sup>performs somewhat better, even though in some cases it yields spurious predictions such as a transmembrane helix with 58 amino-acids length (1KPL:A). Interestingly, the newly developed methods (S-TMHMM, PRO-TMHMM and PRODIV-TMHMM) do not seem to perform better, despite the presence in their training set of some sequences similar to those under evaluation. Even though the independent test set consists mostly of multi-spanning (21 out of 26), and Prokaryotic proteins (22 out of the 26), its use is currently the most appropriate solution since we wanted to independently test the predictors in an, as much as larger as possible dataset, consisting of proteins having no significant similarity to the ones used for training each method. We should emphasize, that in nearly all the publications describing similar prediction methods, an independent test set was not used [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B36">36</xref>]. Only Martelli et al [<xref ref-type="bibr" rid="B39">39</xref>], used as an independent test set, proteins with topology determined by low-resolution biochemical experiments, and concluded that such datasets should not be used either as training or test datasets. This last argument, also applies in order to explain the fact that we were not used such proteins to further enlarge the test set making it thus more balanced.</p>
    <p>Our prediction method was also tested on the 2 datasets containing proteins from <italic>E. coli </italic>[<xref ref-type="bibr" rid="B26">26</xref>] and <italic>S. cerevisiae </italic>[<xref ref-type="bibr" rid="B27">27</xref>](31 and 37 respectively). For reasons of brevity, the detailed results are listed in [<xref ref-type="supplementary-material" rid="S1">Additional File 1</xref>]. We observe, that our method compares favourably to the other available predictors. In the <italic>E. coli </italic>dataset, HMM-TM predicts correctly the localization of the C-terminal part of the sequence for 29 out of the 31 proteins (93.54%), outperformed only by Phobius, which predicts correctly 30 out of the 31 proteins (96.77%). Compared against the methods using evolutionary information (PRO-TMHMM, PRODIV-TMHMM), our method performs similarly to the PRODIV-TMHMM (which predicts 29 out of the 31 proteins correctly), and better than PRO-TMHMM (28 out of 31). All the remaining methods (TMHMM, HMMTOP, MEMSAT, UMDHMM<sup>TMHP </sup>and S-TMHMM) perform significantly worse, yielding from 20 to 27 correct predictions. In this dataset, the Kruskal-Wallis test yields an overall p-value of 0.0019, suggesting that there are true statistically detectable differences in the performance of the various methods. In the pairwise comparisons HMM-TM performs significantly better compared to UMDHMM<sup>TMHP </sup>(p-value = 0.0054, which remains significance after adjusting for multiple comparisons) and against MEMSAT (p-value = 0.011, which does not remain significant after adjustment). The comparisons of HMM-TM against the remaining methods yielded insignificant results. Excluding from the analysis these two last methods, no overall differences could be found (p-value = 0.154). Furthermore, the two methods using evolutionary information (PRO-TMHMM, PRODIV-TMHMM) do not perform significantly better compared to the other four single-sequence methods (HMM-TM, TMHMM, HMMTOP and S-TMHMM), since the Kruskal-Wallis test yields an overall p-value of 0.314. Concerning the number of the predicted transmembrane helices, HMM-TM predicts closely to the other available top-scoring predictors. For instance, it is in agreement with the predictions obtained from TMHMM for 30 out of the 34 proteins, with those obtained from HMMTOP for 28 out of the 34, and for 29 out of the 34 proteins with those obtained from PRO-TMHMM and PRODIV-TMHMM.</p>
    <p>In the <italic>S. cerevisiae </italic>dataset, top-scoring methods were found to be HMMTOP, MEMSAT, PRO-TMHMM and PRODIV-TMHMM correctly predicting the localisation for the C-terminus for 32 out of the 37 proteins (86.50%). HMM-TM, predicts correctly 30 out of the 37 proteins (81.1%), and TMHMM, S-TMHMM and UMDHMM<sup>TMHP </sup>reached correct conclusions for 28 out of the 37 proteins (75.7%). Phobius in this dataset performs significantly worse, reaching an accuracy of only 70.27%. Similar observations hold also for this set, concerning the number of predicted transmembrane segments, and the general agreement of our method with the others. In this dataset however, there are not large discrepancies among the various methods resulting in an overall insignificant Kruskal-Wallis test (p-value = 0.487).</p>
    <p>In total (summing the 2 sets), the 2 methods using evolutionary information (PRO-TMHMM and PRODIV-TMHMM), were ranked first, with 88.23% and 89.71% correct predictions respectively, followed by HMM-TM (86.76%), HMMTOP (83.82%), Phobius (82.35%), TMHMM (80.88%), MEMSAT (77.94%), S-TMHMM (76.47%) and UMDHMM<sup>TMHP </sup>(70.59%). However, these differences showed no overall statisticall significance (p-value = 0.086).</p>
    <p>Even though, the methods using evolutionary information perform slightly (in some datasets) better than HMM-TM, their superiority is not validated statistically here and more importantly, they do not offer the option to fix the topology of various sequence parts. Only TMHMM, Phobius and HMMTOP offer such options, and compared to them, HMM-TM seems to perform constantly better in all the tests performed. Interestingly, when the experimentally determined topology of the C-terminus is incorporated into the predictions for the two proteins on which the method failed (YDGG_ECOLI, ZITB_ECOLI), the predicted number of transmembrane segments changes (from 7 to 8 and from 7 to 6, respectively) and shows a remarkable agreement with those predicted by the above-mentioned methods (figure <xref ref-type="fig" rid="F1">1</xref>). Using the same reasoning for the proteins missed by HMMTOP and TMHMM, we can reach similar conclusions. In the independent dataset of 26 proteins, if we fix the location of the C-terminus to its observed topology, all of the methods that are capable of incorporating such information (HMM-TM, TMHMM, HMMTOP and Phobius), increase both the number of correctly predicted transmembrane segments and the number of correctly predicted topologies. In HMM-TM the number of correctly predicted transmembrane segments is increased from 21 to 22, as well as the number of correctly predicted topologies (from 21 to 22). Similarly, in TMHMM number of correctly predicted topologies becomes 19 (from 17), while the number of correctly predicted transmembrane segments remains 19; in HMMTOP we observe only a slight increase of the correctly predicted topologies (19 from 18) and finally for Phobius we observe an increase both in the correctly predicted topologies becomes (16 from 13) and in the correctly predicted transmembrane segments (16 from 15). Similar results were presented initially in the work of Mellen, Krogh and von Heijne [<xref ref-type="bibr" rid="B24">24</xref>], but here we could not validate them statistically due to the small sample size. Thus, this observation should be further tested in a larger independent dataset of proteins with experimentally determined topology. We have to mention though, that there is a clear gain in correctly specifying the topology using such algorithms, and in future works it might be tempting to construct a predictor that uses both evolutionary derived information and the option to fix various sequence parts in the desired location.</p>
    <p>The usefulness and the practical applicability of the prediction method described here, combined with the option of fixing the topology of various segments along the sequence incorporating this way the experimental information during the decoding phase, could be demonstrated in the case of the multidrug efflux transporter AcrB of <italic>E. coli</italic>. The structure has been resolved crystallographically [<xref ref-type="bibr" rid="B45">45</xref>], and it has been shown that the protein contains 12 transmembrane helices (AcrB is included in the blind test set of 26 proteins used in this study). All the prediction methods used here (with the exception of S-TMHMM, PRO-TMHMM and PRODIV-TMHMM, which in their training set used a close homologue, MexB) failed to accurately predict the full topology of the protein. As we can see (Figure <xref ref-type="fig" rid="F2">2</xref>, upper part), HMM-TM misses 2 transmembrane segments, while falsely predicts an additional segment that does not exist. However, using the results obtained from cysteine-scanning mutagenesis [<xref ref-type="bibr" rid="B46">46</xref>], and incorporating them in the predictions obtained with HMM-TM (Figure <xref ref-type="fig" rid="F2">2</xref>, lower part), results in a highly reliable prediction that is in excellent agreement with the obtained crystallographically solved structure.</p>
    <p>Lastly, even though this was not a primary intention of our study, we evaluated the discrimination capabilities of the methods on the set of 645 globular proteins with known three-dimensional structures, a set used initially for the same purpose in the evaluation of TMHMM [<xref ref-type="bibr" rid="B9">9</xref>]. The results were very conflicting reflecting the differences in the training strategies of the various predictors as well as the different primary intentions of their developers. Thus, when the total number of proteins predicted to be non transmembrane was evaluated, methods that were designed to be applied only on transmembrane proteins such as HMM-TM, HMMTOP, UMDHMM<sup>TMHP</sup>, MEMSAT and PRODIV-TMHMM perform poorly, predicting falsely 15.5%, 8.37%, 24.18%, 99.84% and 76.89% of the globular proteins to possess at least one transmembrane segment, respectively. From the other hand, methods that were trained initially in order to discriminate globular proteins from transmembrane ones, such as TMHMM, Phobius, S-TMHMM and PRO-TMHMM, perform considerably better, predicting respectively only 0.62%, 1.1%, 1.7% and 0.62% of the globular proteins to be transmembrane. When we considered as a discrimination criterion the total number of aminoacids predicted in transmebrane segments, and taking as a cut-off length the value of 19 aminoacids, HMM-TM predicts falsely 5.73% of the globular proteins, TMHMM 0.46%, HMMTOP 4.96%, Phobius 0.9%, UMDHMM<sup>TMHP </sup>11.32%, MEMSAT 14.42%, S-TMHMM 1.7%, PRO-TMHMM 0.62% and PRODIV-TMHMM 76.89%. The differences in both cases are highly significant (p-values&lt;0.001), and it is evident that PRODIV-TMHMM is highly unreliable for discrimination purposes, a fact noticed already in [<xref ref-type="bibr" rid="B13">13</xref>], followed by MEMSAT and UMDHMM<sup>TMHP</sup>, whereas HMM-TM and HMMTOP form a group of intermediate reliability just before the highly reliable for this task methods, TMHMM, Phobius, S-TMHMM and PRO-TMHMM.</p>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>The primary intention of this work was to introduce the modifications to the standard algorithms that will allow incorporation of prior structural or topological information during the decoding procedure; however, the prediction method presented is quite accurate. One may argue, that we should have trained a prediction method that uses evolutionary information in order to achieve the best possible results [<xref ref-type="bibr" rid="B13">13</xref>]. However, this was not possible currently for technical reasons. Furthermore, as we already stated, the primary intention of the particular work was to present the algorithmic details, and not to develop a prediction method. Thus, the algorithmic modifications could now be easily applied in any prediction method based on a HMM.</p>
    <p>From the reported results, it is obvious, that HMM-TM performs comparably if not better than the already established top-scoring HMM methods using single sequences and compares well against the methods using multiple alignments. As a matter of fact, using a rigorous statistical methodology, we found that HMM-TM is not outperformed significantly in any of the tests presented here (except for the test discrimination capabilities). On the contrary, clearly outperforms some of the available methods in some of the performed tests. These conclusions, are valid also for the per-residue and per-segment measures reported in the set of 72 proteins, as well as for the blind test on newly solved three-dimensional structures and on proteins with experimentally verified location of the C-terminus. However, there are cases in which a joint prediction could give better results than each one of the individual methods. From the detailed results listed in [<xref ref-type="supplementary-material" rid="S1">Additional File 1</xref>], we observe that for only 2 out of the 68 proteins used (YNT4_YEAST, Q03193) all of the available algorithms fail to predict correctly the localisation of the C-terminal. This yields another potential use for HMM-TM besides acting as a standalone predictor: it could be very useful as a part of a consensus prediction method. Such consensus predictions, have been proven to significantly improve the predictive performance compared to individual methods, either referring to alpha-helical [<xref ref-type="bibr" rid="B47">47</xref>-<xref ref-type="bibr" rid="B49">49</xref>], beta-barrel membrane proteins [<xref ref-type="bibr" rid="B14">14</xref>] or to general secondary structure prediction methods [<xref ref-type="bibr" rid="B50">50</xref>]. For developing a successful consensus prediction method, it is necessary to have high-scoring individual methods, producing independent results, which indeed is the case here.</p>
    <p>We should emphasize also at this point, that the algorithmic modifications that we introduce, by no way confer bias to the prediction method. Thus, when the decoding (prediction) is applied in an unconstrained manner, the results obtained are not by any means are affected by the existence of the modifications since they do not used at all. However, when experimentally derived information emerges, the algorithmic modifications force the predictions to be in agreement with this prior information. Thus, in such cases it is reasonable to observe better predictions obtained by such an algorithm (that uses the prior information) compared to another algorithm (even a superior one) that does not use this information. Ideally, in future works these modifications should be applied to a prediction method that uses evolutionary information in order to obtain the best possible results. Furthermore, the extent to which the prior knowledge affects the rate of the correct predictions should be evaluated in a larger dataset.</p>
    <p>The algorithmic modifications presented in this paper (see Materials and methods), are for the first time introduced in such detail, allowing one to implement them in a straightforward manner. Although these modifications appear trivial, there is clearly a need to be described in such a detail in order to further clarify some obscure points in the literature. All the relevant works addressed such an issue, in the past were either published as a short applications note in Computational Biology journals, or as regular papers in Molecular Biology journals, and in both cases they did not spend more than a sentence or two for describing the algorithms (with in some cases contradicting notations). For instance, in the first published work that mentions a constraint prediction [<xref ref-type="bibr" rid="B29">29</xref>], the authors state (emphasis added from us): "This segment information is incorporated into the <italic>Baum-Welch algorithm by a conditional probability</italic>." In a later work [<xref ref-type="bibr" rid="B24">24</xref>], the authors simply state that: "The basic TMHMM algorithm allows one to fix the class-assignment for any position in the sequence <italic>by setting the probability for a position to belong to a certain class to 1.0 a </italic>priori." Finally, in a recently published work [<xref ref-type="bibr" rid="B31">31</xref>], Bernsel and von Heijne state that: "The IN/OUT-fixation of a certain residue is <italic>achieved by setting the corresponding state probability in the HMM equal to 1.0, ..."</italic>. Clearly, these statements do not constitute complete and thoroughly described methodology that it is easily applicable from someone willing to incorporate such options to a prediction method.</p>
    <p>Furthermore, here for the first time we apply algorithms for constrained predictions applicable to all the currently available decoding methods, and in all cases preserving the probabilistic nature of the HMM. It is clear though, that these modifications can also be used in any decoding algorithm may appear in the future, or in any HMM trained with various schemes (ML or CML), as well as in methods using evolutionary information or not. Lastly, we should also point that in this work we considered only incorporating in the prediction the experimentally verified topology of various sequence segments. Other works have been presented, dealing for instance with the incorporation of prior physicochemical knowledge concerning the propensity of a helix to be transmembrane or not [<xref ref-type="bibr" rid="B51">51</xref>]. Clearly, such approaches even though useful in practical applications, are irrelevant to the currently proposed methodology and should be considered separately.</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We have presented here, modified algorithms for incorporating prior topological information into HMMs. These algorithms constitute trivial modifications to the well known Forward and Backward algorithms involved in the probability calculations on HMMs, as well as to the already established algorithms for decoding such models (Viterbi, 1-best, and the variants of posterior decoding). We presented these algorithms without introducing further computational complexity, while at the same time retaining the probabilistic interpretation of the results. These algorithms may also be useful in other applications of HMMs, besides the transmembrane protein topology prediction, since they could be applied in any circular HMM, irrespective of the training procedure used. We have shown that these algorithms could be used also with more complex labelling schemes as well as with HMMs using both discrete and continuous emission probabilities. The same modifications may also be applied in optimising the discriminative capability of the models, especially in cases of misplaced labelling arising from inherently mislabelled data. We have presented an application in the prediction of transmembrane segments of alpha-helical membrane proteins, and we developed a method that compares well against, if not better than, the already available top-scoring methods for the same task either using single sequences or multiple alignments. We also have to note, that the method presented here undoubtedly seems to perform better compared to the other HMM predictors that allow the incorporation of experimentally derived information. We also confirmed the results of previous studies, indicating that incorporation of prior topological knowledge will further improve the performance of predictive algorithms, and provided evidence that using a consensus of the top-scoring methods, the predictive performance increases. Consensus of individual methods has been proven a useful strategy for obtaining better predictions, and thus, it could be benefited from including even more high-scoring individual methods. Finally, we set up a web-server, freely available to academic users, where the above-mentioned predictive method can be found (<ext-link ext-link-type="uri" xlink:href="http://bioinformatics.biol.uoa.gr/HMM-TM"/>), offering the most advanced decoding options currently available. The method developed here might be useful to experimentalists who require reliable predictions, in the light of experimentally derived information.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Hidden Markov models</title>
      <p>Two states <italic>k, l </italic>of a Hidden Markov model are connected by means of the transition probabilities <italic>α</italic><sub><italic>kl</italic></sub>. Assuming a protein sequence <bold>x </bold>of length <italic>L </italic>denoted as:</p>
      <p><bold>x </bold>= <italic>x<sub>1</sub></italic>, <italic>x<sub>2</sub></italic>, ...,<italic>x<sub>L</sub></italic>,     (1)</p>
      <p>where the <italic>x</italic><sub><italic>i</italic></sub>'s are the 20 amino acids, we usually denote the "path" (i.e. the sequence of states) ending up to a particular position of the amino acid sequence (the sequence of symbols), by <italic>π</italic>. Each state <italic>k </italic>is associated with an emission probability <italic>e<sub>k</sub>(x<sub>i</sub>)</italic>, which is the probability of a particular symbol <italic>x</italic><sub><italic>i </italic></sub>to be emitted by that state. Formally, we also need two other special states, named <italic>begin (B) </italic>and <italic>end state (E)</italic>, which are essential for starting and ending the process, respectively. These states however, do not emit any symbol. The total probability of a sequence given the model, is calculated by summing over all possible paths using the Forward or the Backward algorithm:</p>
      <p>
        <inline-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-7-189-i1" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mi>P</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mi>π</mml:mi>
                  </mml:munder>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>π</mml:mi>
                        <mml:mo>|</mml:mo>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mi>π</mml:mi>
                  </mml:munder>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>a</mml:mi>
                      <mml:mrow>
                        <mml:mi>B</mml:mi>
                        <mml:msub>
                          <mml:mi>π</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mo>∏</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>e</mml:mi>
                      <mml:mrow>
                        <mml:mi>π</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>x</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:msub>
                      <mml:mi>a</mml:mi>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>π</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>π</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mo>+</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msub>
                    <mml:mtext>     </mml:mtext>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mn>2</mml:mn>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGqbaudaqadaqaaGqabiab=Hha4jabcYha8HGaciab+H7aXbGaayjkaiaawMcaaiabg2da9maaqafabaGaemiuaa1aaeWaaeaacqWF4baEcqGGSaalcqGFapaCcqGG8baFcqGF4oqCaiaawIcacaGLPaaaaSqaaiab+b8aWbqab0GaeyyeIuoakiabg2da9maaqafabaGaemyyae2aaSbaaSqaaiabdkeacjab+b8aWnaaBaaameaacqaIXaqmaeqaaaWcbeaaaeaacqGFapaCaeqaniabggHiLdGcdaqeqbqaaiabdwgaLnaaBaaaleaacqGFapaCcqWGPbqAaeqaaOWaaeWaaeaacqWG4baEdaWgaaWcbaGaemyAaKgabeaaaOGaayjkaiaawMcaaiabdggaHnaaBaaaleaacqGFapaCdaWgaaadbaGaemyAaKgabeaaliab+b8aWnaaBaaameaacqWGPbqAcqGHRaWkcqaIXaqmaeqaaaWcbeaakiaaxMaacaWLjaWaaeWaaeaacqaIYaGmaiaawIcacaGLPaaaaSqaaiabdMgaPjabg2da9iabigdaXaqab0Gaey4dIunaaaa@696A@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </inline-formula>
      </p>
      <p>The generalization from one to many sequences is trivial, and we will consider only one training sequence <bold>x </bold>in the following. When using labelled sequences for training, each amino acid sequence <bold>x </bold>is accompanied by a sequence of labels <bold>y </bold>for each position <italic>i </italic>in the sequence:</p>
      <p><bold>y </bold>= <italic>y<sub>1</sub></italic>, <italic>y<sub>2</sub></italic>, ...,<italic>y<sub>L </sub></italic>    (3)</p>
      <p>Krogh [<xref ref-type="bibr" rid="B32">32</xref>] proposed a simple modified version of the forward and backward algorithms, in order to incorporate information from labelled data. The likelihood to be maximized in such situations is the joint probability of the sequences and the labelling given the model:</p>
      <p>
        <inline-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-7-189-i2" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mi>P</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>x</mml:mi>
                    <mml:mo>,</mml:mo>
                    <mml:mi>y</mml:mi>
                    <mml:mo>|</mml:mo>
                    <mml:mi>θ</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mi>π</mml:mi>
                  </mml:munder>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>y</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>π</mml:mi>
                        <mml:mo>|</mml:mo>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>π</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:msub>
                        <mml:mi>Π</mml:mi>
                        <mml:mi>y</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mrow>
                    <mml:mi>P</mml:mi>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mrow>
                        <mml:mi>x</mml:mi>
                        <mml:mo>,</mml:mo>
                        <mml:mi>π</mml:mi>
                        <mml:mo>|</mml:mo>
                        <mml:mi>θ</mml:mi>
                      </mml:mrow>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                    <mml:mtext>     </mml:mtext>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mn>4</mml:mn>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGqbaudaqadaqaaGqabiab=Hha4jab=XcaSiab=Lha5jabcYha8HGaciab+H7aXbGaayjkaiaawMcaaiabg2da9maaqafabaGaemiuaa1aaeWaaeaacqWF4baEcqWFSaalcqWF5bqEcqGGSaalcqGFapaCcqGG8baFcqGF4oqCaiaawIcacaGLPaaaaSqaaiab+b8aWbqab0GaeyyeIuoakiabg2da9maaqafabaGaemiuaa1aaeWaaeaacqWF4baEcqGGSaalcqGFapaCcqGG8baFcqGF4oqCaiaawIcacaGLPaaacaWLjaGaaCzcamaabmaabaGaeGinaqdacaGLOaGaayzkaaaaleaacqGFapaCcqGHiiIZcqqHGoaudaWgaaadbaGaemyEaKhabeaaaSqab0GaeyyeIuoaaaa@5EDF@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </inline-formula>
      </p>
      <p>This way, the summation has to be done only over those paths Π<sub><italic>y </italic></sub>that are in agreement with the labels <bold>y</bold>. Consequently, one has to declare a new probability distribution, the probability <italic>λ</italic><sub><italic>k</italic></sub><italic>(c) </italic>of a state <italic>k </italic>having a label <italic>c</italic>. In most of the biological applications, this probability is just a delta-function, since a particular state is not allowed to match more than one label.</p>
      <p>
        <inline-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-7-189-i3" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>λ</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:msub>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mi>c</mml:mi>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                            <mml:mo>,</mml:mo>
                            <mml:mtext>if </mml:mtext>
                            <mml:mi>k</mml:mi>
                            <mml:mo>∈</mml:mo>
                            <mml:msub>
                              <mml:mi>σ</mml:mi>
                              <mml:mi>c</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:mn>0</mml:mn>
                            <mml:mo>,</mml:mo>
                            <mml:mtext>if </mml:mtext>
                            <mml:mi>k</mml:mi>
                            <mml:mo>∉</mml:mo>
                            <mml:msub>
                              <mml:mi>σ</mml:mi>
                              <mml:mi>c</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                    <mml:mtext>     </mml:mtext>
                    <mml:mrow>
                      <mml:mo>(</mml:mo>
                      <mml:mn>5</mml:mn>
                      <mml:mo>)</mml:mo>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWF7oaBdaWgaaWcbaGaem4AaSgabeaakmaabmaabaGaem4yamgacaGLOaGaayzkaaWaaiqaaeaafaqabeGabaaabaGaeGymaeJaeiilaWIaeeyAaKMaeeOzayMaeeiiaaIaem4AaSMaeyicI4Sae83Wdm3aaSbaaSqaaiabdogaJbqabaaakeaacqaIWaamcqGGSaalcqqGPbqAcqqGMbGzcqqGGaaicqWGRbWAcqGHjiYZcqWFdpWCdaWgaaWcbaGaem4yamgabeaaaaGccaWLjaGaaCzcamaabmaabaGaeGynaudacaGLOaGaayzkaaaacaGL7baaaaa@4E92@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </inline-formula>
      </p>
      <p>where <italic>σ</italic><sub><italic>c </italic></sub>is the set of states sharing the same label (c). Labelled sequences are used in the training phase (either by Maximum Likelihood or by Conditional Maximum Likelihood), since in the decoding phase in which we do not know the path, the likelihood that is been calculated is of the form of equation (2). An HMM could also be trained using unlabelled sequences. However, having a complex model comprising of a lot of states, even in the decoding phase, we eventually have to cluster the states in "classes" that each one represents some biological meaningful entity. For instance, in the case of transmembrane proteins, these labels (classes) would probably be membrane (M), intracellular (I) and extracellular or outer (O), irrespective of which method the model was trained with. Thus, in the following, we will use the concept of labels in the decoding phase, no matter what training technique has been followed.</p>
      <p>The algorithms that we present here are also very useful in the training phase using labelled sequences, under certain circumstances. For instance, in transmembrane protein topology prediction, even if the observed labels come from crystallographically solved structures, we cannot locate precisely the boundaries of the lipid bilayer. Thus, these inherently misplaced labels may bias the training, towards poor discriminative capability. In some of the most successful models for predicting the membrane-spanning alpha helices [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B13">13</xref>], an optimisation procedure was used, according to which the model was trained initially, the labels were partially disregarded around the ends of the transmembrane helices, and predictions conditional on the remaining labels were performed, in order to re-label the data until the final training procedure. The authors of these methods did not explicitly provide details on the algorithms they used, but the most obvious way for such a procedure to be performed is by using some algorithmic modifications such as those presented here.</p>
    </sec>
    <sec>
      <title>Forward and Backward algorithms</title>
      <p>The standard algorithm employed in the likelihood calculations in HMMs, is the Forward algorithm. It is a dynamic programming algorithm that sums iteratively the probabilities of all the possible paths through the sequence. The algorithm as presented in [<xref ref-type="bibr" rid="B2">2</xref>] is:</p>
      <sec>
        <title>Forward algorithm</title>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-7-189-i4" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mi>k</mml:mi>
                      <mml:mo>≠</mml:mo>
                      <mml:mi>B</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>:</mml:mo>
                      <mml:msub>
                        <mml:mi>f</mml:mi>
                        <mml:mi>B</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mi>f</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>L</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:msub>
                        <mml:mi>f</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>e</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:munder>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>f</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mstyle>
                      <mml:mtext>     </mml:mtext>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>6</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>|</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mstyle displaystyle="true">
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:munder>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>f</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mi>L</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mi>E</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakqaabeqaaiabgcGiIiabdUgaRjabgcMi5kabdkeacjabcYcaSiabdMgaPjabg2da9iabicdaWiabcQda6iabdAgaMnaaBaaaleaacqWGcbGqaeqaaOWaaeWaaeaacqaIWaamaiaawIcacaGLPaaacqGH9aqpcqaIXaqmcqGGSaalcqWGMbGzdaWgaaWcbaGaem4AaSgabeaakmaabmaabaGaeGimaadacaGLOaGaayzkaaGaeyypa0JaeGimaaJaeiilaWcabaGaeyiaIiIaeGymaeJaeyizImQaemyAaKMaeyizImQaemitaWKaeiOoaOJaemOzay2aaSbaaSqaaiabdYgaSbqabaGcdaqadaqaaiabdMgaPbGaayjkaiaawMcaaiabg2da9iabdwgaLnaaBaaaleaacqWGSbaBaeqaaOWaaeWaaeaacqWG4baEdaWgaaWcbaGaemyAaKgabeaaaOGaayjkaiaawMcaamaaqafabaGaemOzay2aaSbaaSqaaiabdUgaRbqabaGcdaqadaqaaiabdMgaPjabgkHiTiabigdaXaGaayjkaiaawMcaaiabdggaHnaaBaaaleaacqWGRbWAcqWGSbaBaeqaaaqaaiabdUgaRbqab0GaeyyeIuoakiaaxMaacaWLjaWaaeWaaeaacqaI2aGnaiaawIcacaGLPaaaaeaacqWGqbaudaqadaqaaGqabiab=Hha4jabcYha8HGaciab+H7aXbGaayjkaiaawMcaaiabg2da9maaqafabaGaemOzay2aaSbaaSqaaiabdUgaRbqabaGcdaqadaqaaiabdYeambGaayjkaiaawMcaaiabdggaHnaaBaaaleaacqWGRbWAcqWGfbqraeqaaaqaaiabdUgaRbqab0GaeyyeIuoaaaaa@8682@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>We will define the concept of the <italic>Information</italic>, <bold>ω </bold>that consists of 1≤<italic>r</italic>≤<italic>L </italic>residues of the sequence <bold>x</bold>, of which we know the experimentally determined topology, and thus the (<italic>a priori</italic>) labelling <italic>ω</italic><sub><italic>i</italic></sub>:</p>
        <p><bold>ω </bold>= <italic>ω<sub>1</sub></italic>, <italic>ω<sub>2</sub></italic>, ...,<italic>ω</italic><sub><italic>r </italic></sub>    (7)</p>
        <p>According to this terminology, the set of residues with <italic>a priori </italic>known labels <italic>ω</italic><sup><italic>r</italic></sup>, is a subset of the set <italic>I </italic>= {1,2, ...,<italic>L</italic>} defined by the residues of the sequence. It is obvious that the labels <italic>ω</italic><sub><italic>i</italic></sub>, should belong to the same set of labels defined in the model architecture. Finally, we have to declare a delta function with values given by:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-7-189-i5" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>d</mml:mi>
                    <mml:mi>k</mml:mi>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mo>{</mml:mo>
                    <mml:mrow>
                      <mml:mtable columnalign="left">
                        <mml:mtr columnalign="left">
                          <mml:mtd columnalign="left">
                            <mml:mrow>
                              <mml:mn>0</mml:mn>
                              <mml:mo>,</mml:mo>
                              <mml:mtext>if </mml:mtext>
                              <mml:msub>
                                <mml:mi>λ</mml:mi>
                                <mml:mi>k</mml:mi>
                              </mml:msub>
                              <mml:mrow>
                                <mml:mo>(</mml:mo>
                                <mml:mrow>
                                  <mml:msub>
                                    <mml:mi>ω</mml:mi>
                                    <mml:mi>i</mml:mi>
                                  </mml:msub>
                                </mml:mrow>
                                <mml:mo>)</mml:mo>
                              </mml:mrow>
                              <mml:mo>≠</mml:mo>
                              <mml:mtext>0 and </mml:mtext>
                              <mml:mi>i</mml:mi>
                              <mml:mo>∈</mml:mo>
                              <mml:msup>
                                <mml:mi>ω</mml:mi>
                                <mml:mi>r</mml:mi>
                              </mml:msup>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr columnalign="left">
                          <mml:mtd columnalign="left">
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                              <mml:mo>,</mml:mo>
                              <mml:mtext>otherwise</mml:mtext>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                      <mml:mtext>     </mml:mtext>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>8</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGKbazdaWgaaWcbaGaem4AaSgabeaakmaabmaabaGaemyAaKgacaGLOaGaayzkaaGaeyypa0ZaaiqaaeaafaqaaeGabaaabaGaeGimaaJaeiilaWIaeeyAaKMaeeOzayMaeeiiaaccciGae83UdW2aaSbaaSqaaiabdUgaRbqabaGcdaqadaqaaiab=L8a3naaBaaaleaacqWGPbqAaeqaaaGccaGLOaGaayzkaaGaeyiyIKRaeeimaaJaeeiiaaIaeeyyaeMaeeOBa4MaeeizaqMaeeiiaaIaemyAaKMaeyicI4Sae8xYdC3aaWbaaSqabeaacqWGYbGCaaaakeaacqaIXaqmcqGGSaalcqqGVbWBcqqG0baDcqqGObaAcqqGLbqzcqqGYbGCcqqG3bWDcqqGPbqAcqqGZbWCcqqGLbqzaaGaaCzcaiaaxMaadaqadaqaaiabiIda4aGaayjkaiaawMcaaaGaay5Eaaaaaa@62A5@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>The trivial modification to the Forward algorithm consists simply of setting the forward variable <italic>f </italic>equal to zero, for each position <italic>i </italic>and state <italic>k </italic>that is not in agreement with the prior experimental information (Figure <xref ref-type="fig" rid="F3">3</xref>). This is conceptually similar with the training with labelled sequences, where we allow only those paths Π<sub><italic>y </italic></sub>that are in agreement with the labelling <bold>y</bold>, to contribute to the total likelihood. Here, we allow only the paths Π<sub><italic>ω </italic></sub>that are in agreement with the prior information <bold>ω</bold>. Thus, the modified Forward algorithm is:</p>
      </sec>
      <sec>
        <title>Modified Forward algorithm</title>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-7-189-i6" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>:</mml:mo>
                      <mml:msubsup>
                        <mml:mi>f</mml:mi>
                        <mml:mi>B</mml:mi>
                        <mml:mi>ω</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:msubsup>
                        <mml:mi>f</mml:mi>
                        <mml:mi>k</mml:mi>
                        <mml:mi>ω</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:mo>∀</mml:mo>
                      <mml:mi>k</mml:mi>
                      <mml:mo>≠</mml:mo>
                      <mml:mi>B</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>L</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:msubsup>
                        <mml:mi>f</mml:mi>
                        <mml:mi>l</mml:mi>
                        <mml:mi>ω</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>d</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mi>e</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:munder>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mi>f</mml:mi>
                            <mml:mi>k</mml:mi>
                            <mml:mi>ω</mml:mi>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mstyle>
                      <mml:mtext>     </mml:mtext>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>9</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>ω</mml:mi>
                          <mml:mo>|</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mstyle displaystyle="true">
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:munder>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mi>f</mml:mi>
                            <mml:mi>k</mml:mi>
                            <mml:mi>ω</mml:mi>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mi>L</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mi>E</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakqaabeqaaiabdMgaPjabg2da9iabicdaWiabcQda6iabdAgaMnaaDaaaleaacqWGcbGqaeaaiiGacqWFjpWDaaGcdaqadaqaaiabicdaWaGaayjkaiaawMcaaiabg2da9iabigdaXiabcYcaSiabdAgaMnaaDaaaleaacqWGRbWAaeaacqWFjpWDaaGcdaqadaqaaiabicdaWaGaayjkaiaawMcaaiabg2da9iabicdaWiabcYcaSiabgcGiIiabdUgaRjabgcMi5kabdkeacbqaaiabgcGiIiabigdaXiabgsMiJkabdMgaPjabgsMiJkabdYeamjabcQda6iabdAgaMnaaDaaaleaacqWGSbaBaeaacqWFjpWDaaGcdaqadaqaaiabdMgaPbGaayjkaiaawMcaaiabg2da9iabdsgaKnaaBaaaleaacqWGSbaBaeqaaOWaaeWaaeaacqWGPbqAaiaawIcacaGLPaaacqWGLbqzdaWgaaWcbaGaemiBaWgabeaakmaabmaabaGaemiEaG3aaSbaaSqaaiabdMgaPbqabaaakiaawIcacaGLPaaadaaeqbqaaiabdAgaMnaaDaaaleaacqWGRbWAaeaacqWFjpWDaaGcdaqadaqaaiabdMgaPjabgkHiTiabigdaXaGaayjkaiaawMcaaiabdggaHnaaBaaaleaacqWGRbWAcqWGSbaBaeqaaaqaaiabdUgaRbqab0GaeyyeIuoakiaaxMaacaWLjaWaaeWaaeaacqaI5aqoaiaawIcacaGLPaaaaeaacqWGqbaudaqadaqaaGqabiab+Hha4jabcYcaSGGabiab9L8a3jabcYha8jab=H7aXbGaayjkaiaawMcaaiabg2da9maaqafabaGaemOzay2aa0baaSqaaiabdUgaRbqaaiab=L8a3baakmaabmaabaGaemitaWeacaGLOaGaayzkaaGaemyyae2aaSbaaSqaaiabdUgaRjabdweafbqabaaabaGaem4AaSgabeqdcqGHris5aaaaaa@9712@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>We have to note here, that all algorithms presented hereinafter will fail to produce results when the prior information that is provided is inconsistent with the model at hand. For example, in some models we may allow only some states to have non-zero transitions from the begin state. This is the case of beta-barrel outer membrane proteins of which we know that the sequence must start by an intracellular loop [<xref ref-type="bibr" rid="B10">10</xref>]. If we force the model to fix the N-terminal location into extracellular space, the algorithms will produce no valid results. Furthermore, if the prior information consists of various segments, these should also be self-consistent and in accordance with the model. For instance, in transmembrane protein topology prediction, we cannot fix the position of the residue <italic>i </italic>to be intracellular and that of the <italic>i</italic>+<italic>1</italic>, to be extracellular, because this will also violate the model's assumptions.</p>
        <p>The counterpart of the Forward algorithm is the Backward algorithm, which is presented below:</p>
      </sec>
      <sec>
        <title>Backward algorithm</title>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-7-189-i7" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mi>k</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mi>L</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:msub>
                        <mml:mi>b</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>L</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>a</mml:mi>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mi>E</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>&lt;</mml:mo>
                      <mml:mi>L</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:msub>
                        <mml:mi>b</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mstyle displaystyle="true">
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>l</mml:mi>
                        </mml:munder>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>e</mml:mi>
                            <mml:mi>l</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>x</mml:mi>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo>+</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>b</mml:mi>
                            <mml:mi>l</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mtext>     </mml:mtext>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mn>10</mml:mn>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>|</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mstyle displaystyle="true">
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>l</mml:mi>
                        </mml:munder>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mrow>
                              <mml:mi>B</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>e</mml:mi>
                            <mml:mi>l</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>x</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>b</mml:mi>
                            <mml:mi>l</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakqaabeqaaiabgcGiIiabdUgaRjabcYcaSiabdMgaPjabg2da9iabdYeamjabcQda6iabdkgaInaaBaaaleaacqWGRbWAaeqaaOWaaeWaaeaacqWGmbataiaawIcacaGLPaaacqGH9aqpcqWGHbqydaWgaaWcbaGaem4AaSMaemyraueabeaaaOqaaiabgcGiIiabigdaXiabgsMiJkabdMgaPjabgYda8iabdYeamjabcQda6iabdkgaInaaBaaaleaacqWGRbWAaeqaaOWaaeWaaeaacqWGPbqAaiaawIcacaGLPaaacqGH9aqpdaaeqbqaaiabdggaHnaaBaaaleaacqWGRbWAcqWGSbaBaeqaaOGaemyzau2aaSbaaSqaaiabdYgaSbqabaGcdaqadaqaaiabdIha4naaBaaaleaacqWGPbqAcqGHRaWkcqaIXaqmaeqaaaGccaGLOaGaayzkaaGaemOyai2aaSbaaSqaaiabdYgaSbqabaGcdaqadaqaaiabdMgaPjabgUcaRiabigdaXaGaayjkaiaawMcaaiaaxMaacaWLjaWaaeWaaeaacqaIXaqmcqaIWaamaiaawIcacaGLPaaaaSqaaiabdYgaSbqab0GaeyyeIuoaaOqaaiabdcfaqnaabmaabaacbeGae8hEaGNaeiiFaWhcciGae4hUdehacaGLOaGaayzkaaGaeyypa0ZaaabuaeaacqWGHbqydaWgaaWcbaGaemOqaiKaemiBaWgabeaakiabdwgaLnaaBaaaleaacqWGSbaBaeqaaOWaaeWaaeaacqWG4baEdaWgaaWcbaGaeGymaedabeaaaOGaayjkaiaawMcaaiabdkgaInaaBaaaleaacqWGSbaBaeqaaOWaaeWaaeaacqaIXaqmaiaawIcacaGLPaaaaSqaaiabdYgaSbqab0GaeyyeIuoaaaaa@873B@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>The total likelihood computed by the Backward algorithm is exactly the same with the one computed by the Forward algorithm so it will rarely be used, however, the algorithm is essential for the posterior decoding, which we will consider later. Using exactly the same notation, we can write down the modified Backward algorithm:</p>
      </sec>
      <sec>
        <title>Modified Backward algorithm</title>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-7-189-i8" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mi>k</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mi>L</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:msubsup>
                        <mml:mi>b</mml:mi>
                        <mml:mi>k</mml:mi>
                        <mml:mi>ω</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>L</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>a</mml:mi>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mi>E</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>&lt;</mml:mo>
                      <mml:mi>L</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:msubsup>
                        <mml:mi>b</mml:mi>
                        <mml:mi>k</mml:mi>
                        <mml:mi>ω</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mstyle displaystyle="true">
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>l</mml:mi>
                        </mml:munder>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>e</mml:mi>
                            <mml:mi>l</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>x</mml:mi>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo>+</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msubsup>
                            <mml:mi>b</mml:mi>
                            <mml:mi>l</mml:mi>
                            <mml:mi>ω</mml:mi>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>d</mml:mi>
                            <mml:mi>l</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mtext>     </mml:mtext>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mn>11</mml:mn>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>ω</mml:mi>
                          <mml:mo>|</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mstyle displaystyle="true">
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>l</mml:mi>
                        </mml:munder>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mrow>
                              <mml:mi>B</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>e</mml:mi>
                            <mml:mi>l</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>x</mml:mi>
                                <mml:mn>1</mml:mn>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msubsup>
                            <mml:mi>b</mml:mi>
                            <mml:mi>l</mml:mi>
                            <mml:mi>ω</mml:mi>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mn>1</mml:mn>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                      </mml:mstyle>
                      <mml:msub>
                        <mml:mi>d</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>1</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakqaabeqaaiabgcGiIiabdUgaRjabcYcaSiabdMgaPjabg2da9iabdYeamjabcQda6iabdkgaInaaDaaaleaacqWGRbWAaeaaiiGacqWFjpWDaaGcdaqadaqaaiabdYeambGaayjkaiaawMcaaiabg2da9iabdggaHnaaBaaaleaacqWGRbWAcqWGfbqraeqaaaGcbaGaeyiaIiIaeGymaeJaeyizImQaemyAaKMaeyipaWJaemitaWKaeiOoaOJaemOyai2aa0baaSqaaiabdUgaRbqaaiab=L8a3baakmaabmaabaGaemyAaKgacaGLOaGaayzkaaGaeyypa0ZaaabuaeaacqWGHbqydaWgaaWcbaGaem4AaSMaemiBaWgabeaakiabdwgaLnaaBaaaleaacqWGSbaBaeqaaOWaaeWaaeaacqWG4baEdaWgaaWcbaGaemyAaKMaey4kaSIaeGymaedabeaaaOGaayjkaiaawMcaaiabdkgaInaaDaaaleaacqWGSbaBaeaacqWFjpWDaaGcdaqadaqaaiabdMgaPjabgUcaRiabigdaXaGaayjkaiaawMcaaiabdsgaKnaaBaaaleaacqWGSbaBaeqaaOWaaeWaaeaacqWGPbqAcqGHRaWkcqaIXaqmaiaawIcacaGLPaaacaWLjaGaaCzcamaabmaabaGaeGymaeJaeGymaedacaGLOaGaayzkaaaaleaacqWGSbaBaeqaniabggHiLdaakeaacqWGqbaudaqadaqaaGqabiab+Hha4jab+XcaSGGabiab9L8a3jabcYha8jab=H7aXbGaayjkaiaawMcaaiabg2da9maaqafabaGaemyyae2aaSbaaSqaaiabdkeacjabdYgaSbqabaGccqWGLbqzdaWgaaWcbaGaemiBaWgabeaakmaabmaabaGaemiEaG3aaSbaaSqaaiabigdaXaqabaaakiaawIcacaGLPaaacqWGIbGydaqhaaWcbaGaemiBaWgabaGae8xYdChaaOWaaeWaaeaacqaIXaqmaiaawIcacaGLPaaaaSqaaiabdYgaSbqab0GaeyyeIuoakiabdsgaKnaaBaaaleaacqWGSbaBaeqaaOWaaeWaaeaacqaIXaqmaiaawIcacaGLPaaaaaaa@9E17@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>The likelihood computed by each one of the previous algorithms, is the joint likelihood of the sequences and the information given the model, which is always smaller than or equal to the likelihood computed by the standard algorithms:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-7-189-i9" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>ω</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:mi>θ</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mi>π</mml:mi>
                    </mml:munder>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>ω</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>π</mml:mi>
                          <mml:mo>|</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>π</mml:mi>
                        <mml:mo>∈</mml:mo>
                        <mml:msub>
                          <mml:mi>Π</mml:mi>
                          <mml:mi>ω</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                    </mml:munder>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>π</mml:mi>
                          <mml:mo>|</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mo>≤</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mi>x</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:mi>θ</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>12</mml:mn>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGqbaudaqadaqaaGqabiab=Hha4jab=XcaSGGabiab+L8a3jabcYha8HGaciab9H7aXbGaayjkaiaawMcaaiabg2da9maaqafabaGaemiuaa1aaeWaaeaacqWF4baEcqWFSaalcqGFjpWDcqGFSaalcqqFapaCcqGG8baFcqqF4oqCaiaawIcacaGLPaaaaSqaaiab9b8aWbqab0GaeyyeIuoakiabg2da9maaqafabaGaemiuaa1aaeWaaeaacqWF4baEcqWFSaalcqqFapaCcqGG8baFcqqF4oqCaiaawIcacaGLPaaaaSqaaiab9b8aWjabgIGiolabfc6aqnaaBaaameaacqqFjpWDaeqaaaWcbeqdcqGHris5aOGaeyizImQaemiuaa1aaeWaaeaacqWF4baEcqGG8baFcqqF4oqCaiaawIcacaGLPaaacaWLjaGaaCzcamaabmaabaGaeGymaeJaeGOmaidacaGLOaGaayzkaaaaaa@69C8@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>By using the Bayes theorem we can calculate the posterior probability of the information, given the sequences and the model, as follows:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-7-189-i10" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mi>ω</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>θ</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>ω</mml:mi>
                          <mml:mo>|</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>|</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>13</mml:mn>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGqbaudaqadaqaaGGabiab=L8a3jabcYha8Hqabiab+Hha4jabcYcaSGGaciab9H7aXbGaayjkaiaawMcaaiabg2da9maalaaabaGaemiuaa1aaeWaaeaacqGF4baEcqGFSaalcqWFjpWDcqGG8baFcqqF4oqCaiaawIcacaGLPaaaaeaacqWGqbaudaqadaqaaiab+Hha4jabcYha8jab9H7aXbGaayjkaiaawMcaaaaacaWLjaGaaCzcamaabmaabaGaeGymaeJaeG4mamdacaGLOaGaayzkaaaaaa@4DDF@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>The last quantity informs us in to what extend our prior beliefs about the protein's topology have been changed when experimentally derived information emerges. If this probability is large, the information does not change our prior beliefs. However, when this probability is small enough, the experimentally derived information has changed a lot our prior beliefs (those based solely on the model), and thus we expect the prediction accuracy to be better.</p>
      </sec>
    </sec>
    <sec>
      <title>Decoding algorithms</title>
      <p>Here we consider similar modifications to the algorithms used for decoding an HMM. The Viterbi algorithm is a dynamic programming algorithm that, on contrary to the Forward and Backward algorithms, finds the probability of the most probable path of states and not the total probability of all paths. With a backtracking step, the algorithm finally recovers the most probable path. The algorithm is conceptually similar to the Forward algorithm, where the consecutive summations are replaced by maximisations:</p>
      <sec>
        <title>Viterbi algorithm</title>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-7-189-i11" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mi>k</mml:mi>
                      <mml:mo>≠</mml:mo>
                      <mml:mi>B</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>:</mml:mo>
                      <mml:msub>
                        <mml:mi>u</mml:mi>
                        <mml:mi>B</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mi>u</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>L</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:msub>
                        <mml:mi>u</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>e</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>max</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:munder>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>u</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                      <mml:mtext>     </mml:mtext>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mn>14</mml:mn>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:msup>
                            <mml:mi>π</mml:mi>
                            <mml:mrow>
                              <mml:mi>max</mml:mi>
                              <mml:mo>⁡</mml:mo>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mo>|</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>max</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:munder>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>u</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mi>L</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mi>E</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakqaabeqaaiabgcGiIiabdUgaRjabgcMi5kabdkeacjabcYcaSiabdMgaPjabg2da9iabicdaWiabcQda6iabdwha1naaBaaaleaacqWGcbGqaeqaaOWaaeWaaeaacqaIWaamaiaawIcacaGLPaaacqGH9aqpcqaIXaqmcqGGSaalcqWG1bqDdaWgaaWcbaGaem4AaSgabeaakmaabmaabaGaeGimaadacaGLOaGaayzkaaGaeyypa0JaeGimaadabaGaeyiaIiIaeGymaeJaeyizImQaemyAaKMaeyizImQaemitaWKaeiOoaOJaemyDau3aaSbaaSqaaiabdYgaSbqabaGcdaqadaqaaiabdMgaPbGaayjkaiaawMcaaiabg2da9iabdwgaLnaaBaaaleaacqWGSbaBaeqaaOWaaeWaaeaacqWG4baEdaWgaaWcbaGaemyAaKgabeaaaOGaayjkaiaawMcaamaaxababaGagiyBa0MaeiyyaeMaeiiEaGhaleaacqWGRbWAaeqaaOWaaiWaaeaacqWG1bqDdaWgaaWcbaGaem4AaSgabeaakmaabmaabaGaemyAaKMaeyOeI0IaeGymaedacaGLOaGaayzkaaGaemyyae2aaSbaaSqaaiabdUgaRjabdYgaSbqabaaakiaawUhacaGL9baacaWLjaGaaCzcamaabmaabaGaeGymaeJaeGinaqdacaGLOaGaayzkaaaabaGaemiuaa1aaeWaaeaaieqacqWF4baEcqGGSaaliiGacqGFapaCdaahaaWcbeqaaiGbc2gaTjabcggaHjabcIha4baakiabcYha8jab+H7aXbGaayjkaiaawMcaaiabg2da9maaxababaGagiyBa0MaeiyyaeMaeiiEaGhaleaacqWGRbWAaeqaaOWaaiWaaeaacqWG1bqDdaWgaaWcbaGaem4AaSgabeaakmaabmaabaGaemitaWeacaGLOaGaayzkaaGaemyyae2aaSbaaSqaaiabdUgaRjabdweafbqabaaakiaawUhacaGL9baaaaaa@9726@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>Here, <italic>π</italic><sup><italic>max </italic></sup>is the most probable path of states and <italic>P</italic>(<bold>x</bold>, <italic>π</italic><sup><italic>max</italic></sup>|<italic>θ</italic>) its probability, with <italic>P</italic>(<bold>x</bold>,<italic>π</italic><sup>max</sup>|<italic>θ</italic>)≤<italic>P</italic>(<bold>x</bold>|<italic>θ</italic>). In the modification to the Viterbi algorithm, sketched below, we use exactly the same constrains in order to force the algorithm to consider only the paths compatible with the information <bold>ω</bold>. In this case, the joint probability of the best path and the information, is denoted <italic>P</italic>(<bold>x</bold>, <italic>π</italic><sup>ω</sup>|<italic>θ</italic>).</p>
      </sec>
      <sec>
        <title>Modified Viterbi algorithm</title>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-7-189-i12" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mi>k</mml:mi>
                      <mml:mo>≠</mml:mo>
                      <mml:mi>B</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>:</mml:mo>
                      <mml:msubsup>
                        <mml:mi>u</mml:mi>
                        <mml:mi>B</mml:mi>
                        <mml:mi>ω</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:msubsup>
                        <mml:mi>u</mml:mi>
                        <mml:mi>k</mml:mi>
                        <mml:mi>ω</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>L</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:msubsup>
                        <mml:mi>u</mml:mi>
                        <mml:mi>l</mml:mi>
                        <mml:mi>ω</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>d</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mi>e</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>max</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:munder>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mi>u</mml:mi>
                            <mml:mi>k</mml:mi>
                            <mml:mi>ω</mml:mi>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                      <mml:mtext>     </mml:mtext>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mn>15</mml:mn>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>ω</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:msup>
                            <mml:mi>π</mml:mi>
                            <mml:mi>ω</mml:mi>
                          </mml:msup>
                          <mml:mo>|</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>max</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:munder>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mi>u</mml:mi>
                            <mml:mi>k</mml:mi>
                            <mml:mi>ω</mml:mi>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mi>L</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mi>E</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakqaabeqaaiabgcGiIiabdUgaRjabgcMi5kabdkeacjabcYcaSiabdMgaPjabg2da9iabicdaWiabcQda6iabdwha1naaDaaaleaacqWGcbGqaeaaiiGacqWFjpWDaaGcdaqadaqaaiabicdaWaGaayjkaiaawMcaaiabg2da9iabigdaXiabcYcaSiabdwha1naaDaaaleaacqWGRbWAaeaacqWFjpWDaaGcdaqadaqaaiabicdaWaGaayjkaiaawMcaaiabg2da9iabicdaWaqaaiabgcGiIiabigdaXiabgsMiJkabdMgaPjabgsMiJkabdYeamjabcQda6iabdwha1naaDaaaleaacqWGSbaBaeaacqWFjpWDaaGcdaqadaqaaiabdMgaPbGaayjkaiaawMcaaiabg2da9iabdsgaKnaaBaaaleaacqWGSbaBaeqaaOWaaeWaaeaacqWGPbqAaiaawIcacaGLPaaacqWGLbqzdaWgaaWcbaGaemiBaWgabeaakmaabmaabaGaemiEaG3aaSbaaSqaaiabdMgaPbqabaaakiaawIcacaGLPaaadaWfqaqaaiGbc2gaTjabcggaHjabcIha4bWcbaGaem4AaSgabeaakmaacmaabaGaemyDau3aa0baaSqaaiabdUgaRbqaaiab=L8a3baakmaabmaabaGaemyAaKMaeyOeI0IaeGymaedacaGLOaGaayzkaaGaemyyae2aaSbaaSqaaiabdUgaRjabdYgaSbqabaaakiaawUhacaGL9baacaWLjaGaaCzcamaabmaabaGaeGymaeJaeGynaudacaGLOaGaayzkaaaabaGaemiuaa1aaeWaaeaaieqacqGF4baEcqGGSaaliiqacqqFjpWDcqGGSaalcqWFapaCdaahaaWcbeqaaiab=L8a3baakiabcYha8jab=H7aXbGaayjkaiaawMcaaiabg2da9maaxababaGagiyBa0MaeiyyaeMaeiiEaGhaleaacqWGRbWAaeqaaOWaaiWaaeaacqWG1bqDdaqhaaWcbaGaem4AaSgabaGae8xYdChaaOWaaeWaaeaacqWGmbataiaawIcacaGLPaaacqWGHbqydaWgaaWcbaGaem4AaSMaemyraueabeaaaOGaay5Eaiaaw2haaaaaaa@A635@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>The 1-best decoding [<xref ref-type="bibr" rid="B33">33</xref>], is a modification of the N-best decoding method, proposed earlier for speech recognition [<xref ref-type="bibr" rid="B52">52</xref>]. The algorithm is a heuristic that tries to find the most probable path of labels <bold>y</bold><sup>max </sup>of a sequence instead of the most probable path of states. For each position <italic>i </italic>in the sequence, keeps track of all the possible active hypotheses <italic>h</italic><sub><italic>i-1 </italic></sub>that consist of all the possible sequence of labels up to that point. Afterwards, for each state <italic>l</italic>, propagates these hypotheses, appending each one of the possible labels <italic>y</italic><sub><italic>i</italic></sub>, and picks up the best, until the end of the sequence. In contrast to the Viterbi algorithm, 1-best does not need a Traceback procedure:</p>
      </sec>
      <sec>
        <title>1-best algorithm</title>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-7-189-i13" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>:</mml:mo>
                      <mml:msub>
                        <mml:mi>γ</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>h</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>a</mml:mi>
                        <mml:mrow>
                          <mml:mi>B</mml:mi>
                          <mml:mi>l</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>e</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>&lt;</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>L</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:msub>
                        <mml:mi>γ</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>h</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>e</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:munder>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>γ</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>h</mml:mi>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo>−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mstyle>
                      <mml:mtext>     </mml:mtext>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mn>16</mml:mn>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:msup>
                            <mml:mi>y</mml:mi>
                            <mml:mrow>
                              <mml:mi>max</mml:mi>
                              <mml:mo>⁡</mml:mo>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mo>|</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mstyle displaystyle="true">
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:munder>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>γ</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>h</mml:mi>
                                <mml:mi>L</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mi>E</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakqaabeqaaiabdMgaPjabg2da9iabigdaXiabcQda6GGaciab=n7aNnaaBaaaleaacqWGSbaBaeqaaOWaaeWaaeaacqWGObaAdaWgaaWcbaGaeGymaedabeaaaOGaayjkaiaawMcaaiabg2da9iabdggaHnaaBaaaleaacqWGcbGqcqWGSbaBaeqaaOGaemyzau2aaSbaaSqaaiabdYgaSbqabaGcdaqadaqaaiabdIha4naaBaaaleaacqaIXaqmaeqaaaGccaGLOaGaayzkaaaabaGaeyiaIiIaeGymaeJaeyipaWJaemyAaKMaeyizImQaemitaWKaeiOoaOJae83SdC2aaSbaaSqaaiabdYgaSbqabaGcdaqadaqaaiabdIgaOnaaBaaaleaacqWGPbqAaeqaaOGaemyEaK3aaSbaaSqaaiabdMgaPbqabaaakiaawIcacaGLPaaacqGH9aqpcqWGLbqzdaWgaaWcbaGaemiBaWgabeaakmaabmaabaGaemiEaG3aaSbaaSqaaiabdMgaPbqabaaakiaawIcacaGLPaaadaaeqbqaaiab=n7aNnaaBaaaleaacqWGRbWAaeqaaOWaaeWaaeaacqWGObaAdaWgaaWcbaGaemyAaKMaeyOeI0IaeGymaedabeaaaOGaayjkaiaawMcaaiabdggaHnaaBaaaleaacqWGRbWAcqWGSbaBaeqaaaqaaiabdUgaRbqab0GaeyyeIuoakiaaxMaacaWLjaWaaeWaaeaacqaIXaqmcqaI2aGnaiaawIcacaGLPaaaaeaacqWGqbaudaqadaqaaGqabiab+Hha4jabcYcaSiab+Lha5naaCaaaleqabaGagiyBa0MaeiyyaeMaeiiEaGhaaOGaeiiFaWNae8hUdehacaGLOaGaayzkaaGaeyypa0ZaaabuaeaacqWFZoWzdaWgaaWcbaGaem4AaSgabeaakmaabmaabaGaemiAaG2aaSbaaSqaaiabdYeambqabaaakiaawIcacaGLPaaacqWGHbqydaWgaaWcbaGaem4AaSMaemyraueabeaaaeaacqWGRbWAaeqaniabggHiLdaaaaa@9361@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>Although this algorithm is a heuristic and no guarantee exists for finding the most probable labelling, the probability of the best reported labelling is always larger than, or equal to, the probability of the best path, and always smaller than, or equal to, the total probability of the sequence, since a lot of allowed paths are contributing to this, thus: <italic>P</italic>(<bold>x</bold>,<italic>π</italic><sup>max </sup>| <italic>θ</italic>)≤<italic>P</italic>(<bold>x</bold>,<bold>y</bold><sup>max </sup>| <italic>θ</italic>)≤<italic>P</italic>(<bold>x </bold>| <italic>θ</italic>). Obviously, we just have to set once again the intermediate variable <italic>γ </italic>equal to zero for the states <italic>k </italic>and residues <italic>i </italic>that are not in agreement with the prior information <bold>ω. </bold>In Viterbi and 1-best decoding, similar measures with that of Equation (13) can be obtained.</p>
      </sec>
      <sec>
        <title>Modified 1-best algorithm</title>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-7-189-i14" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>:</mml:mo>
                      <mml:msubsup>
                        <mml:mi>γ</mml:mi>
                        <mml:mi>l</mml:mi>
                        <mml:mi>ω</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>h</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>a</mml:mi>
                        <mml:mrow>
                          <mml:mi>B</mml:mi>
                          <mml:mi>l</mml:mi>
                        </mml:mrow>
                      </mml:msub>
                      <mml:msub>
                        <mml:mi>e</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>L</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:msubsup>
                        <mml:mi>γ</mml:mi>
                        <mml:mi>l</mml:mi>
                        <mml:mi>ω</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>h</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>d</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mi>e</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>x</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mstyle displaystyle="true">
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:munder>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mi>γ</mml:mi>
                            <mml:mi>k</mml:mi>
                            <mml:mi>ω</mml:mi>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>h</mml:mi>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo>−</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mstyle>
                      <mml:mtext>     </mml:mtext>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mn>17</mml:mn>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:msup>
                            <mml:mi>y</mml:mi>
                            <mml:mi>ω</mml:mi>
                          </mml:msup>
                          <mml:mo>|</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mstyle displaystyle="true">
                        <mml:munder>
                          <mml:mo>∑</mml:mo>
                          <mml:mi>k</mml:mi>
                        </mml:munder>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mi>γ</mml:mi>
                            <mml:mi>k</mml:mi>
                            <mml:mi>ω</mml:mi>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>h</mml:mi>
                                <mml:mi>L</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:msub>
                            <mml:mi>a</mml:mi>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mi>E</mml:mi>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mstyle>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakqaabeqaaiabdMgaPjabg2da9iabigdaXiabcQda6GGaciab=n7aNnaaDaaaleaacqWGSbaBaeaacqWFjpWDaaGcdaqadaqaaiabdIgaOnaaBaaaleaacqaIXaqmaeqaaaGccaGLOaGaayzkaaGaeyypa0Jaemyyae2aaSbaaSqaaiabdkeacjabdYgaSbqabaGccqWGLbqzdaWgaaWcbaGaemiBaWgabeaakmaabmaabaGaemiEaG3aaSbaaSqaaiabigdaXaqabaaakiaawIcacaGLPaaaaeaacqGHaiIicqaIXaqmcqGHKjYOcqWGPbqAcqGHKjYOcqWGmbatcqGG6aGocqWFZoWzdaqhaaWcbaGaemiBaWgabaGae8xYdChaaOWaaeWaaeaacqWGObaAdaWgaaWcbaGaemyAaKgabeaakiabdMha5naaBaaaleaacqWGPbqAaeqaaaGccaGLOaGaayzkaaGaeyypa0Jaemizaq2aaSbaaSqaaiabdYgaSbqabaGcdaqadaqaaiabdMgaPbGaayjkaiaawMcaaiabdwgaLnaaBaaaleaacqWGSbaBaeqaaOWaaeWaaeaacqWG4baEdaWgaaWcbaGaemyAaKgabeaaaOGaayjkaiaawMcaamaaqafabaGae83SdC2aa0baaSqaaiabdUgaRbqaaiab=L8a3baakmaabmaabaGaemiAaG2aaSbaaSqaaiabdMgaPjabgkHiTiabigdaXaqabaaakiaawIcacaGLPaaacqWGHbqydaWgaaWcbaGaem4AaSMaemiBaWgabeaaaeaacqWGRbWAaeqaniabggHiLdGccaWLjaGaaCzcamaabmaabaGaeGymaeJaeG4naCdacaGLOaGaayzkaaaabaGaemiuaa1aaeWaaeaaieqacqGF4baEcqGGSaalcqGF5bqEdaahaaWcbeqaaiab=L8a3baakiabcYha8jab=H7aXbGaayjkaiaawMcaaiabg2da9maaqafabaGae83SdC2aa0baaSqaaiabdUgaRbqaaiab=L8a3baakmaabmaabaGaemiAaG2aaSbaaSqaaiabdYeambqabaaakiaawIcacaGLPaaacqWGHbqydaWgaaWcbaGaem4AaSMaemyraueabeaaaeaacqWGRbWAaeqaniabggHiLdaaaaa@9EA6@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
      </sec>
      <sec>
        <title>Posterior decoding</title>
        <p>The posterior decoding method is based on calculating the "<italic>a-posteriori</italic>" probability of a residue <italic>x</italic><sub><italic>i </italic></sub>to be emitted by a state <italic>k</italic>, having observed the whole sequence <bold>x</bold>. This probability is calculated using the forward and backward variables <italic>f</italic>, <italic>b</italic>:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-7-189-i15" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>π</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mi>k</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>θ</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>f</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mi>b</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>18</mml:mn>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGqbaudaqadaqaaGGaciab=b8aWnaaBaaaleaacqWGPbqAaeqaaOGaeyypa0Jaem4AaSMaeiiFaWhcbeGae4hEaGNaeiilaWIae8hUdehacaGLOaGaayzkaaGaeyypa0ZaaSaaaeaacqWGMbGzdaWgaaWcbaGaem4AaSgabeaakmaabmaabaGaemyAaKgacaGLOaGaayzkaaGaemOyai2aaSbaaSqaaiabdUgaRbqabaGcdaqadaqaaiabdMgaPbGaayjkaiaawMcaaaqaaiabdcfaqnaabmaabaGae4hEaGNaeiilaWIae8hUdehacaGLOaGaayzkaaaaaiaaxMaacaWLjaWaaeWaaeaacqaIXaqmcqaI4aaoaiaawIcacaGLPaaaaaa@52C3@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>In cases of states sharing the same labelling, we usually sum for each position <italic>i </italic>along the sequence, the posterior probabilities of the states with the same labelling <italic>c </italic>[<xref ref-type="bibr" rid="B2">2</xref>], calculating thus the quantity called Posterior Label Probability (PLP) in [<xref ref-type="bibr" rid="B36">36</xref>]:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-7-189-i16" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>g</mml:mi>
                    <mml:mi>c</mml:mi>
                  </mml:msub>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mi>c</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>θ</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mi>k</mml:mi>
                    </mml:munder>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>π</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:mo>=</mml:mo>
                          <mml:mi>k</mml:mi>
                          <mml:mo>|</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mi>λ</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>c</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>19</mml:mn>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGNbWzdaWgaaWcbaGaem4yamgabeaakmaabmaabaGaemyAaKgacaGLOaGaayzkaaGaeyypa0Jaemiuaa1aaeWaaeaacqWG5bqEdaWgaaWcbaGaemyAaKgabeaakiabg2da9iabdogaJjabcYha8Hqabiab=Hha4jabcYcaSGGaciab+H7aXbGaayjkaiaawMcaaiabg2da9maaqafabaGaemiuaa1aaeWaaeaacqGFapaCdaWgaaWcbaGaemyAaKgabeaakiabg2da9iabdUgaRjabcYha8jab=Hha4jabcYcaSiab+H7aXbGaayjkaiaawMcaaiab+T7aSnaaBaaaleaacqWGRbWAaeqaaOWaaeWaaeaacqWGJbWyaiaawIcacaGLPaaaaSqaaiabdUgaRbqab0GaeyyeIuoakiaaxMaacaWLjaWaaeWaaeaacqaIXaqmcqaI5aqoaiaawIcacaGLPaaaaaa@5E6E@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>A naïve approach would be to consider as a path, the sequence of labels that maximises this probability for each position along the sequence. Such an approach for the posterior decoding is capable of yielding paths inconsistent with the model, for instance, it could produce a path according to which an intracellular loop (I) is followed by a segment of residues predicted to be extracellular (O). However, when these posterior probabilities are filtered properly, in many situations have been proved to yield results with better prediction accuracy [<xref ref-type="bibr" rid="B34">34</xref>,<xref ref-type="bibr" rid="B53">53</xref>]. The Dynamic programming solution to the problem of detecting the optimal location and length of <italic>n </italic>transmembrane segments in a sequence of <italic>m </italic>residues, is to divide the problem in <italic>n </italic>smaller problems, thus dealing with each transmembrane segment separately [<xref ref-type="bibr" rid="B37">37</xref>]. If we denote by <italic>s</italic><sup><italic>il </italic></sup>the sum of the posterior label probabilities of transmembrane segments, for a segment of length <italic>l </italic>at position <italic>i </italic>of a sequence, then the overall score <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-7-189-i17" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGtbWudaqhaaWcbaGaemOAaOgabaGaemyAaKgaaaaa@30C0@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>i</italic>: 1, 2,...<italic>n</italic>; <italic>j</italic>:1, 2,...,<italic>m</italic>), will be calculated by a recursive relation:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-7-189-i18" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>S</mml:mi>
                    <mml:mi>j</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:msubsup>
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi>max</mml:mi>
                      <mml:mo>⁡</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>l</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>l</mml:mi>
                        <mml:mrow>
                          <mml:mi>min</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                      </mml:msub>
                      <mml:mo>→</mml:mo>
                      <mml:msub>
                        <mml:mi>l</mml:mi>
                        <mml:mrow>
                          <mml:mi>max</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mrow>
                    <mml:mo>{</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>s</mml:mi>
                        <mml:mi>j</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>l</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mo>+</mml:mo>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>max</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi>k</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                          <mml:mo>+</mml:mo>
                          <mml:mi>l</mml:mi>
                          <mml:mo>+</mml:mo>
                          <mml:mi>A</mml:mi>
                          <mml:mo>→</mml:mo>
                          <mml:mi>n</mml:mi>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mi>S</mml:mi>
                            <mml:mrow>
                              <mml:mi>j</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mi>k</mml:mi>
                          </mml:msubsup>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mo>}</mml:mo>
                  </mml:mrow>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>20</mml:mn>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGtbWudaqhaaWcbaGaemOAaOgabaGaemyAaKgaaOGaeyypa0ZaaCbeaeaacyGGTbqBcqGGHbqycqGG4baEaSqaaiabdYgaSjabg2da9iabdYgaSnaaBaaameaacyGGTbqBcqGGPbqAcqGGUbGBaeqaaSGaeyOKH4QaemiBaW2aaSbaaWqaaiGbc2gaTjabcggaHjabcIha4bqabaaaleqaaOWaaiWaaeaacqWGZbWCdaqhaaWcbaGaemOAaOgabaGaemyAaKMaemiBaWgaaOGaey4kaSYaaCbeaeaacyGGTbqBcqGGHbqycqGG4baEaSqaaiabdUgaRjabg2da9iabigdaXiabgUcaRiabdYgaSjabgUcaRiabdgeabjabgkziUkabd6gaUbqabaGcdaGadaqaaiabdofatnaaDaaaleaacqWGQbGAcqGHsislcqaIXaqmaeaacqWGRbWAaaaakiaawUhacaGL9baaaiaawUhacaGL9baacaWLjaGaaCzcamaabmaabaGaeGOmaiJaeGimaadacaGLOaGaayzkaaaaaa@6AF6@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>where <italic>j </italic>is the total number of transmembrane segments, <italic>l</italic><sub><italic>min </italic></sub>and <italic>l</italic><sub><italic>max </italic></sub>the minimum and maximum allowed lengths for the transmembrane segments respectively, and <italic>A </italic>the minimum allowed length of a turn.</p>
        <p>With the use of the modified Forward and Backward algorithms described above, we can similarly calculate the posterior probability of a residue <italic>i </italic>to be emitted by a state <italic>k</italic>, given the sequence <bold>x </bold>and the information <bold>ω</bold>, as follows:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-7-189-i19" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>π</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:mi>k</mml:mi>
                      <mml:mo>|</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>ω</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>θ</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>f</mml:mi>
                        <mml:mi>k</mml:mi>
                        <mml:mi>ω</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:msubsup>
                        <mml:mi>b</mml:mi>
                        <mml:mi>k</mml:mi>
                        <mml:mi>ω</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>ω</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mfrac>
                  <mml:mo>,</mml:mo>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>21</mml:mn>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGqbaudaqadaqaaGGaciab=b8aWnaaBaaaleaacqWGPbqAaeqaaOGaeyypa0Jaem4AaSMaeiiFaWhcbeGae4hEaGNaeiilaWccceGae0xYdCNaeiilaWIae8hUdehacaGLOaGaayzkaaGaeyypa0ZaaSaaaeaacqWGMbGzdaqhaaWcbaGaem4AaSgabaGae8xYdChaaOWaaeWaaeaacqWGPbqAaiaawIcacaGLPaaacqWGIbGydaqhaaWcbaGaem4AaSgabaGae8xYdChaaOWaaeWaaeaacqWGPbqAaiaawIcacaGLPaaaaeaacqWGqbaudaqadaqaaiab+Hha4jabcYcaSiab9L8a3jabcYcaSiab=H7aXbGaayjkaiaawMcaaaaacqGGSaalcaWLjaGaaCzcamaabmaabaGaeGOmaiJaeGymaedacaGLOaGaayzkaaaaaa@5C80@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>And finally, we can calculate the PLP for the label <italic>c </italic>at position <italic>i </italic>given the information:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-7-189-i20" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>g</mml:mi>
                    <mml:mrow>
                      <mml:msup>
                        <mml:mi>c</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msup>
                    </mml:mrow>
                    <mml:mi>ω</mml:mi>
                  </mml:msubsup>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mi>i</mml:mi>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>y</mml:mi>
                        <mml:mi>i</mml:mi>
                      </mml:msub>
                      <mml:mo>=</mml:mo>
                      <mml:msup>
                        <mml:mi>c</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msup>
                      <mml:mo>|</mml:mo>
                      <mml:mi>x</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>ω</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>θ</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mi>k</mml:mi>
                    </mml:munder>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>π</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:mo>=</mml:mo>
                          <mml:mi>k</mml:mi>
                          <mml:mo>|</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>ω</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:msub>
                        <mml:mi>λ</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msup>
                            <mml:mi>c</mml:mi>
                            <mml:mi>l</mml:mi>
                          </mml:msup>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>22</mml:mn>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGNbWzdaqhaaWcbaGaem4yam2aaWbaaWqabeaacqWGSbaBaaaaleaaiiGacqWFjpWDaaGcdaqadaqaaiabdMgaPbGaayjkaiaawMcaaiabg2da9iabdcfaqnaabmaabaGaemyEaK3aaSbaaSqaaiabdMgaPbqabaGccqGH9aqpcqWGJbWydaahaaWcbeqaaiabdYgaSbaakiabcYha8Hqabiab+Hha4jabcYcaSGGabiab9L8a3jabcYcaSiab=H7aXbGaayjkaiaawMcaaiabg2da9maaqafabaGaemiuaa1aaeWaaeaacqWFapaCdaWgaaWcbaGaemyAaKgabeaakiabg2da9iabdUgaRjabcYha8jab+Hha4jabcYcaSiab9L8a3jabcYcaSiab=H7aXbGaayjkaiaawMcaaiab=T7aSnaaBaaaleaacqWGRbWAaeqaaOWaaeWaaeaacqWGJbWydaahaaWcbeqaaiabdYgaSbaaaOGaayjkaiaawMcaaaWcbaGaem4AaSgabeqdcqGHris5aOGaaCzcaiaaxMaadaqadaqaaiabikdaYiabikdaYaGaayjkaiaawMcaaaaa@6A4E@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>Even though the PLPs obtained this way are consistent with the prior knowledge, the dynamic programming algorithm described in Equation (20), <italic>is not guaranteed </italic>to yield a consistent result, and thus more refined solutions should be pursued.</p>
      </sec>
      <sec>
        <title>Posterior-Viterbi decoding</title>
        <p>Recently, Fariselli and co-workers have provided a decoding algorithm that combines elements of the Viterbi and the posterior decoding [<xref ref-type="bibr" rid="B35">35</xref>]. The algorithm finds the path <italic>π</italic><sup><italic>PV</italic></sup>, such as</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-7-189-i21" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:msup>
                    <mml:mi>π</mml:mi>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mi>V</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi>arg</mml:mi>
                      <mml:mo>⁡</mml:mo>
                      <mml:mi>max</mml:mi>
                      <mml:mo>⁡</mml:mo>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>π</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:msub>
                        <mml:mi>Π</mml:mi>
                        <mml:mi>p</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>L</mml:mi>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>π</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:mo>|</mml:mo>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>23</mml:mn>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFapaCdaahaaWcbeqaaiabdcfaqjabdAfawbaakiabg2da9maaxababaGagiyyaeMaeiOCaiNaei4zaCMagiyBa0MaeiyyaeMaeiiEaGhaleaacqWFapaCcqGHiiIZcqqHGoaudaWgaaadbaGaemiCaahabeaaaSqabaGcdaqeWbqaaiabdcfaqnaabmaabaGae8hWda3aaSbaaSqaaiabdMgaPbqabaGccqGG8baFieqacqGF4baEaiaawIcacaGLPaaaaSqaaiabdMgaPjabg2da9iabigdaXaqaaiabdYeambqdcqGHpis1aOGaaCzcaiaaxMaadaqadaqaaiabikdaYiabiodaZaGaayjkaiaawMcaaaaa@5536@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>where Π<sub><italic>p </italic></sub>is the allowed paths through the model and <italic>P</italic>(<italic>π</italic><sub><italic>i </italic></sub>= <italic>k</italic>|<bold>x</bold>) is the posterior probability for the state <italic>k </italic>at position <italic>i</italic>. To define the allowed paths, we need a delta function, which takes value 1 if the transition <italic>α</italic><sub><italic>kl </italic></sub>is an allowed one and 0 otherwise. Thus:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-7-189-i22" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:mi>δ</mml:mi>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>l</mml:mi>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                  <mml:mo>=</mml:mo>
                  <mml:mrow>
                    <mml:mo>{</mml:mo>
                    <mml:mrow>
                      <mml:mtable>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:mrow>
                              <mml:mn>1</mml:mn>
                              <mml:mo>,</mml:mo>
                              <mml:mtext>if </mml:mtext>
                              <mml:msub>
                                <mml:mi>a</mml:mi>
                                <mml:mrow>
                                  <mml:mi>k</mml:mi>
                                  <mml:mi>l</mml:mi>
                                </mml:mrow>
                              </mml:msub>
                              <mml:mo>&gt;</mml:mo>
                              <mml:mn>0</mml:mn>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                        <mml:mtr>
                          <mml:mtd>
                            <mml:mrow>
                              <mml:mn>0</mml:mn>
                              <mml:mo>,</mml:mo>
                              <mml:mtext>otherwise</mml:mtext>
                            </mml:mrow>
                          </mml:mtd>
                        </mml:mtr>
                      </mml:mtable>
                      <mml:mtext>     </mml:mtext>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mn>24</mml:mn>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWF0oazdaqadaqaaiabdUgaRjabcYcaSiabdYgaSbGaayjkaiaawMcaaiabg2da9maaceaabaqbaeqabiqaaaqaaiabigdaXiabcYcaSiabbMgaPjabbAgaMjabbccaGiabdggaHnaaBaaaleaacqWGRbWAcqWGSbaBaeqaaOGaeyOpa4JaeGimaadabaGaeGimaaJaeiilaWIaee4Ba8MaeeiDaqNaeeiAaGMaeeyzauMaeeOCaiNaee4DaCNaeeyAaKMaee4CamNaeeyzaugaaiaaxMaacaWLjaWaaeWaaeaacqaIYaGmcqaI0aanaiaawIcacaGLPaaaaiaawUhaaaaa@541E@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>Finally, the optimal allowed-posterior path <italic>π</italic><sup><italic>PV</italic></sup>, is denoted by:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-7-189-i23" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:msup>
                    <mml:mi>π</mml:mi>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mi>V</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi>arg</mml:mi>
                      <mml:mo>⁡</mml:mo>
                      <mml:mi>max</mml:mi>
                      <mml:mo>⁡</mml:mo>
                    </mml:mrow>
                    <mml:mi>π</mml:mi>
                  </mml:munder>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∏</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>L</mml:mi>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mi>δ</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>π</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:mo>,</mml:mo>
                          <mml:msub>
                            <mml:mi>π</mml:mi>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>+</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>π</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:mo>|</mml:mo>
                          <mml:mi>x</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>25</mml:mn>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFapaCdaahaaWcbeqaaiabdcfaqjabdAfawbaakiabg2da9maaxababaGagiyyaeMaeiOCaiNaei4zaCMagiyBa0MaeiyyaeMaeiiEaGhaleaacqWFapaCaeqaaOWaaebCaeaacqWF0oazdaqadaqaaiab=b8aWnaaBaaaleaacqWGPbqAaeqaaOGaeiilaWIae8hWda3aaSbaaSqaaiabdMgaPjabgUcaRiabigdaXaqabaaakiaawIcacaGLPaaacqWGqbaudaqadaqaaiab=b8aWnaaBaaaleaacqWGPbqAaeqaaOGaeiiFaWhcbeGae4hEaGhacaGLOaGaayzkaaaaleaacqWGPbqAcqGH9aqpcqaIXaqmaeaacqWGmbata0Gaey4dIunakiaaxMaacaWLjaWaaeWaaeaacqaIYaGmcqaI1aqnaiaawIcacaGLPaaaaaa@5D04@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>The Posterior-Viterbi decoding algorithm performs essentially a Viterbi-like decoding, using the Posterior probabilities instead of the emissions, and the allowed paths given by the above mentioned delta function instead of the transitions.</p>
      </sec>
      <sec>
        <title>Posterior-Viterbi algorithm</title>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1471-2105-7-189-i24" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mi>k</mml:mi>
                      <mml:mo>≠</mml:mo>
                      <mml:mi>B</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>:</mml:mo>
                      <mml:msub>
                        <mml:mi>u</mml:mi>
                        <mml:mi>B</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mi>u</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>L</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:msub>
                        <mml:mi>u</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>π</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:mo>=</mml:mo>
                          <mml:mi>l</mml:mi>
                          <mml:mo>|</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>max</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:munder>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>u</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mi>δ</mml:mi>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                      <mml:mtext>     </mml:mtext>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mn>26</mml:mn>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:msup>
                            <mml:mi>π</mml:mi>
                            <mml:mrow>
                              <mml:mi>P</mml:mi>
                              <mml:mi>V</mml:mi>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mo>|</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>max</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:munder>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>u</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mi>L</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mi>δ</mml:mi>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>E</mml:mi>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakqaabeqaaiabgcGiIiabdUgaRjabgcMi5kabdkeacjabcYcaSiabdMgaPjabg2da9iabicdaWiabcQda6iabdwha1naaBaaaleaacqWGcbGqaeqaaOWaaeWaaeaacqaIWaamaiaawIcacaGLPaaacqGH9aqpcqaIXaqmcqGGSaalcqWG1bqDdaWgaaWcbaGaem4AaSgabeaakmaabmaabaGaeGimaadacaGLOaGaayzkaaGaeyypa0JaeGimaadabaGaeyiaIiIaeGymaeJaeyizImQaemyAaKMaeyizImQaemitaWKaeiOoaOJaemyDau3aaSbaaSqaaiabdYgaSbqabaGcdaqadaqaaiabdMgaPbGaayjkaiaawMcaaiabg2da9iabdcfaqnaabmaabaacciGae8hWda3aaSbaaSqaaiabdMgaPbqabaGccqGH9aqpcqWGSbaBcqGG8baFieqacqGF4baEcqGGSaalcqWF4oqCaiaawIcacaGLPaaadaWfqaqaaiGbc2gaTjabcggaHjabcIha4bWcbaGaem4AaSgabeaakmaacmaabaGaemyDau3aaSbaaSqaaiabdUgaRbqabaGcdaqadaqaaiabdMgaPjabgkHiTiabigdaXaGaayjkaiaawMcaaiab=r7aKnaabmaabaGaem4AaSMaeiilaWIaemiBaWgacaGLOaGaayzkaaaacaGL7bGaayzFaaGaaCzcaiaaxMaadaqadaqaaiabikdaYiabiAda2aGaayjkaiaawMcaaaqaaiabdcfaqnaabmaabaGae4hEaGNaeiilaWIae8hWda3aaWbaaSqabeaacqWGqbaucqWGwbGvaaGccqGG8baFcqWF4oqCaiaawIcacaGLPaaacqGH9aqpdaWfqaqaaiGbc2gaTjabcggaHjabcIha4bWcbaGaem4AaSgabeaakmaacmaabaGaemyDau3aaSbaaSqaaiabdUgaRbqabaGcdaqadaqaaiabdYeambGaayjkaiaawMcaaiab=r7aKnaabmaabaGaem4AaSMaeiilaWIaemyraueacaGLOaGaayzkaaaacaGL7bGaayzFaaaaaaa@A0DF@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>Similar to the Viterbi algorithm, the modified Posterior-Viterbi is as follows:</p>
      </sec>
      <sec>
        <title>Modified Posterior-Viterbi algorithm</title>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" name="1471-2105-7-189-i25" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mi>k</mml:mi>
                      <mml:mo>≠</mml:mo>
                      <mml:mi>B</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>:</mml:mo>
                      <mml:msubsup>
                        <mml:mi>u</mml:mi>
                        <mml:mi>B</mml:mi>
                        <mml:mi>ω</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:msubsup>
                        <mml:mi>u</mml:mi>
                        <mml:mi>k</mml:mi>
                        <mml:mi>ω</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>L</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:msubsup>
                        <mml:mi>u</mml:mi>
                        <mml:mi>l</mml:mi>
                        <mml:mi>ω</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:msub>
                        <mml:mi>d</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>π</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:mo>=</mml:mo>
                          <mml:mi>l</mml:mi>
                          <mml:mo>|</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>ω</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>max</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:munder>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mi>u</mml:mi>
                            <mml:mi>k</mml:mi>
                            <mml:mi>ω</mml:mi>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mi>δ</mml:mi>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                      <mml:mtext>     </mml:mtext>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mn>27</mml:mn>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>ω</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:msup>
                            <mml:mi>π</mml:mi>
                            <mml:mrow>
                              <mml:mi>P</mml:mi>
                              <mml:mi>V</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>ω</mml:mi>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mo>|</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>max</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:munder>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mi>u</mml:mi>
                            <mml:mi>k</mml:mi>
                            <mml:mi>ω</mml:mi>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mi>L</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mi>δ</mml:mi>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>E</mml:mi>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakqaabeqaaiabgcGiIiabdUgaRjabgcMi5kabdkeacjabcYcaSiabdMgaPjabg2da9iabicdaWiabcQda6iabdwha1naaDaaaleaacqWGcbGqaeaaiiGacqWFjpWDaaGcdaqadaqaaiabicdaWaGaayjkaiaawMcaaiabg2da9iabigdaXiabcYcaSiabdwha1naaDaaaleaacqWGRbWAaeaacqWFjpWDaaGcdaqadaqaaiabicdaWaGaayjkaiaawMcaaiabg2da9iabicdaWaqaaiabgcGiIiabigdaXiabgsMiJkabdMgaPjabgsMiJkabdYeamjabcQda6iabdwha1naaDaaaleaacqWGSbaBaeaacqWFjpWDaaGcdaqadaqaaiabdMgaPbGaayjkaiaawMcaaiabg2da9iabdsgaKnaaBaaaleaacqWGSbaBaeqaaOWaaeWaaeaacqWGPbqAaiaawIcacaGLPaaacqWGqbaudaqadaqaaiab=b8aWnaaBaaaleaacqWGPbqAaeqaaOGaeyypa0JaemiBaWMaeiiFaWhcbeGae4hEaGNaeiilaWccceGae0xYdCNaeiilaWIae8hUdehacaGLOaGaayzkaaWaaCbeaeaacyGGTbqBcqGGHbqycqGG4baEaSqaaiabdUgaRbqabaGcdaGadaqaaiabdwha1naaDaaaleaacqWGRbWAaeaacqWFjpWDaaGcdaqadaqaaiabdMgaPjabgkHiTiabigdaXaGaayjkaiaawMcaaiab=r7aKnaabmaabaGaem4AaSMaeiilaWIaemiBaWgacaGLOaGaayzkaaaacaGL7bGaayzFaaGaaCzcaiaaxMaadaqadaqaaiabikdaYiabiEda3aGaayjkaiaawMcaaaqaaiabdcfaqnaabmaabaGae4hEaGNaeiilaWIae0xYdCNaeiilaWIae8hWda3aaWbaaSqabeaacqWGqbaucqWGwbGvcqGGSaalcqWFjpWDaaGccqGG8baFcqWF4oqCaiaawIcacaGLPaaacqGH9aqpdaWfqaqaaiGbc2gaTjabcggaHjabcIha4bWcbaGaem4AaSgabeaakmaacmaabaGaemyDau3aa0baaSqaaiabdUgaRbqaaiab=L8a3baakmaabmaabaGaemitaWeacaGLOaGaayzkaaGae8hTdq2aaeWaaeaacqWGRbWAcqGGSaalcqWGfbqraiaawIcacaGLPaaaaiaawUhacaGL9baaaaaa@B799@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>where, instead of the standard posterior probabilities we used those computed by the modified Forward and Backward algorithms in Equation (10).</p>
      </sec>
      <sec>
        <title>Optimal Accuracy Posterior Decoding</title>
        <p>Finally, Kall and coworkers presented a very similar algorithm, the Optimal Accuracy Posterior Decoder [<xref ref-type="bibr" rid="B36">36</xref>]. The algorithm sums for each position in the sequence the posterior label probabilities (PLPs), using Equation (19), and by using the allowed transitions defined by Equation (24), calculates in a Viterbi-like manner the optimal sequence of labels that maximises the quantity:</p>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" name="1471-2105-7-189-i26" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:msup>
                    <mml:mi>π</mml:mi>
                    <mml:mrow>
                      <mml:mi>O</mml:mi>
                      <mml:mi>A</mml:mi>
                      <mml:mi>P</mml:mi>
                      <mml:mi>D</mml:mi>
                    </mml:mrow>
                  </mml:msup>
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi>arg</mml:mi>
                      <mml:mo>⁡</mml:mo>
                      <mml:mi>max</mml:mi>
                      <mml:mo>⁡</mml:mo>
                    </mml:mrow>
                    <mml:mi>π</mml:mi>
                  </mml:munder>
                  <mml:mstyle displaystyle="true">
                    <mml:munderover>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mi>L</mml:mi>
                    </mml:munderover>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:mi>δ</mml:mi>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:msub>
                                <mml:mi>π</mml:mi>
                                <mml:mi>i</mml:mi>
                              </mml:msub>
                              <mml:mo>,</mml:mo>
                              <mml:msub>
                                <mml:mi>π</mml:mi>
                                <mml:mrow>
                                  <mml:mi>i</mml:mi>
                                  <mml:mo>+</mml:mo>
                                  <mml:mn>1</mml:mn>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mstyle displaystyle="true">
                                <mml:munder>
                                  <mml:mo>∑</mml:mo>
                                  <mml:mi>k</mml:mi>
                                </mml:munder>
                                <mml:mrow>
                                  <mml:mi>P</mml:mi>
                                  <mml:mrow>
                                    <mml:mo>(</mml:mo>
                                    <mml:mrow>
                                      <mml:msub>
                                        <mml:mi>π</mml:mi>
                                        <mml:mi>i</mml:mi>
                                      </mml:msub>
                                      <mml:mo>|</mml:mo>
                                      <mml:mi>x</mml:mi>
                                    </mml:mrow>
                                    <mml:mo>)</mml:mo>
                                  </mml:mrow>
                                  <mml:msub>
                                    <mml:mi>λ</mml:mi>
                                    <mml:mi>k</mml:mi>
                                  </mml:msub>
                                  <mml:mrow>
                                    <mml:mo>(</mml:mo>
                                    <mml:mi>c</mml:mi>
                                    <mml:mo>)</mml:mo>
                                  </mml:mrow>
                                </mml:mrow>
                              </mml:mstyle>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mtext>     </mml:mtext>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mn>28</mml:mn>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaaiiGacqWFapaCdaahaaWcbeqaaiabd+eapjabdgeabjabdcfaqjabdseaebaakiabg2da9maaxababaGagiyyaeMaeiOCaiNaei4zaCMagiyBa0MaeiyyaeMaeiiEaGhaleaacqWFapaCaeqaaOWaaabCaeaadaGadaqaaiab=r7aKnaabmaabaGae8hWda3aaSbaaSqaaiabdMgaPbqabaGccqGGSaalcqWFapaCdaWgaaWcbaGaemyAaKMaey4kaSIaeGymaedabeaaaOGaayjkaiaawMcaamaabmaabaWaaabuaeaacqWGqbaudaqadaqaaiab=b8aWnaaBaaaleaacqWGPbqAaeqaaOGaeiiFaWhcbeGae4hEaGhacaGLOaGaayzkaaGae83UdW2aaSbaaSqaaiabdUgaRbqabaGcdaqadaqaaiabdogaJbGaayjkaiaawMcaaaWcbaGaem4AaSgabeqdcqGHris5aaGccaGLOaGaayzkaaaacaGL7bGaayzFaaaaleaacqWGPbqAcqGH9aqpcqaIXaqmaeaacqWGmbata0GaeyyeIuoakiaaxMaacaWLjaWaaeWaaeaacqaIYaGmcqaI4aaoaiaawIcacaGLPaaaaaa@6C8B@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
      </sec>
      <sec>
        <title>Optimal Accuracy Posterior Decoder algorithm</title>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" name="1471-2105-7-189-i27" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mi>k</mml:mi>
                      <mml:mo>≠</mml:mo>
                      <mml:mi>B</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>:</mml:mo>
                      <mml:msub>
                        <mml:mi>A</mml:mi>
                        <mml:mi>B</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mi>A</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mi>∞</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>L</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:msub>
                        <mml:mi>A</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:mo>=</mml:mo>
                          <mml:msup>
                            <mml:mi>c</mml:mi>
                            <mml:mi>l</mml:mi>
                          </mml:msup>
                          <mml:mo>|</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>max</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:munder>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>A</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mi>δ</mml:mi>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                      <mml:mtext>     </mml:mtext>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mn>29</mml:mn>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:msup>
                            <mml:mi>π</mml:mi>
                            <mml:mrow>
                              <mml:mi>O</mml:mi>
                              <mml:mi>A</mml:mi>
                              <mml:mi>P</mml:mi>
                              <mml:mi>D</mml:mi>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mo>|</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>max</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:munder>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>A</mml:mi>
                            <mml:mi>k</mml:mi>
                          </mml:msub>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mi>L</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mi>δ</mml:mi>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>E</mml:mi>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakqaabeqaaiabgcGiIiabdUgaRjabgcMi5kabdkeacjabcYcaSiabdMgaPjabg2da9iabicdaWiabcQda6iabdgeabnaaBaaaleaacqWGcbGqaeqaaOWaaeWaaeaacqaIWaamaiaawIcacaGLPaaacqGH9aqpcqaIWaamcqGGSaalcqWGbbqqdaWgaaWcbaGaem4AaSgabeaakmaabmaabaGaeGimaadacaGLOaGaayzkaaGaeyypa0JaeyOeI0IaeyOhIukabaGaeyiaIiIaeGymaeJaeyizImQaemyAaKMaeyizImQaemitaWKaeiOoaOJaemyqae0aaSbaaSqaaiabdYgaSbqabaGcdaqadaqaaiabdMgaPbGaayjkaiaawMcaaiabg2da9iabdcfaqnaabmaabaGaemyEaK3aaSbaaSqaaiabdMgaPbqabaGccqGH9aqpcqWGJbWydaahaaWcbeqaaiabdYgaSbaakiabcYha8Hqabiab=Hha4jabcYcaSGGaciab+H7aXbGaayjkaiaawMcaaiabgUcaRmaaxababaGagiyBa0MaeiyyaeMaeiiEaGhaleaacqWGRbWAaeqaaOWaaiWaaeaacqWGbbqqdaWgaaWcbaGaem4AaSgabeaakmaabmaabaGaemyAaKMaeyOeI0IaeGymaedacaGLOaGaayzkaaGae4hTdq2aaeWaaeaacqWGRbWAcqGGSaalcqWGSbaBaiaawIcacaGLPaaaaiaawUhacaGL9baacaWLjaGaaCzcamaabmaabaGaeGOmaiJaeGyoaKdacaGLOaGaayzkaaaabaGaemiuaa1aaeWaaeaacqWF4baEcqGGSaalcqGFapaCdaahaaWcbeqaaiabd+eapjabdgeabjabdcfaqjabdseaebaakiabcYha8jab+H7aXbGaayjkaiaawMcaaiabg2da9maaxababaGagiyBa0MaeiyyaeMaeiiEaGhaleaacqWGRbWAaeqaaOWaaiWaaeaacqWGbbqqdaWgaaWcbaGaem4AaSgabeaakmaabmaabaGaemitaWeacaGLOaGaayzkaaGae4hTdq2aaeWaaeaacqWGRbWAcqGGSaalcqWGfbqraiaawIcacaGLPaaaaiaawUhacaGL9baaaaaa@A481@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
        <p>As one can observe comparing Equations (25) and (28), the main differences of this algorithm compared to the Posterior-Viterbi is, i) the fact that uses the sums of the posterior label probabilities instead of the posterior probabilities, and ii) that instead of the product, it maximises the sum of these probabilities. Consequently, it is straightforward once again to obtain constraint predictions utilising the prior information:</p>
      </sec>
      <sec>
        <title>Modified Optimal Accuracy Posterior Decoder algorithm</title>
        <p>
          <inline-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" name="1471-2105-7-189-i28" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mtable columnalign="left">
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mi>k</mml:mi>
                      <mml:mo>≠</mml:mo>
                      <mml:mi>B</mml:mi>
                      <mml:mo>,</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>:</mml:mo>
                      <mml:msub>
                        <mml:mi>A</mml:mi>
                        <mml:mi>B</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mn>0</mml:mn>
                      <mml:mo>,</mml:mo>
                      <mml:msub>
                        <mml:mi>A</mml:mi>
                        <mml:mi>k</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mo>−</mml:mo>
                      <mml:mi>∞</mml:mi>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mo>∀</mml:mo>
                      <mml:mn>1</mml:mn>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>≤</mml:mo>
                      <mml:mi>L</mml:mi>
                      <mml:mo>:</mml:mo>
                      <mml:msub>
                        <mml:mi>A</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>y</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:msub>
                          <mml:mo>=</mml:mo>
                          <mml:msup>
                            <mml:mi>c</mml:mi>
                            <mml:mi>l</mml:mi>
                          </mml:msup>
                          <mml:mo>|</mml:mo>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>ω</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>d</mml:mi>
                        <mml:mi>l</mml:mi>
                      </mml:msub>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mi>i</mml:mi>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>max</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:munder>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mi>A</mml:mi>
                            <mml:mi>k</mml:mi>
                            <mml:mi>ω</mml:mi>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>i</mml:mi>
                              <mml:mo>−</mml:mo>
                              <mml:mn>1</mml:mn>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mi>δ</mml:mi>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>l</mml:mi>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                      <mml:mtext>     </mml:mtext>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mn>30</mml:mn>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                  <mml:mtr>
                    <mml:mtd>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mo>(</mml:mo>
                        <mml:mrow>
                          <mml:mi>x</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:mi>ω</mml:mi>
                          <mml:mo>,</mml:mo>
                          <mml:msup>
                            <mml:mi>π</mml:mi>
                            <mml:mrow>
                              <mml:mi>O</mml:mi>
                              <mml:mi>A</mml:mi>
                              <mml:mi>P</mml:mi>
                              <mml:mi>D</mml:mi>
                            </mml:mrow>
                          </mml:msup>
                          <mml:mo>|</mml:mo>
                          <mml:mi>θ</mml:mi>
                        </mml:mrow>
                        <mml:mo>)</mml:mo>
                      </mml:mrow>
                      <mml:mo>=</mml:mo>
                      <mml:munder>
                        <mml:mrow>
                          <mml:mi>max</mml:mi>
                          <mml:mo>⁡</mml:mo>
                        </mml:mrow>
                        <mml:mi>k</mml:mi>
                      </mml:munder>
                      <mml:mrow>
                        <mml:mo>{</mml:mo>
                        <mml:mrow>
                          <mml:msubsup>
                            <mml:mi>A</mml:mi>
                            <mml:mi>k</mml:mi>
                            <mml:mi>ω</mml:mi>
                          </mml:msubsup>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mi>L</mml:mi>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                          <mml:mi>δ</mml:mi>
                          <mml:mrow>
                            <mml:mo>(</mml:mo>
                            <mml:mrow>
                              <mml:mi>k</mml:mi>
                              <mml:mo>,</mml:mo>
                              <mml:mi>E</mml:mi>
                            </mml:mrow>
                            <mml:mo>)</mml:mo>
                          </mml:mrow>
                        </mml:mrow>
                        <mml:mo>}</mml:mo>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakqaabeqaaiabgcGiIiabdUgaRjabgcMi5kabdkeacjabcYcaSiabdMgaPjabg2da9iabicdaWiabcQda6iabdgeabnaaBaaaleaacqWGcbGqaeqaaOWaaeWaaeaacqaIWaamaiaawIcacaGLPaaacqGH9aqpcqaIWaamcqGGSaalcqWGbbqqdaWgaaWcbaGaem4AaSgabeaakmaabmaabaGaeGimaadacaGLOaGaayzkaaGaeyypa0JaeyOeI0IaeyOhIukabaGaeyiaIiIaeGymaeJaeyizImQaemyAaKMaeyizImQaemitaWKaeiOoaOJaemyqae0aaSbaaSqaaiabdYgaSbqabaGcdaqadaqaaiabdMgaPbGaayjkaiaawMcaaiabg2da9iabdcfaqnaabmaabaGaemyEaK3aaSbaaSqaaiabdMgaPbqabaGccqGH9aqpcqWGJbWydaahaaWcbeqaaiabdYgaSbaakiabcYha8Hqabiab=Hha4jabcYcaSGGabiab+L8a3jabcYcaSGGaciab9H7aXbGaayjkaiaawMcaaiabgUcaRiabdsgaKnaaBaaaleaacqWGSbaBaeqaaOWaaeWaaeaacqWGPbqAaiaawIcacaGLPaaadaWfqaqaaiGbc2gaTjabcggaHjabcIha4bWcbaGaem4AaSgabeaakmaacmaabaGaemyqae0aa0baaSqaaiabdUgaRbqaaiab9L8a3baakmaabmaabaGaemyAaKMaeyOeI0IaeGymaedacaGLOaGaayzkaaGae0hTdq2aaeWaaeaacqWGRbWAcqGGSaalcqWGSbaBaiaawIcacaGLPaaaaiaawUhacaGL9baacaWLjaGaaCzcamaabmaabaGaeG4mamJaeGimaadacaGLOaGaayzkaaaabaGaemiuaa1aaeWaaeaacqWF4baEcqGGSaalcqGFjpWDcqGGSaalcqqFapaCdaahaaWcbeqaaiabd+eapjabdgeabjabdcfaqjabdseaebaakiabcYha8jab9H7aXbGaayjkaiaawMcaaiabg2da9maaxababaGagiyBa0MaeiyyaeMaeiiEaGhaleaacqWGRbWAaeqaaOWaaiWaaeaacqWGbbqqdaqhaaWcbaGaem4AaSgabaGae0xYdChaaOWaaeWaaeaacqWGmbataiaawIcacaGLPaaacqqF0oazdaqadaqaaiabdUgaRjabcYcaSiabdweafbGaayjkaiaawMcaaaGaay5Eaiaaw2haaaaaaa@B31F@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </inline-formula>
        </p>
      </sec>
    </sec>
    <sec>
      <title>Technical comments on the implementation and future improvements</title>
      <p>There are various ways, with which the delta function described in Equation (8) can be implemented. The most obvious is to introduce a new matrix, similar to those used in all the algorithms (forward, backward etc), in which we store the values of the function. Another way (which in many cases may be more preferable) is to perform the appropriate tests for the agreement of labels with states along the sequence, each time we visit a particular state. Furthermore, with the general notation used in Equation (8), the algorithms described here may also be used in situations where the label probability is not a delta function but instead we allow one state to match more than one labels, requiring thus a full probability distribution of the form:</p>
      <p><italic>λ</italic><sub><italic>k</italic></sub>(c) = <italic>P</italic>(<italic>y</italic><sub><italic>i </italic></sub>= <italic>c</italic>|<italic>π</italic><sub><italic>i </italic></sub>= <italic>k</italic>)</p>
      <p>In such situations, all the algorithms described here remain unchanged.</p>
      <p>Another useful note arises from the observation that in some situations the localisation of a particular residue or segment cannot be easily assigned to one of the model's labels using certain experimental techniques. For instance, using fusions of beta-lactamase (BlaM) in a potential loop and observing negative activity of the fused domain, we may interpret the results as indication for the localisation into the cytoplasm. Unfortunately, the same results could be observed if the particular residue was localised in a transmembrane segment. Similar interpretations may also occur for other reporter fusions (GFP, LacZ etc). In such situations, the above algorithms may also be extended to incorporate this information, by simply allowing the observation to consist of a set of possible labels for each position along the sequence. For instance, instead of stating that the localisation of residue <italic>i </italic>is <italic>cytoplasmic </italic>(<italic>I</italic>):</p>
      <p><italic>ω</italic><sub><italic>i </italic></sub>= <italic>I</italic></p>
      <p>we may state that</p>
      <p><italic>ω</italic><sub><italic>i </italic></sub>= {<italic>M,I</italic>} = <italic>O</italic><sup><italic>C</italic></sup></p>
      <p>meaning that the localisation is <italic>not extracellular </italic>(<italic>O</italic><sup><italic>C</italic></sup>). Modifying now properly the delta function in Equation (8), all the algorithms presented above remain unchanged. We also have to note that the above-mentioned algorithms remain unchanged in cases where the HMM uses continuous instead of discrete emission probabilities, indicating the general applicability of our approach. Finally, we have to mention also a further addition to the algorithms developed here. In particular, if we replace the delta function in Equation (8) with a full probability distribution, all the algorithms presented above remain unchanged and the probabilistic interpretation of the model is retained. This situation may arise in cases where we have multiple sources of information available, and we have reasons for assigning different weights to each one (for instance if we have reasons to believe that one method is more reliable than another). Although this might be a useful strategy, especially in cases of conflicting or ambiguous experiments, we have not tried to investigate this further.</p>
    </sec>
    <sec>
      <title>The model architecture and training procedure</title>
      <p>In order to show the effectiveness of the modified algorithms that we described so far, we developed a method to predict the membrane-spanning segments of alpha-helical membrane proteins. The model that we used is cyclic, consisting of 114 states, including begin (B) and end (E) states, (Figure <xref ref-type="fig" rid="F4">4</xref>), and is conceptually similar to other models described earlier for the same task [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B54">54</xref>], even though somewhat simpler. The architecture has been chosen so that it could fit as much as possible to the limitations imposed by the known structures and the prior biological knowledge. The model consists of three "sub-models" corresponding to the three desired labels to predict, the TM (transmembrane) helix sub-model and the inner and outer loops sub-models respectively. The TM helix model incorporates states to model the architecture of the transmembrane helices. Thus, there are states that correspond to the core of the helix and the cap located at the lipid bilayer interface. All states are connected with the appropriate transition probabilities in order to be consistent with the known structures, that is, to ensure appropriate length distribution. The inner and outer loops are modelled with a "ladder" architecture, at the top each is a self transitioning state corresponding to residues too distant from the membrane; these cannot be modelled as loops, hence that state is named "globular".</p>
      <p>For training the model we used the Conditional Maximum Likelihood (CML) criterion for labelled data [<xref ref-type="bibr" rid="B32">32</xref>,<xref ref-type="bibr" rid="B33">33</xref>], with the modified algorithms for faster and robust training described in [<xref ref-type="bibr" rid="B55">55</xref>]. The training procedure consisted of three steps. Briefly, a model was initially estimated using the Baum-Welch algorithm for labelled sequences [<xref ref-type="bibr" rid="B32">32</xref>]. Afterwards, the labels of the sequences were deleted in a region flanking three residues in each direction of the end of a membrane-spanning helix, and predictions were performed using the modified Viterbi algorithm presented above, and the model that was estimated from step 1. The final model was estimated, using the labels derived from step 2, with the modified gradient-descent method for CML training [<xref ref-type="bibr" rid="B55">55</xref>]. Finally the decoding is performed with the Optimal Accuracy Posterior Decoder, as described in [<xref ref-type="bibr" rid="B36">36</xref>].</p>
    </sec>
    <sec>
      <title>Datasets</title>
      <p>The training set that we used contains 72 membrane proteins with three dimensional structures determined at atomic resolution and most of these structures are deposited in the Protein Data Bank (PDB) [<xref ref-type="bibr" rid="B56">56</xref>]. The dataset is the one used in the work of [<xref ref-type="bibr" rid="B38">38</xref>], except from one protein (1PGE:A) that was not considered to be a typical membrane protein (possesses transmembrane helices shorter than 10 amino-acids). In all cases the sequence used, was that obtained from Uniprot [<xref ref-type="bibr" rid="B57">57</xref>], after the removal of any signal peptide, that could bias the training and testing procedure [<xref ref-type="bibr" rid="B58">58</xref>]. The training dataset consists of 39 single spanning and 33 multi-spanning membrane proteins, of which 42 are of prokaryotic (including viruses) and 30 of eukaryotic origin. Thus, the dataset is considered representative and is of similar composition compared to the training set used for most of the other top-scoring HMM predictors [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B29">29</xref>,<xref ref-type="bibr" rid="B39">39</xref>]. However, it is significantly smaller consisting of only 72 proteins, in contrast to the other datasets used that consisted of nearly more than 150 transmembrane proteins. Only Zhou and Zhou [<xref ref-type="bibr" rid="B38">38</xref>], which used effectively the same set, and Martelli et al [<xref ref-type="bibr" rid="B39">39</xref>], which compiled a dataset of 59 transmembrane proteins, used sets of comparable size. The striking feature of the particular dataset is the fact that consists only of proteins with crystallographically solved structure. Although it is common in the relevant publications to use datasets of mixed resolution, i.e. proteins with three-dimensional structure mixed with proteins with topology determined by low resolution biochemical experiments [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B11">11</xref>,<xref ref-type="bibr" rid="B29">29</xref>], the results of Martelli et al [<xref ref-type="bibr" rid="B39">39</xref>], clearly showed that the low resolution sets are less reliable and they should not be used either as training or even as test sets.</p>
      <p>In order to compare the accuracy of the developed method and facilitate the unbiased comparison against the other established methods, we compiled a dataset of transmembrane proteins whose three-dimensional structures are available and deposited in PDB. We chose proteins, which do not show significant similarity (&lt;30% identities in length of more than 80 residues), to any of the proteins used for training either by the current method (and by UMDHMM<sup>TMHP</sup>), by HMMTOP, or by TMHMM. This dataset consists of 26 proteins (Table <xref ref-type="table" rid="T3">3</xref>), with numbers of transmembrane segments ranging from 1–14, and is considered to be an as representative as possible (although small) set, on which the performance of the various predictors could be evaluated in an unbiased manner.</p>
      <p>As a further blind test we also used a set of 34 <italic>E.coli </italic>inner membrane proteins [<xref ref-type="bibr" rid="B26">26</xref>] and a set of 39 cytoplasmic membrane proteins of <italic>S. cerevisiae </italic>[<xref ref-type="bibr" rid="B27">27</xref>], with experimentally verified localization of the C-terminus. This set contains proteins of which the topology are not known, with the exception of the C-terminal part, but the majority of the web-predictors evaluated in the respective study agree for the number of their transmembrane helices. For 3 proteins of the <italic>E. coli </italic>and 2 of the <italic>S. cerevisiae </italic>set, the localisation of the C-terminus could not be obtained, thus, for these proteins only the number of predicted transmembrane segments are considered. The primary intention of using this set was to evaluate the accuracy of the various predictors in determining only partially the topology, as well as in order to show that using the prior knowledge about the topology the prediction accuracy increases.</p>
      <p>For evaluating the ability of the methods to correctly discriminate transmembrane proteins from globular ones, i.e. to evaluate the rate of false positive predictions, we used an additional non-redundant dataset of 645 globular proteins with crystallographically solved structures, that was initially used by the developers of TMHMM [<xref ref-type="bibr" rid="B9">9</xref>].</p>
      <p>In all of the comparisons performed, the evaluation of the statistical significance of the results was performed using the Kruskal-Wallis non-parametric test for the equality of distributions between several populations. This test is the non-parametric analogue of the one-way Analysis of Variance (ANOVA), and was chosen as it best fits the nature of the data we compare (non-normally distributed) as well as the relative small sample size. Statistical significance was declared for p-values &lt; 0.05.</p>
    </sec>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>PB formulated the algorithms, drafted the manuscript, performed the analysis, and participated in the implementation. TL participated in the analysis, and implemented most of the algorithms as well as the web-interface. SH supervised the whole project, and participated in drafting the manuscript. All authors have read and accepted the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional File 1</title>
        <p>containing the detailed results obtained using the available predictors, on the 2 datasets of proteins with experimentally verified localisation of the C-terminus (supplement.xls).</p>
      </caption>
      <media xlink:href="1471-2105-7-189-S1.xls" mimetype="application" mime-subtype="vnd.ms-excel">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>The authors would like to thank the three anonymous referees for their valuable help and the constructive criticism.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rabiner</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>A tutorial on hidden Markov models and selected applications in speech recognition.</article-title>
        <source>Proc IEEE</source>
        <year>1989</year>
        <volume>77</volume>
        <fpage> 257</fpage>
        <lpage>286</lpage>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mithison</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <source>Biological sequence analysis, probabilistic models of proteins and nucleic acids</source>
        <year>1998</year>
        <publisher-name> Cambridge University Press</publisher-name>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mian</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>A hidden Markov model that finds genes in E. coli DNA</article-title>
        <source>Nucleic Acids Res</source>
        <year>1994</year>
        <volume>22</volume>
        <fpage>4768</fpage>
        <lpage>4778</lpage>
        <pub-id pub-id-type="pmid">7984429</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Multiple alignment using hidden Markov models</article-title>
        <source>Proc Int Conf Intell Syst Mol Biol</source>
        <year>1995</year>
        <volume>3</volume>
        <fpage>114</fpage>
        <lpage>120</lpage>
        <pub-id pub-id-type="pmid">7584426</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Profile hidden Markov models</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>755</fpage>
        <lpage>763</lpage>
        <pub-id pub-id-type="pmid">9918945</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Juncker</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Willenbrock</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>von Heijne</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Brunak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Prediction of lipoprotein signal peptides in Gram-negative bacteria</article-title>
        <source>Protein Sci</source>
        <year>2003</year>
        <volume>12</volume>
        <fpage>1652</fpage>
        <lpage>1662</lpage>
        <pub-id pub-id-type="pmid">12876315</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nielsen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Prediction of signal peptides and signal anchors by a hidden Markov model</article-title>
        <source>Proc Int Conf Intell Syst Mol Biol</source>
        <year>1998</year>
        <volume>6</volume>
        <fpage>122</fpage>
        <lpage>130</lpage>
        <pub-id pub-id-type="pmid">9783217</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Asai</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hayamizu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Handa</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Prediction of protein secondary structure by the hidden Markov model</article-title>
        <source>Comput Appl Biosci</source>
        <year>1993</year>
        <volume>9</volume>
        <fpage>141</fpage>
        <lpage>146</lpage>
        <pub-id pub-id-type="pmid">8481815</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Larsson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>von Heijne</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Sonnhammer</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <article-title>Predicting transmembrane protein topology with a hidden Markov model: application to complete genomes</article-title>
        <source>J Mol Biol</source>
        <year>2001</year>
        <volume>305</volume>
        <fpage>567</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="pmid">11152613</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bagos</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Liakopoulos</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Spyropoulos</surname>
            <given-names>IC</given-names>
          </name>
          <name>
            <surname>Hamodrakas</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>A Hidden Markov Model method, capable of predicting and discriminating beta-barrel outer membrane proteins</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kall</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sonnhammer</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <article-title>A combined transmembrane topology and signal peptide prediction method</article-title>
        <source>J Mol Biol</source>
        <year>2004</year>
        <volume>338</volume>
        <fpage>1027</fpage>
        <lpage>1036</lpage>
        <pub-id pub-id-type="pmid">15111065</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moller</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Croning</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Apweiler</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of methods for the prediction of membrane spanning regions</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>646</fpage>
        <lpage>653</lpage>
        <pub-id pub-id-type="pmid">11448883</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Viklund</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Elofsson</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Best alpha-helical transmembrane protein topology predictions are achieved using hidden Markov models and evolutionary information</article-title>
        <source>Protein Sci</source>
        <year>2004</year>
        <volume>13</volume>
        <fpage>1908</fpage>
        <lpage>1917</lpage>
        <pub-id pub-id-type="pmid">15215532</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bagos</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Liakopoulos</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Hamodrakas</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of methods for predicting the topology of ß-barrel outer membrane proteins and a consensus prediction method</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Traxler</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Boyd</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Beckwith</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The topological analysis of integral cytoplasmic membrane proteins</article-title>
        <source>J Membr Biol</source>
        <year>1993</year>
        <volume>132</volume>
        <fpage>1</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="pmid">8459445</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van Geest</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lolkema</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>Membrane topology and insertion of membrane proteins: search for topogenic signals</article-title>
        <source>Microbiol Mol Biol Rev</source>
        <year>2000</year>
        <volume>64</volume>
        <fpage>13</fpage>
        <lpage>33</lpage>
        <pub-id pub-id-type="pmid">10704472</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bennett</surname>
            <given-names>KL</given-names>
          </name>
          <name>
            <surname>Matthiesen</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Roepstorff</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Probing protein surface topology by chemical surface labeling, crosslinking, and mass spectrometry</article-title>
        <source>Methods Mol Biol</source>
        <year>2000</year>
        <volume>146</volume>
        <fpage>113</fpage>
        <lpage>131</lpage>
        <pub-id pub-id-type="pmid">10948499</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jarvik</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Telmer</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>Epitope tagging</article-title>
        <source>Annu Rev Genet</source>
        <year>1998</year>
        <volume>32</volume>
        <fpage>601</fpage>
        <lpage>618</lpage>
        <pub-id pub-id-type="pmid">9928493</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Conti-Fine</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>Lei</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>McLane</surname>
            <given-names>KE</given-names>
          </name>
        </person-group>
        <article-title>Antibodies as tools to study the structure of membrane proteins: the case of the nicotinic acetylcholine receptor</article-title>
        <source>Annu Rev Biophys Biomol Struct</source>
        <year>1996</year>
        <volume>25</volume>
        <fpage>197</fpage>
        <lpage>229</lpage>
        <pub-id pub-id-type="pmid">8800469</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Loo</surname>
            <given-names>TW</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>DM</given-names>
          </name>
        </person-group>
        <article-title>Determining the structure and mechanism of the human multidrug resistance P-glycoprotein using cysteine-scanning mutagenesis and thiol-modification techniques</article-title>
        <source>Biochim Biophys Acta</source>
        <year>1999</year>
        <volume>1461</volume>
        <fpage>315</fpage>
        <lpage>325</lpage>
        <pub-id pub-id-type="pmid">10581364</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Manoil</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Analysis of membrane protein topology using alkaline phosphatase and beta-galactosidase gene fusions</article-title>
        <source>Methods Cell Biol</source>
        <year>1991</year>
        <volume>34</volume>
        <fpage>61</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="pmid">1943817</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Broome-Smith</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Tadayyon</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Beta-lactamase as a probe of membrane protein assembly and protein export</article-title>
        <source>Mol Microbiol</source>
        <year>1990</year>
        <volume>4</volume>
        <fpage>1637</fpage>
        <lpage>1644</lpage>
        <pub-id pub-id-type="pmid">2077355</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ki</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Kawarasaki</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gam</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Harvey</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Iverson</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Georgiou</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>A periplasmic fluorescent reporter protein and its application in high-throughput membrane protein topology analysis</article-title>
        <source>J Mol Biol</source>
        <year>2004</year>
        <volume>341</volume>
        <fpage>901</fpage>
        <lpage>909</lpage>
        <pub-id pub-id-type="pmid">15328603</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Melen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>von Heijne</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Reliability measures for membrane protein topology prediction algorithms</article-title>
        <source>J Mol Biol</source>
        <year>2003</year>
        <volume>327</volume>
        <fpage>735</fpage>
        <lpage>744</lpage>
        <pub-id pub-id-type="pmid">12634065</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Drew</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sjostrand</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Nilsson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Urbig</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Chin</surname>
            <given-names>CN</given-names>
          </name>
          <name>
            <surname>de Gier</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>von Heijne</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Rapid topology mapping of Escherichia coli inner-membrane proteins by prediction and PhoA/GFP fusion analysis</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2002</year>
        <volume>99</volume>
        <fpage>2690</fpage>
        <lpage>2695</lpage>
        <pub-id pub-id-type="pmid">11867724</pub-id>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rapp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Drew</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Daley</surname>
            <given-names>DO</given-names>
          </name>
          <name>
            <surname>Nilsson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Carvalho</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Melen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>De Gier</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Von Heijne</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Experimentally based topology models for E. coli inner membrane proteins</article-title>
        <source>Protein Sci</source>
        <year>2004</year>
        <volume>13</volume>
        <fpage>937</fpage>
        <lpage>945</lpage>
        <pub-id pub-id-type="pmid">15044727</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Melen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>von Heijne</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Topology models for 37 Saccharomyces cerevisiae membrane proteins based on C-terminal reporter fusions and predictions</article-title>
        <source>J Biol Chem</source>
        <year>2003</year>
        <volume>278</volume>
        <fpage>10208</fpage>
        <lpage>10213</lpage>
        <pub-id pub-id-type="pmid">12524434</pub-id>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Daley</surname>
            <given-names>DO</given-names>
          </name>
          <name>
            <surname>Rapp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Granseth</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Melen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Drew</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>von Heijne</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Global topology analysis of the Escherichia coli inner membrane proteome</article-title>
        <source>Science</source>
        <year>2005</year>
        <volume>308</volume>
        <fpage>1321</fpage>
        <lpage>1323</lpage>
        <pub-id pub-id-type="pmid">15919996</pub-id>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tusnady</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>The HMMTOP transmembrane topology prediction server</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>849</fpage>
        <lpage>850</lpage>
        <pub-id pub-id-type="pmid">11590105</pub-id>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <collab>TMHMMfix</collab>
        </person-group>
        <ext-link ext-link-type="uri" xlink:href="http://www.sbc.su.se/TMHMMfix/"/>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernsel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Von Heijne</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Improved membrane protein topology prediction by domain assignments</article-title>
        <source>Protein Sci</source>
        <year>2005</year>
        <volume>14</volume>
        <fpage>1723</fpage>
        <lpage>1728</lpage>
        <pub-id pub-id-type="pmid">15987901</pub-id>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Hidden Markov models for labelled sequences.</article-title>
        <source>Proceedings of the12th IAPR International Conference on Pattern Recognition</source>
        <year>1994</year>
        <fpage>140</fpage>
        <lpage>144</lpage>
      </citation>
    </ref>
    <ref id="B33">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Two methods for improving performance of an HMM and their application for gene finding</article-title>
        <source>Proc Int Conf Intell Syst Mol Biol</source>
        <year>1997</year>
        <volume>5</volume>
        <fpage>179</fpage>
        <lpage>186</lpage>
        <pub-id pub-id-type="pmid">9322033</pub-id>
      </citation>
    </ref>
    <ref id="B34">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fariselli</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Finelli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Marchignoli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Martelli</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Rossi</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Casadio</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>MaxSubSeq: an algorithm for segment-length optimization. The case study of the transmembrane spanning segments</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>500</fpage>
        <lpage>505</lpage>
        <pub-id pub-id-type="pmid">12611805</pub-id>
      </citation>
    </ref>
    <ref id="B35">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fariselli</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Martelli</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Casadio</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>A new decoding algorithm for hidden Markov models improves the prediction of the topology of all-beta membrane proteins</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6 Suppl 4</volume>
        <fpage>S12</fpage>
        <pub-id pub-id-type="pmid">16351738</pub-id>
      </citation>
    </ref>
    <ref id="B36">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kall</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Krogh</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sonnhammer</surname>
            <given-names>EL</given-names>
          </name>
        </person-group>
        <article-title>An HMM posterior decoder for sequence feature prediction that includes homology information</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21 Suppl 1</volume>
        <fpage>i251</fpage>
        <lpage>i257</lpage>
        <pub-id pub-id-type="pmid">15961464</pub-id>
      </citation>
    </ref>
    <ref id="B37">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jones</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Taylor</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Thornton</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>A model recognition approach to the prediction of all-helical membrane protein structure and topology</article-title>
        <source>Biochemistry</source>
        <year>1994</year>
        <volume>33</volume>
        <fpage>3038</fpage>
        <lpage>3049</lpage>
        <pub-id pub-id-type="pmid">8130217</pub-id>
      </citation>
    </ref>
    <ref id="B38">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Predicting the topology of transmembrane helical proteins using mean burial propensity and a hidden-Markov-model-based method</article-title>
        <source>Protein Sci</source>
        <year>2003</year>
        <volume>12</volume>
        <fpage>1547</fpage>
        <lpage>1555</lpage>
        <pub-id pub-id-type="pmid">12824500</pub-id>
      </citation>
    </ref>
    <ref id="B39">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martelli</surname>
            <given-names>PL</given-names>
          </name>
          <name>
            <surname>Fariselli</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Casadio</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>An ENSEMBLE machine learning approach for the prediction of all-alpha membrane proteins</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19 Suppl 1</volume>
        <fpage>i205</fpage>
        <lpage>11</lpage>
        <pub-id pub-id-type="pmid">12855459</pub-id>
      </citation>
    </ref>
    <ref id="B40">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rost</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Casadio</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Fariselli</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Refining neural network predictions for helical transmembrane proteins by dynamic programming</article-title>
        <source>Proc Int Conf Intell Syst Mol Biol</source>
        <year>1996</year>
        <volume>4</volume>
        <fpage>192</fpage>
        <lpage>200</lpage>
        <pub-id pub-id-type="pmid">8877519</pub-id>
      </citation>
    </ref>
    <ref id="B41">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rost</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Fariselli</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Casadio</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Topology prediction for helical transmembrane proteins at 86% accuracy</article-title>
        <source>Protein Sci</source>
        <year>1996</year>
        <volume>5</volume>
        <fpage>1704</fpage>
        <lpage>1718</lpage>
        <pub-id pub-id-type="pmid">8844859</pub-id>
      </citation>
    </ref>
    <ref id="B42">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Claros</surname>
            <given-names>MG</given-names>
          </name>
          <name>
            <surname>von Heijne</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>TopPred II: an improved software for membrane protein structure predictions</article-title>
        <source>Comput Appl Biosci</source>
        <year>1994</year>
        <volume>10</volume>
        <fpage>685</fpage>
        <lpage>686</lpage>
        <pub-id pub-id-type="pmid">7704669</pub-id>
      </citation>
    </ref>
    <ref id="B43">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baldi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Brunak</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Chauvin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Andersen</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Nielsen</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Assessing the accuracy of prediction algorithms for classification: an overview</article-title>
        <source>Bioinformatics</source>
        <year>2000</year>
        <volume>16</volume>
        <fpage>412</fpage>
        <lpage>424</lpage>
        <pub-id pub-id-type="pmid">10871264</pub-id>
      </citation>
    </ref>
    <ref id="B44">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zemla</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Venclovas</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fidelis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Rost</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>A modified definition of Sov, a segment-based measure for protein secondary structure prediction assessment</article-title>
        <source>Proteins</source>
        <year>1999</year>
        <volume>34</volume>
        <fpage>220</fpage>
        <lpage>223</lpage>
        <pub-id pub-id-type="pmid">10022357</pub-id>
      </citation>
    </ref>
    <ref id="B45">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Murakami</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nakashima</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Yamashita</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Yamaguchi</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Crystal structure of bacterial multidrug efflux transporter AcrB</article-title>
        <source>Nature</source>
        <year>2002</year>
        <volume>419</volume>
        <fpage>587</fpage>
        <lpage>593</lpage>
        <pub-id pub-id-type="pmid">12374972</pub-id>
      </citation>
    </ref>
    <ref id="B46">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fujihira</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Tamura</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Yamaguchi</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Membrane topology of a multidrug efflux transporter, AcrB, in Escherichia coli</article-title>
        <source>J Biochem (Tokyo)</source>
        <year>2002</year>
        <volume>131</volume>
        <fpage>145</fpage>
        <lpage>151</lpage>
        <pub-id pub-id-type="pmid">11754746</pub-id>
      </citation>
    </ref>
    <ref id="B47">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Promponas</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Palaios</surname>
            <given-names>GA</given-names>
          </name>
          <name>
            <surname>Pasquier</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Hamodrakas</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Hamodrakas</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>CoPreTHi: a Web tool which combines transmembrane protein segment prediction methods</article-title>
        <source>In Silico Biol</source>
        <year>1999</year>
        <volume>1</volume>
        <fpage>159</fpage>
        <lpage>162</lpage>
        <pub-id pub-id-type="pmid">11471236</pub-id>
      </citation>
    </ref>
    <ref id="B48">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nilsson</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Persson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>von Heijne</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Consensus predictions of membrane protein topology</article-title>
        <source>FEBS Lett</source>
        <year>2000</year>
        <volume>486</volume>
        <fpage>267</fpage>
        <lpage>269</lpage>
        <pub-id pub-id-type="pmid">11119716</pub-id>
      </citation>
    </ref>
    <ref id="B49">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Arai</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mitsuke</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Ikeda</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Xia</surname>
            <given-names>JX</given-names>
          </name>
          <name>
            <surname>Kikuchi</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Satake</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shimizu</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>ConPred II: a consensus prediction method for obtaining transmembrane topology models with high reliability</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>W390</fpage>
        <lpage>3</lpage>
        <pub-id pub-id-type="pmid">15215417</pub-id>
      </citation>
    </ref>
    <ref id="B50">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cuff</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Clamp</surname>
            <given-names>ME</given-names>
          </name>
          <name>
            <surname>Siddiqui</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Finlay</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Barton</surname>
            <given-names>GJ</given-names>
          </name>
        </person-group>
        <article-title>JPred: a consensus secondary structure prediction server</article-title>
        <source>Bioinformatics</source>
        <year>1998</year>
        <volume>14</volume>
        <fpage>892</fpage>
        <lpage>893</lpage>
        <pub-id pub-id-type="pmid">9927721</pub-id>
      </citation>
    </ref>
    <ref id="B51">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Spassov</surname>
            <given-names>VZ</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Flook</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Szalma</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A hidden Markov model with molecular mechanics energy-scoring function for transmembrane helix prediction</article-title>
        <source>Comput Biol Chem</source>
        <year>2004</year>
        <volume>28</volume>
        <fpage>265</fpage>
        <lpage>274</lpage>
        <pub-id pub-id-type="pmid">15548453</pub-id>
      </citation>
    </ref>
    <ref id="B52">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schwartz</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Chow</surname>
            <given-names>YL</given-names>
          </name>
        </person-group>
        <article-title>The N-Best Algorithm: An Efficient and Exact Procedure for Finding the N Most Likely Sentence Hypotheses.</article-title>
        <source>Proc IEEE Int Conf Acoust, Speech, Sig Proc</source>
        <year>1990</year>
        <volume>1</volume>
        <fpage>81</fpage>
        <lpage>84</lpage>
      </citation>
    </ref>
    <ref id="B53">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bagos</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Liakopoulos</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Spyropoulos</surname>
            <given-names>IC</given-names>
          </name>
          <name>
            <surname>Hamodrakas</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <article-title>PRED-TMBB: a web server for predicting the topology of beta-barrel outer membrane proteins</article-title>
        <source>Nucleic Acids Res</source>
        <year>2004</year>
        <volume>32</volume>
        <fpage>W400</fpage>
        <lpage>W404</lpage>
        <pub-id pub-id-type="pmid">15215419</pub-id>
      </citation>
    </ref>
    <ref id="B54">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tusnady</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Principles governing amino acid composition of integral membrane proteins: application to topology prediction</article-title>
        <source>J Mol Biol</source>
        <year>1998</year>
        <volume>283</volume>
        <fpage>489</fpage>
        <lpage>506</lpage>
        <pub-id pub-id-type="pmid">9769220</pub-id>
      </citation>
    </ref>
    <ref id="B55">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bagos</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Liakopoulos</surname>
            <given-names>TD</given-names>
          </name>
          <name>
            <surname>Hamodrakas</surname>
            <given-names>SJ</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Paliouras G, Sakakibara Y</surname>
          </name>
        </person-group>
        <source>Faster Gradient  Descent Conditional Maximum Likelihood  Training of Hidden Markov Models, Using Individual Learning Rate Adaptation: Athens.
					</source>
        <series>Lecture Notes in Artificial Intelligence</series>
        <comment>Carbonell JG, Siekmann J</comment>
        <year>2004</year>
        <volume>3264</volume>
        <publisher-name>Spinger-Verlag</publisher-name>
        <fpage>40</fpage>
        <lpage>52</lpage>
      </citation>
    </ref>
    <ref id="B56">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berman</surname>
            <given-names>HM</given-names>
          </name>
          <name>
            <surname>Battistuz</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Bhat</surname>
            <given-names>TN</given-names>
          </name>
          <name>
            <surname>Bluhm</surname>
            <given-names>WF</given-names>
          </name>
          <name>
            <surname>Bourne</surname>
            <given-names>PE</given-names>
          </name>
          <name>
            <surname>Burkhardt</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gilliland</surname>
            <given-names>GL</given-names>
          </name>
          <name>
            <surname>Iype</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Fagan</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Marvin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Padilla</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ravichandran</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Schneider</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Thanki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Weissig</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Westbrook</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Zardecki</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>The Protein Data Bank</article-title>
        <source>Acta Crystallogr D Biol Crystallogr</source>
        <year>2002</year>
        <volume>58</volume>
        <fpage>899</fpage>
        <lpage>907</lpage>
        <pub-id pub-id-type="pmid">12037327</pub-id>
      </citation>
    </ref>
    <ref id="B57">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bairoch</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Apweiler</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Barker</surname>
            <given-names>WC</given-names>
          </name>
          <name>
            <surname>Boeckmann</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ferro</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gasteiger</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Magrane</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Natale</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>O'Donovan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Redaschi</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Yeh</surname>
            <given-names>LS</given-names>
          </name>
        </person-group>
        <article-title>The Universal Protein Resource (UniProt)</article-title>
        <source>Nucleic Acids Res</source>
        <year>2005</year>
        <volume>33 Database Issue</volume>
        <fpage>D154</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">15608167</pub-id>
      </citation>
    </ref>
    <ref id="B58">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lao</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Arai</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ikeda</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shimizu</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>The presence of signal peptide significantly affects transmembrane topology prediction</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>1562</fpage>
        <lpage>1566</lpage>
        <pub-id pub-id-type="pmid">12490439</pub-id>
      </citation>
    </ref>
  </ref-list>
  <sec sec-type="display-objects">
    <title>Figures and Tables</title>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>Posterior probability plots and predicted transmembrane segments for a protein whose localisation of the C-terminal was missed by HMM-TM (YDGG_ECOLI)</bold>. In the upper graph we can see the unconstrained prediction. In the lower part, we can see the conditional prediction, after incorporating the information concerning the experimentally verified localisation of the C-terminus. The red bars indicate the predicted transmembrane segments, and we observe that these change also, coming in agreement with the other predictors.
</p>
      </caption>
      <graphic xlink:href="1471-2105-7-189-1"/>
    </fig>
    <fig position="float" id="F2">
      <label>Figure 2</label>
      <caption>
        <p><bold>Posterior probability plots and predicted transmembrane segments for the multidrug efflux transporter AcrB, a protein with known 3-dimensional structure </bold>(PDB code: <ext-link ext-link-type="pdb" xlink:href="1IWG">1IWG</ext-link>). In the upper graph we can see the unconstrained prediction. The red bars indicate the predicted transmembrane segments whereas the black bars, the observed segments. There are two missed transmembrane helices and a falsely predicted one. In the lower part, we can see the constrained prediction, after incorporating the experimental information derived from cysteine-scanning mutagenesis experiments [46]. Green arrows indicate the experimentally verified localisation of a residue in the cytoplasm, whereas blue ones indicate the experimentally verified localisation to the extracellular (periplasmic) space. We observe a remarkable agreement of the constrained prediction with the known structure.</p>
      </caption>
      <graphic xlink:href="1471-2105-7-189-2"/>
    </fig>
    <fig position="float" id="F3">
      <label>Figure 3</label>
      <caption>
        <p><bold>A representation of the matrix produced by the forward algorithm modified to incorporate some prior information</bold>. We have a (hypothetical) model, which consists of 12 states, with 3 labels I, M, O corresponding respectively to states modelling the intracellular, transmembrane and extracellular parts of the sequence. The likelihood of sequence <bold>x </bold>(8 residues), is calculated incorporating the prior information that residues 3 and 4 are transmembrane, residue 1 is extracellular and residue 8 is intracellular.</p>
      </caption>
      <graphic xlink:href="1471-2105-7-189-3"/>
    </fig>
    <fig position="float" id="F4">
      <label>Figure 4</label>
      <caption>
        <p><bold>A schematic representation of the model's architecture</bold>. The model consists of three sub-models denoted by the labels: Cytoplasmic loop, Transmembrane Helix and Extracellular loop. Within each sub-model, states with the same shape, size and colour are sharing the same emission probabilities (parameter tying). Allowed transitions are indicated with arrows.</p>
      </caption>
      <graphic xlink:href="1471-2105-7-189-4"/>
    </fig>
    <table-wrap position="float" id="T1">
      <label>Table 1</label>
      <caption>
        <p>Results obtained from the various predictors, on a dataset of 72 transmembrane proteins [38]. Results obtained when the methods were not trained and tested on the same dataset, however some of the proteins in the dataset were present in the datasets used for training the other methods. The results of HMM-TM were obtained through a nine-fold cross validation procedure. The methods that allow the incorporation of experimental information are listed separately. The results of UMDHMM<sup>TMHP </sup>could not be obtained by cross-validation (since it was trained on the same dataset), and thus are listed separately in the text</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="left">
              <bold>Method</bold>
            </td>
            <td align="center">
              <bold>Q</bold>
            </td>
            <td align="center">
              <bold>C</bold>
            </td>
            <td align="center">
              <bold>SOV</bold>
            </td>
            <td align="center">
              <bold>Correctly predicted TM segments (%)</bold>
            </td>
            <td align="center">
              <bold>Correctly predicted Topologies (%)</bold>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">
              <bold>
                <italic>Methods that allow the incorporation of experimental information</italic>
              </bold>
            </td>
            <td/>
            <td/>
            <td/>
            <td/>
            <td/>
          </tr>
          <tr>
            <td align="left">
              <bold>HMM-TM (cross-validation)</bold>
            </td>
            <td align="center">
              <bold>0.903</bold>
            </td>
            <td align="center">
              <bold>0.762</bold>
            </td>
            <td align="center">
              <bold>0.939</bold>
            </td>
            <td align="center">
              <bold>59/72 (81.9%)</bold>
            </td>
            <td align="center">
              <bold>55/72 (76.4%)</bold>
            </td>
          </tr>
          <tr>
            <td align="left">TMHMM</td>
            <td align="center">0.902</td>
            <td align="center">0.762</td>
            <td align="center">0.931</td>
            <td align="center">58/72 (80.6%)</td>
            <td align="center">49/72 (68.1%)</td>
          </tr>
          <tr>
            <td align="left">HMMTOP</td>
            <td align="center">0.890</td>
            <td align="center">0.735</td>
            <td align="center">0.932</td>
            <td align="center">58/72 (80.6%)</td>
            <td align="center">49/72 (68.1%)</td>
          </tr>
          <tr>
            <td align="left">Phobius †</td>
            <td align="center">0.911</td>
            <td align="center">0.785</td>
            <td align="center">0.954</td>
            <td align="center">65/72 (90.3%)</td>
            <td align="center">52/72 (72.2%)</td>
          </tr>
          <tr>
            <td align="left">
              <bold>
                <italic>Methods that do not allow the incorporation of experimental information</italic>
              </bold>
            </td>
            <td/>
            <td/>
            <td/>
            <td/>
            <td/>
          </tr>
          <tr>
            <td align="left">MEMSAT</td>
            <td align="center">0.905</td>
            <td align="center">0.767</td>
            <td align="center">0.954</td>
            <td align="center">63/72 (87.5%)</td>
            <td align="center">48/72 (66.7%)</td>
          </tr>
          <tr>
            <td align="left">S-TMHMM †</td>
            <td align="center">0.897</td>
            <td align="center">0.747</td>
            <td align="center">0.925</td>
            <td align="center">59/72 (81.9%)</td>
            <td align="center">52/72 (72.2%)</td>
          </tr>
          <tr>
            <td align="left">PRO-TMHMM* †</td>
            <td align="center">0.910</td>
            <td align="center">0.779</td>
            <td align="center">0.945</td>
            <td align="center">65/72 (90.3%)</td>
            <td align="center">63/72 (87.5%)</td>
          </tr>
          <tr>
            <td align="left">PRODIV-TMHMM* †</td>
            <td align="center">0.914</td>
            <td align="center">0.794</td>
            <td align="center">0.970</td>
            <td align="center">67/72 (93.1%)</td>
            <td align="center">64/72 (87.5%)</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p>* The methods using evolutionary information are denoted with an asterisk.</p>
        <p>† These predictors were trained on sets containing sequences similar to the ones included in the training set we used here</p>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap position="float" id="T2">
      <label>Table 2</label>
      <caption>
        <p>Results of the independent test on a dataset of 26 transmembrane proteins with known three-dimensional structures. The proteins were chosen not to have significant sequence identity (&lt;30%) with the proteins used to train the methods: HMM-TM, UMDHMM<sup>TMHP</sup>, TMHMM and HMMTOP. The methods that allow the incorporation of experimental information are listed separately</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="center">
              <bold>Method</bold>
            </td>
            <td align="center">
              <bold>Q</bold>
            </td>
            <td align="center">
              <bold>C</bold>
            </td>
            <td align="center">
              <bold>SOV</bold>
            </td>
            <td align="center">
              <bold>Correctly predicted TM segments (%)</bold>
            </td>
            <td align="center">
              <bold>Correctly predicted Topologies (%)</bold>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left">
              <bold>Methods that allow the incorporation of experimental information</bold>
            </td>
            <td/>
            <td/>
            <td/>
            <td/>
            <td/>
          </tr>
          <tr>
            <td align="left">
              <bold>HMM-TM</bold>
            </td>
            <td align="center">
              <bold>0.899</bold>
            </td>
            <td align="center">
              <bold>0.780</bold>
            </td>
            <td align="center">
              <bold>0.942</bold>
            </td>
            <td align="center">
              <bold>21/26 (80.77%)</bold>
            </td>
            <td align="center">
              <bold>21/26 (80.77%)</bold>
            </td>
          </tr>
          <tr>
            <td align="left">TMHMM</td>
            <td align="center">0.899</td>
            <td align="center">0.782</td>
            <td align="center">0.956</td>
            <td align="center">19/26 (73.08%)</td>
            <td align="center">17/26 (65.38%)</td>
          </tr>
          <tr>
            <td align="left">HMMTOP</td>
            <td align="center">0.881</td>
            <td align="center">0.744</td>
            <td align="center">0.925</td>
            <td align="center">19/26 (73.08%)</td>
            <td align="center">18/26 (69.23%)</td>
          </tr>
          <tr>
            <td align="left">Phobius †</td>
            <td align="center">0.894</td>
            <td align="center">0.773</td>
            <td align="center">0.907</td>
            <td align="center">15/26 (57.69%)</td>
            <td align="center">13/26 (50%)</td>
          </tr>
          <tr>
            <td align="left">
              <bold>Methods that do not allow the incorporation of experimental information</bold>
            </td>
            <td/>
            <td/>
            <td/>
            <td/>
            <td/>
          </tr>
          <tr>
            <td align="left">MEMSAT</td>
            <td align="center">0.890</td>
            <td align="center">0.762</td>
            <td align="center">0.928</td>
            <td align="center">16/26 (61.54%)</td>
            <td align="center">13/26 (50%)</td>
          </tr>
          <tr>
            <td align="left">UMDHMM<sup>TMHP</sup></td>
            <td align="center">0.896</td>
            <td align="center">0.777</td>
            <td align="center">0.947</td>
            <td align="center">23/26 (88.46%)</td>
            <td align="center">22/26 (84.61%)</td>
          </tr>
          <tr>
            <td align="left">S-TMHMM †</td>
            <td align="center">0.899</td>
            <td align="center">0.781</td>
            <td align="center">0.957</td>
            <td align="center">21/26 (80.77%)</td>
            <td align="center">20/26 (76.92%)</td>
          </tr>
          <tr>
            <td align="left">PRO-TMHMM*†</td>
            <td align="center">0.870</td>
            <td align="center">0.718</td>
            <td align="center">0.916</td>
            <td align="center">16/26 (61.54%)</td>
            <td align="center">15/26 (57.69%)</td>
          </tr>
          <tr>
            <td align="left">PRODIV-TMHMM*†</td>
            <td align="center">0.897</td>
            <td align="center">0.778</td>
            <td align="center">0.946</td>
            <td align="center">19/26 (73.08%)</td>
            <td align="center">19/26 (73.08%)</td>
          </tr>
        </tbody>
      </table>
      <table-wrap-foot>
        <p>* The methods using evolutionary information are denoted with an asterisk.</p>
        <p>† These predictors were trained on sets containing sequences similar to the ones included in the test set.</p>
      </table-wrap-foot>
    </table-wrap>
    <table-wrap position="float" id="T3">
      <label>Table 3</label>
      <caption>
        <p>The independent test set of 26 transmembrane proteins with known three-dimensional structures. We list the PDB code, the name of the protein and the number of the transmembrane segments</p>
      </caption>
      <table frame="hsides" rules="groups">
        <thead>
          <tr>
            <td align="left">
              <bold>PDB code</bold>
            </td>
            <td align="left">
              <bold>Name</bold>
            </td>
            <td align="center">
              <bold>Number of transmembrane segments</bold>
            </td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1RC2">1RC2</ext-link>:B</td>
            <td align="left">AQUAPORIN Z</td>
            <td align="center">6</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1J4N">1J4N</ext-link>:A</td>
            <td align="left">AQUAPORIN 1</td>
            <td align="center">6</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1IWG">1IWG</ext-link>:A</td>
            <td align="left">MULTIDRUG EFFLUX TRANSPORTER ACRB</td>
            <td align="center">12</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1NEK">1NEK</ext-link>:C</td>
            <td align="left">SUCCINATE DEHYDROGENASE CYTOCHROME B-556 SUBUNIT</td>
            <td align="center">3</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1NEK">1NEK</ext-link>:D</td>
            <td align="left">SUCCINATE_DEHYDROGENASE HYDROPHOBIC MEMBRANE ANCHOR PROTEIN</td>
            <td align="center">3</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1Q16">1Q16</ext-link>:C</td>
            <td align="left">RESPIRATORY NITRATE REDUCTASE 1 GAMMA CHAIN</td>
            <td align="center">5</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1RH5">1RH5</ext-link>:B</td>
            <td align="left">PREPROTEIN TRANSLOCASE SECE SUBUNIT</td>
            <td align="center">1</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1RH5">1RH5</ext-link>:C</td>
            <td align="left">PREPROTEIN TRANSLOCASE SECBETA SUBUNIT</td>
            <td align="center">1</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1IZL">1IZL</ext-link>:A</td>
            <td align="left">PHOTOSYSTEM II SUBUNIT PSBA</td>
            <td align="center">5</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1IZL">1IZL</ext-link>:C</td>
            <td align="left">PHOTOSYSTEM II SUBUNIT PSBC</td>
            <td align="center">5</td>
          </tr>
          <tr>
            <td align="left">
              <ext-link ext-link-type="pdb" xlink:href="1YCE">1YCE</ext-link>
            </td>
            <td align="left">ROTOR OF F-TYPE NA+-ATPASE</td>
            <td align="center">2</td>
          </tr>
          <tr>
            <td align="left">
              <ext-link ext-link-type="pdb" xlink:href="2BL2">2BL2</ext-link>
            </td>
            <td align="left">ROTOR OF V-TYPE NA+-ATPASE</td>
            <td align="center">4</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1XQF">1XQF</ext-link>:A</td>
            <td align="left">PROBABLE AMMONIUM TRANSPORTER</td>
            <td align="center">11</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1KPL">1KPL</ext-link>:A</td>
            <td align="left">H+/CL- EXCHANGE TRANSPORTER</td>
            <td align="center">14</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1S5L">1S5L</ext-link>:B</td>
            <td align="left">PHOTOSYSTEM II CORE LIGHT HARVESTING PROTEIN</td>
            <td align="center">6</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1S5L">1S5L</ext-link>:C</td>
            <td align="left">PHOTOSYSTEM II CP43 PROTEIN</td>
            <td align="center">6</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1S5L">1S5L</ext-link>:D</td>
            <td align="left">PHOTOSYSTEM II REACTION CENTER D2 PROTEIN</td>
            <td align="center">5</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1S5L">1S5L</ext-link>:E</td>
            <td align="left">CYTOCHROME B559 ALPHA SUBUNIT</td>
            <td align="center">1</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1FX8">1FX8</ext-link>:A</td>
            <td align="left">GLPF GLYCEROL FACILITATOR CHANNEL</td>
            <td align="center">6</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1LNQ">1LNQ</ext-link>:A</td>
            <td align="left">MTHK POTTASIUM CHANNEL, CA-GATED</td>
            <td align="center">2</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1MXM">1MXM</ext-link>:A</td>
            <td align="left">MECHANOSENSITIVE CHANNEL PROTEIN</td>
            <td align="center">3</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1Q90">1Q90</ext-link>:M</td>
            <td align="left">CYTOCHROME B6F COMPLEX SUBUNIT PETM</td>
            <td align="center">1</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1VF5">1VF5</ext-link>:C</td>
            <td align="left">CYTOCHROME F</td>
            <td align="center">1</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1K4C">1K4C</ext-link>:C</td>
            <td align="left">POTASSIUM CHANNEL KCSA</td>
            <td align="center">2</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="1ZCD">1ZCD</ext-link>:A</td>
            <td align="left">NA(+)/H(+) ANTIPORTER 1</td>
            <td align="center">12</td>
          </tr>
          <tr>
            <td align="left"><ext-link ext-link-type="pdb" xlink:href="2A79">2A79</ext-link>:B</td>
            <td align="left">POTASSIUM VOLTAGE-GATED CHANNEL SUBFAMILY A MEMBER 2</td>
            <td align="center">6</td>
          </tr>
        </tbody>
      </table>
    </table-wrap>
  </sec>
</back>
