<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-id journal-id-type="hwp">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3384350</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gks241</article-id>
    <article-id pub-id-type="publisher-id">gks241</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>R-<sc>chie</sc>: a web server and R package for visualizing RNA secondary structures</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Lai</surname>
          <given-names>Daniel</given-names>
        </name>
        <xref ref-type="aff" rid="gks241-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gks241-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Proctor</surname>
          <given-names>Jeff R.</given-names>
        </name>
        <xref ref-type="aff" rid="gks241-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gks241-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Jing Yun A.</given-names>
        </name>
        <xref ref-type="aff" rid="gks241-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gks241-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meyer</surname>
          <given-names>Irmtraud M.</given-names>
        </name>
        <xref ref-type="aff" rid="gks241-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="gks241-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="gks241-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="gks241-AFF1"><sup>1</sup>Department of Computer Science and <sup>2</sup>Department of Medical Genetics, Centre for High-Throughput Biology, University of British Columbia, Vancouver V6T 1Z4, Canada</aff>
    <author-notes>
      <corresp id="gks241-COR1">*To whom correspondence should be addressed. Tel: <phone>+21 604 827 4232</phone>; Fax: <fax>+21 604 822 5485</fax>; Email: <email>irmtraud.meyer@cantab.net</email></corresp>
    </author-notes>
    <!--For NAR both ppub and collection dates generated for PMC processing 1/27/05 beck-->
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>19</day>
      <month>3</month>
      <year>2012</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>19</day>
      <month>3</month>
      <year>2012</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>40</volume>
    <issue>12</issue>
    <fpage>e95</fpage>
    <lpage>e95</lpage>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>12</month>
        <year>2011</year>
      </date>
      <date date-type="rev-recd">
        <day>15</day>
        <month>2</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>1</day>
        <month>3</month>
        <year>2012</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2012. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2012</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0">http://creativecommons.org/licenses/by-nc/3.0</ext-link>), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Visually examining RNA structures can greatly aid in understanding their potential functional roles and in evaluating the performance of structure prediction algorithms. As many functional roles of RNA structures can already be studied given the secondary structure of the RNA, various methods have been devised for visualizing RNA secondary structures. Most of these methods depict a given RNA secondary structure as a planar graph consisting of base-paired stems interconnected by roundish loops. In this article, we present an alternative method of depicting RNA secondary structure as arc diagrams. This is well suited for structures that are difficult or impossible to represent as planar stem-loop diagrams. Arc diagrams can intuitively display pseudo-knotted structures, as well as transient and alternative structural features. In addition, they facilitate the comparison of known and predicted RNA secondary structures. An added benefit is that structure information can be displayed in conjunction with a corresponding multiple sequence alignments, thereby highlighting structure and primary sequence conservation and variation. We have implemented the visualization algorithm as a web server R-<sc>chie</sc> as well as a corresponding R package called R4RNA, which allows users to run the software locally and across a range of common operating systems.</p>
    </abstract>
    <counts>
      <page-count count="6"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>INTRODUCTION</title>
    <p>The tertiary or three-dimensional structure of many RNAs plays a key role in defining the biological function of the molecule. Both <italic>in vivo</italic> and <italic>in silico</italic>, the proper formation of tertiary structure depends on the correct secondary structure, i.e. the pairs of nucleotide positions in the RNA sequence that form complementary base pairs. For both experimentally and computationally derived RNA secondary structures, diagrammatic visualization has been key to evaluating and gleaning biological insight, thereby prompting the development of new computational methods for RNA secondary structure visualization.</p>
    <p>A handful of computationally generated representations of RNA secondary structures exist, the most prominent being the planar format which consists of base pairs stems and unpaired loops (<xref ref-type="bibr" rid="gks241-B1">1</xref>). One is the circular version where the sequence is drawn as a circle and base pairs as chords (<xref ref-type="bibr" rid="gks241-B2">2</xref>). Another one is the linear version of the circle that shows the sequence as horizontal line and the base pairs as arcs, i.e. semicircles connecting the two respective base-pairing positions in the sequence. Other formats include energy dot plots (<xref ref-type="bibr" rid="gks241-B3">3</xref>) which are coloured, square base-pairing matrices (<xref ref-type="bibr" rid="gks241-B4">4</xref>), the dot-bracket or Vienna format (<xref ref-type="bibr" rid="gks241-B5">5</xref>) and the closely related mountain plot figures (<xref ref-type="bibr" rid="gks241-B6">6</xref>). Finally, trees (<xref ref-type="bibr" rid="gks241-B7">7</xref>) and graphs (<xref ref-type="bibr" rid="gks241-B8">8</xref>) in the strict mathematical sense have also been used to display the topology of RNA secondary structures.</p>
    <p>For any experimentally determined or theoretically predicted RNA structure, a critical method of evaluation is to analyze the degree of structure conservation between homologous sequences (<xref ref-type="bibr" rid="gks241-B9">9</xref>). Strong evidence for RNA structure conservation are so-called pairs of compensatory mutations that retain the base-pairing ability, but change the base-pairing nucleotides (co-variation). A quick method of visually surveying the quality of a given multiple sequence alignment and a corresponding secondary structure prediction is to highlight co-varying pairs of alignment columns (<xref ref-type="bibr" rid="gks241-B10">10</xref>).</p>
    <p>During the development and evaluation of our comparative helix prediction method T<sc>ransat</sc> (<xref ref-type="bibr" rid="gks241-B11">11</xref>), we had to develop a new method for RNA secondary structure visualization that was able to show (i) conflicting base pairs (i.e. base pairs involving the same sequence position), (ii) the degree of helix conservation and corresponding co-variation within the multiple sequence alignment and (iii) allows the comparison of two different structures simultaneously (e.g. from different sources). We also wanted the figures to be (iv) visually pleasing and intuitive to grasp. Our requirement to visualize conflicting base pairs rules out all formats except circle, linear and dot plots. Finally, the additional need to simultaneously show several structures in conjunction with a corresponding multiple sequence alignment, led us to choose a linear format.</p>
    <p>While various powerful visualization programs already exist, only a few actively supported tools visualize RNA secondary structure in a linear fashion (<xref ref-type="bibr" rid="gks241-B12">12</xref>,<xref ref-type="bibr" rid="gks241-B13">13</xref>). These tools, however, lacked the features that we required, as they were not designed to handle conflicting base pairs nor display multiple sequence alignments simultaneously with a structure. Finally, the need to create such diagrams in a high-throughput and scripted manner, rather than restricted by a graphical user interface, made their adoption and modification difficult (<xref ref-type="bibr" rid="gks241-B12">12</xref>,<xref ref-type="bibr" rid="gks241-B13">13</xref>).</p>
    <p>In the following, we present a highly modified and new method employing a linear format that we call ‘arc diagrams’ (<xref ref-type="bibr" rid="gks241-B14">14</xref>) to fulfill our above requirements (i–iv). In addition, we provide a web server R-<sc>chie</sc> that accepts four common secondary structure formats and secondary structure for the quick visualization of data with our method to generate publication quality figures. For further customization and local use, we also make a corresponding R package (<xref ref-type="bibr" rid="gks241-B15">15</xref>) called R4RNA available that leverages the graphical and computational framework of the interactive and easily scriptable language.</p>
  </sec>
  <sec sec-type="materials|methods">
    <title>MATERIALS AND METHODS</title>
    <sec>
      <title>The R-<sc>chie</sc> web server</title>
      <p>Located at <ext-link ext-link-type="uri" xlink:href="http://www.e-rna.org/r-chie/">http://www.e-rna.org/r-chie/</ext-link>, the R-<sc>chie</sc> web server provides a simple interface for generating six different types of arc diagrams instantaneously with instructions and examples, accessible by all major browsers. Descriptions and usage of the six different types of diagrams are as follows:</p>
      <sec>
        <title>Single structure</title>
        <p>This is the most basic type of arc diagram, essentially identical to the typical linear diagrams observed in other publications, with the exception of much more powerful graphical options. This arc diagram shows the RNA sequence of interest drawn as a horizontal line from 5′ to 3′, left to right, with ‘arcs’, drawn above the horizontal line. Each arc depicts a base pair of the RNA structure and connects the respective sequence positions involved in that base pair.</p>
        <p>For predicted structures, it is not uncommon for individual structural features such as helices or base pairs to be assigned individual scores such as energetic contributions (<xref ref-type="bibr" rid="gks241-B16">16</xref>) or statistical significance (<xref ref-type="bibr" rid="gks241-B11">11</xref>). In order to retain and visualize this valuable information, our method can assign different colours to individual arcs according to their corresponding scores, using palettes obtained from ColorBrewer (<xref ref-type="bibr" rid="gks241-B17">17</xref>), or those specified by the user. Alternatively, colouring arcs can also be done manually and independently of value, e.g. when certain base pairs or structure features such as pseudoknots are to be especially highlighted. In addition, base pairs can also be filtered by their scores and a lower or upper threshold value can be imposed.</p>
      </sec>
      <sec>
        <title>Double structure</title>
        <p>A double structure arc diagram is obtained by starting with a single structure diagram, and drawing a second structure below the horizontal sequence line. Any colouring and filtering options can be applied to the top and the bottom structure jointly or separately (<xref ref-type="fig" rid="gks241-F1">Figure 1</xref>).
<fig id="gks241-F1" position="float"><label>Figure 1.</label><caption><p>An example of a ‘double structure arc diagram’, showing the Cripavirus Internal Ribosomal Entry Site [family RF00458 from the R<sc>fam</sc> database (<xref ref-type="bibr" rid="gks241-B20">20</xref>)]. The RNA secondary structure shown above the horizontal sequence line has been predicted by T<sc>ransat</sc> (<xref ref-type="bibr" rid="gks241-B11">11</xref>). Every arc corresponds to one base pair whose colour indicates its <italic>P</italic>-value, where dark blue is ≤1e-06, light blue is ≤1e-05, orange is ≤1e-04 and red is ≤1e-03 (<italic>P</italic>-value threshold). The RNA structure shown below the horizontal sequence line shows the consensus RNA structure from R<sc>fam</sc>.</p></caption><graphic xlink:href="gks241f1"/></fig></p>
        <p>This type of arc diagram is especially useful when comparing two—perhaps radically different—alternative structures for the same sequence. It is also useful for comparing two similar structures, e.g. derived from two different structure prediction methods or comparing a predicted to an experimentally validated structure.</p>
      </sec>
      <sec>
        <title>Overlapping structure</title>
        <p>The type of figures seen in the T<sc>ransat</sc> paper (<xref ref-type="bibr" rid="gks241-B11">11</xref>) allow to quickly and entirely visually evaluate the performance of a structure prediction method by comparing the predicted to the known structure. In order to do this best, we aim to simultaneously visualize the sensitivity and the positive predictive value, i.e. specificity, of the prediction method (<xref ref-type="fig" rid="gks241-F2">Figure 2</xref>).
<fig id="gks241-F2" position="float"><label>Figure 2.</label><caption><p>An example of a ‘overlapping structure arc diagram’, overlapping the T<sc>ransat</sc> predicted structure and the R<sc>fam</sc> consensus structure of family RF00458 presented in <xref ref-type="fig" rid="gks241-F1">Figure 1</xref>. The structure shown above the horizontal sequence is the known structure in black, coloured by <italic>P</italic>-value if correctly predicted by T<sc>ransat</sc> (best in blue and worst in red, see <xref ref-type="fig" rid="gks241-F1">Figure 1</xref> for exact <italic>P</italic>-value colours). The arcs below the line represent novel base pairs predicted by T<sc>ransat</sc> not found in the known R<sc>fam</sc> structure. Such a diagram can give} a qualitative description of a predicted structure's performance, where high <italic>sensitivity</italic> would result in a high proportion of top helices being coloured, and high specificity would result in a majority of helices above the line. On the other hand, the novel base pairs observed on the bottom half, may indicate alternative structural elements not yet experimentally verified, but worth investigating, especially in light of strong evolutionary evidence (<xref ref-type="fig" rid="gks241-F3">Figure 3</xref>).</p></caption><graphic xlink:href="gks241f2"/></fig></p>
        <p>Similar to the double structure plot, arcs are seen both above and below the horizontal sequence line. Instead of showing all arcs corresponding to one structure above the horizontal line and all arcs corresponding to the other structure below, however, the first is interpreted as a ‘predicted’ structure, the second as reference i.e. ‘known’ structure, and the two structures are overlapped. For this, the algorithm identifies all predicted base pairs that overlap with those of the known structure (i.e. a ‘true positive’ in the performance evaluation), and draws corresponding arcs above the line, coloured by the score of the base pair in the predicted structure. Any predicted base pair that is not part of the known structure (i.e. a ‘false positive’) is drawn below the sequence line, also coloured by its score. Any known base pair that was not predicted (i.e. a ‘false negative’) is drawn above the sequence line in black. Base pairs that are neither part of the known nor the predicted structure (i.e. ‘false negatives’) are not shown at all.</p>
        <p>With a single glance, this type of diagram shows both the sensitivity and specificity of the structure prediction and readily highlights new base pairs that are not part of the known structure and may warrant further investigation.</p>
        <p>Creating two overlapping structures from predictions of two different algorithms against the same known structure and juxtaposing the resulting diagrams is also an interesting method of comparing and highlighting the differences, as was done extensively in the T<sc>ransat</sc> paper (<xref ref-type="bibr" rid="gks241-B11">11</xref>).</p>
      </sec>
      <sec>
        <title>Single structure co-variation</title>
        <p>Adding a multiple sequence alignment beneath a single structure arc diagram provides a powerful means of displaying both the secondary structure and corresponding evidence for base pair conservation and co-variation. As the state of art in RNA secondary structure prediction in terms of prediction performance is currently provided by comparative methods that typically take a fixed alignment as input, this type of arc diagram is especially useful for evaluating both structures given an alignment and <italic>vice versa</italic>.</p>
        <p>For this type of arc diagram, the arcs are drawn on top of the sequence line as usual while the multiple sequence alignment is shown below as a block of parallel black lines, each representing one sequence of nucleotides (with gray for gaps) from the multiple sequence alignment. Two alignment columns at the base of a single arc represent the two columns of base-pairing nucleotides. The corresponding nucleotides are shown in green or blue if they represent a valid canonical base pair, and red if they are not. The most frequent base pairs are coloured in green. Blue indicates a compensatory mutation relative to the green pairs (dark blue for a double-sided mutation, light blue for a single-sided mutation). This style of colouring is similar to existing programs (<xref ref-type="bibr" rid="gks241-B10">10</xref>,<xref ref-type="bibr" rid="gks241-B18">18</xref>,<xref ref-type="bibr" rid="gks241-B19">19</xref>). In the case where different types of base pairs occurs at the same frequency, green is assigned to the base pair more commonly observed according to Structure Statistics from the Comparative RNA Web Site (<xref ref-type="bibr" rid="gks241-B21">21</xref>).</p>
        <p>Given a structure and a corresponding multiple sequence alignment, the web server automatically applies this colouring, allowing for a quick evaluation of how well (or poorly) the different structural features are supported by co-variation and gap patterns.</p>
        <p>Given two different ways of aligning the same set of sequences, two arc diagrams of this type can also be used to highlight the effect that the alignment quality has on the corresponding structure prediction.</p>
        <p>One small caveat is the technical inability of the co-variation colouring to be displayed simultaneously for conflicting helices. When faced with conflicting helices, our algorithm makes a greedy decision to select and colour the first helix that it observes in the input. A user can therefore simply rank conflicting helices or base pairs in the input file to ensure that the most dominant features are being coloured.</p>
        <p>Additional web server appearance options that users may adjust include displaying sequences as blocks instead of lines, including the nucleotide base on the block, and including the sequence descriptions left of each sequence. The specific colours used to highlight base pairs in the multiple sequence alignment can also be customized, and one may even completely ignore base pairs and colour the alignment based on nucleotides.</p>
        <p>While the structure conservation for one base pair can be summarized in a single numerical value as done for some figures in the R<sc>fam</sc> database (<xref ref-type="bibr" rid="gks241-B20">20</xref>), a coloured multiple sequence alignment as in these arc diagrams retains more detailed information. If desired however, we offer the ability to colour arcs according to structure conservation, co-variation and percent canonical base pair.</p>
      </sec>
      <sec>
        <title>Double structure co-variation</title>
        <p>Two multiple sequence alignment blocks, one for each structure, are inserted between the top and bottom arcs of a double arc diagram, highlighting the conservation and co-variation for each structure.</p>
        <p>An embellishment of the double structure arc diagram, the double structure co-variation diagrams show not only the differences between two structures, but also allow the evaluation of the different base pairs in light of evolutionary evidence. The input multiple sequence alignment is duplicated into two identical blocks. The top alignment and its co-variation annotation refer to the top RNA structure and the bottom alignment to the bottom RNA structure.</p>
      </sec>
      <sec>
        <title>Overlapping structure co-variation</title>
        <p>A natural extension of the arc diagrams mentioned so far is to combine overlapping structure arc diagrams with co-variation plots. These are similar to double structure co-variation plots, but are drawn according to the same rules as overlapping structure arc plots (<xref ref-type="fig" rid="gks241-F3">Figure 3</xref>).
<fig id="gks241-F3" position="float"><label>Figure 3.</label><caption><p>An example of an ‘overlapping covariance arc diagram’, of the T<sc>ransat</sc> predicted structure, overlapping the R<sc>fam</sc> consensus structure of family RF00458 (see <xref ref-type="fig" rid="gks241-F2">Figure 2</xref> for a detailed explanation of the known top and novel bottom arcs). The colouring of arcs indicates their <italic>P</italic>-value (detailed in <xref ref-type="fig" rid="gks241-F1">Figure 1</xref>) from best (blue) to worst (red) and gray for conflicting base pairs. Between the arcs are two covariance blocks representing the same seven sequences in a gapped multiple sequence alignment from R<sc>fam</sc>. Unpaired nucleotides are in black and gaps are in gray. For columns at the ends of a single non-conflicting arc, bases are assigned green if they are valid base pairs (G:C, A:U, G:U and the reversed pairings), or else they are red. For the green valid base pairs, if the base pair varies from the most commonly observed base pair in the column, then it is coloured blue to signify <italic>co-variation</italic>, or compensatory mutations to retain the base-pairing potential of the positions (dark blue for two sided, and light blue for one sided). The colouring of base pairs for arcs gives a qualitative representation of how well the base pair is conserved, and can be used to infer the validity of predicted base pairs, or the quality of an alignment given a known structure. For example, while most of the novel base pairs predicted to exist are simply extensions or slight shifts of known helices, the three largest red helices in the bottom show very high sequence conservation.</p></caption><graphic xlink:href="gks241f3"/></fig></p>
        <p>This type of diagram is of great use when evaluating new helices (drawn below the sequence line in overlapping structure arc plots) by providing evolutionary evidence (or lack of) for their existence. The same rules to resolving conflicting helices exist as outlined above for single structure co-variation plots, as do the rules for ensuring consist co-variation plot colours.</p>
      </sec>
    </sec>
    <sec>
      <title>Input</title>
      <p>There are two main types of text inputs to the web server; those specifying secondary structures and those specifying multiple sequence alignments.</p>
      <p>For RNA secondary structure and to cater for the wider RNA community, our method accepts most common output formats: dot bracket or Vienna format (<xref ref-type="bibr" rid="gks241-B22">22</xref>), M<sc>fold</sc>'s connect format (<xref ref-type="bibr" rid="gks241-B23">23</xref>) and Gutell's bpseq format (<xref ref-type="bibr" rid="gks241-B21">21</xref>). Additionally, we also accept a variant of Shapiro's original region table (<xref ref-type="bibr" rid="gks241-B1">1</xref>) that we refer to as the ‘helix format’. This describes each helix as one line which contains the following fields: start position of outer base pair, end position of outer base pair, helix length (in terms of number of base pairs), helix score. Differing from Shapiro's definition, we add a header line which includes the length of the sequence, along with any other comments one may want to retain, e.g. the primary sequence. This helix format provides an extremely compact means of representing complex RNA structures, and also allows for unambiguous specification of conflicting, pseudo-knotted and overlapping base pairs.</p>
      <p>For multiple sequence alignment, our program accepts standard FASTA format (<xref ref-type="bibr" rid="gks241-B24">24</xref>).</p>
      <p>To control the appearance of the resulting figure showing the desired type of arc diagram, a standard options panel is available to automate and fine-tune colouring and filtering of base pairs on the fly.</p>
    </sec>
    <sec>
      <title>Output</title>
      <p>After generating the figure, which typically takes on the order of seconds, a static web page rendering the figure is displayed from which the figure can be downloaded as .png or .pdf format.</p>
    </sec>
    <sec>
      <title>The R4RNA R package</title>
      <p>The plotting functionality of the web server is driven by an R script built on top of an R package called R4RNA which we make available for offline and local use and which can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.e-rna.org/r-chie/">http://www.e-rna.org/r-chie/</ext-link> release for public use under the GPLv3 license.</p>
      <p>Written in R (<xref ref-type="bibr" rid="gks241-B15">15</xref>) (which is freely downloadable at <ext-link ext-link-type="uri" xlink:href="http://www.r-project.org/">http://www.r-project.org/</ext-link> for all major operating systems), the package is capable of producing the same plots as the server with a few interactive function calls, and allows for even more fine-tune control, automation, and customized diagrams, and output formats. This is especially convenient for Bioinformatics research groups that can call functions of our R package within existing programs and analysis pipelines. Our software is well documented and includes a comprehensive manual and instructional vignettes as well as examples.</p>
    </sec>
  </sec>
  <sec>
    <title>RESULTS AND DISCUSSION</title>
    <p>We here present a new computational method for visualizing RNA secondary structures in conjunction with corresponding multiple sequence alignments which can either be used via a web server R-<sc>chie</sc> or offline and locally via a corresponding R package called R4RNA. Our method readily creates six different types of arc diagrams which cover numerous useful applications. These range from visualizing the evolutionary evidence for a given RNA secondary structure to comparisons of two RNA secondary structure and performance evaluations of RNA structure prediction methods. The key feature of all six types of arc diagrams is that details that are typically lost in a numerical evaluation are highlighted and can be visually interpreted in a straightforward and intuitive way.</p>
    <p>Our method makes several major improvements with respect to existing methods that depict RNA secondary structures in a linear way. These include the colouring of structural features according to their score (e.g. free energy, <italic>P</italic>-value, log-likelihood), the joint display of an RNA structure with a corresponding multiple sequence alignment which highlights the evolutionary patterns that support the different structural features, and comparison plots which allow the quick visual inspection of sensitivity and specificity of a predicted structure with respect to a reference structure. In addition, all types of arc plots can display structural features that are mutually exclusive or would render the overall RNA structure pseudo knotted.</p>
    <p>Our R-<sc>chie</sc> web server and the corresponding R4RNA R package can be freely accessed and downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.e-rna.org/r-chie/">http://www.e-rna.org/r-chie/</ext-link>. In addition to several examples, we have also generated single structure co-variation arc diagrams of all seed alignments in the R<sc>fam</sc> database (<xref ref-type="bibr" rid="gks241-B20">20</xref>) which can be downloaded from our web page.</p>
  </sec>
  <sec>
    <title>FUTURE DIRECTIONS</title>
    <p>We intend to add additional features to the R4RNA R package in the future which will likely include functions related to RNA structural Bioinformatics analysis beyond RNA structure visualization. We also welcome suggestions for improvements on the R-<sc>chie</sc> web server or the R4RNA R package from the research community. Finally, to ensure long-term support and development of the package for RNA analysis, we aim to officially submit the R4RNA package to the B<sc>ioconductor</sc> repository (<xref ref-type="bibr" rid="gks241-B25">25</xref>) once the package is sufficiently developed.</p>
  </sec>
  <sec>
    <title>FUNDING</title>
    <p><funding-source>Canadian Institutes of Health Research/Michael Smith Foundation for Health Research Strategic Training Program in Bioinformatics at the University of British Columbia</funding-source>; <funding-source>Natural Sciences and Engineering Research Council of Canada (NSERC) Alexander Graham Bell Canada Graduate Scholarships</funding-source> (to D.L. and J.R.P.); <funding-source>NSERC Undergraduate Student Research Awards Collaborative Research Experiences for Undergraduates - Canada</funding-source> (to J.Y.A.Z.); <funding-source>NSERC Discovery Grant</funding-source> (to I.M.M.). Funding for open access charge: <funding-source>NSERC Discovery Grant</funding-source> (to I.M.M.).</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENTS</title>
    <p>The authors would like to thank our former group members Nick Wiebe and Casper Shyr for designing a prototype of the visualization software in Perl and Asymptote which motivated the complete re-implementation in R and as a web server. We also thank Adi Steif from our group for testing the web server; and Dave Brent and Renee Stephen from the Department of Computer Science at the University of British Columbia for providing technical assistance with the web server.</p>
  </ack>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="gks241-B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shapiro</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Lipkin</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Maizel</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>An interactive technique for the display of nucleic acid secondary structure</article-title>
        <source>Nucleic Acids Res.</source>
        <year>1982</year>
        <volume>10</volume>
        <fpage>7041</fpage>
        <lpage>7052</lpage>
        <pub-id pub-id-type="pmid">7177857</pub-id>
      </element-citation>
    </ref>
    <ref id="gks241-B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nussinov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Pieczenik</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Griggs</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Kleitman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Algorithms for loop matchings</article-title>
        <source>SIAM J. Appl. Math.</source>
        <year>1978</year>
        <volume>35</volume>
        <fpage>68</fpage>
      </element-citation>
    </ref>
    <ref id="gks241-B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jacobson</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Zuker</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Structural analysis by energy dot plot of a large mRNA</article-title>
        <source>J. Mol. Biol.</source>
        <year>1993</year>
        <volume>233</volume>
        <fpage>261</fpage>
        <lpage>269</lpage>
        <pub-id pub-id-type="pmid">8377202</pub-id>
      </element-citation>
    </ref>
    <ref id="gks241-B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tinoco</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Uhlenbeck</surname>
            <given-names>OC</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Estimation of secondary structure in ribonucleic acids</article-title>
        <source>Nature</source>
        <year>1971</year>
        <volume>230</volume>
        <fpage>362</fpage>
        <lpage>367</lpage>
        <pub-id pub-id-type="pmid">4927725</pub-id>
      </element-citation>
    </ref>
    <ref id="gks241-B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Fontana</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Bonhoeffer</surname>
            <given-names>LS</given-names>
          </name>
          <name>
            <surname>Tacker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schuster</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Fast folding and comparison of RNA secondary structures</article-title>
        <source>Monatsh. Chem.</source>
        <year>1994</year>
        <volume>125</volume>
        <fpage>167</fpage>
        <lpage>188</lpage>
      </element-citation>
    </ref>
    <ref id="gks241-B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
        </person-group>
        <article-title>Automatic detection of conserved base pairing patterns in RNA virus genomes</article-title>
        <source>Comput. Chem.</source>
        <year>1999</year>
        <volume>23</volume>
        <fpage>401</fpage>
        <lpage>414</lpage>
        <pub-id pub-id-type="pmid">10404627</pub-id>
      </element-citation>
    </ref>
    <ref id="gks241-B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Le</surname>
            <given-names>SY</given-names>
          </name>
          <name>
            <surname>Nussinov</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Maizel</surname>
            <given-names>JV</given-names>
          </name>
        </person-group>
        <article-title>Tree graphs of RNA secondary structures and their comparisons</article-title>
        <source>Comput. Biomed. Res.</source>
        <year>1989</year>
        <volume>22</volume>
        <fpage>461</fpage>
        <lpage>473</lpage>
        <pub-id pub-id-type="pmid">2776449</pub-id>
      </element-citation>
    </ref>
    <ref id="gks241-B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gan</surname>
            <given-names>HH</given-names>
          </name>
        </person-group>
        <article-title>Exploring the repertoire of RNA secondary motifs using graph theory; implications for RNA design</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>2926</fpage>
        <lpage>2943</lpage>
        <pub-id pub-id-type="pmid">12771219</pub-id>
      </element-citation>
    </ref>
    <ref id="gks241-B9">
      <label>9</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Pace</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Woese</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Gesteland</surname>
            <given-names>RF</given-names>
          </name>
          <name>
            <surname>Cech</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Atkins</surname>
            <given-names>JF</given-names>
          </name>
        </person-group>
        <article-title>Probing RNA structure, function, and history by comparative analysis</article-title>
        <source>The RNA World</source>
        <year>1999</year>
        <edition>2nd edn</edition>
        <publisher-loc>Cold Spring Harbor, NY</publisher-loc>
        <publisher-name>Cold Spring Habor Press</publisher-name>
        <fpage>113</fpage>
        <lpage>142</lpage>
      </element-citation>
    </ref>
    <ref id="gks241-B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griffiths-Jones</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>RALEE–RNA ALignment editor in Emacs</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>257</fpage>
        <lpage>259</lpage>
        <pub-id pub-id-type="pmid">15377506</pub-id>
      </element-citation>
    </ref>
    <ref id="gks241-B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wiebe</surname>
            <given-names>NJP</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>IM</given-names>
          </name>
        </person-group>
        <article-title>TRANSAT– method for detecting the conserved helices of functional RNA structures, including transient, pseudo-knotted and alternative structures</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2010</year>
        <volume>6</volume>
        <fpage>e1000823</fpage>
        <pub-id pub-id-type="pmid">20589081</pub-id>
      </element-citation>
    </ref>
    <ref id="gks241-B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wiese</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Glen</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Vasudevan</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>jViz. Rna-A Java tool for RNA secondary structure visualization</article-title>
        <source>IEEE Trans. Nanobiosci.</source>
        <year>2005</year>
        <volume>4</volume>
        <fpage>212</fpage>
        <lpage>218</lpage>
      </element-citation>
    </ref>
    <ref id="gks241-B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Darty</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Denise</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ponty</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>VARNA: interactive drawing and editing of the RNA secondary structure</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>1974</fpage>
        <lpage>1975</lpage>
        <pub-id pub-id-type="pmid">19398448</pub-id>
      </element-citation>
    </ref>
    <ref id="gks241-B14">
      <label>14</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Wattenberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Arc diagrams: visualizing structure in strings</article-title>
        <source>Proceedings of the IEEE Symposium on Information Visualization</source>
        <year>2002</year>
        <publisher-loc>Boston, MA</publisher-loc>
        <fpage>110</fpage>
        <lpage>116</lpage>
      </element-citation>
    </ref>
    <ref id="gks241-B15">
      <label>15</label>
      <element-citation publication-type="other">
        <comment>R Development Core Team (2011) <italic>R: a Language and Environment for Statistical Computing</italic>. R Foundation for Statistical Computing, Vienna, Austria</comment>
      </element-citation>
    </ref>
    <ref id="gks241-B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zuker</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jacobson</surname>
            <given-names>AB</given-names>
          </name>
        </person-group>
        <article-title>Using reliability information to annotate RNA secondary structures</article-title>
        <source>RNA</source>
        <year>1998</year>
        <volume>4</volume>
        <fpage>669</fpage>
        <lpage>679</lpage>
        <pub-id pub-id-type="pmid">9622126</pub-id>
      </element-citation>
    </ref>
    <ref id="gks241-B17">
      <label>17</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Harrower</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Brewer</surname>
            <given-names>CA</given-names>
          </name>
        </person-group>
        <article-title>ColorBrewer.org: an online tool for selecting colour schemes for maps</article-title>
        <source>Cartogr. J.</source>
        <year>2003</year>
        <volume>40</volume>
        <fpage>27</fpage>
        <lpage>37</lpage>
      </element-citation>
    </ref>
    <ref id="gks241-B18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pedersen</surname>
            <given-names>JS</given-names>
          </name>
          <name>
            <surname>Bejerano</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Siepel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rosenbloom</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lindblad-Toh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Kent</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Haussler</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Identification and classification of conserved RNA secondary structures in the human genome</article-title>
        <source>PLoS Comput. Biol.</source>
        <year>2006</year>
        <volume>2</volume>
        <fpage>e33</fpage>
        <pub-id pub-id-type="pmid">16628248</pub-id>
      </element-citation>
    </ref>
    <ref id="gks241-B19">
      <label>19</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bendaña</surname>
            <given-names>YR</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>IH</given-names>
          </name>
        </person-group>
        <article-title>Colorstock, SScolor, Ratón: RNA alignment visualization tools</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>579</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="pmid">18218657</pub-id>
      </element-citation>
    </ref>
    <ref id="gks241-B20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griffiths-Jones</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Rfam: an RNA family database</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>439</fpage>
        <lpage>441</lpage>
        <pub-id pub-id-type="pmid">12520045</pub-id>
      </element-citation>
    </ref>
    <ref id="gks241-B21">
      <label>21</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cannone</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Subramanian</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Schnare</surname>
            <given-names>MN</given-names>
          </name>
          <name>
            <surname>Collett</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>D'Souza</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Feng</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Madabusi</surname>
            <given-names>LV</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>KM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The comparative RNA web (CRW) site: an online database of comparative sequence and structure information for ribosomal, intron, and other RNAs</article-title>
        <source>BMC Bioinf.</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>2</fpage>
      </element-citation>
    </ref>
    <ref id="gks241-B22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
        </person-group>
        <article-title>Vienna RNA secondary structure server</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>3429</fpage>
        <lpage>3431</lpage>
        <pub-id pub-id-type="pmid">12824340</pub-id>
      </element-citation>
    </ref>
    <ref id="gks241-B23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zuker</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Mfold web server for nucleic acid folding and hybridization prediction</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2003</year>
        <volume>31</volume>
        <fpage>3406</fpage>
        <lpage>3415</lpage>
        <pub-id pub-id-type="pmid">12824337</pub-id>
      </element-citation>
    </ref>
    <ref id="gks241-B24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pearson</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Improved tools for biological sequence comparison</article-title>
        <source>PNAS</source>
        <year>1988</year>
        <volume>85</volume>
        <fpage>2444</fpage>
        <lpage>2448</lpage>
        <pub-id pub-id-type="pmid">3162770</pub-id>
      </element-citation>
    </ref>
    <ref id="gks241-B25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gentleman</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Carey</surname>
            <given-names>VJ</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Bolstad</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Dettling</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ellis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Gautier</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ge</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Gentry</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>
        <source>Genome Biol.</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>R80</fpage>
        <pub-id pub-id-type="pmid">15461798</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
