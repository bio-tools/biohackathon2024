<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10166586</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbad058</article-id>
    <article-id pub-id-type="publisher-id">vbad058</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Application Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TRviz: a Python library for decomposing and visualizing tandem repeat sequences</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0001-0554</contrib-id>
        <name>
          <surname>Park</surname>
          <given-names>Jonghun</given-names>
        </name>
        <aff><institution>Department of Computer Science &amp; Engineering, University of California, San Diego</institution>, La Jolla, CA 92093, <country country="US">USA</country></aff>
        <xref rid="vbad058-cor1" ref-type="corresp"/>
        <!--jonghunpark@ucsd.edu-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kaufman</surname>
          <given-names>Eli</given-names>
        </name>
        <aff><institution>Division of Medical Genetics, University of Washington School of Medicine</institution>, Seattle, WA 98195, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8840-6969</contrib-id>
        <name>
          <surname>Valdmanis</surname>
          <given-names>Paul N</given-names>
        </name>
        <aff><institution>Division of Medical Genetics, University of Washington School of Medicine</institution>, Seattle, WA 98195, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Bafna</surname>
          <given-names>Vineet</given-names>
        </name>
        <aff><institution>Department of Computer Science &amp; Engineering, University of California, San Diego</institution>, La Jolla, CA 92093, <country country="US">USA</country></aff>
        <xref rid="vbad058-cor1" ref-type="corresp"/>
        <!--vbafna@ucsd.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Zhang</surname>
          <given-names>Zhang</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbad058-cor1">To whom correspondence should be addressed. <email>jonghunpark@ucsd.edu</email> or <email>vbafna@ucsd.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-04-26">
      <day>26</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <volume>3</volume>
    <issue>1</issue>
    <elocation-id>vbad058</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>1</month>
        <year>2023</year>
      </date>
      <date date-type="rev-recd">
        <day>14</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="editorial-decision">
        <day>21</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>4</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>08</day>
        <month>5</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbad058.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>TRviz is an open-source Python library for decomposing, encoding, aligning and visualizing tandem repeat (TR) sequences. TRviz takes a collection of alleles (TR containing sequences) and one or more motifs as input and generates a plot showing the motif composition of the TR sequences.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>TRviz is an open-source Python library and freely available at <ext-link xlink:href="https://github.com/Jong-hun-Park/trviz" ext-link-type="uri">https://github.com/Jong-hun-Park/trviz</ext-link>. Detailed documentation is available at <ext-link xlink:href="https://trviz.readthedocs.io" ext-link-type="uri">https://trviz.readthedocs.io</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIH</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>HG010149</award-id>
        <award-id>RM1HG011558</award-id>
        <award-id>R01GM114362</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Tandem repeats (TRs) are a type of DNA sequence in which a motif is repeated multiple times in a consecutive manner, with the possibility of variations among the repeating motif. A substantial portion of the human genome is comprised of TRs, which often have large motif lengths. TRs are often highly polymorphic in a population, contributing to significant genetic variation and mediating gene expression (<xref rid="vbad058-B1" ref-type="bibr">Bakhtiari <italic toggle="yes">et al.</italic>, 2021</xref>). They have also been associated with more than 50 human traits, including genetic disease (<xref rid="vbad058-B7" ref-type="bibr">Mitra <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad058-B9" ref-type="bibr">Mukamel <italic toggle="yes">et al.</italic>, 2021</xref>).</p>
    <p>Genetic variation in TRs can change the copy number of motifs (or repeat units), resulting in changed allele length. Many bioinformatics tools detect such length variation (<xref rid="vbad058-B1" ref-type="bibr">Bakhtiari <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad058-B3" ref-type="bibr">Dolzhenko <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="vbad058-B8" ref-type="bibr">Mousavi <italic toggle="yes">et al.</italic>, 2019</xref>). TRs, especially variable number tandem repeats or VNTRs with long motifs, can harbor other types of variation, including substitutions and small indels resulting in <italic toggle="yes">imperfect</italic> tandem repeats comprised of multiple motifs.</p>
    <p>Due to the complex variation patterns, it can be challenging to associate specific motifs or alleles with a phenotype. For example, unique VNTR motifs have been reported to be causal for phenotypes (<xref rid="vbad058-B6" ref-type="bibr">Lu <italic toggle="yes">et al.</italic>, 2023</xref>; <xref rid="vbad058-B10" ref-type="bibr">Song <italic toggle="yes">et al.</italic>, 2018</xref>), however, detecting such motifs can be difficult when they appear in a highly complex background. In such cases, a visual display of TR motif composition in multiple individuals, similar to multiple sequence alignments, can be an effective tool to quickly highlight the causal motif. This approach can be especially useful in exploring the complexity and impact of variation in TR regions. The visualization can generate specific hypotheses that can subsequently be assessed with appropriate statistical tests.</p>
    <p>While there were visual displays to show the TR polymorphisms, those efforts were either manually generated (<xref rid="vbad058-B2" ref-type="bibr">Course <italic toggle="yes">et al.</italic>, 2021</xref>), or alternatively used fixed k-mer motifs, which are not suitable for variable length motifs (<xref rid="vbad058-B10" ref-type="bibr">Song <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="vbad058-B11" ref-type="bibr">Sulovari <italic toggle="yes">et al.</italic>, 2019</xref>). This is in part due to the complexity of resolving TR alleles and identifying and comparing the structure of TR sequences.</p>
    <p>Here, we present TRviz, an open-source python library for visualizing TR sequences. TRviz provides modules for decomposing, encoding, aligning and visualizing TR alleles. It may be used to analyse any type of tandem repeats.</p>
  </sec>
  <sec>
    <title>2 Features and methods</title>
    <p>TRviz generates a plot in four steps, each available as a standalone module: decomposition, encoding, alignment and rearrangement and visualization (<xref rid="vbad058-F1" ref-type="fig">Fig. 1a–d</xref>). The output of each module is the input of the following module. In the next sections, we describe each module in detail.</p>
    <fig position="float" id="vbad058-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>An overview of TRviz. (<bold>a</bold>) Decomposition: given tandem repeat (TR) sequences and a set of motifs, the module outputs decomposed sequences comprised of a series of detected motifs. (<bold>b</bold>) Encoding: each distinct motif is labeled as a symbol. (<bold>c</bold>) Alignment and rearrangement: given the encoded TR alleles, it performs multiple sequence alignment and rearranges the order. (<bold>d</bold>) Visualization: this module generates a plot showing the TR motif structure and composition. For each distinct motif, a distinct color is assigned. For example, the motif colored in red could indicate a disease-associated motif. (<bold>e</bold>) A plot generated by TRviz for a TR in <italic toggle="yes">MALRD1</italic> (chr10:1917995-19172084). Rows represent the decomposed TR alleles extracted from human genome assemblies. The sample names are labeled on the <italic toggle="yes">y</italic>-axis. Next to the names, color-coded labels can be used to annotate the group membership. In this example, the super population code was used. (<bold>f</bold>) The mapping between motifs and actual sequences detected in the TR alleles and their frequency in (e)</p>
      </caption>
      <graphic xlink:href="vbad058f1" position="float"/>
    </fig>
    <p><italic toggle="yes">a. Decomposition of tandem repeat sequences</italic>. The decomposition module takes a collection of <italic toggle="yes">alleles</italic> (TR containing sequences) and one or more motifs. It automatically generates an ‘optimum’ decomposition of each allele into motifs (<xref rid="vbad058-F1" ref-type="fig">Fig. 1a</xref>).</p>
    <p>To clarify the decomposition problem, we define <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mo>Σ</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> as a set of sequences composed of the symbols from <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mo>Σ</mml:mo></mml:math></inline-formula>. For <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, let <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> denote a score function between <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic>. Let <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi><mml:mo>⊆</mml:mo><mml:msup><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> represent a collection of input motifs. Given a TR allele <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula>, the decomposition problem is to <italic toggle="yes">optimally parse x</italic>, by partitioning <italic toggle="yes">x</italic> into substrings <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>3</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo>…</mml:mo></mml:mrow></mml:math></inline-formula> such that
is maximized. In this optimum parse, we say that the substring <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is ‘aligned’ to motif <italic toggle="yes">m</italic>. If <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> is aligned to <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math></inline-formula> in the optimum parse, and <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>m</mml:mi></mml:mrow></mml:math></inline-formula>, then <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> denotes an input motif; otherwise, <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> represents a new motif.</p>
    <disp-formula id="E1">
      <label>(1)</label>
      <mml:math id="M1" display="block" overflow="scroll">
        <mml:mrow>
          <mml:mi>D</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mi>x</mml:mi>
          <mml:mo>,</mml:mo>
          <mml:mi>M</mml:mi>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>=</mml:mo>
          <mml:munder>
            <mml:mo>∑</mml:mo>
            <mml:mi>i</mml:mi>
          </mml:munder>
          <mml:mrow>
            <mml:munder>
              <mml:mrow>
                <mml:mi>max</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>∈</mml:mo>
                <mml:mi>M</mml:mi>
              </mml:mrow>
            </mml:munder>
          </mml:mrow>
          <mml:mi>d</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:msup>
            <mml:mrow>
              <mml:mi>x</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>i</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
          </mml:msup>
          <mml:mo>,</mml:mo>
          <mml:mi>m</mml:mi>
          <mml:mo stretchy="false">)</mml:mo>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>We solve the optimum parse problem by using dynamic programming. Let <italic toggle="yes">D</italic>[<italic toggle="yes">i</italic>, <italic toggle="yes">m</italic>, <italic toggle="yes">j</italic>] denote the maximum score of aligning the prefix of the query sequence <italic toggle="yes">x</italic>[1.<italic toggle="yes">i</italic>] to a collection of motifs <italic toggle="yes">M</italic>, where the <italic toggle="yes">i</italic>th character of the query sequence is matched to the <italic toggle="yes">j</italic>th character of motif <italic toggle="yes">m</italic>. Solving the recurrence using dynamic programming (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref>) provides the optimum score as
where <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> denote the length of the query and motif, respectively. We employed the edit distance as the scoring function <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, assigning a score of 5 for matches, –4 for mismatches and indels by default. The final decomposition is constructed using standard backtracking methods.</p>
    <disp-formula id="E2">
      <label>(2)</label>
      <mml:math id="M2" display="block" overflow="scroll">
        <mml:mrow>
          <mml:munder>
            <mml:mrow>
              <mml:mi>max</mml:mi>
            </mml:mrow>
            <mml:mi>m</mml:mi>
          </mml:munder>
          <mml:mo>{</mml:mo>
          <mml:mi>D</mml:mi>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mo>|</mml:mo>
          <mml:mi>x</mml:mi>
          <mml:mo>|</mml:mo>
          <mml:mo>,</mml:mo>
          <mml:mi>m</mml:mi>
          <mml:mo>,</mml:mo>
          <mml:mo>|</mml:mo>
          <mml:mi>m</mml:mi>
          <mml:mo>|</mml:mo>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>}</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:mrow>
      </mml:math>
    </disp-formula>
    <p>The method is similar to the ‘string decomposer’ algorithm (<xref rid="vbad058-B4" ref-type="bibr">Dvorkina <italic toggle="yes">et al.</italic>, 2020</xref>), with some differences, including the possible decomposition into motifs not given by the initial motif set. This is useful for TRs with previously unknown, complex motif structures. As a simple example, the following code snippet uses a novel motif ACCTTTG, to complete the decomposition.<disp-quote content-type="extract"><p><monospace>&gt;&gt;&gt; from trviz.decomposer import Decomposer</monospace></p><p><monospace>&gt;&gt;&gt; tr_decomposer = Decomposer()</monospace></p><p><monospace>&gt;&gt;&gt; tr_sequence = "</monospace><monospace>ACCTTGACCTTGACCTTTG</monospace><monospace>"</monospace></p><p><monospace>&gt;&gt;&gt; motifs = ["</monospace><monospace>ACCTTG</monospace><monospace>"]</monospace></p><p><monospace>&gt;&gt;&gt; tr_decomposer.decompose(tr_sequence, motifs)</monospace></p><p><monospace>&gt;&gt;&gt; ["</monospace><monospace>ACCTTG</monospace><monospace>", "</monospace><monospace>ACCTTG</monospace><monospace>", "</monospace><monospace>ACCTTTG</monospace><monospace>"]</monospace></p></disp-quote></p>
    <p><italic toggle="yes">b. Encoding decomposed motifs</italic>. Similarly, we define <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mo>Γ</mml:mo></mml:math></inline-formula> to denote a second set of symbols, representing encoded motifs, and <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>Γ</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> to be a set of sequences composed of symbols from given <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mo>Γ</mml:mo></mml:math></inline-formula>, representing encoded TR alleles. Given decomposed TR alleles, each represented as a list of motifs, the encoding module sets a mapping function from motifs to symbols, <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mi>e</mml:mi><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mo>Σ</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msup><mml:mo>↦</mml:mo><mml:mo>Γ</mml:mo></mml:mrow></mml:math></inline-formula>, and converts the decomposed allele into a sequence of symbols <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mi>a</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mo>Γ</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:msup></mml:mrow></mml:math></inline-formula> using the mapping function and output the mapping as a text file (<xref rid="vbad058-F1" ref-type="fig">Fig. 1b</xref>). A maximum of 90 distinct symbols (motifs) are allowed, with the option of assigning a special symbol to encode rare private motifs. The frequency threshold for private motifs can be set by users, or an ‘auto’ option can be used to maximize the number of symbols.</p>
    <p><italic toggle="yes">c. Alignment and rearrangement of encoded motifs</italic>. To align the encoded alleles, TRviz performs multiple sequence alignment using MAFFT (<xref rid="vbad058-B5" ref-type="bibr">Katoh and Standley, 2013</xref>) and outputs the aligned sequences (<xref rid="vbad058-F1" ref-type="fig">Fig. 1c</xref>). We use a customized scoring matrix to align the symbols, not nucleotides (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Information</xref>). For every symbol pair, we define a mismatch score based on the similarity between the corresponding pair of motifs. The scoring is optimized to avoid introducing gaps between two quite similar motifs. After the alignment step, TRviz rearranges the aligned sequences (<xref rid="vbad058-F1" ref-type="fig">Fig. 1c</xref>) to bring similar alleles together. By default, TRviz performs hierarchical clustering and rearranges the alleles based on the clusters. We support other rearrangement methods for different visualization goals, including sorting by motif counts and manual rearrangement.</p>
    <p><italic toggle="yes">d. Visualization</italic>. The visualization module generates a plot showing the motif composition of the alleles given the aligned and encoded alleles (<xref rid="vbad058-F1" ref-type="fig">Fig. 1d</xref>). The encoded alleles are color-coded, and a distinct color is automatically assigned to each symbol, including grey (by default) for private motifs. In <xref rid="vbad058-F1" ref-type="fig">Figure 1e</xref>, we visualized a collection of 96 alleles extracted from human assemblies generated by the Human Pangenome Reference Consortium (HPRC) at the chr10:19171995-19172084 VNTR locus. Each row represents a distinct allele sampled from a specific super-population. The participating motifs and their color codes are shown in <xref rid="vbad058-F1" ref-type="fig">Figure 1f</xref>.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>To demonstrate the applicability of the method, we visualized various TR loci using the alleles extracted from human assemblies generated by HPRC (<xref rid="vbad058-F2" ref-type="fig">Fig. 2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>), which have provided insights into the complex variation in motif structure and allele lengths.</p>
    <fig position="float" id="vbad058-F2">
      <label>Fig. 2.</label>
      <caption>
        <p>Human tandem repeat polymorphisms. (<bold>a</bold>) A ‘pure’ variable number tandem repeat (VNTR) with a single motif. The color codes for the super population are shown at the top of the figures. (<bold>b</bold>) and (<bold>c</bold>) VNTRs with two detected motifs that differ by a single nucleotide. It should be noted that some alleles only carry a single motif and are mostly found in African population (marked in red). (<bold>d</bold>) A VNTR composed of two variable motifs (in sky blue and green) and two low-frequency motifs (in yellow and blue). Note that some alleles share the same number of motifs but have different motif compositions. (<bold>e</bold>) Repeat expansion with a set of motifs. The expanded allele pattern reveals a fusion of two separate motifs. All alleles in this figure were extracted from the human assemblies generated by the Human Pangenome Reference Consortium</p>
      </caption>
      <graphic xlink:href="vbad058f2" position="float"/>
    </fig>
    <p><xref rid="vbad058-F2" ref-type="fig">Figure 2a</xref> illustrates one of the simpler cases: a TR locus composed of a single, 9-bp-long motif. In such a TR composed of exact repeats of a single motif, variations in the number of motifs can be identified by using TR genotypers, such as adVNTR (<xref rid="vbad058-B1" ref-type="bibr">Bakhtiari <italic toggle="yes">et al.</italic>, 2021</xref>), which mainly look at length differences in alleles. However, these methods may not fully capture variations occurring within the motifs, for example in <xref rid="vbad058-F2" ref-type="fig">Figure 2b</xref> and <xref rid="vbad058-F2" ref-type="fig">c</xref>. In each of these examples, the VNTRs have two motifs that are one edit distance apart. For example, in <xref rid="vbad058-F2" ref-type="fig">Figure 2b</xref>, the majority of alleles have the same number of motifs but with different motif compositions; the difference between HG01106 and HG02145 would not be captured by most VNTR genotyping tools. Interestingly, the alleles containing a single motif are primarily found within the African population. While visually apparent by looking at the population code in <xref rid="vbad058-F2" ref-type="fig">Figure 2b</xref>, this observation could be easily missed by tools analyzing the data statistically.</p>
    <p><xref rid="vbad058-F2" ref-type="fig">Figure 2d</xref> presents an intriguing case where the number of two quite similar motifs is highly variable, even though the total length of the TR may not vary. For example, HG01109-2 and HG03486-2 have identical lengths, but different compositions. Furthermore, TRviz detected two private motifs represented in only a few alleles. These detected rare motifs can be used to generate a hypothesis, which would not be captured by most VNTR genotyping tools.</p>
    <p><xref rid="vbad058-F2" ref-type="fig">Figure 2e</xref> depicts a complex VNTR region located in the intron of <italic toggle="yes">SSU72</italic> gene. About 78% of the alleles have longer lengths compared to hg38 and T2T reference alleles. The expanded alleles show a striking pattern carrying a group of motifs together when expanding. It is noteworthy that not all motifs have the same length, thus a fixed k-mer-based decomposition method would not be suitable for detecting the pattern correctly, and methods testing hypotheses based on lengths could miss some of the higher order patterns.</p>
    <p>Finally, we visualized the VNTR in <italic toggle="yes">SORL1</italic> gene (chr11:121480539-121482037) of 110 alleles including 6 alleles from three different non-human primates; orangutan, gorilla and chimpanzee, which had been previously reported to have a human-specific expansion (<xref rid="vbad058-B2" ref-type="bibr">Course <italic toggle="yes">et al.</italic>, 2021</xref>). Our tool confirmed this expansion (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>) but also identified human alleles (largely African) with a novel deletion, or a non-expansion of motifs along with a different pattern in the fourth motif.</p>
    <p>The runtime is dominated by the decomposition and alignment steps. Decomposition runtime is dependent on the length and number of the TR alleles and input motifs. As an example, visualizing a TR with 300 alleles of average length 40 bp and a 10 bp motif took 16 secs on a single 3.8 GHz CPU. For a more complex example, visualizing 110 alleles of average length 1559 and 57 bp motifs took 30 s for a SORL1 VNTR shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref>.</p>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Tandem repeats are the ‘hidden polymorphisms,’ that govern a large fraction of human genetic variation, and mediate both Mendelian and complex phenotypes. In recent years, many statistical tools have been developed for analyzing tandem repeats, and identifying previously hidden genetic factors involved in specific phenotypes (<xref rid="vbad058-B1" ref-type="bibr">Bakhtiari <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="vbad058-B3" ref-type="bibr">Dolzhenko <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="vbad058-B8" ref-type="bibr">Mousavi <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="vbad058-B9" ref-type="bibr">Mukamel <italic toggle="yes">et al.</italic>, 2021</xref>). While successful, these methods typically focus on specific aspects of variation. For example, they may look for length differences, or more rarely, for single nucleotide variants within repeats. However, TR variation can take complex forms, relating to changes in the number of copies of different repeat units while preserving overall composition. In these cases, a visual exploration could be helpful in formulating a hypothesis, for which an appropriate statistical test could be devised. The development of such tools is technically challenging due to the complex patterns of variation.</p>
    <p>TRviz is a software tool that provides a direct view of the complexity and evolution of a polymorphic repeat locus. Rather than work as a multiple alignment tool, it is motif-centric and clearly displays the order and number of different motifs. It is length agnostic, and can display motifs of different lengths. Thus, it can highlight subtle differences in TRs between groups of individuals, for example, subpopulations, closely related species, or even cases and controls for a phenotype mediated by variation in tandem repeats.</p>
    <p>The notion of a motif is not well-defined. For example, a motif CTTACCGATT, could also be written as two distinct motifs CTTAC, and CGATT, which appear in tandem. The choice of one or two motifs is largely a matter of preference, but a parsimonious explanation is usually the preferred one. Thus, if they always appeared together in the same order, it would make sense to treat them as a single motif. Similarly, repeated occurrences of a motif (e.g. CTTAC-CTTAC-CTTAC) could easily be shifted by a few base-pairs (e.g. C-TTACC-TTACC-TTAC). Again, the choice is governed by unique sequences at the beginning and end of the tandem repeats, but different tools could make different choices. For these reasons, TRviz takes in a user-defined collection of motifs, and the TR boundaries as input. This allows a user to experiment with different motifs and visually explore the higher-order patterns. They could also compare the visualizations of two different motif structures to explore if groups of alleles are better discriminated by one choice. We note that other tools (e.g. Tandem Repeats Finder) can easily generate these inputs for the user if needed.</p>
    <p>Another feature of TRviz is that complex repeats where two distinct TRs are together, or a TR nested within another TR can also be visualized simply by supplying appropriate motifs. However, we note that the visualization may be imperfect in some cases because of the high complexity of motif structure and the use of an off-the-shelf multiple alignment method. Improved understanding of TR evolution and better scoring functions will further improve visualizations, and how these complex polymorphisms mediate phenotypes.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbad058_Supplementary_Data</label>
      <media xlink:href="vbad058_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>This work was supported by NIH grants [HG010149, RM1HG011558 and R01GM114362].</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: V.B. is a co-founder, paid consultant, and serves on the scientific advisory board of Boundless Bio, inc. (BBI) and Abterra, inc. (Ab).</p>
  </sec>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>There are no new data associated with this article. No new data were generated or analysed in support of this research.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbad058-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bakhtiari</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Variable number tandem repeats mediate the expression of proximal genes</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>2075</fpage>.<pub-id pub-id-type="pmid">33824302</pub-id></mixed-citation>
    </ref>
    <ref id="vbad058-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Course</surname><given-names>M.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Characterizing nucleotide variation and expansion dynamics in human-specific variable number tandem repeats</article-title>. <source>Genome Res</source>., <volume>31</volume>, <fpage>1313</fpage>–<lpage>1324</lpage>.<pub-id pub-id-type="pmid">34244228</pub-id></mixed-citation>
    </ref>
    <ref id="vbad058-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dolzhenko</surname><given-names>E.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>ExpansionHunter: a sequence-graph-based tool to analyze variation in short tandem repeat regions</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>4754</fpage>–<lpage>4756</lpage>.<pub-id pub-id-type="pmid">31134279</pub-id></mixed-citation>
    </ref>
    <ref id="vbad058-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dvorkina</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>The string decomposition problem and its applications to centromere analysis and assembly</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>I93</fpage>–<lpage>I101</lpage>.<pub-id pub-id-type="pmid">32657390</pub-id></mixed-citation>
    </ref>
    <ref id="vbad058-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Katoh</surname><given-names>K.</given-names></string-name>, <string-name><surname>Standley</surname><given-names>D.M.</given-names></string-name></person-group> (<year>2013</year>) <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol. Biol. Evol</source>., <volume>30</volume>, <fpage>772</fpage>–<lpage>780</lpage>.<pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="vbad058-B6">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lu</surname><given-names>T.-Y.</given-names></string-name> et al.</person-group> (<year>2023</year>) The motif composition of variable-number tandem repeats impacts gene expression. <italic toggle="yes">Genome Res</italic> gr.276768.122.</mixed-citation>
    </ref>
    <ref id="vbad058-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mitra</surname><given-names>I.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Patterns of de novo tandem repeat mutations and their role in autism</article-title>. <source>Nature</source>, <volume>589</volume>, <fpage>246</fpage>–<lpage>250</lpage>.<pub-id pub-id-type="pmid">33442040</pub-id></mixed-citation>
    </ref>
    <ref id="vbad058-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mousavi</surname><given-names>N.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Profiling the genome-wide landscape of tandem repeat expansions</article-title>. <source>Nucleic Acids Res</source>., <volume>47</volume>, <fpage>e90</fpage>.<pub-id pub-id-type="pmid">31194863</pub-id></mixed-citation>
    </ref>
    <ref id="vbad058-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mukamel</surname><given-names>R.E.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Protein-coding repeat polymorphisms strongly shape diverse human phenotypes</article-title>. <source>Science</source>, <volume>373</volume>, <fpage>1499</fpage>–<lpage>1505</lpage>.<pub-id pub-id-type="pmid">34554798</pub-id></mixed-citation>
    </ref>
    <ref id="vbad058-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>J.H.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Characterization of a human-specific tandem repeat associated with bipolar disorder and schizophrenia</article-title>. <source>Am. J. Hum. Genet</source>., <volume>103</volume>, <fpage>421</fpage>–<lpage>430</lpage>.<pub-id pub-id-type="pmid">30100087</pub-id></mixed-citation>
    </ref>
    <ref id="vbad058-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sulovari</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal>; <collab>Human Genome Structural Variation Consortium</collab> (<year>2019</year>) <article-title>Human-specific tandem repeat expansion and differential gene expression during primate evolution</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>116</volume>, <fpage>23243</fpage>–<lpage>23253</lpage>.<pub-id pub-id-type="pmid">31659027</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
