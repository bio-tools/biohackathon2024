<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8686224</article-id>
    <article-id pub-id-type="publisher-id">2565</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-021-02565-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MultiMAP: dimensionality reduction and integration of multimodal data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Jain</surname>
          <given-names>Mika Sarkin</given-names>
        </name>
        <address>
          <email>mikasarkinjain@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Polanski</surname>
          <given-names>Krzysztof</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Conde</surname>
          <given-names>Cecilia Dominguez</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Xi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Park</surname>
          <given-names>Jongeun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mamanova</surname>
          <given-names>Lira</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Knights</surname>
          <given-names>Andrew</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Botting</surname>
          <given-names>Rachel A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stephenson</surname>
          <given-names>Emily</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Haniffa</surname>
          <given-names>Muzlifah</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lamacraft</surname>
          <given-names>Austen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8107-9974</contrib-id>
        <name>
          <surname>Efremova</surname>
          <given-names>Mirjana</given-names>
        </name>
        <address>
          <email>m.efremova@qmul.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Teichmann</surname>
          <given-names>Sarah A.</given-names>
        </name>
        <address>
          <email>st9@sanger.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5335.0</institution-id><institution-id institution-id-type="ISNI">0000000121885934</institution-id><institution>Theory of Condensed Matter, Dept Physics, Cavendish Laboratory, </institution><institution>University of Cambridge, </institution></institution-wrap>JJ Thomson Ave, Cambridge, CB3 0HE UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.10306.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 0606 5382</institution-id><institution>Wellcome Sanger Institute, Wellcome Genome Campus, </institution></institution-wrap>Hinxton, Cambridge, CB10 1SA UK </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.263817.9</institution-id><institution-id institution-id-type="ISNI">0000 0004 1773 1790</institution-id><institution>Southern University of Science and Technology, </institution></institution-wrap>1088 Xueyuan Ave, Nanshan, Shenzhen, 518055 Guangdong Province China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.37172.30</institution-id><institution-id institution-id-type="ISNI">0000 0001 2292 0500</institution-id><institution>KAIST, </institution></institution-wrap>291 Daehak-ro, Eoeun-dong, Yuseong-gu, Daejeon, South Korea </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.1006.7</institution-id><institution-id institution-id-type="ISNI">0000 0001 0462 7212</institution-id><institution>Biosciences Institute, </institution><institution>Newcastle University, </institution></institution-wrap>Newcastle upon Tyne, NE2 4HH UK </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.4868.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 2171 1133</institution-id><institution>Barts Cancer Institute, </institution><institution>Queen Mary University of London, </institution></institution-wrap>London, UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>346</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>8</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>3</day>
        <month>12</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Multimodal data is rapidly growing in many fields of science and engineering, including single-cell biology. We introduce MultiMAP, a novel algorithm for dimensionality reduction and integration. MultiMAP can integrate any number of datasets, leverages features not present in all datasets, is not restricted to a linear mapping, allows the user to specify the influence of each dataset, and is extremely scalable to large datasets. We apply MultiMAP to single-cell transcriptomics, chromatin accessibility, methylation, and spatial data and show that it outperforms current approaches. On a new thymus dataset, we use MultiMAP to integrate cells along a temporal trajectory. This enables quantitative comparison of transcription factor expression and binding site accessibility over the course of T cell differentiation, revealing patterns of expression versus binding site opening kinetics.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-021-02565-y.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Gates Cambridge Scholarship</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Barts Charity</institution>
        </funding-source>
        <award-id>MGU045</award-id>
        <principal-award-recipient>
          <name>
            <surname>Efremova</surname>
            <given-names>Mirjana</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004440</institution-id>
            <institution>Wellcome Trust</institution>
          </institution-wrap>
        </funding-source>
        <award-id>WT206194</award-id>
        <award-id>WT211276/Z/18/Z</award-id>
        <principal-award-recipient>
          <name>
            <surname>Teichmann</surname>
            <given-names>Sarah A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Chan Zuckerberg Initiative</institution>
        </funding-source>
        <award-id>CZF2019-002445</award-id>
        <principal-award-recipient>
          <name>
            <surname>Teichmann</surname>
            <given-names>Sarah A.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Multimodal data is rapidly growing in single-cell biology and many other fields of science and engineering. Emerging single-cell technologies are providing high-resolution measurements of different features of cellular identity, including single-cell assays for gene expression, protein abundance [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], chromatin accessibility [<xref ref-type="bibr" rid="CR3">3</xref>], DNA methylation [<xref ref-type="bibr" rid="CR4">4</xref>], and spatial resolution [<xref ref-type="bibr" rid="CR5">5</xref>]. Large-scale collaborations, including the Human Cell Atlas international consortium [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>], are generating an exponentially increasing amount of data, using these technologies. Each technology provides a unique view of cellular biology and has different strengths and weaknesses. Integrating these measurements to study a single biological system will open avenues for a more comprehensive view of cellular identity, cell-cell interactions, developmental dynamics, and tissue structure [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p id="Par3">The integration of multi-omic data poses several challenges [<xref ref-type="bibr" rid="CR9">9</xref>]. Different omics technologies measure distinct unmatched features with different underlying distributions and properties and hence produce data of different dimensionality. This makes it difficult to place data from different omics in the same feature space. Additionally, omics technologies can also have different noise and batch characteristics which are challenging to identify and correct. Furthermore, as multi-omic data grows along two axes, the number of cells per omic and the number of omics per study, integration strategies need to be extremely scalable.</p>
    <p id="Par4">Most data integration methods project multiple measurements of information into a common low-dimensional representation to assemble multiple modalities into an integrated embedding space. Recently published methods employ different algorithms to project multiple datasets into an embedding space, including canonical correlation analysis (CCA) [<xref ref-type="bibr" rid="CR10">10</xref>], nonnegative matrix factorization (NMF) [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>], or neural network models [<xref ref-type="bibr" rid="CR13">13</xref>]. These methods have demonstrated utility, yet suffer from shortcomings, including challenges with scaling and being limited to consideration of features shared across data sets (e.g., the same genes). A further drawback is that methods that use linear models, such as CCA and NMF, are unable to capture nonlinear differences between datasets.</p>
    <p id="Par5">Here we introduce a new method that overcomes all these limitations: MultiMAP, an algorithm for the dimensionality reduction and integration of multiple datasets. MultiMAP integrates data by constructing a nonlinear manifold on which diverse high-dimensional data reside and then projecting the manifold and data into a shared low-dimensional embedding space (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). MultiMAP generalizes the UMAP algorithm [<xref ref-type="bibr" rid="CR14">14</xref>] to the setting of multiple datasets with different dimensions, while implementing novel techniques for estimating the manifold, constructing a joint graph on the manifold, and optimizing the low-dimensional embedding to account for the limitations and the challenges of multimodal and multi-omic data. In contrast to other integration strategies for single-cell data, MultiMAP can integrate any number of datasets, is not restricted to a linear mapping, leverages features that are not present in all datasets (i.e., datasets can be of different dimensionalities), allows the user to specify the influence of each dataset on the embedding, and is effortlessly scalable to large datasets. The ability of MultiMAP to integrate datasets of different dimensionalities allows leveraging information that is not considered by methods that operate in a shared feature space. The power of MultiMAP’s consideration of all features in each modality can be illustrated when integrating the 20,000-feature gene space of scRNAseq data with the 100,000-feature peak space of scATAC-seq data: by taking into account the full epigenetic landscape of cells, including distal enhancers, in addition to the transcriptome, cell states such as, e.g., memory T cells versus naive T cells, where it is known that memory is largely epigenetically encoded, can be more sharply defined in the manifold space.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic of MultiMAP. <bold>a</bold> MultiMAP takes any number of datasets, including those of differing dimensions, recovers geodesic distances on a single latent manifold on which all data lie, constructs a neighborhood graph (MultiGraph) on the manifold, and then projects the data into a single low-dimensional embedding. Integrated analysis and visualization can be performed on the embedding or graph. Variables are discussed in Methods. <bold><italic>X</italic></bold><sup><italic>i</italic></sup> is dataset <italic>i</italic>, <bold><italic>x</italic></bold><sub><italic>j</italic></sub><sup><italic>i</italic></sup> is a point in <bold><italic>X</italic></bold><sup><italic>i</italic></sup>, <italic>M</italic> is the shared manifold, <italic>B</italic>(<bold><italic>x</italic></bold><sub><italic>i</italic></sub><sup>2</sup>) is a ball on M centered at <bold><italic>x</italic></bold><sub><italic>i</italic></sub><sup>2</sup>, <italic>X</italic><sup><italic>ij</italic></sup> is the ambient space of <italic>M</italic> in the coordinate space with data containing points from datasets <italic>i</italic> and <italic>j</italic>, <italic>g</italic><sup><italic>ij</italic></sup> is the metric of <italic>M</italic> in the space <italic>X</italic><sup><italic>ij</italic></sup>, <italic>μ</italic> is the membership function of the fuzzy simplicial set on the manifold, <italic>ν</italic> is the membership function of the fuzzy simplicial set in the low-dimensional space. <bold>b</bold> In the field of cell atlas technologies, encompassing single-cell genomics and spatial technologies, MultiMAP can be applied to integrate across different omics modalities, species, individuals, batches, and normal/perturbed states</p></caption><graphic xlink:href="13059_2021_2565_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par6">We apply MultiMAP to challenging synthetic multimodal data, demonstrate its ability to integrate a wide range of single-cell omics datasets, and benchmark it against popular integration algorithms using a variety of performance metrics. Finally, we apply MultiMAP to the study of T cell development with new scATAC-seq data from fetal thymi. We show that MultiMAP can co-embed datasets across different technologies and modalities, while at the same time preserving the structure of the data, even with extensive biological and technical differences. The resulting embedding and shared neighborhood graph (MultiGraph) can be used for simultaneous visualization and integrative analysis of multiple datasets. With respect to single-cell genomics data, this allows for standard analysis on the integrated data, such as cluster label transfer, joint clustering, and trajectory analysis.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>The MultiMAP framework</title>
      <p id="Par7">We introduce MultiMAP, an approach for integration and dimensionality reduction of multimodal data. MultiMAP is based on a framework of Riemannian geometry and algebraic topology and generalizes the UMAP framework to the setting of multiple datasets each with different dimensionality. MultiMAP takes as input any number of datasets of potentially differing dimensions and recovers geodesic distances on a single latent manifold on which all of the data is uniformly distributed. The distances are calculated between data points of the same dataset by normalizing distances with respect to a neighborhood distance specific to the dataset, and between data points of different datasets by normalizing distances between the data in a shared feature space with respect to a neighborhood parameter specific to the shared feature space. These distances are then used to construct a neighborhood graph (MultiGraph) on the manifold. Finally, the data and manifold space are projected into a low-dimensional embedding space by minimizing the cross entropy of the graph in the embedding space with respect to the graph in the manifold space. MultiMAP allows the user to modify the weight of each dataset in the cross entropy loss, and thus to modulate the contribution of each dataset to the layout. Integrated analysis can be performed on the embedding or the graph, and the embedding also provides an integrated visualization. The mathematical formulation of MultiMAP is elaborated in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Supplementary Methods [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR20">20</xref>].</p>
      <p id="Par8">In order to study MultiMAP in a controlled setting, we first applied it to two synthetic examples of multimodal data (“Methods”). The first synthetic data consists of points sampled randomly from the canonical 3D “Swiss Roll” surface and the 2D rectangle (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). The dataset is considered multimodal data, because samples are drawn from different feature spaces but describe the same rectangular manifold. In addition, we are given the position along the manifold of 1% of the data. This synthetic setting illustrates that MultiMAP can integrate data in a nonlinear fashion and operate on datasets of different dimensionality, because data points along a similar position on the manifold are near each other in the embedding (Fig. <xref rid="Fig2" ref-type="fig">2</xref>b). The MultiMAP embedding properly unrolls the Swiss Roll dataset, indicating that the projection is nonlinear. The embedding also appears to preserve aspects of both datasets; the data is curved and at the same time unrolled.
<fig id="Fig2"><label>Fig. 2</label><caption><p>MultiMAP applied to synthetic data. <bold>a</bold> Data sampled from the 3D Swiss Roll (X<sup>1</sup>) and a 2D rectangle (X<sup>2</sup>). <bold>b</bold> Shared embedding of both datasets produced by MultiMAP. Color indicates position along the manifold (a,b). <bold>c</bold> Left (X<sup>1</sup>) and right (X<sup>2</sup>) halves of MNIST handwritten digit images with a 2 pixel wide shared region. Gaussian noise is added to the left half. UMAP projections of each half and the shared region. <bold>d</bold> Shared embedding of both MNIST halves (including Gaussian noise introduced for the left half) produced by MultiMAP. Each color is a different handwritten digit (0–9 as shown in the key). This illustrates that MultiMAP leverages both shared and unshared features to integrate multimodal datasets</p></caption><graphic xlink:href="13059_2021_2565_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par9">To determine if MultiMAP can effectively leverage features unique to certain datasets, we used the MNIST database [<xref ref-type="bibr" rid="CR21">21</xref>], where handwritten images were split horizontally with thin overlap (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c; see “Methods” for details). The two datasets can be considered multimodal because they have different feature spaces but describe the same set of digit images. The thin overlapping region of the two halves is not enough information to create a good embedding of the data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). Many distinct digits are similar in this thin central sliver, and hence they cluster together in the feature space of this sliver. Indeed, in a UMAP projection of the data in the shared feature space of this overlap, the clusters of different digits are not as well separated as in the UMAP projections of each half (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c).</p>
      <p id="Par10">A multimodal integration strategy that effectively leverages all features would use the features unique to each half to separate different digits, and the shared space to bring the same digits from each dataset close together (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). We show that with MultiMAP the different modalities are well mixed in the embedding space and the digits cluster separately, despite mostly different feature spaces and noise being added to only the second dataset. This indicates that MultiMAP is leveraging the features unique to each dataset and is also robust to datasets with different levels of noise.</p>
      <p id="Par11">Moreover, MultiMAP has weight parameters <italic>ω</italic><sup><italic>v</italic></sup> which control the contribution of each dataset <bold><italic>X</italic></bold><sup><italic>v</italic></sup> to the final embedding, allowing the user to modulate which dataset has a greater influence on the MultiMAP embedding. When a dataset’s weight is larger, its structure has a larger contribution to the MultiMAP embedding. Our results show that when integrating the MNIST data, for different choices of <italic>ω</italic><sup><italic>v</italic></sup>, the datasets remain well integrated in the embedding space (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1a,b). For our real biological datasets, we use fixed default values of the weighting parameter (0.8 for scRNA-seq and 0.2 for all other -omics), demonstrating that MultiMAP produces robust integration without the need to adjust the weighting.</p>
      <p id="Par12">Finally, to illustrate that our assumption of a shared manifold is robust to variable levels of overlap across datasets, we used MultiMAP to integrate datasets with varying numbers of shared clusters in the MNIST data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). Our results show that MultiMAP is able to effectively integrate datasets that have only 1 out of 10 clusters shared between them. The transfer accuracy, silhouette score, and structure score of the MultiMAP integration remained largely constant as the number of overlapping clusters varied, demonstrating that MultiMAP is highly robust to differences in populations between datasets.</p>
    </sec>
    <sec id="Sec4">
      <title>MultiMAP integration of single-cell transcriptomics and chromatin accessibility</title>
      <p id="Par13">Having shown that MultiMAP succeeds in integrating synthetic data, we applied the technique to real biological data. Epigenomic regulation underlies gene expression and cellular identity. Hence, integration of single-cell transcriptomics and epigenomics data provides an opportunity to investigate how epigenomic alterations regulate gene expression to determine and maintain cell identity. In addition, effective integration with transcriptomics data can improve the sensitivity and interpretability of the more sparse scATAC-seq data.</p>
      <p id="Par14">To assess MultiMAP’s ability to integrate transcriptomic and epigenomic data, we applied it to integrate our previously generated high-coverage scATAC-seq data of mouse splenocytes [<xref ref-type="bibr" rid="CR22">22</xref>] and generated corresponding single-cell transcriptomic profiles of the same tissue. The high coverage of the plate-based scATAC-seq data as well as the published cluster annotations of the subpopulations served as a good ground truth example to validate our method. Analysis of the transcriptomics data revealed similar subpopulations to the published scATAC-seq dataset, in addition to two RNA-specific clusters: a subpopulation of B cells with higher expression of Interferon-Induced (Ifit) genes and a subpopulation of proliferating cells (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3a,b).</p>
      <p id="Par15">MultiMAP effectively integrated the two datasets, using both gene activity scores and the cell-type-specific epigenetic information outside of gene bodies. The different modalities are well mixed in the embedding space and cells annotated as the same type are close together, regardless of the modality for different choices of <italic>ω</italic><sup><italic>v</italic></sup> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig S1c,d). Next, we jointly clustered cells from both datasets using the MultiGraph. This produced clusters with markers corresponding to known cell types [<xref ref-type="bibr" rid="CR22">22</xref>] (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig S3c). The annotations produced by this joint clustering were generally consistent with independent annotations of each dataset (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c). Two of the clusters determined to be proliferating cells and B cells with upregulated Ifit genes were found only in the scRNA-seq data, as expected (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3b). In addition, the integration produced by MultiMAP is robust to different choices of the weight parameters (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1c).
<fig id="Fig3"><label>Fig. 3</label><caption><p>MultiMAP integration of single-cell transcriptomics and chromatin accessibility. <bold>a</bold> MultiMAP visualization of the integration of published scATAC-seq [<xref ref-type="bibr" rid="CR22">22</xref>] and newly generated scRNA-seq data of the mouse spleen (<italic>n</italic> = 1), colored by omic technology (left hand panel) and independent cell type annotations of each omic technology (right hand panel). <bold>b</bold> Dot plot showing the <italic>z</italic>-score of the mean log-normalized gene expression and gene activity scores of known markers of each identified joint cluster. The top dot of each row shows the cells from the scRNA-seq data, and the bottom dot represents the cells from the scATAC-seq data. <bold>c</bold> Riverplot showing correspondence between the joint clusters and the independent annotations of the scATAC-seq and scRNAseq data. <bold>d</bold> Confusion matrix of label transfer from the scRNAseq to the scATAC-seq. <bold>e</bold> MultiMAP visualization of the integration of single-cell transcriptomics and chromatin accessibility of human bone marrow and peripheral blood mononuclear cells [<xref ref-type="bibr" rid="CR23">23</xref>] colored by omic technology (left hand panel) and by the published cell type annotation (right hand panel). <bold>f</bold> UMAP (panels in top row) and MultiMAP (panels in bottom row) visualization of the scRNA-seq and scATAC-seq data colored by cluster annotation and batch, showing the effective batch correction of both modalities using MultiMAP</p></caption><graphic xlink:href="13059_2021_2565_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par16">Further, we used the MultiGraph to directly predict the cell types of the scATAC-seq given the cell types of the scRNA-seq. Figure <xref rid="Fig3" ref-type="fig">3</xref>d shows the confusion matrix of the predictions, demonstrating that cells were generally annotated correctly. This illustrates the ability of MultiMAP to leverage annotation efforts of one omic technology to inform those of another. Interestingly, a small subset of cells from scRNA-seq previously annotated as T cells is now clearly separated on the MultiMAP plot, and clusters close to the B cells (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig S3). Doublet detection confirmed that this cluster is composed of doublet T/B cells. These doublets are spread throughout the UMAP plot of the scRNA-seq data, but are clearly distinct on the MultiMAP plot (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3). This illustrates the power of MultiMAP both as a visualization tool, and to reveal new populations of cells.</p>
      <p id="Par17">Next, we applied MultiMAP to integration of multiple batches from each data modality, to assess the ability to account for batch effects. For this purpose, we used recently published scRNA-seq and scATAC-seq data of human bone marrow and peripheral blood mononuclear cells (PBMCs) [<xref ref-type="bibr" rid="CR23">23</xref>]. This dataset consists of 16 experimental samples, representing different experimental batches. Another challenge is that cells are not in discrete clusters but rather on a continuum. MultiMAP is able to simultaneously correct batch effects and modality differences, integrating all 16 datasets into a consistent embedding (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e). The different modalities are well mixed in the embedding and cells of the same type are close together, regardless of modality or batch. The cell-type annotations of all of the data were taken from the original publication [<xref ref-type="bibr" rid="CR23">23</xref>], so they provide a good ground truth and independent validation of MultiMAP. Additionally, MultiMAP is able to correct batch effects present in different omics technologies. Applying MultiMAP to just the scRNA-seq data produces embedding that properly integrates cells of the same type regardless of batch, and the same is true when MultiMAP is applied to only the scATAC-seq data (Fig. <xref rid="Fig3" ref-type="fig">3</xref>f). It is also evident from this figure that clusters with cell types unique to a batch remain unmixed in the embedding. This indicates that MultiMAP is not forcing incompatible data to integrate and demonstrates that MultiMAP can integrate datasets even if they have extensive technical differences.</p>
    </sec>
    <sec id="Sec5">
      <title>MultiMAP integration of multiple modalities of mouse brain cells</title>
      <p id="Par18">Recent advances in spatial sequencing technology enable the simultaneous measurement of gene expression and spatial locations of single cells, facilitating the study of tissue structure [<xref ref-type="bibr" rid="CR5">5</xref>]. While these technologies provide spatial information, they often measure only a small fraction of the genes measured by scRNA-seq. Integration of spatial measurements and scRNA-seq has the potential to provide spatial context to scRNA-seq data, as well as to reveal finer grained biological differences in the spatial data by leveraging the greater number of cells and genes present in scRNA-seq data.</p>
      <p id="Par19">We applied MultiMAP to the integration of a Drop-seq scRNA-seq data of the mouse frontal cortex [<xref ref-type="bibr" rid="CR24">24</xref>] and STARmap in situ gene expression dataset [<xref ref-type="bibr" rid="CR25">25</xref>]. Despite the differences between the two datasets in the number of measured genes (only 1020 in STARmap) and the number of cells (71640 in Drop-seq versus 2137 in STARmap), our integrated analysis shows that MultiMAP successfully integrated the datasets. Clustering the integrated data using the MultiGraph produced clusters with markers corresponding to known cell types (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, b). One of the clusters, the claustrum, was found only in the scRNA-seq data, consistent with previous studies [<xref ref-type="bibr" rid="CR11">11</xref>]. Integration with MultiMAP also resulted in improved cluster annotation for both datasets. The excitatory L4 neurons were previously only present in the STARmap data, as the motor cortex and prefrontal cortex that are part of the frontal cortex are considered to lack a layer 4 in mice [<xref ref-type="bibr" rid="CR27">27</xref>]. However, after the integration, we also identified L4 cells in the scRNA-seq data previously annotated as L5 neurons (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a, c, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4). A similar population of pyramidal cells located between layers 3 and 5 were recently identified both with anatomical and single-cell studies [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. This was confirmed by expression of marker genes associated with L4, including Cux2 and Rorb (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4). This illustrates the power of MultiMAP to reveal new cell types.
<fig id="Fig4"><label>Fig. 4</label><caption><p>MultiMAP integration of multiple modalities of mouse brain cell data. <bold>a</bold> MultiMAP visualization of scRNA-seq [<xref ref-type="bibr" rid="CR24">24</xref>] and spatial STARmap [<xref ref-type="bibr" rid="CR25">25</xref>] (<italic>n</italic> = 2) data of the mouse brain, colored by omic technology, and joint clusters identified with the MultiGraph. <bold>b</bold> Dot plot showing mean log-normalized gene expression of known markers of each identified joint cluster. The top dot in each row represents cells from the scRNA-seq data, and the bottom dot represents cells from the scATAC-seq data. <bold>c</bold> Riverplot showing correspondence between the joint clusters, and the independent annotations of the scATAC-seq and scRNAseq data. <bold>d</bold> Spatial locations of the STARmap cells, colored by the joint clusters. <bold>e</bold> UMAP and MultiMAP visualizations of the STARmap dataset. The silhouette score as employed here quantifies the separation of clusters, and the higher value for MultiMAP shows the better cluster separation as compared to UMAP. <bold>f</bold> MultiMAP visualization of the integration of single-cell transcriptomics, chromatin accessibility, and DNA methylation of the mouse primary cortex, colored by omic technology and the published cell type annotation [<xref ref-type="bibr" rid="CR26">26</xref>]</p></caption><graphic xlink:href="13059_2021_2565_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par20">MultiMAP also improves visualization of the STARmap data. Before integration with MultiMAP, many of the cell types of the spatial data did not cluster separately and were difficult to distinguish visually. In comparison, the MultiMAP embedding of the STARmap data exhibits tighter cell-type clusters and increased separation between cell types (Fig. <xref rid="Fig4" ref-type="fig">4</xref>e). This improvement was measured by the average Silhouette score in the embedding space, which is significantly larger for MultiMAP (Fig. <xref rid="Fig4" ref-type="fig">4</xref>e). We attribute the improved cluster separation seen in the MultiMAP plot to the fact that MultiMAP leverages all ~ 30 k genes, included genes that are present in only the scRNA-seq data, rather than only the ~ 1 k genes shared between the STARmap and scRNA-seq.</p>
      <p id="Par21">Integration with MultiMAP also enabled us to spatially locate all the joint cell types in the STARmap data, allowing study of the spatial structure of the tissue (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). The pyramidal neurons localize to layers 2–6 and oligodendrocytes localize to the layer below the cortex, whereas the interneurons do not appear to exhibit spatial organization. These observations are all consistent with the known spatial architecture of the mouse visual cortex [<xref ref-type="bibr" rid="CR25">25</xref>].</p>
      <p id="Par22">To investigate the performance of MultiMAP on the integration of more than two modalities, we applied the approach to integrate recently published multi-omics datasets of the mouse primary motor cortex [<xref ref-type="bibr" rid="CR26">26</xref>] consisting of 9 separate datasets, including 7 single-cell or single-nucleus transcriptomics datasets, one single-nucleus chromatin accessibility, and one single-nucleus DNA methylation (snmC-seq) dataset. MultiMAP successfully co-embedded more than 600,000 single-cell or single-nucleus samples assayed by six molecular modalities and identified the previously published cell subpopulations. The MultiMAP embedding displays good mixing of clusters from different modalities when the clusters correspond to the same cell type. Cell-type annotations were taken from the original publication of the data, so they provide a good ground truth and an independent validation of MultiMAP. We further see that cell types that exist in one modality, but not in the others, are not falsely aligned in the embedding space. This indicates that MultiMAP does not force incompatible data to integrate.</p>
      <p id="Par23">Finally, using the integration of scRNA-seq with the STARmap data, as well as the integration of the multi-omics spleen data, we assessed the impact of using only shared vs. all features. We find that using all features greatly improves the integration and results in embeddings that are visually and quantitatively superior, according to four performance metrics (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5). This illustrates that non-shared features can be extremely helpful and demonstrates an advantage of MultiMAP over other methods which do not consider non-shared features.</p>
    </sec>
    <sec id="Sec6">
      <title>Benchmarking</title>
      <p id="Par24">We assessed and benchmarked the performance of MultiMAP against several popular approaches for integrating single-cell multi-omics, including Seurat [<xref ref-type="bibr" rid="CR10">10</xref>], LIGER [<xref ref-type="bibr" rid="CR11">11</xref>], iNMF [<xref ref-type="bibr" rid="CR12">12</xref>], Conos [<xref ref-type="bibr" rid="CR29">29</xref>], and GLUER [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
      <p id="Par25">These integration approaches differ in key regards, summarized in Fig. <xref rid="Fig5" ref-type="fig">5</xref>d. We used a diversity of performance metrics to comprehensively compare MultiMAP with other approaches, including transfer accuracy, silhouette score, alignment, preservation of the structure, and runtime. With these metrics, we quantified the separation of the joint clusters, how well mixed the datasets were after integration and how well they preserved the structure in the original datasets to investigate whether the methods integrate populations across datasets without blending distinct populations together. To measure transfer accuracy and silhouette score, we use cell-type annotations generated by other publications or different members of our lab group as ground truth, to ensure an independent validation. Out alignment and structure preservation metrics are based on the structural qualities of MultiMAP’s output and do not rely on ground truth labels. This provides an orthogonal and complementary form of validation to using ground truth labels.
<fig id="Fig5"><label>Fig. 5</label><caption><p>Benchmarking MultiMAP against existing approaches. <bold>a</bold> Embeddings returned by multi-omic integration methods on different datasets. “X” indicates that the method terminated due to an out-of-memory error (218 GB RAM). <bold>b</bold> Comparison of each method in terms of transfer learning accuracy (“Transfer”), separation of cell type clusters as quantified by Silhouette coefficient (“Silhouette”), mixing of different datasets as measured by fraction of nearest neighbors that belong to a different dataset (“Alignment”), preservation of high-dimensional structure as measured by the Pearson correlation between distances in the high- and low-dimensional spaces (“Structure”), and runtime. <bold>c</bold> Wall-clock time of multi-omic integration methods on different sized datasets. Seurat, LIGER and iNMF produced out-of-memory errors when run on 500,000 data points (218 GB RAM). To produce these datasets we subsampled the mouse primary cortex scRNA-seq and scATAC-seq data [<xref ref-type="bibr" rid="CR26">26</xref>] using geometric sketching [<xref ref-type="bibr" rid="CR31">31</xref>]. The datasets were subsampled so that there are an equal number of cells in the scRNA-seq and scATAC-seq data until 100,000 cells. Since the scATAC-seq data had 81,196 cells in total, for the 500,000-cell comparison, we used an scRNA-seq of 418,804 cells. <bold>d</bold> Comparison of capabilities and properties of each method. “Mapping” refers to the nature of the mapping employed by the method; “Max no. datasets” refers to the upper limit in terms of numbers of datasets accepted by the method; “Scalable to large data” refers to allowing a total of over 500,000 cells; “Dataset-specific features” is whether the integration method allows information that is not shared across datasets; and “Dataset influence on integration” is whether the user can modulate the weighting of a given dataset relative to the others during the integration</p></caption><graphic xlink:href="13059_2021_2565_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par26">To this end, we generated single-nucleus data from human PBMCs using the Multiome ATAC + RNA kit. We obtained a PBMC atlas of 6344 nuclei of high-quality ATAC + RNA profiles. We analyzed and annotated the RNA and ATAC data separately, revealing all the known major PBMC types: CD14 and CD16 monocytes, cDCs and pDCs, naive and effector CD4 and CD8 T cells, Tregs, MAIT and gamma-delta T cells, NK and ILCs, naive and memory B cells, and plasmablasts (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6a). Most cell types were well separated in both modalities with the exception of the NK and ILC clusters and the gamma-delta and the CD8 effector T cells that blended together in the ATAC data.</p>
      <p id="Par27">We used the PBMCs as a gold standard dataset to benchmark MultiMAP against the four other methods. As shown in the co-embedding and the metrics, MultiMAP successfully integrated the cell types across modalities and outperformed other methods (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6b,c). The label transfer accuracy was particularly striking, with MultiMAP achieving a much higher score compared to other methods.</p>
      <p id="Par28">Furthermore, we also benchmarked MultiMAP using a variety of multi-omics data with published cell-type annotations, including the transcriptomics and chromatin accessibility spleen data, scRNA-seq and STARmap of the visual cortex, and the multi-omics data of the primary cortex. For all datasets, MultiMAP achieves top or near top performance on all metrics (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). a, bThe embeddings produced by MultiMAP prove superior for transferring cell-type annotations between datasets, separating clusters of different cell populations, integrating datasets in a well-mixed manner, and capturing the high-dimensional structure of each dataset.</p>
      <p id="Par29">Critically, MultiMAP is significantly faster and more scalable than all other benchmarked methods, and significantly faster than LIGER and Seurat (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). Seurat, LIGER and iNMF were not able to scale to the primary cortex data of 600 k, producing out-of-memory errors despite access to 218 GB of RAM.</p>
      <p id="Par30">Finally, to assess the performance of MultiMAP for batch correction, we also applied it to three scRNA-seq studies of the human pancreas [<xref ref-type="bibr" rid="CR32">32</xref>–<xref ref-type="bibr" rid="CR34">34</xref>] that were recently used for comparison of eight batch correction methods [<xref ref-type="bibr" rid="CR35">35</xref>]. Even though the main purpose of MultiMAP is the integration of several different omic technologies, MultiMAP outperformed all other well-established batch correction methods in the field, demonstrating that MultiMAP can correct batches and integrate multiple omics data simultaneously (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7).</p>
    </sec>
    <sec id="Sec7">
      <title>MultiMAP reveals patterns of T cell maturation along a multi-omic trajectory</title>
      <p id="Par31">Single-cell transcriptomics has enabled reconstruction of developmental trajectories and the study of dynamic processes such as differentiation and reprogramming. Bulk RNA-seq and ATAC-seq data have further revealed regulatory events driving these processes [<xref ref-type="bibr" rid="CR36">36</xref>]. However, joint analysis of single-cell expression and chromatin accessibility profiles along a time course trajectory would allow the study of dynamic chromatin regulation alongside gene expression, elucidating the epigenomic drivers of transcriptional change [<xref ref-type="bibr" rid="CR37">37</xref>, <xref ref-type="bibr" rid="CR38">38</xref>].</p>
      <p id="Par32">In order to investigate the potential of integrating multi-omic data along a common differentiation trajectory, we focused on T cell development in the thymus. The thymus is an organ essential for the maturation and selection of T cells. Precursor cells migrate from the fetal liver and bone marrow to the thymus where they develop into different types of mature T cells [<xref ref-type="bibr" rid="CR39">39</xref>]. We recently provided a comprehensive single-cell transcriptomics atlas of the human thymus during development, childhood, and adult life, and computationally predicted the trajectory of T cell development from early progenitors to mature T cells [<xref ref-type="bibr" rid="CR39">39</xref>]. To expand on this and further investigate the gene regulatory mechanisms driving T cell development, we generated single-cell transcriptomics and chromatin accessibility data from a human fetal thymus sample at 10 weeks of gestation.</p>
      <p id="Par33">Clustering of the scRNA-seq data revealed cell types identified in our recently published transcriptomic thymus cell atlas [<xref ref-type="bibr" rid="CR39">39</xref>], including several subpopulations of T cells across different stages of development, fibroblasts, endothelial cells, erythrocytes, thymic epithelial cells (TECs), NK and ILC3 cells, and macrophages and dendritic cells (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8). The sparse scATAC-seq and the continuous nature of cell types along the maturation trajectory made it difficult to cluster the ATAC cells into different T cell subtypes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8). However, the integration with MultiMAP and the joint clusters obtained using the MultiGraph corresponded to the published thymus cell types [<xref ref-type="bibr" rid="CR39">39</xref>] (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a, b), allowing us to correctly annotate the cell types of the scATAC-seq data. Comparison with other integration methods shows that MultiMAP, by taking advantage of all features, outperforms other integration methods (Additional file 1: Fig S8f).
<fig id="Fig6"><label>Fig. 6</label><caption><p>Integration of scRNAseq and scATAC-seq data of human fetal thymus reveals transcriptional regulatory principles of T cell development. <bold>a</bold> MultiMAP visualization of scRNA-seq and scATAC-seq datasets of the human fetal thymus (<italic>n</italic> = 1), colored by modality and joint clusters identified using the MultiGraph. <bold>b</bold> Heatmap of gene expression and gene activity scores of key markers of the joint clusters identified using the MultiGraph. <bold>c</bold> Inferred pseudotime using the MultiGraph recovers the T cell differentiation trajectory. Color indicates pseudotime from red (early, beginning) to blue (late, end). <bold>d</bold> Heatmap of the gene expression and gene activity scores over pseudotime of genes known to be involved in T cell development. <bold>e</bold> Smoothed heatmaps of the <italic>z</italic>-score of the gene expression and motif accessibility of the most variable transcription factors over pseudotime. The motif accessibilities of TFs that varied most in time show changes in accessibility at the transition between the late DN and early DP stage of differentiation. This includes TFs such as GATA3 and LEF1 for which the chromatin at the binding sites closes at that transition, and TFs for which the chromatin at the binding sites opens, such as E2F4, ETS1, and others</p></caption><graphic xlink:href="13059_2021_2565_Fig6_HTML" id="MO6"/></fig></p>
      <p id="Par34">We then selected the T cell populations identified from the joint clustering and performed diffusion map pseudotime analysis using the alignment MultiMAP graph. The reconstructed development trajectory showed a continuous differentiation with the same trend as the published study, starting from early double negative (DN) CD4-CD8-, gradually progressing to double positive (DP) CD4+ CD8+ T cells, and then differentiating into single positive (SP) mature CD8+ or CD4+ T cells. Hallmark genes of T cell differentiation varied along the inferred pseudotime in a manner consistent with [<xref ref-type="bibr" rid="CR39">39</xref>] (Fig. <xref rid="Fig6" ref-type="fig">6</xref>d), serving as validation of the trajectory inference and the integration produced by MultiMAP.</p>
      <p id="Par35">To identify transcription factors (TFs) that potentially regulate T cell development, we studied changes in TF expression and TF binding site accessibility along the differentiation trajectory. The top variable TFs/TF binding sites along the trajectory included many TFs that have been previously shown to be involved in T cell differentiation, including GATA3, SPI1, MEF2C, ERG, TCF3, TCF4, TFAP4, MYBL2, STAT1, NR4A2, and others [<xref ref-type="bibr" rid="CR36">36</xref>, <xref ref-type="bibr" rid="CR39">39</xref>, <xref ref-type="bibr" rid="CR40">40</xref>] (Fig. <xref rid="Fig6" ref-type="fig">6</xref>e, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9). The TFs that most varied along the trajectory showed changes in motif accessibility at the transition between the late DN and early DP stage of differentiation as shown before [<xref ref-type="bibr" rid="CR40">40</xref>].</p>
      <p id="Par36">Moreover, our integrated trajectory allowed us to identify TFs where changes in motif accessibility and expression of the TF itself were closely coordinated, for example LEF1, IRF1, REL, FOS, and others, suggesting that these TFs actively regulate their target genes immediately and directly (Fig. <xref rid="Fig6" ref-type="fig">6</xref>e). In contrast, for TFs such as ETS1 and JUN, gene expression of the TF significantly precedes the accessibility of the corresponding TF binding sites, suggesting that additional regulatory mechanisms are potentially required for opening of the TF motifs.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par37">Here we present a novel approach for dimensionality reduction and integration of multimodal data which considers full datasets, even when they have different feature spaces. MultiMAP embeds all datasets into a shared space to preserve both the manifold structure of each dataset independently, as well as in shared feature spaces. This enables both visualization and streamlined downstream analyses.</p>
    <p id="Par38">Existing integration methods require correspondence between all features profiled across omics technologies. In comparison, our method can incorporate different types of features, such as gene expression and open chromatin peaks or intergenic methylation, and thus takes advantage of the full power of multi-omics data. Ignoring the features unique to one dataset (as in most existing methods) may omit important information such as distinguishing features of certain subpopulations of cells, and thus yield an integrated embedding that does not distinctly cluster all subpopulations. Dataset-specific features often capture cell type or state heterogeneity not present in the shared features, for instance, cells may exhibit heterogeneity in chromatin structure outside of genes, or heterogeneity in genes other than the very small number of ~ 1000 genes shared by different technologies, as in the case of integrating scRNA with spatial data. Discarding this heterogeneity potentially stifles the discovery of new cell types or states. In addition, our integrated MultiGraph enables inference of joint developmental or differentiation trajectories that allow the study of dynamic chromatin regulation alongside gene expression. Using non-shared features that account for the full epigenetic landscape of cells, including distal enhancers, could help identify novel regulatory elements.</p>
    <p id="Par39">Another limitation is that linear integration approaches such as CCA and NMF are not able to correct for nonlinear distortions between datasets. In contrast, MultiMAP uses a nonlinear manifold learning approach and we demonstrate that it can effectively integrate in the presence of nonlinear differences between datasets. We find this to be a significant advantage of MultiMAP both for multi-omic integration and batch correction. Crucially, some methods such as LIGER, Seurat, and other CCA or NMF approaches are challenged by scaling to large datasets because they require matrix factorization. In contrast, MultiMAP readily scales to hundreds of thousands of cells due to its graph-based algorithm.</p>
    <p id="Par40">An additional feature of MultiMAP, not present in other existing strategies, is that the influence of each dataset on the shared embedding can be modulated. This is useful when integrating datasets of different qualities, or when aligning a query dataset to a reference dataset. Comparison with existing methods for integration shows that MultiMAP outperforms or has close to best performance in every aspect investigated. MultiMAP is a robust and effective method for dimensionality reduction and integration of multimodal data and is extremely fast and scalable to massive datasets.</p>
    <p id="Par41">Using synthetic examples to illustrate the power of the method, we show that MultiMAP leverages the features unique to each dataset to effectively integrate and reduce the dimensionality of the data and is also robust to data with noise. Throughout our applications of MultiMAP to diverse single-cell multi-omic data, we demonstrate that our method can facilitate integration across transcriptomic, epigenomic, and spatially resolved datasets and derive biological insights jointly from multi-omic single-cell data. In addition, our method can align datasets across different technologies and modalities even with extensive biological and technical differences. Crucially, we show that MultiMAP is flexible enough to integrate datasets with different clusters and cell populations, illustrating that MultiMAP is applicable even when its central hypothesis is not strictly reflected by the data. The multimodal integration of three or more omics technologies opens many opportunities for the comprehensive study of tissues.</p>
    <p id="Par42">We note that our method is based on the hypothesis that multi-omics data are uniformly distributed on a latent manifold. A hypothesis of this sort, about the distribution of data in a latent space, is a central feature of many existing integration strategies. For example, CCA-based strategies (including Seurat and Conos) assume that the data reside in a maximally correlated manner in a latent space which is a linear projection of the original data. MultiMAP, in contrast, does not make as strong an assumption because we do not restrict the latent manifold to a linear projection of the data. While this kind of hypothesis is often realistic for data generated from the same tissue, there may be cases where this is not strictly the case. In practice, we find that MultiMAP can successfully accommodate datasets that depart from this central hypothesis, i.e., when clusters and cell populations are not shared across all datasets that are being integrated.</p>
    <p id="Par43">Perhaps the greatest potential lies in applying MultiMAP to datasets beyond those considered here. Integrative analysis with MultiMAP can be used to compare healthy and diseased states and identify pathologic features, or to uncover cell-type-specific responses to perturbations. Other examples include the integration of data across species to study the evolution of cell states and identify conserved cell types and regulatory programs. Along similar lines, the integration of in vivo with in vitro models such as organoids will reveal the quality or faithfulness of cells in a dish relative to their native counterparts. Finally, given the rapid development of joint multimodal single-cell genomics methods (e.g., CITEseq for protein and RNA, joint snRNA-, and ATACseq), it is relevant to point out that MultiMAP can be applied to multi-omic data acquired both from different cells and from the same cells.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par44">In this study, we introduce a novel algorithm for dimensionality reduction and integration of multiple datasets, which generalizes the UMAP algorithm to the setting of multiple datasets with different dimensions. MultiMAP is a nonlinear manifold learning algorithm that recovers a single manifold on which several datasets reside and then projects the data into a single low-dimensional space so as to preserve the manifold structure. It can be used for visualization of multimodal data, and as an integration approach that enables joint analyses.</p>
    <p id="Par45">We apply MultiMAP to the integration of a variety of single-cell transcriptomics, chromatin accessibility, methylation, and spatial data and show that it outperforms current approaches in preservation of high-dimensional structure, alignment of datasets, visual separation of clusters, transfer learning, and runtime. Furthermore, MultiMAP enables joint analysis of single-cell expression and chromatin accessibility profiles along a time course trajectory, allowing the study of dynamic chromatin regulation alongside gene expression.</p>
    <p id="Par46">In summary, given the broad appeal of dimensionality reduction methods (e.g., PCA, tSNE, UMAP), and the growth of multimodal data in many areas of science and engineering, we anticipate that MultiMAP will find wide and diverse use.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>MultiMAP</title>
      <p id="Par47">MultiMAP (Fig. <xref rid="Fig1" ref-type="fig">1</xref>) is a new approach for the integration and dimensionality reduction of multimodal data based on a framework of Riemannian geometry and algebraic topology. MultiMAP takes as input any number of datasets of potentially differing dimensions. The datasets take the form <bold><italic>X</italic></bold><sup><italic>i</italic></sup><italic>, i</italic> = 1,2,…, with <bold><italic>x</italic></bold><sub><italic>j</italic></sub><sup><italic>i</italic></sup> ∈ <italic>R</italic><sup>Di</sup> being the <italic>j</italic>th point in dataset <bold><italic>X</italic></bold><sup><italic>i</italic></sup>. MultiMAP recovers geodesic distances on a single latent manifold <italic>M</italic> on which all of the data is uniformly distributed. The geodesic distances are calculated between data points of the same dataset by normalizing distances in each dataset’s ambient space <italic>X</italic><sup><italic>ii</italic></sup> with respect to a neighborhood distance specific to the dataset, and between data points of different datasets by normalizing distances between the data in a shared ambient space <italic>X</italic><sup><italic>ij</italic></sup> with respect to a neighborhood distance specific to the shared feature space. We note that MultiMAP leverages both shared and unshared features. We do not wish for our approach to rely only on unmatched features because correspondence between shared features provides valuable information across omics. When integrating multi-omics data with MultiMAP, the ambient spaces are the PC components of each dataset’s full feature space and of the shared feature space(s). These neighborhood distances are the radius of a constant-radius ball <italic>B</italic> on <italic>M</italic>. These distances are then used to construct a neighborhood graph (MultiGraph) on the manifold. Finally, the data and manifold space are projected into a low-dimensional embedding space by minimizing the cross entropy of the graph in the embedding space with respect to the graph in the manifold space. Specifically, this optimization minimizes cross entropy of a fuzzy set–representation (<italic>ν</italic>, {<bold><italic>x</italic></bold><sub><italic>j</italic></sub><sup><italic>i</italic></sup>}) of the graph in the embedding space with respect to a fuzzy set–representation (<italic>μ</italic>, {<bold><italic>x</italic></bold><sub><italic>j</italic></sub><sup><italic>i</italic></sup>}) of the graph in the manifold space. MultiMAP allows the user to modify the weight <italic>ω</italic><sup><italic>i</italic></sup> of each dataset in the cross entropy loss, allowing the user to modulate the contribution of each dataset to the layout. Integrated analysis can be performed on the embedding or the graph, and the embedding also provides an integrated visualization. MultiMAP is novel in its graph construction on the shared manifold, the weights of the graph’s edges, and the optimization of the low-dimensional embedding, each of which is motivated by manifold geometry. An extended description of MultiMAP, including mathematical background and motivation, is in the Supplementary information.</p>
    </sec>
    <sec id="Sec12">
      <title>Synthetic data</title>
      <p id="Par48">MultiMAP was applied to two synthetic examples of multimodal data, in order to study the technique in a controlled setting.</p>
      <p id="Par49">The first synthetic setting is schematized in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a. This setting consists of one dataset (<bold><italic>X</italic></bold><sup>1</sup>) of 10,000 points sampled randomly from the canonical 3D “Swiss roll” surface (generated with sklearn in Python), and a second dataset (<bold><italic>X</italic></bold><sup>2</sup>) of 10,000 points sampled randomly from a 2D rectangle. The two datasets can be considered multimodal data because they have different feature spaces but describe a similar rectangular manifold. In addition, we are given the position along the manifold of 1% of the data. Distances between data in the different datasets are calculated for 1% of the data as the absolute differences between these positions. These distances are supplied to MultiMAP. The purpose of this setting is to determine if MultiMAP can integrate data in a nonlinear fashion and operate on datasets of different dimensionality.</p>
      <p id="Par50">The second synthetic setting is schematized in Fig. <xref rid="Fig2" ref-type="fig">2</xref>c. This setting consists of two datasets based on the MNIST database [<xref ref-type="bibr" rid="CR41">41</xref>] which comprises 70,000 28 × 28 pixel grayscale images of handwritten digits 0–9. The first dataset (<bold><italic>X</italic></bold><sup>1</sup>) consists of the 28 × 15 pixel left half of each of images flattened into a 420 dimensional vector. The second dataset (<italic>X</italic><sup>2</sup>) consists of the 28 × 15 pixel right half of each of 70,000 digit images, also flattened into a 420 dimensional vector. Added to the first dataset is Gaussian noise with a mean of zero and a standard deviation equal to the maximum pixel value. The two halves overlap by a 28 × 2 pixel region. Distances between data in the different datasets are calculated in this shared space and supplied to MultiMAP. The two datasets can be considered multimodal because they have different feature spaces but describe a similar population of digit images. The purpose of this setting is to determine if MultiMAP can effectively leverage features unique to certain datasets. The thin overlapping region of the two halves is not enough information to create a good embedding of the data. Many distinct digits are similar in this thin central sliver, and hence they should cluster together in the feature space of the two pixel overlap. Indeed, in a UMAP projection of the data in the shared feature space of this overlap, the clusters of different digits are not as well separated as in the UMAP projections of each half (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). A multimodal integration strategy that effectively leverages all features would use the features unique to each half to separate different digits, and the shared space to bring the same digits from each dataset close together.</p>
    </sec>
    <sec id="Sec13">
      <title>Acquisition and processing of human fetal thymic tissue</title>
      <p id="Par51">The developmental age was estimated from measurements of foot length and heel-to-knee length, and compared against a standard growth chart [<xref ref-type="bibr" rid="CR42">42</xref>]. A piece of skin was collected from every sample for Quantitative Fluorescence-Polymerase Chain Reaction analysis using markers for the sex chromosomes and the following autosomes: 13, 15, 16, 18, 21, 22. The sample was of normal karyotype.</p>
      <p id="Par52">The tissue was processed immediately after isolation using enzymatic digestion. Tissue was transferred to a sterile 10 mm<sup>2</sup> tissue culture dish and cut into &lt; 1 mm<sup>3</sup> segments before being transferred to a 50-mL conical tube. Tissues were digested with 1.6 mg/mL collagenase type IV (Worthington) in RPMI (Sigma-Aldrich) supplemented with 10% (v/v) heat-inactivated fetal bovine serum (FBS; Gibco), 100 U/mL penicillin (Sigma-Aldrich), 0.1 mg/mL streptomycin (Sigma-Aldrich), and 2 mM L-glutamine (Sigma-Aldrich) for 30 min at 37 °C with intermittent shaking. Digested tissue was passed through a 100-μm filter, and cells collected by centrifugation (500<italic>g</italic> for 5 min at 4 °C). Cells were treated with 1× red blood cells (RBC lysis buffer (eBioscience) for 5 min at room temperature and washed once with a flow buffer (PBS containing 5% (v/v) FBS and 2 mM EDTA) prior to cell counting. For scATAC-seq, cells were taken forward for nuclei isolation following 10X Genomics guidelines. Briefly, cells were centrifuged (300<italic>g</italic> for 5 min), added the lysis buffer (Tris-HCl (pH 7.4) 10 mM; NaCl 10 Mm; MgCl<sub>2</sub> 3 mM; Tween-20 0.1%; NP-40 0.1%; Digitonin 0.01%; BSA 1%) and incubated on ice for 3 min (time optimized for thymus). Following the incubation, cells were washed (Tris-HCl (pH 7.4) 10 mM; NaCl 10 Mm; MgCl2 3 mM; BSA 1%; Tween-20 0.1%) and centrifuged (300<italic>g</italic> for 5 min) and nuclei were resuspended in Diluted Nuclei Buffer (10X Genomics). Isolated nuclei were high-quality with well-resolved edges and no evidence of blebbing. The final nuclei concentration was determined prior to loading using a hemocytometer.</p>
    </sec>
    <sec id="Sec14">
      <title>Single-cell RNA and ATAC sequencing of human thymus</title>
      <p id="Par53">scRNA-seq targeting 5000 cells per sample was performed using the Chromium Controller (10X Genomics). Single-cell cDNA synthesis, amplification, and sequencing libraries were generated using the Single Cell 5’ Reagent Kit following the manufacturer’s instructions. The libraries from up to eight loaded channels were multiplexed together and sequenced on an Illumina HiSeq 4000.</p>
      <p id="Par54">scATAC-seq targeting 5000 cells was performed using Chromium Single Cell ATAC Library and Gel Bead kit (10X Genomics). The libraries from up to eight loaded channels were multiplexed together and sequenced on an Illumina HiSeq 4000.</p>
    </sec>
    <sec id="Sec15">
      <title>Computational processing and analysis of the human fetal thymus single-cell genomics data</title>
      <p id="Par55">scRNA-seq data were aligned and quantified using the Cell Ranger Single-Cell Software Suite (version 2.0, 10X Genomics) against the GRCh38 human reference genome provided by Cell Ranger. The scRNA-seq data was preprocessed using Seurat. Cells with fewer than 500 detected genes and more than 10% mitochondrial gene expression content were removed. Ribosomal genes, cell cycle genes [<xref ref-type="bibr" rid="CR39">39</xref>], and genes associated with dissociation-induced effects [<xref ref-type="bibr" rid="CR43">43</xref>] were removed. Clusters were identified using a community identification algorithm as implemented in the Seurat “FindClusters” function and annotated using canonical cell-type markers from [<xref ref-type="bibr" rid="CR39">39</xref>].</p>
      <p id="Par56">The scATAC-seq data was aligned and preprocessed using CellRanger (10X Genomics). SnapATAC [<xref ref-type="bibr" rid="CR44">44</xref>] was used for quality control, preprocessing, and generating cell-by-bin and log-normalized gene activity matrices. The binarized cell-by-bin matrix was used as input for term frequency-inverse document frequency (TF-IDF) weighting, using term frequency and smoothed inverse document frequency as the weighting scheme. Singular-value decomposition (SVD) was used for dimensionality reduction. Clustering and UMAP visualization were performed using Seurat. chromVar [<xref ref-type="bibr" rid="CR45">45</xref>] was used to discover transcription factor dynamics and variation in their motif accessibility.</p>
      <p id="Par57">The 50 dimension reduced scATAC-seq and the 50 dimension reduced scRNA-seq data were supplied as input to MultiMAP. A shared feature space with both the scATAC-seq and scRNA-seq was constructed by removing genes from each dataset that were not present in the other, and then reducing the space to 50 dimensions using PCA. This shared space was supplied as input to MultiMAP, allowing the calculation of distances between cells from different datasets. The parameters of MultiMAP were all set to their default values, including the weight parameter for the scRNA-seq set to 0.8 and for ATAC-seq set to 0.2, on account of the higher-quality scRNA-seq.</p>
      <p id="Par58">The Leiden algorithm [<xref ref-type="bibr" rid="CR46">46</xref>] was applied directly to the MultiGraph to jointly cluster all cells. The clusters were then annotated using canonical cell-type markers from [<xref ref-type="bibr" rid="CR39">39</xref>]. Diffusion pseudotime (DPT) [<xref ref-type="bibr" rid="CR47">47</xref>] was used for trajectory inference. The MultiGraph was supplied as input to the DPT function in SCANPY [<xref ref-type="bibr" rid="CR48">48</xref>]. DPT was performed only on cells annotated as T cells. Cells were removed if they were positioned away from T cell clusters and close to fibroblasts and erythrocytes on the MultiMAP plot, as this likely indicated that they were incorrectly annotated. tradeSeq [<xref ref-type="bibr" rid="CR49">49</xref>] was used to identify genes whose expression changes significantly along the trajectory.</p>
    </sec>
    <sec id="Sec16">
      <title>Acquisition and processing of human PBMCs</title>
      <p id="Par59">PBMCs from two donors were acquired from a LeukoLab (Clinical division of AllCells). Frozen PBMC samples were thawed quickly at 37 °C in a water bath. Two pools made for technical duplicates with ~ 500,000 cells for each donor per pool (50/50). Nuclei isolation, transposition, ATAC-seq, and Gene Expression (GEX) sequencing libraries construction performed according to the manufacturer’s demonstrated protocol (CG000365 Rev A; 10X Genomics) and Next GEM Single Cell Multiome ATAC and Gene Expression user guide (CG000338 Rev A; 10X Genomics). One lane per pool with a 3000 targeted nuclei recovery was loaded on a Chromium Next GEM Chip J. ATAC-seq and GEX indexed libraries were sequenced on a NovaSeq 6000 SP Flowcell according to the 10X Genomics recommendations, aiming for a minimum of 50,000 PE reads per cell for both types (ATAC-Seq and GEX) libraries.</p>
    </sec>
    <sec id="Sec17">
      <title>Computational processing and analysis of the human PBMCs Multiome ATAC+RNA data</title>
      <p id="Par60">snRNA-seq and snATAC-seq data were aligned and quantified using the Cell Ranger ARC suite (10X Genomics) against the GRCh38 human reference genome provided by Cell Ranger. The snRNA-seq data was preprocessed using Seurat. Cells with fewer than 500 detected genes and more than 20% mitochondrial gene expression content were removed. Clusters were identified using a community identification algorithm as implemented in the Seurat “FindClusters” function and annotated using canonical cell-type markers.</p>
      <p id="Par61">SnapATAC [<xref ref-type="bibr" rid="CR44">44</xref>] was used for quality control, preprocessing, and generating cell-by-bin and log-normalized gene activity matrices for the snATAC-seq data. The binarized cell-by-bin matrix was used as input for term frequency-inverse document frequency (TF-IDF) weighting, using term frequency and smoothed inverse document frequency as the weighting scheme. SVD was used for dimensionality reduction. Clustering and UMAP visualization were performed using Seurat.</p>
      <p id="Par62">The 50 dimension reduced snATAC-seq and the 50 dimension reduced snRNA-seq data were supplied as input to MultiMAP. A shared feature space with both the snATAC-seq and snRNA-seq was constructed by removing genes from each dataset that were not present in the other, and then reducing the space to 50 dimensions using PCA. This shared space was supplied as input to MultiMAP, allowing the calculation of distances between cells from different datasets. The parameters of MultiMAP were all set to their default values, including the weight parameter for the snRNA-seq set to 0.8 and for snATAC-seq set to 0.2, on account of the higher-quality snRNA-seq.</p>
    </sec>
    <sec id="Sec18">
      <title>Single-cell RNA sequencing of mouse spleen and data processing</title>
      <p id="Par63">The spleen from a 6-month-old C57BL/6Jax mouse was removed. The splenocytes were isolated by passing the spleen through a 70-μm cell strainer (Fisher Scientific 10788201) into 30-m ice-cold 1× DPBS (Thermo Fisher 14190169) with 2 mM EDTA and 0.5% (w/v) BSA (Sigma A9418) using the plunger of a 2-ml syringe. Cells were spun down at 500<italic>g</italic> for 7 min at 4°. Then the supernatant was removed, and the cell pellet resuspended in 5 ml 1× RBC lysis buffer (Thermo Fisher 00-4300-54). The cell suspension was vigorously vortexed for 5 s and left on the bench for 5 min to lyse the red blood cells. Then, 45 ml ice-cold 1× DPBS was added, and cells were spun down at 500<italic>g</italic> for 7 min at 4°. The supernatant was removed, and 30 ml ice-cold 1× DPBS with 0.1% BSA was used to resuspend the cell pellet. The cell suspension was passed through a Miltenyi 30 μm Pre-Separation Filter (Miltenyi 130-041-407), and the cell number was determined using the C-chip counting chamber (VWR DHC-N01). The cells were spun down again, and the cell pellet resuspended in ice-cold 1× DPBS with 0.1% BSA to reach a concentration of 1,000,000 cells per ml. The splenocytes were then loaded on the 10x Chromium Controller, aiming to recover ~ 5000 cells (Targeted Cell Recovery 5000 cells). cDNA and a sequencing library were made according to 10x Single Cell 3’ Reagent Kits v2 manual. The library was sequenced on an Illumina HiSeq 4000 machine.</p>
      <p id="Par64">The resulting scRNA-seq data were preprocessed using CellRanger (10X Genomics) and downstream analysis were performed using the Seurat workflow. Cells with fewer than 200 detected genes and more than 10% mitochondrial gene expression content were filtered out. Downstream analyses such as normalization, clustering, and visualization were performed using Seurat. Clusters were identified using the community identification algorithm as implemented in the Seurat “FindClusters” function. Clusters were annotated using canonical cell-type markers from the original study [<xref ref-type="bibr" rid="CR22">22</xref>]. Scrublet [<xref ref-type="bibr" rid="CR50">50</xref>] was used for doublet detection.</p>
    </sec>
    <sec id="Sec19">
      <title>Acquisition and processing of previously published datasets</title>
      <p id="Par65">The mouse spleen scATAC-seq data was obtained from ArrayExpress (E-MTAB-6714) and preprocessed using the code provided by Chen et al. [<xref ref-type="bibr" rid="CR22">22</xref>] (<ext-link ext-link-type="uri" xlink:href="https://github.com/dbrg77/plate_scATAC-seq">https://github.com/dbrg77/plate_scATAC-seq</ext-link>). Briefly, reads from all cells were merged, and open chromatin regions were identified by peak calling with MACS2 [<xref ref-type="bibr" rid="CR51">51</xref>]. Latent semantic indexing analysis was used for dimensionality reduction of the resulting cell-by-bin matrix. The binary cell-by-bin accessibility was used as input for TF-IDF weighting, using term frequency and smoothed inverse document frequency as the weighting scheme. SVD was used for dimensionality reduction. SnapATAC [<xref ref-type="bibr" rid="CR44">44</xref>] was used to generate gene activity count matrices, which were then log-normalized. The 50 dimension reduced accessibility of the scATAC-seq and the 50 dimension reduced gene expression of the scRNA-seq data were supplied as input to MultiMAP. A shared feature space with both the scATAC-seq and scRNA-seq was constructed by removing genes from each dataset that were not present in the other, and then reducing the space to 50 dimensions using PCA. This shared space was supplied as input to MultiMAP, allowing the calculation of distances between cells from different datasets. The parameters of MultiMAP were all set to their default values, including the weight parameter for the scRNA-seq set to 0.8 and for ATAC-seq set to 0.2 due to the higher-quality scRNA-seq. The Leiden algorithm was applied directly to the MultiGraph to jointly cluster all cells. Harmonic function-based node classification was performed directly on the MultiGraph to predict cell types of the scATAC-seq cells given the cell types of the scRNA-seq cells [<xref ref-type="bibr" rid="CR52">52</xref>].</p>
      <p id="Par66">Human hematopoiesis scRNA-seq and scATAC-seq data were downloaded from <ext-link ext-link-type="uri" xlink:href="https://github.com/GreenleafLab/MPAL-Single-Cell-2019">https://github.com/GreenleafLab/MPAL-Single-Cell-2019</ext-link>. The scRNA-seq consists of 6 experimental batches, and the scATAC-seq consists of 10 experimental batches. Severe batch effects were observed, so this data was considered to consist of 16 separate datasets for the integration with MultiMAP. The scRNA-seq data was preprocessed using Seurat, and each batch was log-normalized and reduced to 50 dimensions with PCA. The cell-by-bin peak accessibility was used as provided by the authors. The binary cell-by-bin accessibility was used as input for TF-IDF weighting, using term frequency and smoothed inverse document frequency as the weighting scheme. Separately for each batch, the weighted data were reduced to 50 dimensions using SVD. Gene activities of the ATAC data were calculated using Cicero [<xref ref-type="bibr" rid="CR53">53</xref>] and log-normalized. To integrate all of the data at once, all 16 datasets were provided as input to MultiMAP in the form of the 50 dimension reduced accessibility data of the scATAC-seq and the 50 dimension reduced gene expression of the scRNA-seq. Shared feature spaces containing two datasets were constructed by removing genes from each of the datasets that were not present in the other, and then reducing the space to 50 dimensions using PCA. These shared spaces were supplied as input to MultiMAP to calculate distances between cells from different datasets. The parameters of MultiMAP were all set to their default values, including the weight parameter for the scRNA-seq set to 0.8 and for ATAC-seq set to 0.2 due to the higher-quality scRNA-seq data.</p>
      <p id="Par67">scRNA-seq data of the mouse frontal cortex acquired with Drop-seq was obtained from <ext-link ext-link-type="uri" xlink:href="http://dropviz.org">dropviz.org</ext-link>. STARmap data of the mouse visual cortex was downloaded from <ext-link ext-link-type="uri" xlink:href="https://www.starmapresources.com/data/">https://www.starmapresources.com/data/</ext-link>. Each dataset was separately preprocessed with Seurat [<xref ref-type="bibr" rid="CR10">10</xref>], log-normalized, and reduced to 50 dimensions with PCA. Both 50 dimensional reduced datasets were supplied as input to MultiMAP. A shared feature space with both the STARmap and scRNA-seq data was constructed by removing genes from each dataset that were not present in the other, and then reducing the space to 50 dimensions using PCA. This shared space was supplied as input to MultiMAP to calculate distances between cells from different datasets. The parameters of MultiMAP were all set to their default values, including the weight parameter for the scRNA-seq set to 0.8 and for Drop-seq set to 0.2, on account of higher-quality, tighter clusters generally observed in the scRNA-seq.</p>
      <p id="Par68">scRNA-seq, scATAC-seq, and snmC-seq data from the mouse primary cortex [<xref ref-type="bibr" rid="CR26">26</xref>] was downloaded from the Neuroscience Multi-omics Archive (NeMO). The scRNA-seq was preprocessed using Seurat, log-normalized, and reduced to 50 dimensions with PCA. The binary cell-by-bin accessibility and gene activity count matrix of the scATAC-seq were obtained with SnapATAC [<xref ref-type="bibr" rid="CR44">44</xref>]. The gene activity count data was log-normalized. Latent semantic indexing analysis was used for dimensionality reduction of the scATAC-seq accessibility. The binary cell-by-bin accessibility was used as input for TF-IDF weighting, using term frequency and smoothed inverse document frequency as weighting scheme. Weighted data were reduced to 50 dimensions using SVD. The DNA methylation data was preprocessed as described in [<xref ref-type="bibr" rid="CR54">54</xref>], using the provided scripts. Briefly, after mapping, the methyl-cytosine counts and total cytosine counts were calculated in two sets of genome regions for each cell: the non-overlapping 100-kb bins tiling the mm10 genome, which was used for dimensionality reduction, and gene body regions ± 2 kb, which is used for the joint alignment. Posterior mCH and mCG rates were calculated based on beta-binomial distribution for the non-overlapping 100-kb bins matrix. The top 3000 highly variable features were taken and the data was reduced to 50 dimensions with PCA. Because gene body mCH proportions are negatively correlated with gene expression level, the direction of the methylation data was reversed by subtracting all values from the maximum methylation value [<xref ref-type="bibr" rid="CR11">11</xref>]. The 50 dimensional reduced scRNA-seq, scATAC-seq, and snmC-seq were supplied as input to MultiMAP. Shared feature spaces containing each pair of two datasets and all three datasets together were constructed by removing genes from each of the datasets that were not present in the other, and then reducing the space to 50 dimensions using PCA. These shared spaces were supplied as input to MultiMAP, allowing the calculation of distances between cells from different datasets. The parameters of MultiMAP were all set to their default values. The weight parameter for the scRNA-seq set to 0.8 and for the other omics set to 0.2, on account of the higher-quality scRNA-seq data.</p>
    </sec>
    <sec id="Sec20">
      <title>Benchmarking</title>
      <p id="Par69">Benchmarking of MultiMAP, Seurat v3, LIGER, iNMF, Conos, and GLUER was performed using a variety of multi-omic data including the scRNA-seq and scATAC-seq data of the spleen, scRNA-seq, and STARmap of the visual cortex, and the scRNA-seq, scATAC-seq, and snmC-seq of the primary cortex. These datasets were chosen because they all have cell type annotations supplied in their original publications, which was used to independently validate the integration.</p>
      <p id="Par70">The scRNA-seq and STARmap data was log-normalized using Seurat and then used as an input for all integration methods, except GLUER where the raw data was used as an input and preprocessed using the SCANPY workflow. The scATAC-seq data was preprocessed as described above and the log-normalized gene activity matrix was used as an input for all integration methods. Seurat, LIGER, iNMF, Conos, and GLUER were executed as detailed in their tutorials, with all parameters set to their default values. Latent Semantic Indexing was used as the dimensionality reduction technique for the scATAC-seq data for weighting anchors in Seurat 3. CCA was used as the dimensionality reduction technique for the scRNA-seq and STARmap data for weighting anchors in Seurat.</p>
      <p id="Par71">A diversity of performance metrics was used. After integration, label transfer of the cell type annotations from the scRNA-seq to each other omic was performed by setting the cell type of a query cell to the most frequent type among its 5 nearest labeled neighbors. The balanced accuracy of the label transfer (“Transfer”) was calculated using the annotations from the original publications as the ground truth. A high accuracy indicates that the same cell types from different modalities are near each other in the integrated embedding. After integration, the average Silhouette score [<xref ref-type="bibr" rid="CR55">55</xref>] (“Silhouette”) across all cells was calculated using the cell type annotations from the original publications as the cluster labels. We note that the Silhouette score is not affected by the number of clusters as we use the same cell type labels, and hence number of clusters, for each integration method. A higher Silhouette score indicates the embedding is better separating distinct cell types. The degree of alignment (“Alignment”) of the different datasets in the integrated embedding was calculated as the proportion of each cell’s 5 nearest neighbors that originated in a different dataset, averaged over all cells. This metric was also used in [<xref ref-type="bibr" rid="CR11">11</xref>]. A higher value of the alignment score indicates that the different datasets are more evenly mixed in the integrated embedding. The degree to which the embedding preserves the high-dimensional structure (“Structure”) of each dataset was calculated as the Pearson correlation between all pairwise distances in the high-dimensional spaces and the corresponding distances in the embedding. A higher correlation indicates that the embedding is more faithful to the high-dimensional structure. All of these performance metrics were also calculated in the shared feature space of the datasets to be integrated, to get baseline values of the metrics prior to the application of any integration strategy.</p>
      <p id="Par72">The wall-clock runtime of each method on each dataset was recorded. Additionally, to characterize the runtimes of the methods on a wide range of dataset sizes, the integration methods were run on datasets ranging from 1000 to 500,000 cells. To produce these datasets, we subsampled the mouse primary cortex scRNA-seq and scATAC-seq data [<xref ref-type="bibr" rid="CR26">26</xref>] using geometric sketching [<xref ref-type="bibr" rid="CR31">31</xref>]. The datasets were subsampled so that there were an equal number of cells in each of the scRNA-seq and scATAC-seq datasets, up to 100,000 cells. Since the scATAC-seq data had 81,196 cells in total, for the 500,000-cell comparison, we used an scRNA-seq of 418,804 cells. All methods were run with 3.1 GHz Intel i7 cores and 218 GB RAM.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec21">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2021_2565_MOESM1_ESM.docx">
            <caption>
              <p>
                <bold>Additional file 1: Figures S1-S9</bold>
              </p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2021_2565_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2.</bold> Supplementary Methods</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2021_2565_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 3.</bold> Review history</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Jana Eliasova for the graphical illustrations. We are grateful to Emma Dann, Natsuhiko Kumasaka, and Zhihan Xu for critical feedback on the manuscript. We thank Ruben Chazarra-Gil and Vladimir Yu Kiselev for the comparison of different batch correction methods on the pancreas dataset. M.S.J. was supported by a Gates Cambridge Scholarship. J.-E.P. was supported by EMBO Long-Term and Advanced Fellowships. M.E. is funded by a Barts Charity Lectureship (MGU045). S.A.T. is funded by Wellcome (WT206194). The study was supported by Wellcome Human Cell Atlas Strategic Science Support (WT211276/Z/18/Z) and the Chan Zuckerberg Initiative (CZF2019-002445).</p>
    <sec id="FPar1">
      <title>Review history</title>
      <p id="Par73">The review history is available as Additional file <xref rid="MOESM3" ref-type="media">3</xref>.</p>
    </sec>
    <sec id="FPar2">
      <title>Peer review information</title>
      <p id="Par74">Barbara Cheifet was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>M.S.J., M.E., and S.A.T. conceived the study. M.S.J conceived and developed MultiMAP. M.S.J, created the codebase with contributions from K.P. and M.E.. C.D.C., J.-E.P., R.A.B, E.S, L.M., A.E., and X.C. generated the single-cell data. M.E. analyzed the data and interpreted the results with contributions from M.S.J. and S.A.T. M.S.J., M.E., and S.A.T. wrote the manuscript with contributions from A.L., X.C., and C.D.C. All authors read and accepted the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>scRNA-seq and scATAC-seq data generated for this publication were deposited in ArrayExpress: E-MTAB-9769 [<xref ref-type="bibr" rid="CR56">56</xref>] for scRNA-seq of mouse splenocytes, E-MTAB-9840 [<xref ref-type="bibr" rid="CR57">57</xref>] and E-MTAB-9828 [<xref ref-type="bibr" rid="CR58">58</xref>] for scRNA-seq and scATAC-seq of the thymus, ArrayExpress. E-MTAB-11225 and E-MTAB-11226 [<xref ref-type="bibr" rid="CR59">59</xref>] for the Multiome RNA + ATAC PBMC data.</p>
    <p>MultiMAP is publicly available at github.com/Teichlab/MultiMAP [<xref ref-type="bibr" rid="CR60">60</xref>] and zenodo [<xref ref-type="bibr" rid="CR61">61</xref>].</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar3">
      <title>Ethics approval and consent to participate</title>
      <p id="Par75">The thymus tissue sample used for this study was obtained with written informed consent from the participant in accordance with the guidelines in The Declaration of Helsinki 2000. The human fetal tissue was obtained from the MRC/Wellcome Trust-funded Human Developmental Biology Resource (HDBR, <ext-link ext-link-type="uri" xlink:href="http://www.hdbr.org">http://www.hdbr.org</ext-link>) with appropriate maternal written consent and approval from the Newcastle and North Tyneside NHS Health Authority Joint Ethics Committee (08/H0906/21 + 5). HDBR is regulated by the UK Human Tissue Authority (HTA; <ext-link ext-link-type="uri" xlink:href="http://www.hta.gov.uk">www.hta.gov.uk</ext-link>) and operates in accordance with the relevant HTA Codes of Practice.</p>
      <p id="Par76">The mice for the splenocyte data were maintained under specific pathogen-free conditions at the Wellcome Trust Genome Campus Research Support Facility (Cambridge, UK). These animal facilities are approved by and registered with the UK Home Office. All procedures were in accordance with the Animals (Scientific Procedures) Act 1986. The protocols were approved by the Animal Welfare and Ethical Review Body of the Wellcome Trust Genome Campus.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par77">S.A.T. has received remunerations for consulting and Scientific Advisory Board work from Genentech, Biogen, Roche, and GlaxoSmithKline as well as Foresite Labs over the past 3 years.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stoeckius</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hafemeister</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title>
        <source>Nat Methods.</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>9</issue>
        <fpage>865</fpage>
        <lpage>868</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4380</pub-id>
        <?supplied-pmid 28759029?>
        <pub-id pub-id-type="pmid">28759029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peterson</surname>
            <given-names>VM</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>KX</given-names>
          </name>
        </person-group>
        <article-title>Multiplexed quantification of proteins and transcripts in single cells</article-title>
        <source>Nat Biotechnol.</source>
        <year>2017</year>
        <volume>35</volume>
        <issue>10</issue>
        <fpage>936</fpage>
        <lpage>939</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3973</pub-id>
        <?supplied-pmid 28854175?>
        <pub-id pub-id-type="pmid">28854175</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klemm</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Shipony</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>Chromatin accessibility and the regulatory epigenome</article-title>
        <source>Nat Rev Genet.</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>4</issue>
        <fpage>207</fpage>
        <lpage>220</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-018-0089-8</pub-id>
        <?supplied-pmid 30675018?>
        <pub-id pub-id-type="pmid">30675018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karemaker</surname>
            <given-names>ID</given-names>
          </name>
          <name>
            <surname>Vermeulen</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Single-cell DNA methylation profiling: technologies and biological applications</article-title>
        <source>Trends Biotechnol.</source>
        <year>2018</year>
        <volume>36</volume>
        <issue>9</issue>
        <fpage>952</fpage>
        <lpage>965</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tibtech.2018.04.002</pub-id>
        <?supplied-pmid 29724495?>
        <pub-id pub-id-type="pmid">29724495</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mayr</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Serra</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Liberali</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Exploring single cells in space and time during tissue development, homeostasis and regeneration</article-title>
        <source>Development.</source>
        <year>2019</year>
        <volume>146</volume>
        <fpage>12</fpage>
        <pub-id pub-id-type="doi">10.1242/dev.176727</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Regev A, Teichmann SA. The Human Cell Atlas. Elife. 2017;6. 10.7554/eLife.27041.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>HuBMAP Consortium</collab>
        </person-group>
        <article-title>The human body at cellular resolution: the NIH Human Biomolecular Atlas Program</article-title>
        <source>Nature.</source>
        <year>2019</year>
        <volume>574</volume>
        <issue>7777</issue>
        <fpage>187</fpage>
        <lpage>192</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1629-x</pub-id>
        <pub-id pub-id-type="pmid">31597973</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efremova</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Computational methods for single-cell omics across modalities</article-title>
        <source>Nat Methods.</source>
        <year>2020</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>14</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0692-4</pub-id>
        <?supplied-pmid 31907463?>
        <pub-id pub-id-type="pmid">31907463</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lähnemann</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Eleven grand challenges in single-cell data science</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>31</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-020-1926-6</pub-id>
        <?supplied-pmid 32033589?>
        <pub-id pub-id-type="pmid">32033589</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell.</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1888</fpage>
        <lpage>1902.e21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Welch</surname>
            <given-names>JD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell multi-omic integration compares and contrasts features of brain cell identity</article-title>
        <source>Cell.</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1873</fpage>
        <lpage>1887.e17</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.006</pub-id>
        <pub-id pub-id-type="pmid">31178122</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gao</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Iterative single-cell multi-omic integration using online learning</article-title>
        <source>Nat Biotechnol.</source>
        <year>2021</year>
        <volume>39</volume>
        <issue>8</issue>
        <fpage>1000</fpage>
        <lpage>1007</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-021-00867-x</pub-id>
        <?supplied-pmid 33875866?>
        <pub-id pub-id-type="pmid">33875866</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <source>A joint model of unpaired data from scRNA-seq and spatial transcriptomics for imputing missing gene expression measurements. arXiv [csLG]</source>
        <year>2019</year>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McInnes</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Healy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Saul</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Großberger</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>UMAP: Uniform Manifold Approximation and Projection</article-title>
        <source>J Open Source Software.</source>
        <year>2018</year>
        <volume>3</volume>
        <issue>29</issue>
        <fpage>861</fpage>
        <pub-id pub-id-type="doi">10.21105/joss.00861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Becht</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>McInnes</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Healy</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dutertre</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Kwok</surname>
            <given-names>IWH</given-names>
          </name>
          <name>
            <surname>Ng</surname>
            <given-names>LG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dimensionality reduction for visualizing single-cell data using umap</article-title>
        <source>Nat Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>1</issue>
        <fpage>38</fpage>
        <lpage>44</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Spivak</surname>
            <given-names>ID</given-names>
          </name>
        </person-group>
        <source>Metric realization of fuzzy simplicial sets. Preprint</source>
        <year>2009</year>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barr</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Fuzzy set theory and topos theory</article-title>
        <source>Can Math Bull.</source>
        <year>1986</year>
        <volume>29</volume>
        <issue>4</issue>
        <fpage>501</fpage>
        <lpage>508</lpage>
        <pub-id pub-id-type="doi">10.4153/CMB-1986-079-9</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shang</surname>
            <given-names>X-G</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>W-S</given-names>
          </name>
        </person-group>
        <article-title>A note on fuzzy information measures</article-title>
        <source>Pattern Recogn Lett.</source>
        <year>1997</year>
        <volume>18</volume>
        <fpage>425</fpage>
        <lpage>432</lpage>
        <pub-id pub-id-type="doi">10.1016/S0167-8655(97)00028-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Mikolov</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Sutskever</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Corrado</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dean</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Distributed representations of words and phrases and their compositionality</article-title>
        <source>Proceedings of the 26th International Conference on Neural Information Processing Systems - Volume 2 3111–3119</source>
        <year>2013</year>
        <publisher-name>(Curran Associates Inc.</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Tang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mei</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>Visualizing large-scale and high-dimensional data</article-title>
        <source>Proceedings of the 25th International Conference on World Wide Web 287–297</source>
        <year>2016</year>
        <publisher-name>International World Wide Web Conferences Steering Committee</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <mixed-citation publication-type="other">Gradient-based learning applied to document recognition. Intell Signal Process. 2009. 10.1109/9780470544976.ch9.</mixed-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Miragaia</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Natarajan</surname>
            <given-names>KN</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>A rapid and robust method for single cell chromatin accessibility profiling</article-title>
        <source>Nat Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>5345</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-07771-0</pub-id>
        <?supplied-pmid 30559361?>
        <pub-id pub-id-type="pmid">30559361</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Granja</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Klemm</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Single-cell multiomic analysis identifies regulatory programs in mixed-phenotype acute leukemia</article-title>
        <source>Nat Biotechnol.</source>
        <year>2019</year>
        <volume>37</volume>
        <issue>12</issue>
        <fpage>1458</fpage>
        <lpage>1465</lpage>
        <pub-id pub-id-type="doi">10.1038/s41587-019-0332-7</pub-id>
        <?supplied-pmid 31792411?>
        <pub-id pub-id-type="pmid">31792411</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Saunders</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular diversity and specializations among the cells of the adult mouse brain</article-title>
        <source>Cell.</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>1015</fpage>
        <lpage>1030.e16</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.07.028</pub-id>
        <pub-id pub-id-type="pmid">30096299</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <mixed-citation publication-type="other">Wang X, Allen WE. Three-dimensional intact-tissue sequencing of single-cell transcriptional states. Science. 2018;361(6400). 10.1126/science.aat5691.</mixed-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <mixed-citation publication-type="other">Yao Z, et al. An integrated transcriptomic and epigenomic atlas of mouse primary motor cortex cell types. 2020.02.29.970558. 2020. 10.1101/2020.02.29.970558.</mixed-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Brodmann</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <source>Brodmann’s: Localisation in the Cerebral Cortex</source>
        <year>2010</year>
        <publisher-name>Springer</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yamawaki</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Borges</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Suter</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Shepherd</surname>
            <given-names>GMG</given-names>
          </name>
        </person-group>
        <article-title>A genuine layer 4 in motor cortex with prototypical synaptic circuit connectivity</article-title>
        <source>Elife.</source>
        <year>2014</year>
        <volume>3</volume>
        <fpage>e05422</fpage>
        <pub-id pub-id-type="doi">10.7554/eLife.05422</pub-id>
        <?supplied-pmid 25525751?>
        <pub-id pub-id-type="pmid">25525751</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barkas</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Petukhov</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Joint analysis of heterogeneous single-cell RNA-seq dataset collections</article-title>
        <source>Nat Methods.</source>
        <year>2019</year>
        <volume>16</volume>
        <issue>8</issue>
        <fpage>695</fpage>
        <lpage>698</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-019-0466-z</pub-id>
        <?supplied-pmid 31308548?>
        <pub-id pub-id-type="pmid">31308548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <mixed-citation publication-type="other">Peng T, Chen GM, Tan K. GLUER: integrative analysis of single-cell omics and imaging data by deep neural network. 10.1101/2021.01.25.427845.</mixed-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hie</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>DeMeo</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bryson</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Berger</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Geometric sketching compactly summarizes the single-cell transcriptomic landscape</article-title>
        <source>Cell Syst.</source>
        <year>2019</year>
        <volume>8</volume>
        <fpage>483</fpage>
        <lpage>493.e7</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2019.05.003</pub-id>
        <pub-id pub-id-type="pmid">31176620</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muraro</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptome atlas of the human pancreas</article-title>
        <source>Cell Syst.</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>385</fpage>
        <lpage>394.e3</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.09.002</pub-id>
        <pub-id pub-id-type="pmid">27693023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>Å</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>
        <source>Cell Metab.</source>
        <year>2016</year>
        <volume>24</volume>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.020</pub-id>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>
        <source>Cell Syst.</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>346</fpage>
        <lpage>360.e4</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.08.011</pub-id>
        <pub-id pub-id-type="pmid">27667365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <mixed-citation publication-type="other">Chazarra-Gil R, van Dongen S, Kiselev VY, Hemberg M. Flexible comparison of batch correction methods for single-cell RNA-seq using BatchBench. Nucleic Acids Res. 2021. 10.1093/nar/gkab004.</mixed-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roels</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kuchmiy</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Distinct and temporary-restricted epigenetic mechanisms regulate human αβ and γδ T cell development</article-title>
        <source>Nat Immunol.</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>10</issue>
        <fpage>1280</fpage>
        <lpage>1292</lpage>
        <pub-id pub-id-type="doi">10.1038/s41590-020-0747-9</pub-id>
        <?supplied-pmid 32719521?>
        <pub-id pub-id-type="pmid">32719521</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Preussner</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Single cell RNA-seq and ATAC-seq analysis of cardiac progenitor cell transition states and lineage settlement</article-title>
        <source>Nat Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>4877</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-018-07307-6</pub-id>
        <?supplied-pmid 30451828?>
        <pub-id pub-id-type="pmid">30451828</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Albergante</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Single-cell trajectories reconstruction, exploration and mapping of omics data with STREAM</article-title>
        <source>Nat Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>1903</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-019-09670-4</pub-id>
        <?supplied-pmid 31015418?>
        <pub-id pub-id-type="pmid">31015418</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <mixed-citation publication-type="other">Park J-E, Botting RA. A cell atlas of human thymic development defines T cell repertoire formation. Science. 2020;367(6480). 10.1126/science.aay3224.</mixed-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Hosokawa H, Rothenberg EV. How transcription factors drive choice of the T cell fate. Nat Rev Immunol. 2020. 10.1038/s41577-020-00426-6.</mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lecun</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Bottou</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Bengio</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Haffner</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Gradient-based learning applied to document recognition</article-title>
        <source>Proc IEEE.</source>
        <year>1998</year>
        <volume>86</volume>
        <issue>11</issue>
        <fpage>2278</fpage>
        <lpage>2324</lpage>
        <pub-id pub-id-type="doi">10.1109/5.726791</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hern</surname>
            <given-names>WM</given-names>
          </name>
        </person-group>
        <article-title>Correlation of fetal age and measurements between 10 and 26 weeks of gestation</article-title>
        <source>Obstet Gynecol.</source>
        <year>1984</year>
        <volume>63</volume>
        <issue>1</issue>
        <fpage>26</fpage>
        <lpage>32</lpage>
        <?supplied-pmid 6691014?>
        <pub-id pub-id-type="pmid">6691014</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>van den Brink</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Sage</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Single-cell sequencing reveals dissociation-induced gene expression in tissue subpopulations</article-title>
        <source>Nat Methods.</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>10</issue>
        <fpage>935</fpage>
        <lpage>936</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4437</pub-id>
        <?supplied-pmid 28960196?>
        <pub-id pub-id-type="pmid">28960196</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Fang R, et al. Fast and accurate clustering of single cell epigenomes reveals Cis-regulatory elements in rare cell types. 10.1101/615179.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schep</surname>
            <given-names>AN</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>chromVAR: inferring transcription-factor-associated accessibility from single-cell epigenomic data</article-title>
        <source>Nat Methods.</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>975</fpage>
        <lpage>978</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4401</pub-id>
        <pub-id pub-id-type="pmid">28825706</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blondel</surname>
            <given-names>VD</given-names>
          </name>
          <name>
            <surname>Guillaume</surname>
            <given-names>J-L</given-names>
          </name>
          <name>
            <surname>Lambiotte</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lefebvre</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Fast unfolding of communities in large networks</article-title>
        <source>J Stat Mechanics.</source>
        <year>2008</year>
        <volume>2008</volume>
        <fpage>P10008</fpage>
        <pub-id pub-id-type="doi">10.1088/1742-5468/2008/10/P10008</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Haghverdi</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Büttner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Diffusion pseudotime robustly reconstructs lineage branching</article-title>
        <source>Nat Methods.</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>10</issue>
        <fpage>845</fpage>
        <lpage>848</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3971</pub-id>
        <?supplied-pmid 27571553?>
        <pub-id pub-id-type="pmid">27571553</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>Angerer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>
        <source>Genome Biol.</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>15</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-017-1382-0</pub-id>
        <?supplied-pmid 29409532?>
        <pub-id pub-id-type="pmid">29409532</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Van den Berge</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Trajectory-based differential expression analysis for single-cell sequencing data</article-title>
        <source>Nat Commun.</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>1201</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-020-14766-3</pub-id>
        <?supplied-pmid 32139671?>
        <pub-id pub-id-type="pmid">32139671</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolock</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Scrublet: computational identification of cell doublets in single-cell transcriptomic data</article-title>
        <source>Cell Syst</source>
        <year>2019</year>
        <volume>8</volume>
        <fpage>281</fpage>
        <lpage>291.e9</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2018.11.005</pub-id>
        <pub-id pub-id-type="pmid">30954476</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grytten</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Rand</surname>
            <given-names>KD</given-names>
          </name>
        </person-group>
        <article-title>Graph Peak Caller: calling ChIP-seq peaks on graph-based reference genomes</article-title>
        <source>PLoS Comput Biol.</source>
        <year>2019</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>e1006731</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006731</pub-id>
        <?supplied-pmid 30779737?>
        <pub-id pub-id-type="pmid">30779737</pub-id>
      </element-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Ghahramani</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Lafferty</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>Semi-supervised learning using Gaussian fields and harmonic functions</article-title>
        <source>Proceedings of the 20th International conference on Machine learning (ICML-03)</source>
        <year>2003</year>
        <fpage>912</fpage>
        <lpage>919</lpage>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pliner</surname>
            <given-names>HA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cicero predicts cis-regulatory DNA interactions from single-cell chromatin accessibility data</article-title>
        <source>Mol Cell.</source>
        <year>2018</year>
        <volume>71</volume>
        <fpage>858</fpage>
        <lpage>871.e8</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2018.06.044</pub-id>
        <pub-id pub-id-type="pmid">30078726</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Kozareva V, et al. A transcriptomic atlas of the mouse cerebellum reveals regional specializations and novel cell types. 10.1101/2020.03.04.976407.</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rousseeuw</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Silhouettes: a graphical aid to the interpretation and validation of cluster analysis</article-title>
        <source>J Comput Appl Math.</source>
        <year>1987</year>
        <volume>20</volume>
        <fpage>53</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1016/0377-0427(87)90125-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Sarkin</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Krzysztof</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cecilia</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jongeun</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lira</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Andrew</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Botting Rachel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Emily</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Muzlifah</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Austen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mirjana</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Teichmann Sarah</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>scRNA-seq data of mouse splenocytes. ArrayExpress. E-MTAB-9769</source>
        <year>2021</year>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Sarkin</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Krzysztof</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cecilia</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jongeun</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lira</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Andrew</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Botting Rachel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Emily</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Muzlifah</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Austen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mirjana</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Teichmann Sarah</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>scRNA-seq data of human fetal thymus. ArrayExpress. E-MTAB-9840</source>
        <year>2021</year>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Sarkin</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Krzysztof</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cecilia</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jongeun</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lira</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Andrew</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Botting Rachel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Emily</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Muzlifah</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Austen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mirjana</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Teichmann Sarah</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>scATAC-seq data of human fetal thyms. ArrayExpress. E-MTAB-9828</source>
        <year>2021</year>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Sarkin</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Krzysztof</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cecilia</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jongeun</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lira</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Andrew</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Botting Rachel</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Emily</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Muzlifah</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Austen</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mirjana</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Teichmann Sarah</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <source>Multiome RNA + ATAC data of human PBMCs. ArrayExpress. E-MTAB-11225 and E-MTAB-11226</source>
        <year>2021</year>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Sarkin</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Krzysztof</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cecilia</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jongeun</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lira</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Multiome RNA + ATAC data of human PBMCs. MultiMAP: dimensionality reduction and integration of multimodal data</source>
        <year>2021</year>
        <publisher-name>Github</publisher-name>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Sarkin</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Krzysztof</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cecilia</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Xi</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Jongeun</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lira</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <source>Multiome RNA + ATAC data of human PBMCs. MultiMAP: dimensionality reduction and integration of multimodal data</source>
        <year>2021</year>
        <publisher-name>Zenodo</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
