<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8963326</article-id>
    <article-id pub-id-type="pmid">35020805</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac024</article-id>
    <article-id pub-id-type="publisher-id">btac024</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genetics and Population Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>A data-adaptive Bayesian regression approach for polygenic risk
prediction</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Shuang</given-names>
        </name>
        <aff><institution>Center for Statistical Science, Tsinghua University</institution>, Beijing
100084, <country country="CN">China</country></aff>
        <aff><institution>School of Life Sciences, Department of Industrial Engineering, Tsinghua
University</institution>, Beijing 100084, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4283-8501</contrib-id>
        <name>
          <surname>Hou</surname>
          <given-names>Lin</given-names>
        </name>
        <aff><institution>Center for Statistical Science, Tsinghua University</institution>, Beijing
100084, <country country="CN">China</country></aff>
        <aff><institution>School of Life Sciences, Department of Industrial Engineering, Tsinghua
University</institution>, Beijing 100084, <country country="CN">China</country></aff>
        <aff><institution>MOE Key Laboratory of Bioinformatics, School of Life Sciences, Tsinghua
University</institution>, Beijing 100084, <country country="CN">China</country></aff>
        <xref rid="btac024-cor1" ref-type="corresp"/>
        <!--houl@tsinghua.edu.cn-->
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Jun S</given-names>
        </name>
        <aff><institution>Department of Statistics, Harvard University</institution>, Cambridge, MA
02138, <country country="US">USA</country></aff>
        <xref rid="btac024-cor1" ref-type="corresp"/>
        <!--jliu@stat.harvard.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac024-cor1">To whom correspondence should be addressed. Email:
<email>houl@tsinghua.edu.cn</email> or <email>jliu@stat.harvard.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>01</day>
      <month>4</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-01-10">
      <day>10</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <volume>38</volume>
    <issue>7</issue>
    <fpage>1938</fpage>
    <lpage>1946</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>21</day>
        <month>12</month>
        <year>2021</year>
      </date>
      <date date-type="editorial-decision">
        <day>05</day>
        <month>1</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>09</day>
        <month>1</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>19</day>
        <month>1</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University
Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative
Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits
non-commercial re-use, distribution, and reproduction in any medium, provided the
original work is properly cited. For commercial re-use, please contact
journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac024.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Polygenic risk score (PRS) has been widely exploited for genetic risk prediction due to
its accuracy and conceptual simplicity. We introduce a unified Bayesian regression
framework, NeuPred, for PRS construction, which accommodates varying genetic
architectures and improves overall prediction accuracy for complex diseases by allowing
for a wide class of prior choices. To take full advantage of the framework, we propose a
summary-statistics-based cross-validation strategy to automatically select suitable
chromosome-level priors, which demonstrates a striking variability of the prior
preference of each chromosome, for the same complex disease, and further significantly
improves the prediction accuracy.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Simulation studies and real data applications with seven disease datasets from the
Wellcome Trust Case Control Consortium cohort and eight groups of large-scale
genome-wide association studies demonstrate that NeuPred achieves substantial and
consistent improvements in terms of predictive <italic toggle="yes">r</italic><sup>2</sup> over
existing methods. In addition, NeuPred has similar or advantageous computational
efficiency compared with the state-of-the-art Bayesian methods.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The R package implementing NeuPred is available at <ext-link xlink:href="https://github.com/shuangsong0110/NeuPred" ext-link-type="uri">https://github.com/shuangsong0110/NeuPred</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are
available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>DMS-1903139</award-id>
        <award-id>DMS-2015411</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Natural Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>12071243</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Genome-wide association studies (GWAS) of human complex diseases have identified tens of
thousands of associated genetic variants (<xref rid="btac024-B19" ref-type="bibr">Jostins
and Barrett, 2011</xref>), providing novel insights about disease mechanisms and revealing
extensive polygenic genetic architectures. In clinical translation of GWAS discoveries,
polygenic risk score (PRS), which quantifies genetic risks via aggregation of risk alleles,
has emerged as a promising tool to stratify patients for precision prevention, screening and
diagnosis and treatments (<xref rid="btac024-B1" ref-type="bibr">Allen <italic toggle="yes">et
al.</italic>, 2010</xref>; <xref rid="btac024-B8" ref-type="bibr">Consortium <italic toggle="yes">et
al.</italic>, 2009</xref>; <xref rid="btac024-B33" ref-type="bibr">Ripke <italic toggle="yes">et
al.</italic>, 2011</xref>). PRS calculates a weighted sum of the number of risk alleles
carried in a personal genome, and finding a good weighting strategy is key to the success of
a PRS tool.</p>
    <p>PRS methods differ by their selection of risk loci and estimation of effect sizes. An early
PRS approach, Pruning and Thresholding (P + T), first selects a subset of significant and
approximately independent single nucleotide polymorphisms (SNPs) via linkage disequilibrium
(LD) clumping and <italic toggle="yes">P</italic>-value thresholding, and then calculates PRS based on
the selected SNPs. Instead of using individual-level genotype data, P + T only requires GWAS
summary statistics to construct PRS, which is attractive because of the data sharing
concerns and privacy policies. However, this simple construction discards potentially useful
information due to the <italic toggle="yes">ad hoc</italic> nature of their aggregation of marginal
effects of the selected SNPs, which hurts its prediction accuracy. A main challenge in
constructing a good PRS lies in the high dimensionality of genetic variants and the complex
LD structure between them, which complicates risk variant selection and effect size
estimation. Advanced statistical techniques in high-dimensional data analysis are
particularly helpful in this respect.</p>
    <p>A recent trend in PRS research is to leverage high-dimensional techniques in variable
selection and shrinkage estimation. Some methods leverage the marginal estimator of variant
effect sizes and infer the posterior distribution of true effect sizes through Bayesian
[LDpred (<xref rid="btac024-B42" ref-type="bibr">Vilhjálmsson <italic toggle="yes">et al.</italic>,
2015</xref>) and the updated version LDpred2 (<xref rid="btac024-B32" ref-type="bibr">Privé <italic toggle="yes">et al.</italic>, 2021</xref>)] or empirical Bayes methods [EB-PRS (<xref rid="btac024-B35" ref-type="bibr">Song <italic toggle="yes">et al.</italic>, 2020</xref>)]. Both
approaches enforce sparsity and shrinkage in effect size estimation by utilizing
spike-and-slab priors. Other methods employ high-dimensional regression analysis to jointly
estimate the effect sizes of risk variants, and incorporate various penalty terms to shrink
the linear coefficients. For example, PANPRS (<xref rid="btac024-B7" ref-type="bibr">Chen
<italic toggle="yes">et al.</italic>, 2020</xref>) use <italic toggle="yes">L</italic><sub>1</sub> penalty, TlpSum
takes a truncated LASSO penalty (<xref rid="btac024-B30" ref-type="bibr">Pattee and Pan,
2020</xref>), and LassoSum (<xref rid="btac024-B24" ref-type="bibr">Mak <italic toggle="yes">et
al.</italic>, 2017</xref>) and ElastSum (<xref rid="btac024-B30" ref-type="bibr">Pattee
and Pan, 2020</xref>) use a combination of <italic toggle="yes">L</italic><sub>1</sub> and
<italic toggle="yes">L</italic><sub>2</sub> penalties. In comparison to penalized regression
approaches, Bayesian high-dimensional regression methods bring additional flexibility by
allowing for a wide range of priors to model the polygenic structure of complex diseases.
Specifically, RSS (<xref rid="btac024-B49" ref-type="bibr">Zhu and Stephens, 2017</xref>)
and SBayesR (<xref rid="btac024-B23" ref-type="bibr">Lloyd-Jones <italic toggle="yes">et al.</italic>,
2019</xref>) employ finite normal mixture distributions as the prior, while PRS-CS (<xref rid="btac024-B14" ref-type="bibr">Ge <italic toggle="yes">et al.</italic>, 2019</xref>) uses the
Strawderman-Berger prior (<xref rid="btac024-B2" ref-type="bibr">Berger, 1980</xref>; <xref rid="btac024-B38" ref-type="bibr">Strawderman, 1971</xref>), to characterize the
distribution of genetic effects. DBSLMM assumes that all SNPs have non-zero effects on the
phenotype, but that some SNPs have larger effect sizes than the others (<xref rid="btac024-B46" ref-type="bibr">Yang and Zhou, 2020</xref>).</p>
    <p>Existing methods have unambiguously demonstrated benefits of high-dimensional statistical
methods in PRS construction. However, there is a lack of guidance on how to determine the
optimal penalties or the class of prior distributions for a trait of interest. Intuitively,
the relative performance of different PRS methods depends on how well their internal model
assumptions match the underlying genetic architectures. The true effect size distributions
of human diseases are diverse and complex (<xref rid="btac024-B29" ref-type="bibr">Park
<italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btac024-B47" ref-type="bibr">Zhang
<italic toggle="yes">et al.</italic>, 2018</xref>), and most importantly, unknown. The genetic
architecture of a certain disease may also vary from chromosome to chromosome (<xref rid="btac024-B27" ref-type="bibr">Moser <italic toggle="yes">et al.</italic>, 2015</xref>). Moreover,
subtle tweaks in penalty terms and prior distributions could raise completely new
computational challenges in the corresponding optimization algorithms and Markov chain Monte
Carlo (MCMC) sampling strategies.</p>
    <p>In light of the aforementioned limitations, we propose NeuPred, a Bayesian PRS framework
that selects prior classes and hyper-parameters in a data adaptive and computationally
effective fashion. Our main contributions are two: (i) a general Bayesian framework built
upon the recently introduced ‘neuronized prior’ for Bayesian regression (<xref rid="btac024-B34" ref-type="bibr">Shin and Liu, 2021</xref>); (ii) a flexible
summary-statistics-based cross-validation (CV) strategy to select suitable priors. With a
unified formulation and efficient MCMC computations, neuronized priors cover diverse types
of sparse and shrinkage priors commonly used in Bayesian linear regressions, such as
continuous and discrete spike-and-slab priors, Laplace priors, Cauchy priors, horseshoe
priors, etc. NeuPred searches in a wide class of tunable priors, ranging from conjugate to
non-conjugate, from discrete mixture to continuous hierarchical, and from heavy-tailed to
light-tailed, and uses the proposed CV strategy to select a suitable one. Note that it is
straightforward to conduct CV when individual data are available, but is not obvious how to
do CV when only summary statistics for associations are available.</p>
    <p>Simulations and real data applications on seven Wellcome Trust Case Control Consortium
(WTCCC) traits and another eight groups of large-scale GWAS datasets demonstrate that
NeuPred achieves substantial and consistent improvements in prediction accuracy compared to
existing approaches due to its adaptability to varying genetic architectures. Furthermore,
NeuPred is robust when the LD matrices are externally estimated based on genotype data of a
reference panel with relevant ancestry, and is also computationally more efficient than many
existing Bayesian PRS algorithms.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Method overview</title>
      <p>We provide two algorithms: NeuPred, which targets cases when only GWAS summary statistics
are provided, and NeuPred-I, which works with individual-level genotype data. Due to
potential privacy and data sharing concerns, NeuPred can be more extensively applied than
NeuPred-I. As the key innovations are similar in the two methods, our discussions focus on
NeuPred in the main text. NeuPred is based on the Bayesian linear regression model:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ϵ</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <bold>y</bold> denotes the vector of phenotypes of the
<italic toggle="yes">n</italic> individuals and <bold>X</bold>, an
<italic toggle="yes">n </italic>×<italic toggle="yes"> p</italic> matrix, denotes genotypes of the
<italic toggle="yes">n</italic> individuals at <italic toggle="yes">p</italic> SNPs. The regression coefficient
vector <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">β</mml:mi></mml:math></inline-formula> is of <italic toggle="yes">p</italic>-dimensional, and the error term
<inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mo>ϵ</mml:mo><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> accounts for environmental effects. We assume that both
<bold>y</bold> and <bold>X</bold> are standardized. When only GWAS summary statistics
are provided, we only have access to <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mtext>marg</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mo>⊤</mml:mo></mml:msup><mml:mi mathvariant="bold">y</mml:mi><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>. Let the in-sample linkage-disequilibrium (LD) matrix be
<inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">R</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold">X</mml:mi><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula>, which may be available in some cases or estimated from
other sources. Multiplying <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> to both sides of <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> we obtain <disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mtext>marg</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold">R</mml:mi><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi mathvariant="bold-italic">ϵ</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
      <p>Consider the eigen-decomposition <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">R</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="bold">U</mml:mi><mml:mi mathvariant="bold">D</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, where <bold>U</bold> and <bold>D</bold> are orthogonal and
diagonal matrices, respectively. Multiplying both sides of (2) by <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msqrt><mml:mi>n</mml:mi></mml:msqrt><mml:msup><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mi mathvariant="bold">U</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula>, we obtain a new regression equation <disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>′</mml:mo><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">ϵ</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where the error term satisfies the i.i.d. Gaussian condition,
i.e. <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mtext>Var</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold-italic">ϵ</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mo>ϵ</mml:mo><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. If <bold>R</bold> is known exactly, the OLS estimate based
on (3) is exactly the same as that based on (1). But (3) enables conduction of regularized
regression when only <bold>R</bold> is available and the feature matrix <bold>X</bold> is
not.</p>
      <p>To overcome the winner’s curse in high-dimensional analysis, Bayesian approaches resort
to a specific class of shrinkage priors, such as point-normal or normal mixtures (LDpred,
RSS, SBayesR and EB-PRS), and Strawderman-Berger prior (PRS-CS) to induce shrinkage
estimation in linear coefficients. However, choosing a prior that can lead to optimal
prediction accuracy is a non-trivial task. NeuPred is based the <italic toggle="yes">neuronized
prior</italic> introduced by <xref rid="btac024-B34" ref-type="bibr">Shin and Liu
(2021)</xref>, which postulates that each regression coefficient can be represented
<italic toggle="yes">a priori</italic> as <disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>β</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>:</mml:mo><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <italic toggle="yes">T</italic> is a non-decreasing activation
function, <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, and <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mo>τ</mml:mo></mml:mrow><mml:mo>ω</mml:mo><mml:mn>2</mml:mn></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, for <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:math></inline-formula>. The hyperparameter <italic toggle="yes">α</italic><sub>0</sub> can be
either specified to a fixed value or updated with Gibbs sampling (<xref rid="btac024-B22" ref-type="bibr">Liu and Sabatti, 2000</xref>; <xref rid="btac024-B34" ref-type="bibr">Shin and Liu, 2021</xref>). This formulation enables a unified implementation of
various classes of shrinkage priors by simply changing the activation function. This is
desirable when coping with genetic data of a specific disease with unknown genetic
architectures, as it can be implemented efficiently via one common MCMC algorithm. Details
about the MCMC algorithm and the selection of hyperparameters are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S1.1</xref>.</p>
      <p>To take full advantage of the neuronized priors, we design a summary-statistics-based CV
strategy to automatically select a suitable prior for each chromosome (see Section 2.2).
PRS is estimated subsequently as the posterior mean effect size under the selected prior.
Three built-in neuronized priors are considered in our R package NeuPred, including the
spike-and-slab Laplace (Neu-SpSL-L), spike-and-slab Cauchy (Neu-SpSL-C) and horseshoe
(Neu-HS) priors, which appear to be sufficient for most genetic data applications we have
tested.</p>
      <p>For all reported simulation experiments and real data applications, we trained
summary-statistics-based methods with only GWAS summary statistics, and evaluated the
performances of PRS in an independent validation dataset. The prediction accuracy is
evaluated with respect to the predictive <italic toggle="yes">r</italic><sup>2</sup> and the area under
the receiver operating characteristic (ROC) curve (AUC) in the validation dataset.</p>
    </sec>
    <sec>
      <title>2.2 A cross-validation strategy for prior selection</title>
      <p>To adapt to varying genetic architectures, we wish to implement CV to select an
appropriate neuronized prior for each chromosome. If individual-level genotype data are
available, we can directly apply fivefold CV to the training data and choose the best
performing neuronized prior according to the predictive <italic toggle="yes">r</italic><sup>2</sup>.
When only GWAS summary statistics are provided, we design the following two-step CV
procedure based on the post-transformation data, <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as in (3) of Section 2.1.</p>
      <p>
        <disp-quote content-type="extract">
          <p>Step 1: For each prior choice (i.e. Neu-SpSL-L, Neu-SpSL-C and Neu-HS) and each
chromosome, we calculate the Pearson correlation coefficient (PCC) between the
observed <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and its prediction <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> derived from fivefold CV based on data <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">D</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>; we test whether the prediction accuracy of a prior is
significantly higher than the other two (one-tailed test, <italic toggle="yes">P</italic>-value
&lt; 0.05) after the Fisher transformation of the PCC values and choose the one if it
is significantly better than the other two. If no prior significantly outperforms the
other two in terms of PCC, we conduct Step 2 focusing on the robustness and similarity
between <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
          <p>Step 2: We compute the Kolmogorov–Smirnov (KS) test statistic between empirical
distributions of the observed <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">y</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> and the predicted <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>, and choose the prior with the minimum KS statistic if
we have not made a decision in Step 1.</p>
        </disp-quote>
      </p>
      <p>We stress that the proposed CV procedure only requires GWAS summary statistics and a LD
reference panel, and does not need any external information from a validation dataset.</p>
    </sec>
    <sec>
      <title>2.3 Simulation settings</title>
      <sec>
        <title>2.3.1 Neuronized priors for varying genetic architectures</title>
        <p>We first conducted simulations based on generated genotypes to explore the performances
of NeuPred under three neuronized priors for varying genetic architectures. The minor
allele frequencies (MAF) were sampled from Unif<inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>. The numbers of SNPs <italic toggle="yes">p</italic> and individuals
<italic toggle="yes">n</italic> were fixed at 1000 and 2000, respectively. The genotypes with
correlated LD structures were generated from binomial distributions with AR(1)
correlation matrix, under which the correlation decreases with increasing spatial
distances, using the R package CorBin (<xref rid="btac024-B18" ref-type="bibr">Jiang
<italic toggle="yes">et al.</italic>, 2021</xref>), and the correlation coefficient was fixed at
0.1. The proportion of causal SNPs <italic toggle="yes">κ</italic> took values in <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>0.05</mml:mn><mml:mo>,</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.3</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, the true effect sizes for causal SNPs were sampled from
<inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo>κ</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>. The quantitative phenotypes were generated by <xref rid="E1" ref-type="disp-formula">Equation (1)</xref>, and the error term
<inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold-italic">ϵ</mml:mi><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula></p>
      </sec>
      <sec>
        <title>2.3.2 Effectiveness of the cross-validation strategy for prior selection</title>
        <p>We fixed the number of SNPs to be 1000 and the heritability to be 0.5, and let the
proportion of causal SNPs take values from <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>0.05</mml:mn><mml:mo>,</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.3</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>. We considered three scenarios: <italic toggle="yes">n</italic> is
smaller than <italic toggle="yes">p</italic> (<italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>500);
<italic toggle="yes">n</italic> is equal to <italic toggle="yes">p</italic>
(<italic toggle="yes">n </italic>=<italic toggle="yes"> p </italic>=<italic toggle="yes"> </italic>1000); and
<italic toggle="yes">n</italic> is larger than <italic toggle="yes">p</italic>
(<italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>2000). The block size was set to be 50. In each
block, we randomly sampled MAF from <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:mtext>Unif</mml:mtext><mml:mo stretchy="false">[</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.5</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, and generated genotypes under an AR(1) correlation
structure. The correlation coefficient in each block was randomly sampled from
Unif<inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>0.1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mo>ρ</mml:mo></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">ρ</italic><sub>max</sub> is the Prentice
constraint imposed on marginal expectations and correlation coefficients (<xref rid="btac024-B31" ref-type="bibr">Prentice, 1988</xref>). We used the two CV
procedures (fivefold) to tune parameter <italic toggle="yes">λ</italic> in LASSO regression to
minimize the MSEs, and compared their estimates including and the sets of variables
selected, and the MSEs and predictive <italic toggle="yes">r</italic><sup>2</sup> in an independent
test dataset of sample size 1000. The Jaccard index was employed for comparing two sets
<italic toggle="yes">A</italic> and <italic toggle="yes">B</italic>, which is defined as <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:mi>J</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>∩</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>∪</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec>
        <title>2.3.3 Comparison between NeuPred and other PRS methods</title>
        <p>We conducted a simulation study based on the real genotype data of chromosome 22 (4097
SNPs) from the WTCCC rheumatoid arthritis (RA) study on 4685 individuals. Markers with
MAF smaller than 0.005 or genotyping failure rate larger than 0.05 or significant
Hardy–Weinberg equilibrium (HWE) with <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> in PLINK 1.9 (<xref rid="btac024-B5" ref-type="bibr">Chang <italic toggle="yes">et al.</italic>, 2015</xref>) were removed. Samples with more than 10%
missing were also removed. A method’s performance is evaluated by the fivefold CV:
four-fifths of the samples were used to calculate the GWAS summary statistics to train
PRS models and the remaining one-fifth were reserved as test data.</p>
        <p>We also performed simulations with WTCCC genotypes at a larger scale, corresponding to
15 860 individuals and 260 243 SNPs after overlapping with HapMap 3 SNPs and quality
control. The effect sizes were simulated from a point-normal distribution
<inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mo>κ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo>κ</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>h</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mo>κ</mml:mo><mml:mi>p</mml:mi></mml:mrow></mml:mfrac><mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:math></inline-formula>, with <italic toggle="yes">κ</italic> = <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:mn>0.1</mml:mn><mml:mo>%</mml:mo><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>%</mml:mo><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> and 100%. Four scenarios representing different effective
sample sizes were considered: (i) all SNPs (chromosomes 1–22, 260 243 SNPs), (ii)
chromosomes 1–4 (78 067 SNPs), (iii) chromosomes 1 and 2 (42 984 SNPs) and (iv)
chromosome 1 (21 007 SNPs). The effective sample sizes are defined as the sample size
that maintains the same <italic toggle="yes">n</italic>/<italic toggle="yes">p</italic> ratio if all SNPs are
used, i.e. <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>sim</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext>all</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. Here <italic toggle="yes">p</italic><sub>sim</sub> is the actual
number of SNPs used in each simulation, and <italic toggle="yes">p</italic><sub>all</sub> is the
number of all autosomal SNPs (<xref rid="btac024-B42" ref-type="bibr">Vilhjálmsson
<italic toggle="yes">et al.</italic>, 2015</xref>).</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Compared methods</title>
      <p>We compared NeuPred with 12 state-of-the-art summary-statistics-based PRS methods,
including unadjusted PRS (unadj PRS), P + T, LDpred-inf, LDpred (<xref rid="btac024-B42" ref-type="bibr">Vilhjálmsson <italic toggle="yes">et al.</italic>, 2015</xref>), SBayesR (<xref rid="btac024-B23" ref-type="bibr">Lloyd-Jones <italic toggle="yes">et al.</italic>, 2019</xref>),
SBayesC (<xref rid="btac024-B15" ref-type="bibr">Habier <italic toggle="yes">et al.</italic>,
2011</xref>), RSS (<xref rid="btac024-B49" ref-type="bibr">Zhu and Stephens,
2017</xref>), PRS-CS-auto, PRS-CS (<xref rid="btac024-B14" ref-type="bibr">Ge <italic toggle="yes">et
al.</italic>, 2019</xref>), LDpred2-inf, LDpred2-auto and LDpred2-grid (<xref rid="btac024-B32" ref-type="bibr">Privé <italic toggle="yes">et al.</italic>, 2021</xref>) (detailed
in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S1.2</xref>), and
an individual-level-data-based method, BayesR (<xref rid="btac024-B27" ref-type="bibr">Moser <italic toggle="yes">et al.</italic>, 2015</xref>) was used as benchmarks. For each compared
method, we used the default setting in its provided software. For RSS, we set the number
of MCMC iterations to be 10<sup>6</sup> with <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula> burn-in iterations. There were cases that long MCMC chains
of RSS encountered computational instabilities; and we halved the number of iterations in
such cases.</p>
      <p>Four methods, P + T, LDpred, PRS-CS and LDpred2-grid, need further parameter calibrations
when applied to a new dataset. However, reporting the highest accuracy with <italic toggle="yes">post
hoc</italic> parameter tuning makes comparisons with other methods unfair. To alleviate
the concern, in simulations and WTCCC studies, we carved out one-fifth of the test data to
tune parameters and evaluated prediction accuracy on the remaining four-fifth (this is
still a bit unfair to other methods). For real data applications with independent test
datasets, we tuned the parameters with an external validation dataset (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). We also
provide the results with the best <italic toggle="yes">post hoc</italic> tuning parameters for the four
methods in <xref rid="sup1" ref-type="supplementary-material">Supplementary
Materials</xref>.</p>
    </sec>
    <sec>
      <title>2.5 Reference LD matrix construction</title>
      <p>The in-sample LD matrix was estimated from GWAS samples. An external LD matrix was
estimated via a non-linear shrinkage method (<xref rid="btac024-B20" ref-type="bibr">Ledoit and Wolf, 2015</xref>, <xref rid="btac024-B21" ref-type="bibr">2017</xref>)
based on the reference panel of the 1000 Genomes Project (1000G, henceforth), which
contains 489 Europeans with 9 997 231 SNPs after quality control. We partitioned the
genome into 1703 independent blocks using LDetect (<xref rid="btac024-B3" ref-type="bibr">Berisa and Pickrell, 2016</xref>), based on the 1000G reference panel with European
ancestry (<ext-link xlink:href="https://bitbucket.org/nygcresearch/ldetect-data/src/master/" ext-link-type="uri">https://bitbucket.org/nygcresearch/ldetect-data/src/master/</ext-link>), and performed
Bayesian regression in each LD block. For SBayesR and RSS, we used the gctb software
(<ext-link xlink:href="https://cnsgenomics.com/software/gctb/" ext-link-type="uri">https://cnsgenomics.com/software/gctb/</ext-link>) to shrink the off-diagonal entries
of the sample LD matrix toward zero. The gctb software is implemented by SBayesR (<xref rid="btac024-B23" ref-type="bibr">Lloyd-Jones <italic toggle="yes">et al.</italic>, 2019</xref>),
which is also a C++ port from that provided with the RSS software (<xref rid="btac024-B49" ref-type="bibr">Zhu and Stephens, 2017</xref>). We also used an LD matrix estimated
from the UK Biobank (UKBB) samples of European ancestry, which is available at <ext-link xlink:href="https://pan.ukbb.broadinstitute.org" ext-link-type="uri">https://pan.ukbb.broadinstitute.org</ext-link> with <xref rid="btac024-B28" ref-type="bibr">Pan-UKB Team (2020)</xref>. Note that, several methods have built-in
options to use UKBB LD matrices, namely, SBayesR, SBayesC, PRS-CS and LDpred2. For these
methods, we directly downloaded and used their internal LD estimation.</p>
    </sec>
    <sec>
      <title>2.6 Computation time</title>
      <p>We compared the CPU time of the Bayesian PRS methods including NeuPred, LDpred, SBayesR,
SBayesC, RSS, PRS-CS and LDpred2. Numbers of MCMC iterations for these methods were chosen
according to their respective default settings, i.e. 10<sup>4</sup>, 60, 10<sup>4</sup>,
10<sup>4</sup>, 10<sup>6</sup>, 10<sup>3</sup> and 500, with the corresponding burn-in
iterations <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>3</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, 5, <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>10</mml:mn></mml:mrow></mml:mrow><mml:mn>5</mml:mn></mml:msup></mml:mrow></mml:math></inline-formula>, 500 and 10<sup>3</sup>, respectively. LDpred, PRS-CS and
LDpred2 all require grid search for finding the best tuning parameters. The time we
reported is only for one specific parameter setting, and the computation time for
estimating LD matrices is negligible. The computation time for each of the seven methods
is for simulations based on the WTCCC RA dataset, with an Intel Xeon processor with
2.50 GHz and 48 cores. Among the methods, NeuPred, RSS, PRS-CS and LDpred2 were run with
all 48 cores, while SBayesR, SBayesC and LDpred did not have parallel computing capacity
and used 1 CPU core only.</p>
    </sec>
    <sec>
      <title>2.7 Genetic datasets analyzed</title>
      <p>The WTCCC datasets on seven complex diseases (<xref rid="btac024-B44" ref-type="bibr">Wellcome Trust Case Control Consortium, 2007</xref>) were used in both simulations and
real data analysis. As for the large-scale GWAS studies, we trained models with 4533
individuals with celiac disease (CEL) and 10 750 controls from Dubois’ study (<xref rid="btac024-B9" ref-type="bibr">Dubois <italic toggle="yes">et al.</italic>, 2010</xref>). The test
dataset is from the National Institute of Diabetes and Digestive and Kidney Diseases
(NIDDK) CEL study (1716 cases and 530 controls, dbGaP: phs000274) (<xref rid="btac024-B13" ref-type="bibr">Garner <italic toggle="yes">et al.</italic>, 2014</xref>). For Crohn’s disease
(CD), we trained models using summary statistics from the International Inflammatory Bowel
Disease Genetics Consortium (IIBDGC; 15 056 cases and 6333 controls) (<xref rid="btac024-B12" ref-type="bibr">Franke <italic toggle="yes">et al.</italic>, 2010</xref>).
Individuals from the WTCCC were removed from the meta-analysis and used as the test
dataset (2891 cases and 1689 controls). For RA, we used summary statistics from the <xref rid="btac024-B36" ref-type="bibr">Stahl <italic toggle="yes">et al.</italic> (2010)</xref> (5539
cases and 20 169 controls), removing WTCCC samples for training, and used the WTCCC data
as the test data. For type 2 diabetes (T2D), we trained models using summary statistics
from the Diabetes Genetics Replication and Meta-analysis consortium (DIAGRAM, 56 862 cases
and 12 171 controls) (<xref rid="btac024-B26" ref-type="bibr">Morris <italic toggle="yes">et
al.</italic>, 2012</xref>), and tested the model on samples from the Northwestern
NUgene Project (517 cases and 662 controls, dbGaP: phs000237).</p>
      <p>We also trained PRS with the UKBB GWAS summary statistics, downloaded from Neale lab GWAS
round 2 (<ext-link xlink:href="http://www.nealelab.is/uk-biobank" ext-link-type="uri">http://www.nealelab.is/uk-biobank</ext-link>), and tested with the Genetic Epidemiology
Research on Aging (GERA) summary statistics for asthma (ATH) (dbGaP: phs000674.v3.p3,
<ext-link xlink:href="http://cg.bsc.es/gera_summary_stats/" ext-link-type="uri">http://cg.bsc.es/gera_summary_stats/</ext-link>), and with the WTCCC data for
hypertension (HT). We tested with the GWAS summary statistics on 449 899 Europeans in
<xref rid="btac024-B39" ref-type="bibr">Turcot <italic toggle="yes">et al.</italic> (2018)</xref> for
body mass index (BMI) and 253 288 individuals of European ancestry in <xref rid="btac024-B45" ref-type="bibr">Wood <italic toggle="yes">et al.</italic> (2014)</xref> for height
(HGT). As for the <italic toggle="yes">post hoc</italic> parameter tuning for P + T, LDpred, PRS-CS and
LDpred2-grid, we used UKBB summary statistics for CD, CEL, RA, T2D, BMI and HGT; GWAS data
from GABRIEL consortium for ATH (<xref rid="btac024-B25" ref-type="bibr">Moffatt
<italic toggle="yes">et al.</italic>, 2010</xref>); and the FinnGen GWAS data for HT. More details
about the datasets are provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Simulation experiments</title>
      <sec>
        <title>3.1.1 Neuronized priors for varying genetic architectures</title>
        <p>We simulated datasets to investigate performances of NeuPred under different types of
priors for various genetic architectures. The simulated genetic architectures vary in
three aspects: LD structure, heritability and the sparsity of causal SNPs. Scenarios
with both independent SNPs and arbitrary LD structures were tested (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1 and S2</xref>),
with heritability level <italic toggle="yes">h</italic><sup>2</sup> at 20%, 50% and 80%.</p>
        <p>NeuPred with either Neu-SpSL-L or Neu-SpSL-C obtained similar predictive
<italic toggle="yes">r</italic><sup>2</sup>, but performed worse under the Neu-HS prior when causal
signals are sparse, regardless of the LD structures and heritability settings. On the
other hand, the Neu-HS prior worked the best under more polygenic architectures. The
results highlight that different underlying genetic architectures prefer different
priors, often strongly, and thus the prediction accuracy can be potentially much
improved with a proper selection of prior distributions.</p>
      </sec>
      <sec>
        <title>3.1.2 Effectiveness of the cross-validation strategy for prior selection</title>
        <p>When individual-level genotype data are available, it is straightforward to use CV for
prior and other tuning parameter selections. When only GWAS summary statistics are
provided, however, the standard individual-data-based CV is no longer applicable. In
Section 2.2, we detail a summary-statistics-based CV approach useful for selecting prior
for each chromosome. To demonstrate its effectiveness, we used LASSO as the regression
tool and simulations to compare the new CV procedure with the standard one. Similar
results are expected to hold true for more time-consuming Bayesian procedures.</p>
        <p>We observed that MSEs and predictive <italic toggle="yes">r</italic><sup>2</sup> reported by the two
CV procedures were similar (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>), especially when the prediction accuracy was high
(under sparser settings). We further evaluate the similarity between the sets of
variables selected by the two CV procedures by the Jaccard index (JI). We observed that
JI between the two selected sets ranged from 0.725 to 0.885, under sparse settings (i.e.
<inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mo>κ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.01</mml:mn><mml:mo>,</mml:mo><mml:mn>0.05</mml:mn><mml:mo>,</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>), indicating a strong consistency between the two CV
procedures. In polygenic cases (<inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:mo>κ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.3</mml:mn></mml:mrow></mml:math></inline-formula>), JI was reduced to 0.37 when
<italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>500, reflecting a high uncertainty in variable
selection (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table
S2</xref>).</p>
      </sec>
      <sec>
        <title>3.1.3 Prediction accuracy</title>
        <p>We first applied all the considered PRS methods to a small-scale simulation based on
the observed genotypes chromosome 22 on the WTCCC data (Section 2). Quantitative
phenotypes were generated with three genetic models: (i) a point-normal distribution
with 1% causal SNPs; (ii) a point-normal distribution with 10% causal SNPs; (iii) equal
effect sizes for 1% causal SNPs. The heritability was fixed at 0.5. Two full
individual-level-data-based methods, NeuPred-I and BayesR were also applied and their
performances are listed as benchmarks. For summary-statistics-based methods, we evaluate
their performances under both in-sample and external LD matrices. Since PRS-CS-auto and
PRS-CS have built-in LD matrices estimated from the 1000G reference panel, their
corresponding results with in-sample LD matrices are not available. For P + T, in-sample
LD matrices were used to clump SNPs.</p>
        <p>For setting (i) where the simulated genetic signals are sparse, NeuPred achieved a high
prediction accuracy compared with other summary-statistics-based methods (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). In
particular, NeuPred had performed comparably to NeuPred-I and BayesR, which used the
full individual-level data. LDpred2-grid had the best performance among the
summary-statistics-based methods in simulation setting (ii) where the genetic
architecture were relatively polygenic (<inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mrow><mml:mo>κ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math></inline-formula>). We note that the generating models of settings (i) and
(ii) are consistent with the underlying models of LDpred2-auto, LDpred2-grid and
SBayesC, and LDpred2-grid further tunes parameters among a grid size of 126. The setting
(iii) assumes equal contribution from each causal SNP, which violates the normal
assumption and results in less optimal performances for methods assuming point-normal or
normal mixture priors. In contrast, NeuPred remained robustness and showed a better
performance in this case.</p>
        <p>We then applied the methods to whole-genome-scale simulations with a larger sample
size, with varying proportion of causal SNPs (Section 2). We omitted the comparison with
unadjusted PRS, LDpred and RSS since their performances were demonstrated to be inferior
to the others in the literature (<xref rid="btac024-B32" ref-type="bibr">Privé
<italic toggle="yes">et al.</italic>, 2021</xref>) and the small-scale simulation studies. Note
that, the generating models in the simulation settings are the same as the underlying
models (including priors) of LDpred2-auto, LDpred2-grid and SBayesC, and are similar to
that of SBayesR. These four methods performed well in these simulations, especially
LDpred2-auto and LDpred2-grid (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). LDpred2-inf had good performances under polygenic
scenarios (<italic toggle="yes">κ </italic>= 1), but became less competitive under sparse settings.
Even employed priors are different from that of the generating models, NeuPred remained
to perform robustly under all sparse and polygenic simulation settings, especially when
the effective sample sizes were large. This high robustness is consistent with our
findings in the small-scale simulations and is likely due to its ability in choosing one
from three distinctive classes of priors adaptively via our new CV strategy.</p>
        <p>In addition, we assessed the calibration of polygenic prediction methods by regressing
the true phenotype onto the PRS predictor and inspecting the regression slope. A slope
close to one often indicates the predictor is correctly calibrated (<xref rid="btac024-B42" ref-type="bibr">Vilhjálmsson <italic toggle="yes">et al.</italic>, 2015</xref>).
We note that the usage of the calibration slope is being debated (<xref rid="btac024-B37" ref-type="bibr">Stevens and Poppe, 2020</xref>; <xref rid="btac024-B41" ref-type="bibr">Vach, 2013</xref>; <xref rid="btac024-B43" ref-type="bibr">Wang,
2020</xref>) and we suggest to interpret this statistic with caution. In general, the
Bayesian approaches had calibration slopes closer to one than P + T, especially when the
predictive accuracy was high (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>). NeuPred was well calibrated under sparse settings
with large effective sample sizes.</p>
      </sec>
      <sec>
        <title>3.1.4 Robustness to external LD information</title>
        <p>We conducted simulations based on the RA data of WTCCC (Section 2), to evaluate
robustness of NeuPred with respect to the LD information input under three prior
choices. For each chromosome, we simulated the SNP effect sizes from a point-normal
distribution, fixed the heritability at 0.5 and varied the proportion of causal SNPs.
The LD matrices were either estimated from the simulated samples (in-sample LD) or from
the 1000G reference panel with European ancestry (external LD). We can see that the
influence of the LD input varies among chromosomes and prior choices, whereas the
Neu-SpSL-L prior enabled the most robust performance under varying genetic architectures
(<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref> and
<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>).
Therefore, we recommend to always use Neu-SpSL-L as the default setting when the LD
information is from an external source, and to employ a shrinkage method to estimate the
LD matrices (<xref rid="btac024-B20" ref-type="bibr">Ledoit and Wolf, 2015</xref>, <xref rid="btac024-B21" ref-type="bibr">2017</xref>). The robustness of NeuPred is also
evident in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure
S4</xref>. Although performances of all methods modeling LD information deteriorated
when external LD estimates were used in the place of the in-sample LD matrices, NeuPred
appeared to be least affected.</p>
      </sec>
    </sec>
    <sec>
      <title>3.2 Real data applications</title>
      <sec>
        <title>3.2.1 Adaptability to varying genetic architectures</title>
        <p>We tested NeuPred with the WTCCC datasets of seven complex diseases, including bipolar
disorder (BD), coronary artery disease (CAD), T2D, HT, CD, RA and type 1 diabetes (T1D).
To assess the added value of prior selection, NeuPred was implemented in two ways: (i)
using one of the three default neuronized priors, namely, Neu-SpSL-L, Neu-SpSL-C and
Neu-HS, versus (ii) using a data-adaptive prior selected (among the three) by the
summary-statistics-based CV procedure. We used the in-sample LD information and
conducted fivefold CV to evaluate predictive <italic toggle="yes">r</italic><sup>2</sup> and AUC for
each method and disease. In terms of predictive <italic toggle="yes">r</italic><sup>2</sup>, we
observe that for the three immune-related diseases, CD, RA and T1D, using either
Neu-SpSL-C or Neu-SpSL-L gave similar results and was superior to using Neu-HS (<xref rid="btac024-F1" ref-type="fig">Fig. 1</xref>). In contrast, the Neu-HS prior was
strongly favored by BD. The three priors worked comparably well for CAD, T2D and HT.
Similar patterns were observed with respect to AUC (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>).</p>
        <fig position="float" id="btac024-F1">
          <label>Fig. 1.</label>
          <caption>
            <p>Comparison of three neuronized priors applied to the seven WTCCC complex diseases.
(<bold>a</bold>) The predictive <italic toggle="yes">r</italic><sup>2</sup> is estimated from
fivefold CV. The orange solid and dashed lines indicate the mean predictive
<italic toggle="yes">r</italic><sup>2</sup> and standard deviations, respectively, estimated by
NeuPred with priors automatically selected. (<bold>b</bold>) The predictive
<italic toggle="yes">r</italic><sup>2</sup> of NeuPred under three neuronized priors for each
chromosome for CAD and HT. In each CV, NeuPred automatically selected a prior, and
the prior that is most frequently selected is marked with a star, which varies
greatly among diseases and chromosomes</p>
          </caption>
          <graphic xlink:href="btac024f1" position="float"/>
        </fig>
        <p>Because the major histocompatibility complex region explains a large amount of the
overall variance of autoimmune-related traits (<xref rid="btac024-B27" ref-type="bibr">Moser <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btac024-B42" ref-type="bibr">Vilhjálmsson <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btac024-B47" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2018</xref>), the favorable
performance of Neu-SpSL-C and Neu-SpSL-L in autoimmune diseases echos the simulation
results that these priors are advantageous for less polygenic traits. Regardless of the
underlying genetic architecture, the approach with adaptive prior selection consistently
outperforms any single-prior approach. The selected prior for each chromosome is marked
for CAD and HT (<xref rid="btac024-F1" ref-type="fig">Fig. 1b</xref>) and others (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>). For most
cases, our CV strategy selected the best performing prior for each chromosome, which
explains the substantial improvement in the overall prediction accuracy. For scenarios
where Neu-SpSL-L and Neu-SpSL-C had better performance compared with Neu-HS, our CV
strategy showed a slight preference to Neu-SpSL-L, which shrinks more strongly and is
more conservative than Neu-SpSL-C. Although in general Neu-SpSL-L and Neu-SpSL-C are
preferred by autoimmune diseases and Neu-HS is favored by polygenic genetic
architectures, <xref rid="btac024-F1" ref-type="fig">Figure 1b</xref> shows a
significant variability among the chromosome-level prior preferences, which further
highlights the importance of using data-adaptive priors. We also provide a comparison
between our summary-statistics-based CV strategy and the pseudo-validation strategy
proposed in the lassosum method (<xref rid="btac024-B24" ref-type="bibr">Mak <italic toggle="yes">et
al.</italic>, 2017</xref>). Even if we gave an advantage to the pseudo-validation
method by allowing it to use the test genotype data, our summary-statistics-based CV
strategy showed more improvement in six of the seven traits (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S1.3</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>).</p>
      </sec>
      <sec>
        <title>3.2.2 Prediction accuracy</title>
        <p>To assess the performance of NeuPred and other summary-statistics-based PRS
methodologies, we analysed seven WTCCC complex diseases and eight large-scale GWAS
studies with independent test datasets (Section 2). For calibration, we provide the
results of NeuPred-I and BayesR as benchmarks when possible as they leverage full
individual-level genotype information. We also estimated the SNP-based heritability (on
the observed scale) of each of the seven WTCCC traits using LDSC (<xref rid="btac024-B4" ref-type="bibr">Bulik-Sullivan <italic toggle="yes">et al.</italic>, 2015</xref>), which provides
a theoretical upper bound for the predictive <italic toggle="yes">r</italic><sup>2</sup> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S7</xref>).</p>
        <p>For the seven WTCCC traits based on CV, we observe that NeuPred consistently
outperformed all other summary-statistics-based methods in terms of both predictive
<italic toggle="yes">r</italic><sup>2</sup> and AUC criteria (see details in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S1.4</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S8</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S8–S11</xref>). We
note, however, that the extent of improvement by CV may not be extensible to other
studies, due to the limited sample sizes of the WTCCC datasets and potential
over-fitting problems. We further validated the predictors trained with the WTCCC data
on the independent samples from the Northwestern NUgene Project of T2D. Although the
prediction accuracy diminished for all tested methods, NeuPred still achieved the best
performance, showcasing that the model fitted by NeuPred generalizes well in independent
datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table
S12</xref>).</p>
        <p>We applied all the methods to four large-scale GWAS studies on CD, CEL, RA and T2D, and
evaluated their performance with four independent test datasets (<xref rid="btac024-F2" ref-type="fig">Fig. 2a</xref>, <xref rid="btac024-T1" ref-type="table">Table 1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary
Table S13</xref>). The hyperparameters for P + T, LDpred, PRS-SC and LDpred2-grid were
tuned with UKBB GWAS data, which is independent of our training and test datasets. We
also provide the results for the four methods with the best <italic toggle="yes">post hoc</italic>
tuned parameters in test data in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S14</xref>. LDpred was relatively robust with parameters either
optimized <italic toggle="yes">post hoc</italic> or tuned with external validation datasets, while
the other three all performed much worse on two or more of the four traits without
<italic toggle="yes">post hoc</italic> optimizing. We also notice that SBayesR and SBayesC had
convergence issues and suboptimal performances on traits such as CEL and RA, which were
also reported in other studies (<xref rid="btac024-B48" ref-type="bibr">Zhou and Zhao,
2021</xref>). Therefore, we used a shorter chain length (5000) if the two methods
encountered a convergence problem. If the convergence issue remained, we substituted LD
matrices with that estimated from the UKBB LD reference panel. We can see that NeuPred
still consistently outperformed the others in terms of both predictive
<italic toggle="yes">r</italic><sup>2</sup> and AUC on all compared traits. We also provide the
calibration slope results in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S15</xref>, showing that it was challenging for all methods to
derive PRS with slope close to one with an independent test cohort.</p>
        <fig position="float" id="btac024-F2">
          <label>Fig. 2.</label>
          <caption>
            <p>Comparison of prediction accuracy among NeuPred and other 12 methods on real data
experiments. (<bold>a</bold>) Predictive <italic toggle="yes">r</italic><sup>2</sup> on the four
diseases (CD, CEL, RA and T2D) with large-scale GWAS studies. PRSs were derived from
summary statistics of GWAS studies, and the AUC was evaluated based on independent
test datasets. The LD matrix was externally estimated from the 1000G reference
panel. (<bold>b</bold>) Predictive <italic toggle="yes">r</italic><sup>2</sup> on the four
diseases (ATH, HT, BMI and HGT) with GWAS studies from UKBB. The AUC was evaluated
based on independent test datasets. The LD matrix was estimated from the UKBB
European individuals</p>
          </caption>
          <graphic xlink:href="btac024f2" position="float"/>
        </fig>
        <table-wrap position="float" id="btac024-T1">
          <label>Table 1.</label>
          <caption>
            <p>AUC of summary-statistics-based PRS methods for four diseases with large-scale GWAS
studies and independent test data</p>
          </caption>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col valign="top" align="left" span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="char" char="." span="1"/>
              <col valign="top" align="char" char="." span="1"/>
            </colgroup>
            <thead>
              <tr>
                <th rowspan="1" colspan="1">Trait</th>
                <th colspan="9" align="center" rowspan="1">Without <italic toggle="yes">post hoc</italic> tuning<hr/></th>
                <th colspan="4" align="center" rowspan="1">With <italic toggle="yes">post hoc</italic> tuning<hr/></th>
              </tr>
              <tr>
                <th rowspan="1" colspan="1"/>
                <th align="center" rowspan="1" colspan="1">NeuPred</th>
                <th align="center" rowspan="1" colspan="1">Unadj PRS</th>
                <th align="center" rowspan="1" colspan="1">LDpred- inf</th>
                <th align="center" rowspan="1" colspan="1">SBayesR</th>
                <th align="center" rowspan="1" colspan="1">SBayesC</th>
                <th align="center" rowspan="1" colspan="1">RSS</th>
                <th align="center" rowspan="1" colspan="1">PRS- CS-auto</th>
                <th align="center" rowspan="1" colspan="1">LDpred2- inf</th>
                <th align="center" rowspan="1" colspan="1">LDpred2- auto</th>
                <th align="center" rowspan="1" colspan="1">P + T</th>
                <th align="center" rowspan="1" colspan="1">LDpred</th>
                <th align="center" rowspan="1" colspan="1">PRS- CS</th>
                <th align="center" rowspan="1" colspan="1">LDpred2-grid</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td rowspan="1" colspan="1">CD</td>
                <td rowspan="1" colspan="1">
                  <bold>0.712</bold>
                </td>
                <td rowspan="1" colspan="1">0.632</td>
                <td rowspan="1" colspan="1">0.623</td>
                <td rowspan="1" colspan="1">0.692</td>
                <td rowspan="1" colspan="1">0.698</td>
                <td rowspan="1" colspan="1">0.584</td>
                <td rowspan="1" colspan="1">0.584</td>
                <td rowspan="1" colspan="1">0.631</td>
                <td rowspan="1" colspan="1">0.633</td>
                <td rowspan="1" colspan="1">0.679</td>
                <td rowspan="1" colspan="1">0.661</td>
                <td rowspan="1" colspan="1">0.707</td>
                <td rowspan="1" colspan="1">0.632</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">CEL</td>
                <td rowspan="1" colspan="1">
                  <bold>0.630</bold>
                </td>
                <td rowspan="1" colspan="1">0.594</td>
                <td rowspan="1" colspan="1">0.585</td>
                <td rowspan="1" colspan="1">0.618</td>
                <td rowspan="1" colspan="1">0.617</td>
                <td rowspan="1" colspan="1">0.508</td>
                <td rowspan="1" colspan="1">0.587</td>
                <td rowspan="1" colspan="1">0.571</td>
                <td rowspan="1" colspan="1">0.607</td>
                <td rowspan="1" colspan="1">0.572</td>
                <td rowspan="1" colspan="1">0.606</td>
                <td rowspan="1" colspan="1">0.584</td>
                <td rowspan="1" colspan="1">0.625</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">RA</td>
                <td rowspan="1" colspan="1">
                  <bold>0.710</bold>
                </td>
                <td rowspan="1" colspan="1">0.645</td>
                <td rowspan="1" colspan="1">0.625</td>
                <td rowspan="1" colspan="1">0.598</td>
                <td rowspan="1" colspan="1">0.608</td>
                <td rowspan="1" colspan="1">0.636</td>
                <td rowspan="1" colspan="1">0.706</td>
                <td rowspan="1" colspan="1">0.654</td>
                <td rowspan="1" colspan="1">0.656</td>
                <td rowspan="1" colspan="1">0.688</td>
                <td rowspan="1" colspan="1">0.662</td>
                <td rowspan="1" colspan="1">0.704</td>
                <td rowspan="1" colspan="1">0.596</td>
              </tr>
              <tr>
                <td rowspan="1" colspan="1">T2D</td>
                <td rowspan="1" colspan="1">
                  <bold>0.632</bold>
                </td>
                <td rowspan="1" colspan="1">0.587</td>
                <td rowspan="1" colspan="1">0.581</td>
                <td rowspan="1" colspan="1">0.604</td>
                <td rowspan="1" colspan="1">0.619</td>
                <td rowspan="1" colspan="1">0.523</td>
                <td rowspan="1" colspan="1">0.616</td>
                <td rowspan="1" colspan="1">0.575</td>
                <td rowspan="1" colspan="1">0.565</td>
                <td rowspan="1" colspan="1">0.567</td>
                <td rowspan="1" colspan="1">0.614</td>
                <td rowspan="1" colspan="1">0.584</td>
                <td rowspan="1" colspan="1">0.614</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <fn id="tblfn1">
              <p><italic toggle="yes">Note</italic>: The four diseases are Crohn’s disease (CD), celiac disease
(CEL), rheumatoid arthritis (RA) and type 2 diabetes (T2D). The LD matrix was
externally estimated from the 1000G. The UKBB data were used for <italic toggle="yes">post
hoc</italic> parameter tuning for P + T, LDpred, PRS-CS and LDpred2-grid. The
highest AUC is highlighted in boldface.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>We further evaluated prediction accuracy of NeuPred, P + T, SBayesR, SBayesC, PRS-CS
and LDpred2 with UKBB GWAS datasets on two binary traits, ATH and HT, and two
quantitative traits, BMI and HGT. The LD matrices were estimated with UKBB individuals
(Section 2). The evaluation is based on the square of the (quasi-) correlation in an
independent test dataset (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S1.5</xref>). We tuned parameters for P + T, PRS-CS and
LDpred2-grid with an external validation dataset for ATH and HT, but used the optimal
parameters in the training data for BMI and HGT (as no independent validation cohort was
available). We also provide the results under the optimal <italic toggle="yes">post hoc</italic>
tuned parameters (i.e. the parameter set that leads to the best testing result) for the
four methods in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table
S16</xref>. Overall, NeuPred and LDpred2-auto performed comparably and better than
other methods (<xref rid="btac024-F2" ref-type="fig">Fig. 2b</xref>), both requiring no
<italic toggle="yes">post hoc</italic> tuning. LDpred2-grid performed competitively.</p>
      </sec>
      <sec>
        <title>3.2.3 Computational efficiency</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S9</xref> and
<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S17</xref> show
the computation time of NeuPred (under three prior choices), LDpred, SBayesR, SBayesC,
RSS, PRS-CS and LDpred2 for analyzing the simulated datasets based on chromosome 1
(26 799 SNPs) and chromosome 22 (4097 SNPs) of the WTCCC dataset. Compared with the
other six Bayesian methodologies, NeuPred is very competitive in terms of time
efficiency. NeuPred under the Neu-SpSL-L prior has the shortest mean running time with
about 30-folds improvement over PRS-CS at the default setting.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>As GWAS sample sizes continue to grow, PRS methods are becoming more and more powerful in
predicting complex diseases, and offer potentials for applications in clinical care and
precision medicine (<xref rid="btac024-B6" ref-type="bibr">Chatterjee <italic toggle="yes">et
al.</italic>, 2013</xref>; <xref rid="btac024-B10" ref-type="bibr">Dudbridge,
2013</xref>). Several Bayesian PRS methods have been developed to improve the prediction
accuracy, each focusing on a specific class of priors, such as point-normal, normal mixtures
and the Strawderman–Berger distributions. However, a unified framework is still lacking for
accommodating diverse and unknown genetic architectures of complex traits. NeuPred described
in this article fills in this gap by providing a unified treatment of priors, which allows
one to test out, tune and combine multiple types of prior classes to accommodate different
genetic architectures. NeuPred takes GWAS summary statistics and a LD matrix as input, and
employs an efficient computational strategy to entertain a wide range of prior choices such
as point-normal, horseshoe, Cauchy and point-Laplace. As a consequence, NeuPred
substantially improves the prediction accuracy and computational stability compared with
existing Bayesian PRS methods. In particular, NeuPred allows one to test out, tune and
combine diverse classes of priors to accommodate different genetic architectures at
chromosome level with no need of information from an external validation dataset, which is
useful and flexible as a validation dataset is not always available in clinical
applications.</p>
    <p>We provide three candidate neuronized priors for consideration by default: Neu-SpSL-L,
Neu-SpSL-C and Neu-HS, which should have covered most genetic structures in our experiments.
We also propose a novel CV strategy for choosing the best performing prior when only the
GWAS summary statistics are available in the training dataset, and show that its
performances are comparable to the same CV-procedure applied to the corresponding
individual-level genotypes when such data are available, especially when dimension
<italic toggle="yes">p</italic> is high. Empirically, users may also specify a proper prior based on
our knowledge about the target disease and use our software to derive posterior effect size
estimates.</p>
    <p>We observe that the Neu-HS prior performed the best for polygenic genetic architectures, in
which a large number of SNPs are disease-associated but with very small effects. This is
also consistent with the findings in <xref rid="btac024-B27" ref-type="bibr">Moser
<italic toggle="yes">et al.</italic> (2015)</xref>. The Neu-SpSL-C prior is powerful for capturing
strong signals as its heavy tail helps keep large effects unaffected, while its spike part
shrinks small coefficients to zero. Equipped with the CV procedure, NeuPred automatically
selects the most appropriate prior for each chromosome. When estimating PRS with an external
LD matrix, however, we recommend to use Neu-SpSL-L, since it is lighter-tailed, shrinks more
strongly, and is more robust than Neu-SpSL-C to a potential mismatch between the target
population and the LD reference panel.</p>
    <p>In real data applications, we found that although sample sizes of GWAS studies were larger,
the prediction accuracy on an independent test dataset was not as high as that for the WTCCC
studies with in-sample LD reference. There are several reasons: (i) The genetic signals
across training and test cohorts in the WTCCC studies are well matched, whereas there could
be differences in sample ascertainment in an external validation dataset; (ii) The bias in
an external LD reference may have also led to the decrease in prediction accuracy,
especially for the 1000G reference panel, which contains only 489 individuals after quality
control; (iii) The disparity of case/control ratios further made the predictive
<italic toggle="yes">r</italic><sup>2</sup> not comparable across cohorts. In theory, optimizing CV
(for predictive likelihood) is equivalent to optimizing AIC asymptotically, thus tends to
lead to a larger model than the true one (i.e. is not model consistent, whereas the BIC
procedure is model-selection consistent). However, for training a proper model and in the
lack of future test data, the CV procedure still appears to be one of the best available
general methods.</p>
    <p>As mentioned earlier, the calibration slope should be used with caution. <xref rid="btac024-B41" ref-type="bibr">Vach (2013)</xref> commented that a calibration can look
perfect even if all regression coefficients are underestimated, and introduced the concept
of ‘bias slope’ (<inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>bias</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>), which is the slope for regressing the predicted scores
against the true phenotype. Clearly, the product
<italic toggle="yes">β</italic><sub>calib</sub>×<inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mtext>bias</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is equal to predictive <italic toggle="yes">r</italic><sup>2</sup>. In a
clinical context, the bias perspective is more relevant as the aim of a prediction rule
should be to inform a patient about the prognosis, while the calibration slope focuses on
whether patients with a certain estimated probability can expect on average to experience an
event rate equal to this value. Therefore, it is hard to tell whether a calibration slope
close to one really comes from a well calibrated model, or from a sacrifice of the bias
slope, especially when the predictive <italic toggle="yes">r</italic><sup>2</sup> does not reach the
level of SNP-based heritability. In real data applications, if calibration is really
desired, a post-training adjustment could be adopted, such as multiplying the estimated
regression vector by a constant, to make a better calibration.</p>
    <p>For future directions, it is conceptually advantageous to jointly model multiple
genetically correlated traits and functional annotations to further improve the prediction
accuracy (<xref rid="btac024-B16" ref-type="bibr">Hu <italic toggle="yes">et al.</italic>,
2017a</xref>,<xref rid="btac024-B17" ref-type="bibr">b</xref>; <xref rid="btac024-B40" ref-type="bibr">Turley <italic toggle="yes">et al.</italic>, 2018</xref>). We believe that the
concise and unified form of neuronized priors can also be used in such an attempt to bring
in additional gains. An additional direction for further exploration is to discern small
effects from the noise by taking further advantage of existing genetic knowledge. Similar to
most PRS studies, we currently removed markers with MAF smaller than 0.005 and focused on
the common variants. A better way to model rare variants awaits for a future careful
investigation. Our current work imposes independence among the
<italic toggle="yes">β</italic><sub>j</sub>’s <italic toggle="yes">a priori</italic>. It may be of interest to
induce correlations among the <italic toggle="yes">β</italic><sub>j</sub>’s based on our genetic
knowledge. This can be achieved in our NeuPred framework by, say, modeling the
<italic toggle="yes">α</italic><sub>j</sub>’s in <xref rid="E4" ref-type="disp-formula">Equation
(4)</xref> as a Markov chain.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac024_Supplementary_Appendix</label>
      <media xlink:href="btac024_supplementary_appendix.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank Minsuk Shin for helpful discussions regarding neuronized priors, and the
knowledgeable referees for their insightful and constructive comments and suggestions. This
study makes use of data generated by the <xref rid="btac024-B44" ref-type="bibr">Wellcome
Trust Case Control Consortium (2007)</xref>. A full list of the investigators who
contributed to the generation of the data is available from <ext-link xlink:href="http://www.wtccc.org.uk" ext-link-type="uri">www.wtccc.org.uk</ext-link>. Funding for the project
was provided by the Wellcome Trust under award 076113. This research has been conducted
using the publicly available UK Biobank and FinnGen GWAS summary statistics released by
Neale’s lab. The author also thank the investigators of GERA, DIAGRAM, IIBDGC, NIDDK,
GABRIEL and the NUgene project (<ext-link xlink:href="http://www.nugene.org" ext-link-type="uri">www.nugene.org</ext-link>) for
providing GWAS data. We want to acknowledge the participants and investigators of the
FinnGen study.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported in part by National Science Foundation [DMS-1903139 and
DMS-2015411 to J.S.L.]; and the National Natural Science Foundation of China [12071243 to
L.H.].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
    <sec sec-type="data-availability">
      <title>Data availability statements</title>
      <p>The data underlying this article are available in the article and in its online
supplementary material.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac024-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allen</surname><given-names>H.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>Hundreds of
variants clustered in genomic loci and biological pathways affect human
height</article-title>. <source>Nature</source>, <volume>467</volume>,
<fpage>832</fpage>–<lpage>838</lpage>.<pub-id pub-id-type="pmid">20881960</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berger</surname><given-names>J.</given-names></string-name></person-group> (<year>1980</year>) <article-title>A robust generalized Bayes estimator
and confidence region for a multivariate normal mean</article-title>. <source>Ann.
Stat</source>., <volume>8</volume>, <fpage>716</fpage>.</mixed-citation>
    </ref>
    <ref id="btac024-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berisa</surname><given-names>T.</given-names></string-name>,
<string-name><surname>Pickrell</surname><given-names>J.K.</given-names></string-name></person-group>
(<year>2016</year>) <article-title>Approximately independent linkage disequilibrium
blocks in human populations</article-title>. <source>Bioinformatics</source>,
<volume>32</volume>, <fpage>283</fpage>–<lpage>285</lpage>.<pub-id pub-id-type="pmid">26395773</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bulik-Sullivan</surname><given-names>B.K.</given-names></string-name></person-group>  <etal>et al</etal>; , Schizophrenia Working Group of the Psychiatric
Genomics Consortium. (<year>2015</year>) <article-title>LD score regression distinguishes
confounding from polygenicity in genome-wide association studies</article-title>.
<source>Nat. Genet</source>., <volume>47</volume>,
<fpage>291</fpage>–<lpage>295</lpage>.<pub-id pub-id-type="pmid">25642630</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chang</surname><given-names>C.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Second-generation
PLINK: rising to the challenge of larger and richer datasets</article-title>.
<source>Gigascience</source>, <volume>4</volume>, <fpage>7</fpage>.<pub-id pub-id-type="pmid">25722852</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chatterjee</surname><given-names>N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) <article-title>Projecting the
performance of risk prediction based on polygenic analyses of genome-wide association
studies</article-title>. <source>Nat. Genet</source>., <volume>45</volume>,
<fpage>400</fpage>–<lpage>405</lpage>.<pub-id pub-id-type="pmid">23455638</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>T.-H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>A penalized
regression framework for building polygenic risk models based on summary statistics from
genome-wide association studies and incorporating external information</article-title>.
<source>J. Am. Stat. Assoc</source>., <volume>116</volume>,
<fpage>1</fpage>–<lpage>11</lpage>.</mixed-citation>
    </ref>
    <ref id="btac024-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Consortium</surname><given-names>I.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>Common polygenic
variation contributes to risk of schizophrenia and bipolar disorder</article-title>.
<source>Nature</source>, <volume>460</volume>, <fpage>748</fpage>.<pub-id pub-id-type="pmid">19571811</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dubois</surname><given-names>P.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>Multiple common
variants for celiac disease influencing immune gene expression</article-title>.
<source>Nat. Genet</source>., <volume>42</volume>,
<fpage>295</fpage>–<lpage>302</lpage>.<pub-id pub-id-type="pmid">20190752</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dudbridge</surname><given-names>F.</given-names></string-name></person-group> (<year>2013</year>) <article-title>Power and predictive accuracy of
polygenic risk scores</article-title>. <source>PLoS Genet</source>., <volume>9</volume>,
<fpage>e1003348</fpage>.<pub-id pub-id-type="pmid">23555274</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Franke</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>Genome-wide
meta-analysis increases to 71 the number of confirmed Crohn’s disease susceptibility
loci</article-title>. <source>Nat. Genet</source>., <volume>42</volume>,
<fpage>1118</fpage>–<lpage>1125</lpage>.<pub-id pub-id-type="pmid">21102463</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Garner</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>Genome-wide
association study of celiac disease in North America confirms FRMD4B as new celiac
locus</article-title>. <source>PLoS One</source>, <volume>9</volume>,
<fpage>e101428</fpage>.<pub-id pub-id-type="pmid">24999842</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ge</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Polygenic
prediction via Bayesian regression and continuous shrinkage priors</article-title>.
<source>Nat. Commun</source>., <volume>10</volume>,
<fpage>1</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">30602773</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Habier</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>Extension of the
Bayesian alphabet for genomic selection</article-title>. <source>BMC
Bioinformatics</source>, <volume>12</volume>,
<fpage>186</fpage>–<lpage>112</lpage>.<pub-id pub-id-type="pmid">21605355</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017a</year>) <article-title>Joint modeling of
genetically correlated diseases and functional annotations increases accuracy of
polygenic risk prediction</article-title>. <source>PLoS Genet</source>.,
<volume>13</volume>, <fpage>e1006836</fpage>.<pub-id pub-id-type="pmid">28598966</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017b</year>) <article-title>Leveraging
functional annotations in genetic risk prediction for human complex
diseases</article-title>. <source>PLoS Comput. Biol</source>., <volume>13</volume>,
<fpage>e1005589</fpage>.<pub-id pub-id-type="pmid">28594818</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jiang</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>A set of efficient
methods to generate high-dimensional binary data with specified correlation
structures</article-title>. <source>Am. Stat</source>., <volume>75</volume>,
<fpage>310</fpage>–<lpage>322</lpage>.</mixed-citation>
    </ref>
    <ref id="btac024-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jostins</surname><given-names>L.</given-names></string-name>,
<string-name><surname>Barrett</surname><given-names>J.C.</given-names></string-name></person-group>
(<year>2011</year>) <article-title>Genetic risk prediction in complex
disease</article-title>. <source>Hum. Mol. Genet</source>., <volume>20</volume>,
<fpage>R182</fpage>–<lpage>R188</lpage>.<pub-id pub-id-type="pmid">21873261</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ledoit</surname><given-names>O.</given-names></string-name>,
<string-name><surname>Wolf</surname><given-names>M.</given-names></string-name></person-group>
(<year>2015</year>) <article-title>Spectrum estimation: a unified framework for
covariance matrix estimation and PCA in large dimensions</article-title>. <source>J.
Multivar. Anal</source>., <volume>139</volume>,
<fpage>360</fpage>–<lpage>384</lpage>.</mixed-citation>
    </ref>
    <ref id="btac024-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ledoit</surname><given-names>O.</given-names></string-name>,
<string-name><surname>Wolf</surname><given-names>M.</given-names></string-name></person-group>
(<year>2017</year>) <article-title>Numerical implementation of the QuEST
function</article-title>. <source>Comput. Stat. Data Anal</source>.,
<volume>115</volume>, <fpage>199</fpage>–<lpage>223</lpage>.</mixed-citation>
    </ref>
    <ref id="btac024-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>J.S.</given-names></string-name>,
<string-name><surname>Sabatti</surname><given-names>C.</given-names></string-name></person-group>
(<year>2000</year>) <article-title>Generalised gibbs sampler and multigrid Monte Carlo
for Bayesian computation</article-title>. <source>Biometrika</source>,
<volume>87</volume>, <fpage>353</fpage>–<lpage>369</lpage>.</mixed-citation>
    </ref>
    <ref id="btac024-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lloyd-Jones</surname><given-names>L.R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Improved polygenic
prediction by Bayesian multiple regression on summary statistics</article-title>.
<source>Nat. Commun</source>., <volume>10</volume>,
<fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">30602773</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mak</surname><given-names>T.S.H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Polygenic scores
via penalized regression on summary statistics</article-title>. <source>Genet.
Epidemiol</source>., <volume>41</volume>,
<fpage>469</fpage>–<lpage>480</lpage>.<pub-id pub-id-type="pmid">28480976</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moffatt</surname><given-names>M.F.</given-names></string-name></person-group>  <etal>et al</etal>; GABRIEL Consortium. (<year>2010</year>)
<article-title>A large-scale, consortium-based genomewide association study of
asthma</article-title>. <source>N. Engl. J. Med</source>., <volume>363</volume>,
<fpage>1211</fpage>–<lpage>1221</lpage>.<pub-id pub-id-type="pmid">20860503</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morris</surname><given-names>A.P.</given-names></string-name></person-group>  <etal>et al</etal>; DIAbetes Genetics Replication And Meta-analysis
(DIAGRAM) Consortium. (<year>2012</year>) <article-title>Large-scale association analysis
provides insights into the genetic architecture and pathophysiology of type 2
diabetes</article-title>. <source>Nat. Genet</source>., <volume>44</volume>,
<fpage>981</fpage>–<lpage>990</lpage>.<pub-id pub-id-type="pmid">22885922</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moser</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Simultaneous
discovery, estimation and prediction analysis of complex traits using a Bayesian mixture
model</article-title>. <source>PLoS Genet</source>., <volume>11</volume>,
<fpage>e1004969</fpage>.<pub-id pub-id-type="pmid">25849665</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B28">
      <mixed-citation publication-type="other">Pan-UKB Team (<year>2020</year>) <ext-link xlink:href="https://pan.ukbb.broadinstitute.org" ext-link-type="uri">https://pan.ukbb.broadinstitute.org (29
October 2020, date last accessed)</ext-link>.</mixed-citation>
    </ref>
    <ref id="btac024-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Park</surname><given-names>J.H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) <article-title>Estimation of
effect size distribution from genome-wide association studies and implications for
future discoveries</article-title>. <source>Nat. Genet</source>., <volume>42</volume>,
<fpage>570</fpage>–<lpage>575</lpage>.<pub-id pub-id-type="pmid">20562874</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pattee</surname><given-names>J.</given-names></string-name>,
<string-name><surname>Pan</surname><given-names>W.</given-names></string-name></person-group>
(<year>2020</year>) <article-title>Penalized regression and model selection methods for
polygenic scores on summary statistics</article-title>. <source>PLoS Comput.
Biol</source>., <volume>16</volume>, <fpage>e1008271</fpage>.<pub-id pub-id-type="pmid">33001975</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Prentice</surname><given-names>R.L.</given-names></string-name></person-group> (<year>1988</year>) <article-title>Correlated binary regression with
covariates specific to each binary observation</article-title>.
<source>Biometrics</source>, <volume>44</volume>,
<fpage>1033</fpage>–<lpage>1048</lpage>.<pub-id pub-id-type="pmid">3233244</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Privé</surname><given-names>F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>LDpred2: better,
faster, stronger</article-title>. <source>Bioinformatics</source>, <volume>36</volume>,
<fpage>5424</fpage>–<lpage>5431</lpage>.</mixed-citation>
    </ref>
    <ref id="btac024-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ripke</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>Genome-wide
association study identifies five new schizophrenia loci</article-title>. <source>Nat.
Genet</source>., <volume>43</volume>, <fpage>969</fpage>.<pub-id pub-id-type="pmid">21926974</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shin</surname><given-names>M.</given-names></string-name>,
<string-name><surname>Liu</surname><given-names>J.S.</given-names></string-name></person-group>
(<year>2021</year>) <article-title>Neuronized priors for Bayesian sparse linear
regression</article-title>. <source>J. Am. Stat. Assoc</source>.,
<fpage>1</fpage>–<lpage>43</lpage>.
https://doi.org/10.1080/01621459.2021.1876710.<pub-id pub-id-type="pmid">35757777</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Leveraging effect
size distributions to improve polygenic risk scores derived from summary statistics of
genome-wide association studies</article-title>. <source>PLoS Comput. Biol</source>.,
<volume>16</volume>, <fpage>e1007565</fpage>.<pub-id pub-id-type="pmid">32045423</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stahl</surname><given-names>E.A.</given-names></string-name></person-group>  <etal>et al</etal>; BIRAC Consortium. (<year>2010</year>)
<article-title>Genome-wide association study meta-analysis identifies seven new
rheumatoid arthritis risk loci</article-title>. <source>Nat. Genet</source>.,
<volume>42</volume>, <fpage>508</fpage>–<lpage>514</lpage>.<pub-id pub-id-type="pmid">20453842</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stevens</surname><given-names>R.J.</given-names></string-name>,
<string-name><surname>Poppe</surname><given-names>K.K.</given-names></string-name></person-group>
(<year>2020</year>) <article-title>Validation of clinical prediction models: what does
the “calibration slope” really measure?</article-title>  <source>J. Clin.
Epidemiol</source>., <volume>118</volume>,
<fpage>93</fpage>–<lpage>99</lpage>.<pub-id pub-id-type="pmid">31605731</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Strawderman</surname><given-names>W.E.</given-names></string-name></person-group> (<year>1971</year>) <article-title>Proper Bayes minimax estimators of the
multivariate normal mean</article-title>. <source>Ann. Math. Stat</source>.,
<volume>42</volume>, <fpage>385</fpage>–<lpage>388</lpage>.</mixed-citation>
    </ref>
    <ref id="btac024-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Turcot</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal>; CHD Exome+ Consortium. (<year>2018</year>)
<article-title>Protein-altering variants associated with body mass index implicate
pathways that control energy intake and expenditure in obesity</article-title>.
<source>Nat. Genet</source>., <volume>50</volume>,
<fpage>26</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">29273807</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Turley</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal>; Social Science Genetic Association Consortium.
(<year>2018</year>) <article-title>Multi-trait analysis of genome-wide association
summary statistics using MTAG</article-title>. <source>Nat. Genet</source>.,
<volume>50</volume>, <fpage>229</fpage>–<lpage>237</lpage>.<pub-id pub-id-type="pmid">29292387</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vach</surname><given-names>W.</given-names></string-name></person-group> (<year>2013</year>) <article-title>Calibration of clinical prediction
rules does not just assess bias</article-title>. <source>J. Clin. Epidemiol</source>.,
<volume>66</volume>, <fpage>1296</fpage>–<lpage>1301</lpage>.<pub-id pub-id-type="pmid">24021610</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vilhjálmsson</surname><given-names>B.J.</given-names></string-name></person-group>  <etal>et al</etal>; Schizophrenia Working Group of the Psychiatric
Genomics Consortium, Discovery, Biology, and Risk of Inherited Variants in Breast Cancer
(DRIVE) study. (<year>2015</year>) <article-title>Modeling linkage disequilibrium
increases accuracy of polygenic risk scores</article-title>. <source>Am. J. Hum.
Genet</source>., <volume>97</volume>,
<fpage>576</fpage>–<lpage>592</lpage>.<pub-id pub-id-type="pmid">26430803</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>J.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Calibration slope versus discrimination
slope: shoes on the wrong feet</article-title>. <source>J. Clin. Epidemiol</source>.,
<volume>125</volume>, <fpage>161</fpage>–<lpage>162</lpage>.<pub-id pub-id-type="pmid">32505740</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B44">
      <mixed-citation publication-type="journal">Wellcome Trust Case Control Consortium.
(<year>2007</year>) <article-title>Genome-wide association study of 14,000 cases of
seven common diseases and 3,000 shared controls</article-title>.
<source>Nature</source>, <volume>447</volume>, <fpage>661</fpage>.<pub-id pub-id-type="pmid">17554300</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wood</surname><given-names>A.R.</given-names></string-name></person-group>, LifeLines Cohort Study. <etal>et al</etal> (<year>2014</year>)
<article-title>Defining the role of common variation in the genomic and biological
architecture of adult human height</article-title>. <source>Nat. Genet</source>.,
<volume>46</volume>, <fpage>1173</fpage>–<lpage>1186</lpage>.<pub-id pub-id-type="pmid">25282103</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>S.</given-names></string-name>,
<string-name><surname>Zhou</surname><given-names>X.</given-names></string-name></person-group>
(<year>2020</year>) <article-title>Accurate and scalable construction of polygenic
scores in large biobank data sets</article-title>. <source>Am. J. Hum. Genet</source>.,
<volume>106</volume>, <fpage>679</fpage>–<lpage>693</lpage>.<pub-id pub-id-type="pmid">32330416</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Estimation of
complex effect-size distributions using summary-level statistics from genome-wide
association studies across 32 complex traits</article-title>. <source>Nat.
Genet</source>., <volume>50</volume>,
<fpage>1318</fpage>–<lpage>1326</lpage>.<pub-id pub-id-type="pmid">30104760</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname><given-names>G.</given-names></string-name>,
<string-name><surname>Zhao</surname><given-names>H.</given-names></string-name></person-group>
(<year>2021</year>) <article-title>A fast and robust Bayesian nonparametric method for
prediction of complex traits using summary statistics</article-title>. <source>PLoS
Genet</source>., <volume>17</volume>, <fpage>e1009697</fpage>.<pub-id pub-id-type="pmid">34310601</pub-id></mixed-citation>
    </ref>
    <ref id="btac024-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname><given-names>X.</given-names></string-name>,
<string-name><surname>Stephens</surname><given-names>M.</given-names></string-name></person-group>
(<year>2017</year>) <article-title>Bayesian large-scale multiple regression with summary
statistics from genome-wide association studies</article-title>. <source>Ann. Appl.
Stat</source>., <volume>11</volume>,
<fpage>1561</fpage>–<lpage>1592</lpage>.<pub-id pub-id-type="pmid">29399241</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
