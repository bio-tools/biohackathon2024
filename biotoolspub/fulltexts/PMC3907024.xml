<?DTDIdentifier.IdentifierValue http://www.biomedcentral.com/xml/article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Genomics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Genomics</journal-id>
    <journal-title-group>
      <journal-title>BMC Genomics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2164</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3907024</article-id>
    <article-id pub-id-type="publisher-id">1471-2164-14-674</article-id>
    <article-id pub-id-type="pmid">24088188</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2164-14-674</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>V-Phaser 2: variant inference for viral populations</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Yang</surname>
          <given-names>Xiao</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>xiaoyang@broadinstitute.org</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Charlebois</surname>
          <given-names>Patrick</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>patccmoi@hotmail.com</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Macalalad</surname>
          <given-names>Alex</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>arm@cs.stanford.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Henn</surname>
          <given-names>Matthew R</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>mhenn@sereshealth.com</email>
      </contrib>
      <contrib contrib-type="author" id="A5">
        <name>
          <surname>Zody</surname>
          <given-names>Michael C</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>mczody@broadinstitute.org</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Broad Institute of MIT &amp; Harvard, 7 Cambridge Center, Cambridge, MA 02142 USA</aff>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>3</day>
      <month>10</month>
      <year>2013</year>
    </pub-date>
    <volume>14</volume>
    <fpage>674</fpage>
    <lpage>674</lpage>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>5</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>26</day>
        <month>9</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2013 Yang et al.; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Yang et al.; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2164/14/674"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Massively parallel sequencing offers the possibility of revolutionizing the study of viral populations by providing ultra deep sequencing (tens to hundreds of thousand fold coverage) of complete viral genomes. However, differentiation of true low frequency variants from sequencing errors remains challenging.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We developed a software package, V-Phaser 2, for inferring intrahost diversity within viral populations. This program adds three major new methodologies to the state of the art: a technique to efficiently utilize paired end read data for calling phased variants, a new strategy to represent and infer length polymorphisms, and an in line filter for erroneous calls arising from systematic sequencing artifacts. We have also heavily optimized memory and run time performance. This combination of algorithmic and technical advances allows V-Phaser 2 to fully utilize extremely deep paired end sequencing data (such as generated by Illumina sequencers) to accurately infer low frequency intrahost variants in viral populations in reasonable time on a standard desktop computer. V-Phaser 2 was validated and compared to both QuRe and the original V-Phaser on three datasets obtained from two viral populations: a mixture of eight known strains of West Nile Virus (WNV) sequenced on both 454 Titanium and Illumina MiSeq and a mixture of twenty-four known strains of WNV sequenced only on 454 Titanium. V-Phaser 2 outperformed the other two programs in both sensitivity and specificity while using more than five fold less time and memory.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>We developed V-Phaser 2, a publicly available software tool (V-Phaser 2 can be accessed via: <ext-link ext-link-type="uri" xlink:href="http://www.broadinstitute.org/scientific-community/science/projects/viral-genomics/v-phaser-2">http://www.broadinstitute.org/scientific-community/science/projects/viral-genomics/v-phaser-2</ext-link> and is freely available for academic use) that enables the efficient analysis of ultra-deep sequencing data produced by common next generation sequencing platforms for viral populations.</p>
      </sec>
    </abstract>
    <kwd-group>
      <kwd>Viral population</kwd>
      <kwd>Variant calling</kwd>
      <kwd>Length polymorphisms</kwd>
      <kwd>Phasing</kwd>
      <kwd>Next generation sequencing</kwd>
    </kwd-group>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Inferring variants for viral populations is crucial for understanding disease progression, determining the effect of immune pressure on viral genotype, optimizing vaccine design, and identifying and detecting drug resistance mutations [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B5">5</xref>].</p>
    <p>The basic steps of variant inference in viral populations start by aligning reads to a reference genome, either previously assembled [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>] or assembled <italic>de novo</italic>[<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B8">8</xref>]. Assembling each virus <italic>de novo</italic> prior to variant calling is advantageous as the sample consensus may be highly diverged from any existing reference (if a reference even exists). Also, aligning to a reference that differs too much from the reads may result in reference bias in variant calling or spurious variant calling due to poor alignments [<xref ref-type="bibr" rid="B4">4</xref>]. Then, ideally, any base that differs from the reference base shall be a variant. However, a base difference may occur due to sequencing errors and hence a variant can be identified if it appears more frequent than sequencing errors [<xref ref-type="bibr" rid="B9">9</xref>-<xref ref-type="bibr" rid="B11">11</xref>]. This is typically referred to as a pileup model. To identify variants with much lower frequency, phylogenetic relationships among multiple sites, termed <italic>phasing</italic>, need to be considered [<xref ref-type="bibr" rid="B12">12</xref>]. The rationale is that errors typically appear more randomly and less concordantly with each other compared to real variants that are phylogenetically related, <italic>i.e.</italic> in phase.</p>
    <p>Because of the utilization of the phasing model, V-Phaser [<xref ref-type="bibr" rid="B12">12</xref>] fares better in variant calling compared to other programs for viral population. It was mainly applied to 454 sequencing data, which typically has a few hundred fold read coverage. Illumina sequencing is a cost-effective alternative compared to 454 sequencing and it has several advantages: Illumina data typically provide thousands to tens of thousands read coverage, with which low frequency variants are more likely to be captured. The dominant error mode in 454 data is insertion/deletion error caused by incorrect counting of homopolymers and associated substitutions resulting from carry forward and incomplete extension (CAFIE). In contrast, Illumina errors are primarily single base substitutions. The former results in spurious frameshifts in coding regions and also introduces spurious length polymorphisms (LPs, or indels), which are typically more difficult to manage compared to spurious single nucleotide polymorphisms (SNPs). However, when applied to Illumina sequencing data, V-Phaser has poor scalability. In addition, it is not able to directly utilize phasing information provided by paired end reads.</p>
    <p>We developed the V-Phaser 2 program that overcomes these limitations of V-Phaser [<xref ref-type="bibr" rid="B12">12</xref>]. V-Phaser 2 utilizes paired reads in phasing, extending the distance between phased sites from a read length to a fragment length. A more efficient implementation of the base quality recalibration and error inference algorithms vastly reduces run time and memory use, making it possible to analyze much deeper sequencing data. In addition, in V-Phaser 2, we further addressed the following general issues in the existing viral variant calling methods: </p>
    <p>1) Variant inference programs typically infer variants with respect to a given reference. However, the reference genome may contain bases that do not represent the majority of the read data. This may result in extra computation and neglecting of real variants in phase. We alleviate this issue by first <italic>de novo</italic> assembling the data and creating the reference to which reads can be realigned [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B8">8</xref>]. Then we recompute the consensus using alignment information alone to further avoid the misrepresentation of the consensus during variant calling.</p>
    <p>2) The representation of LPs is not standardized, and the previous methods have been mostly focused on SNPs. We introduced a method to represent and infer LPs.</p>
    <p>3) Alignment programs may have difficulties generating accurate alignments in homopolymeric regions and towards the ends of reads. These alignment artifacts may not be avoided. Therefore, we integrated a filtering strategy that can be used to remove probable recurrent or correlated artifacts based on strand bias.</p>
    <p>We demonstrate the effectiveness of V-Phaser 2 on a mixed population of eight known West Nile virus (WNV) strains, sequenced by both 454 and Illumina MiSeq for 900 fold and 4500 fold effective coverage, respectively, and on a more complex sample consisting of twenty-four WNV strains sequenced by 454 with an effective coverage of around 1,000 fold. V-Phaser 2 has comparable sensitivity to V-Phaser but is superior in controlling false positives. It reduces compute-time and memory usage substantially over V-Phaser. When compared to relevant viral variant inference programs like QuRe [<xref ref-type="bibr" rid="B10">10</xref>], V-Phaser 2 has a higher sensitivity and achieved better run-time and memory usage as well.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <p>V-Phaser 2 requires only read alignment in BAM format [<xref ref-type="bibr" rid="B13">13</xref>] as the input. For each reference genome in the BAM file, it reports both single nucleotide polymorphisms (SNPs) and length polymorphsms (LPs). The API of Bamtools [<xref ref-type="bibr" rid="B14">14</xref>] was used for accessing the BAM file. To be precise about terminology, we term any base that differs from the consensus base (typically the base in the reference genome) a <italic>single nucleotide difference</italic> (SND). When a SND is statistically validated, it is termed a <italic>single nucleotide variant</italic> (SNV). We further term the corresponding consensus a <italic>single nucleotide consensus</italic> (SNC). Likewise, as length polymorphism occurs when an oligo is inserted or deleted compared to the reference, we use the terms <italic>length polymorphism difference</italic> (LPD), <italic>length polymorphism variant</italic> (LPV) and <italic>length polymorphism consensus</italic> (LPC) to denote the inserted or deleted oligo, a statistically validated LPD, and the corresponding consensus.</p>
    <p>The basic idea and strategy used in V-Phaser 2 are outlined below.</p>
    <p>To be able to handle ultra-deep coverage data, <italic>e.g.</italic> &gt;3,000 fold, using a moderate amount of memory, we process each reference genome in the BAM file by first partitioning it into a set of non-overlapping target windows with equal length except the last one. An example is shown in Figure <xref ref-type="fig" rid="F1">1</xref> (a), where the reference is divided into 6 target windows. Then, these target windows are processed in 5 <sup>′</sup> to 3 <sup>′</sup> direction.</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p><bold>Reduce memory footprint by genome partitioning and analysis. </bold><bold>(a)</bold> The reference genome, denoted by a horizontal line, is partitioned into 6 non-overlapping windows <italic>W</italic><sub><italic>i</italic></sub>s (0≤<italic>i</italic>≤5). <bold>(b)</bold> When analyzing each window, all reads overlapping this window as well as the relevant paired end reads are considered. Each read (denoted by a short line) is placed underneath the location where it is aligned to the reference. Each read pair is connected by a dotted line. Assuming <italic>W</italic><sub>1</sub> is the target window, all reads overlapping with <italic>W</italic><sub>1</sub> will be considered for pileup and phase analysis. In addition, reads overlapping with <italic>W</italic><sub>1<italic>i</italic></sub>s, 1≤<italic>i</italic>≤3, will be considered for phase analysis.</p>
      </caption>
      <graphic xlink:href="1471-2164-14-674-1"/>
    </fig>
    <p>For each target window, we obtain complete read alignment information by analyzing any read (partially or fully) aligned to this window. For example, in Figure <xref ref-type="fig" rid="F1">1</xref> (b), let <italic>W</italic><sub>1</sub> be the target and <bold>R</bold><sub>1</sub> be the set of all reads aligned to <italic>W</italic><sub>1</sub>. Then, we infer for every alignment column <italic>c</italic> in <italic>W</italic><sub>1</sub> variants that are statistically significant given base error probabilities in <italic>c</italic> (see details later). To infer variants that may be in phase with variants in <italic>c</italic>, we further investigate alignment information provided by any read that is paired with some read in <bold>R</bold><sub>1</sub>. For <italic>W</italic><sub>1</sub>, this involves reads in windows <italic>W</italic><sub>12</sub> and <italic>W</italic><sub>13</sub> in Figure <xref ref-type="fig" rid="F1">1</xref> (b). Thus, a phased variant may belong to an alignment column <italic>c</italic><sup>′</sup> that is either contained by <italic>W</italic><sub>1</sub>, <italic>W</italic><sub>11</sub>, <italic>W</italic><sub>12</sub> or <italic>W</italic><sub>13</sub>. Note that <italic>c</italic><sup>′</sup> may involve only a subset of reads aligning to this column in the BAM file, <italic>e.g.</italic> in <italic>W</italic><sub>12</sub>. We calculate the mean and standard deviation of fragment size in the BAM file and allow users to limit the distance between paired reads to be considered for phasing. Like V-Phaser [<xref ref-type="bibr" rid="B12">12</xref>], we consider no more than two columns for phasing, as increasing this number may not necessarily improve the results nor be computationally practical.</p>
    <p>V-Phaser 2 combines the strategies used in GATK [<xref ref-type="bibr" rid="B15">15</xref>] and V-Phaser to calibrate sequencing error probability. As in GATK, sequencing error probability is determined by a set of joint variables (e.g., read cycle, quality score, etc.). However, unlike both GATK and V-Phaser, V-Phaser 2 no longer outputs re-calibrated quality scores. Instead, error probabilities are directly calculated by dividing the observed sequencing errors by total number of observations defined by the joint variables. Calculated error probabilities are then used during variant inference rather than drawn from quality scores (see details later). Observed sequencing errors are initialized to be all differences between the reads and the consensus, as it is typically too costly to add a known control sequence, as used in GATK, to be sequenced along with the viral sample for the purpose of measuring sequencing errors.</p>
    <p>We differentiate error probabilities of LPDs and SNDs; for major NGS platforms indel error rate differs substantially from substitution error rate. Note that we do not differentiate insertion from deletion LPDs as in the current application, this classification is only relative to the chosen reference genome to which the reads were aligned. Furthermore, as compared to most existing methods that assume the reference base to be the correct consensus, we do not require the knowledge of the reference genome(s) based on which the BAM file was generated. Instead, the consensus is recalculated using read alignment information, and when multiple bases occur at the same frequency, the alphabetically smallest one is chosen to be the consensus. By doing so, we avoid the unnecessary variant inference and inspect co-variants that would be neglected otherwise. For example, in Figure <xref ref-type="fig" rid="F2">2</xref>, after consensus recalculation, base “A” (column <italic>k</italic>) will not be reported as a variant and the co-variation of “CG” (columns <italic>i</italic> and <italic>j</italic>) becomes evident.</p>
    <fig id="F2" position="float">
      <label>Figure 2</label>
      <caption>
        <p><bold>An example of read alignment with respect to a reference, where only three positions are shown.</bold> Reference bases are bolded. The dominant base in each alignment column is circled. Recalculation of consensus base may fix reference base, initially used for read alignment.</p>
      </caption>
      <graphic xlink:href="1471-2164-14-674-2"/>
    </fig>
    <p>More importantly, recalculated consensus bases using read alignment can better serve as the back-bone sequence of the underlying population, based on which SNVs and LPVs are inferred.</p>
    <p>Given the calibrated error probabilities, V-Phaser 2 iterates through the following steps until no further variants are inferred: 1) calculate SND and LPD error probabilities from the data, 2) infer SNVs and LPVs, 3) remove any alignment column in which a variant has been inferred from error probability calculation. In the second step, the pileup model is first used to infer variants for single alignment column followed by phasing model, where the already inferred variants would not be considered. Lastly, inferred variants that show strand-bias are removed. Below, we present the details of the method.</p>
    <sec>
      <title>Calibrating sequencing error probability</title>
      <p>We use substitution and indel error probabilities to infer SNVs and LPVs, respectively. Since an error base is identified by comparing with the consensus, we first discuss consensus base recalculation using read alignment information. For ease of presentation, we assume reads are aligned in the forward direction. The methodology remains the same for reversely mapped reads with technical differences only.</p>
      <sec>
        <title>Consensus base recalculation</title>
        <p>Let <italic>c</italic><sub><italic>i</italic></sub> denote an alignment column with respect to the reference position <italic>i</italic>, and <italic>c</italic><sub><italic>i</italic>,<italic>i</italic>+1</sub> denote an inserted column between positions <italic>i</italic> and <italic>i</italic>+1. We classify an alignment column to be 1) an inserted column, 2) a column containing deletion start sites among a subset of reads, or 3) neither 1) nor 2). For example, in Figure <xref ref-type="fig" rid="F3">3</xref>, <italic>c</italic><sub><italic>i</italic>−3,<italic>i</italic>−2</sub> is type 1, <italic>c</italic><sub><italic>i</italic></sub> is type 2, and <italic>c</italic><sub><italic>i</italic>+2</sub> is type 3.</p>
        <fig id="F3" position="float">
          <label>Figure 3</label>
          <caption>
            <p><bold>An illustration of consensus base recalculation between reference positions (</bold><bold><italic>i </italic></bold><bold>−3) and (</bold><bold><italic>i </italic></bold><bold>+2) using read alignment information.</bold> The alignment of 7 reads (<italic>r</italic><sub>0</sub>,<italic>r</italic><sub>1</sub>,…,<italic>r</italic><sub>6</sub>) with respect to the reference genomic positions is given. <italic>c</italic><sub><italic>i</italic>−3,<italic>i</italic>−2</sub> and <italic>c</italic><sub><italic>i</italic>−2,<italic>i</italic>−1</sub> denote insertions. Deletions are denoted by “-”s. Each type of length polymorphism is circulated by a blank rectangular. Recalculated single nucleotide consensus (SNC) and length polymorphic consensus (LPC) are shown below the alignment, where each dot denotes that the corresponding consensus base will not be considered.</p>
          </caption>
          <graphic xlink:href="1471-2164-14-674-3"/>
        </fig>
        <p>For type 1 column, we calculate LPC only. Each type of insertion is considered as a “base” in the column. For instance, column <italic>c</italic><sub><italic>i</italic>−3,<italic>i</italic>−2</sub> contains three types of bases: an null base which we denote as “d” (stands for deletion with respect to the reference), an inserted base of “AT”, and an inserted base of “C”. “d” is selected to be the LPC as it is the most frequent type.</p>
        <p>For type 2 column, we calculate both SNC and LPC. A deletion as a whole is treated as a LPD, thus, we consider only deletions starting at this alignment column. Since the deleted fragment is unknown, we treat deletions with the same length as one type of base. Deletions of length zero is denoted as “i” (stands for insertion with respect to the reference). For instance, in Figure <xref ref-type="fig" rid="F3">3</xref>, column <italic>c</italic><sub><italic>i</italic></sub> contains two types of deletions: “D2”, a length 2 deletion, and “i”, where the latter is the LPC. We further calculate SNC by neglecting all deletions in the alignment column, using the same method as in type 3 below.</p>
        <p>For type 3 column, neither insertions nor the start of deletions occur, we calculate SNC only, which is the dominant nucleotide. For instance, the consensus base is “G” for column <italic>c</italic><sub><italic>i</italic>+2</sub> in Figure <xref ref-type="fig" rid="F3">3</xref>. Any base that failed to be called by the sequencer, typically marked as an “N” in a read, is neglected.</p>
        <p>The aforementioned consensus calculation is naturally extended to the phasing stage, where the phasing consensus is derived by concatenating the consensus of two alignment columns of interest. At most four types of phasing consensus would be calculated.</p>
      </sec>
      <sec>
        <title>Error probability calculation</title>
        <p>We associate a specific base with the following variables: read cycle (denoted by <italic>α</italic>), di-nucleotide content (denoted by <italic>β</italic>), quality score (denoted by <italic>γ</italic>), and the order of the read in the mate pair (denoted by <italic>θ</italic>). Let <italic>C</italic><sub>·</sub> (·∈{<italic>α</italic>,<italic>β</italic>,<italic>γ</italic>,<italic>θ</italic>}) denote the cardinality of the corresponding variable, which is uniquely determined when an input dataset is specified. Then the total combinations is given by <italic>C</italic><sub><italic>α</italic></sub>×<italic>C</italic><sub><italic>β</italic></sub>×<italic>C</italic><sub><italic>γ</italic></sub>×<italic>C</italic><sub><italic>θ</italic></sub>. For example, assuming in a Illumina paired read dataset, the maximum read cycle is 101, the total number of di-nucleotides is 4<sup>2</sup>=16, the quality score value is in the range of ‘#’ and ‘I’ (39 ASCII characters), and a read can either be the first or the second in the mate-pair. Then <italic>C</italic><sub><italic>α</italic></sub>=101,<italic>C</italic><sub><italic>β</italic></sub>=16,<italic>C</italic><sub><italic>γ</italic></sub>=39 and <italic>C</italic><sub><italic>θ</italic></sub>=2, and the total number of such combinations is <italic>C</italic><sub><italic>α</italic></sub>×<italic>C</italic><sub><italic>β</italic></sub>×<italic>C</italic><sub><italic>γ</italic></sub>×<italic>C</italic><sub><italic>θ</italic></sub>=126,048.</p>
        <p>A base can be uniquely projected to one of these combinations, which we term as a <italic>bucket</italic> for the base, and the index of the bucket can be calculated as <italic>α</italic>×<italic>C</italic><sub><italic>β</italic></sub>×<italic>C</italic><sub><italic>γ</italic></sub>×<italic>C</italic><sub><italic>θ</italic></sub>+<italic>β</italic>×<italic>C</italic><sub><italic>γ</italic></sub>×<italic>C</italic><sub><italic>θ</italic></sub>+<italic>γ</italic>×<italic>C</italic><sub><italic>θ</italic></sub>+<italic>θ</italic>. Note that <italic>β</italic>, <italic>γ</italic> and <italic>θ</italic> are converted to the integer values.</p>
        <p>Given the read data, two values are computed for each bucket: the frequency of total bases in the bucket, <italic>N</italic><sub><italic>a</italic><italic>l</italic><italic>l</italic></sub>, and the frequency of bases that do not match the recalculated consensus bases in their corresponding alignment columns, <italic>N</italic><sub><italic>m</italic><italic>i</italic><italic>s</italic></sub>. Then, the error probability of each bucket is calculated as <italic>N</italic><sub><italic>m</italic><italic>i</italic><italic>s</italic></sub>/<italic>N</italic><sub><italic>a</italic><italic>l</italic><italic>l</italic></sub>. This may be an over estimation of error probability for some buckets when the mismatches resulted from real variants in the data are included.</p>
        <p>For a nucleotide in the alignment, the calculation of its bucket is straight-forward. For an insertion or a deletion, <italic>α</italic> and <italic>γ</italic> are assigned the same values as the nucleotide preceding it in the 5 <sup>′</sup> region on the same read; and <italic>β</italic> is determined by the di-nucleotide that is formed by concatenating its two neighboring nucleotides. For example, in Figure <xref ref-type="fig" rid="F3">3</xref>, <italic>β</italic>=1 and the di-nucleotide is “AC” for the “AT” insertion of read <italic>r</italic><sub>3</sub>, and <italic>β</italic>=3, and the di-nucleotide is “CG” for the 2 base deletion of read <italic>r</italic><sub>0</sub>.</p>
        <p>Using the above method, we create buckets for calculating SND and LPD error probabilities, respectively. For the former, all bases in the type 3 columns and all nucleotide bases in type 2 columns are used for calculating two bucket values, where SNC is used to determine if a mismatch occurs; and for the latter, all bases in every column are used for calculation, except that LPC is used to determine mismatches. Thus, given a base in the alignment, let it be a nucleotide, a deletion, or an insertion, the error probability can be calculated by first identifying its bucket and then by dividing the two values in the bucket as described above. The phasing error probability for two columns of interest is equal to the product of the LPD or SND error probabilities of both columns; hence, up to four types of phasing probability are calculated: SND versus SND, SND versus LPD, LPD versus SND, and LPD versus LPD.</p>
        <p>To provide flexibility for different applications, we allow users to use a subset of these variables. For example, when the target viral genomic region of interest is fully contained by every read of the input, there exists strong correlation between both cycle in the read and dinucleotide content and sites of real variation. In such cases, it is more appropriate to neglect these variables in the model. When none of these variables are used, the error probability becomes independently and identically distributed, which is equivalent to dividing the total number of non-consensus bases by the total number of bases in the alignment data.</p>
      </sec>
    </sec>
    <sec>
      <title>Inferring SNVs and LPVs</title>
      <p>The solution boils down to answering the following two questions: 1) given an alignment column and the error probability for each base in this column, does any non-consensus base occur more frequently than expected due to sequencing errors, and 2) given two alignment columns and the error probability for each base involved, does any pair of non-consensus bases co-occur more frequently than expected due to sequencing errors.</p>
      <p>We first illustrate the pileup and phasing probability model defined by [<xref ref-type="bibr" rid="B12">12</xref>] in Figure <xref ref-type="fig" rid="F4">4</xref>. <inline-formula><mml:math id="M1" name="1471-2164-14-674-i1" overflow="scroll"><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:math></inline-formula> are the reads overlapping reference position <italic>i</italic> in pileup (a) or both <italic>i</italic> and <italic>j</italic> in phasing (b) models. Base <italic>b</italic><sub><italic>i</italic><italic>k</italic></sub> having error probability <italic>p</italic><sub><italic>i</italic><italic>k</italic></sub> is considered an error if it differs from the consensus. The corresponding indicator functions <italic>E</italic><sub><italic>i</italic><italic>k</italic></sub>=1 when <italic>b</italic><sub><italic>i</italic><italic>k</italic></sub> is an error and <italic>E</italic><sub><italic>i</italic><italic>j</italic><italic>k</italic></sub>=1 when both <italic>b</italic><sub><italic>i</italic><italic>k</italic></sub> and <italic>b</italic><sub><italic>j</italic><italic>k</italic></sub> are errors. The former two questions are then answered by determining if the following two functions are statistically significant: <inline-formula><mml:math id="M2" name="1471-2164-14-674-i2" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="M3" name="1471-2164-14-674-i3" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ij</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>E</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ijk</mml:mtext></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula>, where <italic>P</italic><sub><italic>m</italic></sub>(<italic>n</italic><sub><italic>i</italic></sub>) denote the probability that given coverage <italic>n</italic><sub><italic>i</italic></sub> at position <italic>i</italic>, the probability of observing <italic>m</italic> errors.</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>Error model for inferring statistically significant variants based on (a) Pileup and (b) Phasing.</bold> The reference genome has length <italic>l</italic>. <italic>b</italic><sub><italic>i</italic><italic>k</italic></sub> is the <italic>i</italic><sup><italic>t</italic><italic>h</italic></sup> base of read <italic>r</italic><sub><italic>k</italic></sub>.</p>
        </caption>
        <graphic xlink:href="1471-2164-14-674-4"/>
      </fig>
      <p>As the error probability of each base may differ, <italic>P</italic><sub><italic>m</italic></sub>(<italic>n</italic><sub><italic>i</italic></sub>) follows the Poisson binomial distribution and can be calculated exactly by a recursive function in <inline-formula><mml:math id="M4" name="1471-2164-14-674-i4" overflow="scroll"><mml:mi>O</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula> time [<xref ref-type="bibr" rid="B16">16</xref>]. This strategy was used in V-Phaser. However, as in the current application <italic>n</italic><sub><italic>i</italic></sub> is typically large and the error probability is small, this can be well approximated by the Poisson distribution <italic>P</italic><sub><italic>m</italic></sub>(<italic>n</italic><sub><italic>i</italic></sub>)≈<italic>P</italic><italic>o</italic><italic>i</italic><italic>s</italic><italic>s</italic><italic>o</italic><italic>n</italic>(<italic>m</italic>;<italic>λ</italic>) [<xref ref-type="bibr" rid="B16">16</xref>], where <inline-formula><mml:math id="M5" name="1471-2164-14-674-i5" overflow="scroll"><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> for the pileup model and <inline-formula><mml:math id="M6" name="1471-2164-14-674-i6" overflow="scroll"><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">ik</mml:mtext></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mtext mathvariant="italic">jk</mml:mtext></mml:mrow></mml:msub></mml:math></inline-formula> for the phasing model. Use of this approximation makes the run time linear with respect to the coverage and results in substantial speed up for relevant coverages.</p>
      <p>Using the above strategy, we inspect for every single alignment column the probability of observing SNDs and LPDs and for each pair of alignment columns all four combinations of probabilities of observing phased SNDs and LPDs. <inline-formula><mml:math id="M7" name="1471-2164-14-674-i7" overflow="scroll"><mml:mi>Š</mml:mi><mml:mtext>id</mml:mtext><mml:mi>á</mml:mi></mml:math></inline-formula>k correction [<xref ref-type="bibr" rid="B17">17</xref>] was used to correct for multiple tests.</p>
    </sec>
    <sec>
      <title>Filtering systematic artifacts</title>
      <p>The statistical methods used to distinguish real variants from sequencing error assume error modes that follow the models above. In practice, some sequencing errors systematically occur at certain loci on certain instruments [<xref ref-type="bibr" rid="B18">18</xref>]. Many such artifacts display a strong bias towards one strand of sequencing, making strand symmetry of the alleles a simple and useful filter [<xref ref-type="bibr" rid="B15">15</xref>]. Hence, we applied either a Chi-square test or Fisher’s exact test to each identified variant by generating a two by two table, where the rows are labeled as the forward or the reverse strand, and the columns are labeled as the target allele and other alleles, and each entry of the cell registers the corresponding count. Chi-square test was applied whenever all cell entries in the table have an expected value of ≥5, otherwise, Fisher’s exact test was used. To correct for multiple hypothesis testing, we used the Benjamini - Hochberg procedure [<xref ref-type="bibr" rid="B19">19</xref>] to control for false discovery rate (FDR) at the level of 0.05. Note that although the above procedure may be effective in removing spurious variants, there is a risk of removing real variants and the reason is not yet clear.</p>
    </sec>
    <sec>
      <title>Generation of West Nile virus sequence data</title>
      <p>Sequence data for evaluation was generated as described in Macalalad et al. [<xref ref-type="bibr" rid="B12">12</xref>]. Briefly eight (8-mix) or twenty-four (24-mix) strains of West Nile virus (WNV) isolated from birds and mosquitos were pooled at equal concentration and used to infect C6/36 cells. After competitive replication, the viral RNA was isolated, reverse transcribed to cDNA, and then amplified using four overlapping amplicons each of approximately 3 kb length. The resulting amplicons were used as input to library construction for 454 and Illumina sequencing.</p>
    </sec>
  </sec>
  <sec>
    <title>Result and discussion</title>
    <p>To validate the result of variant inference, we used a sample consisting of a mixture of 8 known strains of West Nile Virus, sequenced by 454 [<xref ref-type="bibr" rid="B12">12</xref>] and Illumina MiSeq sequencers, respectively. A more complex sample consisting of a mixture of 24 known strains of West Nile Virus sequenced by 454 was also analyzed. The workflow of our validation process is given in Figure <xref ref-type="fig" rid="F5">5</xref>, where each part of the diagram is described in detail below.</p>
    <fig id="F5" position="float">
      <label>Figure 5</label>
      <caption>
        <p><bold>Variant validation.</bold> Variants inferred by a variant calling program on the sequence data of a mixed population sample (left panel) are validated against real variants, which are inferred to be bases at positions of the multiple sequence alignment of the parental strains of the same sample, where not all bases are identical (right panel).</p>
      </caption>
      <graphic xlink:href="1471-2164-14-674-5"/>
    </fig>
    <sec>
      <title>Data sets, assembly and read mapping</title>
      <p>The input datasets (Table <xref ref-type="table" rid="T1">1</xref>) were first assembled <italic>de novo</italic> using AV454 [<xref ref-type="bibr" rid="B4">4</xref>] to generate reference genomes representing the underlying populations (Figure <xref ref-type="fig" rid="F5">5</xref> (a)). The resulting reference genomes are 10,621bp and 10,664bp in length for the 8-mix and the 24-mix samples, respectively.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Dataset description and read mapping results</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left" valign="bottom"> <hr/></th>
              <th align="center" valign="bottom">
                <bold>Data</bold>
                <hr/>
              </th>
              <th align="right" valign="bottom">
                <bold># of</bold>
                <hr/>
              </th>
              <th align="right" valign="bottom">
                <bold>% reads</bold>
                <hr/>
              </th>
              <th align="right" valign="bottom">
                <bold>Coverage</bold>
                <hr/>
              </th>
            </tr>
            <tr>
              <th align="left"> </th>
              <th align="left"> </th>
              <th align="right">
                <bold>reads</bold>
              </th>
              <th align="right">
                <bold>mapped</bold>
              </th>
              <th align="left"> </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">454<hr/></td>
              <td align="right" valign="bottom">26,771<hr/></td>
              <td align="right" valign="bottom">99.9<hr/></td>
              <td align="right" valign="bottom">919<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">8-mix<hr/></td>
              <td align="left" valign="bottom">MiSeq<hr/></td>
              <td align="right" valign="bottom">308,260<hr/></td>
              <td align="right" valign="bottom">69.1<hr/></td>
              <td align="right" valign="bottom">4,512<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">MiSeq trimmed<hr/></td>
              <td align="right" valign="bottom">290,875<hr/></td>
              <td align="right" valign="bottom">94.4<hr/></td>
              <td align="right" valign="bottom">4,466<hr/></td>
            </tr>
            <tr>
              <td align="left">24-mix</td>
              <td align="left">454</td>
              <td align="right">39,759</td>
              <td align="right">95.7</td>
              <td align="right">1,074</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Next, the 454 reads and MiSeq reads were mapped to the corresponding reference genomes (Figure <xref ref-type="fig" rid="F5">5</xref> (b)) using Mosaik 2.1.33 (<ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/mosaik-aligner/">http://code.google.com/p/mosaik-aligner/</ext-link>, with parameters “m = all, gop = 15, hgop = 4, gep = 6.7, mmp = 0.15, minp = 0.5” for 454 data and “m = all, gop = 50, hgop = 40, gep = 15, mmp = 0.07, minp = 0.9” for Illumina data). RC454 [<xref ref-type="bibr" rid="B4">4</xref>] was further applied to correct homopolymer and carry-forward errors in 454 data. The mapping results (Table <xref ref-type="table" rid="T1">1</xref>) indicate that the 454 data has high quality whereas the quality of MiSeq data for the 8-mix is relatively poor. As the quality of read mapping may affect variant inference substantially, trimming is applied to MiSeq data: since the bad quality suffix of a read is indicated by a quality score of 2, we trim MiSeq reads by removing 3<sup>′</sup> suffix of each read with such a quality, and retain only reads with a minimum length of 30bp. Post-trimming, the percentage of mapped reads increased to 94.4%, indicating a substantial improvement of read quality. Lastly, we use GATK (version 2.1-13-g1706365) indel realigner component [<xref ref-type="bibr" rid="B15">15</xref>] to adjust the local alignment of indels for MiSeq read mapping results.</p>
    </sec>
    <sec>
      <title>Benchmark variants in the mixed populations</title>
      <p>In order to evaluate the result of variant inference, we need to determine real variants in the mixed population, which can be done by inspecting the known parental viral strains in the mixed population.</p>
      <p>Multiple sequence alignment of all known strains and the assembled reference genome was obtained (Figure <xref ref-type="fig" rid="F5">5</xref> (c)). Any alignment position containing more than one type of base is considered to have variation. This way we obtained 121 SNVs and no LPV for the 8-mix data and 258 SNVs and 3 LPVs for the 24-mix data. We need to mention that for the 24-mix data, we only successfully obtained 21 individual strains in the mix whereas the remaining 3 failed the sequencing. Thus, it is likely that the 24-mix sample contains very low quantity of viral particles for the 3 strains that failed sequencing process. Hence, the multiple sequence alignment was performed on the 21 input strains and the assembled sequence.</p>
      <p>Some of the variants in the input strains may not necessarily be observed in the sequencing data. After eliminating those that have 0 instances in the 454 and MiSeq data for the 8-mix and in the 454 data for the 24-mix, we obtained 114 variants for the former and 243 variants for the latter as our benchmark (Figure <xref ref-type="fig" rid="F5">5</xref> (d)). All of these variants are SNVs. The frequencies of these variants in the sequence data are summarized in Table <xref ref-type="table" rid="T2">2</xref>. Note that it is challenging to determine the origin of additional variants that are not present in the sequences of the input strains but which may appear at high confidence in the data. First, as we have only consensus sequences of the parental strains, some may be low frequency variants in the input strains that are detected in the final mix but not observed in the alignment of parental consensus. For the 24-mix, these may also come from the parental strains which failed consensus sequencing. Some may also represent real viral variants occurring in cell culture during the competitive growth of the mixed strains. Finally, some may result from errors occurring during reverse transcription or early rounds of PCR amplification that are at detectable frequency but represent true reads by the sequencing instrument and so are not detectable as errors under the model used even though they do not represent true variants in the input RNA. Because these were not validated by experiments, we choose not to explore them for benchmarking and instead treat them all as false positives despite the fact that some may be real variants.</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>The variants are divided into four different bins according to their observed frequencies in the read alignment data</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th colspan="2" align="center" valign="bottom">
                <bold>Data</bold>
                <hr/>
              </th>
              <th colspan="4" align="center" valign="bottom">
                <bold>Number of variants with frequency</bold>
                <hr/>
              </th>
            </tr>
            <tr>
              <th align="left"> </th>
              <th align="left"> </th>
              <th align="center">
                <bold>(0, 0.5%]</bold>
              </th>
              <th align="center">
                <bold>(0.5%, 1%]</bold>
              </th>
              <th align="center">
                <bold>(1%, 5%]</bold>
              </th>
              <th align="center">
                <bold>(5%, 50%)</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">8-mix<hr/></td>
              <td align="center" valign="bottom">454<hr/></td>
              <td align="center" valign="bottom">3<hr/></td>
              <td align="center" valign="bottom">9<hr/></td>
              <td align="center" valign="bottom">11<hr/></td>
              <td align="center" valign="bottom">91<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="center" valign="bottom">MiSeq<hr/></td>
              <td align="center" valign="bottom">3<hr/></td>
              <td align="center" valign="bottom">10<hr/></td>
              <td align="center" valign="bottom">6<hr/></td>
              <td align="center" valign="bottom">95<hr/></td>
            </tr>
            <tr>
              <td align="left">24-mix</td>
              <td align="center">454</td>
              <td align="center">4</td>
              <td align="center">11</td>
              <td align="center">148</td>
              <td align="center">80</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>In each set of sequencing data, we examine only those positions where multiple base types are observed in the raw alignments. As a result, a total of 924, 9,714, and 3,134 positions are inspected in the 8-mix 454 data, 8-mix Illumina MiSeq data, and 24-mix 454 data, respectively (Table <xref ref-type="table" rid="T3">3</xref>). The remaining sites contain no non-consensus calls are trivially called as consensus without need for application of statistical inference.</p>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>Variant inference results of V-Phaser, QuRe and V-Phaser 2 on three datasets</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
            <col/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th colspan="2" align="center">
                <bold>Data</bold>
              </th>
              <th align="left">
                <bold>Method</bold>
              </th>
              <th align="right">
                <bold>TP</bold>
              </th>
              <th align="right">
                <bold>FP</bold>
              </th>
              <th align="right">
                <bold>FN</bold>
              </th>
              <th align="right">
                <bold>TN</bold>
              </th>
              <th align="right">
                <bold>Sensitivity</bold>
              </th>
              <th align="right">
                <bold>Specificity</bold>
              </th>
              <th align="right">
                <bold>Run time (min)</bold>
              </th>
              <th align="right">
                <bold>Memory (G)</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">V-Phaser<hr/></td>
              <td align="right" valign="bottom">110<hr/></td>
              <td align="right" valign="bottom">116<hr/></td>
              <td align="right" valign="bottom">4<hr/></td>
              <td align="right" valign="bottom">694<hr/></td>
              <td align="right" valign="bottom">
                <bold>96.49%</bold>
                <hr/>
              </td>
              <td align="right" valign="bottom">85.56%<hr/></td>
              <td align="right" valign="bottom">34.3<hr/></td>
              <td align="right" valign="bottom">12.51<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">454<hr/></td>
              <td align="left" valign="bottom">QuRe<hr/></td>
              <td align="right" valign="bottom">59<hr/></td>
              <td align="right" valign="bottom">19<hr/></td>
              <td align="right" valign="bottom">55<hr/></td>
              <td align="right" valign="bottom">791<hr/></td>
              <td align="right" valign="bottom">51.75%<hr/></td>
              <td align="right" valign="bottom">
                <bold>97.65%</bold>
                <hr/>
              </td>
              <td align="right" valign="bottom">6.5<hr/></td>
              <td align="right" valign="bottom">7.50<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">V-Phaser 2<hr/></td>
              <td align="right" valign="bottom">105<hr/></td>
              <td align="right" valign="bottom">27<hr/></td>
              <td align="right" valign="bottom">9<hr/></td>
              <td align="right" valign="bottom">783<hr/></td>
              <td align="right" valign="bottom">92.11%<hr/></td>
              <td align="right" valign="bottom">96.67%<hr/></td>
              <td align="right" valign="bottom">
                <bold>0.9</bold>
                <hr/>
              </td>
              <td align="right" valign="bottom">
                <bold>0.04</bold>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left" valign="bottom">8-mix<hr/></td>
              <td align="left" valign="bottom">Illumina<hr/></td>
              <td align="left" valign="bottom">V-Phaser<hr/></td>
              <td align="right" valign="bottom">-<hr/></td>
              <td align="right" valign="bottom">-<hr/></td>
              <td align="right" valign="bottom">-<hr/></td>
              <td align="right" valign="bottom">-<hr/></td>
              <td align="right" valign="bottom">-<hr/></td>
              <td align="right" valign="bottom">-<hr/></td>
              <td align="right" valign="bottom">&gt;600.0<hr/></td>
              <td align="right" valign="bottom">&gt;100.00<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">MiSeq<hr/></td>
              <td align="left" valign="bottom">QuRe<hr/></td>
              <td align="right" valign="bottom">87<hr/></td>
              <td align="right" valign="bottom">84<hr/></td>
              <td align="right" valign="bottom">27<hr/></td>
              <td align="right" valign="bottom">9,516<hr/></td>
              <td align="right" valign="bottom">76.31%<hr/></td>
              <td align="right" valign="bottom">99.13%<hr/></td>
              <td align="right" valign="bottom">206.3<hr/></td>
              <td align="right" valign="bottom">11.00<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">V-Phaser 2<hr/></td>
              <td align="right" valign="bottom">106<hr/></td>
              <td align="right" valign="bottom">40<hr/></td>
              <td align="right" valign="bottom">8<hr/></td>
              <td align="right" valign="bottom">9,560<hr/></td>
              <td align="right" valign="bottom">
                <bold>92.98%</bold>
                <hr/>
              </td>
              <td align="right" valign="bottom">
                <bold>99.58%</bold>
                <hr/>
              </td>
              <td align="right" valign="bottom">
                <bold>36.1</bold>
                <hr/>
              </td>
              <td align="right" valign="bottom">
                <bold>0.73</bold>
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom"> <hr/></td>
              <td align="left" valign="bottom">V-Phaser<hr/></td>
              <td align="right" valign="bottom">194<hr/></td>
              <td align="right" valign="bottom">180<hr/></td>
              <td align="right" valign="bottom">49<hr/></td>
              <td align="right" valign="bottom">2,711<hr/></td>
              <td align="right" valign="bottom">79.84%<hr/></td>
              <td align="right" valign="bottom">93.84%<hr/></td>
              <td align="right" valign="bottom">120.6<hr/></td>
              <td align="right" valign="bottom">18.20<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">24-mix<hr/></td>
              <td align="left" valign="bottom">454<hr/></td>
              <td align="left" valign="bottom">QuRe<hr/></td>
              <td align="right" valign="bottom">124<hr/></td>
              <td align="right" valign="bottom">201<hr/></td>
              <td align="right" valign="bottom">119<hr/></td>
              <td align="right" valign="bottom">2,690<hr/></td>
              <td align="right" valign="bottom">51.03%<hr/></td>
              <td align="right" valign="bottom">93.05%<hr/></td>
              <td align="right" valign="bottom">19.5<hr/></td>
              <td align="right" valign="bottom">7.80<hr/></td>
            </tr>
            <tr>
              <td align="left"> </td>
              <td align="left"> </td>
              <td align="left">V-Phaser 2</td>
              <td align="right">196</td>
              <td align="right">61</td>
              <td align="right">48</td>
              <td align="right">2,829</td>
              <td align="right">
                <bold>80.33%</bold>
              </td>
              <td align="right">
                <bold>97.89%</bold>
              </td>
              <td align="right">
                <bold>2.4</bold>
              </td>
              <td align="right">
                <bold>0.14</bold>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The results show that V-Phaser 2 substantially reduces the run-time and memory usage compared to V-Phaser and QuRe; V-Phaser 2 has comparable sensitivity with V-Phaser, where both are better than QuRe; V-Phaser 2 has comparable specificity compared to QuRe, where both are better than V-Phaser. ‘-’ indicates the corresponding value was not measured. We terminated V-Phaser after it uses over 100G memory on the Illumina MiSeq data. For each performance measure, the best value is bolded.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>Comparing V-Phaser 2 with V-Phaser and relevant programs</title>
      <p>In Table <xref ref-type="table" rid="T3">3</xref>, we present the variant inference results of V-Phaser 2, V-Phaser, and QuRe [<xref ref-type="bibr" rid="B10">10</xref>] on all three datasets with the default parameters for all. Attempts have been made to test all programs reviewed in [<xref ref-type="bibr" rid="B20">20</xref>], nonetheless, only QuRe successfully ran on all the datasets. Although another program, Segminator II [<xref ref-type="bibr" rid="B11">11</xref>], can handle all three datasets as well, we consider the comparison would not be meaningful as in deep coverage data, it reports variants in every single position with respect to the reference genome and the burden of choosing the correct variants is left to the user. QuRe reported haplotypes for the underlying population, where multiple sequence alignment of the haplotypes were created using MUSCLE and the variants were determined at positions wherever variations occur. The coordinates of these variants were then transformed to the coordinates of the corresponding reference genome to be comparable.</p>
      <p>All of the experiments were performed on a Linux system, with 24 heterogeneous AMD Opteron Processors working at 800 MHz and 2400 MHz. V-Phaser used one core, whereas both V-Phaser 2 and QuRe can take advantage of multi-core architecture, where eight cores were used.</p>
      <p>For all three datasets, V-Phaser 2 is the most efficient. It achieved 38-50 fold reduction in run-time and 130-320 fold reduction in memory usage when compared to V-Phaser for runs where V-Phaser was able to complete. For the 8-mix Illumina MiSeq data, we terminated V-Phaser after it used exceedingly large memory (over 100 Gb). V-Phaser 2 is also substantially more efficient compared to QuRe, where 7-8 fold reduction in run-time and 15-187 fold reduction in memory usage were observed.</p>
      <p>V-Phaser 2 and V-Phaser have comparable sensitivity, where both outperform QuRe large as a result of their utilization of the phasing model. More specifically, for the 8-mix 454 data, V-Phaser 2 inferred 105 real variants that are fully contained in the variant set inferred by V-Phaser. All three real variants with frequency ≤0.5<italic>%</italic> (Table <xref ref-type="table" rid="T2">2</xref>) were missed by both programs. V-Phaser inferred five more true variants than V-Phaser 2, where four of them have frequency ≤1.6<italic>%</italic> and the remaining one has frequency 12.08% but showed strand bias. QuRe misses about half of the real variants, and the minimum frequency of the variants identified is 5.79%. For the 8-mix MiSeq data, the sensitivity of QuRe improved on the same sample but still trailed V-Phaser 2, which has comparable sensitivity to the result it produced for the 454 data. It is worth noting that although the same 8-mix sample is sequenced by 454 and Illumina MiSeq, the variant calling results from V-Phaser 2 and QuRe differ, mainly because of the differences in sequencing depth and read alignment. For the 24-mix 454 data, the coverage is slightly higher compared to the 454 data of the 8-mix (Table <xref ref-type="table" rid="T1">1</xref>). V-Phaser and V-Phaser 2 inferred 183 real variants in common, and both missed a common set of 34 real variants. The uniquely inferred real variants are 11 for V-Phaser and 13 for V-Phaser 2. The high percentage of overlap in inferred real variants for both 454 datasets indicates that the two programs are highly consistent.</p>
      <p>In general, V-Phaser 2 has better specificity compared to V-Phaser, which is due to the inclusion of the strand bias test in the former that eliminated many false positive inferences. It also inferred many fewer false positives compared to QuRe on two of the datasets. As we discussed earlier, the homopolymer sequencing errors are more difficult to handle. This has been reflected in the results of QuRe, which infers many false LPVs in the 454 data but none in the MiSeq data.</p>
      <p>Although in the current datasets, there should be no real LPVs based on the parental strain analysis, V-Phaser 2 did predict 5 insertions in MiSeq data (Table <xref ref-type="table" rid="T4">4</xref>) and 2 insertions in the 24-mix data. Upon further inspection, it appears that all these variants seem to be existing in the input reads. The LPVs in MiSeq data (see Table <xref ref-type="table" rid="T4">4</xref>) showed no strand bias while falling in the scope of frequencies of real variants. Since all these cases are present in the homopolymer region (the inserted As are part of a stretch of six As and the G is present in a stretch of eight Gs), these variants could have been artificially introduced during the PCR process. The two insertions in the 24-mix data form a more interesting case, where a one base insertion A is present after position 4135 with respect to the reference and a two base insertion GT is present downstream after position 4320. These two insertions are in phase and are present at the frequency of 0.3342%. As a result, when compared to the normal open reading frame, an additional codon is inserted. Since it does not result in the introduction of any stop codon, the resulting protein is likely functional.</p>
      <table-wrap position="float" id="T4">
        <label>Table 4</label>
        <caption>
          <p>Characterizing falsely inferred LPVs in 8-mix Illumina MiSeq data</p>
        </caption>
        <table frame="hsides" rules="groups" border="1">
          <colgroup>
            <col align="left"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
            <col align="center"/>
          </colgroup>
          <thead valign="top">
            <tr>
              <th align="left" valign="bottom">
                <bold>Reference</bold>
                <hr/>
              </th>
              <th align="left" valign="bottom">
                <bold>Inferred LPV</bold>
                <hr/>
              </th>
              <th align="left" valign="bottom">
                <bold>Consensus</bold>
                <hr/>
              </th>
              <th align="left" valign="bottom">
                <bold>LPV</bold>
                <hr/>
              </th>
              <th align="left" valign="bottom">
                <bold>Strand bias</bold>
                <hr/>
              </th>
            </tr>
            <tr>
              <th align="left">
                <bold>position</bold>
              </th>
              <th align="left">
                <bold>count (+, -)</bold>
              </th>
              <th align="left">
                <bold>count (+, -)</bold>
              </th>
              <th align="left">
                <bold>frequency</bold>
              </th>
              <th align="left">
                <bold>
                  <italic>p</italic>
                </bold>
                <bold>-value</bold>
              </th>
            </tr>
          </thead>
          <tbody valign="top">
            <tr>
              <td align="left" valign="bottom">4115<hr/></td>
              <td align="left" valign="bottom">IA (86, 86)<hr/></td>
              <td align="left" valign="bottom">(2131, 2013)<hr/></td>
              <td align="left" valign="bottom">4.15%<hr/></td>
              <td align="left" valign="bottom">0.72<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">5172<hr/></td>
              <td align="left" valign="bottom">IA (12, 20)<hr/></td>
              <td align="left" valign="bottom">(1632, 2149)<hr/></td>
              <td align="left" valign="bottom">0.85%<hr/></td>
              <td align="left" valign="bottom">0.52<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">6203<hr/></td>
              <td align="left" valign="bottom">IA (64, 40)<hr/></td>
              <td align="left" valign="bottom">(2494, 2123)<hr/></td>
              <td align="left" valign="bottom">2.25%<hr/></td>
              <td align="left" valign="bottom">0.13<hr/></td>
            </tr>
            <tr>
              <td align="left" valign="bottom">8294<hr/></td>
              <td align="left" valign="bottom">IG (21, 14)<hr/></td>
              <td align="left" valign="bottom">(1923, 1625)<hr/></td>
              <td align="left" valign="bottom">0.99%<hr/></td>
              <td align="left" valign="bottom">0.49<hr/></td>
            </tr>
            <tr>
              <td align="left">9063</td>
              <td align="left">IA (22, 16)</td>
              <td align="left">(2054, 2074)</td>
              <td align="left">0.92%</td>
              <td align="left">0.35</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>(+, -) denote the positive and negative strands. ‘I’ denotes the LPV is an insertion.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="conclusions">
    <title>Conclusions</title>
    <p>At a higher sequencing depth of intra-host viral population data, ranging anywhere from a thousand to tens of thousands fold, it is expected that we would pick up signals that were previously unseen at a lower coverage. As such practice becomes routine, we are facing both the computational challenge of controlling run time and memory usage as well as the biological challenge of teasing out real variants from systematic errors.</p>
    <p>We have implemented V-Phaser 2 to address these challenges. It overcomes the major performance bottleneck in the previous version and has a better control for false positive predictions. Moreover, V-Phaser 2 has a clear model for length polymorphic variants, which is particularly relevant for the study of chronic diseases like HIV. Nonetheless, these variations may occur in an acute disease as well but could have been missed in lower coverage data due to a lack of power to detect such variants. We believe that V-Phaser 2 would be useful in studying these cases.</p>
    <p>A remaining challenge is to improve filtering techniques to further reduce the number of false positives while retaining high sensitivity. Certain systematic errors of unknown origin remain that are called as true variants under the current models and not filtered out by strand bias testing. On the other hand, certain true variants appear to be filtered out by the strand bias filter for reasons that are not well understood. In spite of these challenges, V-Phaser 2 represents a major step forward in our ability to accurately call low level intra-host variation in very deep coverage sequencing data from multiple platforms.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors’ contributions</title>
    <p>XY, MCZ &amp; AM conceived and designed the algorithm; XY implemented V-Phaser 2; XY, PC, AM, MRH &amp; MCZ analyzed data; XY &amp; MCZ wrote the manuscript with input from all authors; All authors read and approved the final manuscript.</p>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>We are grateful to Bruce Birren for his support of this project and Gregory Ebel for providing us the mixed viral population samples, and also thank Kristian Andersen, Ryan Poplin, and Ruchi Newman for helpful discussions about this manuscript. This project has been funded in whole or in part with Federal funds from the National Institute of Allergy and Infectious Diseases, National Institutes of Health, Department of Health and Human Services, under Contract No.:HHSN272200900018C.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lin</surname>
          <given-names>SR</given-names>
        </name>
        <name>
          <surname>Hsieh</surname>
          <given-names>SC</given-names>
        </name>
        <name>
          <surname>Yueh</surname>
          <given-names>YY</given-names>
        </name>
        <name>
          <surname>Lin</surname>
          <given-names>TH</given-names>
        </name>
        <name>
          <surname>Chao</surname>
          <given-names>DY</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>WJ</given-names>
        </name>
        <name>
          <surname>King</surname>
          <given-names>CC</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>WK</given-names>
        </name>
        <article-title>Study of sequence variation of dengue type 3 virus in naturally infected mosquitoes and human hosts: implications for transmission and evolution</article-title>
        <source>J Virol</source>
        <year>2004</year>
        <volume>14</volume>
        <issue>22</issue>
        <fpage>12717</fpage>
        <lpage>12721</lpage>
        <comment>[http://dx.doi.org/10.1128/JVI.78.22.12717-12721.2004]</comment>
        <pub-id pub-id-type="doi">10.1128/JVI.78.22.12717-12721.2004</pub-id>
        <?supplied-pmid 15507664?>
        <pub-id pub-id-type="pmid">15507664</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bimber</surname>
          <given-names>BN</given-names>
        </name>
        <name>
          <surname>Dudley</surname>
          <given-names>DM</given-names>
        </name>
        <name>
          <surname>Lauck</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Becker</surname>
          <given-names>EA</given-names>
        </name>
        <name>
          <surname>Chin</surname>
          <given-names>EN</given-names>
        </name>
        <name>
          <surname>Lank</surname>
          <given-names>SM</given-names>
        </name>
        <name>
          <surname>Grunenwald</surname>
          <given-names>HL</given-names>
        </name>
        <name>
          <surname>Caruccio</surname>
          <given-names>NC</given-names>
        </name>
        <name>
          <surname>Maffitt</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Wilson</surname>
          <given-names>NA</given-names>
        </name>
        <name>
          <surname>Reed</surname>
          <given-names>JS</given-names>
        </name>
        <name>
          <surname>Sosman</surname>
          <given-names>JM</given-names>
        </name>
        <name>
          <surname>Tarosso</surname>
          <given-names>LF</given-names>
        </name>
        <name>
          <surname>Sanabani</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Kallas</surname>
          <given-names>EG</given-names>
        </name>
        <name>
          <surname>Hughes</surname>
          <given-names>AL</given-names>
        </name>
        <name>
          <surname>O’Connor</surname>
          <given-names>DH</given-names>
        </name>
        <article-title>Whole-genome characterization of human and simian immunodeficiency virus intrahost diversity by ultradeep pyrosequencing</article-title>
        <source>J Virol</source>
        <year>2010</year>
        <volume>14</volume>
        <issue>22</issue>
        <fpage>12087</fpage>
        <lpage>12092</lpage>
        <comment>[http://dx.doi.org/10.1128/JVI.01378-10]</comment>
        <pub-id pub-id-type="doi">10.1128/JVI.01378-10</pub-id>
        <?supplied-pmid 20844037?>
        <pub-id pub-id-type="pmid">20844037</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Murcia</surname>
          <given-names>PR</given-names>
        </name>
        <name>
          <surname>Baillie</surname>
          <given-names>GJ</given-names>
        </name>
        <name>
          <surname>Daly</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Elton</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Jervis</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Mumford</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Newton</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Parrish</surname>
          <given-names>CR</given-names>
        </name>
        <name>
          <surname>Hoelzer</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Dougan</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Parkhill</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Lennard</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Ormond</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Moule</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Whitwham</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>McCauley</surname>
          <given-names>JW</given-names>
        </name>
        <name>
          <surname>McKinley</surname>
          <given-names>TJ</given-names>
        </name>
        <name>
          <surname>Holmes</surname>
          <given-names>EC</given-names>
        </name>
        <name>
          <surname>Grenfell</surname>
          <given-names>BT</given-names>
        </name>
        <name>
          <surname>Wood</surname>
          <given-names>JLN</given-names>
        </name>
        <article-title>Intra- and interhost evolutionary dynamics of equine influenza virus</article-title>
        <source>J Virol</source>
        <year>2010</year>
        <volume>14</volume>
        <issue>14</issue>
        <fpage>6943</fpage>
        <lpage>6954</lpage>
        <comment>[http://dx.doi.org/10.1128/JVI.00112-10]</comment>
        <pub-id pub-id-type="doi">10.1128/JVI.00112-10</pub-id>
        <?supplied-pmid 20444896?>
        <pub-id pub-id-type="pmid">20444896</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Henn</surname>
          <given-names>MR</given-names>
        </name>
        <name>
          <surname>Boutwell</surname>
          <given-names>CL</given-names>
        </name>
        <name>
          <surname>Charlebois</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Lennon</surname>
          <given-names>NJ</given-names>
        </name>
        <name>
          <surname>Power</surname>
          <given-names>KA</given-names>
        </name>
        <name>
          <surname>Macalalad</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Berlin</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Malboeuf</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Ryan</surname>
          <given-names>EM</given-names>
        </name>
        <name>
          <surname>Gnerre</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Zody</surname>
          <given-names>MC</given-names>
        </name>
        <name>
          <surname>Erlich</surname>
          <given-names>RL</given-names>
        </name>
        <name>
          <surname>Green</surname>
          <given-names>LM</given-names>
        </name>
        <name>
          <surname>Berical</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Casali</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Streeck</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Bloom</surname>
          <given-names>AK</given-names>
        </name>
        <name>
          <surname>Dudek</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Tully</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Newman</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Axten</surname>
          <given-names>KL</given-names>
        </name>
        <name>
          <surname>Gladden</surname>
          <given-names>AD</given-names>
        </name>
        <name>
          <surname>Battis</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Kemper</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Zeng</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Shea</surname>
          <given-names>TP</given-names>
        </name>
        <name>
          <surname>Gujja</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Zedlack</surname>
          <given-names>C</given-names>
        </name>
        <etal/>
        <article-title>Whole genome deep sequencing of HIV-1 reveals the impact of early minor variants upon immune recognition during acute infection</article-title>
        <source>PLoS Pathog</source>
        <year>2012</year>
        <volume>14</volume>
        <issue>3</issue>
        <fpage>e1002529</fpage>
        <comment>[http://dx.doi.org/10.1371/journal.ppat.1002529]</comment>
        <pub-id pub-id-type="doi">10.1371/journal.ppat.1002529</pub-id>
        <?supplied-pmid 22412369?>
        <pub-id pub-id-type="pmid">22412369</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lauck</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Alvarado-Mora</surname>
          <given-names>MV</given-names>
        </name>
        <name>
          <surname>Becker</surname>
          <given-names>EA</given-names>
        </name>
        <name>
          <surname>Bhattacharya</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Striker</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Hughes</surname>
          <given-names>AL</given-names>
        </name>
        <name>
          <surname>Carrilho</surname>
          <given-names>FJ</given-names>
        </name>
        <name>
          <surname>O’Connor</surname>
          <given-names>DH</given-names>
        </name>
        <name>
          <surname>Pinho</surname>
          <given-names>JRR</given-names>
        </name>
        <article-title>Analysis of hepatitis C virus intrahost diversity across the coding region by ultradeep pyrosequencing</article-title>
        <source>J Virol</source>
        <year>2012</year>
        <volume>14</volume>
        <issue>7</issue>
        <fpage>3952</fpage>
        <lpage>3960</lpage>
        <comment>[http://dx.doi.org/10.1128/JVI.06627-11]</comment>
        <pub-id pub-id-type="doi">10.1128/JVI.06627-11</pub-id>
        <?supplied-pmid 22278255?>
        <pub-id pub-id-type="pmid">22278255</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zagordi</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Klein</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Daumer</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Beerenwinkel</surname>
          <given-names>N</given-names>
        </name>
        <article-title>Error correction of next-generation sequencing data and reliable estimation of HIV quasispecies</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <volume>14</volume>
        <issue>21</issue>
        <fpage>7400</fpage>
        <lpage>7409</lpage>
        <comment>[http://dx.doi.org/10.1093/nar/gkq655]</comment>
        <pub-id pub-id-type="doi">10.1093/nar/gkq655</pub-id>
        <?supplied-pmid 20671025?>
        <pub-id pub-id-type="pmid">20671025</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Willerth</surname>
          <given-names>SM</given-names>
        </name>
        <name>
          <surname>Pedro</surname>
          <given-names>HA</given-names>
        </name>
        <name>
          <surname>Pachter</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Humeau</surname>
          <given-names>LM</given-names>
        </name>
        <name>
          <surname>Arkin</surname>
          <given-names>AP</given-names>
        </name>
        <name>
          <surname>Schaffer</surname>
          <given-names>DV</given-names>
        </name>
        <article-title>Development of a low bias method for characterizing viral populations using next generation sequencing technology</article-title>
        <source>PloS one</source>
        <year>2010</year>
        <volume>14</volume>
        <issue>10</issue>
        <fpage>e13564</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pone.0013564</pub-id>
        <?supplied-pmid 21042592?>
        <pub-id pub-id-type="pmid">21042592</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Yang</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Charlebois</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Gnerre</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Coole</surname>
          <given-names>MG</given-names>
        </name>
        <name>
          <surname>Lennon</surname>
          <given-names>NJ</given-names>
        </name>
        <name>
          <surname>Levin</surname>
          <given-names>JZ</given-names>
        </name>
        <name>
          <surname>Qu</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Ryan</surname>
          <given-names>EM</given-names>
        </name>
        <name>
          <surname>Zody</surname>
          <given-names>MC</given-names>
        </name>
        <name>
          <surname>Henn</surname>
          <given-names>MR</given-names>
        </name>
        <article-title>De novo assembly of highly diverse viral populations</article-title>
        <source>BMC Genomics</source>
        <year>2012</year>
        <volume>14</volume>
        <fpage>475</fpage>
        <comment>[http://dx.doi.org/10.1186/1471-2164-13-475]</comment>
        <pub-id pub-id-type="doi">10.1186/1471-2164-13-475</pub-id>
        <?supplied-pmid 22974120?>
        <pub-id pub-id-type="pmid">22974120</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zagordi</surname>
          <given-names>O</given-names>
        </name>
        <name>
          <surname>Bhattacharya</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Eriksson</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Beerenwinkel</surname>
          <given-names>N</given-names>
        </name>
        <article-title>ShoRAH: estimating the genetic diversity of a mixed sample from next-generation sequencing data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>14</volume>
        <fpage>119</fpage>
        <comment>[http://dx.doi.org/10.1186/1471-2105-12-119]</comment>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-119</pub-id>
        <?supplied-pmid 21521499?>
        <pub-id pub-id-type="pmid">21521499</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Prosperi</surname>
          <given-names>MCF</given-names>
        </name>
        <name>
          <surname>Salemi</surname>
          <given-names>M</given-names>
        </name>
        <article-title>QuRe: software for viral quasispecies reconstruction from next-generation sequencing data</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>14</volume>
        <fpage>132</fpage>
        <lpage>133</lpage>
        <comment>[http://dx.doi.org/10.1093/bioinformatics/btr627]</comment>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr627</pub-id>
        <?supplied-pmid 22088846?>
        <pub-id pub-id-type="pmid">22088846</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Archer</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Baillie</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Watson</surname>
          <given-names>SJ</given-names>
        </name>
        <name>
          <surname>Kellam</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Rambaut</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Robertson</surname>
          <given-names>DL</given-names>
        </name>
        <article-title>Analysis of high-depth sequence data for studying viral diversity: a comparison of next generation sequencing platforms using Segminator II</article-title>
        <source>BMC Bioinformatics</source>
        <year>2012</year>
        <volume>14</volume>
        <fpage>47</fpage>
        <comment>[http://dx.doi.org/10.1186/1471-2105-13-47]</comment>
        <pub-id pub-id-type="doi">10.1186/1471-2105-13-47</pub-id>
        <?supplied-pmid 22443413?>
        <pub-id pub-id-type="pmid">22443413</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Macalalad</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Zody</surname>
          <given-names>MC</given-names>
        </name>
        <name>
          <surname>Charlebois</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Lennon</surname>
          <given-names>NJ</given-names>
        </name>
        <name>
          <surname>Newman</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Malboeuf</surname>
          <given-names>CM</given-names>
        </name>
        <name>
          <surname>Ryan</surname>
          <given-names>EM</given-names>
        </name>
        <name>
          <surname>Boutwell</surname>
          <given-names>CL</given-names>
        </name>
        <name>
          <surname>Power</surname>
          <given-names>KA</given-names>
        </name>
        <name>
          <surname>Brackney</surname>
          <given-names>DE</given-names>
        </name>
        <name>
          <surname>Pesko</surname>
          <given-names>KN</given-names>
        </name>
        <name>
          <surname>Levin</surname>
          <given-names>JZ</given-names>
        </name>
        <name>
          <surname>Ebel</surname>
          <given-names>GD</given-names>
        </name>
        <name>
          <surname>Allen</surname>
          <given-names>TM</given-names>
        </name>
        <name>
          <surname>Birren</surname>
          <given-names>BW</given-names>
        </name>
        <name>
          <surname>Henn</surname>
          <given-names>MR</given-names>
        </name>
        <article-title>Highly sensitive and specific detection of rare variants in mixed viral populations from massively parallel sequence data</article-title>
        <source>PLoS Comput Biol</source>
        <year>2012</year>
        <volume>14</volume>
        <issue>3</issue>
        <fpage>e1002417</fpage>
        <comment>[http://dx.doi.org/10.1371/journal.pcbi.1002417]</comment>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1002417</pub-id>
        <?supplied-pmid 22438797?>
        <pub-id pub-id-type="pmid">22438797</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Li</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Handsaker</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Wysoker</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fennell</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Ruan</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Homer</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Marth</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Abecasis</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Durbin</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Subgroup</surname>
          <given-names>GPDP</given-names>
        </name>
        <article-title>The sequence alignment/map format and SAMtools</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>14</volume>
        <issue>16</issue>
        <fpage>2078</fpage>
        <lpage>2079</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>
        <?supplied-pmid 19505943?>
        <pub-id pub-id-type="pmid">19505943</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Barnett</surname>
          <given-names>DW</given-names>
        </name>
        <name>
          <surname>Garrison</surname>
          <given-names>EK</given-names>
        </name>
        <name>
          <surname>Quinlan</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Stromberg</surname>
          <given-names>MP</given-names>
        </name>
        <name>
          <surname>Marth</surname>
          <given-names>GT</given-names>
        </name>
        <article-title>BamTools: a C++ API and toolkit for analyzing and managing BAM files</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>14</volume>
        <issue>12</issue>
        <fpage>1691</fpage>
        <lpage>1692</lpage>
        <comment>[http://dx.doi.org/10.1093/bioinformatics/btr174]</comment>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr174</pub-id>
        <?supplied-pmid 21493652?>
        <pub-id pub-id-type="pmid">21493652</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>DePristo</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Banks</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Poplin</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Garimella</surname>
          <given-names>KV</given-names>
        </name>
        <name>
          <surname>Maguire</surname>
          <given-names>JR</given-names>
        </name>
        <name>
          <surname>Hartl</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Philippakis</surname>
          <given-names>AA</given-names>
        </name>
        <name>
          <surname>del Angel</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Rivas</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Hanna</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>McKenna</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fennell</surname>
          <given-names>TJ</given-names>
        </name>
        <name>
          <surname>Kernytsky</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Sivachenko</surname>
          <given-names>AY</given-names>
        </name>
        <name>
          <surname>Cibulskis</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Gabriel</surname>
          <given-names>SB</given-names>
        </name>
        <name>
          <surname>Altshuler</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Daly</surname>
          <given-names>MJ</given-names>
        </name>
        <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>
        <source>Nat Genet</source>
        <year>2011</year>
        <volume>14</volume>
        <issue>5</issue>
        <fpage>491</fpage>
        <lpage>498</lpage>
        <comment>[http://dx.doi.org/10.1038/ng.806]</comment>
        <pub-id pub-id-type="doi">10.1038/ng.806</pub-id>
        <?supplied-pmid 21478889?>
        <pub-id pub-id-type="pmid">21478889</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chen</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Liu</surname>
          <given-names>J</given-names>
        </name>
        <article-title>Statistical applications of the poisson-binomial and conditional Bernoulli distributions</article-title>
        <source>Stat Sin</source>
        <year>1997</year>
        <volume>14</volume>
        <fpage>875</fpage>
        <lpage>892</lpage>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lehmann</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Romano</surname>
          <given-names>JP</given-names>
        </name>
        <article-title>Generalizations of the familywise error rate</article-title>
        <source>Ann Stat</source>
        <year>2005</year>
        <volume>14</volume>
        <issue>3</issue>
        <fpage>1138</fpage>
        <lpage>1154</lpage>
        <pub-id pub-id-type="doi">10.1214/009053605000000084</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Quail</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Smith</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Coupland</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Otto</surname>
          <given-names>TD</given-names>
        </name>
        <name>
          <surname>Harris</surname>
          <given-names>SR</given-names>
        </name>
        <name>
          <surname>Connor</surname>
          <given-names>TR</given-names>
        </name>
        <name>
          <surname>Bertoni</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Swerdlow</surname>
          <given-names>HP</given-names>
        </name>
        <name>
          <surname>Gu</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>A tale of three next generation sequencing platforms: comparison of Ion Torrent, pacific biosciences and Illumina MiSeq sequencers</article-title>
        <source>BMC Genomics</source>
        <year>2012</year>
        <volume>14</volume>
        <fpage>341</fpage>
        <comment>[http://dx.doi.org/10.1186/1471-2164-13-341]</comment>
        <pub-id pub-id-type="doi">10.1186/1471-2164-13-341</pub-id>
        <?supplied-pmid 22827831?>
        <pub-id pub-id-type="pmid">22827831</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Benjamini</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Hochberg</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>J R Stat Soc Series B (Methodological)</source>
        <year>1995</year>
        <volume>14</volume>
        <issue>1</issue>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Beerenwinkel</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Zagordi</surname>
          <given-names>O</given-names>
        </name>
        <article-title>Ultra-deep sequencing for the analysis of viral populations</article-title>
        <source>Curr Opin Virol</source>
        <year>2011</year>
        <volume>14</volume>
        <issue>5</issue>
        <fpage>413</fpage>
        <lpage>418</lpage>
        <comment>[http://dx.doi.org/10.1016/j.coviro.2011.07.008]</comment>
        <pub-id pub-id-type="doi">10.1016/j.coviro.2011.07.008</pub-id>
        <?supplied-pmid 22440844?>
        <pub-id pub-id-type="pmid">22440844</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
