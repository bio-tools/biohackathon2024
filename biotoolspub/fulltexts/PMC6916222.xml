<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6916222</article-id>
    <article-id pub-id-type="publisher-id">3309</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-019-3309-0</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>shinyBN: an online application for interactive Bayesian network inference and visualization</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Jiajin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Ruyang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Dong</surname>
          <given-names>Xuesi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Lijuan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Ying</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>He</surname>
          <given-names>Jieyu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Christiani</surname>
          <given-names>David C.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wei</surname>
          <given-names>Yongyue</given-names>
        </name>
        <address>
          <email>ywei@njmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Chen</surname>
          <given-names>Feng</given-names>
        </name>
        <address>
          <email>fengchen@njmu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9255 8984</institution-id><institution-id institution-id-type="GRID">grid.89957.3a</institution-id><institution>Department of Biostatistics, School of Public Health, State Key Laboratory of Reproductive Medicine, </institution><institution>Nanjing Medical University, </institution></institution-wrap>Nanjing, China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0004 1761 0489</institution-id><institution-id institution-id-type="GRID">grid.263826.b</institution-id><institution>Department of Epidemiology and Biostatistics, School of Public Health, </institution><institution>Southeast University, </institution></institution-wrap>Nanjing, China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">000000041936754X</institution-id><institution-id institution-id-type="GRID">grid.38142.3c</institution-id><institution>Department of Environmental Health, </institution><institution>Harvard School of Public Health, </institution></institution-wrap>Boston, MA USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0000 9255 8984</institution-id><institution-id institution-id-type="GRID">grid.89957.3a</institution-id><institution>Jiangsu Key Lab of Cancer Biomarkers, Prevention and Treatment, Jiangsu Collaborative Innovation Center for Cancer Personalized Medicine, </institution><institution>Nanjing Medical University, </institution></institution-wrap>Nanjing, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>711</elocation-id>
    <history>
      <date date-type="received">
        <day>26</day>
        <month>3</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>5</day>
        <month>12</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">High-throughput technologies have brought tremendous changes to biological domains, and the resulting high-dimensional data has also posed enormous challenges to computational science. A Bayesian network is a probabilistic graphical model represented by a directed acyclic graph, which provides concise semantics to describe the relationship between entities and has an independence assumption that is suitable for sparse omics data. Bayesian networks have been broadly used in biomedical research fields, including disease risk assessment and prognostic prediction. However, the inference and visualization of Bayesian networks are unfriendly to the users lacking programming skills.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed an R/Shiny application, <italic>shinyBN</italic>, which is an online graphical user interface to facilitate the inference and visualization of Bayesian networks. <italic>shinyBN</italic> supports multiple types of input and provides flexible settings for network rendering and inference. For output, users can download network plots, prediction results and external validation results in publication-ready high-resolution figures.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">Our user-friendly application (<italic>shinyBN</italic>) provides users with an easy method for Bayesian network modeling, inference and visualization via mouse clicks. <italic>shinyBN</italic> can be used in the R environment or online and is compatible with three major operating systems, including Windows, Linux and Mac OS. <italic>shinyBN</italic> is deployed at <ext-link ext-link-type="uri" xlink:href="https://jiajin.shinyapps.io/shinyBN/">https://jiajin.shinyapps.io/shinyBN/</ext-link>. Source codes and the manual are freely available at <ext-link ext-link-type="uri" xlink:href="https://www.github.com/JiajinChen/shinyBN">https://github.com/JiajinChen/shinyBN</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Bayesian network</kwd>
      <kwd>Visualization</kwd>
      <kwd>Inference</kwd>
      <kwd>Online tool</kwd>
      <kwd>R package</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Key Research and Development Program of China</institution>
        </funding-source>
        <award-id>2016YFE0204900</award-id>
        <principal-award-recipient>
          <name>
            <surname>Chen</surname>
            <given-names>Feng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>81530088</award-id>
        <award-id>81973142</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wei</surname>
            <given-names>Yongyue</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Feng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CA209414, CA092824, and ES000002</award-id>
        <principal-award-recipient>
          <name>
            <surname>Christiani</surname>
            <given-names>David C.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par11">Bayesian networks have become one of the most commonly used models for the modeling and reasoning of uncertain systems. In the biomedical field, Bayesian networks are successfully applied to assess the risk of disease and explore the relationship between genotypes and phenotypes [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. However, the inference and visualization of Bayesian networks is not user friendly. <italic>SMILE</italic> (Structural Modeling, Inference, and Learning Engine) is a causal discovery engine [<xref ref-type="bibr" rid="CR3">3</xref>] and is easily embedded into the other tools, such as <italic>jSMILE</italic>, a Java implementation of <italic>SMILE</italic>, and <italic>rSMILE</italic>, an R package connecting to <italic>jSMILE</italic> [<xref ref-type="bibr" rid="CR4">4</xref>]. However, since <italic>SMILE</italic> has been shifted from open license to commercial version (product brand: <italic>GeNIe</italic>), <italic>rSMILE</italic> and <italic>jSMILE</italic> are no longer maintained. <italic>BayesianNetwork</italic>, an R/Shiny web widget to construct Bayesian network [<xref ref-type="bibr" rid="CR5">5</xref>], while the connections between nodes are nondirectional, and only one predictor variable can be considered for outcome inference which hinders its application in real-word medical studies. In addition, there are some commercial products for Bayesian network analysis which require complex installation (Table <xref rid="Tab1" ref-type="table">1</xref>). To solve these inconveniences, we developed <italic>shinyBN</italic>, an online tool based on R and Shiny for interactive inference and visualization of Bayesian network, incorporating multiple types of inputs, flexible parameter settings, and multiple combinations of outcomes.
<table-wrap id="Tab1"><label>Table 1</label><caption><p>Existing tools for Bayesian network analysis</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Tool</th><th>Latest version</th><th>Free</th><th>Open source</th><th>Web based</th><th>R API</th><th>Interactive visualization</th><th>Batch inference</th></tr></thead><tbody><tr><td>jSMILE/ rSMILE</td><td>2009<sup>a</sup></td><td>Y</td><td>N</td><td>N</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td>Netica</td><td>2018</td><td>N<sup>b</sup></td><td>N</td><td>N</td><td>N</td><td>Y</td><td>N</td></tr><tr><td>BayesiaLab</td><td>2018</td><td>N</td><td>N</td><td>N</td><td>N</td><td>Y</td><td>Y</td></tr><tr><td>BayesianNetwork</td><td>2018</td><td>Y</td><td>Y</td><td>Y</td><td>Y</td><td>N</td><td>N</td></tr><tr><td>GeNIe/ SMILE</td><td>2019</td><td>N<sup>c</sup></td><td>N</td><td>N</td><td>Y</td><td>Y</td><td>N</td></tr><tr><td>Bayes Server</td><td>2019</td><td>N</td><td>N</td><td>N</td><td>Y</td><td>Y</td><td>Y</td></tr><tr><td>shinyBN</td><td>2019</td><td>Y</td><td>Y</td><td>Y</td><td>Y</td><td>Y</td><td>Y</td></tr></tbody></table><table-wrap-foot><p><sup>a</sup>Stop maintenance</p><p><sup>b</sup>Maximal 15 nodes allowed for free version</p><p><sup>c</sup>Free only for academic community</p></table-wrap-foot></table-wrap></p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Overview of <italic>shinyBN</italic></title>
      <p id="Par12"><italic>shinyBN</italic> was developed with five R packages:
<list list-type="bullet"><list-item><p id="Par13"><italic>bnlearn</italic> for structure learning and parameter training [<xref ref-type="bibr" rid="CR6">6</xref>];</p></list-item><list-item><p id="Par14"><italic>gRain</italic> for network inference [<xref ref-type="bibr" rid="CR7">7</xref>];</p></list-item><list-item><p id="Par15"><italic>visNetwork</italic> for network visualization [<xref ref-type="bibr" rid="CR8">8</xref>];</p></list-item><list-item><p id="Par16"><italic>pROC</italic> for plotting receiver operating characteristic (ROC) curves [<xref ref-type="bibr" rid="CR9">9</xref>];</p></list-item><list-item><p id="Par17"><italic>rmda</italic> for plotting the decision curve analysis (DCA);</p></list-item></list>and was further wrapped by R/Shiny, a framework to build interactive web applications by R [<xref ref-type="bibr" rid="CR10">10</xref>]. By using these packages, <italic>shinyBN</italic> could construct the Bayesian network by the uploaded structural information from Excel file or R object, learning the Bayesian network by individual data, visualize and customize the network illustration, and implement the network for outcome inference. A flow chart of the proposed <italic>shinyBN</italic> is shown in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. <italic>shinyBN</italic> is compatible with three major operating systems and popular browsers (Additional file <xref rid="MOESM2" ref-type="media">2</xref>).
<fig id="Fig1"><label>Fig. 1</label><caption><p>The flow chart of the proposed <italic>shinyBN</italic> application</p></caption><graphic xlink:href="12859_2019_3309_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Network input</title>
      <p id="Par18"><italic>shinyBN</italic> supports three types of input:
<list list-type="bullet"><list-item><p id="Par19">Microsoft Excel file, which has network structural information and properties of the nodes (size, color, shape) and edges (color, width and line type);</p></list-item><list-item><p id="Par20"><italic>bnlearn</italic> output object that embeds Bayesian network (class <italic>bn</italic> or <italic>bn.fit</italic>);</p></list-item><list-item><p id="Par21">csv file with individual data for Bayesian network structure learning and parameter training. The data is an N × M matrix with discrete data, where N is the number of observables and M is the number of the features (nodes).</p></list-item></list></p>
    </sec>
    <sec id="Sec5">
      <title>Network construction</title>
      <p id="Par22">Bayesian network constructions are performed using the methods in the <italic>bnlearn</italic> R package [<xref ref-type="bibr" rid="CR6">6</xref>]. Users can select constraint-based algorithms, score-based algorithms or hybrid algorithms to train the network structure and incorporate structural priors by setting whitelists (included in the graph) and blacklists (excluded from the graph), and the bootstrap approach is supported in <italic>shinyBN</italic> as well [<xref ref-type="bibr" rid="CR11">11</xref>]. Parameter estimation via either maximum likelihood estimation or the Bayesian method is supported in <italic>shinyBN</italic>. The structure information (nodes, edges) of constructed network can be further extracted for visualization using <italic>visNetwork</italic>. The network can be directly transformed to class <italic>grain</italic> that met the requirement of the input for <italic>gRain</italic> package and perform inference.</p>
    </sec>
    <sec id="Sec6">
      <title>Network visualization</title>
      <p id="Par23">Network visualizations are based on the <italic>visNetwork</italic> R package using <italic>vis.js</italic> JavaScript library [<xref ref-type="bibr" rid="CR8">8</xref>]. Once the input is uploaded to the server, a visualization of the network with default settings is automatically rendered. The properties of the nodes and edges can be modified by changing the corresponding settings. Node color can be defined individually, by color palettes that meet scientific journal requirements, or by the dominant colors automatically extracted from the uploaded picture. The widths of the connections can be defined manually or corresponding to the strength of the probabilistic relationships. For a better presentation, graph layouts can be modified by the default layouts or, conveniently, by mouse drag and drop. A high-resolution network graph can be downloaded from <italic>shinyBN</italic>.</p>
    </sec>
    <sec id="Sec7">
      <title>Outcome inference</title>
      <p id="Par24">Inferences are performed using the junction tree algorithm in <italic>gRain</italic> R package [<xref ref-type="bibr" rid="CR7">7</xref>]. It transforms a Bayesian network model into a tree, combines the efficiency of belief propagation and the sum-product method to allow the efficient computation of posterior probabilities.</p>
      <p id="Par25">By selecting the nodes of interest as outcomes, defining the factors (nodes) as predictive variables, setting the values accordingly as evidence, the predicted results will be displayed in a bar plot or a probabilistic table. Marginal and joint prediction results for multiple outcomes can be output. In addition, <italic>shinyBN</italic> supports external validation sets uploaded for batch inference and outputs the inference results, an ROC curve, a DCA curve and other evaluation indices. Publication-ready high-resolution figures can be downloaded from <italic>shinyBN</italic>.</p>
    </sec>
    <sec id="Sec8">
      <title>Timing evaluation</title>
      <p id="Par26">The performance of the application largely depends on the configurations of the computer. In order to improve the performance, the shiny server is upgraded with 8GB of RAM. We evaluated the timing of <italic>shinyBN</italic> by using several publicly accessible networks with different number of nodes (Table <xref rid="Tab2" ref-type="table">2</xref>).
<table-wrap id="Tab2"><label>Table 2</label><caption><p>Timing evaluation of <italic>shinyBN</italic></p></caption><table frame="hsides" rules="groups"><thead><tr><th>Network</th><th>Number of nodes</th><th>Number of edges</th><th>Time for visualization</th><th>Time for single inference</th></tr></thead><tbody><tr><td>Cancer</td><td>5</td><td>4</td><td>1 s</td><td>2 s</td></tr><tr><td>Child</td><td>20</td><td>25</td><td>1 s</td><td>2 s</td></tr><tr><td>Hailfinder</td><td>56</td><td>66</td><td>1 s</td><td>2 s</td></tr><tr><td>Pathfinder</td><td>109</td><td>195</td><td>1 s</td><td>2 s</td></tr><tr><td>Diabetes</td><td>413</td><td>602</td><td>2 s</td><td>7 s</td></tr><tr><td>Munin (full network)</td><td>1041</td><td>1397</td><td>2 s</td><td>12 s</td></tr></tbody></table></table-wrap></p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results</title>
    <sec id="Sec10">
      <title>Real data application</title>
      <p id="Par27">Stroke is a severe complication of sickle cell anemia (SCA) that can cause permanent brain damage and even death. By integrating 108 SNPs from 39 candidate genes and clinical characteristics from 1398 individuals with SCA, Sebastiani et al. constructed a Bayesian network to predict the risk of stroke, which achieved an excellent accuracy of 98.2% [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
      <p id="Par28">First, the network model was replicated using the information from the original study and uploaded to <italic>shinyBN</italic>. Size and color of nodes and width of edges could be modified for a better presentation. In the example, the color of the nodes for the clinical characteristics was set to pink, and the color of the Markov blanket for stroke, which directly associated with stroke, was set to yellow. The layout of network was manually adjusted by the mouse drag and drop (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). By setting the evidence for some candidate gene loci, the predicted probabilities for stroke are displayed in a table and a bar plot (Additional file <xref rid="MOESM3" ref-type="media">3</xref>). The network can be downloaded as an HTML file for high-resolution figures or in as an Excel file for network structures. Furthermore, we simulated random data from the stroke Bayesian network with a missing rate of 40% for each variable and then uploaded it to the server as a pseudo external validation set. The ROC plot (Additional file <xref rid="MOESM4" ref-type="media">4</xref>) and the DCA plot (Additional file <xref rid="MOESM5" ref-type="media">5</xref>) were displayed, and the batch inference results were download as a comma-separated values file.
<fig id="Fig2"><label>Fig. 2</label><caption><p>The stroke network rendered by <italic>shinyBN</italic></p></caption><graphic xlink:href="12859_2019_3309_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec11">
    <title>Conclusions</title>
    <p id="Par29">In conclusion, we developed an online application, <italic>shinyBN</italic>, to construct and illustrate a Bayesian network with high scalability. <italic>shinyBN</italic> supports multiple types of input and provides flexible settings for network rendering and inference. A real data application confirms that the Bayesian network can be used for omics data modeling. By integrating several packages, <italic>shinyBN</italic> is a practical pipeline for Bayesian network modeling, inference and visualization.</p>
  </sec>
  <sec id="Sec12">
    <title>Availability and requirements</title>
    <p id="Par30"><bold>Project name:</bold> shinyBN.</p>
    <p id="Par31">
      <bold>Project home page:</bold>
      <ext-link ext-link-type="uri" xlink:href="https://github.com/JiajinChen/shinyBN">https://github.com/JiajinChen/shinyBN</ext-link>
    </p>
    <p id="Par32">
      <bold>Operating system(s):</bold>
    </p>
    <p id="Par33">For R users, any platform for which the R software is implemented;</p>
    <p id="Par34">For online users, any platform with compatible browser.</p>
    <p id="Par35"><bold>Programming language:</bold> R</p>
    <p id="Par36"><bold>Other requirements:</bold> Shiny</p>
    <p id="Par37"><bold>License:</bold> Apache License 2.0</p>
    <p id="Par38"><bold>Any restrictions to use by non-academics:</bold> None</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec13">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2019_3309_MOESM1_ESM.zip">
            <caption>
              <p><bold>Additional file 1. </bold>A zip archive containing the source codes and manual of <italic>shinyBN</italic>.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2019_3309_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2. </bold>The compatibility of the proposed <italic>shinyBN</italic> application. We tested the compatibility of <italic>shinyBN</italic> across three major operating systems and popular browsers.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2019_3309_MOESM3_ESM.pdf">
            <caption>
              <p><bold>Additional file 3. </bold>The inference result generated by <italic>shinyBN</italic>. (A) The settings of the evidence for some candidate gene loci; (B) The predicted probability of stroke displayed in a probabilistic table; (C) The predicted probability of stroke displayed in a bar plot.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12859_2019_3309_MOESM4_ESM.pdf">
            <caption>
              <p><bold>Additional file 4.</bold> The ROC plot for the simulated validation set. This file contains the receiver operating characteristic curve for the simulated validation set of the stroke network.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12859_2019_3309_MOESM5_ESM.pdf">
            <caption>
              <p><bold>Additional file 5.</bold> The DCA plot for the simulated validation set. This file contains the decision curve for the simulated validation set of the stroke network.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="12859_2019_3309_MOESM6_ESM.r">
            <caption>
              <p><bold>Additional file 6.</bold> An R script containing all the code to construct the stroke network using conditional probability tables provided in [<xref ref-type="bibr" rid="CR1">1</xref>].</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="12859_2019_3309_MOESM7_ESM.zip">
            <caption>
              <p><bold>Additional file 7. </bold>A zip archive containing the testing files of <italic>shinyBN</italic>.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>API</term>
        <def>
          <p id="Par4">Application programming interface</p>
        </def>
      </def-item>
      <def-item>
        <term>DCA</term>
        <def>
          <p id="Par5">Decision curve analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>HTML</term>
        <def>
          <p id="Par6">HyperText Markup Language</p>
        </def>
      </def-item>
      <def-item>
        <term>ROC</term>
        <def>
          <p id="Par7">Receiver operating characteristic</p>
        </def>
      </def-item>
      <def-item>
        <term>SCA</term>
        <def>
          <p id="Par8">Sickle cell anemia</p>
        </def>
      </def-item>
      <def-item>
        <term>SMILE</term>
        <def>
          <p id="Par9">Structural modeling, inference, and learning engine</p>
        </def>
      </def-item>
      <def-item>
        <term>SNP</term>
        <def>
          <p id="Par10">Single nucleotide polymorphism</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-019-3309-0.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank the contributors of the cited R packages.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>JC wrote the codes and the manuscript. YW and FC conceived the idea and designed the software. DCC revised the manuscript critically. RZ, XD and LL optimized the code. YZ and JH extensively tested the application. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work has been supported by the National Key Research and Development Program of China (2016YFE0204900 to F.C.), the National Natural Science Foundation of China (81530088 to F.C., 81973142 to Y.W.), the US National Institutes of Health (CA209414, CA092824, and ES000002 to D.C.C.). The funding sponsors had no role in study design, collection, analysis and interpretation of data, or preparation of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The proposed <italic>shinyBN</italic> is deployed at <ext-link ext-link-type="uri" xlink:href="https://jiajin.shinyapps.io/shinyBN/">https://jiajin.shinyapps.io/shinyBN/</ext-link>. Source codes and manual are freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/JiajinChen/shinyBN">https://github.com/JiajinChen/shinyBN</ext-link> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>. The R scripts to construct the stroke network are included as Additional file <xref rid="MOESM6" ref-type="media">6</xref>. The testing files for users are included as Additional file <xref rid="MOESM7" ref-type="media">7</xref>.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par39">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par40">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par41">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sebastiani</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Ramoni</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Baldwin</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Steinberg</surname>
            <given-names>MH</given-names>
          </name>
        </person-group>
        <article-title>Genetic dissection and prognostic modeling of overt stroke in sickle cell anemia</article-title>
        <source>Nat Genet</source>
        <year>2005</year>
        <volume>37</volume>
        <issue>4</issue>
        <fpage>435</fpage>
        <pub-id pub-id-type="doi">10.1038/ng1533</pub-id>
        <pub-id pub-id-type="pmid">15778708</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Krishnan KC, Kurt Z, Barrere-Cain R, Sabir S, Das A, Floyd R, Vergnes L, Zhao Y, Che N, Charugundla S. Integration of multi-omics data from mouse diversity panel highlights mitochondrial dysfunction in non-alcoholic fatty liver disease. Cell Syst. 2018;6(1):103–115.e107.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Druzdzel</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>SMILE: structural modeling, inference, and learning engine and GeNIe: a development environment for graphical decision-theoretic models</article-title>
        <source>Sixteenth National Conference on Artificial Intelligence and Eleventh Conference on Innovative Applications of Artificial Intelligence</source>
        <year>1999</year>
        <fpage>902</fpage>
        <lpage>903</lpage>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Friedrich</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Klinger</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>rSMILE, an interface to the Bayesian Network package GeNIe/SMILE</article-title>
        <source>Book of Abstracts of the R User Conference</source>
        <year>2009</year>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Govan</surname>
            <given-names>PB</given-names>
          </name>
        </person-group>
        <article-title>BayesianNetwork: interactive Bayesian network modeling and analysis</article-title>
        <source>J Open Source Softw</source>
        <year>2018</year>
        <volume>3</volume>
        <fpage>425</fpage>
        <pub-id pub-id-type="doi">10.21105/joss.00425</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Scutari</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Learning Bayesian networks with the bnlearn R package</article-title>
        <source>J Stat Softw</source>
        <year>2010</year>
        <volume>35</volume>
        <issue>03</issue>
        <fpage>2010</fpage>
        <pub-id pub-id-type="doi">10.18637/jss.v035.i03</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Højsgaard</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Graphical independence networks with the gRain package for R</article-title>
        <source>J Stat Softw</source>
        <year>2012</year>
        <volume>46</volume>
        <issue>10</issue>
        <fpage>1</fpage>
        <lpage>26</lpage>
        <pub-id pub-id-type="pmid">22837731</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Almende B, Thieurmel B, Robert T. visNetwork: network visualization using’vis. js’ Library. R Package Version 2.0.9. 2019; <ext-link ext-link-type="uri" xlink:href="https://www.CRAN.R-project.org/package=visNetwork">https://CRAN.R-project.org/package=visNetwork</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robin</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Turck</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Hainard</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tiberti</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Lisacek</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Sanchez</surname>
            <given-names>J-C</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>pROC: an open-source package for R and S+ to analyze and compare ROC curves</article-title>
        <source>BMC Bioinformatics</source>
        <year>2011</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>77</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-12-77</pub-id>
        <pub-id pub-id-type="pmid">21414208</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <mixed-citation publication-type="other">Chang W, Cheng J, Allaire JJ, Xie Y, Mcpherson J. shiny: web application framework for R. R Package Version 1.4.0. 2019; <ext-link ext-link-type="uri" xlink:href="https://www.CRAN.R-project.org/package=shiny">https://CRAN.R-project.org/package=shiny</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Friedman N, Goldszmidt M, Wyner A. Data analysis with Bayesian networks: a bootstrap approach. In: Proceedings of the Fifteenth Conference on Uncertainty in Artificial Intelligence. San Francisco: Morgan Kaufmann Publishers Inc; 1999. p. 196–205.</mixed-citation>
    </ref>
  </ref-list>
</back>
