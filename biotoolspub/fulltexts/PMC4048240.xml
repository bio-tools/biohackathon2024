<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4048240</article-id>
    <article-id pub-id-type="pmid">24905985</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-13-55012</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0098855</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology and Life Sciences</subject>
        <subj-group>
          <subject>Agriculture</subject>
          <subj-group>
            <subject>Agricultural Biotechnology</subject>
            <subject>Crops</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computational Biology</subject>
        </subj-group>
        <subj-group>
          <subject>Genetics</subject>
          <subj-group>
            <subject>Genomics</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer and Information Sciences</subject>
        <subj-group>
          <subject>Information Technology</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Construction and Analysis of High-Density Linkage Map Using High-Throughput Sequencing Data</article-title>
      <alt-title alt-title-type="running-head">Linkage Mapping Using NGS Data</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Dongyuan</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Ma</surname>
          <given-names>Chouxian</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Hong</surname>
          <given-names>Weiguo</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Huang</surname>
          <given-names>Long</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Min</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Hui</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zeng</surname>
          <given-names>Huaping</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Deng</surname>
          <given-names>Dejing</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xin</surname>
          <given-names>Huaigen</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Song</surname>
          <given-names>Jun</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Chunhua</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sun</surname>
          <given-names>Xiaowen</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hou</surname>
          <given-names>Xilin</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Xiaowu</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zheng</surname>
          <given-names>Hongkun</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Biomarker Technologies Corporation, Beijing, China</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>Heilongjiang River Fisheries Research Institute, Chinese Academy of Fishery Sciences, Harbin, China</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>State Key laboratory of Crop Genetic and Germplasm Enhancement, Key Laboratory of Biology and Germplasm Enhancement of Horticultural Crops in East China, Ministry of Agriculture, Nanjing Agricultural University, Nanjing, China</addr-line>
    </aff>
    <aff id="aff4">
      <label>4</label>
      <addr-line>Institute of Vegetables and Flowers, Chinese Academy of Agricultural Sciences (IVF, CAAS), Beijing, China</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Liu</surname>
          <given-names>Chunyu</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Illinois at Chicago, United States of America</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>wangxw@mail.caas.net.cn (XWW)</email> (XW); <email>zhenghk@biomarker.com.cn (HKZ)</email> (HZ)</corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The twelve authors are current employees of the Biomarker Technologies Corporation in Beijing. However, this study is not related to any products in development at BTC or currently produced by BTC. The authors have maintained strict adherence to all the PLoS ONE policies regarding the sharing of data and materials.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: HKZ DL CM. Performed the experiments: LH HL CM. Analyzed the data: ML HPZ DD HX JS CX. Contributed reagents/materials/analysis tools: XS XH. Wrote the paper: WH HKZ XW.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2014</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>6</month>
      <year>2014</year>
    </pub-date>
    <volume>9</volume>
    <issue>6</issue>
    <elocation-id>e98855</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>1</month>
        <year>2014</year>
      </date>
      <date date-type="accepted">
        <day>8</day>
        <month>5</month>
        <year>2014</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2014 Liu et al</copyright-statement>
      <copyright-year>2014</copyright-year>
      <copyright-holder>Liu et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Linkage maps enable the study of important biological questions. The construction of high-density linkage maps appears more feasible since the advent of next-generation sequencing (NGS), which eases SNP discovery and high-throughput genotyping of large population. However, the marker number explosion and genotyping errors from NGS data challenge the computational efficiency and linkage map quality of linkage study methods. Here we report the HighMap method for constructing high-density linkage maps from NGS data. HighMap employs an iterative ordering and error correction strategy based on a k-nearest neighbor algorithm and a Monte Carlo multipoint maximum likelihood algorithm. Simulation study shows HighMap can create a linkage map with three times as many markers as ordering-only methods while offering more accurate marker orders and stable genetic distances. Using HighMap, we constructed a common carp linkage map with 10,004 markers. The singleton rate was less than one-ninth of that generated by JoinMap4.1. Its total map distance was 5,908 cM, consistent with reports on low-density maps. HighMap is an efficient method for constructing high-density, high-quality linkage maps from high-throughput population NGS data. It will facilitate genome assembling, comparative genomic analysis, and QTL studies. HighMap is available at <ext-link ext-link-type="uri" xlink:href="http://highmap.biomarker.com.cn/">http://highmap.biomarker.com.cn/</ext-link>.</p>
    </abstract>
    <funding-group>
      <funding-statement>This work was supported by a National Program on Key Basic Research Projects [the 973 Program: 2012CB113906 and 2012CB113900]; a National High Technology Research and Development Program of China [the 863 Program, No. 2012AA100101]. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>Linkage maps, especially high-density ones, play an important role in the study of genetics and genomics. Application of high-density linkage maps has greatly facilitated discovery of functional genes <xref rid="pone.0098855-Graham1" ref-type="bibr">[1]</xref>, genome assembly <xref rid="pone.0098855-Mayer1" ref-type="bibr">[2]</xref>–<xref rid="pone.0098855-Howe1" ref-type="bibr">[6]</xref>, and comparative analysis of genome structure <xref rid="pone.0098855-Shifman1" ref-type="bibr">[7]</xref>–<xref rid="pone.0098855-MacLeod1" ref-type="bibr">[9]</xref>. However, most current maps harbor only about hundreds of markers, largely plagued by marker discovery technologies and genotyping costs. The advent of next-generation sequencing (NGS) makes it possible to rapidly discover huge numbers of markers. The genotyping approaches based on NGS, such as SLAF-seq (specific-locus amplified fragment sequencing) <xref rid="pone.0098855-Sun1" ref-type="bibr">[10]</xref>, RAD (restriction site associated DNA) genotyping <xref rid="pone.0098855-Baird1" ref-type="bibr">[11]</xref>, and genotyping-by-sequencing <xref rid="pone.0098855-Elshire1" ref-type="bibr">[12]</xref> are even capable of discovering and genotyping hundreds of thousands of genetic markers throughout the genome at relatively low cost <xref rid="pone.0098855-Davey1" ref-type="bibr">[13]</xref>. These revolutionary advances in genotyping technologies provide exciting opportunities to economically construct increasingly dense maps <xref rid="pone.0098855-Sun1" ref-type="bibr">[10]</xref>, <xref rid="pone.0098855-Andolfatto1" ref-type="bibr">[14]</xref>, <xref rid="pone.0098855-Xie1" ref-type="bibr">[15]</xref>. However, NGS data still inevitably suffer from genotyping errors <xref rid="pone.0098855-Nielsen1" ref-type="bibr">[16]</xref>–<xref rid="pone.0098855-Bansal1" ref-type="bibr">[18]</xref>, especially when sequencing depths are low <xref rid="pone.0098855-Chen1" ref-type="bibr">[19]</xref>–<xref rid="pone.0098855-Xu1" ref-type="bibr">[21]</xref> and genotypes are highly heterozygous. The inherent features of NGS data impose two major challenges on the construction of high-density linkage map: First, genotyping errors affect the map quality <xref rid="pone.0098855-vanOs1" ref-type="bibr">[22]</xref>. Second, the marker density explosion leads to the exponential increase in computational intensity <xref rid="pone.0098855-vanOs1" ref-type="bibr">[22]</xref>.</p>
    <p>Great efforts have been made to study algorithms for constructing high-density and high-quality linkage map <xref rid="pone.0098855-vanOs1" ref-type="bibr">[22]</xref>–<xref rid="pone.0098855-VanOs1" ref-type="bibr">[24]</xref>. RECORD has been developed to produce accurate marker orders in a relatively short time by employing the total number of observable recombination events between adjacent markers as a target function <xref rid="pone.0098855-VanOs1" ref-type="bibr">[24]</xref>. SMOOTH has been reported to eliminate genotyping errors from genetic linkage data during the mapping process and improve map quality <xref rid="pone.0098855-vanOs1" ref-type="bibr">[22]</xref>. However, neither RECORD nor SMOOTH is capable of handling populations with high heterozygous loci. OneMap <xref rid="pone.0098855-Margarido1" ref-type="bibr">[25]</xref> and FsLinkageMap <xref rid="pone.0098855-Tong1" ref-type="bibr">[26]</xref> have been developed to construct linkage maps of high heterozygous species. However, OneMap is computationally intensive and FsLinkageMap is incapable of constructing high-density linkage map. JoinMap4.1 employs a Monte Carlo multipoint maximum likelihood algorithm and greatly expedites computational speed in marker ordering <xref rid="pone.0098855-JW1" ref-type="bibr">[27]</xref>; nonetheless, it still suffers from the limit of the marker number in linkage grouping <xref rid="pone.0098855-Amores1" ref-type="bibr">[28]</xref>, and serious expansion of map distance. The problems caused by genotyping errors and density explosion still remain great challenges for constructing high-density linkage map efficiently and accurately.</p>
    <p>Several practical strategies have been used to tackle the difficulties in constructing high-density linkage map in species such as sunflower <xref rid="pone.0098855-Bowers1" ref-type="bibr">[29]</xref>, mouse <xref rid="pone.0098855-Shifman1" ref-type="bibr">[7]</xref>, porcine <xref rid="pone.0098855-Munoz1" ref-type="bibr">[30]</xref>, Brassica napus <xref rid="pone.0098855-Sun2" ref-type="bibr">[31]</xref>, maize <xref rid="pone.0098855-Ganal1" ref-type="bibr">[32]</xref>, spotted gar <xref rid="pone.0098855-Amores1" ref-type="bibr">[28]</xref> and potato <xref rid="pone.0098855-vanOs2" ref-type="bibr">[33]</xref>. Sunflower linkage map integrated four individual linkage maps <xref rid="pone.0098855-Bowers1" ref-type="bibr">[29]</xref> to improve marker densities. The integration strategy is laborious and quality suspicious. The linkage map of mouse and pig were constructed by directly using the physical order of marker in the genomes to circumvent the intensive computation of marker ordering <xref rid="pone.0098855-Shifman1" ref-type="bibr">[7]</xref>, <xref rid="pone.0098855-Munoz1" ref-type="bibr">[30]</xref>. This strategy only works for the construction of species which have genome reference sequence. A bin strategy has been used to construct the linkage map of potato <xref rid="pone.0098855-vanOs2" ref-type="bibr">[33]</xref>, Brassica napus, maize <xref rid="pone.0098855-Ganal1" ref-type="bibr">[32]</xref> and spotted gar <xref rid="pone.0098855-Amores1" ref-type="bibr">[28]</xref>. A “bin” is a group of markers with a unique segregation pattern and is separated from adjacent bins by a single recombination event. The bin strategy reduces computational costs as well as impacts of genotyping errors, but at the cost of incomplete utilization of genotyping data and recombination information, reducing the application value of high-density linkage map. All the above linkage maps enabled the biology studies in these species, but the methods of map construction still suffered from computational time, map quality and the utilization of genotyping data.</p>
    <p>Here, by using an iterative ordering and error correction strategy, we present an efficient method that simplifies and enhances the construction of high-density, high-quality linkage map from high-throughput population NGS data (HighMap). Our studies reveal that HighMap has excellent performance of high-density linkage map construction. HighMap provides an important tool for understanding genetics and genomics.</p>
  </sec>
  <sec sec-type="material|methods" id="s2">
    <title>Material and Methods</title>
    <p>All experimental procedures were conducted in conformity with institutional guidelines for the care and use of laboratory animals in Centre for Applied Aquatic Genomics of the Chinese Academy of Fishery Sciences. The protocol was approved by the Committee on the Ethics of Animal Experiments of the Centre for Applied Aquatic Genomics at Chinese Academy of Fishery Sciences (2011AA1004020012).</p>
    <sec id="s2a">
      <title>HighMap overview</title>
      <p>Here we report a new strategy, the iterative ordering and error correction, to construct high-density genetic maps. We referred to the error correction strategy of SMOOTH <xref rid="pone.0098855-vanOs1" ref-type="bibr">[22]</xref>, and used a <italic>k</italic>-nearest neighbor algorithm to correct genotyping errors and impute genotyping missing <xref rid="pone.0098855-Huang1" ref-type="bibr">[34]</xref>. We employed the enhanced algorithm of Gibbs sampling, spatial sampling and simulated annealing (GSS) <xref rid="pone.0098855-JW1" ref-type="bibr">[27]</xref>, <xref rid="pone.0098855-Jansen1" ref-type="bibr">[35]</xref> to order markers. GSS marker ordering algorithm is computationally efficient <xref rid="pone.0098855-JW1" ref-type="bibr">[27]</xref>, but it generates inflated map distances, and has unstable map quality, especially for the data high in genotyping errors. To ensure stability of map quality, we enhanced GSS by using the summation of adjacent recombination fractions (<italic>SARF</italic>) as objective function and adopted Blocked Gibbs sampler after trying different Gibbs sampling methods and different objective functions in simulated annealing. HighMap consists of four modules, designed for linkage grouping, marker ordering, error genotyping correction and map evaluation, respectively (<xref ref-type="fig" rid="pone-0098855-g001">Figure 1</xref>). The map evaluation module provides heat mapsand haplotype maps for intuitive displays of map quality <xref rid="pone.0098855-West1" ref-type="bibr">[36]</xref>.</p>
      <fig id="pone-0098855-g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0098855.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Modules of HighMap algorithm.</title>
          <p>A: The single-linkage clustering algorithm was used to partition the marker loci into linkage groups based on a pairwise modified independence LOD score for the recombination frequency. B and B': The ordering module combines Gibbs sampling, spatial sampling, and simulated annealing algorithm to order markers and estimate map distances. C: The error correction module identified singletons according to parental contribution of genotypes and eliminated them from the data using <italic>k</italic>-nearest neighbor algorithm. To order markers correctly, the processes of ordering and error correction were carried out iteratively. D: Heat maps and haplotype maps were constructed to evaluate map quality.</p>
        </caption>
        <graphic xlink:href="pone.0098855.g001"/>
      </fig>
    </sec>
    <sec id="s2b">
      <title>Linkage grouping</title>
      <p>The grouping module uses the single-linkage clustering algorithm to cluster the markers into linkage groups, using a pair-wise modified independence LOD score as distance metric. Assuming a loci pair with segregation type, <inline-formula><inline-graphic xlink:href="pone.0098855.e001.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0098855.e002.jpg"/></inline-formula>, a contingency table of genotypes is produced:<disp-formula id="pone.0098855.e003"><graphic xlink:href="pone.0098855.e003.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
      <p>Here <inline-formula><inline-graphic xlink:href="pone.0098855.e004.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0098855.e005.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0098855.e006.jpg"/></inline-formula>, and O represent row-total, column-total, grand-total, and observed number of each genotype, respectively. The expected number <inline-formula><inline-graphic xlink:href="pone.0098855.e007.jpg"/></inline-formula> in each cell in above contingency table is calculated by <inline-formula><inline-graphic xlink:href="pone.0098855.e008.jpg"/></inline-formula>. The independence test <inline-formula><inline-graphic xlink:href="pone.0098855.e009.jpg"/></inline-formula> statistic, with degrees of freedom <inline-formula><inline-graphic xlink:href="pone.0098855.e010.jpg"/></inline-formula> being equal to the number of rows minus 1 multiplied by the number of columns minus 1, is given by <inline-formula><inline-graphic xlink:href="pone.0098855.e011.jpg"/></inline-formula>. The modified LOD score is obtained from an approximate transformation:<disp-formula id="pone.0098855.e012"><graphic xlink:href="pone.0098855.e012.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
      <p>With increasing LOD thresholds, different group nodes form, and these can be represented as a dendrogram, which branches might be huge and deep. Since the algorithm exhaustively searches all possible solutions that the linkage groups number is equal to the chromosome number, it is computationally extensive, especially for marker data of low depth. To speed up the calculation, we simplified the tree structure by adopting two new strategies: deleting small “group fragments”, and merging small descendant nodes into large ancestral nodes.</p>
    </sec>
    <sec id="s2c">
      <title>Marker ordering and genotyping error correction</title>
      <p>The mapping algorithm applies an iterative process of marker ordering and error genotype correction to ensure the accuracy of map order and map distances in the presence of missing observations and genotyping errors (<xref ref-type="fig" rid="pone-0098855-g001">Figure 1</xref>). Prior to iterative mapping, recombinant frequencies and LOD scores were calculated by two-point analysis. Based on recombinant fractions and LOD values, linkage phases were inferred by using the anchoring algorithm <xref rid="pone.0098855-Wu1" ref-type="bibr">[37]</xref>.</p>
      <p>Consider a linkage group consisting of <inline-formula><inline-graphic xlink:href="pone.0098855.e013.jpg"/></inline-formula> markers, denoted as <inline-formula><inline-graphic xlink:href="pone.0098855.e014.jpg"/></inline-formula>. The recombination frequency matrix is as follows: <inline-formula><inline-graphic xlink:href="pone.0098855.e015.jpg"/></inline-formula>. The marker ordering module introduces a combination of statistic techniques, spatial sampling, Gibbs sampling and simulated annealing, to obtain the map order with the summation of recombination frequencies and estimate their mutual genetic distances <xref rid="pone.0098855-JW1" ref-type="bibr">[27]</xref>, <xref rid="pone.0098855-Jansen1" ref-type="bibr">[35]</xref>.</p>
      <p>In the first stage of the ordering procedure, markers are selected using spatial sampling as following. One marker is taken at random (marker <inline-formula><inline-graphic xlink:href="pone.0098855.e016.jpg"/></inline-formula>) in a priority order of full cross, <inline-formula><inline-graphic xlink:href="pone.0098855.e017.jpg"/></inline-formula> cross and test cross. Markers with a recombination frequency smaller than a given sampling radius <inline-formula><inline-graphic xlink:href="pone.0098855.e018.jpg"/></inline-formula> are excluded from the marker set. From the remaining markers, one marker in the abovementioned priority order is selected again (marker <inline-formula><inline-graphic xlink:href="pone.0098855.e019.jpg"/></inline-formula>). All markers with recombination frequencies smaller than the given value <inline-formula><inline-graphic xlink:href="pone.0098855.e020.jpg"/></inline-formula> with <inline-formula><inline-graphic xlink:href="pone.0098855.e021.jpg"/></inline-formula> are deleted from the remaining marker set. The sampling process is continued until no markers are left. Finally, a subset of markers <inline-formula><inline-graphic xlink:href="pone.0098855.e022.jpg"/></inline-formula> is obtained. In this marker set, all pair-wise recombination frequencies <inline-formula><inline-graphic xlink:href="pone.0098855.e023.jpg"/></inline-formula> are greater than the given value <inline-formula><inline-graphic xlink:href="pone.0098855.e024.jpg"/></inline-formula>.</p>
      <p>Subsequently, simulated annealing is employed to find the best map order. We adopted <italic>SARF</italic> as an objective function for it could enormously reduce the computations yet show a lower rate of convergence than the maximum likelihood. Calculation of <italic>SARF</italic> for a given sequence of the above sampled loci is performed by summation of <italic>SARF</italic> in two parent maps, i.e.,<disp-formula id="pone.0098855.e025"><graphic xlink:href="pone.0098855.e025.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
      <p>Where <inline-formula><inline-graphic xlink:href="pone.0098855.e026.jpg"/></inline-formula> is the <inline-formula><inline-graphic xlink:href="pone.0098855.e027.jpg"/></inline-formula> th element of the paternal maps, <inline-formula><inline-graphic xlink:href="pone.0098855.e028.jpg"/></inline-formula> is the <inline-formula><inline-graphic xlink:href="pone.0098855.e029.jpg"/></inline-formula> th element of the parental maps, and <inline-formula><inline-graphic xlink:href="pone.0098855.e030.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0098855.e031.jpg"/></inline-formula> are the number of markers in <inline-formula><inline-graphic xlink:href="pone.0098855.e032.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0098855.e033.jpg"/></inline-formula> maps respectively. Markers with full cross and <inline-formula><inline-graphic xlink:href="pone.0098855.e034.jpg"/></inline-formula> cross segregation pattern occur in both maps, whereas markers with test cross can be observed for that parent only. simulated annealing starts from an initial map order from which the sampled markers are permutated randomly. A new neighbor order is obtained by placing a random locus into a random position, and will be accepted if <disp-formula id="pone.0098855.e035"><graphic xlink:href="pone.0098855.e035.jpg" position="anchor" orientation="portrait"/></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0098855.e036.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0098855.e037.jpg"/></inline-formula> is the acceptance control parameter(<inline-formula><inline-graphic xlink:href="pone.0098855.e038.jpg"/></inline-formula>) and <inline-formula><inline-graphic xlink:href="pone.0098855.e039.jpg"/></inline-formula> is a random value in the range <inline-formula><inline-graphic xlink:href="pone.0098855.e040.jpg"/></inline-formula>. The annealing scheme of <inline-formula><inline-graphic xlink:href="pone.0098855.e041.jpg"/></inline-formula> is the same as that illustrated by Jansen and colleagues<xref rid="pone.0098855-Jansen1" ref-type="bibr">[35]</xref>. The annealing system stops if, in a number of successive steps, the newly generated map order is rejected. Once the optimal map order of the sample markers is obtained, the new order can be used to estimate multipoint recombination frequencies of both parents using Blocked Gibbs sampling, for basic Gibbs sampler often did not work when high-density maps were constructed using small populations or data rich in erroneous markers. The updated recombination frequencies help to integrate the two parental maps, determine the order of test cross markers and optimize the map order in the next cycle of simulated annealing. After three to four cycles, an optimal map of sampled markers is obtained. In the next map-building round, the sampling radius decreases, and a subset of currently unmapped markers is selected and added to the previous sample. The mapping algorithm repeats the previously described stages for the new sample. Then the entire system stops when all markers are in place.</p>
      <p>In high-density genetic maps, a genotyping error usually manifests itself as a singleton. A singleton is a single locus in one offspring which is different in parental origin from both its directly neighboring loci <xref rid="pone.0098855-vanOs1" ref-type="bibr">[22]</xref>. Singletons are mainly caused by erroneous genotypes, but they may also result from other biological phenomena, such as double recombination events, gene conversions, mutations <xref rid="pone.0098855-vanOs1" ref-type="bibr">[22]</xref>. In the third module, missing genotypes were identified according to parental contribution of genotypes. Identified singletons were eliminated from data and identified missing genotypes were imputed using <inline-formula><inline-graphic xlink:href="pone.0098855.e042.jpg"/></inline-formula>-nearest neighbor algorithm <xref rid="pone.0098855-vanOs1" ref-type="bibr">[22]</xref>. Here <inline-formula><inline-graphic xlink:href="pone.0098855.e043.jpg"/></inline-formula> is a parameter that can be specified as appropriate. The number of singletons in each marker reflects marker quality. Markers with singleton ratios exceeding a given threshold are labeled as “suspicious markers”. To avoid that correct markers are deleted by mistake, “suspicious markers” were neither corrected nor imputed. In practice, three to four rounds of ordering and error correction are required to produce a reasonably accurate map order and map distance.</p>
    </sec>
    <sec id="s2d">
      <title>Simulation study</title>
      <p>Simulation data sets were randomly generated based on a full-sib family of an outbreeding species using a Perl script. First, markers were randomly placed along a single paternal or maternal chromosome at random intervals. Then, offspring's genotypes were generated using the simulation data of maternal and paternal chromosomes. Assuming that no crossover interferences occurred, the number of crossover events solely depended on the distance as specified by the simulated positions of the loci on the parent chromosomes. Missing and erroneous data were independently and randomly distributed along chromosomes.</p>
    </sec>
    <sec id="s2e">
      <title>Experimental data</title>
      <p>HighMap performance was further confirmed using the sequencing data of a real full-sib family of common carp which consisted of 211 offsprings <xref rid="pone.0098855-Sun1" ref-type="bibr">[10]</xref> (The sequencing data is available at <ext-link ext-link-type="uri" xlink:href="http://highmap.biomarker.com.cn/">http://highmap.biomarker.com.cn/</ext-link>). JoinMap4.1 was incapable of grouping large data of markers. To compare ordering performance of HighMap with that of JoinMap4.1, we used HighMap rather than JoinMap4.1 to cluster the marker data when we constructed the linkage map using JoinMap4.1.</p>
    </sec>
  </sec>
  <sec id="s3">
    <title>Results</title>
    <sec id="s3a">
      <title>Enhancing utilization of NGS data</title>
      <p>Depth and quality of sequencing reads fluctuate randomly across genomes due to sampling randomness. To ensure genotype quality, reads with low depth of sequencing should be discarded in the process of genotype calling <xref rid="pone.0098855-Sun1" ref-type="bibr">[10]</xref>. If linkage map software can bear more genotype missing and error, it will be possible to make use of more sequencing data and to create higher-density linkage maps at lower costs. Therefore, an important consideration in this study is NGS data utilization, which reflects the performance of a linkage study method in NGS era. To assess data utilization of HighMap, simulation data were generated from a full-sib family consisting of 200 offsprings. To simulate real NGS data accurately, missing observations and genotyping errors were introduced incrementally and simultaneously as the marker number increased from 100 to 1,000 (<xref ref-type="supplementary-material" rid="pone.0098855.s001">Figure S1</xref>). The data set was produced by iteratively appending 100 markers, each time with an increment of 5% missing observation and 5% erroneous genotyping.</p>
      <p>Comparative analysis revealed that HighMap permitted the utilization of more markers than JoinMap4.1 (<xref ref-type="fig" rid="pone-0098855-g002">Figure 2A, 2B and 2C</xref>). HighMap could make use of 700 markers and create linkage maps with a Spearman rank order correlation coefficient greater than 0.9. In contrast, 300 markers led to the correlation coefficient smaller than 0.8 when the linkage map was constructed using JoinMap4.1. Based on a cutoff value of 0.8 <xref rid="pone.0098855-VanOs1" ref-type="bibr">[24]</xref>, we estimated that HighMap could construct a linkage map with three times the number of markers as JoinMap4.1 could.</p>
      <fig id="pone-0098855-g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0098855.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>NGS data utilization enhancement by HighMap.</title>
          <p>The X-axis represents marker numbers. The Y-axis represents Spearman rank correlation coefficient between estimated map marker order and true marker location for A, B and C, singleton rates for D, E and F, estimated genetic map distances for G, H and I, respectively.</p>
        </caption>
        <graphic xlink:href="pone.0098855.g002"/>
      </fig>
      <p>HighMap contains an error correction algorithm, which can impute missing observations and eliminate erroneous genotyping from mapping data in the mapping process. Data showed that the algorithm is efficient. Take the dataset of 700 markers as an example. We introduced 10.25% of erroneous data and 12.86% of missing observations (<xref ref-type="table" rid="pone-0098855-t001">Table 1</xref>). After error correction treatment, final erroneous and missing rate reduced to 5.40% and 0.65%, respectively. 94.88% of genotyping errors were accurately corrected, and 89.13% of missing observations were accurately imputed. The performance of HighMap in genotyping error correction and missing observation imputation accounts for its high data utilization.</p>
      <table-wrap id="pone-0098855-t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0098855.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>Capability of missing imputation and error correction of HighMap.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0098855-t001-1" xlink:href="pone.0098855.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1"># of marker</td>
                <td colspan="4" align="left" rowspan="1">genotyping error</td>
                <td colspan="4" align="left" rowspan="1">genotyping missing</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">initial rate (%)</td>
                <td align="left" rowspan="1" colspan="1">% of detected</td>
                <td align="left" rowspan="1" colspan="1">accurate rate (%)</td>
                <td align="left" rowspan="1" colspan="1">remain rate (%)</td>
                <td align="left" rowspan="1" colspan="1">initial rate (%)</td>
                <td align="left" rowspan="1" colspan="1">% of detected</td>
                <td align="left" rowspan="1" colspan="1">accurate rate (%)</td>
                <td align="left" rowspan="1" colspan="1">remain rate (%)</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">100</td>
                <td align="left" rowspan="1" colspan="1">0.00</td>
                <td align="left" rowspan="1" colspan="1">0.00</td>
                <td align="left" rowspan="1" colspan="1">0.00</td>
                <td align="left" rowspan="1" colspan="1">0.00</td>
                <td align="left" rowspan="1" colspan="1">0.00</td>
                <td align="left" rowspan="1" colspan="1">0.00</td>
                <td align="left" rowspan="1" colspan="1">0.00</td>
                <td align="left" rowspan="1" colspan="1">0.00</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">200</td>
                <td align="left" rowspan="1" colspan="1">2.37</td>
                <td align="left" rowspan="1" colspan="1">75.74</td>
                <td align="left" rowspan="1" colspan="1">97.63</td>
                <td align="left" rowspan="1" colspan="1">0.88</td>
                <td align="left" rowspan="1" colspan="1">2.50</td>
                <td align="left" rowspan="1" colspan="1">85.10</td>
                <td align="left" rowspan="1" colspan="1">99.53</td>
                <td align="left" rowspan="1" colspan="1">0.37</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">300</td>
                <td align="left" rowspan="1" colspan="1">4.61</td>
                <td align="left" rowspan="1" colspan="1">82.88</td>
                <td align="left" rowspan="1" colspan="1">97.65</td>
                <td align="left" rowspan="1" colspan="1">1.53</td>
                <td align="left" rowspan="1" colspan="1">5.00</td>
                <td align="left" rowspan="1" colspan="1">96.33</td>
                <td align="left" rowspan="1" colspan="1">98.34</td>
                <td align="left" rowspan="1" colspan="1">0.18</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">400</td>
                <td align="left" rowspan="1" colspan="1">6.69</td>
                <td align="left" rowspan="1" colspan="1">79.15</td>
                <td align="left" rowspan="1" colspan="1">96.93</td>
                <td align="left" rowspan="1" colspan="1">2.39</td>
                <td align="left" rowspan="1" colspan="1">7.50</td>
                <td align="left" rowspan="1" colspan="1">96.90</td>
                <td align="left" rowspan="1" colspan="1">97.39</td>
                <td align="left" rowspan="1" colspan="1">0.23</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">500</td>
                <td align="left" rowspan="1" colspan="1">6.32</td>
                <td align="left" rowspan="1" colspan="1">81.80</td>
                <td align="left" rowspan="1" colspan="1">97.52</td>
                <td align="left" rowspan="1" colspan="1">1.99</td>
                <td align="left" rowspan="1" colspan="1">7.00</td>
                <td align="left" rowspan="1" colspan="1">97.47</td>
                <td align="left" rowspan="1" colspan="1">97.60</td>
                <td align="left" rowspan="1" colspan="1">0.18</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">600</td>
                <td align="left" rowspan="1" colspan="1">8.40</td>
                <td align="left" rowspan="1" colspan="1">77.98</td>
                <td align="left" rowspan="1" colspan="1">97.14</td>
                <td align="left" rowspan="1" colspan="1">3.16</td>
                <td align="left" rowspan="1" colspan="1">10.00</td>
                <td align="left" rowspan="1" colspan="1">97.42</td>
                <td align="left" rowspan="1" colspan="1">94.82</td>
                <td align="left" rowspan="1" colspan="1">0.26</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">700</td>
                <td align="left" rowspan="1" colspan="1">10.25</td>
                <td align="left" rowspan="1" colspan="1">69.42</td>
                <td align="left" rowspan="1" colspan="1">94.88</td>
                <td align="left" rowspan="1" colspan="1">5.40</td>
                <td align="left" rowspan="1" colspan="1">12.86</td>
                <td align="left" rowspan="1" colspan="1">94.96</td>
                <td align="left" rowspan="1" colspan="1">89.13</td>
                <td align="left" rowspan="1" colspan="1">0.65</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">800</td>
                <td align="left" rowspan="1" colspan="1">11.90</td>
                <td align="left" rowspan="1" colspan="1">65.19</td>
                <td align="left" rowspan="1" colspan="1">93.40</td>
                <td align="left" rowspan="1" colspan="1">6.91</td>
                <td align="left" rowspan="1" colspan="1">15.63</td>
                <td align="left" rowspan="1" colspan="1">93.46</td>
                <td align="left" rowspan="1" colspan="1">85.75</td>
                <td align="left" rowspan="1" colspan="1">1.02</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">900</td>
                <td align="left" rowspan="1" colspan="1">13.20</td>
                <td align="left" rowspan="1" colspan="1">60.10</td>
                <td align="left" rowspan="1" colspan="1">91.07</td>
                <td align="left" rowspan="1" colspan="1">9.16</td>
                <td align="left" rowspan="1" colspan="1">18.33</td>
                <td align="left" rowspan="1" colspan="1">93.27</td>
                <td align="left" rowspan="1" colspan="1">79.73</td>
                <td align="left" rowspan="1" colspan="1">1.23</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">1000</td>
                <td align="left" rowspan="1" colspan="1">14.35</td>
                <td align="left" rowspan="1" colspan="1">56.66</td>
                <td align="left" rowspan="1" colspan="1">89.90</td>
                <td align="left" rowspan="1" colspan="1">10.42</td>
                <td align="left" rowspan="1" colspan="1">21.00</td>
                <td align="left" rowspan="1" colspan="1">91.88</td>
                <td align="left" rowspan="1" colspan="1">76.44</td>
                <td align="left" rowspan="1" colspan="1">1.70</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>A singleton is a single locus in one offspring which is different in parental origin from both its direct neighboring loci <xref rid="pone.0098855-vanOs1" ref-type="bibr">[22]</xref>. It comprehensively reflects linkage map quality and is useful for quality evaluation of linkage maps since true order of marker is unavailable for a linkage map obtained from real data. When linkage maps were constructed using 700 marker data, the singleton rate of HighMap, 0.77%, was much smaller than that generated byJoinMap4.1, which was 8.54% (<xref ref-type="fig" rid="pone-0098855-g002">Figure 2D, 2E and 2F</xref>). This result demonstrates that the correction procedure of HighMap is effective and efficient, which ensures that HighMap with stands high rate of genotyping errors and make more use of marker data.</p>
    </sec>
    <sec id="s3b">
      <title>Marker order accuracy and map distance stability</title>
      <p>To assess the performance of HighMap in marker order accuracy and map distance stability, simulation data set was generated from the full-sib family consisting of 200 offsprings with 200 markers, which contained different missing observations or different genotyping errors. Results showed that the Spearman correlation coefficient between the true and calculated marker order based on HighMap decreased less obviously than that of JoinMap4.1 as the marker error rate increased. The differences of the correlation coefficient between HighMap and JoinMap4.1 were more pronounced when error rate exceeded 20% (<xref ref-type="fig" rid="pone-0098855-g003">Figure 3</xref>). This result demonstrated that HighMap could offer linkage maps of higher quality than JoinMap4.1 when there were a large proportion of erroneous markers. The singleton rate of HighMap grew slowly as error rates increased, whereas the singleton rate ascended linearly with JoinMap4.1. HighMap led to only 3.3% of the singleton rate when the marker data contained 20% error, whereas JoinMap4.1 led to 14.4% of the singleton rate, suggesting that HighMap detected and eliminated most genotyping errors from the data. Both the correlation and singleton analysis revealed that JoinMap4.0 was sensitive not only to erroneous data but also to missing data (<xref ref-type="fig" rid="pone-0098855-g003">Figure 3</xref> and <xref ref-type="supplementary-material" rid="pone.0098855.s002">Figure S2</xref>). It failed to construct linkage map due to its inefficiency in estimating linkage phases when the error rate exceeded about 14% (<xref ref-type="fig" rid="pone-0098855-g003">Figure 3</xref>). Collectively, HighMap remarkedly outperformed both JoinMap4.0 and JoinMap4.1 with respect to marker order accuracy.</p>
      <fig id="pone-0098855-g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0098855.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Changes in linkage map quality as genotyping error increased.</title>
          <p>The X-axis represents genotyping error. The Y-axis represents Spearman rank correlation coefficient between estimated map marker order and true marker location for A, B and C, singleton rates for D, E and F, estimated genetic map distances for G, H and I, respectively.“Integrated”, “Female”, and “Male” indicates integrated, female, or male linkage maps, respectively. JoinMap4.0 failed to construct linkage map due to its inefficiency in estimating linkage phases when the error rate exceeded about 14%.</p>
        </caption>
        <graphic xlink:href="pone.0098855.g003"/>
      </fig>
      <p>Map distance expansion is mainly caused by genotyping errors and the map distance reflects the quality of a linkage map. In the presence of genotyping errors, it may be necessary to make a balance between controlling the expansion of map distance and ensuring validity of the marker order. We gave the priority to address issue of marker order accuracy for it is more important than the map distance<xref rid="pone.0098855-vanOs1" ref-type="bibr">[22]</xref>. While ensuring accurate marker order, HighMap greatly curbs map distance expansion. First, map distances that HighMap offered was robust to increasing density of markers. It led to a genetic distance of 2,030 cM when marker numbers reached 700, whereas JoinMap4.1 led to the genetic distance of 48,056 cM (<xref ref-type="fig" rid="pone-0098855-g002">Figure 2G, 2H and 2I</xref>). In addition, the map distance estimated by HighMap was insensitive to the increase of genotyping errors. It produced only 430 cM of genetic distance when the data with 10% marker errors was used; whereas JoinMap4.1 gave a genetic distance up to 1,925 cM (<xref ref-type="fig" rid="pone-0098855-g003">Figure 3</xref>). These results not only demonstrate that the error correction is an efficient strategy for solving map distance expansion but also account for the reason of better data utilization of HighMap relative to JoinMap.</p>
    </sec>
    <sec id="s3c">
      <title>Computational efficiency of map construction</title>
      <p>Computational efficiency is a concern in linkage mapping. Both grouping and ordering are important in the construction of high-density linkage map. JoinMap still suffers from the limit of marker number in the linkage grouping <xref rid="pone.0098855-Amores1" ref-type="bibr">[28]</xref>, and this might hamper its application in linkage mapping based on NGS data. HighMap allows to handle hundreds of thousands of markers in relatively short time, for it was developed to construct linkage maps based on NGS data under the Linux operation system, and can also run on a server or cluster. We assessed the efficiency of marker ordering, by comparing it with currently available mapping tools including JionMap4.0 and JionMap4.1, both of which used the default parameters. To this end, we simulated a data set based on a full-sib family consisting of 200 offsprings. The data sets contained markers numbering from 50 to 1,000. The simulation data contained neither missing nor erroneous values. Results showed that computational time consumption increased as marker densities went up (<xref ref-type="supplementary-material" rid="pone.0098855.s003">Figure S3</xref>). For JoinMap4.0, the time consumption was prohibitively large for the construction of a linkage map with more than 200 markers. HighMap could create a linkage group with 1,000 markers within a single day. We also evaluated the efficiency of marker ordering of OneMap <xref rid="pone.0098855-Margarido1" ref-type="bibr">[25]</xref> and FsLinkageMap <xref rid="pone.0098855-Tong1" ref-type="bibr">[26]</xref>. FsLinkageMap <xref rid="pone.0098855-Tong1" ref-type="bibr">[26]</xref> couldn't construct a linkage group with 100 makers; OneMap (using Record, rcd,or ug algorithms) <xref rid="pone.0098855-Margarido1" ref-type="bibr">[25]</xref> cost more than one day for creating a linkage group with 200 markers (Data not shown). Therefore, FsLinkageMap and OneMap might not be suitable for constructing high-density linkage maps based on NGS data. All experiments were completed on a computer with a Xeon processor (2.4 GHz and 16 Gb memory).</p>
    </sec>
    <sec id="s3d">
      <title>Application in real population NGS data from common carp</title>
      <p>To test HighMap performances on real data, we generated a high-density linkage map of common carp based on a full-sib family NGS data. The integrated map was comprised of 10,004 markers with an average of 11 fold sequencing depths. Among them, 19% were the data with sequencing depths of less than 5 fold. The segregation patterns for these markers are shown in <xref ref-type="supplementary-material" rid="pone.0098855.s007">Table S1</xref>. Similar to the simulation results, HighMap offered a linkage map of higher quality than JoinMap4.1. Singleton rate of the maps created by HighMap was less than one-ninth of those of the maps constructed by JoinMap4.1 (<xref ref-type="supplementary-material" rid="pone.0098855.s008">Table S2</xref>). Heat maps (<xref ref-type="supplementary-material" rid="pone.0098855.s004">Figure S4</xref>) and haplotype maps (<xref ref-type="supplementary-material" rid="pone.0098855.s005">Figure S5</xref>) verified the quality of the linkage maps that HighMap produced. The linkage maps created by HighMap spanned 5,908 cM in 50 linkage groups, closer to that reported previously <xref rid="pone.0098855-Zhang1" ref-type="bibr">[38]</xref>, smaller than that JoinMap4.1 gave, which was 55,550 cM (<xref ref-type="supplementary-material" rid="pone.0098855.s009">Table S3</xref>). We also analyzed the Spearman correlation coefficient between the marker order of common carp and the genome sequences of zebrafish <xref rid="pone.0098855-Howe1" ref-type="bibr">[6]</xref>, a close relative of the common carp. The data revealed that, for about 70% of linkage groups of common carp, the correlation coefficient based on HighMap was larger than those based on JoinMap4.1 (<xref ref-type="supplementary-material" rid="pone.0098855.s006">Figure S6</xref>), suggesting that HighMap is better than JoinMap4.1with respect to map accuracy.</p>
    </sec>
  </sec>
  <sec id="s4">
    <title>Discussion</title>
    <p>In this study, we intended to develop a method that can efficiently utilize NGS data and ease the construction of high-density and high-quality linkage map. The challenges of such an effort are associated with the marker density explosion and potential genotyping errors, which involve sequencing depth and sequence heterozygosity. The higher the heterozygosity is, the more the genotyping is prone to error. As was shown in the simulation study, the error rate reached up to 34.1% for markers with ab×cd segregation pattern when markers were sequenced at one fold depth, for markers with ef×eg segregation pattern it arrived at 21.3%, and for markers with hk×hk or nn×np or lm×ll segregation pattern, the error rate stood at 17.4% (<xref ref-type="table" rid="pone-0098855-t002">Table 2</xref>). To address the challenges in the construction of linkage map from high-throughput population NGS data, we exploited an iterative ordering and error correction strategy as well as optimized GSS algorithm. Consequently, HighMap was efficient for constructing high-density linkage maps, even using low-depth sequencing data where genotyping errors and missing observations were common. HighMap offers many advantages over JoinMap4.1. First, the marker order and the map distance are relatively accurate for data with large proportion of missing and erroneous markers. Second, It is robust to genotyping errors, allowing for the use of genotyping data with relatively low sequencing depth and therefore makes it possible to construct high-density linkage map at low cost. The above advantages demonstrate that the iterative marker ordering and error correction strategy is effective and efficient. In addition, HighMap provides an intuitive and convenient way to evaluate map quality in forms of heat maps and haplotype maps. It also has the feature of easy use and does not require the specialized skills.</p>
    <table-wrap id="pone-0098855-t002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0098855.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>Genotyping error and missing rates of different segregation patterns in NGS.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0098855-t002-2" xlink:href="pone.0098855.t002"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1">sequencing depths</td>
              <td colspan="2" align="left" rowspan="1">ab×cd</td>
              <td colspan="2" align="left" rowspan="1">ef×eg</td>
              <td colspan="2" align="left" rowspan="1">hk×hk/nn×np/lm×ll</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td align="left" rowspan="1" colspan="1">error rates (%)</td>
              <td align="left" rowspan="1" colspan="1">missing rates (%)</td>
              <td align="left" rowspan="1" colspan="1">error rates (%)</td>
              <td align="left" rowspan="1" colspan="1">missing rates (%)</td>
              <td align="left" rowspan="1" colspan="1">error rates (%)</td>
              <td align="left" rowspan="1" colspan="1">missing rates (%)</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">1</td>
              <td align="left" rowspan="1" colspan="1">34.1</td>
              <td align="left" rowspan="1" colspan="1">43.2</td>
              <td align="left" rowspan="1" colspan="1">24.7</td>
              <td align="left" rowspan="1" colspan="1">58.5</td>
              <td align="left" rowspan="1" colspan="1">17.4</td>
              <td align="left" rowspan="1" colspan="1">44.8</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">2</td>
              <td align="left" rowspan="1" colspan="1">31.7</td>
              <td align="left" rowspan="1" colspan="1">31.2</td>
              <td align="left" rowspan="1" colspan="1">23.7</td>
              <td align="left" rowspan="1" colspan="1">47.6</td>
              <td align="left" rowspan="1" colspan="1">15.6</td>
              <td align="left" rowspan="1" colspan="1">31.2</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">3</td>
              <td align="left" rowspan="1" colspan="1">25.2</td>
              <td align="left" rowspan="1" colspan="1">17.8</td>
              <td align="left" rowspan="1" colspan="1">21.2</td>
              <td align="left" rowspan="1" colspan="1">36.9</td>
              <td align="left" rowspan="1" colspan="1">13.6</td>
              <td align="left" rowspan="1" colspan="1">17.8</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4</td>
              <td align="left" rowspan="1" colspan="1">21.3</td>
              <td align="left" rowspan="1" colspan="1">11.0</td>
              <td align="left" rowspan="1" colspan="1">17.6</td>
              <td align="left" rowspan="1" colspan="1">33.6</td>
              <td align="left" rowspan="1" colspan="1">10.3</td>
              <td align="left" rowspan="1" colspan="1">9.2</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">5</td>
              <td align="left" rowspan="1" colspan="1">17.5</td>
              <td align="left" rowspan="1" colspan="1">6.8</td>
              <td align="left" rowspan="1" colspan="1">12.6</td>
              <td align="left" rowspan="1" colspan="1">29.4</td>
              <td align="left" rowspan="1" colspan="1">8.1</td>
              <td align="left" rowspan="1" colspan="1">6.6</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">6</td>
              <td align="left" rowspan="1" colspan="1">14.0</td>
              <td align="left" rowspan="1" colspan="1">3.4</td>
              <td align="left" rowspan="1" colspan="1">8.9</td>
              <td align="left" rowspan="1" colspan="1">28.1</td>
              <td align="left" rowspan="1" colspan="1">6.4</td>
              <td align="left" rowspan="1" colspan="1">3.7</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">7</td>
              <td align="left" rowspan="1" colspan="1">9.9</td>
              <td align="left" rowspan="1" colspan="1">2.5</td>
              <td align="left" rowspan="1" colspan="1">8.4</td>
              <td align="left" rowspan="1" colspan="1">26.9</td>
              <td align="left" rowspan="1" colspan="1">5.2</td>
              <td align="left" rowspan="1" colspan="1">2.6</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">8</td>
              <td align="left" rowspan="1" colspan="1">7.6</td>
              <td align="left" rowspan="1" colspan="1">1.4</td>
              <td align="left" rowspan="1" colspan="1">5.7</td>
              <td align="left" rowspan="1" colspan="1">25.9</td>
              <td align="left" rowspan="1" colspan="1">4.2</td>
              <td align="left" rowspan="1" colspan="1">2.3</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">9</td>
              <td align="left" rowspan="1" colspan="1">5.1</td>
              <td align="left" rowspan="1" colspan="1">1.0</td>
              <td align="left" rowspan="1" colspan="1">3.3</td>
              <td align="left" rowspan="1" colspan="1">25.8</td>
              <td align="left" rowspan="1" colspan="1">2.6</td>
              <td align="left" rowspan="1" colspan="1">1.3</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">10</td>
              <td align="left" rowspan="1" colspan="1">4.3</td>
              <td align="left" rowspan="1" colspan="1">0.9</td>
              <td align="left" rowspan="1" colspan="1">3.4</td>
              <td align="left" rowspan="1" colspan="1">26.0</td>
              <td align="left" rowspan="1" colspan="1">2.0</td>
              <td align="left" rowspan="1" colspan="1">0.6</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <p>Linkage maps are widely used in marker-assisted selection, quantitative trait loci mapping, and comparative genome analysis. They are also necessary to anchor scaffolds on chromosomes during genome assembly. Due to the limitation of marker density and population size of linkage maps, there left many scaffolds unanchored or unordered in genome assembly recently published. For example, the cacao genome had only 67% and 50% of assembled sequences anchored and ordered, respectively <xref rid="pone.0098855-Argout1" ref-type="bibr">[39]</xref>. The apple (88%, 66%) <xref rid="pone.0098855-Velasco1" ref-type="bibr">[40]</xref> and grape genomes (69%, 61%) <xref rid="pone.0098855-Jaillon1" ref-type="bibr">[41]</xref> exhibited slightly higher utility of scaffolds. Nonetheless, there was still more than 30% of the scaffold that could not be ordered onto chromosomes. Recently, Hyten et al showed that they can orient additional 23 scaffolds (totaling 7.1 Mb) <xref rid="pone.0098855-Hyten1" ref-type="bibr">[42]</xref>, which were previously unordered, into chromosomes by using a higher-density linkage map with larger size of the population, suggesting construction of higher resolution genetic maps is critical for improving genome assembly. In the case of cacao, the assembled genome was 326 Mb, and scaffold N90 was 75.5 kb <xref rid="pone.0098855-Argout1" ref-type="bibr">[39]</xref>. To ensure 90% of the sequence assembly ordered, every 75.5 kb sequence requires at least two markers, and the linkage map should offer at least 8,636 markers in total. The linkage map used in the study had only 1,259 markers <xref rid="pone.0098855-Argout1" ref-type="bibr">[39]</xref>, about 7,000 markers fewer than what was needed. Therefore there remained up to 2,207 scaffolds unordered in the cacao study. By providing high-density, HighMap will be of great benefit to genome assembly and validation of the scaffold placement on the chromosomes.</p>
    <p>In summary, we offer a computationally efficient method for linkage mapping using population NGS data. The development of HighMap should propel the application of NGS in linkage mapping. It is a lasting task to make full use of NGS data at lower cost and to construct high-density linkage maps. Great efforts are guaranteed to further improve the potentials of NGS data utilization in the linkage studies.</p>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0098855.s001">
      <label>Figure S1</label>
      <caption>
        <p>Simulation data sets containing both the missing and erroneous markers. Missing and erroneous rates increased simultaneously as markers increased from 100 to 1,000.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0098855.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0098855.s002">
      <label>Figure S2</label>
      <caption>
        <p>Changes in linkage map quality as missing observation increased. The X-axis indicates missing observation. The Y-axis indicates Spearman rank correlation coefficient between estimated map marker order and true marker location for A, B and C, singleton rates for D, E and F, estimated genetic map distances for G, H and I, respectively. “Integrated”, “Female”, and “Male” indicate integrated, female, or male linkage maps, respectively.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0098855.s002.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0098855.s003">
      <label>Figure S3</label>
      <caption>
        <p>Computational speed of HighMap. Running time was reported as number of 100 seconds. JoinMap4.0 is computationally demanding when marker data contained more than 200 markers.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0098855.s003.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0098855.s004">
      <label>Figure S4</label>
      <caption>
        <p>Heat maps of pair-wise recombination of the common carp. Yellow color represents tight linkage; red represents weak linkage; blue represents no linkage.</p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0098855.s004.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0098855.s005">
      <label>Figure S5</label>
      <caption>
        <p>Haplotype maps of the family of common carp consisting of 211 offsprings. Each two columns represent the genotype of an individual. Rows correspond to genetic markers. Green and blue boxes indicate one chromatid from parents; gray boxes indicate missing data.</p>
        <p>(JPG)</p>
      </caption>
      <media xlink:href="pone.0098855.s005.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0098855.s006">
      <label>Figure S6</label>
      <caption>
        <p>The difference between the correlation coefficient of HighMap and JoinMap4.1. r<sub>HighMap</sub> indicates the Spearman correlation coefficient between marker order of linkage map estimated by HighMap and genome sequences of zebra fish. r<sub>JoinMap4.1</sub> indicates the Spearman correlation coefficient between the marker order of linkage map estimated by JoinMap4.1and the genome sequences of zebra fish.</p>
        <p>(JPG)</p>
      </caption>
      <media xlink:href="pone.0098855.s006.jpg">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0098855.s007">
      <label>Table S1</label>
      <caption>
        <p>Segregation patterns of common carp linkage map.</p>
        <p>(DOC)</p>
      </caption>
      <media xlink:href="pone.0098855.s007.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0098855.s008">
      <label>Table S2</label>
      <caption>
        <p>Singleton rate of common carp linkage map estimated by HighMap and JoinMap4.1.</p>
        <p>(DOC)</p>
      </caption>
      <media xlink:href="pone.0098855.s008.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0098855.s009">
      <label>Table S3</label>
      <caption>
        <p>Genetic distance of common carp linkage map estimated by HighMap and JoinMap4.1.</p>
        <p>(DOC)</p>
      </caption>
      <media xlink:href="pone.0098855.s009.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>The authors would like to thank Dian Guan and Yan Zheng for valuable comments on the manuscript, Xiaofeng Zhang for providing DNA materials of common carp, and Ning Guan for the assistance in DNA sequencing.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0098855-Graham1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Graham</surname><given-names>IA</given-names></name>, <name><surname>Besser</surname><given-names>K</given-names></name>, <name><surname>Blumer</surname><given-names>S</given-names></name>, <name><surname>Branigan</surname><given-names>CA</given-names></name>, <name><surname>Czechowski</surname><given-names>T</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>The genetic map of Artemisia annua L. identifies loci affecting yield of the antimalarial drug artemisinin</article-title>. <source>Science</source>
<volume>327</volume>: <fpage>328</fpage>–<lpage>331</lpage>.<pub-id pub-id-type="pmid">20075252</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Mayer1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Mayer</surname><given-names>KF</given-names></name>, <name><surname>Waugh</surname><given-names>R</given-names></name>, <name><surname>Brown</surname><given-names>JW</given-names></name>, <name><surname>Schulman</surname><given-names>A</given-names></name>, <name><surname>Langridge</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>A physical, genetic and functional sequence assembly of the barley genome</article-title>. <source>Nature</source>
<volume>491</volume>: <fpage>711</fpage>–<lpage>716</lpage>.<pub-id pub-id-type="pmid">23075845</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Wang1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>X</given-names></name>, <name><surname>Wang</surname><given-names>H</given-names></name>, <name><surname>Wang</surname><given-names>J</given-names></name>, <name><surname>Sun</surname><given-names>R</given-names></name>, <name><surname>Wu</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>The genome of the mesopolyploid crop species Brassica rapa</article-title>. <source>Nat Genet</source>
<volume>43</volume>: <fpage>1035</fpage>–<lpage>1039</lpage>.<pub-id pub-id-type="pmid">21873998</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Guo1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Guo</surname><given-names>S</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Sun</surname><given-names>H</given-names></name>, <name><surname>Salse</surname><given-names>J</given-names></name>, <name><surname>Lucas</surname><given-names>WJ</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>The draft genome of watermelon (Citrullus lanatus) and resequencing of 20 diverse accessions</article-title>. <source>Nat Genet</source>
<volume>45</volume>: <fpage>51</fpage>–<lpage>58</lpage>.<pub-id pub-id-type="pmid">23179023</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Consortium1">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Consortium</surname><given-names>TTG</given-names></name> (<year>2012</year>) <article-title>The tomato genome sequence provides insights into fleshy fruit evolution</article-title>. <source>Nature</source>
<volume>485</volume>: <fpage>635</fpage>–<lpage>641</lpage>.<pub-id pub-id-type="pmid">22660326</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Howe1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Howe</surname><given-names>K</given-names></name>, <name><surname>Clark</surname><given-names>MD</given-names></name>, <name><surname>Torroja</surname><given-names>CF</given-names></name>, <name><surname>Torrance</surname><given-names>J</given-names></name>, <name><surname>Berthelot</surname><given-names>C</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>The zebrafish reference genome sequence and its relationship to the human genome</article-title>. <source>Nature</source>
<volume>496</volume>: <fpage>498</fpage>–<lpage>503</lpage>.<pub-id pub-id-type="pmid">23594743</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Shifman1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Shifman</surname><given-names>S</given-names></name>, <name><surname>Bell</surname><given-names>JT</given-names></name>, <name><surname>Copley</surname><given-names>RR</given-names></name>, <name><surname>Taylor</surname><given-names>MS</given-names></name>, <name><surname>Williams</surname><given-names>RW</given-names></name>, <etal>et al</etal> (<year>2006</year>) <article-title>A high-resolution single nucleotide polymorphism genetic map of the mouse genome</article-title>. <source>PLoS Biol</source>
<volume>4</volume>: <fpage>e395</fpage>.<pub-id pub-id-type="pmid">17105354</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Wang2">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>S</given-names></name>, <name><surname>Zhang</surname><given-names>L</given-names></name>, <name><surname>Meyer</surname><given-names>E</given-names></name>, <name><surname>Matz</surname><given-names>MV</given-names></name> (<year>2009</year>) <article-title>Construction of a high-resolution genetic linkage map and comparative genome analysis for the reef-building coral Acropora millepora</article-title>. <source>Genome Biol</source>
<volume>10</volume>: <fpage>R126</fpage>.<pub-id pub-id-type="pmid">19900279</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-MacLeod1">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>MacLeod</surname><given-names>A</given-names></name>, <name><surname>Tweedie</surname><given-names>A</given-names></name>, <name><surname>McLellan</surname><given-names>S</given-names></name>, <name><surname>Taylor</surname><given-names>S</given-names></name>, <name><surname>Hall</surname><given-names>N</given-names></name>, <etal>et al</etal> (<year>2005</year>) <article-title>The genetic map and comparative analysis with the physical map of Trypanosoma brucei</article-title>. <source>Nucleic Acids Res</source>
<volume>33</volume>: <fpage>6688</fpage>–<lpage>6693</lpage>.<pub-id pub-id-type="pmid">16314301</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Sun1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Sun</surname><given-names>X</given-names></name>, <name><surname>Liu</surname><given-names>D</given-names></name>, <name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>W</given-names></name>, <name><surname>Liu</surname><given-names>H</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>SLAF-seq: An Efficient Method of Large-Scale De Novo SNP Discovery and Genotyping Using High-Throughput Sequencing</article-title>. <source>PLoS One</source>
<volume>8</volume>: <fpage>e58700</fpage>.<pub-id pub-id-type="pmid">23527008</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Baird1">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Baird</surname><given-names>NA</given-names></name>, <name><surname>Etter</surname><given-names>PD</given-names></name>, <name><surname>Atwood</surname><given-names>TS</given-names></name>, <name><surname>Currey</surname><given-names>MC</given-names></name>, <name><surname>Shiver</surname><given-names>AL</given-names></name>, <etal>et al</etal> (<year>2008</year>) <article-title>Rapid SNP discovery and genetic mapping using sequenced RAD markers</article-title>. <source>PLoS One</source>
<volume>3</volume>: <fpage>e3376</fpage>.<pub-id pub-id-type="pmid">18852878</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Elshire1">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Elshire</surname><given-names>RJ</given-names></name>, <name><surname>Glaubitz</surname><given-names>JC</given-names></name>, <name><surname>Sun</surname><given-names>Q</given-names></name>, <name><surname>Poland</surname><given-names>JA</given-names></name>, <name><surname>Kawamoto</surname><given-names>K</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>A robust, simple genotyping-by-sequencing (GBS) approach for high diversity species</article-title>. <source>PLoS One</source>
<volume>6</volume>: <fpage>e19379</fpage>.<pub-id pub-id-type="pmid">21573248</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Davey1">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Davey</surname><given-names>JW</given-names></name>, <name><surname>Hohenlohe</surname><given-names>PA</given-names></name>, <name><surname>Etter</surname><given-names>PD</given-names></name>, <name><surname>Boone</surname><given-names>JQ</given-names></name>, <name><surname>Catchen</surname><given-names>JM</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Genome-wide genetic marker discovery and genotyping using next-generation sequencing</article-title>. <source>Nat Rev Genet</source>
<volume>12</volume>: <fpage>499</fpage>–<lpage>510</lpage>.<pub-id pub-id-type="pmid">21681211</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Andolfatto1">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Andolfatto</surname><given-names>P</given-names></name>, <name><surname>Davison</surname><given-names>D</given-names></name>, <name><surname>Erezyilmaz</surname><given-names>D</given-names></name>, <name><surname>Hu</surname><given-names>TT</given-names></name>, <name><surname>Mast</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Multiplexed shotgun genotyping for rapid and efficient genetic mapping</article-title>. <source>Genome Res</source>
<volume>21</volume>: <fpage>610</fpage>–<lpage>617</lpage>.<pub-id pub-id-type="pmid">21233398</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Xie1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Xie</surname><given-names>W</given-names></name>, <name><surname>Feng</surname><given-names>Q</given-names></name>, <name><surname>Yu</surname><given-names>H</given-names></name>, <name><surname>Huang</surname><given-names>X</given-names></name>, <name><surname>Zhao</surname><given-names>Q</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>Parent-independent genotyping for constructing an ultrahigh-density linkage map based on population sequencing</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>107</volume>: <fpage>10578</fpage>–<lpage>10583</lpage>.<pub-id pub-id-type="pmid">20498060</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Nielsen1">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>Nielsen</surname><given-names>R</given-names></name>, <name><surname>Paul</surname><given-names>JS</given-names></name>, <name><surname>Albrechtsen</surname><given-names>A</given-names></name>, <name><surname>Song</surname><given-names>YS</given-names></name> (<year>2011</year>) <article-title>Genotype and SNP calling from next-generation sequencing data</article-title>. <source>Nat Rev Genet</source>
<volume>12</volume>: <fpage>443</fpage>–<lpage>451</lpage>.<pub-id pub-id-type="pmid">21587300</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Le1">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Le</surname><given-names>SQ</given-names></name>, <name><surname>Durbin</surname><given-names>R</given-names></name> (<year>2011</year>) <article-title>SNP detection and genotyping from low-coverage sequencing data on multiple diploid samples</article-title>. <source>Genome Res</source>
<volume>21</volume>: <fpage>952</fpage>–<lpage>960</lpage>.<pub-id pub-id-type="pmid">20980557</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Bansal1">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Bansal</surname><given-names>V</given-names></name>, <name><surname>Harismendy</surname><given-names>O</given-names></name>, <name><surname>Tewhey</surname><given-names>R</given-names></name>, <name><surname>Murray</surname><given-names>SS</given-names></name>, <name><surname>Schork</surname><given-names>NJ</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>Accurate detection and genotyping of SNPs utilizing population sequencing data</article-title>. <source>Genome Res</source>
<volume>20</volume>: <fpage>537</fpage>–<lpage>545</lpage>.<pub-id pub-id-type="pmid">20150320</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Chen1">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Chen</surname><given-names>W</given-names></name>, <name><surname>Li</surname><given-names>B</given-names></name>, <name><surname>Zeng</surname><given-names>Z</given-names></name>, <name><surname>Sanna</surname><given-names>S</given-names></name>, <name><surname>Sidore</surname><given-names>C</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>Genotype calling and haplotyping in parent-offspring trios</article-title>. <source>Genome Res</source>
<volume>23</volume>: <fpage>142</fpage>–<lpage>151</lpage>.<pub-id pub-id-type="pmid">23064751</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Wang3">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Lu</surname><given-names>J</given-names></name>, <name><surname>Yu</surname><given-names>J</given-names></name>, <name><surname>Gibbs</surname><given-names>RA</given-names></name>, <name><surname>Yu</surname><given-names>F</given-names></name> (<year>2013</year>) <article-title>An integrative variant analysis pipeline for accurate genotype/haplotype inference in population NGS data</article-title>. <source>Genome Res</source>
<volume>23</volume>: <fpage>833</fpage>–<lpage>842</lpage>.<pub-id pub-id-type="pmid">23296920</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Xu1">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>F</given-names></name>, <name><surname>Wang</surname><given-names>W</given-names></name>, <name><surname>Wang</surname><given-names>P</given-names></name>, <name><surname>Jun Li</surname><given-names>M</given-names></name>, <name><surname>Chung Sham</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>A fast and accurate SNP detection algorithm for next-generation sequencing data</article-title>. <source>Nat Commun</source>
<volume>3</volume>: <fpage>1258</fpage>.<pub-id pub-id-type="pmid">23212387</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-vanOs1">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>van Os</surname><given-names>H</given-names></name>, <name><surname>Stam</surname><given-names>P</given-names></name>, <name><surname>Visser</surname><given-names>RG</given-names></name>, <name><surname>van Eck</surname><given-names>HJ</given-names></name> (<year>2005</year>) <article-title>SMOOTH: a statistical method for successful removal of genotyping errors from high-density genetic linkage data</article-title>. <source>Theor Appl Genet</source>
<volume>112</volume>: <fpage>187</fpage>–<lpage>194</lpage>.<pub-id pub-id-type="pmid">16258753</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Rastas1">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Rastas</surname><given-names>P</given-names></name>, <name><surname>Paulin</surname><given-names>L</given-names></name>, <name><surname>Hanski</surname><given-names>I</given-names></name>, <name><surname>Lehtonen</surname><given-names>R</given-names></name>, <name><surname>Auvinen</surname><given-names>P</given-names></name> (<year>2013</year>) <article-title>Lep-MAP: fast and accurate linkage map construction for large SNP datasets</article-title>. <source>Bioinformatics</source>
<volume>29</volume>: <fpage>3128</fpage>–<lpage>3134</lpage>.<pub-id pub-id-type="pmid">24078685</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-VanOs1">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Van Os</surname><given-names>H</given-names></name>, <name><surname>Stam</surname><given-names>P</given-names></name>, <name><surname>Visser</surname><given-names>RG</given-names></name>, <name><surname>Van Eck</surname><given-names>HJ</given-names></name> (<year>2005</year>) <article-title>RECORD: a novel method for ordering loci on a genetic linkage map</article-title>. <source>Theor Appl Genet</source>
<volume>112</volume>: <fpage>30</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">16228189</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Margarido1">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Margarido</surname><given-names>GR</given-names></name>, <name><surname>Souza</surname><given-names>AP</given-names></name>, <name><surname>Garcia</surname><given-names>AA</given-names></name> (<year>2007</year>) <article-title>OneMap: software for genetic mapping in outcrossing species</article-title>. <source>Hereditas</source>
<volume>144</volume>: <fpage>78</fpage>–<lpage>79</lpage>.<pub-id pub-id-type="pmid">17663699</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Tong1">
      <label>26</label>
      <mixed-citation publication-type="journal"><name><surname>Tong</surname><given-names>C</given-names></name>, <name><surname>Zhang</surname><given-names>B</given-names></name>, <name><surname>Shi</surname><given-names>J</given-names></name> (<year>2010</year>) <article-title>A hidden Markov model approach to multilocus linkage analysis in a full-sib family</article-title>. <source>Tree Genetics and Genomes</source>
<volume>6</volume>: <fpage>12</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0098855-JW1">
      <label>27</label>
      <mixed-citation publication-type="journal"><name><surname>JW</surname><given-names>VANO</given-names></name> (<year>2011</year>) <article-title>Multipoint maximum likelihood mapping in a full-sib family of an outbreeding species</article-title>. <source>Genet Res (Camb)</source>
<volume>93</volume>: <fpage>343</fpage>–<lpage>349</lpage>.<pub-id pub-id-type="pmid">21878144</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Amores1">
      <label>28</label>
      <mixed-citation publication-type="journal"><name><surname>Amores</surname><given-names>A</given-names></name>, <name><surname>Catchen</surname><given-names>J</given-names></name>, <name><surname>Ferrara</surname><given-names>A</given-names></name>, <name><surname>Fontenot</surname><given-names>Q</given-names></name>, <name><surname>Postlethwait</surname><given-names>JH</given-names></name> (<year>2011</year>) <article-title>Genome evolution and meiotic maps by massively parallel DNA sequencing: spotted gar, an outgroup for the teleost genome duplication</article-title>. <source>Genetics</source>
<volume>188</volume>: <fpage>799</fpage>–<lpage>808</lpage>.<pub-id pub-id-type="pmid">21828280</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Bowers1">
      <label>29</label>
      <mixed-citation publication-type="journal"><name><surname>Bowers</surname><given-names>JE</given-names></name>, <name><surname>Bachlava</surname><given-names>E</given-names></name>, <name><surname>Brunick</surname><given-names>RL</given-names></name>, <name><surname>Rieseberg</surname><given-names>LH</given-names></name>, <name><surname>Knapp</surname><given-names>SJ</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Development of a 10,000 locus genetic map of the sunflower genome based on multiple crosses</article-title>. <source>G3 (Bethesda)</source>
<volume>2</volume>: <fpage>721</fpage>–<lpage>729</lpage>.<pub-id pub-id-type="pmid">22870395</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Munoz1">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Munoz</surname><given-names>M</given-names></name>, <name><surname>Alves</surname><given-names>E</given-names></name>, <name><surname>Ramayo-Caldas</surname><given-names>Y</given-names></name>, <name><surname>Casellas</surname><given-names>J</given-names></name>, <name><surname>Rodriguez</surname><given-names>C</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Recombination rates across porcine autosomes inferred from high-density linkage maps</article-title>. <source>Anim Genet</source>
<volume>43</volume>: <fpage>620</fpage>–<lpage>623</lpage>.<pub-id pub-id-type="pmid">22497205</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Sun2">
      <label>31</label>
      <mixed-citation publication-type="journal"><name><surname>Sun</surname><given-names>Z</given-names></name>, <name><surname>Wang</surname><given-names>Z</given-names></name>, <name><surname>Tu</surname><given-names>J</given-names></name>, <name><surname>Zhang</surname><given-names>J</given-names></name>, <name><surname>Yu</surname><given-names>F</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>An ultradense genetic recombination map for Brassica napus, consisting of 13551 SRAP markers</article-title>. <source>Theor Appl Genet</source>
<volume>114</volume>: <fpage>1305</fpage>–<lpage>1317</lpage>.<pub-id pub-id-type="pmid">17426959</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Ganal1">
      <label>32</label>
      <mixed-citation publication-type="journal"><name><surname>Ganal</surname><given-names>MW</given-names></name>, <name><surname>Durstewitz</surname><given-names>G</given-names></name>, <name><surname>Polley</surname><given-names>A</given-names></name>, <name><surname>Berard</surname><given-names>A</given-names></name>, <name><surname>Buckler</surname><given-names>ES</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>A large maize (Zea mays L.) SNP genotyping array: development and germplasm genotyping, and genetic mapping to compare with the B73 reference genome</article-title>. <source>PLoS One</source>
<volume>6</volume>: <fpage>e28334</fpage>.<pub-id pub-id-type="pmid">22174790</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-vanOs2">
      <label>33</label>
      <mixed-citation publication-type="journal"><name><surname>van Os</surname><given-names>H</given-names></name>, <name><surname>Andrzejewski</surname><given-names>S</given-names></name>, <name><surname>Bakker</surname><given-names>E</given-names></name>, <name><surname>Barrena</surname><given-names>I</given-names></name>, <name><surname>Bryan</surname><given-names>GJ</given-names></name>, <etal>et al</etal> (<year>2006</year>) <article-title>Construction of a 10,000-marker ultradense genetic recombination map of potato: providing a framework for accelerated gene isolation and a genomewide physical map</article-title>. <source>Genetics</source>
<volume>173</volume>: <fpage>1075</fpage>–<lpage>1087</lpage>.<pub-id pub-id-type="pmid">16582432</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Huang1">
      <label>34</label>
      <mixed-citation publication-type="journal"><name><surname>Huang</surname><given-names>X</given-names></name>, <name><surname>Zhao</surname><given-names>Y</given-names></name>, <name><surname>Wei</surname><given-names>X</given-names></name>, <name><surname>Li</surname><given-names>C</given-names></name>, <name><surname>Wang</surname><given-names>A</given-names></name>, <etal>et al</etal> (<year>2012</year>) <article-title>Genome-wide association study of flowering time and grain yield traits in a worldwide collection of rice germplasm</article-title>. <source>Nat Genet</source>
<volume>44</volume>: <fpage>32</fpage>–<lpage>39</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0098855-Jansen1">
      <label>35</label>
      <mixed-citation publication-type="journal"><name><surname>Jansen</surname><given-names>J</given-names></name>, <name><surname>Jong</surname><given-names>AGd</given-names></name>, <name><surname>Ooijen</surname><given-names>JWv</given-names></name> (<year>2001</year>) <article-title>Constructing dense genetic linkage maps</article-title>. <source>Theor Appl Genet</source>
<volume>102</volume>: <fpage>10</fpage>.</mixed-citation>
    </ref>
    <ref id="pone.0098855-West1">
      <label>36</label>
      <mixed-citation publication-type="journal"><name><surname>West</surname><given-names>MA</given-names></name>, <name><surname>van Leeuwen</surname><given-names>H</given-names></name>, <name><surname>Kozik</surname><given-names>A</given-names></name>, <name><surname>Kliebenstein</surname><given-names>DJ</given-names></name>, <name><surname>Doerge</surname><given-names>RW</given-names></name>, <etal>et al</etal> (<year>2006</year>) <article-title>High-density haplotyping with microarray-based expression and single feature polymorphism markers in Arabidopsis</article-title>. <source>Genome Res</source>
<volume>16</volume>: <fpage>787</fpage>–<lpage>795</lpage>.<pub-id pub-id-type="pmid">16702412</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Wu1">
      <label>37</label>
      <mixed-citation publication-type="journal"><name><surname>Wu</surname><given-names>R</given-names></name>, <name><surname>Ma</surname><given-names>CX</given-names></name>, <name><surname>Painter</surname><given-names>I</given-names></name>, <name><surname>Zeng</surname><given-names>ZB</given-names></name> (<year>2002</year>) <article-title>Simultaneous maximum likelihood estimation of linkage and linkage phases in outcrossing species</article-title>. <source>Theor Popul Biol</source>
<volume>61</volume>: <fpage>349</fpage>–<lpage>363</lpage>.<pub-id pub-id-type="pmid">12027621</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Zhang1">
      <label>38</label>
      <mixed-citation publication-type="journal"><name><surname>Zhang</surname><given-names>X</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name>, <name><surname>Zheng</surname><given-names>X</given-names></name>, <name><surname>Kuang</surname><given-names>Y</given-names></name>, <name><surname>Zhao</surname><given-names>Z</given-names></name>, <etal>et al</etal> (<year>2013</year>) <article-title>A consensus linkage map provides insights on genome character and evolution in common carp (Cyprinus carpio L.)</article-title>. <source>Mar Biotechnol (NY)</source>
<volume>15</volume>: <fpage>275</fpage>–<lpage>312</lpage>.<pub-id pub-id-type="pmid">23073608</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Argout1">
      <label>39</label>
      <mixed-citation publication-type="journal"><name><surname>Argout</surname><given-names>X</given-names></name>, <name><surname>Salse</surname><given-names>J</given-names></name>, <name><surname>Aury</surname><given-names>JM</given-names></name>, <name><surname>Guiltinan</surname><given-names>MJ</given-names></name>, <name><surname>Droc</surname><given-names>G</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>The genome of Theobroma cacao</article-title>. <source>Nat Genet</source>
<volume>43</volume>: <fpage>101</fpage>–<lpage>108</lpage>.<pub-id pub-id-type="pmid">21186351</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Velasco1">
      <label>40</label>
      <mixed-citation publication-type="journal"><name><surname>Velasco</surname><given-names>R</given-names></name>, <name><surname>Zharkikh</surname><given-names>A</given-names></name>, <name><surname>Affourtit</surname><given-names>J</given-names></name>, <name><surname>Dhingra</surname><given-names>A</given-names></name>, <name><surname>Cestaro</surname><given-names>A</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>The genome of the domesticated apple (Malus x domestica Borkh.)</article-title>. <source>Nat Genet</source>
<volume>42</volume>: <fpage>833</fpage>–<lpage>839</lpage>.<pub-id pub-id-type="pmid">20802477</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Jaillon1">
      <label>41</label>
      <mixed-citation publication-type="journal"><name><surname>Jaillon</surname><given-names>O</given-names></name>, <name><surname>Aury</surname><given-names>JM</given-names></name>, <name><surname>Noel</surname><given-names>B</given-names></name>, <name><surname>Policriti</surname><given-names>A</given-names></name>, <name><surname>Clepet</surname><given-names>C</given-names></name>, <etal>et al</etal> (<year>2007</year>) <article-title>The grapevine genome sequence suggests ancestral hexaploidization in major angiosperm phyla</article-title>. <source>Nature</source>
<volume>449</volume>: <fpage>463</fpage>–<lpage>467</lpage>.<pub-id pub-id-type="pmid">17721507</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0098855-Hyten1">
      <label>42</label>
      <mixed-citation publication-type="journal"><name><surname>Hyten</surname><given-names>DL</given-names></name>, <name><surname>Cannon</surname><given-names>SB</given-names></name>, <name><surname>Song</surname><given-names>Q</given-names></name>, <name><surname>Weeks</surname><given-names>N</given-names></name>, <name><surname>Fickus</surname><given-names>EW</given-names></name>, <etal>et al</etal> (<year>2010</year>) <article-title>High-throughput SNP discovery through deep resequencing of a reduced representation library to anchor and orient scaffolds in the soybean whole genome sequence</article-title>. <source>BMC Genomics</source>
<volume>11</volume>: <fpage>38</fpage>.<pub-id pub-id-type="pmid">20078886</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
