<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4765874</article-id>
    <article-id pub-id-type="pmid">26072503</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btv231</article-id>
    <article-id pub-id-type="publisher-id">btv231</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Ismb/Eccb 2015 Proceedings Papers Committee July 10 to July 14, 2015, Dublin, Ireland</subject>
        <subj-group subj-group-type="heading">
          <subject>Genes</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Reconstructing 16S rRNA genes in metagenomic data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Yuan</surname>
          <given-names>Cheng</given-names>
        </name>
        <xref ref-type="aff" rid="btv231-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lei</surname>
          <given-names>Jikai</given-names>
        </name>
        <xref ref-type="aff" rid="btv231-AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cole</surname>
          <given-names>James</given-names>
        </name>
        <xref ref-type="aff" rid="btv231-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sun</surname>
          <given-names>Yanni</given-names>
        </name>
        <xref ref-type="aff" rid="btv231-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btv231-COR1">*</xref>
      </contrib>
      <aff id="btv231-AFF1"><sup>1</sup>Computer Science and Engineering, Michigan State Univerisity, 428 South Shaw Rd East Lansing, MI 48824, USA and <sup>2</sup>Center for Microbial Ecology, Michigan State University, East Lansing, MI 48824, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btv231-COR1">*To whom correspondence should be addressed.</corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>6</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>10</day>
      <month>6</month>
      <year>2015</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>6</month>
      <year>2015</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>31</volume>
    <issue>12</issue>
    <fpage>i35</fpage>
    <lpage>i43</lpage>
    <permissions>
      <copyright-statement>© The Author 2015. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2015</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Metagenomic data, which contains sequenced DNA reads of uncultured microbial species from environmental samples, provide a unique opportunity to thoroughly analyze microbial species that have never been identified before. Reconstructing 16S ribosomal RNA, a phylogenetic marker gene, is usually required to analyze the composition of the metagenomic data. However, massive volume of dataset, high sequence similarity between related species, skewed microbial abundance and lack of reference genes make 16S rRNA reconstruction difficult. Generic <italic>de novo</italic> assembly tools are not optimized for assembling 16S rRNA genes. In this work, we introduce a targeted rRNA assembly tool, REAGO (REconstruct 16S ribosomal RNA Genes from metagenOmic data). It addresses the above challenges by combining secondary structure-aware homology search, zproperties of rRNA genes and <italic>de novo</italic> assembly. Our experimental results show that our tool can correctly recover more rRNA genes than several popular generic metagenomic assembly tools and specially designed rRNA construction tools.</p>
      <p><bold>Availability and implementation:</bold> The source code of REAGO is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/chengyuan/reago">https://github.com/chengyuan/reago</ext-link>.</p>
      <p>
        <bold>Contact:</bold>
        <email>yannisun@msu.edu</email>
      </p>
    </abstract>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Microbes are ubiquitous species existing in all environments on earth, including extreme conditions (<xref rid="btv231-B25" ref-type="bibr">Rothschild and Mancinelli, 2001</xref>). From the desert to acid wastewater, from pine forest soil to mine drainage, they sustain themselves using various mechanisms (<xref rid="btv231-B14" ref-type="bibr">Konings <italic>et al.</italic>, 2002</xref>). Human bodies are also habitats of microbes. It is estimated that there are 10<sup>14</sup> bacterial cell inhabiting on our body, which is 10 times more than our own cells (<xref rid="btv231-B3" ref-type="bibr">Berg, 1996</xref>; <xref rid="btv231-B27" ref-type="bibr">Savage, 1977</xref>). Human life as well as the entire ecosystem are profoundly affected by microbes. There is a strong need to understand the function of microbial communities and how they interact with their hosts. The function of microbial community is defined by its composition and diversity (<xref rid="btv231-B18" ref-type="bibr">Loreau <italic>et al.</italic>, 2001</xref>). In particular, metagenomic data, which contains sequenced DNA reads of uncultured microbial species from environmental samples, provide a unique opportunity to thoroughly analyze microbial species that have never been identified before.</p>
    <p>A commonly adopted approach for identifying the microbial species in environmental samples is to conduct comparative analysis of ribosomal RNA sequences (<xref rid="btv231-B35" ref-type="bibr">Woese and Fox, 1977</xref>; <xref rid="btv231-B36" ref-type="bibr">Woese <italic>et al.</italic>, 1990</xref>). The use of rRNA for microbial phylogenetic analysis had become such a relied-upon methodology that by 2008; 77% of all INSDC (<xref rid="btv231-B2" ref-type="bibr">Benson <italic>et al.</italic>, 2010</xref>; <xref rid="btv231-B6" ref-type="bibr">Cochrane <italic>et al.</italic>, 2009</xref>; <xref rid="btv231-B31" ref-type="bibr">Tateno <italic>et al.</italic>, 2002</xref>) bacterial DNA sequence submissions described an rRNA gene sequence (<xref rid="btv231-B5" ref-type="bibr">Christen, 2008</xref>)! 16S rRNA reads from metagenomic studies provide a source of sequences that are not subject to PCR primer bias and therefore covers taxa that might be missed by existing popular primer sets (<xref rid="btv231-B11" ref-type="bibr">Hamady and Knight, 2009</xref>). The rRNA genes are a patchwork of hypervariable (rapidly evolving) and universally conserved regions. Unassembled reads in metagenomic data usually lack usable phylogenetic signal. Thus, there is a strong need to recover complete or near-complete rRNA genes from the short reads for analyzing microbial composition in the underlying samples. However, the massive data volume, short read length, skewed species abundance and high similarity of 16S rRNA genes all make rRNA recovery in metagenomic data very difficult. The goal of this work is to provide a tool that can efficiently and accurately recover rRNA genes from metagenomic data.</p>
    <p>Existing pipelines for annotating rRNA genes in metagenomic data can be divided into two groups. The first type of pipelines relies on existing <italic>de novo</italic> assembly tools to output assembled contigs, which are then used as input to available genome-wide rRNA search tools. There are various metagenomic assembly programs (<xref rid="btv231-B15" ref-type="bibr">Laserson <italic>et al.</italic>, 2011</xref>; <xref rid="btv231-B19" ref-type="bibr">Luo <italic>et al.</italic>, 2012</xref>; <xref rid="btv231-B21" ref-type="bibr">Namiki <italic>et al.</italic>, 2012</xref>; <xref rid="btv231-B23" ref-type="bibr">Peng <italic>et al.</italic>, 2011</xref>; <xref rid="btv231-B26" ref-type="bibr">Salzberg <italic>et al.</italic>, 2008</xref>; <xref rid="btv231-B32" ref-type="bibr">Treangen <italic>et al.</italic>, 2013</xref>; <xref rid="btv231-B37" ref-type="bibr">Wu <italic>et al.</italic>, 2012</xref>), which intend to recover individual genomes in an environmental sample. Metagenomic assembly is computationally difficult (<xref rid="btv231-B32" ref-type="bibr">Treangen <italic>et al.</italic>, 2013</xref>). In particular, previous work shows that metagenomic sequencing of high-complexity microbial communities results in little or no assembly of reads (<xref rid="btv231-B12" ref-type="bibr">Jeffrey and Zhong, 2011</xref>; <xref rid="btv231-B33" ref-type="bibr">Tringe <italic>et al.</italic>, 2005</xref>). In addition, our goal is to detect rRNA genes in metagenomic data while much of generic <italic>de novo</italic> assemblies consist of other genomic regions. Thus, the commonly used pipeline of combining generic metagenomic assembly and genome-wide rRNA detection tools is convenient but not optimized for rRNA detection in metagenomic data. The second type of pipelines avoids metagenomic assembly and incorporates properties of rRNA genes (<xref rid="btv231-B9" ref-type="bibr">Fan <italic>et al.</italic>, 2012</xref>; <xref rid="btv231-B20" ref-type="bibr">Miller <italic>et al.</italic>, 2011</xref>). The most promising one is perhaps EMIRGE (<xref rid="btv231-B20" ref-type="bibr">Miller <italic>et al.</italic>, 2011</xref>), which uses an expectation maximization approach along with a set of reference gene sequences to assemble rRNA genes from metagenomic data. However, EMIRGE requires a large number of known rRNA genes for the mapping step and may miss remotely related rRNA genes.</p>
    <p>Therefore, lacking reference genomes, recovering full-length rRNA genes from a large number of short and error-prone reads is still an outstanding challenge. In this work, we propose and implement a targeted rRNA assembly program, REAGO, which is optimized for rRNA gene recovery in metagenomic data. It has three advantages comparing with existing methods. First, it significantly reduces the problem size by first discarding reads that are not likely sequenced from rRNA genes. Second, paired-end information is carefully applied to guide gene assembly and thus distinguish rRNA genes from different species. Third, the profile-based homology search step enables us to decide the orientation and relative position of each contig, leading to efficient scaffolding. We applied our tool to two metagenomic datasets and benchmarked its performance with several other programs. The experimental results show that our tool competes favorably in recovering rRNA genes in metagenomic datasets.</p>
  </sec>
  <sec id="SEC2">
    <title>2 Method</title>
    <sec sec-type="intro">
      <title>2.1 Overview of REAGO</title>
      <p><xref ref-type="fig" rid="btv231-F1">Figure 1</xref> is a schematic representation of the pipeline, which contains four stages. First, we identify 16S rRNA reads from the original metagenomic dataset using secondary-structure-aware homology search. The majority of non-16S reads are discarded in this process, significantly reducing the problem size. Second, REAGO constructs overlap graphs. Various graph reduction techniques are applied to remove possible sequencing errors and prepare the graph for efficient assembly. The third stage assembles reads into contigs by our path finding algorithms. The path finding procedure is guided using paired-end information and aims to avoid generating chimeric 16S rRNA genes by maximizing Weighted Paired-End Match Score (WPEMS) (Section 2.5). Finally, paired-end information again is used to scaffold incomplete 16S fragments, if any, into longer contigs or full-length genes.
<fig id="btv231-F1" position="float"><label>Fig. 1.</label><caption><p>Pipeline of the 16S rRNA gene assembly. Short black and gray bars represent reads originating from different 16S rRNA genes. Short white bars represent reads from non-16S regions. Long bars represent contigs assembled from short reads</p></caption><graphic xlink:href="btv231f1p"/></fig>
</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 16S rRNA reads identification</title>
      <p>In our method, we first conduct homology search to identify reads originating from 16S rRNA genes. To utilize both the sequence and structural conservation of 16S rRNA genes, we align metagenomic reads to a Stochastic Context-Free Grammar (SCFG) based model (<xref rid="btv231-B8" ref-type="bibr">Durbin, 1998</xref>), which is trained on characterized rRNA genes and describes both the sequence and secondary structure conservation. The-state-of-the-art implementation of SCFG is covariance model (CM) in Infernal (<xref rid="btv231-B22" ref-type="bibr">Nawrocki <italic>et al.</italic>, 2009</xref>). The scores and associated E-values of the alignments between reads and the CM are used to screen rRNA reads. In general, reads sequenced from 16S rRNA genes are likely to get high alignment scores while reads from other genes tend to receive low scores.</p>
      <p>Fragmentary sequences pose great challenges to the alignment algorithms since structural information in short reads is likely to be partially missing. As a result, such short reads tend to receive marginal alignment scores and are not identified. Infernal handles this problem by recovering possibly missing bases while performing the alignment (<xref rid="btv231-B13" ref-type="bibr">Kolbe and Eddy, 2009</xref>). Thus, short 16S rRNA reads can still receive significant alignment scores.</p>
      <p>BLAST (<xref rid="btv231-B1" ref-type="bibr">Altschul <italic>et al.</italic>, 1990</xref>) is another choice for 16S read identification. By aligning reads with the reference 16S rRNA database, rRNA reads may be recognized using BLAST alignment scores or E-values. We choose SCFG-based homology search over BLAST for two reasons. First, BLAST conducts homology search based on sequence similarity and may miss reads lacking primary sequence conservation. 16S ribosomal RNAs share high sequence similarity on many regions across different species. However, there also exist a number of variable regions where secondary structures are better conserved than primary sequences. Secondary structural information could then be very helpful to provide additional evidence for 16S sequence identification. A number of studies have demonstrated the advantages of incorporating secondary structural information in various types of non-coding RNA homology search (<xref rid="btv231-B22" ref-type="bibr">Nawrocki <italic>et al.</italic>, 2009</xref>). Experiments were conducted to compare BLAST and CM-based approaches (<xref rid="btv231-B13" ref-type="bibr">Kolbe and Eddy, 2009</xref>; <xref rid="btv231-B38" ref-type="bibr">Yuan and Sun, 2013</xref>) on identifying short rRNA reads. The results indicate that BLAST tends to miss short rRNA reads that are sequenced from non-conserved regions. CM-based approaches generally improve the identification accuracy by including secondary structure information. The second reason behind choosing SCFG-based homology is that the single SCFG-based model provides a convenient reference for inferring the orientation and relative positions among contigs during the scaffolding stage.</p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Overlap graph creation and graph pruning</title>
      <p>All reads that are possibly sequenced from rRNA genes are used to construct an overlap graph for assembly. An overlap between two reads is formed if the suffix of a read matches the prefix of another read. A straightforward overlap detection method performs pair-wise comparison among all reads, requiring <inline-formula><mml:math id="MM1"><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> comparisons. There exist efficient implementations of overlap graphs based on data structures such as hash table and BTW (<xref rid="btv231-B10" ref-type="bibr">Gonnella and Kurtz, 2012</xref>; <xref rid="btv231-B29" ref-type="bibr">Simpson and Durbin, 2012</xref>). We choose Readjoiner (<xref rid="btv231-B10" ref-type="bibr">Gonnella and Kurtz, 2012</xref>), which provides a set of time and space efficient algorithms for detecting all suffix-prefix matches among a set of reads. In overlap graphs, each vertex represents a read and each edge represents a suffix-prefix match of size at least <italic>l</italic>, a pre-determined overlap threshold. <italic>l</italic> has high impact on complexity and connectivity of graphs. Small <italic>l</italic> tends to increase the connectivity, but also complexity, of the overlap graph. Larger <italic>l</italic> is likely to produce less tangled graph, but can possibly miss connections between reads from lowly sequenced regions. Note that transitive edges are automatically removed in the output by Readjoiner.</p>
      <p>The original graphs generated from the output of Readjoiner could be very complex because of the large data size, sequencing errors, and highly similar regions shared by different genes. We apply an iterative graph pruning procedure, as depicted in <xref ref-type="fig" rid="btv231-F2">Figure 2</xref>, to gradually simplify the graph at each iteration. The procedure terminates when the graph stops changing. Below we detail each stage.
<fig id="btv231-F2" position="float"><label>Fig. 2.</label><caption><p>Graph reduction is conducted iteratively until there is no change on the graph</p></caption><graphic xlink:href="btv231f2p"/></fig>
</p>
      <sec id="SEC2.3.1">
        <title>2.3.1 Node collapsing</title>
        <p>The original overlap graph tends to have chains of linearly connected vertices. In such chains, each vertex has only a single incoming edge and outgoing edge. Such vertices can be merged without loss of reachability.</p>
      </sec>
      <sec id="SEC2.3.2">
        <title>2.3.2 Alignment-based error correction</title>
        <p>Sequencing errors and highly similar regions shared by different genes can contribute to a large number of bifurcations, greatly complicating the graph. Error correction in metagenomic data is an unsolved problem. Rare reads may come from low abundance genes rather than sequencing errors. Nevertheless, we still follow the error correction rationale commonly used in <italic>de novo</italic> genome assembly and correct bases in rare reads. As shown in <xref ref-type="fig" rid="btv231-F3">Figure 3</xref>, we applied a heuristic but efficient alignment-based error correction to two types of bifurcations. Reads or contigs from sibling nodes <inline-formula><mml:math id="MM2"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, which share the same predecessor or successor, are aligned. Specifically, based on the known overlaps with the contig in the common predecessor or successor, the contigs in the sibling nodes will be aligned first. Then the reads inside the contigs can be aligned using their positions inside the contig.
<fig id="btv231-F3" position="float"><label>Fig. 3.</label><caption><p>Two types of bifurcation where error correction is applied. (<bold>A</bold>) Multiple vertices sharing the same successor. (<bold>B</bold>) Multiple vertices sharing the same predecessor</p></caption><graphic xlink:href="btv231f3p"/></fig>
</p>
        <p>For each column in the read alignment, a base is corrected if it is overwhelmingly out-voted by other bases that are aligned to it. An assumption made here is, if a base is sequenced multiple times, it is correctly sequenced the majority of the time. A base <italic>a</italic> is corrected into <inline-formula><mml:math id="MM3"><mml:mrow><mml:mi>a</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>, if and only if the number of <inline-formula><mml:math id="MM4"><mml:mrow><mml:mi>a</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> is at least <italic>τ</italic> times more than the number of <italic>a</italic>. It is worth noting that this strategy could potentially incorrectly mutate bases from low abundance genes, since the number of those bases could be out-voted by bases from related and abundant genes. In order to make our tool more practically useful, we sacrifice some accuracy for assembly efficiency. The value of <italic>τ</italic> is customizable so the user can change the strictness of error correction in different datasets by adjusting the value of <italic>τ</italic>. A larger <italic>τ</italic> tends to yield more conserved error correction. A smaller <italic>τ</italic> tends to correct more erroneous bases, but may also falsely modify correct bases into incorrect ones, especially in regions with low coverage.</p>
        <p>An example is depicted in <xref ref-type="fig" rid="btv231-F4">Figure 4</xref>. Sequences represented in vertices <italic>V</italic><sub>2</sub> and <italic>V</italic><sub>3</sub> are very similar and only differ in one base. The bifurcation may be caused by sequencing error or simply represent similar regions from highly related species. Reads in both vertices are aligned. In the highlighted column, the number of base <italic>T</italic> in <italic>V</italic><sub>3</sub> is far less than that of the base <italic>A</italic> in <italic>V</italic><sub>2</sub>, so we mutate the <italic>T</italic> into <italic>A</italic> then merge <italic>V</italic><sub>2</sub> and <italic>V</italic><sub>3</sub> in to a single vertex.
<fig id="btv231-F4" position="float"><label>Fig. 4.</label><caption><p>An example of error correction (applied on <italic>V</italic><sub>2</sub> and <italic>V</italic><sub>3</sub>). The sequence represented by each node is given beside the node. (<bold>A</bold>) Ungapped alignment of reads from bifurcating vertices. (<bold>B</bold>) Mutate rare bases. (<bold>C</bold>) Remove bifurcation</p></caption><graphic xlink:href="btv231f4p"/></fig>
</p>
      </sec>
      <sec id="SEC2.3.3">
        <title>2.3.3 Topology-based graph reduction</title>
        <p>Alignment-based error correction is only applied to nodes sharing the same predecessor or successor. Following the existing assembly methods (<xref rid="btv231-B39" ref-type="bibr">Zerbino and Birney, 2008</xref>), we conduct topology-based graph reduction and remove tips and bubbles. Similar to the bifurcation removal procedure, the tip and bubble removal could potentially remove contigs from low abundance genes. So we also allow the thresholds used in this step to be adjusted by users.</p>
      </sec>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 Bad edge removal</title>
      <p>Due to the nature of metagenomic datasets, there may exist multiple species with very high sequence similarity. Thus, reads originating from different species have high chance to form edges in the graph. In another word, having suffix-prefix match does not necessarily guarantee correct connection. Wrong edges not only increase the complexity of graph but also lead to chimera.</p>
      <p>Thus after graph reduction, we applied a Naive Bayes Classifier, similarly to the RDP classifier (<xref rid="btv231-B34" ref-type="bibr">Wang <italic>et al.</italic>, 2007</xref>), on each vertex and approximately annotate it with one or more genera. If the vertices on either end of an edge do not share any common annotated genus, we regard it as a ‘bad’ edge and remove it. Annotation of each vertex can be obtained by calculating a posterior probability <inline-formula><mml:math id="MM5"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic>C</italic> is the contig that the vertex represents and <italic>G<sub>i</sub></italic> represents a genus. The probability indicates the likelihood that <italic>C</italic> originated from <italic>G<sub>i</sub></italic>. If the probability is higher than a threshold, we annotate <italic>C</italic> with <italic>G<sub>i</sub></italic>. To calculate <inline-formula><mml:math id="MM6"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we first decompose the contig <italic>C</italic> into a set of k-mers <inline-formula><mml:math id="MM7"><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Same as the RDP classifier, the default value of k is 8. Then <inline-formula><mml:math id="MM8"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> can be extended as <inline-formula><mml:math id="MM9"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Assuming the independence of <italic>k<sub>i</sub></italic> as in the Naive Bayes Classifier, we can further simplify the likelihood to <inline-formula><mml:math id="MM10"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>⋯</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, in which each term can be pre-calculated based on the RDP database (<xref rid="btv231-B7" ref-type="bibr">Cole <italic>et al.</italic>, 2005</xref>). The prior probability <inline-formula><mml:math id="MM11"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> can also be calculated as the proportion of sequences in <italic>G<sub>i</sub></italic> to the total number of sequences in the RDP database. The posterior probability <inline-formula><mml:math id="MM12"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>C</mml:mi><mml:mo>|</mml:mo><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, which indicates the likelihood that <italic>C</italic> does not originate from <italic>G<sub>i</sub></italic>, can also be calculated in the same way. The detailed steps are listed in <xref ref-type="fig" rid="btv231-F5">Figure 5</xref>.
<fig id="btv231-F5" position="float"><label>Fig. 5.</label><caption><p>The detailed calculation of the probability that a contig <italic>C</italic> originated from a genus <italic>G<sub>i</sub></italic></p></caption><graphic xlink:href="btv231f5p"/></fig>
</p>
      <p>For a vertex, a genus <italic>G<sub>i</sub></italic> is included into its annotation if <inline-formula><mml:math id="MM13"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is greater than a threshold. As most vertices in the graphs represent only short and partial 16S genes, the classifier may not have enough evidence to uniquely and accurately annotate them. As a result, each vertex is generally associated with multiple genera. Yet, base on our observation, the annotation always includes the true positive genus. The edge removal algorithm works better on longer sequences. Thus, it is iteratively applied after graph reduction and node collapsing, as shown in <xref ref-type="fig" rid="btv231-F2">Figure 2</xref>.</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Guided path finding using paired-end information</title>
      <p>We then recover 16S rRNA sequences by finding paths that represent a full or partial rRNA gene. Path finding starts at a vertex with no incoming edge and terminates at a vertex with no outgoing edge. Paired-end information of reads are widely used in many assembly tools for guiding the creation of contigs (<xref rid="btv231-B40" ref-type="bibr">Zhang <italic>et al.</italic>, 2014</xref>) or scaffolds. The rationale is that the two ends of a read pair should be assembled in the same contig or scaffold. To utilize the paired-end information, a common approach adopted by SOAPdenovo (<xref rid="btv231-B17" ref-type="bibr">Li <italic>et al.</italic>, 2010</xref>), ABySS (<xref rid="btv231-B30" ref-type="bibr">Simpson <italic>et al.</italic>, 2009</xref>) and ALLPATHS (<xref rid="btv231-B4" ref-type="bibr">Butler <italic>et al.</italic>, 2008</xref>) creates graphs from a set of contigs where each vertex represents a contig and an edge is formed between two vertices if more than a certain number of read pairs exist between their reads. Then the graphs are searched, using various constraints and heuristics, to extend contigs into longer scaffolds. Velvet (<xref rid="btv231-B39" ref-type="bibr">Zerbino and Birney, 2008</xref>), on the other hand, assumes a small variance of insert size distribution and aims to create ‘long nodes’ that are longer than all inserts. The objective function intends to maximize the number of ‘long nodes’ while minimizing the number of read pairs spanning over such nodes. As an extension of Velvet, MetaVelvet (<xref rid="btv231-B21" ref-type="bibr">Namiki <italic>et al.</italic>, 2012</xref>) uses paired-end information to guide the creation of contigs by checking their consistency. The number of paired-end reads connecting the origin node and the extension node is used to resolve chimeric node candidates.</p>
      <p>In our algorithm, we use paired-end information to guide the path finding and scaffolding. At each vertex with multiple successors, we decide which one to include based on a new metric, WPEMS, which gives higher weights to paired-end reads located in distant nodes than those located in nearby nodes. Let <inline-formula><mml:math id="MM14"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be a mate pair located in vertices <italic>V</italic> and <inline-formula><mml:math id="MM15"><mml:mrow><mml:mi>V</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> (<inline-formula><mml:math id="MM16"><mml:mrow><mml:mi>V</mml:mi><mml:mo>≠</mml:mo><mml:mi>V</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>), respectively. The WPEMS of this read pair is thus <inline-formula><mml:math id="MM17"><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>, where <inline-formula><mml:math id="MM18"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the number of vertices between <italic>V</italic> and <inline-formula><mml:math id="MM19"><mml:mrow><mml:mi>V</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>. If <inline-formula><mml:math id="MM20"><mml:mrow><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>, we define its WPEMS as 0. The WPEMS of a path <italic>P</italic> is the sum of WPEMS of all paired end reads in <italic>P</italic>.
<disp-formula><mml:math id="MM21"><mml:mrow><mml:mtext>WPEMS</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula>
</p>
      <p>When deciding among a set of vertices to visit next, we select the vertex that maximizes the WPEMS of the current path in a greedy way. The rationale behind the design of WPEMS is that only read pairs existing in non-adjacent vertices provide extra evidence for path finding. Read pairs included in the same vertex or spanning adjacent vertices do not provide additional path finding information beyond the existing overlap graph. In practice, the graph pruning procedure (<xref ref-type="fig" rid="btv231-F2">Fig. 2</xref>) leads to many vertices representing relatively long contigs. Thus, for average fragment sizes such as hundreds of bases, the paired-end reads usually exist within the same vertex or vertices already connected by an edge. <xref ref-type="fig" rid="btv231-F6">Figure 6</xref> describes a typical example of read pair distribution in a graph. There are usually many paired-end reads spanning adjacent vertices such as from <italic>n</italic><sub>6</sub> to <italic>n</italic><sub>8</sub>. Many fewer paired-end reads span non-adjacent vertices, such as those from <italic>n</italic><sub>1</sub> to <italic>n</italic><sub>7</sub> and from <italic>n</italic><sub>4</sub> to <italic>n</italic><sub>7</sub>. Paired-end reads located in two adjacent nodes have WPEMS of 1, because there is no intermediate node between the adjacent nodes.
<fig id="btv231-F6" position="float"><label>Fig. 6.</label><caption><p>Path finding using paired-end information. Solid lines represent overlaps between nodes and dashed lines represent the existence of paired-end reads. The numbers beside dashed lines are the numbers of paired end reads between the corresponding nodes</p></caption><graphic xlink:href="btv231f6p"/></fig>
</p>
      <p>We use the example in <xref ref-type="fig" rid="btv231-F6">Figure 6</xref> to explain our path finding procedure. Nodes in the graph are formed by reads from two different 16S rRNA genes A and B, colored in blue and yellow, respectively. Nodes <italic>n</italic><sub>3</sub> and <italic>n</italic><sub>6</sub> are represented using shaded color since they are formed by reads from common regions of A and B. Genes A and B are represented by <inline-formula><mml:math id="MM22"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>7</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM23"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>6</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>8</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, respectively. Suppose the path finding process has successfully identified the path <inline-formula><mml:math id="MM24"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>3</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>4</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mn>6</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>, which is highlighted in yellow, and needs to choose between <italic>n</italic><sub>7</sub> and <italic>n</italic><sub>8</sub> as the next node to include. By choosing <italic>n</italic><sub>7</sub>, the increased score is <inline-formula><mml:math id="MM25"><mml:mrow><mml:mn>8</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mn>3</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>12</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>11</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mn>1</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>30</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mn>0</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>164</mml:mn></mml:mrow></mml:math></inline-formula>. By choosing <italic>n</italic><sub>8</sub>, the score is <inline-formula><mml:math id="MM26"><mml:mrow><mml:mn>15</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mn>70</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mn>0</mml:mn></mml:msup><mml:mo>=</mml:mo><mml:mn>130</mml:mn></mml:mrow></mml:math></inline-formula>. Thus, WPEMS will choose <italic>n</italic><sub>7</sub>, the correct node, because of more paired-end reads shared between non-adjacent nodes.</p>
      <p>In order to produce all 16S ribosomal RNA sequences, we apply the path finding algorithm on each vertex with no incoming edge. If the length of a contig represented by a path is greater than a user-defined threshold, we consider the contig to be a full-length gene. Otherwise, we include it in the input to the next scaffolding stage. As this approach is a greedy algorithm, the time complexity is very low. The entire path finding procedure take <italic>O(mn)</italic> time to complete, where <italic>m</italic> is the average out-degree of each vertex and <italic>n</italic> is the average distance between nodes with no incoming edge and nodes with no outgoing edge.</p>
    </sec>
    <sec id="SEC2.6">
      <title>2.6 Scaffolding 16S rRNA segments</title>
      <p>In the path finding stage, contigs longer than a user-defined parameter <italic>L</italic>, are output directly. Contigs shorter than <italic>L</italic> are selected for further processing. Short contigs are usually created due to regionally low coverage of rRNA genes in metagenomic data. Reads from lowly sequenced regions failed to create connection to other region due to small overlap. As a result, rRNA segments originating from the same gene may be broken apart. To produce full-length rRNA sequences, we can utilize the WPEMS, with a minor modification, to scaffold shorter segments. First, as we know the orientation and alignment position of each read on the CM during the homology search, we can infer the orientation and alignment position of each contig based on the contained reads. Then, for two segments <italic>S<sub>A</sub></italic> and <italic>S<sub>B</sub></italic> with <italic>S<sub>A</sub></italic> being in the upstream of <italic>S<sub>B</sub></italic> (<xref ref-type="fig" rid="btv231-F7">Fig. 7</xref>), the WPEMS between <italic>S<sub>A</sub></italic> and <italic>S<sub>B</sub></italic> is defined as
<disp-formula><mml:math id="MM27"><mml:mrow><mml:mtext>WPEMS</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:math></disp-formula>
where <inline-formula><mml:math id="MM28"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a mate pair. <italic>r</italic> and <inline-formula><mml:math id="MM29"><mml:mrow><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula> are in <italic>S<sub>A</sub></italic> and <italic>S<sub>B</sub></italic>, respectively. As we have no information about the gap between <italic>S<sub>A</sub></italic> and <italic>S<sub>B</sub></italic>, we define <inline-formula><mml:math id="MM30"><mml:mrow><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>,</mml:mo><mml:mi>r</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as the total number of vertices after <italic>r</italic> and before <inline-formula><mml:math id="MM31"><mml:mrow><mml:mi>r</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:math></inline-formula>, in <italic>S<sub>A</sub></italic> and <italic>S<sub>B</sub></italic>, respectively. An example is given in <xref ref-type="fig" rid="btv231-F7">Figure 7</xref>.
<fig id="btv231-F7" position="float"><label>Fig. 7.</label><caption><p>Calculate the score between two segments. Arcs indicate existence of paired-end reads between vertices. Thickness of arcs indicate weight of the paired-end match. Actual weights are labeled beside each arc. Assuming there is only one mate-pair among contigs, the WPEMS is 22</p></caption><graphic xlink:href="btv231f7p"/></fig>
</p>
      <p>We only calculate <inline-formula><mml:math id="MM32"><mml:mrow><mml:mtext>WPEMS</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> if <italic>S<sub>A</sub></italic> is on the upstream of <italic>S<sub>B</sub></italic> and their CM alignment position overlap. If <italic>S<sub>A</sub></italic> and <italic>S<sub>B</sub></italic> are from the same gene, <inline-formula><mml:math id="MM33"><mml:mrow><mml:mtext>WPEMS</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> tends to be the highest among all <inline-formula><mml:math id="MM34"><mml:mrow><mml:mtext>WPEMS</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="MM35"><mml:mrow><mml:mtext>WPEMS</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. So we calculate the pair-wise WPEMS in all segments. We then connect <italic>S<sub>A</sub></italic> and <italic>S<sub>B</sub></italic>, if
<disp-formula><mml:math id="MM36"><mml:mrow><mml:mtext>WPEMS </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mtext>WPEMS </mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>A</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>
</p>
      <p>
        <inline-formula>
          <mml:math id="MM37">
            <mml:mrow>
              <mml:mtext>for all </mml:mtext>
              <mml:msub>
                <mml:mi>S</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:msub>
              <mml:mtext> on the downstream of </mml:mtext>
              <mml:msub>
                <mml:mi>S</mml:mi>
                <mml:mi>A</mml:mi>
              </mml:msub>
              <mml:mo>,</mml:mo>
              <mml:mtext> and</mml:mtext>
            </mml:mrow>
          </mml:math>
        </inline-formula>
        <disp-formula>
          <mml:math id="MM38">
            <mml:mrow>
              <mml:mtext>WPEMS</mml:mtext>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:msub>
                <mml:mi>S</mml:mi>
                <mml:mi>A</mml:mi>
              </mml:msub>
              <mml:mo>,</mml:mo>
              <mml:msub>
                <mml:mi>S</mml:mi>
                <mml:mi>B</mml:mi>
              </mml:msub>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>&gt;</mml:mo>
              <mml:mtext>WPEMS</mml:mtext>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:msub>
                <mml:mi>S</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:msub>
              <mml:mo>,</mml:mo>
              <mml:msub>
                <mml:mi>S</mml:mi>
                <mml:mi>B</mml:mi>
              </mml:msub>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <inline-formula>
          <mml:math id="MM39">
            <mml:mrow>
              <mml:mtext>for all </mml:mtext>
              <mml:msub>
                <mml:mi>S</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:msub>
              <mml:mtext> on the upstream of </mml:mtext>
              <mml:msub>
                <mml:mi>S</mml:mi>
                <mml:mi>B</mml:mi>
              </mml:msub>
            </mml:mrow>
          </mml:math>
        </inline-formula>
      </p>
      <p>All connected segments with total length longer than <italic>L</italic> will be output.</p>
    </sec>
  </sec>
  <sec id="SEC3">
    <title>3 Experimental results</title>
    <p>To evaluate the performance of our algorithm, we applied REAGO to a simulated metagenomic dataset and a mock community dataset. As the species and their genomes are largely known in the two datasets, we are able to evaluate the accuracy of rRNA assembly. We benchmarked our tool with EMIRGE, a 16S rRNA identification tool, and two popular metagenomic assembly tools, IDBA-UD (<xref rid="btv231-B24" ref-type="bibr">Peng <italic>et al.</italic>, 2012</xref>) and MetaVelvet (<xref rid="btv231-B21" ref-type="bibr">Namiki <italic>et al.</italic>, 2012</xref>). We also compared the performance of the three tools on two sets of inputs, the entire datasets and only true positive reads (i.e. reads sequenced from 16S rRNA genes). For all the tools, we evaluated their performance to reconstruct 16S rRNA sequences at sequence-level and genus-level. We also recorded and compared their running time on the same high performance computing node with a 64-bit CPU and Linux operating system. The detailed commands, parameters and output can be found along with the source code of REAGO.</p>
    <sec id="SEC3.1">
      <title>3.1 Experiment 1: simulated metagenomic dataset</title>
      <p>To evaluate the performance of REAGO, we first applied it to a simulated metagenomic dataset containing reads from 11 species of 8 genera. We used WGSIM (<xref rid="btv231-B16" ref-type="bibr">Li, 2011</xref>) to generate 9.6e+7 paired-end, 110 nt long error-containing reads. The sequencing error rate was set to 2% by default and the insert size was set to 320 with a standard deviation of 10 bases. The relative abundance of the 11 species is shown in <xref ref-type="table" rid="btv231-T1">Table 1</xref>. The most abundant species is 11 times more abundant than the least abundant species.
<table-wrap id="btv231-T1" position="float"><label>Table 1.</label><caption><p>Species abundance</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Species</th><th rowspan="1" colspan="1">Abundance (%)</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1"><italic>Bacteroides thetaiotaomicron</italic> VPI-5482 (BTV)</td><td align="char" char="." rowspan="1" colspan="1">24.17</td></tr><tr><td rowspan="1" colspan="1"><italic>Bacteroides vulgatus</italic> (BVG)</td><td align="char" char="." rowspan="1" colspan="1">4.13</td></tr><tr><td rowspan="1" colspan="1"><italic>Chlorobium phaeobacteroides</italic> DSM 266 (CPB)</td><td align="char" char="." rowspan="1" colspan="1">10.02</td></tr><tr><td rowspan="1" colspan="1"><italic>Chlorobium phaeovibrioides</italic> DSM 265 (CPV)</td><td align="char" char="." rowspan="1" colspan="1">6.29</td></tr><tr><td rowspan="1" colspan="1"><italic>Chlorobium tepidum</italic> TLS (CTT)</td><td align="char" char="." rowspan="1" colspan="1">12.38</td></tr><tr><td rowspan="1" colspan="1"><italic>Salinispora tropica</italic> CNB-440 (STC)</td><td align="char" char="." rowspan="1" colspan="1">1.96</td></tr><tr><td rowspan="1" colspan="1"><italic>Sulfurihydrogenibium</italic> sp YO3AOP1 (SSY)</td><td align="char" char="." rowspan="1" colspan="1">4.72</td></tr><tr><td rowspan="1" colspan="1"><italic>Bordetella bronchiseptica</italic> RB50 (BBR)</td><td align="char" char="." rowspan="1" colspan="1">7.86</td></tr><tr><td rowspan="1" colspan="1"><italic>Burkholderia xenovorans</italic> LB400 (BXL)</td><td align="char" char="." rowspan="1" colspan="1">10.02</td></tr><tr><td rowspan="1" colspan="1"><italic>Leptothrix cholodnii</italic> SP-6 (LCS)</td><td align="char" char="." rowspan="1" colspan="1">4.72</td></tr><tr><td rowspan="1" colspan="1"><italic>Nitrosomonas europaea</italic> ATCC 19718 (NEA)</td><td align="char" char="." rowspan="1" colspan="1">13.75</td></tr></tbody></table></table-wrap></p>
      <p>To challenge REAGO, we selected some closely related species in the same genus with highly similar 16S rRNA genes. We listed their pair-wise sequence similarity in <xref ref-type="table" rid="btv231-T2">Table 2</xref>. For example, three selected species in <italic>Chlorobium</italic> share sequence identity above 93%. <italic>Chlorobium phaeobacteroides</italic> and <italic>Chlorobium phaeovibrioides</italic> even share similarity as high as 96%. Reads simulated from these species tend to produce extremely tangled overlap graphs that pose challenges for assembly. Traversing such graphs will result in a large number of paths, and most of which represent chimeric assemblies.
<table-wrap id="btv231-T2" position="float"><label>Table 2.</label><caption><p>Pair-wise sequence similarity</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">BBR</th><th rowspan="1" colspan="1">BTV</th><th rowspan="1" colspan="1">BVG</th><th rowspan="1" colspan="1">BXL</th><th rowspan="1" colspan="1">CPB</th><th rowspan="1" colspan="1">CPV</th><th rowspan="1" colspan="1">CTT</th><th rowspan="1" colspan="1">LCS</th><th rowspan="1" colspan="1">NEA</th><th rowspan="1" colspan="1">SSY</th><th rowspan="1" colspan="1">STC</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">BBR</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td></tr><tr><td rowspan="1" colspan="1">BTV</td><td align="char" char="." rowspan="1" colspan="1">71</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td></tr><tr><td rowspan="1" colspan="1">BVG</td><td align="char" char="." rowspan="1" colspan="1">71</td><td align="char" char="." rowspan="1" colspan="1"><bold>91</bold></td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td></tr><tr><td rowspan="1" colspan="1">BXL</td><td align="char" char="." rowspan="1" colspan="1"><bold>91</bold></td><td align="char" char="." rowspan="1" colspan="1">72</td><td align="char" char="." rowspan="1" colspan="1">71</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td></tr><tr><td rowspan="1" colspan="1">CPB</td><td align="char" char="." rowspan="1" colspan="1">76</td><td align="char" char="." rowspan="1" colspan="1">75</td><td align="char" char="." rowspan="1" colspan="1">75</td><td align="char" char="." rowspan="1" colspan="1">75</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td></tr><tr><td rowspan="1" colspan="1">CPV</td><td align="char" char="." rowspan="1" colspan="1">75</td><td align="char" char="." rowspan="1" colspan="1">75</td><td align="char" char="." rowspan="1" colspan="1">75</td><td align="char" char="." rowspan="1" colspan="1">74</td><td align="char" char="." rowspan="1" colspan="1"><bold>96</bold></td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td></tr><tr><td rowspan="1" colspan="1">CTT</td><td align="char" char="." rowspan="1" colspan="1">75</td><td align="char" char="." rowspan="1" colspan="1">75</td><td align="char" char="." rowspan="1" colspan="1">74</td><td align="char" char="." rowspan="1" colspan="1">74</td><td align="char" char="." rowspan="1" colspan="1"><bold>93</bold></td><td align="char" char="." rowspan="1" colspan="1"><bold>94</bold></td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td></tr><tr><td rowspan="1" colspan="1">LCS</td><td align="char" char="." rowspan="1" colspan="1"><bold>90</bold></td><td align="char" char="." rowspan="1" colspan="1">73</td><td align="char" char="." rowspan="1" colspan="1">72</td><td align="char" char="." rowspan="1" colspan="1"><bold>90</bold></td><td align="char" char="." rowspan="1" colspan="1">76</td><td align="char" char="." rowspan="1" colspan="1">77</td><td align="char" char="." rowspan="1" colspan="1">76</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td></tr><tr><td rowspan="1" colspan="1">NEA</td><td align="char" char="." rowspan="1" colspan="1">88</td><td align="char" char="." rowspan="1" colspan="1">73</td><td align="char" char="." rowspan="1" colspan="1">72</td><td align="char" char="." rowspan="1" colspan="1">89</td><td align="char" char="." rowspan="1" colspan="1">75</td><td align="char" char="." rowspan="1" colspan="1">75</td><td align="char" char="." rowspan="1" colspan="1">74</td><td align="char" char="." rowspan="1" colspan="1">86</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td></tr><tr><td rowspan="1" colspan="1">SSY</td><td align="char" char="." rowspan="1" colspan="1">73</td><td align="char" char="." rowspan="1" colspan="1">72</td><td align="char" char="." rowspan="1" colspan="1">72</td><td align="char" char="." rowspan="1" colspan="1">73</td><td align="char" char="." rowspan="1" colspan="1">73</td><td align="char" char="." rowspan="1" colspan="1">73</td><td align="char" char="." rowspan="1" colspan="1">73</td><td align="char" char="." rowspan="1" colspan="1">74</td><td align="char" char="." rowspan="1" colspan="1">74</td><td align="char" char="." rowspan="1" colspan="1">-</td><td align="char" char="." rowspan="1" colspan="1">-</td></tr><tr><td rowspan="1" colspan="1">STC</td><td align="char" char="." rowspan="1" colspan="1">76</td><td align="char" char="." rowspan="1" colspan="1">72</td><td align="char" char="." rowspan="1" colspan="1">71</td><td align="char" char="." rowspan="1" colspan="1">76</td><td align="char" char="." rowspan="1" colspan="1">77</td><td align="char" char="." rowspan="1" colspan="1">77</td><td align="char" char="." rowspan="1" colspan="1">76</td><td align="char" char="." rowspan="1" colspan="1">77</td><td align="char" char="." rowspan="1" colspan="1">76</td><td align="char" char="." rowspan="1" colspan="1">76</td><td align="char" char="." rowspan="1" colspan="1">-</td></tr></tbody></table><table-wrap-foot><fn id="btv231-TF1"><p>Bold numbers indicate sequence similarity above 90%.</p></fn></table-wrap-foot></table-wrap></p>
      <sec id="SEC3.1.1">
        <title>3.1.1 Performance of rRNA reads classification</title>
        <p>Following the pipeline in <xref ref-type="fig" rid="btv231-F1">Figure 1</xref>, we applied cmsearch, CM alignment program in Infernal to identify reads originating from rRNA genes. When building the CM for cmsearch, we only used rRNA genes that are not in the simulated dataset. Specifically, we downloaded 2591 bacterial 16S rRNA genes from the RDP website (<xref rid="btv231-B7" ref-type="bibr">Cole <italic>et al.</italic>, 2005</xref>). Then we removed the rRNA genes in the 11 species used for simulation and also the ones in the same genera as those 11 species. As a result, we have 2537 genes in the training set for building the CM in cmsearch. The performance of cmsearch is quantified using two metrics: sensitivity and positive predictive value (PPV). The set of reads sequenced from 16S rRNA genes are true positive (i.e. TP) while the set of reads extracted from other regions are true negative. Let <italic>P</italic> be the set of reads predicted as positive by cmsearch. We thus have
<disp-formula><mml:math id="MM40"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mtext>sensitivity</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>∩</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mi>P</mml:mi><mml:mi>V</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mo>∩</mml:mo><mml:mi>T</mml:mi><mml:mi>P</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
</p>
        <p>It is worth noting that we only keep reads that can be globally aligned to CM. For reads that are partially sequenced from the rRNA genes and thus produce partial or local alignments, we don’t keep them for downstream analysis. Correspondingly, during the performance evaluation, we only use reads that are completely sequenced from the rRNA genes and non-rRNA regions. Reads sequenced from boundaries of rRNA genes will not be used for computation. For this simulated dataset, the sensitivity and PPV of cmsearch in recognizing rRNA reads are both 0.990. Reads originating from 16S rRNA genes were precisely separated from those from other regions of genomes with only a small amount of incorrectly classified reads. The output of cmsearch contains 82 638 reads, which are used as input for overlap graph construction. Compared with the original size of the dataset (9.6e7 reads), the problem size is significantly reduced.</p>
      </sec>
      <sec id="SEC3.1.2">
        <title>3.1.2 Overlap graph construction</title>
        <p>The reads classified as rRNA reads by cmsearch were used as input to Readjoiner for efficient overlap graph construction. By default, the overlap threshold was set to 70% of the read length, which is 77 in the simulated dataset. A larger overlap may be used when sequencing depth is high for each species, while smaller overlap should be used if some low abundance species are present. A smaller overlap, however, tends to yield more tangled graphs. We have tried a range of overlaps from 66 to 99. The results are almost identical on the simulated dataset. The default error correction threshold <italic>τ</italic> was set to 50, indicating that a base will be corrected if at least 50 bases of a different kind are aligned to it.</p>
        <p>We evaluated the efficiency of our error correction and graph reduction algorithms using the change of graph complexity, which is quantified by the total number of paths in the graph. The increase of the number of different paths implies the increase of the graph complexity. We only record ‘complete’ paths that start at nodes with no incoming edge and end at nodes with no outgoing edges. The original graph contains 16 994 765 paths. After applying our graph reduction procedures, the graph is significantly simplified, containing only 961 paths. As shown by the assembly results presented in the following section, a majority of the genes have been kept in the reduced graph.</p>
      </sec>
      <sec id="SEC3.1.3">
        <title>3.1.3 Assembly</title>
        <p>Finally, we evaluated the performance of our assembly algorithms and compared it with EMIRGE, IDBA-UD and MetaVelvet. Metrics used are the number of genes recovered at sequence level, the number of genera recovered, the number of falsely recovered genes, and the running time. For all tools, all contigs or super-contigs longer than 1350 nts are considered to be final output. An assembly is considered to be correct at sequence level if and only if it can be aligned to the true gene with at least 98% identity by BLAST. A genus is correctly recovered as long as one of its genes is recovered.</p>
        <p>For EMIRGE we did two experiments using two different rRNA gene databases. The first one is its original small subunit ribosomal RNA (SSU) candidate database excluding just the 11 training genes. Similar to the method of constructing the training set for the CM in REAGO, the second one uses the original database excluding all genes in the eight selected genera. All parameters of IDBA-UD were set as default. For MetaVelvet, we followed the recommendation in its tutorial and used k-mer size of 55.</p>
        <p>As displayed in <xref ref-type="table" rid="btv231-T3">Table 3</xref>, our assembly algorithms demonstrate better performance in reconstructing 16S rRNA genes. EMIRGE achieved the same sensitivity as our tool with the first database. But it took much longer running time. For the second database, which excluded all genes in the eight chosen genera as the training set for our tool, it recovered many fewer genes. Thus, if a genus in a metagenomic dataset does not exist in the SSU candidate database at all, it is possible that the genes from this genus cannot be recovered. IDBA-UD was correct only on three genes and MetaVelvet only identified one. The results show that generic <italic>de novo</italic> assembly tools are not optimized for recovering 16S rRNA genes and thus are not recommended for this task.
<table-wrap id="btv231-T3" position="float"><label>Table 3.</label><caption><p>Performance of 16S rRNA gene recovery</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Tool</th><th rowspan="1" colspan="1"># output genes</th><th rowspan="1" colspan="1"># genes recovered</th><th rowspan="1" colspan="1"># genera recovered</th><th rowspan="1" colspan="1"># incorrect assemblies</th><th rowspan="1" colspan="1">Running time</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">REAGO</td><td align="char" char="." rowspan="1" colspan="1">12</td><td align="center" rowspan="1" colspan="1">11/11</td><td align="center" rowspan="1" colspan="1">8/8</td><td align="char" char="." rowspan="1" colspan="1">1</td><td rowspan="1" colspan="1">4:53:19</td></tr><tr><td rowspan="1" colspan="1">EMIRGE, 16S DB, excluding the 11 genes</td><td align="char" char="." rowspan="1" colspan="1">16</td><td align="center" rowspan="1" colspan="1">10/11</td><td align="center" rowspan="1" colspan="1">7/8</td><td align="char" char="." rowspan="1" colspan="1">6</td><td rowspan="1" colspan="1">96:12:1</td></tr><tr><td rowspan="1" colspan="1">EMIRGE, 16S DB, excluding eight genera</td><td align="char" char="." rowspan="1" colspan="1">23</td><td align="center" rowspan="1" colspan="1">6/11</td><td align="center" rowspan="1" colspan="1">5/8</td><td align="char" char="." rowspan="1" colspan="1">17</td><td rowspan="1" colspan="1">96:14:29</td></tr><tr><td rowspan="1" colspan="1">IDBA-UD</td><td align="char" char="." rowspan="1" colspan="1">416</td><td align="center" rowspan="1" colspan="1">3/11</td><td align="center" rowspan="1" colspan="1">3/8</td><td align="char" char="." rowspan="1" colspan="1">413</td><td rowspan="1" colspan="1">16:36:28</td></tr><tr><td rowspan="1" colspan="1">MetaVelvet</td><td align="char" char="." rowspan="1" colspan="1">1 258</td><td align="center" rowspan="1" colspan="1">1/11</td><td align="center" rowspan="1" colspan="1">1/8</td><td align="char" char="." rowspan="1" colspan="1">1 257</td><td rowspan="1" colspan="1">5:35:30</td></tr></tbody></table><table-wrap-foot><fn id="btv231-TF2"><p>In all tables hereafter, ‘# output genes’ is the number of outputs longer than 1 350 nts. The CM used in REAGO is trained on 16S rRNA genes excluding all in the eight genera of the test data.</p></fn></table-wrap-foot></table-wrap></p>
        <p>The performance of REAGO heavily relies on two key steps: rRNA read homology search and <italic>de novo</italic> assembly. Our pipeline allows the users to replace the assembly component with other generic assembly tools or rRNA construction tools. To evaluate whether our assembly step contributes to the improvement of REAGO over other tools, we applied EMIRGE, IDBA-UD and MetaVelvet directly on true positive 16S reads. Compared to applying homology search to recognize rRNA reads, using only true positive rRNA reads ensures that the tested tools obtain the optimal rRNA assembly/construction results. As summarized in <xref ref-type="table" rid="btv231-T4">Table 4</xref>, even using this ideal input, the rRNA construction performance of the three tools are not better than REAGO (<xref ref-type="table" rid="btv231-T3">Table 3</xref>), demonstrating the advantages of the assembly stage of REAGO. <xref ref-type="table" rid="btv231-T4">Table 4</xref> also shows that the performance of all tools improve when using only rRNA reads as input. As expected, they all run significantly faster and produce fewer contigs. When using the database excluding 11 genes, EMIRGE achieves similar performance to REAGO, except outputting four more wrong assemblies. However, when excluding all genes in the eight genera as we did for REAGO, it is worse than REAGO.
<table-wrap id="btv231-T4" position="float"><label>Table 4.</label><caption><p>Performance of 16S rRNA gene recovery using only true positive reads as input</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Tool</th><th rowspan="1" colspan="1"># output genes</th><th rowspan="1" colspan="1"># genes recover</th><th rowspan="1" colspan="1"># genera recovered</th><th rowspan="1" colspan="1"># incorrect assemblies</th><th rowspan="1" colspan="1">Running time</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">REAGO</td><td align="char" char="." rowspan="1" colspan="1">12</td><td align="center" rowspan="1" colspan="1">11/11</td><td align="center" rowspan="1" colspan="1">8/8</td><td align="char" char="." rowspan="1" colspan="1">1</td><td align="center" rowspan="1" colspan="1">0:2:14</td></tr><tr><td rowspan="1" colspan="1">EMIRGE, 16S DB, excluding the 11 genes</td><td align="char" char="." rowspan="1" colspan="1">17</td><td align="center" rowspan="1" colspan="1">11/11</td><td align="center" rowspan="1" colspan="1">8/8</td><td align="char" char="." rowspan="1" colspan="1">5</td><td align="center" rowspan="1" colspan="1">0:13:01</td></tr><tr><td rowspan="1" colspan="1">EMIRGE, 16S DB, excluding the 8 genera</td><td align="char" char="." rowspan="1" colspan="1">21</td><td align="center" rowspan="1" colspan="1">7/11</td><td align="center" rowspan="1" colspan="1">6/8</td><td align="char" char="." rowspan="1" colspan="1">14</td><td align="center" rowspan="1" colspan="1">0:14:10</td></tr><tr><td rowspan="1" colspan="1">IDBA-UD</td><td align="char" char="." rowspan="1" colspan="1">3</td><td align="center" rowspan="1" colspan="1">3/11</td><td align="center" rowspan="1" colspan="1">3/8</td><td align="char" char="." rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">0:5:26</td></tr><tr><td rowspan="1" colspan="1">MetaVelvet</td><td align="char" char="." rowspan="1" colspan="1">1</td><td align="center" rowspan="1" colspan="1">1/11</td><td align="center" rowspan="1" colspan="1">1/8</td><td align="char" char="." rowspan="1" colspan="1">0</td><td align="center" rowspan="1" colspan="1">0:0:35</td></tr></tbody></table></table-wrap></p>
      </sec>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Experiment 2: synthetic metagenomic data</title>
      <p>To further assess the performance of our assembly algorithms, we applied REAGO to a metagenomic dataset (SRR606249) sequenced from an archaeal and bacterial synthetic community (<xref rid="btv231-B28" ref-type="bibr">Shakya <italic>et al.</italic>, 2013</xref>), which contains 16 archaeal species and 48 bacterial species, covering 50 different genera. The metagenomic dataset was sequenced using Illumina HiSeq-2000 and contains ∼11.1 Gbp in total. Reads in the dataset are all 101-base long and were sequenced in pairs. The annotations of 16S rRNA genes in these species were downloaded from NCBI. High sequence similarity exists among genes in the same genus and genes across different genera. For instance, species from <italic>Leptothrix</italic>, <italic>Bordetella</italic>, <italic>Burkholdera</italic> and <italic>Nitrosomonas</italic> share sequence similarity above 97%. Three species under <italic>Thermotoga</italic> share sequences similarity above 99%. Additionally, the abundance of species is more skewed in this dataset than in the first one. The most abundant species is over 20 times more abundant than the least abundant species.</p>
      <sec id="SEC3.2.1">
        <title>3.2.1 rRNA reads classification</title>
        <p>We applied cmsearch for rRNA homology search. As this dataset contains both archaeal and bacterial species, we trained two types of CMs using genes in archaeal and bacterial species, respectively. In addition, for each type of CM, we constructed two CMs using two training sets. The first CM was trained on all 16S genes from RDP excluding the exact copies of rRNA genes from the 64 species of the synthetic community. Next, we further removed all genes belonging to any of the 50 genera and trained the second CM. The read mapping results and the annotation of the 16S rRNA genes in the component genomes enable us to determine whether a read is part of an rRNA gene. In this dataset, there are 67 979 reads completely sequenced from rRNA genes. Based on the known origins of the reads, we can evaluate the performance of cmsearch on both CMs using sensitivity, PPV and running time. <xref ref-type="table" rid="btv231-T5">Table 5</xref> summarized the combined performance of the archaeal and bacterial models. cmsearch achieved both high sensitivity and PPV with both CMs. Removal of all genes in the 50 genera only slightly decreased the sensitivity and PPV. <xref ref-type="table" rid="btv231-T5">Table 5</xref> also shows the significant reduction in problem size by 99.87% (from 54 029 186 reads to less than 67 000 reads). The experiments were conducted using a 2.4 GHz CPU and 8 GB memory.
<table-wrap id="btv231-T5" position="float"><label>Table 5<bold>.</bold></label><caption><p>The performance of cmsearch on the synthetic community data</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">CM Training set</th><th rowspan="1" colspan="1">Training set size (# archaeal and bacterial genes)</th><th rowspan="1" colspan="1"># output reads</th><th rowspan="1" colspan="1">Sensitivity</th><th rowspan="1" colspan="1">PPV</th><th rowspan="1" colspan="1">Running time (the sum of archaeal and bacterial CMs)</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">RDP training set, excluding the 64 genes</td><td align="char" char="." rowspan="1" colspan="1">2 384</td><td align="char" char="." rowspan="1" colspan="1">66 755</td><td align="char" char="." rowspan="1" colspan="1">0.982</td><td align="char" char="." rowspan="1" colspan="1">0.962</td><td align="char" char="." rowspan="1" colspan="1">11:56:52</td></tr><tr><td rowspan="1" colspan="1">RDP training set, excluding the 50 genera</td><td align="char" char="." rowspan="1" colspan="1">2 325</td><td align="char" char="." rowspan="1" colspan="1">66 347</td><td align="char" char="." rowspan="1" colspan="1">0.976</td><td align="char" char="." rowspan="1" colspan="1">0.958</td><td align="char" char="." rowspan="1" colspan="1">12:21:32</td></tr></tbody></table></table-wrap></p>
      </sec>
      <sec id="SEC3.2.2">
        <title>3.2.2 Assembly</title>
        <p>Next, we applied our assembly algorithms on the reads that are classified as rRNA reads by cmsearch. The overlap threshold of REAGO was set to 70 (the default overlap threshold is 70% of the read length). The CM training sequences contained none of the 64 genes nor any gene from the 50 genera. We compared the performance of REAGO with EMIRGE, IDBA-UD and MetaVelvet. Parameters of IDBA-UD were all set as default. Following the recommendation of the tutorial, we run MetaVelvet using k-mer length 55. EMIRGE was run twice with two different 16S rRNA databases. The first one is its 16S rRNA database excluding only exact copies of the 64 genes, and the second one is its database excluding all genes in the 50 genera. For all tools, we only consider assemblies longer than 1350 nt as the final output.</p>
        <p>We summarized the results in <xref ref-type="table" rid="btv231-T6">Table 6</xref>. Our tool correctly recovered more genes and genera with far shorter running time. Even with all genes in the 50 genera removed from the training set of the CM, REAGO can recover 58 out of 64 genes and 47 out of 50 genera. For REAGO, most of the time was spent in running cmsearch and the actual assembly procedure finished within a couple of minutes. The filtration with cmsearch can be greatly accelerated when running in parallel. EMIRGE, on the other hand, recovered fewer genes and genera with longer running time. With the removal of all genes in the 50 genera, the performance of EMIRGE significantly deteriorated, indicating its limited ability to recover 16S genes from unknown genera.
<table-wrap id="btv231-T6" position="float"><label>Table 6.</label><caption><p>The performance of rRNA recovery on synthetic community data</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Tool</th><th rowspan="1" colspan="1"># output genes</th><th rowspan="1" colspan="1"># genes recovered</th><th rowspan="1" colspan="1"># genera recovered</th><th rowspan="1" colspan="1"># incorrect assemblies</th><th rowspan="1" colspan="1">Running time</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">REAGO</td><td align="char" char="." rowspan="1" colspan="1">59</td><td align="center" rowspan="1" colspan="1">58/64</td><td align="center" rowspan="1" colspan="1">47/50</td><td align="char" char="." rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">12:28:01</td></tr><tr><td rowspan="1" colspan="1">EMIRGE 16S DB, excluding the 64 genes</td><td align="char" char="." rowspan="1" colspan="1">76</td><td align="center" rowspan="1" colspan="1">42/64</td><td align="center" rowspan="1" colspan="1">33/50</td><td align="char" char="." rowspan="1" colspan="1">42</td><td rowspan="1" colspan="1">120:30:11</td></tr><tr><td rowspan="1" colspan="1">EMIRGE 16S DB, excluding the 50 genera</td><td align="char" char="." rowspan="1" colspan="1">105</td><td align="center" rowspan="1" colspan="1">19/64</td><td align="center" rowspan="1" colspan="1">16/50</td><td align="char" char="." rowspan="1" colspan="1">89</td><td rowspan="1" colspan="1">120:25:38</td></tr><tr><td rowspan="1" colspan="1">IDBA-UD</td><td align="char" char="." rowspan="1" colspan="1">61</td><td align="center" rowspan="1" colspan="1">39/64</td><td align="center" rowspan="1" colspan="1">33/50</td><td align="char" char="." rowspan="1" colspan="1">28</td><td rowspan="1" colspan="1">17:26:50</td></tr><tr><td rowspan="1" colspan="1">MetaVelvet</td><td align="char" char="." rowspan="1" colspan="1">135</td><td align="center" rowspan="1" colspan="1">4/64</td><td align="center" rowspan="1" colspan="1">4/50</td><td align="char" char="." rowspan="1" colspan="1">131</td><td rowspan="1" colspan="1">7:56:01</td></tr></tbody></table><table-wrap-foot><fn id="btv231-TF3"><p>‘# output genes’ is the number of outputs longer than 1 350 nts. The CM used in REAGO is trained on 16S rRNA genes excluding all in the 50 genera of the test data.</p></fn></table-wrap-foot></table-wrap></p>
        <p>It is worth noting that all tools may output highly similar but not identical sequences. Thus, multiple outputs may be mapped to the same rRNA gene with <inline-formula><mml:math id="MM41"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>98</mml:mn><mml:mi>%</mml:mi></mml:mrow></mml:math></inline-formula> identity. Meanwhile, some rRNA genes are highly similar and can be recovered by one assembly. Thus, in <xref ref-type="table" rid="btv231-T6">Tables 6</xref> and <xref ref-type="table" rid="btv231-T7">7</xref>, the sum of incorrect and correct assemblies may not be equal to the total number of output sequences.
<table-wrap id="btv231-T7" position="float"><label>Table 7.</label><caption><p>The performance of rRNA recovery on only true positive 16S rRNA reads from synthetic community data</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Tool</th><th rowspan="1" colspan="1"># output genes</th><th rowspan="1" colspan="1"># genes recovered</th><th rowspan="1" colspan="1"># genera recovered</th><th rowspan="1" colspan="1"># incorrect assemblies</th><th rowspan="1" colspan="1">Running time</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">REAGO</td><td align="char" char="." rowspan="1" colspan="1">59</td><td align="center" rowspan="1" colspan="1">58/64</td><td align="center" rowspan="1" colspan="1">47/50</td><td align="char" char="." rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">0:2:06</td></tr><tr><td rowspan="1" colspan="1">EMIRGE, 16S DB, excluding the 64 genes</td><td align="char" char="." rowspan="1" colspan="1">82</td><td align="center" rowspan="1" colspan="1">45/64</td><td align="center" rowspan="1" colspan="1">36/50</td><td align="char" char="." rowspan="1" colspan="1">45</td><td rowspan="1" colspan="1">0:52:19</td></tr><tr><td rowspan="1" colspan="1">EMIRGE, 16S DB, excluding the 50 genera</td><td align="char" char="." rowspan="1" colspan="1">103</td><td align="center" rowspan="1" colspan="1">25/64</td><td align="center" rowspan="1" colspan="1">20/50</td><td align="char" char="." rowspan="1" colspan="1">82</td><td rowspan="1" colspan="1">0:51:48</td></tr><tr><td rowspan="1" colspan="1">IDBA-UD</td><td align="char" char="." rowspan="1" colspan="1">60</td><td align="center" rowspan="1" colspan="1">41/64</td><td align="center" rowspan="1" colspan="1">34/50</td><td align="char" char="." rowspan="1" colspan="1">26</td><td rowspan="1" colspan="1">0:1:16</td></tr><tr><td rowspan="1" colspan="1">MetaVelvet</td><td align="char" char="." rowspan="1" colspan="1">65</td><td align="center" rowspan="1" colspan="1">16/64</td><td align="center" rowspan="1" colspan="1">16/50</td><td align="char" char="." rowspan="1" colspan="1">49</td><td rowspan="1" colspan="1">0:0:26</td></tr></tbody></table><table-wrap-foot><fn id="btv231-TF4"><p>‘# output genes’ is the number of outputs longer than 1 350 nts.</p></fn></table-wrap-foot></table-wrap></p>
        <p>Similar to the first experiment, we applied EMIRGE, IDBA-UD and MetaVelvet directly on true positive 16S reads. As summarized in <xref ref-type="table" rid="btv231-T7">Table 7</xref>, the number of recovered genes and genera increased for all tools. Additionally, running time of each tool was significantly reduced. Thus, using only ‘correct’ and relevant reads as input can improve the assembly performance. However, even with the ideal input, all the three tools recover fewer rRNA genes than REAGO, demonstrating the advantage of the assembly stage in REAGO.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion and conclusion</title>
    <p>We reported a set of algorithms, implemented as REAGO, to reconstruct 16S rRNA genes from metagenomic data. REAGO is able to accurately identify 16S rRNA from error-containing metagenomic datasets at sequence level. The algorithms are robust even if the genera of the underlying genes are not included in the CM training set. It can be readily applied to any metagnomic dataset containing paired-end reads. Several components in REAGO work better with increasing read length. In particular, the homology search stage and the bad edge removal part can all benefit from increased sequence length, which is the trend for next-generation sequencing technologies.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was partially supported by <funding-source>NSF CAREER</funding-source> Grant <award-id>DBI- 0953738</award-id>.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btv231-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Altschul</surname><given-names>S.F.</given-names></name><etal/></person-group><italic>.</italic> (<year>1990</year>) 
<article-title>Basic local alignment search tool</article-title>. <source>J. Mol. Biol.</source>, <volume>215</volume>, <fpage>403</fpage>–<lpage>410</lpage>.<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benson</surname><given-names>D.A.</given-names></name><etal/></person-group><italic>.</italic> (<year>2010</year>) 
<article-title>GenBank</article-title>. <source>Nucleic Acids Res.</source>, <volume>38</volume>, <fpage>D46</fpage>–<lpage>D51</lpage>.<pub-id pub-id-type="pmid">19910366</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berg</surname><given-names>R.D.</given-names></name></person-group> (<year>1996</year>) 
<article-title>The indigenous gastrointestinal microflora</article-title>. <source>Trends Microbiol.</source>, <volume>4</volume>, <fpage>430</fpage>–<lpage>435</lpage>.<pub-id pub-id-type="pmid">8950812</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Butler</surname><given-names>J.</given-names></name><etal/></person-group><italic>.</italic> (<year>2008</year>) 
<article-title>ALLPATHS: de novo assembly of whole-genome shotgun microreads</article-title>. <source>Genome Res.</source>, <volume>18</volume>, <fpage>810</fpage>–<lpage>820</lpage>.<pub-id pub-id-type="pmid">18340039</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Christen</surname><given-names>R.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Global sequencing: a review of current molecular data and new methods available to assess microbial diversity</article-title>. <source>Microbes Environ. JSME</source>, <volume>23</volume>, <fpage>253</fpage>–<lpage>268</lpage>.</mixed-citation>
    </ref>
    <ref id="btv231-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cochrane</surname><given-names>G.</given-names></name><etal/></person-group><italic>.</italic> (<year>2009</year>) 
<article-title>Petabyte-scale innovations at the European nucleotide archive</article-title>. <source>Nucleic Acids Res.</source>, <volume>37</volume>, <fpage>D19</fpage>–<lpage>D25</lpage>.<pub-id pub-id-type="pmid">18978013</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cole</surname><given-names>J.R.</given-names></name><etal/></person-group><italic>.</italic> (<year>2005</year>) 
<article-title>The Ribosomal Database Project (RDP-II): sequences and tools for high-throughput rRNA analysis</article-title>. <source>Nucleic Acids Res.</source>, <volume>33</volume> (<issue>Suppl. 1</issue>), <fpage>D294</fpage>–<lpage>D296</lpage>.<pub-id pub-id-type="pmid">15608200</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B8">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Durbin</surname><given-names>R.</given-names></name></person-group> (<year>1998</year>) <source>Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids</source><italic>.</italic>
<publisher-name>Cambridge University Press</publisher-name>, 
<publisher-loc>Cambridge, UK</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="btv231-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Fan</surname><given-names>L.</given-names></name><etal/></person-group><italic>.</italic> (<year>2012</year>) 
<article-title>Reconstruction of ribosomal RNA genes from metagenomic data</article-title>. <source>PloS One</source>, <volume>7</volume>, <fpage>e39948</fpage>.<pub-id pub-id-type="pmid">22761935</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gonnella</surname><given-names>G.</given-names></name><name><surname>Kurtz</surname><given-names>S.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Readjoiner: a fast and memory efficient string graph-based sequence assembler</article-title>. <source>BMC Bioinformatics</source>, <volume>13</volume>, <fpage>82</fpage>.<pub-id pub-id-type="pmid">22559072</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hamady</surname><given-names>M.</given-names></name><name><surname>Knight</surname><given-names>R.</given-names></name></person-group> (<year>2009</year>) 
<article-title>Microbial community profiling for human microbiome projects: tools, techniques, and challenges</article-title>. <source>Genome Res.</source>, <volume>19</volume>, <fpage>1141</fpage>–<lpage>1152</lpage>.<pub-id pub-id-type="pmid">19383763</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jeffrey</surname><given-names>A.M.</given-names></name><name><surname>Zhong</surname><given-names>W.</given-names></name></person-group> (<year>2011</year>) 
<article-title>Next-generation transcriptome assembly</article-title>. <source>Nat. Rev. Genet.</source>, <volume>12</volume>, <fpage>671</fpage>–<lpage>682</lpage>.<pub-id pub-id-type="pmid">21897427</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kolbe</surname><given-names>D.L.</given-names></name><name><surname>Eddy</surname><given-names>S.R.</given-names></name></person-group> (<year>2009</year>) 
<article-title>Local RNA structure alignment with incomplete sequence</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1236</fpage>–<lpage>1243</lpage>.<pub-id pub-id-type="pmid">19304875</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Konings</surname><given-names>W.N.</given-names></name><etal/></person-group><italic>.</italic> (<year>2002</year>) 
<article-title>The cell membrane plays a crucial role in survival of bacteria and archaea in extreme environments</article-title>. <source>Antonie Van Leeuwenhoek</source>, <volume>81</volume>, <fpage>61</fpage>–<lpage>72</lpage>.<pub-id pub-id-type="pmid">12448706</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Laserson</surname><given-names>J.</given-names></name><etal/></person-group><italic>.</italic> (<year>2011</year>) 
<article-title>Genovo: de novo assembly for metagenomes</article-title>. <source>J. Comput. Biol.</source>, <volume>18</volume>, <fpage>429</fpage>–<lpage>443</lpage>.<pub-id pub-id-type="pmid">21385045</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H.</given-names></name></person-group> (<year>2011</year>) 
<article-title>WGSIM-read simulator for next generation sequencing</article-title>. <comment><ext-link ext-link-type="uri" xlink:href="https://github.com/lh3/wgsim">https://github.com/lh3/wgsim</ext-link> (11 May 2015 date last accessed)</comment>. </mixed-citation>
    </ref>
    <ref id="btv231-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>R.</given-names></name><etal/></person-group><italic>.</italic> (<year>2010</year>) 
<article-title>De novo assembly of human genomes with massively parallel short read sequencing</article-title>. <source>Genome Res.</source>, <volume>20</volume>, <fpage>265</fpage>–<lpage>272</lpage>.<pub-id pub-id-type="pmid">20019144</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Loreau</surname><given-names>M.</given-names></name><etal/></person-group><italic>.</italic> (<year>2001</year>) 
<article-title>Biodiversity and ecosystem functioning: current knowledge and future challenges</article-title>. <source>Science</source>, <volume>294</volume>, <fpage>804</fpage>–<lpage>808</lpage>.<pub-id pub-id-type="pmid">11679658</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Luo</surname><given-names>C.</given-names></name><etal/></person-group><italic>.</italic> (<year>2012</year>) 
<article-title>Individual genome assembly from complex community short-read metagenomic datasets</article-title>. <source>ISME J.</source>, <volume>6</volume>, <fpage>898</fpage>–<lpage>901</lpage>.<pub-id pub-id-type="pmid">22030673</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Miller</surname><given-names>C.S.</given-names></name><etal/></person-group><italic>.</italic> (<year>2011</year>) 
<article-title>EMIRGE: reconstruction of full-length ribosomal genes from microbial community short read sequencing data</article-title>. <source>Genome Biol.</source>, <volume>12</volume>, <fpage>R44</fpage>.<pub-id pub-id-type="pmid">21595876</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Namiki</surname><given-names>T.</given-names></name><etal/></person-group><italic>.</italic> (<year>2012</year>) 
<article-title>MetaVelvet: an extension of Velvet assembler to de novo metagenome assembly from short sequence reads</article-title>. <source>Nucleic Acids Res.</source>, <volume>40</volume>, <fpage>e155</fpage>–<lpage>e155</lpage>.<pub-id pub-id-type="pmid">22821567</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Nawrocki</surname><given-names>E.P.</given-names></name><etal/></person-group><italic>.</italic> (<year>2009</year>) 
<article-title>Infernal 1.0: inference of RNA alignments</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1335</fpage>–<lpage>1337</lpage>.<pub-id pub-id-type="pmid">19307242</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname><given-names>Y.</given-names></name><etal/></person-group><italic>.</italic> (<year>2011</year>) 
<article-title>Meta-IDBA: a de novo assembler for metagenomic data</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>i94</fpage>–<lpage>i101</lpage>.<pub-id pub-id-type="pmid">21685107</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Peng</surname><given-names>Y.</given-names></name><etal/></person-group><italic>.</italic> (<year>2012</year>) 
<article-title>IDBA-UD: a de novo assembler for single-cell and metagenomic sequencing data with highly uneven depth</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>1420</fpage>–<lpage>1428</lpage>.<pub-id pub-id-type="pmid">22495754</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Rothschild</surname><given-names>L.J.</given-names></name><name><surname>Mancinelli</surname><given-names>R.L.</given-names></name></person-group> (<year>2001</year>) 
<article-title>Life in extreme environments</article-title>. <source>Nature</source>, <volume>409</volume>, <fpage>1092</fpage>–<lpage>1101</lpage>.<pub-id pub-id-type="pmid">11234023</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Salzberg</surname><given-names>S.L.</given-names></name><etal/></person-group><italic>.</italic> (<year>2008</year>) 
<article-title>Gene-boosted assembly of a novel bacterial genome from very short reads</article-title>. <source>PLOS Comput. Biol.</source>, <volume>4</volume>, <fpage>e1000186</fpage>.<pub-id pub-id-type="pmid">18818729</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Savage</surname><given-names>D.C.</given-names></name></person-group> (<year>1977</year>) 
<article-title>Microbial ecology of the gastrointestinal tract</article-title>. <source>Annu. Rev. Microbiol.</source>, <volume>31</volume>, <fpage>107</fpage>–<lpage>133</lpage>.<pub-id pub-id-type="pmid">334036</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Shakya</surname><given-names>M.</given-names></name><etal/></person-group><italic>.</italic> (<year>2013</year>) 
<article-title>Comparative metagenomic and rRNA microbial diversity characterization using archaeal and bacterial synthetic communities</article-title>. <source>Environ. Microbiol.</source>, <volume>15</volume>, <fpage>1882</fpage>–<lpage>1899</lpage>.<pub-id pub-id-type="pmid">23387867</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simpson</surname><given-names>J.T.</given-names></name><name><surname>Durbin</surname><given-names>R.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Efficient de novo assembly of large genomes using compressed data structures</article-title>. <source>Genome Res.</source>, <volume>22</volume>, <fpage>549</fpage>–<lpage>556</lpage>.<pub-id pub-id-type="pmid">22156294</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Simpson</surname><given-names>J.T.</given-names></name><etal/></person-group><italic>.</italic> (<year>2009</year>) 
<article-title>ABySS: a parallel assembler for short read sequence data</article-title>. <source>Genome Res.</source>, <volume>19</volume>, <fpage>1117</fpage>–<lpage>1123</lpage>.<pub-id pub-id-type="pmid">19251739</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tateno</surname><given-names>Y.</given-names></name><etal/></person-group><italic>.</italic> (<year>2002</year>) 
<article-title>DNA Data Bank of Japan (DDBJ) for genome scale research in life science</article-title>. <source>Nucleic Acids Res.</source>, <volume>30</volume>, <fpage>27</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">11752245</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Treangen</surname><given-names>T.</given-names></name><etal/></person-group><italic>.</italic> (<year>2013</year>) 
<article-title>MetAMOS: a modular and open source metagenomic assembly and analysis pipeline</article-title>. <source>Genome Biol.</source>, <volume>14</volume>, <fpage>R2</fpage>.<pub-id pub-id-type="pmid">23320958</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tringe</surname><given-names>S.G.</given-names></name><etal/></person-group><italic>.</italic> (<year>2005</year>) 
<article-title>Comparative metagenomics of microbial communities</article-title>. <source>Science</source>, <volume>308</volume>, <fpage>554</fpage>–<lpage>557</lpage>.<pub-id pub-id-type="pmid">15845853</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Q.</given-names></name><etal/></person-group><italic>.</italic> (<year>2007</year>) 
<article-title>Nave Bayesian classifier for rapid assignment of rRNA sequences into the new bacterial taxonomy</article-title>. <source>Appl. Environ. Microbiol.</source>, <volume>73</volume>, <fpage>5261</fpage>–<lpage>5267</lpage>.<pub-id pub-id-type="pmid">17586664</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Woese</surname><given-names>C.R.</given-names></name><name><surname>Fox</surname><given-names>G.E.</given-names></name></person-group> (<year>1977</year>) 
<article-title>Phylogenetic structure of the prokaryotic domain: the primary kingdoms</article-title>. <source>Proc. Natl. Acad. Sci.</source>, <volume>74</volume>, <fpage>5088</fpage>–<lpage>5090</lpage>.<pub-id pub-id-type="pmid">270744</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Woese</surname><given-names>C.R.</given-names></name><etal/></person-group><italic>.</italic> (<year>1990</year>) 
<article-title>Towards a natural system of organisms: proposal for the domains Archaea, Bacteria, and Eucarya</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source>, <volume>87</volume>, <fpage>4576</fpage>–<lpage>4579</lpage>.<pub-id pub-id-type="pmid">2112744</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>Y.</given-names></name><etal/></person-group><italic>.</italic> (<year>2012</year>) 
<article-title>Stitching gene fragments with a network matching algorithm improves gene assembly for metagenomics</article-title>. <source>Bioinformatics</source>, <volume>28</volume>, <fpage>i363</fpage>–<lpage>i369</lpage>.<pub-id pub-id-type="pmid">22962453</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Yuan</surname><given-names>C.</given-names></name><name><surname>Sun</surname><given-names>Y.</given-names></name></person-group> (<year>2013</year>) 
<article-title>RNA-CODE: A noncoding RNA classification tool for short reads in NGS data lacking reference genomes</article-title>. <source>PLoS One</source>, <volume>8</volume>, <fpage>e77596</fpage>.<pub-id pub-id-type="pmid">24204885</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zerbino</surname><given-names>D.R.</given-names></name><name><surname>Birney</surname><given-names>E.</given-names></name></person-group> (<year>2008</year>) 
<article-title>Velvet: algorithms for de novo short read assembly using de Bruijn graphs</article-title>. <source>Genome Res.</source>, <volume>18</volume>, <fpage>821</fpage>–<lpage>829</lpage>.<pub-id pub-id-type="pmid">18349386</pub-id></mixed-citation>
    </ref>
    <ref id="btv231-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>Y.</given-names></name><etal/></person-group><italic>.</italic> (<year>2014</year>) 
<article-title>A scalable and accurate targeted gene assembly tool (SAT-assembler) for next-generation sequencing data</article-title>. <source>PLoS Comput. Biol.</source>, <volume>10</volume>, <fpage>e1003737</fpage>.<pub-id pub-id-type="pmid">25122209</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
