<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7703727</article-id>
    <article-id pub-id-type="pmid">31693070</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz814</article-id>
    <article-id pub-id-type="publisher-id">btz814</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Influenza classification from short reads with VAPOR facilitates robust mapping pipelines and zoonotic strain detection for routine surveillance applications</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Southgate</surname>
          <given-names>Joel A</given-names>
        </name>
        <xref ref-type="aff" rid="btz814-aff1">1</xref>
        <xref ref-type="corresp" rid="btz814-cor1"/>
        <!--<email>southgateJA@cardiff.ac.uk</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bull</surname>
          <given-names>Matthew J</given-names>
        </name>
        <xref ref-type="aff" rid="btz814-aff1">1</xref>
        <xref ref-type="aff" rid="btz814-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brown</surname>
          <given-names>Clare M</given-names>
        </name>
        <xref ref-type="aff" rid="btz814-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Watkins</surname>
          <given-names>Joanne</given-names>
        </name>
        <xref ref-type="aff" rid="btz814-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Corden</surname>
          <given-names>Sally</given-names>
        </name>
        <xref ref-type="aff" rid="btz814-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Southgate</surname>
          <given-names>Benjamin</given-names>
        </name>
        <xref ref-type="aff" rid="btz814-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Moore</surname>
          <given-names>Catherine</given-names>
        </name>
        <xref ref-type="aff" rid="btz814-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-2394-6504</contrib-id>
        <name>
          <surname>Connor</surname>
          <given-names>Thomas R</given-names>
        </name>
        <xref ref-type="aff" rid="btz814-aff1">1</xref>
        <xref ref-type="aff" rid="btz814-aff2">2</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Birol</surname>
          <given-names>Inanc</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btz814-aff1"><label>1</label><institution>Organisms and Environment Division, School of Biosciences, Cardiff University</institution>, Cardiff CF10 3AX, <country country="GB">UK</country></aff>
    <aff id="btz814-aff2"><label>2</label><institution>Public Health Wales, University Hospital of Wales</institution>, Cardiff CF14 4XW, <country country="GB">UK</country></aff>
    <aff id="btz814-aff3"><label>3</label><institution>MRC Centre for Regenerative Medicine, University of Edinburgh</institution>, Edinburgh EH16 4UU, <country country="GB">UK</country></aff>
    <author-notes>
      <corresp id="btz814-cor1">
        <email>southgateJA@cardiff.ac.uk</email>
      </corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-11-06">
      <day>06</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>06</day>
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>6</issue>
    <fpage>1681</fpage>
    <lpage>1688</lpage>
    <history>
      <date date-type="received">
        <day>04</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>8</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz814.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Influenza viruses represent a global public health burden due to annual epidemics and pandemic potential. Due to a rapidly evolving RNA genome, inter-species transmission, intra-host variation, and noise in short-read data, reads can be lost during mapping, and <italic>de novo</italic> assembly can be time consuming and result in misassembly. We assessed read loss during mapping and designed a graph-based classifier, VAPOR, for selecting mapping references, assembly validation and detection of strains of non-human origin.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Standard human reference viruses were insufficient for mapping diverse influenza samples in simulation. VAPOR retrieved references for 257 real whole-genome sequencing samples with a mean of <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:mo>&gt;</mml:mo><mml:mn>99.8</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> identity to assemblies, and increased the proportion of mapped reads by up to 13.3% compared to standard references. VAPOR has the potential to improve the robustness of bioinformatics pipelines for surveillance and could be adapted to other RNA viruses.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>VAPOR is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/connor-lab/vapor">https://github.com/connor-lab/vapor</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Biotechnology and Biological Sciences Research Council</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000268</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>BB/M009122/1</award-id>
        <award-id>MR/L015080/1</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Welsh Government</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Genomics Partnership Wales</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Influenza viruses are enveloped, single-stranded, segmented negative-sense RNA viruses of the family Orthomyxoviridae. Influenza A and B have eight genome segments, with major antigenic recognition sites within the two proteins haemagglutinin (HA) and neuraminidase. Accumulation of point mutations within the antigenic recognition sites of HA and neuraminidase can result in host immune evasion, thereby causing annual seasonal epidemics (<xref rid="btz814-B29" ref-type="bibr">Petrova and Russell, 2018</xref>; <xref rid="btz814-B38" ref-type="bibr">Taubenberger and Kash, 2010</xref>). Current estimates suggest that seasonal influenza A and B cause 4–5 million severe infections (<xref rid="btz814-B36" ref-type="bibr">Tafalla <italic>et al.</italic>, 2016</xref>) in humans with ∼291 000–645 000 (<xref rid="btz814-B14" ref-type="bibr">Iuliano <italic>et al.</italic>, 2018</xref>) deaths per year globally. Furthermore, influenza type A is a zoonotic virus infecting a wide range of avian and other non-human species (<xref rid="btz814-B32" ref-type="bibr">Sautto <italic>et al.</italic>, 2018</xref>). These viruses have the capability to reassort leading to the emergence of new strains (<xref rid="btz814-B4" ref-type="bibr">Bouvier and Palese, 2008</xref>), which can result in pandemics.</p>
    <p>Whole-genome sequencing (WGS) has been used to study the influenza virus genome for over a decade and is emerging as an important tool in research and surveillance (<xref rid="btz814-B10" ref-type="bibr">Holmes <italic>et al.</italic>, 2005</xref>; <xref rid="btz814-B25" ref-type="bibr">McGinnis <italic>et al.</italic>, 2016</xref>; <xref rid="btz814-B26" ref-type="bibr">Meinel <italic>et al.</italic>, 2018</xref>; <xref rid="btz814-B30" ref-type="bibr">Rutvisuttinunt <italic>et al.</italic>, 2013</xref>). Protocols have been developed (<xref rid="btz814-B44" ref-type="bibr">Zhou <italic>et al.</italic>, 2009</xref>, <xref rid="btz814-B45" ref-type="bibr">2014</xref>) that facilitate routine monitoring of isolates by public health organizations, as well as the study of transmission events (<xref rid="btz814-B11" ref-type="bibr">Houlihan <italic>et al.</italic>, 2018</xref>; <xref rid="btz814-B26" ref-type="bibr">Meinel <italic>et al.</italic>, 2018</xref>). Two important data sharing resources exist to this end; the NCBI Influenza Virus Resource (NIVR) (<xref rid="btz814-B2" ref-type="bibr">Bao <italic>et al.</italic>, 2008</xref>), and the Global Initiative on Sharing All Influenza Data (<xref rid="btz814-B34" ref-type="bibr">Shu and McCauley, 2017</xref>), wherein over a hundred thousand influenza genome segment sequences can be found at the time of writing. Sequencing can be performed directly from clinical swabs with single-reaction genomic reverse transcription polymerase chain reaction (RT-PCR) (<xref rid="btz814-B8" ref-type="bibr">Goldstein <italic>et al.</italic>, 2017</xref>; <xref rid="btz814-B44" ref-type="bibr">Zhou <italic>et al.</italic>, 2009</xref>). Furthermore, bioinformatics pipelines have begun to be developed for efficient processing of this data (<xref rid="btz814-B3" ref-type="bibr">Borges <italic>et al.</italic>, 2018</xref>; <xref rid="btz814-B39" ref-type="bibr">Wan <italic>et al.</italic>, 2015</xref>).</p>
    <p>Despite the increasing application of next-generation sequencing to influenza, the pitfalls associated with current bioinformatics approaches have not been explored in depth. Influenza virus <italic>de novo</italic> assembly also poses additional challenges due to biological population complexity and additional error resulting from RT-PCR (<xref rid="btz814-B12" ref-type="bibr">Hunt <italic>et al.</italic>, 2015</xref>; <xref rid="btz814-B28" ref-type="bibr">Orton <italic>et al.</italic>, 2015</xref>). Firstly, we aim to provide evidence that current mapping approaches can, due to diversity of influenza genome sequences, routinely result in unmapped reads and potential data loss. This has been previously noted in study of human immunodeficiency virus (<xref rid="btz814-B42" ref-type="bibr">Wymant <italic>et al.</italic>, 2018</xref>). If reads are lost during mapping, coverage may appear to be poor, and downstream analyses, such as SNP analysis, estimates of viral intra-host diversity or even reconstructed sequences, may be biased. Furthermore, in the worst case, sequences of zoonotic origin may fail to be identified, resulting in a dataset that appears to be low coverage, missing segments or missing potential future pandemic reassortments. Whilst alternatives, such as read classification by mapping to a large database of influenza sequences (<xref rid="btz814-B43" ref-type="bibr">Yu <italic>et al.</italic>, 2014</xref>) and subsequent <italic>de novo</italic> assembly can help to resolve this issue, such pipelines are often complex, slow and require expertise that is not necessarily available in routine surveillance. Furthermore, even with recent assembly programs, misassembly can occur (<xref rid="btz814-B42" ref-type="bibr">Wymant <italic>et al.</italic>, 2018</xref>). We aim to show that this problem can be resolved by classification of isolates from reads prior to analysis by directly querying a De Bruijn graph (DBG) built directly from Illumina sequencing reads. Mapping reads directly to a DBG has been previously argued to be less biased than that of mapping to assembled contigs (<xref rid="btz814-B23" ref-type="bibr">Limasset <italic>et al.</italic>, 2016</xref>). Directly querying DBGs instead of assembled sequences has been previously addressed (<xref rid="btz814-B9" ref-type="bibr">Holley and Peterlongo, 2012</xref>; <xref rid="btz814-B23" ref-type="bibr">Limasset <italic>et al.</italic>, 2016</xref>; <xref rid="btz814-B24" ref-type="bibr">Liu <italic>et al.</italic>, 2016</xref>; <xref rid="btz814-B31" ref-type="bibr">Salmela and Rivals, 2014</xref>), although most previous work has focussed on mapping reads to a DBG, and not diverse RNA virus gene sequences. Instead of mapping reads to a DBG, we sought to develop a method for querying short influenza genome sequences against a short-read DBG in order to retrieve the most similar reference. We compare our tool, VAPOR, with both a slow BLAST-based (<xref rid="btz814-B1" ref-type="bibr">Altschul <italic>et al.</italic>, 1990</xref>) approach and fast <italic>k</italic>-mer-based MASH (<xref rid="btz814-B27" ref-type="bibr">Ondov <italic>et al.</italic>, 2016</xref>), and show superior or equivalent results in several use cases with reasonable runtimes.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 WGS datasets</title>
      <p>Total RNA was extracted from patient samples using the NucliSens easyMAG instrument according to the manufacturer’s instructions. Following RNA extraction, a one-step RT-PCR (Quanta biosciences qScript XLT kit, following manufacturer’s instructions) was then undertaken to generate DNA for sequencing using the primers previously described for influenza A (<xref rid="btz814-B44" ref-type="bibr">Zhou <italic>et al.</italic>, 2009</xref>) and influenza B (<xref rid="btz814-B45" ref-type="bibr">Zhou <italic>et al.</italic>, 2014</xref>). Sequencing was performed using Illumina sequencing instruments. Libraries were prepared using NexteraXT, and samples were then multiplexed for sequencing. Samples were run on a MiSeq (2 ×250 bp V2 kit—44 samples) and NextSeq (2 ×150 bp Medium Output kit—213 samples). In total, 257 samples were utilized. Short-read data can be found at s3.climb.ac.uk/vapor-benchmark-data/vapor_benchmarking_realdata_reads_filtered_18_03_18.tar, or hosted at the European Nucleotide Archive under project accession PRJEB33950.</p>
      <p>For publicly available data, any reads that were classified as human by Kraken2 (<xref rid="btz814-B40" ref-type="bibr">Wood and Salzberg, 2014</xref>), or those that mapped to the hg38 human genome with Minimap2 (<xref rid="btz814-B19" ref-type="bibr">Li, 2018</xref>), were removed.</p>
      <p>These WGS datasets were then processed by extraction of influenza reads by mapping with Minimap2 (<xref rid="btz814-B19" ref-type="bibr">Li, 2018</xref>) to eight curated influenza segment reference.fasta files (19 594 sequences in total), one at a time. These reference files were prepared by downloading all available influenza segment sequences from the NIVR (<ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/genomes/FLU/">https://www.ncbi.nlm.nih.gov/genomes/FLU/</ext-link>) and clustering to 99.5% identity with cd-hit-est (<xref rid="btz814-B22" ref-type="bibr">Li and Godzik, 2006</xref>). Extracted reads were assembled with IVA (<xref rid="btz814-B12" ref-type="bibr">Hunt <italic>et al.</italic>, 2015</xref>). For all 257 fastq file pairs used, a near-full-length <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>90</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> contig could be assembled for at least one major segment protein. Samples for which a contig could not be assembled were not used. In total, 1495 segment contigs were included.</p>
    </sec>
    <sec>
      <title>2.2 Mapping assessment</title>
      <p>Four mapping programmes were assessed in this analysis: Minimap2 (<xref rid="btz814-B19" ref-type="bibr">Li, 2018</xref>), BWA-MEM (<xref rid="btz814-B20" ref-type="bibr">Li and Durbin, 2009</xref>), NGM (<xref rid="btz814-B33" ref-type="bibr">Sedlazeck <italic>et al.</italic>, 2013</xref>) and Hisat2 (<xref rid="btz814-B16" ref-type="bibr">Kim <italic>et al.</italic>, 2015</xref>). These tools were used to represent a range of algorithms and intended use cases, in order to assess whether robustness to influenza data is a common problem, or whether it can be addressed by choice of tool. Default settings were used for all tools. Each experiment can be reproduced using the code and instructions found at github.com/connor-lab/vapor_mapping_benchmarking. Four mapping simulations were performed in total.</p>
      <p>For assessment of the sufficiency of single reference strains for mapping diverse samples, two simulations were performed. For assessment of robustness to species origin, read sets were simulated with ArtificialFastqGenerator (<xref rid="btz814-B7" ref-type="bibr">Frampton and Houlston, 2012</xref>) from 552 avian, 16 679 human and 4054 swine H1N1 HA coding sequences from the NIVR (<xref rid="btz814-B2" ref-type="bibr">Bao <italic>et al.</italic>, 2008</xref>). An additional 0.05% <italic>in silico</italic> substitution was introduced into simulated reads to account for RT-PCR technical errors and biological intra-host variation. This rate was chosen to be in accordance with experimental observations made by <xref rid="btz814-B28" ref-type="bibr">Orton <italic>et al.</italic> (2015)</xref>. Reads were then mapped to the A/California/07/2009 (H1N1) HA reference sequence. For assessment of robustness to divergence, technical and biological noise, reads were simulated from A/Perth/16/09 (H3N2) HA, with additional <italic>in silico</italic> mutation with per-base rates between 2 and 16%, performed uniformly across the chosen reference sequence; reads were simulated as above, then mapped back to A/Perth/16/09 (H3N2). This was performed 1000 times for each mutation rate. A/California/07/2009 (H1N1) and A/Perth/16/2009 (H3N2) were used as references since they are common clade representatives. Samtools (<xref rid="btz814-B21" ref-type="bibr">Li <italic>et al.</italic>, 2009</xref>) was used to retrieve successfully mapped reads, which were then counted.</p>
      <p>For comparison of mapping with and without VAPOR classification, and potential zoonotic virus detection, two simulations were performed using 33 133 unique approximately full-length influenza A HA coding sequences of any lineage or species, downloaded from the NIVR. In the first case, 5000 pairs of sequences were chosen randomly; the first of the pair was used for read simulation as above, and the second as a mapping reference. In the second simulation, a single sequence was randomly chosen for read simulation, and the reference was chosen by VAPOR version 1.0.1. This process is shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>. As before, successfully mapped reads were extracted with samtools, then counted.</p>
      <p>To assess the potential benefit of classification with VAPOR on real data, 206 of 257 fastq file pairs were subjected to mapping with Minimap2 with default settings for short reads (-x sr), both with and without VAPOR classification. A total of 51 out of 257 samples with &lt;1000 HA reads were excluded to avoid very low coverage samples skewing calculation of mean percentage gain. In the first case, reads were mapped to a set of 4 HA references from different subtypes: A/Perth/16/2009 (H3N2), A/California/07/2009 (H1N1), B/Florida/4/2006 (Yamagata) and B/Brisbane/60/2008 (Victoria). In the second case, VAPOR was used to choose a single reference from 53 758 influenza A and B HA references. The number of reads mapping and the number passing VAPOR pre-filtering was recorded in each case.</p>
    </sec>
    <sec>
      <title>2.3 Algorithm overview</title>
      <sec>
        <label>2.3.1</label>
        <title>Definitions</title>
        <p>Let <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>R</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>S</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> be indexed multisets of strings (sequencing reads and references, respectively), over a common alphabet <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:mo>Σ</mml:mo><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, where |<italic>R</italic>| denotes the cardinality of set <italic>R</italic>. Let <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:mi mathvariant="script">W</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>E</mml:mi><mml:mo>,</mml:mo><mml:mi>W</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> be a weighted DBG built from reads <italic>R</italic>, where <italic>N</italic>, <italic>E</italic> and <italic>W</italic> are sets of nodes (<italic>k</italic>-mers), edges (<italic>k</italic>−1-mers) and node weights (sequencing depth for some <italic>k</italic>-mer), for some <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:mi>k</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> (by default <italic>k </italic>=<italic> </italic>21). We assume a model read generation process reflective of RNA virus sequencing: let the multiset <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>X</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, be a population of virus sequences (quasispecies) for some gene, for which we suppose there is some major variant <italic>x</italic>* with the greatest multiplicity. Let reads <italic>R</italic> be generated from this population, with varying coverage across the gene (possibly by several orders of magnitude), and additional errors (due to RT-PCR and sequencing). We attempt, using heuristics, to find a reference that is similar to <italic>x</italic>*.</p>
      </sec>
      <sec>
        <label>2.3.2</label>
        <title>Mapping and scoring</title>
        <p>VAPOR maps each reference <italic>s</italic> against <inline-formula id="IE9"><mml:math id="IM9"><mml:mi mathvariant="script">W</mml:mi></mml:math></inline-formula>, such that the <italic>i</italic>th <italic>k</italic>-mer of <italic>s</italic>, denoted <italic>s</italic>[<italic>i</italic>, <italic>i </italic>+<italic> k</italic>] is either mapped to some node <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula>, or mapped to a gap. We note that <italic>s</italic>[<italic>i</italic>, <italic>i </italic>+<italic> k</italic>] does not have to equal <italic>n</italic>. Let <italic>s′</italic> be the string representation of the path mapped to by <italic>s</italic>. <xref ref-type="fig" rid="btz814-F1">Figure 1</xref> demonstrates the concept of this mapping.</p>
        <fig id="btz814-F1" orientation="portrait" position="float">
          <label>Fig. 1.</label>
          <caption>
            <p>Simplified VAPOR algorithm. Firstly, pre-processing and graph construction is performed (<bold>A</bold>), where target reads <italic>R</italic> (solid black lines) are filtered from non-target (e.g. bacterial) reads (dotted lines) using a fast <italic>k</italic>-mer comparison to references <italic>S</italic>. This is followed by wDBG construction. Then, mapping and scoring is performed simultaneously (<bold>B</bold>), where each reference sequence <italic>s</italic> (dashed line) is mapped to the wDBG, <inline-formula id="IE11"><mml:math id="IM11"><mml:mi mathvariant="script">W</mml:mi></mml:math></inline-formula>, built from these reads. This is done in two main steps: exact <italic>k</italic>-mer matching (black circles) and extension (white circles) by heuristic graph traversal</p>
          </caption>
          <graphic xlink:href="btz814f1"/>
        </fig>
        <p>We next formulate a scoring function <inline-formula id="IE12"><mml:math id="IM12"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We chose to favour sequences for which there is high weight in <inline-formula id="IE13"><mml:math id="IM13"><mml:mi mathvariant="script">W</mml:mi></mml:math></inline-formula>; due to the high degree of variation in RNA virus datasets, and large number of closely related reference sequences, many <italic>k</italic>-mers may be present in the <inline-formula id="IE14"><mml:math id="IM14"><mml:mi mathvariant="script">W</mml:mi></mml:math></inline-formula> at low frequency, such that there may be several reference sequences which correspond exactly to a path in <inline-formula id="IE15"><mml:math id="IM15"><mml:mi mathvariant="script">W</mml:mi></mml:math></inline-formula>. Conversely, since sequencing depth in these datasets may be highly skewed, we seek to also reward matches which cover a greater proportion of the reference, rather than those that have high depth for a short subsequence, then poor matches elsewhere. In order to capture this trade-off, we define:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi mathvariant="script">W</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo>ψ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>·</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>δ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE16"><mml:math id="IM16"><mml:mrow><mml:mo>ψ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the fraction of non-gap bases of <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>|</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:math></inline-formula> is the length of string <italic>s</italic> and <italic>M<sub>i</sub></italic> is the maximum sequencing depth of <italic>k</italic>-mers that overlap with the <italic>i</italic>th base of <italic>s<sup>′</sup></italic>. That is, for the sequence of node weights <italic>w<sub>i</sub></italic> with corresponding <italic>k</italic>-mer nodes <italic>n<sub>i</sub></italic> of <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mo>{</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>i</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>i</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE19"><mml:math id="IM19"><mml:mrow><mml:mover accent="true"><mml:mi>i</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE20"><mml:math id="IM20"><mml:mrow><mml:mo>δ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if <inline-formula id="IE21"><mml:math id="IM21"><mml:mrow><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and 0 otherwise. Since any reference can be mapped onto the graph in many ways, we attempt to heuristically find high scoring placements.</p>
      </sec>
      <sec>
        <label>2.3.3</label>
        <title>Pre-processing</title>
        <p>VAPOR first filters reads to remove non-target sequences (e.g. bacterial) and decide orientation of reads. As input, VAPOR takes a fasta file of full or approximately full-length reference segment sequences, and a.fastq (or.fastq.gz) file of WGS reads. Firstly, VAPOR builds a set of <italic>k</italic>-mers <italic>U</italic> from all reference sequences. Next, the <italic>i</italic>th read is decomposed into a set of non-overlapping subsequences of length <italic>k</italic> (words), <italic>A<sub>i</sub></italic>, and if <inline-formula id="IE22"><mml:math id="IM22"><mml:mrow><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:mi>U</mml:mi><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>≤</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:math></inline-formula> (the proportion of read words also present in the references), where |<italic>A</italic>| gives the number of elements of the set <italic>A</italic>, for some specified parameter <italic>t</italic>, the read is discarded. This is repeated for the reverse complement; if both are kept, the highest score decides orientation. Furthermore, in order to try to eliminate erroneous <italic>k</italic>-mers, any node <inline-formula id="IE23"><mml:math id="IM23"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:math></inline-formula> with corresponding weight <inline-formula id="IE24"><mml:math id="IM24"><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mi>W</mml:mi></mml:mrow></mml:math></inline-formula> less than a coverage parameter <italic>c</italic> is discarded.</p>
      </sec>
      <sec>
        <label>2.3.4</label>
        <title>Core algorithm</title>
        <p>Firstly, <inline-formula id="IE25"><mml:math id="IM25"><mml:mi mathvariant="script">W</mml:mi></mml:math></inline-formula> is built from the filtered reads. Then for each input reference sequence, <italic>s</italic>, the core algorithm of VAPOR makes use of a heuristic seed-and-extend procedure to find a high scoring mapping of <italic>s</italic> onto <inline-formula id="IE26"><mml:math id="IM26"><mml:mi mathvariant="script">W</mml:mi></mml:math></inline-formula>. Each reference sequence, <italic>s</italic>, with length |<italic>s</italic>|, is decomposed into a sequence of <italic>k</italic>-mers. Querying proceeds in four phases, where the query is walked along the wDBG: <italic>k</italic>-mer seeding, trimming, bridging and scoring. We seek to simultaneously perform the mapping and compute the array <inline-formula id="IE27"><mml:math id="IM27"><mml:mrow><mml:mi>M</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>δ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>δ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>δ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi>s</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as in (1). Firstly, an array <italic>a</italic> is initialized from exact <italic>k</italic>-mer matches, where <italic>a<sub>m</sub></italic> is the weight of the <italic>m</italic>th <italic>k</italic>-mer of the reference, and any not in <italic>N</italic> are set to zero. For speed considerations, only a subset of seed arrays is extended: those with a fraction of non-zero elements greater than a user-defined parameter –min_kmer_cov (default: 0.1), and in a top user-defined percentile –top_seed_frac (default: 0.2). In order to reduce the number of suboptimal exact matches, seeds are trimmed. Each seed (sequence of <italic>k</italic>-mer matches) in the array <italic>a</italic>, is trimmed back (set to zero) at both ends until a suboptimal branch points in the graph within <italic>ρ</italic> positions of the end of the seed is found. This procedure is used to heuristically prevent suboptimal seeds to low coverage regions of the wDBG, possibly generated by error or low frequency variants. Next, bridging is performed. For the <italic>i</italic>th gap (run of zeros) in <italic>a</italic> of length <italic>l</italic>, a bridge <italic>b<sub>i</sub></italic> is formed by walking <italic>l</italic> locally optimal (where there is a branch, the edge with the highest weight) edges in the wDBG from the last matching <italic>k</italic>-mer. As such, bridging attempts to extend a mapping with only exact matches to one with inexact matches. Next, the array <italic>M</italic> is computed by (i) inserting bridge <italic>k</italic>-mer weights and (ii) re-calculating the weight at each position <italic>j</italic> as <italic>M<sub>j</sub></italic> (as defined in mapping and scoring). Finally, each bridge, <italic>b<sub>i</sub></italic>, a string, is then compared to the <italic>i</italic>th gap string, the original substring in the reference sequence corresponding to the gap, in order to compute <inline-formula id="IE28"><mml:math id="IM28"><mml:mrow><mml:mo>δ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as in (1). For any <italic>s<sub>j</sub></italic> in an exact match, <inline-formula id="IE29"><mml:math id="IM29"><mml:mrow><mml:mo>δ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> by definition. <xref ref-type="fig" rid="btz814-F2">Figure 2</xref> shows the steps involved in computing the array <italic>M<sup>′</sup></italic> for an example graph mapping.</p>
        <fig id="btz814-F2" orientation="portrait" position="float">
          <label>Fig. 2.</label>
          <caption>
            <p>Scoring procedure for an example graph mapping. An example mapping of a reference <italic>s</italic> (dashed line) to a graph <inline-formula id="IE30"><mml:math id="IM30"><mml:mi mathvariant="script">W</mml:mi></mml:math></inline-formula> (solid lines), with exact matches (black circles) and inexact matches (white circles), is shown (<bold>A</bold>), with string representation of the path, <italic>s<sup>′</sup></italic> (<bold>B</bold>). Firstly, a weight array <italic>a</italic> is retrieved for which <italic>a<sub>i</sub></italic> gives the weight of the <italic>i</italic>th reference <italic>k</italic>-mer in the wDBG, where gaps are given a weight of zero. These exact matches are then extended with bridges <italic>b</italic> to inexact matches. Next, per-base weights <italic>M</italic> are calculated such that each base is given the greatest weight of any <italic>k</italic>-mer that includes it, which also functions to assign weights to terminal characters of a string (or substring before a gap) that do not have <italic>k</italic>-mers (such as ‘TA’ at the fourth position). Finally, the array <italic>M<sup>′</sup></italic> is computed as <inline-formula id="IE31"><mml:math id="IM31"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE32"><mml:math id="IM32"><mml:mrow><mml:msub><mml:mrow><mml:mo>δ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> if <inline-formula id="IE33"><mml:math id="IM33"><mml:mrow><mml:mi>s</mml:mi><mml:msub><mml:mrow><mml:mo>′</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and zero otherwise. For our classifier, we chose to multiply the sum of this array by the fraction of non-gap (non-zero) positions, in order to penalize high weight, high gap mappings</p>
          </caption>
          <graphic xlink:href="btz814f2"/>
        </fig>
        <p>VAPOR is implemented in Python3, with source code available at github.com/connor-lab/vapor.</p>
      </sec>
    </sec>
    <sec>
      <title>2.4 Classification benchmarking</title>
      <p>VAPOR was compared to MASH (<xref rid="btz814-B27" ref-type="bibr">Ondov <italic>et al.</italic>, 2016</xref>) and BLAST (<xref rid="btz814-B1" ref-type="bibr">Altschul <italic>et al.</italic>, 1990</xref>) read classification by simulation. BLAST consensus classification was performed by BLASTing each read, taking the best scoring references by <italic>e</italic>-value then bit-score, summing the number of times each result occurs in all reads and returning the most frequent. Reads were simulated as follows: a reference, <italic>s</italic><sub>0</sub>, was chosen from 46 724 unique approximately full-length influenza A HA sequences from the NIVR, and mutated uniformly with a given probability (0.01, 0.02, 0.03) to generate a mutated sequence <italic>s<sub>m</sub></italic>; reads were simulated with ArtificialFastqGenerator as before, with a higher uniform error rate of 1%, in order to provide a challenging classification task representative of difficult datasets. To provide an additional challenge, we simulated an intra-host population with four minor sequences, mixed in the ratio of 100:5:1:1:1, with each minor sequence additionally mutated by 1% relative to the major sequence.</p>
      <p>This process was performed 500 times for each category. Performance was assessed as follows: the Levenshtein distance of the mutated sequence <italic>s<sub>m</sub></italic> was taken with respect to the original sequence <italic>s<sub>o</sub></italic> as a baseline, denoted by <inline-formula id="IE34"><mml:math id="IM34"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>; the reads were classified by each tool with all 32 804 references as a database, and the best hit <italic>s<sub>c</sub></italic> returned by each were compared to the mutated sequence to obtain <italic>L</italic>(<italic>s<sub>m</sub></italic>, <italic>s<sub>c</sub></italic>). Global alignment was performed with the pairwise2 module of Biopython (<xref rid="btz814-B5" ref-type="bibr">Cock <italic>et al.</italic>, 2009</xref>) (with cost parameters 0, −1, −1, −1, corresponding to Levenshtein distance). We defined the additional Levenshtein distance, <inline-formula id="IE35"><mml:math id="IM35"><mml:mrow><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>c</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This distance was chosen because, for mutated sequences, it captures the additional error in classification beyond that caused by uniform mutation to the original reference. We note that <italic>L</italic>(<italic>s<sub>o</sub></italic>, <italic>s<sub>m</sub></italic>) may occasionally be suboptimal, i.e. there may exist <italic>s<sub>o</sub></italic> such that <inline-formula id="IE36"><mml:math id="IM36"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>&lt;</mml:mo><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>o</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>m</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> where <italic>in silico</italic> mutations introduced resulted in a sequence more similar to some other sequence in the database than the original.</p>
      <p>For real datasets, 257 raw fastq file pairs that produced full-length contigs for at least one segment were chosen from the sequencing runs described above. The assembled contigs were annotated with BLAST (sorting by <italic>e</italic>-value, bit-score and length), and raw reads classified by VAPOR. The percentage identity (PID) of VAPOR classifications to each contig was recorded.</p>
    </sec>
    <sec>
      <title>2.5 Detection of reassortments and zoonotic strains</title>
      <p>For assessment of reassortment classification, two simulations were performed. Firstly, 9659 avian, 18 308 human and 2893 swine complete influenza genome sets were downloaded from the NIVR and 250 influenza human genome sets were randomly selected. Another 250 were randomly selected with a single segment swapped with a randomly chosen avian or swine influenza segment. For each, 1000 reads from each segment were simulated uniformly with an error rate of 0.5%. Each set of reads was classified with VAPOR. For the reference strains chosen by VAPOR for each segment, respective HA sequences were compared by global alignment, and PID taken. If the maximum pairwise distance between chosen strain HA sequences exceeded a given threshold <italic>v</italic>, a classification of true was returned. Receiver operating characteristic curves were generated by varying the parameter <italic>v</italic>. For assessment of intra-subtype reassortment classification, the same experiment was performed with randomly chosen H3N2 genomes.</p>
    </sec>
    <sec>
      <title>2.6 Computational resources and performance benchmarks</title>
      <p>In all cases, experiments were performed natively on a 96 core, 1.4 TB memory CentOS version 7.4.1708 virtual machine hosted by Cloud Infrastructure for Microbial Bioinformatics (CLIMB) (<xref rid="btz814-B6" ref-type="bibr">Connor <italic>et al.</italic>, 2016</xref>), with GNU parallel (<xref rid="btz814-B37" ref-type="bibr">Tange, 2011</xref>) where required. Basic time and space benchmarks comparing BLAST and VAPOR were performed with GNU-time (wall-clock time, maximum resident set size). The largest 11 influenza A samples with at least 1% (between 1 and 16%) of reads identifiable as influenza (samples 36, 51, 93, 95, 100, 101, 105, 113, 114, 131, 155) were randomly sub-sampled to between 200 000 and 2 000 000 reads (total for a pair of fastq files). BLAST and VAPOR were used to query a database of 47 073 influenza A HA gene sequences. For BLAST, reads were first converted to fasta files, which was not included in the benchmark time. For BLAST, tabulated output was specified (-outfmt 6), and output redirected to/dev/null in order to reduce I/O time (assuming a tool using BLAST for classification would not parse output files). VAPOR was also benchmarked on a laptop with an Intel<sup>®</sup> Core<sup>TM</sup> i7-6600U CPU @ 2.60 GHz with 8 GB of memory, using the same samples without sub-sampling (mean read total 6 600 000).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Benchmarking single-reference mapping</title>
      <p>A range of mapping programmes (Minimap2, BWA-MEM, Hisat2 and NGM) were compared to assess possible data loss when single references are chosen for mapping of short reads from influenza virus WGS datasets. For the first experiment, simulated reads from 16 679 human, 552 avian and 4054 swine H1N1 HA sequences retrieved from the NIVR were mapped to the reference strain A/California/07/2009 (H1N1). Reads were simulated with an additional 0.05% error on top of simulated sequencing error to account for the combined effect of intra-host population variation and RT-PCR error. This error rate was found to be conservative when compared to the raw error rate in our datasets, as shown by <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S3</xref>, which was frequently higher than 2%. The proportion of successfully mapped reads for each tool and host species is given in <xref ref-type="fig" rid="btz814-F3">Figure 3</xref>. In this case, using a single reference strain with any of the programmes resulted in unmapped reads. NGM resulted in the lowest average percentage of unmapped reads. When utilizing a database of all H1N1 sequences from human hosts, Minimap2, NGM, BWA-MEM and Hisat2 had mean mapping percentages of 87.2, 92.2, 89.1 and 84.9% respectively; as such, even for these influenza sequences, data loss was not uncommon, possibly due to samples in the database representing human infection from zoonotic strains. However, for avian and swine samples, read recovery was poor. For NGM, only 34.1% of avian reads mapped successfully on average. Swine sequences were mapped with intermediate success. This provides evidence that, should zoonotic strains be sequenced in routine surveillance, they may fail to map entirely, and go undetected.</p>
      <fig id="btz814-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Histogram showing proportion of mapped reads, by software and dataset. Reads were simulated for each dataset retrieved from the NIVR: 16 679 Human H1N1 HA (left column); 552 avian H1N1 HA (middle column); 4054 Swine H1N1 HA (right column). All sequences were mapped to California/07/2009. For human viruses, most simulated datasets mapped successfully, although even for this dataset, around 10% of samples had some proportion of unmapped reads. However, for avian and swine sequences, mapping quality was poor, and often failed entirely. Even for the best performing software, NGM, avian sequences mapped poorly</p>
        </caption>
        <graphic xlink:href="btz814f3"/>
      </fig>
      <p>Secondly, in order to assess how read recovery varies with sequence divergence, reads were simulated by taking the coding sequence of A/Perth/16/09 HA and subjecting it to <italic>in silico</italic> uniform mutation at specified rate, with additional read error of 0.05% as before (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S4</xref>). For all mapping programmes, at ∼10% mutation, read recovery begins to regularly diminish, which is insufficient for robust mapping of influenza strains from different species. Furthermore, for several of the programmes tested, mapping quality was suboptimal beyond 1–3% mutation.</p>
    </sec>
    <sec>
      <title>3.2 Simulation classification performance</title>
      <p>In order to assess the performance of classification from simulated reads, our tool, VAPOR, was compared to MASH and consensus BLAST classification. Reads were simulated from randomly selected H1N1 HA sequences mutated with a given uniform per-base probability, with additional read error of 1% to provide challenging datasets. A fourth category included simple simulated intra-host populations (denoted as 3%/Q). <xref ref-type="fig" rid="btz814-F4">Figure 4</xref> shows the additional Levenshtein distance, <italic>L</italic><sub>A</sub>, for each tool. Mean coverage for simulated reads was 77.76 for single-sequence simulations, and 96.03 for simulated intra-host populations. The average additional distance of retrieved sequences for MASH were 4.69, 5.24, 6.83 and 7.28, showing some sensitivity to additional simulated variant noise; for all cases mean additional distance for BLAST and VAPOR were below 0.74 and 0.88, respectively. For MASH, the 75, 95 and 99% percentiles for retrievals for the 3% threshold were 11.00, 24.00 and 37.04. However, for BLAST and VAPOR, these percentiles were under 12 and 14, respectively, for all cases. These results show that references chosen by BLAST and VAPOR were often near-optimal or optimal, despite a large amount of noise, and that the performance difference between these approaches was small. These results show that the algorithm used by VAPOR facilitates accurate classification of influenza strains directly from reads, comparable in accuracy to BLAST for WGS read sets, which is generally not computationally tractable for datasets with millions of reads (shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S7</xref>).</p>
      <fig id="btz814-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>Box plots showing additional Levenshtein distance of input sequence to output reference chosen by VAPOR, MASH and BLAST consensus classification. Reads with 1% error rate were generated from randomly selected references mutated <italic>in silico</italic> by 1, 2, 3 and 3% with additional biological intra-host variant noise simulation 3%/Q, and repeated 500 times for each category. <italic>L</italic><sub>A</sub> is defined as Levenshtein distance of a classified sequence <italic>s</italic><sub>c</sub> to original mutated sequence <italic>s</italic><sub>m</sub>, minus the distance of the original mutated sequence <italic>s</italic><sub>m</sub> to the original non-mutated reference sequence <italic>s</italic><sub>o</sub>. Outliers are indicated as diamonds. Performance of VAPOR was generally equivalent to that of BLAST. For both of these tools, classification most often resulted in none, or a few extra incorrect bases</p>
        </caption>
        <graphic xlink:href="btz814f4"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Real data classification performance</title>
      <p>In order to validate the performance of VAPOR directly on real datasets, we took raw reads from 257 samples corresponding to 1495 segment contigs previously processed and assembled with IVA, with a single full-length contig each previously annotated by BLAST. In each case, corresponding reads were classified by VAPOR. The chosen reference was compared by global alignment to the assembled full-length contigs. <xref ref-type="fig" rid="btz814-F5">Figure 5</xref> gives a scatter plot showing the PID of references retrieved by VAPOR to the assembled contig versus the PID of references selected by BLAST classifications of contigs. Comparison to BLAST classification of contigs was used to provide a baseline near-optimal classification. The mean PID between contig and VAPOR classification was 99.82%. In the case of NS1, VAPOR outperformed BLAST annotation of assembled contigs, with a mean of 99.48 versus 98.74%. On closer inspection, this was a result of the method used to sort BLAST results combined with the presence of a sequence with an additional 150–200 bp of the 3′ untranslated region (UTR). Removal of this sequence and sorting by PID resulted in a mean of 99.45 and 99.93%, respectively. These results show that in most cases tested, VAPOR was able to accurately identify a sample from reads with comparable performance to BLAST annotation of assembled contigs. We note that, for some contigs, neither BLAST nor VAPOR could achieve classifications with a PID &gt;97%. Manual examination of these samples showed large deletions, with at least one a likely misassembly (deletion including start codon, inclusion of 5′ UTR).</p>
      <fig id="btz814-F5" orientation="portrait" position="float">
        <label>Fig. 5.</label>
        <caption>
          <p>Scatterplots showing PIDs of VAPOR read classifications versus BLAST contig classifications with respect to assembled contigs for all eight major segment coding sequences. Black lines indicate <italic>x </italic>=<italic> y</italic>. Points that fall below this line were classified better from reads with VAPOR. Points above the line were classified better with BLAST from contigs. VAPOR is capable in general of performing classification of reads to within 1% of the correct sequence. The mean PID of VAPOR classifications for all segments was 99.82%. For datapoints under 98% PID, BLAST was generally also not able of providing a better classification given the reference database</p>
        </caption>
        <graphic xlink:href="btz814f5"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 Mapping with pre-classification</title>
      <p>Raw mapping performance was also assessed on real data by mapping datasets with Minimap2 with and without pre-classification. <xref ref-type="fig" rid="btz814-F6">Figure 6</xref> shows the number of additional reads mapped when pre-classification was performed. In all but one case, this resulted in a greater number of mapped reads, with a mean of 7816.03, corresponding to a mean percentage gain of 6.85%, including a case with over 68 000 additional reads. The maximum percentage increase was 13.32%. An outlier did occur where the number of mapped reads decreased. In this case, VAPOR identified several thousand more reads as influenza than were mapped. On further inspection, for this sample, reads mapped to both A/Perth/16/09 (H3N2) and A/California/07/09 (H1N1), indicating that the sample represented influenza from two different subtypes. As such, this sample represented a true biological coinfection or a contamination and could not be mapped to a single reference.</p>
      <fig id="btz814-F6" orientation="portrait" position="float">
        <label>Fig. 6.</label>
        <caption>
          <p>Additional number of reads mapped by Minimap2 with VAPOR pre-classification for 257 real.fastq file pairs. Pre-classification with VAPOR on average resulted in 7816.03 more mapped reads. Several samples gained more than 50 000 reads by choosing a suitable reference. For one sample, representing a possible coinfection, 5221 fewer reads mapped when using a single reference chosen by VAPOR</p>
        </caption>
        <graphic xlink:href="btz814f6"/>
      </fig>
      <p>For simulations with randomly selected pairs from any species, mean recovery rates were &lt;20% without pre-classification (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S5</xref>). However, with pre-classification using VAPOR, the mean was over 99.72% for all tools, demonstrating that mapping with pre-classification is robust to sequences of non-human origin.</p>
    </sec>
    <sec>
      <title>3.5 Detection of reassorted strains directly from reads</title>
      <p>In order to assess the application of read pre-classification to reassortment detection directly from reads, 250 simulated reassortment events with zoonotic strains were mixed with 250 complete genome sets, reads simulated, then classified by VAPOR. A simple reassortment classifier was used on the output of VAPOR, which compared the minimum pairwise PID of the HA sequences of the eight strains assigned by VAPOR to each segment; if this PID was below a given parameter <italic>v</italic>, a reassortment was called. A receiver operating characteristic curve is shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S6</xref>, illustrating the performance of this classification strategy. Simulated zoonotic reassortments were detected with 97.2% true positive rate and 0.08% false positive rate for a <italic>v</italic> of 91.35%. This is expected because, as previously shown, VAPOR generally was able to classify strains to within a few base-pairs; randomly chosen zoonotic strains generally had PIDs of &lt;90% to human strains, depending on origin. We note that, given the database used, some avian strains may have been isolated from humans, and labelled as human; as such, perfect classification with this dataset may be impossible. In order to provide a more difficult reassortment detection task, the same experiment was performed between human H3N2 sequences. We found at a PID threshold of 96.3%, a true positive rate of 76.8% could be achieved at a false positive rate of 10.8%. This result was expected given that sequences from different H3N2 strains generally have a PID within a few percent. In total, these results provide evidence that reassortments with zoonotic strains can be detected directly from reads with reasonable accuracy, but that intra-lineage reassortments may be more difficult.</p>
    </sec>
    <sec>
      <title>3.6 Run-time and computational requirements</title>
      <p>For benchmarking performed on the CLIMB VM, VAPOR performed all benchmarks within 11 min. As expected, using BLAST to query all reads was too slow for general application to these datasets, as shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S7</xref>. For the 2 000 000 read samples, BLAST took over 20 h in the worst case, excluding both pre- and post-processing of results. For the laptop computer, VAPOR classified samples with a mean of 6 600 000 total reads in a mean time of 3.73 min and mean peak memory consumption of 2.78 Gb.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <sec>
      <title>4.1 Mapping approaches and improvement with VAPOR</title>
      <p>We provide evidence that, in the best case, approaches for influenza virus analysis that use mapping to a single reference may result in data loss due to biological variation and noise. As shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figures S2 and S3</xref>, influenza strains continually accumulate substitutions relative to a single reference (∼5 substitutions per year for H3N2) and reads may have a high error rate <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>2</mml:mn><mml:mo>%</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Often, mapping to a single reference may be most unreliable for important samples, such as zoonotic transmission events. In the worst cases, mapping may fail completely, when usable data are present, requiring time and expertise to resolve with more complex methods. Our approach largely avoids these pitfalls altogether, allowing simpler pipelines and retaining the advantages of using a mapping-based approach for analysis. We chose Minimap2, BWA-MEM, NGM and Hisat2 in order to represent a range of mapping softwares. BWA has found use in general for influenza read mapping (<xref rid="btz814-B3" ref-type="bibr">Borges <italic>et al.</italic>, 2018</xref>; <xref rid="btz814-B13" ref-type="bibr">Imai <italic>et al.</italic>, 2018</xref>; <xref rid="btz814-B15" ref-type="bibr">Jonges <italic>et al.</italic>, 2014</xref>; <xref rid="btz814-B18" ref-type="bibr">Leonard <italic>et al.</italic>, 2016</xref>; <xref rid="btz814-B30" ref-type="bibr">Rutvisuttinunt <italic>et al.</italic>, 2013</xref>; <xref rid="btz814-B41" ref-type="bibr">Wu <italic>et al.</italic>, 2014</xref>; <xref rid="btz814-B43" ref-type="bibr">Yu <italic>et al.</italic>, 2014</xref>). In some cases, references were chosen by mapping-based approaches for selection (<xref rid="btz814-B43" ref-type="bibr">Yu <italic>et al.</italic>, 2014</xref>). Of these softwares, only NGM was developed with specific robustness to variation. Furthermore, the experiments reported were not intended as complete evaluations of the programmes, since such an evaluation must also include mapping quality. Our data, however, does demonstrate that pre-classification with raw reads provides a broad strategy to improve robustness of pipelines and achieve faster results. For the chosen references, A/Perth/16/2009 (H3N2) and California/07/2009 (H1N1) were chosen as vaccine strains recommended by the WHO multiple times, and have also been used previously as references (<xref rid="btz814-B30" ref-type="bibr">Rutvisuttinunt <italic>et al.</italic>, 2013</xref>; <xref rid="btz814-B35" ref-type="bibr">Simon <italic>et al.</italic>, 2019</xref>). In other cases, different single references have been used (<xref rid="btz814-B26" ref-type="bibr">Meinel <italic>et al.</italic>, 2018</xref>). We do not believe that using different individual strains would affect the trends demonstrated.</p>
      <p>We note that alternative approaches exist, including mapping to a large sequence database, but this does not easily allow for visualization of an alignment to a single reference, and subsequent analysis such as characterization of point mutations. We note that in principle, pre-classification with any software could work reasonably well. MASH performed well in simulations. However; using an optimal reference is ideal, since for later advanced applications, such as transmission events, or study of intra-host variation, the closest possible reference may be necessary. Furthermore, VAPOR permits simultaneous filtering out of any non-human or bacterial reads with optimal reference selection. Whilst BLAST performed well for individual read classification, it is often too slow for general application. Furthermore, assembly of virus genomes can be slow, often taking several days for a single sample when contaminant reads, such as human DNA, are present. Finally, misassembly can occur (<xref rid="btz814-B42" ref-type="bibr">Wymant <italic>et al.</italic>, 2018</xref>), which potentially occurred in several of our samples.</p>
      <p>In all but one of our real-data cases examined, pre-classification with VAPOR resulted in a greater number of mapped reads than mapping to four reference strains from A/H3N2, A/H1N1, B/Victoria and B/Yamagata. However, for a single sample, which contained influenza sequences from two clades, the number of mapped reads was reduced. Although VAPOR can report the number of influenza sequences detected in total, future study should be utilized to develop methods of coinfection detection. In these relatively rare cases, a single reference is not sufficient for mapping.</p>
    </sec>
    <sec>
      <title>4.2 VAPOR algorithm and performance</title>
      <p>We have presented a novel approach to virus classification from short-reads data using DBGs. In future study, as public sequence data accumulates, our algorithm may show promise in WGS approaches for other RNA viruses with small genomes, such as measles virus, human immunodeficiency virus or Ebola virus. Several default parameters were explored during development, but not exhaustively. A <italic>k</italic>-mer size of 21 was utilized, as this was also able to perform read pre-filtering from contaminating sequences, without addition of a separate parameter. Similarly, parameters controlling the minimum fraction of required <italic>k</italic>-mers for seed extension, as well as the top percentile of seeds chosen for extension could be adjusted, possibly to improve speed. However, in the read sets examined, the default parameters were generally sufficient to ensure matches were found and did not appear to exclude potentially optimal matches. However, for novel strains that differ greatly from all strains previously observed, more sensitive parameterizations may be required.</p>
    </sec>
    <sec>
      <title>4.3 Real-data classification</title>
      <p>As shown in <xref ref-type="fig" rid="btz814-F4">Figure 4</xref>, we note that the BLAST contig classification strategy we used performed poorly on NS1. This was due to sorting by <italic>e</italic>-value, bit-score and length over PID, combined with the presence of some NS1 sequences in the database which were longer than the required coding region. Since in general usage we do not wish to exclude sequences with longer 3′ UTRs, we opted to include this result to illustrate a potential pitfall that can occur with automated BLAST classification, as well as the trade-off between length and PID. Although sorting by PID may alleviate this problem, it may also yield shorter, incomplete alignments. For some samples, neither BLAST nor VAPOR could retrieve a sequence closer than 96% to the assembled contig. For some samples, this was due to large deletions present in the assembled contig. Although some of these deletions may be present in the true biological sequences, for at least one, this was due to suspected misassembly. These assemblies were also included to draw attention to potential problems that may be encountered during analysis.</p>
    </sec>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>Here we demonstrate that influenza sequence pre-classification with VAPOR minimizes data loss, reduces pipeline complexity, and allows for classification of zoonotic strains and reassortments directly from reads. We believe that the simplicity of our approach has potential to alleviate several difficulties associated with current bioinformatics pipelines and could reduce workloads in public health surveillance. Lastly, whilst we have tested VAPOR extensively for use with influenza, we believe our approach may be more broadly applicable to other sequence data, particularly small RNA and DNA viruses.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz814_Supplementary_Data</label>
      <media xlink:href="btz814_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to acknowledge and offer our thanks to the Pathogen Genomics Unit (PenGU) at Public Health Wales for their efforts and assistance in performing laboratory work, without which this research could not have been performed. Likewise, we would also like to thank Angela Marchbank and the Sequencing Hub at Cardiff University for the sequencing work performed.</p>
    <sec>
      <title>Funding</title>
      <p>J.S. was supported by the Biotechnology and Biological Sciences Research Council-funded South West Biosciences Doctoral Training Partnership [training grant reference BB/M009122/1]. This work made use of computational resources provided by Medical Research Council Cloud Infrastructure for Microbial Bioinformatics, which also funds T.R.C. and M.J.B. [grant reference MR/L015080/1]. The project was also supported by specific funding from Welsh Government which provided funds for the sequencing of influenza isolates. The Pathogen Genomics Unit (S.C., J.W.) was funded through Genomics Partnership Wales by Welsh Government.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz814-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>S.F.</given-names></name></person-group><etal>et al</etal> (<year>1990</year>) 
<article-title>Basic local alignment search tool</article-title>. <source>J. Mol. Biol</source>., <volume>215</volume>, <fpage>403</fpage>–<lpage>410</lpage>.<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bao</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>The influenza virus resource at the National Center for Biotechnology Information</article-title>. <source>J. Virol</source>., <volume>82</volume>, <fpage>596</fpage>–<lpage>601</lpage>.<pub-id pub-id-type="pmid">17942553</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Borges</surname><given-names>V.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>INSaFLU: an automated open web-based bioinformatics suite “from-reads” for influenza whole-genome-sequencing-based surveillance</article-title>. <source>Genome Med</source>., <volume>10</volume>, <fpage>46</fpage>.<pub-id pub-id-type="pmid">29954441</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bouvier</surname><given-names>N.M.</given-names></name>, <name name-style="western"><surname>Palese</surname><given-names>P.</given-names></name></person-group> (<year>2008</year>) 
<article-title>The biology of influenza viruses</article-title>. <source>Vaccine</source>, <volume>26</volume>, <fpage>D49</fpage>–<lpage>D53</lpage>.<pub-id pub-id-type="pmid">19230160</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cock</surname><given-names>P.J.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1422</fpage>–<lpage>1423</lpage>.<pub-id pub-id-type="pmid">19304878</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Connor</surname><given-names>T.R.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>CLIMB (the cloud infrastructure for microbial bioinformatics): an online resource for the medical microbiology community</article-title>. <source>Microb. Genom</source>., <volume>2</volume>, <fpage>e000086</fpage>.<pub-id pub-id-type="pmid">28785418</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Frampton</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Houlston</surname><given-names>R.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Generation of artificial FASTQ files to evaluate the performance of next-generation sequencing pipelines</article-title>. <source>PLoS One</source>, <volume>7</volume>, <fpage>e49110</fpage>.<pub-id pub-id-type="pmid">23152858</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Goldstein</surname><given-names>E.J.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Integrating patient and whole-genome sequencing data to provide insights into the epidemiology of seasonal influenza A(H3N2) viruses</article-title>. <source>Microb. Genom</source>., <volume>2018</volume>, <fpage>4</fpage>.</mixed-citation>
    </ref>
    <ref id="btz814-B9">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Holley</surname><given-names>G.</given-names></name>, <name name-style="western"><surname>Peterlongo</surname><given-names>P.</given-names></name></person-group> (<year>2012</year>) <chapter-title>Blastgraph: intensive approximate patternmatching in sequence graphs and De Bruijn graphs</chapter-title> In: <italic>Proceedings of the Prague Stringology Conference 2012, Prague, Czech Republic</italic>, pp. 53–63. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.stringology.org/event/2012/p06.html">http://www.stringology.org/event/2012/p06.html</ext-link> (7 February 2019, date last accessed). </mixed-citation>
    </ref>
    <ref id="btz814-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Holmes</surname><given-names>E.C.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>Whole-genome analysis of human influenza A virus reveals multiple persistent lineages and reassortment among recent H3N2 viruses</article-title>. <source>PLoS Biol</source>., <volume>3</volume>, <fpage>e300</fpage>.<pub-id pub-id-type="pmid">16026181</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Houlihan</surname><given-names>C.F.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Use of whole-genome sequencing in the investigation of a nosocomial influenza virus outbreak</article-title>. <source>J. Infect. Dis</source>., <volume>218</volume>, <fpage>1485</fpage>–<lpage>1489</lpage>.<pub-id pub-id-type="pmid">29873767</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hunt</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>IVA: accurate <italic>de novo</italic> assembly of RNA virus genomes</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>2374</fpage>–<lpage>2376</lpage>.<pub-id pub-id-type="pmid">25725497</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Imai</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Whole genome sequencing of influenza A and B viruses with the MinION sequencer in the clinical setting: a pilot study</article-title>. <source>Front. Microbiol</source>., <volume>9</volume>, <fpage>2748</fpage>.<pub-id pub-id-type="pmid">30483243</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Iuliano</surname><given-names>A.D.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Estimates of global seasonal influenza-associated respiratory mortality: a modelling study</article-title>. <source>Lancet</source>, <volume>391</volume>, <fpage>1285</fpage>–<lpage>1300</lpage>.<pub-id pub-id-type="pmid">29248255</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jonges</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Emergence of the virulence-associated PB2 E627K substitution in a fatal human case of highly pathogenic avian influenza virus A(H7N7) infection as determined by Illumina ultra-deep sequencing</article-title>. <source>Virology</source>, <volume>88</volume>, <fpage>1694</fpage>–<lpage>1702</lpage>.</mixed-citation>
    </ref>
    <ref id="btz814-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kim</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>HISAT: a fast spliced aligner with low memory requirements</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>357</fpage>–<lpage>356</lpage>.<pub-id pub-id-type="pmid">25751142</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leonard</surname><given-names>A.S.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Deep sequencing of Influenza A virus from a human challenge study reveals a selective bottleneck and only limited intrahost genetic diversification</article-title>. <source>Virology</source>, <volume>90</volume>, <fpage>11247</fpage>–<lpage>11258</lpage>.</mixed-citation>
    </ref>
    <ref id="btz814-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name></person-group> (<year>2018</year>) 
<article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>3094</fpage>–<lpage>3100</lpage>.<pub-id pub-id-type="pmid">29750242</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Durbin</surname><given-names>R.</given-names></name></person-group> (<year>2009</year>) 
<article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1754</fpage>–<lpage>1760</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>The sequence alignment/map format and SAMtools</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>2078</fpage>–<lpage>2079</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>W.</given-names></name>, <name name-style="western"><surname>Godzik</surname><given-names>A.</given-names></name></person-group> (<year>2006</year>) 
<article-title>Cd-hit: a fast program for clustering and comparing large sets of protein or nucleotide sequences</article-title>. <source>Bioinformatics</source>, <volume>22</volume>, <fpage>1658</fpage>–<lpage>1659</lpage>.<pub-id pub-id-type="pmid">16731699</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Limasset</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Read mapping on De Bruijn graphs</article-title>. <source>Bioinformatics</source>, <volume>17</volume>, <fpage>237</fpage>.<pub-id pub-id-type="pmid">27306641</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>deBGA: read alignment with De Bruijn graph-based seed and extension</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>3224</fpage>–<lpage>3232</lpage>.<pub-id pub-id-type="pmid">27378303</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McGinnis</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Next generation sequencing for whole genome analysis and surveillance of influenza A viruses</article-title>. <source>J. Clin. Virol</source>., <volume>79</volume>, <fpage>44</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">27085509</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Meinel</surname><given-names>D.M.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Whole genome sequencing identifies influenza A H3N2 transmission and offers superior resolution to classical typing methods</article-title>. <source>Infection</source>, <volume>46</volume>, <fpage>69</fpage>–<lpage>76</lpage>.<pub-id pub-id-type="pmid">29086356</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ondov</surname><given-names>B.D.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>132</fpage>.<pub-id pub-id-type="pmid">27323842</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Orton</surname><given-names>R.J.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Distinguishing low frequency mutations from RT-PCR and sequence errors in viral deep sequencing data</article-title>. <source>BMC Genomics</source>, <volume>16</volume>, <fpage>299</fpage>.<pub-id pub-id-type="pmid">25887590</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Petrova</surname><given-names>V.N.</given-names></name>, <name name-style="western"><surname>Russell</surname><given-names>C.A.</given-names></name></person-group> (<year>2018</year>) 
<article-title>The evolution of seasonal influenza viruses</article-title>. <source>Nat. Rev. Microbiol</source>., <volume>16</volume>, <fpage>47</fpage>–<lpage>60</lpage>. <pub-id pub-id-type="pmid">29081496</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rutvisuttinunt</surname><given-names>W.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Simultaneous and complete genome sequencing of influenza A and B with high coverage by Illumina MiSeq platform</article-title>. <source>J. Virol. Methods</source>, <volume>193</volume>, <fpage>394</fpage>–<lpage>404</lpage>.<pub-id pub-id-type="pmid">23856301</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Salmela</surname><given-names>L.</given-names></name>, <name name-style="western"><surname>Rivals</surname><given-names>E.</given-names></name></person-group> (<year>2014</year>) 
<article-title>LoRDEC: accurate and efficient long read error correction</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>3506</fpage>–<lpage>3514</lpage>.<pub-id pub-id-type="pmid">25165095</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sautto</surname><given-names>G.A.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Towards a universal influenza vaccine: different approaches for one goal</article-title>. <source>Virol. J</source>., <volume>15</volume>, <fpage>17</fpage>.<pub-id pub-id-type="pmid">29370862</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sedlazeck</surname><given-names>F.J.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>NextGenMap: fast and accurate read mapping in highly polymorphic genomes</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>2790</fpage>–<lpage>2791</lpage>.<pub-id pub-id-type="pmid">23975764</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shu</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>McCauley</surname><given-names>J.</given-names></name></person-group> (<year>2017</year>) 
<article-title>GISAID: global initiative on sharing all influenza data - from vision to reality</article-title>. <source>Euro Surveill</source>., <volume>22</volume>, <fpage>30494</fpage>.<pub-id pub-id-type="pmid">28382917</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Simon</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Whole genome sequencing of A (H3N2) influenza viruses reveals variants associated with severity during the 2016–2017 season</article-title>. <source>Viruses</source>, <volume>11</volume>, <fpage>108</fpage>.</mixed-citation>
    </ref>
    <ref id="btz814-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Tafalla</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>A comprehensive review of the epidemiology and disease burden of influenza B in 9 European countries</article-title>. <source>Hum. Vaccin. Immunother</source>., <volume>12</volume>, <fpage>993</fpage>–<lpage>1002</lpage>.<pub-id pub-id-type="pmid">26890005</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B37">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Tange</surname><given-names>O.</given-names></name></person-group> (<year>2011</year>) GNU Parallel - The Command-Line Power Tool.; login: The USENIX Magazine. <bold>36</bold>, <fpage>42</fpage>–<lpage>47</lpage>. <ext-link ext-link-type="uri" xlink:href="http://www.gnu.org/s/parallel">http://www.gnu.org/s/parallel (7 June 2018, date last accessed).</ext-link></mixed-citation>
    </ref>
    <ref id="btz814-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Taubenberger</surname><given-names>J.K.</given-names></name>, <name name-style="western"><surname>Kash</surname><given-names>J.C.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Influenza virus evolution, host adaptation, and pandemic formation</article-title>. <source>Cell Host Microbe</source>, <volume>7</volume>, <fpage>440</fpage>–<lpage>451</lpage>.<pub-id pub-id-type="pmid">20542248</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wan</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>VirAmp: a galaxy-based viral genome assembly pipeline</article-title>. <source>GigaScience</source>, <volume>4</volume>, <fpage>19</fpage>.<pub-id pub-id-type="pmid">25918639</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wood</surname><given-names>D.E.</given-names></name>, <name name-style="western"><surname>Salzberg</surname><given-names>S.L.</given-names></name></person-group> (<year>2014</year>) 
<article-title>Kraken: ultrafast metagenomic sequence classification using exact alignments</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>R46</fpage>.<pub-id pub-id-type="pmid">24580807</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wu</surname><given-names>N.C.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>High-throughput profiling of influenza A virus hemagglutinin gene at single-nucleotide resolution</article-title>. <source>Sci. Rep</source>., <volume>4</volume>, <fpage>4942</fpage>. <pub-id pub-id-type="pmid">24820965</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Wymant</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Easy and accurate reconstruction of whole HIV genomes from short-read sequence data with shiver</article-title>. <source>Virus Evol</source>., <volume>4</volume>, <fpage>vey007</fpage>.<pub-id pub-id-type="pmid">29876136</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yu</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Influenza H7N9 and H9N2 viruses: coexistence in poultry linked to human H7N9 infection and genome characteristics</article-title>. <source>Virology</source>, <volume>88</volume>, <fpage>3423</fpage>–<lpage>3431</lpage>.</mixed-citation>
    </ref>
    <ref id="btz814-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhou</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Single-reaction genomic amplification accelerates sequencing and vaccine production for classical and swine origin human influenza A viruses</article-title>. <source>J. Virol</source>., <volume>83</volume>, <fpage>10309</fpage>–<lpage>10313</lpage>.<pub-id pub-id-type="pmid">19605485</pub-id></mixed-citation>
    </ref>
    <ref id="btz814-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhou</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Universal influenza B virus genomic amplification facilitates sequencing, diagnostics, and reverse genetics</article-title>. <source>J. Clin. Microbiol</source>., <volume>52</volume>, <fpage>1330</fpage>–<lpage>1337</lpage>.<pub-id pub-id-type="pmid">24501036</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
