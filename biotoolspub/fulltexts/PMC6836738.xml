<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Res</journal-id>
    <journal-id journal-id-type="hwp">genome</journal-id>
    <journal-id journal-id-type="pmc">genome</journal-id>
    <journal-id journal-id-type="publisher-id">GENOME</journal-id>
    <journal-title-group>
      <journal-title>Genome Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1088-9051</issn>
    <issn pub-type="epub">1549-5469</issn>
    <publisher>
      <publisher-name>Cold Spring Harbor Laboratory Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6836738</article-id>
    <article-id pub-id-type="pmid">31628257</article-id>
    <article-id pub-id-type="medline">9509184</article-id>
    <article-id pub-id-type="doi">10.1101/gr.243121.118</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SiCloneFit: Bayesian inference of population structure, genotype, and phylogeny of tumor clones from single-cell genome sequencing data</article-title>
      <alt-title alt-title-type="left-running">Zafar et al.</alt-title>
      <alt-title alt-title-type="right-running">Integrative inference from single-cell genomes</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zafar</surname>
          <given-names>Hamim</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
        <xref ref-type="aff" rid="af2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Navin</surname>
          <given-names>Nicholas</given-names>
        </name>
        <xref ref-type="aff" rid="af3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chen</surname>
          <given-names>Ken</given-names>
        </name>
        <xref ref-type="aff" rid="af2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nakhleh</surname>
          <given-names>Luay</given-names>
        </name>
        <xref ref-type="aff" rid="af1">1</xref>
      </contrib>
    </contrib-group>
    <aff id="af1"><label>1</label>Department of Computer Science, Rice University, Houston, Texas 77005, USA;</aff>
    <aff id="af2"><label>2</label>Department of Bioinformatics and Computational Biology, The University of Texas MD Anderson Cancer Center, Houston, Texas 77030, USA;</aff>
    <aff id="af3"><label>3</label>Department of Genetics, The University of Texas MD Anderson Cancer Center, Houston, Texas 77030, USA</aff>
    <author-notes>
      <corresp>Corresponding authors: <email>hamim@iitk.ac.in</email>, <email>nakhleh@rice.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>11</month>
      <year>2019</year>
    </pub-date>
    <volume>29</volume>
    <issue>11</issue>
    <fpage>1847</fpage>
    <lpage>1859</lpage>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>8</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>7</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>
        <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/site/misc/terms.xhtml">© 2019 Zafar et al.; Published by Cold Spring Harbor Laboratory Press</ext-link>
      </copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This article is distributed exclusively by Cold Spring Harbor Laboratory Press for the first six months after the full-issue publication date (see <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/site/misc/terms.xhtml">http://genome.cshlp.org/site/misc/terms.xhtml</ext-link>). After six months, it is available under a Creative Commons License (Attribution-NonCommercial 4.0 International), as described at <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>.</license-p>
      </license>
    </permissions>
    <self-uri content-type="pdf" xlink:href="1847.pdf"/>
    <abstract>
      <p>Accumulation and selection of somatic mutations in a Darwinian framework result in intra-tumor heterogeneity (ITH) that poses significant challenges to the diagnosis and clinical therapy of cancer. Identification of the tumor cell populations (clones) and reconstruction of their evolutionary relationship can elucidate this heterogeneity. Recently developed single-cell DNA sequencing (SCS) technologies promise to resolve ITH to a single-cell level. However, technical errors in SCS data sets, including false-positives (FP) and false-negatives (FN) due to allelic dropout, and cell doublets, significantly complicate these tasks. Here, we propose a nonparametric Bayesian method that reconstructs the clonal populations as clusters of single cells, genotypes of each clone, and the evolutionary relationship between the clones. It employs a tree-structured Chinese restaurant process as the prior on the number and composition of clonal populations. The evolution of the clonal populations is modeled by a clonal phylogeny and a finite-site model of evolution to account for potential mutation recurrence and losses. We probabilistically account for FP and FN errors, and cell doublets are modeled by employing a Beta-binomial distribution. We develop a Gibbs sampling algorithm comprising partial reversible-jump and partial Metropolis-Hastings updates to explore the joint posterior space of all parameters. The performance of our method on synthetic and experimental data sets suggests that joint reconstruction of tumor clones and clonal phylogeny under a finite-site model of evolution leads to more accurate inferences. Our method is the first to enable this joint reconstruction in a fully Bayesian framework, thus providing measures of support of the inferences it makes.</p>
    </abstract>
    <funding-group>
      <award-group id="funding-1">
        <funding-source>
          <institution-wrap>
            <institution>National Science Foundation </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/100000001</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group id="funding-2">
        <funding-source>
          <institution-wrap>
            <institution>Directorate for Computer and Information Science and Engineering </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/100000083</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>IIS-1812822</award-id>
      </award-group>
      <award-group id="funding-3">
        <funding-source>
          <institution-wrap>
            <institution>National Cancer Institute </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/100000054</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R01 CA172652</award-id>
      </award-group>
      <award-group id="funding-4">
        <funding-source>Cancer Center</funding-source>
        <award-id>P30 CA016672</award-id>
      </award-group>
      <award-group id="funding-5">
        <funding-source>
          <institution-wrap>
            <institution>Andrew Sabin Family Foundation </institution>
            <institution-id institution-id-type="open-funder-registry">10.13039/100012287</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="13"/>
    </counts>
  </article-meta>
</front>
<body>
  <p>Acquisition of somatic mutations that confer selective growth advantage to the carrier cells drives initiation and progression of cancer (<xref rid="GR243121ZAFC46" ref-type="bibr">Vogelstein et al. 2013</xref>). From an evolutionary viewpoint, tumor progression is a somatic evolutionary process that gives rise to a composite mixture of genetically distinct subpopulations (clones) of cells through rounds of accumulation of somatic alterations, proliferation, and Darwinian selection in the tumor microenvironment (<xref rid="GR243121ZAFC35" ref-type="bibr">Nowell 1976</xref>; <xref rid="GR243121ZAFC30" ref-type="bibr">Merlo et al. 2006</xref>; <xref rid="GR243121ZAFC36" ref-type="bibr">Pepper et al. 2009</xref>; <xref rid="GR243121ZAFC50" ref-type="bibr">Yates and Campbell 2012</xref>). The genomic heterogeneity within a tumor, also known as intra-tumor heterogeneity (ITH) not only propels disease progression and metastasis (<xref rid="GR243121ZAFC45" ref-type="bibr">Turke et al. 2010</xref>; <xref rid="GR243121ZAFC49" ref-type="bibr">Wu et al. 2012</xref>) but can also lead to therapeutic relapse and drug resistance (<xref rid="GR243121ZAFC14" ref-type="bibr">Gillies et al. 2012</xref>; <xref rid="GR243121ZAFC3" ref-type="bibr">Burrell et al. 2013</xref>). High-throughput second-generation sequencing technologies have provided large-scale quantitative genomic data sets (<xref rid="GR243121ZAFC34" ref-type="bibr">Nik-Zainal et al. 2012</xref>; <xref rid="GR243121ZAFC20" ref-type="bibr">Kandoth et al. 2013</xref>) for investigating ITH. Most studies typically perform deep sequencing of bulk DNA retrieved from a single sample of the cancer tissue (<xref rid="GR243121ZAFC43" ref-type="bibr">Shah et al. 2012</xref>; <xref rid="GR243121ZAFC22" ref-type="bibr">Landau et al. 2015</xref>). Such data sets provide variant allele frequencies (VAFs) of somatic mutations, an aggregate signal averaged over the existing distinct tumor subclones as well as contaminating normal cells (<xref rid="GR243121ZAFC31" ref-type="bibr">Navin 2014</xref>), and VAFs are modeled as mixtures of subclones for their computational inference (<xref rid="GR243121ZAFC39" ref-type="bibr">Roth et al. 2014</xref>; <xref rid="GR243121ZAFC5" ref-type="bibr">Deshwar et al. 2015</xref>; <xref rid="GR243121ZAFC6" ref-type="bibr">El-Kebir et al. 2016</xref>; <xref rid="GR243121ZAFC19" ref-type="bibr">Jiang et al. 2016</xref>). However, the noisy aggregate signal of VAFs has limited resolution and thus restricts a comprehensive exploration of ITH (<xref rid="GR243121ZAFC31" ref-type="bibr">Navin 2014</xref>; <xref rid="GR243121ZAFC2" ref-type="bibr">Baslan and Hicks 2017</xref>). Sequencing multiple samples from different geographical regions of a tumor can improve upon single-sample bulk sequencing (<xref rid="GR243121ZAFC12" ref-type="bibr">Gerlinger et al. 2012</xref>, <xref rid="GR243121ZAFC13" ref-type="bibr">2015</xref>; <xref rid="GR243121ZAFC51" ref-type="bibr">Yates et al. 2015</xref>) but cannot resolve spatially intermixed subpopulations (<xref rid="GR243121ZAFC32" ref-type="bibr">Navin 2015</xref>).</p>
  <p>Ultimately, a single cell is the fundamental substrate of tumor evolution and single-cell DNA sequencing (SCS) has emerged as a powerful technique for resolving tumor evolution and ITH to a single-cell level (<xref rid="GR243121ZAFC17" ref-type="bibr">Hou et al. 2012</xref>; <xref rid="GR243121ZAFC11" ref-type="bibr">Gawad et al. 2014</xref>; <xref rid="GR243121ZAFC47" ref-type="bibr">Wang et al. 2014</xref>; <xref rid="GR243121ZAFC24" ref-type="bibr">Leung et al. 2017</xref>). Such technologies provide sequencing data pertaining to single cells, thus allowing for direct measurement of genotypes and prevalences of tumor subclones without requiring deconvolution of aggregate signals (<xref rid="GR243121ZAFC53" ref-type="bibr">Zafar et al. 2018</xref>). At the same time, they offer the possibility of reconstructing the clonal lineage tree. However, these tasks are challenged by a high level of experimental noise introduced in SCS data (<xref rid="GR243121ZAFC53" ref-type="bibr">Zafar et al. 2018</xref>) during the sample preparation and whole genome amplification (WGA) steps. WGA errors include false-positive (FP) and false-negative (FN) errors due to allelic dropout (ADO) (<xref rid="GR243121ZAFC31" ref-type="bibr">Navin 2014</xref>). FP errors are caused by deamination of cytosine bases and infidelity of polymerase enzymes. ADO affects the heterozygous loci as one of the alleles is preferentially amplified. Unintended isolation and processing of two cells together can result in cell doublets (characterized by merged genotype) (<xref rid="GR243121ZAFC53" ref-type="bibr">Zafar et al. 2018</xref>). Another problem with SCS data is missing entries due to coverage nonuniformity (<xref rid="GR243121ZAFC53" ref-type="bibr">Zafar et al. 2018</xref>).</p>
  <p>Single-cell somatic point mutation profiles have been used to infer clonal subpopulations. Early studies (<xref rid="GR243121ZAFC25" ref-type="bibr">Li et al. 2012</xref>; <xref rid="GR243121ZAFC47" ref-type="bibr">Wang et al. 2014</xref>) used multidimensional scaling and hierarchical clustering for reconstructing the tumor subclones, but such approaches fail to account for errors. <xref rid="GR243121ZAFC11" ref-type="bibr">Gawad et al. (2014)</xref> used a Bernoulli mixture model (BMM) to infer clusters of cells and predict cluster genotypes and performed model selection via a Bayesian information criterion (BIC) score. This approach was extended in the SCG method (<xref rid="GR243121ZAFC40" ref-type="bibr">Roth et al. 2016</xref>) to accommodate errors due to ADO and doublets. However, such approaches neither utilize the evolutionary relationship between the clonal clusters nor infer any phylogeny that can convey the evolutionary history of the tumor cells. Another direction with SCS data has been the reconstruction of cell lineages to study tumor evolution. SCITE (<xref rid="GR243121ZAFC18" ref-type="bibr">Jahn et al. 2016</xref>) and OncoNEM (<xref rid="GR243121ZAFC38" ref-type="bibr">Ross and Markowetz 2016</xref>) probabilistically model WGA-specific errors for inferring tumor lineages from SCS data. However, both SCITE and OncoNEM operate under the infinite sites assumption (ISA), which posits that no genomic site mutates more than once and mutations are never lost. This assumption could get violated in tumor evolution due to events including convergent evolution, chromosomal deletions, and loss of heterozygosity (LOH) (<xref rid="GR243121ZAFC4" ref-type="bibr">Davis and Navin 2016</xref>; <xref rid="GR243121ZAFC21" ref-type="bibr">Kuipers et al. 2017</xref>). SiFit (<xref rid="GR243121ZAFC52" ref-type="bibr">Zafar et al. 2017</xref>) employs a finite-site model of evolution to allow for mutation recurrence and losses and employs a maximum-likelihood-based approach for reconstructing tumor phylogeny. Finally, PhISCS (<xref rid="GR243121ZAFC27" ref-type="bibr">Malikic et al. 2019</xref>) is a combinatorial approach that employs integer linear programming for inferring phylogenetic trees that deviate slightly from the ISA from single-cell and bulk-sequencing data. However, these phylogeny approaches (other than OncoNEM) do not provide straightforward reconstruction of the tumor subclones. At the same time, none of these phylogeny-based methods account for cell doublets as the merged genotypes cannot be represented by a cell lineage tree model.</p>
  <p>Here, we propose SiCloneFit, a unified statistical framework and computational method that simultaneously addresses the problems of subclonal reconstruction and phylogeny inference from single-cell sequencing data. Our unified model simultaneously (1) estimates the number of tumor clones, (2) identifies the tumor clones as clusters of single cells, (3) predicts the mutations associated with each tumor clone (clonal genotype), and (4) under a finite-site model of evolution places the tumor clones at the leaves of a phylogenetic tree (clonal tree) that models their genealogical relationships.</p>
  <sec sec-type="results" id="s1">
    <title>Results</title>
    <sec id="s1a">
      <title>Overview of SiCloneFit</title>
      <p>SiCloneFit integrates nonparametric Bayesian mixture modeling based on a Chinese restaurant process with the finite-sites-based phylogenetic approach introduced in SiFit (<xref rid="GR243121ZAFC52" ref-type="bibr">Zafar et al. 2017</xref>). Using single-cell somatic point mutation profiles as input, SiCloneFit introduces a nonparametric Bayesian mixture model based on a phylogeny-based Chinese restaurant process (clusters reside at the leaves of a phylogeny) to identify clusters (clones) of cells that share mutations and to resolve the clonal genotypes (mutations associated with a clonal cluster). The evolution of the clonal genotypes is modeled using a clonal phylogeny and a finite-site model of evolution that accounts for the effects of deletion, LOH, and point mutations at the genomic sites. SiCloneFit adopts the probabilistic error model of SiFit to account for FP and FN errors in SCS. The doublet-aware model of SiCloneFit employs a Beta-binomial distribution to accommodate for the presence of cell doublets and augments the nonparametric Bayesian mixture model with another finite mixture model to allow for the placement of a potential doublet in two clonal clusters. SiCloneFit employs a Gibbs sampling algorithm comprised of partial reversible-jump and partial Metropolis-Hastings updates to explore the joint posterior space of all parameters. To the best of our knowledge, SiCloneFit is the first Bayesian framework that jointly reconstructs clonal populations and their evolutionary history from SCS data sets under a finite-site model of evolution while accounting for cell doublets along with other WGA artifacts.</p>
    </sec>
    <sec id="s1b">
      <title>Description of SiCloneFit model</title>
      <p>We start with a brief description of the formulation of the joint inference problem and the SiCloneFit model. Overview of the SiCloneFit model is given in <xref ref-type="fig" rid="GR243121ZAFF1">Figure 1</xref>A.</p>
      <fig id="GR243121ZAFF1" orientation="portrait" position="float">
        <label>Figure 1.</label>
        <caption>
          <p>Overview of SiCloneFit Model. (<italic>A</italic>) From an observed noisy genotype matrix of single cells, SiCloneFit infers the clonal clusters, clonal phylogeny, and clonal genotypes of single cells. (<italic>B</italic>) A probabilistic graphical model representing the singlet model of SiCloneFit. Shaded nodes represent the observed values or fixed parameters; unshaded nodes are the latent variables that are of interest; a posterior distribution over the values of the unshaded nodes is approximated using samples from the proposed Gibbs sampler. The variables and indices are described in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Methods</ext-link>. (<italic>C</italic>) Distributional assumptions for the different variables in the SiCloneFit singlet model.</p>
        </caption>
        <graphic xlink:href="1847f01"/>
      </fig>
      <p>A tumor population (clone) refers to a set of cells that share a common genotype as they descend from a common ancestor (<xref rid="GR243121ZAFC30" ref-type="bibr">Merlo et al. 2006</xref>). In the context of single-cell sequencing, a clonal population refers to a maximal set of cells with identical genotype (with respect to the set of mutations under analysis) (<xref rid="GR243121ZAFC40" ref-type="bibr">Roth et al. 2016</xref>). We model the lineage of the clonal populations using a clonal phylogeny, a rooted directed binary tree, the root of which represents normal (unmutated) genotype, and somatic mutations are accumulated along the branches of the phylogeny. The sampling of single cells from the tumor at any point in time is analogous to horizontally slicing the clonal phylogeny to obtain samples from the leaves. The leaves of the clonal phylogeny represent the clonal populations, and the sampled cells are individuals sampled from each leaf. The DNA from each sampled cell goes through the process of single-cell DNA sequencing and mutation calling, which provides the observed genotype matrix <bold>D</bold> = <italic>D</italic><sub>n×m</sub> for <italic>m</italic> single cells and <italic>n</italic> somatic mutation sites.</p>
      <p>In SiCloneFit, we model this generative process using the probabilistic graphical model shown in <xref ref-type="fig" rid="GR243121ZAFF1">Figure 1</xref>B (also <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S1</ext-link>). Here, we briefly describe the singlet model (all sampled cells are assumed to be singlets) of SiCloneFit. The probabilistic graphical model for the doublet-aware model is shown in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Figure S2</ext-link>. The model variables, hyperparameters, and associated indices are introduced in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Tables S1–S3</ext-link>. For a detailed description of the singlet and doublet-aware model of SiCloneFit, see <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Methods</ext-link>.</p>
      <p>We consider somatic single nucleotide variant (SNV) sites, where the input data is represented by a matrix that records the observed genotype for each cell for each mutation site. The input matrix can be binary, when the presence (denoted by 1) or absence (denoted by 0) of a mutation is noted. For a ternary matrix, the three possible genotype states, 0, 1, and 2 correspond to homozygous reference, and heterozygous and homozygous nonreference genotypes, respectively. We assume that there is a set of <italic>K</italic> clonal populations from which a total of <italic>m</italic> single cells are sampled and the clonal populations can be placed at the leaves of a clonal phylogeny, <inline-formula><mml:math id="il1"><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:math></inline-formula>. Each clonal population contains a set of cells that have identical genotype and share a common ancestor. It is important to note that <italic>K</italic> is unknown. To infer the number of clones and assign the cells to clones, we introduce a tree-structured infinite mixture model. In our model, we extend the tree-structured Chinese restaurant process (CRP) prior from <xref rid="GR243121ZAFC29" ref-type="bibr">Meeds et al. (2008)</xref> to define a nonparametric Bayesian prior over binary trees, leaves of which represent the mixture components (clonal clusters). The clonal phylogeny represents the genealogical relationship between the clonal populations. A tree-structured infinite mixture model has been used for inferring tumor phylogeny from bulk-sequencing data (<xref rid="GR243121ZAFC5" ref-type="bibr">Deshwar et al. 2015</xref>). The genotype vector associated with a clone is called clonal genotype, and it records the genotype values for all mutation sites for the corresponding clone. To model the evolution of the clonal genotypes along the branches of <inline-formula><mml:math id="il2"><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:math></inline-formula>, we employ a finite-site model of evolution, <inline-formula><mml:math id="il3"><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msub></mml:math></inline-formula>, that accounts for the effects of point mutations, deletion, and LOH on the clonal genotypes. The model of evolution assigns transition probabilities to different genotype transitions along the branches of the clonal phylogeny. The true genotype of each cell is identical to the clonal genotype of the clonal cluster where it is assigned. However, observed genotypes of single cells can differ from their true genotype due to amplification errors introduced during the SCS work flow. The effect of amplification errors is modeled using an error model distribution parameterized by FP error rate <italic>α</italic> and FN error rate <italic>β</italic>. The generative process is described in detail in Methods and the distributional assumptions of the model are shown in <xref ref-type="fig" rid="GR243121ZAFF1">Figure 1</xref>C.</p>
      <p>SiCloneFit attempts to jointly reconstruct the tumor clones as clusters of single cells, clonal genotypes, and the clonal phylogeny. In doing so, it employs a likelihood function and a compound prior to define the posterior distribution over these latent variables. SiCloneFit employs a Markov chain Monte Carlo (MCMC) sampling procedure based on the Gibbs sampling algorithm comprised of partial reversible-jump and partial Metropolis-Hastings updates to estimate the latent variables. The posterior distribution and the inference algorithm are described in Methods and <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Methods</ext-link>.</p>
    </sec>
    <sec id="s1c">
      <title>Benchmarking on simulated data sets</title>
      <p>We performed comprehensive simulations to evaluate the performance of SiCloneFit in (1) clustering the cells into different clones, (2) inferring the genotypes of the cells via clonal genotyping, and (3) reconstructing the clonal lineage. To generate benchmarking data sets, we first sampled observed clonal prevalences for a fixed number of clones from a Dirichlet distribution, and the cells were assigned to different clones using a multinomial distribution. Then, we constructed linear and branching topologies for clonal phylogeny using the Beta-splitting model (<xref rid="GR243121ZAFC41" ref-type="bibr">Sainudiin and Véber 2016</xref>). The clonal genotypes at the leaves of the phylogeny were simulated in a similar fashion as described in <xref rid="GR243121ZAFC52" ref-type="bibr">Zafar et al. (2017)</xref>. Different SCS artifacts were then introduced on the cellular genotypes to produce the noisy observed genotypes which were used as the input data for inference. The simulation process is described in detail in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Results</ext-link>.</p>
      <p>To compare the results of SiCloneFit against the ground truth, we summarized the posterior samples from the Gibbs sampler of SiCloneFit. The clustering samples were summarized by the maximum posterior expected adjusted Rand (MPEAR) method (<xref rid="GR243121ZAFC10" ref-type="bibr">Fritsch and Ickstadt 2009</xref>). To summarize the clonal phylogeny samples, we constructed a maximum clade credibility topology (MCCT) from the posterior samples using DendroPy (<xref rid="GR243121ZAFC44" ref-type="bibr">Sukumaran and Holder 2010</xref>). From the posterior samples, we computed the posterior probability of the genotype of each cell at each mutation site, and the genotype with the highest posterior probability was assigned as the inferred genotype. When using the doublet-aware model of SiCloneFit, the doublets were inferred based on the posterior probability and were filtered out for subsequent analysis. The summarization methods are described in detail in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Results</ext-link>.</p>
      <p>We compared SiCloneFit's performance against SCG (<xref rid="GR243121ZAFC40" ref-type="bibr">Roth et al. 2016</xref>), OncoNEM (<xref rid="GR243121ZAFC38" ref-type="bibr">Ross and Markowetz 2016</xref>), SiFit (<xref rid="GR243121ZAFC52" ref-type="bibr">Zafar et al. 2017</xref>), and SCITE (<xref rid="GR243121ZAFC18" ref-type="bibr">Jahn et al. 2016</xref>). SCG was used to infer clonal genotypes and clonal structures from the single cell somatic SNV profiles. The clonal phylogeny was obtained by running a maximum parsimony algorithm (<xref rid="GR243121ZAFC42" ref-type="bibr">Schliep 2011</xref>) on the clonal genotypes as suggested in the original study (<xref rid="GR243121ZAFC40" ref-type="bibr">Roth et al. 2016</xref>). OncoNEM was used to infer a clonal tree from the single cell somatic SNV profiles. Clonal genotypes were obtained by inferring the occurrence of the mutation on the branches of the clonal tree. SiFit inferred a cell lineage tree, the leaves of which represent the single cells. Mutations were inferred on the branches of this phylogeny using SiFit's mutation placement algorithm, which also resulted in inferring the genotype vector for each cell. The cells were clustered into a number of clones that resulted in the highest silhouette score for <italic>k</italic>-medoids clustering of the cells based on a distance matrix obtained from the inferred cell lineage tree. SCITE was used to infer a mutation tree from the noisy single-cell mutation profiles. The attachments of the cells on the nodes of the mutation tree also helped in inferring the genotype of each cell. We inferred the clonal populations by clustering the cells using a silhouette score-based <italic>k</italic>-medoids clustering based on a distance matrix obtained from the mutation tree. Details of how results were extracted for each method are described in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Results</ext-link>.</p>
      <p>The clustering accuracy of each method was measured using the Adjusted Rand Index (ARI) and B-cubed <italic>F</italic>-score (<xref rid="GR243121ZAFC1" ref-type="bibr">Amigó et al. 2009</xref>) for data sets without and with doublets, respectively. For evaluating the genotyping performance of each method, we computed the genotyping error defined by the average Hamming distance (number of entries differing) per cell per site between the true and inferred genotypes of the cells. For an assessment of the phylogeny inference, we used the tree reconstruction error computed as the pairwise cell shortest-path distance (<xref rid="GR243121ZAFC38" ref-type="bibr">Ross and Markowetz 2016</xref>) between the true and inferred clonal phylogeny. The performance metrics are described in detail in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Results</ext-link>.</p>
      <p>SiCloneFit employs a finite-site model of evolution along the branches of the clonal phylogeny to account for the effects of possible mutation losses and recurrence on the clonal genotypes. To analyze how well this finite-site model performs in conjunction with the tree-structured infinite mixture model in recovering the clonal genotypes of the single cells under varying rates of mutation recurrence and losses, we conducted three sets of experiments. For the three sets, varying probabilities for deletion (<italic>d</italic>), loss of heterozygosity (<italic>ω</italic>), and recurrent mutation (<italic>r</italic>) were used for simulation, respectively. An extreme setting (<italic>d</italic> = 0, <italic>ω</italic> = 0, <italic>r</italic> = 0) of these parameters also generated data sets under the infinite-sites model. The first two parameters resulted in loss of mutations; the third one introduced parallel recurrent mutations. For these experiments, we compared SiCloneFit's result against that of SiFit (the only other method employing a finite-site model) to test whether SiCloneFit's additional ability to cluster the cells results in improved performance. Details of these experiments have been described in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Results</ext-link>. For different values of deletion probability, SiCloneFit performed superiorly over SiFit based on all three metrics (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S3</ext-link>). Specifically, SiCloneFit achieved major improvement over SiFit in reducing the genotyping error and tree reconstruction error. Similarly, for different values of the probability of LOH, SiCloneFit achieved better or similar clustering accuracy (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S4A</ext-link>) and reasonably reduced tree reconstruction error (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S4B</ext-link>) and genotyping error (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S4C</ext-link>) compared to SiFit. For the data sets generated under the infinite-sites model (<italic>d</italic> = 0, <italic>ω</italic> = 0, <italic>r</italic> = 0), both SiCloneFit and SiFit achieved high clustering accuracy, but SiCloneFit outperformed SiFit in reconstructing the clonal genotypes and the phylogeny (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S5</ext-link>). For different values of recurrent mutation probability (<italic>r</italic>), SiCloneFit performed better than SiFit in inferring the clonal phylogeny and the genotypes (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S5</ext-link>).</p>
      <p>To evaluate SiCloneFit's singlet model, we first conducted simulations excluding doublets. For a fixed number of clones, we simulated data sets with varying number of cells and varying number of sites. For these data sets, we compared against SCG, OncoNEM, SiFit, and SCITE. However, for larger sized data sets (<italic>m</italic> = 500), OncoNEM failed to run. Clustering accuracy (<xref ref-type="fig" rid="GR243121ZAFF2">Fig. 2</xref>A; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S6</ext-link>) and phylogeny inference accuracy (<xref ref-type="fig" rid="GR243121ZAFF2">Fig. 2</xref>C; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S8</ext-link>) of each method improved as the number of sites increased. Genotyping error (<xref ref-type="fig" rid="GR243121ZAFF2">Fig. 2</xref>B; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S7</ext-link>) of each method reduced with an increase in the number of sites. For each experimental setting, SiCloneFit performed the best in terms of all performance metrics. For larger sized data sets, it achieved perfect clustering for almost all data sets. In the presence of a higher number of clonal populations, sampling the same number of cells leads to a more difficult inference problem. Even for such situations, SiCloneFit performed the best based on all three metrics (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S9</ext-link>), and it was robust against the increase in number of clones as evidenced by its low rate of reduction in clustering accuracy. SiCloneFit's performance was also robust against increasing error rate. With an increase in the FN rate, performance of each method degraded, but SiCloneFit had the lowest amount of reduction in performance, and it also outperformed all other methods for all values of FN rate (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S10</ext-link>). The same trend was observed when false positive rate was elevated (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S11</ext-link>). SiCloneFit's performance was robust to an increase in FP rate, and it performed superiorly over all other methods based on all three metrics. In this setting, for some data sets, SCG's genotyping failed to converge and resulted in a large number of false predictions. For larger data sets, we also tested the effect of missing data on inference accuracy. For these experiments, we compared SiCloneFit's results to that of only SCG as SCG was overall the second best performer (matched or outperformed by SiFit for some settings) in all our previous experiments. Even in the presence of a high amount of missing data, SiCloneFit performed well in clustering the cells into clones and inferring the clonal phylogeny. It consistently performed better than SCG (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Figs. S12–S14</ext-link>) in terms of all metrics. Only in one setting (<italic>n</italic> = 100, 30% missing data) did SCG achieve lower genotyping error than SiCloneFit.</p>
      <fig id="GR243121ZAFF2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>Performance comparison on simulated data sets containing 100 cells. SiCloneFit's performance is compared against that of SCG, OncoNEM, SiFit, and SCITE on simulated data sets containing 100 cells for varying numbers of sites. On the <italic>x</italic>-axis, we have results corresponding to <italic>n</italic> = 50 and <italic>n</italic> = 100. The cells were sampled from <italic>K</italic> = 10 clonal populations. Each box plot summarizes results for 10 simulated data sets with varying clonal phylogeny and varying size of clonal clusters. (<italic>A</italic>) Comparison of clustering accuracy measured in terms of Adjusted Rand Index that compares the inferred clustering against the ground truth. (<italic>B</italic>) Comparison based on the genotyping error measured in terms of Hamming distance per cell per site between the true genotype matrix and inferred genotype matrix. (<italic>C</italic>) Comparison based on the tree reconstruction error measured in terms of pairwise cell shortest-path distance between the true clonal phylogeny and inferred clonal phylogeny.</p>
        </caption>
        <graphic xlink:href="1847f02"/>
      </fig>
      <p>While most human tumors show evidence of at least weak selection leading to the prevalence of clonal subpopulations that harbor driver mutations (<xref rid="GR243121ZAFC15" ref-type="bibr">Greaves and Maley 2012</xref>), some tumors might undergo neutral evolution as shown in <xref rid="GR243121ZAFC26" ref-type="bibr">Ling et al. (2015)</xref> and <xref rid="GR243121ZAFC48" ref-type="bibr">Williams et al. (2016)</xref>. To analyze SiCloneFit's performance under neutral evolution that can lead to an absence of clonal structure, we conducted simulation experiments under the neutral evolution model proposed in <xref rid="GR243121ZAFC48" ref-type="bibr">Williams et al. (2016)</xref>. The neutral evolution model in <xref rid="GR243121ZAFC48" ref-type="bibr">Williams et al. (2016)</xref> posits that the number of subclonal mutations should follow the 1/<italic>f</italic> power law distribution (<italic>f</italic> being the allelic frequency of a mutation), and the cumulative distribution <italic>M</italic>(<italic>f</italic>) of subclonal mutations should have a linear relationship with 1/<italic>f</italic>. We simulated data sets satisfying these conditions (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S15</ext-link>) and compared SiCloneFit's results to that of SCG, SiFit, and SCITE (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S16</ext-link>). For these data sets, SiCloneFit performed either similarly or better than the other methods based on the different metrics (see <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Results</ext-link> for details).</p>
      <p>We further evaluated SiCloneFit's ability to estimate the error rates from the data sets. SiCloneFit performed very well for estimating both FP rate <italic>α</italic> and FN rate <italic>β</italic> (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S17</ext-link>). For data sets generated under a wide range of error rate values, SiCloneFit's estimated error rates were highly correlated (0.998 for <italic>α</italic> and 0.992 for <italic>β</italic>) to the original error rates used for generating the data sets. In order to evaluate SiCloneFit's ability to infer the correct number of clusters, we generated data sets under varying levels of sampling distortion. Higher sampling distortion leads to the sampled cells deviating from the true prevalences of the clonal clusters, making it more difficult to infer the actual number of clusters. SiCloneFit's performance in inferring the actual number of clusters improved as the amount of sampling distortion reduced from high to moderate to low (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S18</ext-link>). Even in the presence of high sampling distortion, it inferred the actual number of clusters for some data sets and only missed rare clusters (consisting of one cell). SiCloneFit also performed well for data sets containing a large number of cells (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S19</ext-link>) and large number of sites (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S20</ext-link>).</p>
      <p>Next, we performed simulations including 10% doublets to evaluate SiCloneFit's doublet model. SCG is the only other method that accounts for the presence of doublets. As a consequence, for these data sets, we only compared SiCloneFit's results against that of SCG. For a fixed number of clones, we simulated data sets with varying number of cells and varying number of sites. SiCloneFit achieved higher clustering accuracy (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S21</ext-link>) and genotyping accuracy (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S22</ext-link>) compared to SCG. It also achieved lower tree reconstruction error (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S23</ext-link>) in all settings except for <italic>m</italic> = 500 and <italic>n</italic> = 100. For some data sets, SCG failed to converge and resulted in very low clustering accuracy and high genotyping error. In the presence of a higher number of clonal populations, SiCloneFit significantly outperformed SCG (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S24</ext-link>). Finally, we evaluated how inference is affected when missing data and doublets are simultaneously present. Even in the presence of a high amount of missing data (15%, 30%), both methods performed well in clustering (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S25</ext-link>) the cells to clones, with SiCloneFit performing better than SCG in all settings. For all settings, SiCloneFit's genotyping performance (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S26</ext-link>) was better than that of SCG's. For some data sets, SCG failed to converge and resulted in low clustering accuracy and high genotyping error. SiCloneFit's tree reconstruction error (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S27</ext-link>) was also smaller in all but one setting (<italic>n</italic> = 100 and 15% missing data).</p>
    </sec>
    <sec id="s1d">
      <title>Inference of clonal clusters, genotypes, and phylogeny from experimental SCS data</title>
      <p>We applied SiCloneFit to two experimental single-cell DNA sequencing data sets from two metastatic colon cancer patients, obtained from the study of <xref rid="GR243121ZAFC24" ref-type="bibr">Leung et al. (2017)</xref>. These data sets were generated using a highly multiplexed single-cell DNA sequencing method (<xref rid="GR243121ZAFC23" ref-type="bibr">Leung et al. 2016</xref>) and a 1000-cancer gene panel was used as the target region for sequencing. These are two of the most recent SCS data sets and contain a large number of cells and a small number of mutation sites, making the inference difficult.</p>
      <p>The first data set consisted of 178 cells (<xref rid="GR243121ZAFC24" ref-type="bibr">Leung et al. 2017</xref>) obtained from both primary colon tumor and liver metastasis. The original study reported 16 somatic SNVs after variant calling. The reported genotypes were binary values, representing the presence or absence of a mutation at the SNV sites. In the original study, SCITE (<xref rid="GR243121ZAFC18" ref-type="bibr">Jahn et al. 2016</xref>) was used for performing phylogenetic analysis of this tumor. However, SCITE operates under the infinite sites assumption and only infers the mutation tree. We ran the four-gamete test on this data set, which identified 104 (out of 120) pairs of SNV sites violating the four-gamete test, indicating potential violation of the infinite sites assumption. Multiple potential events including mutation recurrence and loss, FP and FN error could have caused such a high number of violations of the four-gamete test (<xref rid="GR243121ZAFC52" ref-type="bibr">Zafar et al. 2017</xref>). After running SiCloneFit on this data set, we collected the samples from the posterior and computed a maximum clade credibility tree based on the posterior samples, as shown in <xref ref-type="fig" rid="GR243121ZAFF3">Figure 3</xref>A. Five different clusters were identified from the SiCloneFit posterior samples. The largest cluster (N) consisted of normal cells without any somatic mutation. The primary tumor cells were clustered into two subclones (P1 and P2). Metastatic aneuploid tumor cells were clustered into one subclone (M). There was another cluster (D) consisting of diploid cells (mostly metastatic). The clonal genotype of each cluster was inferred based on the posterior samples. The inferred genotypes are shown in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Figure S28</ext-link>. Based on the clonal genotypes, we inferred the ancestral sequences at the internal nodes, and this enabled us to find the maximum-likelihood solution for placing the mutations on the branches of the clonal phylogeny. First, a heterozygous nonsense mutation was acquired in <italic>APC</italic> along with mutations in the <italic>KRAS</italic> oncogene and <italic>TP53</italic> tumor suppressor gene, and these initiated the tumor mass. The subclone (D) consisting of diploid cells acquired another mutation in <italic>GATA1</italic> and branched out from the primary tumor mass. The primary tumor subclones developed by acquiring six more somatic mutations, including a mutation in the <italic>CCNE1</italic> oncogene. These mutations were subsequently inherited in the metastatic tumor subclone (M). The accumulation of mutations in <italic>EYS</italic>, <italic>GATA1</italic>, <italic>RBFOX1</italic>, <italic>TRRAP</italic>, and <italic>ZNF521</italic> marked the point of metastatic divergence. The two primary tumor subclones were distinguished by the presence/absence of <italic>TPM4</italic> mutation. It was specific to the second primary subclone (P2) and was not identified in any of the metastatic tumor cells, suggesting that the first primary subclone (P1) disseminated and established the metastatic tumor mass. The clonal phylogeny displayed recurrence of the <italic>GATA1</italic> mutation that was not identified in the original study. This finding was further supported by a mixture-model Bayesian binomial test (<xref rid="GR243121ZAFC24" ref-type="bibr">Leung et al. 2017</xref>) based on the read counts of the <italic>GATA1</italic> mutation (see <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Results</ext-link> for details). We ran MACHINA (<xref rid="GR243121ZAFC7" ref-type="bibr">El-Kebir et al. 2018</xref>) on the clonal phylogeny inferred by SiCloneFit for reconstructing the migration history of the tumor clones for this patient. The inferred migration graph (<xref ref-type="fig" rid="GR243121ZAFF3">Fig. 3</xref>B) had two migrations with comigration number = 1. Since two anatomical sites were sequenced, the inference of a minimum possible comigration number indicates a single-source seeding pattern with colon being the source. The presence of a multiedge in the migration graph also indicates polyclonal seeding, where liver was seeded by two different clones that originated in colon. However, the first seeding did not result in the clonal expansion; metastatic tumor mass formed after the second seeding that was associated with the mutations in <italic>EYS</italic>, <italic>GATA1</italic>, <italic>RBFOX1</italic>, <italic>TRRAP</italic>, and <italic>ZNF521</italic>. None of the cells were inferred as doublets by the doublet-aware model of SiCloneFit. This finding was further supported by the doublet detection by SCG, which also did not find any doublet. This is expected, as the cells in this data set were isolated using FACS Aria II (<xref rid="GR243121ZAFC24" ref-type="bibr">Leung et al. 2017</xref>), which included a protocol for removing doublets.</p>
      <fig id="GR243121ZAFF3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>Inference of tumor clones and clonal phylogeny using SiCloneFit for metastatic colorectal cancer patient CRC1. (<italic>A</italic>) Maximum clade credibility tree reconstructed from the posterior samples obtained using SiCloneFit. Each tumor clone is a cluster of single cells, and their genotypes are also inferred. The temporal order of the mutations is reconstructed, and mutations are annotated on the branches of the clonal tree. The cancer genes and tumor-suppressor genes are marked in purple. The colors of the shades represent the organ/anatomical site of the origin of the cells. (<italic>B</italic>) Parsimonious migration history of the tumor clones inferred using MACHINA (<xref rid="GR243121ZAFC7" ref-type="bibr">El-Kebir et al. 2018</xref>) with the SiCloneFit inferred clonal tree as input. The <italic>top</italic> figure shows the clonal tree where the leaves are annotated by the anatomical sites and the anatomical sites annotation of the internal nodes and root are inferred by MACHINA. The <italic>bottom</italic> figure shows the migration graph of the cells with migration number 2 and comigration number 1. This indicates polyclonal single-source seeding from colon to liver.</p>
        </caption>
        <graphic xlink:href="1847f03"/>
      </fig>
      <p>For comparison, we ran SCG on this data set. SCG reported four clonal clusters, and the inferred clonal genotypes are shown in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Figure S29</ext-link>. SCG could not distinguish the primary tumor cells on the basis of the presence/absence of the <italic>TPM4</italic> mutation and genotyped all of them to contain <italic>TPM4</italic>. Thus, it did not report two primary tumor subclones that were detected by SiCloneFit and instead only one primary tumor subclone (all primary tumor cells were assigned to this cluster) was inferred.</p>
      <p>The second data set consisted of 182 cells (<xref rid="GR243121ZAFC24" ref-type="bibr">Leung et al. 2017</xref>) obtained from both primary colon tumor and liver metastasis. The original study reported 36 somatic SNVs after variant calling. The reported genotypes were binary values, representing the presence or absence of a mutation at the SNV sites. After running the four-gamete test on this data set, we identified 347 (out of 630) pairs of SNV sites violating the four-gamete test, indicating potential violation of the infinite sites assumption. After running SiCloneFit on this data set, we collected the samples from the posterior and computed a maximum clade credibility tree based on the posterior samples, as shown in <xref ref-type="fig" rid="GR243121ZAFF4">Figure 4</xref>A. Six different clusters were identified in the MPEAR solution based on the posterior samples. The largest cluster (N) consisted of normal cells that did not harbor any somatic mutation. There were two clusters consisting of primary aneuploid tumor cells (P1 and P2) and two clusters consisting of metastatic aneuploid tumor cells (M1 and M2). There was one more cluster (I) comprised of diploid cells that harbored somatic mutations that were completely different from the primary or metastatic clusters, representing an independent clonal lineage consistent with the findings reported by <xref rid="GR243121ZAFC24" ref-type="bibr">Leung et al. (2017)</xref>. The clonal genotype of each cluster was inferred based on the posterior samples. The inferred genotypes are shown in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Figure S30</ext-link>. Based on the clonal genotypes, we inferred the ancestral sequences at the internal nodes, and this enabled us to find the maximum-likelihood solution for placing the mutations on the branches of the clonal phylogeny. The first primary tumor clone (P1) evolved from the normal cells by acquiring eight mutations, including mutations in <italic>APC</italic>, <italic>NRAS</italic>, <italic>CDK4</italic>, and <italic>TP53</italic>. After that, four additional mutations (<italic>CHN1</italic>, <italic>APC</italic>, <italic>LINGO2</italic>, <italic>IL21R</italic>) were acquired before the first metastatic cluster (M1) diverged. After dissemination into liver, the first metatstatic subclone (M1) continued to evolve and acquired a number of metastasis-specific mutations (e.g., <italic>SPEN</italic>, <italic>IL7R</italic>, <italic>PIK3CG</italic>, <italic>F8</italic>, <italic>LINGO2</italic>). Before the divergence of the second metastatic subclone (M2), two more mutations (<italic>FHIT</italic>, <italic>ATP7B</italic>) were acquired that were also present in the second primary tumor subclone P2. The second primary tumor clone (P2) acquired two additional mutations in <italic>LRP1B</italic> and <italic>LINGO2</italic> that were not present in either metastatic clone. The second metastatic clone disseminated after acquiring the <italic>ATP7B</italic> mutation and further expanded the liver tumor mass by acquiring seven additional mutations (e.g., <italic>PTPRD</italic>, <italic>NR4A3</italic>, <italic>HELZ</italic>, <italic>TSHZ3</italic>). In the original study, SCITE identified two different lineages for metastatic cells and inferred four mutations (<italic>FHIT</italic>, <italic>ATP7B</italic>, <italic>APC</italic>, and <italic>CHN1</italic>) between the two metastatic divergence events. These were called as “bridge mutations.” In contrast, SiCloneFit identified two mutations (<italic>FHIT</italic> and <italic>ATP7B</italic>) as “bridge mutations,” and the other two putative bridge mutations (<italic>APC</italic>, and <italic>CHN1</italic>) were identified as nonbridge and placed before the divergence of the first metastatic subclone. To evaluate these results, we performed the mixture-model Bayesian binomial test proposed in <xref rid="GR243121ZAFC24" ref-type="bibr">Leung et al. (2017)</xref> based on the read counts for these four mutations, which further indicated that SiCloneFit's placement of these mutations in the tumor phylogeny is more plausible than that of SCITE (see <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Results</ext-link>; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Figs. S31, S32</ext-link> for details). Other than the precursor mutations shared with the primary tumor clones, the metastatic tumor clones had three more mutations in common (<italic>PTPRD</italic>, <italic>FUS</italic>, and <italic>LINGO2</italic>). This is evidence for a potential convergent evolution. To evaluate the accuracy of this, we performed the mixture-model Bayesian binomial test (<xref rid="GR243121ZAFC24" ref-type="bibr">Leung et al. 2017</xref>), which provided strong evidence of recurrence for two of these mutations (<italic>FUS</italic> and <italic>LINGO2</italic>) (see <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S33</ext-link>; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Results</ext-link> for details). Apart from the primary and metastatic tumor clones, there was another cluster (I) consisting of seven primary diploid cells that had completely independent somatic mutations. These cells acquired mutations in <italic>SPEN</italic>, <italic>ALK</italic>, <italic>ATR</italic>, <italic>NR3C2</italic>, and <italic>EPHB6</italic> but did not share any other mutations with the primary or metastatic tumor cells, representing an entirely different tumor lineage that did not expand significantly. We reconstructed the migration history of the tumor clones by running MACHINA (<xref rid="GR243121ZAFC7" ref-type="bibr">El-Kebir et al. 2018</xref>) on the SiCloneFit inferred clonal phylogeny, whose leaves (clonal clusters) were annotated by the anatomical site of origin of the associated cells. The inferred migration graph (<xref ref-type="fig" rid="GR243121ZAFF4">Fig. 4</xref>B) had two migrations with comigration number = 1 (also the minimum possible comigration number for two anatomical sites), indicating polyclonal single-source seeding from colon to liver. Here, both the seeding events led to expansion of tumor mass in liver and resulted in two different metastatic subclones. For this data set also, none of the cells were inferred as a doublet by SiCloneFit's doublet-aware model. Similarly, SCG did not detect any doublet in this data set.</p>
      <fig id="GR243121ZAFF4" orientation="portrait" position="float">
        <label>Figure 4.</label>
        <caption>
          <p>Inference of tumor clones and clonal phylogeny using SiCloneFit for metastatic colorectal cancer patient CRC2. (<italic>A</italic>) Maximum clade credibility tree reconstructed from the posterior samples obtained using SiCloneFit. Each tumor clone is a cluster of single cells, and their genotypes are also inferred. The temporal order of the mutations is reconstructed, and mutations are annotated on the branches of the clonal tree. The cancer genes and tumor-suppressor genes are marked in purple. The colors of the shades represent the organ/anatomical site of the origin of the cells. (<italic>B</italic>) Parsimonious migration history of the tumor clones inferred using MACHINA (<xref rid="GR243121ZAFC7" ref-type="bibr">El-Kebir et al. 2018</xref>) with the SiCloneFit inferred clonal tree as input. The <italic>top</italic> figure shows the clonal tree where the leaves are annotated by the anatomical sites and the anatomical sites annotation of the internal nodes and root are inferred by MACHINA. The <italic>bottom</italic> figure shows the migration graph of the cells with migration number 2 and comigration number 1. This indicates polyclonal single-source seeding from colon to liver.</p>
        </caption>
        <graphic xlink:href="1847f04"/>
      </fig>
      <p>SCG reported five clonal clusters from this data set (<ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S34</ext-link>). Clustering and genotyping results of SCG mostly agreed with that of SiCloneFit. However, SCG failed to detect two primary tumor subclones and instead clustered them together into one subclone, resulting in incorrect genotyping for those cells.</p>
      <p>To validate SiCloneFit's doublet detection from experimental SCS data, we applied SiCloneFit on a high-grade serous ovarian cancer data set introduced in <xref rid="GR243121ZAFC28" ref-type="bibr">McPherson et al. (2016)</xref> consisting of 370 cells and 43 somatic mutations. Since, ground truth doublets were not known for this data set, we compared the results of the doublet-aware models of SiCloneFit and SCG on this data set. Seventeen cells were reported as doublets by both of these methods. SCG reported 11 additional doublets, 10 of which had similar posterior probabilities (computed by SCG) of being a doublet or a singlet (see <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Fig. S35</ext-link>; <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Results</ext-link> for details).</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s2">
    <title>Discussion</title>
    <p>Inference of tumor subclones and their evolutionary history is of paramount importance given their contribution to drug resistance and therapeutic relapse. While this problem has been investigated in depth in the context of bulk-sequencing data, methods are lacking for SCS data, the most promising and high-resolution data for studying tumor heterogeneity. Here, we reported on SiCloneFit, a novel probabilistic framework for inferring the number and structure of tumor clones, their genotypes, and evolutionary history from noisy somatic SNV profiles of single cells. Our unified framework jointly reconstructs the tumor clones as clusters of single cells as well as their genealogical relationship in the form of a clonal phylogeny. In this process, SiCloneFit accounts for the effects of mutational events (point mutations, LOH, deletion) in the evolutionary history of the tumor via a finite-site model of evolution and denoises the effects of technical artifacts such as allelic dropout, false-positive errors, missing entries, and cell-doublets to infer the clonal genotypes. SiCloneFit employs a Gibbs sampling algorithm consisting of partial reversible-jump MCMC and partial Gibbs updates for estimating the latent variables by sampling from the posterior distribution. A major distinguishing feature of SiCloneFit is that it jointly solves the subclonal reconstruction and tumor phylogeny inference problems from SCS data sets, whereas existing methods either cluster the cells into subclones or infer a tumor phylogeny. The phylogeny inference methods (except SiFit) also rely on infinite sites assumption to restrict the search space. On the contrary, SiCloneFit employs a finite-site model of evolution to account for mutation recurrence and losses. At the same time, SiCloneFit accounts for cell doublets, an important technical artifact that is not dealt with by existing single-cell phylogeny inference methods.</p>
    <p>We assessed SiCloneFit's performance through a comprehensive set of simulation studies aimed at creating experimental settings corresponding to different aspects of modern SCS data sets. Data sets were generated with varying rates of mutation losses and recurrences, a varying number of cells, genomic sites, and tumor subclones, a wide range of error rates, and varying amounts of missing data and cell doublets. In simulated benchmarks, SiCloneFit outperformed the state-of-the-art methods based on different metrics for evaluating its performance in inferring the clonal clusters, clonal genotypes, and the clonal evolutionary history. SiCloneFit also performed well in estimating the error rates in SCS data. We also applied SiCloneFit on two targeted SCS data sets from two metastatic colon cancer patients for studying the intra-tumor heterogeneity. For these tumors, SiCloneFit inferred the primary and metastatic subclones as clusters of single cells, inferred their genotypes, reconstructed the genealogy of these subclones, and inferred the temporal order of the mutations in their evolutionary history, revealing mutations that potentially played an important role in metastatic divergence.</p>
    <p>SiCloneFit's inference of clonal populations and clonal genotypes could potentially be improved by accounting for copy number alterations (CNAs) along with SNVs. The current model of SiCloneFit accounts for only LOH and deletion that can give rise to CNAs altering the genotype of a point mutation site. Similarly, copy number gain can also result in changing the genotype of a point mutation site. Copy number information for the mutation sites will be very helpful in a more accurate understanding of the genotype states of point mutations. While it is possible to approximate any copy number information via the ternary genotype states (e.g., for copy number 3, ternary genotype states will be 0 = {<italic>aaa</italic>}, 1 = {<italic>aaa</italic>, <italic>abb</italic>}, 2 = {<italic>bbb</italic>}; ‘a’: reference allele and ‘b’: variant allele) of our current model, the exact copy number information will help in more precise inference of the genotypes. Our finite-site model is flexible, and it can be easily extended by adding copy number gain and loss parameters to account for the possible genotype states emerged due to simultaneous occurrence of CNAs and SNVs. The inclusion of CNAs along with SNVs can also improve the inference of the mutational history of the tumor, as the placement of CNAs on the branches of the clonal phylogeny can help in understanding their role in subclonal expansion. However, owing to the difference of the whole genome amplification methods required for CNA and SNV detection, modern SCS data sets are generated with an aim to uncover either the CNAs or the SNVs. Most studies resort to targeted sequencing for SNV detection, and because of the uneven coverage of the targeted sequencing, inference of copy numbers from such data sets becomes extremely difficult. When technologies become available for producing SCS data sets enabling the measurement of both CNAs and SNVs from the same cell, SiCloneFit's finite-site model can be extended to account for more complex genotype states resulting from CNAs. If copy number information becomes available, SiCloneFit's error model can be further improved, as the mutated alleles present in multiple copies will be less prone to be affected by allelic dropout. SiCloneFit's error model can be further extended to utilize reference and variant read counts at each mutation site in each cell as the input data instead of presence/absence of mutation inferred by a variant caller.</p>
    <p>In closing, SiCloneFit advances the understanding of intra-tumor heterogeneity and clonal evolution through improved computational analysis of SCS data. As SCS becomes more high-throughput, generating somatic SNV profiles for thousands of cells, SiCloneFit will be very helpful in reconstructing the tumor clones and clonal phylogeny from such large data sets. Being capable of handling doublets, SiCloneFit will find important applications in removing doublets, as their percentage can be high in more high-throughput data sets. Methods like SiCloneFit will have important translational applications for improving cancer diagnosis, treatment, and therapy in clinical applications.</p>
  </sec>
  <sec sec-type="methods" id="s3">
    <title>Methods</title>
    <sec id="s3a">
      <title>Model description</title>
      <p>We assume that we have measurements from <italic>m</italic> single cells. For each cell, <italic>n</italic> somatic single nucleotide variant sites have been measured. The data can be represented by a matrix <italic>D</italic><sub><italic>n</italic>×<italic>m</italic></sub> = (<italic>D</italic><sub><italic>ij</italic></sub>) of observed genotypes, where <italic>D</italic><sub><italic>ij</italic></sub> is the observed genotype at the <italic>i</italic><sup><italic>th</italic></sup> site of cell <italic>j</italic>. Let <italic>g</italic><sub><italic>t</italic></sub> be the set of possible true genotype values for the SNVs, and <italic>g</italic><sub><italic>o</italic></sub> be the set of observable values for the SNVs. For binary measurements for SNVs, <italic>g</italic><sub><italic>t</italic></sub> = {0, 1}, whereas <italic>g</italic><sub><italic>o</italic></sub> = {0, 1, <italic>X</italic>}, where 0, 1, and <italic>X</italic> denote the absence of mutation, presence of mutation, and missing value, respectively. If ternary measurements are available for SNVs, <italic>g</italic><sub><italic>t</italic></sub> = {0, 1, 2}and <italic>g</italic><sub><italic>o</italic></sub> = {0, 1, 2, <italic>X</italic>}, where 0 denotes homozygous reference genotype, and 1 and 2 denote heterozygous, and homozygous nonreference genotypes, respectively, and <italic>X</italic> denotes missing data.</p>
      <p>We assume that there is a set of <italic>K</italic> clonal populations from which <italic>m</italic> single cells are sampled and the clonal populations can be placed at the leaves of a clonal phylogeny, <inline-formula><mml:math id="il4"><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:math></inline-formula>. Each clonal population consists of a set of cells that have an identical genotype (with respect to the set of mutations in consideration) and a common ancestor. The genotype vector associated with a clone <italic>c</italic> is called clonal genotype (denoted by <italic>G</italic><sub><italic>c</italic></sub>, <italic>G</italic><sub><italic>c</italic></sub> ∈ {0, 1, 2}<sup><italic>n</italic></sup>), and it records the genotype values for all <italic>n</italic> sites for the corresponding clone. The true genotype vector of each cell is identical to the clonal genotype of the clonal population to which it belongs. The clonal genotype matrix, <italic>G</italic><sub><italic>K</italic>×<italic>n</italic></sub>, represents the clonal genotypes of <italic>K</italic> clones. It is important to note that, <italic>K</italic>, the number of clones is unknown. To automatically infer the number of clones and assign the cells to clones, we introduce a tree-structured infinite mixture model. <xref rid="GR243121ZAFC29" ref-type="bibr">Meeds et al. (2008)</xref> describes a nonparametric Bayesian prior over trees similar to mixture models using a Chinese restaurant process (<xref rid="GR243121ZAFC37" ref-type="bibr">Pitman 2006</xref>) prior. For this tree-structured CRP, each node of the tree represents a cluster. In our model, we extend this idea to define a nonparametric Bayesian prior over binary trees, leaves of which represent the mixture components (clonal clusters). A Chinese restaurant process defines a distribution for partitioning customers into different tables. In our problem, single cells are analogous to customers and clonal clusters are analogous to tables. Let <italic>c</italic><sub><italic>j</italic></sub> denote the cluster assignment for cell <italic>j</italic> and assume that cells 1:<italic>j</italic> − 1 have already been assigned to clonal clusters {1, …, |<italic>c</italic><sub>1:<italic>j</italic>−1</sub>|}, where |<italic>c</italic><sub>1:<italic>j</italic>−1</sub>| denotes the number of clusters induced by the cluster indicators of <italic>j</italic> − 1 cells. The cluster assignment of cell <italic>j</italic>, <italic>c</italic><sub><italic>j</italic></sub> is based on the distribution defined by a Chinese restaurant process and is given by
<disp-formula id="GR243121ZAFM1"><label>(1)</label><mml:math id="M1"><mml:mtable columnalign="right left" rowspacing=".5em" columnspacing="thickmathspace"><mml:mtr><mml:mtd><mml:mspace width="0.4em"/><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mi mathvariant="normal">∀</mml:mi><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where <italic>n</italic><sub><italic>c</italic></sub> denotes the number of cells already assigned (excluding cell <italic>j</italic>) to cluster <italic>c</italic>. <italic>α</italic><sub>0</sub> is the concentration parameter for the CRP model.</p>
      <p>The clonal phylogeny, <inline-formula><mml:math id="il5"><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:math></inline-formula>, is a rooted directed binary tree whose number of leaves is equal to the number of clonal clusters, <italic>K</italic> = |<italic>c</italic>| defined by the assignment of <italic>m</italic> cells to different clusters by the CRP. The root of <inline-formula><mml:math id="il6"><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:math></inline-formula> represents normal (unmutated) genotype, and somatic mutations are accumulated along the branches of the phylogeny. Each leaf in the clonal phylogeny corresponds to a clonal cluster, <italic>c</italic> ∈ {1, …, <italic>K</italic>}, and is associated with a clonal genotype <italic>G</italic><sub><italic>c</italic></sub> that records the set of mutations accumulated along the branches from the root. To model the evolution of the clonal genotypes, we employ a finite-site model of evolution, <inline-formula><mml:math id="il7"><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msub></mml:math></inline-formula>, that accounts for the effects of point mutations, deletion, and loss of heterozygosity on the clonal genotypes. The model of evolution assigns transition probabilities to different genotype transitions along the branches of the clonal phylogeny. The true genotype of each cell is identical to the clonal genotype of the clonal cluster where it is assigned. However, observed genotypes of single cells differ from their true genotype due to amplification errors introduced during the single-cell sequencing work flow. The effect of amplification errors is modeled using an error model distribution parameterized by FP error rate, <italic>α</italic> and FN error rate, <italic>β</italic>. The generative process can be described as follows:
<list list-type="order"><list-item><p>Draw <inline-formula><mml:math id="il8"><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="normal">Gamma</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="il9"><mml:mi>α</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="normal">Beta</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="il10"><mml:mtext>β</mml:mtext><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="normal">Beta</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mtext>β</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>β</mml:mtext></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>.</p></list-item><list-item><p>For <italic>j</italic> ∈ {1, 2, …, <italic>m</italic>}, draw <inline-formula><mml:math id="il11"><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>C</mml:mi><mml:mi>R</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>.</p><p>From this, derive <italic>K</italic> = |<italic>c</italic>|, the total number of clusters (or clones) implicitly defined by <italic>c</italic>.</p></list-item><list-item><p>Draw <inline-formula><mml:math id="il12"><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow><mml:mo>∼</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">prior</mml:mi></mml:mrow></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>K</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>.</p></list-item><list-item><p>For <inline-formula><mml:math id="il13"><mml:mi>λ</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msub></mml:math></inline-formula>, draw <inline-formula><mml:math id="il14"><mml:mi>λ</mml:mi><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="normal">Beta</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>λ</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mi>λ</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>.</p></list-item><list-item><p>For <italic>k</italic> ∈ {1, 2, …, <italic>K</italic>}, draw <inline-formula><mml:math id="il15"><mml:msub><mml:mi>G</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>.</p></list-item><list-item><p>For <italic>j</italic> ∈ {1, 2, …, <italic>m</italic>} and <italic>i</italic> ∈ {1, 2, …, <italic>n</italic>}, draw <inline-formula><mml:math id="il16"><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mtext>β</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>.</p></list-item></list></p>
      <p><italic>c</italic> denotes the clonal assignments of all cells. <italic>T</italic><sub>prior</sub> is the prior distribution on phylogenetic trees for a fixed number of leaves. <inline-formula><mml:math id="il17"><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msub></mml:math></inline-formula> denotes the set of parameters in the finite-site model of evolution. <italic>F</italic> denotes a distribution on the genotypes at the leaves of a phylogenetic tree and can be computed using Felsenstein's pruning algorithm (<xref rid="GR243121ZAFC9" ref-type="bibr">Felsenstein 1981</xref>) given the phylogeny and a finite-site model of evolution. <italic>E</italic> is the error model distribution that relates the observed genotype at locus <italic>i</italic> for cell <italic>j</italic>, <italic>D</italic><sub><italic>ij</italic></sub> to clonal genotype <inline-formula><mml:math id="il18"><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. <inline-formula><mml:math id="il19"><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>β</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>β</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:math></inline-formula> denote different hyperparameters used in this model.</p>
    </sec>
    <sec id="s3b">
      <title>Doublet-aware model description</title>
      <p>The singlet model of SiCloneFit is extended to handle cases where some data points result from measuring two cells (doublets). The expected genotype for a doublet due to merging of two cells is defined by the <inline-formula><mml:math id="il20"><mml:mo>⊕</mml:mo></mml:math></inline-formula> operator as shown in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Table S6</ext-link> and the <italic>logical or</italic> operator for ternary and binary data type, respectively. The doublet-aware model of SiCloneFit incorporates all the variables in the singlet model. In addition, for each single cell <italic>j</italic>, it employs a Bernoulli variable <italic>Y</italic><sub><italic>j</italic></sub> for indicating whether the cell is a singlet or a doublet. A Beta distributed variable, <italic>δ</italic>, represents the probability of sampling a doublet. For each cell, two cluster indicators are used. <inline-formula><mml:math id="il21"><mml:msubsup><mml:mi>c</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:math></inline-formula> is the primary cluster indicator for cell <italic>j</italic> with a Chinese restaurant process prior based on hyperparameter <italic>α</italic><sub>0</sub>, whereas <inline-formula><mml:math id="il22"><mml:msubsup><mml:mi>c</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> is a secondary cluster indicator for cell <italic>j</italic> that can uniformly take values in the range {1, …, |<italic>c</italic><sup>1</sup>|}. If <italic>Y</italic><sub><italic>j</italic></sub> = 1, <inline-formula><mml:math id="il23"><mml:msubsup><mml:mi>c</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:math></inline-formula> denotes the clone of origin of the cell that forms a doublet by merging with cell <italic>j</italic> from clone <inline-formula><mml:math id="il24"><mml:msubsup><mml:mi>c</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:math></inline-formula>. These additional variables are described in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Table S7</ext-link>. The generative process for the doublet-aware model is described in detail in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Methods</ext-link>.</p>
    </sec>
    <sec id="s3c">
      <title>Model of evolution and error model</title>
      <p>To capture the effect of point mutations, LOH, and deletion on the clonal genotypes along the branches of clonal phylogeny, we employ a finite-site model of evolution similar to the one introduced in SiFit (<xref rid="GR243121ZAFC52" ref-type="bibr">Zafar et al. 2017</xref>). Point mutations can result in the genotype transition 0 → 1, whereas LOH and deletion can result in the genotype transitions 1 → 0 or 1 → 2. The finite-site model of evolution, <inline-formula><mml:math id="il25"><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msub></mml:math></inline-formula>, is modeled using a continuous-time Markov chain that assigns a probability with each possible transition of genotypes. The transition rate matrix of the continuous-time Markov chain for binary and ternary genotypes can be defined based on branch length, <italic>t</italic>, and parameters <italic>λ</italic><sub><italic>r</italic></sub> and <italic>λ</italic><sub><italic>l</italic></sub>, accounting for the effects of recurrent mutation and mutation loss, respectively. These are described in detail in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Methods</ext-link>.</p>
      <p>To account for FP and FN errors in SCS data, we introduce an error model distribution, <inline-formula><mml:math id="il26"><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mtext>β</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, which gives the probability of observing genotype <italic>D</italic><sub><italic>ij</italic></sub> for locus <italic>i</italic> in cell <italic>j</italic>, given the true clonal genotype <inline-formula><mml:math id="il27"><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. The error model distributions for ternary and binary data are shown in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Tables S4</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">S5,</ext-link> respectively.</p>
    </sec>
    <sec id="s3d">
      <title>Posterior distribution</title>
      <p>The posterior distribution <inline-formula><mml:math id="il28"><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow></mml:math></inline-formula> over the latent variables of the SiCloneFit model is given by
<disp-formula id="GR243121ZAFM2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="script">V</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">V</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="script">V</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>
where <inline-formula><mml:math id="il29"><mml:mrow><mml:mi mathvariant="script">V</mml:mi></mml:mrow></mml:math></inline-formula> denotes the set of latent variables in the model, <inline-formula><mml:math id="il30"><mml:mrow><mml:mi mathvariant="script">V</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo fence="false">{</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mtext>β</mml:mtext><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo fence="false">}</mml:mo></mml:math></inline-formula>. <bold>c</bold> is a vector containing cluster assignment for all cells, and it implicitly defines the number of clones <italic>K</italic>. <inline-formula><mml:math id="il31"><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow></mml:math></inline-formula> is the set of fixed hyperparameters of the model, <inline-formula><mml:math id="il32"><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mo fence="false">{</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>β</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>β</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo fence="false">}</mml:mo></mml:math></inline-formula>. In Equation <xref ref-type="disp-formula" rid="GR243121ZAFM2">2</xref>, the term <inline-formula><mml:math id="il33"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">V</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> denotes the likelihood of the model, and the term <inline-formula><mml:math id="il34"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="script">V</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> denotes the product of prior probabilities. The posterior distribution for the doublet-aware model is described in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Methods</ext-link>.</p>
    </sec>
    <sec id="s3e">
      <title>Likelihood function</title>
      <p>The likelihood function employed by SiCloneFit is given by
<disp-formula id="GR243121ZAFM3"><label>(3)</label><mml:math id="M3"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">V</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">D</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mtext>β</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:munderover><mml:mrow><mml:mo>∏</mml:mo></mml:mrow><mml:mrow><mml:mspace width="0.4em"/><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:munderover><mml:mo>⁡</mml:mo><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mtext>β</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>
In Equation <xref ref-type="disp-formula" rid="GR243121ZAFM3">3</xref>, <inline-formula><mml:math id="il35"><mml:mi>E</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mtext>β</mml:mtext></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is given by the error model distribution of observing genotype <italic>D</italic><sub><italic>ij</italic></sub> for site <italic>i</italic> in cell <italic>j</italic>, given the true clonal genotype <inline-formula><mml:math id="il36"><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and is parameterized by <italic>α</italic> and <italic>β</italic>. This error model is based on the error model of SiFit (<xref rid="GR243121ZAFC52" ref-type="bibr">Zafar et al. 2017</xref>). The likelihood of the doublet-aware model is described in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Methods</ext-link>.</p>
    </sec>
    <sec id="s3f">
      <title>Prior distributions</title>
      <p>The SiCloneFit model incorporates a compound prior given by
<disp-formula id="GR243121ZAFM4"><label>(4)</label><mml:math id="M4"><mml:mtable columnalign="right left" rowspacing=".5em" columnspacing="thickmathspace"><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="script">V</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd><mml:mtd><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mtext>β</mml:mtext><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">c</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mtext>β</mml:mtext><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>λ</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula>
where
<disp-formula id="GR243121ZAFUM5"><mml:math id="UM1"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mtext>β</mml:mtext><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mtext>β</mml:mtext><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mtext>β</mml:mtext></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mtext>β</mml:mtext></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:math></disp-formula>
</p>
      <p><inline-formula><mml:math id="il37"><mml:mi>F</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">G</mml:mi></mml:mrow><mml:mo stretchy="false">|</mml:mo><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> denotes the prior distribution on the clonal genotype matrix given a clonal phylogeny <inline-formula><mml:math id="il38"><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:math></inline-formula> and parameters of the model of evolution <inline-formula><mml:math id="il39"><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msub></mml:math></inline-formula>, and it can be efficiently calculated using Felsenstein's pruning algorithm (<xref rid="GR243121ZAFC9" ref-type="bibr">Felsenstein 1981</xref>), assuming sites are independent and identically distributed. <italic>P</italic>(<bold>c</bold>|<italic>α</italic><sub>0</sub>) denotes the prior probability of partitioning <italic>m</italic> single cells into <italic>K</italic> (<italic>K</italic> is the number of clusters defined by <bold>c</bold>) clusters under a CRP with concentration parameter <italic>α</italic><sub>0</sub>. <inline-formula><mml:math id="il40"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> denotes the prior probability on the clonal phylogeny. This is a product of the prior on topology and the prior on branch length. We consider uniform distribution for the prior on topology and exponential distribution for the prior on branch lengths. As the values of the error rate parameters <italic>α</italic>, <italic>β</italic> and the parameters of the model of evolution <inline-formula><mml:math id="il41"><mml:msub><mml:mrow><mml:mi mathvariant="script">M</mml:mi></mml:mrow><mml:mi>λ</mml:mi></mml:msub></mml:math></inline-formula> lie between 0 and 1, we use Beta distribution as their prior. For the concentration parameter <italic>α</italic><sub>0</sub>, we assume a Gamma prior as suggested in <xref rid="GR243121ZAFC8" ref-type="bibr">Escobar and West (1995)</xref>. We set the value of hyperparameters for the Gamma distribution to <italic>a</italic> = 1 and <italic>b</italic> = 1 for all the analyses performed, but these are user-specified parameters in the software. All the prior distributions are described in detail in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Methods</ext-link>. The doublet-aware model of SiCloneFit contains additional parameters for indicating whether a cell is a singlet or a doublet; doublet rate and assigning a cell to two clonal clusters and the associated prior distributions are described in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Methods</ext-link>.</p>
    </sec>
    <sec id="s3g">
      <title>Inference</title>
      <p>We designed a Markov chain Monte Carlo sampling procedure based on the Gibbs sampling algorithm to estimate the latent variables according to Equation <xref ref-type="disp-formula" rid="GR243121ZAFM2">2</xref>. Our algorithm is inspired by a partial Metropolis-Hastings, partial Gibbs sampling algorithm described in <xref rid="GR243121ZAFC33" ref-type="bibr">Neal (2000)</xref>. In each iteration, the sampler first samples new cluster indicators, <bold>c</bold>*, for all the cells using partial Metropolis-Hastings, partial Gibbs updates. During this, the dimensionality of the sample may change due to addition of a new cluster (resulting in addition of new edges in the clonal phylogeny) or removal of an existing singleton cluster (resulting in removal of existing edges from the clonal phylogeny). In case the dimensionality changes, the absolute value of the determinant of the Jacobian matrix is also taken into account, which results in partial reversible-jump MCMC (<xref rid="GR243121ZAFC16" ref-type="bibr">Green 1995</xref>) updates. When such dimension changing moves are accepted, the corresponding new clonal phylogeny <inline-formula><mml:math id="il42"><mml:msup><mml:mrow><mml:mi mathvariant="script">T</mml:mi></mml:mrow><mml:mo>∗</mml:mo></mml:msup></mml:math></inline-formula> and new clonal genotype matrix <bold>G</bold>* are also accepted. The sampler next samples a new clonal phylogeny and new parameters of the model of evolution with the help of a Metropolis-Hastings MCMC sampler. After that, new clonal genotype for each clonal cluster is sampled from the conditional posterior distribution. To sample new values of the error rate parameters from their corresponding conditional posterior distributions, our sampler employs rejection sampling. Finally, the concentration parameter <italic>α</italic><sub>0</sub> is sampled based on the method described in <xref rid="GR243121ZAFC8" ref-type="bibr">Escobar and West (1995)</xref>. The sampling algorithms for both the singlet and doublet models of SiCloneFit are described in detail in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Methods</ext-link>.</p>
    </sec>
    <sec id="s3h">
      <title>Software availability</title>
      <p>SiCloneFit has been implemented in Java and is freely available at <uri xlink:href="https://bitbucket.org/hamimzafar/siclonefit">https://bitbucket.org/hamimzafar/siclonefit</uri>, released under the MIT license. The binary file of SiCloneFit is also included in <ext-link ext-link-type="uri" xlink:href="http://genome.cshlp.org/lookup/suppl/doi:10.1101/gr.243121.118/-/DC1">Supplemental Code</ext-link>.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplemental Material</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_29_11_1847__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_gr.243121.118_Supplemental_Material.pdf"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="x-zip-compressed" xlink:href="supp_gr.243121.118_Supplemental_Code.zip"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>L.N. was supported by National Science Foundation (Directorate for Computer and Information Science and Engineering) Grant IIS-1812822. K.C. was supported by the National Cancer Institute (grant R01 CA172652), a Cancer Center support grant (P30 CA016672), and the Andrew Sabin Family Foundation.</p>
  </ack>
  <fn-group>
    <fn fn-type="supplementary-material">
      <p>[Supplemental material is available for this article.]</p>
    </fn>
    <fn>
      <p>Article published online before print. Article, supplemental material, and publication date are at <ext-link ext-link-type="uri" xlink:href="http://www.genome.org/cgi/doi/10.1101/gr.243121.118">http://www.genome.org/cgi/doi/10.1101/gr.243121.118</ext-link>.</p>
    </fn>
  </fn-group>
  <ref-list>
    <title>References</title>
    <ref id="GR243121ZAFC1">
      <mixed-citation publication-type="journal"><string-name><surname>Amigó</surname><given-names>E</given-names></string-name>, <string-name><surname>Gonzalo</surname><given-names>J</given-names></string-name>, <string-name><surname>Artiles</surname><given-names>J</given-names></string-name>, <string-name><surname>Verdejo</surname><given-names>F</given-names></string-name>. <year>2009</year><article-title>A comparison of extrinsic clustering evaluation metrics based on formal constraints</article-title>. <source>Inf Retr</source><volume>12</volume>: <fpage>461</fpage>–<lpage>486</lpage>. <pub-id pub-id-type="doi">10.1007/s10791-008-9066-8</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC2">
      <mixed-citation publication-type="journal"><string-name><surname>Baslan</surname><given-names>T</given-names></string-name>, <string-name><surname>Hicks</surname><given-names>J</given-names></string-name>. <year>2017</year><article-title>Unravelling biology and shifting paradigms in cancer with single-cell sequencing</article-title>. <source>Nat Rev Cancer</source><volume>17</volume>: <fpage>557</fpage>–<lpage>569</lpage>. <pub-id pub-id-type="doi">10.1038/nrc.2017.58</pub-id><pub-id pub-id-type="pmid">28835719</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC3">
      <mixed-citation publication-type="journal"><string-name><surname>Burrell</surname><given-names>RA</given-names></string-name>, <string-name><surname>McGranahan</surname><given-names>N</given-names></string-name>, <string-name><surname>Bartek</surname><given-names>J</given-names></string-name>, <string-name><surname>Swanton</surname><given-names>C</given-names></string-name>. <year>2013</year><article-title>The causes and consequences of genetic heterogeneity in cancer evolution</article-title>. <source>Nature</source><volume>501</volume>: <fpage>338</fpage>–<lpage>345</lpage>. <pub-id pub-id-type="doi">10.1038/nature12625</pub-id><pub-id pub-id-type="pmid">24048066</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC4">
      <mixed-citation publication-type="journal"><string-name><surname>Davis</surname><given-names>A</given-names></string-name>, <string-name><surname>Navin</surname><given-names>NE</given-names></string-name>. <year>2016</year><article-title>Computing tumor trees from single cells</article-title>. <source>Genome Biol</source><volume>17</volume>: <fpage>113</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-0987-z</pub-id><pub-id pub-id-type="pmid">27230879</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC5">
      <mixed-citation publication-type="journal"><string-name><surname>Deshwar</surname><given-names>AG</given-names></string-name>, <string-name><surname>Vembu</surname><given-names>S</given-names></string-name>, <string-name><surname>Yung</surname><given-names>CK</given-names></string-name>, <string-name><surname>Jang</surname><given-names>GH</given-names></string-name>, <string-name><surname>Stein</surname><given-names>L</given-names></string-name>, <string-name><surname>Morris</surname><given-names>Q</given-names></string-name>. <year>2015</year><article-title>PhyloWGS: reconstructing subclonal composition and evolution from whole-genome sequencing of tumors</article-title>. <source>Genome Biol</source><volume>16</volume>: <fpage>35</fpage><pub-id pub-id-type="doi">10.1186/s13059-015-0602-8</pub-id><pub-id pub-id-type="pmid">25786235</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC6">
      <mixed-citation publication-type="journal"><string-name><surname>El-Kebir</surname><given-names>M</given-names></string-name>, <string-name><surname>Satas</surname><given-names>G</given-names></string-name>, <string-name><surname>Oesper</surname><given-names>L</given-names></string-name>, <string-name><surname>Raphael</surname><given-names>B</given-names></string-name>. <year>2016</year><article-title>Inferring the mutational history of a tumor using multi-state perfect phylogeny mixtures</article-title>. <source>Cell Syst</source><volume>3</volume>: <fpage>43</fpage>–<lpage>53</lpage>. <pub-id pub-id-type="doi">10.1016/j.cels.2016.07.004</pub-id><pub-id pub-id-type="pmid">27467246</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC7">
      <mixed-citation publication-type="journal"><string-name><surname>El-Kebir</surname><given-names>M</given-names></string-name>, <string-name><surname>Satas</surname><given-names>G</given-names></string-name>, <string-name><surname>Raphael</surname><given-names>BJ</given-names></string-name>. <year>2018</year><article-title>Inferring parsimonious migration histories for metastatic cancers</article-title>. <source>Nat Genet</source><volume>50</volume>: <fpage>718</fpage>–<lpage>726</lpage>. <pub-id pub-id-type="doi">10.1038/s41588-018-0106-z</pub-id><pub-id pub-id-type="pmid">29700472</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC8">
      <mixed-citation publication-type="journal"><string-name><surname>Escobar</surname><given-names>MD</given-names></string-name>, <string-name><surname>West</surname><given-names>M</given-names></string-name>. <year>1995</year><article-title>Bayesian density estimation and inference using mixtures</article-title>. <source>J Am Stat Assoc</source><volume>90</volume>: <fpage>577</fpage>–<lpage>588</lpage>. <pub-id pub-id-type="doi">10.1080/01621459.1995.10476550</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC9">
      <mixed-citation publication-type="journal"><string-name><surname>Felsenstein</surname><given-names>J</given-names></string-name>. <year>1981</year><article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>. <source>J Mol Evol</source><volume>17</volume>: <fpage>368</fpage>–<lpage>376</lpage>. <pub-id pub-id-type="doi">10.1007/BF01734359</pub-id><pub-id pub-id-type="pmid">7288891</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC10">
      <mixed-citation publication-type="journal"><string-name><surname>Fritsch</surname><given-names>A</given-names></string-name>, <string-name><surname>Ickstadt</surname><given-names>K</given-names></string-name>. <year>2009</year><article-title>Improved criteria for clustering based on the posterior similarity matrix</article-title>. <source>Bayesian Anal</source><volume>4</volume>: <fpage>367</fpage>–<lpage>391</lpage>. <pub-id pub-id-type="doi">10.1214/09-BA414</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC11">
      <mixed-citation publication-type="journal"><string-name><surname>Gawad</surname><given-names>C</given-names></string-name>, <string-name><surname>Koh</surname><given-names>W</given-names></string-name>, <string-name><surname>Quake</surname><given-names>SR</given-names></string-name>. <year>2014</year><article-title>Dissecting the clonal origins of childhood acute lymphoblastic leukemia by single-cell genomics</article-title>. <source>Proc Natl Acad Sci</source><volume>111</volume>: <fpage>17947</fpage>–<lpage>17952</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1420822111</pub-id><pub-id pub-id-type="pmid">25425670</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC12">
      <mixed-citation publication-type="journal"><string-name><surname>Gerlinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Rowan</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Horswell</surname><given-names>S</given-names></string-name>, <string-name><surname>Larkin</surname><given-names>J</given-names></string-name>, <string-name><surname>Endesfelder</surname><given-names>D</given-names></string-name>, <string-name><surname>Gronroos</surname><given-names>E</given-names></string-name>, <string-name><surname>Martinez</surname><given-names>P</given-names></string-name>, <string-name><surname>Matthews</surname><given-names>N</given-names></string-name>, <string-name><surname>Stewart</surname><given-names>A</given-names></string-name>, <string-name><surname>Tarpey</surname><given-names>P</given-names></string-name>, <etal/><year>2012</year><article-title>Intratumor heterogeneity and branched evolution revealed by multiregion sequencing</article-title>. <source>N Engl J Med</source><volume>366</volume>: <fpage>883</fpage>–<lpage>892</lpage>. <pub-id pub-id-type="doi">10.1056/NEJMoa1113205</pub-id><pub-id pub-id-type="pmid">22397650</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC13">
      <mixed-citation publication-type="journal"><string-name><surname>Gerlinger</surname><given-names>M</given-names></string-name>, <string-name><surname>Horswell</surname><given-names>S</given-names></string-name>, <string-name><surname>Larkin</surname><given-names>J</given-names></string-name>, <string-name><surname>Rowan</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Salm</surname><given-names>MP</given-names></string-name>, <string-name><surname>Varela</surname><given-names>I</given-names></string-name>, <string-name><surname>Fisher</surname><given-names>R</given-names></string-name>, <string-name><surname>McGranahan</surname><given-names>N</given-names></string-name>, <string-name><surname>Matthews</surname><given-names>N</given-names></string-name>, <string-name><surname>Santos</surname><given-names>CR</given-names></string-name>, <etal/><year>2015</year><article-title>Genomic architecture and evolution of clear cell renal cell carcinomas defined by multiregion sequencing</article-title>. <source>Nat Genet</source><volume>46</volume>: <fpage>225</fpage>–<lpage>233</lpage>. <pub-id pub-id-type="doi">10.1038/ng.2891</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC14">
      <mixed-citation publication-type="journal"><string-name><surname>Gillies</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Verduzco</surname><given-names>D</given-names></string-name>, <string-name><surname>Gatenby</surname><given-names>RA</given-names></string-name>. <year>2012</year><article-title>Evolutionary dynamics of carcinogenesis and why targeted therapy does not work</article-title>. <source>Nat Rev Cancer</source><volume>12</volume>: <fpage>487</fpage>–<lpage>493</lpage>. <pub-id pub-id-type="doi">10.1038/nrc3298</pub-id><pub-id pub-id-type="pmid">22695393</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC15">
      <mixed-citation publication-type="journal"><string-name><surname>Greaves</surname><given-names>M</given-names></string-name>, <string-name><surname>Maley</surname><given-names>CC</given-names></string-name>. <year>2012</year><article-title>Clonal evolution in cancer</article-title>. <source>Nature</source><volume>481</volume>: <fpage>306</fpage>–<lpage>313</lpage>. <pub-id pub-id-type="doi">10.1038/nature10762</pub-id><pub-id pub-id-type="pmid">22258609</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC16">
      <mixed-citation publication-type="journal"><string-name><surname>Green</surname><given-names>PJ</given-names></string-name>. <year>1995</year><article-title>Reversible jump Markov chain Monte Carlo computation and Bayesian model determination</article-title>. <source>Biometrika</source><volume>82</volume>: <fpage>711</fpage>–<lpage>732</lpage>. <pub-id pub-id-type="doi">10.1093/biomet/82.4.711</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC17">
      <mixed-citation publication-type="journal"><string-name><surname>Hou</surname><given-names>Y</given-names></string-name>, <string-name><surname>Song</surname><given-names>L</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>P</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>B</given-names></string-name>, <string-name><surname>Tao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Xu</surname><given-names>X</given-names></string-name>, <string-name><surname>Li</surname><given-names>F</given-names></string-name>, <string-name><surname>Wu</surname><given-names>K</given-names></string-name>, <string-name><surname>Liang</surname><given-names>J</given-names></string-name>, <string-name><surname>Shao</surname><given-names>D</given-names></string-name>, <etal/><year>2012</year><article-title>Single-cell exome sequencing and monoclonal evolution of a <italic>JAK2</italic>-negative myeloproliferative neoplasm</article-title>. <source>Cell</source><volume>148</volume>: <fpage>873</fpage>–<lpage>885</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2012.02.028</pub-id><pub-id pub-id-type="pmid">22385957</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC18">
      <mixed-citation publication-type="journal"><string-name><surname>Jahn</surname><given-names>K</given-names></string-name>, <string-name><surname>Kuipers</surname><given-names>J</given-names></string-name>, <string-name><surname>Beerenwinkel</surname><given-names>N</given-names></string-name>. <year>2016</year><article-title>Tree inference for single-cell data</article-title>. <source>Genome Biol</source><volume>17</volume>: <fpage>86</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-0936-x</pub-id><pub-id pub-id-type="pmid">27149953</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC19">
      <mixed-citation publication-type="journal"><string-name><surname>Jiang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Qiu</surname><given-names>Y</given-names></string-name>, <string-name><surname>Minn</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>NR</given-names></string-name>. <year>2016</year><article-title>Assessing intratumor heterogeneity and tracking longitudinal and spatial clonal evolutionary history by next-generation sequencing</article-title>. <source>Proc Natl Acad Sci</source><volume>113</volume>: <fpage>E5528</fpage>–<lpage>E5537</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1522203113</pub-id><pub-id pub-id-type="pmid">27573852</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC20">
      <mixed-citation publication-type="journal"><string-name><surname>Kandoth</surname><given-names>C</given-names></string-name>, <string-name><surname>McLellan</surname><given-names>MD</given-names></string-name>, <string-name><surname>Vandin</surname><given-names>F</given-names></string-name>, <string-name><surname>Ye</surname><given-names>K</given-names></string-name>, <string-name><surname>Niu</surname><given-names>B</given-names></string-name>, <string-name><surname>Lu</surname><given-names>C</given-names></string-name>, <string-name><surname>Xie</surname><given-names>M</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>Q</given-names></string-name>, <string-name><surname>McMichael</surname><given-names>JF</given-names></string-name>, <string-name><surname>Wyczalkowski</surname><given-names>MA</given-names></string-name>, <etal/><year>2013</year><article-title>Mutational landscape and significance across 12 major cancer types</article-title>. <source>Nature</source><volume>502</volume>: <fpage>333</fpage>–<lpage>339</lpage>. <pub-id pub-id-type="doi">10.1038/nature12634</pub-id><pub-id pub-id-type="pmid">24132290</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC21">
      <mixed-citation publication-type="journal"><string-name><surname>Kuipers</surname><given-names>J</given-names></string-name>, <string-name><surname>Jahn</surname><given-names>K</given-names></string-name>, <string-name><surname>Raphael</surname><given-names>BJ</given-names></string-name>, <string-name><surname>Beerenwinkel</surname><given-names>N</given-names></string-name>. <year>2017</year><article-title>Single-cell sequencing data reveal widespread recurrence and loss of mutational hits in the life histories of tumors</article-title>. <source>Genome Res</source><volume>27</volume>: <fpage>1885</fpage>–<lpage>1894</lpage>. <pub-id pub-id-type="doi">10.1101/gr.220707.117</pub-id><pub-id pub-id-type="pmid">29030470</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC22">
      <mixed-citation publication-type="journal"><string-name><surname>Landau</surname><given-names>DA</given-names></string-name>, <string-name><surname>Tausch</surname><given-names>E</given-names></string-name>, <string-name><surname>Taylor-Weiner</surname><given-names>AN</given-names></string-name>, <string-name><surname>Stewart</surname><given-names>C</given-names></string-name>, <string-name><surname>Reiter</surname><given-names>JG</given-names></string-name>, <string-name><surname>Bahlo</surname><given-names>J</given-names></string-name>, <string-name><surname>Kluth</surname><given-names>S</given-names></string-name>, <string-name><surname>Bozic</surname><given-names>I</given-names></string-name>, <string-name><surname>Lawrence</surname><given-names>M</given-names></string-name>, <string-name><surname>Böttcher</surname><given-names>S</given-names></string-name>, <etal/><year>2015</year><article-title>Mutations driving CLL and their evolution in progression and relapse</article-title>. <source>Nature</source><volume>526</volume>: <fpage>525</fpage>–<lpage>530</lpage>. <pub-id pub-id-type="doi">10.1038/nature15395</pub-id><pub-id pub-id-type="pmid">26466571</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC23">
      <mixed-citation publication-type="journal"><string-name><surname>Leung</surname><given-names>ML</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Kim</surname><given-names>C</given-names></string-name>, <string-name><surname>Gao</surname><given-names>R</given-names></string-name>, <string-name><surname>Jiang</surname><given-names>J</given-names></string-name>, <string-name><surname>Sei</surname><given-names>E</given-names></string-name>, <string-name><surname>Navin</surname><given-names>NE</given-names></string-name>. <year>2016</year><article-title>Highly multiplexed targeted DNA sequencing from single nuclei</article-title>. <source>Nat Protoc</source><volume>11</volume>: <fpage>214</fpage>–<lpage>235</lpage>. <pub-id pub-id-type="doi">10.1038/nprot.2016.005</pub-id><pub-id pub-id-type="pmid">26741407</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC24">
      <mixed-citation publication-type="journal"><string-name><surname>Leung</surname><given-names>ML</given-names></string-name>, <string-name><surname>Davis</surname><given-names>A</given-names></string-name>, <string-name><surname>Gao</surname><given-names>R</given-names></string-name>, <string-name><surname>Casasent</surname><given-names>A</given-names></string-name>, <string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Sei</surname><given-names>E</given-names></string-name>, <string-name><surname>Vilar</surname><given-names>E</given-names></string-name>, <string-name><surname>Maru</surname><given-names>D</given-names></string-name>, <string-name><surname>Kopetz</surname><given-names>S</given-names></string-name>, <string-name><surname>Navin</surname><given-names>NE</given-names></string-name>. <year>2017</year><article-title>Single-cell DNA sequencing reveals a late-dissemination model in metastatic colorectal cancer</article-title>. <source>Genome Res</source><volume>27</volume>: <fpage>1287</fpage>–<lpage>1299</lpage>. <pub-id pub-id-type="doi">10.1101/gr.209973.116</pub-id><pub-id pub-id-type="pmid">28546418</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC25">
      <mixed-citation publication-type="journal"><string-name><surname>Li</surname><given-names>Y</given-names></string-name>, <string-name><surname>Xu</surname><given-names>X</given-names></string-name>, <string-name><surname>Song</surname><given-names>L</given-names></string-name>, <string-name><surname>Hou</surname><given-names>Y</given-names></string-name>, <string-name><surname>Li</surname><given-names>Z</given-names></string-name>, <string-name><surname>Tsang</surname><given-names>S</given-names></string-name>, <string-name><surname>Li</surname><given-names>F</given-names></string-name>, <string-name><surname>Im</surname><given-names>KM</given-names></string-name>, <string-name><surname>Wu</surname><given-names>K</given-names></string-name>, <string-name><surname>Wu</surname><given-names>H</given-names></string-name>, <etal/><year>2012</year><article-title>Single-cell sequencing analysis characterizes common and cell-lineage-specific mutations in a muscle-invasive bladder cancer</article-title>. <source>Gigascience</source><volume>1</volume>: <fpage>12</fpage><pub-id pub-id-type="doi">10.1186/2047-217X-1-12</pub-id><pub-id pub-id-type="pmid">23587365</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC26">
      <mixed-citation publication-type="journal"><string-name><surname>Ling</surname><given-names>S</given-names></string-name>, <string-name><surname>Hu</surname><given-names>Z</given-names></string-name>, <string-name><surname>Yang</surname><given-names>Z</given-names></string-name>, <string-name><surname>Yang</surname><given-names>F</given-names></string-name>, <string-name><surname>Li</surname><given-names>Y</given-names></string-name>, <string-name><surname>Lin</surname><given-names>P</given-names></string-name>, <string-name><surname>Chen</surname><given-names>K</given-names></string-name>, <string-name><surname>Dong</surname><given-names>L</given-names></string-name>, <string-name><surname>Cao</surname><given-names>L</given-names></string-name>, <string-name><surname>Tao</surname><given-names>Y</given-names></string-name>, <etal/><year>2015</year><article-title>Extremely high genetic diversity in a single tumor points to prevalence of non-Darwinian cell evolution</article-title>. <source>Proc Natl Acad Sci</source><volume>112</volume>: <fpage>E6496</fpage>–<lpage>E6505</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1519556112</pub-id><pub-id pub-id-type="pmid">26561581</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC27">
      <mixed-citation publication-type="journal"><string-name><surname>Malikic</surname><given-names>S</given-names></string-name>, <string-name><surname>Mehrabadi</surname><given-names>FR</given-names></string-name>, <string-name><surname>Ciccolella</surname><given-names>S</given-names></string-name>, <string-name><surname>Rahman</surname><given-names>MK</given-names></string-name>, <string-name><surname>Ricketts</surname><given-names>C</given-names></string-name>, <string-name><surname>Haghshenas</surname><given-names>E</given-names></string-name>, <string-name><surname>Seidman</surname><given-names>D</given-names></string-name>, <string-name><surname>Hach</surname><given-names>F</given-names></string-name>, <string-name><surname>Hajirasouliha</surname><given-names>I</given-names></string-name>, <string-name><surname>Sahinalp</surname><given-names>SC</given-names></string-name>. <year>2019</year><article-title>PhISCS: a combinatorial approach for subperfect tumor phylogeny reconstruction via integrative use of single-cell and bulk sequencing data</article-title>. <source>Genome Res</source><comment>(this issue)</comment><pub-id pub-id-type="doi">10.1101/gr.234435.118</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC28">
      <mixed-citation publication-type="journal"><string-name><surname>McPherson</surname><given-names>A</given-names></string-name>, <string-name><surname>Roth</surname><given-names>A</given-names></string-name>, <string-name><surname>Laks</surname><given-names>E</given-names></string-name>, <string-name><surname>Masud</surname><given-names>T</given-names></string-name>, <string-name><surname>Bashashati</surname><given-names>A</given-names></string-name>, <string-name><surname>Zhang</surname><given-names>AW</given-names></string-name>, <string-name><surname>Ha</surname><given-names>G</given-names></string-name>, <string-name><surname>Biele</surname><given-names>J</given-names></string-name>, <string-name><surname>Yap</surname><given-names>D</given-names></string-name>, <string-name><surname>Wan</surname><given-names>A</given-names></string-name>, <etal/><year>2016</year><article-title>Divergent modes of clonal spread and intraperitoneal mixing in high-grade serous ovarian cancer</article-title>. <source>Nat Genet</source><volume>48</volume>: <fpage>758</fpage>–<lpage>767</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3573</pub-id><pub-id pub-id-type="pmid">27182968</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC29">
      <mixed-citation publication-type="confproc"><string-name><surname>Meeds</surname><given-names>EW</given-names></string-name>, <string-name><surname>Ross</surname><given-names>DA</given-names></string-name>, <string-name><surname>Zemel</surname><given-names>RS</given-names></string-name>, <string-name><surname>Roweis</surname><given-names>ST</given-names></string-name>. <year>2008</year><article-title>Learning</article-title><article-title>stick-figure models using nonparametric Bayesian priors over trees</article-title>. In <conf-name>2008 IEEE Conference on Computer Vision and Pattern Recognition</conf-name>, pp. <fpage>1</fpage>–<lpage>8</lpage>. Anchorage, AK.</mixed-citation>
    </ref>
    <ref id="GR243121ZAFC30">
      <mixed-citation publication-type="journal"><string-name><surname>Merlo</surname><given-names>LM</given-names></string-name>, <string-name><surname>Pepper</surname><given-names>JW</given-names></string-name>, <string-name><surname>Reid</surname><given-names>BJ</given-names></string-name>, <string-name><surname>Maley</surname><given-names>CC</given-names></string-name>. <year>2006</year><article-title>Cancer as an evolutionary and ecological process</article-title>. <source>Nat Rev Cancer</source><volume>6</volume>: <fpage>924</fpage>–<lpage>935</lpage>. <pub-id pub-id-type="doi">10.1038/nrc2013</pub-id><pub-id pub-id-type="pmid">17109012</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC31">
      <mixed-citation publication-type="journal"><string-name><surname>Navin</surname><given-names>NE</given-names></string-name>. <year>2014</year><article-title>Cancer genomics: one cell at a time</article-title>. <source>Genome Biol</source><volume>15</volume>: <fpage>452</fpage><pub-id pub-id-type="doi">10.1186/s13059-014-0452-9</pub-id><pub-id pub-id-type="pmid">25222669</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC32">
      <mixed-citation publication-type="journal"><string-name><surname>Navin</surname><given-names>NE</given-names></string-name>. <year>2015</year><article-title>The first five years of single-cell cancer genomics and beyond</article-title>. <source>Genome Res</source><volume>25</volume>: <fpage>1499</fpage>–<lpage>1507</lpage>. <pub-id pub-id-type="doi">10.1101/gr.191098.115</pub-id><pub-id pub-id-type="pmid">26430160</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC33">
      <mixed-citation publication-type="journal"><string-name><surname>Neal</surname><given-names>RM</given-names></string-name>. <year>2000</year><article-title>Markov chain sampling methods for Dirichlet process mixture models</article-title>. <source>J Comput Graph Stat</source><volume>9</volume>: <fpage>249</fpage>–<lpage>265</lpage>. <pub-id pub-id-type="doi">10.1080/10618600.2000.10474879</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC34">
      <mixed-citation publication-type="journal"><string-name><surname>Nik-Zainal</surname><given-names>S</given-names></string-name>, <string-name><surname>Van Loo</surname><given-names>P</given-names></string-name>, <string-name><surname>Wedge</surname><given-names>DC</given-names></string-name>, <string-name><surname>Alexandrov</surname><given-names>LB</given-names></string-name>, <string-name><surname>Greenman</surname><given-names>CD</given-names></string-name>, <string-name><surname>Lau</surname><given-names>KW</given-names></string-name>, <string-name><surname>Raine</surname><given-names>K</given-names></string-name>, <string-name><surname>Jones</surname><given-names>D</given-names></string-name>, <string-name><surname>Marshall</surname><given-names>J</given-names></string-name>, <string-name><surname>Ramakrishna</surname><given-names>M</given-names></string-name>, <etal/><year>2012</year><article-title>The life history of 21 breast cancers</article-title>. <source>Cell</source><volume>149</volume>: <fpage>994</fpage>–<lpage>1007</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2012.04.023</pub-id><pub-id pub-id-type="pmid">22608083</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC35">
      <mixed-citation publication-type="journal"><string-name><surname>Nowell</surname><given-names>P</given-names></string-name>. <year>1976</year><article-title>The clonal evolution of tumor cell populations</article-title>. <source>Science</source><volume>194</volume>: <fpage>23</fpage>–<lpage>28</lpage>. <pub-id pub-id-type="doi">10.1126/science.959840</pub-id><pub-id pub-id-type="pmid">959840</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC36">
      <mixed-citation publication-type="journal"><string-name><surname>Pepper</surname><given-names>JW</given-names></string-name>, <string-name><surname>Scott Findlay</surname><given-names>C</given-names></string-name>, <string-name><surname>Kassen</surname><given-names>R</given-names></string-name>, <string-name><surname>Spencer</surname><given-names>SL</given-names></string-name>, <string-name><surname>Maley</surname><given-names>CC</given-names></string-name>. <year>2009</year><article-title>SYNTHESIS: Cancer research meets evolutionary biology</article-title>. <source>Evol Appl</source><volume>2</volume>: <fpage>62</fpage>–<lpage>70</lpage>. <pub-id pub-id-type="doi">10.1111/j.1752-4571.2008.00063.x</pub-id><pub-id pub-id-type="pmid">25567847</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC37">
      <mixed-citation publication-type="confproc"><string-name><surname>Pitman</surname><given-names>J</given-names></string-name>. <year>2006</year><article-title>Combinatorial stochastic processes</article-title>. <conf-name>Ecole d'Eté de Probabilités de Saint-Flour XXXII – 2002</conf-name> (ed. <string-name><surname>Picard</surname><given-names>J</given-names></string-name>). <publisher-name>Springer</publisher-name>, <publisher-loc>Berlin Heidelberg</publisher-loc>.</mixed-citation>
    </ref>
    <ref id="GR243121ZAFC38">
      <mixed-citation publication-type="journal"><string-name><surname>Ross</surname><given-names>EM</given-names></string-name>, <string-name><surname>Markowetz</surname><given-names>F</given-names></string-name>. <year>2016</year><article-title>OncoNEM: inferring tumor evolution from single-cell sequencing data</article-title>. <source>Genome Biol</source><volume>17</volume>: <fpage>69</fpage><pub-id pub-id-type="doi">10.1186/s13059-016-0929-9</pub-id><pub-id pub-id-type="pmid">27083415</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC39">
      <mixed-citation publication-type="journal"><string-name><surname>Roth</surname><given-names>A</given-names></string-name>, <string-name><surname>Khattra</surname><given-names>J</given-names></string-name>, <string-name><surname>Yap</surname><given-names>D</given-names></string-name>, <string-name><surname>Wan</surname><given-names>A</given-names></string-name>, <string-name><surname>Laks</surname><given-names>E</given-names></string-name>, <string-name><surname>Biele</surname><given-names>J</given-names></string-name>, <string-name><surname>Ha</surname><given-names>G</given-names></string-name>, <string-name><surname>Aparicio</surname><given-names>S</given-names></string-name>, <string-name><surname>Bouchard-Côté</surname><given-names>A</given-names></string-name>, <string-name><surname>Shah</surname><given-names>SP</given-names></string-name>. <year>2014</year><article-title>PyClone: statistical inference of clonal population structure in cancer</article-title>. <source>Nat Methods</source><volume>11</volume>: <fpage>396</fpage>–<lpage>398</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2883</pub-id><pub-id pub-id-type="pmid">24633410</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC40">
      <mixed-citation publication-type="journal"><string-name><surname>Roth</surname><given-names>A</given-names></string-name>, <string-name><surname>McPherson</surname><given-names>A</given-names></string-name>, <string-name><surname>Laks</surname><given-names>E</given-names></string-name>, <string-name><surname>Biele</surname><given-names>J</given-names></string-name>, <string-name><surname>Yap</surname><given-names>D</given-names></string-name>, <string-name><surname>Wan</surname><given-names>A</given-names></string-name>, <string-name><surname>Smith</surname><given-names>MA</given-names></string-name>, <string-name><surname>Nielsen</surname><given-names>CB</given-names></string-name>, <string-name><surname>McAlpine</surname><given-names>JN</given-names></string-name>, <string-name><surname>Aparicio</surname><given-names>S</given-names></string-name>, <etal/><year>2016</year><article-title>Clonal genotype and population structure inference from single-cell tumor sequencing</article-title>. <source>Nat Methods</source><volume>13</volume>: <fpage>573</fpage>–<lpage>576</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.3867</pub-id><pub-id pub-id-type="pmid">27183439</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC41">
      <mixed-citation publication-type="journal"><string-name><surname>Sainudiin</surname><given-names>R</given-names></string-name>, <string-name><surname>Véber</surname><given-names>A</given-names></string-name>. <year>2016</year><article-title>A Beta-splitting model for evolutionary trees</article-title>. <source>R Soc Open Sci</source><volume>3</volume>: <fpage>160016</fpage><pub-id pub-id-type="doi">10.1098/rsos.160016</pub-id><pub-id pub-id-type="pmid">27293780</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC42">
      <mixed-citation publication-type="journal"><string-name><surname>Schliep</surname><given-names>K</given-names></string-name>. <year>2011</year><article-title>phangorn: phylogenetic analysis in R</article-title>. <source>Bioinformatics</source><volume>27</volume>: <fpage>592</fpage>–<lpage>593</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq706</pub-id><pub-id pub-id-type="pmid">21169378</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC43">
      <mixed-citation publication-type="journal"><string-name><surname>Shah</surname><given-names>SP</given-names></string-name>, <string-name><surname>Roth</surname><given-names>A</given-names></string-name>, <string-name><surname>Goya</surname><given-names>R</given-names></string-name>, <string-name><surname>Oloumi</surname><given-names>A</given-names></string-name>, <string-name><surname>Ha</surname><given-names>G</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>Y</given-names></string-name>, <string-name><surname>Turashvili</surname><given-names>G</given-names></string-name>, <string-name><surname>Ding</surname><given-names>J</given-names></string-name>, <string-name><surname>Tse</surname><given-names>K</given-names></string-name>, <string-name><surname>Haffari</surname><given-names>G</given-names></string-name>, <etal/><year>2012</year><article-title>The clonal and mutational evolution spectrum of primary triple-negative breast cancers</article-title>. <source>Nature</source><volume>486</volume>: <fpage>395</fpage>–<lpage>399</lpage>. <pub-id pub-id-type="doi">10.1038/nature10933</pub-id><pub-id pub-id-type="pmid">22495314</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC44">
      <mixed-citation publication-type="journal"><string-name><surname>Sukumaran</surname><given-names>J</given-names></string-name>, <string-name><surname>Holder</surname><given-names>MT</given-names></string-name>. <year>2010</year><article-title>DendroPy: a Python library for phylogenetic computing</article-title>. <source>Bioinformatics</source><volume>26</volume>: <fpage>1569</fpage>–<lpage>1571</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq228</pub-id><pub-id pub-id-type="pmid">20421198</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC45">
      <mixed-citation publication-type="journal"><string-name><surname>Turke</surname><given-names>AB</given-names></string-name>, <string-name><surname>Zejnullahu</surname><given-names>K</given-names></string-name>, <string-name><surname>Wu</surname><given-names>Y-L</given-names></string-name>, <string-name><surname>Song</surname><given-names>Y</given-names></string-name>, <string-name><surname>Dias-Santagata</surname><given-names>D</given-names></string-name>, <string-name><surname>Lifshits</surname><given-names>E</given-names></string-name>, <string-name><surname>Toschi</surname><given-names>L</given-names></string-name>, <string-name><surname>Rogers</surname><given-names>A</given-names></string-name>, <string-name><surname>Mok</surname><given-names>T</given-names></string-name>, <string-name><surname>Sequist</surname><given-names>L</given-names></string-name>, <etal/><year>2010</year><article-title>Preexistence and clonal selection of <italic>MET</italic> amplification in <italic>EGFR</italic> mutant NSCLC</article-title>. <source>Cancer Cell</source><volume>17</volume>: <fpage>77</fpage>–<lpage>88</lpage>. <pub-id pub-id-type="doi">10.1016/j.ccr.2009.11.022</pub-id><pub-id pub-id-type="pmid">20129249</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC46">
      <mixed-citation publication-type="journal"><string-name><surname>Vogelstein</surname><given-names>B</given-names></string-name>, <string-name><surname>Papadopoulos</surname><given-names>N</given-names></string-name>, <string-name><surname>Velculescu</surname><given-names>VE</given-names></string-name>, <string-name><surname>Zhou</surname><given-names>S</given-names></string-name>, <string-name><surname>Diaz</surname><given-names>LA</given-names></string-name>, <string-name><surname>Kinzler</surname><given-names>KW</given-names></string-name>. <year>2013</year><article-title>Cancer genome landscapes</article-title>. <source>Science</source><volume>339</volume>: <fpage>1546</fpage>–<lpage>1558</lpage>. <pub-id pub-id-type="doi">10.1126/science.1235122</pub-id><pub-id pub-id-type="pmid">23539594</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC47">
      <mixed-citation publication-type="journal"><string-name><surname>Wang</surname><given-names>Y</given-names></string-name>, <string-name><surname>Waters</surname><given-names>J</given-names></string-name>, <string-name><surname>Leung</surname><given-names>ML</given-names></string-name>, <string-name><surname>Unruh</surname><given-names>A</given-names></string-name>, <string-name><surname>Roh</surname><given-names>W</given-names></string-name>, <string-name><surname>Shi</surname><given-names>X</given-names></string-name>, <string-name><surname>Chen</surname><given-names>K</given-names></string-name>, <string-name><surname>Scheet</surname><given-names>P</given-names></string-name>, <string-name><surname>Vattathil</surname><given-names>S</given-names></string-name>, <string-name><surname>Liang</surname><given-names>H</given-names></string-name>, <etal/><year>2014</year><article-title>Clonal evolution in breast cancer revealed by single nucleus genome sequencing</article-title>. <source>Nature</source><volume>512</volume>: <fpage>155</fpage>–<lpage>160</lpage>. <pub-id pub-id-type="doi">10.1038/nature13600</pub-id><pub-id pub-id-type="pmid">25079324</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC48">
      <mixed-citation publication-type="journal"><string-name><surname>Williams</surname><given-names>MJ</given-names></string-name>, <string-name><surname>Werner</surname><given-names>B</given-names></string-name>, <string-name><surname>Barnes</surname><given-names>CP</given-names></string-name>, <string-name><surname>Graham</surname><given-names>TA</given-names></string-name>, <string-name><surname>Sottoriva</surname><given-names>A</given-names></string-name>. <year>2016</year><article-title>Identification of neutral tumor evolution across cancer types</article-title>. <source>Nat Genet</source><volume>48</volume>: <fpage>238</fpage>–<lpage>244</lpage>. <pub-id pub-id-type="doi">10.1038/ng.3489</pub-id><pub-id pub-id-type="pmid">26780609</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC49">
      <mixed-citation publication-type="journal"><string-name><surname>Wu</surname><given-names>X</given-names></string-name>, <string-name><surname>Northcott</surname><given-names>P</given-names></string-name>, <string-name><surname>Dubuc</surname><given-names>A</given-names></string-name>, <string-name><surname>Dupuy</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Shih</surname><given-names>DJH</given-names></string-name>, <string-name><surname>Witt</surname><given-names>H</given-names></string-name>, <string-name><surname>Croul</surname><given-names>S</given-names></string-name>, <string-name><surname>Bouffet</surname><given-names>E</given-names></string-name>, <string-name><surname>Fults</surname><given-names>DW</given-names></string-name>, <string-name><surname>Eberhart</surname><given-names>C</given-names></string-name>, <etal/><year>2012</year><article-title>Clonal selection drives genetic divergence of metastatic medulloblastoma</article-title>. <source>Nature</source><volume>482</volume>: <fpage>529</fpage>–<lpage>533</lpage>. <pub-id pub-id-type="doi">10.1038/nature10825</pub-id><pub-id pub-id-type="pmid">22343890</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC50">
      <mixed-citation publication-type="journal"><string-name><surname>Yates</surname><given-names>LR</given-names></string-name>, <string-name><surname>Campbell</surname><given-names>PJ</given-names></string-name>. <year>2012</year><article-title>Evolution of the cancer genome</article-title>. <source>Nat Rev Genet</source><volume>13</volume>: <fpage>795</fpage>–<lpage>806</lpage>. <pub-id pub-id-type="doi">10.1038/nrg3317</pub-id><pub-id pub-id-type="pmid">23044827</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC51">
      <mixed-citation publication-type="journal"><string-name><surname>Yates</surname><given-names>LR</given-names></string-name>, <string-name><surname>Gerstung</surname><given-names>M</given-names></string-name>, <string-name><surname>Knappskog</surname><given-names>S</given-names></string-name>, <string-name><surname>Desmedt</surname><given-names>C</given-names></string-name>, <string-name><surname>Gundem</surname><given-names>G</given-names></string-name>, <string-name><surname>Van Loo</surname><given-names>P</given-names></string-name>, <string-name><surname>Aas</surname><given-names>T</given-names></string-name>, <string-name><surname>Alexandrov</surname><given-names>LB</given-names></string-name>, <string-name><surname>Larsimont</surname><given-names>D</given-names></string-name>, <string-name><surname>Davies</surname><given-names>H</given-names></string-name>, <etal/><year>2015</year><article-title>Subclonal diversification of primary breast cancer revealed by multiregion sequencing</article-title>. <source>Nat Methods</source><volume>21</volume>: <fpage>751</fpage>–<lpage>759</lpage>. <pub-id pub-id-type="doi">10.1038/nm.3886</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC52">
      <mixed-citation publication-type="journal"><string-name><surname>Zafar</surname><given-names>H</given-names></string-name>, <string-name><surname>Tzen</surname><given-names>A</given-names></string-name>, <string-name><surname>Navin</surname><given-names>N</given-names></string-name>, <string-name><surname>Chen</surname><given-names>K</given-names></string-name>, <string-name><surname>Nakhleh</surname><given-names>L</given-names></string-name>. <year>2017</year><article-title>SiFit: inferring tumor trees from single-cell sequencing data under finite-sites models</article-title>. <source>Genome Biol</source><volume>18</volume>: <fpage>178</fpage><pub-id pub-id-type="doi">10.1186/s13059-017-1311-2</pub-id><pub-id pub-id-type="pmid">28927434</pub-id></mixed-citation>
    </ref>
    <ref id="GR243121ZAFC53">
      <mixed-citation publication-type="journal"><string-name><surname>Zafar</surname><given-names>H</given-names></string-name>, <string-name><surname>Navin</surname><given-names>N</given-names></string-name>, <string-name><surname>Nakhleh</surname><given-names>L</given-names></string-name>, <string-name><surname>Chen</surname><given-names>K</given-names></string-name>. <year>2018</year><article-title>Computational approaches for inferring tumor evolution from single-cell genomic data</article-title>. <source>Curr Opin Syst Biol</source><volume>7</volume>: <fpage>16</fpage>–<lpage>25</lpage>. <pub-id pub-id-type="doi">10.101s6/j.coisb.2017.11.008</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
