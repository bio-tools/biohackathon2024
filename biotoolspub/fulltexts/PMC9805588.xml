<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9805588</article-id>
    <article-id pub-id-type="pmid">36453872</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac772</article-id>
    <article-id pub-id-type="publisher-id">btac772</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Treenome Browser: co-visualization of enormous phylogenies and millions of genomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-3630-3209</contrib-id>
        <name>
          <surname>Kramer</surname>
          <given-names>Alexander M</given-names>
        </name>
        <aff><institution>Department of Biomolecular Engineering, University of California, Santa Cruz</institution>, Santa Cruz, CA 95064, <country country="US">USA</country></aff>
        <aff><institution>Genomics Institute, University of California, Santa Cruz</institution>, Santa Cruz, CA 95064, <country country="US">USA</country></aff>
        <xref rid="btac772-cor1" ref-type="corresp"/>
        <!--alex.kramer@ucsc.edu-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sanderson</surname>
          <given-names>Theo</given-names>
        </name>
        <aff><institution>The Francis Crick Institute</institution>, London NW1 1AT, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Corbett-Detig</surname>
          <given-names>Russell</given-names>
        </name>
        <aff><institution>Department of Biomolecular Engineering, University of California, Santa Cruz</institution>, Santa Cruz, CA 95064, <country country="US">USA</country></aff>
        <aff><institution>Genomics Institute, University of California, Santa Cruz</institution>, Santa Cruz, CA 95064, <country country="US">USA</country></aff>
        <xref rid="btac772-cor1" ref-type="corresp"/>
        <!--rucorbet@ucsc.edu-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac772-cor1">To whom correspondence should be addressed. Email: <email>alex.kramer@ucsc.edu</email> or <email>rucorbet@ucsc.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-12-01">
      <day>01</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>01</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <volume>39</volume>
    <issue>1</issue>
    <elocation-id>btac772</elocation-id>
    <history>
      <date date-type="received">
        <day>27</day>
        <month>9</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>22</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>26</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>29</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>07</day>
        <month>12</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac772.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Treenome Browser is a web browser tool to interactively visualize millions of genomes alongside huge phylogenetic trees.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>Treenome Browser for SARS-CoV-2 can be accessed at <ext-link xlink:href="https://cov2tree.org/" ext-link-type="uri">cov2tree.org</ext-link>, or at <ext-link xlink:href="https://taxonium.org/" ext-link-type="uri">taxonium.org</ext-link> for user-provided trees. Source code and documentation are available at <ext-link xlink:href="http://github.com/theosanderson/taxonium" ext-link-type="uri">github.com/theosanderson/taxonium</ext-link> and <ext-link xlink:href="https://docs.taxonium.org/en/latest/treenome.html" ext-link-type="uri">docs.taxonium.org/en/latest/treenome.html</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Centers for Disease Control</institution>
            <institution-id institution-id-type="DOI">10.13039/100000030</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>BAA 200-2021-11554</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>210918/Z/18/Z</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Francis Crick Institute</institution>
            <institution-id institution-id-type="DOI">10.13039/100010438</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Cancer Research UK</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000289</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>FC001043</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>UK Medical Research</institution>
          </institution-wrap>
        </funding-source>
        <award-id>FC001043</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>FC001043</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Huge genomic datasets are increasingly common and widely available. The ongoing coronavirus disease 2019 pandemic has particularly stressed existing bioinformatic infrastructure for the analysis of genomic data. We developed UShER (<xref rid="btac772-B8" ref-type="bibr">Turakhia <italic toggle="yes">et al.</italic>, 2021</xref>) to enable the inference of a continuously growing phylogeny containing millions of SARS-CoV-2 genomes (<xref rid="btac772-B4" ref-type="bibr">McBroome <italic toggle="yes">et al.</italic>, 2021</xref>) and Taxonium to enable interactive exploration of phylogenies of this size (<xref rid="btac772-B5" ref-type="bibr">Sanderson, 2022</xref>). Gingr (<xref rid="btac772-B7" ref-type="bibr">Treangen <italic toggle="yes">et al.</italic>, 2014</xref>) and the UCSC Genome Browser can display a multiple sequence alignment alongside a phylogeny (<xref rid="btac772-B3" ref-type="bibr">Lee <italic toggle="yes">et al.</italic>, 2022</xref>). However, no existing tool can simultaneously visualize million sample phylogenies with their underlying genome sequences.</p>
    <p>We present Treenome Browser, a visualization tool for exploring genetic variation in millions of genomes alongside a huge phylogeny. Treenome Browser uses an innovative phylogenetic compression technique to interactively display the genome of each sample aligned with its phylogenetic position, remaining performant on trees with over 12 million sequences. The web application is available at <ext-link xlink:href="https://cov2tree.org/" ext-link-type="uri">cov2tree.org</ext-link> for the global SARS-CoV-2 tree and at <ext-link xlink:href="https://taxonium.org/" ext-link-type="uri">taxonium.org</ext-link> for user-provided trees.</p>
  </sec>
  <sec>
    <title>2. Description</title>
    <p>Treenome Browser displays mutations as vertical lines spanning the mutation’s presence among samples in the phylogeny, drawn at their horizontal position in an associated reference genome (<xref rid="btac772-F1" ref-type="fig">Fig. 1</xref>). Both amino acid and nucleotide mutations are supported. When the whole tree is visible, the genetic signatures of major clades in the tree become apparent. Users can search or manually zoom to samples in the tree to inspect smaller clades and individual genomes. The genome alignment can also be navigated to analyze sites or regions of interest. Potential applications of Treenome Browser include variation-informed primer design, uncovering technical artifacts in tree construction or primary sequence assembly and investigating molecular evolutionary processes. We provide a special build of Treenome Browser for the global SARS-CoV-2 tree at <ext-link xlink:href="https://cov2tree.org/" ext-link-type="uri">cov2tree.org</ext-link>. This site is preloaded with annotations for the reference genome (RefSeq NC_045512v2) curated by the UCSC Genome Browser (<xref rid="btac772-B3" ref-type="bibr">Lee <italic toggle="yes">et al.</italic>, 2022</xref>). We also support user-provided mutation-annotated trees created with UShER, which can be produced using the TaxoniumTools package (<xref rid="btac772-B5" ref-type="bibr">Sanderson 2022</xref>) and loaded at <ext-link xlink:href="https://taxonium.org/" ext-link-type="uri">taxonium.org</ext-link>.</p>
    <fig position="float" id="btac772-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Treenome Browser for the global SARS-CoV-2 tree with 5.9 million genomes, shown with the ARTIC Primers v4.1 annotation track (<ext-link xlink:href="https://community.artic.network/t/sars-cov-2-v4-1-update-for-omicron-variant/342" ext-link-type="uri">https://community.artic.network/t/sars-cov-2-v4-1-update-for-omicron-variant/342</ext-link>). Colored lines represent amino acid mutations relative to the reference genome</p>
      </caption>
      <graphic xlink:href="btac772f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>3. Implementation</title>
    <p>The mutation-annotated tree data structure enables Treenome Browser to scale to huge trees. This data structure is used by UShER and Taxonium to encode genomic data in the form of a phylogeny with the inferred emergence of mutations annotated on each node. The genotype data encoded in a mutation-annotated tree is often many times smaller than the same data in VCF format (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). We use this phylogenetic compression to efficiently display mutations. Compared to an existing tool with similar functionality, Treenome Browser is much faster and scales to much larger phylogenomic datasets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>).</p>
    <p>The core algorithm used by Treenome Browser decodes a mutation-annotated tree to compute the on-screen position of each mutation in the tree. To compute vertical positions, the vertical span of each subclade of the tree is first stored using dynamic programming. These pre-computed positions are then used along with horizontal positions computed on-the-fly to draw each annotated mutation on screen as it is encountered in a traversal of the tree from root to leaves. We use the deck.gl framework (<ext-link xlink:href="https://github.com/visgl/deck.gl" ext-link-type="uri">https://github.com/visgl/deck.gl</ext-link>) to render the mutations along the genome, which exploits WebGL to render large datasets much more quickly than traditional approaches for web visualization. This phylogenetically informed process displays on screen the complete set of amino acid and/or nucleotide substitutions in every leaf genome without explicitly enumerating the mutations in each genome, increasing rendering speed and reducing memory usage (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>).</p>
    <p>Treenome Browser further increases performance by subsampling nodes and mutations. Because many nodes occupy essentially the same spatial position when the tree is zoomed out, Taxonium dynamically displays sparsified trees from the full tree (<xref rid="btac772-B5" ref-type="bibr">Sanderson, 2022</xref>). Treenome Browser also uses these subsampled trees when displaying mutations to avoid unneeded computation. This tool further filters mutations by discarding those spanning very small clades at a given zoom level. These subsampling steps exclude imperceptible data based on zoom level while allowing users to view any individual node or mutation.</p>
    <p>The reference genome and annotation tracks are displayed in an interactive JBrowse 2 (Buels <italic toggle="yes">et al</italic>., 2016) panel. Annotations are loaded into Treenome Browser automatically for the global SARS-CoV-2 tree at <ext-link xlink:href="https://cov2tree.org/" ext-link-type="uri">cov2tree.org</ext-link>. We use the UCSC Genome Browser API to fetch each bigBed and bigWig annotation file curated by UCSC for SARS-CoV-2 (Fernandes <italic toggle="yes">et al.</italic>, 2020). These annotations and user-provided annotation files are displayed by JBrowse 2. Treenome Browser is implemented in React as a feature addition to the Taxonium project. Source code is available at <ext-link xlink:href="https://github.com/theosanderson/taxonium/tree/master/taxonium_web_client" ext-link-type="uri">https://github.com/theosanderson/taxonium/tree/master/taxonium_web_client</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac772_Supplementary_Data</label>
      <media xlink:href="btac772_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors gratefully acknowledge the many developers of the open-source projects enabling the development of Treenome Browser and those who have generated and submitted the sequence data visualized by our tool. We also thank Jakob McBroome, Angie Hinrichs and Yatish Turakhia for their feedback and helpful discussions.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the Centers for Disease Control [BAA 200-2021-11554 to A.K. and R.C.D.]. T.S. is supported by the Wellcome Trust [210918/Z/18/Z] and the Francis Crick Institute which receives its core funding from Cancer Research UK [FC001043], the UK Medical Research [FC001043] Council and the Wellcome Trust [FC001043].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <sec sec-type="data-availability">
    <title>Data availability</title>
    <p>Files used in our supplemental experiments are available at <ext-link xlink:href="http://hgdownload.soe.ucsc.edu/goldenPath/wuhCor1/UShER_SARS-CoV-2/2022/09/21/" ext-link-type="uri">http://hgdownload.soe.ucsc.edu/goldenPath/wuhCor1/UShER_SARS-CoV-2/2022/09/21/</ext-link>. The latest Taxonium mutation-annotated tree is available at <ext-link xlink:href="https://cov2tree.nyc3.cdn.digitaloceanspaces.com/latest_public.jsonl.gz" ext-link-type="uri">https://cov2tree.nyc3.cdn.digitaloceanspaces.com/latest_public.jsonl.gz</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac772-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>B.T.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>The UCSC genome browser database: 2022 update</article-title>. <source>Nucleic Acids Res</source>., <volume>50</volume>, <fpage>D1115</fpage>–<lpage>D1122</lpage>.<pub-id pub-id-type="pmid">34718705</pub-id></mixed-citation>
    </ref>
    <ref id="btac772-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McBroome</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>A daily-updated database and tools for comprehensive SARS-CoV-2 mutation-annotated trees</article-title>. <source>Mol. Biol. Evol</source>., <volume>38</volume>, <fpage>5819</fpage>–<lpage>5824</lpage>.<pub-id pub-id-type="pmid">34469548</pub-id></mixed-citation>
    </ref>
    <ref id="btac772-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sanderson</surname><given-names>T.</given-names></string-name></person-group> (<year>2022</year>) <article-title>Taxonium: a web-based tool for exploring large phylogenetic trees</article-title>. <source>eLife</source>, <volume>11</volume>, <fpage>e82392</fpage>.<pub-id pub-id-type="pmid">36377483</pub-id></mixed-citation>
    </ref>
    <ref id="btac772-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Treangen</surname><given-names>T.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>The harvest suite for rapid core-genome alignment and visualization of thousands of intraspecific microbial genomes</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>524</fpage>.<pub-id pub-id-type="pmid">25410596</pub-id></mixed-citation>
    </ref>
    <ref id="btac772-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Turakhia</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Ultrafast sample placement on existing tRees (UShER) enables real-time phylogenetics for the SARS-CoV-2 pandemic</article-title>. <source>Nat. Genet</source>., <volume>53</volume>, <fpage>809</fpage>–<lpage>816</lpage>.<pub-id pub-id-type="pmid">33972780</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
