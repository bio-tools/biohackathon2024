<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6247925</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/bty476</article-id>
    <article-id pub-id-type="publisher-id">bty476</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Meffil: efficient normalization and analysis of very large DNA methylation datasets</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Min</surname>
          <given-names>J L</given-names>
        </name>
        <xref ref-type="aff" rid="bty476-aff1">1</xref>
        <xref ref-type="aff" rid="bty476-aff2">2</xref>
        <xref ref-type="corresp" rid="bty476-cor1"/>
        <xref ref-type="author-notes" rid="bty476-FM1"/>
        <!--<email>josine.min@bristol.ac.uk</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hemani</surname>
          <given-names>G</given-names>
        </name>
        <xref ref-type="aff" rid="bty476-aff1">1</xref>
        <xref ref-type="aff" rid="bty476-aff2">2</xref>
        <xref ref-type="author-notes" rid="bty476-FM1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Davey Smith</surname>
          <given-names>G</given-names>
        </name>
        <xref ref-type="aff" rid="bty476-aff1">1</xref>
        <xref ref-type="aff" rid="bty476-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Relton</surname>
          <given-names>C</given-names>
        </name>
        <xref ref-type="aff" rid="bty476-aff1">1</xref>
        <xref ref-type="aff" rid="bty476-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Suderman</surname>
          <given-names>M</given-names>
        </name>
        <xref ref-type="aff" rid="bty476-aff1">1</xref>
        <xref ref-type="aff" rid="bty476-aff2">2</xref>
        <xref ref-type="corresp" rid="bty476-cor1"/>
        <!--<email>matthew.suderman@bristol.ac.uk</email>-->
      </contrib>
    </contrib-group>
    <aff id="bty476-aff1"><label>1</label>MRC Integrative Epidemiology Unit, University of Bristol, Bristol, UK</aff>
    <aff id="bty476-aff2"><label>2</label>Bristol Medical School, University of Bristol, Bristol, UK</aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Hancock</surname>
          <given-names>John</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="bty476-cor1">To whom correspondence should be addressed. E-mail: <email>josine.min@bristol.ac.uk</email> or <email>matthew.suderman@bristol.ac.uk</email></corresp>
      <fn id="bty476-FM1">
        <p>The authors wish it to be known that J. L. Min and G. Hemani authors contributed equally.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>12</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2018-06-21">
      <day>21</day>
      <month>6</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>21</day>
      <month>6</month>
      <year>2018</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>23</issue>
    <fpage>3983</fpage>
    <lpage>3989</lpage>
    <history>
      <date date-type="received">
        <day>09</day>
        <month>1</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>06</day>
        <month>5</month>
        <year>2018</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>6</month>
        <year>2018</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2018. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2018</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="bty476.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>DNA methylation datasets are growing ever larger both in sample size and genome coverage. Novel computational solutions are required to efficiently handle these data.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We have developed <italic>meffil</italic>, an R package designed for efficient quality control, normalization and epigenome-wide association studies of large samples of Illumina Methylation BeadChip microarrays. A complete re-implementation of functional normalization minimizes computational memory without increasing running time. Incorporating fixed and random effects within functional normalization, and automated estimation of functional normalization parameters reduces technical variation in DNA methylation levels, thus reducing false positive rates and improving power. Support for normalization of datasets distributed across physically different locations without needing to share biologically-based individual-level data means that <italic>meffil</italic> can be used to reduce heterogeneity in meta-analyses of epigenome-wide association studies.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>
          <ext-link ext-link-type="uri" xlink:href="https://github.com/perishky/meffil/">https://github.com/perishky/meffil/</ext-link>
        </p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Medical Research Council</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000265</named-content>
        </funding-source>
        <award-id>102215/2/13/2</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">ALSPAC</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">University of Bristol</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000883</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">ALSPAC</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">UK Economic and Social Research Council</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">UK Medical Research Council</named-content>
        </funding-source>
        <award-id>MC_UU_12013/1</award-id>
        <award-id>MC_UU_12013/2</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Danish National Research Foundation</named-content>
          <named-content content-type="funder-identifier">10.13039/501100001732</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Danish Regional Committees</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Pharmacy Foundation</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Egmont Foundation</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">March of Dimes Birth Defects Foundation</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Health Foundation</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000724</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Novo Nordisk Foundation</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Lundbeck Foundation</named-content>
          <named-content content-type="funder-identifier">10.13039/501100003554</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Medical Research Council Integrative Epidemiology Unit</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">UK Medical Research Council and the Health Foundation</named-content>
        </funding-source>
        <award-id>[MC_UU_12013/1-9</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">University of Bristol</named-content>
          <named-content content-type="funder-identifier">10.13039/501100000883</named-content>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>DNA methylation is the addition of methyl groups to cytosine bases in the DNA sequence, most often in the context of a CpG dinucleotide, a cytosine followed by a guanine. The addition or loss of methyl groups is often associated with changes in gene expression, and through epigenome wide associations studies (EWAS) it has been shown to associate with a wide range of complex traits. A number of technologies have been developed for interrogating DNA methylation including microarrays and sequencing-based methods. The Illumina Infinium HumanMethylation450 BeadChip (450k array) can be used to measure DNA methylation of 485k CpG sites, comprising just under 2% of the total genomic CpG content mainly clustered around the transcription start sites (<xref rid="bty476-B28" ref-type="bibr">Michels <italic>et al.</italic>, 2013</xref>). The new Illumina Infinium MethylationEPIC BeadChip (EPIC array) expands this coverage to ∼850k sites to include enhancer regions identified by ENCODE (<xref rid="bty476-B18" ref-type="bibr">Hong <italic>et al.</italic>, 2016</xref>) and FANTOM5 (<xref rid="bty476-B3" ref-type="bibr">Andersson <italic>et al.</italic>, 2014</xref>).</p>
    <p>Batch effects present a well-known challenge to microarray analysis (<xref rid="bty476-B38" ref-type="bibr">Teschendorff <italic>et al.</italic>, 2011</xref>), particularly in datasets composed of thousands of samples since they cannot all possibly be processed at the same times and by the same technical personnel (<xref rid="bty476-B22" ref-type="bibr">Leek <italic>et al.</italic>, 2010</xref>). This unwanted variation can increase both false negative and false positive rates if correlated with the outcome of interest, and controlling for this is not trivial, especially as sample sizes continue to grow.</p>
    <p>Following the popularity of quantile normalization for analyzing gene expression microarrays (<xref rid="bty476-B8" ref-type="bibr">Bolstad <italic>et al.</italic>, 2003</xref>), many variations based on quantile normalization have been developed for DNA methylation microarrays (<xref rid="bty476-B24" ref-type="bibr">Lehne <italic>et al.</italic>, 2015</xref>; <xref rid="bty476-B37" ref-type="bibr">Teschendorff <italic>et al.</italic>, 2013</xref>; <xref rid="bty476-B39" ref-type="bibr">Touleimat and Tost, 2012</xref>), however, all assume that global methylation does not vary between samples (<xref rid="bty476-B17" ref-type="bibr">Hicks and Irizarry, 2015</xref>). When this does not hold, most notably between tumor and normal samples, between different tissue types, or when there are batch differences between cases and controls, quantile normalization can remove biological variation along with technical variation [e.g. (<xref rid="bty476-B11" ref-type="bibr">Fortin <italic>et al.</italic>, 2014b</xref>; <xref rid="bty476-B16" ref-type="bibr">Heiss and Brenner, 2015</xref>)]. A feature of 450k and EPIC arrays is the inclusion of control probes–probes that do not assay biological variation and only vary due to technical effects. Functional normalization (FN; <xref rid="bty476-B11" ref-type="bibr">Fortin <italic>et al.</italic>, 2014b</xref>) exploits control probes to separate biological variation from technical variation, and its performance compares favorably to other approaches (<xref rid="bty476-B11" ref-type="bibr">Fortin <italic>et al.</italic>, 2014b</xref>; <xref rid="bty476-B16" ref-type="bibr">Heiss and Brenner, 2015</xref>; <xref rid="bty476-B24" ref-type="bibr">Lehne <italic>et al.</italic>, 2015</xref>; <xref rid="bty476-B25" ref-type="bibr">Liu and Siegmund, 2016</xref>; <xref rid="bty476-B26" ref-type="bibr">Maksimovic <italic>et al.</italic>, 2015</xref>).</p>
    <p>Many DNA methylation datasets using 450k and EPIC arrays have now been generated independently and are being used in EWAS to discover associations between CpG sites and a variety of exposures, complex traits and disease risks. Much like genome-wide association studies (GWAS), the widespread use of the Illumina platform has made possible large-scale meta-analyses organized by international consortium-based efforts that are combining ever larger numbers of subjects to reach statistical power to detect robust associations. However, unlike GWAS, it comes with a number of crucial challenges that have not been fully resolved. First, most existing software tools for quality control and normalizing DNA methylation levels were not designed to handle datasets comprising thousands of samples, and recently developed tools in R (<xref rid="bty476-B15" ref-type="bibr">Gorrie-Stone, 2018</xref>) and Java (<xref rid="bty476-B2" ref-type="bibr">Almeida <italic>et al.</italic>, 2017</xref>) may not provide desired functionality. Second, sharing of individual-level data is prohibited due to ethical considerations, so meta-analyses are liable to encounter heterogeneity introduced when datasets are normalized independently. Third, there is currently no universally accepted standard approach that addresses all aspects of dataset quality control and normalization of large datasets. Fourth, there is no standardized approach for selecting and comparing statistical models for EWAS, including selection and generation of covariates. Fifth, there is currently no standard for sharing quality control information and EWAS findings.</p>
    <p>We have developed <italic>meffil</italic> (Efficient algorithms for analyzing DNA methylation data) to provide solutions in a user-friendly and open source R package (<ext-link ext-link-type="uri" xlink:href="https://github.com/perishky/meffil">https://github.com/perishky/meffil</ext-link>). <xref ref-type="fig" rid="bty476-F1">Figure 1</xref> shows the <italic>meffil</italic> work-flow from raw data to quality control to normalized data to EWAS. Meffil includes functionality for identifying low quality methylation measurements, discovering and rectifying sample mismatches, merging datasets containing both 450k and EPIC arrays, removing confounding effects of cell type heterogeneity and assessing the quality of observed associations. In this paper, we describe its implementation and evaluate the computational and statistical advantages that it achieves, while demonstrating where limitations might still exist.
</p>
    <fig id="bty476-F1" orientation="portrait" position="float">
      <label>Fig. 1.</label>
      <caption>
        <p>The workflow of <italic>meffil</italic></p>
      </caption>
      <graphic xlink:href="bty476f1"/>
    </fig>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Data</title>
      <p>Full details of the Accessible Resource for Integrated Epigenomic Studies (ARIES; <xref rid="bty476-B33" ref-type="bibr">Relton <italic>et al.</italic>, 2015</xref>) and Genetics of Overweight Young Adults (GOYA; <xref rid="bty476-B30" ref-type="bibr">Paternoster <italic>et al.</italic>, 2011</xref>) datasets are provided in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>. DNA methylation was quantified in bisulfite-converted genomic DNA using 450k arrays for all samples. Some samples were removed due to genotype and gender mismatches and methylation quality (low detection scores, low number of beads, methylated/unmethylated ratio, strong dye-bias, post-normalization checks). Samples were normalized using FN using <italic>meffil.</italic> After normalization we checked for batch effects including bisulfite-conversion plate (‘plate’) and beadchip (‘slide’).</p>
    </sec>
    <sec>
      <title>2.2 Implementation of <italic>meffil</italic></title>
      <p><italic>Meffil</italic> is designed around a re-implementation of FN as implemented in the <italic>minfi</italic> R package (<xref rid="bty476-B11" ref-type="bibr">Fortin <italic>et al.</italic>, 2014b</xref>). Output using default settings and without enhancements is therefore identical to <italic>minfi</italic> (<xref rid="bty476-B4" ref-type="bibr">Aryee <italic>et al.</italic>, 2014</xref>)<italic>. Meffil</italic> uses the <italic>illuminaio</italic> R package (<xref rid="bty476-B36" ref-type="bibr">Smith <italic>et al.</italic>, 2013</xref>) to parse Illumina IDAT files into QC objects (<xref ref-type="fig" rid="bty476-F1">Fig. 1</xref>) which contain raw control probe summaries, quantile distributions of raw probe intensities, poor quality probes based on detection <italic>P</italic>-values and number of beads, predicted sex (<xref rid="bty476-B4" ref-type="bibr">Aryee <italic>et al.</italic>, 2014</xref>), predicted cellular composition (<xref rid="bty476-B19" ref-type="bibr">Houseman <italic>et al.</italic>, 2012</xref>) when a cell type reference is specified and batch variable values. As in minfi, probe intensities are dye-bias and background corrected using the ‘noob’ method (<xref rid="bty476-B40" ref-type="bibr">Triche <italic>et al.</italic>, 2013</xref>). Control probes are summarized as 42 different control types in a control matrix with one row for each control type and one column for each sample.</p>
      <p>This summary object is all that is needed to perform quality control, sample and CpG site filtering, identification of batch effects and the normalization of sample quantiles, the first normalization step of FN. In this step, probe intensity quantiles are normalized between samples by fitting linear models with these quantiles to the top principal components of the control matrix. The resulting quantile residuals for each QC object are retained as a set of normalized quantiles which are then used in the second normalization step where the raw probe intensities for each sample are adjusted to conform to its set of normalized quantiles.</p>
      <p>This memory-reducing innovation makes it possible to perform the second normalization step on small subsets of the dataset, each at different times or on different compute servers. Parallelization of the normalization is possible when either a single compute server has multiple processors or the normalization is being performed on a compute cluster. After the second normalization step has been completed for each individual sample, the resulting normalized methylation data subsets may be merged into a single dataset for DNA methylation analyses. The order of or server on which the samples were normalized does not affect the final normalized values in any way.</p>
    </sec>
    <sec>
      <title>2.3 Quality control features</title>
      <p>In <italic>meffil</italic>, quality control reports can be generated in order to uncover variation due to technical artefacts, identify outliers and flag poor quality probes and samples using detection <italic>P</italic>-values, number of beads, ratio of unmethylated/methylated signal, dyebias and control probe checks. The report also provides checks for sample swap detection using SNP discordance between methylation and genotype arrays as well as a gender check (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>).</p>
      <p><italic>Meffil</italic> generates a normalization report with coefficients plots comparing the strength of associations between batch variables with control probes and with normalized data. The report contains a table with ANOVA F and post-hoc <italic>t</italic>-statistics that pass a user-defined significance threshold to identify problematic batches, e.g. a specific slide with technical artefacts that are not sufficiently resolved by normalization (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>). All reports are generated in markdown and HTML.</p>
    </sec>
    <sec>
      <title>2.4 Extending FN to reduce technical variation</title>
      <p><italic>Meffil</italic> provides two new features to reduce technical variation: (i) a method to identify the number of principal components that minimizes the residual variance unexplained by the given number of principal components. Residual variance is calculated under a 10-fold cross-validation scheme in order to avoid overfitting. (ii) We observed that FN failed to completely remove the variance due to certain technical artefacts such as sample slide or slide row. To address this, we allow the user to normalize sample quantiles using additional fixed and random effects. Random effects are handled using the <italic>lme4</italic> R package (<xref rid="bty476-B7" ref-type="bibr">Bates <italic>et al.</italic>, 2015</xref>).</p>
    </sec>
    <sec>
      <title>2.5 EWAS pipeline</title>
      <p>To deliver a comprehensive and integrated toolkit for methylation analysis, <italic>meffil</italic> also provides an EWAS pipeline. Linear regression models are fitted using <italic>limma</italic> (<xref rid="bty476-B34" ref-type="bibr">Ritchie <italic>et al.</italic>, 2015</xref>). Confounding effects are handled by including appropriate covariates in the EWAS. By default, <italic>meffil</italic> fits four different regression models: no covariates, only supplied covariates, supplied and surrogate variables obtained by surrogate variable analysis (SVA; <xref rid="bty476-B21" ref-type="bibr">Leek <italic>et al.</italic>, 2012</xref>; <xref rid="bty476-B23" ref-type="bibr">Leek and Storey, 2007</xref>) and supplied and surrogate variables obtained by independent surrogate variable analysis (ISVA; <xref rid="bty476-B38" ref-type="bibr">Teschendorff <italic>et al.</italic>, 2011</xref>). <italic>Meffil</italic> allows estimation of cellular composition using the Houseman algorithm (<xref rid="bty476-B19" ref-type="bibr">Houseman <italic>et al.</italic>, 2012</xref>) from DNA methylation profiles based on several publicly available blood reference datasets including three cord blood references (<xref rid="bty476-B6" ref-type="bibr">Bakulski <italic>et al.</italic>, 2016</xref>; <xref rid="bty476-B9" ref-type="bibr">de Goede <italic>et al.</italic>, 2015</xref>; <xref rid="bty476-B14" ref-type="bibr">Gervin <italic>et al.</italic>, 2016</xref>) and one peripheral blood reference (<xref rid="bty476-B32" ref-type="bibr">Reinius <italic>et al.</italic>, 2012</xref>) or from user-supplied references.</p>
      <p>EWAS results are summarized in a report that includes quantile-quantile, Manhattan, covariate and variable-of-interest plots as well as tables and scatterplots showing the strongest as well as user-defined candidate CpG site associations. Outputs are displayed to allow comparison between each of the different EWAS models (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S3</xref>).</p>
    </sec>
    <sec>
      <title>2.6 Analysis that protects study participant privacy</title>
      <p>Because the control probes capture only technical variation, they are fundamentally non-disclosive. It is possible to use <italic>meffil</italic> to normalize datasets residing on distinct servers together while sharing only the control probe summaries and probe intensity quantiles between the two servers. This information cannot be used to identify individuals and should not violate most cohort participant privacy agreements. Actual phenotype or DNA methylation levels need never be shared.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Automated normalization for heterogeneous data with improved computational efficiency</title>
      <sec>
        <title><italic>3.1.1</italic> Computational efficiency</title>
        <p>Our original motivation for creating <italic>meffil</italic> was an inability to successfully normalize ∼5400 450k arrays using available software tools and computational resources. The main impediment was the large memory requirement of loading all data into memory before normalization could be initiated. We discovered, however, that FN (<xref rid="bty476-B11" ref-type="bibr">Fortin <italic>et al.</italic>, 2014b</xref>) could be reimplemented in a way that uses a small fraction (∼1/20) of the memory required by the entire dataset. In particular, we realized that FN could be completed one sample at a time while holding in memory a relatively small summary of probe intensities for each sample. The summary consists of a control probe matrix and probe intensity quantiles. After the summary has been collected, FN then proceeds to normalize intensity quantiles by removing control probe variation. Normalized methylation levels for each sample can then be derived from the normalized quantiles independently of all other samples.</p>
        <p>To minimize running time, the <italic>meffil</italic> implementation makes use of the R parallel package (<xref rid="bty476-B31" ref-type="bibr">R Core Team, 2014</xref>) to allow normalization of multiple samples simultaneously. Normalization of 5469 450k arrays took 3 h on a compute server with 64 Gb of RAM and 16 processors. A comparison shows that the memory requirements to normalize the same dataset using another popular software tool, minfi, were much larger (<xref rid="bty476-T1" ref-type="table">Table 1</xref>). Most other popular packages (<xref rid="bty476-B5" ref-type="bibr">Assenov <italic>et al.</italic>, 2014</xref>; <xref rid="bty476-B29" ref-type="bibr">Morris <italic>et al.</italic>, 2014</xref>) that provide FN capability are simply wrappers for the minfi implementation. Two recently developed tools, bigMelon (<xref rid="bty476-B15" ref-type="bibr">Gorrie-Stone, 2018</xref>) and DiMmeR (<xref rid="bty476-B2" ref-type="bibr">Almeida <italic>et al.</italic>, 2017</xref>) were also specifically designed to normalize large datasets. Although neither implements FN, we provide their performance characteristics for comparison.
<table-wrap id="bty476-T1" orientation="portrait" position="float"><label>Table 1.</label><caption><p>Comparison between software packages on a server with 16 available processors</p></caption><table frame="hsides" rules="groups"><colgroup span="1"><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/><col valign="top" align="left" span="1"/></colgroup><thead><tr><th rowspan="1" colspan="1"/><th rowspan="1" colspan="1">meffil</th><th rowspan="1" colspan="1">minfi</th><th rowspan="1" colspan="1">meffil</th><th rowspan="1" colspan="1">bigMelon<xref ref-type="table-fn" rid="tblfn1"><sup>a</sup></xref></th><th rowspan="1" colspan="1">bigMelon<xref ref-type="table-fn" rid="tblfn2"><sup>b</sup></xref></th><th rowspan="1" colspan="1">diMmeR</th></tr></thead><tbody><tr><td rowspan="1" colspan="1">Number of samples</td><td rowspan="1" colspan="1">1000</td><td rowspan="1" colspan="1">1000</td><td rowspan="1" colspan="1">5469</td><td rowspan="1" colspan="1">5469</td><td rowspan="1" colspan="1">5469</td><td rowspan="1" colspan="1">5469</td></tr><tr><td rowspan="1" colspan="1">Normalization method</td><td rowspan="1" colspan="1">FN</td><td rowspan="1" colspan="1">FN</td><td rowspan="1" colspan="1">FN</td><td rowspan="1" colspan="1">Dasen</td><td rowspan="1" colspan="1">Dasen</td><td rowspan="1" colspan="1">QN</td></tr><tr><td rowspan="1" colspan="1">Platform</td><td rowspan="1" colspan="1">R</td><td rowspan="1" colspan="1">R</td><td rowspan="1" colspan="1">R</td><td rowspan="1" colspan="1">R</td><td rowspan="1" colspan="1">R</td><td rowspan="1" colspan="1">Java</td></tr><tr><td rowspan="1" colspan="1">Size of summary (Gb)<xref ref-type="table-fn" rid="tblfn3"><sup>c</sup></xref></td><td rowspan="1" colspan="1">0.2</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">0.8</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1"/></tr><tr><td rowspan="1" colspan="1">Memory (Gb)</td><td rowspan="1" colspan="1">3/5<xref ref-type="table-fn" rid="tblfn4"><sup>d</sup></xref></td><td rowspan="1" colspan="1">15</td><td rowspan="1" colspan="1">3/67<xref ref-type="table-fn" rid="tblfn4"><sup>d</sup></xref></td><td rowspan="1" colspan="1">57</td><td rowspan="1" colspan="1">12</td><td rowspan="1" colspan="1">4.4</td></tr><tr><td rowspan="1" colspan="1">Time (min)</td><td rowspan="1" colspan="1">16</td><td rowspan="1" colspan="1">54</td><td rowspan="1" colspan="1">180</td><td rowspan="1" colspan="1">350</td><td rowspan="1" colspan="1">450</td><td rowspan="1" colspan="1">82</td></tr><tr><td rowspan="1" colspan="1">Size of output (Gb)<xref ref-type="table-fn" rid="tblfn5"><sup>e</sup></xref></td><td rowspan="1" colspan="1">3.5</td><td rowspan="1" colspan="1">2.8</td><td rowspan="1" colspan="1">17</td><td rowspan="1" colspan="1">90</td><td rowspan="1" colspan="1">90</td><td rowspan="1" colspan="1"/></tr></tbody></table><table-wrap-foot><fn id="tblfn1"><label>a</label><p>bigMelon applied with chunksize set to 500.</p></fn><fn id="tblfn2"><label>b</label><p>bigMelon applied with chunksize set to 100.</p></fn><fn id="tblfn3"><label>c</label><p>Only meffil generates a summary object.</p></fn><fn id="tblfn4"><label>d</label><p>If the output from meffil is a matrix in R, then memory use peaks at 67 Gb. If the output is saved to ‘gdsfmt’(<xref rid="bty476-B43" ref-type="bibr">Zheng <italic>et al.</italic>, 2012</xref>, <xref rid="bty476-B42" ref-type="bibr">2017</xref>) file like bigMelon, then the memory use peaks at 3 Gb. We note that the running time will be the same for both options.</p></fn><fn id="tblfn5"><label>e</label><p>DimMeR does not save output until after a permutation-based EWAS is run. We terminated analysis after normalization so output size was not determined.</p></fn></table-wrap-foot></table-wrap></p>
      </sec>
      <sec>
        <title><italic>3.1.2</italic> Scalable pipeline and reporting mechanisms</title>
        <p>Normalization and analysis of datasets, particularly large datasets, is rarely automatic and requires interactive problem-solving. Ideally, then, analysis tools should reflect this, allowing for some level of automation while also allowing high-level tasks to be broken down into more specific tasks with customizable solutions. Graphical user interface packages, which are most convenient for users, are often not available on computational servers or high-performance computing cluster. Graphical interfaces like shinyMethyl (<xref rid="bty476-B11" ref-type="bibr">Fortin <italic>et al.</italic>, 2014a</xref>) and MethylAid (<xref rid="bty476-B41" ref-type="bibr">van Iterson <italic>et al.</italic>, 2014</xref>) handle this problem by extracting data summaries that can be loaded and manipulated on a desktop computer. In <italic>meffil</italic>, we address this challenge by providing functions that nearly completely automate the entire process but can be replaced with calls to sets of functions that allow more detailed interaction with data processing. After each main processing step (quality control, normalization and EWAS), HTML reports are generated that summarize the results of each (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S1–S3</xref>), allowing the user to evaluate the success of each step before proceeding to the next and to share with collaborators. We also provide extensively tested quality control protocols on the meffil wiki website (<ext-link ext-link-type="uri" xlink:href="https://github.com/perishky/meffil/wiki">https://github.com/perishky/meffil/wiki</ext-link>). We note that EWAS in <italic>meffil</italic> actually fits four different regression models: no covariates and user-supplied covariates with or without surrogate variables obtained by applying SVA or ISVA.</p>
      </sec>
      <sec>
        <title><italic>3.1.3</italic> Analysis of mixed 450k and EPIC datasets</title>
        <p>Given the large number of datasets that have 450k DNA methylation profiles and the apparent popularity of the new EPIC microarray, it will likely be necessary to merge 450k and EPIC datasets for analysis. This is made possible in <italic>meffil</italic> by applying identical methods to probes common to both microarrays. We have yet to assess the performance of this approach due to the lack of an available mixed dataset. <xref rid="bty476-B12" ref-type="bibr">Fortin <italic>et al.</italic>, 2017</xref> have made a first attempt using the <italic>minfi</italic> package but their assessment dataset includes only three EPIC microarrays supplied by the manufacturer.</p>
      </sec>
    </sec>
    <sec>
      <title>3.2 Extending FN to reduce technical variation</title>
      <p>To assess the performance of new features in <italic>meffil</italic> we processed raw data from ARIES (<xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>). Although the utmost care was taken in the generation of the high-quality methylation profiles in ARIES, practical constraints lead to inconsistencies in the way samples were collected and processed. For example, DNA was extracted from a variety different sample types: whole blood, white cells, peripheral blood lymphocytes and blood spots, each with slight differences in the resulting methylation measurements. We exploit this heterogeneity to evaluate the performance of FN. An EWAS of pre-natal tobacco exposure was then applied to the cord blood samples comprising white cells and bloodspots (<italic>n</italic> = 777). To ensure that our observations weren’t specific to ARIES given the differences between sample starting material (e.g. blood spots versus white blood cells), we repeated the analysis in the GOYA study (<xref rid="bty476-B30" ref-type="bibr">Paternoster <italic>et al.</italic>, 2011</xref>; <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>). Performance was assessed by comparing resulting association statistics in the two datasets to 5801 associations of a large EWAS meta-analysis of pre-natal smoking (<xref rid="bty476-B20" ref-type="bibr">Joubert <italic>et al.</italic>, 2016</xref>). As there are multiple options for selecting covariates to include in the EWAS regression model, we considered three options: no covariates, cellular composition estimates from cord or adult blood panels plus other covariates and surrogate variables obtained using ISVA (<xref rid="bty476-B23" ref-type="bibr">Leek and Storey, 2007</xref>; <xref rid="bty476-B38" ref-type="bibr">Teschendorff <italic>et al.</italic>, 2011</xref>). Consistent with previous findings, ISVA surrogate appear to sufficiently account for most confounding factors including heterogeneity of cellular composition (<xref rid="bty476-B27" ref-type="bibr">McGregor <italic>et al.</italic>, 2016</xref>) resulting in highly sensitive and specific EWAS findings (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S4</xref>).</p>
      <sec>
        <title><italic>3.2.1</italic> Extending FN to include fixed and random effects</title>
        <p>We and others (<xref rid="bty476-B1" ref-type="bibr">Akulenko <italic>et al.</italic>, 2016</xref>) have found that FN often fails to completely remove slide and plate effects (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>). Slide effects occur because groups of samples are measured using the same glass slide or bead chip (12 samples per slide for 450 K microarrays and 8 per slide for EPIC microarrays). Plate effects occur because groups of samples are bisulfite converted on the same 96-well plate. We therefore revised our implementation of FN to allow additional fixed and random effects to be included with the control probe summaries.</p>
        <p>Normalization reports for ARIES showed a large drop in batch-associated variation after including batch (slide) as a random effect in FN. It was not possible to model batch as a fixed effect because induced group sizes were too small. When we performed an EWAS of pre-natal tobacco exposure in the resulting normalized version of ARIES, we observed increased specificity and sensitivity to detect previously meta-analyzed associations (<xref rid="bty476-B20" ref-type="bibr">Joubert <italic>et al.</italic>, 2016</xref>; <xref ref-type="fig" rid="bty476-F2">Fig. 2</xref>). Area under the curve (AUC) increased in ARIES (0.63 to 0.65, <italic>P</italic> &lt; 2.2 x 10<sup>−16</sup>, DeLong’s test) and in GOYA (when including plate as a random effect; 0.58 to 0.59, <italic>P</italic> = 1.8 x 10<sup>−7</sup>). For comparison, we also applied a random effects EWAS to FN normalized data. Including slide as a random effect in an EWAS of ARIES was not an improvement over our extension of FN (AUC decreased from 0.65 to 0.64, <italic>P</italic> = 1.8 x 10<sup>−6</sup>), however including plate as a random effect in an EWAS of GOYA was an improvement (AUC increased from 0.59 to 0.61, <italic>P</italic> &lt; 2.2 x 10<sup>−16</sup>). All receiver operating characteristic (ROC) curves are shown in <xref ref-type="fig" rid="bty476-F2">Figure 2</xref>. Users could use a similar approach using the normalization report and well-established EWAS findings to make normalization decisions.
</p>
        <fig id="bty476-F2" orientation="portrait" position="float">
          <label>Fig. 2.</label>
          <caption>
            <p>Effect of adjusting ‘slide’ or ‘plate’ as a random effect. True positive rates (TPRs) are consistently higher in a downstream EWAS when variation due to ‘slide’ effects in ARIES (<bold>a</bold>) and ‘plate’ effects in GOYA (<bold>b</bold>) are removed using random effects models. Random effects models were applied either probe quantiles along with control variation in FN (‘FN+re’) or during the EWAS (‘FN+ewas.re’). TPRs were estimated by comparison to associations from a large meta-analysis (<xref rid="bty476-B20" ref-type="bibr">Joubert <italic>et al.</italic>, 2016</xref>)</p>
          </caption>
          <graphic xlink:href="bty476f2"/>
        </fig>
      </sec>
      <sec>
        <title><italic>3.2.2</italic> Automated parameter selection</title>
        <p>FN has one main parameter that can be set by the user: the number of principal components (maximum = 42) derived from control features to be used to normalize the probe quantiles (<xref rid="bty476-B11" ref-type="bibr">Fortin <italic>et al.</italic>, 2014b</xref>). The default number advised by <xref rid="bty476-B11" ref-type="bibr">Fortin <italic>et al.</italic>, 2014b</xref> is two, derived as the number maximizing discovery of differentially methylated signals in a few examples. In meffil, we implemented an approach that estimates the number of principal components as the number that best explains variation in the probe intensity quantiles. This test is performed under cross validation in order to avoid overfitting (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>).</p>
        <p>To evaluate the performance of the automatic parameter selection, we generated nine normalizations of ARIES and GOYA cord blood samples, each normalized with a different number of control summary principal components and evaluated the sensitivity and specificity of identifying associations with pre-natal tobacco exposure. ROC curves show that parameter choice can have a large influence (<xref ref-type="fig" rid="bty476-F3">Fig. 3a and b</xref>), with the recommended choice of 10 returning the best performance.
</p>
        <fig id="bty476-F3" orientation="portrait" position="float">
          <label>Fig. 3.</label>
          <caption>
            <p>Parameter selection for FN. The main parameter for FN is the number of principal components of control variation with which to normalize probe quantiles. Screeplots (a, b, d, e) show the metric used to <italic>meffil</italic> for choosing the optimal number of principal components in ARIES (a, b, c) and GOYA (d, e, f), the amount of probe quantile variation unexplained by the principal components under 10-fold cross validation. The explained variation is mainly due to technical variance as the control probes should not be correlated with biological signal (<xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). Screeplots (a, d) show the variation without regressing out random effects whereas plots (b) and (e) show the variation after regressing out slide (b) or plate (e) as random effect. Plots (c) and (f) compares true and false positive rates in a downstream EWAS of pre-natal smoking in ARIES (c) and GOYA (f) after normalizing with different numbers of principal components and regressing out slide or plate as a random effect. TPRs were estimated by comparison to associations from a large meta-analysis (<xref rid="bty476-B20" ref-type="bibr">Joubert <italic>et al.</italic>, 2016</xref>)</p>
          </caption>
          <graphic xlink:href="bty476f3"/>
        </fig>
      </sec>
      <sec>
        <title><italic>3.2.3</italic> Reducing heterogeneity in Meta-analyses with minimal data sharing</title>
        <p>Due to the way that FN is re-implemented in <italic>meffil</italic>, it is possible to normalize datasets residing on distinct servers together while sharing only the control probe summaries and probe intensity quantiles between the two servers (<xref ref-type="fig" rid="bty476-F4">Fig. 4a</xref>). We evaluated the effect of this approach on heterogeneity in a meta-analysis of age in seven publicly available DNA methylation datasets (<italic>n</italic> = 2967, <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>, <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>). In a first meta-analysis, each dataset was normalized separately and, in a second meta-analysis (the ‘mega’ EWAS), the datasets were normalized together (<xref ref-type="fig" rid="bty476-F4">Fig. 4a</xref>). Heterogeneity was compared between meta-analyses by paired <italic>t</italic>-test of <italic>tau<sup>2</sup></italic> (<xref rid="bty476-B35" ref-type="bibr">Rucker <italic>et al.</italic>, 2008</xref>) to only those CpG sites associated with age in an EWAS of all datasets merged together (Bonferroni adjusted <italic>P</italic> &lt; 0.05 and at least 0.1% change in methylation per year). In each EWAS surrogate variables generated either by ISVA or SVA were used as covariates. The ISVA mega EWAS identified 2487 CpG sites associated with age (Bonferroni adjusted <italic>P</italic> &lt; 0.05 and absolute value of the regression coefficient greater than 0.1% per year) whereas the SVA mega EWAS identified 7697 sharing 1773 associations. The regression coefficients of the pooled set of 8411 associations were highly correlated between them (<italic>R</italic> = 0.91).
</p>
        <fig id="bty476-F4" orientation="portrait" position="float">
          <label>Fig. 4.</label>
          <caption>
            <p>Meta-analysis with normalized data. Data can be normalized using <italic>meffil</italic> as illustrated in (a) by generating QC objects for each dataset, sending them to a normalization server for normalization and then sending them back to each dataset to complete normalization of each sample. (b) The heterogeneity <italic>tau</italic><sup>2</sup> statistic is shown for CpG sites in the meta-analyses of age performed with and without normalizing the seven datasets together prior to meta-analysis. The top plot shows heterogeneity when ISVA is used to generate surrogate covariates and the bottom plot when SVA is used instead. CpG sites shown in the plot are those identified as associated with age in the EWAS of the combined dataset, 2486 associations for ISVA and 7697 for SVA. The dark diagonal line shows <italic>y</italic> = <italic>x</italic> and the grey line the regression line</p>
          </caption>
          <graphic xlink:href="bty476f4"/>
        </fig>
        <p>Using ISVA, heterogeneity was actually lower when datasets were normalized separately prior to meta-analysis (mean <italic>tau<sup>2</sup></italic> difference = 1.2 x 10<sup>−7</sup>, <italic>P</italic> &lt; 7.7 x 10<sup>−54</sup>; <xref ref-type="fig" rid="bty476-F4">Fig. 4b</xref>). Conversely, when SVA was used, heterogeneity was much lower when datasets were normalized together (mean <italic>tau</italic><sup>2</sup> difference = 2.4 x 10<sup>−8</sup>; <italic>P</italic> &lt; 1.4 x 10<sup>−194</sup>; <xref ref-type="fig" rid="bty476-F4">Fig. 4b</xref>).</p>
        <p>Agreement between meta-analyzed and mega EWAS was also highly covariate-dependent and followed expectations that reduced heterogeneity led to greater agreement. Agreement was quantified by treating the mega EWAS associations as the true set of associations and calculating the false discovery rate (FDR) and TPR of the corresponding meta-analysis. For ISVA-based EWAS, FDR was 35% and TPR was 63% when datasets were normalized separately. When datasets were normalized together, FDR was slightly higher (36%) and TPR lower (49%). For SVA, FDR was much lower at 6% and TPR much higher at 78% when datasets were normalized separately. When datasets were normalized together, FDR was slightly lower (4%) and TPR slightly higher (81%). From these results, we conclude that normalization prior to meta-analysis may improve results but this is not guaranteed.</p>
      </sec>
    </sec>
    <sec>
      <title>3.3 Perfect confounding between batch effects and biological phenotypes is not resolved by functional normalization</title>
      <p>A common problem in epidemiological datasets is perfect confounding with batch, particularly for opportunistic case-control studies in which data is generated for cases subsequent to data collected from a control population. We evaluated the efficacy of FN to remove only technical variation based on control variation while leaving biological variation intact. To test this, we compared methylation differences between methylation profiles obtained from cord blood against peripheral blood collected in adolescence under two scenarios, one in which there was perfect confounding with batch (e.g. GOYA cord against ARIES adolescence) and another in which batch was randomized (e.g. ARIES cord versus ARIES adolescence). In the unconfounded analysis, only 14 DNA methylation differences were identified (Bonferroni adjusted <italic>P</italic> &lt; 0.05) after adjusting for heterogeneity in cellular composition. In contrast, in the confounded analysis, there were 38 950 methylation differences and this included only seven of the 14 differences from the unconfounded analysis. Of the 38 950, 62% had effect sizes in the same direction as in the unconfounded analysis. This suggests that the vast majority of the 38 950 were false positives.</p>
      <p>We then asked if adjusting for controls directly in the EWAS regression model would reduce the number of apparent false positives while retaining some of the true positives. Under this model we obtained 199 differentially methylated CpG sites, of which 50 overlapped with the 38 950 from the confounded analysis and none with the unconfounded analysis. Of the 199 123 (62%) agreed on the direction of association. Once again, these results suggest that most or all of the 199 were false positives. This was not due to the control probes failing to fully account for batch variation as a few of the ‘hybridization’ controls perfectly differentiated between batches. The false positives were then possibly due to model instability due to high correlation between controls and the variable of interest.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Illumina Infinium DNA methylation microarrays have been used in a number of large-scale epigenetic epidemiological studies due to their low cost and large coverage of the genome. Despite the extensive use of these arrays, memory efficient and comprehensive software are currently lacking. We have designed <italic>meffil</italic> to perform pre-processing, quality control, data harmonization, normalization and EWAS easily, flexibly and memory-efficiently. We have demonstrated that <italic>meffil</italic> can remove unwanted variation both using FN and by including covariates in EWAS models. Automatic generation of comprehensive reports at each step allows users to assess the success of each and potentially repeat steps after tweaking parameters to improve performance. The possibility of normalizing remote datasets together without sharing sensitive information may help to reduce heterogeneity in meta-analysis.</p>
    <p>To evaluate different settings in <italic>meffil</italic>, we used the ARIES and GOYA datasets and compared associations with pre-natal tobacco exposure under various normalization schemes against those published for a large meta-analysis (<xref rid="bty476-B20" ref-type="bibr">Joubert <italic>et al.</italic>, 2016</xref>) as an example. A limitation of this approach is that the meta-analyzed set of associations might be contaminated with false positives due to batch and confounding effects that replicate across meta-analyzed datasets. Although the meta-analysis appears to be well-powered and therefore able to identify associations with small effect sizes, there are undoubtedly false negatives due to the variety of different data generation, quality control and normalization procedures applied to meta-analyzed datasets. Furthermore, all studies relied on self-reported smoking during pregnancy.</p>
    <p>We used pre-natal smoking where multiple loci with small effect sizes contribute to the phenotypic variance rather than large case control effects (such as cancer). As batch effects will have the largest impact on such small effects, correcting for these effects in the most optimal way will improve power. In addition, integration and harmonization across different studies will lead to increased power in EWAS. However, simulations with different sizes of batch, confounder and case control effects are required to find out which method and settings work best but are not the scope of this paper. Especially, as for most traits the genomic architecture is unknown, different assumptions should be made for different traits.</p>
    <p>We and others (<xref rid="bty476-B1" ref-type="bibr">Akulenko <italic>et al.</italic>, 2016</xref>) have noted that FN may fail to completely remove certain technical effects, either because that variation is missing from microarray controls or because probe quantiles rather than probe intensities are directly adjusted. To address the former possibility, we allow the user to include additional technical variables as fixed or random effects. As shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>, the addition of a random ‘slide’ effect does indeed reduce variation associated with ‘slide’. For this reason, it might be better in some cases to employ a different normalization method. Crucially, we demonstrate that though FN attempts to separate technical from biological variation, when batch and phenotype are perfectly confounded results can be extremely unreliable. We recommend that cases and controls be assayed jointly within a single experiment in a random order.</p>
    <p>Reducing heterogeneity in meta-analysis is likely to increase power to observe associations. Although we hypothesized that normalizing between datasets prior to meta-analysis could reduce heterogeneity, our analyses show that this cannot always be assumed and may depend on the regression models used for EWAS, at least for FN. Further work is needed to better understand the conditions necessary for reducing heterogeneity by normalization.</p>
    <p>We plan in future to provide alternative background subtraction and normalization approaches, re-implemented in order to preserve the current low memory requirements of <italic>meffil</italic> and ability to normalize datasets present on distinct servers. We note however that for some methods, the re-implementation will not produce identical results because they depend on the entire dataset being loaded into memory [e.g. (<xref rid="bty476-B24" ref-type="bibr">Lehne <italic>et al.</italic>, 2015</xref>)]. For specific parts of the normalization pipeline, we plan to offer means for users apply their own custom R code. Future directions also include the possibility of integrating <italic>meffil</italic> within systems like DataShield (<xref rid="bty476-B13" ref-type="bibr">Gaye <italic>et al.</italic>, 2014</xref>) that will allow not only combined normalization but also EWAS of datasets present on distinct servers. This will improve both the power of and the speed at which meta-analyses of multiple cohort studies can be completed.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Methods</label>
      <media xlink:href="bty476_supplemental_methods.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors are extremely grateful to all the families who took part in the ALSPAC study, the midwives for their help in recruiting them and the whole ALSPAC team, which includes interviewers, computer and laboratory technicians, clerical workers, research scientists, volunteers, managers, receptionists and nurses.</p>
    <p>The authors want to thank the many pregnant women who have taken part in the GOYA study. Without them, there would be no cohort.</p>
    <sec>
      <title>Funding</title>
      <p>ARIES was supported by the UK Medical Research Council; Wellcome (<ext-link ext-link-type="uri" xlink:href="http://www.wellcome.ac.uk">www.wellcome.ac.uk</ext-link>; [grant number 102215/2/13/2 to ALSPAC]); the University of Bristol to ALSPAC; the UK Economic and Social Research Council (<ext-link ext-link-type="uri" xlink:href="http://www.esrc.ac.uk">www.esrc.ac.uk</ext-link>; [ES/N000498/1] to CR) and the UK Medical Research Council (<ext-link ext-link-type="uri" xlink:href="http://www.mrc.ac.uk">www.mrc.ac.uk</ext-link>; grant numbers [MC_UU_12013/1, MC_UU_12013/2 to JLM, GH, GDS, CR and MS]).</p>
      <p>GOYA was supported by a significant grant from the Danish National Research Foundation; the Danish Regional Committees; the Pharmacy Foundation; the Egmont Foundation; the March of Dimes Birth Defects Foundation; the Health Foundation and other minor grants. The DNBC Biobank has been supported by the Novo Nordisk Foundation and the Lundbeck Foundation. Generation of DNA methylation data was supported by the Medical Research Council Integrative Epidemiology Unit which is supported by The UK Medical Research Council and the Health Foundation (grant number [MC_UU_12013/1-9]) and the University of Bristol.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="bty476-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Akulenko</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>BEclear: batch effect detection and adjustment in DNA methylation data</article-title>. <source>PLoS One</source>, <volume>11</volume>, <fpage>e0159921.</fpage><pub-id pub-id-type="pmid">27559732</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Almeida</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Efficient detection of differentially methylated regions using DiMmeR</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>549</fpage>–<lpage>551</lpage>.<pub-id pub-id-type="pmid">27794558</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Andersson</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>An atlas of active enhancers across human cell types and tissues</article-title>. <source>Nat. Methods</source>, <volume>507</volume>, <fpage>455</fpage>–<lpage>461</lpage>.</mixed-citation>
    </ref>
    <ref id="bty476-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Aryee</surname><given-names>M.J.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Minfi: a flexible and comprehensive Bioconductor package for the analysis of Infinium DNA methylation microarrays</article-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>1363</fpage>–<lpage>1369</lpage>.<pub-id pub-id-type="pmid">24478339</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Assenov</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Comprehensive analysis of DNA methylation data with RnBeads</article-title>. <volume>11</volume>, <fpage>1138</fpage>–<lpage>1140</lpage>.</mixed-citation>
    </ref>
    <ref id="bty476-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bakulski</surname><given-names>K.M.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>DNA methylation of cord blood cell types: applications for mixed cell birth studies</article-title>. <source>Epigenetics</source>, <volume>11</volume>, <fpage>354</fpage>–<lpage>362</lpage>.<pub-id pub-id-type="pmid">27019159</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bates</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Fitting linear mixed-effects models using lme4</article-title>. <source>J. Stat. Software</source>, <volume>1</volume>, <fpage>2015</fpage>.</mixed-citation>
    </ref>
    <ref id="bty476-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bolstad</surname><given-names>B.M.</given-names></name></person-group><etal>et al</etal> (<year>2003</year>) 
<article-title>A comparison of normalization methods for high density oligonucleotide array data based on variance and bias</article-title>. <source>Bioinformatics (Oxford, England)</source>, <volume>19</volume>, <fpage>185</fpage>–<lpage>193</lpage>.</mixed-citation>
    </ref>
    <ref id="bty476-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>de Goede</surname><given-names>O.M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Nucleated red blood cells impact DNA methylation and expression analyses of cord blood hematopoietic cells</article-title>. <source>Clin. Epigenet</source>., <volume>7</volume>, <fpage>95</fpage>.</mixed-citation>
    </ref>
    <ref id="bty476-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fortin</surname><given-names>J.P.</given-names></name></person-group><etal>et al</etal> (<year>2014a</year>) 
<article-title>shinyMethyl: interactive quality control of Illumina 450k DNA methylation arrays in R</article-title>. <source>F1000Research</source>, <volume>3</volume>, <fpage>175.</fpage><pub-id pub-id-type="pmid">25285208</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fortin</surname><given-names>J.P.</given-names></name></person-group><etal>et al</etal> (<year>2014b</year>) 
<article-title>Functional normalization of 450k methylation array data improves replication in large cancer studies</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>12</fpage>–<lpage>503</lpage>.</mixed-citation>
    </ref>
    <ref id="bty476-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Fortin</surname><given-names>J.P.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Preprocessing, normalization and integration of the Illumina HumanMethylationEPIC array with minfi</article-title>. <source>Bioinformatics (Oxford, England)</source>, <volume>33</volume>, <fpage>558</fpage>–<lpage>560</lpage>.</mixed-citation>
    </ref>
    <ref id="bty476-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gaye</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>DataSHIELD: taking the analysis to the data, not the data to the analysis</article-title>. <source>Int. J. Epidemiol</source>., <volume>43</volume>, <fpage>1929</fpage>–<lpage>1944</lpage>.<pub-id pub-id-type="pmid">25261970</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gervin</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Cell type specific DNA methylation in cord blood: a 450K-reference data set and cell count-based validation of estimated cell type composition</article-title>. <source>Epigenetics</source>, <volume>11</volume>, <fpage>690</fpage>–<lpage>698</lpage>.<pub-id pub-id-type="pmid">27494297</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gorrie-Stone</surname><given-names>T.J.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>bigmelon: illumina methylation array analysis for large experiments</article-title>. <source>R Package Version 1.6.0</source>.</mixed-citation>
    </ref>
    <ref id="bty476-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Heiss</surname><given-names>J.A.</given-names></name>, <name name-style="western"><surname>Brenner</surname><given-names>H.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Between-array normalization for 450K data</article-title>. <source>Front.Genet</source>., <volume>6</volume>, <fpage>92.</fpage><pub-id pub-id-type="pmid">25806048</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hicks</surname><given-names>S.C.</given-names></name>, <name name-style="western"><surname>Irizarry</surname><given-names>R.A.</given-names></name></person-group> (<year>2015</year>) 
<article-title>quantro: a data-driven approach to guide the choice of an appropriate normalization method</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>117.</fpage><pub-id pub-id-type="pmid">26040460</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hong</surname><given-names>E.L.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Principles of metadata organization at the ENCODE data coordination center. <italic>Database</italic></article-title><source>J. Biol. Databases Curation</source>, <volume>2016</volume>, <fpage>baw001.</fpage></mixed-citation>
    </ref>
    <ref id="bty476-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Houseman</surname><given-names>E.A.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>DNA methylation arrays as surrogate measures of cell mixture distribution</article-title>. <source>BMC Bioinformatics</source>, <volume>13</volume>, <fpage>86</fpage>.<pub-id pub-id-type="pmid">22568884</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Joubert</surname><given-names>B.R.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>DNA methylation in newborns and maternal smoking in pregnancy: genome-wide consortium meta-analysis</article-title>. <source>Am. J. Hum. Genet</source>., <volume>98</volume>, <fpage>680</fpage>–<lpage>696</lpage>.<pub-id pub-id-type="pmid">27040690</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leek</surname><given-names>J.T.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>The sva package for removing batch effects and other unwanted variation in high-throughput experiments</article-title>. <source>Bioinformatics (Oxford, England)</source>, <volume>28</volume>, <fpage>882</fpage>–<lpage>883</lpage>.</mixed-citation>
    </ref>
    <ref id="bty476-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leek</surname><given-names>J.T.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Tackling the widespread and critical impact of batch effects in high-throughput data</article-title>. <source>Nat. Rev. Genet</source>., <volume>11</volume>, <fpage>733</fpage>–<lpage>739</lpage>.<pub-id pub-id-type="pmid">20838408</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leek</surname><given-names>J.T.</given-names></name>, <name name-style="western"><surname>Storey</surname><given-names>J.D.</given-names></name></person-group> (<year>2007</year>) 
<article-title>Capturing heterogeneity in gene expression studies by surrogate variable analysis</article-title>. <source>PLoS Genet</source>., <volume>3</volume>, <fpage>e161</fpage>–<lpage>1735</lpage>.</mixed-citation>
    </ref>
    <ref id="bty476-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lehne</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>A coherent approach for analysis of the Illumina HumanMethylation450 BeadChip improves data quality and performance in epigenome-wide association studies</article-title>. <source>Genome Biol</source>., <volume>16</volume>, <fpage>37</fpage>.<pub-id pub-id-type="pmid">25853392</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Liu</surname><given-names>J.</given-names></name>, <name name-style="western"><surname>Siegmund</surname><given-names>K.D.</given-names></name></person-group> (<year>2016</year>) 
<article-title>An evaluation of processing methods for HumanMethylation450 BeadChip data</article-title>. <source>BMC Genomics</source>, <volume>17</volume>, <fpage>469.</fpage><pub-id pub-id-type="pmid">27334613</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Maksimovic</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Removing unwanted variation in a differential methylation analysis of Illumina HumanMethylation450 array data</article-title>. <source>Nucleic Acids Res</source>., <volume>43</volume>, <fpage>e106</fpage>.<pub-id pub-id-type="pmid">25990733</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McGregor</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>An evaluation of methods correcting for cell-type heterogeneity in DNA methylation studies</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>84</fpage>.<pub-id pub-id-type="pmid">27142380</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Michels</surname><given-names>K.B.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Recommendations for the design and analysis of epigenome-wide association studies</article-title>. <source>Nat. Methods</source>, <volume>10</volume>, <fpage>949</fpage>–<lpage>955</lpage>.<pub-id pub-id-type="pmid">24076989</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Morris</surname><given-names>T.J.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>ChAMP: 450k chip analysis methylation pipeline</article-title>. <source>Nature</source>, <volume>30</volume>, <fpage>428</fpage>–<lpage>430</lpage>.</mixed-citation>
    </ref>
    <ref id="bty476-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Paternoster</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Genome-wide population-based association study of extremely overweight young adults–the GOYA study</article-title>. <source>PLoS One</source>, <volume>6</volume>, <fpage>e24303</fpage>.<pub-id pub-id-type="pmid">21935397</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B31">
      <mixed-citation publication-type="other"><collab>R Core Team</collab>. (<year>2014</year>) R: A language and environment for statistical computing. In <italic>R Foundation for Statistical Computing</italic>, Vienna, Austria, <ext-link ext-link-type="uri" xlink:href="http://www.R-project.org/">http://www.R-project.org/</ext-link>.</mixed-citation>
    </ref>
    <ref id="bty476-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Reinius</surname><given-names>L.E.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Differential DNA methylation in purified human blood cells: implications for cell lineage and studies on disease susceptibility</article-title>. <source>PLoS One</source>, <volume>7</volume>, <fpage>e41361</fpage>.<pub-id pub-id-type="pmid">22848472</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Relton</surname><given-names>C.L.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Data resource profile: accessible resource for integrated epigenomic studies (ARIES)</article-title>. <source>Int. J. Epidemiol</source>., <volume>44</volume>, <fpage>1181</fpage>–<lpage>1190</lpage>.<pub-id pub-id-type="pmid">25991711</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ritchie</surname><given-names>M.E.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>. <source>Nucleic Acids Res</source>., <volume>43</volume>, <fpage>e47</fpage>.<pub-id pub-id-type="pmid">25605792</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rucker</surname><given-names>G.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Undue reliance on I(2) in assessing heterogeneity may mislead</article-title>. <source>BMC Med. Res. Methodol</source>., <volume>8</volume>, <fpage>79</fpage>.<pub-id pub-id-type="pmid">19036172</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smith</surname><given-names>M.L.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>illuminaio: an open source IDAT parsing tool for Illumina microarrays</article-title>. <source>F1000Research</source>, <volume>2</volume>, <fpage>264</fpage>.<pub-id pub-id-type="pmid">24701342</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Teschendorff</surname><given-names>A.E.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>A beta-mixture quantile normalization method for correcting probe design bias in Illumina Infinium 450 k DNA methylation data</article-title>. <source>Bioinformatics (Oxford, England)</source>, <volume>29</volume>, <fpage>189</fpage>–<lpage>196</lpage>.</mixed-citation>
    </ref>
    <ref id="bty476-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Teschendorff</surname><given-names>A.E.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Independent surrogate variable analysis to deconvolve confounding factors in large-scale microarray profiling studies</article-title>. <source>Bioinformatics (Oxford, England)</source>, <volume>27</volume>, <fpage>1496</fpage>–<lpage>1505</lpage>.</mixed-citation>
    </ref>
    <ref id="bty476-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Touleimat</surname><given-names>N.</given-names></name>, <name name-style="western"><surname>Tost</surname><given-names>J.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Complete pipeline for infinium((R)) human methylation 450K BeadChip data processing using subset quantile normalization for accurate DNA methylation estimation</article-title>. <source>Epigenomics</source>, <volume>4</volume>, <fpage>325</fpage>–<lpage>341</lpage>.<pub-id pub-id-type="pmid">22690668</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Triche</surname><given-names>T.J.</given-names><suffix>Jr</suffix></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Low-level processing of Illumina Infinium DNA Methylation BeadArrays</article-title>. <source>Nucleic Acids Res</source>., <volume>41</volume>, <fpage>e90</fpage>.<pub-id pub-id-type="pmid">23476028</pub-id></mixed-citation>
    </ref>
    <ref id="bty476-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>van Iterson</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>MethylAid: visual and interactive quality control of large Illumina 450k datasets</article-title>. <source>Bioinformatics (Oxford, England)</source>, <volume>30</volume>, <fpage>3435</fpage>–<lpage>3437</lpage>.</mixed-citation>
    </ref>
    <ref id="bty476-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zheng</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>SeqArray-a storage-efficient high-performance data format for WGS variant calls</article-title>. <source>Bioinformatics (Oxford, England)</source>, <volume>33</volume>, <fpage>2251</fpage>–<lpage>2257</lpage>.</mixed-citation>
    </ref>
    <ref id="bty476-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zheng</surname><given-names>X.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>A high-performance computing toolset for relatedness and principal component analysis of SNP data</article-title>. <source>Bioinformatics (Oxford, England)</source>, <volume>28</volume>, <fpage>3326</fpage>–<lpage>3328</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
