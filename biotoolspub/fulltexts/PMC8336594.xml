<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8336594</article-id>
    <article-id pub-id-type="pmid">34252941</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btab298</article-id>
    <article-id pub-id-type="publisher-id">btab298</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Regulatory and Functional Genomics</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>stPlus: a reference-based method for the accurate enhancement of spatial transcriptomics</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Shengquan</surname>
          <given-names>Chen</given-names>
        </name>
        <aff><institution>Ministry of Education Key Laboratory of Bioinformatics, Research Department of Bioinformatics at the Beijing National Research Center for Information Science and Technology, Center for Synthetic and Systems Biology, Department of Automation, Tsinghua University</institution>, Beijing 100084, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Boheng</surname>
          <given-names>Zhang</given-names>
        </name>
        <aff><institution>Ministry of Education Key Laboratory of Bioinformatics, Research Department of Bioinformatics at the Beijing National Research Center for Information Science and Technology, Center for Synthetic and Systems Biology, Department of Automation, Tsinghua University</institution>, Beijing 100084, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xiaoyang</surname>
          <given-names>Chen</given-names>
        </name>
        <aff><institution>Ministry of Education Key Laboratory of Bioinformatics, Research Department of Bioinformatics at the Beijing National Research Center for Information Science and Technology, Center for Synthetic and Systems Biology, Department of Automation, Tsinghua University</institution>, Beijing 100084, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xuegong</surname>
          <given-names>Zhang</given-names>
        </name>
        <aff><institution>Ministry of Education Key Laboratory of Bioinformatics, Research Department of Bioinformatics at the Beijing National Research Center for Information Science and Technology, Center for Synthetic and Systems Biology, Department of Automation, Tsinghua University</institution>, Beijing 100084, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Rui</surname>
          <given-names>Jiang</given-names>
        </name>
        <xref rid="btab298-cor1" ref-type="corresp"/>
        <!--ruijiang@tsinghua.edu.cn-->
        <aff><institution>Ministry of Education Key Laboratory of Bioinformatics, Research Department of Bioinformatics at the Beijing National Research Center for Information Science and Technology, Center for Synthetic and Systems Biology, Department of Automation, Tsinghua University</institution>, Beijing 100084, <country country="CN">China</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btab298-cor1">To whom correspondence should be addressed. <email>ruijiang@tsinghua.edu.cn</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-07-12">
      <day>12</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>7</month>
      <year>2021</year>
    </pub-date>
    <volume>37</volume>
    <issue>Suppl 1</issue>
    <issue-title>ISMB/ECCB 2021 Proceedings</issue-title>
    <fpage>i299</fpage>
    <lpage>i307</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btab298.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single-cell RNA sequencing (scRNA-seq) techniques have revolutionized the investigation of transcriptomic landscape in individual cells. Recent advancements in spatial transcriptomic technologies further enable gene expression profiling and spatial organization mapping of cells simultaneously. Among the technologies, imaging-based methods can offer higher spatial resolutions, while they are limited by either the small number of genes imaged or the low gene detection sensitivity. Although several methods have been proposed for enhancing spatially resolved transcriptomics, inadequate accuracy of gene expression prediction and insufficient ability of cell-population identification still impede the applications of these methods.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We propose stPlus, a reference-based method that leverages information in scRNA-seq data to enhance spatial transcriptomics. Based on an auto-encoder with a carefully tailored loss function, stPlus performs joint embedding and predicts spatial gene expression via a weighted <italic toggle="yes">k</italic>-nearest-neighbor. stPlus outperforms baseline methods with higher gene-wise and cell-wise Spearman correlation coefficients. We also introduce a clustering-based approach to assess the enhancement performance systematically. Using the data enhanced by stPlus, cell populations can be better identified than using the measured data. The predicted expression of genes unique to scRNA-seq data can also well characterize spatial cell heterogeneity. Besides, stPlus is robust and scalable to datasets of diverse gene detection sensitivity levels, sample sizes and number of spatially measured genes. We anticipate stPlus will facilitate the analysis of spatial transcriptomics.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>stPlus with detailed documents is freely accessible at <ext-link xlink:href="http://health.tsinghua.edu.cn/software/stPlus/" ext-link-type="uri">http://health.tsinghua.edu.cn/software/stPlus/</ext-link> and the source code is openly available on <ext-link xlink:href="https://github.com/xy-chen16/stPlus" ext-link-type="uri">https://github.com/xy-chen16/stPlus</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Key Research and Development Program of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100012166</institution-id>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
        <award-id>2018YFC0910404</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Natural Science Foundation of China</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001809</institution-id>
          </institution-wrap>
          <!-- oupReleaseDelayRemoved from OA Article (00|0) -->
        </funding-source>
        <award-id>61873141</award-id>
        <award-id>61721003</award-id>
        <award-id>61573207</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="9"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Recent advances in single-cell RNA sequencing (scRNA-seq) techniques have stimulated efforts to unravel the heterogeneity of cell types, revolutionized the understanding of various complex tissues and boosted the development of modern cellular and molecular biology. However, scRNA-seq requires a dissociation step to obtain cell suspension, leading to a loss of spatial context. The maintenance of spatial context is crucial for understanding cellular characteristics and reconstructing tissue architecture in normal physiology or under perturbation.</p>
    <p>To elucidate single-cell heterogeneity and define cell types while also retaining spatial information, a number of remarkable methodologies have been recently developed to profile spatially resolved transcriptomics. These methodologies can be grouped into two main categories: (i) sequencing-based technologies that provide unbiased capture of the transcriptomic landscape via capturing and quantifying the mRNA population of molecules <italic toggle="yes">in situ</italic>, such as ST (<xref rid="btab298-B23" ref-type="bibr">Stahl <italic toggle="yes">et al.</italic>, 2016</xref>), HDST (<xref rid="btab298-B29" ref-type="bibr">Vickovic <italic toggle="yes">et al</italic>., 2019</xref>) and Slide-seq (<xref rid="btab298-B20" ref-type="bibr">Rodriques <italic toggle="yes">et al.</italic>, 2019</xref>) and (ii) imaging-based technologies that offer higher spatial resolutions by fluorescence <italic toggle="yes">in situ</italic> hybridization (FISH) or <italic toggle="yes">in situ</italic> sequencing, such as osmFISH (<xref rid="btab298-B9" ref-type="bibr">Codeluppi <italic toggle="yes">et al.</italic>, 2018</xref>), seqFISH+ (<xref rid="btab298-B11" ref-type="bibr">Eng <italic toggle="yes">et al.</italic>, 2019</xref>), MERFISH (<xref rid="btab298-B19" ref-type="bibr">Moffitt <italic toggle="yes">et al.</italic>, 2018</xref>) and STARmap (<xref rid="btab298-B30" ref-type="bibr">Wang <italic toggle="yes">et al</italic>., 2018</xref>). These approaches are often complementary and differ in their target throughput, coverage and spatial resolution. For example, sequencing-based methods offer relatively high throughput but have been limited by spatial resolution, while imaging-based methods can provide subcellular resolution but have been limited in terms of sequence coverage and overall throughput (<xref rid="btab298-B14" ref-type="bibr">Larsson <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btab298-B37" ref-type="bibr">Zhuang, 2021</xref>). In this study, we focus on the imaging-based methods with the understanding that increasing spatial resolution can help define transcriptomic gradients within tissues more accurately, and allow detection of the subcellular localization of transcripts (<xref rid="btab298-B5" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2021a</xref>).</p>
    <p>In imaging-based methodologies, early methods based on FISH, such as osmFISH, can provide excellent signal quality in tissue imaging with even higher gene detection sensitivity than scRNA-seq (<xref rid="btab298-B9" ref-type="bibr">Codeluppi <italic toggle="yes">et al.</italic>, 2018</xref>). Nevertheless, the molecular crowding problem presents a challenge to scaling up the number of genes imaged. Although recent advanced technologies can help mitigate the molecular crowding problem and image more than 10 000 genes in individual cells (<xref rid="btab298-B11" ref-type="bibr">Eng <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab298-B33" ref-type="bibr">Xia <italic toggle="yes">et al</italic>., 2019</xref>), increasing the number of genes imaged will, in general, lead to increment of the overall measurement time and/or reduction of the measurement accuracy for multiplexed FISH and <italic toggle="yes">in situ</italic> sequencing (<xref rid="btab298-B37" ref-type="bibr">Zhuang, 2021</xref>). Therefore, a more general challenge for imaging-based profiling of spatially resolved transcriptomics is to balance the number of genes imaged and the gene detection sensitivity. As suggested by <xref rid="btab298-B30" ref-type="bibr">Wang <italic toggle="yes">et al.</italic> (2018)</xref>, a conceptually simple approach based on the idea of divide-and-conquer is to divide the targeted genes into multiple groups and image them sequentially one group at a time. Moreover, computational approaches can help fill this gap by incorporating scRNA-seq data as reference and predicting genome-wide expression of cells profiled with a targeted gene set (<xref rid="btab298-B37" ref-type="bibr">Zhuang, 2021</xref>), given that recent efforts of cell atlas consortiums have generated massive amounts of scRNA-seq data.</p>
    <p>Computational methods for enhancing spatially resolved transcriptomics are anticipated to accurately predict expression of unmeasured genes on the data with small number of genes imaged, and effectively impute expression of imaged genes to better identify cell populations on the data with low gene detection sensitivity. Existing computational methods can be divided into two major categories: (i) probabilistic methods, such as gimVI (<xref rid="btab298-B17" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic>, 2019</xref>), that generatively model spatial transcriptomic data while integrating reference scRNA-seq data by domain adaptation and (ii) joint embedding-based methods, such as Seurat (<xref rid="btab298-B24" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2019</xref>) and Liger (<xref rid="btab298-B31" ref-type="bibr">Welch <italic toggle="yes">et al</italic>., 2019</xref>), that perform joint dimensionality reduction for spatial data and reference data, and then impute the unmeasured genes in spatial transcriptomic data based on the linkage between cells in these two datasets. Most recently, SpaGE performs linearly joint embedding using genes shared between spatial and scRNA-seq datasets, and then predicts spatial gene expression by a <italic toggle="yes">k</italic>-nearest-neighbor (<italic toggle="yes">k</italic>-NN) approach (<xref rid="btab298-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic>, 2020</xref>). For the joint embedding-based methods, the first step plays the most important role in the enhancement of spatial transcriptomic data (<xref rid="btab298-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic>, 2020</xref>), while the second step is usually based on a general idea that integrates the information of neighboring cells in reference scRNA-seq data (<xref rid="btab298-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab298-B31" ref-type="bibr">Welch <italic toggle="yes">et al.</italic>, 2019</xref>). Abdelaal et al. also provided an evaluation of the existing methods for the first time, and demonstrated that SpaGE achieves overall state-of-the-art performance. However, the use of only a certain fraction of the features (i.e. genes present in both datasets) cannot take full advantage of the reference scRNA-seq data, and thus limits the performance of joint embedding and final enhancement. Besides, although evaluation based on Spearman correlation coefficients can assess the prediction accuracy to some extent, it may not be the optimal evaluation metric because the Spearman correlation coefficients are relatively low in most instances even the visual inspection shows good enhancement for genes with known spatial pattern (<xref rid="btab298-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab298-B17" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic>, 2019</xref>). In addition, Spearman correlation coefficients cannot reflect performance for the identification of cell populations using enhanced spatial transcriptomic data.</p>
    <p>Motivated by the above understanding, we propose stPlus, a reference-based method for the accurate enhancement of spatial transcriptomics. stPlus is built upon an auto-encoder with a carefully tailored loss function for leveraging the holistic information in reference scRNA-seq data instead of only genes shared with spatial transcriptomic data. With the learned cell embeddings, stPlus predicts gene expression in spatial transcriptomics via a weighted <italic toggle="yes">k</italic>-NN approach. We also introduce a clustering-based approach to assess the cell heterogeneity maintained in the predicted spatial profiles by metrics suitable for different scenarios. We conduct a comprehensive evaluation by gene-wise and cell-wise Spearman correlation coefficients and four metrics for cell clustering. Benchmarked against state-of-the-art methods across a variety of spatial and scRNA-seq dataset pairs, stPlus provides superior enhancement performance and can scale to large datasets. We also demonstrate that the predicted spatial gene expression can offer comparable or even better performance to identify cell populations than the measured spatially resolved transcriptomics. We anticipate stPlus will help mitigate the technical limitations and better characterize the transcriptomic pattern of complex tissues.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 The model of stPlus</title>
      <p>stPlus aims at enhancing spatial transcriptomics by accurately predicting expression of unmeasured genes and effectively imputing expression of measured genes. The input of stPlus is the target spatial data and the reference scRNA-seq data profiled from matching or similar tissue as the spatial data. These two data can be represented by two gene-by-cell matrixes, respectively. Note that the cells between these two data are not matched, and the genes in reference data usually include most of the genes in spatial data. Users can specify any genes from the reference data to be predicted. The output of stPlus is a gene-by-cell matrix containing the predicted expression of each specified gene for each cell in the spatial data.</p>
      <p>The enhancement process of stPlus can be divided into three main steps: (i) data processing to prepare for joint embedding; (ii) joint embedding of the single cells in spatial transcriptomic data and reference scRNA-seq data; and (iii) predicting the expression of spatially unmeasured genes based on the cell embedding and reference scRNA-seq data (<xref rid="btab298-F1" ref-type="fig">Fig. 1</xref>).</p>
      <fig position="float" id="btab298-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>A graphical illustration of the stPlus model. stPlus first augments spatial transcriptomic data and combines it with reference scRNA-seq data. The data are then jointly embedded using an auto-encoder. Finally, stPlus predicts the expression of spatially unmeasured genes based on weighted <italic toggle="yes">k</italic>-NN</p>
        </caption>
        <graphic xlink:href="btab298f1" position="float"/>
      </fig>
      <p>In the data processing step, to avoid introducing highly noisy genes, stPlus selects the top 2000 highly variable genes from genes only present in scRNA-seq data, as suggested by the widely used toolkits for scRNA-seq analysis (<xref rid="btab298-B24" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btab298-B32" ref-type="bibr">Wolf <italic toggle="yes">et al</italic>., 2018</xref>). The set of selected genes is denoted as <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi mathvariant="normal">U</mml:mi></mml:math></inline-formula>, while the set of genes shared between spatial transcriptomic data and reference scRNA-seq data is denoted as <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi mathvariant="normal">S</mml:mi></mml:math></inline-formula>. For the spatial transcriptomic data, stPlus augments expression measurements of genes <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi mathvariant="normal">U</mml:mi></mml:math></inline-formula> with zeros, and unifies the gene order with that of the processed scRNA-seq data. Then, the spatial transcriptomic and scRNA-seq datasets are merged together, shuffled across cells and fed into the next step.</p>
      <p>The joint embedding step aims to fit each spatial transcriptomic cell to the most similar scRNA-seq cells, but not to perform single-cell data integration and batch-effect correction (<xref rid="btab298-B28" ref-type="bibr">Tran <italic toggle="yes">et al</italic>., 2020</xref>), or dimensionality reduction for downstream analyses such as data visualization and cell clustering (<xref rid="btab298-B25" ref-type="bibr">Sun <italic toggle="yes">et al</italic>., 2019</xref>). The joint embedding step plays the most crucial role in the enhancement of spatial transcriptomic data (<xref rid="btab298-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic>, 2020</xref>), while the state-of-the-art method performs linearly embedding without incorporating the information of genes unique to scRNA-seq data, which constitutes major hindrances to the enhancement performance. In this step, stPlus uses an auto-encoder with a carefully tailored loss function to incorporate the biological variation of scRNA-seq-unique genes.</p>
      <p>More specifically, the auto-encoder projects the gene expression data with a dimension of <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi mathvariant="normal">S</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal">U</mml:mi></mml:math></inline-formula> into a 1000-dimension latent space with a fully connected layer. The latent embedding is then decoded to the original space with another fully connected layer. Both the layers use the rectified linear (ReLU) activation function, which outputs zero for negative values, to achieve non-linear transformation and overcome the vanishing gradient problem. As the essence of stPlus, the loss function consists of two parts: (i) loss of the reconstruction for shared genes <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mi mathvariant="normal">S</mml:mi></mml:math></inline-formula> in the spatial transcriptomic data and (ii) data sparsity-penalized loss of the prediction for genes <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi mathvariant="normal">U</mml:mi></mml:math></inline-formula> in the reference scRNA-seq data.</p>
      <p>To access the two parts of loss function, stPlus feedforwards each training batch twice, respectively. First, stPlus feeds the batch into the auto-encoder, and extracts the decoded results corresponding to genes <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mi mathvariant="normal">S</mml:mi></mml:math></inline-formula> for the spatial transcriptomic cells (denoted as <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>). With the original expression data of genes <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mi mathvariant="normal">S</mml:mi></mml:math></inline-formula> in the spatial transcriptomic cells (denoted as <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), the first part of loss function is calculated as follows:
<disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> denotes squared error (squared L2 norm) between each element in the two inputs. Second, to mimic the augmented spatial transcriptomic data, stPlus extracts scRNA-seq cells in the batch, and masks the entries of genes <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mi mathvariant="normal">U</mml:mi></mml:math></inline-formula> by setting the expression of genes <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mi mathvariant="normal">U</mml:mi></mml:math></inline-formula> (denoted as <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">U</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) to zero. The masked scRNA-seq data is then fed into the auto-encoder, and the decoder output corresponding to genes <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mi mathvariant="normal">U</mml:mi></mml:math></inline-formula> (denoted as <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">U</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>) is regarded as the prediction result for genes <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mi mathvariant="normal">U</mml:mi></mml:math></inline-formula> in scRNA-seq cells. The element-wise squared error can thus be obtained by <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">U</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">U</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula>. Given that scRNA-seq data usually contains technical artifacts (e.g. dropouts) and does not reflect the actual expression level, stPlus further penalizes <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">U</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">U</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:math></inline-formula> by down-weighting the errors of zero elements in <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">U</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> with the percentage of non-zero elements in reference scRNA-seq data (denoted as <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mi>Q</mml:mi></mml:math></inline-formula>), i.e. one minus data sparsity. This strategy is based on the idea that the sparser the scRNA-seq data is, the more likely the zero elements are false negatives, and the prediction error should be penalized with lower weights. The second part of loss function is then computed as the following formula:
<disp-formula id="E2"><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mi>S</mml:mi><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">U</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">U</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo><mml:mo>⊙</mml:mo><mml:mi mathvariant="bold">Γ</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mo>⊙</mml:mo></mml:math></inline-formula> denotes element-wise multiplication, <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mi mathvariant="bold">Γ</mml:mi></mml:math></inline-formula> denotes a matrix with the same dimension as <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">U</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, in which an entry is set to <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mi>Q</mml:mi></mml:math></inline-formula> if the corresponding entry in <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">E</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">U</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is zero, and is set to 1 otherwise. The two parts of loss function are then scaled by the number of gene sets <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mi mathvariant="normal">S</mml:mi></mml:math></inline-formula> (denoted as <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) versus that of <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi mathvariant="normal">U</mml:mi></mml:math></inline-formula> (denoted as <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">U</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>), and the number of spatial transcriptomic cells (denoted as <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) versus that of scRNA-seq cells (denoted as <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>). The final loss is the sum of these two scaled losses:
<disp-formula id="E3"><mml:math id="M3" display="block" overflow="scroll"><mml:mi mathvariant="normal">loss</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mo>α</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">S</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">U</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi>M</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>After feedforwarding each training batch twice, stPlus performs backward propagation with the final loss. stPlus optimizes parameters in the auto-encoder until convergence, and finally obtains cell embeddings of spatial transcriptomic data and reference scRNA-seq data. We also introduce two variations of stPlus, i.e. stPlus without the first part of loss (stPlus w/o P1) and stPlus without the second part of loss (stPlus w/o P2), to demonstrate how the two parts of loss affect the enhancement results.</p>
      <p>In the predicting step, stPlus predicts the expression of spatially unmeasured genes using a strategy similar to SpaGE. For each spatial transcriptomic cell <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, stPlus calculates its cosine distance with each scRNA-seq cell <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> based on the learned cell embeddings. The neighboring 50 scRNA-seq cells are then used to predict the expression of unmeasured genes in cell <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> via a weighted <italic toggle="yes">k</italic>-NN approach. Specifically, stPlus filters out the neighbors with negative cosine similarity, and calculates the weight between <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <italic toggle="yes">k</italic>th neighbor in the remaining <italic toggle="yes">K</italic> neighbors by:
<disp-formula id="E4"><mml:math id="M4" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">distance</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mi mathvariant="normal">distance</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">R</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>K</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>Finally, stPlus predicts expression of spatially unmeasured genes in cell <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">T</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> by the weighted expression of these genes in the <italic toggle="yes">K</italic> neighbors from reference scRNA-seq data:
<disp-formula id="E5"><mml:math id="M5" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="bold">X</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denotes expression data of genes to predict in the <italic toggle="yes">k</italic>th neighbor.</p>
      <p>Leveraging the ensemble learning strategy, stPlus automatically adopts five epochs with minimal loss when training the auto-encoder, and averages the prediction results to achieve better and stable performance.</p>
    </sec>
    <sec>
      <title>2.2 Data collection and preprocessing</title>
      <p>We collected the five benchmarking dataset pairs adopted in SpaGE (<xref rid="btab298-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic>, 2020</xref>) to evaluate the enhancement performance of different computational methods. As shown in <xref rid="btab298-T1" ref-type="table">Table 1</xref>, the dataset pairs have diverse gene detection sensitivity levels, sample sizes and number of spatially measured genes. Specifically, the five dataset pairs are made up of three spatial transcriptomic datasets (osmFISH, MERFISH and STARmap) from different mouse brain regions, and four reference scRNA-seq datasets (Zeisel, AllenVISp, AllenSSp and Moffit). The osmFISH dataset was retrieved from <ext-link xlink:href="http://linnarssonlab.org/osmFISH/" ext-link-type="uri">http://linnarssonlab.org/osmFISH/</ext-link> (<xref rid="btab298-B9" ref-type="bibr">Codeluppi <italic toggle="yes">et al.</italic>, 2018</xref>). The MERFISH dataset was downloaded from <ext-link xlink:href="10.5061/dryad.8t8s248" ext-link-type="doi">https://doi.org/10.5061/dryad.8t8s248</ext-link> (<xref rid="btab298-B19" ref-type="bibr">Moffitt <italic toggle="yes">et al.</italic>, 2018</xref>). The STARmap dataset is available at <ext-link xlink:href="https://www.starmapresources.com/data" ext-link-type="uri">https://www.starmapresources.com/data</ext-link> (<xref rid="btab298-B30" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2018</xref>). Note that the labels of cell populations in the osmFISH and MERFISH datasets are accessible, while that of the STARmap dataset cannot be successfully aligned with cells. For the reference scRNA-seq data, the Zeisel dataset, which is provided by the same lab as that of the osmFISH dataset, was downloaded from <ext-link xlink:href="http://linnarssonlab.org/cortex/" ext-link-type="uri">http://linnarssonlab.org/cortex/</ext-link> (<xref rid="btab298-B34" ref-type="bibr">Zeisel <italic toggle="yes">et al</italic>., 2015</xref>). The AllenVISp (<xref rid="btab298-B27" ref-type="bibr">Tasic <italic toggle="yes">et al</italic>., 2018</xref>) and AllenSSp (<xref rid="btab298-B4" ref-type="bibr">Chatterjee <italic toggle="yes">et al.</italic>, 2018</xref>) datasets collected from <ext-link xlink:href="https://portal.brain-map.org/atlases-and-data/rnaseq" ext-link-type="uri">https://portal.brain-map.org/atlases-and-data/rnaseq</ext-link> were more deeply sequenced than the Zeisel dataset. The AllenVISp was measured from a different brain region than the osmFISH dataset, while the AllenSSp dataset was measured from the somatosensory cortex, similar to the osmFISH dataset. The Moffit dataset, which was published in the same study of MERFISH, was retrieved from NCBI Gene Expression Omnibus with the accession number GSE113576 (<xref rid="btab298-B19" ref-type="bibr">Moffitt <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
      <table-wrap position="float" id="btab298-T1">
        <label>Table 1.</label>
        <caption>
          <p>Summary of the five benchmarking dataset pairs</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="center" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1">Spatial/scRNA-seq dataset pair</th>
              <th colspan="4" rowspan="1">Spatial transcriptomic data<hr/></th>
              <th colspan="4" rowspan="1">Reference scRNA-seq data<hr/></th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">Number of cells</th>
              <th rowspan="1" colspan="1">Number of genes</th>
              <th rowspan="1" colspan="1">Data sparsity (%)</th>
              <th rowspan="1" colspan="1">Tissue</th>
              <th rowspan="1" colspan="1">Number of cells</th>
              <th rowspan="1" colspan="1">Number of genes</th>
              <th rowspan="1" colspan="1">Data sparsity (%)</th>
              <th rowspan="1" colspan="1">Tissue</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">osmFISH_Zeisel</td>
              <td rowspan="1" colspan="1">3405</td>
              <td rowspan="1" colspan="1">33</td>
              <td rowspan="1" colspan="1">29.7</td>
              <td rowspan="1" colspan="1">SMSc</td>
              <td rowspan="1" colspan="1">1691</td>
              <td rowspan="1" colspan="1">15 075</td>
              <td rowspan="1" colspan="1">78.9</td>
              <td rowspan="1" colspan="1">SMSc</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">osmFISH_AllenVISp</td>
              <td rowspan="1" colspan="1">3405</td>
              <td rowspan="1" colspan="1">33</td>
              <td rowspan="1" colspan="1">29.7</td>
              <td rowspan="1" colspan="1">SMSc</td>
              <td rowspan="1" colspan="1">14 249</td>
              <td rowspan="1" colspan="1">34 617</td>
              <td rowspan="1" colspan="1">74.7</td>
              <td rowspan="1" colspan="1">VISc</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">osmFISH_AllenSSp</td>
              <td rowspan="1" colspan="1">3405</td>
              <td rowspan="1" colspan="1">33</td>
              <td rowspan="1" colspan="1">29.7</td>
              <td rowspan="1" colspan="1">SMSc</td>
              <td rowspan="1" colspan="1">5577</td>
              <td rowspan="1" colspan="1">30 527</td>
              <td rowspan="1" colspan="1">69.8</td>
              <td rowspan="1" colspan="1">SMSc</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">MERFISH_Moffit</td>
              <td rowspan="1" colspan="1">64 373</td>
              <td rowspan="1" colspan="1">155</td>
              <td rowspan="1" colspan="1">60.6</td>
              <td rowspan="1" colspan="1">POR</td>
              <td rowspan="1" colspan="1">31 299</td>
              <td rowspan="1" colspan="1">18 646</td>
              <td rowspan="1" colspan="1">85.6</td>
              <td rowspan="1" colspan="1">POR</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">STARmap_AllenVISp</td>
              <td rowspan="1" colspan="1">1549</td>
              <td rowspan="1" colspan="1">1020</td>
              <td rowspan="1" colspan="1">79.0</td>
              <td rowspan="1" colspan="1">VISc</td>
              <td rowspan="1" colspan="1">14 249</td>
              <td rowspan="1" colspan="1">34 617</td>
              <td rowspan="1" colspan="1">74.7</td>
              <td rowspan="1" colspan="1">VISc</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic toggle="yes">Note</italic>: POR: pre-optic region; SMSc: somatosensory cortex; VISc: visual cortex.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>For the implementation of stPlus, we followed the data preprocessing procedure of SpaGE except for the final <italic toggle="yes">z</italic>-score step (<xref rid="btab298-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic>, 2020</xref>). To be more specific, we filtered out the blank genes and the <italic toggle="yes">Fos</italic> gene (non-numerical values), and filtered out the cells labeled as ‘Ambiguous’ in the MERFISH dataset. We only kept the cells from cortical regions in the osmFISH dataset. Each spatial transcriptomic dataset was then normalized via dividing the counts within each cell by the total number of transcripts within that cell, scaled by the median number of transcripts per cell and log-transformed with a pseudo-count. For the reference scRNA-seq datasets, we filtered out genes expressed in &lt;10 cells. We also filtered out low-quality cells in the AllenVISp dataset according to the metadata (‘Low Quality’ and ‘No Class’ cells), and filtered out the hippocampus cells in the Zeisel dataset according to the metadata. The filtered scRNA-seq datasets were next independently normalized by dividing the counts within each cell by the total number of transcripts within that cell, scaled by 10e6, and log-transformed with a pseudo-count.</p>
    </sec>
    <sec>
      <title>2.3 Evaluation approaches</title>
      <p>Considering that the technical challenge for imaging-based profiling of spatially resolved transcriptomics is to balance the number of genes imaged and the gene detection sensitivity, computational methods for data enhancement are anticipated to (i) accurately predict expression of unmeasured genes, especially for the data with small number of genes imaged and (ii) effectively impute expression of imaged genes to better identify cell populations, especially for the data with low gene detection sensitivity. We hence conduct a comprehensive evaluation of enhancement performance from two perspectives.</p>
      <p>First, we evaluated the prediction performance of gene expression by gene-wise and cell-wise Spearman correlation coefficients between the measured and predicted spatial profiles. The Spearman correlation coefficient over cells for each gene (gene-wise) can directly reflect the correlation between predicted and measured spatial profiles since the prediction object is a gene. The gene-wise coefficient was adopted as the primary evaluation metric in the two state-of-the-art methods specifically designed to enhance the spatial transcriptomic data (<xref rid="btab298-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btab298-B17" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic>, 2019</xref>). Given that cell heterogeneity is essential to single-cell studies, we additionally assessed cellular characteristics maintained in the predicted spatial profiles by Spearman correlation coefficients over genes for each cell (cell-wise) based on the idea that higher correlation per cell can better maintain cellular characteristics. We obtained the predicted spatial transcriptomics of all genes iteratively in cross-validation experiments, and then calculated Spearman correlation coefficients at cell-wise.</p>
      <p>Second, we evaluated performance for the identification of cell populations by four clustering metrics. It is intuitive that, based on the ground-truth cell labels and the enhanced spatial transcriptomic data, a higher score of cell clustering metric indicates better performance for the identification of cell populations, and thus a better enhancement of spatial transcriptomics. Therefore, we assess clustering results based on the computationally predicted spatial transcriptomics, using clustering results based on the spatially profiled data as the baseline. Specifically, we used the standard pipeline with default parameters in Scanpy (<xref rid="btab298-B32" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic>, 2018</xref>), a widely used Python library for the analysis of single-cell data, to perform dimension reduction and cell clustering. We adopted a recently suggested clustering strategy for benchmark studies (<xref rid="btab298-B6" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2019</xref>). The strategy is based on Louvain clustering, a community detection-based clustering method (<xref rid="btab298-B3" ref-type="bibr">Blondel <italic toggle="yes">et al.</italic>, 2008</xref>; <xref rid="btab298-B15" ref-type="bibr">Levine <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btab298-B32" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic>, 2018</xref>), and uses a binary search to tune the resolution parameter in Louvain clustering to make the number of clusters and the number of ground-truth cell labels as close as possible.</p>
    </sec>
    <sec>
      <title>2.4 Metrics for assessment of clustering results</title>
      <p>The clustering results were evaluated based on four widely used metrics: adjusted mutual information (AMI), adjusted Rand index (ARI), homogeneity (Homo) and normalized mutual information (NMI). A comparison of ARI, NMI and AMI was presented in <xref rid="btab298-B21" ref-type="bibr">Romano <italic toggle="yes">et al.</italic> (2016)</xref>. Rand index (RI) represents the probability that the predicted clusters and the true cell labels will agree on a randomly chosen pair of cells. ARI is an adjusted version of RI, where it adjusts for the expected agreement by chance. ARI is preferred when there are large equal-sized clusters (<xref rid="btab298-B21" ref-type="bibr">Romano <italic toggle="yes">et al.</italic>, 2016</xref>). Both NMI and AMI are based on mutual information (MI), which assesses the similarity between the predicted clusters and true cell labels. NMI scales MI to be between 0 and 1, while AMI adjusts MI by considering the expected value under random clustering. AMI is theoretically preferred to NMI, even though NMI is also very widely used and usually provides roughly the same results. Compared with ARI, AMI is preferred when the sizes of clusters are unbalanced and when there are small clusters (<xref rid="btab298-B21" ref-type="bibr">Romano <italic toggle="yes">et al.</italic>, 2016</xref>). We note that the sizes of cell populations in most spatial transcriptomic data, including the datasets used in this study, are unbalanced since some rare cell populations exist. Therefore, AMI is more appropriate in most cases, while ARI should be adopted when the clusters have nearly equal sizes. The homogeneity score assesses whether the obtained clusters contain only cells of the same population, and it equals 1 if all the cells within the same cluster correspond to the same population.</p>
      <p>To be more specific, suppose <italic toggle="yes">T</italic> is the known ground-truth labels of cells, <italic toggle="yes">P</italic> is the predicted clustering assignments, <italic toggle="yes">N</italic> is the total number of single cells, <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the number of cells assigned to the <italic toggle="yes">i</italic>th unique cluster of <italic toggle="yes">P</italic>, <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the number of cells that belong to the <italic toggle="yes">j</italic>th unique label of <italic toggle="yes">T</italic> and <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the number of overlapping cells between the <italic toggle="yes">i</italic>th cluster and the <italic toggle="yes">j</italic>th unique label. Then the ARI score is computed as follows:
<disp-formula id="E6"><mml:math id="M6" display="block" overflow="scroll"><mml:mi mathvariant="normal">ARI</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>-</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:msub><mml:mrow><mml:mi>y</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow></mml:mfenced><mml:mo>/</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mfrac linethickness="0pt"><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>The NMI score is computed as the following formula:
<disp-formula id="E7"><mml:math id="M7" display="block" overflow="scroll"><mml:mi mathvariant="normal">NMI</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">MI</mml:mi><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msqrt><mml:mi>H</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mfenced><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:msqrt></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> is the entropy function, and <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mi mathvariant="normal">MI</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>,</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> is the mutual entropy.</p>
      <p>The AMI score is calculated as follows:
<disp-formula id="E8"><mml:math id="M8" display="block" overflow="scroll"><mml:mi mathvariant="normal">AMI</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">MI</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mi mathvariant="normal">MI</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfenced><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">avg</mml:mi><mml:mo>[</mml:mo><mml:mi>H</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>-</mml:mo><mml:mi>E</mml:mi><mml:mo>[</mml:mo><mml:mi mathvariant="normal">MI</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>P</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mfenced><mml:mo>]</mml:mo></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mi>E</mml:mi><mml:mo>(</mml:mo><mml:mo>·</mml:mo><mml:mo>)</mml:mo></mml:math></inline-formula> denotes the expectation function.</p>
      <p>The homogeneity score is computed as follows:
<disp-formula id="E9"><mml:math id="M9" display="block" overflow="scroll"><mml:mi mathvariant="normal">Homo</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:mi>H</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>P</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mi>H</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mi>H</mml:mi><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>|</mml:mo><mml:mi>P</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> denotes the uncertainty of true labels based on the knowledge of clustering assignments.</p>
    </sec>
    <sec>
      <title>2.5 Baseline methods</title>
      <p>We compared the performance of stPlus with four baseline methods, including SpaGE (<xref rid="btab298-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic>, 2020</xref>), Seurat (<xref rid="btab298-B24" ref-type="bibr">Stuart <italic toggle="yes">et al.</italic>, 2019</xref>), Liger (<xref rid="btab298-B31" ref-type="bibr">Welch <italic toggle="yes">et al.</italic>, 2019</xref>) and gimVI (<xref rid="btab298-B17" ref-type="bibr">Lopez <italic toggle="yes">et al.</italic>, 2019</xref>), with their default parameters or settings provided in the accompanying examples. Source code for implementing the baseline methods was obtained from the study of SpaGE, which is the first to systematically benchmark existing methods using the five dataset pairs introduced above (<xref rid="btab298-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic>, 2020</xref>). Data processing procedures, such as normalization and scaling, were also performed following the source code of each method.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 stPlus accurately predicts spatial transcriptomic data</title>
      <p>To demonstrate the advantage of stPlus for predicting spatial gene expression, we conducted a series of 5-fold cross-validation experiments using five dataset pairs of diverse gene detection sensitivity levels, sample sizes and number of spatially measured genes (<xref rid="btab298-T1" ref-type="table">Table 1</xref>). On each dataset pair, we randomly split genes shared between the two datasets into five folds, and predicted expression of the genes in each fold by the stPlus model trained with the genes in the remaining four folds. The predicted spatial transcriptomics of all genes in all cells can be obtained iteratively in the cross-validation experiments.</p>
      <p>We first compared the Spearman correlation coefficients at gene-wise of stPlus to that of other methods. The gene-wise coefficients can directly reflect the correlation between predicted and measured spatial profiles since the prediction object is a gene. For each comparison, we conducted one-sided paired Wilcoxon signed-rank tests to test if stPlus achieves significantly higher Spearman correlation coefficients than the baseline methods at gene-wise. As shown in <xref rid="btab298-F2" ref-type="fig">Figure 2</xref>, stPlus consistently and significantly outperformed Seurat and Liger across all datasets. On the osmFISH_Zeisel dataset pair, stPlus significantly outperformed SpaGE (one-sided paired Wilcoxon test <italic toggle="yes">P</italic>-value &lt; 0.01), and greatly improved the median Spearman correlation coefficient by 61.0% than gimVI although the <italic toggle="yes">P</italic>-value is not less than 0.01 (<xref rid="btab298-F2" ref-type="fig">Fig. 2a</xref>). On the osmFISH_AllenVISp dataset pair, stPlus improved the median Spearman correlation coefficient by 11.2% than SpaGE, while slightly outperformed gimVI (<xref rid="btab298-F2" ref-type="fig">Fig. 2b</xref>). On the osmFISH_AllenSSp dataset pair, stPlus again significantly outperformed SpaGE, and improved the median Spearman correlation coefficient by 7.6% than gimVI (<xref rid="btab298-F2" ref-type="fig">Fig. 2c</xref>). On the above three dataset pairs, Seurat provided overall the lowest performance with Spearman correlation coefficients close to 0, which is consistent with the observations in the study of SpaGE (<xref rid="btab298-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic>, 2020</xref>), and suggests that the performance of Seurat heavily decreases when there are very few shared genes. On the MERFISH_Moffit dataset pair, which contains over 95 000 cells, stPlus consistently achieved significantly better performance than other methods with at least 8.8% improvement of the median Spearman correlation coefficient (<xref rid="btab298-F2" ref-type="fig">Fig. 2d</xref>). On the STARmap_AllenVISp dataset pair, stPlus significantly outperformed gimVI, while SpaGE achieved comparable performance (<xref rid="btab298-F2" ref-type="fig">Fig. 2e</xref>). This is consistent with the observation in the study of SpaGE (<xref rid="btab298-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic>, 2020</xref>) that gimVI performs worse on data with low gene detection sensitivity. We note that there might exist inconsistencies between the results of 5-fold cross-validation in this study and the results of leave-one-out cross-validation in the study of SpaGE (<xref rid="btab298-B1" ref-type="bibr">Abdelaal <italic toggle="yes">et al.</italic>, 2020</xref>), which simplifies the task because the training set contains more genes highly correlated with the gene to predict.</p>
      <fig position="float" id="btab298-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Spearman correlation coefficients of different methods on various dataset pairs. The median Spearman correlation coefficient and <italic toggle="yes">P</italic>-value of one-sided paired Wilcoxon signed-rank tests are reported. (a) osmFISH_Zeisel. (b) osmFISH_AllenVISp. (c) osmFISH_AllenSSp. (d) MERFISH_Moffit. (e) STARmap_AllenVISp</p>
        </caption>
        <graphic xlink:href="btab298f2" position="float"/>
      </fig>
      <p>We then compared the Spearman correlation coefficients of different methods at cell-wise. The cell-wise coefficients can reflect cellular characteristics maintained in the predicted spatial profiles. For each comparison, we also conducted one-sided paired Wilcoxon signed-rank tests to test if stPlus achieves significantly higher Spearman correlation coefficients at cell-wise. As shown in <xref rid="btab298-F2" ref-type="fig">Figure 2</xref>, stPlus consistently achieved significantly higher coefficients than all the four baseline methods across all the five dataset pairs (one-sided paired Wilcoxon test <italic toggle="yes">P</italic>-value &lt; 0.01), and has an average improvement of 23.2% on the median Spearman correlation coefficient over the second best method. All these results suggest the superior performance of stPlus for the prediction of spatially unmeasured gene expression. Compared with stPlus w/o P1, stPlus improved the median gene-wise and cell-wise Spearman correlation coefficients by an average of 2.9% and 0.1%, respectively. However, compared with stPlus w/o P2, the average improvements are 8.9% and 7.5%, respectively, which suggests that the accurate prediction of gene expression mainly benefits from the second part of loss function.</p>
    </sec>
    <sec>
      <title>3.2 stPlus facilitates the identification of cell populations</title>
      <p>The essential step in single-cell analyses is the characterization of known or novel cell types, which is based on the accurate identification of cell populations. However, in technical limitations, either small number of genes imaged or low gene detection sensitivity constitutes major hindrances to the identification of cell populations in spatial transcriptomic data. Therefore, we used the measured spatial transcriptomic data as the baseline to verify if the computationally enhanced spatial transcriptomics can better identify cell populations. Specifically, we obtained cell labels of the osmFISH and MERFISH datasets from the original studies, while that of the STARmap dataset cannot be successfully aligned with cells. We then used the cell labels as ground truth, and evaluated the performance by four clustering metrics, including AMI, ARI, Homo and NMI. It is intuitive that, based on the enhanced data, a higher score of clustering metric indicates better performance for the identification of cell populations, and thus a better enhancement of spatial transcriptomics. Note that the sizes of different cell populations in most spatial transcriptomic data, including the datasets used in this study, are unbalanced since there exist some rare cell populations, and AMI is preferred in this case compared with ARI (<xref rid="btab298-B21" ref-type="bibr">Romano <italic toggle="yes">et al.</italic>, 2016</xref>).</p>
      <p>First, we performed cell clustering using the predicted gene expression in each fold of the 5-fold cross-validation, which means that only one-fifth of the genes are used for clustering. As shown in <xref rid="btab298-F3" ref-type="fig">Figure 3a</xref>, clustering performance using the originally profiled spatial transcriptomic data is unsatisfactory and fluctuates greatly, which is expected since few genes were used (e.g. about six genes for the osmFISH dataset). However, the clustering performance can be significantly improved using the computationally predicted gene expression. For example, SpaGE and gimVI achieved better clustering performance with smaller variance on the first three dataset pairs that are based on the osmFISH dataset. Consistent with the performance evaluated by Spearman correlation coefficients, Seurat provided the lowest clustering performance on the first three dataset pairs, while the advantages of Seurat over other methods were observed on the MERFISH dataset, which again suggests that the performance of Seurat is greatly affected by the number of genes shared between two datasets. Among these four dataset pairs, stPlus achieved the overall best clustering performance, especially on the first three dataset pairs (<xref rid="btab298-F3" ref-type="fig">Fig. 3a</xref>).</p>
      <fig position="float" id="btab298-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Clustering results of spatial transcriptomic cells evaluated by AMI, ARI, Homo and NMI. (<bold>a</bold>) Clustering results using the measured or computationally predicted expression of genes in each fold of the 5-fold cross-validation. (<bold>b</bold>) Clustering results using the measured or computationally predicted expression of all shared genes</p>
        </caption>
        <graphic xlink:href="btab298f3" position="float"/>
      </fig>
      <p>Second, we obtained the predicted spatial transcriptomics of all genes iteratively in the cross-validation experiments. The conduction of cross-validation experiments can be regarded as a strategy for data enhancement. As expected, the baseline performance (dotted lines in <xref rid="btab298-F3" ref-type="fig">Fig. 3b</xref>) was significantly improved using the data with all genes. On the first three dataset pairs, only when using the gene expression data predicted by stPlus can the clustering performance exceed the baseline. On the MERFISH_Moffit dataset pair, stPlus again outperformed the baseline and other computational methods, while Seurat also achieved better clustering performance than the baseline. These results not only suggest that stPlus is capable of predicting spatially unmeasured gene expression, but also demonstrate that the data enhanced by stPlus can provide superior performance for the identification of cell populations than that enhanced by existing methods and even the originally profiled spatial transcriptomic data. Compared with stPlus w/o P1, stPlus improved AMI, ARI, Homo and NMI by an average of 7.9%, 21.0%, 6.3% and 7.8%, respectively. However, compared with stPlus w/o P2, the average improvements are 5.6%, 3.4%, 4.0% and 5.5%, respectively, which suggests that the effective characterization of cell heterogeneity mainly benefits from the first part of loss function.</p>
    </sec>
    <sec>
      <title>3.3 stPlus is scalable to large datasets</title>
      <p>Recent efforts of cell atlas consortiums have generated massive amounts of scRNA-seq data, providing a wealth of reference data on the diversity of cell types across organisms, developmental stages and disease states (<xref rid="btab298-B10" ref-type="bibr">Davie <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab298-B13" ref-type="bibr">Han <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btab298-B22" ref-type="bibr">Rozenblatt-Rosen <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btab298-B26" ref-type="bibr">Tabula Muris <italic toggle="yes">et al</italic>., 2018</xref>; <xref rid="btab298-B35" ref-type="bibr">Zeisel <italic toggle="yes">et al</italic>., 2018</xref>; <xref rid="btab298-B36" ref-type="bibr">Zheng <italic toggle="yes">et al</italic>., 2017</xref>). Besides, high-throughput technologies now allow the simultaneous profiling of massive cells. Therefore, computational efficiency and scalability are important for a computational method to facilitate the enhancement of spatial transcriptomics. We have demonstrated the superior enhancement performance of stPlus on the MERFISH_Moffit dataset pair, which is composed of 64 373 spatial transcriptomic cells and 31 299 scRNA-seq cells. To assess the computational efficiency and scalability of different methods, we benchmarked the average running time and the peak memory usage in experiments of the 5-fold cross-validation on the MERFISH_Moffit dataset pair. The experiments were run on a machine with an Intel Xeon E5-2660 v4 X CPU, a GeForce GTX 1080 and 500GB of RAM on CentOS 7 operating system. As shown in <xref rid="btab298-T2" ref-type="table">Table 2</xref>, stPlus provided satisfactory computational efficiency and scalability in large data, while SpaGE achieved the best computational efficiency. The efficiency advantage of SpaGE mainly benefited from the joint embedding step, where it is based on principal component analysis while stPlus needs iterative training. Seurat, Liger and gimVI performed relatively worse for the computational efficiency. Note that gimVI, a probabilistic method, directly performs prediction without the embedding step. The peak memory usage of stPlus is moderate among all the methods, and is reasonable since stPlus additionally incorporated genes unique to the reference 31 299 scRNA-seq cells.</p>
      <table-wrap position="float" id="btab298-T2">
        <label>Table 2.</label>
        <caption>
          <p>Average running time and peak memory usage in experiments of the 5-fold cross-validation on the MERFISH_Moffit dataset pair</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
            <col valign="top" align="char" char="." span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="2" colspan="1">Method</th>
              <th colspan="3" rowspan="1">Time (s)<hr/></th>
              <th rowspan="1" colspan="1">Memory (GB)</th>
            </tr>
            <tr>
              <th rowspan="1" colspan="1">Embedding</th>
              <th rowspan="1" colspan="1">Prediction</th>
              <th rowspan="1" colspan="1">Total</th>
              <th rowspan="1" colspan="1">Peak usage</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">stPlus</td>
              <td rowspan="1" colspan="1">94.2</td>
              <td rowspan="1" colspan="1">186.0</td>
              <td rowspan="1" colspan="1">280.2</td>
              <td rowspan="1" colspan="1">35.6</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">SpaGE</td>
              <td rowspan="1" colspan="1">30.7</td>
              <td rowspan="1" colspan="1">163.7</td>
              <td rowspan="1" colspan="1">194.4</td>
              <td rowspan="1" colspan="1">15.5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Seurat</td>
              <td rowspan="1" colspan="1">1617.0</td>
              <td rowspan="1" colspan="1">213.6</td>
              <td rowspan="1" colspan="1">1830.6</td>
              <td rowspan="1" colspan="1">49.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">Liger</td>
              <td rowspan="1" colspan="1">217.0</td>
              <td rowspan="1" colspan="1">373.3</td>
              <td rowspan="1" colspan="1">590.3</td>
              <td rowspan="1" colspan="1">141.0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">gimVI</td>
              <td rowspan="1" colspan="1">—</td>
              <td rowspan="1" colspan="1">4367.7</td>
              <td rowspan="1" colspan="1">4367.7</td>
              <td rowspan="1" colspan="1">24.7</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p>Data visualization is fundamental to single-cell analyses by providing an intuitive understanding of cellular composition. To test if the predicted spatial transcriptomics of large data can provide satisfactory data visualization results, we used the standard pipeline with default parameters in Scanpy (<xref rid="btab298-B32" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic>, 2018</xref>) to perform dimension reduction and UMAP visualization (<xref rid="btab298-B18" ref-type="bibr">McInnes <italic toggle="yes">et al.</italic>, 2018</xref>). As shown in <xref rid="btab298-F4" ref-type="fig">Figure 4</xref>, compared to other methods, using the expression of spatial genes enhanced by stPlus, the patterns of various cell types can be better re-characterized, and some biological variations are even better distinguished than using the measured data. For example, the excitatory and inhibitory cells can be better separated using the expression data enhanced by stPlus. To assess the identification of minor cell types quantitatively, we left out the cell types that account for more than 10% (Inhibitory: 38.5%, Excitatory: 18.3% and Astrocyte: 13.0%), resulting in more balanced and minor cell types. We evaluated the clustering performance of different methods. stPlus again provided better performance than the measured data. Compared with the second best method, stPlus improved AMI, ARI, Homo and NMI by 3.8%, 13.3%, 7.4% and 3.8%, respectively. All the above observations suggest that stPlus can not only offer satisfactory computational efficiency and memory usage, but also provide the scalability to visualization of large data based on the enhanced spatial transcriptomics.</p>
      <fig position="float" id="btab298-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>UMAP visualization of cells in the MERFISH dataset using the measured or computationally predicted expression of all shared genes</p>
        </caption>
        <graphic xlink:href="btab298f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 stPlus is robust to the choice of hyperparameters</title>
      <p>The major hyperparameters of stPlus are the number of neighboring cells used to predict, and the number of epochs adopted to perform ensemble learning. In this section, we further used the MERFISH_Moffit dataset pair to demonstrate the robustness of stPlus to the choice of these two hyperparameters. We note that in the MERFISH dataset, the dominant cell types, i.e. excitatory and inhibitory cells, constitute over 56.7% of the total cells, while the rare cell types, i.e. OD Immature 2, OD Mature 3 and OD Mature 4 cells, constitute &lt;0.8%. Therefore, compared with ARI, AMI is preferred for the assessment of cell clustering on this dataset (<xref rid="btab298-B21" ref-type="bibr">Romano <italic toggle="yes">et al.</italic>, 2016</xref>). When we varied one hyperparameter, we fixed the other parameters to the default setting. We used the spatial transcriptomics of all genes iteratively predicted in the 5-fold cross-validation experiments to evaluate the robustness of stPlus. As shown in <xref rid="btab298-F5" ref-type="fig">Figure 5a</xref>, stPlus achieved stable gene-wise and cell-wise Spearman correlation coefficients with different choices of the number of neighboring cells used to predict. Besides, there are no significant fluctuations in the clustering metrics except ARI. We next varied the number of epochs adopted to perform ensemble learning. As shown in <xref rid="btab298-F5" ref-type="fig">Figure 5b</xref>, the performance assessed by gene-wise and cell-wise Spearman correlation coefficients is stable, and the clustering metrics show no significant fluctuations except ARI. The results indicate that stPlus is robust to the choice of hyperparameters.</p>
      <fig position="float" id="btab298-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>The robustness of stPlus to the choice of (<bold>a</bold>) number of neighboring cells used to predict and (<bold>b</bold>) number of epochs adopted to perform ensemble learning</p>
        </caption>
        <graphic xlink:href="btab298f5" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.5 Genes unique to reference data contain cell heterogeneity</title>
      <p>The above assessments are based entirely on the profiled spatially resolved transcriptomics. To verify if the genes inherent to reference scRNA-seq data can characterize the cellular composition, instead of 5-fold cross-validation, we further used all shared genes to train models and predicted expression of the genes unique to scRNA-seq data. Since expression of these genes was not measured in spatial transcriptomic cells, we only evaluated the clustering performance using the predicted expression of these genes, and compared it with the clustering performance using the predicted expression of genes shared between spatial and scRNA-seq datasets, i.e. the results in <xref rid="btab298-F3" ref-type="fig">Figure 3b</xref>. The measured spatial transcriptomic data was again used as the baseline (light blue markers and dotted lines in <xref rid="btab298-F6" ref-type="fig">Fig. 6</xref>). As shown in <xref rid="btab298-F6" ref-type="fig">Figure 6</xref>, most methods provided better clustering performance on the first three dataset pairs using the genes unique to scRNA-seq data than using the 33 shared genes. However, on the MERFISH_Moffit dataset pair that has more shared genes, most methods achieved better clustering performance using the 153 shared genes, while stPlus offered comparable performance using the genes unique to scRNA-seq data. In addition, stPlus outperformed other methods by all the four metrics across all the four dataset pairs, which indicates that the spatial expression of genes unique to scRNA-seq data predicted by stPlus will continue to deepen our understanding of the characterization of cell heterogeneity.</p>
      <fig position="float" id="btab298-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Clustering results of spatial transcriptomic cells using the predicted expression of genes shared between two datasets versus genes unique to scRNA-seq data</p>
        </caption>
        <graphic xlink:href="btab298f6" position="float"/>
      </fig>
      <p>We further demonstrated that the predicted expression of scRNA-seq-unique genes can provide biological insight into the identified cell population. Taking the MERFISH_Moffit dataset pair as an example, we used Wilcoxon rank-sum test in Scanpy (<xref rid="btab298-B32" ref-type="bibr">Wolf <italic toggle="yes">et al.</italic>, 2018</xref>) to find the top five differentially expressed genes (DEGs) for each cluster. We performed gene ontology enrichment analysis using the DEGs uniquely obtained by each method (<xref rid="btab298-B2" ref-type="bibr">Ashburner <italic toggle="yes">et al.</italic>, 2000</xref>; <xref rid="btab298-B12" ref-type="bibr">Gene Ontology Consortium, 2021</xref>). Using the DEGs uniquely obtained by stPlus, the significantly enriched results (generation of neurons, axon development, nervous system development, cell development, neuron differentiation and neurogenesis) are related to the biological process of neurons, which is consistent with the original spatial data. However, none of the significantly enriched biological process using the DEGs uniquely obtained by each of other methods is directly related to the original spatial data. These results indicate that stPlus opens a new avenue for the identification of marker genes and further provides biological insight into spatial transcriptomics analysis.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>In this work, we proposed stPlus for the accurate enhancement of spatial transcriptomics, and introduced a clustering-based approach for the systematical assessment of enhancement performance. stPlus simultaneously models the genes shared between spatial transcriptomic data and reference scRNA-seq data and the genes unique to scRNA-seq data. We demonstrated that stPlus outperforms baseline methods in accurately predicting expression of unmeasured genes. Besides, stPlus facilitates the identification of cell populations by enhancing spatial transcriptomics. The predicted spatial expression of scRNA-seq-unique genes also provides potential for the characterization of cell heterogeneity. In addition, stPlus is robust and scalable to dataset pairs of diverse gene detection sensitivity levels, sample sizes and number of spatially measured genes. We also provided user-friendly interfaces, detailed documents and quick-start tutorials to facilitate the application of stPlus.</p>
    <p>Certainly, our modeling framework is flexible and can be extended easily. First, gene expression data used in this study can be further combined with spatial coordinates. Second, we can incorporate other types of profiles, e.g. epigenetic profiles, as the additional reference data (<xref rid="btab298-B7" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2021b</xref>,<xref rid="btab298-B8" ref-type="bibr">c</xref>). Third, we can also extend stPlus by incorporating advanced deep neural networks to capture higher-level features of the profiled cells in spatial transcriptomic data (<xref rid="btab298-B16" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We appreciate the authors of SpaGE for the benchmarking data and code.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by the National Key Research and Development Program of China [2018YFC0910404] and the National Natural Science Foundation of China [61873141, 61721003, 61573207].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btab298-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdelaal</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>SpaGE: spatial gene enhancement using scRNA-seq</article-title>. <source>Nucleic Acids Res</source>., <volume>48</volume>, <fpage>e107</fpage>.<pub-id pub-id-type="pmid">32955565</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ashburner</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2000</year>) <article-title>Gene ontology: tool for the unification of biology. The Gene Ontology Consortium</article-title>. <source>Nat. Genet</source>., <volume>25</volume>, <fpage>25</fpage>–<lpage>29</lpage>.<pub-id pub-id-type="pmid">10802651</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blondel</surname><given-names>V.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>Fast unfolding of communities in large networks</article-title>. <source>J. Stat. Mech. Theory Exp</source>., <volume>2008</volume>, <fpage>P10008</fpage>.</mixed-citation>
    </ref>
    <ref id="btab298-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chatterjee</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Nontoxic, double-deletion-mutant rabies viral vectors for retrograde targeting of projection neurons</article-title>. <source>Nat. Neurosci</source>., <volume>21</volume>, <fpage>638</fpage>–<lpage>646</lpage>.<pub-id pub-id-type="pmid">29507411</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021a</year>) <article-title>Large field of view-spatially resolved transcriptomics at nanoscale resolution</article-title>. <source>bioRxiv</source>, <volume>2021</volume>.2001.2017.427004.</mixed-citation>
    </ref>
    <ref id="btab298-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Assessment of computational methods for the analysis of single-cell ATAC-seq data</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>241</fpage>.<pub-id pub-id-type="pmid">31739806</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021b</year>) <article-title>OpenAnnotate: a web server to annotate the chromatin accessibility of genomic regions</article-title>. <source>Nucleic Acids Res.</source>, <fpage>gkab337</fpage>.</mixed-citation>
    </ref>
    <ref id="btab298-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021c</year>) <article-title>RA3 is a reference-guided approach for epigenetic characterization of single cells</article-title>. <source>Nat. Commun.</source>, <volume>12</volume>, <fpage>2177</fpage>.<pub-id pub-id-type="pmid">33846355</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Codeluppi</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Spatial organization of the somatosensory cortex revealed by osmFISH</article-title>. <source>Nat. Methods</source>, <volume>15</volume>, <fpage>932</fpage>–<lpage>935</lpage>.<pub-id pub-id-type="pmid">30377364</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davie</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>A single-cell transcriptome atlas of the aging Drosophila brain</article-title>. <source>Cell</source>, <volume>174</volume>, <fpage>982</fpage>–<lpage>998.e920</lpage>.<pub-id pub-id-type="pmid">29909982</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eng</surname><given-names>C.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Transcriptome-scale super-resolved imaging in tissues by RNA seqFISH</article-title>. <source>Nature</source>, <volume>568</volume>, <fpage>235</fpage>–<lpage>239</lpage>.<pub-id pub-id-type="pmid">30911168</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B12">
      <mixed-citation publication-type="journal">Gene Ontology Consortium (<year>2021</year>) <article-title>The gene ontology resource: enriching a GOld mine</article-title>. <source>Nucleic Acids Res</source>., <volume>49</volume>, <fpage>D325</fpage>–<lpage>D334</lpage>.<pub-id pub-id-type="pmid">33290552</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Mapping the mouse cell atlas by Microwell-seq</article-title>. <source>Cell</source>, <volume>173</volume>, <fpage>1307</fpage>.<pub-id pub-id-type="pmid">29775597</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Larsson</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Spatially resolved transcriptomics adds a new dimension to genomics</article-title>. <source>Nat. Methods</source>, <volume>18</volume>, <fpage>15</fpage>–<lpage>18</lpage>.<pub-id pub-id-type="pmid">33408402</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levine</surname><given-names>J.H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Data-driven phenotypic dissection of AML reveals progenitor-like cells that correlate with prognosis</article-title>. <source>Cell</source>, <volume>162</volume>, <fpage>184</fpage>–<lpage>197</lpage>.<pub-id pub-id-type="pmid">26095251</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>Q.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Simultaneous deep generative modeling and clustering of single cell genomic data</article-title>. <source>bioRxiv</source>, <volume>2020</volume>.2008.2017.254730.</mixed-citation>
    </ref>
    <ref id="btab298-B17">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Lopez</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>A joint model of unpaired data from scRNA-seq and spatial transcriptomics for imputing missing gene expression measurements</article-title>. arXiv Preprint arXiv<italic toggle="yes">:</italic>1905.02269.</mixed-citation>
    </ref>
    <ref id="btab298-B18">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>McInnes</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>UMAP: uniform manifold approximation and projection for dimension reduction</article-title>. arXiv Preprint arXiv<italic toggle="yes">:</italic>1802.03426.</mixed-citation>
    </ref>
    <ref id="btab298-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moffitt</surname><given-names>J.R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Molecular, spatial, and functional single-cell profiling of the hypothalamic preoptic region</article-title>. <source>Science</source>, <volume>362</volume>, <fpage>eaau5324</fpage>.<pub-id pub-id-type="pmid">30385464</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rodriques</surname><given-names>S.G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Slide-seq: a scalable technology for measuring genome-wide expression at high spatial resolution</article-title>. <source>Science</source>, <volume>363</volume>, <fpage>1463</fpage>–<lpage>1467</lpage>.<pub-id pub-id-type="pmid">30923225</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Romano</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Adjusting for chance clustering comparison measures</article-title>. <source>J. Mach. Learn. Res</source>., <volume>17</volume>, <fpage>4635</fpage>–<lpage>4666</lpage>.</mixed-citation>
    </ref>
    <ref id="btab298-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rozenblatt-Rosen</surname><given-names>O.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>The human cell atlas: from vision to reality</article-title>. <source>Nature</source>, <volume>550</volume>, <fpage>451</fpage>–<lpage>453</lpage>.<pub-id pub-id-type="pmid">29072289</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stahl</surname><given-names>P.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</article-title>. <source>Science</source>, <volume>353</volume>, <fpage>78</fpage>–<lpage>82</lpage>.<pub-id pub-id-type="pmid">27365449</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stuart</surname><given-names>T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Comprehensive integration of single-cell data</article-title>. <source>Cell</source>, <volume>177</volume>, <fpage>1888</fpage>–<lpage>1902.e1821</lpage>.<pub-id pub-id-type="pmid">31178118</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Accuracy, robustness and scalability of dimensionality reduction methods for single-cell RNA-seq analysis</article-title>. <source>Genome Biol</source>., <volume>20</volume>, <fpage>269</fpage>.<pub-id pub-id-type="pmid">31823809</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tabula Muris</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Single-cell transcriptomics of 20 mouse organs creates a Tabula Muris</article-title>. <source>Nature</source>, <volume>562</volume>, <fpage>367</fpage>–<lpage>372</lpage>.<pub-id pub-id-type="pmid">30283141</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tasic</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Shared and distinct transcriptomic cell types across neocortical areas</article-title>. <source>Nature</source>, <volume>563</volume>, <fpage>72</fpage>–<lpage>78</lpage>.<pub-id pub-id-type="pmid">30382198</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tran</surname><given-names>H.T.N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>A benchmark of batch-effect correction methods for single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>., <volume>21</volume>, <fpage>12</fpage>.<pub-id pub-id-type="pmid">31948481</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vickovic</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>High-definition spatial transcriptomics for in situ tissue profiling</article-title>. <source>Nat. Methods</source>, <volume>16</volume>, <fpage>987</fpage>–<lpage>990</lpage>.<pub-id pub-id-type="pmid">31501547</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Three-dimensional intact-tissue sequencing of single-cell transcriptional states</article-title>. <source>Science</source>, <volume>361</volume>, <fpage>eaat5691</fpage>.<pub-id pub-id-type="pmid">29930089</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Welch</surname><given-names>J.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Single-cell multi-omic integration compares and contrasts features of brain cell identity</article-title>. <source>Cell</source>, <volume>177</volume>, <fpage>1873</fpage>–<lpage>1887.e1817</lpage>.<pub-id pub-id-type="pmid">31178122</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>F.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source>., <volume>19</volume>, <fpage>15</fpage>.<pub-id pub-id-type="pmid">29409532</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xia</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Spatial transcriptome profiling by MERFISH reveals subcellular RNA compartmentalization and cell cycle-dependent gene expression</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>116</volume>, <fpage>19490</fpage>–<lpage>19499</lpage>.<pub-id pub-id-type="pmid">31501331</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeisel</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>Brain structure. Cell types in the mouse cortex and hippocampus revealed by single-cell RNA-seq</article-title>. <source>Science</source>, <volume>347</volume>, <fpage>1138</fpage>–<lpage>1142</lpage>.<pub-id pub-id-type="pmid">25700174</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeisel</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Molecular architecture of the mouse nervous system</article-title>. <source>Cell</source>, <volume>174</volume>, <fpage>999</fpage>–<lpage>1014.e1022</lpage>.<pub-id pub-id-type="pmid">30096314</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>G.X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat. Commun</source>., <volume>8</volume>, <fpage>14049</fpage>.<pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
    <ref id="btab298-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhuang</surname><given-names>X.</given-names></string-name></person-group> (<year>2021</year>) <article-title>Spatially resolved single-cell genomics and transcriptomics by imaging</article-title>. <source>Nat. Methods</source>, <volume>18</volume>, <fpage>18</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">33408406</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
