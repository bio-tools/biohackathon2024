<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9805578</article-id>
    <article-id pub-id-type="pmid">36440957</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac761</article-id>
    <article-id pub-id-type="publisher-id">btac761</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Phylogenetics</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Distinguishing imported cases from locally acquired cases within a geographically limited genomic sample of an infectious disease</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1885-500X</contrib-id>
        <name>
          <surname>Didelot</surname>
          <given-names>Xavier</given-names>
        </name>
        <aff><institution>School of Life Sciences and Department of Statistics, University of Warwick</institution>, Coventry CV4 7AL, <country country="GB">UK</country></aff>
        <xref rid="btac761-cor1" ref-type="corresp"/>
        <!--xavier.didelot@warwick.ac.uk-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Helekal</surname>
          <given-names>David</given-names>
        </name>
        <aff><institution>Centre for Doctoral Training in Mathematics for Real-World Systems, University of Warwick</institution>, Coventry CV4 7AL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kendall</surname>
          <given-names>Michelle</given-names>
        </name>
        <aff><institution>School of Life Sciences and Department of Statistics, University of Warwick</institution>, Coventry CV4 7AL, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ribeca</surname>
          <given-names>Paolo</given-names>
        </name>
        <aff><institution>Gastrointestinal Bacteria Reference Unit, UK Health Security Agency</institution>, London NW9 5EQ, <country country="GB">UK</country></aff>
        <aff><institution>Biomathematics and Statistics Scotland, The James Hutton Institute</institution>, Edinburgh EH9 3FD, <country country="GB">UK</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac761-cor1">To whom correspondence should be addressed. Email: <email>xavier.didelot@warwick.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>1</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-11-28">
      <day>28</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>28</day>
      <month>11</month>
      <year>2022</year>
    </pub-date>
    <volume>39</volume>
    <issue>1</issue>
    <elocation-id>btac761</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="rev-recd">
        <day>17</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>18</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>24</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>10</day>
        <month>12</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac761.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>The ability to distinguish imported cases from locally acquired cases has important consequences for the selection of public health control strategies. Genomic data can be useful for this, for example, using a phylogeographic analysis in which genomic data from multiple locations are compared to determine likely migration events between locations. However, these methods typically require good samples of genomes from all locations, which is rarely available.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>Here, we propose an alternative approach that only uses genomic data from a location of interest. By comparing each new case with previous cases from the same location, we are able to detect imported cases, as they have a different genealogical distribution than that of locally acquired cases. We show that, when variations in the size of the local population are accounted for, our method has good sensitivity and excellent specificity for the detection of imports. We applied our method to data simulated under the structured coalescent model and demonstrate relatively good performance even when the local population has the same size as the external population. Finally, we applied our method to several recent genomic datasets from both bacterial and viral pathogens, and show that it can, in a matter of seconds or minutes, deliver important insights on the number of imports to a geographically limited sample of a pathogen population.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>The R package DetectImports is freely available from <ext-link xlink:href="https://github.com/xavierdidelot/DetectImports" ext-link-type="uri">https://github.com/xavierdidelot/DetectImports</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Institute for Health Research</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000272</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIHR</institution>
            <institution-id institution-id-type="DOI">10.13039/100006662</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Health Protection Research Unit in Genomics and Enabling Data</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution> UK Engineering and Physical Sciences Research Council</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>EPSRC</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000266</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>EP/S022244/1</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>EPSRC Centre for Doctoral Training in Mathematics for Real-World Systems II</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>UK’s Crop Diversity Bioinformatics HPC</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>BBSRC</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000268</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>BB/S019669/1</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Many infectious disease pathogens spread mostly within multiple geographical locations, for example, countries and are also occasionally imported from one location to another. When pathogen genetic data are available from several locations, a phylogeographic approach can be used to infer past migrations between countries (<xref rid="btac761-B5" ref-type="bibr">Bloomquist <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btac761-B43" ref-type="bibr">Lemey <italic toggle="yes">et al.</italic>, 2009</xref>). Here, however, we consider the situation where genetic data are available only from a single location, which is subject to imports from other locations about which little is known. This situation occurs frequently, for example, due to high discrepancies between the sequencing capacities of high- and low-income countries. Furthermore, even if limited sequences are available from other locations, biases in sampling between locations can often confuse phylogeographic methods (<xref rid="btac761-B11" ref-type="bibr">De Maio <italic toggle="yes">et al.</italic>, 2015</xref>).</p>
    <p>We therefore address the problem of inferring the number and phylogenetic location of imports into a population based on samples taken only from that population. This problem is important for determining which measures to take in the control of infectious diseases, since different measures are effective against importation and local transmission. It is also important to consider the presence of imports into a population before attempting to reconstruct local transmission chains with one of the recently developed methods for this purpose (<xref rid="btac761-B12" ref-type="bibr">De Maio <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btac761-B21" ref-type="bibr">Didelot <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btac761-B38" ref-type="bibr">Jombart <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btac761-B41" ref-type="bibr">Klinkenberg <italic toggle="yes">et al.</italic>, 2017</xref>). Only one of these methods considered the possibility of importation by performing a test based on the number of mutations between a case and its most likely donor (<xref rid="btac761-B38" ref-type="bibr">Jombart <italic toggle="yes">et al.</italic>, 2014</xref>).</p>
    <p>Our starting point is a dated phylogeny for the samples at the location of interest. Such a phylogeny can be constructed either directly from the genomes using BEAST (<xref rid="btac761-B56" ref-type="bibr">Suchard <italic toggle="yes">et al.</italic>, 2018</xref>) or BEAST2 (<xref rid="btac761-B6" ref-type="bibr">Bouckaert <italic toggle="yes">et al.</italic>, 2019</xref>) or by dating the nodes in a standard phylogeny using treedater (<xref rid="btac761-B60" ref-type="bibr">Volz and Frost, 2017</xref>), TreeTime (<xref rid="btac761-B52" ref-type="bibr">Sagulenko <italic toggle="yes">et al.</italic>, 2018</xref>) or BactDating (<xref rid="btac761-B22" ref-type="bibr">Didelot <italic toggle="yes">et al.</italic>, 2018</xref>). We consider the leaves of this dated phylogeny in increasing order of sampling dates, asking ourselves for each leaf whether it is likely to be the result of local transmission from the population sampled so far. If not, the leaf is the first representative of a previously undetected imported population, even though it is unlikely to be the import itself since in most situations only a relatively small fraction of cases are sampled and present in the phylogeny. This chronological approach is important to assess the true number of imports: for example, if an import occurred followed by local transmission of the imported variant, the first sample from this variant should be labelled as an import, but subsequent samples from the same variant should not. The approach also lends itself naturally to the online assessment of imports as new cases arise, which is often needed when performing infectious disease epidemiology in real time.</p>
    <p>Since we do not have any information about the external sources and do not want to make any assumptions about them, we build statistical models based on the hypothesis of local transmission, which are fitted using Bayesian methods. When a leaf of the dated phylogeny is found to be a bad fit for this local model, we deduce that an importation is likely to have occurred. Our model is based on the coalescent framework (<xref rid="btac761-B25" ref-type="bibr">Donnelly and Tavaré, 1995</xref>; <xref rid="btac761-B40" ref-type="bibr">Kingman, 1982</xref>) and in particular, its extension to heterochronous sampling (<xref rid="btac761-B26" ref-type="bibr">Drummond <italic toggle="yes">et al.</italic>, 2002</xref>, <xref rid="btac761-B27" ref-type="bibr">2003</xref>). We also use the version of the coalescent model that accounts for variations in the population size (<xref rid="btac761-B25" ref-type="bibr">Donnelly and Tavaré, 1995</xref>; <xref rid="btac761-B33" ref-type="bibr">Griffiths and Tavare, 1994</xref>). We use simulated datasets to show that our approach has an excellent specificity and a good sensitivity for the detection of imports. We also show that our approach can be useful in practice by analysing several recently published real datasets.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Coalescent framework and notations</title>
      <p>Let <italic toggle="yes">n</italic> denote the number of tips in a dated phylogeny <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula>, let <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denote the dates of the leaves, and <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> denote the dates of the internal nodes. Let <italic toggle="yes">A</italic>(<italic toggle="yes">t</italic>) denote the number of lineages at time <italic toggle="yes">t</italic> in <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula>. This is easily computed as the number of leaves dated after <italic toggle="yes">t</italic> minus the number of internal nodes dated after <italic toggle="yes">t</italic>:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="italic">A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="italic">i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="italic">n</mml:mi></mml:munderover><mml:mo> </mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">s</mml:mi></mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mi mathvariant="italic">t</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="italic">i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="italic">n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo> </mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">c</mml:mi></mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mi mathvariant="italic">t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>In the coalescent model, each pair of lineages coalesces at rate <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, where <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the effective population size at time <italic toggle="yes">t</italic> (<xref rid="btac761-B33" ref-type="bibr">Griffiths and Tavare, 1994</xref>). Note that here and throughout this article, we use the notation <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and the name effective population size to denote what is in fact the product of the generation duration and the population size in an idealized Wright–Fisher population. Let us initially assume that this function <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is known, and we will see later how to extend to the situation where it is not known. The total coalescent rate for all pairs at time <italic toggle="yes">t</italic> is therefore equal to:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mrow><mml:mo>λ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mi>A</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mtext>with</mml:mtext><mml:mo> </mml:mo><mml:mtext>the</mml:mtext><mml:mo> </mml:mo><mml:mtext>notation</mml:mtext><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>2</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>However, here we consider an alternative equivalent formulation of the coalescent model, in which the phylogeny is formed by iterating over the leaves one by one in increasing order of date, and considering how each leaf coalesces with the phylogeny made by the previous leaves (<xref rid="btac761-B9" ref-type="bibr">Carson <italic toggle="yes">et al.</italic>, 2022</xref>; <xref rid="btac761-B19" ref-type="bibr">Didelot <italic toggle="yes">et al.</italic>, 2014</xref>). To do so, we consider that the dates <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of the leaves are in increasing order, and that the dates <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> of the internal nodes are ordered so that <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> corresponds to the date of the internal node created when adding the leaf indexed <italic toggle="yes">k</italic> to the tree made of the first <italic toggle="yes">k −</italic> 1 leaves. <xref rid="btac761-F1" ref-type="fig">Figure 1</xref> shows an example of this notation used for labelling the leaves and nodes of the tree. With these notations, the tree made of the <italic toggle="yes">k</italic> first leaves contains the leaves with dates <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and the nodes with dates <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>:</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. We can therefore define the number <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> of lineages at time <italic toggle="yes">t</italic> in the tree made of only the first <italic toggle="yes">k</italic> samples in a way similar to <xref rid="E1" ref-type="disp-formula">Equation 1</xref>:
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="italic">A</mml:mi></mml:mrow><mml:mi mathvariant="italic">k</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="italic">t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="italic">i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi mathvariant="italic">k</mml:mi></mml:munderover><mml:mo> </mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">s</mml:mi></mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mi mathvariant="italic">t</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi mathvariant="italic">i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="italic">k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mo> </mml:mo><mml:mn mathvariant="double-struck">1</mml:mn><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="italic">c</mml:mi></mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mi mathvariant="italic">t</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <fig position="float" id="btac761-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Illustration of the notations used for a genealogy with <italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>10 leaves. The leaves are indexed by <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math></inline-formula> in increasing order of sampling dates <italic toggle="yes">s<sub>k</sub></italic>. The internal nodes are indexed by <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> so that the leaf <italic toggle="yes">k</italic> coalesces at node <italic toggle="yes">k −</italic> 1 with the genealogy made of the previous leaves <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>. The date of the internal node <italic toggle="yes">k</italic> is denoted <italic toggle="yes">c<sub>k</sub></italic>. The coalescent interval for the last leaf <italic toggle="yes">k </italic>=<italic toggle="yes"> </italic>10 at date <italic toggle="yes">s</italic><sub>10</sub> is shown in red</p>
        </caption>
        <graphic xlink:href="btac761f1" position="float"/>
      </fig>
      <p>Note in particular that <italic toggle="yes">A</italic>(<italic toggle="yes">t</italic>) from <xref rid="E1" ref-type="disp-formula">Equation 1</xref> is equal to <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> from <xref rid="E3" ref-type="disp-formula">Equation 3</xref> as expected since this corresponds to the number of lineages in the tree made of all <italic toggle="yes">n</italic> leaves and <italic toggle="yes">n −</italic> 1 internal nodes. The rate at which a new leaf at date <italic toggle="yes">s<sub>k</sub></italic> coalesces with the tree made of the first <italic toggle="yes">k −</italic> 1 leaves is then:
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>The difference in <xref rid="E4" ref-type="disp-formula">Equation 4</xref> compared to <xref rid="E2" ref-type="disp-formula">Equation 2</xref> is that we are now considering coalescence of a single given lineage leading to leaf at date <italic toggle="yes">s<sub>k</sub></italic>, rather than any two pairs of lineages, so that the binomial term for the number of lineages is replaced with simply the number of previous lineages. Note that after the date of leaf <italic toggle="yes">k −</italic> 1, i.e. for <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, we have no previous lineages, i.e. <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, so that <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>, i.e. coalescence is impossible. On the other hand, before the date of leaf <italic toggle="yes">k −</italic> 1, i.e. for <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, we have always at least one previous lineage so that <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo>λ</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
      <p>Let <italic toggle="yes">C<sub>k</sub></italic> denote the coalescent interval for leaf <italic toggle="yes">k</italic>, which is defined as the sum of branch lengths between time <italic toggle="yes">s<sub>k</sub></italic> and <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> in the phylogeny made of the <italic toggle="yes">k −</italic> 1 first leaves. This represents the amount of branch lengths before the new leaf <italic toggle="yes">k</italic> coalesced in the previous tree. <xref rid="btac761-F1" ref-type="fig">Figure 1</xref> shows an example of how the coalescent interval is counted. More formally, we can define the coalescent intervals as:
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>To obtain a given value of <italic toggle="yes">C<sub>k</sub></italic>, we need to have no coalescence of the new lineage between <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">s<sub>k</sub></italic>, which happens with probability <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mrow><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, and a coalescent event at time <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> with one of the <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> lineages existing at that time, which happens with rate <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula>. The probability density function of <italic toggle="yes">C<sub>k</sub></italic> can therefore be written as:
<disp-formula id="E6"><label>(6)</label><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>Note that <italic toggle="yes">C<sub>k</sub></italic> does not appear on the right-hand side because it is fully determined by the values of the leaf and node dates, as shown in <xref rid="E5" ref-type="disp-formula">Equation 5</xref>. This formula for the distribution of <italic toggle="yes">C<sub>k</sub></italic> is valid under the assumptions of the coalescent model with varying population size (<xref rid="btac761-B25" ref-type="bibr">Donnelly and Tavaré, 1995</xref>; <xref rid="btac761-B33" ref-type="bibr">Griffiths and Tavare, 1994</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Detecting imports into a population</title>
      <p>Our aim is to find the number and phylogenetic location of import events in a given dated phylogeny. We address this question by considering each leaf of the tree and whether it is likely to be the result of a previously unreported import, given the dated phylogeny made of only the previous samples. If a leaf indexed <italic toggle="yes">k</italic> is not the result of a new import, then its coalescent interval <italic toggle="yes">C<sub>k</sub></italic> is distributed as described in <xref rid="E6" ref-type="disp-formula">Equation 6</xref>, where <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is the size of the local population. On the other hand, if the leaf indexed <italic toggle="yes">k</italic> is the result of a new import, its coalescent interval will be larger, depending on how distantly related the source of the import is. We do not attempt to explicitly model the source of imports firstly because the data contain little information about import sources, and secondly because we do not want to make assumptions on the sources. We expect most cases in the dated phylogeny to represent local transmission, with only a relatively small ratio (e.g. &lt;5%) of the number of imports to the number of cases. Only the chronologically first case of any imported population is classified as an import, whereas further cases from the same imported population represent local transmission following the import and therefore are not classified as imports. Thus, if a single import occurred followed by local transmission of the imported variant, only the first representative of the imported population will be labelled as an import. The first case in the whole phylogeny is not tested for importation since it does not have a coalescent interval.</p>
      <p>To progressively explain our methodology for the detection of imports, we will first assume that the demographic function is a known constant, then extend to the case of an unknown constant value, and finally extend to the general case of an unknown variable population size function.</p>
    </sec>
    <sec>
      <title>2.3 Case of a known constant population size</title>
      <p>Let us first assume that the demographic function <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a known constant <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. In this case, <xref rid="E6" ref-type="disp-formula">Equation 6</xref> simplifies into:
<disp-formula id="E7"><label>(7)</label><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mrow><mml:mi mathvariant="normal">d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></disp-formula>which means that in the case of a constant population size, the coalescent intervals are independent and identically distributed as exponential with mean <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. If the leaf indexed <italic toggle="yes">k</italic> is the first reported case of an import, it is likely to have a coalescent interval <italic toggle="yes">C<sub>k</sub></italic> greater than would be expected if transmission happened only locally, which can be used to form a simple one-sided statistical test with <italic toggle="yes">P</italic>-value:
<disp-formula id="E8"><label>(8)</label><mml:math id="M8" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>2.4 Case of an unknown constant population size</title>
      <p>In the case where the population size function is a constant <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> which is unknown, we need to estimate it in order to detect imports. We take a Bayesian viewpoint to perform this estimation, which requires setting a prior <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mrow><mml:mo>π</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and combining it with the likelihood terms in <xref rid="E7" ref-type="disp-formula">Equation 7</xref> to obtain the posterior distribution of <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>:
<disp-formula id="E9"><label>(9)</label><mml:math id="M9" display="block" overflow="scroll"><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mo>π</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>Note that the phylogeny <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:mi mathvariant="script">G</mml:mi></mml:math></inline-formula> is treated as observed data, from which the values of the coalescent intervals <italic toggle="yes">C<sub>k</sub></italic> can be computed using <xref rid="E5" ref-type="disp-formula">Equation 5</xref>. For <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:mrow><mml:mo>π</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, we use a InvGamma(0.001,0.001) prior, which means that the exponential rate parameter <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> follows approximately its improper Jeffrey’s prior (<xref rid="btac761-B55" ref-type="bibr">Spiegelhalter <italic toggle="yes">et al.</italic>, 2002</xref>). The Gamma distributions used here and throughout this article are parameterized in terms of the shape and rate parameters, respectively. This same uninformative prior on <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> was previously used in a method aimed at building dated phylogenies (<xref rid="btac761-B22" ref-type="bibr">Didelot <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
      <p>The posterior distribution in <xref rid="E9" ref-type="disp-formula">Equation 9</xref> assumes that there are no imports into the local population, so that all coalescent intervals are distributed according to <xref rid="E7" ref-type="disp-formula">Equation 7</xref>. The estimated value of <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> could therefore be biased upwards compared to the correct value of <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> in the local population, since any import is likely to have higher coalescent interval values. There are three reasons why this is not a concern in practice. Firstly, we expect only a relatively small number of the leaves to be new imports. Secondly, the distribution of coalescent intervals in the local population (<xref rid="E7" ref-type="disp-formula">Equation 7</xref>) is permissive to high values, so that a few high values do not push up the estimated mean dramatically. Thirdly, if <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> is overestimated, then we are less likely to detect imports due to having unexpectedly high coalescent intervals. This would therefore contribute to making the method more conservative in the detection of imports, rather than having false positives. High sensitivity is impossible to achieve anyway since quick back-and-forwards migrations are unidentifiable.</p>
      <p>We can use a Monte Carlo approach to generate a sample of <italic toggle="yes">N</italic> values <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi>N</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> from the posterior distribution in <xref rid="E9" ref-type="disp-formula">Equation 9</xref>, and we can then adapt <xref rid="E8" ref-type="disp-formula">Equation 8</xref> to compute a posterior predictive <italic toggle="yes">P</italic>-value (<xref rid="btac761-B30" ref-type="bibr">Gelman <italic toggle="yes">et al.</italic>, 1996</xref>) to test if the leaf at date <italic toggle="yes">s<sub>k</sub></italic> is the result of a previously undetected import as:
<disp-formula id="E10"><label>(10)</label><mml:math id="M10" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi><mml:mi>i</mml:mi></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
    </sec>
    <sec>
      <title>2.5 General case of an unknown variable population size</title>
      <p>The distribution in <xref rid="E6" ref-type="disp-formula">Equation 6</xref> represents the model for coalescent intervals if only local transmission occurred and the population size was the function <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. However, this equation cannot be used in the general case because the demographic function <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is unknown. Phylodynamic methods can be applied to reconstruct the <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> function either at the same time as reconstructing a dated phylogeny (<xref rid="btac761-B1" ref-type="bibr">Baele <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btac761-B35" ref-type="bibr">Ho and Shapiro, 2011</xref>; <xref rid="btac761-B49" ref-type="bibr">Pybus and Rambaut, 2009</xref>) or in a subsequent step (<xref rid="btac761-B24" ref-type="bibr">Didelot <italic toggle="yes">et al.</italic>, 2021b</xref>; <xref rid="btac761-B39" ref-type="bibr">Karcher <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btac761-B42" ref-type="bibr">Lan <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btac761-B59" ref-type="bibr">Volz and Didelot, 2018</xref>). However, all these methods make some assumptions about the demographic function. Furthermore, even if this function was known the resulting distribution for the coalescent intervals in <xref rid="E6" ref-type="disp-formula">Equation 6</xref> would not be computable analytically. Since our aim here is not to estimate this function but rather to detect imports, we take a different approach.</p>
      <p>In the general case, <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is not constant, but when the coalescent time <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is soon before the sampling date <italic toggle="yes">s<sub>k</sub></italic>, then <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> should be approximately constant between <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> and <italic toggle="yes">s<sub>k</sub></italic>, so that <italic toggle="yes">C<sub>k</sub></italic> is approximately exponential as in <xref rid="E7" ref-type="disp-formula">Equation 7</xref>. We therefore consider that the coalescent intervals <italic toggle="yes">C<sub>k</sub></italic> are exponentially distributed with a mean <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mrow><mml:mo>μ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> which depends on the date of sampling <italic toggle="yes">s<sub>k</sub></italic>. This approximation is necessary since the full distribution is unknown, and results on simulated datasets show that this test is robust.</p>
      <p>To perform Bayesian inference under this model, we need to define the joint prior <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:mrow><mml:mo>π</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mn>3</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We use a Gaussian process with mean zero and covariance function <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> equal to the Matérn kernel with smoothness <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:mrow><mml:mo>ν</mml:mo><mml:mo>=</mml:mo><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> (<xref rid="btac761-B32" ref-type="bibr">Genton, 2002</xref>; <xref rid="btac761-B62" ref-type="bibr">Williams and Rasmussen, 2006</xref>):
<disp-formula id="E11"><label>(11)</label><mml:math id="M11" display="block" overflow="scroll"><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>r</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mi>r</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mtext>with</mml:mtext><mml:mo> </mml:mo><mml:mi>r</mml:mi><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mo>|</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>The spectral density function of this kernel in one dimension is:
<disp-formula id="E12"><label>(12)</label><mml:math id="M12" display="block" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>ω</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>4</mml:mn><mml:msup><mml:mrow><mml:mo>α</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt></mml:mrow><mml:mi>l</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>3</mml:mn><mml:mrow><mml:msup><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>This kernel is characterized by two parameters: the length scale <italic toggle="yes">l</italic> which represents how quickly the distance between two points reduces their correlation, and the scale <italic toggle="yes">α</italic> which represents the marginal standard deviation of the kernel. Specifying the prior on these two parameters completes the definition of the prior model:
<disp-formula id="E13"><label>(13)</label><mml:math id="M13" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mi>l</mml:mi><mml:mo>∼</mml:mo><mml:mtext>InvGamma</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>α</mml:mo><mml:mo>∼</mml:mo><mml:mtext>Half-Normal</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mo>α</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>μ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi mathvariant="script">G</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="script">P</mml:mi></mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mo>α</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>′</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo> </mml:mo></mml:mtd></mml:mtr></mml:mtable><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>This prior is applied to the dated phylogeny rescaled in the interval <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula>, so that the root is at time <italic toggle="yes">t</italic> = − 1 and the most recent leaf at time <italic toggle="yes">t </italic>=<italic toggle="yes"> </italic>1. This ensures that the timescale used in the dated phylogeny does not affect the analysis: for example, the same dated phylogeny with branch lengths measured in years or in days will produce exactly the same results. In all examples shown here, we used hyperparameter values <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mo>α</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math></inline-formula>. We will show that the choice of these values has little effect on our results.</p>
      <p>We want to perform inference in a way that is not computationally intensive even for large phylogenetic trees. Combining this objective with the necessary assumption of dense sampling, together with the assumption that the coalescent rate does not fluctuate too wildly, lends itself naturally to the use of an approximation of the full-rank Gaussian Process. We resort to using a Hilbert space Gaussian process approximation recently described (<xref rid="btac761-B50" ref-type="bibr">Riutort-Mayol <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac761-B54" ref-type="bibr">Solin and Särkkä, 2020</xref>). This requires setting two approximation parameters <italic toggle="yes">M</italic> and <italic toggle="yes">L</italic> corresponding to the number of terms in the expansion and the domain size, respectively. We use <italic toggle="yes">M </italic>=<italic toggle="yes"> </italic>20 and <italic toggle="yes">L </italic>=<italic toggle="yes"> </italic>2 as previously suggested (<xref rid="btac761-B50" ref-type="bibr">Riutort-Mayol <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
      <p>This model is fitted to the data using the dynamic Hamiltonian Monte Carlo method implemented in Stan, which provides a convenient way to specify and infer the variable population size feature (<xref rid="btac761-B3" ref-type="bibr">Betancourt, 2018</xref>; <xref rid="btac761-B8" ref-type="bibr">Carpenter <italic toggle="yes">et al.</italic>, 2017</xref>). For a leaf at date <italic toggle="yes">s<sub>k</sub></italic>, this results in a Monte Carlo sample of size <italic toggle="yes">N</italic> denoted <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>N</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> from the posterior distribution of <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mrow><mml:mo>μ</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. We can then use these values to detect imports using a similar posterior predictive <italic toggle="yes">P</italic>-value as in <xref rid="E10" ref-type="disp-formula">Equation 10</xref>, namely:
<disp-formula id="E14"><label>(14)</label><mml:math id="M14" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mo> </mml:mo><mml:mtext>exp</mml:mtext><mml:mo> </mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msup><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>The statistical tests in <xref rid="E8" ref-type="disp-formula">Equations 8</xref>, <xref rid="E10" ref-type="disp-formula">10</xref> and <xref rid="E14" ref-type="disp-formula">14</xref> are applied to all leaves except the first one, resulting in <italic toggle="yes">n</italic> − 1 separate tests. Multiple testing correction could be considered to limit the number of false positives, however methods to do so pose their own problems (<xref rid="btac761-B31" ref-type="bibr">Gelman <italic toggle="yes">et al.</italic>, 2012</xref>; <xref rid="btac761-B51" ref-type="bibr">Rothman, 1990</xref>) therefore in all the results presented below we report uncorrected <italic toggle="yes">P</italic>-values and consider whether they are below a threshold of 0.01, unless otherwise stated. Although this choice is somewhat arbitrary, our results on simulated data show that they provide a good balance between sensitivity and specificity. In our graphical representation of the results, we show which cases are below the 0.01 threshold and also which cases are below the more stringent 0.001 threshold. For users wishing to apply a multiple testing correction, we provide the option to use for example the Bonferroni correction or the false discovery rate correction (<xref rid="btac761-B2" ref-type="bibr">Benjamini and Hochberg, 1995</xref>).</p>
    </sec>
    <sec>
      <title>2.6 Implementation</title>
      <p>We implemented the simulation and inference methods described in this article in a new R package entitled <italic toggle="yes">DetectImports</italic> which is available at <ext-link xlink:href="https://github.com/xavierdidelot/DetectImports" ext-link-type="uri">https://github.com/xavierdidelot/DetectImports</ext-link> for R version 3.5 or later. We used the <italic toggle="yes">cmdstanr</italic> package (<ext-link xlink:href="https://mc-stan.org/cmdstanr/" ext-link-type="uri">https://mc-stan.org/cmdstanr/</ext-link>) version 0.5.2.1 as interface to Stan version 2.3 (<xref rid="btac761-B8" ref-type="bibr">Carpenter <italic toggle="yes">et al.</italic>, 2017</xref>) and the <italic toggle="yes">posterior</italic> package version 1.2.2 (<ext-link xlink:href="https://mc-stan.org/posterior/" ext-link-type="uri">https://mc-stan.org/posterior/</ext-link>) to store and analyse the results. Our default settings (used throughout this article) use four chains with 4000 iterations each (1000 for warmup and 3000 for sampling) and an adaptation target acceptance statistic <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mrow><mml:mo>δ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.9</mml:mn></mml:mrow></mml:math></inline-formula>. This number of chains is a choice of convenience, to show that good results can be obtained on a standard laptop, but users have the option to increase this number if wanted. We made sure that no divergent transitions occurred during the sampling phase. Convergence and mixing of the algorithm were verified by checking that for all parameters the improved <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> statistics were lower than 1.05 (<xref rid="btac761-B58" ref-type="bibr">Vehtarh <italic toggle="yes">et al.</italic>, 2021</xref>) and the effective sample sizes greater than 2000. All code and data needed to replicate the results are included in the ‘run’ directory of the <italic toggle="yes">DetectImports</italic> repository.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Accounting for variations in the local population size is necessary to correctly identify imports</title>
      <p>We can show that the model with constant population size (<xref rid="E10" ref-type="disp-formula">Equation 10</xref>) is insufficient to capture even relatively simple realistic scenarios, and statistical inference based on the variable population size model (<xref rid="E14" ref-type="disp-formula">Equation 14</xref>) is necessary to correctly identify imports. The simulated phylogeny in <xref rid="btac761-F2" ref-type="fig">Figure 2A</xref> includes 100 samples taken uniformly throughout a single year, from the 1st January to the 31st December. The ancestral process is the standard coalescent model without any import but with varying effective population size (<xref rid="btac761-B25" ref-type="bibr">Donnelly and Tavaré, 1995</xref>; <xref rid="btac761-B33" ref-type="bibr">Griffiths and Tavare, 1994</xref>), which increased 5-fold in the second half of the year compared to its previous level, from <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0.2</mml:mn></mml:mrow></mml:math></inline-formula> year before the 1st July to <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> year afterwards. Consequently, the branches tend to be longer in the second half of the year compared to the first half of the year and the part of the ancestry that occurred in the year prior to sampling (<xref rid="btac761-F2" ref-type="fig">Fig. 2A</xref>). We first attempted to detect imports in this phylogeny under our model assuming a constant local population size. This took approximately 1 s on a standard laptop, and the result is shown in <xref rid="btac761-F2" ref-type="fig">Figure 2B</xref>. The mean coalescent interval was estimated to be 0.44 year (with 95% credible interval 0.37–0.54), with the three samples with the largest coalescent intervals having been identified as likely imports (i.e. with a posterior predictive <italic toggle="yes">P</italic>-value <italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>0.01). This is because these three tips had coalescent intervals higher than would be expected by chance if the population size had been constant, whereas these values were in fact caused by the increase in the population size in the second half of the year. We then inferred using our full model which accounts for variations in the local population size. This took approximately 3 s on a standard laptop, and the results are shown in <xref rid="btac761-F2" ref-type="fig">Figure 2C</xref>. The mean coalescent interval was inferred to have increased significantly from the start until the end of 2020, from 0.19 (0.11–0.36) to 1.33 (0.74–2.54). Consequently, the three tips with the largest coalescent intervals were no longer detected as imports, i.e. the using the full model removed the false positives.</p>
      <fig position="float" id="btac761-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Illustrative application to a single simulated dataset showing that ignoring variations in the local population size can lead to false positives in the detection of imports. (<bold>A</bold>) Simulated phylogeny. (<bold>B</bold>) Inference of imports under the model with constant population size. (<bold>C</bold>) Inference of imports under the model with variable population size. In (B, C), the inferred mean and 95% credible intervals of the mean coalescent intervals over time are shown in blue</p>
        </caption>
        <graphic xlink:href="btac761f2" position="float"/>
      </fig>
      <p>The example in <xref rid="btac761-F2" ref-type="fig">Figure 2</xref> shows that ignoring the variations in the local population size can lead to the detection of imports that are not real. Conversely, it is important to account for variations in the local population size to avoid real imports going undetected. To illustrate this, we simulated a phylogeny shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1A</xref> in which the local population starts on 1st January, with a single import happening on 1st April. Both the original and imported strains follow the same linear growth in effective population size <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mo>τ</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mo>τ</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic toggle="yes">τ</italic> is measured in years since the strain introduction. The original and imported strains coalesce together soon before the 1st January. A total of 500 genomes were sampled between the 1st January and the 31st December, with sampling happening at a rate proportional to the effective population size of each strain. When inferring imports under the constant population size model as shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1B</xref>, the correct import was not detected (<italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>0.19), but seven spurious imports were detected (<italic toggle="yes">P </italic>&lt;<italic toggle="yes"> </italic>0.01). On the other hand, when inferring imports under the variable population size model as shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1C</xref>, the correct import was the only one to be detected (<italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>0.002). The run times were approximately 2 and 13 s on a standard laptop computer, for the inference with constant and variable population size, respectively.</p>
      <p>We performed 100 repeats of a similar simulated scenario to the one described above, except that after the local population was initiated on the 1st January, there were two imports in each simulation on the 1st April and on the 1st July. A total of 500 genomes were sampled throughout the year between the 1st January and the 31st December, with sampling happening at a rate proportional to the effective population size of each of the three strains (initial plus two imports). We performed inference under both models with constant and variable population size, and computed the sensitivity and specificity of both import classifiers at different values of the posterior predictive <italic toggle="yes">P</italic>-values. This resulted in the receiver operating characteristic (ROC) curves shown in <xref rid="btac761-F3" ref-type="fig">Figure 3</xref>. The ROC curve for the model with constant population size is far from perfect, with an area under the curve (AUC) of 0.895. This AUC value represents the probability of giving a lower posterior predictive <italic toggle="yes">P</italic>-value of import to an imported sample compared to a sample that was not imported. In contrast, the model with variable population size has an almost perfect ROC curve, with an AUC of 0.997 (<xref rid="btac761-F3" ref-type="fig">Fig. 3</xref>). Considering <italic toggle="yes">P </italic>=<italic toggle="yes"> </italic>0.01 as the cut-off for significance, the inference under the constant population size model has a specificity of 98.6% and a sensitivity of only 40.5%, whereas the inference under the variable size model has a specificity of 99.7% and a sensitivity of 97.0%. To ensure that our choice of the prior did not have undue effect on the results, we repeated this ROC analysis with hyperparameter values <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mo>α</mml:mo></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and found that it made little difference (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>).</p>
      <fig position="float" id="btac761-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Receiver operating characteristic (ROC) curves for the model with variable population size (red) and the model with constant population size (blue). The dots represent a <italic toggle="yes">P</italic>-value of 0.01</p>
        </caption>
        <graphic xlink:href="btac761f3" position="float"/>
      </fig>
      <p>This ROC analysis (<xref rid="btac761-F3" ref-type="fig">Fig. 3</xref>) confirms the result illustrated with specific examples in <xref rid="btac761-F2" ref-type="fig">Figure 2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S1</xref> about the importance of accounting for the variations in the local population size in order to detect imports with good specificity and sensitivity, and the variable population size model will therefore be used throughout the rest of this article. The time taken to run analyses in the default conditions under the variable population size model grows approximately linearly with the number of genomes in the phylogeny (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). We also performed inference based on simulations using a logistic growth model for imported populations (<xref rid="btac761-B34" ref-type="bibr">Helekal <italic toggle="yes">et al.</italic>, 2021</xref>) and found similarly good accuracy of the import detection (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>).</p>
    </sec>
    <sec>
      <title>3.2 Inference on simulated datasets from the structured coalescent model</title>
      <p>The simulations above were considering only the phylogenetic process within the local population. Here, we consider a more complex model in which the global population is structured into several locations, also known as demes, with migrations potentially occurring from any deme to any other. The corresponding genealogical process is described by the structured coalescent model (<xref rid="btac761-B37" ref-type="bibr">Hudson, 1990</xref>; <xref rid="btac761-B44" ref-type="bibr">Muller <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btac761-B45" ref-type="bibr">Notohara, 1990</xref>). We used the software <italic toggle="yes">Master</italic>, a stochastic simulator of birth–death master equations, (<xref rid="btac761-B57" ref-type="bibr">Vaughan and Drummond, 2013</xref>) to simulate under this model with <italic toggle="yes">D</italic> demes which all had the same effective population size <italic toggle="yes">N<sub>e</sub></italic> = 1 year. The backward-in-time migration rate from any deme to any other was sampled uniformly at random between 0 and <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mrow><mml:mn>0.5</mml:mn><mml:mo>/</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, so that the expected waiting time until a migration from one deme to any of the other <italic toggle="yes">D</italic> − 1 demes was identical for all values of <italic toggle="yes">D</italic>. Only one of the <italic toggle="yes">D</italic> demes was sampled 500 times with dates taken uniformly at random over a period of a year. We performed 100 simulations with <italic toggle="yes">D </italic>=<italic toggle="yes"> </italic>5, <italic toggle="yes">D </italic>=<italic toggle="yes"> </italic>3 and <italic toggle="yes">D </italic>=<italic toggle="yes"> </italic>2, each.</p>
      <p>For each simulated dataset, we counted the correct number of imports into the local population by looking through the whole migration history for migrations into the local deme that led directly (i.e. without any other migration event on the phylogenetic path) to at least one sampled leaf. We also inferred the number of imports based on the dated phylogeny of the samples from local deme, using the model with variable population size, which took between 15 and 20 s to run for each simulated dataset. <xref rid="btac761-F4" ref-type="fig">Figure 4</xref> compares the correct and inferred number of imports in each simulation. The number of detected imports is correlated with the correct number of imports in all three cases with <italic toggle="yes">D </italic>=<italic toggle="yes"> </italic>5 demes (<xref rid="btac761-F4" ref-type="fig">Fig. 4A</xref>), <italic toggle="yes">D </italic>=<italic toggle="yes"> </italic>3 demes (<xref rid="btac761-F4" ref-type="fig">Fig. 4B</xref>) and <italic toggle="yes">D </italic>=<italic toggle="yes"> </italic>2 demes (<xref rid="btac761-F4" ref-type="fig">Fig. 4C</xref>). However, in all three cases, we find that the number of imports has been estimated, with on average only 81%, 76% and 69% of imports being detected for <italic toggle="yes">D </italic>=<italic toggle="yes"> </italic>5, <italic toggle="yes">D </italic>=<italic toggle="yes"> </italic>3 and <italic toggle="yes">D </italic>=<italic toggle="yes"> </italic>2 demes, respectively. This increasing relationship between the number of demes and the ability to detect imports into one of the demes is as expected: when the number of demes is larger, the local population represents a smaller proportion of the global population. Each import becomes more clearly separated in the phylogenies and therefore easier to detect. The fact that some imports remain impossible to detect in all three cases is also expected, since there is always the possibility that a lineage going back in time migrates out of the local population and back into it quickly afterwards, making it basically undetectable. Finally, the case with <italic toggle="yes">D </italic>=<italic toggle="yes"> </italic>2 demes is especially interesting since in this case there are just two populations of equal sizes, one which is sampled and the other one not. Detecting imports is clearly challenging in these conditions, harder than we would envisage in most applications to real data where the local population would typically be a small fraction of the global population. It is therefore encouraging to see that even in this difficult case our method was able to detect the majority of the imports (<xref rid="btac761-F4" ref-type="fig">Fig. 4C</xref>). Analysis of the same simulated datasets under the constant population size model had a slightly improved power to detect imports, as would be expected since the local population size was constant in the simulations (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>).</p>
      <fig position="float" id="btac761-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Application to simulated datasets from the structured coalescent model with five demes (<bold>A</bold>), three demes (<bold>B</bold>) and two demes (<bold>C</bold>). Each dot corresponds to a single simulated dataset, with the correct and inferred number of migrations shown on the <italic toggle="yes">x</italic> and <italic toggle="yes">y</italic> axes, respectively. The solid line corresponds to <italic toggle="yes">x </italic>=<italic toggle="yes"> y</italic> whereas the dotted line shows a linear regression through the dots</p>
        </caption>
        <graphic xlink:href="btac761f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.3 Application to real datasets</title>
      <p>We also applied our importation detection methodology to real datasets and considered how our inference compares with accepted epidemiological wisdom about a number of outbreaks originated by diverse pathogens.</p>
      <p>First, we analysed a small dataset of 132 genomes from an outbreak of <italic toggle="yes">Neisseria gonorrhoeae</italic> (<xref rid="btac761-B20" ref-type="bibr">Didelot <italic toggle="yes">et al.</italic>, 2016</xref>). The genomes were collected between 1995 and 2000 as part of a prospective study on gonorrhoea in Sheffield (<xref rid="btac761-B61" ref-type="bibr">Ward <italic toggle="yes">et al.</italic>, 2000</xref>), and all belonged to ST12 which was the most prevalent NG-MAST type in this setting (<xref rid="btac761-B4" ref-type="bibr">Bilek <italic toggle="yes">et al.</italic>, 2007</xref>). In the previous study of these data (<xref rid="btac761-B20" ref-type="bibr">Didelot <italic toggle="yes">et al.</italic>, 2016</xref>), a dated phylogeny was built using BEAST (<xref rid="btac761-B56" ref-type="bibr">Suchard <italic toggle="yes">et al.</italic>, 2018</xref>) as shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6A</xref>. Analysis took approximately 5 s and the result is shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S6B</xref>. No detectable import was found in this dataset, confirming that all the genomes seem to belong to the same outbreak and can be analysed as such as previously performed (<xref rid="btac761-B20" ref-type="bibr">Didelot <italic toggle="yes">et al.</italic>, 2016</xref>). In particular, there was a gap of about 2 years in the sampling in 1998 and 1999, with most genomes originating before this gap and only seven genomes corresponding to cases afterwards. In principle, this gap could have been explained by a clearance and reintroduction of ST12 in the region, but our analysis shows that this is not the case. Instead, the later cases are descended from the earlier ones through chains of unsampled transmission intermediates, as previously proposed (<xref rid="btac761-B20" ref-type="bibr">Didelot <italic toggle="yes">et al.</italic>, 2016</xref>) using <italic toggle="yes">outbreaker</italic> (<xref rid="btac761-B38" ref-type="bibr">Jombart <italic toggle="yes">et al.</italic>, 2014</xref>).</p>
      <p>Second, we analysed a collection of 155 Vietnamese genomes from the VN clade of the emerging enteric pathogen <italic toggle="yes">Shigella sonnei</italic> (<xref rid="btac761-B36" ref-type="bibr">Holt <italic toggle="yes">et al.</italic>, 2013</xref>). These genomes were sampled between 1995 and 2010, and a dated phylogeny was built using the additive relaxed clock model in BactDating (<xref rid="btac761-B23" ref-type="bibr">Didelot <italic toggle="yes">et al.</italic>, 2021a</xref>). The import analysis took approximately 6 s and the result is shown in <xref rid="btac761-F5" ref-type="fig">Figure 5</xref>. A single import was found (isolate labelled 30 451) with a posterior predictive <italic toggle="yes">P</italic>-value of 0.0057. This isolate may not look remarkably different at first sight on the phylogeny (<xref rid="btac761-F5" ref-type="fig">Fig. 5A</xref>), but it is the second most recent isolate in the collection and has by far the largest coalescent interval (<xref rid="btac761-F5" ref-type="fig">Fig. 5B</xref>). We repeated this analysis for 100 phylogenies from the posterior sample produced by BactDating (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>). The results were robust to phylogenetic uncertainty, with only isolate 30 451 being a likely import. The <italic toggle="yes">P</italic>-values for this isolate had an interquantile range between 0.007 and 0.014 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>). Given these <italic toggle="yes">P</italic>-values, we cannot be absolutely certain if this isolate was indeed imported, but if so it would most probably represent a relatively quick migration out and back into the Vietnamese population, for example via a neighbouring country.</p>
      <fig position="float" id="btac761-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Application to <italic toggle="yes">Shigella sonnei</italic> dataset. (<bold>A</bold>) Dated phylogeny with imports highlighted in red. (<bold>B</bold>) Inference of imports. The inferred mean and 95% credible intervals of the mean coalescent intervals over time are shown in blue</p>
        </caption>
        <graphic xlink:href="btac761f5" position="float"/>
      </fig>
      <p>We also analysed a collection of 1031 genomes of Ebola isolated from Sierra Leone between the 25th May 2014 and 12th September 2015. A dated phylogeny was built for these genomes using BEAST (<xref rid="btac761-B56" ref-type="bibr">Suchard <italic toggle="yes">et al.</italic>, 2018</xref>) in a previous study (<xref rid="btac761-B28" ref-type="bibr">Dudas <italic toggle="yes">et al.</italic>, 2017</xref>). The import analysis took 50 s. The results are shown in <xref rid="btac761-F6" ref-type="fig">Figure 6</xref>, with 25 isolates having a posterior predictive <italic toggle="yes">P</italic>-value of importation below 0.01, of which 5 had a probability below 0.001. All the inferred imports correspond to isolates from 2015, despite most (544/1031) isolates in this collection being from 2014, which is statistically significant (Fisher’s exact test comparing imported versus non-imported in 2014 versus 2015, <italic toggle="yes">P</italic> &lt; 10<sup>−4</sup>). This result coincides well with the incidence of Ebola over time in Sierra Leone and the two other badly affected neighbouring countries Guinea and Liberia (<xref rid="btac761-B53" ref-type="bibr">Shultz <italic toggle="yes">et al.</italic>, 2016</xref>). The end of 2014 and the beginning of 2015 corresponds to the time when Sierra Leone managed to greatly reduce the number of Ebola cases, whereas other countries took longer to do so. The previous study analysing these Sierra Leone genomes also included 210 genomes from Liberia and 369 genomes from Guinea (<xref rid="btac761-B28" ref-type="bibr">Dudas <italic toggle="yes">et al.</italic>, 2017</xref>) and performed a geographic history reconstruction of migrations between the three countries using the discrete trait analysis method (<xref rid="btac761-B43" ref-type="bibr">Lemey <italic toggle="yes">et al.</italic>, 2009</xref>) implemented within BEAST (<xref rid="btac761-B56" ref-type="bibr">Suchard <italic toggle="yes">et al.</italic>, 2018</xref>). It is therefore interesting to compare the results of this previous phylogeographic analysis (<xref rid="btac761-B28" ref-type="bibr">Dudas <italic toggle="yes">et al.</italic>, 2017</xref>) with our own results based on the genomes from Sierra Leone only (<xref rid="btac761-F6" ref-type="fig">Fig. 6</xref>). The phylogeographic analysis revealed that the most recent common ancestor of the epidemic existed around January 2014 in Guinea, from which it spread to Sierra Leone around April 2014 (<xref rid="btac761-B28" ref-type="bibr">Dudas <italic toggle="yes">et al.</italic>, 2017</xref>). The vast majority of subsequent cases in Sierra Leone were descended from this initial introduction (<xref rid="btac761-B28" ref-type="bibr">Dudas <italic toggle="yes">et al.</italic>, 2017</xref>), which would not be detected by our approach since it corresponds to the start of the local population. However, a few sporadic cases were linked with several reintroduction events of Ebola into Sierra Leone, especially from Guinea between January and April 2015 (<xref rid="btac761-B28" ref-type="bibr">Dudas <italic toggle="yes">et al.</italic>, 2017</xref>). The timing and phylogenetic position of these migrations are in good qualitative agreement with our results on importation into Sierra Leone (<xref rid="btac761-F6" ref-type="fig">Fig. 6</xref>). These reintroduction events occurred in spite of the closure of the international borders between the three countries affected by Ebola in mid-2014, as previously noted (<xref rid="btac761-B28" ref-type="bibr">Dudas <italic toggle="yes">et al.</italic>, 2017</xref>). A phylogeography approach would generally be expected to yield more accurate results on migration between countries, since it is based on more complete data, compared to an importation analysis based on genomes from a single country only. However, in many situations genomes are not available from all the countries in which a pathogen circulates, so that a traditional phylogeographic method could not be applied.</p>
      <fig position="float" id="btac761-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Application to Ebola dataset. (<bold>A</bold>) Dated phylogeny showing the imports (red) and locally transmitted descendants of imports (blue). (<bold>B</bold>) Histogram showing the number of locally transmitted (blue) and imported (red) isolates over time</p>
        </caption>
        <graphic xlink:href="btac761f6" position="float"/>
      </fig>
      <p>Finally, we analysed a set of 3797 SARS-CoV-2 genomes isolated in Scotland between March 2020 and June 2022. This collection was obtained by downsampling the ∼200 000 Scottish sequences that have been deposited in GISAID since the beginning of the COVID-19 pandemic; for each day, for which data were available, at most five genomes were randomly selected from those having no ambiguous or unknown base. We then cleaned up the multiple sequence alignment retrieved from GISAID by only keeping the relevant rows, eliminating columns entirely made of dashes and trimming sequences at both sides by the minimum amount of nucleotides needed to make the stretches of dashes at the beginning and the end of each genome, which indicate unknown sequence, entirely disappear for all the genomes selected. The resulting alignment was given as input to FastTree version 2.1.10 (<xref rid="btac761-B48" ref-type="bibr">Price <italic toggle="yes">et al.</italic>, 2010</xref>) to generate a phylogeny which was then dated using BactDating version 1.1 (<xref rid="btac761-B22" ref-type="bibr">Didelot <italic toggle="yes">et al.</italic>, 2018</xref>). This choice of phylogenetic software was guided by the need for scalability to large numbers of genomes. The inference of imports took approximately 20 min to compute, resulting in a total of 50 detected imports, as shown in <xref rid="btac761-F7" ref-type="fig">Figure 7</xref> and listed in <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>. Interestingly, no imports were found until August 2020, perhaps as an effect of the first lockdown which started at the end of March 2020 and was progressively relaxed throughout Spring 2020. During August 2020, 15 imports were identified, which was the largest for any month in the analysis. Many of these imports may be associated with Summer holidaying. According to our analysis, the alpha variant was imported in November 2020, soon after it had been reported in England (<xref rid="btac761-B10" ref-type="bibr">Davies <italic toggle="yes">et al.</italic>, 2021</xref>). Several imports corresponded to low-frequency variants, including Beta in December 2020, Zeta in December 2020 and Eta in March 2021. Fewer imports were detected in the first few months of 2021, which may be the result of the second lockdown in January and February 2021. The Delta variant was imported in April 2021, soon before it became dominant throughout the UK (<xref rid="btac761-B29" ref-type="bibr">Elliott <italic toggle="yes">et al.</italic>, 2021</xref>). From then on, the Alpha variant was reimported three times and the Delta variant nine times with the last imports occurring in December 2021. The Omicron variant (<xref rid="btac761-B7" ref-type="bibr">Cao <italic toggle="yes">et al.</italic>, 2022</xref>) was first imported in December 2021, and reimported three times from January to March 2022, by which time this variant had become dominant in the UK and globally.</p>
      <fig position="float" id="btac761-F7">
        <label>Fig. 7.</label>
        <caption>
          <p>Application to SARS-CoV-2 dataset. (<bold>A</bold>) Inference of imports. The inferred mean and 95% credible intervals of the mean coalescent intervals over time are shown in blue. (<bold>B</bold>) Histogram showing the number of locally transmitted (blue) and imported (red) isolates over time</p>
        </caption>
        <graphic xlink:href="btac761f7" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>When studying the occurrence of an infectious disease in a geographically limited population, it is often important to distinguish cases that have been transmitted within the population from cases that have been imported from external origins. Genomic data have the potential to distinguish between these two types of cases, since new imported cases would usually be more distantly related from previous cases than cases arising from local transmission. We developed a statistical method that can quickly establish which cases have been imported. Application to simulated datasets showed that our method has excellent specificity, which means a very low probability that a locally transmitted case would be inferred to have been imported. Our method also has good sensitivity to detect cases that have been truly imported, although this is not perfect since there is always a chance that an import will be genetically similar to the locally transmitting population. We also showed that our method can be useful in four very different real applications: an outbreak of gonorrhoea in a single city, a country-wide expansion of a bacterial clone causing enteric disease, the 2013–2016 epidemic of Ebola virus disease in Sierra Leone, and the COVID-19 pandemic.</p>
    <p>Our approach uses only genomic data from within the location of interest, without making assumptions about the genomic epidemiology of the disease outside of this location. This problem is therefore analogous to the inference of recombination coming from external unsampled sources (<xref rid="btac761-B13" ref-type="bibr">Didelot and Falush, 2007</xref>; <xref rid="btac761-B15" ref-type="bibr">Didelot and Wilson, 2015</xref>) rather than recombination within a single population (<xref rid="btac761-B16" ref-type="bibr">Didelot <italic toggle="yes">et al.</italic>, 2010</xref>). In this case, genomes from other populations are sometimes used subsequently, by comparing them with the inferred recombination tracts to determine if they might be the origin of the recombination events (<xref rid="btac761-B17" ref-type="bibr">Didelot <italic toggle="yes">et al.</italic>, 2011</xref>, <xref rid="btac761-B18" ref-type="bibr">2012</xref>; <xref rid="btac761-B47" ref-type="bibr">Ozer <italic toggle="yes">et al.</italic>, 2019</xref>). In the same way, for the problem of detecting imports into a location we are interested in here, any information about the genetic diversity at other locations could be used to assess the likely origin of the detected imports, simply by comparing the genomic sequences of the inferred imports with the genomes collected from other locations.</p>
    <p>Our method requires first to compute a dated phylogeny from the genomes before detecting imports and therefore fits within the framework of step-by-step approaches from microbial genomes to epidemiology (<xref rid="btac761-B14" ref-type="bibr">Didelot and Parkhill, 2022</xref>). There are several advantages to this type of approach, including scalability to large datasets as we demonstrated here with the analysis in a matter of seconds of datasets containing hundreds of pathogen genomes. There are however also drawbacks to such an approach compared to a more integrated approach (<xref rid="btac761-B14" ref-type="bibr">Didelot and Parkhill, 2022</xref>). A first issue concerns the fact that the model used to build the dated phylogeny is contradicted here by the presence of imports. As previously noted (cf Section 2), this is unlikely to have a significant effect as long as imports are relatively rare, but in any case, the effect would be to overestimate the local effective population size, thus making the method more specific and less sensitive, as desired. Another inaccuracy of the step-by-step approach is that a single dated phylogeny is used as input, which does not capture the uncertainty in the phylogenetic reconstruction. A solution is to apply the method to a posterior sample of the dated phylogenies (<xref rid="btac761-B46" ref-type="bibr">Nylander <italic toggle="yes">et al.</italic>, 2008</xref>), which is feasible here since our method to detect imports is very fast. We applied this idea to one of the real datasets we analysed and found that the detection of imports was relatively robust even when using a single consensus tree (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>). This is as expected since imports correspond to long branches of the tree which are unlikely to have much uncertainty.</p>
    <p>The main assumption in our model is that the local population evolves according to a coalescent model with varying population size (<xref rid="btac761-B25" ref-type="bibr">Donnelly and Tavaré, 1995</xref>; <xref rid="btac761-B33" ref-type="bibr">Griffiths and Tavare, 1994</xref>). Imports are detected as deviations from this model, rather than being based on an explicit model of migration, so that our method could be described as being semi-parametric. Consequently, our method can be applied to a wide range of epidemiological scenarios, including outbreaks, as showcased by our analysis of a local gonorrhoea outbreak (<xref rid="btac761-B20" ref-type="bibr">Didelot <italic toggle="yes">et al.</italic>, 2016</xref>); large epidemics spanning multiple countries, as exemplified by the <italic toggle="yes">S.sonnei</italic> and Ebola analyses (<xref rid="btac761-F5" ref-type="fig">Figs 5</xref> and <xref rid="btac761-F6" ref-type="fig">6</xref>); or even worldwide pandemics, as in the SARS-CoV-2 application (<xref rid="btac761-F7" ref-type="fig">Fig. 7</xref>). Our method should be especially useful when data are available mostly from a single location, preventing the use of a standard phylogeography approach (<xref rid="btac761-B5" ref-type="bibr">Bloomquist <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btac761-B11" ref-type="bibr">De Maio <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btac761-B43" ref-type="bibr">Lemey <italic toggle="yes">et al.</italic>, 2009</xref>). Sampling of the local population needs to be dense enough to infer fluctuations of its effective size as in other phylodynamic methods (<xref rid="btac761-B1" ref-type="bibr">Baele <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btac761-B35" ref-type="bibr">Ho and Shapiro, 2011</xref>; <xref rid="btac761-B49" ref-type="bibr">Pybus and Rambaut, 2009</xref>). If the sampling is not dense enough, the credible range for the coalescent intervals will be very large and imports will not be detectable. In addition, most cases need to be locally transmitted rather than imported, since imports are detected based on having larger coalescent intervals than other comparable cases (<xref rid="E14" ref-type="disp-formula">Equation 14</xref>). Consequently, one situation where our method would be misleading is if all cases are imported rather than locally transmitted. For instance, consider a set of samples from a single hospital ward, with all cases being community-acquired from a local outbreak rather than transmitted on the ward. In this case, the population size will be estimated for the whole community population, rather than for the ward population, and no import would be inferred, which would be misleading in terms of distinguishing nosocomial and community transmission. Our method should therefore be used only on genomes from a population within which local transmission is known to happen frequently, with importation being the exception rather than the rule.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac761_Supplementary_Data</label>
      <media xlink:href="btac761_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Funding</title>
    <p>We acknowledge funding from the National Institute for Health Research (NIHR) Health Protection Research Unit in Genomics and Enabling Data. This work was supported by the UK Engineering and Physical Sciences Research Council (EPSRC) [EP/S022244/1] for the EPSRC Centre for Doctoral Training in Mathematics for Real-World Systems II. The Research/Scientific Computing teams at The James Hutton Institute and NIAB for providing computational resources and technical support for the UK’s Crop Diversity Bioinformatics HPC [BBSRC grant BB/S019669/1], use of which has contributed to the results reported within this article to X.D. and P.R.</p>
    <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac761-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baele</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Emerging concepts of data integration in pathogen phylodynamics</article-title>. <source>Syst. Biol</source>. doi: <pub-id pub-id-type="doi">10.1093/sysbio/syw054</pub-id>.</mixed-citation>
    </ref>
    <ref id="btac761-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benjamini</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Hochberg</surname><given-names>Y.</given-names></string-name></person-group> (<year>1995</year>) <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>J. R. Statisitical Soc. Ser. B</source>, <volume>57</volume>, <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="btac761-B3">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Betancourt</surname><given-names>M.</given-names></string-name></person-group> (<year>2018</year>) <italic toggle="yes">A Conceptual Introduction to Hamiltonian Monte Carlo.</italic> arXiv preprint arXiv:1701.02434<italic toggle="yes">.</italic></mixed-citation>
    </ref>
    <ref id="btac761-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bilek</surname><given-names>N.</given-names></string-name></person-group><etal>et al</etal> (<year>2007</year>) <article-title>Concordance between <italic toggle="yes">Neisseria gonorrhoeae</italic> genotypes recovered from known sexual contacts</article-title>. <source>J. Clin. Microbiol</source>., <volume>45</volume>, <fpage>3564</fpage>–<lpage>3567</lpage>.<pub-id pub-id-type="pmid">17855579</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bloomquist</surname><given-names>E.W.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>Three roads diverged? Routes to phylogeographic inference</article-title>. <source>Trends Ecol. Evol</source>., <volume>25</volume>, <fpage>626</fpage>–<lpage>632</lpage>.<pub-id pub-id-type="pmid">20863591</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bouckaert</surname><given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>BEAST 2.5: an advanced software platform for Bayesian evolutionary analysis</article-title>. <source>PLoS Comput. Biol</source>., <volume>15</volume>, <fpage>e1006650</fpage>.<pub-id pub-id-type="pmid">30958812</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Omicron escapes the majority of existing SARS-CoV-2 neutralizing antibodies</article-title>. <source>Nature</source>, <volume>602</volume>, <fpage>657</fpage>–<lpage>663</lpage>.<pub-id pub-id-type="pmid">35016194</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carpenter</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Stan: a probabilistic programming language</article-title>. <source>J. Stat. Softw</source>, <volume>76</volume>, 1–32.</mixed-citation>
    </ref>
    <ref id="btac761-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carson</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>The bounded coalescent model: conditioning a genealogy on a minimum root date</article-title>. <source>J. Theor. Biol</source>., <volume>548</volume>, <fpage>111186</fpage>.<pub-id pub-id-type="pmid">35697144</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davies</surname><given-names>N.G.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Estimated transmissibility and impact of SARS-CoV-2 lineage B.1.1.7 in England</article-title>. <source>Science</source>, <volume>372</volume>, eabg3055.</mixed-citation>
    </ref>
    <ref id="btac761-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Maio</surname><given-names>N.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>New routes to phylogeography: a Bayesian structured coalescent approximation</article-title>. <source>PLoS Genet</source>., <volume>11</volume>, <fpage>e1005421</fpage>.<pub-id pub-id-type="pmid">26267488</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Maio</surname><given-names>N.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>SCOTTI: efficient reconstruction of transmission within outbreaks with the structured coalescent</article-title>. <source>PLoS Comput. Biol</source>., <volume>12</volume>, <fpage>e1005130</fpage>.<pub-id pub-id-type="pmid">27681228</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Didelot</surname><given-names>X.</given-names></string-name>, <string-name><surname>Falush</surname><given-names>D.</given-names></string-name></person-group> (<year>2007</year>) <article-title>Inference of bacterial microevolution using multilocus sequence data</article-title>. <source>Genetics</source>, <volume>175</volume>, <fpage>1251</fpage>–<lpage>1266</lpage>.<pub-id pub-id-type="pmid">17151252</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Didelot</surname><given-names>X.</given-names></string-name>, <string-name><surname>Parkhill</surname><given-names>J.</given-names></string-name></person-group> (<year>2022</year>) <article-title>A scalable analytical approach from bacterial genomes to epidemiology</article-title>. <source>Philos. Trans. R Soc. Lond. B Biol. Sci</source>., <volume>377</volume>, <fpage>20210246</fpage>.<pub-id pub-id-type="pmid">35989600</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Didelot</surname><given-names>X.</given-names></string-name>, <string-name><surname>Wilson</surname><given-names>D.J.</given-names></string-name></person-group> (<year>2015</year>) <article-title>ClonalFrameML: efficient inference of recombination in whole bacterial genomes</article-title>. <source>PLoS Comput. Biol</source>., <volume>11</volume>, <fpage>e1004041</fpage>.<pub-id pub-id-type="pmid">25675341</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Didelot</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>Inference of homologous recombination in bacteria using whole-genome sequences</article-title>. <source>Genetics</source>, <volume>186</volume>, <fpage>1435</fpage>–<lpage>1449</lpage>.<pub-id pub-id-type="pmid">20923983</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Didelot</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2011</year>) <article-title>Recombination and population structure in Salmonella enterica</article-title>. <source>PLoS Genet</source>., <volume>7</volume>, <fpage>e1002191</fpage>.<pub-id pub-id-type="pmid">21829375</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Didelot</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>Impact of homologous and non-homologous recombination in the genomic evolution of Escherichia coli</article-title>. <source>BMC Genomics</source>., <volume>13</volume>, <fpage>256</fpage>.<pub-id pub-id-type="pmid">22712577</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Didelot</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Bayesian inference of infectious disease transmission from whole genome sequence data</article-title>. <source>Mol. Biol. Evol</source>., <volume>31</volume>, <fpage>1869</fpage>–<lpage>1879</lpage>.<pub-id pub-id-type="pmid">24714079</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Didelot</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Genomic analysis and comparison of two gonorrhea outbreaks</article-title>. <source>MBio</source>, <volume>7</volume>, <fpage>e00525–16</fpage>.<pub-id pub-id-type="pmid">27353752</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Didelot</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Genomic infectious disease epidemiology in partially sampled and ongoing outbreaks</article-title>. <source>Mol. Biol. Evol</source>., <volume>34</volume>, <fpage>997</fpage>–<lpage>1007</lpage>.<pub-id pub-id-type="pmid">28100788</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Didelot</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Bayesian inference of ancestral dates on bacterial phylogenetic trees</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>e134</fpage>.<pub-id pub-id-type="pmid">30184106</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Didelot</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2021a</year>) <article-title>Additive uncorrelated relaxed clock models for the dating of genomic epidemiology phylogenies</article-title>. <source>Mol. Biol. Evol</source>., <volume>38</volume>, <fpage>307</fpage>–<lpage>317</lpage>.<pub-id pub-id-type="pmid">32722797</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B24">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Didelot</surname><given-names>X.</given-names></string-name></person-group><etal>et al</etal> (<year>2021b</year>) Model design for non-parametric phylodynamic inference and applications to pathogen surveillance. <italic toggle="yes">bioRxiv</italic>, 2021.01.18.427056.</mixed-citation>
    </ref>
    <ref id="btac761-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Donnelly</surname><given-names>P.</given-names></string-name>, <string-name><surname>Tavaré</surname><given-names>S.</given-names></string-name></person-group> (<year>1995</year>) <article-title>Coalescents and genealogical structure under neutrality</article-title>. <source>Annu. Rev. Genet</source>., <volume>29</volume>, <fpage>401</fpage>–<lpage>421</lpage>.<pub-id pub-id-type="pmid">8825481</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Drummond</surname><given-names>A.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2002</year>) <article-title>Estimating mutation parameters, population history and genealogy simultaneously from temporally spaced sequence data</article-title>. <source>Genetics</source>, <volume>161</volume>, <fpage>1307</fpage>–<lpage>1320</lpage>.<pub-id pub-id-type="pmid">12136032</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Drummond</surname><given-names>A.J.</given-names></string-name></person-group><etal>et al</etal> (<year>2003</year>) <article-title>Measurably evolving populations</article-title>. <source>Trends Ecol. Evol</source>., <volume>18</volume>, <fpage>481</fpage>–<lpage>488</lpage>.</mixed-citation>
    </ref>
    <ref id="btac761-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dudas</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Virus genomes reveal factors that spread and sustained the ebola epidemic</article-title>. <source>Nature</source>, <volume>544</volume>, <fpage>309</fpage>–<lpage>315</lpage>.<pub-id pub-id-type="pmid">28405027</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elliott</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Exponential growth, high prevalence of SARS-CoV-2, and vaccine effectiveness associated with the Delta variant</article-title>. <source>Science</source>, <volume>374</volume>, eabl9551.</mixed-citation>
    </ref>
    <ref id="btac761-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gelman</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>1996</year>) <article-title>Posterior predictive assessment of model fitness via realized discrepancies</article-title>. <source>Stat. Sin</source>., <volume>6</volume>, <fpage>733</fpage>–<lpage>807</lpage>.</mixed-citation>
    </ref>
    <ref id="btac761-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gelman</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2012</year>) <article-title>Why we (usually) don’t have to worry about multiple comparisons</article-title>. <source>J. Res. Educ. Effect</source>., <volume>5</volume>, <fpage>189</fpage>–<lpage>211</lpage>.</mixed-citation>
    </ref>
    <ref id="btac761-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Genton</surname><given-names>M.G.</given-names></string-name></person-group> (<year>2002</year>) <article-title>Classes of kernels for machine learning: a statistics perspective</article-title>. <source>J. Mach. Learn. Res</source>, <volume>2</volume>, <fpage>299</fpage>–<lpage>312</lpage>.</mixed-citation>
    </ref>
    <ref id="btac761-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Griffiths</surname><given-names>R.</given-names></string-name>, <string-name><surname>Tavare</surname><given-names>S.</given-names></string-name></person-group> (<year>1994</year>) <article-title>Sampling theory for neutral alleles in a varying environment</article-title>. <source>Philos. Trans. R. Soc. B</source>, <volume>344</volume>, <fpage>403</fpage>–<lpage>410</lpage>.</mixed-citation>
    </ref>
    <ref id="btac761-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Helekal</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Bayesian inference of clonal expansions in a dated phylogeny</article-title>. <source>Syst. Biol.</source><fpage>syab095</fpage>.</mixed-citation>
    </ref>
    <ref id="btac761-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ho</surname><given-names>S.Y.W.</given-names></string-name>, <string-name><surname>Shapiro</surname><given-names>B.</given-names></string-name></person-group> (<year>2011</year>) <article-title>Skyline-plot methods for estimating demographic history from nucleotide sequences</article-title>. <source>Mol. Ecol. Resour</source>., <volume>11</volume>, <fpage>423</fpage>–<lpage>434</lpage>.<pub-id pub-id-type="pmid">21481200</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Holt</surname><given-names>K.E.</given-names></string-name></person-group><etal>et al</etal> (<year>2013</year>) <article-title>Tracking the establishment of local endemic populations of an emergent enteric pathogen</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>110</volume>, <fpage>17522</fpage>–<lpage>17527</lpage>.<pub-id pub-id-type="pmid">24082120</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hudson</surname><given-names>R.</given-names></string-name></person-group> (<year>1990</year>) <article-title>Gene genealogies and the coalescent process</article-title>. <source>Oxford Surv. Evol. Biol</source>., <volume>7</volume>, <fpage>1</fpage>–<lpage>44</lpage>.</mixed-citation>
    </ref>
    <ref id="btac761-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jombart</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2014</year>) <article-title>Bayesian reconstruction of disease outbreaks by combining epidemiologic and genomic data</article-title>. <source>PLoS Comput. Biol</source>., <volume>10</volume>, <fpage>e1003457</fpage>.<pub-id pub-id-type="pmid">24465202</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karcher</surname><given-names>M.D.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Phylodyn: an R package for phylodynamic simulation and inference</article-title>. <source>Mol. Ecol. Resour</source>., <volume>17</volume>, <fpage>96</fpage>–<lpage>100</lpage>.<pub-id pub-id-type="pmid">27801980</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kingman</surname><given-names>J.</given-names></string-name></person-group> (<year>1982</year>) <article-title>The coalescent</article-title>. <source>Stoch. Process. Appl</source>., <volume>13</volume>, <fpage>235</fpage>–<lpage>248</lpage>.</mixed-citation>
    </ref>
    <ref id="btac761-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klinkenberg</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Simultaneous inference of phylogenetic and transmission trees in infectious disease outbreaks</article-title>. <source>PLoS Comput. Biol</source>., <volume>13</volume>, <fpage>e1005495</fpage>.<pub-id pub-id-type="pmid">28545083</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lan</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>An efficient Bayesian inference framework for coalescent-based nonparametric phylodynamics</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>3282</fpage>–<lpage>3289</lpage>.<pub-id pub-id-type="pmid">26093147</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lemey</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>Bayesian phylogeography finds its roots</article-title>. <source>PLoS Comput. Biol</source>., <volume>5</volume>, <fpage>e1000520</fpage>.<pub-id pub-id-type="pmid">19779555</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muller</surname><given-names>N.F.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>The structured coalescent and its approximations</article-title>. <source>Mol. Biol. Evol</source>., <volume>34</volume>, <fpage>2970</fpage>–<lpage>2981</lpage>.<pub-id pub-id-type="pmid">28666382</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Notohara</surname><given-names>M.</given-names></string-name></person-group> (<year>1990</year>) <article-title>The coalescent and the genealogical process in geographically structured population</article-title>. <source>J. Math. Biol</source>., <volume>29</volume>, <fpage>59</fpage>–<lpage>75</lpage>.<pub-id pub-id-type="pmid">2277236</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nylander</surname><given-names>J.A.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2008</year>) <article-title>Accounting for phylogenetic uncertainty in biogeography: a bayesian approach to dispersal-vicariance analysis of the thrushes (aves: turdus)</article-title>. <source>Syst. Biol</source>., <volume>57</volume>, <fpage>257</fpage>–<lpage>268</lpage>.<pub-id pub-id-type="pmid">18425716</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ozer</surname><given-names>E.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>The population structure of <italic toggle="yes">Pseudomonas aeruginosa</italic> is characterized by genetic isolation of exoU+ and exoS+ lineages</article-title>. <source>Genome Biol. Evol</source>., <volume>11</volume>, <fpage>1780</fpage>–<lpage>1796</lpage>.<pub-id pub-id-type="pmid">31173069</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Price</surname><given-names>M.N.</given-names></string-name></person-group><etal>et al</etal> (<year>2010</year>) <article-title>FastTree 2 – approximately maximum-likelihood trees for large alignments</article-title>. <source>PLoS One</source>, <volume>5</volume>, <fpage>e9490</fpage>.<pub-id pub-id-type="pmid">20224823</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pybus</surname><given-names>O.G.</given-names></string-name>, <string-name><surname>Rambaut</surname><given-names>A.</given-names></string-name></person-group> (<year>2009</year>) <article-title>Evolutionary analysis of the dynamics of viral infectious disease</article-title>. <source>Nat. Rev. Genet</source>., <volume>10</volume>, <fpage>540</fpage>–<lpage>550</lpage>.<pub-id pub-id-type="pmid">19564871</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B50">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Riutort-Mayol</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) Practical Hilbert space approximate Bayesian Gaussian processes for probabilistic programming. <italic toggle="yes">Arxiv Prepr. arXiv2004.11408v1</italic>.</mixed-citation>
    </ref>
    <ref id="btac761-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rothman</surname><given-names>K.J.</given-names></string-name></person-group> (<year>1990</year>) <article-title>No adjustments are needed for multiple comparisons</article-title>. <source>Epidemiology</source>, <volume>1</volume>, <fpage>43</fpage>–<lpage>46</lpage>.<pub-id pub-id-type="pmid">2081237</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sagulenko</surname><given-names>P.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>TreeTime: maximum likelihood phylodynamic analysis</article-title>. <source>Virus Evol</source>., <volume>4</volume>, vex042.</mixed-citation>
    </ref>
    <ref id="btac761-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shultz</surname><given-names>J.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Distinguishing epidemiological features of the 2013–2016 west africa ebola virus disease outbreak</article-title>. <source>Disaster Health</source>, <volume>3</volume>, <fpage>78</fpage>–<lpage>88</lpage>.<pub-id pub-id-type="pmid">28229017</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Solin</surname><given-names>A.</given-names></string-name>, <string-name><surname>Särkkä</surname><given-names>S.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Hilbert space methods for reduced-rank Gaussian process regression</article-title>. <source>Stat. Comput</source>., <volume>30</volume>, <fpage>419</fpage>–<lpage>446</lpage>.</mixed-citation>
    </ref>
    <ref id="btac761-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Spiegelhalter</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2002</year>) <article-title>Bayesian measures of model complexity and fit</article-title>. <source>J. R. Stat. Soc. B</source>, <volume>64</volume>, <fpage>583</fpage>–<lpage>639</lpage>.</mixed-citation>
    </ref>
    <ref id="btac761-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Suchard</surname><given-names>M.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Bayesian phylogenetic and phylodynamic data integration using BEAST 1.10</article-title>. <source>Virus Evol</source>., <volume>4</volume>, vey016.</mixed-citation>
    </ref>
    <ref id="btac761-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vaughan</surname><given-names>T.G.</given-names></string-name>, <string-name><surname>Drummond</surname><given-names>A.J.</given-names></string-name></person-group> (<year>2013</year>) <article-title>A stochastic simulator of birth-death master equations with application to phylodynamics</article-title>. <source>Mol. Biol. Evol</source>., <volume>30</volume>, <fpage>1480</fpage>–<lpage>1493</lpage>.<pub-id pub-id-type="pmid">23505043</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vehtarh</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Rank-normalization, folding, and localization: an improved R hat for assessing convergence of MCMC</article-title>. <source>Bayesian Anal</source>., <volume>16</volume>, <fpage>667</fpage>–<lpage>718</lpage>.</mixed-citation>
    </ref>
    <ref id="btac761-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Volz</surname><given-names>E.M.</given-names></string-name>, <string-name><surname>Didelot</surname><given-names>X.</given-names></string-name></person-group> (<year>2018</year>) <article-title>Modeling the growth and decline of pathogen effective population size provides insight into epidemic dynamics and drivers of antimicrobial resistance</article-title>. <source>Syst. Biol</source>., <volume>67</volume>, <fpage>719</fpage>–<lpage>728</lpage>.<pub-id pub-id-type="pmid">29432602</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Volz</surname><given-names>E.M.</given-names></string-name>, <string-name><surname>Frost</surname><given-names>S.D.W.</given-names></string-name></person-group> (<year>2017</year>) <article-title>Scalable relaxed clock phylogenetic dating</article-title>. <source>Virus Evol</source>., <volume>3</volume>.</mixed-citation>
    </ref>
    <ref id="btac761-B61">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ward</surname><given-names>H.</given-names></string-name></person-group><etal>et al</etal> (<year>2000</year>) <article-title>A prospective social and molecular investigation of gonococcal transmission</article-title>. <source>Lancet</source>, <volume>356</volume>, <fpage>1812</fpage>–<lpage>1817</lpage>.<pub-id pub-id-type="pmid">11117914</pub-id></mixed-citation>
    </ref>
    <ref id="btac761-B62">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Williams</surname><given-names>C.K.</given-names></string-name>, <string-name><surname>Rasmussen</surname><given-names>C.E.</given-names></string-name></person-group> (<year>2006</year>) <source>Gaussian Processes for Machine Learning</source>. <publisher-name>MIT Press</publisher-name>, <publisher-loc>Cambridge, MA</publisher-loc>.</mixed-citation>
    </ref>
  </ref-list>
</back>
