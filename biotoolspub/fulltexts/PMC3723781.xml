<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3723781</article-id>
    <article-id pub-id-type="pmid">23935913</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-13-16318</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0068954</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Biophysics</subject>
          <subj-group>
            <subject>Protein Folding</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computational Biology</subject>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Structure Prediction</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Macromolecular Structure Analysis</subject>
            <subj-group>
              <subject>Protein Structure</subject>
            </subj-group>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer Science</subject>
        <subj-group>
          <subject>Algorithms</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Mathematics</subject>
        <subj-group>
          <subject>Applied Mathematics</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Physics</subject>
        <subj-group>
          <subject>Biophysics</subject>
          <subj-group>
            <subject>Protein Folding</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Efficient Sampling in Fragment-Based Protein Structure Prediction Using an Estimation of Distribution Algorithm</article-title>
      <alt-title alt-title-type="running-head">Efficient Sampling in Protein Structure Prediction</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Simoncini</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Kam Y. J.</given-names>
        </name>
        <xref ref-type="aff" rid="aff1"/>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <addr-line>Zhang Initiative Research Unit, Institute Laboratories, RIKEN, Wako, Saitama, Japan</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Zhang</surname>
          <given-names>Yang</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Michigan, United States of America</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>kamzhang@riken.jp</email></corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Conceived and designed the experiments: DS KYJZ. Performed the experiments: DS. Analyzed the data: DS KYJZ. Wrote the paper: DS KYJZ.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>25</day>
      <month>7</month>
      <year>2013</year>
    </pub-date>
    <volume>8</volume>
    <issue>7</issue>
    <elocation-id>e68954</elocation-id>
    <history>
      <date date-type="received">
        <day>18</day>
        <month>4</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>6</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2013 Simoncini, Zhang</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Simoncini, Zhang</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Fragment assembly is a powerful method of protein structure prediction that builds protein models from a pool of candidate fragments taken from known structures. Stochastic sampling is subsequently used to refine the models. The structures are first represented as coarse-grained models and then as all-atom models for computational efficiency. Many models have to be generated independently due to the stochastic nature of the sampling methods used to search for the global minimum in a complex energy landscape. In this paper we present <inline-formula><inline-graphic xlink:href="pone.0068954.e001.jpg"/></inline-formula>, a fragment-based approach which shares information between the generated models and steers the search towards native-like regions. A distribution over fragments is estimated from a pool of low energy all-atom models. This iteratively-refined distribution is used to guide the selection of fragments during the building of models for subsequent rounds of structure prediction. The use of an estimation of distribution algorithm enabled <inline-formula><inline-graphic xlink:href="pone.0068954.e002.jpg"/></inline-formula> to reach lower energy levels and to generate a higher percentage of near-native models. <inline-formula><inline-graphic xlink:href="pone.0068954.e003.jpg"/></inline-formula> uses an all-atom energy function and produces models with atomic resolution. We observed an improvement in energy-driven blind selection of models on a benchmark of <inline-formula><inline-graphic xlink:href="pone.0068954.e004.jpg"/></inline-formula> in comparison with the <inline-formula><inline-graphic xlink:href="pone.0068954.e005.jpg"/></inline-formula> AbInitioRelax protocol.</p>
    </abstract>
    <funding-group>
      <funding-statement>Funded by RIKEN Initiative Research Unit program. The funder had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>The prediction of protein structures from their sequences has been a subject of intense research ever since the seminal work of Anfinsen <xref rid="pone.0068954-Anfinsen1" ref-type="bibr">[1]</xref>. Based on the principle that form follows function, the three-dimensional (3D) structure of a protein provides critical clues to its function. Moreover, the knowledge of a protein structure facilitates the design of therapeutic agents that modify its function. There are two main challenges that a protein structure prediction (PSP) method has to face: the inaccuracy in energy functions and the size of the search space. The inaccuracy in energy functions make identification of near-native models a difficult task. A study suggests that in some cases the native structure does not belong to the global minimum basin <xref rid="pone.0068954-Kim1" ref-type="bibr">[2]</xref>, and it was estimated that for over <inline-formula><inline-graphic xlink:href="pone.0068954.e006.jpg"/></inline-formula> of the tested targets, a better sampling of the search space may lead to successful predictions. Inaccuracies in the energy functions combined with the huge size of the conformational space give rise to sampling issues. Many methods have been proposed to deal with these problems. One idea was to reduce the search space by assembling the structure from a pool of experimentally determined structural fragments <xref rid="pone.0068954-Bowie1" ref-type="bibr">[3]</xref>. This fragment assembly approach has become one of the most popular methods for protein structure prediction due to the success of <inline-formula><inline-graphic xlink:href="pone.0068954.e007.jpg"/></inline-formula>
<xref rid="pone.0068954-Simons1" ref-type="bibr">[4]</xref>, <xref rid="pone.0068954-Simons2" ref-type="bibr">[5]</xref>, <xref rid="pone.0068954-Rohl1" ref-type="bibr">[6]</xref>. <inline-formula><inline-graphic xlink:href="pone.0068954.e008.jpg"/></inline-formula> employs a two stage strategy: fragment assembly followed by all-atom refinement. During the fragment assembly, the protein models are represented by backbone atoms and centroid of side chains (coarse-grained sampling). Once the models are assembled, the structure representation is switched to all-atom: side chains are added and packed by minimizing an all-atom knowledge-based energy function <xref rid="pone.0068954-LeaverFay1" ref-type="bibr">[7]</xref>.</p>
    <p>Many other fragment-based approaches have been proposed. The <inline-formula><inline-graphic xlink:href="pone.0068954.e009.jpg"/></inline-formula> method, which was successful in recent CASP experiments <xref rid="pone.0068954-Kinch1" ref-type="bibr">[8]</xref>, uses variable length fragments and replica exchange Monte Carlo for sampling <xref rid="pone.0068954-Xu1" ref-type="bibr">[9]</xref>. <inline-formula><inline-graphic xlink:href="pone.0068954.e010.jpg"/></inline-formula> attempts to improve the conformational sampling efficiency by using Conformational Space Annealing <xref rid="pone.0068954-Lee1" ref-type="bibr">[10]</xref>. <inline-formula><inline-graphic xlink:href="pone.0068954.e011.jpg"/></inline-formula> introduces the concept of reversible fragment insertion, where local structures created by the junction of two proteins fragments can be reused later on during the sampling process <xref rid="pone.0068954-Chikenji1" ref-type="bibr">[11]</xref>. <inline-formula><inline-graphic xlink:href="pone.0068954.e012.jpg"/></inline-formula> combines variable length fragments and fold recognition analysis. It uses a genetic algorithm for sampling <xref rid="pone.0068954-Karplus1" ref-type="bibr">[12]</xref>. <inline-formula><inline-graphic xlink:href="pone.0068954.e013.jpg"/></inline-formula> combines supersecondary structural fragments built from several sequential secondary structures with small fragments. The models are assembled using a genetic algorithm and simulated annealing <xref rid="pone.0068954-Jones1" ref-type="bibr">[13]</xref>. Some probabilistic methods estimate the joint angle distribution by a mixture model of particular distributions <xref rid="pone.0068954-Hamelryck1" ref-type="bibr">[14]</xref>, <xref rid="pone.0068954-Li1" ref-type="bibr">[15]</xref>. Among them, <italic>Fragment-HMM</italic> uses protein fragments to obtain a first estimation of the torsion angle distributions using the cosine model, a bi-variate von Mises distribution. The cosine models are used as hidden nodes in a position-specific hidden Markov Model which is then used to sample a sequence of torsion angle pairs. The method then uses the generated protein models as new input to refine the joint angle distributions and iterates until convergence. The incorporation of information from prior rounds has been shown to be beneficial for the prediction of protein secondary and tertiary structures <xref rid="pone.0068954-DeBartolo1" ref-type="bibr">[16]</xref>, <xref rid="pone.0068954-Adhikari1" ref-type="bibr">[17]</xref>. Using the principle of sequential stabilization, Adhikari <italic>et al.</italic> has demonstrated that the accuracy of predicted structures can be greatly improved using a process of progressive learning and structural stabilization found in prior round of folding.</p>
    <p>Fragment-based methods such as <inline-formula><inline-graphic xlink:href="pone.0068954.e014.jpg"/></inline-formula> need to generate a huge number of models in order to find a correct structure. The rugged nature of the energy landscape, due to the inaccuracy of the energy functions and the size of the search space, necessitates the use of stochastic sampling methods. Recently, we have proposed a method (<inline-formula><inline-graphic xlink:href="pone.0068954.e015.jpg"/></inline-formula>) that takes advantage of the large size of the data-set by enabling communications between predictions during the sampling <xref rid="pone.0068954-Simoncini1" ref-type="bibr">[18]</xref>. The idea was that if some fragments occur more often in low energy models, then these fragments are more likely to resemble the native structure. Using an Estimation of Distribution Algorithm (EDA), <inline-formula><inline-graphic xlink:href="pone.0068954.e016.jpg"/></inline-formula> iteratively updates the probabilities of inserting fragments in new models according to their frequency in low energy models. The results obtained with <inline-formula><inline-graphic xlink:href="pone.0068954.e017.jpg"/></inline-formula> were promising, and show that the method is able to enhance the proportion of near-native structures in the pool of protein models on a benchmark of <inline-formula><inline-graphic xlink:href="pone.0068954.e018.jpg"/></inline-formula> proteins. However, it employed coarse-grained models to estimate fragment probabilities. As a result, some high quality models could not be identified and the sampling was misguided on a few targets because of energy function inaccuracy. Also, as its aim was to study the sampling dynamics at a coarse-grained level, it lacks the ability to produce all-atom models.</p>
    <p>In this paper, we describe a new method (<inline-formula><inline-graphic xlink:href="pone.0068954.e019.jpg"/></inline-formula>) that estimates probability mass functions of fragments from all-atom models instead of coarse-grained models as <inline-formula><inline-graphic xlink:href="pone.0068954.e020.jpg"/></inline-formula>. Our new protocol relies on <inline-formula><inline-graphic xlink:href="pone.0068954.e021.jpg"/></inline-formula>'s all-atom energy in order to rank the models during the estimation of distribution step of the algorithm and the all-atom models produced show notable improvements over <inline-formula><inline-graphic xlink:href="pone.0068954.e022.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e023.jpg"/></inline-formula> AbInitioRelax. The gain in accuracy provided by the all-atom energy function had several positive effects on the sampling; the closest structure to native in the pool of models, the proportion of near-native models and the accuracy of lowest energy models improved on average, and on a majority of the <inline-formula><inline-graphic xlink:href="pone.0068954.e024.jpg"/></inline-formula> proteins in our benchmark.</p>
  </sec>
  <sec id="s2">
    <title>Results</title>
    <p><inline-formula><inline-graphic xlink:href="pone.0068954.e025.jpg"/></inline-formula> favors fragments from the library that are closer to native fragments. The probability of selecting each of the 25 9-residue fragments at iteration 4 of <inline-formula><inline-graphic xlink:href="pone.0068954.e026.jpg"/></inline-formula> is plotted against the C<italic><sub>α</sub></italic>RMSD of each fragment to the native structure for 3 fragment windows of PDB codes 1ogw, 1dtj and 1bq9 in <xref ref-type="fig" rid="pone-0068954-g001">Figure 1</xref>. Pearson product moment correlation coefficient shows anti-correlation between probabilities and C<italic><sub>α</sub></italic>RMSD to native, putting in evidence that native-like fragments usually get a high probability of being selected and <italic>vice versa</italic>. The average C<italic><sub>α</sub></italic>RMSD of fragments to native weighted by their probability of being selected at iterations 1 and 4 is plotted for the same PDB codes in <xref ref-type="fig" rid="pone-0068954-g002">Figure 2</xref>. Overall, the average probability weighted C<italic><sub>α</sub></italic>RMSD shows improvement from iteration 1 to 4 in all of the 3 cases.</p>
    <fig id="pone-0068954-g001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0068954.g001</object-id>
      <label>Figure 1</label>
      <caption>
        <title>Estimation of distribution: the probability of selecting each of the 25 9-residue fragments at iteration 4 is plotted against the C<italic><sub>α</sub></italic>RMSD of each fragment to the native structure for 3 fragment windows of PDB codes 1ogw, 1dtj and 1bq9.</title>
        <p>The Pearson correlation coefficient (R) between probabilities and C<italic><sub>α</sub></italic>RMSD to native structure is given for each fragment window.</p>
      </caption>
      <graphic xlink:href="pone.0068954.g001"/>
    </fig>
    <fig id="pone-0068954-g002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0068954.g002</object-id>
      <label>Figure 2</label>
      <caption>
        <title>Average probability weighted C<italic><sub>α</sub></italic>RMSD : for each fragment window, the average of the C<italic><sub>α</sub></italic>RMSD of each fragment weighted by the probability of selecting it is plotted for iterations 1 and 4.</title>
        <p>The average over all fragments windows at iterations 1 and 4 shows an overall improvement on all cases: PDB codes 1ogw, 1dtj and 1bq9.</p>
      </caption>
      <graphic xlink:href="pone.0068954.g002"/>
    </fig>
    <p><inline-formula><inline-graphic xlink:href="pone.0068954.e027.jpg"/></inline-formula> can successively generate lower energy models after each iteration. The distributions of the energies of the models generated by <inline-formula><inline-graphic xlink:href="pone.0068954.e028.jpg"/></inline-formula> at iterations <inline-formula><inline-graphic xlink:href="pone.0068954.e029.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e030.jpg"/></inline-formula> and by <inline-formula><inline-graphic xlink:href="pone.0068954.e031.jpg"/></inline-formula> were shown in <xref ref-type="fig" rid="pone-0068954-g003">Figure 3</xref>. The measures were made with two protein targets, PDB codes 1bq9 and 1ogw. Whereas the distributions of <inline-formula><inline-graphic xlink:href="pone.0068954.e032.jpg"/></inline-formula>'s iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e033.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e034.jpg"/></inline-formula> have the same shape and suggest that the two methods sample similar regions of the search space and in equal proportions, the curve describing the iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e035.jpg"/></inline-formula> is different. In both cases, <inline-formula><inline-graphic xlink:href="pone.0068954.e036.jpg"/></inline-formula> favors the sampling of low energy basins of the search space. For 1bq9, even though the shape of the curves are the same, we note that the curve at iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e037.jpg"/></inline-formula> from <inline-formula><inline-graphic xlink:href="pone.0068954.e038.jpg"/></inline-formula> already shifts a little towards lower energies.</p>
    <fig id="pone-0068954-g003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0068954.g003</object-id>
      <label>Figure 3</label>
      <caption>
        <title>Histograms of energy distribution: comparison between iterations <inline-formula><inline-graphic xlink:href="pone.0068954.e039.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0068954.e040.jpg"/></inline-formula> of <inline-formula><inline-graphic xlink:href="pone.0068954.e041.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e042.jpg"/></inline-formula> for 1bq9 (left) and 1ogw (right).</title>
        <p>The estimation of distribution algorithm allows <inline-formula><inline-graphic xlink:href="pone.0068954.e043.jpg"/></inline-formula> to increase the performance from iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e044.jpg"/></inline-formula> to iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e045.jpg"/></inline-formula>.</p>
      </caption>
      <graphic xlink:href="pone.0068954.g003"/>
    </fig>
    <p>The improvement in lower energy basins sampling achieved by <inline-formula><inline-graphic xlink:href="pone.0068954.e046.jpg"/></inline-formula> translates into better quality models with lower C<italic><sub>α</sub></italic>RMSD (C-alpha Root Mean Square Deviation) to native. This can be seen from <xref ref-type="fig" rid="pone-0068954-g004">Figure 4</xref>, which plots the distribution of decoys as a function of C<italic><sub>α</sub></italic>RMSD to native. The results match with the observations made at energy level. At first iteration, <inline-formula><inline-graphic xlink:href="pone.0068954.e047.jpg"/></inline-formula> sample similar regions of the search space. As a shift at iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e048.jpg"/></inline-formula> for 1bq9 was observed, it can be seen in this figure that <inline-formula><inline-graphic xlink:href="pone.0068954.e049.jpg"/></inline-formula> produces models closer to the native structure even at iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e050.jpg"/></inline-formula>. The distributions change at iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e051.jpg"/></inline-formula>. In both cases, regions closer to the native structure are thoroughly sampled at this stage. The algorithm is particularly efficient for 1bq9. This efficiency of the algorithm could be due to the shape of the fitness landscape induced by <inline-formula><inline-graphic xlink:href="pone.0068954.e052.jpg"/></inline-formula> all-atom energy. Since <inline-formula><inline-graphic xlink:href="pone.0068954.e053.jpg"/></inline-formula> favors the insertion of fragments which have been identified as being helpful in minimizing the energy, a good correlation between the lowest energies and C<italic><sub>α</sub></italic>RMSD to native is one reason for improved performance.</p>
    <fig id="pone-0068954-g004" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0068954.g004</object-id>
      <label>Figure 4</label>
      <caption>
        <title>Histograms of C<italic><sub>α</sub></italic>RMSD to native distribution: comparison between iterations <inline-formula><inline-graphic xlink:href="pone.0068954.e054.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0068954.e055.jpg"/></inline-formula> of <inline-formula><inline-graphic xlink:href="pone.0068954.e056.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e057.jpg"/></inline-formula> for 1bq9 (left) and 1ogw (right).</title>
        <p>Whereas the distributions look identical between iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e058.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e059.jpg"/></inline-formula>, at iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e060.jpg"/></inline-formula> the distribution has shifted towards native structure.</p>
      </caption>
      <graphic xlink:href="pone.0068954.g004"/>
    </fig>
    <p>The quality of models have been improved by estimating probability mass functions of fragments based on all-atom energy instead of coarse-grained energy. The distribution of energies as a function of C<italic><sub>α</sub></italic>RMSD to native for all models generated at iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e061.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e062.jpg"/></inline-formula> produced by <inline-formula><inline-graphic xlink:href="pone.0068954.e063.jpg"/></inline-formula> for one target, 1bq9, are shown in <xref ref-type="fig" rid="pone-0068954-g005">Figure 5</xref>. In addition, it also shows the scatter plot between energy and C<italic><sub>α</sub></italic>RMSD to native for the same target with <inline-formula><inline-graphic xlink:href="pone.0068954.e064.jpg"/></inline-formula> which was using <inline-formula><inline-graphic xlink:href="pone.0068954.e065.jpg"/></inline-formula>'s coarse-grained energy. This figure revealed the critical importance of the energy function in our process. In <inline-formula><inline-graphic xlink:href="pone.0068954.e066.jpg"/></inline-formula>, even though some good models were discovered, the sampling process was misled by the inaccuracies of the coarse-grained energy function. As a result, <inline-formula><inline-graphic xlink:href="pone.0068954.e067.jpg"/></inline-formula> enhanced the search in the wrong region at about 9 Å from the native structure. The high number of low energy misfolded models complicates the identification of the high quality ones. Once we use the all-atom energy in our process, the fitness landscape changes. This time, the algorithm can discover unprecedented energy levels which correspond to models located at about 1 Å C<italic><sub>α</sub></italic>RMSD from the native structure. This suggests that using a more accurate energy function for the periodic estimation of distributions in <inline-formula><inline-graphic xlink:href="pone.0068954.e068.jpg"/></inline-formula> improves the sampling.</p>
    <fig id="pone-0068954-g005" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0068954.g005</object-id>
      <label>Figure 5</label>
      <caption>
        <title>Fitness landscapes at iterations 1 and 4 with coarse-grained models (top, <inline-formula><inline-graphic xlink:href="pone.0068954.e069.jpg"/></inline-formula>) and all-atom models (bottom, <inline-formula><inline-graphic xlink:href="pone.0068954.e070.jpg"/></inline-formula>) for 1bq9.</title>
      </caption>
      <graphic xlink:href="pone.0068954.g005"/>
    </fig>
    <p>We know that turning coarse-grained models into all-atom models dramatically modifies the landscape, but it is unclear if using the all-atom energy to drive <inline-formula><inline-graphic xlink:href="pone.0068954.e071.jpg"/></inline-formula>'s sampling is more efficient. We performed some control experiments for which we used <inline-formula><inline-graphic xlink:href="pone.0068954.e072.jpg"/></inline-formula> to generate coarse-grained models, and turned them into all-atom models with <inline-formula><inline-graphic xlink:href="pone.0068954.e073.jpg"/></inline-formula>'s fast Relax protocol as a final step. The results were then compared with those from our new <inline-formula><inline-graphic xlink:href="pone.0068954.e074.jpg"/></inline-formula> algorithm which includes fast Relax at each iterative step. The same number of models was produced with each method for <inline-formula><inline-graphic xlink:href="pone.0068954.e075.jpg"/></inline-formula> protein sequences and each protocol's ability to produce near-native models was examined. <xref ref-type="table" rid="pone-0068954-t001">Table 1</xref> shows that <inline-formula><inline-graphic xlink:href="pone.0068954.e076.jpg"/></inline-formula> systematically produced models with smaller C<italic><sub>α</sub></italic>RMSD to the native structure, and <inline-formula><inline-graphic xlink:href="pone.0068954.e077.jpg"/></inline-formula> also generated a higher proportion of near-native models than <inline-formula><inline-graphic xlink:href="pone.0068954.e078.jpg"/></inline-formula>. This result shows that switching the models to an all-atom representation at each iteration of our algorithm and modifying the probabilities of subsequent fragment selection according to <inline-formula><inline-graphic xlink:href="pone.0068954.e079.jpg"/></inline-formula>'s all-atom energy function improves the accuracy of <inline-formula><inline-graphic xlink:href="pone.0068954.e080.jpg"/></inline-formula>.</p>
    <table-wrap id="pone-0068954-t001" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0068954.t001</object-id>
      <label>Table 1</label>
      <caption>
        <title>Comparison of all-atom models generated using fragment distributions estimated from all-atom models versus coarse-grained models.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0068954-t001-1" xlink:href="pone.0068954.t001"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td colspan="2" align="left" rowspan="1">1‰ C<italic><sub>α</sub></italic>RMSD (Å)</td>
              <td colspan="2" align="left" rowspan="1">1% C<italic><sub>α</sub></italic>RMSD (Å)</td>
              <td colspan="2" align="left" rowspan="1">Best model (Å)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Target</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>EdaFold<sub>AA</sub></italic>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <italic>EdaFold<sub>CG</sub></italic>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <italic>EdaFold<sub>AA</sub></italic>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <italic>EdaFold<sub>CG</sub></italic>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <italic>EdaFold<sub>AA</sub></italic>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <italic>EdaFold<sub>CG</sub></italic>
              </td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">1di2</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>0.70</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">0.75</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>0.86</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">0.99</td>
              <td align="left" rowspan="1" colspan="1">0.51</td>
              <td align="left" rowspan="1" colspan="1">0.54</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1scj</td>
              <td align="left" rowspan="1" colspan="1">3.26</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.14</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">4.08</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.44</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.35</td>
              <td align="left" rowspan="1" colspan="1">2.41</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1tig</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.28</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.33</td>
              <td align="left" rowspan="1" colspan="1">3.74</td>
              <td align="left" rowspan="1" colspan="1">3.74</td>
              <td align="left" rowspan="1" colspan="1">1.75</td>
              <td align="left" rowspan="1" colspan="1">2.17</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4ubp</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>4.13</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">4.27</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>4.90</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">5.16</td>
              <td align="left" rowspan="1" colspan="1">3.03</td>
              <td align="left" rowspan="1" colspan="1">3.04</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1acf</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.20</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.67</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.94</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">4.32</td>
              <td align="left" rowspan="1" colspan="1">2.20</td>
              <td align="left" rowspan="1" colspan="1">2.44</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt101">
          <label/>
          <p>1‰ C<italic><sub>α</sub></italic>RMSD is the average over the 1‰ lowest C<italic><sub>α</sub></italic>RMSD to native models. Similarly, 1% C<italic><sub>α</sub></italic>RMSD is the average over the 1% lowest C<italic><sub>α</sub></italic>RMSD to native models. Best model is the single lowest C<italic><sub>α</sub></italic>RMSD to native model. <inline-formula><inline-graphic xlink:href="pone.0068954.e081.jpg"/></inline-formula> is a dataset of models obtained by generating coarse-grained <inline-formula><inline-graphic xlink:href="pone.0068954.e082.jpg"/></inline-formula> followed by <inline-formula><inline-graphic xlink:href="pone.0068954.e083.jpg"/></inline-formula>'s fast Relax protocol. In <inline-formula><inline-graphic xlink:href="pone.0068954.e084.jpg"/></inline-formula>, the fast Relax protocol is embedded in each iteration and contributes to the estimation of distributions. Data in bold are statistically better with a confidence greater than 95% according to the Student's <italic>t</italic>-test.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p><inline-formula><inline-graphic xlink:href="pone.0068954.e085.jpg"/></inline-formula> can generate a higher proportion of near-native models on average. The <xref ref-type="table" rid="pone-0068954-t002">Table 2</xref> shows a comparison of the C<italic><sub>α</sub></italic>RMSD to native that each method can reach. The average lowest 1 C<italic><sub>α</sub></italic>RMSD and 1% C<italic><sub>α</sub></italic>RMSD to native are shown. In addition, the C<italic><sub>α</sub></italic>RMSD to native of the best model is shown. The analysis of the proportion and quality of near-native models produced by <inline-formula><inline-graphic xlink:href="pone.0068954.e086.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e087.jpg"/></inline-formula> shows that <inline-formula><inline-graphic xlink:href="pone.0068954.e088.jpg"/></inline-formula> can generate a higher proportion of near-native models on average. The best model generated by each method without selection considerations is also slightly better on average for <inline-formula><inline-graphic xlink:href="pone.0068954.e089.jpg"/></inline-formula>. <xref ref-type="supplementary-material" rid="pone.0068954.s002">Table S1</xref> shows that the trend is similar when looking at AARMSD (All-Atom Root Mean Square Deviation) values. The trend is the same whether we compare C<italic><sub>α</sub></italic>RMSD or AARMSD.</p>
    <table-wrap id="pone-0068954-t002" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0068954.t002</object-id>
      <label>Table 2</label>
      <caption>
        <title>Comparison of all-atom models generated by <inline-formula><inline-graphic xlink:href="pone.0068954.e090.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e091.jpg"/></inline-formula>.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0068954-t002-2" xlink:href="pone.0068954.t002"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td colspan="2" align="left" rowspan="1">1‰ C<italic><sub>α</sub></italic>RMSD (Å)</td>
              <td colspan="2" align="left" rowspan="1">1% C<italic><sub>α</sub></italic>RMSD (Å)</td>
              <td colspan="2" align="left" rowspan="1">Best model (Å)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Target</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>EdaFold<sub>AA</sub></italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Rosetta</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>EdaFold<sub>AA</sub></italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Rosetta</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>EdaFold<sub>AA</sub></italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Rosetta</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">1bq9</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>1.29</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.33</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>1.75</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">4.51</td>
              <td align="left" rowspan="1" colspan="1">0.98</td>
              <td align="left" rowspan="1" colspan="1">2.27</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1di2</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>0.70</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">0.91</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>0.86</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">1.43</td>
              <td align="left" rowspan="1" colspan="1">0.51</td>
              <td align="left" rowspan="1" colspan="1">0.59</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1scj</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.26</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.53</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>4.08</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">4.22</td>
              <td align="left" rowspan="1" colspan="1">2.35</td>
              <td align="left" rowspan="1" colspan="1">2.42</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1hz5</td>
              <td align="left" rowspan="1" colspan="1">2.26</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.21</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.52</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.46</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">1.24</td>
              <td align="left" rowspan="1" colspan="1">1.78</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1cc8</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.09</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.46</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.40</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.13</td>
              <td align="left" rowspan="1" colspan="1">1.72</td>
              <td align="left" rowspan="1" colspan="1">1.77</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1ctf</td>
              <td align="left" rowspan="1" colspan="1">3.44</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.09</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">4.36</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.76</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.70</td>
              <td align="left" rowspan="1" colspan="1">2.40</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1ig5</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.24</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.29</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.61</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.68</td>
              <td align="left" rowspan="1" colspan="1">1.69</td>
              <td align="left" rowspan="1" colspan="1">1.74</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1dtj</td>
              <td align="left" rowspan="1" colspan="1">2.46</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.41</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.56</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.47</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">1.35</td>
              <td align="left" rowspan="1" colspan="1">1.47</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1ogw</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.25</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.67</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.72</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.10</td>
              <td align="left" rowspan="1" colspan="1">1.33</td>
              <td align="left" rowspan="1" colspan="1">1.79</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1dcj</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.55</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.68</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.02</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.38</td>
              <td align="left" rowspan="1" colspan="1">2.00</td>
              <td align="left" rowspan="1" colspan="1">1.65</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">2ci2</td>
              <td align="left" rowspan="1" colspan="1">3.18</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.95</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">4.81</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>4.15</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.24</td>
              <td align="left" rowspan="1" colspan="1">2.07</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">3nzl</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.63</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.83</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>4.11</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">4.45</td>
              <td align="left" rowspan="1" colspan="1">3.07</td>
              <td align="left" rowspan="1" colspan="1">2.96</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1a19</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.90</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.28</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.55</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">4.34</td>
              <td align="left" rowspan="1" colspan="1">2.20</td>
              <td align="left" rowspan="1" colspan="1">1.99</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1tig</td>
              <td align="left" rowspan="1" colspan="1">3.28</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.20</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.74</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.89</td>
              <td align="left" rowspan="1" colspan="1">1.75</td>
              <td align="left" rowspan="1" colspan="1">2.31</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1bm8</td>
              <td align="left" rowspan="1" colspan="1">3.76</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.58</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">4.79</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>4.55</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.84</td>
              <td align="left" rowspan="1" colspan="1">2.43</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4ubp</td>
              <td align="left" rowspan="1" colspan="1">4.13</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.86</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">4.90</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>4.70</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.03</td>
              <td align="left" rowspan="1" colspan="1">2.48</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1m6t</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>1.22</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">1.46</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>1.42</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">1.84</td>
              <td align="left" rowspan="1" colspan="1">1.01</td>
              <td align="left" rowspan="1" colspan="1">1.08</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1iib</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.92</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.30</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>4.00</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">4.82</td>
              <td align="left" rowspan="1" colspan="1">1.85</td>
              <td align="left" rowspan="1" colspan="1">1.89</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1acf</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.20</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">4.55</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.94</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">5.85</td>
              <td align="left" rowspan="1" colspan="1">2.20</td>
              <td align="left" rowspan="1" colspan="1">2.77</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">3chy</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.51</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.82</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>4.63</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">4.93</td>
              <td align="left" rowspan="1" colspan="1">2.18</td>
              <td align="left" rowspan="1" colspan="1">2.52</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Average</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>2.72</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">2.97</td>
              <td align="left" rowspan="1" colspan="1">
                <bold>3.39</bold>
              </td>
              <td align="left" rowspan="1" colspan="1">3.79</td>
              <td align="left" rowspan="1" colspan="1">1.91</td>
              <td align="left" rowspan="1" colspan="1">2.02</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt102">
          <label/>
          <p>1‰ C<italic><sub>α</sub></italic>RMSD is the average over the 1‰ lowest C<italic><sub>α</sub></italic>RMSD to native models. Similarly, 1% C<italic><sub>α</sub></italic>RMSD is the average over the 1% lowest C<italic><sub>α</sub></italic>RMSD to native models. Best model is the single lowest C<italic><sub>α</sub></italic>RMSD to native model. Data in bold are statistically better with a confidence greater than 95% according to the Student's <italic>t</italic>-test.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>The improvement of low quality models away from native is probably not very meaningful. Models with C<italic><sub>α</sub></italic>RMSD less than 3 Å from native structure could potentially be used as templates for solving crystal structures by molecular replacement <xref rid="pone.0068954-Blow1" ref-type="bibr">[19]</xref>. A global view of the ability of each method to produce and identify near-native models was given in <xref ref-type="fig" rid="pone-0068954-g006">Figure 6</xref>. The percentage of models within 3 Å C<italic><sub>α</sub></italic>RMSD of the native structure for the <inline-formula><inline-graphic xlink:href="pone.0068954.e092.jpg"/></inline-formula> lowest energies were computed. For each target, the difference between the percentage of near-native models obtained from <inline-formula><inline-graphic xlink:href="pone.0068954.e093.jpg"/></inline-formula>'s and <inline-formula><inline-graphic xlink:href="pone.0068954.e094.jpg"/></inline-formula>'s dataset was plotted. This difference is in favor of <inline-formula><inline-graphic xlink:href="pone.0068954.e095.jpg"/></inline-formula> for all points above the <inline-formula><inline-graphic xlink:href="pone.0068954.e096.jpg"/></inline-formula> straight line. It is in favor of <inline-formula><inline-graphic xlink:href="pone.0068954.e097.jpg"/></inline-formula> for all points under it. A majority of the points are above the straight line, which confirms that <inline-formula><inline-graphic xlink:href="pone.0068954.e098.jpg"/></inline-formula> improves the quality of the lowest energy models. The percentage of models generated closer than 3 Å C<italic><sub>α</sub></italic>RMSD from the native structure amongst the <inline-formula><inline-graphic xlink:href="pone.0068954.e099.jpg"/></inline-formula> lowest energies in <inline-formula><inline-graphic xlink:href="pone.0068954.e100.jpg"/></inline-formula>'s and <inline-formula><inline-graphic xlink:href="pone.0068954.e101.jpg"/></inline-formula>'s datasets was analyzed in details and illustrated in <xref ref-type="supplementary-material" rid="pone.0068954.s001">Figure S1</xref>. Measurements range from models within <inline-formula><inline-graphic xlink:href="pone.0068954.e102.jpg"/></inline-formula> Å to less than <inline-formula><inline-graphic xlink:href="pone.0068954.e103.jpg"/></inline-formula> Å from native by steps of <inline-formula><inline-graphic xlink:href="pone.0068954.e104.jpg"/></inline-formula> Å. <inline-formula><inline-graphic xlink:href="pone.0068954.e105.jpg"/></inline-formula> was able to produce a higher percentage of models at less than <inline-formula><inline-graphic xlink:href="pone.0068954.e106.jpg"/></inline-formula> Å for <inline-formula><inline-graphic xlink:href="pone.0068954.e107.jpg"/></inline-formula> targets. <inline-formula><inline-graphic xlink:href="pone.0068954.e108.jpg"/></inline-formula> outperforms <inline-formula><inline-graphic xlink:href="pone.0068954.e109.jpg"/></inline-formula> on <inline-formula><inline-graphic xlink:href="pone.0068954.e110.jpg"/></inline-formula> targets. Neither of the two methods was able to generate near-native models within the <inline-formula><inline-graphic xlink:href="pone.0068954.e111.jpg"/></inline-formula> lowest energies on the same two targets: PDB codes <inline-formula><inline-graphic xlink:href="pone.0068954.e112.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e113.jpg"/></inline-formula>.</p>
    <fig id="pone-0068954-g006" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0068954.g006</object-id>
      <label>Figure 6</label>
      <caption>
        <title>Percentage of near native models: 100 lowest energy models were selected from <inline-formula><inline-graphic xlink:href="pone.0068954.e114.jpg"/></inline-formula>'s and <inline-formula><inline-graphic xlink:href="pone.0068954.e115.jpg"/></inline-formula>'s datasets.</title>
        <p>The percentage of models less than 3 Å away from native in terms of C<italic><sub>α</sub></italic>RMSD was computed. The differences in percentages between <inline-formula><inline-graphic xlink:href="pone.0068954.e116.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e117.jpg"/></inline-formula> are plotted.</p>
      </caption>
      <graphic xlink:href="pone.0068954.g006"/>
    </fig>
    <p>The improved distribution of low energy models has enabled the “blind selection” of better models amongst all generated by <inline-formula><inline-graphic xlink:href="pone.0068954.e118.jpg"/></inline-formula>. The “blind selection” results with energy as a selection criterion for <inline-formula><inline-graphic xlink:href="pone.0068954.e119.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e120.jpg"/></inline-formula> are shown in <xref ref-type="table" rid="pone-0068954-t003">Table 3</xref>. Two results, the first and best predictions, are presented. The first prediction is the model with the lowest energy in the dataset whereas the best prediction is the best model out of the <inline-formula><inline-graphic xlink:href="pone.0068954.e121.jpg"/></inline-formula> lowest energies. Both first and best prediction of <inline-formula><inline-graphic xlink:href="pone.0068954.e122.jpg"/></inline-formula> improves over <inline-formula><inline-graphic xlink:href="pone.0068954.e123.jpg"/></inline-formula> of about <inline-formula><inline-graphic xlink:href="pone.0068954.e124.jpg"/></inline-formula> Å either when looking at C<italic><sub>α</sub></italic>RMSD or AARMSD (See <xref ref-type="supplementary-material" rid="pone.0068954.s003">Table S2</xref> for AARMSD values).</p>
    <table-wrap id="pone-0068954-t003" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0068954.t003</object-id>
      <label>Table 3</label>
      <caption>
        <title>Comparison of best all-atom models selected based on energy.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0068954-t003-3" xlink:href="pone.0068954.t003"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td colspan="2" align="left" rowspan="1">First prediction (Å)</td>
              <td colspan="2" align="left" rowspan="1">Best prediction (Å)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Target</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>EdaFold<sub>AA</sub></italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Rosetta</td>
              <td align="left" rowspan="1" colspan="1">
                <italic>EdaFold<sub>AA</sub></italic>
              </td>
              <td align="left" rowspan="1" colspan="1">Rosetta</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">1bq9</td>
              <td align="left" rowspan="1" colspan="1">1.55</td>
              <td align="left" rowspan="1" colspan="1">4.32</td>
              <td align="left" rowspan="1" colspan="1">1.38</td>
              <td align="left" rowspan="1" colspan="1">4.32</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1di2</td>
              <td align="left" rowspan="1" colspan="1">1.00</td>
              <td align="left" rowspan="1" colspan="1">1.23</td>
              <td align="left" rowspan="1" colspan="1">0.76</td>
              <td align="left" rowspan="1" colspan="1">0.86</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1scj</td>
              <td align="left" rowspan="1" colspan="1">7.74</td>
              <td align="left" rowspan="1" colspan="1">7.23</td>
              <td align="left" rowspan="1" colspan="1">3.61</td>
              <td align="left" rowspan="1" colspan="1">6.36</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1hz5</td>
              <td align="left" rowspan="1" colspan="1">3.21</td>
              <td align="left" rowspan="1" colspan="1">3.51</td>
              <td align="left" rowspan="1" colspan="1">3.00</td>
              <td align="left" rowspan="1" colspan="1">3.18</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1cc8</td>
              <td align="left" rowspan="1" colspan="1">3.89</td>
              <td align="left" rowspan="1" colspan="1">8.28</td>
              <td align="left" rowspan="1" colspan="1">3.66</td>
              <td align="left" rowspan="1" colspan="1">3.29</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1ctf</td>
              <td align="left" rowspan="1" colspan="1">7.05</td>
              <td align="left" rowspan="1" colspan="1">4.84</td>
              <td align="left" rowspan="1" colspan="1">4.58</td>
              <td align="left" rowspan="1" colspan="1">2.76</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1ig5</td>
              <td align="left" rowspan="1" colspan="1">6.46</td>
              <td align="left" rowspan="1" colspan="1">2.64</td>
              <td align="left" rowspan="1" colspan="1">3.63</td>
              <td align="left" rowspan="1" colspan="1">2.64</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1dtj</td>
              <td align="left" rowspan="1" colspan="1">1.72</td>
              <td align="left" rowspan="1" colspan="1">1.72</td>
              <td align="left" rowspan="1" colspan="1">1.69</td>
              <td align="left" rowspan="1" colspan="1">1.72</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1ogw</td>
              <td align="left" rowspan="1" colspan="1">2.47</td>
              <td align="left" rowspan="1" colspan="1">2.71</td>
              <td align="left" rowspan="1" colspan="1">2.47</td>
              <td align="left" rowspan="1" colspan="1">2.71</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1dcj</td>
              <td align="left" rowspan="1" colspan="1">5.02</td>
              <td align="left" rowspan="1" colspan="1">3.02</td>
              <td align="left" rowspan="1" colspan="1">2.50</td>
              <td align="left" rowspan="1" colspan="1">2.56</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">2ci2</td>
              <td align="left" rowspan="1" colspan="1">7.73</td>
              <td align="left" rowspan="1" colspan="1">8.47</td>
              <td align="left" rowspan="1" colspan="1">6.77</td>
              <td align="left" rowspan="1" colspan="1">6.41</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">3nzl</td>
              <td align="left" rowspan="1" colspan="1">5.95</td>
              <td align="left" rowspan="1" colspan="1">5.80</td>
              <td align="left" rowspan="1" colspan="1">5.95</td>
              <td align="left" rowspan="1" colspan="1">5.33</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1a19</td>
              <td align="left" rowspan="1" colspan="1">2.73</td>
              <td align="left" rowspan="1" colspan="1">3.76</td>
              <td align="left" rowspan="1" colspan="1">2.73</td>
              <td align="left" rowspan="1" colspan="1">3.10</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1tig</td>
              <td align="left" rowspan="1" colspan="1">4.07</td>
              <td align="left" rowspan="1" colspan="1">3.92</td>
              <td align="left" rowspan="1" colspan="1">3.69</td>
              <td align="left" rowspan="1" colspan="1">3.72</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1bm8</td>
              <td align="left" rowspan="1" colspan="1">9.03</td>
              <td align="left" rowspan="1" colspan="1">3.73</td>
              <td align="left" rowspan="1" colspan="1">3.44</td>
              <td align="left" rowspan="1" colspan="1">3.73</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4ubp</td>
              <td align="left" rowspan="1" colspan="1">10.48</td>
              <td align="left" rowspan="1" colspan="1">10.50</td>
              <td align="left" rowspan="1" colspan="1">5.87</td>
              <td align="left" rowspan="1" colspan="1">8.51</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1m6t</td>
              <td align="left" rowspan="1" colspan="1">1.99</td>
              <td align="left" rowspan="1" colspan="1">1.94</td>
              <td align="left" rowspan="1" colspan="1">1.34</td>
              <td align="left" rowspan="1" colspan="1">1.88</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1iib</td>
              <td align="left" rowspan="1" colspan="1">2.50</td>
              <td align="left" rowspan="1" colspan="1">15.28</td>
              <td align="left" rowspan="1" colspan="1">2.50</td>
              <td align="left" rowspan="1" colspan="1">9.46</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1acf</td>
              <td align="left" rowspan="1" colspan="1">3.60</td>
              <td align="left" rowspan="1" colspan="1">2.77</td>
              <td align="left" rowspan="1" colspan="1">3.00</td>
              <td align="left" rowspan="1" colspan="1">2.77</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">3chy</td>
              <td align="left" rowspan="1" colspan="1">4.38</td>
              <td align="left" rowspan="1" colspan="1">12.37</td>
              <td align="left" rowspan="1" colspan="1">4.38</td>
              <td align="left" rowspan="1" colspan="1">5.38</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Average</td>
              <td align="left" rowspan="1" colspan="1">4.63</td>
              <td align="left" rowspan="1" colspan="1">5.40</td>
              <td align="left" rowspan="1" colspan="1">3.35</td>
              <td align="left" rowspan="1" colspan="1">4.04</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt103">
          <label/>
          <p>The first prediction is the model with the lowest energy. The best prediction is the best model out of the five lowest energies. The C<italic><sub>α</sub></italic>RMSD to native structure for predicted models are shown.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
    <p>Finally, the improved “blind selection” of models is due to the iterative estimation of distribution over the fragments. A comparison of the blind selection ability of <inline-formula><inline-graphic xlink:href="pone.0068954.e125.jpg"/></inline-formula> at iterations <inline-formula><inline-graphic xlink:href="pone.0068954.e126.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e127.jpg"/></inline-formula> is given in <xref ref-type="table" rid="pone-0068954-t004">Table 4</xref>. The first and best of <inline-formula><inline-graphic xlink:href="pone.0068954.e128.jpg"/></inline-formula> predictions are shown for models taken from iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e129.jpg"/></inline-formula> alone and iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e130.jpg"/></inline-formula> alone. As stated in the method section, <inline-formula><inline-graphic xlink:href="pone.0068954.e131.jpg"/></inline-formula> produces one quarter of the total number of models at each iteration. The results show an improvement of <inline-formula><inline-graphic xlink:href="pone.0068954.e132.jpg"/></inline-formula> Å on average for the first prediction and over <inline-formula><inline-graphic xlink:href="pone.0068954.e133.jpg"/></inline-formula> Å on average for the best prediction. For comparison, one quarter of the final models generated by <inline-formula><inline-graphic xlink:href="pone.0068954.e134.jpg"/></inline-formula> AbInitioRelax was randomly selected. The results show that <inline-formula><inline-graphic xlink:href="pone.0068954.e135.jpg"/></inline-formula> performs slightly better than <inline-formula><inline-graphic xlink:href="pone.0068954.e136.jpg"/></inline-formula> at iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e137.jpg"/></inline-formula>, when no information is shared to produce the models. This result suggests that the sampling algorithm of <inline-formula><inline-graphic xlink:href="pone.0068954.e138.jpg"/></inline-formula> is more efficient than ours. The same trend was observed when looking at AARMSD values (see <xref ref-type="supplementary-material" rid="pone.0068954.s004">Table S3</xref>). Nevertheless, <inline-formula><inline-graphic xlink:href="pone.0068954.e139.jpg"/></inline-formula> outperforms <inline-formula><inline-graphic xlink:href="pone.0068954.e140.jpg"/></inline-formula> on this benchmark thanks to the use of EDA. Fragment-based approaches appear to gain considerable advantage from sharing information between predictions.</p>
    <table-wrap id="pone-0068954-t004" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0068954.t004</object-id>
      <label>Table 4</label>
      <caption>
        <title>Blind selection ability of all-atom models generated by <inline-formula><inline-graphic xlink:href="pone.0068954.e141.jpg"/></inline-formula> at iterations <inline-formula><inline-graphic xlink:href="pone.0068954.e142.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e143.jpg"/></inline-formula>.</title>
      </caption>
      <alternatives>
        <graphic id="pone-0068954-t004-4" xlink:href="pone.0068954.t004"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
            <col align="center" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <td align="left" rowspan="1" colspan="1"/>
              <td colspan="3" align="left" rowspan="1">First prediction (Å)</td>
              <td colspan="3" align="left" rowspan="1">Best prediction (Å)</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Target</td>
              <td align="left" rowspan="1" colspan="1">Iter. 1</td>
              <td align="left" rowspan="1" colspan="1">Iter. 4</td>
              <td align="left" rowspan="1" colspan="1">Rosetta</td>
              <td align="left" rowspan="1" colspan="1">Iter. 1</td>
              <td align="left" rowspan="1" colspan="1">Iter. 4</td>
              <td align="left" rowspan="1" colspan="1">Rosetta</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1">1bq9</td>
              <td align="left" rowspan="1" colspan="1">6.28</td>
              <td align="left" rowspan="1" colspan="1">1.38</td>
              <td align="left" rowspan="1" colspan="1">9.41</td>
              <td align="left" rowspan="1" colspan="1">2.86</td>
              <td align="left" rowspan="1" colspan="1">1.11</td>
              <td align="left" rowspan="1" colspan="1">6.20</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1di2</td>
              <td align="left" rowspan="1" colspan="1">1.37</td>
              <td align="left" rowspan="1" colspan="1">0.85</td>
              <td align="left" rowspan="1" colspan="1">1.05</td>
              <td align="left" rowspan="1" colspan="1">0.92</td>
              <td align="left" rowspan="1" colspan="1">0.76</td>
              <td align="left" rowspan="1" colspan="1">0.94</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1scj</td>
              <td align="left" rowspan="1" colspan="1">3.61</td>
              <td align="left" rowspan="1" colspan="1">7.87</td>
              <td align="left" rowspan="1" colspan="1">7.23</td>
              <td align="left" rowspan="1" colspan="1">3.61</td>
              <td align="left" rowspan="1" colspan="1">2.64</td>
              <td align="left" rowspan="1" colspan="1">6.36</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1hz5</td>
              <td align="left" rowspan="1" colspan="1">3.39</td>
              <td align="left" rowspan="1" colspan="1">3.24</td>
              <td align="left" rowspan="1" colspan="1">3.98</td>
              <td align="left" rowspan="1" colspan="1">2.98</td>
              <td align="left" rowspan="1" colspan="1">3.15</td>
              <td align="left" rowspan="1" colspan="1">3.21</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1cc8</td>
              <td align="left" rowspan="1" colspan="1">3.86</td>
              <td align="left" rowspan="1" colspan="1">3.49</td>
              <td align="left" rowspan="1" colspan="1">8.28</td>
              <td align="left" rowspan="1" colspan="1">3.26</td>
              <td align="left" rowspan="1" colspan="1">3.03</td>
              <td align="left" rowspan="1" colspan="1">2.80</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1ctf</td>
              <td align="left" rowspan="1" colspan="1">5.81</td>
              <td align="left" rowspan="1" colspan="1">7.05</td>
              <td align="left" rowspan="1" colspan="1">4.84</td>
              <td align="left" rowspan="1" colspan="1">4.78</td>
              <td align="left" rowspan="1" colspan="1">5.62</td>
              <td align="left" rowspan="1" colspan="1">3.39</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1ig5</td>
              <td align="left" rowspan="1" colspan="1">3.11</td>
              <td align="left" rowspan="1" colspan="1">6.46</td>
              <td align="left" rowspan="1" colspan="1">2.95</td>
              <td align="left" rowspan="1" colspan="1">2.62</td>
              <td align="left" rowspan="1" colspan="1">6.35</td>
              <td align="left" rowspan="1" colspan="1">2.71</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1dtj</td>
              <td align="left" rowspan="1" colspan="1">3.22</td>
              <td align="left" rowspan="1" colspan="1">1.68</td>
              <td align="left" rowspan="1" colspan="1">1.72</td>
              <td align="left" rowspan="1" colspan="1">1.69</td>
              <td align="left" rowspan="1" colspan="1">1.65</td>
              <td align="left" rowspan="1" colspan="1">1.72</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1ogw</td>
              <td align="left" rowspan="1" colspan="1">3.29</td>
              <td align="left" rowspan="1" colspan="1">2.78</td>
              <td align="left" rowspan="1" colspan="1">2.71</td>
              <td align="left" rowspan="1" colspan="1">3.08</td>
              <td align="left" rowspan="1" colspan="1">2.68</td>
              <td align="left" rowspan="1" colspan="1">2.71</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1dcj</td>
              <td align="left" rowspan="1" colspan="1">2.85</td>
              <td align="left" rowspan="1" colspan="1">5.02</td>
              <td align="left" rowspan="1" colspan="1">3.90</td>
              <td align="left" rowspan="1" colspan="1">2.85</td>
              <td align="left" rowspan="1" colspan="1">2.68</td>
              <td align="left" rowspan="1" colspan="1">2.68</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">2ci2</td>
              <td align="left" rowspan="1" colspan="1">7.49</td>
              <td align="left" rowspan="1" colspan="1">7.73</td>
              <td align="left" rowspan="1" colspan="1">7.20</td>
              <td align="left" rowspan="1" colspan="1">7.14</td>
              <td align="left" rowspan="1" colspan="1">6.77</td>
              <td align="left" rowspan="1" colspan="1">7.20</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">3nzl</td>
              <td align="left" rowspan="1" colspan="1">10.87</td>
              <td align="left" rowspan="1" colspan="1">11.42</td>
              <td align="left" rowspan="1" colspan="1">5.80</td>
              <td align="left" rowspan="1" colspan="1">5.58</td>
              <td align="left" rowspan="1" colspan="1">5.50</td>
              <td align="left" rowspan="1" colspan="1">4.99</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1a19</td>
              <td align="left" rowspan="1" colspan="1">6.77</td>
              <td align="left" rowspan="1" colspan="1">3.82</td>
              <td align="left" rowspan="1" colspan="1">3.76</td>
              <td align="left" rowspan="1" colspan="1">3.26</td>
              <td align="left" rowspan="1" colspan="1">2.75</td>
              <td align="left" rowspan="1" colspan="1">3.10</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1tig</td>
              <td align="left" rowspan="1" colspan="1">4.60</td>
              <td align="left" rowspan="1" colspan="1">3.69</td>
              <td align="left" rowspan="1" colspan="1">4.29</td>
              <td align="left" rowspan="1" colspan="1">3.91</td>
              <td align="left" rowspan="1" colspan="1">3.69</td>
              <td align="left" rowspan="1" colspan="1">4.29</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1bm8</td>
              <td align="left" rowspan="1" colspan="1">9.13</td>
              <td align="left" rowspan="1" colspan="1">9.03</td>
              <td align="left" rowspan="1" colspan="1">4.06</td>
              <td align="left" rowspan="1" colspan="1">9.13</td>
              <td align="left" rowspan="1" colspan="1">3.44</td>
              <td align="left" rowspan="1" colspan="1">3.17</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">4ubp</td>
              <td align="left" rowspan="1" colspan="1">9.23</td>
              <td align="left" rowspan="1" colspan="1">11.39</td>
              <td align="left" rowspan="1" colspan="1">10.50</td>
              <td align="left" rowspan="1" colspan="1">5.93</td>
              <td align="left" rowspan="1" colspan="1">7.64</td>
              <td align="left" rowspan="1" colspan="1">7.74</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1m6t</td>
              <td align="left" rowspan="1" colspan="1">2.21</td>
              <td align="left" rowspan="1" colspan="1">1.93</td>
              <td align="left" rowspan="1" colspan="1">1.88</td>
              <td align="left" rowspan="1" colspan="1">1.57</td>
              <td align="left" rowspan="1" colspan="1">1.34</td>
              <td align="left" rowspan="1" colspan="1">1.36</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1iib</td>
              <td align="left" rowspan="1" colspan="1">9.87</td>
              <td align="left" rowspan="1" colspan="1">2.50</td>
              <td align="left" rowspan="1" colspan="1">15.28</td>
              <td align="left" rowspan="1" colspan="1">9.79</td>
              <td align="left" rowspan="1" colspan="1">2.50</td>
              <td align="left" rowspan="1" colspan="1">6.98</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">1acf</td>
              <td align="left" rowspan="1" colspan="1">10.43</td>
              <td align="left" rowspan="1" colspan="1">3.60</td>
              <td align="left" rowspan="1" colspan="1">8.59</td>
              <td align="left" rowspan="1" colspan="1">4.25</td>
              <td align="left" rowspan="1" colspan="1">3.00</td>
              <td align="left" rowspan="1" colspan="1">5.42</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">3chy</td>
              <td align="left" rowspan="1" colspan="1">13.96</td>
              <td align="left" rowspan="1" colspan="1">4.38</td>
              <td align="left" rowspan="1" colspan="1">9.08</td>
              <td align="left" rowspan="1" colspan="1">7.89</td>
              <td align="left" rowspan="1" colspan="1">4.38</td>
              <td align="left" rowspan="1" colspan="1">5.84</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">Average</td>
              <td align="left" rowspan="1" colspan="1">6.07</td>
              <td align="left" rowspan="1" colspan="1">4.97</td>
              <td align="left" rowspan="1" colspan="1">5.83</td>
              <td align="left" rowspan="1" colspan="1">4.35</td>
              <td align="left" rowspan="1" colspan="1">3.54</td>
              <td align="left" rowspan="1" colspan="1">4.15</td>
            </tr>
          </tbody>
        </table>
      </alternatives>
      <table-wrap-foot>
        <fn id="nt104">
          <label/>
          <p>The first prediction is the model with the lowest energy. The best prediction is the best model out of the five lowest energies. All results are shown as C<italic><sub>α</sub></italic>RMSD to native structure. Models produced at iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e144.jpg"/></inline-formula> alone and iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e145.jpg"/></inline-formula> alone are compared. For comparison, the columns Rosetta show the same data obtained from a sample of Rosetta models randomly picked from Rosetta's prediction results.</p>
        </fn>
      </table-wrap-foot>
    </table-wrap>
  </sec>
  <sec id="s3">
    <title>Discussion</title>
    <p>The identification of near-native models is challenging due to the inaccuracy of the energy function. In our previous communication, we presented <inline-formula><inline-graphic xlink:href="pone.0068954.e146.jpg"/></inline-formula> which focused on enrichment of the near-native structures at a coarse-grained level. We have demonstrated that the improved coarse-grained models can lead to better all-atom models by refining the top quality coarse-grained models into all-atom models <xref rid="pone.0068954-Simoncini1" ref-type="bibr">[18]</xref>. However, the question of how top quality coarse-grained models are identified was not addressed. We were focused on the generation rather than the identification of good models, believing that it is pointless trying to identify good models if they are not generated to begin with. Here we show that it is not necessary to identify good coarse-grained models for refinement into all-atom models. Our new method takes all of the coarse-grained models and refines them into all-atom models. By interlacing all-atom representation of models and coarse-grained sampling, <inline-formula><inline-graphic xlink:href="pone.0068954.e147.jpg"/></inline-formula> is able to enrich the proportion of near-native structures in the lowest energy all-atom models. Therefore, we have demonstrated here that the improved coarse-grained models can lead to better all-atom models without the need to identify good coarse-grained models.</p>
    <p><inline-formula><inline-graphic xlink:href="pone.0068954.e148.jpg"/></inline-formula> uses the lowest energy all-atom models for the estimation of fragment distributions, whereas <inline-formula><inline-graphic xlink:href="pone.0068954.e149.jpg"/></inline-formula> uses the lowest energy coarse-grained models for the estimation of fragment distributions. The estimated fragment distributions are used for the assembly of coarse-grained models in both methods. It is generally considered that the all-atom energy function is more accurate than the coarse-grained energy function. The all-atom models should be better than coarse-grained models given that the former has the benefit of complete side-chains taken into consideration. Therefore, it makes sense to derive probability mass functions of fragments from the refined all-atom models, and then to use these probabilities to guide the assembly of fragments. We have found that quality of coarse-grained models generated by <inline-formula><inline-graphic xlink:href="pone.0068954.e150.jpg"/></inline-formula> has been improved over those generated by <inline-formula><inline-graphic xlink:href="pone.0068954.e151.jpg"/></inline-formula> for the same target. By using this strategy, we benefit from the speed of the coarse-grained energy function during the sampling and of the accuracy of the all-atom energy which is helpful to guide the search in subsequent coarse-grained sampling rounds. Our results show the efficiency of this protocol for blind selection of models: at iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e152.jpg"/></inline-formula> the quality of the lowest energy model and of the closest structure to native out of the top <inline-formula><inline-graphic xlink:href="pone.0068954.e153.jpg"/></inline-formula> lowest energy models dramatically improves over iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e154.jpg"/></inline-formula>.</p>
    <p>The fragment assembly approach requires the generation of a huge number of models in order to produce a satisfactory solution. This is due to the stochastic nature of the sampling methods and to the inaccuracy of knowledge-based energy functions. The predictions are typically independent and modern technology allows massive parallelization of the computation. In this paper, we show that sharing information between these independent predictions can improve the quality of final results. The estimation of distribution over the fragment library relying on each fragment's frequency in low energy models allows <inline-formula><inline-graphic xlink:href="pone.0068954.e155.jpg"/></inline-formula> to significantly improve its performance in <inline-formula><inline-graphic xlink:href="pone.0068954.e156.jpg"/></inline-formula> iterations. The amount of communications remains small, and the effective parallelization ratio is around <inline-formula><inline-graphic xlink:href="pone.0068954.e157.jpg"/></inline-formula>. Our study suggests that the gain in performances is independent of the sampling method. Therefore, estimation of distribution can possibly increase the efficiency of any fragment-based approach.</p>
    <p>The computation time required for the implementation of the estimation of distribution algorithm, including the encoding and decoding of fragments, the calculation of the probability mass functions and the sampling of fragments with Roulette wheels, is a small fraction of the time used for the generation of each model. In a previous communication, we reported that <inline-formula><inline-graphic xlink:href="pone.0068954.e158.jpg"/></inline-formula> was 2.5 times slower than <inline-formula><inline-graphic xlink:href="pone.0068954.e159.jpg"/></inline-formula>. This was derived from the comparison of the times it took for the generation of equal numbers of coarse-grained models by both methods. The difference was due to our implementation of the simulated annealing and iterated hill climbing protocols in the coarse-grained model generation step is less efficient than the Monte Carlo search protocol in Rosetta. However, the extra time that <inline-formula><inline-graphic xlink:href="pone.0068954.e160.jpg"/></inline-formula> spent on the coarse-grained model generation did not produce better results than <inline-formula><inline-graphic xlink:href="pone.0068954.e161.jpg"/></inline-formula> when EDA was not used as shown in <xref ref-type="table" rid="pone-0068954-t004">Table 4</xref>. The quality of all-atom models from “iteration 1” without EDA was comparable or slightly worse than that of <inline-formula><inline-graphic xlink:href="pone.0068954.e162.jpg"/></inline-formula> for both first prediction and best prediction. It is only when EDA was used that the all-atom models were improved as shown from “iteration 4” in <xref ref-type="table" rid="pone-0068954-t004">Table 4</xref> compared to <inline-formula><inline-graphic xlink:href="pone.0068954.e163.jpg"/></inline-formula> as well as “iteration 1”. Since our goal is to evaluate the impact of EDA on the all-atom models due to the improved coarse-grained model sampling and the computing time required for the implementation of EDA is negligibly small, the same number of all-atoms models were generated when comparing the performance of <inline-formula><inline-graphic xlink:href="pone.0068954.e164.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e165.jpg"/></inline-formula> in this paper.</p>
    <p>The incorporation of information from prior rounds in an iterative process has been shown previously to be a powerful technique applicable to protein structure prediction. The principle of sequential stabilization applied to protein folding is such an example <xref rid="pone.0068954-Adhikari1" ref-type="bibr">[17]</xref>. The <inline-formula><inline-graphic xlink:href="pone.0068954.e166.jpg"/></inline-formula> method uses the statistics of folding trajectories garnered from prior rounds to bias subsequent sampling of backbone dihedral angles, tertiary contacts and hydrogen bonds. There were no fragments used in the <inline-formula><inline-graphic xlink:href="pone.0068954.e167.jpg"/></inline-formula> method.</p>
    <p>Even though <italic>Fragment-HMM</italic> and <inline-formula><inline-graphic xlink:href="pone.0068954.e168.jpg"/></inline-formula> both use iterative strategies and are similar in the sense that they use information on generated models to refine estimations, the two methods differ in many ways. First, whereas <italic>Fragment-HMM</italic> estimates a distribution over the torsion angles assuming it follows a bi-variate von Mises distribution, <inline-formula><inline-graphic xlink:href="pone.0068954.e169.jpg"/></inline-formula> estimates a distribution over the fragment library starting from a uniform distribution. Then, the sampling method is different: <italic>Fragment-HMM</italic> uses a position specific hidden Markov Model and <inline-formula><inline-graphic xlink:href="pone.0068954.e170.jpg"/></inline-formula> uses simulated annealing and iterated hill climbing. Also, even though <italic>Fragment-HMM</italic> initially uses fragments to estimate distributions at the first iteration, it doesn't use fragments during the sampling, unlike <inline-formula><inline-graphic xlink:href="pone.0068954.e171.jpg"/></inline-formula>. Finally, <italic>Fragment-HMM</italic> iterates until converging on one final model, whereas <inline-formula><inline-graphic xlink:href="pone.0068954.e172.jpg"/></inline-formula> generates a diverse set of models, out of which the best ones will be selected.</p>
    <p>The competition between global and local interactions plays a critical role in protein folding as well as structure prediction. This has been exploited for improving protein secondary and tertiary structure predictions using the principle of sequential stabilization <xref rid="pone.0068954-DeBartolo1" ref-type="bibr">[16]</xref>, <xref rid="pone.0068954-Adhikari1" ref-type="bibr">[17]</xref>. The identification of good quality fragments using the estimation of distribution algorithms implemented in <inline-formula><inline-graphic xlink:href="pone.0068954.e173.jpg"/></inline-formula> considers global interactions since the distributions are derived from the lowest energy all-atom models, whereas the initial fragment library is obtained by sequence homology that only takes into account local interactions of the residues within the fragment window. As the quality of all-atom models improve after each iteration, the global interactions are more accurately represented, which enables the good quality fragments being identified. However, unlike <inline-formula><inline-graphic xlink:href="pone.0068954.e174.jpg"/></inline-formula> which can identify novel interactions as they have been generated and bias sampling towards those novel interactions, <inline-formula><inline-graphic xlink:href="pone.0068954.e175.jpg"/></inline-formula> seeks only to bias existing fragments in the library, although novel fragments have been generated in the structure prediction process. The identification of novel fragments and bias the sampling towards good quality novel fragments will be an interesting direction for future exploration.</p>
    <p>Our study also showed some deficiencies in <inline-formula><inline-graphic xlink:href="pone.0068954.e176.jpg"/></inline-formula>'s sampling method. It fails to perform as well as <inline-formula><inline-graphic xlink:href="pone.0068954.e177.jpg"/></inline-formula> when no information is shared between the models (i.e. at iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e178.jpg"/></inline-formula>). This observation leaves room for improvement of our method. Beyond the improvement of our heuristic sampling methods, future work will focus on other ways of sharing information between predictions.</p>
  </sec>
  <sec sec-type="methods" id="s4">
    <title>Methods</title>
    <p><inline-formula><inline-graphic xlink:href="pone.0068954.e179.jpg"/></inline-formula> is a fragment-based protein structure prediction algorithm. Similarly to <inline-formula><inline-graphic xlink:href="pone.0068954.e180.jpg"/></inline-formula>
<xref rid="pone.0068954-LeaverFay1" ref-type="bibr">[7]</xref>, it has two stages. First, 9-mers (followed by 3-mers) are assembled together to create coarse-grained models. 9-mers and 3-mers are taken from a fragment library which is created from protein structures available in the PDB. The fragment library we used was constructed using <inline-formula><inline-graphic xlink:href="pone.0068954.e181.jpg"/></inline-formula>'s fragment picking method <xref rid="pone.0068954-Gront1" ref-type="bibr">[20]</xref>. When creating this library, proteins that shared more than 30% sequence identity with the target sequence were removed in order to remove any favorable bias. During the second stage, models are represented in atomic detail, and side chains are packed to minimize an all-atom energy function. The <inline-formula><inline-graphic xlink:href="pone.0068954.e182.jpg"/></inline-formula> Relax protocol was used to perform this operation.</p>
    <p><inline-formula><inline-graphic xlink:href="pone.0068954.e183.jpg"/></inline-formula>'s protocol is described in Table 5 (Algorithm 1). It is an iterative algorithm using the concept of EDA to gather information between initially independent predictions. The concept of EDA is used to influence the probability of selecting fragments from the library. A fraction of the final model set (25%) is generated at each iteration. At iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e184.jpg"/></inline-formula>, there is a uniform distribution over the library and every fragment has the same probability of being selected. At each iteration, a fraction of the lowest energy models (10%) is selected as a sample set. To compute the energy, all the models are relaxed in their all-atom representation via <inline-formula><inline-graphic xlink:href="pone.0068954.e185.jpg"/></inline-formula> Relax protocol. We keep track of the links between coarse-grained and all-atom representations of a model so that we can retrieve which fragments were used to generate which all-atom model. The probabilities of selecting fragments for insertion during subsequent iterations are modified according to the observed distribution of fragments used in the sample set. The sampling is influenced by the probability mass function defined over the fragment library. Still, each iteration starts with models in extended conformation. Models generated at a given iteration are stored in the final set and are not reused for subsequent iterations. <inline-formula><inline-graphic xlink:href="pone.0068954.e186.jpg"/></inline-formula> inherits its sampling engine from <inline-formula><inline-graphic xlink:href="pone.0068954.e187.jpg"/></inline-formula>
<xref rid="pone.0068954-Simoncini1" ref-type="bibr">[18]</xref>. The sampling is performed using an alternation of simulated annealing <xref rid="pone.0068954-Kirkpatrick1" ref-type="bibr">[21]</xref> and iterated hill climbing <xref rid="pone.0068954-Lourenco1" ref-type="bibr">[22]</xref>. The estimation of distribution is handled by the function <inline-formula><inline-graphic xlink:href="pone.0068954.e188.jpg"/></inline-formula> and is computed by the following formula:<disp-formula id="pone.0068954.e189"><graphic xlink:href="pone.0068954.e189.jpg" position="anchor" orientation="portrait"/></disp-formula>where <inline-formula><inline-graphic xlink:href="pone.0068954.e190.jpg"/></inline-formula> is the current iteration, <inline-formula><inline-graphic xlink:href="pone.0068954.e191.jpg"/></inline-formula> the probability of fragment <inline-formula><inline-graphic xlink:href="pone.0068954.e192.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0068954.e193.jpg"/></inline-formula> the observed frequency of fragment <inline-formula><inline-graphic xlink:href="pone.0068954.e194.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e195.jpg"/></inline-formula> a conservation rate (k = 0.6 in our experiments).</p>
    <table-wrap id="pone-0068954-t005" orientation="portrait" position="float">
      <object-id pub-id-type="doi">10.1371/journal.pone.0068954.t005</object-id>
      <label>Table 5</label>
      <caption>
        <title>Algorithm 1: <inline-formula><inline-graphic xlink:href="pone.0068954.e196.jpg"/></inline-formula> (comments are enclosed between braces).</title>
      </caption>
      <alternatives>
        <graphic id="pone-0068954-t005-5" xlink:href="pone.0068954.t005"/>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col align="left" span="1"/>
          </colgroup>
          <tbody>
            <tr>
              <td align="left" rowspan="1" colspan="1"><bold>input</bold> : <italic>s</italic> {sequence of the target protein}</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"><bold>input</bold> : <italic>n</italic> {number of minimization steps}</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"><bold>output</bold> : <italic>p</italic> {set of potential solutions}</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <inline-formula>
                  <inline-graphic xlink:href="pone.0068954.e197.jpg"/>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0068954.e198.jpg"/></inline-formula> {first iteration}</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <inline-formula>
                  <inline-graphic xlink:href="pone.0068954.e199.jpg"/>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"><bold>for</bold><italic>i</italic> in <inline-formula><inline-graphic xlink:href="pone.0068954.e200.jpg"/></inline-formula>
<bold>do</bold>
</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <inline-formula>
                  <inline-graphic xlink:href="pone.0068954.e201.jpg"/>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="pone.0068954.e202.jpg"/></inline-formula> {remaining iterations}</td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <inline-formula>
                  <inline-graphic xlink:href="pone.0068954.e203.jpg"/>
                </inline-formula>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>end for</bold>
              </td>
            </tr>
            <tr>
              <td align="left" rowspan="1" colspan="1">
                <bold>return</bold>
                <italic>p</italic>
              </td>
            </tr>
          </tbody>
        </table>
      </alternatives>
    </table-wrap>
    <p>The performance of <inline-formula><inline-graphic xlink:href="pone.0068954.e204.jpg"/></inline-formula> was measured on a dataset of <inline-formula><inline-graphic xlink:href="pone.0068954.e205.jpg"/></inline-formula> protein sequences, which were used in our previous studies <xref rid="pone.0068954-Simoncini1" ref-type="bibr">[18]</xref>. We performed <inline-formula><inline-graphic xlink:href="pone.0068954.e206.jpg"/></inline-formula> iterations of <inline-formula><inline-graphic xlink:href="pone.0068954.e207.jpg"/></inline-formula> for each target. The models used during the estimation phase (iterations <inline-formula><inline-graphic xlink:href="pone.0068954.e208.jpg"/></inline-formula>, <inline-formula><inline-graphic xlink:href="pone.0068954.e209.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="pone.0068954.e210.jpg"/></inline-formula>) are part of the final model set: <inline-formula><inline-graphic xlink:href="pone.0068954.e211.jpg"/></inline-formula> of the final models are generated at each iteration. The number of models generated (same for Rosetta and <inline-formula><inline-graphic xlink:href="pone.0068954.e212.jpg"/></inline-formula>) depends on the length of the target sequence: 250,000 for PDB codes 1m6t, 1iib, 1acf, 3chy and 300,000 for all other targets. C<italic><sub>α</sub></italic>RMSD calculations were performed with the <italic>ranker</italic> tool from Durandal <xref rid="pone.0068954-Berenger1" ref-type="bibr">[23]</xref>. All-atom RMSD, referred to as AARMSD in the following, were computed with the LSQKAB program from the CCP4 Software Suite <xref rid="pone.0068954-Winn1" ref-type="bibr">[24]</xref>, <xref rid="pone.0068954-Kabsch1" ref-type="bibr">[25]</xref>. <inline-formula><inline-graphic xlink:href="pone.0068954.e213.jpg"/></inline-formula> Version 3.2 was used for performance comparisons.</p>
  </sec>
  <sec id="s5">
    <title>Conclusions</title>
    <p>We present an estimation of distribution-based protein structure prediction algorithm which generates models with atomic details. The use of <inline-formula><inline-graphic xlink:href="pone.0068954.e214.jpg"/></inline-formula>'s fast Relax protocol in the iterative process of <inline-formula><inline-graphic xlink:href="pone.0068954.e215.jpg"/></inline-formula> allows the estimation of distributions over the protein fragment libraries according to an all-atom energy function. Energy distribution and C<italic><sub>α</sub></italic>RMSD to native histograms revealed that our protocol can reach lower energies and generate more accurate models after <inline-formula><inline-graphic xlink:href="pone.0068954.e216.jpg"/></inline-formula> iterations. A comparison with <inline-formula><inline-graphic xlink:href="pone.0068954.e217.jpg"/></inline-formula> AbInitioRelax shows that <inline-formula><inline-graphic xlink:href="pone.0068954.e218.jpg"/></inline-formula> is able to produce more accurate models and a higher percentage of near-native structures. The proportion of near-native structures in the low energy range also improves on a majority of targets. As a result, energy-driven blind selection of models is more efficient: <inline-formula><inline-graphic xlink:href="pone.0068954.e219.jpg"/></inline-formula> selects more accurate models when looking at the lowest or the top <inline-formula><inline-graphic xlink:href="pone.0068954.e220.jpg"/></inline-formula> lowest energies in our dataset on a benchmark of <inline-formula><inline-graphic xlink:href="pone.0068954.e221.jpg"/></inline-formula> protein targets.</p>
  </sec>
  <sec id="s6">
    <title>Authors' Information</title>
    <p><inline-formula><inline-graphic xlink:href="pone.0068954.e222.jpg"/></inline-formula> is released under the GNU General Public License. It can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www.riken.jp/zhangiru/software.html">http://www.riken.jp/zhangiru/software.html</ext-link>.</p>
  </sec>
  <sec sec-type="supplementary-material" id="s7">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0068954.s001">
      <label>Figure S1</label>
      <caption>
        <p>
          <bold>Models distribution as a function of C</bold>
          <bold>
            <italic>
              <sub>α</sub>
            </italic>
          </bold>
          <bold>RMSD to native for the lowest 500 energies in </bold>
          <inline-formula>
            <inline-graphic xlink:href="pone.0068954.e223.jpg"/>
          </inline-formula>
          <bold> and </bold>
          <inline-formula>
            <inline-graphic xlink:href="pone.0068954.e224.jpg"/>
          </inline-formula>
          <bold> datasets.</bold>
        </p>
        <p>(TIF)</p>
      </caption>
      <media xlink:href="pone.0068954.s001.tif">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0068954.s002">
      <label>Table S1</label>
      <caption>
        <p><bold>Comparison of all-atom models generated by </bold><inline-formula><inline-graphic xlink:href="pone.0068954.e225.jpg"/></inline-formula><bold> and </bold><inline-formula><inline-graphic xlink:href="pone.0068954.e226.jpg"/></inline-formula><bold>.</bold> 1‰ AARMSD is the average over the 1‰ lowest AARMSD to native models. Similarly, 1% AARMSD is the average over the 1% lowest AARMSD to native models. Best model is the single lowest AARMSD to native model. All mean differences are statistically significant with a confidence greater than 95% according to the Student's <italic>t</italic>-test.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0068954.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0068954.s003">
      <label>Table S2</label>
      <caption>
        <p><bold>Comparison of best all-atom models selected based on energy.</bold> The first prediction is the model with the lowest energy. The best prediction is the best model out of the five lowest energies. All results are shown as AARMSD to native structure.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0068954.s003.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0068954.s004">
      <label>Table S3</label>
      <caption>
        <p><bold>Blind selection ability of all-atom models generated by </bold><inline-formula><inline-graphic xlink:href="pone.0068954.e227.jpg"/></inline-formula><bold> at iterations </bold><inline-formula><inline-graphic xlink:href="pone.0068954.e228.jpg"/></inline-formula><bold> and </bold><inline-formula><inline-graphic xlink:href="pone.0068954.e229.jpg"/></inline-formula><bold>.</bold> The first prediction is the model with the lowest energy. The best prediction is the best model out of the five lowest energies. All results are shown as AARMSD to native structure. Models produced at iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e230.jpg"/></inline-formula> alone and iteration <inline-formula><inline-graphic xlink:href="pone.0068954.e231.jpg"/></inline-formula> alone are compared. For comparison, the columns <inline-formula><inline-graphic xlink:href="pone.0068954.e232.jpg"/></inline-formula> show the same data obtained from a sample of <inline-formula><inline-graphic xlink:href="pone.0068954.e233.jpg"/></inline-formula> models randomly picked from <inline-formula><inline-graphic xlink:href="pone.0068954.e234.jpg"/></inline-formula>'s prediction results.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0068954.s004.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <p>We thank RIKEN, Japan, for an allocation of computing resources on the RIKEN Integrated Cluster of Clusters (RICC) system. We are grateful to the Rosetta Commons Member Institutions (<ext-link ext-link-type="uri" xlink:href="http://www.rosettacommons.org/">http://www.rosettacommons.org/</ext-link>) for making Rosetta source code available. We thank Francois Berenger for providing efficient computational tools for statistical analysis. We thank Prof. Jeremy Tame for proofreading the manuscript.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="pone.0068954-Anfinsen1">
      <label>1</label>
      <mixed-citation publication-type="journal"><name><surname>Anfinsen</surname><given-names>CB</given-names></name>, <name><surname>Haber</surname><given-names>E</given-names></name>, <name><surname>Sela</surname><given-names>M</given-names></name>, <name><surname>White</surname><given-names>FH</given-names></name> (<year>1961</year>) <article-title>The kinetics of formation of native ribonuclease during oxidation of the reduced polypeptide chain</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>47</volume>: <fpage>1309</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">13683522</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Kim1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Kim</surname><given-names>DE</given-names></name>, <name><surname>Blum</surname><given-names>B</given-names></name>, <name><surname>Bradley</surname><given-names>P</given-names></name>, <name><surname>Baker</surname><given-names>D</given-names></name> (<year>2009</year>) <article-title>Sampling bottlenecks in de novo protein structure prediction</article-title>. <source>J Mol Biol</source>
<volume>393</volume>: <fpage>249</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">19646450</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Bowie1">
      <label>3</label>
      <mixed-citation publication-type="journal"><name><surname>Bowie</surname><given-names>JU</given-names></name>, <name><surname>Eisenberg</surname><given-names>D</given-names></name> (<year>1994</year>) <article-title>An evolutionary approach to folding small alpha-helical proteins that uses sequence information and an empirical guiding fitness function</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>91</volume>: <fpage>4436</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">8183927</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Simons1">
      <label>4</label>
      <mixed-citation publication-type="journal"><name><surname>Simons</surname><given-names>KT</given-names></name>, <name><surname>Kooperberg</surname><given-names>C</given-names></name>, <name><surname>Huang</surname><given-names>E</given-names></name>, <name><surname>Baker</surname><given-names>D</given-names></name> (<year>1997</year>) <article-title>Assembly of protein tertiary structures from fragments with similar local sequences using simulated annealing and Bayesian scoring functions</article-title>. <source>J Mol Biol</source>
<volume>268</volume>: <fpage>209</fpage>–<lpage>25</lpage>.<pub-id pub-id-type="pmid">9149153</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Simons2">
      <label>5</label>
      <mixed-citation publication-type="journal"><name><surname>Simons</surname><given-names>KT</given-names></name>, <name><surname>Bonneau</surname><given-names>R</given-names></name>, <name><surname>Ruczinski</surname><given-names>I</given-names></name>, <name><surname>Baker</surname><given-names>D</given-names></name> (<year>1999</year>) <article-title>Ab initio protein structure prediction of CASP III targets using ROSETTA</article-title>. <source>Proteins</source>
<volume>Suppl 3</volume>: <fpage>171</fpage>–<lpage>6</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0068954-Rohl1">
      <label>6</label>
      <mixed-citation publication-type="journal"><name><surname>Rohl</surname><given-names>CA</given-names></name>, <name><surname>Strauss</surname><given-names>CEM</given-names></name>, <name><surname>Misura</surname><given-names>KMS</given-names></name>, <name><surname>Baker</surname><given-names>D</given-names></name> (<year>2004</year>) <article-title>Protein structure prediction using Rosetta</article-title>. <source>Methods Enzymol</source>
<volume>383</volume>: <fpage>66</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">15063647</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-LeaverFay1">
      <label>7</label>
      <mixed-citation publication-type="journal"><name><surname>Leaver-Fay</surname><given-names>A</given-names></name>, <name><surname>Tyka</surname><given-names>M</given-names></name>, <name><surname>Lewis</surname><given-names>SM</given-names></name>, <name><surname>Lange</surname><given-names>OF</given-names></name>, <name><surname>Thompson</surname><given-names>J</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>ROSETTA3: an objectoriented software suite for the simulation and design of macromolecules</article-title>. <source>Methods Enzymol</source>
<volume>487</volume>: <fpage>545</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">21187238</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Kinch1">
      <label>8</label>
      <mixed-citation publication-type="journal"><name><surname>Kinch</surname><given-names>L</given-names></name>, <name><surname>Yong Shi</surname><given-names>S</given-names></name>, <name><surname>Cong</surname><given-names>Q</given-names></name>, <name><surname>Cheng</surname><given-names>H</given-names></name>, <name><surname>Liao</surname><given-names>Y</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>CASP9 assessment of free modeling target predictions</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>
<volume>79</volume>: <fpage>59</fpage>–<lpage>73</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0068954-Xu1">
      <label>9</label>
      <mixed-citation publication-type="journal"><name><surname>Xu</surname><given-names>D</given-names></name>, <name><surname>Zhang</surname><given-names>Y</given-names></name> (<year>2012</year>) <article-title>Ab initio protein structure assembly using continuous structure fragments and optimized knowledge-based force field</article-title>. <source>Proteins</source>
<volume>80</volume>: <fpage>1715</fpage>–<lpage>1735</lpage>.<pub-id pub-id-type="pmid">22411565</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Lee1">
      <label>10</label>
      <mixed-citation publication-type="journal"><name><surname>Lee</surname><given-names>J</given-names></name>, <name><surname>Kim</surname><given-names>SY</given-names></name>, <name><surname>Joo</surname><given-names>K</given-names></name>, <name><surname>Kim</surname><given-names>I</given-names></name>, <name><surname>Lee</surname><given-names>J</given-names></name> (<year>2004</year>) <article-title>Prediction of protein tertiary structure using PROFESY, a novel method based on fragment assembly and conformational space annealing</article-title>. <source>Proteins</source>
<volume>56</volume>: <fpage>704</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">15281124</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Chikenji1">
      <label>11</label>
      <mixed-citation publication-type="journal"><name><surname>Chikenji</surname><given-names>G</given-names></name>, <name><surname>Fujitsuka</surname><given-names>Y</given-names></name>, <name><surname>Takada</surname><given-names>S</given-names></name> (<year>2003</year>) <article-title>A reversible fragment assembly method for de novo protein structure prediction</article-title>. <source>The Journal of Chemical Physics</source>
<volume>119</volume>: <fpage>6895</fpage>–<lpage>6903</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0068954-Karplus1">
      <label>12</label>
      <mixed-citation publication-type="journal"><name><surname>Karplus</surname><given-names>K</given-names></name>, <name><surname>Karchin</surname><given-names>R</given-names></name>, <name><surname>Draper</surname><given-names>J</given-names></name>, <name><surname>Casper</surname><given-names>J</given-names></name>, <name><surname>Mandel-Gutfreund</surname><given-names>Y</given-names></name>, <etal>et al</etal> (<year>2003</year>) <article-title>Combining localstructure, fold-recognition, and new fold methods for protein structure prediction</article-title>. <source>Proteins</source>
<volume>53 Suppl 6</volume>: <fpage>491</fpage>–<lpage>6</lpage>.<pub-id pub-id-type="pmid">14579338</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Jones1">
      <label>13</label>
      <mixed-citation publication-type="journal"><name><surname>Jones</surname><given-names>DT</given-names></name>, <name><surname>McGuffin</surname><given-names>LJ</given-names></name> (<year>2003</year>) <article-title>Assembling novel protein folds from super-secondary structural fragments</article-title>. <source>Proteins</source>
<volume>53 Suppl 6</volume>: <fpage>480</fpage>–<lpage>5</lpage>.<pub-id pub-id-type="pmid">14579336</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Hamelryck1">
      <label>14</label>
      <mixed-citation publication-type="journal"><name><surname>Hamelryck</surname><given-names>T</given-names></name>, <name><surname>Kent</surname><given-names>JT</given-names></name>, <name><surname>Krogh</surname><given-names>A</given-names></name> (<year>2006</year>) <article-title>Sampling realistic protein conformations using local structural bias</article-title>. <source>PLoS Comput Biol</source>
<volume>2</volume>: <fpage>e131</fpage>.<pub-id pub-id-type="pmid">17002495</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Li1">
      <label>15</label>
      <mixed-citation publication-type="journal"><name><surname>Li</surname><given-names>SC</given-names></name>, <name><surname>Bu</surname><given-names>D</given-names></name>, <name><surname>Xu</surname><given-names>J</given-names></name>, <name><surname>Li</surname><given-names>M</given-names></name> (<year>2008</year>) <article-title>Fragment-HMM: a new approach to protein structure prediction</article-title>. <source>Protein Sci</source>
<volume>17</volume>: <fpage>1925</fpage>–<lpage>34</lpage>.<pub-id pub-id-type="pmid">18723665</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-DeBartolo1">
      <label>16</label>
      <mixed-citation publication-type="journal"><name><surname>DeBartolo</surname><given-names>J</given-names></name>, <name><surname>Colubri</surname><given-names>A</given-names></name>, <name><surname>Jha</surname><given-names>AK</given-names></name>, <name><surname>Fitzgerald</surname><given-names>JE</given-names></name>, <name><surname>Freed</surname><given-names>KF</given-names></name>, <etal>et al</etal> (<year>2009</year>) <article-title>Mimicking the folding pathway to improve homology-free protein structure prediction</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>106</volume>: <fpage>3734</fpage>–<lpage>3739</lpage>.<pub-id pub-id-type="pmid">19237560</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Adhikari1">
      <label>17</label>
      <mixed-citation publication-type="journal"><name><surname>Adhikari</surname><given-names>AN</given-names></name>, <name><surname>Freed</surname><given-names>KF</given-names></name>, <name><surname>Sosnick</surname><given-names>TR</given-names></name> (<year>2012</year>) <article-title>De novo prediction of protein folding pathways and structure using the principle of sequential stabilization</article-title>. <source>Proc Natl Acad Sci U S A</source>
<volume>109</volume>: <fpage>17442</fpage>–<lpage>17447</lpage>.<pub-id pub-id-type="pmid">23045636</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Simoncini1">
      <label>18</label>
      <mixed-citation publication-type="journal"><name><surname>Simoncini</surname><given-names>D</given-names></name>, <name><surname>Berenger</surname><given-names>F</given-names></name>, <name><surname>Shrestha</surname><given-names>R</given-names></name>, <name><surname>Zhang</surname><given-names>KYJ</given-names></name> (<year>2012</year>) <article-title>A probabilistic fragment-based protein structure prediction algorithm</article-title>. <source>PLoS One</source>
<volume>7</volume>: <fpage>e38799</fpage>.<pub-id pub-id-type="pmid">22829868</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Blow1">
      <label>19</label>
      <mixed-citation publication-type="journal"><name><surname>Blow</surname><given-names>DM</given-names></name>, <name><surname>Rossmann</surname><given-names>MG</given-names></name> (<year>1961</year>) <article-title>The single isomorphous replacement method</article-title>. <source>Acta Crystallographica</source>
<volume>14</volume>: <fpage>1195</fpage>–<lpage>1202</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0068954-Gront1">
      <label>20</label>
      <mixed-citation publication-type="journal"><name><surname>Gront</surname><given-names>D</given-names></name>, <name><surname>Kulp</surname><given-names>DW</given-names></name>, <name><surname>Vernon</surname><given-names>RM</given-names></name>, <name><surname>Strauss</surname><given-names>CEM</given-names></name>, <name><surname>Baker</surname><given-names>D</given-names></name> (<year>2011</year>) <article-title>Generalized fragment picking in Rosetta: design, protocols and applications</article-title>. <source>PLoS One</source>
<volume>6</volume>: <fpage>e23294</fpage>.<pub-id pub-id-type="pmid">21887241</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Kirkpatrick1">
      <label>21</label>
      <mixed-citation publication-type="journal"><name><surname>Kirkpatrick</surname><given-names>S</given-names></name>, <name><surname>Gelatt</surname><given-names>CD</given-names></name>, <name><surname>Vecchi</surname><given-names>MP</given-names></name> (<year>1983</year>) <article-title>Optimization by simulated annealing</article-title>. <source>Science</source>
<volume>220</volume>: <fpage>671</fpage>–<lpage>680</lpage>.<pub-id pub-id-type="pmid">17813860</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Lourenco1">
      <label>22</label>
      <mixed-citation publication-type="other">Lourenco H, Martin O, Stutzle T (2001) Iterated Local Search. In “Handbook of Metaheuristics”, Ed F Glover and G Kochenberger, ISORMS 57, p 321–353 (2002), Kluwer.</mixed-citation>
    </ref>
    <ref id="pone.0068954-Berenger1">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Berenger</surname><given-names>F</given-names></name>, <name><surname>Zhou</surname><given-names>Y</given-names></name>, <name><surname>Shrestha</surname><given-names>R</given-names></name>, <name><surname>Zhang</surname><given-names>KYJ</given-names></name> (<year>2011</year>) <article-title>Entropy-accelerated exact clustering of protein decoys</article-title>. <source>Bioinformatics</source>
<volume>27</volume>: <fpage>939</fpage>–<lpage>45</lpage>.<pub-id pub-id-type="pmid">21310747</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Winn1">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Winn</surname><given-names>MD</given-names></name>, <name><surname>Ballard</surname><given-names>CC</given-names></name>, <name><surname>Cowtan</surname><given-names>KD</given-names></name>, <name><surname>Dodson</surname><given-names>EJ</given-names></name>, <name><surname>Emsley</surname><given-names>P</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Overview of the CCP4 suite and current developments</article-title>. <source>Acta Crystallogr D Biol Crystallogr</source>
<volume>67</volume>: <fpage>235</fpage>–<lpage>42</lpage>.<pub-id pub-id-type="pmid">21460441</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0068954-Kabsch1">
      <label>25</label>
      <mixed-citation publication-type="journal"><name><surname>Kabsch</surname><given-names>W</given-names></name> (<year>1976</year>) <article-title>A solution of the best rotation to relate two sets of vectors</article-title>. <source>Acta Crystallographica</source>
<volume>A32</volume>: <fpage>922</fpage>–<lpage>923</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
