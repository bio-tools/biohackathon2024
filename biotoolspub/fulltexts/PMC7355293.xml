<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7355293</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa396</article-id>
    <article-id pub-id-type="publisher-id">btaa396</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Studies of Phenotypes and Clinical Applications</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Robust and accurate deconvolution of tumor populations uncovers evolutionary mechanisms of breast cancer metastasis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Tao</surname>
          <given-names>Yifeng</given-names>
        </name>
        <xref ref-type="aff" rid="btaa396-aff1">b1</xref>
        <xref ref-type="aff" rid="btaa396-aff2">b2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lei</surname>
          <given-names>Haoyun</given-names>
        </name>
        <xref ref-type="aff" rid="btaa396-aff1">b1</xref>
        <xref ref-type="aff" rid="btaa396-aff2">b2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Fu</surname>
          <given-names>Xuecong</given-names>
        </name>
        <xref ref-type="aff" rid="btaa396-aff3">b3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lee</surname>
          <given-names>Adrian V</given-names>
        </name>
        <xref ref-type="aff" rid="btaa396-aff4">b4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ma</surname>
          <given-names>Jian</given-names>
        </name>
        <xref ref-type="aff" rid="btaa396-aff1">b1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schwartz</surname>
          <given-names>Russell</given-names>
        </name>
        <xref ref-type="aff" rid="btaa396-aff1">b1</xref>
        <xref ref-type="aff" rid="btaa396-aff3">b3</xref>
        <xref ref-type="corresp" rid="btaa396-cor1"/>
        <!--<email>russells@andrew.cmu.edu</email>-->
      </contrib>
    </contrib-group>
    <aff id="btaa396-aff1"><label>b1</label><institution>Department of computational Biology, School of Computer Science, Carnegie Mellon University</institution>, Pittsburgh, PA 15213, <country country="US">USA</country></aff>
    <aff id="btaa396-aff2"><label>b2</label><institution>Joint Carnegie Mellon-University of Pittsburgh Ph.D. Program in Computational Biology</institution>, Pittsburgh, PA 15213, <country country="US">USA</country></aff>
    <aff id="btaa396-aff3"><label>b3</label><institution>Department of Biological Sciences, Carnegie Mellon University</institution>, Pittsburgh, PA 15213, <country country="US">USA</country></aff>
    <aff id="btaa396-aff4"><label>b4</label><institution>Department of Pharmacology and Chemical Biology, UPMC Hillman Cancer Center, Magee-Womens Research Institute</institution>, Pittsburgh, PA 15213, <country country="US">USA</country></aff>
    <author-notes>
      <corresp id="btaa396-cor1">To whom correspondence should be addressed. E-mail: <email>russells@andrew.cmu.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-07-13">
      <day>13</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>13</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>Suppl 1</issue>
    <issue-title>ISMB 2020 Proceedings</issue-title>
    <fpage>i407</fpage>
    <lpage>i416</lpage>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa396.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Cancer develops and progresses through a clonal evolutionary process. Understanding progression to metastasis is of particular clinical importance, but is not easily analyzed by recent methods because it generally requires studying samples gathered years apart, for which modern single-cell sequencing is rarely an option. Revealing the clonal evolution mechanisms in the metastatic transition thus still depends on unmixing tumor subpopulations from bulk genomic data.</p>
      </sec>
      <sec id="s2">
        <title>Methods</title>
        <p>We develop a novel toolkit called robust and accurate deconvolution (RAD) to deconvolve biologically meaningful tumor populations from multiple transcriptomic samples spanning the two progression states. RAD uses gene module compression to mitigate considerable noise in RNA, and a hybrid optimizer to achieve a robust and accurate solution. Finally, we apply a phylogenetic algorithm to infer how associated cell populations adapt across the metastatic transition via changes in expression programs and cell-type composition.</p>
      </sec>
      <sec id="s3">
        <title>Results</title>
        <p>We validated the superior robustness and accuracy of RAD over alternative algorithms on a real dataset, and validated the effectiveness of gene module compression on both simulated and real bulk RNA data. We further applied the methods to a breast cancer metastasis dataset, and discovered common early events that promote tumor progression and migration to different metastatic sites, such as dysregulation of <italic>ECM-receptor</italic>, <italic>focal adhesion</italic> and <italic>PI3k-Akt</italic> pathways.</p>
      </sec>
      <sec id="s4">
        <title>Availability and implementation</title>
        <p>The source code of the RAD package, models, experiments and technical details such as parameters, is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/CMUSchwartzLab/RAD">https://github.com/CMUSchwartzLab/RAD</ext-link>.</p>
      </sec>
      <sec id="s6">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NIH</institution>
            <institution-id institution-id-type="DOI">10.13039/100000002</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>R21CA216452</award-id>
        <award-id>R01HG010589</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Pennsylvania Department of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100004897</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>#4100070287</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Mario Lemieux Foundation</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Breast Cancer Alliance</institution>
            <institution-id institution-id-type="DOI">10.13039/100001513</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>AWS Machine Learning Research Awards</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Center for Machine Learning and Health Fellowship in Digital Health</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Pennsylvania Department of Health</institution>
            <institution-id institution-id-type="DOI">10.13039/100004897</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Breast cancer is the second most common cause of death in women (<xref rid="btaa396-B22" ref-type="bibr">Lin <italic>et al.</italic>, 2004</xref>), with metastasis the dominant mechanism by which breast cancer results in mortality (<xref rid="btaa396-B32" ref-type="bibr">Riihimäki <italic>et al.</italic>, 2018</xref>). Although the overall survival of breast cancer patients has improved substantially in recent decades, there are usually limited treatment options once metastasis has occurred (<xref rid="btaa396-B12" ref-type="bibr">Guan, 2015</xref>). Understanding how tumors evolve, and especially how they evolve across the metastatic transition, is thus crucial in further understanding and preventing cancer mortality.</p>
    <p>Cancers develop through a process of clonal evolution, in which populations of genetically distinct tumor cells evolve and adapt functionally coordinate with interaction with various non-cancerous stromal cell populations (<xref rid="btaa396-B5" ref-type="bibr">Beerenwinkel <italic>et al.</italic>, 2016</xref>). Metastasis occurs when a population of tumor cells escape normal controls on cell growth, migrate to a distant site and successfully establish themselves in that site and continue to develop (<xref rid="btaa396-B32" ref-type="bibr">Riihimäki <italic>et al.</italic>, 2018</xref>). Because of its medical importance, the metastatic transition has been the focus of intensive prior study (<xref rid="btaa396-B27" ref-type="bibr">Nguyen <italic>et al.</italic>, 2009</xref>). It is particularly important to understand this process at a clonal level if we wish to identify those tumors at particular risk for metastasis and find markers and potential therapeutic targets specific to their metastatic clones (<xref rid="btaa396-B38" ref-type="bibr">Tao <italic>et al.</italic>, 2019a</xref>).</p>
    <p>Previous research has revealed multiple recurrent features common to breast cancer metastasis, such as dramatic perturbations in the <italic>PI3K-Akt</italic>, <italic>RET</italic> and <italic>ErbB</italic> pathways based on the paired transcriptome of breast primary and brain metastatic sites (<xref rid="btaa396-B30" ref-type="bibr">Priedigkeit <italic>et al.</italic>, 2017b</xref>; <xref rid="btaa396-B41" ref-type="bibr">Vareslija <italic>et al.</italic>, 2018</xref>). Methods for tumor phylogenetics (<xref rid="btaa396-B34" ref-type="bibr">Schwartz and Schäffer, 2017</xref>), i.e. inference of evolutionary trees on tumor cell populations, have proven powerful for characterizing genomics of progression processes, including in metastatic progression. Past research has shown that deconvolution and phylogenetic methods allow one to infer evolutionary trajectories in breast cancer brain metastases from either bulk genomic or transcriptomic alterations (<xref rid="btaa396-B7" ref-type="bibr">Brastianos <italic>et al.</italic>, 2015</xref>; <xref rid="btaa396-B18" ref-type="bibr">Körber <italic>et al.</italic>, 2019</xref>; <xref rid="btaa396-B39" ref-type="bibr">Tao <italic>et al.</italic>, 2019b</xref>). However, much remains unknown, including whether one can reliably identify those clones most susceptible to metastasis and whether the premetastatic genomics of these clones or their subsequent evolutionary trajectories influence their eventual metastatic sites (brain, ovary, bone and gastrointestinal tract).</p>
    <p>Much of the current advances in tumor phylogenetics are coming from single-cell sequencing technologies, such as single-cell RNA-Seq (scRNA) and single-cell DNA-Seq (scDNA), which allow one to characterize clonal heterogeneity with precision (<xref rid="btaa396-B24" ref-type="bibr">Navin, 2015</xref>). In practice, though, these kinds of data are rarely available for matched primary and metastatic samples. Such studies depend on analyzing paired samples generally gathered years apart, where primary tumors are generally archived and no longer amenable to single-cell analysis. While rapid autopsy studies (<xref rid="btaa396-B1" ref-type="bibr">Alsop <italic>et al.</italic>, 2016</xref>) are beginning to recruit cohorts in which data can be gathered promptly at both initial diagnosis and mortality, the difficulty of recruiting subjects and cost of gathering comprehensive single-cell data makes it still prohibitive to gather paired single-cell data for reasonable sizes of study cohort. In contrast, matched bulk data, e.g. RNA-Seq of both breast primary and metastatic samples, are easier to acquire when one or both samples have been archived (<xref rid="btaa396-B46" ref-type="bibr">Zhu <italic>et al.</italic>, 2019</xref>). Inferring clonal evolution from paired archived samples is thus still dependent on an older class of method that sought to study cancer at the clonal level through deconvolution (unmixing) of genomic data from bulk samples (<xref rid="btaa396-B4" ref-type="bibr">Beerenwinkel <italic>et al.</italic>, 2005</xref>).</p>
    <p>Here we build on our past work in developing deconvolution methods for understanding the metastatic transition (<xref rid="btaa396-B39" ref-type="bibr">Tao <italic>et al.</italic>, 2019b</xref>). Our contributions in this work are twofold. Methodologically, we proposed and developed a tool kit called robust and accurate deconvolution (RAD), the core algorithm of which takes bulk RNA as input, and infers the expressions and proportions of groups of associated tumor cells, which we denote <italic>cell communities</italic>. We refer readers to Section 2.2 and Section 3.3 for the major novelty and advancement of RAD, and the differences between RAD and previous deconvolution algorithms such as NMF (<xref rid="btaa396-B19" ref-type="bibr">Lee and Seung, 2000</xref>), Geometric Unmixing (<xref rid="btaa396-B35" ref-type="bibr">Schwartz and Shackney, 2010</xref>), LinSeed (<xref rid="btaa396-B42" ref-type="bibr">Zaitsev <italic>et al.</italic>, 2019</xref>) and NND (<xref rid="btaa396-B39" ref-type="bibr">Tao <italic>et al.</italic>, 2019b</xref>). We show that RAD can automatically identify correct numbers of cell populations and identify perturbed biomarkers, such as cancer pathways. We validated its superiority over alternative deconvolution algorithms through comprehensive validations on both simulated and real datasets. Biologically, we applied the RAD algorithm to transcriptomic data from matched breast cancer primary and metastatic samples (<xref rid="btaa396-B3" ref-type="bibr">Basudan <italic>et al.</italic>, 2019</xref>; Priedigkeit <italic>et al.</italic>, <xref rid="btaa396-B29" ref-type="bibr">2017a,b</xref>; <xref rid="btaa396-B46" ref-type="bibr">Zhu <italic>et al.</italic>, 2019</xref>), extending our prior analysis of brain metastasis specifically (<xref rid="btaa396-B39" ref-type="bibr">Tao <italic>et al.</italic>, 2019b</xref>) to consider variations across multiple metastatic sites. We further applied a refined phylogeny inference algorithm to trace the evolutionary trajectories from the primary tumor to different metastatic sites (<xref rid="btaa396-B39" ref-type="bibr">Tao <italic>et al.</italic>, 2019b</xref>). Our analysis showed that although the breast tumors of different metastatic types encompass heterogeneous and distinct cell populations, there exist common patterns of perturbed pathways detected at the early stage of primary breast cancer, suggesting that our framework might shed light on early diagnostic and treatment options.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Overview</title>
      <p><xref ref-type="fig" rid="btaa396-F1">Figure 1</xref> illustrates the general approach for unmixing bulk RNA from paired breast cancer metastatic samples and inferring underlying tumor evolutionary processes. To reduce the noise of bulk RNA, we first compress the expression levels of individual genes into the modules using external knowledge bases (<xref ref-type="fig" rid="btaa396-F1">Fig. 1a;</xref> Section 2.2.2). We then apply a novel RAD algorithm to unmix the compressed expression data into expression profiles and fractions of individual cell communities (<xref ref-type="fig" rid="btaa396-F1">Fig. 1b;</xref> Section 2.2). Finally, we infer the evolutionary trajectories of the unmixed tumor communities. We then analyze perturbed biomarkers, such as activity of cancer-related regulatory pathways, during tumor metastasis (<xref ref-type="fig" rid="btaa396-F1">Fig. 1c;</xref> Section 2.3).
</p>
      <fig id="btaa396-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>Illustration of discovering underlying cancer evolutionary mechanisms of metastatic progression using the proposed computational models. (<bold>a</bold>) Gene module compression. Genes from the same modules have similar coexpression patterns. By mapping the individual genes into modules, we can get a cleaner representation of bulk RNA data. (<bold>b</bold>) Deconvolution of bulk RNA. Using the RAD algorithm, we unmixed the bulk data into two matrices: expression matrix and fraction matrix, which represent the expression profile and fractions of individual cell populations. (<bold>c</bold>) Phylogeny inference of cell communities. The inferred phylogeny represents the most likely evolutionary trajectories of cell populations</p>
        </caption>
        <graphic xlink:href="btaa396f1"/>
      </fig>
      <p>Note that our overall goal is to deconvolve tumor <italic>cell communities</italic> (<xref rid="btaa396-B39" ref-type="bibr">Tao <italic>et al.</italic>, 2019b</xref>), as opposed to necessarily single cells, and describe their evolution across the metastatic transition. A cell community is defined as one or more cell types with potentially distinct expression profiles that share common mixture proportions across samples, indicative of their possible interaction or coassociation in the tumor. For example a set of immunogenic tumor clones and the immune cell types infiltrating them may form a community exhibiting an overall expression pattern that is a mixture of those of its constituent cell types. Although our deconvolution algorithm can identify correct numbers of distinct clones when they are mixed in distinct proportions in different samples (Section 3.2), it is more proper to interpret results as describing cell communities when the sample size is small or when tumor cells may associate or coevolve with their stroma (<xref rid="btaa396-B5" ref-type="bibr">Beerenwinkel <italic>et al.</italic>, 2016</xref>).</p>
    </sec>
    <sec>
      <title>2.2 RAD: toolkit for robust and accurate deconvolution</title>
      <p>We proposed and developed the toolkit called RAD. RAD is a set of tools that solves the problem of (i) estimating the number of cell communities from bulk RNA, (ii) unmixing the cell communities from bulk data and (iii) inferring other biomarkers such as pathways from the deconvolved communities. <xref rid="btaa396-T1" ref-type="table">Table 1</xref> shows an example of applying RAD to a common RNA deconvolution problem.
</p>
      <table-wrap id="btaa396-T1" orientation="portrait" position="float">
        <label>Table 1.</label>
        <caption>
          <p>Functions in the RAD package</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="char" char="" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Function</th>
              <th rowspan="1" colspan="1">Demo code</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>compress_module</monospace>
              </td>
              <td rowspan="1" colspan="1">
                <monospace>B_M = compress_module(B, module)</monospace>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>estimate_number</monospace>
              </td>
              <td rowspan="1" colspan="1">
                <monospace>k = estimate_number(B_M)</monospace>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>estimate_clones</monospace>
              </td>
              <td rowspan="1" colspan="1">
                <monospace>C_M, F = estimate_clones(B_M, k)</monospace>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">
                <monospace>estimate_marker</monospace>
              </td>
              <td rowspan="1" colspan="1">
                <monospace>C_P = estimate_marker(B_P, F)</monospace>
              </td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td rowspan="1" colspan="1">
                <monospace>C = estimate_marker(B, F)</monospace>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="tblfn1">
            <p><italic>Note</italic>: The five-line demo shows a typical application of RAD package, which takes as input the bulk RNA data <inline-formula id="IE1"><mml:math id="IM1"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula>, bulk marker data <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and gene module knowledge, and outputs deconvolved RNA <inline-formula id="IE3"><mml:math id="IM3"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula>, biomarker <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, and fractions <inline-formula id="IE5"><mml:math id="IM5"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula>.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>RAD is different from the traditional non-negative matrix factorization (NMF; <xref rid="btaa396-B19" ref-type="bibr">Lee and Seung, 2000</xref>) widely used in this problem domain. First, RAD considers a biologically meaningful unmixing problem (Section 2.2.1), which has additional constraints that make it much harder to solve than the general NMF problem. Although there exist many NMF variants that consider different regularizations, such as NMF with <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-norm (<xref rid="btaa396-B36" ref-type="bibr">Shen <italic>et al.</italic>, 2014</xref>) and sparseness (<xref rid="btaa396-B15" ref-type="bibr">Hoyer, 2004</xref>), these NMF algorithms mainly consider the prior of data distribution instead of the biological feasibility. As far as we know, the only algorithm that solves this specific deconvolution problem is our gradient descent-based NND method (<xref rid="btaa396-B39" ref-type="bibr">Tao <italic>et al.</italic>, 2019b</xref>). Algorithms derived from the widely used multiplicative update (MU) rules do not necessarily guarantee the convergence or accuracy in this new scenario (<xref rid="btaa396-B20" ref-type="bibr">Lei <italic>et al.</italic>, 2020a</xref>,<xref rid="btaa396-B21" ref-type="bibr">b</xref>), a problem that RAD tackles by using a hybrid solver. Second, NMF is fragile since the unmixed matrices may be distinct given a different initialization seed. In contrast, RAD uses both the prior knowledge of gene modules and the minimum similarity criteria to generate robust and reliable output. Finally, RAD is a toolkit that aims to resolve a series of problems in the deconvolution of bulk RNA, whereas NMF mainly focuses on optimizing the objective function efficiently.</p>
      <sec>
        <title>2.2.1 Deconvolution problem formulation</title>
        <p>Given a non-negative bulk RNA-Seq expression matrix <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, where each row <italic>i</italic> is a gene, each column <italic>j</italic> is a tumor sample, our goal is to infer an expression profile matrix <inline-formula id="IE8"><mml:math id="IM8"><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, where each column <italic>l</italic> is a cell community, and a fraction matrix <inline-formula id="IE9"><mml:math id="IM9"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, such that: <inline-formula id="IE10"><mml:math id="IM10"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo>≈</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">F</mml:mi></mml:mrow></mml:math></inline-formula>. To be more concrete, we formulated the problem, as in our prior work (<xref rid="btaa396-B39" ref-type="bibr">Tao <italic>et al.</italic>, 2019b</xref>), as follows:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1"><mml:mrow><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">F</mml:mi></mml:mrow></mml:munder><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mtext>Fr</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E2"><label>(2)</label><mml:math id="M2"><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo>.</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E3"><label>(3)</label><mml:math id="M3"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E4"><label>(4)</label><mml:math id="M4"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE11"><mml:math id="IM11"><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mtext>Fr</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is the Frobenius norm. The column-wise normalization of <xref ref-type="disp-formula" rid="E4">Equation (4)</xref> ensures that the total fractions of all cell communities in the same sample sum up to one. This optimization problem is non-convex and non-trivial to resolve. In addition, the bulk data <inline-formula id="IE12"><mml:math id="IM12"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> is noisy, so even an optimal solution does not necessarily fit the ground truth <inline-formula id="IE13"><mml:math id="IM13"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> and <inline-formula id="IE14"><mml:math id="IM14"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula>. Our overall approach to solve for this problem consists of three phases—a randomized warm-start procedure to develop an initial guess as to a solution, coordinate descent optimization to improve fit to the objective, and a minimum similarity selection procedure to identify the most informative partitioning among a set of random restarts—as described in more detail below.</p>
      </sec>
      <sec>
        <title>2.2.2 Knowledge-driven gene module compression</title>
        <p>By default, RAD unmixes the raw expression matrix <inline-formula id="IE15"><mml:math id="IM15"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> directly. However, gene module compression (compress_module) is a suggested option if we have prior information on what genes belong to the same gene modules. Gene expressions within the same gene modules are highly correlated, which can be explained by their shared genomic context, similar biological functions, or participation in the same interaction network (<xref rid="btaa396-B40" ref-type="bibr">Tao <italic>et al.</italic>, 2020</xref>). Intuitively, we can compress the noisy expressions of individual genes into cleaner ‘gene modules’ (<xref rid="btaa396-B8" ref-type="bibr">Desmedt <italic>et al.</italic>, 2008</xref>; <xref rid="btaa396-B28" ref-type="bibr">Park <italic>et al.</italic>, 2009</xref>), to reduce the signal-to-noise ratio (SNR).</p>
        <p>Here we utilize the functional annotation clustering tool in DAVID to group the top 3000 most varied genes into around 100–200 modules (<xref rid="btaa396-B16" ref-type="bibr">Huang <italic>et al.</italic>, 2009</xref>), where multiple external knowledge databases are used to facilitate the clustering. The gene expressions within the same module are averaged to get the module expression value. The resulting bulk compressed module matrix is <inline-formula id="IE16"><mml:math id="IM16"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, where <italic>m</italic><sub>1</sub> is the total number of modules.</p>
        <p>The gene module compression in our work is knowledge-driven, which is reliable even when only limited tumor samples are available, in contrast to prior work using data-driven clustering of coexpressed genes (<xref rid="btaa396-B42" ref-type="bibr">Zaitsev <italic>et al.</italic>, 2019</xref>), which is more dependent on large sample sizes. We validate the superiority of knowledge-driven compression over data-driven compression on a real dataset (<xref ref-type="fig" rid="btaa396-F4">Fig. 4b and e</xref>), and the effect of such knowledge-driven compression (<xref ref-type="fig" rid="btaa396-F4">Fig. 4d and e</xref>) in Section 3.3.</p>
      </sec>
      <sec>
        <title>2.2.3 Core algorithm of RAD</title>
        <p>The core algorithm of RAD (estimate_clones) unmixes the compressed bulk RNA data <inline-formula id="IE17"><mml:math id="IM17"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> into expression profiles <inline-formula id="IE18"><mml:math id="IM18"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and fractions <inline-formula id="IE19"><mml:math id="IM19"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> of individual communities. The method works in three phases—warm-start, coordinate descent and minimum similarity selection—to achieve accuracy and robustness. RAD can directly unmix the original bulk RNA data <inline-formula id="IE20"><mml:math id="IM20"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> as well, and we will remove the subscript <sub><italic>M</italic></sub> in this section for simplicity.</p>
        <p><italic>Warm-start</italic> The warm-start phase borrows its idea from the MU rules for the general NMF problem (<xref rid="btaa396-B19" ref-type="bibr">Lee and Seung, 2000</xref>). It first randomly initializes <inline-formula id="IE21"><mml:math id="IM21"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> and <inline-formula id="IE22"><mml:math id="IM22"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> from the uniform distribution <italic>U</italic>(0, 1) then iterates the following loop until the objective function converges:
<disp-formula id="E5"><label>(5)</label><mml:math id="M5"><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mo>←</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>⊙</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>⊺</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⊘</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">F</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>⊺</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E6"><label>(6)</label><mml:math id="M6"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi><mml:mo>←</mml:mo><mml:mi mathvariant="bold">F</mml:mi><mml:mo>⊙</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>⊺</mml:mo></mml:msup><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⊘</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>⊺</mml:mo></mml:msup><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E7"><label>(7)</label><mml:math id="M7"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>←</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>/</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>′</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE23"><mml:math id="IM23"><mml:mo>⊙</mml:mo></mml:math></inline-formula> and <inline-formula id="IE24"><mml:math id="IM24"><mml:mo>⊘</mml:mo></mml:math></inline-formula> are element-wise product and element-wise division operators. We add an additional MU step, <xref ref-type="disp-formula" rid="E7">Equation (7)</xref>, to the original two MU steps, <xref ref-type="disp-formula" rid="E5">Equations (5)</xref> and <xref ref-type="disp-formula" rid="E6">(6)</xref>, to satisfy the constraint <xref ref-type="disp-formula" rid="E4">Equation (4)</xref>. This deteriorates the convergence guarantee of the original MU rules. Therefore, we have to stop the update once the objective stops decreasing. However, the revised MU rules in the warm-start phase still have the advantage of fast convergence even when the initial values of <inline-formula id="IE25"><mml:math id="IM25"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> and <inline-formula id="IE26"><mml:math id="IM26"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> are far from optimal solution, and can provide a reasonable starting point for the second phase.</p>
        <p><italic>Coordinate descent</italic> After the warm-start phase, the coordinate descent phase optimizes over the two coordinates <inline-formula id="IE27"><mml:math id="IM27"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> and <inline-formula id="IE28"><mml:math id="IM28"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> iteratively until the objective function converges:
<disp-formula id="E8"><label>(8)</label><mml:math id="M8"><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mo>←</mml:mo><mml:mi>arg</mml:mi><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:munder><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mtext>Fr</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E9"><label>(9)</label><mml:math id="M9"><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo>.</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mrow><mml:mtext>il</mml:mtext></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">m</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="normal">l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">k</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>and
<disp-formula id="E10"><label>(10)</label><mml:math id="M10"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi><mml:mo>←</mml:mo><mml:mi>arg</mml:mi><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:munder><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mtext>Fr</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E11"><label>(11)</label><mml:math id="M11"><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mo>.</mml:mo><mml:mi mathvariant="normal">t</mml:mi><mml:mo>.</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E12"><label>(12)</label><mml:math id="M12"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>Although the original optimization problem, <xref ref-type="disp-formula" rid="E1">Equations (1</xref>–<xref ref-type="disp-formula" rid="E4">4)</xref>, is non-convex, the two subproblems of the coordinate descent are convex and can be solved using general quadratic programming. We used the Python package cvxopt (<xref rid="btaa396-B2" ref-type="bibr">Andersen <italic>et al.</italic>, 2011</xref>). The coordinate descent phase can usually further reduce the loss function by around 5–30% after the warm-start phase, as evaluated on a real dataset GSE19830 (Section 2.5.2; <xref rid="btaa396-B37" ref-type="bibr">Shen-Orr <italic>et al.</italic>, 2010</xref>).</p>
        <p><italic>Minimum similarity selection</italic> Since the deconvolution problem, <xref ref-type="disp-formula" rid="E1 E2 E3 E4">Equations (1–4)</xref>, is non-convex, different initialization values of <inline-formula id="IE29"><mml:math id="IM29"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> and <inline-formula id="IE30"><mml:math id="IM30"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> may converge to distinct solutions. We reran the initialization, warm-start and coordinate descent for multiple times (10 in our experiments) and selected the solution with minimum similarity of expression profiles. We defined the unnormalized cosine similarity of a specific solution <inline-formula id="IE31"><mml:math id="IM31"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> as:
<disp-formula id="E13"><label>(13)</label><mml:math id="M13"><mml:mrow><mml:mtext>cosim</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>′</mml:mo><mml:mo>=</mml:mo><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mrow><mml:mo>·</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mo>⊺</mml:mo></mml:msubsup></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mrow><mml:mo>·</mml:mo><mml:mi>l</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>Biologically, the use of minimum similarity is motivated by the assumption that individual cell communities should be distinct from each other. Minimum similarity performs slightly better than minimum loss on GSE19830 dataset, although the two criteria often overlap empirically.</p>
      </sec>
      <sec>
        <title>2.2.4 Estimating number of communities</title>
        <p>The core algorithm of RAD infers the <inline-formula id="IE32"><mml:math id="IM32"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> and <inline-formula id="IE33"><mml:math id="IM33"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> from <inline-formula id="IE34"><mml:math id="IM34"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> given a specific number of communities <italic>k</italic>, which in practice is unknown to us in advance. RAD estimates the number of cell components (estimate_ number) through cross-validation (CV). The estimated/optimal <italic>k</italic> reflects the trade-off between model bias and the variance.</p>
        <p>We take a 20-fold CV as an example: In each fold, 5% of the elements in <inline-formula id="IE35"><mml:math id="IM35"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> are unseen at the time of training/optimization. At the time of test, the loss is calculated only on these unseen 5% elements. Technically, we realized it by utilizing the mask matrices with the same shape of <inline-formula id="IE36"><mml:math id="IM36"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula>: <inline-formula id="IE37"><mml:math id="IM37"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mtext>test</mml:mtext></mml:mrow></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (<inline-formula id="IE38"><mml:math id="IM38"><mml:mi mathvariant="bold">M</mml:mi></mml:math></inline-formula> is <inline-formula id="IE39"><mml:math id="IM39"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mtext>train</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>. We omit the subscript <inline-formula id="IE40"><mml:math id="IM40"><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mtext>train</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> for simplicity.), and <inline-formula id="IE41"><mml:math id="IM41"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mtext>test</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. <inline-formula id="IE42"><mml:math id="IM42"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is blocked when the corresponding position of <inline-formula id="IE43"><mml:math id="IM43"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>. In each fold, 5% of the <inline-formula id="IE44"><mml:math id="IM44"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mtext>test</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> are 1’s, and 95% of the <inline-formula id="IE45"><mml:math id="IM45"><mml:mi mathvariant="bold">M</mml:mi></mml:math></inline-formula> are 1’s. Note that the positions of the 1’s and 0’s are randomly distributed across the whole matrices <inline-formula id="IE46"><mml:math id="IM46"><mml:mi mathvariant="bold">M</mml:mi></mml:math></inline-formula> and <inline-formula id="IE47"><mml:math id="IM47"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">M</mml:mi></mml:mrow><mml:mrow><mml:mtext>test</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>, rather than column-wise or row-wise.</p>
        <p>At the time of validation, we can calculate the ‘normalized MSE’ as the CV error on validation set:
<disp-formula id="E14"><label>(14)</label><mml:math id="M14"><mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mtext>test</mml:mtext></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>C</mml:mi></mml:mstyle><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mover accent="true"><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>F</mml:mi></mml:mstyle><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>/</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>M</mml:mi></mml:mstyle></mml:mrow><mml:mrow><mml:mtext>test</mml:mtext></mml:mrow></mml:msub><mml:mo>⊙</mml:mo><mml:mstyle mathvariant="bold" mathsize="normal"><mml:mi>B</mml:mi></mml:mstyle></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></disp-formula></p>
        <p>At the time of training, we want to optimize the following objective function with the same constraints to <xref ref-type="disp-formula" rid="E2 E3 E4">Equations (2–4)</xref>:
<disp-formula id="E15"><label>(15)</label><mml:math id="M15"><mml:mrow><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">F</mml:mi></mml:mrow></mml:munder><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mi mathvariant="bold">M</mml:mi><mml:mo>⊙</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mtext>Fr</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>There exist corresponding algorithms for MU warm-start and coordinate descent phases when a mask <inline-formula id="IE48"><mml:math id="IM48"><mml:mi mathvariant="bold">M</mml:mi></mml:math></inline-formula> exists. The MU rules to optimize the masked objective, <xref ref-type="disp-formula" rid="E15">Equation (15)</xref>, is similar to <xref ref-type="disp-formula" rid="E5">Equations (5</xref>–<xref ref-type="disp-formula" rid="E7">7)</xref>. However, <xref ref-type="disp-formula" rid="E5">Equations (5)</xref> and <xref ref-type="disp-formula" rid="E6">(6)</xref> are revised to the following rules:
<disp-formula id="E16"><label>(16)</label><mml:math id="M16"><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mo>←</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>⊙</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">M</mml:mi><mml:mo>⊙</mml:mo><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>⊺</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⊘</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">M</mml:mi><mml:mo>⊙</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">F</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>⊺</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula><disp-formula id="E17"><label>(17)</label><mml:math id="M17"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi><mml:mo>←</mml:mo><mml:mi mathvariant="bold">F</mml:mi><mml:mo>⊙</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>⊺</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">M</mml:mi><mml:mo>⊙</mml:mo><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⊘</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>⊺</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">M</mml:mi><mml:mo>⊙</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">F</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>The coordinate descent iterations of the masked version are the same to the unmasked version, <xref ref-type="disp-formula" rid="E8 E9 E10 E11 E12">Equations (8–12)</xref>, except that <inline-formula id="IE49"><mml:math id="IM49"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="E8">Equations (8)</xref> and <xref ref-type="disp-formula" rid="E10">(10)</xref> are replaced with <inline-formula id="IE50"><mml:math id="IM50"><mml:mrow><mml:mi mathvariant="bold">M</mml:mi><mml:mo>⊙</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo>−</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. The subproblems of the two masked coordinate descent steps are still quadratic programming problems.</p>
      </sec>
      <sec>
        <title>2.2.5 Cancer-related pathway annotation</title>
        <p>We further processed the bulk data to derive aggregate biomarkers profiling activity of cancer-related pathways. Although this is not part of the RAD toolkit, we make use of bulk biomarkers and estimates of their activity in individual cell components (Section 2.2.6) to interpret the results of the RAD. We extracted 24 cancer-related pathways and the corresponding genes from the <italic>pathways in cancer</italic> (hsa05200), <italic>breast cancer</italic> (hsa05224) and <italic>glioma</italic> (hsa05214) of the KEGG database (<xref rid="btaa396-B17" ref-type="bibr">Kanehisa and Goto, 2000</xref>). The value of each pathway is the average expression of all genes within it. We mapped the original bulk gene matrix <inline-formula id="IE51"><mml:math id="IM51"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> into the cancer pathway probes matrix <inline-formula id="IE52"><mml:math id="IM52"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>24</mml:mn><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. Readers can find the list of pathways in <xref ref-type="fig" rid="btaa396-F5">Figure 5</xref>.</p>
        <p>Cancer pathways are distinct from gene modules, which capture the major variance across samples and the coexpression patterns using prior knowledge to facilitate more reliable deconvolution. However, coexpression modules are often weakly linked to biological functions and not informative for downstream analysis. In contrast, biomarkers such as cancer-related pathways facilitate functional interpretation of results. We did not use cancer-related pathways or other biomarkers for deconvolution, since they are not representative of the expression profiles.</p>
      </sec>
      <sec>
        <title>2.2.6 Pathway estimation of cell communities</title>
        <p>Given the bulk cancer pathway data <inline-formula id="IE53"><mml:math id="IM53"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, RAD utilizes the deconvolved <inline-formula id="IE54"><mml:math id="IM54"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> to infer the pathway values of cell populations <inline-formula id="IE55"><mml:math id="IM55"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (estimate_marker), similar to the paradigm of the Digital Sorting Algorithm (DSA; <xref rid="btaa396-B44" ref-type="bibr">Zhong <italic>et al.</italic>, 2013</xref>), by replacing <inline-formula id="IE56"><mml:math id="IM56"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> and <inline-formula id="IE57"><mml:math id="IM57"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> with <inline-formula id="IE58"><mml:math id="IM58"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE59"><mml:math id="IM59"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="E8">Equations (8)</xref> and <xref ref-type="disp-formula" rid="E9">(9)</xref>. The unmixed <inline-formula id="IE60"><mml:math id="IM60"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> or <inline-formula id="IE61"><mml:math id="IM61"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> may not be easy to interpret. However, other biomarkers, such as cancer pathways, provide a possible way to explain the biological process of each cell community, and can be used as input to infer the phylogeny and perturbed pathways during progression (Section 2.3).</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Phylogeny inference through minimum elastic potential</title>
      <p>Given the deconvolved cell clone profiles <inline-formula id="IE62"><mml:math id="IM62"><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> of <italic>k</italic> cell components, we inferred trees describing the observed extant and unobserved ancestral Steiner communities. We use the term ‘phylogeny’ to refer to these trees to highlight their connection to tumor phylogenetics methods often used for similar purposes and on similar data (<xref rid="btaa396-B34" ref-type="bibr">Schwartz and Schäffer, 2017</xref>), although we recognize that these trees describe changes in mean transcriptomic states of groups of associated cells rather than strictly clonal evolution and thus are not proper phylogenies.</p>
      <p>RAD works in the original non-log linear space, which recovers underlying components with higher accuracy and lower bias (<xref rid="btaa396-B43" ref-type="bibr">Zhong and Liu, 2012</xref>). In the phylogeny inference algorithm, however, we instead used the log space to focus on the fold change of expressions <inline-formula id="IE63"><mml:math id="IM63"><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mo>←</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>. We also normalize the expression to make them have zero mean value for each gene.</p>
      <p>We used a variant of the minimum elastic potential (MEP) method to infer the phylogeny structure and expression values of Steiner nodes (<xref rid="btaa396-B39" ref-type="bibr">Tao <italic>et al.</italic>, 2019b</xref>). Taking <inline-formula id="IE64"><mml:math id="IM64"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> as input, the MEP first builds the phylogeny tree that includes <italic>k</italic> extant nodes and <inline-formula id="IE65"><mml:math id="IM65"><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> ancestral Steiner nodes using the neighbor-joining algorithm (<xref rid="btaa396-B25" ref-type="bibr">Nei and Saitou, 1987</xref>). To identify the perturbed biological processes and gene expression during tumor evolution, MEP infers expression values of the unknown Steiner nodes by minimizing an ‘elastic potential energy’. For a specific pathway or gene, this is equivalent to a quadratic programming problem:
<disp-formula id="E18"><label>(18)</label><mml:math id="M18"><mml:mrow><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:munder><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:msup><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mo>⊺</mml:mo></mml:msup><mml:mi mathvariant="bold">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">W</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="bold">x</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">q</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">W</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mo>⊺</mml:mo></mml:msup><mml:mi mathvariant="bold">x</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE66"><mml:math id="IM66"><mml:mrow><mml:mi mathvariant="bold">x</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msup></mml:mrow></mml:math></inline-formula> are the expression values of Steiner and extant nodes; <inline-formula id="IE67"><mml:math id="IM67"><mml:mrow><mml:mi mathvariant="bold">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">W</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a function that takes as input the tree edge weights <inline-formula id="IE68"><mml:math id="IM68"><mml:mi mathvariant="script">W</mml:mi></mml:math></inline-formula> and outputs a matrix <inline-formula id="IE69"><mml:math id="IM69"><mml:mrow><mml:mi mathvariant="bold">P</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>; <inline-formula id="IE70"><mml:math id="IM70"><mml:mrow><mml:mi mathvariant="bold">q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">W</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">y</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is a function that takes as input edge weights <inline-formula id="IE71"><mml:math id="IM71"><mml:mi mathvariant="script">W</mml:mi></mml:math></inline-formula> and vector <inline-formula id="IE72"><mml:math id="IM72"><mml:mi mathvariant="bold">y</mml:mi></mml:math></inline-formula> and outputs a vector <inline-formula id="IE73"><mml:math id="IM73"><mml:mrow><mml:mi mathvariant="bold">q</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. We further added an <inline-formula id="IE74"><mml:math id="IM74"><mml:mrow><mml:msub><mml:mrow><mml:mi>ℓ</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>-regularization <inline-formula id="IE75"><mml:math id="IM75"><mml:mrow><mml:mo>λ</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold">I</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> to the <inline-formula id="IE76"><mml:math id="IM76"><mml:mrow><mml:mi mathvariant="bold">P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="script">W</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. In practice we use <inline-formula id="IE77"><mml:math id="IM77"><mml:mrow><mml:mo>λ</mml:mo><mml:mo>=</mml:mo><mml:mn>0.001</mml:mn></mml:mrow></mml:math></inline-formula>, which helps more stable inference when the total number of nodes is large. Interested readers can find detailed problem formulation, derivatives and proofs of MEP in the previous work (<xref rid="btaa396-B39" ref-type="bibr">Tao <italic>et al.</italic>, 2019b</xref>).</p>
      <p>Although we used the notation <inline-formula id="IE78"><mml:math id="IM78"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> for the explanation in this section, in our application, we used the pathway probes <inline-formula id="IE79"><mml:math id="IM79"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mi>P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> to infer the cancer pathway values of each Steiner nodes for downstream interpretation.</p>
    </sec>
    <sec>
      <title>2.4 Evaluation</title>
      <p>The deconvolution algorithm outputs both the estimated expression profiles <inline-formula id="IE80"><mml:math id="IM80"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and the fractions <inline-formula id="IE81"><mml:math id="IM81"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> of each cell communities. We utilized four different metrics to measure the accuracy and error of the two estimators with the ground truth <inline-formula id="IE82"><mml:math id="IM82"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> and <inline-formula id="IE83"><mml:math id="IM83"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> following previous research (<xref rid="btaa396-B26" ref-type="bibr">Newman <italic>et al.</italic>, 2015</xref>; <xref rid="btaa396-B42" ref-type="bibr">Zaitsev <italic>et al.</italic>, 2019</xref>; <xref rid="btaa396-B45" ref-type="bibr">Zhu <italic>et al.</italic>, 2018</xref>): <inline-formula id="IE84"><mml:math id="IM84"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> (Pearson coefficient of <inline-formula id="IE85"><mml:math id="IM85"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE86"><mml:math id="IM86"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula>), <italic>L</italic><sub>1</sub> loss (<inline-formula id="IE87"><mml:math id="IM87"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">C</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mi mathvariant="bold">C</mml:mi><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>), <inline-formula id="IE88"><mml:math id="IM88"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi>F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> (Pearson coefficient of <inline-formula id="IE89"><mml:math id="IM89"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE90"><mml:math id="IM90"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula>), MSE (Mean square error of <inline-formula id="IE91"><mml:math id="IM91"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">F</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE92"><mml:math id="IM92"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula>).</p>
    </sec>
    <sec>
      <title>2.5 Datasets and preprocessing</title>
      <p>We utilized three datasets throughout this work: one real dataset of breast cancer metastasis (BrM; <xref rid="btaa396-B46" ref-type="bibr">Zhu <italic>et al.</italic>, 2019</xref>); one real dataset of both pure and mixed transcriptome of liver, brain and lung (GSE19830; <xref rid="btaa396-B37" ref-type="bibr">Shen-Orr <italic>et al.</italic>, 2010</xref>); and one simulated dataset. All three datasets contain bulk transcriptome <inline-formula id="IE93"><mml:math id="IM93"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula>, which is the input of RAD and downstream analysis. Ground truths <inline-formula id="IE94"><mml:math id="IM94"><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="bold">F</mml:mi></mml:mrow></mml:math></inline-formula> are only available in simulated and GSE19830 datasets, and unknown in BrM dataset. Ground truth module knowledge of genes are only available in simulated dataset, GSE19830 and BrM datasets instead used DAVID to infer gene module.</p>
      <sec>
        <title>2.5.1 Simulated dataset</title>
        <p>We simulated a series of datasets with different parameters of module size (1, 2, 4,…, 512) and noise level <inline-formula id="IE95"><mml:math id="IM95"><mml:mrow><mml:mo>σ</mml:mo><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> to validate the effectiveness of RAD and module compression. We selected most of the parameters following <xref rid="btaa396-B42" ref-type="bibr">Zaitsev <italic>et al.</italic> (2019)</xref>, with selected parameters consistent with the distribution of the real dataset GSE19830.</p>
        <p>We considered the expression of 2048 interested genes and assumed three pure cell clones <inline-formula id="IE96"><mml:math id="IM96"><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>2048</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>. In the case where each module consists of just one gene, <inline-formula id="IE97"><mml:math id="IM97"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> was drawn from a log-normal distribution independently (<xref rid="btaa396-B6" ref-type="bibr">Bengtsson, 2005</xref>):
<disp-formula id="E19"><label>(19)</label><mml:math id="M19"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>2.5</mml:mn></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>2048</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3.</mml:mn></mml:mrow></mml:math></disp-formula></p>
        <p>We assumed that genes from the same module are highly correlated and prone to coexpress. When module size is greater than one, e.g. there are four genes in a module, for each gene module <inline-formula id="IE98"><mml:math id="IM98"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> (a subblock of <inline-formula id="IE99"><mml:math id="IM99"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula>), we draw each gene module as follows:
<disp-formula id="E20"><label>(20)</label><mml:math id="M20"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mi>S</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mo>·</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo>,</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow><mml:mo>⊺</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mn>2.5</mml:mn></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>Σ</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula>where Σ is the covariance matrix of four genes in the module:
<disp-formula id="E21"><label>(21)</label><mml:math id="M21"><mml:mrow><mml:mo>Σ</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="true">[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.95</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.95</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.95</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.95</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.95</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.95</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.95</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.95</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.95</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0.95</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.95</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>0.95</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy="true">]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>We assumed 100 mixture samples of bulk RNA, and drew the fractions of mixture samples uniformly from a unit simplex:
<disp-formula id="E22"><label>(22)</label><mml:math id="M22"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mrow><mml:mo>·</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>U</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msup><mml:mrow><mml:mo>Δ</mml:mo></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:math></disp-formula></p>
        <p>Finally, we added the noise of magnitude <italic>σ</italic> to get the final bulk data:
<disp-formula id="E23"><label>(23)</label><mml:math id="M23"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mi mathvariant="bold">F</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="script">N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mo>σ</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>2048</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mn>100.</mml:mn></mml:mrow></mml:math></disp-formula></p>
      </sec>
      <sec>
        <title>2.5.2 GSE19830 dataset</title>
        <p>GSE19830 contains RMA-normalized Affymetrix expressions of cells from rat brain, liver and lung biospecimens (<xref rid="btaa396-B37" ref-type="bibr">Shen-Orr <italic>et al.</italic>, 2010</xref>). It mixed the three pure tissues in different predefined proportions, leading to 33 mixture samples. Expression profiles of each pure and mixed sample were measured three times.</p>
        <p>We removed the non-protein coding genes, conducted quantile normalization and took the average of three replicates. This yielded three matrices for the GSE19830 data: expression profiles of the three pure clones <inline-formula id="IE100"><mml:math id="IM100"><mml:mrow><mml:mi mathvariant="bold">C</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>13741</mml:mn><mml:mo>×</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, fractions of three clones in all mixture data <inline-formula id="IE101"><mml:math id="IM101"><mml:mrow><mml:mi mathvariant="bold">F</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:mn>33</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and bulk data <inline-formula id="IE102"><mml:math id="IM102"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>13741</mml:mn><mml:mo>×</mml:mo><mml:mn>33</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec>
        <title>2.5.3 BrM dataset</title>
        <p>The BrM dataset contains matched transcriptome data of breast cancer metastasis patients (<xref rid="btaa396-B46" ref-type="bibr">Zhu <italic>et al.</italic>, 2019</xref>). There are 102 samples from 51 patients in total. There are four possible different metastatic sites for each breast cancer patient in the dataset: brain (BR; 22 patients), ovary (OV; 13 patients), bone (BO; 11 patients) and gastrointestinal tract (GI; 5 patients). A sample from the primary breast site has a matched sample from the metastatic site of the same patients. RNA-Seq of around 60 000 genes are available. We will denote the sample from the metastatic site and the corresponding primary site as MBR/PBR, MOV/POV, MBO/PBO, MGI/PGI. We removed the non-protein coding genes and conducted quantile normalization to get the final bulk data: <inline-formula id="IE103"><mml:math id="IM103"><mml:mrow><mml:mi mathvariant="bold">B</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mn>19689</mml:mn><mml:mo>×</mml:mo><mml:mn>102</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Gene modules facilitate robust deconvolution</title>
      <p>RAD can act directly on the bulk gene expression <inline-formula id="IE104"><mml:math id="IM104"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> or on the knowledge-based compressed bulk gene module expression <inline-formula id="IE105"><mml:math id="IM105"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (Section 2.2.2). We validated that the gene module compression is beneficial to RAD through both simulated data and real datasets.</p>
      <p>As a proof of concept, we first assume the knowledge of gene modules is correct and known to us. We generated simulated bulk data with a noise level <italic>σ </italic>= 4 and various module sizes from 1 to 512 (Section 2.5.1). We calculated four metrics to evaluate the accuracy of RAD estimation on these data, and repeated all experiments 100 times (<xref ref-type="fig" rid="btaa396-F2">Fig. 2</xref>). A moderate module size of 32 makes RAD the most accurate (highest median accuracy) and robust (smallest variance), which is helpful to deconvolution. RAD is less robust (high variance) on the original uncompressed bulk gene data (module size of one). However, when module size is too large, RAD has both inaccurate and unstable performance. We refer interested readers to <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref> for a more comprehensive result on the effects of both module size and noise level on RAD performance.
</p>
      <fig id="btaa396-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Effectiveness of gene module representation. Compressing the expression of individual genes into gene modules can promote more robust deconvolution with proper module size. We tested on the simulated bulk data with the noise level of <italic>σ </italic>= 4, and repeated all the experiments for 100 times to get the boxplot. We evaluated four metrics that measure the accuracy of deconvolution with different gene module sizes. Note that ‘module size’ of one is equivalent to the original gene expression without module compression. (<bold>a</bold>) Accuracy of expression matrix estimation: <inline-formula id="IE106"><mml:math id="IM106"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>. (<bold>b</bold>) Error of expression matrix estimation: <italic>L</italic><sub>1</sub> loss. (<bold>c</bold>) Accuracy of fraction matrix estimation: <inline-formula id="IE107"><mml:math id="IM107"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi mathvariant="normal">F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>. (<bold>d</bold>) Error of fraction matrix estimation: MSE</p>
        </caption>
        <graphic xlink:href="btaa396f2"/>
      </fig>
      <p>We further examined whether the module knowledge from DAVID generates a reasonable module size and facilitates robust RAD deconvolution. We applied RAD to both the uncompressed and compressed GSE19830 dataset. As shown in <xref ref-type="fig" rid="btaa396-F4">Figure 4d, e</xref>, module compression based on DAVID improve the RAD estimation of both <inline-formula id="IE108"><mml:math id="IM108"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> and <inline-formula id="IE109"><mml:math id="IM109"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula>.</p>
      <p>We could not directly validate the effectiveness of DAVID compression on unmixing the BrM dataset, but we found the gene module representation informative for separating primary and metastatic samples (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S2</xref>).</p>
    </sec>
    <sec>
      <title>3.2 RAD detects the correct number of cell components</title>
      <p>RAD utilizes CV to identify the number of underlying cell populations (Section 2.2.4). To validate its correctness, we applied a 20-fold CV to the GSE19830 data. As shown in <xref ref-type="fig" rid="btaa396-F3">Figure 3a</xref>, the CV error, <xref ref-type="disp-formula" rid="E14">Equation (14)</xref>, drops quickly when the number of cell components <italic>k</italic> increases from one to three, and flattens after <italic>k</italic> goes over three. In this case, we identify the correct number of cell clones to be three (Although <italic>k</italic> =8 gives minimum CV error, it is due to the small noise or artifacts in the samples.).
</p>
      <fig id="btaa396-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Cross-validation to automatically select the number of cell communities. We conducted a 20-fold cross-validation to infer the optimal number of cell component <italic>k</italic> as the input of RAD algorithm. (<bold>a</bold>) Cross-validation on GSE19830 dataset. The actual number of cell clones is three. (<bold>b</bold>) Cross-validation on BrM dataset. The inferred number of cell components is seven, which is used as the input parameter for <xref ref-type="fig" rid="btaa396-F5">Figures 5–7</xref></p>
        </caption>
        <graphic xlink:href="btaa396f3"/>
      </fig>
      <p>For the BrM dataset, we applied a 20-fold CV as well and found the CV error drops when <italic>k</italic> is smaller than seven, and increases with substantial variance because of overfitting when <italic>k</italic> is higher than seven. We therefore used <italic>k </italic>=<italic> </italic>7 as the number of communities in the BrM data. Previous research using a subset of the BrM dataset (only breast cancer brain metastasis samples) identified only five cell populations (<xref rid="btaa396-B39" ref-type="bibr">Tao <italic>et al.</italic>, 2019b</xref>). With a larger sample size, and more heterogeneous data, we can identify more fine-grained unmixed cell communities.</p>
    </sec>
    <sec>
      <title>3.3 RAD estimates cell populations robustly and accurately</title>
      <p>We then evaluated the accuracy and error of RAD relative to alternative deconvolution algorithms. There are many algorithms to solve the ‘partial deconvolution’ problem, where the expression profiles of clones <inline-formula id="IE110"><mml:math id="IM110"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> are available at the time of deconvolution, e.g. DSA (<xref rid="btaa396-B44" ref-type="bibr">Zhong <italic>et al.</italic>, 2013</xref>). For tumor samples, however, the underlying cell types are often unknown, and partial deconvolution can be unstable. We consider the ‘complete deconvolution’ problem here (<xref rid="btaa396-B42" ref-type="bibr">Zaitsev <italic>et al.</italic>, 2019</xref>), where the expression profiles of populations <inline-formula id="IE111"><mml:math id="IM111"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> are not available and must be inferred.</p>
      <p>There are a few existing algorithms that seem to be suitable for the complete deconvolution problem, e.g. principal components analysis (PCA), independent components analysis (ICA) and NMF. However, none of these algorithms account for the fraction normalization constraints, <xref ref-type="disp-formula" rid="E4">Equation (4)</xref>, and PCA and ICA do not guarantee the non-negativity of expression profiles, <xref ref-type="disp-formula" rid="E2">Equation (2)</xref>. A few more well-designed algorithms have been developed for the specific complete deconvolution problem, including Geometric Unmixing (<xref rid="btaa396-B35" ref-type="bibr">Schwartz and Shackney, 2010</xref>), LinSeed (<xref rid="btaa396-B42" ref-type="bibr">Zaitsev <italic>et al.</italic>, 2019</xref>) and NND (<xref rid="btaa396-B39" ref-type="bibr">Tao <italic>et al.</italic>, 2019b</xref>):
</p>
      <list list-type="bullet">
        <list-item>
          <p>Geometric Unmixing: It poses unmixing as a problem from computational geometry by assuming all the bulk samples are located in a simplex, where the corners of the simplex represent the expression profiles of pure clones.</p>
        </list-item>
        <list-item>
          <p>LinSeed: Based on the observation that genes in the same module are highly correlated to each other. It first identifies these anchor genes through linear correlation. Then it uses a partial deconvolution algorithm DSA to infer the fractions <inline-formula id="IE112"><mml:math id="IM112"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> and expressions of non-anchor genes <inline-formula id="IE113"><mml:math id="IM113"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> (<xref rid="btaa396-B44" ref-type="bibr">Zhong <italic>et al.</italic>, 2013</xref>).</p>
        </list-item>
        <list-item>
          <p>NND: It converts the complete deconvolution problem equivalently into an optimization problem, which can be implemented as a neural network. It uses backpropagation (gradient descent) to optimize.</p>
        </list-item>
      </list>
      <p>For RAD, we can directly take as input the bulk gene expression matrix <inline-formula id="IE114"><mml:math id="IM114"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> (<xref ref-type="fig" rid="btaa396-F4">Fig. 4d</xref>), or use the more noise-free bulk module expression matrix <inline-formula id="IE115"><mml:math id="IM115"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="btaa396-F4">Fig. 4e</xref>). Although the NND can also take <inline-formula id="IE116"><mml:math id="IM116"><mml:mi mathvariant="bold">B</mml:mi></mml:math></inline-formula> or <inline-formula id="IE117"><mml:math id="IM117"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> in principle, we only included results of ‘NND w/Module’ (<xref ref-type="fig" rid="btaa396-F4">Fig. 4c</xref>), due to the intractable training time of ‘NND w/Gene’.
</p>
      <fig id="btaa396-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>Performance of different deconvolution algorithms on GSE19830 dataset. We compared the accuracy of both estimated <inline-formula id="IE118"><mml:math id="IM118"><mml:mi mathvariant="bold">C</mml:mi></mml:math></inline-formula> and <inline-formula id="IE119"><mml:math id="IM119"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> across four different deconvolution algorithms. RAD with the module achieves best the performance among all the deconvolution algorithms evaluated in <inline-formula id="IE120"><mml:math id="IM120"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi mathvariant="normal">F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula>, and MSE. The module information facilitates the RAD to achieve better performance. (<bold>a</bold>) Geometric Unmixing. (<bold>b</bold>) LinSeed. (<bold>c</bold>) NND (with module). (<bold>d</bold>) RAD (with gene). (<bold>e</bold>) RAD (with module)</p>
        </caption>
        <graphic xlink:href="btaa396f4"/>
      </fig>
      <p><xref ref-type="fig" rid="btaa396-F4">Figure 4</xref> compares the performance of the five deconvolution algorithms and module-compressed variants on the GSE19830 dataset. The gene module compression improves the accuracy of RAD significantly (<xref ref-type="fig" rid="btaa396-F4">Fig. 4d and e</xref>), consistent with the observations in <xref ref-type="fig" rid="btaa396-F2">Figure 2</xref>. The RAD on the compressed module data outperforms the other three algorithms in metrics <inline-formula id="IE121"><mml:math id="IM121"><mml:mrow><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi mathvariant="normal">C</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mi mathvariant="normal">F</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> and MSE (<xref ref-type="fig" rid="btaa396-F4">Fig. 4a–c</xref> and e). It also has comparable <italic>L</italic><sub>1</sub> loss with the ‘NND w/Module’ algorithm (<xref ref-type="fig" rid="btaa396-F4">Fig. 4c and e</xref>). These results reveal the superiority and accuracy of the RAD algorithm and module compression.</p>
      <p>The elevated accuracy and robustness of RAD over competing algorithms is crucial for downstream analyses such as phylogeny inference. For example RAD reveals a more detailed portrait of perturbed pathways (Section 3.5) during metastasis than our previous NND algorithm (<xref rid="btaa396-B39" ref-type="bibr">Tao <italic>et al.</italic>, 2019b</xref>).</p>
    </sec>
    <sec>
      <title>3.4 Landscape of tumor cell communities</title>
      <p>We derived the fractions of cell communities in each sample <inline-formula id="IE122"><mml:math id="IM122"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> using RAD, and further inferred the pathway values of each cell community from <inline-formula id="IE123"><mml:math id="IM123"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">B</mml:mi></mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="IE124"><mml:math id="IM124"><mml:mi mathvariant="bold">F</mml:mi></mml:math></inline-formula> (Section 2.2.6). Although there exists inter-tumor heterogeneity across cancer samples, RAD aims to separate the shared features of cell populations across these tumors from sample-specific features as in prior cross-cohort deconvolutional phylogeny studies (<xref rid="btaa396-B33" ref-type="bibr">Roman <italic>et al.</italic>, 2015</xref>; <xref rid="btaa396-B35" ref-type="bibr">Schwartz and Shackney, 2010</xref>) and prior oncogenetic tree methods that do not include a deconvolution step (<xref rid="btaa396-B9" ref-type="bibr">Desper <italic>et al.</italic>, 2004</xref>; <xref rid="btaa396-B31" ref-type="bibr">Riester <italic>et al.</italic>, 2010</xref>).</p>
      <p><italic>Expression profiles of cell communities</italic><xref ref-type="fig" rid="btaa396-F5">Figure 5</xref> shows the pathway values of each cell population in log scale <inline-formula id="IE125"><mml:math id="IM125"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> after applying RAD to the BrM dataset. <italic>C</italic>5 is the most abnormal community, having lost half of the pathways completely (almost zero expression), including <italic>PI3K-Akt</italic>, <italic>ECM-receptor</italic> and <italic>Calcium</italic>. Another unusual cell community is <italic>C</italic>2, which is specifically enriched in neurotransmitter and calcium homeostasis functions (<italic>Calcium</italic> and <italic>cAMP</italic>; <xref rid="btaa396-B14" ref-type="bibr">Hofer and Lefkimmiatis, 2007</xref>). We hypothesize that <italic>C</italic>2 might reflect a cell community combining both neural cells and metastatic tumor cells. In contrast, <italic>C</italic>6, which we infer to approximate the primary breast tumor community, has a relatively high expression of <italic>PI3K-Akt</italic> (<xref rid="btaa396-B7" ref-type="bibr">Brastianos <italic>et al.</italic>, 2015</xref>) and immune function (<italic>Cytokine-cytokine receptor</italic>; <xref rid="btaa396-B46" ref-type="bibr">Zhu <italic>et al.</italic>, 2019</xref>).
</p>
      <fig id="btaa396-F5" orientation="portrait" position="float">
        <label>Fig. 5.</label>
        <caption>
          <p>Cancer-related pathway strengths of each cell component from BrM dataset. The strengths are shown in log-scale <inline-formula id="IE126"><mml:math id="IM126"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo> </mml:mo><mml:mtext>log</mml:mtext><mml:mo> </mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula></p>
        </caption>
        <graphic xlink:href="btaa396f5"/>
      </fig>
      <p><italic>Distribution of cell communities</italic><xref ref-type="fig" rid="btaa396-F6">Figure 6</xref> shows the distribution of cell components across different metastatic sites. We classified the tumor sites into eight categories: MBR/PBR, MOV/POV, MBO/PBO and MGI/PGI (Section 2.5.3). We observe that <italic>C</italic>6 is always decreased in the metastatic samples, from which we infer it may approximate the primary clones and capture features that distinguish primary clones from metastatic ones in general. Other components are increased in specific metastasis types. For example <italic>C</italic>1 in OV and BO; <italic>C</italic>2 in BR, OV and GI; <italic>C</italic>3 in BR, OV and GI; <italic>C</italic>4 in BO; <italic>C</italic>5 in BR, OV and BO; and <italic>C</italic>7 in BR. This indicates that there exist different cell population mixtures in different metastatic sites, likely in part reflecting site-specific stroma but also revealing commonalities across metastatic sites. We further note that the distribution of cell clones across primary sites is related to their eventual sites of metastasis. This result is suggestive that there may be a signal in the primary clonal composition of whether a primary tumor is likely to metastasize to a particular site, although that suggestion requires further evaluation and validation.
</p>
      <fig id="btaa396-F6" orientation="portrait" position="float">
        <label>Fig. 6.</label>
        <caption>
          <p>Fractions of communities in both primary and metastatic sites of four different metastasis types from BrM dataset. The differences of cell distribution exist both between primary (lighter) and metastatic (darker) sites, and across four metastatic cases (different colors)</p>
        </caption>
        <graphic xlink:href="btaa396f6"/>
      </fig>
      <p>We do not know the ground truth cell populations in the BrM dataset. Given that the component <italic>C</italic>3 mainly exists in the GI samples (<xref ref-type="fig" rid="btaa396-F6">Fig. 6</xref>), though, we would predict that removing the GI samples would decrease the optimal number of components from 7 (<xref ref-type="fig" rid="btaa396-F3">Fig. 3b</xref>) to 6, which is indeed the case (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S3</xref>).</p>
    </sec>
    <sec>
      <title>3.5 Common evolutionary mechanisms of breast cancer metastasis</title>
      <p>Using the unmixed cell clones <inline-formula id="IE127"><mml:math id="IM127"><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold">C</mml:mi></mml:mrow><mml:mi mathvariant="normal">P</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>, we built a phylogeny and inferred the pathway values of Steiner nodes using the MEP algorithm (Section 2.3). Since there are vast differences across the four metastasis types (<xref ref-type="fig" rid="btaa396-F6">Fig. 6</xref>), we inferred a phylogeny tree for each metastasis type (<xref ref-type="fig" rid="btaa396-F7">Fig. 7a–d</xref>; <xref ref-type="supplementary-material" rid="sup1">Supplementary Tables S1–S4</xref>). We presented <italic>C</italic>6 as the common root node, as it consistently decreases in all four metastasis types, and identified the communities whose average fractions increase in the metastatic communities of specific metastasis types. <xref ref-type="fig" rid="btaa396-F7">Figure 7</xref> shows the top five most differentially expressed pathways for more than onefold along each edge.
</p>
      <fig id="btaa396-F7" orientation="portrait" position="float">
        <label>Fig. 7.</label>
        <caption>
          <p>Phylogenies of four different metastatic cases. Although there are large differences in tumor communities across the four metastasis sites, there exists common mechanisms, such as the early events of perturbed <italic>PI3K-Akt</italic>, <italic>ECM-receptor</italic> and <italic>focal adhesion</italic> pathways. (<bold>a</bold>) Breast cancer brain metastasis. (<bold>b</bold>) Breast cancer ovary metastasis. (<bold>c</bold>) Breast cancer bone metastasis. (<bold>d</bold>) Breast cancer GI metastasis</p>
        </caption>
        <graphic xlink:href="btaa396f7"/>
      </fig>
      <p>As shown, there are common patterns at the early stage of metastasis, e.g. the decrease of <italic>PI3K-Akt</italic>, <italic>ECM-receptor interaction</italic> and <italic>focal adhesion</italic>. The loss of <italic>PI3K/Akt/mTOR</italic> in metastatic tumors has already been identified in brain metastasis research based on both genomic and transcriptomic data (<xref rid="btaa396-B7" ref-type="bibr">Brastianos <italic>et al.</italic>, 2015</xref>; <xref rid="btaa396-B39" ref-type="bibr">Tao <italic>et al.</italic>, 2019b</xref>). Our result indicates the loss of <italic>PI3K-Akt</italic> pathway is a common event among the general metastasis types as well, not limited to brain metastasis. Loss of <italic>ECM-receptor interaction</italic> and <italic>focal adhesion</italic> also plays a critical role in tumor cell migration generically (<xref rid="btaa396-B23" ref-type="bibr">Nagano <italic>et al.</italic>, 2012</xref>). Tumor cells adhere to the extracellular matrix (ECM), forming the structures called focal adhesions and loss of these interactions is a key step in enabling metastatic migration.</p>
      <p>There are also substantial differences across metastatic sites that may suggest potential markers of incipient site-specific metastasis. The dysregulation of some perturbed pathways have already been shown to be closely related to tumor progression (<italic>Hedgehog</italic>, <italic>Apoptosis</italic>; <xref rid="btaa396-B13" ref-type="bibr">Gupta <italic>et al.</italic>, 2010</xref>). <italic>RET</italic> and <italic>ErbB</italic> have been shown recurrently perturbed in metastasis (<xref rid="btaa396-B30" ref-type="bibr">Priedigkeit <italic>et al.</italic>, 2017b</xref>). The reduction of <italic>Cytokine-cytokine receptor</italic> may reflect the reduced immune cell recruitment in metastatic samples (<xref rid="btaa396-B46" ref-type="bibr">Zhu <italic>et al.</italic>, 2019</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We developed a tool called RAD for deconvolution of multi-stage transcriptomic data corresponding to primary and metastatic tumor samples. We have shown that RAD can robustly and accurately estimate the number of cell populations, unmix the cell populations and infer biomarkers from bulk RNA-Seq of tumor samples, while showing improved reliability and accuracy over other deconvolution algorithms on both simulated and real RNA datasets. We applied RAD with gene module compression and a phylogeny inference algorithm to bulk transcriptome data collected from matched breast primary and four different metastatic sites to characterize similarities and variations in tumor clonal populations by eventual site of metastasis. Significant perturbations of cancer-related pathways, such as <italic>PI3K-Akt</italic>, <italic>ECM-receptor</italic> and <italic>focal adhesion</italic> emerge as common early events across sites of breast cancer metastasis, showing the potential of the method to reveal recurrent evolution mechanisms of breast cancer metastasis.</p>
    <p>It has been observed that the noise of RNA expression grows with its amplitude, suggesting that a more principled probabilistic model instead of Frobenius norm could potentially further improve the deconvolution accuracy (<xref rid="btaa396-B45" ref-type="bibr">Zhu <italic>et al.</italic>, 2018</xref>). Furthermore, we applied RAD by considering a limited two-stage progression process, without use of the time-series information. One future direction might be extending RAD into a temporal model to take advantage of more precise information on time to metastasis when available or more extensive time-series data on multiple time points such as might be produced by ‘liquid biopsy’ technologies. We mainly focused on transcriptome data in this work, but we expect the RAD algorithm to be versatile and potentially applicable to other types of continuous biological data, such as epigenome and proteome. With moderate adaptations, it is also possible to apply RAD to genome data, which is one major focus of cancer phylogenetics, such as copy number variations (<xref rid="btaa396-B10" ref-type="bibr">Eaton <italic>et al.</italic>, 2018</xref>). While much of the motivation for this work is the difficulty of acquiring scRNA for primary tumor samples when examining metastases years later, we do anticipate that this problem will lessen over time. It is thus worth considering for the future whether our methods might be adapted for working on limited and noisy scRNA with matched bulk data (<xref rid="btaa396-B11" ref-type="bibr">Elyanow <italic>et al.</italic>, 2020</xref>).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btaa396_Supplementary_Data</label>
      <media xlink:href="btaa396_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The author would like to thank to the reviewers for their helpful suggestions.</p>
    <sec>
      <title>Funding</title>
      <p>This work was partially supported by NIH awards R21CA216452 and R01HG010589, Pennsylvania Department of Health award #4100070287, Susan G. Komen for the Cure, the Mario Lemieux Foundation and the Breast Cancer Alliance. It is also partially supported by the AWS Machine Learning Research Awards granted to J.M. and R.S. and by the Center for Machine Learning and Health Fellowship in Digital Health granted to Y.T. The Pennsylvania Department of Health specifically disclaims responsibility for any analyses, interpretations or conclusions.</p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa396-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Alsop</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>A community-based model of rapid autopsy in end-stage cancer patients</article-title>. <source>Nat. Biotechnol</source>., <volume>34</volume>, <fpage>1010</fpage>–<lpage>1014</lpage>.<pub-id pub-id-type="pmid">27617737</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Andersen</surname><given-names>M.S.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) Interior-point methods for large-scale cone programming, In: Sra,S. <italic>et al</italic>, (eds) <italic>Optimization for Machine Learning</italic>, MIT Press, Cambridge, MA, pp. <fpage>55</fpage>–<lpage>83</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa396-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Basudan</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Frequent ESR1 and CDK pathway copy-number alterations in metastatic breast cancer</article-title>. <source>Mol. Cancer Res. MCR</source>, <volume>17</volume>, <fpage>457</fpage>–<lpage>468</lpage>.<pub-id pub-id-type="pmid">30355675</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Beerenwinkel</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>Mtreemix: a software package for learning and using mixture models of mutagenetic trees</article-title>. <source>Bioinformatics</source>, <volume>21</volume>, <fpage>2106</fpage>–<lpage>2107</lpage>.<pub-id pub-id-type="pmid">15657098</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Beerenwinkel</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Computational cancer biology: an evolutionary perspective</article-title>. <source>PLoS Comput. Biol</source>., <volume>12</volume>, <fpage>e1004717</fpage>.<pub-id pub-id-type="pmid">26845763</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Bengtsson</surname><given-names>M.</given-names></name></person-group> (<year>2005</year>) 
<article-title>Gene expression profiling in single cells from the pancreatic islets of Langerhans reveals lognormal distribution of mRNA levels</article-title>. <source>Genome Research</source>, <volume>15</volume>, <fpage>1388</fpage>–<lpage>1392</lpage>.<pub-id pub-id-type="pmid">16204192</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Brastianos</surname><given-names>P.K.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Genomic characterization of brain metastases reveals branched evolution and potential therapeutic targets</article-title>. <source>Cancer Discov</source>., <volume>5</volume>, <fpage>1164</fpage>–<lpage>1177</lpage>.<pub-id pub-id-type="pmid">26410082</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Desmedt</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Biological processes associated with breast cancer clinical outcome depend on the molecular subtypes</article-title>. <source>Clin. Cancer Res</source>., <volume>14</volume>, <fpage>5158</fpage>–<lpage>5165</lpage>.<pub-id pub-id-type="pmid">18698033</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Desper</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) 
<article-title>Tumor classification using phylogenetic methods on expression data</article-title>. <source>J. Theor. Biol</source>., <volume>228</volume>, <fpage>477</fpage>–<lpage>496</lpage>.<pub-id pub-id-type="pmid">15178197</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Eaton</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Deconvolution and phylogeny inference of structural variations in tumor genomic samples</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>i357</fpage>–<lpage>i365</lpage>.<pub-id pub-id-type="pmid">29950001</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Elyanow</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2020</year>) 
<article-title>NetNMF-sc: leveraging gene–gene interactions for imputation and dimensionality reduction in single-cell expression analysis</article-title>. <source>Genome Res</source>., <volume>30</volume>, <fpage>195</fpage>–<lpage>204</lpage>.<pub-id pub-id-type="pmid">31992614</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Guan</surname><given-names>X.</given-names></name></person-group> (<year>2015</year>) 
<article-title>Cancer metastases: challenges and opportunities</article-title>. <source>Acta Pharm. Sin. B</source>, <volume>5</volume>, <fpage>402</fpage>–<lpage>418</lpage>.<pub-id pub-id-type="pmid">26579471</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Gupta</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Targeting the Hedgehog pathway in cancer</article-title>. <source>Therap. Adv. Med. Oncol</source>., <volume>2</volume>, <fpage>237</fpage>–<lpage>250</lpage>.<pub-id pub-id-type="pmid">21789137</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hofer</surname><given-names>A.M.</given-names></name>, <name name-style="western"><surname>Lefkimmiatis</surname><given-names>K.</given-names></name></person-group> (<year>2007</year>) 
<article-title>Extracellular calcium and cAMP: second messengers as third messengers?</article-title><source>Physiology</source>, <volume>22</volume>, <fpage>320</fpage>–<lpage>327</lpage>.<pub-id pub-id-type="pmid">17928545</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hoyer</surname><given-names>P.O.</given-names></name></person-group> (<year>2004</year>) 
<article-title>Non-negative matrix factorization with sparseness constraints</article-title>. <source>J. Mach. Learn. Res</source>., <volume>5</volume>, <fpage>1457</fpage>–<lpage>1469</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa396-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Huang</surname><given-names>D.W.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Systematic and integrative analysis of large gene lists using DAVID bioinformatics resources</article-title>. <source>Nat. Protoc</source>., <volume>4</volume>, <fpage>44</fpage>–<lpage>57</lpage>.<pub-id pub-id-type="pmid">19131956</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Kanehisa</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Goto</surname><given-names>S.</given-names></name></person-group> (<year>2000</year>) 
<article-title>KEGG: Kyoto Encyclopedia of Genes and Genomes</article-title>. <source>Nucleic Acids Res</source>., <volume>28</volume>, <fpage>27</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">10592173</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Körber</surname><given-names>V.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Evolutionary trajectories of IDHWT glioblastomas reveal a common path of early tumorigenesis instigated years ahead of initial diagnosis</article-title>. <source>Cancer Cell</source>, <volume>35</volume>, <fpage>692</fpage>–<lpage>704.e12</lpage>.<pub-id pub-id-type="pmid">30905762</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B19">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>D.D.</given-names></name>, <name name-style="western"><surname>Seung</surname><given-names>H.S.</given-names></name></person-group> (<year>2000</year>) Algorithms for non-negative matrix factorization. In Proceedings of the 13th International Conference on Neural Information Processing Systems, NIPS’00, pp. 535–541, MIT Press, Cambridge, MA, USA.</mixed-citation>
    </ref>
    <ref id="btaa396-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lei</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2020</year>a) 
<article-title>Tumor copy number deconvolution integrating bulk and single-cell sequencing data</article-title>. <source>J. Comput. Biol</source>., <volume>27</volume>, <fpage>565</fpage>–<lpage>598</lpage>.<pub-id pub-id-type="pmid">32181683</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B21">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Lei</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2020</year>b) Tumor heterogeneity assessed by sequencing and fluorescence in situ hybridization (FISH) data. <italic>bioRxiv, 2020.02.29.970392.</italic></mixed-citation>
    </ref>
    <ref id="btaa396-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lin</surname><given-names>N.U.</given-names></name></person-group><etal>et al</etal> (<year>2004</year>) 
<article-title>CNS metastases in breast cancer</article-title>. <source>J. Clin. Oncol</source>., <volume>22</volume>, <fpage>3608</fpage>–<lpage>3617</lpage>.<pub-id pub-id-type="pmid">15337811</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nagano</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Turnover of focal adhesions and cancer cell migration</article-title>. <source>Int. J. Cell Biol</source>., <volume>2012</volume>, <fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa396-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Navin</surname><given-names>N.E.</given-names></name></person-group> (<year>2015</year>) 
<article-title>The first five years of single-cell cancer genomics and beyond</article-title>. <source>Genome Res</source>., <volume>25</volume>, <fpage>1499</fpage>–<lpage>1507</lpage>.<pub-id pub-id-type="pmid">26430160</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nei</surname><given-names>M.</given-names></name>, <name name-style="western"><surname>Saitou</surname><given-names>N.</given-names></name></person-group> (<year>1987</year>) 
<article-title>The neighbor-joining method: a new method for reconstructing phylogenetic trees</article-title>. <source>Mol. Biol. Evol</source>., <volume>4</volume>, <fpage>406</fpage>–<lpage>425</lpage>.<pub-id pub-id-type="pmid">3447015</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Newman</surname><given-names>A.M.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Robust enumeration of cell subsets from tissue expression profiles</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>453</fpage>–<lpage>457</lpage>.<pub-id pub-id-type="pmid">25822800</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Nguyen</surname><given-names>D.X.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Metastasis: from dissemination to organ-specific colonization</article-title>. <source>Nat. Rev. Cancer</source>, <volume>9</volume>, <fpage>274</fpage>–<lpage>284</lpage>.<pub-id pub-id-type="pmid">19308067</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Park</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>Network-based inference of cancer progression from microarray data</article-title>. <source>IEEE/ACM Trans. Comput. Biol. Bioinf</source>., <volume>6</volume>, <fpage>200</fpage>–<lpage>212</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa396-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Priedigkeit</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>a) 
<article-title>Exome-capture RNA sequencing of decade-old breast cancers and matched decalcified bone metastases</article-title>. <source>JCI Insight</source>, <volume>2</volume>, e95703.</mixed-citation>
    </ref>
    <ref id="btaa396-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Priedigkeit</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>b) 
<article-title>Intrinsic subtype switching and acquired ERBB2/HER2 amplifications and mutations in breast cancer brain metastases</article-title>. <source>JAMA Oncol</source>., <volume>3</volume>, <fpage>666</fpage>–<lpage>671</lpage>.<pub-id pub-id-type="pmid">27926948</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Riester</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>A differentiation-based phylogeny of cancer subtypes</article-title>. <source>PLoS Comput. Biol</source>., <volume>6</volume>, <fpage>e1000777</fpage>.<pub-id pub-id-type="pmid">20463876</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Riihimäki</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Clinical landscape of cancer metastases</article-title>. <source>Cancer Med</source>., <volume>7</volume>, <fpage>5534</fpage>–<lpage>5542</lpage>.<pub-id pub-id-type="pmid">30328287</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Roman</surname><given-names>T.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>A simplicial complex-based approach to unmixing tumor progression data</article-title>. <source>BMC Bioinformatics</source>, <volume>16</volume>, <fpage>254</fpage>.<pub-id pub-id-type="pmid">26264682</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schwartz</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Schäffer</surname><given-names>A.A.</given-names></name></person-group> (<year>2017</year>) 
<article-title>The evolution of tumour phylogenetics: principles and practice</article-title>. <source>Nat. Rev. Genet</source>., <volume>18</volume>, <fpage>213</fpage>–<lpage>229</lpage>.<pub-id pub-id-type="pmid">28190876</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Schwartz</surname><given-names>R.</given-names></name>, <name name-style="western"><surname>Shackney</surname><given-names>S.E.</given-names></name></person-group> (<year>2010</year>) 
<article-title>Applying unmixing to gene expression data for tumor phylogeny inference</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>42</fpage>.<pub-id pub-id-type="pmid">20089185</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B36">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Shen</surname><given-names>B.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) Robust nonnegative matrix factorization via L1 norm regularization by multiplicative updating rules. In: <italic>2014 IEEE International Conference on Image Processing (ICIP)</italic>, Institute of Electrical and Electronics Engineers (IEEE), New York, pp. <fpage>5282</fpage>–<lpage>5286</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa396-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Shen-Orr</surname><given-names>S.S.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>Cell type-specific gene expression differences in complex tissues</article-title>. <source>Nat. Methods</source>, <volume>7</volume>, <fpage>287</fpage>–<lpage>289</lpage>.<pub-id pub-id-type="pmid">20208531</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B38">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Tao</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>a) Improving personalized prediction of cancer prognoses with clonal evolution models. <italic><italic>bioRxiv</italic>, 761510<italic>.</italic></italic></mixed-citation>
    </ref>
    <ref id="btaa396-B39">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Tao</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>b) <chapter-title>Phylogenies derived from matched transcriptome reveal the evolution of cell populations and temporal order of perturbed pathways in breast cancer brain metastases</chapter-title> In: Bebis,G. <etal>et al</etal> (eds) <italic>Mathematical and Computational Oncology</italic>
<publisher-name>Springer International Publishing</publisher-name>, Cham, Switzerland, pp. <fpage>3</fpage>–<lpage>28</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa396-B40">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Tao</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2020</year>) 
<article-title>From genome to phenome: predicting multiple cancer phenotypes based on somatic genomic alterations via the genomic impact transformer</article-title>. In: Altman,R.B. <etal>et al</etal> (eds) <italic>Pacific Symposium on Biocomputing</italic>, <volume>vol. 25</volume>
<publisher-name>World Scientific</publisher-name>, Toh Tuck Link, Singapore, pp. <fpage>79</fpage>–<lpage>90</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa396-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Vareslija</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Transcriptome characterization of matched primary breast and brain metastatic tumors to detect novel actionable targets</article-title>. <source>J. Natl. Cancer Inst</source>., <volume>111</volume>, <fpage>388</fpage>–<lpage>398</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa396-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zaitsev</surname><given-names>K.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Complete deconvolution of cellular mixtures based on linearity of transcriptional signatures</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>2209</fpage>.<pub-id pub-id-type="pmid">31101809</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhong</surname><given-names>Y.</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>Z.</given-names></name></person-group> (<year>2012</year>) 
<article-title>Gene expression deconvolution in linear space</article-title>. <source>Nat. Methods</source>, <volume>9</volume>, <fpage>8</fpage>–<lpage>9</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa396-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhong</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Digital sorting of complex tissues for cell type-specific gene expression profiles</article-title>. <source>BMC Bioinformatics</source>, <volume>14</volume>, <fpage>89</fpage>.<pub-id pub-id-type="pmid">23497278</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhu</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>A unified statistical framework for single cell and bulk RNA sequencing data</article-title>. <source>Ann. Appl. Stat</source>., <volume>12</volume>, <fpage>609</fpage>–<lpage>632</lpage>.<pub-id pub-id-type="pmid">30174778</pub-id></mixed-citation>
    </ref>
    <ref id="btaa396-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhu</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2019</year>) 
<article-title>Metastatic breast cancers have reduced immune cell recruitment but harbor increased macrophages relative to their matched primary tumors</article-title>. <source>J. ImmunoTherapy Cancer</source>, <volume>7</volume>, <fpage>265</fpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
