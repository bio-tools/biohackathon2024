<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8790911</article-id>
    <article-id pub-id-type="publisher-id">2583</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-021-02583-w</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>CellPhy: accurate and fast probabilistic inference of single-cell phylogenies from scDNA-seq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kozlov</surname>
          <given-names>Alexey</given-names>
        </name>
        <address>
          <email>alexey.kozlov@h-its.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Alves</surname>
          <given-names>Joao M.</given-names>
        </name>
        <address>
          <email>jalves@uvigo.es</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stamatakis</surname>
          <given-names>Alexandros</given-names>
        </name>
        <address>
          <email>Alexandros.Stamatakis@h-its.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1407-3406</contrib-id>
        <name>
          <surname>Posada</surname>
          <given-names>David</given-names>
        </name>
        <address>
          <email>dposada@uvigo.es</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.424699.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2275 2842</institution-id><institution>Computational Molecular Evolution Group, </institution><institution>Heidelberg Institute for Theoretical Studies, </institution></institution-wrap>69118 Heidelberg, Germany </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.6312.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 6738</institution-id><institution>CINBIO, Universidade de Vigo, </institution></institution-wrap>36310 Vigo, Spain </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.6312.6</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 6738</institution-id><institution>Department of Biochemistry, Genetics, and Immunology, </institution><institution>Universidade de Vigo, </institution></institution-wrap>36310 Vigo, Spain </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.512379.b</institution-id><institution>Galicia Sur Health Research Institute (IIS Galicia Sur), </institution><institution>SERGAS-UVIGO, </institution></institution-wrap>Vigo, Spain </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.7892.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 0075 5874</institution-id><institution>Institute for Theoretical Informatics, </institution><institution>Karlsruhe Institute of Technology, </institution></institution-wrap>76128 Karlsruhe, Germany </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>26</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>26</day>
      <month>1</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <volume>23</volume>
    <elocation-id>37</elocation-id>
    <history>
      <date date-type="received">
        <day>6</day>
        <month>5</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>12</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">We introduce CellPhy, a maximum likelihood framework for inferring phylogenetic trees from somatic single-cell single-nucleotide variants. CellPhy leverages a finite-site Markov genotype model with 16 diploid states and considers amplification error and allelic dropout. We implement CellPhy into RAxML-NG, a widely used phylogenetic inference package that provides statistical confidence measurements and scales well on large datasets with hundreds or thousands of cells. Comprehensive simulations suggest that CellPhy is more robust to single-cell genomics errors and outperforms state-of-the-art methods under realistic scenarios, both in accuracy and speed. CellPhy is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/amkozlov/cellphy">https://github.com/amkozlov/cellphy</ext-link>.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-021-02583-w.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Somatic phylogenetics</kwd>
      <kwd>Genotype evolution</kwd>
      <kwd>Single-cell genomics</kwd>
      <kwd>Single-cell phylogenies</kwd>
      <kwd>Cell lineage trees</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000781</institution-id>
            <institution>European Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>ERC-617457- PHYLOCANCER</award-id>
        <principal-award-recipient>
          <name>
            <surname>Posada</surname>
            <given-names>David</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>MCIN</institution>
        </funding-source>
        <award-id>PID2019-106247GB-I00</award-id>
        <principal-award-recipient>
          <name>
            <surname>Posada</surname>
            <given-names>David</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>AECC</institution>
        </funding-source>
        <award-id>AECC Investigator 2020</award-id>
        <principal-award-recipient>
          <name>
            <surname>Alves</surname>
            <given-names>Joao M.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100007316</institution-id>
            <institution>Klaus Tschira Stiftung</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2022</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">The study of single cells is revolutionizing biology, unveiling unprecedented levels of genomic and phenotypic heterogeneity within otherwise seemingly homogeneous tissues [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. Understanding this somatic mosaicism has applications in multiple areas of biology due to its intrinsic connection to development, aging, and disease [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>]. However, the analysis of single-cell genomic data is not devoid of challenges [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR9">9</xref>], including the development of more integrative, scalable, and biologically realistic models of somatic evolution that can handle the inherent noise of single-cell data—mainly amplification error and allelic dropout (ADO) [<xref ref-type="bibr" rid="CR10">10</xref>]. Understanding how somatic cells evolve is one of the main applications of single-cell technologies. In particular, the reconstruction of cell phylogenies from single-cell DNA sequencing (scDNA-seq) can help us understand the mode and tempo of cell diversification and its mechanisms [<xref ref-type="bibr" rid="CR11">11</xref>]. Thus, cell phylogenies can help disentangle key events in the ontogeny of differentiated cell types [<xref ref-type="bibr" rid="CR12">12</xref>] and can be used to decipher human development at a remarkable resolution [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR17">17</xref>]. When geographical information is available, cell (and clonal) genealogies can inform us about somatic expansions and cell migrations, which are of great relevance, for example, to understand tumor growth and metastasis [<xref ref-type="bibr" rid="CR18">18</xref>–<xref ref-type="bibr" rid="CR22">22</xref>].</p>
    <p id="Par3">Several methods have been proposed to reconstruct cell phylogenies from scDNA-seq data using single-nucleotide variants (SNVs) [<xref ref-type="bibr" rid="CR23">23</xref>, <xref ref-type="bibr" rid="CR24">24</xref>]. OncoNEM [<xref ref-type="bibr" rid="CR25">25</xref>] implements a nested-effects likelihood model to correct for observational noise, plus a simple heuristic search that maximizes the likelihood of the data across tree space. It reconstructs a tree of clones and mutations by assigning cells to the clones. OncoNEM assumes an infinite-site mutation (ISM) model, and as we will see below, it is very slow and can only analyze small datasets. Among the most popular, SCITE [<xref ref-type="bibr" rid="CR26">26</xref>] assumes an infinite-site mutation (ISM) model and uses Markov Chain Monte Carlo (MCMC) to sample likelihoods/posterior probabilities. Apart from the cell phylogeny, SCITE can estimate a mutation tree to which it attaches the cells a posteriori. Conveniently, it can also infer false-positive (FP) and false-negative (FN) error rates from the data. infSCITE [<xref ref-type="bibr" rid="CR27">27</xref>] extends SCITE to consider cell doublets, test the ISM’s validity, and learn the FP rate from panel sequencing data. SiFit [<xref ref-type="bibr" rid="CR28">28</xref>] implements a Markov finite-site evolution model and a heuristic ML tree search algorithm. It can also estimate FP and FN error rates, and in the reported simulations, outperforms OncoNEM and SCITE in terms of speed and accuracy. SCIPhI [<xref ref-type="bibr" rid="CR29">29</xref>] jointly estimates the cell genotypes and their phylogenetic relationships, working directly with the read counts and considering amplification/sequencing errors, ADO, and loss of heterozygosity. SPhyR [<xref ref-type="bibr" rid="CR30">30</xref>] and SASC [<xref ref-type="bibr" rid="CR31">31</xref>] are ISM methods that exploit Dollo parsimony, which assumes that a mutation can be gained only once but lost multiple times. SCARLET [<xref ref-type="bibr" rid="CR32">32</xref>] is another method that explicitly considers losses, uses a statistical model for the sequencing data, and leverages copy number profiles. More recently, ScisTree [<xref ref-type="bibr" rid="CR33">33</xref>] implements an ISM maximum likelihood method whose input is binary/ternary genotype probabilities. In the simulations performed by the author, ScisTree’s accuracy is similar to SCIPhI and SCITE, but it is much faster. Related approaches for single-cell SNV data include methods focused on cell clustering and clonal phylogeny [<xref ref-type="bibr" rid="CR34">34</xref>–<xref ref-type="bibr" rid="CR41">41</xref>], phylogenetic model selection [<xref ref-type="bibr" rid="CR42">42</xref>, <xref ref-type="bibr" rid="CR43">43</xref>], mutation ordering [<xref ref-type="bibr" rid="CR44">44</xref>], genotype correction [<xref ref-type="bibr" rid="CR45">45</xref>], or longitudinal comparisons [<xref ref-type="bibr" rid="CR46">46</xref>]. Methods also exist for inferring phylogenies from single-cell copy number variants [<xref ref-type="bibr" rid="CR47">47</xref>], but these are out of the scope of this study.</p>
    <p id="Par4">All methods mentioned above for the specific problem of cell phylogeny reconstruction with SNVs were implemented de novo, yet they use relatively simple evolutionary models. Indeed, developing biologically realistic and yet computationally tractable models is one of the current challenges for single-cell phylogenetics [<xref ref-type="bibr" rid="CR9">9</xref>]. Statistical phylogenetics is a well-developed field, with many sophisticated evolutionary models implemented into efficient computational programs. We reasoned that we could leverage such a framework to obtain more accurate somatic cell phylogenies. Thus, we implemented a novel, dedicated single-cell somatic SNV evolution model in an existing, successful framework for statistical phylogenetics, RAxML-NG [<xref ref-type="bibr" rid="CR48">48</xref>]. We named the resulting software CellPhy. The main focus of CellPhy is the complete reconstruction of cell phylogenies, which can be the basis of subsequent evolutionary analyses. Our computer simulations and the analysis of empirical datasets show that CellPhy can reconstruct accurate single-cell SNV phylogenies across different biological scenarios and is substantially faster than the competing likelihood-based methods. We also evaluated a maximum parsimony-based tool TNT [<xref ref-type="bibr" rid="CR49">49</xref>], an extremely fast approach for phylogenetic reconstruction. Although TNT performed very well in error-free simulation scenarios, its accuracy quickly degraded in the presence of the typical biases observed in scDNA-seq data.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>CellPhy</title>
      <p id="Par5">We developed a probabilistic model for the phylogenetic analysis of single-cell diploid genotypes inferred from scDNA-seq experiments, called CellPhy. For tractability, we focused on single nucleotide variants (SNVs), arguably the most common genetic data obtained from somatic tissues nowadays. Current SNV evolutionary models for single-cells only consider the absence/presence of mutations regardless of the nucleotides involved [<xref ref-type="bibr" rid="CR25">25</xref>, <xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]. Thus, they deal with at most a ternary state space where genotypes can only have 0, 1, or 2 mutant alleles (normal, heterozygous, or homozygous mutant, respectively). Instead, here we consider changes among all possible 16 phased DNA genotypes <italic>Γ</italic> = {A|A, A|C, A|G, A|T, C|A, C|C, C|G, C|T, G|A, G|C, G|G, G|T, T|A, T|C, T|G, T|T}, by extending the well-established finite-site continuous-time general-time-reversible Markov model of DNA sequence evolution with four states (GTR) [<xref ref-type="bibr" rid="CR50">50</xref>] to 16 states. We named this new model GT16. In Fig. S<xref rid="MOESM1" ref-type="media">1</xref>, we summarize a few characteristics of this model.</p>
      <p id="Par6">Because somatic evolution proceeds mainly by mitosis, where both daughter cells receive the same set of chromosomes and recombination can be safely ignored, a unique cell history is recorded in the same way in the maternal and paternal chromosomes. Therefore, we do not need to know whether a mutation occurred in the maternal or paternal chromosome to infer the cell phylogeny. While the GT16 model in CellPhy considers phased genotypes, nowadays, the vast majority of the empirical scDNA-seq datasets are unphased due to technical limitations. Conveniently, the GT16 model can also work with unphased genotypes (10 states) simply by considering the ambiguity of the phase in heterozygotes (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section). Our simulations consist of unphased genotypes to represent current scDNA-seq data.</p>
      <p id="Par7">Importantly, single-cell genotypes can be very noisy, mainly due to biases during whole-genome amplification (WGA) [<xref ref-type="bibr" rid="CR10">10</xref>]. While previous methods rely on observational error models based on FP and FN rate parameters, we built an error model with two free parameters, the ADO rate (δ), and the amplification/sequencing error rate (ε). Compared with previous implementations, the advantage of this parameterization is that it can incorporate plausible situations such as an amplification/sequencing error converting a homozygous mutant into a heterozygous genotype. Due to its low probability of occurrence, we discard the possibility of observing more than one amplification/sequencing error at a given site. Still, we allow for the presence of both ADO and amplification/sequencing error in a single genotype. Instead of using a genotype error model, CellPhy can also use the Phred-scaled genotype likelihoods provided by single-cell variant callers.</p>
      <p id="Par8">We assume that the evolutionary history of a sample of cells can be appropriately portrayed as an unrooted binary tree and that all SNVs evolve in the same way and independently of each other. Given a set of single-cell SNV genotypes (provided by the user as a matrix in FASTA or PHYLIP format, or as a standard VCF file), CellPhy leverages its error and genotype models to compute the tree likelihood as a product of the independent probabilities across SNVs, using the standard Felsenstein pruning algorithm [<xref ref-type="bibr" rid="CR51">51</xref>, <xref ref-type="bibr" rid="CR52">52</xref>]. Conveniently, CellPhy does not need to assume any particular genotypic configuration at the root, like other programs. For example, SiFit assumes that the root of the tree is homozygous for the reference allele at all sites. Instead, the CellPhy tree can be easily rooted a posteriori using a particular set of cells as an outgroup (see [<xref ref-type="bibr" rid="CR51">51</xref>]). For example, if we study tumor cells, the outgroup could be one or more healthy cells.</p>
      <p id="Par9">We implemented CellPhy’s phylogenetic model in RAxML-NG [<xref ref-type="bibr" rid="CR48">48</xref>], a popular maximum likelihood (ML) framework in organismal phylogenetics. Therefore, to obtain ML estimates of the model parameters (substitution rates, ADO, and amplification/sequencing errors) and the cell tree, CellPhy leverages the optimization routines and tree search strategies of RAxML [<xref ref-type="bibr" rid="CR53">53</xref>] and RAxML-NG [<xref ref-type="bibr" rid="CR48">48</xref>]. The latter, for example, is known to work particularly well on large trees [<xref ref-type="bibr" rid="CR54">54</xref>]. The fact that CellPhy exploits RAxML-NG allows it to also calculate confidence values for the inner tree branches using either the standard [<xref ref-type="bibr" rid="CR55">55</xref>] or transfer [<xref ref-type="bibr" rid="CR56">56</xref>] bootstrap (BS) techniques. Moreover, CellPhy can perform ancestral state reconstruction [<xref ref-type="bibr" rid="CR57">57</xref>] to obtain ancestral ML genotypes and map mutations onto the branches of the ML tree. CellPhy is freely available, together with documentation, tutorials, and example data at <ext-link ext-link-type="uri" xlink:href="https://github.com/amkozlov/cellphy">https://github.com/amkozlov/cellphy</ext-link>.</p>
    </sec>
    <sec id="Sec4">
      <title>Validation and benchmarking</title>
      <p id="Par10">We benchmarked CellPhy against eight alternative methods for inferring cell phylogenies using SNV data (TNT, OncoNEM, SASC, SPhyR, infSCITE, SiFit, SCIPhI, and ScisTree), under multiple scenarios (Table <xref rid="MOESM1" ref-type="media">S1</xref>). These methods represent various approaches regarding the ISM assumption, the input data, the error model, the optimization criterion, the search algorithm, or the statistical paradigm. We do not consider other clustering methods that do not explicitly reconstruct cell phylogenies or require additional data (e.g., bulk sequencing data). Since SCARLET requires copy-number profile data, and single-cell CNVs are out of the scope of this study, we did not include this method in the comparison.</p>
    </sec>
    <sec id="Sec5">
      <title>Initial assessment of methods</title>
      <p id="Par11">We carried out an initial performance assessment to understand which methods were worth evaluating in detail. Three methods, OncoNEM, SASC, and SPhyR, already showed poor phylogenetic accuracy under ideal conditions (no errors) or relatively low noise levels (Fig. S<xref rid="MOESM1" ref-type="media">2</xref>). OncoNEM produced highly unresolved trees (i.e., 50 to 90% polytomies), with low phylogenetic accuracy under these (and other) simple scenarios. In addition, OncoNEM is extremely slow and cannot handle large data sets. Similarly, SASC showed poor phylogenetic accuracy, with many polytomies, and also extremely long running times. SPhyR, on the other hand, was more accurate (and faster) than OncoNEM and SASC, albeit clearly worse than the remaining competitor tools despite being executed with the “true” simulated error rates. Unfortunately, SPhyR suffered from memory corruption issues for most (simulated and empirical) datasets. Thus, we did not further evaluate OncoNEM, SASC, and SPhyR.</p>
    </sec>
    <sec id="Sec6">
      <title>Simulation 1: infinite-site model and low number of SNVs (“target-ISM”)</title>
      <p id="Par12">For a simple scenario with samples of 40 cells and 250–1000 SNVs evolved under an infinite-site mutation model, phylogenetic accuracy decreased rapidly for all methods with increasing levels of genotype error or ADO (Figs. <xref rid="Fig1" ref-type="fig">1</xref>, S<xref rid="MOESM1" ref-type="media">3</xref>–S<xref rid="MOESM1" ref-type="media">4</xref>). CellPhy was the most accurate method overall, although closely followed by SiFit and, to a lesser extent, by infSCITE, which performed worse when genotype errors were prevalent. TNT, a parsimony-based inference tool, was as accurate as CellPhy, SiFit, or infSCITE without ADO and genotype error, but worse otherwise. The genotype coding strategy (“keep,” “remove,” and “missing”; see the “<xref rid="Sec20" ref-type="sec">Methods”</xref> section) influenced accuracy only when genotype errors were present, with “missing” and “keep” being better than “remove” (see Figs. S<xref rid="MOESM1" ref-type="media">3</xref>-S<xref rid="MOESM1" ref-type="media">4</xref>).<fig id="Fig1"><label>Fig. 1</label><caption><p>Phylogenetic accuracy in simulation 1 (“target-ISM”) with 250 SNVs. Datasets consisted of 40 cells. Accuracy was evaluated under different levels of genotype error (ERR), allele dropout (ADO), and genotype recoding strategy “missing.” Phylogenetic accuracy is 1—nRF (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section). Boxplots were generated with the ggplot2 R package [<xref ref-type="bibr" rid="CR58">58</xref>] (<ext-link ext-link-type="uri" xlink:href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</ext-link>) with default parameters. Lower and upper hinges correspond to the first and third quartiles. The upper whisker extends from the hinge to the largest value no further than 1.5 * IQR (IQR is the interquartile range or distance between the first and third quartiles). The lower whisker extends from the hinge to the smallest value at most 1.5 * IQR of the hinge. Data points beyond the end of the whiskers are called “outlier” points and plotted individually</p></caption><graphic xlink:href="13059_2021_2583_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Simulation 2: finite-site model and large number of SNVs (“WGS-FSM”)</title>
      <p id="Par13">When we simulated larger data sets (100 cells, ~2000 SNVs) under a finite-site model of DNA evolution, overall phylogenetic accuracy increased for all methods. As before, all methods performed worse with higher levels of ADO or genotype error (Fig. <xref rid="Fig2" ref-type="fig">2</xref>). CellPhy was again most accurate overall, mainly when the data contained many genotype errors and ADO events. As in simulation 1, the “missing” coding strategy was slightly superior to “keep,” particularly with higher genotype error rates, and substantially better than “remove” (data not shown). Thus, for subsequent simulations, we only considered the “missing” strategy.<fig id="Fig2"><label>Fig. 2</label><caption><p>Phylogenetic reconstruction accuracy in simulation 2 (“WGS-FSM”). Datasets consisted of 100 cells and ~2000 SNVs. Accuracy was evaluated under different levels of genotype error (ERR), allelic dropout (ADO), and genotype coding strategies “missing.” Phylogenetic accuracy is 1—nRF (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section). See Fig. <xref rid="Fig1" ref-type="fig">1</xref> for an explanation of the boxplots</p></caption><graphic xlink:href="13059_2021_2583_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec8">
      <title>Simulation 3: mutational signatures and large number of SNVs (“WGS-sig”)</title>
      <p id="Par14">In simulation 3, we produced relatively large datasets (60 cells, 1000–4000 SNVs) under COSMIC trinucleotide mutational signatures 1 and 5, assuming an infinite-site model. The trends were as before, and CellPhy consistently outperformed the competing methods, especially with increasing levels of genotype error or ADO (Figs. S<xref rid="MOESM1" ref-type="media">5</xref>-S<xref rid="MOESM1" ref-type="media">6</xref>).</p>
    </sec>
    <sec id="Sec9">
      <title>Simulation 4: genotype likelihoods from NGS read counts (“NGS-like”)</title>
      <p id="Par15">Here, we simulated NGS data, and the input for tree inference consisted of read counts (SCIPhI and ScisTree), ML genotypes (CellPhy-ML and the remaining methods), or genotype likelihoods (CellPhy-GL). Across this scenario, with a realistic sequencing depth for single cells (5x), CellPhy performed much better than the competing methods, in particular under its genotype likelihood mode (“CellPhy-GL”) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>). At 30x and 100x, the accuracy differences were substantially more minor and CellPhy still performed as well as or better than the competing methods (Figs. S<xref rid="MOESM1" ref-type="media">7</xref>-S<xref rid="MOESM1" ref-type="media">8</xref>). ScisTree recovered highly inaccurate trees as the errors increased. Strikingly, the relative performance of SCIPhI and ScisTree worsened at 30× and fully degraded at 100× in the presence of single-cell noise.<fig id="Fig3"><label>Fig. 3</label><caption><p>Phylogenetic accuracy in simulation 4 (“NGS-like”) at 5x. Datasets consisted of 40 cells and 1000–2000 SNVs. TNT, SiFit, and CellPhy-ML16 use the inferred genotypes, CellPhy-GL16 uses genotype likelihoods, and SCIPhI and ScisTree use read counts. Phylogenetic accuracy is 1—nRF (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section). AMP is the amplification error rate, SEQ is the sequencing error rate, and ADO is the allelic dropout rate. See Fig. <xref rid="Fig1" ref-type="fig">1</xref> for an explanation of the boxplots</p></caption><graphic xlink:href="13059_2021_2583_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec10">
      <title>Simulation 5: NGS doublets</title>
      <p id="Par16">In many single-cell experiments, cell doublets can be relatively common [<xref ref-type="bibr" rid="CR24">24</xref>], so we also assessed their effect. As expected, the presence of cell doublets reduced phylogenetic accuracy for all methods. Still, CellPhy was the most accurate method, particularly in the presence of ADO and amplification errors (Fig. S<xref rid="MOESM1" ref-type="media">9</xref>).</p>
    </sec>
    <sec id="Sec11">
      <title>Simulation 6: NGS for large numbers of cells and SNVs</title>
      <p id="Par17">We assessed phylogenetic accuracy on large scDNA-seq datasets, with up to 1000 cells and 50,000 SNVs, without doublets. Here we could not evaluate infSCITE, as jobs were still running after 1 month. For the largest datasets, we could not obtain results for SCIPhI and ScisTree after running jobs for several days. CellPhy generally outperformed the competing methods, with rapidly increasing accuracy as a function of the number of SNVs, benefiting further from the use of genotype likelihoods (Fig. <xref rid="Fig4" ref-type="fig">4</xref>). Remarkably, SCIPhI showed a constant accuracy of ~0.4 across conditions. However, we noted that the SCIPhI trees contained many unresolved nodes, which decreases the possibility of false positives. Moreover, SCIPhI’s accuracy decreased with more SNVs, highlighting a systematic bias.<fig id="Fig4"><label>Fig. 4</label><caption><p>Phylogenetic reconstruction accuracy in simulation 6 (“NGS-large”). Mutations were introduced according to signature S1, and the sequencing depth was 5x. Read counts were simulated with a 5% amplification error, 1% sequencing error, and 10% ADO. TNT, SiFit, and CellPhy-ML16 use the inferred genotypes, CellPhy-GL16, uses genotype likelihoods, and SCIPhI and ScisTree use read counts. Phylogenetic accuracy is 1—nRF (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section). For more than 1000 SNVs or more than 100 cells, only ten replicates were run for SiFit for reasonable running times. The (light) orange stars indicate that we could not obtain SCIPhI and ScisTree results for the largest datasets after running each replicate for &gt;100 h. CellPhy was run using the ML genotypes error model (CellPhy-ML) and genotype likelihoods (CellPhy-GL). See Fig. <xref rid="Fig1" ref-type="fig">1</xref> for an explanation of the boxplots.</p></caption><graphic xlink:href="13059_2021_2583_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec12">
      <title>Estimation of genotype error and ADO rates</title>
      <p id="Par18">Besides inferring the ML tree, CellPhy can calculate ML estimates for the genotyping error and the ADO rate of scDNA-seq datasets. Across the different simulation scenarios described above, CellPhy estimated the genotyping error quite accurately (MSE: 0.00003–0.002), with a slight over or underestimation when its actual value was below/above 5%, respectively (Fig. S<xref rid="MOESM1" ref-type="media">10</xref>A). The ML estimates of ADO were more variable and tended to underestimate the actual value (MSE = 0.002–0.02), but were still generally accurate, particularly at higher rates (Fig. S<xref rid="MOESM1" ref-type="media">10</xref>B). As expected, in both cases, improved estimates were obtained with larger datasets comprising more SNVs.</p>
    </sec>
    <sec id="Sec13">
      <title>Computational speed</title>
      <p id="Par19">We compared the speed of the different methods by recording the running times for six simulated and two empirical data sets (Fig. <xref rid="Fig5" ref-type="fig">5</xref>). TNT was the fastest method by at least two orders of magnitude, which is not surprising as parsimony scores are substantially cheaper to compute than likelihood scores. After TNT, CellPhy under both ML and GL models, and ScisTree—CellPhy being faster than ScisTree on larger data sets—were second-fastest, approximately one to two orders of magnitude faster than SiFit, SCIPhI, or infSCITE. For some of the most extensive data sets, including simulated and empirical data, infSCITE did not finish after several days. Regarding the methods discarded during simulation 1, OncoNEM and SASC were slower than infSCITE, and SPhyR crashed before finishing the speed benchmark due to memory allocation issues (data not shown). As expected, running 100 bootstrap replicates (+BS) increased computational time by 1–2 orders of magnitude for CellPhy, but only by one order of magnitude or less for TNT (Fig. S<xref rid="MOESM1" ref-type="media">11</xref>). Still, the single-threaded version of CellPhy with 100 bootstrap replicates is faster than infSCITE. Furthermore, running CellPhy with several threads reduces its time-to-completion by one order of magnitude on a modern multicore machine (Fig. S<xref rid="MOESM1" ref-type="media">11</xref>).<fig id="Fig5"><label>Fig. 5</label><caption><p>Speed comparisons for simulated and real datasets. “Sim1” corresponds to a simulated single-cell dataset with 40 cells and 4753 SNVs. “Sim2” corresponds to a simulated dataset with 100 cells and 9935 SNVs. “Sim3” corresponds to a simulated dataset with 60 cells and 9982 SNVs. “Sim4” corresponds to a simulated dataset with 40 cells and 3986. “Sim6-100” corresponds to a simulated dataset with 100 cells and 1000 SNVs. “Sim6-500” corresponds to a simulated dataset with 500 cells and 1000 SNVs. CRC24 and L86 correspond to two empirical datasets (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section). Note the logarithmic time scale on the <italic>y</italic>-axis</p></caption><graphic xlink:href="13059_2021_2583_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec14">
      <title>Application to single-cell data</title>
      <sec id="Sec15">
        <title>Phylogenetic reconstruction of a colorectal cancer</title>
        <p id="Par20">We analyzed a single-cell WGS dataset (CRC24) produced in our lab, consisting of 24 cells collected from two primary tumor biopsies of a patient with colorectal cancer (CRC). After filtering out germline polymorphisms, SNVs in non-diploid regions, and low-quality variants (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section), we identified a total of 17,851 SNVs, of which 126 were exonic (Fig. S<xref rid="MOESM1" ref-type="media">12</xref>). The high quality of these data is supported by the fact that the variant allele frequency distribution (VAF) derived from the single-cell SNVs is very similar to the VAF obtained from the bulk samples (Fig. S<xref rid="MOESM1" ref-type="media">13</xref>). Some SNVs occurred in established CRC driver genes, such as <italic>APC</italic>, <italic>BRAF</italic>, <italic>BRCA2</italic>, <italic>LRP1B</italic>, and <italic>MAP2K4</italic>, although they were intronic. In the ML tree estimated by CellPhy using the genotype likelihoods (“CellPhy-GL” model) (Fig. <xref rid="Fig6" ref-type="fig">6A</xref>), cells tended to group according to their geographical location and phenotype, although not in a perfect fashion. Some of these relationships are well supported by the data, as reflected by several high bootstrap values, but others are not. This heterogeneous support illustrates one of the convenient features of CellPhy: it can provide phylogenetic confidence measurements for different parts of the tree. Interestingly, in the tumor interior region (TI), non-stem cells had longer branch lengths than stem cells, suggesting a potential difference in evolutionary rate between these two cell types [<xref ref-type="bibr" rid="CR59">59</xref>–<xref ref-type="bibr" rid="CR61">61</xref>]. We mapped the non-synonymous mutations onto the internal branches of the tree using a custom script (see the “<xref rid="Sec20" ref-type="sec">Methods</xref>” section). We found that all tumor cells share the vast majority of these mutations (i.e., they are clonal), including variants affecting genes previously associated with CRC progression (e.g., <italic>INPP1</italic>, <italic>CDC5L</italic>, <italic>ROR2</italic>, <italic>EXOSC5</italic>) [<xref ref-type="bibr" rid="CR62">62</xref>–<xref ref-type="bibr" rid="CR65">65</xref>]. The tree topologies inferred by SiFit, SCIPhI, infSCITE, ScisTree, and TNT (Fig. S14) were distinct from the topology inferred by CellPhy (nRF=0.86, 0.59, 0.50, 0.64, and 0.68, respectively), but with a similar, albeit not identical, overall pattern regarding geography and cell type. Unfortunately, for the infSCITE, SiFit, SCIPhI, and ScisTree, the absence of branch support measures makes it impossible to determine which parts of the estimated trees can be trusted.<fig id="Fig6"><label>Fig. 6</label><caption><p>CellPhy tree for the CRC24 and L86 datasets. <bold>A</bold> “CellPhy-GL” CRC24 tree. Distinct shapes and colors represent cell type: healthy (blue circle); tumor-non-stem from the tumor inferior (TI) region (dark green triangle), tumor-stem from TI region (light green square), tumor-non-stem from the tumor middle (TM) region (dark purple triangle), and tumor-stem from the TM region (light purple square). Only bootstrap support values above 50 are shown. Non-synonymous mutations are displayed on internal branches. <bold>B</bold> “CellPhy-GL” L86 tree. Distinct shapes and colors represent cell type: healthy diploid cells—from both primary and metastatic sites—(dark purple circle), healthy diploid cells missorted (light purple circle), primary tumor aneuploid cells (light orange square), and metastatic aneuploid cells (dark orange square). Only bootstrap values above 50 are shown</p></caption><graphic xlink:href="13059_2021_2583_Fig6_HTML" id="MO6"/></fig></p>
      </sec>
      <sec id="Sec16">
        <title>Revisiting the evolutionary history of a metastatic colorectal cancer</title>
        <p id="Par21">We also explored a published dataset from metastatic colorectal cancer patient CRC2 in Leung et al. [<xref ref-type="bibr" rid="CR21">21</xref>]. In that study, after performing custom targeted sequencing of 182 single cells sampled from primary and metastatic lesions, the authors derived a cell tree using SCITE. They inferred a polyclonal seeding of liver metastases (i.e., distinct populations of tumor cells migrated from the primary tumor towards the liver). However, their findings have been recently re-evaluated in two different studies. Zafar et al. [<xref ref-type="bibr" rid="CR36">36</xref>] used the newly developed SiCloneFit, which relaxes the infinite-sites assumption, and proposed a polyclonal seeding of the metastases. More recently, Satas et al. [<xref ref-type="bibr" rid="CR32">32</xref>] performed a joint analysis of SNVs and copy-number variants (CNVs) with SCARLET and concluded instead that a single clone seeded the liver metastasis. Our analysis focuses on cancer history, so we removed most of the healthy cells in the original dataset to speed up computation, ending with 86 cells (L86 data set) that we used for CNV and SNV calling. SC-Caller [<xref ref-type="bibr" rid="CR66">66</xref>] identified 598 SNVs distributed over the genome portion not affected by CNVs, including several variants detected in the original study (e.g., <italic>LINGO2</italic>, <italic>IL7R</italic>, <italic>MYH11</italic>, <italic>FUS</italic>, <italic>PTPRD</italic>, <italic>LRP1B</italic>, <italic>TSHZ3</italic>), as well as other mutations affecting essential driver genes in CRC (e.g., <italic>APC</italic>, <italic>TP53</italic>, <italic>NRAS</italic>). Note that our set of SNVs only overlaps partially with the one in Leung et al., which is not surprising given that we used a different pipeline and a subset of their cells.</p>
        <p id="Par22">In the CellPhy tree, all metastatic cells clustered together with high support, indicating a monoclonal origin of the liver metastasis (Fig. <xref rid="Fig6" ref-type="fig">6B</xref>). Interestingly, some primary (PA-54 and PA-27) and metastatic aneuploid (MA-25 and MA-26) cells appear intermixed with healthy diploid cells; these correspond to cells mislabeled during FACS sorting, as previously noted by the authors. Furthermore, after mapping the non-synonymous mutations onto the internal branches of the CellPhy tree (Fig. S<xref rid="MOESM1" ref-type="media">15</xref>), we found that all cancer cells harbor somatic variants affecting genes that can contribute to human intestinal neoplasia (i.e., <italic>MYH11</italic> and <italic>STAG1</italic>) [<xref ref-type="bibr" rid="CR67">67</xref>, <xref ref-type="bibr" rid="CR68">68</xref>]. Apart from CellPhy, SCIPhI, and ScisTree also recovered a single metastatic clade (Fig. S<xref rid="MOESM1" ref-type="media">16</xref>). Although in the SiFit tree, most metastatic cells cluster together, some of them appear intermixed with the primary tumor cells. In the infSCITE and TNT trees, the tumor cells did not form a clade, a result that does not appear to be realistic.</p>
      </sec>
      <sec id="Sec17">
        <title>Applicability of CellPhy to non-cancer data and bulk clonal sequences</title>
        <p id="Par23">Finally, we used CellPhy to analyze two non-cancer WGS single-cell datasets. The first of these datasets (E15) consists of 242 somatic SNVs from 15 single neurons from a healthy individual [<xref ref-type="bibr" rid="CR69">69</xref>]. In the CellPhy tree built using genotype likelihoods (Fig. S<xref rid="MOESM1" ref-type="media">17</xref>A), different lineages seem to exhibit highly different evolutionary rates. However, most branches had low bootstrap support (&lt;50%), suggesting that more SNVs are required before making reliable interpretations. All other methods recovered very distinct trees (Fig. S<xref rid="MOESM1" ref-type="media">17</xref>B-F), and in the case of TNT, also with shallow bootstrap values. Unfortunately, infSCITE, SiFit, SCIPhI, and ScisTree do not assess branch support for cell trees.</p>
        <p id="Par24">The second dataset (LS140) consists of 140 single cell-derived human hematopoietic stem and progenitor colonies from a healthy individual [<xref ref-type="bibr" rid="CR15">15</xref>]. In this case, because there is no single-cell genome amplification involved, we expect a minimal genotype error and no ADO. Remarkably, CellPhy ML estimates for this data set were zero for both error and ADO parameters. The CellPhy tree shows very high bootstrap values (Fig. S<xref rid="MOESM1" ref-type="media">18</xref>), highlighting the quality of this dataset, which has a strong phylogenetic signal. We expected this result given that the dataset has 127,884 SNVs and lacks single-cell biases. Moreover, our analysis confirms an early, well-supported divergence of the cell colonies into two distinct groups, together with a lack of geographical structure, hence reinforcing the idea of a continuous redistribution of stem cell pools at the whole-body level.</p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec18">
    <title>Discussion</title>
    <p id="Par25">We have developed CellPhy, a phylogenetic tool for analyzing single-cell SNV data inspired by existing models and methods in statistical phylogenetics. Unlike most of its competitors, CellPhy does not assume an infinite-site model of evolution, a widespread postulate in somatic evolution challenged by recent studies [<xref ref-type="bibr" rid="CR27">27</xref>, <xref ref-type="bibr" rid="CR70">70</xref>]. CellPhy’s evolutionary model explicitly considers all 16 possible phased DNA genotypes—but can work with both phased and unphased data—and can also account for their uncertainty by using genotype likelihoods as input. Furthermore, CellPhy can directly estimate single-cell error and ADO rates from the genotypes if the genotype likelihoods are unavailable. Finally, CellPhy can reconstruct ancestral states, predict mutations on tree branches, and provide a statistical measure of branch support. To benchmark CellPhy, we conducted computer simulations under different scenarios with varying degrees of complexity. Unlike in previous comparisons [<xref ref-type="bibr" rid="CR25">25</xref>–<xref ref-type="bibr" rid="CR28">28</xref>], we consider more realistic somatic genealogies by sampling sets of cells from a growing population. Demographic growth results in more difficult-to-reconstruct phylogenies, with shorter internal and longer terminal branches that require hundreds of SNVs to be accurately inferred.</p>
    <p id="Par26">Overall, CellPhy was the most accurate method, under infinite- and finite-site mutation models with different mutational patterns (e.g., using COSMIC trinucleotide mutational signatures), mainly when genotype errors and ADO were common, which is often the case for scDNA-seq data. Our simulations suggest that accounting for SNV calling uncertainty is essential when sequencing depth is low to moderate, which is typically the case for single-cell WGS due to the sequencing costs. With a 5x sequencing depth, the ability to account for genotype uncertainty makes CellPhy substantially more accurate than its competitors. Notably, the accuracy of CellPhy does not come at the cost of speed. CellPhy is one to two orders of magnitude faster than SiFit, infSCITE, or SCIPhI. Although, as expected, parsimony-based TNT was by far the fastest tool, this comes at the cost of considerably worse accuracy under most scenarios. Moreover, CellPhy allows multi-threading, so running times could be considerably shorter if a multi-core computer—very common nowadays—is used, even with bootstrapping. CellPhy’s bootstrap analyses illustrate the importance of explicitly considering phylogenetic uncertainty. Without such a measure, one cannot assess if the data support the estimated phylogeny. Further, the analysis of cell colonies shows that CellPhy can also be used to estimate trees from clonal sequences that do not necessarily correspond to amplified single-cells. As expected, and as shown in previous studies (e.g., [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR28">28</xref>]), cell doublets can be detrimental for single-cell phylogenetic reconstruction. When doublets are likely to occur in the data, specific scDNA-seq doublet detection methods might be used to remove suspicious cells [<xref ref-type="bibr" rid="CR71">71</xref>].</p>
    <p id="Par27">Our results suggest that CellPhy is an efficient tool for estimating phylogenetic trees from scDNA-seq data. It is important to note that to achieve high phylogenetic accuracy under realistic conditions (i.e., growing populations with long terminal branches), CellPhy requires a reasonably high number of SNVs (hundreds to tens of thousands, depending on the number of cells). However, as can be seen in our benchmark, this limitation is common to all methods. It reflects the fundamental problem of poor signal-to-noise ratio: the faster the cell population grows, the more cells we have, and the higher the single-cell error and ADO rates are, the more SNVs are needed to recover the true cell relationships. We expect that further improvements in single-cell sequencing accuracy, variant calling sensitivity, and genotype phasing will yield datasets that are better suited for phylogenetic inference. Furthermore, some common simplifying assumptions of the classical phylogenetic models (reversibility, stationarity, context-independence) could be particularly problematic in the context of somatic evolution, which takes place at a much shorter temporal scale. Albeit methodologically and computationally demanding, eliminating those assumptions could improve accuracy on scDNA-seq datasets with a weak phylogenetic signal. Finally, another critical challenge for the future, particularly relevant for cancer data, will be developing models that simultaneously take into account SNVs and CNVs. While more or less simple methods have been proposed [<xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR34">34</xref>, <xref ref-type="bibr" rid="CR40">40</xref>, <xref ref-type="bibr" rid="CR72">72</xref>], a full SNV + CNV phylogenetic Markov model is not trivial because copy number variants can overlap, breaking the site independence assumption typical of many phylogenetic models, including CellPhy.</p>
  </sec>
  <sec id="Sec19">
    <title>Conclusions</title>
    <p id="Par28">The main focus of CellPhy, and its principal output, is the estimation of cell lineage trees. Our extensive simulations show that CellPhy can produce accurate cell phylogenies for small and large scDNA-seq SNV datasets within a reasonable timeframe. Cell phylogenies encode information regarding temporal diversification, demographic history, migration, and adaptation and can shed light on multiple aspects of cell biology [<xref ref-type="bibr" rid="CR11">11</xref>]. CellPhy’s model is a step forward towards more realistic models of somatic genotype evolution and can be applied to any population of somatic cells that divide asexually. Therefore, the use of CellPhy is not limited to cancer cells, as it could also be applied to normal cells, for example, to better understand human development [<xref ref-type="bibr" rid="CR13">13</xref>–<xref ref-type="bibr" rid="CR16">16</xref>].</p>
  </sec>
  <sec id="Sec20">
    <title>Methods</title>
    <sec id="Sec21">
      <title>The CellPhy model</title>
      <sec id="Sec22">
        <title>Model of nucleotide substitution for phased/unphased diploid genotypes</title>
        <p id="Par29">We developed a substitution model for diploid genotypes akin to those typically used for DNA sequences in organismal phylogenetics ([see [<xref ref-type="bibr" rid="CR51">51</xref>]). Specifically, we built a finite-site, continuous-time, Markov model of genotype evolution considering all possible 16 phased diploid states <italic>Γ</italic>= {A|A, A|C, A|G, A|T, C|A, C|C, C|G, C|T, G|A, G|C, G|G, G|T, T|A, T|C, T|G, T|T}, in which SNVs are independent and identically distributed. This model, named GT16, is defined by a rate matrix <italic>Q</italic> that contains the instantaneous transition rates q<italic>X</italic>↔<italic>Y</italic> among genotypes <italic>X</italic> and <italic>Y</italic>. For computational convenience, we assume a time-reversible process, in which case the <italic>Q</italic> matrix is the product of a symmetric exchangeability matrix <italic>R</italic> (r<italic>X</italic>↔<italic>Y</italic> = r<italic>Y</italic>↔<italic>X</italic>) and a diagonal matrix of stationary genotype frequencies π<sub><italic>X</italic></sub><italic>:</italic><disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$Q=R\cdotp \mathit{\operatorname{diag}}\left({\pi}_{A\mid \mathrm{A}},{\pi}_{A\mid C},\dots, {\pi}_{T\mid T}\right)$$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo>·</mml:mo><mml:mo mathvariant="italic">diag</mml:mo><mml:mfenced close=")" open="(" separators=",,,"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">A</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>A</mml:mi><mml:mo>∣</mml:mo><mml:mi>C</mml:mi></mml:mrow></mml:msub><mml:mo>…</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mo>∣</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mfenced></mml:math><graphic xlink:href="13059_2021_2583_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par30">We assume that only one of the two alleles in a genotype can change in an infinitesimal amount of time. Furthermore, because maternal and paternal chromosomes evolve independently in somatic cells, we also assume that the instantaneous transition rate of a given allele <italic>a</italic> in genotype <italic>X</italic> to allele <italic>b</italic> in genotype <italic>Y</italic> does not depend on the identity of the homologous allele <italic>n</italic> within the respective genotypes. In other words, we assume r(<italic>na</italic>↔<italic>nb)</italic> = r(<italic>b</italic>↔<italic>a)</italic>. Conveniently, these assumptions significantly reduce the number of free parameters in the <italic>Q</italic> matrix, as we only need to consider five nucleotide exchangeabilities (α <italic>= r</italic>(<italic>A</italic>↔<italic>C)</italic>, <italic>β = r</italic>(<italic>A</italic>↔<italic>G)</italic>, γ<italic>= r</italic>(<italic>A</italic>↔<italic>T)</italic>, <italic>κ = r</italic>(<italic>C</italic>↔<italic>G)</italic>, λ <italic>= r</italic>(<italic>C</italic>↔<italic>T)</italic>; <italic>let</italic> μ <italic>= r</italic>(<italic>G</italic>↔<italic>T) = 1</italic>) and 15 stationary-phased genotype frequencies (π<sub>A|A</sub>, π<sub>A|C</sub>, π<sub>A|G</sub>, π<sub>A|T</sub>, π<sub>C|A</sub>, π<sub>C|C</sub>, π<sub>C|G</sub>, π<sub>C|T</sub>, π<sub>G|A</sub>, π<sub>G|C</sub>, π<sub>G|G</sub>, π<sub>G|T</sub>, π<sub>T|A</sub>, π<sub>T|C</sub>, π<sub>T|G</sub>; π<sub>T|T</sub>= 1 - ∑π<sub>X</sub>):</p>
        <p id="Par313"><inline-graphic xlink:href="13059_2021_2583_Figa_HTML.gif" id="d32e1213"/> (2)</p>
        <p id="Par31">The <italic>Q</italic> matrix gives us the probabilities of changing from one genotype to another in an infinitely small time interval. When two genotypes differ at more than one nucleotide, these rates are 0. To calculate the tree likelihood, we first need to compute the change probabilities from the beginning to the end of each branch. The probabilities of changing from a given genotype to another along a branch of length <italic>t</italic> (in units of expected number of mutations per SNV site) are given by:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P(t)={e}^{Qt}$$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mi>P</mml:mi><mml:mfenced close=")" open="("><mml:mi>t</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mi mathvariant="italic">Qt</mml:mi></mml:msup></mml:math><graphic xlink:href="13059_2021_2583_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par32">The resulting matrix <italic>P(t)</italic> is known as the transition probability matrix, and all its entries are (small) positive values. For further details, we refer the reader to Felsenstein [<xref ref-type="bibr" rid="CR51">51</xref>] and Yang [<xref ref-type="bibr" rid="CR73">73</xref>].</p>
        <p id="Par33">Notably, the GT16 model can also work with unphased genotype data simply by assigning the same relative likelihood at the tips of the tree to the two possible resolutions of the phase for the observed genotype (see Table S2). This flexibility is relevant because current scDNA-seq techniques do not reveal the phase of the genotypes (i.e., we do not know which allele is located in the maternal or paternal chromosome). Therefore, in our simulations (see below), the simulated genotypes will always be unphased.</p>
        <p id="Par34">In addition to the GT16 model, we also implemented a model for unphased genotypes with only ten states, called GT10 (see Supplementary Note <xref rid="MOESM1" ref-type="media">2</xref> for details). The GT10 model is computationally less expensive, approximately twice as fast as GT16. To maintain the reversibility assumption—otherwise, the calculations are much more complex—the GT10 model assumes that the probability of change between homozygous and heterozygous genotypes is equivalent. However, this is incorrect, as the change from homozygote to heterozygote is twice as likely as the change from heterozygote to homozygote. Despite this theoretical flaw, GT10 and GT16 showed very similar tree inference accuracy in our experiments.</p>
      </sec>
      <sec id="Sec23">
        <title>Single-cell genotype error model</title>
        <p id="Par35">We assume that the true genotypes are always diploid and biallelic. To incorporate errors in the observed genotypes arising during single-cell whole-genome amplification (scWGA) and sequencing, we consider two free parameters: the allelic dropout (ADO) rate (δ) and the amplification/sequencing error (ERR) rate (ε).</p>
        <p id="Par36">Allele dropout occurs during scWGA when one of the two alleles is not amplified and is absent from the sequencing library. ADO always implies a single allele in our model, as if both alleles drop, no reads would be available, and no genotype could be observed (i.e., it would be “missing”). Therefore, δ is the probability that the amplification of one or the other allele has failed and thus that we observe the homozygous genotype defined by the amplified allele. Given the phased genotype <italic>a</italic>|<italic>b</italic>, and with “_” indicating the dropped allele, we define the ADO rate as:<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta =\mathrm{P}\left(\_\left|b\left|a\left|b\right.\right.\right.\right)+\mathrm{P}\left(a\left|\_\left|a\left|b\right.\right.\right.\right),$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mo>_</mml:mo><mml:mfenced open="|"><mml:mrow><mml:mi>b</mml:mi><mml:mfenced open="|"><mml:mrow><mml:mi>a</mml:mi><mml:mfenced open="|"><mml:mi>b</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>+</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>a</mml:mi><mml:mfenced open="|"><mml:mrow><mml:mo>_</mml:mo><mml:mfenced open="|"><mml:mrow><mml:mi>a</mml:mi><mml:mfenced open="|"><mml:mi>b</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="13059_2021_2583_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <italic>P</italic> (<italic>Y</italic>|<italic>X</italic>) is the probability of observing genotype <italic>Y</italic> after sequencing, given the true genotype <italic>X</italic>.</p>
        <p id="Par38">Genotype errors other than ADO can result from polymerase errors during scWGA, in the course of sequencing, variant calling, or generally represent an incorrect allele. Importantly, we assume a maximum of one ERR per genotype. Given that <italic>ε</italic> tends to be small, in the order of 10<sup>-3</sup> to 10<sup>-5</sup> [<xref ref-type="bibr" rid="CR74">74</xref>], the probability of two ERR in one genotype, ε<sup>2</sup>, is negligible. Specifically, ε is the probability that allele <italic>a</italic> will be observed as another allele <italic>b</italic> ≠ <italic>a</italic>:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varepsilon =\mathrm{P}\left(b\left|a\right.\right)$$\end{document}</tex-math><mml:math id="M8" display="block"><mml:mi>ε</mml:mi><mml:mo>=</mml:mo><mml:mi mathvariant="normal">P</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>b</mml:mi><mml:mfenced open="|"><mml:mi>a</mml:mi></mml:mfenced></mml:mrow></mml:mfenced></mml:math><graphic xlink:href="13059_2021_2583_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par39">Note that we allow for the presence of both ADO and ERR in the same observed genotype. Under these assumptions, if the true genotype is homozygous <italic>a</italic>|<italic>a</italic>, for phased genotypes <italic>P</italic> (<italic>Y</italic>|<italic>X</italic>) becomes:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\space(a\vert a \space\vert\space a \vert a)=1-\varepsilon +\space\raisebox{1ex}{$1$}\!/ \!\space\raisebox{-1ex}{$2$}\space\delta \varepsilon$$\end{document}</tex-math><mml:math id="M10"><mml:mi>P</mml:mi><mml:mtext/><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mi>a</mml:mi><mml:mtext/><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mtext/><mml:mi>a</mml:mi><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mtext>ε</mml:mtext></mml:mrow><mml:mo>+</mml:mo><mml:msup><mml:mtext/><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="negativethinmathspace"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mspace width="negativethinmathspace"/><mml:msub><mml:mtext/><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mtext/><mml:mi>δ</mml:mi><mml:mrow><mml:mtext>ε</mml:mtext></mml:mrow></mml:math><graphic xlink:href="13059_2021_2583_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\space(a\vert b \space\vert\space a \vert a)=\left(1-\delta \right)\cdot\space\raisebox{1ex}{$1$}\!/\space \!\raisebox{-1ex}{$6$}\space\varepsilon$$\end{document}</tex-math><mml:math id="M12"><mml:mi>P</mml:mi><mml:mtext/><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mi>b</mml:mi><mml:mtext/><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mtext/><mml:mi>a</mml:mi><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msup><mml:mtext/><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="negativethinmathspace"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mtext/><mml:msub><mml:mspace width="negativethinmathspace"/><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mtext/><mml:mrow><mml:mtext>ε</mml:mtext></mml:mrow></mml:math><graphic xlink:href="13059_2021_2583_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\space(b\vert b \space\vert\space a \vert a)=\space\raisebox{1ex}{$1$}\!/ \!\space\raisebox{-1ex}{$6$} \space \delta \varepsilon$$\end{document}</tex-math><mml:math id="M14"><mml:mi>P</mml:mi><mml:mtext/><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mi>b</mml:mi><mml:mtext/><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mtext/><mml:mi>a</mml:mi><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mtext/><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mspace width="negativethinmathspace"/><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mspace width="negativethinmathspace"/><mml:msub><mml:mtext/><mml:mrow><mml:mn>6</mml:mn></mml:mrow></mml:msub><mml:mtext/><mml:mi>δ</mml:mi><mml:mrow><mml:mtext>ε</mml:mtext></mml:mrow></mml:math><graphic xlink:href="13059_2021_2583_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par40">Likewise, if the true genotype is heterozygous <italic>a|b</italic>, <italic>P</italic> (<italic>Y</italic>|<italic>X</italic>) can be shown to be:</p>
        <p id="Par41">
          <disp-formula id="Equ9">
            <label>9</label>
            <alternatives>
              <tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\space(a\vert a \space\vert\space a \vert b)=\space \raisebox{1ex}{$1$}\!/ \!\space\raisebox{-1ex}{$2$} \space\delta \space + \space \raisebox{1ex}{$1$}\!/ \!\space\raisebox{-1ex}{$6$}\space\varepsilon \space - \space\raisebox{1ex}{$1$}\!/ \!\space\raisebox{-1ex}{$3$}\space \delta \varepsilon$$\end{document}</tex-math>
              <mml:math id="M16">
                <mml:mi>P</mml:mi>
                <mml:mtext/>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>a</mml:mi>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
                <mml:mi>a</mml:mi>
                <mml:mtext/>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
                <mml:mtext/>
                <mml:mi>a</mml:mi>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
                <mml:mi>b</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mtext/>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mspace width="negativethinmathspace"/>
                <mml:mrow>
                  <mml:mo>/</mml:mo>
                </mml:mrow>
                <mml:mspace width="negativethinmathspace"/>
                <mml:msub>
                  <mml:mtext/>
                  <mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mtext/>
                <mml:mi>δ</mml:mi>
                <mml:mtext/>
                <mml:mo>+</mml:mo>
                <mml:msup>
                  <mml:mtext/>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mspace width="negativethinmathspace"/>
                <mml:mrow>
                  <mml:mo>/</mml:mo>
                </mml:mrow>
                <mml:mspace width="negativethinmathspace"/>
                <mml:msub>
                  <mml:mtext/>
                  <mml:mrow>
                    <mml:mn>6</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mtext/>
                <mml:mrow>
                  <mml:mtext>ε</mml:mtext>
                </mml:mrow>
                <mml:mtext/>
                <mml:mo>−</mml:mo>
                <mml:msup>
                  <mml:mtext/>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mspace width="negativethinmathspace"/>
                <mml:mrow>
                  <mml:mo>/</mml:mo>
                </mml:mrow>
                <mml:mspace width="negativethinmathspace"/>
                <mml:msub>
                  <mml:mtext/>
                  <mml:mrow>
                    <mml:mn>3</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mtext/>
                <mml:mi>δ</mml:mi>
                <mml:mrow>
                  <mml:mtext>ε</mml:mtext>
                </mml:mrow>
              </mml:math>
              <graphic xlink:href="13059_2021_2583_Article_Equ9.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
          <disp-formula id="Equ10">
            <label>10</label>
            <alternatives>
              <tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\space(c\vert c \space\vert\space a\vert b)=\space \raisebox{1ex}{$1$}\!/ \!\space \raisebox{-1ex}{$6$} \space \delta \varepsilon$$\end{document}</tex-math>
              <mml:math id="M18">
                <mml:mi>P</mml:mi>
                <mml:mtext/>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>c</mml:mi>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
                <mml:mi>c</mml:mi>
                <mml:mtext/>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
                <mml:mtext/>
                <mml:mi>a</mml:mi>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
                <mml:mi>b</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mtext/>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mspace width="negativethinmathspace"/>
                <mml:mrow>
                  <mml:mo>/</mml:mo>
                </mml:mrow>
                <mml:mspace width="negativethinmathspace"/>
                <mml:msub>
                  <mml:mtext/>
                  <mml:mrow>
                    <mml:mn>6</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mtext/>
                <mml:mi>δ</mml:mi>
                <mml:mrow>
                  <mml:mtext>ε</mml:mtext>
                </mml:mrow>
              </mml:math>
              <graphic xlink:href="13059_2021_2583_Article_Equ10.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
          <disp-formula id="Equ11">
            <label>11</label>
            <alternatives>
              <tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\space(a\vert c \space\vert\space a\vert b)=(1-\delta)\cdot \space\raisebox{1ex}{$1$}\!/ \space\!\raisebox{-1ex}{$6$}\space\varepsilon$$\end{document}</tex-math>
              <mml:math id="M20">
                <mml:mi>P</mml:mi>
                <mml:mtext/>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>a</mml:mi>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
                <mml:mi>c</mml:mi>
                <mml:mtext/>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
                <mml:mtext/>
                <mml:mi>a</mml:mi>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
                <mml:mi>b</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>−</mml:mo>
                <mml:mi>δ</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>⋅</mml:mo>
                <mml:msup>
                  <mml:mtext/>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:msup>
                <mml:mspace width="negativethinmathspace"/>
                <mml:mrow>
                  <mml:mo>/</mml:mo>
                </mml:mrow>
                <mml:mtext/>
                <mml:msub>
                  <mml:mspace width="negativethinmathspace"/>
                  <mml:mrow>
                    <mml:mn>6</mml:mn>
                  </mml:mrow>
                </mml:msub>
                <mml:mtext/>
                <mml:mrow>
                  <mml:mtext>ε</mml:mtext>
                </mml:mrow>
              </mml:math>
              <graphic xlink:href="13059_2021_2583_Article_Equ11.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
          <disp-formula id="Equ12">
            <label>12</label>
            <alternatives>
              <tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\space(a\vert b \space\vert\space a\vert b)=(1-\delta)\cdot (1-\varepsilon )$$\end{document}</tex-math>
              <mml:math id="M22">
                <mml:mi>P</mml:mi>
                <mml:mtext/>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>a</mml:mi>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
                <mml:mi>b</mml:mi>
                <mml:mtext/>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
                <mml:mtext/>
                <mml:mi>a</mml:mi>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
                <mml:mi>b</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>−</mml:mo>
                <mml:mi>δ</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>⋅</mml:mo>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>−</mml:mo>
                <mml:mrow>
                  <mml:mtext>ε</mml:mtext>
                </mml:mrow>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:math>
              <graphic xlink:href="13059_2021_2583_Article_Equ12.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p id="Par42">For the remaining scenarios, given the assumptions of the error model, <italic>P</italic> (<italic>Y</italic>|<italic>X</italic>) is zero. See Supplementary Material Note <xref rid="MOESM1" ref-type="media">1</xref> for a detailed explanation.</p>
        <p id="Par43">Given the observed genotype <italic>Y</italic> for the SNV <italic>i</italic> and cell <italic>j</italic>, the likelihood of a genotype <italic>X</italic> being the true genotype at this position becomes:</p>
        <p id="Par44">
          <disp-formula id="Equ13">
            <label>13</label>
            <alternatives>
              <tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_i^j\left(X\left|Y\right.\right)=P\left(Y\left|X\right.\right),\forall X\in \Gamma$$\end{document}</tex-math>
              <mml:math id="M24">
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>L</mml:mi>
                  </mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>X</mml:mi>
                    <mml:mrow>
                      <mml:mo>|</mml:mo>
                      <mml:mi>Y</mml:mi>
                      <mml:mo fence="true" stretchy="true" symmetric="true"/>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>Y</mml:mi>
                    <mml:mrow>
                      <mml:mo>|</mml:mo>
                      <mml:mi>X</mml:mi>
                      <mml:mo fence="true" stretchy="true" symmetric="true"/>
                    </mml:mrow>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mi mathvariant="normal">∀</mml:mi>
                <mml:mi>X</mml:mi>
                <mml:mo>∈</mml:mo>
                <mml:mi mathvariant="normal">Γ</mml:mi>
              </mml:math>
              <graphic xlink:href="13059_2021_2583_Article_Equ13.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p id="Par45">This follows from Bayes’ theorem assuming equal prior genotype probabilities.</p>
        <p id="Par46">For missing data, we consider all possible genotypes to be equally likely, which is a standard assumption in likelihood-based phylogenetic inference. In this case:</p>
        <p id="Par47">
          <disp-formula id="Equ14">
            <label>14</label>
            <alternatives>
              <tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_i^j\left(X\ |\ missing\right)=P\ \left( missing\ |\ X\right)=1,\forall X\in \Gamma$$\end{document}</tex-math>
              <mml:math id="M26">
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>L</mml:mi>
                  </mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>X</mml:mi>
                    <mml:mtext/>
                    <mml:mrow>
                      <mml:mo stretchy="false">|</mml:mo>
                    </mml:mrow>
                    <mml:mtext/>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mi>s</mml:mi>
                    <mml:mi>s</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mi>n</mml:mi>
                    <mml:mi>g</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mi>P</mml:mi>
                <mml:mtext/>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mi>s</mml:mi>
                    <mml:mi>s</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mi>n</mml:mi>
                    <mml:mi>g</mml:mi>
                    <mml:mtext/>
                    <mml:mrow>
                      <mml:mo stretchy="false">|</mml:mo>
                    </mml:mrow>
                    <mml:mtext/>
                    <mml:mi>X</mml:mi>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi mathvariant="normal">∀</mml:mi>
                <mml:mi>X</mml:mi>
                <mml:mo>∈</mml:mo>
                <mml:mi mathvariant="normal">Γ</mml:mi>
              </mml:math>
              <graphic xlink:href="13059_2021_2583_Article_Equ14.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
      </sec>
      <sec id="Sec24">
        <title>Phylogenetic likelihood</title>
        <p id="Par48">We consider the evolutionary history of cells as an unrooted binary tree, where <italic>τ</italic> is a tree topology, and <italic>t</italic> is a vector of branch lengths. We define the phylogenetic likelihood of the cell tree <italic>T</italic> as the conditional probability of the observed SNV matrix <italic>S</italic> given the substitution model <italic>M</italic> with parameters <italic>θ</italic> and <italic>T</italic>:<disp-formula id="Equ15"><label>15</label><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L\left(T,M,\theta \right)=P\left(S\ |\ T,M,\theta \right)$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mi>L</mml:mi><mml:mfenced close=")" open="(" separators=",,"><mml:mi>T</mml:mi><mml:mi>M</mml:mi><mml:mi>θ</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mfenced close=")" open="(" separators="|,,"><mml:mrow><mml:mi>S</mml:mi><mml:mspace width="0.25em"/></mml:mrow><mml:mrow><mml:mspace width="0.25em"/><mml:mi>T</mml:mi></mml:mrow><mml:mi>M</mml:mi><mml:mi>θ</mml:mi></mml:mfenced></mml:math><graphic xlink:href="13059_2021_2583_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par49">We assume that genomic sites evolve independently under model <italic>M</italic>. Therefore, the probability of observing the SNV matrix <italic>S</italic> is the product over the independent probabilities for all individual SNVs, <italic>S</italic><sub><italic>i</italic></sub>:<disp-formula id="Equ16"><label>16</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L(T,M,\theta )={\displaystyle\prod}_{i=1}^s \space P({S}_i \space\vert\space T,M,\theta)$$\end{document}</tex-math><mml:math id="M30"><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mo>∏</mml:mo></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mtext/><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mtext/><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mtext/><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><graphic xlink:href="13059_2021_2583_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula>where <italic>s</italic> is the total number of SNVs. For numerical reasons, that is, to avoid floating-point underflow, in practice, we calculate the log-likelihood score:<disp-formula id="Equ17"><label>17</label><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\log L(T,M,\theta)={\sum}_{i=1}^s \log  P({S}_i \space \vert \space T,M,\theta)$$\end{document}</tex-math><mml:math id="M32"><mml:mi>log</mml:mi><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mi>log</mml:mi><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mtext/><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mtext/><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math><graphic xlink:href="13059_2021_2583_Article_Equ17.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par51">We can efficiently compute the log-likelihood score of a given tree with the standard method called Felsenstein’s pruning algorithm [<xref ref-type="bibr" rid="CR52">52</xref>]. Let us place an additional imaginary node, called <italic>virtual root</italic>, into an arbitrary branch of the unrooted tree <italic>T</italic> at a random position along that branch. Without loss of generality, if we assume that this virtual root node has an index of 0 and that <italic>c</italic> is the number of cells, we can index the tip nodes from 1 to <italic>c</italic> by their respective cell numbers and index the internal nodes from <italic>c</italic>+1 to 2<italic>c</italic>–2 (note that an unrooted binary tree with <italic>c</italic> leaves has <italic>c</italic>–3 inner nodes, i.e., (2<italic>c</italic>–2) – (<italic>c</italic>+1) = <italic>c</italic>–3). Then, under the GT16 model, per-SNV probabilities can be computed as follows:<disp-formula id="Equ18"><label>18</label><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P\space({S}_i \space\vert\space T, GT \textit{16},R,\pi)=\sum\limits_{X\in\Gamma} \space\space{L}_i^0(X)\space{\pi}_x,\space i=1 \dots \mathrm{s}$$\end{document}</tex-math><mml:math id="M34"><mml:mi>P</mml:mi><mml:mtext/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mtext/><mml:mo fence="false" stretchy="false">|</mml:mo><mml:mtext/><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mi>T</mml:mi><mml:mrow><mml:mtext class="MJX-tex-mathit" mathvariant="italic">16</mml:mtext></mml:mrow><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow></mml:munder><mml:msubsup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext/><mml:msub><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mi>x</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext/><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:math><graphic xlink:href="13059_2021_2583_Article_Equ18.gif" position="anchor"/></alternatives></disp-formula>where <italic>X</italic> is a genotype, <italic>π</italic><sub><italic>x</italic></sub>is the stationary frequency of the genotype <italic>X</italic>, and <inline-formula id="IEq1"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_i^0$$\end{document}</tex-math><mml:math id="M36" display="inline"><mml:msubsup><mml:mi>L</mml:mi><mml:mi>i</mml:mi><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2021_2583_Article_IEq1.gif"/></alternatives></inline-formula>is the vector of genotype likelihoods at the virtual root, which we compute as follows:<disp-formula id="Equ19"><label>19</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_i^{\nu}(X)=\sum\limits_{Y\in \Gamma}{P}_{X,Y} \space ({t}_u)\space{L}_i^u(Y)  \space\cdot \sum\limits_{Y\in \Gamma} {P}_{X,Y} \space ({t}_w) \space {L}_i^w (Y), \space\space\space\forall\space X\in\Gamma, \space\upsilon \notin [1\dots c]$$\end{document}</tex-math><mml:math id="M38"><mml:msubsup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>ν</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>Y</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mtext/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>u</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mtext/><mml:msubsup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>u</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext/><mml:mo>⋅</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>Y</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:msub><mml:mtext/><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>w</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mtext/><mml:msubsup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>w</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>Y</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi mathvariant="normal">∀</mml:mi><mml:mtext/><mml:mi>X</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo>,</mml:mo><mml:mtext/><mml:mi>υ</mml:mi><mml:mo>∉</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:math><graphic xlink:href="13059_2021_2583_Article_Equ19.gif" position="anchor"/></alternatives></disp-formula>where <italic>Y</italic> is another genotype, <italic>u</italic> and <italic>w</italic> are both children nodes of <italic>v</italic> in the direction from the virtual root (Fig. S<xref rid="MOESM1" ref-type="media">19</xref>) for the respective branch lengths.</p>
        <p id="Par54">We initialize the genotype likelihood vectors at the tip nodes (<inline-formula id="IEq2"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_i^1$$\end{document}</tex-math><mml:math id="M40" display="inline"><mml:msubsup><mml:mi>L</mml:mi><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2021_2583_Article_IEq2.gif"/></alternatives></inline-formula>.. <inline-formula id="IEq3"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_i^c$$\end{document}</tex-math><mml:math id="M42" display="inline"><mml:msubsup><mml:mi>L</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2021_2583_Article_IEq3.gif"/></alternatives></inline-formula>) depending on the input type (see Section “<xref rid="Sec27" ref-type="sec">Input data</xref>” below) and the error model. If the input is the genotype matrix <italic>S</italic>, in the absence of observational error, these tip likelihood vectors are:</p>
        <p id="Par55"><disp-formula id="Equ20"><label>20</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_i^v(X)=\{1\ if\ {S}_i^v=X,\space \space 0\ otherwise\},\space v\in [1\dots c], \space i\in [1\dots s]$$\end{document}</tex-math><mml:math id="M44"><mml:msubsup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>v</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mtext/><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mtext/><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>v</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>X</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn><mml:mtext/><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mo>,</mml:mo><mml:mtext/><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mtext/><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:math><graphic xlink:href="13059_2021_2583_Article_Equ20.gif" position="anchor"/></alternatives></disp-formula>while if we include the error model, the tip likelihoods are computed according to the equations in the “single-cell genotype error model” section.</p>
        <p id="Par57">Otherwise, if the input consists of genotype likelihoods <italic>G</italic>, the tip likelihoods are:</p>
        <p id="Par58">
          <disp-formula id="Equ21">
            <label>21</label>
            <alternatives>
              <tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_i^v(X)=1{0}^{G_i^v(X)}, \space \forall \space X\in \Gamma, \space v\in [1\dots c], \space i\in [1\dots s]$$\end{document}</tex-math>
              <mml:math id="M46">
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi>L</mml:mi>
                  </mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>v</mml:mi>
                </mml:msubsup>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>X</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:msup>
                  <mml:mrow>
                    <mml:mn>0</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>G</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mi>v</mml:mi>
                    </mml:msubsup>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>X</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msup>
                <mml:mo>,</mml:mo>
                <mml:mtext/>
                <mml:mi mathvariant="normal">∀</mml:mi>
                <mml:mtext/>
                <mml:mi>X</mml:mi>
                <mml:mo>∈</mml:mo>
                <mml:mi mathvariant="normal">Γ</mml:mi>
                <mml:mo>,</mml:mo>
                <mml:mtext/>
                <mml:mi>v</mml:mi>
                <mml:mo>∈</mml:mo>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>…</mml:mo>
                <mml:mi>c</mml:mi>
                <mml:mo stretchy="false">]</mml:mo>
                <mml:mo>,</mml:mo>
                <mml:mtext/>
                <mml:mi>i</mml:mi>
                <mml:mo>∈</mml:mo>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>…</mml:mo>
                <mml:mi>s</mml:mi>
                <mml:mo stretchy="false">]</mml:mo>
              </mml:math>
              <graphic xlink:href="13059_2021_2583_Article_Equ21.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p id="Par59">The GT16 model will consider both phasing options equally likely when the input genotype likelihoods are unphased:</p>
        <p id="Par60"><disp-formula id="Equ22"><label>22</label><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_i^v(a|b)={L}_i^v(b|a)=1{0}^{G_i^v(a/b)}, \space \forall \space  a,b,v\in [1\dots c], \space  i\in [1\dots s]$$\end{document}</tex-math><mml:math id="M48"><mml:msubsup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>v</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>v</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>b</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:msup><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msubsup><mml:mi>G</mml:mi><mml:mi>i</mml:mi><mml:mi>v</mml:mi></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mrow><mml:mo>/</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mtext/><mml:mi mathvariant="normal">∀</mml:mi><mml:mtext/><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>c</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mtext/><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:math><graphic xlink:href="13059_2021_2583_Article_Equ22.gif" position="anchor"/></alternatives></disp-formula>where <italic>a</italic> and <italic>b</italic> represent any two alleles.</p>
        <p id="Par62">Finally, if Phred-scaled likelihoods for REF/REF, REF/ALT, and ALT/ALT genotypes are provided (PL field in a VCF file), we calculate tip likelihoods as follows:<disp-formula id="Equ23"><label>23</label><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${L}_i^{\upsilon }(X)={L}_i^{\upsilon}\left(a\left|b\right.\right)=\left\{\begin{array}{ll}{10}^{-0.1\cdot {PL}_i^{\upsilon }(0)}&amp; \mathrm{if}\kern0.5em a= REF\wedge b= REF\\ {}{10}^{-0.1\cdot {PL}_i^{\upsilon }(1)}&amp; \mathrm{if}\left(a= REF\wedge b= ALT\right)\vee (a= ALT\wedge b= REF)\\ {}{10}^{-0.1\cdot {PL}_i^{\upsilon }(2)}&amp; \mathrm{if}\kern0.5em a= ALT\wedge b= REF\\ {}0&amp; \mathrm{otherwise}\end{array}\right.$$\end{document}</tex-math><mml:math id="M50"><mml:msubsup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>υ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mi>X</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>υ</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi>b</mml:mi><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>0.1</mml:mn><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>υ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mspace width="0.5em"/><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:mi>F</mml:mi><mml:mo>∧</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:mi>F</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>0.1</mml:mn><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>υ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:mi>F</mml:mi><mml:mo>∧</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>L</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∨</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>L</mml:mi><mml:mi>T</mml:mi><mml:mo>∧</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:mi>F</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>0.1</mml:mn><mml:mo>⋅</mml:mo><mml:msubsup><mml:mrow><mml:mi>P</mml:mi><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mi>υ</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">f</mml:mi></mml:mrow><mml:mspace width="0.5em"/><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mi>A</mml:mi><mml:mi>L</mml:mi><mml:mi>T</mml:mi><mml:mo>∧</mml:mo><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:mi>F</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">o</mml:mi><mml:mi mathvariant="normal">t</mml:mi><mml:mi mathvariant="normal">h</mml:mi><mml:mi mathvariant="normal">e</mml:mi><mml:mi mathvariant="normal">r</mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mi mathvariant="normal">i</mml:mi><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow></mml:math><graphic xlink:href="13059_2021_2583_Article_Equ23.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par63">The final tree can be rooted using an outgroup (see [<xref ref-type="bibr" rid="CR51">51</xref>]). For the sake of completeness, we included a simple explanation of standard phylogenetic likelihood calculations on DNA sequence alignments in the Supplementary Material (Figs. S<xref rid="MOESM1" ref-type="media">19</xref>-S<xref rid="MOESM1" ref-type="media">20</xref>, Supplementary Note <xref rid="MOESM1" ref-type="media">3</xref>).</p>
      </sec>
    </sec>
    <sec id="Sec25">
      <title>Implementation</title>
      <sec id="Sec26">
        <title>Overview</title>
        <p id="Par64">We implemented CellPhy as a pipeline based on a modified version of RAxML-NG [<xref ref-type="bibr" rid="CR48">48</xref>]. In addition to the core tree search functionality of RAxML-NG, the CellPhy pipeline offers VCF conversion, mutation mapping, and tree visualization using the <italic>ape</italic> [<xref ref-type="bibr" rid="CR75">75</xref>] and the <italic>ggtree</italic> package [<xref ref-type="bibr" rid="CR76">76</xref>]. Furthermore, CellPhy provides reasonable defaults for most parameters, which allows the user to run a “standard” CellPhy analysis by specifying just the input VCF file (or the genotype matrix). Alternatively, expert users can customize every aspect of the CellPhy analysis to fit their needs, as shown in the tutorial (<ext-link ext-link-type="uri" xlink:href="https://github.com/amkozlov/cellphy/blob/master/doc/CellPhy-Tutorial.pdf">https://github.com/amkozlov/cellphy/blob/master/doc/CellPhy-Tutorial.pdf</ext-link>). In the remainder of this section, we will also provide implementation details on each step of the CellPhy pipeline. CellPhy code and documentation are freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/amkozlov/cellphy">https://github.com/amkozlov/cellphy</ext-link>.</p>
      </sec>
      <sec id="Sec27">
        <title>Input data</title>
        <p id="Par65">CellPhy accepts two input types, a matrix of genotypes in FASTA or PHYLIP format or a standard VCF file (<ext-link ext-link-type="uri" xlink:href="https://samtools.github.io/hts-specs/VCFv4.3.pdf">https://samtools.github.io/hts-specs/VCFv4.3.pdf</ext-link>). When the input is a genotype matrix, genotypes are encoded as shown in Table S2. When the input is a VCF, CellPhy can run in two distinct modes. The first mode (“CellPhy-ML”) requires a VCF with at least the GT field (that stores the genotype calls), in which case CellPhy simply extracts the genotype matrix. The second mode (“CellPhy-GL”) requires a VCF with the PL field (which stores the Phred-scaled genotype likelihoods) and uses the likelihood of each genotype instead. While commonly used variant callers for single-cell data (e.g., Monovar [<xref ref-type="bibr" rid="CR77">77</xref>]) generate VCF files with a standard PL field, users should know that the PL definition may differ from its standard meaning in different callers. Indeed, SC-Caller [<xref ref-type="bibr" rid="CR66">66</xref>], for instance, uses the PL field to store the likelihood of heterozygous and alternative homozygous genotypes and the likelihood of sequencing noise and amplification artifacts. On this basis, the PL field in VCF files stemming from SC-Caller needs to be converted to the standard PL format before CellPhy can be used (see Table S3 outlining CellPhy’s compatibility with popular variant calling algorithms).</p>
      </sec>
      <sec id="Sec28">
        <title>Phylogenetic tree search</title>
        <p id="Par66">CellPhy uses the broadly used and well-tested heuristic tree search strategy of RAxML [<xref ref-type="bibr" rid="CR53">53</xref>] and RAxML-NG [<xref ref-type="bibr" rid="CR48">48</xref>]. CellPhy’s search algorithm starts by default with 20 different trees, ten obtained using a maximum parsimony-based randomized stepwise addition order routine and ten with a completely random topology. The ML tree search itself alternates between model parameter optimization and tree topology optimization phases. One of the most popular approaches for searching tree topologies is the so-called subtree pruning and regrafting (SPR) [<xref ref-type="bibr" rid="CR78">78</xref>], which removes subtrees from the tree and subsequently places them into different branches to assess if the likelihood improves. Those SPR moves are applied iteratively until no SPR move further increases the tree’s likelihood. In this case, CellPhy terminates and returns the best-found ML tree. For further details, please see [<xref ref-type="bibr" rid="CR79">79</xref>] and references therein.</p>
      </sec>
      <sec id="Sec29">
        <title>Model parameter optimization</title>
        <p id="Par67">CellPhy uses the L-BFGS-B method [<xref ref-type="bibr" rid="CR80">80</xref>] to optimize genotype substitution rates and equilibrium base frequencies. ADO rate and amplification/sequencing error rate are optimized independently using Brent’s method [<xref ref-type="bibr" rid="CR81">81</xref>]. After each iteration of Brent’s algorithm, CellPhy re-computes all per-genotype likelihoods according to Eq. <xref rid="Equ7" ref-type="">7</xref> using the new values of the ADO rate δ` and the amplification/sequencing error ε’.</p>
      </sec>
      <sec id="Sec30">
        <title>Branch support</title>
        <p id="Par68">CellPhy can compute confidence values for individual inner branches of the ML tree using two bootstrap (BS) techniques, the standard BS [<xref ref-type="bibr" rid="CR55">55</xref>], and the transfer BS [<xref ref-type="bibr" rid="CR56">56</xref>]. In the standard BS, the first step consists of generating many BS replicates, typically 100 to 1000, from the original dataset by randomly sampling SNV sites with replacement. Then, an ML tree is estimated for each replicate. Finally, the support for each inner branch in the ML tree is computed as the percentage of BS trees that contain that branch, as outlined in the example provided in Fig. S<xref rid="MOESM1" ref-type="media">21</xref>. The standard BS only considers exact matches (i.e., the branch in the ML tree and the BS trees must match exactly to be counted). In contrast, the transfer BS also considers inexact matches to account for the tree search uncertainty and vastness of the tree search space in phylogenetic analyses with many cells.</p>
      </sec>
      <sec id="Sec31">
        <title>Mapping mutations onto the tree</title>
        <p id="Par69">CellPhy can show predicted mutations on the branches of the inferred cell tree. To this end, it performs marginal ancestral state reconstruction [<xref ref-type="bibr" rid="CR57">57</xref>] to obtain the ML genotype for every SNV at every inner node of the tree. At the tips of the tree, occupied by the observed cell genotypes, depending on the input, CellPhy applies Eq. <xref rid="Equ4" ref-type="">4</xref> to compute genotype likelihoods given the observed genotype <italic>y</italic> and estimated error rates (δ, ε) or directly uses the genotype likelihoods provided in the VCF file. Then, it compares ML genotypes between two nodes connected by a branch, and if they differ, a mutation is predicted on the corresponding branch. The mutation mapping output consists of two files, a branch-labeled tree in the Newick format and a text file with a list of predicted mutations (SNV names or positions) at each branch. We also provide a script (<ext-link ext-link-type="uri" xlink:href="https://github.com/amkozlov/cellphy/blob/master/script/mutation-map.R">https://github.com/amkozlov/cellphy/blob/master/script/mutation-map.R</ext-link>) that automatically generates a plot with the mutations mapped onto the resulting phylogenetic tree, together with a tutorial that explains its use.</p>
      </sec>
      <sec id="Sec32">
        <title>Computational efficiency</title>
        <p id="Par70">RAxML-NG was developed with a particular focus on high performance and scalability to large datasets. Hence, CellPhy capitalizes on numerous computational optimizations implemented therein, including highly efficient and vectorized likelihood calculation code, coarse- and fine-grained parallelization with multi-threading, checkpointing, and fast transfer bootstrap computation [<xref ref-type="bibr" rid="CR82">82</xref>].</p>
      </sec>
    </sec>
    <sec id="Sec33">
      <title>Benchmarking</title>
      <p id="Par71">We used computer simulations to benchmark the accuracy of CellPhy under different scenarios (Table S1) relative to state-of-the-art methods for single-cell phylogenies like OncoNEM [<xref ref-type="bibr" rid="CR25">25</xref>], SPhyR [<xref ref-type="bibr" rid="CR30">30</xref>], SASC [<xref ref-type="bibr" rid="CR31">31</xref>], ScisTree [<xref ref-type="bibr" rid="CR33">33</xref>], infSCITE [<xref ref-type="bibr" rid="CR26">26</xref>, <xref ref-type="bibr" rid="CR27">27</xref>], SiFit [<xref ref-type="bibr" rid="CR28">28</xref>], and SCIPhI [<xref ref-type="bibr" rid="CR29">29</xref>]. For OncoNEM, SPhyR, SASC, infSCITE, and SiFit, the input is the matrix of observed reference/non-reference homozygous/heterozygous genotypes. ScisTree uses a matrix of genotype probabilities estimated from the simulated read counts for each site, while SCIPhI relies on a standard mpileup file with the simulated read counts. Also, we included in the comparison the standard phylogenetic method TNT [<xref ref-type="bibr" rid="CR49">49</xref>]. TNT implements a maximum parsimony (MP) approach and attempts to find the tree/s that require the least number of mutations to explain the data. TNT is very popular in MP organismal phylogenetics, heavily optimized for computational speed and efficiency. It is not designed for single-cell NGS data and therefore assumes that the observed genotypes are error-free.</p>
      <sec id="Sec34">
        <title>Simulation of genealogies and genotypes</title>
        <p id="Par72">For the simulation of single-cell diploid genotypes, we used CellCoal [<xref ref-type="bibr" rid="CR83">83</xref>]. This program can simulate the evolution of a set of cells sampled from a growing population, introducing single-nucleotide variants on the coalescent genealogy under different models of DNA mutation. Furthermore, it can also introduce the typical errors of single-cell sequencing, specifically ADO, amplification, and sequencing errors, and doublets, either to the observed genotypes or directly into the read counts.</p>
        <p id="Par73">
We designed six distinct simulation scenarios (simulations 1–6) representing different types of scDNA-seq datasets (Table S1), including variable numbers of cells (40–1000) and sites (1000–50,000). We simulated unphased genotype data in all cases, as current scDNA-seq techniques do not reveal the genotype phase. We chose a set of scenarios and parameter values that, in our opinion, are representative of different situations that researchers are likely to encounter. The cell samples were assumed to come from an exponentially growing population (growth rate equal to 1×10<sup>-4</sup>) with a present-day effective population size of 10,000. Across scenarios, we set a constant value of 0.1 for the root branch. Note that the mutations in this branch are shared by all cells. We also defined an outgroup branch length of zero in all cases, so the healthy cell and the most recent common ancestor (MRCA) of the sample (a single healthy cell plus several tumor cells) have identical genotypes. The standard coalescent process results in an ultrametric tree, where all tips have the same distance from the MRCA of the sample. However, we introduced rate variation across cell lineages by multiplying the branch lengths of the resulting coalescent genealogy with scaling factors sampled from a Gamma distribution with a mean of 1.0.</p>
        <p id="Par74">Only in the first simulation scenario, we consider a fixed number of SNVs. In the remaining scenarios, the number of observed mutations resulted from applying a mutation rate of 1×10<sup>-6</sup> [<xref ref-type="bibr" rid="CR84">84</xref>], plus the different scDNA-seq errors. We explored different infinite- and finite-site mutation models at the single nucleotide or trinucleotide level. Except for the ISM scenarios (simulations 1 and 3), we introduced a variable mutation rate across sites using a Gamma distribution with a mean of 1.0.</p>
        <p id="Par75">
We simulated unphased genotypes, as current scDNA-seq techniques do not reveal the phase. We generated the observed genotype matrices in two distinct ways. In the first three scenarios (simulations 1–3), we obtained the observed genotypes by directly adding sequencing/amplification errors (i.e., changing one or both alleles) and ADO to the simulated genotype matrices. In the other three (simulations 4–6), the generation of the observed genotypes was more complex. In this case, we first simulated read counts for each cell based on the true genotypes, considering different overdispersed sequencing depths, as well as amplification and sequencing errors. For simplicity, we assumed that maternal and paternal chromosomes are amplified with the same probability. Also, we consider that the number of reads is half for those genomic positions in which only one allele was amplified. In simulation 5, we introduced so-called doublets, that is, two cells that are erroneously sequenced together and that thus appear as a single cell in the sequencing data. For every combination of parameters, we generated 100 replicates. In total, we generated 19,400 cell samples.</p>
      </sec>
      <sec id="Sec35">
        <title>Preliminary simulations</title>
        <p id="Par76">We carried out a set of preliminary simulations under favorable conditions, without errors or relatively low noise levels (ADO = 0.10 and amplification error= 0.01). We simulated 40 cells with 250 SNVs, assuming a diploid ISM model [<xref ref-type="bibr" rid="CR85">85</xref>]. Under this model, a given site can only accumulate a single mutation along with the genealogy, either in the maternal or paternal chromosome.</p>
      </sec>
      <sec id="Sec36">
        <title>Simulation 1: infinite-site model, low number of SNVs (“target-ISM”)</title>
        <p id="Par77">We started the full simulations with a simple scenario with 40 sampled cells and 250, 500, or 1000 SNVs, assuming a diploid ISM model [<xref ref-type="bibr" rid="CR85">85</xref>]. We introduced genotype errors and ADO at different rates (Table S1).</p>
      </sec>
      <sec id="Sec37">
        <title>Simulation 2: finite-site model, large number of SNVs (“WGS-FSM”)</title>
        <p id="Par78">In this case, we simulated a larger number of SNVs, more typical of whole-genome sequencing (WGS) experiments. The number of sampled cells was 100. The mutation model, in this case, was a non-reversible version of the finite-site General Time Reversible Markov model [<xref ref-type="bibr" rid="CR50">50</xref>], that we called GTnR, assuming a set of single-nucleotide instantaneous rates extrapolated (essentially, we pooled the same mutation in the same rate independently of the 5′ and 3′ context) from the trinucleotide mutational signature 1 at COSMIC (<ext-link ext-link-type="uri" xlink:href="https://cancer.sanger.ac.uk/cosmic/signatures">https://cancer.sanger.ac.uk/cosmic/signatures</ext-link>):<disp-formula id="Equ24"><label>24</label><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Q}_{GTnR}=\left[\begin{array}{llll}0&amp; 0.03&amp; 0.12&amp; 0.04\\ {}0.11&amp; 0&amp; 0.02&amp; 0.68\\ {}6.68&amp; 0.02&amp; 0&amp; 0.11\\ {}0.04&amp; 0.12&amp; 0.13&amp; 0\end{array}\right]$$\end{document}</tex-math><mml:math id="M52" display="block"><mml:msub><mml:mi>Q</mml:mi><mml:mtext mathvariant="italic">GTnR</mml:mtext></mml:msub><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0.03</mml:mn></mml:mtd><mml:mtd><mml:mn>0.12</mml:mn></mml:mtd><mml:mtd><mml:mn>0.04</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0.11</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0.02</mml:mn></mml:mtd><mml:mtd><mml:mn>0.68</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>6.68</mml:mn></mml:mtd><mml:mtd><mml:mn>0.02</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0.11</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0.04</mml:mn></mml:mtd><mml:mtd><mml:mn>0.12</mml:mn></mml:mtd><mml:mtd><mml:mn>0.13</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:math><graphic xlink:href="13059_2021_2583_Article_Equ24.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par79">The overall mutation rate was set to 1×10<sup>-6</sup>, which resulted in about 2000 <italic>true</italic> SNVs (see Table S1). However, since ADO events and genotype errors can introduce false negatives and false positives, the number of <italic>observed</italic> SNVs ranged between 1531 and 10,000. The mutation rates varied across sites according to a Gamma distribution (+G) with shape parameter and mean equal to 1.0 (i.e., moderate among-site rate heterogeneity).</p>
      </sec>
      <sec id="Sec38">
        <title>Simulation 3: mutational signatures and large number of SNVs (“WGS-sig”)</title>
        <p id="Par80">This scenario is similar to the previous one, with 60 cells and assuming a trinucleotide ISM model, with COSMIC signatures 1 and 5. The former is a ubiquitous signature in human cells with a predominance of C&gt;T <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Transition_(genetics)">transition</ext-link>s in the NCG trinucleotide context and is related to the spontaneous deamination of 5-methylcytosine [<xref ref-type="bibr" rid="CR86">86</xref>]. The latter is also a typical age-related signature with a predominance of T&gt;C substitutions in the ATN trinucleotide context, related to transcriptional strand bias [<xref ref-type="bibr" rid="CR87">87</xref>].</p>
      </sec>
      <sec id="Sec39">
        <title>Simulation 4: genotype likelihoods from NGS read counts (“NGS-like”)</title>
        <p id="Par81">In this scenario, and the next two, we simulated NGS read counts from the simulated genotypes. The number of sampled cells was 40, with 10,000 sites and the same mutation model (GTnR+G) and mutation rates as in Simulation 3. We explored three sequencing depths (5x, 30x, and 100x), three ADO rates (0, 0.05, 0.10), three amplification error rates (0, 0.05, 0.10), and three sequencing error rates (0, 0.01, 0.05). We assumed that amplification and sequencing errors among the four nucleotides were equally likely. From the read counts, CellCoal can also simulate the likelihood for all ten possible unphased genotypes at each SNV site, in this case under a 4-template amplification model [<xref ref-type="bibr" rid="CR83">83</xref>]. The input for CellPhy was either the ten genotype likelihoods at each SNV site (CellPhy-GL mode) or the unphased genotype with the maximum likelihood (ML) value (CellPhy-ML mode). The input for SCIPhi was the read counts, while for the rest of the programs, it was the ML unphased genotype. In the rare case of tied ML genotypes, we chose one of them at random.</p>
      </sec>
      <sec id="Sec40">
        <title>Simulation 5: NGS doublets (“NGS-doublet”)</title>
        <p id="Par82">In this case, we intended to explore the effects of doublets in the data. Settings were very similar to those for Simulation 4 but, for simplicity, we fixed the sequencing depth to 5x and explored two amplification error rates (0, 0.05), two sequencing error rates (0, 0.01), and four doublet rates (0, 0.05, 0.10, 0.20).</p>
      </sec>
      <sec id="Sec41">
        <title>Simulation 6: NGS for large numbers of cells and SNVs (“NGS-large”)</title>
        <p id="Par83">Finally, to assess the scalability of the tools, we simulated scenarios with 100, 500, or 1000 cells and with 1000, 10,000, or 50,000 sites. Given the mutation rate, a large number of cells, and, most importantly, the amplification and sequencing error rates, almost all sites were observed as SNVs. Settings were very similar to those specified for Simulation 5 but, for simplicity, we fixed the sequencing depth to 5x and explored only one amplification (0.05) and one sequencing (0.01) error value. We only analyzed the first 20 replicates in this scenario due to the high computational cost and prohibitive running times for several competing tools.</p>
      </sec>
      <sec id="Sec42">
        <title>Settings for the phylogenetic analyses</title>
        <sec id="FPar1">
          <title>Coding DNA into ternary genotypes</title>
          <p id="Par84">Our simulations produce unphased DNA genotypes with ten possible states. However, except for CellPhy, existing tools work with an alphabet composed of 0 (homozygous for the reference allele), 1 (heterozygous), 2 (homozygous for the alternative allele), and 3 (missing genotype). Therefore, we had to encode the simulated DNA genotypes into ternary genotypes (0–3). For this, we used the true reference allele, considering that, in real life, we usually know which allele is the reference. For the sake of simplicity, we did not introduce germline mutations. Importantly, our simulations do not necessarily produce bi-allelic SNVs, as in the finite-site model multiple mutations can coincide, and amplification and sequencing errors can also result in new alleles called. CellPhy does not limit the number of alleles at an SNV site, but competing tools handle multi-allelic sites differently. We explored three ways of coding sites with more than two alleles into ternary genotypes:<list list-type="bullet"><list-item><p id="Par85">Option <italic>keep</italic>: transform all heterozygotes to “1” and all homozygotes for the alternative allele/s to “2”. In this case, all simulated sites are held, regardless of the number of observed alleles.</p></list-item><list-item><p id="Par86">Option <italic>remove</italic>: eliminate sites from the data with more than two alleles. The final genotype matrix includes only bi-allelic sites.</p></list-item><list-item><p id="Par87">Option <italic>missing</italic>: keep only those genotypes that contain the reference allele and/or the major (most common) alternative allele. All other genotypes (containing minor alternative alleles) are considered as missing data (“3”). Therefore, the final ternary genotype matrix includes the same number of sites as the original DNA genotype matrix.</p></list-item></list></p>
          <p id="Par88">We considered all three encoding options only in simulations 1 and 2. In the remaining simulations, we used only the “missing” option, as it maximized accuracy in most cases.</p>
        </sec>
        <sec id="FPar2">
          <title>TNT settings</title>
          <p id="Par89">We performed the TNT analyses using a binary data matrix in TNT format for all simulated and empirical datasets. We allowed 1000 trees to be retained for each run and performed tree searches by setting <italic>mult = replic 100</italic>. We stored all equally parsimonious trees and used additional ttags to store branch lengths and bootstrap support values.</p>
        </sec>
        <sec id="FPar3">
          <title>OncoNEM settings</title>
          <p id="Par90">We ran OncoNEM following the recommended settings in the OncoNEM vignette. We set the false positive rate as the actual genotype error for each scenario and performed a tree search for 200 iterations. Because of its heavy computational requirements and poor performance, we only run it in Simulation 1.</p>
        </sec>
        <sec id="FPar4">
          <title>SASC settings</title>
          <p id="Par91">We generated binary matrices as input files and set <italic>-k</italic> option to 1. Additionally, the false positive rate was set as the actual genotype error, and the false negative rate was set as the actual ADO rate. The command line was: <italic>sasc -n &lt;CELLS&gt; -m &lt;SNVS&gt; -k 1 -a &lt;ADO&gt; -b &lt;ERR&gt; -E data.CellID -l -i data.sasc -p 24</italic>. Similar to OncoNEM, due to its bad performance, SASC was only run partially in Simulation 1.</p>
        </sec>
        <sec id="FPar5">
          <title>SPhyR settings</title>
          <p id="Par92">We produced binary input files using a custom script and ran the kDPFC version with the false positive rate (<italic>-a</italic>) set to the simulated genotype error and the false negative rate (<italic>-b</italic>) set to the simulated ADO rate. The command line was <italic>kDPFC data.sphyr -a &lt;ERR&gt; -b &lt;ADO&gt; -k 1 -t 24 &gt; data.sphyr.result</italic>. Afterwards, we used the <italic>visualize</italic> program to generate the output tree. The command line was <italic>visualize data.sphyr.result -c data.snv_labels -t data.cell_labels &gt; data.sphyr.dot</italic>. Because it continuously crashed for most datasets, SPhyR was only run partially in simulation 1.</p>
        </sec>
        <sec id="FPar6">
          <title>infSCITE settings</title>
          <p id="Par93">For simulations 1–3, we ran infSCITE using a ternary data matrix composed of 0, 1, 2, and 3, as described above, and set the false positive rate (<italic>-fd</italic>) to be the actual genotype error for each simulated scenario. We set the false-positive rate for simulations 4–5 as the sum of the simulated sequencing and amplification error rates. For the empirical analyses, we set the false positive rate to <italic>1e−05</italic>. We set the remaining parameters to the default values in all runs and obtained results after running an MCMC chain with 5 million steps, a fair trade-off between runtime and apparent MCMC convergence (the best tree score barely changed after 1M iterations). We additionally set the -<italic>transpose</italic> option to return a tree where the single-cell samples are the leaf labels. The command line was <italic>infSCITE -i data.infSCITE -n &lt;SNVS&gt; -m &lt;CELLS&gt; -r 1 -l 5000000 -fd &lt;ERR&gt; -ad 1.46e-1 -cc 1.299164e-05 -transpose -e 0.2 -o data.infSCITE.Tree</italic></p>
        </sec>
        <sec id="FPar7">
          <title>SiFit settings</title>
          <p id="Par94">For all simulated and empirical datasets, we ran SiFit for 200,000 iterations. The command line was <italic>java -jar /SiFit.jar -m &lt;CELLS&gt; -n &lt;SNVS&gt; -r 1 -iter 200000 -df 1 -ipMat data.sf -cellNames data.names</italic>.</p>
        </sec>
        <sec id="FPar8">
          <title>SCIPhI settings</title>
          <p id="Par95">Since SCIPhI requires read counts to perform joint variant calling and phylogenetic reconstruction, we ran it only for simulations 4–6. We set the mean error rate (-wildMean) for each scenario as the sum of the true sequencing and amplification error rates. The command line was <italic>sciphi -o data.Result --in sampleNames -u 1 --ncf 0 --md 1 --mmw 4 --mnp 1 --ms 1 --mc 1 --unc true -l 200000 --seed $RANDOM data.mpileup --ese 0 --wildMean &lt;ERR&gt;.</italic> To make the results comparable, for the empirical datasets we used samtools to generate mpileups for the positions previously identified by SC-Caller. These were in turn used as input for SCIPhI: <italic>sciphi -o &lt;SET&gt;.SCIPhI --in &lt;SET&gt;-SampleNames.txt -u 0 --ncf 0 --md 0 --mmw 4 --mnp 1 --unc true -l 200000 --seed 421 &lt;SET&gt;.SCCaller-Positions.mpileup</italic>.</p>
        </sec>
        <sec id="FPar9">
          <title>ScisTree settings</title>
          <p id="Par96">We extracted allele counts from VCF files using a custom script (available in the CellPhy’s GitHub repository) and obtained genotype probabilities using the <italic>scprob</italic> program provided with ScisTree. We ran ScisTree v1.2.0.6 with default parameters, which we called as follows: <italic>scistree &lt;genotype-probability-matrix&gt;</italic>.</p>
        </sec>
        <sec id="FPar10">
          <title>CellPhy settings</title>
          <p id="Par97">For simulations 1–6, we performed a heuristic tree search starting from a single parsimony-based tree under the GT16 model. The command line for runs with ML genotypes as input was <italic>cellphy.sh RAXML --search --msa data.phy --model GT16+FO+E --tree pars{1}</italic>. The command line for runs where the input was genotype likelihoods (VCF) was <italic>cellphy.sh RAXML --search --msa data.vcf --model GT16+FO --tree pars{1}</italic>. For all empirical datasets except LS140, to take advantage of the genotype likelihood model, we used an <italic>in-house</italic> bash script (sc-caller-convert.sh, distributed together with CellPhy) to convert the PL field from our SC-Caller VCFs. In short, following SC-Caller authors’ suggestion, we used the highest likelihood score of the first two values in the PL field (i.e., sequencing noise, amplification artifact) as the Phred-scaled genotype likelihood of the reference homozygous (0/0) genotype, and the remaining values as the likelihood for heterozygous (0/1) and alternative homozygous (1/1) genotypes, respectively. Afterward, we ran CellPhy using the following command line <italic>cellphy.sh RAXML --all --msa data.vcf --model GT16+FO --bs-metric fbp,tbe --bs-trees 100</italic> to perform an all-in-one analysis (ML tree inference and bootstrapping based on 100 bootstrap trees). For LS140, since we only had the genotype matrix available and these data were generated without whole-genome amplification, we ran CellPhy without the single-cell error model using the following command line <italic>cellphy.sh RAXML --all --msa data.vcf --model GT16+FO --prob-msa off --bs-metric fbp,tbe --bs-trees 100</italic>.</p>
        </sec>
      </sec>
      <sec id="Sec43">
        <title>Evaluation of phylogenetic accuracy</title>
        <p id="Par98">We defined <italic>phylogenetic accuracy</italic> as one minus the normalized Robinson-Foulds (nRF) distance [<xref ref-type="bibr" rid="CR88">88</xref>] between the inferred tree and the (true) simulated tree. This normalization divides the (absolute) RF distance by the total number of (internal) branches in <italic>both</italic> trees. Hence, the nRF distance is a convenient metric from zero to one that reflects the proportion of branches (bipartitions of the data) correctly inferred.</p>
      </sec>
      <sec id="Sec44">
        <title>Running time comparisons</title>
        <p id="Par99">We characterized the computational efficiency of CellPhy by comparing running times for all methods on six datasets from simulations 1–6 (sim1-ADO:0.50, ERR:0.10, sim2-ADO:0.10, ERR:0.05, sim3-ADO:0.15, ERR:0.10, Signature1, sim4-Number of cells:40, ADO:0.25, Amp error:0.10, Seq error: 0.05; sim6-100-Number of Cells:100, ADO:0.10, Amp error:0.05; Seq error:0.01; and sim6-500-Number of Cells:500, ADO:0.10, Amp error:0.05; Seq error:0.01) and two empirical datasets (CRC24 and L86) described below. We measured running times using the Linux/Unix “time” command, as follows: <italic>{time ./cellphy.sh RAXML --search --msa data.vcf --model GT16+FO --tree pars{1} --prefix data-out --threads 1 ; } 2&gt; data-CellPhyGL16.time</italic>. We ran all analyses on a single core from an Intel Xeon E5-2680 v3 Haswell Processor 2.5 GHz with 128 Gb of RAM. For the bootstrap benchmark, the CellPhy command line was <italic>{time ./cellphy.sh RAXML --all --msa data.vcf --model GT16+FO --tree pars{1} --bs-trees 100 --prefix data-out-Boot --threads 1 ; } 2&gt; data-CellPhyGL16.Boot.time.</italic> As for TNT, additional ttags were used to perform and store 100 bootstrap replicates.</p>
      </sec>
      <sec id="Sec45">
        <title>Analysis of empirical data</title>
        <sec id="FPar11">
          <title>In-house single-cell WGS data from a colorectal cancer patient (CRC24)</title>
          <p id="Par100">We obtained a fresh frozen primary tumor and normal tissues from a single colorectal cancer patient (CRC24). We isolated EpCAM+ cells with a BD FACSAria III cytometer from two tumoral regions (tumor inferior (TI) section and tumor middle section (TM)) and classified them as stem or non-stem according to the stemness markers at the cell surface (stem: EpCAM+/Lgr5+/CD44-/CD166-; non-stem: EpCAM+/Lgr5-/CD44-/CD166-). We amplified the genomes of 24 cells with Ampli1 (Silicon Biosystems) and built whole-genome sequencing libraries using the KAPA (Kapa Biosystems) library kit. Each library was then sequenced at ~ 6× on an Illumina Novaseq 6000 at the National Center of Genomic Analysis (CNAG-CR; <ext-link ext-link-type="uri" xlink:href="https://www.cnag.crg.eu/">https://www.cnag.crg.eu/</ext-link>).</p>
        </sec>
        <sec id="FPar12">
          <title>Retrieval of publicly available datasets (L86, E15, and LS140)</title>
          <p id="Par101">We also analyzed three public data sets with 86, 15, and 140 cells (L86, E15, and LS140, respectively). The L86 dataset consists of targeted sequencing data from 86 cells from a metastatic colorectal cancer patient (CRC2 in [<xref ref-type="bibr" rid="CR21">21</xref>]) that we downloaded from the Sequence Read Archive (SRA) in FASTQ format, together with paired healthy-tumor bulk cell population samples (accession number: SRP074289). The E15 dataset consists of WGS data from 15 neurons [<xref ref-type="bibr" rid="CR69">69</xref>] from a healthy donor, downloaded from the SRA in FASTQ format, together with a bulk cell population from heart tissue (accession number: SRP041470). The LS140 dataset consists of 140 single cell-derived human hematopoietic stem and progenitor colonies from a healthy individual [<xref ref-type="bibr" rid="CR15">15</xref>]. For this dataset, we directly downloaded the substitution calls from the Mendeley data archive (<ext-link ext-link-type="uri" xlink:href="https://data.mendeley.com/datasets/yzjw2stk7f/1">https://data.mendeley.com/datasets/yzjw2stk7f/1</ext-link>).</p>
        </sec>
        <sec id="FPar13">
          <title>NGS data processing and variant calling</title>
          <p id="Par102">We aligned single-cell and bulk reads to the human reference GRCh37 using the MEM algorithm in the BWA software [<xref ref-type="bibr" rid="CR89">89</xref>]. The mapped reads were then independently processed for all datasets by filtering reads displaying low mapping quality, performing local realignment around indels, and removing PCR duplicates. For the tumor bulk samples (i.e., CRC24 &amp; L86), we obtained SNV calls using the paired-sample variant-calling approach implemented in the MuTect2 software [<xref ref-type="bibr" rid="CR90">90</xref>]. For the E15 dataset, we ran HaplotypeCaller from the Genome Analysis Toolkit (GATK) [<xref ref-type="bibr" rid="CR91">91</xref>] software on the bulk sample from the heart tissue to identify and remove all germline variants.</p>
          <p id="Par103">In parallel, we used the single-cell SC-caller software [<xref ref-type="bibr" rid="CR66">66</xref>] to retrieve single-cell SNV calls. In short, for each single-cell BAM, we ran SC-Caller together with the corresponding healthy bulk DNA as input under default settings. Since different amplification methods were used to generate each dataset, we defined the bias estimation interval (<italic>--lamb</italic>) as the average amplicon size of each amplification method—10,000 for MDA-based protocols (L86, E15) and 2000 for Ampli1 (CRC24). Besides, since the actual genomic targets of the L86 dataset were not available, we ran SC-caller on the entire exome. We applied a series of heavy filters (see below) to remove potential off-target calls. We additionally estimated copy-number variants (CNVs) for each single-cell dataset. For the sc-WGS datasets (CRC24 and E15), we obtained CNV calls with the Ginkgo software [<xref ref-type="bibr" rid="CR92">92</xref>] using variable-length bins of around 500 kb. For the L86 dataset, we determined CNVs using CNVPanelizer, an algorithm specifically designed to infer copy number states from targeted sequencing data.</p>
          <p id="Par104">We filtered our raw single-cell VCFs by excluding short indels, SNVs with a flag other than “true” in the SO format field (i.e., showing weak evidence of being a true somatic mutation), and variable sites with an alternative read count &lt; 3. We also excluded variable sites in which the ML genotype estimate was above 120 (Phred-scaled). Such uncertainty in the genotype call was usually associated with sites experiencing an apparent disparity in the proportion of both alleles (i.e., allelic bias). Moreover, as we are primarily interested in analyzing diploid genomic regions, we removed those SNVs located within CN variable regions.</p>
          <p id="Par105">
For each dataset, we then merged single-cell VCFs using the bcftools software [<xref ref-type="bibr" rid="CR93">93</xref>] and applied a “consensus” filter to only retain sites present in at least one cell and the bulk tumor sample, or in two cells. For the E15 dataset, we limited this “consensus” filter to somatic sites observed in at least two cells, as we classified as germline all variants observed in the bulk sample. Finally, we removed positions missing (i.e., not covered by any read) in more than 50% of the cells and SNVs comprising more than one alternative allele. For the L86 dataset, we filtered out off-target SNVs located outside exonic regions. For the LS140 dataset, we converted the binary genotype matrix into a VCF by transforming 0, 1, and NA values into 0/0, 0/1, and ./., respectively. Afterward, we removed all duplicated (non-biallelic) positions and indels.</p>
        </sec>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec46">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2021_2583_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary Tables S1-S3, Figures S1-S22, and Notes S1-S3 [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR29">29</xref>, <xref ref-type="bibr" rid="CR51">51</xref>, <xref ref-type="bibr" rid="CR52">52</xref>, <xref ref-type="bibr" rid="CR66">66</xref>, <xref ref-type="bibr" rid="CR69">69</xref>, <xref ref-type="bibr" rid="CR73">73</xref>, <xref ref-type="bibr" rid="CR77">77</xref>, <xref ref-type="bibr" rid="CR91">91</xref>, <xref ref-type="bibr" rid="CR94">94</xref>–<xref ref-type="bibr" rid="CR98">98</xref>].</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2021_2583_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>Alexey Kozlov and Joao M. Alves shared first-authorship.</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We want to thank Debora Chantada, Pilar Alvariño, and Sonia Prado for their help in obtaining the CRC24 dataset and Phylogenomics lab members for their comments.</p>
    <sec id="FPar14">
      <title>Review history</title>
      <p id="Par106">The review history is available as Additional file <xref rid="MOESM2" ref-type="media">2</xref>.</p>
    </sec>
    <sec id="FPar15">
      <title>Peer review information</title>
      <p id="Par107">Barbara Cheifet was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>A.K. implemented the model within RAxML-NG and ran part of the simulations. J.M.A. ran part of the simulations and performed the empirical analyses. A.S. supervised the phylogenetic implementation. D.P. conceived the CellPhy model, developed the error model, defined the experimental design, and supervised the obtention of the single-cell data. All authors contributed to manuscript writing. The authors read and approved the final manuscript.</p>
    <sec id="FPar16">
      <title>Authors’ information</title>
      <p id="Par108">Twitter handles: @JMFAlves (Joao M. Alves); @AlexisCompBio (Alexandros Stamatakis); @dposada_ (David Posada)</p>
    </sec>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the European Research Council (ERC-617457- PHYLOCANCER awarded to D.P.) and by the Spanish Ministry of Science and Innovation - MICINN (PID2019-106247GB-I00 awarded to D.P.). D.P. receives further support from Xunta de Galicia and from FCT (PTDC/BIA-EVL/32030/2017). J.M.A. is supported by an AXA Research Fund Postdoctoral Fellowship and an AECC Investigator 2020 fellowship. This work was also financially supported by the Klaus Tschira Foundation (A.K. and A.S.).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The source code of CellPhy is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/amkozlov/cellphy">https://github.com/amkozlov/cellphy</ext-link> [<xref ref-type="bibr" rid="CR99">99</xref>] under the GNU Affero GPL version 3 license. The source code version used in the manuscript can be downloaded from the Zenodo repository (10.5281/zenodo.5345921) [<xref ref-type="bibr" rid="CR100">100</xref>].</p>
    <p>Conversion scripts and input/output files for the empirical analyses are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/amkozlov/cellphy-paper">https://github.com/amkozlov/cellphy-paper</ext-link>.</p>
    <p>We deposited the raw single-cell whole-genome sequencing data for patient CRC24 at the National Center for Biotechnology Information (NCBI) as BioProject PRJNA789841 [<xref ref-type="bibr" rid="CR101">101</xref>]. We additionally analyzed several published single-cell data sets [<xref ref-type="bibr" rid="CR21">21</xref>, <xref ref-type="bibr" rid="CR69">69</xref>]. Raw sequencing data for these are available from the SRA database under accession numbers SRP074289 (L86) and SRP041470 (E15). We generated the genotype matrix for the LS140 dataset [<xref ref-type="bibr" rid="CR15">15</xref>] from the substitution calls available at the Mendeley data archive (<ext-link ext-link-type="uri" xlink:href="https://data.mendeley.com/datasets/yzjw2stk7f/1">https://data.mendeley.com/datasets/yzjw2stk7f/1</ext-link>).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar17">
      <title>Ethics approval and consent to participate</title>
      <p id="Par109">Tissue samples from patient CRC24 were obtained at the Galicia Sur Health Research Institute (IISGS) Biobank, member of the Spanish National Biobank Network (N° B.0000802). This study was approved by a local Ethical and Scientific Committee (CAEI Galicia 2014/015).</p>
    </notes>
    <notes id="FPar18">
      <title>Consent for publication</title>
      <p id="Par110">Not applicable.</p>
    </notes>
    <notes id="FPar19" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par111">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gawad</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Koh</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Single-cell genome sequencing: current state of the science</article-title>
        <source>Nat Rev Genet.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>175</fpage>
        <lpage>188</lpage>
        <?supplied-pmid 26806412?>
        <pub-id pub-id-type="pmid">26806412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <mixed-citation publication-type="other">Tanay A, Regev A. Scaling single-cell genomics from phenomenology to mechanism. Nature. Nature Publishing Group, a division of Macmillan Publishers Limited. All Rights Reserved.; 2017;541:331.</mixed-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macaulay</surname>
            <given-names>IC</given-names>
          </name>
          <name>
            <surname>Voet</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Single cell genomics: advances and future perspectives</article-title>
        <source>PLoS Genet.</source>
        <year>2014</year>
        <volume>10</volume>
        <fpage>e1004126</fpage>
        <?supplied-pmid 24497842?>
        <pub-id pub-id-type="pmid">24497842</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baslan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Hicks</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Unravelling biology and shifting paradigms in cancer with single-cell sequencing</article-title>
        <source>Nat Rev Cancer.</source>
        <year>2017</year>
        <volume>17</volume>
        <fpage>557</fpage>
        <lpage>569</lpage>
        <?supplied-pmid 28835719?>
        <pub-id pub-id-type="pmid">28835719</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stegle</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Teichmann</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Computational and analytical challenges in single-cell transcriptomics</article-title>
        <source>Nat Rev Genet.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>133</fpage>
        <lpage>145</lpage>
        <?supplied-pmid 25628217?>
        <pub-id pub-id-type="pmid">25628217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lim</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Navin</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Advancing cancer research and medicine with single-cell genomics</article-title>
        <source>Cancer Cell.</source>
        <year>2020</year>
        <volume>37</volume>
        <fpage>456</fpage>
        <lpage>470</lpage>
        <?supplied-pmid 32289270?>
        <pub-id pub-id-type="pmid">32289270</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Arendt</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>How single-cell genomics is changing evolutionary and developmental biology</article-title>
        <source>Annu Rev Cell Dev Biol.</source>
        <year>2017</year>
        <volume>33</volume>
        <fpage>537</fpage>
        <lpage>553</lpage>
        <?supplied-pmid 28813177?>
        <pub-id pub-id-type="pmid">28813177</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <mixed-citation publication-type="other">Wiedmeier JE, Noel P, Lin W, Von Hoff DD, Han H. Single-cell sequencing in precision medicine. Precision Medicine. Cancer Therapy. 2019:237–52.</mixed-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lähnemann</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Szczurek</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Hicks</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Eleven grand challenges in single-cell data science</article-title>
        <source>Genome Biol.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>31</fpage>
        <?supplied-pmid 32033589?>
        <pub-id pub-id-type="pmid">32033589</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Navin</surname>
            <given-names>NE</given-names>
          </name>
        </person-group>
        <article-title>Cancer genomics: one cell at a time</article-title>
        <source>Genome Biol.</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>452</fpage>
        <?supplied-pmid 25222669?>
        <pub-id pub-id-type="pmid">25222669</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <mixed-citation publication-type="other">Stadler T, Pybus OG, Stumpf MPH. Phylodynamics for cell biologists. Science [Internet]. 2021;371. Available from: 10.1126/science.aah6266</mixed-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wagner</surname>
            <given-names>DE</given-names>
          </name>
          <name>
            <surname>Klein</surname>
            <given-names>AM</given-names>
          </name>
        </person-group>
        <article-title>Lineage tracing meets single-cell omics: opportunities and challenges</article-title>
        <source>Nat Rev Genet.</source>
        <year>2020</year>
        <volume>21</volume>
        <fpage>410</fpage>
        <lpage>427</lpage>
        <?supplied-pmid 32235876?>
        <pub-id pub-id-type="pmid">32235876</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Coorens</surname>
            <given-names>THH</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>PS</given-names>
          </name>
          <name>
            <surname>Sanghvi</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Christopher</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Hewinson</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Extensive phylogenies of human development inferred from somatic mutations</article-title>
        <source>Nature.</source>
        <year>2021</year>
        <volume>597</volume>
        <fpage>387</fpage>
        <lpage>392</lpage>
        <?supplied-pmid 34433963?>
        <pub-id pub-id-type="pmid">34433963</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lodato</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Woodworth</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Evrony</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Mehta</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Karger</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Somatic mutation in single human neurons tracks developmental and transcriptional history</article-title>
        <source>Science.</source>
        <year>2015</year>
        <volume>350</volume>
        <fpage>94</fpage>
        <lpage>98</lpage>
        <?supplied-pmid 26430121?>
        <pub-id pub-id-type="pmid">26430121</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee-Six</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Øbro</surname>
            <given-names>NF</given-names>
          </name>
          <name>
            <surname>Shepherd</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Grossmann</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Dawson</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Belmonte</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Population dynamics of normal human blood inferred from somatic mutations</article-title>
        <source>Nature.</source>
        <year>2018</year>
        <volume>561</volume>
        <fpage>473</fpage>
        <lpage>478</lpage>
        <?supplied-pmid 30185910?>
        <pub-id pub-id-type="pmid">30185910</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Park</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mali</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Choi</surname>
            <given-names>J-W</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clonal dynamics in early human embryogenesis inferred from somatic mutation</article-title>
        <source>Nature.</source>
        <year>2021</year>
        <volume>597</volume>
        <fpage>393</fpage>
        <lpage>397</lpage>
        <?supplied-pmid 34433967?>
        <pub-id pub-id-type="pmid">34433967</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Evrony</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Hinch</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Luo</surname>
            <given-names>C</given-names>
          </name>
        </person-group>
        <article-title>Applications of single-cell DNA sequencing</article-title>
        <source>Annu Rev Genomics Hum Genet.</source>
        <year>2021</year>
        <volume>22</volume>
        <fpage>171</fpage>
        <lpage>197</lpage>
        <?supplied-pmid 33722077?>
        <pub-id pub-id-type="pmid">33722077</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <mixed-citation publication-type="other">Quinn JJ, Jones MG, Okimoto RA, Nanjo S, Chan MM, Yosef N, et al. Single-cell lineages reveal the rates, routes, and drivers of metastasis in cancer xenografts. Science [Internet]. 2021;371. Available from: 10.1126/science.abc1944</mixed-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Naxerova</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>RK</given-names>
          </name>
        </person-group>
        <article-title>Using tumour phylogenetics to identify the roots of metastasis in humans</article-title>
        <source>Nat Rev Clin Oncol.</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>258</fpage>
        <lpage>272</lpage>
        <?supplied-pmid 25601447?>
        <pub-id pub-id-type="pmid">25601447</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hong</surname>
            <given-names>WS</given-names>
          </name>
          <name>
            <surname>Shpak</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Townsend</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Inferring the origin of metastases from cancer phylogenies</article-title>
        <source>Cancer Res.</source>
        <year>2015</year>
        <volume>75</volume>
        <fpage>4021</fpage>
        <lpage>4025</lpage>
        <?supplied-pmid 26260528?>
        <pub-id pub-id-type="pmid">26260528</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Leung</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Gao</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Casasent</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Sei</surname>
            <given-names>E</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell DNA sequencing reveals a late-dissemination model in metastatic colorectal cancer</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>1287</fpage>
        <lpage>1299</lpage>
        <?supplied-pmid 28546418?>
        <pub-id pub-id-type="pmid">28546418</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alves</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Prado-López</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Cameselle-Teijeiro</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Posada</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Rapid evolution and biogeographic spread in a colorectal cancer</article-title>
        <source>Nat Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>5139</fpage>
        <?supplied-pmid 31723138?>
        <pub-id pub-id-type="pmid">31723138</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuipers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jahn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Advances in understanding tumour evolution through single-cell sequencing</article-title>
        <source>Biochim Biophys Acta Rev Cancer.</source>
        <year>2017</year>
        <volume>1867</volume>
        <fpage>127</fpage>
        <lpage>138</lpage>
        <?supplied-pmid 28193548?>
        <pub-id pub-id-type="pmid">28193548</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zafar</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Navin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Computational approaches for inferring tumor evolution from single-cell genomic data</article-title>
        <source>Current Opinion in Systems Biology.</source>
        <year>2018</year>
        <volume>7</volume>
        <fpage>16</fpage>
        <lpage>25</lpage>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ross</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Markowetz</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>OncoNEM: inferring tumor evolution from single-cell sequencing data</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>69</fpage>
        <?supplied-pmid 27083415?>
        <pub-id pub-id-type="pmid">27083415</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jahn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kuipers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Tree inference for single-cell data</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>86</fpage>
        <?supplied-pmid 27149953?>
        <pub-id pub-id-type="pmid">27149953</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuipers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jahn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Single-cell sequencing data reveal widespread recurrence and loss of mutational hits in the life histories of tumors</article-title>
        <source>Genome Res.</source>
        <year>2017</year>
        <volume>27</volume>
        <fpage>1885</fpage>
        <lpage>1894</lpage>
        <?supplied-pmid 29030470?>
        <pub-id pub-id-type="pmid">29030470</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zafar</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Tzen</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Navin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>SiFit: inferring tumor trees from single-cell sequencing data under finite-sites models</article-title>
        <source>Genome Biol.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>178</fpage>
        <?supplied-pmid 28927434?>
        <pub-id pub-id-type="pmid">28927434</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Singer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kuipers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Jahn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Single-cell mutation identification via phylogenetic inference</article-title>
        <source>Nat Commun.</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>5144</fpage>
        <?supplied-pmid 30514897?>
        <pub-id pub-id-type="pmid">30514897</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>El-Kebir</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>SPhyR: tumor phylogeny estimation from single-cell sequencing data under loss and error</article-title>
        <source>Bioinformatics.</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>i671</fpage>
        <lpage>i679</lpage>
        <?supplied-pmid 30423070?>
        <pub-id pub-id-type="pmid">30423070</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ciccolella</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ricketts</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Soto Gomez</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Silverbush</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Bonizzoni</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inferring cancer progression from single-cell sequencing while allowing mutation losses</article-title>
        <source>Bioinformatics.</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>326</fpage>
        <lpage>333</lpage>
        <?supplied-pmid 32805010?>
        <pub-id pub-id-type="pmid">32805010</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Satas</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Zaccaria</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mon</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>SCARLET: single-cell tumor phylogeny inference with copy-number constrained mutation losses</article-title>
        <source>Cell Systems.</source>
        <year>2020</year>
        <volume>10</volume>
        <fpage>323</fpage>
        <lpage>32.e8</lpage>
        <?supplied-pmid 32864481?>
        <pub-id pub-id-type="pmid">32864481</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Accurate and efficient cell lineage tree inference from noisy single cell data: the maximum likelihood perfect phylogeny approach</article-title>
        <source>Bioinformatics.</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>742</fpage>
        <lpage>750</lpage>
        <?supplied-pmid 31504211?>
        <pub-id pub-id-type="pmid">31504211</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gong</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>RobustClone: a robust PCA method for tumor clone and evolution inference from single-cell sequencing data</article-title>
        <source>Bioinformatics.</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>3299</fpage>
        <lpage>3306</lpage>
        <?supplied-pmid 32159762?>
        <pub-id pub-id-type="pmid">32159762</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sadeqi Azer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Rashidi Mehrabadi</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Malikić</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>XC</given-names>
          </name>
          <name>
            <surname>Bartok</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Litchfield</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PhISCS-BnB: a fast branch and bound algorithm for the perfect tumor phylogeny reconstruction problem</article-title>
        <source>Bioinformatics.</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>i169</fpage>
        <lpage>i176</lpage>
        <?supplied-pmid 32657358?>
        <pub-id pub-id-type="pmid">32657358</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zafar</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Navin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>SiCloneFit: Bayesian inference of population structure, genotype, and phylogeny of tumor clones from single-cell genome sequencing data</article-title>
        <source>Genome Res.</source>
        <year>2019</year>
        <volume>29</volume>
        <fpage>1847</fpage>
        <lpage>1859</lpage>
        <?supplied-pmid 31628257?>
        <pub-id pub-id-type="pmid">31628257</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McPherson</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Laks</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Biele</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yap</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clonal genotype and population structure inference from single-cell tumor sequencing</article-title>
        <source>Nat Methods.</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>573</fpage>
        <lpage>576</lpage>
        <?supplied-pmid 27183439?>
        <pub-id pub-id-type="pmid">27183439</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Malikic</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Jahn</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kuipers</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Sahinalp</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Beerenwinkel</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Integrative inference of subclonal tumour evolution from single-cell and bulk sequencing data</article-title>
        <source>Nat Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>2750</fpage>
        <?supplied-pmid 31227714?>
        <pub-id pub-id-type="pmid">31227714</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Salehi</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Steif</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Roth</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Aparicio</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bouchard-Côté</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>ddClone: joint statistical inference of clonal populations from single cell and bulk tumour sequencing data</article-title>
        <source>Genome Biol.</source>
        <year>2017</year>
        <volume>18</volume>
        <fpage>44</fpage>
        <?supplied-pmid 28249593?>
        <pub-id pub-id-type="pmid">28249593</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <mixed-citation publication-type="other">Chen Z, Gong F, Wan L, Ma L. BiTSC2: Bayesian inference of tumor clonal tree by joint analysis of single-cell SNV and CNA data [Internet]. bioRxiv. 2020 [cited 2021 Aug 11]. p. 2020.11.30.380949. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2020.11.30.380949v1">https://www.biorxiv.org/content/10.1101/2020.11.30.380949v1</ext-link></mixed-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Baghaarabani L, Goliaei S, Foroughmand-Araabi M-H, Shariatpanahi SP, Goliaei B. Conifer: clonal tree inference for tumor heterogeneity with single-cell and bulk sequencing data [Internet]. Research Square; 2021. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.researchsquare.com/article/rs-263502/v1">https://www.researchsquare.com/article/rs-263502/v1</ext-link></mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sadeqi Azer</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Haghir Ebrahimabadi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Malikić</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khardon</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sahinalp</surname>
            <given-names>SC</given-names>
          </name>
        </person-group>
        <article-title>Tumor phylogeny topology inference via deep learning</article-title>
        <source>iScience</source>
        <year>2020</year>
        <volume>23</volume>
        <fpage>101655</fpage>
        <?supplied-pmid 33117968?>
        <pub-id pub-id-type="pmid">33117968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>El-Kebir</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Distinguishing linear and branched evolution given single-cell DNA sequencing data of tumors</article-title>
        <source>Algorithms Mol Biol.</source>
        <year>2021</year>
        <volume>16</volume>
        <fpage>14</fpage>
        <?supplied-pmid 34229713?>
        <pub-id pub-id-type="pmid">34229713</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Gao Y, Gaither J, Chifman J, Kubatko L. A phylogenetic approach to inferring the order in which mutations arise during cancer progression [Internet]. bioRxiv. 2021 [cited 2021 Aug 10]. p. 2020.05.06.081398. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2020.05.06.081398v5">https://www.biorxiv.org/content/10.1101/2020.05.06.081398v5</ext-link></mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miura</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Huuki</surname>
            <given-names>LA</given-names>
          </name>
          <name>
            <surname>Buturla</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Vu</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gomez</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Computational enhancement of single-cell sequences for inferring tumor evolution</article-title>
        <source>Bioinformatics.</source>
        <year>2018</year>
        <volume>34</volume>
        <fpage>i917</fpage>
        <lpage>i926</lpage>
        <?supplied-pmid 30423071?>
        <pub-id pub-id-type="pmid">30423071</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Ramazzotti D, Angaroni F, Maspero D, Ascolani G. Longitudinal cancer evolution from single cells. bioRxiv [Internet]. biorxiv.org. 2020; Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2020.01.14.906453v2.abstract">https://www.biorxiv.org/content/10.1101/2020.01.14.906453v2.abstract</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mallory</surname>
            <given-names>XF</given-names>
          </name>
          <name>
            <surname>Edrisi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Navin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Assessing the performance of methods for copy number aberration detection from single-cell DNA sequencing data</article-title>
        <source>PLoS Comput Biol.</source>
        <year>2020</year>
        <volume>16</volume>
        <fpage>e1008012</fpage>
        <?supplied-pmid 32658894?>
        <pub-id pub-id-type="pmid">32658894</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kozlov</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Darriba</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Flouri</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Morel</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>RAxML-NG: a fast, scalable, and user-friendly tool for maximum likelihood phylogenetic inference</article-title>
        <source>Bioinformatics.</source>
        <year>2019</year>
        <volume>35</volume>
        <fpage>4453</fpage>
        <lpage>4455</lpage>
        <?supplied-pmid 31070718?>
        <pub-id pub-id-type="pmid">31070718</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goloboff</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Catalano</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>TNT version 1.5, including a full implementation of phylogenetic morphometrics</article-title>
        <source>Cladistics.</source>
        <year>2016</year>
        <volume>32</volume>
        <fpage>221</fpage>
        <lpage>238</lpage>
        <?supplied-pmid 34727670?>
        <pub-id pub-id-type="pmid">34727670</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tavaré</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Some probabilistic and statistical problems in the analysis of DNA sequences</article-title>
        <source>Lectures on mathematics in the life sciences.</source>
        <year>1986</year>
        <volume>17</volume>
        <fpage>57</fpage>
        <lpage>86</lpage>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Felsenstein J. Inferring phylogenies. Sinauer associates Sunderland, MA; 2004.</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>
        <source>J Mol Evol.</source>
        <year>1981</year>
        <volume>17</volume>
        <fpage>368</fpage>
        <lpage>376</lpage>
        <?supplied-pmid 7288891?>
        <pub-id pub-id-type="pmid">7288891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>RAxML version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</article-title>
        <source>Bioinformatics.</source>
        <year>2014</year>
        <volume>30</volume>
        <fpage>1312</fpage>
        <lpage>1313</lpage>
        <?supplied-pmid 3998144?>
        <pub-id pub-id-type="pmid">24451623</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhou</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>X-X</given-names>
          </name>
          <name>
            <surname>Hittinger</surname>
            <given-names>CT</given-names>
          </name>
          <name>
            <surname>Rokas</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Evaluating fast maximum likelihood-based phylogenetic programs using empirical phylogenomic data sets</article-title>
        <source>Mol Biol Evol.</source>
        <year>2018</year>
        <volume>35</volume>
        <fpage>486</fpage>
        <lpage>503</lpage>
        <?supplied-pmid 29177474?>
        <pub-id pub-id-type="pmid">29177474</pub-id>
      </element-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Felsenstein</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Confidence limits on phylogenies: an approach using the bootstrap</article-title>
        <source>Evolution.</source>
        <year>1985</year>
        <volume>39</volume>
        <fpage>783</fpage>
        <lpage>791</lpage>
        <?supplied-pmid 28561359?>
        <pub-id pub-id-type="pmid">28561359</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lemoine</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Domelevo Entfellner</surname>
            <given-names>J-B</given-names>
          </name>
          <name>
            <surname>Wilkinson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Correia</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dávila Felipe</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>De Oliveira</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Renewing Felsenstein’s phylogenetic bootstrap in the era of big data</article-title>
        <source>Nature.</source>
        <year>2018</year>
        <volume>556</volume>
        <fpage>452</fpage>
        <lpage>456</lpage>
        <?supplied-pmid 29670290?>
        <pub-id pub-id-type="pmid">29670290</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nei</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A new method of inference of ancestral nucleotide and amino acid sequences</article-title>
        <source>Genetics.</source>
        <year>1995</year>
        <volume>141</volume>
        <fpage>1641</fpage>
        <lpage>1650</lpage>
        <?supplied-pmid 8601501?>
        <pub-id pub-id-type="pmid">8601501</pub-id>
      </element-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <mixed-citation publication-type="other">Wickham H. ggplot2: elegant graphics for data analysis: Springer; 2016.</mixed-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hartenstein</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Stem cells in the context of evolution and development</article-title>
        <source>Dev Genes Evol.</source>
        <year>2013</year>
        <volume>223</volume>
        <fpage>1</fpage>
        <lpage>3</lpage>
        <?supplied-pmid 23223955?>
        <pub-id pub-id-type="pmid">23223955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reya</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Morrison</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>MF</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>IL</given-names>
          </name>
        </person-group>
        <article-title>Stem cells, cancer, and cancer stem cells</article-title>
        <source>Nature.</source>
        <year>2001</year>
        <volume>414</volume>
        <fpage>105</fpage>
        <lpage>111</lpage>
        <?supplied-pmid 11689955?>
        <pub-id pub-id-type="pmid">11689955</pub-id>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kreso</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Dick</surname>
            <given-names>JE</given-names>
          </name>
        </person-group>
        <article-title>Evolution of the cancer stem cell model</article-title>
        <source>Cell Stem Cell.</source>
        <year>2014</year>
        <volume>14</volume>
        <fpage>275</fpage>
        <lpage>291</lpage>
        <?supplied-pmid 24607403?>
        <pub-id pub-id-type="pmid">24607403</pub-id>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Sun</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Guo</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CDC5L promotes hTERT expression and colorectal tumor growth</article-title>
        <source>Cell Physiol Biochem.</source>
        <year>2017</year>
        <volume>41</volume>
        <fpage>2475</fpage>
        <lpage>2488</lpage>
        <?supplied-pmid 28472785?>
        <pub-id pub-id-type="pmid">28472785</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>SSQ</given-names>
          </name>
          <name>
            <surname>Srivastava</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Llamosas</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Hawkins</surname>
            <given-names>NJ</given-names>
          </name>
          <name>
            <surname>Hesson</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Ward</surname>
            <given-names>RL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>ROR2 is epigenetically inactivated in the early stages of colorectal neoplasia and is associated with proliferation and migration</article-title>
        <source>BMC Cancer.</source>
        <year>2016</year>
        <volume>16</volume>
        <fpage>508</fpage>
        <?supplied-pmid 27440078?>
        <pub-id pub-id-type="pmid">27440078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR64">
      <label>64.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Pan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Song</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ji</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Lv</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>EXOSC5 as a novel prognostic marker promotes proliferation of colorectal cancer via activating the ERK and AKT pathways</article-title>
        <source>Front Oncol.</source>
        <year>2019</year>
        <volume>9</volume>
        <fpage>643</fpage>
        <?supplied-pmid 31380280?>
        <pub-id pub-id-type="pmid">31380280</pub-id>
      </element-citation>
    </ref>
    <ref id="CR65">
      <label>65.</label>
      <mixed-citation publication-type="other">Li S-R, Gyselman VG, Lalude O, Dorudi S, Bustin SA. Transcription of the inositol polyphosphate 1-phosphatase gene (INPP1) is upregulated in human colorectal cancer. Mol Carcinog. 2000;27:322–9.</mixed-citation>
    </ref>
    <ref id="CR66">
      <label>66.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dong</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Milholland</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Maslov</surname>
            <given-names>AY</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accurate identification of single-nucleotide variants in whole-genome-amplified single cells</article-title>
        <source>Nature Methods.</source>
        <year>2017</year>
        <volume>14</volume>
        <fpage>491</fpage>
        <lpage>493</lpage>
        <?supplied-pmid 28319112?>
        <pub-id pub-id-type="pmid">28319112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR67">
      <label>67.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alhopuro</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Phichith</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Tuupanen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sammalkorpi</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Nybondas</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Saharinen</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Unregulated smooth-muscle myosin in human intestinal neoplasia</article-title>
        <source>Proc Natl Acad Sci U S A.</source>
        <year>2008</year>
        <volume>105</volume>
        <fpage>5513</fpage>
        <lpage>5518</lpage>
        <?supplied-pmid 18391202?>
        <pub-id pub-id-type="pmid">18391202</pub-id>
      </element-citation>
    </ref>
    <ref id="CR68">
      <label>68.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Romero-Pérez</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Surdez</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Brunet</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Delattre</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Grünewald</surname>
            <given-names>TGP</given-names>
          </name>
        </person-group>
        <article-title>STAG mutations in cancer</article-title>
        <source>Trends Cancer Res.</source>
        <year>2019</year>
        <volume>5</volume>
        <fpage>506</fpage>
        <lpage>520</lpage>
      </element-citation>
    </ref>
    <ref id="CR69">
      <label>69.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Evrony</surname>
            <given-names>GD</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Mehta</surname>
            <given-names>BK</given-names>
          </name>
          <name>
            <surname>Benjamini</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>RM</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cell lineage analysis in human brain using endogenous retroelements</article-title>
        <source>Neuron.</source>
        <year>2015</year>
        <volume>85</volume>
        <fpage>49</fpage>
        <lpage>59</lpage>
        <?supplied-pmid 25569347?>
        <pub-id pub-id-type="pmid">25569347</pub-id>
      </element-citation>
    </ref>
    <ref id="CR70">
      <label>70.</label>
      <mixed-citation publication-type="other">Demeulemeester J, Dentro SC, Gerstung M, Van Loo P. Biallelic mutations in cancer genomes reveal local mutational determinants [Internet]. bioRxiv. 2021; Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2021.03.29.437407v1.abstract">https://www.biorxiv.org/content/10.1101/2021.03.29.437407v1.abstract</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR71">
      <label>71.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weber</surname>
            <given-names>LL</given-names>
          </name>
          <name>
            <surname>Sashittal</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>El-Kebir</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>doubletD: detecting doublets in single-cell DNA sequencing data</article-title>
        <source>Bioinformatics.</source>
        <year>2021</year>
        <volume>37</volume>
        <fpage>i214</fpage>
        <lpage>i221</lpage>
        <?supplied-pmid 34252961?>
        <pub-id pub-id-type="pmid">34252961</pub-id>
      </element-citation>
    </ref>
    <ref id="CR72">
      <label>72.</label>
      <mixed-citation publication-type="other">Zhu Y, Sengupta S, Wei L, Yang S, Ji Y. Tumor Evolution Decoder (TED): unveiling tumor evolution based on mutation profiles of subclones or single cells [Internet]. bioRxiv. 2019; Available from: <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/633610">http://biorxiv.org/lookup/doi/10.1101/633610</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR73">
      <label>73.</label>
      <mixed-citation publication-type="other">Yang Z. Molecular evolution: a statistical approach. Oxford: Oxford University Press; 2014.</mixed-citation>
    </ref>
    <ref id="CR74">
      <label>74.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>XS</given-names>
          </name>
        </person-group>
        <article-title>Single-cell whole-genome amplification and sequencing: methodology and applications</article-title>
        <source>Annu Rev Genomics Hum Genet.</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>79</fpage>
        <lpage>102</lpage>
        <?supplied-pmid 26077818?>
        <pub-id pub-id-type="pmid">26077818</pub-id>
      </element-citation>
    </ref>
    <ref id="CR75">
      <label>75.</label>
      <mixed-citation publication-type="other">Paradis E, Schliep K. ape 5.0: an environment for modern phylogenetics and evolutionary analyses in R. Bioinformatics. 2019;35:526–528.</mixed-citation>
    </ref>
    <ref id="CR76">
      <label>76.</label>
      <mixed-citation publication-type="other">Yu G, Smith DK, Zhu H, Guan Y, Lam TT. ggtree: an r package for visualization and annotation of phylogenetic trees with their covariates and other associated data. Methods in Ecology and Evolution. 2017;8:28–36.</mixed-citation>
    </ref>
    <ref id="CR77">
      <label>77.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zafar</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Nakhleh</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Navin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Monovar: single-nucleotide variant detection in single cells</article-title>
        <source>Nat Methods.</source>
        <year>2016</year>
        <volume>13</volume>
        <fpage>505</fpage>
        <lpage>507</lpage>
        <?supplied-pmid 27088313?>
        <pub-id pub-id-type="pmid">27088313</pub-id>
      </element-citation>
    </ref>
    <ref id="CR78">
      <label>78.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>DF</given-names>
          </name>
        </person-group>
        <article-title>Comparison of labeled trees with valency three</article-title>
        <source>J Combin Theory Ser B.</source>
        <year>1971</year>
        <volume>11</volume>
        <fpage>105</fpage>
        <lpage>119</lpage>
      </element-citation>
    </ref>
    <ref id="CR79">
      <label>79.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Kozlov</surname>
            <given-names>O</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Posada</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Models, optimizations, and tools for large-scale phylogenetic inference, handling sequence uncertainty, and taxonomic validation [Dr-Ing.]</article-title>
        <source>Karlsruher Institut für Technologie (KIT)</source>
        <year>2018</year>
      </element-citation>
    </ref>
    <ref id="CR80">
      <label>80.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Fletcher</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <source>Practical methods of optimization [Internet]</source>
        <year>2000</year>
      </element-citation>
    </ref>
    <ref id="CR81">
      <label>81.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brent</surname>
            <given-names>RP</given-names>
          </name>
        </person-group>
        <article-title>An algorithm with guaranteed convergence for finding a zero of a function</article-title>
        <source>The Computer Journal.</source>
        <year>1971</year>
        <volume>14</volume>
        <fpage>422</fpage>
        <lpage>425</lpage>
      </element-citation>
    </ref>
    <ref id="CR82">
      <label>82.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lutteropp</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kozlov</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Stamatakis</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A fast and memory-efficient implementation of the transfer bootstrap</article-title>
        <source>Bioinformatics.</source>
        <year>2020</year>
        <volume>36</volume>
        <fpage>2280</fpage>
        <lpage>2281</lpage>
        <?supplied-pmid 31755898?>
        <pub-id pub-id-type="pmid">31755898</pub-id>
      </element-citation>
    </ref>
    <ref id="CR83">
      <label>83.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Posada</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>CellCoal: coalescent simulation of single-cell sequencing samples</article-title>
        <source>Mol Biol Evol.</source>
        <year>2020</year>
        <volume>37</volume>
        <fpage>1535</fpage>
        <lpage>1542</lpage>
        <?supplied-pmid 32027371?>
        <pub-id pub-id-type="pmid">32027371</pub-id>
      </element-citation>
    </ref>
    <ref id="CR84">
      <label>84.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martincorena</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Somatic mutation in cancer and normal cells</article-title>
        <source>Science.</source>
        <year>2015</year>
        <volume>349</volume>
        <fpage>1483</fpage>
        <lpage>1489</lpage>
        <?supplied-pmid 26404825?>
        <pub-id pub-id-type="pmid">26404825</pub-id>
      </element-citation>
    </ref>
    <ref id="CR85">
      <label>85.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kimura</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The number of heterozygous nucleotide sites maintained in a finite population due to steady flux of mutations</article-title>
        <source>Genetics.</source>
        <year>1969</year>
        <volume>61</volume>
        <fpage>893</fpage>
        <lpage>903</lpage>
        <?supplied-pmid 5364968?>
        <pub-id pub-id-type="pmid">5364968</pub-id>
      </element-citation>
    </ref>
    <ref id="CR86">
      <label>86.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Aparicio</surname>
            <given-names>SAJR</given-names>
          </name>
          <name>
            <surname>Behjati</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Biankin</surname>
            <given-names>AV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Signatures of mutational processes in human cancer</article-title>
        <source>Nature.</source>
        <year>2013</year>
        <volume>500</volume>
        <fpage>415</fpage>
        <lpage>421</lpage>
        <?supplied-pmid 23945592?>
        <pub-id pub-id-type="pmid">23945592</pub-id>
      </element-citation>
    </ref>
    <ref id="CR87">
      <label>87.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alexandrov</surname>
            <given-names>LB</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>PH</given-names>
          </name>
          <name>
            <surname>Wedge</surname>
            <given-names>DC</given-names>
          </name>
          <name>
            <surname>Sale</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Clock-like mutational processes in human somatic cells</article-title>
        <source>Nat Genet.</source>
        <year>2015</year>
        <volume>47</volume>
        <fpage>1402</fpage>
        <lpage>1407</lpage>
        <?supplied-pmid 26551669?>
        <pub-id pub-id-type="pmid">26551669</pub-id>
      </element-citation>
    </ref>
    <ref id="CR88">
      <label>88.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>DF</given-names>
          </name>
          <name>
            <surname>Foulds</surname>
            <given-names>LR</given-names>
          </name>
        </person-group>
        <article-title>Comparison of phylogenetic trees</article-title>
        <source>Math Biosci.</source>
        <year>1981</year>
        <volume>53</volume>
        <fpage>131</fpage>
        <lpage>147</lpage>
      </element-citation>
    </ref>
    <ref id="CR89">
      <label>89.</label>
      <mixed-citation publication-type="other">Li H. Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM [Internet]. arXiv [q-bio.GN]. 2013; Available from: <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1303.3997">http://arxiv.org/abs/1303.3997</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR90">
      <label>90.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cibulskis</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lawrence</surname>
            <given-names>MS</given-names>
          </name>
          <name>
            <surname>Carter</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Sivachenko</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jaffe</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sougnez</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sensitive detection of somatic point mutations in impure and heterogeneous cancer samples</article-title>
        <source>Nature Biotechnology.</source>
        <year>2013</year>
        <volume>31</volume>
        <fpage>213</fpage>
        <lpage>219</lpage>
        <?supplied-pmid 23396013?>
        <pub-id pub-id-type="pmid">23396013</pub-id>
      </element-citation>
    </ref>
    <ref id="CR91">
      <label>91.</label>
      <mixed-citation publication-type="other">Poplin R, Ruano-Rubio V, DePristo MA, Fennell TJ. Scaling accurate genetic variant discovery to tens of thousands of samples. BioRxiv [Internet]. biorxiv.org. 2018; Available from: <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/201178v3.abstract">https://www.biorxiv.org/content/10.1101/201178v3.abstract</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR92">
      <label>92.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Garvin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Aboukhalil</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kendall</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Baslan</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Atwal</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Hicks</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Interactive analysis and assessment of single-cell copy-number variations</article-title>
        <source>Nat Methods.</source>
        <year>2015</year>
        <volume>12</volume>
        <fpage>1058</fpage>
        <lpage>1060</lpage>
        <?supplied-pmid 26344043?>
        <pub-id pub-id-type="pmid">26344043</pub-id>
      </element-citation>
    </ref>
    <ref id="CR93">
      <label>93.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>
        <source>Bioinformatics.</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>2987</fpage>
        <lpage>2993</lpage>
        <?supplied-pmid 21903627?>
        <pub-id pub-id-type="pmid">21903627</pub-id>
      </element-citation>
    </ref>
    <ref id="CR94">
      <label>94.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hård</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Al Hakim</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Kindblom</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Björklund</surname>
            <given-names>ÅK</given-names>
          </name>
          <name>
            <surname>Sennblad</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Demirci</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Conbase: a software for unsupervised discovery of clonal somatic mutations in single cells through read phasing</article-title>
        <source>Genome Biol.</source>
        <year>2019</year>
        <volume>20</volume>
        <fpage>68</fpage>
        <?supplied-pmid 30935387?>
        <pub-id pub-id-type="pmid">30935387</pub-id>
      </element-citation>
    </ref>
    <ref id="CR95">
      <label>95.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luquette</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Bohrson</surname>
            <given-names>CL</given-names>
          </name>
          <name>
            <surname>Sherman</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Identification of somatic mutations in single cell DNA-seq using a spatial model of allelic imbalance</article-title>
        <source>Nat Commun.</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>3908</fpage>
        <?supplied-pmid 31467286?>
        <pub-id pub-id-type="pmid">31467286</pub-id>
      </element-citation>
    </ref>
    <ref id="CR96">
      <label>96.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lähnemann</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Köster</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Fischer</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Borkhardt</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>McHardy</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Schönhuth</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Accurate and scalable variant calling from single cell DNA sequencing data with ProSolo</article-title>
        <source>Nat Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>6744</fpage>
        <?supplied-pmid 34795237?>
        <pub-id pub-id-type="pmid">34795237</pub-id>
      </element-citation>
    </ref>
    <ref id="CR97">
      <label>97.</label>
      <mixed-citation publication-type="other">Roch S. A short proof that phylogenetic tree reconstruction by maximum likelihood is hard [Internet]. IEEE/ACM Transactions on Computational Biology and Bioinformatics. 2006. p. 92–4. Available from: 10.1109/tcbb.2006.4</mixed-citation>
    </ref>
    <ref id="CR98">
      <label>98.</label>
      <mixed-citation publication-type="other">Stamatakis A, Kozlov AM, Kozlov A. Efficient maximum likelihood tree building methods. <ext-link ext-link-type="uri" xlink:href="http://hal.archives-ouvertes.fr">hal.archives-ouvertes.fr</ext-link>; 2020; Available from: <ext-link ext-link-type="uri" xlink:href="https://hal.archives-ouvertes.fr/hal-02535285/">https://hal.archives-ouvertes.fr/hal-02535285/</ext-link></mixed-citation>
    </ref>
    <ref id="CR99">
      <label>99.</label>
      <mixed-citation publication-type="other">Kozlov A, Alves JM, Stamatakis A, Posada D. CellPhy: accurate and fast probabilistic inference of single-cell phylogenies from scDNA-seq data. Github. 2021; <ext-link ext-link-type="uri" xlink:href="https://github.com/amkozlov/cellphy">https://github.com/amkozlov/cellphy</ext-link>.</mixed-citation>
    </ref>
    <ref id="CR100">
      <label>100.</label>
      <mixed-citation publication-type="other">Kozlov A, Alves JM, Stamatakis A, Posada D. CellPhy v0.9.1 source code. Zenodo. 2021. 10.5281/zenodo.5345921.</mixed-citation>
    </ref>
    <ref id="CR101">
      <label>101.</label>
      <mixed-citation publication-type="other">Kozlov A, Alves JM, Stamatakis A, Posada D. CellPhy: accurate and fast probabilistic inference of single-cell phylogenies from scDNA-seq data. Datasets. Bioproject. (2021) <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/bioproject/PRJNA789841">https://www.ncbi.nlm.nih.gov/bioproject/PRJNA789841</ext-link></mixed-citation>
    </ref>
  </ref-list>
</back>
