<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7672894</article-id>
    <article-id pub-id-type="publisher-id">3863</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03863-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>The MOBSTER R package for tumour subclonal deconvolution from bulk DNA whole-genome sequencing data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4240-3265</contrib-id>
        <name>
          <surname>Caravagna</surname>
          <given-names>Giulio</given-names>
        </name>
        <address>
          <email>gcaravagna@units.it</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sanguinetti</surname>
          <given-names>Guido</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Graham</surname>
          <given-names>Trevor A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Sottoriva</surname>
          <given-names>Andrea</given-names>
        </name>
        <address>
          <email>andrea.sottoriva@icr.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.5133.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 1941 4308</institution-id><institution>University of Trieste, </institution></institution-wrap>Trieste, Italy </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.5970.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1762 9868</institution-id><institution>International School for Advanced Studies, </institution></institution-wrap>Trieste, Italy </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.4868.2</institution-id><institution-id institution-id-type="ISNI">0000 0001 2171 1133</institution-id><institution>Barts Cancer Institute, Barts and the London School of Medicine and Dentistry, Queen Mary University of London, </institution></institution-wrap>London, UK </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.18886.3f</institution-id><institution-id institution-id-type="ISNI">0000 0001 1271 4623</institution-id><institution>The Institute of Cancer Research, </institution></institution-wrap>London, UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>11</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>531</elocation-id>
    <history>
      <date date-type="received">
        <day>7</day>
        <month>8</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>4</day>
        <month>11</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">The large-scale availability of whole-genome sequencing profiles from bulk DNA sequencing of cancer tissues is fueling the application of evolutionary theory to cancer. From a bulk biopsy, subclonal deconvolution methods are used to determine the composition of cancer subpopulations in the biopsy sample, a fundamental step to determine clonal expansions and their evolutionary trajectories.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In a recent work we have developed a new model-based approach to carry out subclonal deconvolution from the site frequency spectrum of somatic mutations. This new method integrates, for the first time, an explicit model for neutral evolutionary forces that participate in clonal expansions; in that work we have also shown that our method improves largely over competing data-driven methods. In this Software paper we present mobster, an open source R package built around our new deconvolution approach, which provides several functions to plot data and fit models, assess their confidence and compute further evolutionary analyses that relate to subclonal deconvolution.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">We present the mobster package for tumour subclonal deconvolution from bulk sequencing, the first approach to integrate Machine Learning and Population Genetics which can explicitly model co-existing neutral and positive selection in cancer. We showcase the analysis of two datasets, one simulated and one from a breast cancer patient, and overview all package functionalities.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Tumour subclonal deconvolution</kwd>
      <kwd>Cancer evolution</kwd>
      <kwd>Population genetics</kwd>
      <kwd>Dirichlet mixture model</kwd>
      <kwd>Whole-genome DNA sequencing</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100004440</institution-id>
            <institution>Wellcome Trust</institution>
          </institution-wrap>
        </funding-source>
        <award-id>202778/B/16/Z</award-id>
        <award-id>202778/Z/16/Z</award-id>
        <award-id>105104/Z/14/Z</award-id>
        <principal-award-recipient>
          <name>
            <surname>Graham</surname>
            <given-names>Trevor A.</given-names>
          </name>
          <name>
            <surname>Sottoriva</surname>
            <given-names>Andrea</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000289</institution-id>
            <institution>Cancer Research UK</institution>
          </institution-wrap>
        </funding-source>
        <award-id>A22909</award-id>
        <award-id>A19771</award-id>
        <principal-award-recipient>
          <name>
            <surname>Graham</surname>
            <given-names>Trevor A.</given-names>
          </name>
          <name>
            <surname>Sottoriva</surname>
            <given-names>Andrea</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000265</institution-id>
            <institution>Medical Research Council</institution>
          </institution-wrap>
        </funding-source>
        <award-id>MR/P000789/1</award-id>
        <principal-award-recipient>
          <name>
            <surname>Sottoriva</surname>
            <given-names>Andrea</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>NCI U54 CA217376</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par8">One of the most exciting recent developments in cancer informatics is the ability to reconstruct the evolutionary history and clonal composition of tumours from whole-genome DNA sequencing (WGS) data [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>]. This analysis leverages statistical models and bioinformatics tools that can recapitulate patient-level <italic>intra-tumour heterogeneity</italic>, and that we can use to study, from an evolutionary point of view, tumour evolutionary patterns across multiple patients [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR6">6</xref>]. An investigation of the evolutionary forces underpinning a tumour usually begins by performing a <italic>subclonal deconvolution</italic> of the bulk WGS data of a single patient. The main objective of this first and crucial task is to determine how many cancer (sub)clones co-exist in the tumour, and the general architecture of tumour population [<xref ref-type="bibr" rid="CR7">7</xref>]. This step is crucial as the construction of the tumour evolutionary trajectory depends on results from this analysis. The deconvolution of the signal is however challenged by the mixed effect of positive, neutral and negative selection that are all potentially operating within the tumour; see a review and references therein for a discussion on the role of these forces in driving tumour evolution [<xref ref-type="bibr" rid="CR8">8</xref>].</p>
    <p id="Par9">Several unsupervised bioinformatics tools exist that can be used to determine the clonal architecture of a tumour; all of the tools solve different formulations of a clustering problem, defined from the site frequency spectrum of somatic mutations detected in the WGS biopsies and other covariates [<xref ref-type="bibr" rid="CR7">7</xref>]. In a recent work [<xref ref-type="bibr" rid="CR9">9</xref>], we have shown that these clustering methods have severe limitations stemming from the fact that they do not account for neutral evolutionary forces, one key force underpinning tumour growth (see [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR13">13</xref>]). A direct consequence of their data-driven design is that they tend to overestimate the number of tumour clones, and the complexity of the tumour clonal architecture. In the same work [<xref ref-type="bibr" rid="CR9">9</xref>], we have mitigated these limitations by approaching the clustering problem through the integration of Machine Learning and Population Genetics. In particular, we have used mathematical models from Population Genetics to create a mixture model that, for the first time, could account also for within-clone neutral evolutionary dynamics.</p>
    <p id="Par10">The new model-based method MOBSTER (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a) can identify subclones that are experiencing <italic>positive selection,</italic> while at the same time modelling background neutral dynamics. This Software paper describes the implementation of mobster, a new open source R package for tumour subclonal deconvolution that implements the statistical model introduced in [<xref ref-type="bibr" rid="CR9">9</xref>].<fig id="Fig1"><label>Fig. 1</label><caption><p><bold>a</bold> Pipeline for data analysis with the mobster R package for subclonal deconvolution. The package can be used to infer the clonal composition of a tumour bulk DNA biopsy. The statistical method integrates machine learning and evolutionary theory to detect subclones that have expanded due to positive selection, while modelling intra-clone neutral evolution with distributions predicted by population genetics. mobster also computes clone-specific evolutionary parameters (e.g., mutation rates, selection coefficients), dN/dS statistics and clone trees. <bold>b</bold> Example tumour clonal expansion simulated with the stochastic branching process implemented in the TEMULATOR (<ext-link ext-link-type="uri" xlink:href="https://t-heide.github.io/TEMULATOR/">https://t-heide.github.io/TEMULATOR/</ext-link>) package. After <inline-formula id="IEq69"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=13$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>13</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq69.gif"/></alternatives></inline-formula> cell doublings a subclonal driver triggers a clonal expansion that sweeps in the ancestral population (left). Using mobster from a bulk sample collected at <inline-formula id="IEq70"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=17$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>17</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq70.gif"/></alternatives></inline-formula> we can retrieve the tumour architecture, the clone tree and the evolutionary parameters of the simulated tumour (right)</p></caption><graphic xlink:href="12859_2020_3863_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par11">The package mobster can be used to detect cancer subclones in bulk whole-genome DNA sequencing assays of tumour and matched normal samples (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). Besides clustering, the package implements several other analyses that can compute a number of evolutionary parameters that characterize tumour growth, which we discuss below.</p>
    <p id="Par12">The package is implemented using the S3 object system in R (version &gt;= 3.6.0), providing easy access to the main inference algorithm and a number of visualization functions that can be used to inspect the input data, and the model fits. The package supports different types of input formats that store input data for the somatic mutations detected in the tumour. The theory of MOBSTER is based on the site frequency spectrum of each somatic mutation, which can be either single-nucleotide variants or more complex insertions and deletions (provided the frequency spectrum is computable). For every mutation mobster needs to know either the Variant Allele Frequency (VAF), i.e., the ratio of read counts mapping to the mutant allele, over the total coverage at the variant locus, or the Cancer Cell Fraction (CCF). The CCF is the proportion of cancer cells harboring the mutations, and must be pre-computed normalizing the VAF for tumour sample purity and tumour copy number segments. All the calls (i.e., somatic mutations, copy number and tumour purity estimates) should be generated before tumour subclonal analysis using external bioinformatics tools. Input frequency values have to range in <inline-formula id="IEq1"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[\mathrm{0,1}]$$\end{document}</tex-math><mml:math id="M6"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq1.gif"/></alternatives></inline-formula> consistently with the support of the probability distributions used in MOBSTER’s statistical model. VAF values by definition range in <inline-formula id="IEq2"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[\mathrm{0,1}]$$\end{document}</tex-math><mml:math id="M8"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq2.gif"/></alternatives></inline-formula>. For CCF values this is not necessarily the case, since CCF values of clonal mutations, which are by definition present in 100% of cancer cells, range around 1; for this reason, canonical CCF values can be adjusted by dividing the CCF estimate by half. In this case they technically represent the expected allele frequency for a clonal diploid mutation, for a pure tumour sample (i.e., a sample with no contamination from normal cells).</p>
    <p id="Par13">To facilitate data input for the mobster package, input VAF values can also be provided from a file storing somatic mutations in the standard Variant Calling Format (see the package manual for input requirements).</p>
    <sec id="Sec3">
      <title>The model</title>
      <p id="Par14">The statistical model implemented in the mobster package a Dirichlet finite mixture with mixed distributions [<xref ref-type="bibr" rid="CR9">9</xref>]. It contains one (optional) Pareto Type-I random variable (a type of power-law), and <inline-formula id="IEq3"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\ge 1$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>k</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq3.gif"/></alternatives></inline-formula> Beta random variables; the overall model is a univariate finite mixture with <inline-formula id="IEq4"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k+1$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq4.gif"/></alternatives></inline-formula> components if the tail is fit to data, and <inline-formula id="IEq5"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M14"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq5.gif"/></alternatives></inline-formula> otherwise. In this model, Beta components capture ongoing clonal expansions, while the power law tail captures neutral dynamics; the power law distribution is predicted by Population Genetics of mutant alleles spreading in growing populations, and has been recently used within cancer evolution [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref>]. Model selection determines the optimal value for <inline-formula id="IEq6"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M16"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq6.gif"/></alternatives></inline-formula>, and also if a tail should be fit, or not, to data. A model fit with <inline-formula id="IEq7"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k=1$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq7.gif"/></alternatives></inline-formula> represents a monoclonal tumour (i.e., with no evidence of ongoing subclonal selection), a model with <inline-formula id="IEq8"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k&gt;1$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>k</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq8.gif"/></alternatives></inline-formula> is polyclonal.</p>
      <p id="Par15">The likelihood for <inline-formula id="IEq9"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M22"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq9.gif"/></alternatives></inline-formula> datapoints <inline-formula id="IEq10"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${x}_{i}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq10.gif"/></alternatives></inline-formula> in data <inline-formula id="IEq11"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$D$$\end{document}</tex-math><mml:math id="M26"><mml:mi>D</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq11.gif"/></alternatives></inline-formula> is<disp-formula id="Equa"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$f(D|\theta ,\pi )={\prod\limits_{i=1}^{n}}\left[{\pi }_{1}g({x}_{i}|{x}_{*},\alpha ) + {\sum\limits_{w=2}^{k}}{\pi }_{w}h({x}_{i}|{a}_{w-1},{b}_{w-1})\right]$$\end{document}</tex-math><mml:math id="M28" display="block"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover></mml:mrow><mml:mfenced close="]" open="["><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>g</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover></mml:mrow><mml:msub><mml:mi>π</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math><graphic xlink:href="12859_2020_3863_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq12"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$g$$\end{document}</tex-math><mml:math id="M30"><mml:mi>g</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq12.gif"/></alternatives></inline-formula> and <inline-formula id="IEq13"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$h$$\end{document}</tex-math><mml:math id="M32"><mml:mi>h</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq13.gif"/></alternatives></inline-formula> are density functions for the mixture components, <inline-formula id="IEq14"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta =\{{x}_{*},\alpha ,{a}_{1},\ldots,{a}_{k},{b}_{1},\ldots, {b}_{k}\}$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi>θ</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq14.gif"/></alternatives></inline-formula> is a set of parameters; here <inline-formula id="IEq15"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\pi =({\pi }_{1}, \ldots,{\pi }_{k+1})$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mi>π</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq15.gif"/></alternatives></inline-formula> are mixing proportions in a standard mixture model with <inline-formula id="IEq16"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n\times (k+1)$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq16.gif"/></alternatives></inline-formula> latent variables <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z$$\end{document}</tex-math><mml:math id="M40"><mml:mi>z</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq17.gif"/></alternatives></inline-formula> (which determine the assignment probability of each one of the <inline-formula id="IEq18"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M42"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq18.gif"/></alternatives></inline-formula> input points to the <inline-formula id="IEq19"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k+1$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq19.gif"/></alternatives></inline-formula> mixture components). The Pareto component (fixed indexed position <inline-formula id="IEq20"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq20.gif"/></alternatives></inline-formula> of the mixture) follows the standard Pareto Type-I density function, and the other components the standard Beta density. The details on the densities, the model derivation and the fitting strategy are presented in detail in [<xref ref-type="bibr" rid="CR9">9</xref>].
</p>
      <p id="Par16">A MOBSTER model is fit through an iterative procedure that resembles an Expectation-Maximization strategy; the fit combines the maximum likelihood estimators for the Pareto tail, and the moment-matching estimator for the Beta peaks (default implementation). A full maximum likelihood estimation via the expectation maximization algorithm is also available. Model selection can optimize the value of <inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M48"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq21.gif"/></alternatives></inline-formula>
<italic>as well as</italic> the presence or absence of the tail in the fit. A model <inline-formula id="IEq22"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M50"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq22.gif"/></alternatives></inline-formula> with size <inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M52"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq23.gif"/></alternatives></inline-formula> (number of parameters) is scored according to the following quantities<disp-formula id="Equb"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{NLL}= -log\, f\left(D|\theta ,\pi \right) \qquad (\text{negative log-likelihood})$$\end{document}</tex-math><mml:math id="M54" display="block"><mml:mrow><mml:mtext>NLL</mml:mtext><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mspace width="0.166667em"/><mml:mi>f</mml:mi><mml:mfenced close=")" open="("><mml:mi>D</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>θ</mml:mi><mml:mo>,</mml:mo><mml:mi>π</mml:mi></mml:mfenced><mml:mspace width="2em"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>negative log-likelihood</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2020_3863_Article_Equb.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equc"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{BIC}=2\,NLL+\lambda\,log\,n \qquad (\text{Bayesian Information Criterion})$$\end{document}</tex-math><mml:math id="M56" display="block"><mml:mrow><mml:mtext>BIC</mml:mtext><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.166667em"/><mml:mi>N</mml:mi><mml:mi>L</mml:mi><mml:mi>L</mml:mi><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mspace width="0.166667em"/><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mspace width="0.166667em"/><mml:mi>n</mml:mi><mml:mspace width="2em"/><mml:mo stretchy="false">(</mml:mo><mml:mtext>Bayesian Information Criterion</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2020_3863_Article_Equc.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equd"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{ICL}=\text{BIC}+H\left(z\right) \qquad (\text{Integrated Classification Likelihood})$$\end{document}</tex-math><mml:math id="M58" display="block"><mml:mrow><mml:mtext>ICL</mml:mtext><mml:mo>=</mml:mo><mml:mtext>BIC</mml:mtext><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:mfenced close=")" open="("><mml:mi>z</mml:mi></mml:mfenced><mml:mspace width="2em"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>Integrated Classification Likelihood</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><graphic xlink:href="12859_2020_3863_Article_Equd.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Eque"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\text{reICL}=\text{BIC}+H\left(\widehat{z}\right) \qquad (\text{reduced ICL}).$$\end{document}</tex-math><mml:math id="M60" display="block"><mml:mrow><mml:mtext>reICL</mml:mtext><mml:mo>=</mml:mo><mml:mtext>BIC</mml:mtext><mml:mo>+</mml:mo><mml:mi>H</mml:mi><mml:mfenced close=")" open="("><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mfenced><mml:mspace width="2em"/><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mtext>reduced ICL</mml:mtext><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2020_3863_Article_Eque.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par17">Here <inline-formula id="IEq24"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$H(z)$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>H</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>z</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq24.gif"/></alternatives></inline-formula> is the entropy of the latent variables <inline-formula id="IEq25"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z$$\end{document}</tex-math><mml:math id="M64"><mml:mi>z</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq25.gif"/></alternatives></inline-formula>, and <inline-formula id="IEq26"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{z}$$\end{document}</tex-math><mml:math id="M66"><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq26.gif"/></alternatives></inline-formula> a re-normalisation of <inline-formula id="IEq27"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$z$$\end{document}</tex-math><mml:math id="M68"><mml:mi>z</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq27.gif"/></alternatives></inline-formula> after removal of tail mutations (i.e., points with hard clustering assignments to the tail). The scoring is obtained extending the popular BIC with the entropy of the model's latent variables, which leads to the ICL approach. We also derived a different version of the ICL score which uses the entropy for a subset of variables <inline-formula id="IEq28"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{z}$$\end{document}</tex-math><mml:math id="M70"><mml:mover accent="true"><mml:mi>z</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq28.gif"/></alternatives></inline-formula>; this latter is the default score for model selection and is called reduced ICL (reICL). The intuition of reICL is to penalize the overlap between Beta components of the mixture—i.e., promoting models with clear, well-separated subclonal peaks.</p>
      <p id="Par18">In [<xref ref-type="bibr" rid="CR9">9</xref>] we provide extensive testing for MOBSTER, comparing our approach to other popular methods in the field in a variety of settings; e.g., with single-sample or multi-region tumor datasets, with variable sequencing coverage and sample purity, and with different input clonal architectures.</p>
    </sec>
    <sec id="Sec4">
      <title>Main software functions</title>
      <sec id="Sec5">
        <title>Fitting functions</title>
        <p id="Par19">Function mobster_fit is the interface to the Dirichlet finite mixture that can cluster the input mutations into <inline-formula id="IEq29"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M72"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq29.gif"/></alternatives></inline-formula> Beta components—i.e., <inline-formula id="IEq30"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M74"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq30.gif"/></alternatives></inline-formula> clonal peaks—and one optional power law tail for neutral mutations. The function implements a routine for model-selection that determines the optimal number of Beta clusters <inline-formula id="IEq31"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k\ge 1$$\end{document}</tex-math><mml:math id="M76"><mml:mrow><mml:mi>k</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq31.gif"/></alternatives></inline-formula>, and whether a tail should be used to fit the data, or not. Models are scored using data likelihood, regularised by model complexity with the aid of the entropy of the latent variables (see above); this function takes a parameter to identify which scoring strategy should be used to determine the best model. Function mobster_fit repeats the fit a desired number of times, sampling multiple initial conditions for the model parameters to avoid local optima. The tool can exploit a parallel inference engine, which can be used to speed up the fit with multi-core architectures. In general, however, the fit is fast compared to other approaches, possibly because of the maximum-likelihood formulation of the inference, e.g., the analysis of a tumour with about 13,000 somatic mutations takes about one minute, on a standard laptop, without exploiting the parallel inference engine.</p>
        <p id="Par20">A post-hoc cluster-selection heuristic is available to filter out clusters that are either too small, or that contain too few mutations; post-hoc, the package can also assign new mutations (i.e., previously unseen) to the model’s clusters, conditioning on the inferred parameters. Density functions are available for the S3 model object, as well as functions to sample data from a fit model, or to create a random generative model (clusters and parameters) that can be used for data generation. This utility can be easily used for synthetic benchmarking of MOBSTER or other subclonal deconvolution tools.</p>
        <p id="Par21">Confidence of the fits can be computed using parametric and non-parametric bootstrap procedures that are available in mobster [<xref ref-type="bibr" rid="CR14">14</xref>]. Both procedures take as input a model object computed from mobster_fit, and the number <inline-formula id="IEq32"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M78"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq32.gif"/></alternatives></inline-formula> of required bootstrap samples. The non-parametric approach re-samples <inline-formula id="IEq33"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M80"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq33.gif"/></alternatives></inline-formula> datasets of size equal to the original dataset, therefore sampling with repetition from the original dataset; the parametric approach samples <inline-formula id="IEq34"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M82"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq34.gif"/></alternatives></inline-formula> new datasets from the fit model. In both cases the new datasets are used to fit <inline-formula id="IEq35"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M84"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq35.gif"/></alternatives></inline-formula> new models with a parallel fitting routing, and from the output fits the package computes a distribution over the full model (i.e., the frequency at which the input model is re-fit) and over the parameter fits to the original data. Bootstrap results can be used to estimate confidence intervals, using a given confidence <inline-formula id="IEq36"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M86"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq36.gif"/></alternatives></inline-formula>-level with <inline-formula id="IEq37"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0&lt;\alpha &lt;1$$\end{document}</tex-math><mml:math id="M88"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mi>α</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq37.gif"/></alternatives></inline-formula> to determine quantiles. In the case of the non-parametric approach the package also computes the co-clustering probability for each pair of input mutations; this is a quantity that can be used to determine clustering’s stability, defined as the frequency at which two mutations cluster together. We note that in this case the frequency is bounded by the probability of sampling every pair of mutations in the same bootstrap resample.</p>
      </sec>
      <sec id="Sec6">
        <title>Visualization functions</title>
        <p id="Par22">Model fits can be plotted as data histograms colored by clustering assignment, with the fit density (per component and overall) overlaid to the data histogram. A number of functions can be used to plot the model likelihood, the entropy of the latent variables, the sum of squares error of the fit to data and the mixing proportions. An additional function allows the user to inspect alternative fits of the data, which helps for model selection in cases where one is not confident about the tool parameterizations. Specific functions also allow to visualize results from bootstrap analysis, giving easy access to the bootstrap distribution and confidence intervals.</p>
      </sec>
      <sec id="Sec7">
        <title>Post-clustering analyses</title>
        <p id="Par23">The package can be used to run further (post-clustering) analyses directly from the output of mobster_fit. For example, dN/dS statistics from the ratio of nonsynonymous to synonymous single nucleotide mutations can be computed for either the clusters of a single patient, or across multiple patients (e.g., pooling all tail mutations). Computations are carried out interfacing mobster to dndscv, an R package for dN/dS [<xref ref-type="bibr" rid="CR15">15</xref>]. From a fit, mobster can compute also the tumour’s evolutionary parameters, revealing the <italic>mutation rate</italic>
<inline-formula id="IEq38"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu &gt;0$$\end{document}</tex-math><mml:math id="M90"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq38.gif"/></alternatives></inline-formula>, and the <italic>selective advantage coefficient</italic>
<inline-formula id="IEq39"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s&gt;0$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mi>s</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq39.gif"/></alternatives></inline-formula> and the age of each subclone, in units of tumour doubling times. Interfacing with the ctree R package, clone trees can also be readily assembled from the output mobster clusters [<xref ref-type="bibr" rid="CR4">4</xref>].</p>
      </sec>
      <sec id="Sec8">
        <title>Detailed functionalities</title>
        <p id="Par24">In Additional file <xref rid="MOESM1" ref-type="media">1</xref> of this paper we provide six extra notes that explain the most relevant mobster functions and their parameters.</p>
        <p id="Par25">Using a markdown-style with example R code, these notes discuss the following topics:<list list-type="order"><list-item><p id="Par26">Introduction to the input format, simple fits and data-generation process;</p></list-item><list-item><p id="Par27">plotting functions for fit models and input data;</p></list-item><list-item><p id="Par28">bootstrap estimation for confidence assessment;</p></list-item><list-item><p id="Par29">post-clustering inference of Population Genetics parameters of tumour growth;</p></list-item><list-item><p id="Par30">post-clustering clone-specific dN/dS statistics;</p></list-item><list-item><p id="Par31">post-clustering clone trees generation.</p></list-item></list></p>
      </sec>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Results</title>
    <sec id="Sec10">
      <title>Relation to tumour growth models</title>
      <p id="Par32">We show the analysis of a simulated tumour using the mobster package. The tumour is simulated using thee <italic>stochastic branching process</italic> [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR13">13</xref>] model of tumour growth, which is implemented in the TEMULATOR open source R package.<xref ref-type="fn" rid="Fn1">1</xref></p>
      <p id="Par33">In brief, the stochastic branching process that we use is a discrete-time discrete-state Markov process that describes cell divisions and mutation accumulation. At each time point <inline-formula id="IEq40"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t&gt;0$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq40.gif"/></alternatives></inline-formula> cells divide or die, with some probability; when they divide successfully the somatic mutations are copied into daughter cells, and new accumulation are accumulated at a certain rate (the tumour mutation rate). This simple linear birth–death model captures the diffusion of mutant alleles (i.e., somatic mutations) in expanding populations (i.e., cells dividing). A selective advantage coefficient <inline-formula id="IEq41"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s&gt;0$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:mi>s</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq41.gif"/></alternatives></inline-formula> controls the propensity of successful cell divisions or, in other words, the rate of growth of the progeny of any given cell—this is a measure of fitness for a cellular population. In the model implemented in the TEMULATOR package, the cell initiating the tumour starts with a baseline value <inline-formula id="IEq42"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{0}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq42.gif"/></alternatives></inline-formula>, and its progeny keeps sharing the same <inline-formula id="IEq43"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{0}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq43.gif"/></alternatives></inline-formula> value. At any given timepoint, if a new subclonal driver mutation triggers the formation of a more fit clone, its value of <inline-formula id="IEq44"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M102"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq44.gif"/></alternatives></inline-formula> is increased relative to <inline-formula id="IEq45"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{0}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq45.gif"/></alternatives></inline-formula> (i.e. <inline-formula id="IEq46"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${s}_{1}={s}_{0}+{\delta }_{1}$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq46.gif"/></alternatives></inline-formula> is the new clone-specific value for the coefficient). It is possible to show that, in the long run, the new subclonal population outgrows the parental clonal population. This model is particularly interesting since it allows deriving the analytical Power law distribution for within-clone neutral evolutionary dynamics used in the MOBSTER model [<xref ref-type="bibr" rid="CR9">9</xref>]—i.e., the distribution of the site frequency spectrum for somatic mutations that accumulate in-between the formation of new clones with different values of <inline-formula id="IEq47"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M108"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq47.gif"/></alternatives></inline-formula>. This is true for both the deterministic version of the model based on an ordinary differential equation representation of the Markov chain [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>], as well as for the stochastic counterpart ruled by a master equation [<xref ref-type="bibr" rid="CR13">13</xref>].</p>
      <p id="Par34">In Fig. <xref rid="Fig1" ref-type="fig">1</xref>b (left panel) we show a simulated tumour where after <inline-formula id="IEq48"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=13$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>13</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq48.gif"/></alternatives></inline-formula> cell doublings a subclonal driver triggers a clonal expansion that sweeps in the ancestral population. The tumour bulk WGS data is simulated form the tumour cell population collected at time <inline-formula id="IEq49"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t=17$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>17</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq49.gif"/></alternatives></inline-formula>, when the subclone has reached a tumour mass that is detectable relative to the overall tumour size, considering a simulated WGS assay with Poisson-distributed coverage with rate <inline-formula id="IEq50"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda =120$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>=</mml:mo><mml:mn>120</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq50.gif"/></alternatives></inline-formula> (i.e., mean coverage 120×).</p>
      <p id="Par35">We run filtering of simulated somatic mutations consistently with a standard quality-check analysis, and identify <inline-formula id="IEq51"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=3499$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>3499</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq51.gif"/></alternatives></inline-formula> somatic mutations with VAF above 5%. We use these to run a mobster analysis with default parameters Fig. <xref rid="Fig1" ref-type="fig">1</xref>b (right panel), and retrieve the generative model simulated with TEMULATOR. In particular, the tool detects <inline-formula id="IEq52"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K=2$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq52.gif"/></alternatives></inline-formula> Beta clusters, plus one Pareto tail. The Beta clusters reveal clonal mutations (cluster C1, red; 30% of the mutations) present in all tumour cells in the simulated biopsy, as well as the mutations that characterize the ongoing subclonal expansion (cluster C2, blue; about 40% of the mutations). Mutations assigned to the tumour tail—an intermixing of the tails of both clones—are about 30% of the simulated mutations. Using functionalities of the mobster package we retrieve evolutionary parameters that we used to simulate the tumour with TEMULATOR. In particular we obtain a mutation rate <inline-formula id="IEq53"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mu =71.4$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:mn>71.4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq53.gif"/></alternatives></inline-formula> (in mutations per cell division), and the subclone parameters—i.e., we date the subclone to <inline-formula id="IEq54"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{t}=13.3$$\end{document}</tex-math><mml:math id="M122"><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>13.3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq54.gif"/></alternatives></inline-formula> (age of the subclone relative to its ancestor) and retrieve its selection coefficient to <inline-formula id="IEq55"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{s}=1.73$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>1.73</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq55.gif"/></alternatives></inline-formula> (where 1 is the baseline value of the ancestor). Through the interface of mobster with other packages, we can also retrieve the clone tree that explains this architecture, which in this case is trivial because C2 is the only possible descendant of C1.</p>
      <p id="Par36">Overall, this simple example shows that we can simulate tumour growth (with specific evolutionary parameters like mutation rate, selection coefficients etc.), and that we can faithfully retrieve such parameters and architectures using the mobster package.</p>
    </sec>
    <sec id="Sec11">
      <title>Subclonal deconvolution from the PD4120a breast tumour</title>
      <p id="Par37">We discuss an example application to a WGS dataset of a real primary breast cancer; this dataset has been first discussed in [<xref ref-type="bibr" rid="CR7">7</xref>] and also re-analyzed in our recent work [<xref ref-type="bibr" rid="CR9">9</xref>]. The analysis that we present here reports the same overall conclusions but is more detailed than the one in [<xref ref-type="bibr" rid="CR9">9</xref>], as it serves to show multiple functionalities of the mobster package.</p>
      <p id="Par38">This breast cancer sample (PD4120a) has been sequenced at very high-coverage (approximately 180×) and presents with <inline-formula id="IEq56"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=4643$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>4643</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq56.gif"/></alternatives></inline-formula> somatic single-nucleotide variants (SNVs) mapping to chromosome 3; this reduced dataset has been generated and quality-checked for one of our earlier works [<xref ref-type="bibr" rid="CR12">12</xref>]. Chromosome 3 is diploid and therefore the VAF analysis of mutations mapping to that chromosome is analogous to using CCF values (here re-scaled in <inline-formula id="IEq57"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[\mathrm{0,1}]$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq57.gif"/></alternatives></inline-formula>). This is true because for diploid regions the CCF computation from VAF is trivial, and corresponds just to a purity adjustment.</p>
      <p id="Par39">A call to mobster_fit on the input mutations with default parameters computes the output model, as well as a number of alternative fitting solutions. The computation takes less than a couple of minutes on a standard laptop. The best output model computed using reICL is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, while the sequencing depth of the input mutations is shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b to show the high-quality of the input data. mobster fits the input data with <inline-formula id="IEq58"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K=3$$\end{document}</tex-math><mml:math id="M130"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq58.gif"/></alternatives></inline-formula> Beta components, and one Pareto tail. This reflects a cancer sample that harbours clonal mutations, two distinct sub-clones enjoying a clonal expansion triggered by positive selection, and the tail of within-clone neutral dynamics. This 2-subclones model is a simplification of the v proposed in the original analysis of PD4120a [<xref ref-type="bibr" rid="CR7">7</xref>]. As suggested in [<xref ref-type="bibr" rid="CR9">9</xref>], the 2-subclones model seems more plausible in light of a complementary analysis carried out in [<xref ref-type="bibr" rid="CR7">7</xref>], where it is shown that tail mutations after phasing associate to multiple nodes of the tumour’s clone tree. This is consistent with the signal of polyphyletic lineages that by definition constitute neutral mutations, and not with mutations hitchhiking tumour subclones. Therefore, the input <inline-formula id="IEq59"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=4643$$\end{document}</tex-math><mml:math id="M132"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>4643</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq59.gif"/></alternatives></inline-formula> SNVs are assigned to 4 clusters by MOBSTER (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c); the pool of clonal mutations represents the larger cluster (C1) with more than 30% of the input SNVs, the largest subclone (C2) and the tail have a similar number of mutations (i.e., about 25% of the input SNVs), and the smallest cluster is one of the two subclones (C3).<fig id="Fig2"><label>Fig. 2</label><caption><p>MOBSTER analysis of WGS sample PD4120a (breast cancer). <bold>a</bold> MOBSTER fit for <inline-formula id="IEq71"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=4643$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>4643</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq71.gif"/></alternatives></inline-formula> somatic mutations mapping to chromosome 3, which is largely diploid. Here the input VAF (Observed frequency) is adjusted by tumour purity. MOBSTER identifies <inline-formula id="IEq72"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K=3$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq72.gif"/></alternatives></inline-formula> Beta components and one tail, as shown previously in [CG20]. <bold>b</bold> Coverage for this sample as a histogram of the depth of sequencing for the input mutations. This sample has a median coverage of 169×. <bold>c</bold> Mixing proportions obtained from MOBSTER’s clustering assignments; these represent the proportion of mutations assigned to each one of the fit clusters in the model’s mixture. <bold>d</bold> Scores for model selection used by MOBSTER; in this case the model is selected by using the ICL score with reduced entropy, termed reICL. Note that all other scores suggest the same optimum model (red point in the score plot). This means that the identified model is the optimum no matter what scoring system we use. <bold>e</bold> Entropy of the model’s latent variables; we report both the standard entropy (solid line), as well as the reduced entropy which is computed just between mutations assigned to Beta clusters. As expected the reduced entropy is bounded from above by the standard entropy. <bold>f</bold> Value of the latent variable per mutation (cluster assignment probability). Here we assign via hard clustering assignments all mutations regardless the latent variables value. This shows that more uncertainty is found for mutations that map to clusters C3, C2 and Tail as the mixture density functions have overlapping support</p></caption><graphic xlink:href="12859_2020_3863_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par40">The package implements a number of distinct scores for model-selection, but the model in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a is selected by using reICL. In this case all the scores available in the package rank the output model first, meaning that they consistently predict the model in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a to be the best possible fit for the input data (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d). The tool also offers visualization functions that can at least suggest, even from a single model fit, what is the stability of the clustering. This information is linked to model’s latent variables—denoted with <inline-formula id="IEq60"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{z}}$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mi mathvariant="bold-italic">z</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq60.gif"/></alternatives></inline-formula>, and represented as a <inline-formula id="IEq61"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n\times (k+1)$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq61.gif"/></alternatives></inline-formula> matrix—which provide the probability of each of the input <inline-formula id="IEq62"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M142"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq62.gif"/></alternatives></inline-formula> mutations to be assigned to the <inline-formula id="IEq63"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k+1$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq63.gif"/></alternatives></inline-formula> clusters (<inline-formula id="IEq64"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M146"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq64.gif"/></alternatives></inline-formula> Beta plus one tail). In Fig. <xref rid="Fig2" ref-type="fig">2</xref>e we plot the entropy profile associated to each one of the input values in the domain <inline-formula id="IEq65"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$[\mathrm{0,1}]$$\end{document}</tex-math><mml:math id="M148"><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq65.gif"/></alternatives></inline-formula>; this is computed from the relative density of each mixture component in the model, and shows, for both the standard and reduced entropies, higher values where there is more uncertainty in clustering assignments. The full set of latent variables can also be visualized (Fig. <xref rid="Fig2" ref-type="fig">2</xref>f) as a heatmap, in this case highlighting more uncertainty for the assignments of the two subclones and the tail. This is expected since the three components largely overlap with similar density values.</p>
      <p id="Par41">Model confidence and stability can be formalized using bootstrap procedures. In Fig. <xref rid="Fig3" ref-type="fig">3</xref> we show the result of a non-parametric bootstrap run with 200 resamples, which can be used to estimate bootstrap confidence intervals (CI) for all the model parameters at a desired <inline-formula id="IEq66"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M150"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq66.gif"/></alternatives></inline-formula>-level (default 5%), and the overall model confidence. Figure <xref rid="Fig3" ref-type="fig">3</xref>a shows the overall model confidence; the selected output model of Fig. <xref rid="Fig2" ref-type="fig">2</xref>a is selected in 65% of the non-parametric bootstrap resamples, and in the remaining 35% of the cases a model with only <inline-formula id="IEq67"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K=2$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq67.gif"/></alternatives></inline-formula> Beta components and one tail is selected. In those models the signal lost is the one from the smallest subclone, C3, as one can immediately expect from Fig. <xref rid="Fig2" ref-type="fig">2</xref> and the width of the Beta component C2 is increased to include SNVs originally assigned to C3. The 200 bootstrap resamples allow the estimation of a full distribution for the tail shape (CI [1.41–1.57]), as well as the Beta means and variance (means: C1 CI [0.51–0.52], C2 CI [0.24–0.29] and C3 CI [0.15–0.16], variance: C1 CI [0.001–0.002], C2 CI [0.001–0.008] and C3 CI [0.0005–0.0009]); the bootstrap distributions are plot in Fig. <xref rid="Fig3" ref-type="fig">3</xref>b, c. Notice that as expected the largest CIs are associated to C2, consistently to reflect the cases where cluster C3 is drop. The usage of a non-parametric bootstrap procedure allows also to estimate the co-clustering probability for each pair of mutations (Fig. <xref rid="Fig3" ref-type="fig">3</xref>f), which is bounded from above by the joint sampling probability for each pair of mutations (resampled with uniform probability in this bootstrap). This <inline-formula id="IEq68"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n\times n$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:mi>n</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq68.gif"/></alternatives></inline-formula> matrix shows that the clonal cluster (C1) is extremely stable (dark blue gradient), and that lower stability involves the two subclonal clusters (C3 and C2), confirming the other assessments. On the overall, these metrics suggest that the quality of the fit computed with mobster, as measured from robustness of the overall model fit and its parameters, is very high and confirms that the breast cancer sample PD4120a likely contains two on-going subclonal expansions.<fig id="Fig3"><label>Fig. 3</label><caption><p>Analysis of the model in Fig. <xref rid="Fig2" ref-type="fig">2</xref> using <inline-formula id="IEq73"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n=200$$\end{document}</tex-math><mml:math id="M156"><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>200</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq73.gif"/></alternatives></inline-formula> non-parametric bootstrap resamples. <bold>a</bold> Bootstrapped model frequency. The target model has <inline-formula id="IEq74"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K=3$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq74.gif"/></alternatives></inline-formula> Beta clusters, plus one tail. Across all the 200 resamples the target model is fit in 65% of the cases, and in the remaining 35% only two Beta components are used; in all cases the tail is always fit to data. <bold>b </bold>Bootstrapped distribution of the tail shape, with annotated point estimate (dashed line). <bold>c</bold> Bootstrapped distribution of the mean and variance of the Beta components, with annotated point estimate (dashed line). Note that cluster C2 can show bimodal distributions; this is due to the 35% bootstrapped cases in which C2 is the only subclonal cluster (i.e., C3 is dropped). Point estimates are annotated as dashed lines. <bold>d</bold> Co-clustering probability of each pair of points in the input data, visualized as a matrix ordered by the clustering assignments in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. This shows that clonal mutations are very stable (C1), and that mutations in cluster C3 in a small proportion of cases are assigned together with mutations in cluster C2. This is confirmed by the plot in panel (<bold>a</bold>) where the model with <inline-formula id="IEq75"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K=2$$\end{document}</tex-math><mml:math id="M160"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2020_3863_Article_IEq75.gif"/></alternatives></inline-formula> Beta clusters plus one tail are identified in 35% of the non-parametric bootstrap resamples</p></caption><graphic xlink:href="12859_2020_3863_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
  </sec>
  <sec id="Sec12">
    <title>Discussion</title>
    <p id="Par42">The mobster package implements the first statistical method that integrates Machine Learning and Population Genetics to perform tumour subclonal deconvolution from whole-genome DNA sequencing data of human cancers [<xref ref-type="bibr" rid="CR9">9</xref>]. The method improves largely over standard methods for tumour deconvolution, as largely shown in [<xref ref-type="bibr" rid="CR9">9</xref>], and is made accessible through the new R software package mobster which provides several functions for data pre-processing, visualization and analysis (model fitting, confidence assessment and post-clustering analysis). In this paper we described the principles underlying the R package and showed its analysis of one tumour simulated by a stochastic branching process model of tumour growth, and one polyclonal breast cancer sample. In the future we will extend the current package to support input/output with other common tools for cancer evolutionary analyses, such as callers for somatic mutations and copy number detection, and population-level inferences of patterns of tumour evolution from data of multiple patients.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec13">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2020_3863_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary notes that describe the software and its applications.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>WGS</term>
        <def>
          <p id="Par4">Whole-genome sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>VAF</term>
        <def>
          <p id="Par5">Variant Allele Frequency</p>
        </def>
      </def-item>
      <def-item>
        <term>CCF</term>
        <def>
          <p id="Par6">Cancer Cell Fraction</p>
        </def>
      </def-item>
      <def-item>
        <term>SNV</term>
        <def>
          <p id="Par7">Single-nucleotide variant</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn id="Fn1">
      <label>1</label>
      <p id="Par54">
        <ext-link ext-link-type="uri" xlink:href="https://t-heide.github.io/TEMULATOR/">https://t-heide.github.io/TEMULATOR/</ext-link>
      </p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-03863-1.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>GC wishes to thank Timon Heide, Marc J Williams and Luca De Sano for helping to develop the mobster package.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>GC and AS conceived the study, and GC implemented the software. GC, GS, TAG and AS carried out the analysis of real data, and interpreted the results. All authors drafted the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>AS is supported by the Wellcome Trust (202778/B/16/Z) and Cancer Research UK (A22909). TAG is supported by the Wellcome Trust (202778/Z/16/Z) and Cancer Research UK (A19771). We acknowledge funding from the Medical Research Council (MR/P000789/1) to A.S. and from the National Institute of Health (NCI U54 CA217376) to AS and TAG. This work was also supported by a Wellcome Trust award to the Centre for Evolution and Cancer (105104/Z/14/Z). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The tool and data shown in this paper are available at the GitHub website hosting the mobster package: <ext-link ext-link-type="uri" xlink:href="https://caravagnalab.github.io/mobster/">https://caravagnalab.github.io/mobster/</ext-link>.</p>
    <sec id="FPar3">
      <title>Availability and requirements</title>
      <p id="Par43">Project name: mobster.</p>
      <p id="Par44">Project home page: <ext-link ext-link-type="uri" xlink:href="https://caravagnalab.github.io/mobster/">https://caravagnalab.github.io/mobster/</ext-link>.</p>
      <p id="Par45">Operating system(s): Platform independent.</p>
      <p id="Par46">Programming language: R (version &gt;= 3.6.0; with releases for both ~ 3.6 and &gt; 4.0).</p>
      <p id="Par47">Other requirements: open R packages (<italic>ggplot2, sads, cli, clisymbols, cowplot, crayon, ctree, dndscv, dplyr, magrittr, reshape2, tidyr</italic>) that are automatically installed by the tool.</p>
      <p id="Par48">License: GNU GPL 3.</p>
      <p id="Par49">Any restrictions to use by non-academics: none.</p>
    </sec>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par50">Does not apply since we use public data.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par51">Does not apply.</p>
  </notes>
  <notes id="FPar4" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par52">All the authors declare no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References
</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jamal-Hanjani</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tracking the evolution of non-small-cell lung cancer</article-title>
        <source>NEJM</source>
        <year>2017</year>
        <volume>376</volume>
        <issue>22</issue>
        <fpage>2109</fpage>
        <lpage>2121</lpage>
        <pub-id pub-id-type="doi">10.1056/NEJMoa1616288</pub-id>
        <pub-id pub-id-type="pmid">28445112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spiteri</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Evolutionary dynamics of residual disease in human glioblastoma</article-title>
        <source>Ann Oncol</source>
        <year>2019</year>
        <volume>30</volume>
        <issue>3</issue>
        <fpage>456</fpage>
        <lpage>463</lpage>
        <pub-id pub-id-type="doi">10.1093/annonc/mdy506</pub-id>
        <pub-id pub-id-type="pmid">30452544</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caravagna</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Algorithmic methods to infer the evolutionary trajectories in cancer progression</article-title>
        <source>PNAS</source>
        <year>2016</year>
        <volume>113</volume>
        <issue>28</issue>
        <fpage>E4025-E403415.9</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1520213113</pub-id>
        <pub-id pub-id-type="pmid">27357673</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caravagna</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Detecting repeated cancer evolution from multi-region tumor sequencing data</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>9</issue>
        <fpage>707</fpage>
        <lpage>714</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-018-0108-x</pub-id>
        <pub-id pub-id-type="pmid">30171232</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turajlic</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deterministic evolutionary trajectories influence primary tumor growth: TRACERx renal</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>173</volume>
        <issue>3</issue>
        <fpage>595</fpage>
        <lpage>610</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.03.043</pub-id>
        <pub-id pub-id-type="pmid">29656894</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turajlic</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Tracking cancer evolution reveals constrained routes to metastases: TRACERx renal</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>173</volume>
        <issue>3</issue>
        <fpage>581</fpage>
        <lpage>594</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.03.057</pub-id>
        <pub-id pub-id-type="pmid">29656895</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nik-Zainal</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The life history of 21 breast cancers</article-title>
        <source>Cell</source>
        <year>2012</year>
        <volume>149</volume>
        <issue>5</issue>
        <fpage>994</fpage>
        <lpage>1007</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2012.04.023</pub-id>
        <pub-id pub-id-type="pmid">22608083</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Turajlic</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Resolving genetic heterogeneity in cancer</article-title>
        <source>Nat Rev Genet</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>7</issue>
        <fpage>404</fpage>
        <lpage>416</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-019-0114-6</pub-id>
        <pub-id pub-id-type="pmid">30918367</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Caravagna</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Subclonal reconstruction of tumors by using machine learning and population genetics</article-title>
        <source>Nat Genet.</source>
        <year>2020</year>
        <volume>52</volume>
        <fpage>898</fpage>
        <lpage>907</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-020-0675-5</pub-id>
        <pub-id pub-id-type="pmid">32879509</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sottoriva</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A Big Bang model of human colorectal tumor growth</article-title>
        <source>Nat Genet</source>
        <year>2015</year>
        <volume>47</volume>
        <issue>3</issue>
        <fpage>209</fpage>
        <pub-id pub-id-type="doi">10.1038/ng.3214</pub-id>
        <pub-id pub-id-type="pmid">25665006</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Identification of neutral tumor evolution across cancer types</article-title>
        <source>Nat Genet</source>
        <year>2016</year>
        <volume>48</volume>
        <issue>3</issue>
        <fpage>238</fpage>
        <pub-id pub-id-type="doi">10.1038/ng.3489</pub-id>
        <pub-id pub-id-type="pmid">26780609</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Williams</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Quantification of subclonal selection in cancer from bulk sequencing data</article-title>
        <source>Nat Genet</source>
        <year>2018</year>
        <volume>50</volume>
        <issue>6</issue>
        <fpage>895</fpage>
        <lpage>903</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0128-6</pub-id>
        <pub-id pub-id-type="pmid">29808029</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kessler</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Large population solution of the stochastic Luria-Delbrück evolution model</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2013</year>
        <volume>110</volume>
        <issue>29</issue>
        <fpage>11682</fpage>
        <lpage>11687</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1309667110</pub-id>
        <pub-id pub-id-type="pmid">23818583</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Efron B. The jackknife, the bootstrap and other resampling plans. In: CBMS-NSF regional conference series in applied mathematics; SIAM, 1982. ISBN 978-0-89871-179-0, p. xi + 85.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Martincorena</surname>
            <given-names>I</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Universal patterns of selection in cancer and somatic tissues</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <issue>5</issue>
        <fpage>1029</fpage>
        <lpage>1041</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.09.042</pub-id>
        <pub-id pub-id-type="pmid">29056346</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
