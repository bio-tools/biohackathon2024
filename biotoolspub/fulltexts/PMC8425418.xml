<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Brief Bioinform</journal-id>
    <journal-id journal-id-type="iso-abbrev">Brief Bioinform</journal-id>
    <journal-id journal-id-type="publisher-id">bib</journal-id>
    <journal-title-group>
      <journal-title>Briefings in Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1467-5463</issn>
    <issn pub-type="epub">1477-4054</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8425418</article-id>
    <article-id pub-id-type="pmid">34370020</article-id>
    <article-id pub-id-type="doi">10.1093/bib/bbab124</article-id>
    <article-id pub-id-type="publisher-id">bbab124</article-id>
    <article-categories>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
      <subj-group subj-group-type="heading">
        <subject>Problem Solving Protocol</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TIPS: trajectory inference of pathway significance through pseudotime comparison for functional assessment of single-cell RNAseq data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zheng</surname>
          <given-names>Zihan</given-names>
        </name>
        <aff><institution>Biowavelet Ltd.</institution>, Chongqing, <country country="CN">China</country></aff>
        <aff><institution>Chongqing International Institute for Immunology</institution>, Chongqing, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Qiu</surname>
          <given-names>Xin</given-names>
        </name>
        <aff><institution>R&amp;D Department, TCRCure Ltd.</institution>, Chongqing, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Haiyang</given-names>
        </name>
        <aff><institution>R&amp;D Department, TCRCure Ltd.</institution>, Chongqing, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chang</surname>
          <given-names>Ling</given-names>
        </name>
        <aff><institution>Department of Immunology, Army Medical University</institution>, Chongqing, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tang</surname>
          <given-names>Xiangyu</given-names>
        </name>
        <aff><institution>Biomedical Analysis Center, Army Medical University</institution>, Chongqing, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zou</surname>
          <given-names>Liyun</given-names>
        </name>
        <aff><institution>Department of Immunology, Army Medical University</institution>, Chongqing, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Jingyi</given-names>
        </name>
        <aff><institution>Chongqing International Institute for Immunology</institution>, Chongqing, <country country="CN">China</country></aff>
        <aff><institution>Department of Rheumatology and Immunology, First Affiliated Hospital of Army Medical University</institution>, Chongqing, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Yuzhang</given-names>
        </name>
        <aff><institution>Department of Immunology, Army Medical University</institution>, Chongqing, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhou</surname>
          <given-names>Jianzhi</given-names>
        </name>
        <aff><institution>Biowavelet Ltd.</institution>, Chongqing, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jiang</surname>
          <given-names>Shan</given-names>
        </name>
        <!--shan.jiang1975@szu.edu.cn-->
        <xref rid="cor1" ref-type="corresp"/>
        <aff><institution>Institute for Advanced Study, Shenzhen University</institution>, Shenzhen, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wan</surname>
          <given-names>Ying</given-names>
        </name>
        <xref rid="cor1" ref-type="corresp"/>
        <!--wanying516@foxmail.com-->
        <aff><institution>Biomedical Analysis Center, Army Medical University</institution>, Chongqing, <country country="CN">China</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ni</surname>
          <given-names>Qingshan</given-names>
        </name>
        <xref rid="cor1" ref-type="corresp"/>
        <!--qingshanni@foxmail.com-->
        <aff><institution>Biomedical Analysis Center, Army Medical University</institution>, Chongqing, <country country="CN">China</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1">Corresponding authors: Shan Jiang, Institute for Advanced Study, Shenzhen University, Shenzhen, China. E-mail: <email>shan.jiang1975@szu.edu.cn</email>; Ying Wan; Qingshan Ni, Biomedical Analysis Center, Army Medical University, Chongqing, China. E-mail: <email>wanying516@foxmail.com</email>; <email>qingshanni@foxmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-04-29">
      <day>29</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>4</month>
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <issue>5</issue>
    <elocation-id>bbab124</elocation-id>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>13</day>
        <month>3</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>3</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bbab124.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Recent advances in bioinformatics analyses have led to the development of novel tools enabling the capture and trajectory mapping of single-cell RNA sequencing (scRNAseq) data. However, there is a lack of methods to assess the contributions of biological pathways and transcription factors to an overall developmental trajectory mapped from scRNAseq data. In this manuscript, we present a simplified approach for trajectory inference of pathway significance (TIPS) that leverages existing knowledgebases of functional pathways and other gene lists to provide further mechanistic insights into a biological process. TIPS identifies key pathways which contribute to a process of interest, as well as the individual genes that best reflect these changes. TIPS also provides insight into the relative timing of pathway changes, as well as a suite of visualizations to enable simplified data interpretation of scRNAseq libraries generated using a wide range of techniques. The TIPS package can be run through either a web server or downloaded as a user-friendly GUI run in R, and may serve as a useful tool to help biologists perform deeper functional analyses and visualization of their single-cell data.</p>
    </abstract>
    <kwd-group>
      <kwd>trajectory mapping</kwd>
      <kwd>pseudotime</kwd>
      <kwd>TIPS</kwd>
      <kwd>pathway analysis</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Natural Science Foundation of Shanghai</institution>
            <institution-id institution-id-type="DOI">10.13039/100007219</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>JCYJ20190808150009605</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>National Key Project of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2016YFA0502201</award-id>
        <award-id>2017YFA0700404</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="11"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Introduction</title>
    <p>Recent advances in single cell RNAseq (scRNAseq) library construction technologies, coupled with decreases in cost of high-throughput sequencing, have led to a proliferation of new single cell transcriptome data across a range of species and developmental/disease contexts. In order to interpret this data, a slew of new bioinformatics tools and analysis techniques have been developed. These include network-based methods to infer <italic toggle="yes">cis</italic>-regulatory interactions, splicing-informed mapping of RNA-velocity and inferences on key intercellular interactions based on receptor-ligand pairs [<xref rid="ref1" ref-type="bibr">1–3</xref>]. These and other novel tools have helped to unlock the potential of scRNAseq to provide a plethora of information that was previously inaccessible to analysis of bulk sequencing-based datasets.</p>
    <p>However, one area in which currently available single-cell analysis tools are lacking in is in pathway analysis. While pathways analysis and similar gene-set-based enrichment analyses are among the most common ways to infer molecular mechanisms contributing to altered behavior under different conditions, directly applying bulk-sequencing inspired pathway analysis methods to scRNAseq data comes with substantial difficulties. Unlike bulk sequencing profiles, scRNAseq transcriptome tend to have significant dropout, with technical variation causing false-zero detection of any given gene in a cell [<xref rid="ref4" ref-type="bibr">4</xref>, <xref rid="ref5" ref-type="bibr">5</xref>]. Chance-driven technical dropout also tends to be particularly severe for genes with low- to medium-expression magnitudes, many of which are key components of biological pathways. Because of this, some approaches (such as Metacell) have been developed to enable gene set enrichment analyses across clusters of cells using composite/imputed profiles [<xref rid="ref6" ref-type="bibr">6</xref>]. However, such an approach sacrifices the single-cell resolution offered by scRNAseq by using it to approximate bulk sequencing results. Furthermore, this emphasis on pairwise differential regulation is less suitable for single cell datasets that encompass multiple cellular states and functional clusters. Other tools, such as AUCell and GSVA, preserve single-cell resolution to generate scored profiles for each cell for a given pathway but are focused on describing these pathways in terms of absolute expression level [<xref rid="ref7" ref-type="bibr">7</xref>, <xref rid="ref8" ref-type="bibr">8</xref>]. However, not all pathway changes can be accurately reflected as absolute increases in expression level; many curated pathways will also contain genes with weak changes or decreases in expression as part of known regulatory behavior. In addition, these approaches cannot provide information on the temporal order by which pathways (and the genes represented within) may change during a larger biological process.</p>
    <p>In order to implement pathway analysis at single-cell resolution, we present here a novel analytical framework that provides trajectory inference of pathway significance (TIPS). Our approach leverages the trajectory mapping principle of pseudotime assignment to build pathway-specific trajectories from a pool of single cells. The pseudotime values for each cell along these pathway-specific trajectories are then compared to identify the processes with highest similarity to an overall trajectory in a simple and intuitive process. This approach differs from existing pathway analysis methodologies by evaluating expression dynamics of individual genes, instead of taking an averaged measure of gross expression. Consequently, this approach allows for straightforward comparisons of the relative influence of each pathway, as well as the timing of pathway changes. Furthermore, key genes that are associated with both the overall trajectory and/or pathway-specific trajectories are also identified, providing ready targets for downstream validation work. Direct visualizations are also offered at each of the primary steps, with customizable options for figure generation for pathways and genes of interest. The key modules in TIPS incorporate in a number of leading scRNAseq analysis tools and can be run sequentially within a shiny GUI in R with the source code available on GitHub (https://github.com/qingshanni/TIPS) or on a dedicated webserver (<ext-link xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="http://118.24.236.198:3838/TIPS/" ext-link-type="uri">http://118.24.236.198:3838/TIPS/</ext-link>). We hope that the TIPS workflow may help further expand the range of functional analyses that are possible when working with scRNAseq data, and help derive new functional insights into complex biological processes.</p>
  </sec>
  <sec id="sec2">
    <title>Materials and Methods</title>
    <sec id="sec3">
      <title>Overview of the TIPS framework</title>
      <p>The TIPS framework is designed as 7 primary modules (described in detail below) intended to be run sequentially in R as either a local shiny-based GUI or as online as a webserver. Each module will automatically generate and format the analysis results as necessary to permit further analyses without a need for manual modification. A schematic overview of these modules is included as <xref rid="f1" ref-type="fig">Figure 1</xref>, and a video walkthrough of the operation of the shiny-based GUI using demo data is included as <xref rid="sup1" ref-type="supplementary-material">Supplementary Video S1</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/.</p>
      <fig position="float" id="f1">
        <label>
Figure 1
</label>
        <caption>
          <p>Overview of TIPS workflow. The TIPS workflow as presented here and as implemented in our GUI and shiny app requires the input of only a gene expression file and the selection of a reference database for consideration, with an optional option for helping visualize associated metadata. These data are then loaded to create a Seurat object. Three modes of dimension reduction are then run (PCA, tSNE and UMAP) to generate 2D visualizations of transcriptional similarity between cells using HVGs. A trajectory is constructed using DDRTree in monocle (run in successive order in our app). Users may then select parameters regarding gene size and expression to filter for pathways of interest, and additional trajectories are then constructed based on individual pathway gene sets. The statistical significance of each pathway is computed based on signal relative to background noise from 1000 randomly selected gene lists of the same size. Users may then further select specific pathways of interest for further analysis. These analyses include temporal ordering of different pathways, as well as selection of the critical genes from each pathway for downstream validation. All visualizations can be exported as publication-ready PDFs or tiffs with selectable scaling. The Seurat and monocle objects are stored in a directory to allow for further manipulation by the user if necessary. Full tables of pathways and genes within displaying significant association are also provided as text files.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bbab124f1" position="float"/>
      </fig>
    </sec>
    <sec id="sec4">
      <title>Uploading data</title>
      <p>TIPS takes as its primary data input a standard gene expression matrix, wherein each row corresponds to a gene and each column a cell, from a comma-delimited (.csv) file. Ideally, this matrix should be pre-processed beforehand to only include in the cells that are of sufficient quality and which are pertinent to the intended trajectory analysis. Since preprocessed data may have been pre-normalized, an option is available to either log-normalize raw data or to accept it as is. TIPS also accepts metadata information for each cell (regarding sample quality, origin, type, etc.), from an additional (.csv) file for further visualizations. The user may then choose a list of gene sets to consider from a dropdown menu (six are built-in, including Reactome, KEGG, BioCarta, Msigdb) or otherwise upload an additional (.gmt) file containing the gene lists they wish to analyze [<xref rid="ref9" ref-type="bibr">9–11</xref>]. This allowance for built-in options allows for customized analysis of data derived from other organisms or knowledgebases.</p>
    </sec>
    <sec id="sec5">
      <title>Dimension reduction</title>
      <p>TIPS automatically loads and manages the data input as a Seurat object and runs three different dimension reduction algorithms (PCA, tSNE and UMAP) to generate 2D visualizations of the transcriptome similarity between cells [<xref rid="ref12" ref-type="bibr">12</xref>, <xref rid="ref13" ref-type="bibr">13</xref>]. Users may select cutoff parameters for selecting the list of highly variable genes (HVGs) to consider for these reductions (both expression and dispersion cutoffs), and number of nearest neighbors, in order to optimize the analysis to suit their dataset. The results from the reduction can be visualized directly, with metadata information as selectable overlays, while a Louvain clustering algorithm is run at common resolutions to provide a range of clustering results.</p>
    </sec>
    <sec id="sec6">
      <title>Primary trajectory analysis</title>
      <p>As a matter of principle, the TIPS framework can next be applied directly to generate a primary trajectory that includes all cells. However, we strongly recommend that users perform any data subsetting or sample filtering steps before the trajectory analysis step to ensure that the analysis can return meaningful results in practice. In particular, we suggest that users only select cell types/clusters which have direct temporal relations and/or transitional potential for downstream analysis in TIPS. This is because inclusion of irrelevant cell types will significantly increase the calculation runtime at the expense of computational accuracy. Inclusion of extraneous clusters introduces noise to the analysis, which can lead to false positive inferences for pathways that are not related to the primary trajectory of interest, while also sacrificing the resolution of pathways with actual trajectory correlation. As such, users of the TIPS GUI are given the option to select clusters of interest identified by the preceding dimension reduction visualization, with access to the heatmap visualization of the top markers for each cluster.</p>
      <p>After selecting the clusters of interest, the HVGs that define these clusters are then calculated, to ensure representational accuracy. These HVGs are then passed to Monocle for DDRTree-based mapping and pseudotime assignment to generate the primary dataset trajectory [<xref rid="ref14" ref-type="bibr">14</xref>]. Since the actual assignment direction for pseudotime values can be arbitrary, an option to reverse the initial order of cells is provided, such that users may select an order more intuitive for their question of interest in terms of expected temporal relations between clusters. This assignment is then treated as the reference pseudotime trajectory for downstream analysis.</p>
    </sec>
    <sec id="sec7">
      <title>Pathway inference</title>
      <p>In order to identify the pathways that are functionally associated with the overall trajectory of interest, we first load into the TIPS pipeline the selected reference knowledgebase of pathways for consideration. We then tailor these reference pathways to the dataset of interest to remove genes with missing expression and prune out overly small pathways based on absolute size (&lt;20 genes). TIPS then iteratively runs the DDRTree algorithm to generate one trajectory per pathway of interest, considering all of the expressed genes from the pathway (including ones where the genes display non-significant variation in expression) to give a complete picture of pathway dynamics. This process reduces each pathway to a single linear vector of pseudotime values. These pseudotime vectors are then compared with the reference pseudotime trajectory using absolute Pearson’s correlation to assess relative similarity in terms. Notably, absolute comparisons are used for these measures to avoid potentially misleading inferences about the direction of trajectory values. In order to assess the pathways with true significance, DDRTree is also iterated on randomly generated pathway lists to establish a false discovery rate (FDR) for genes sets of a given size. Pathways at correlation levels below 5% FDR and which have significant correlation in terms of absolute gene expression (&gt;0.6) are considered to be significantly associated with the overall trajectory.</p>
    </sec>
    <sec id="sec8">
      <title>Pathway temporal alignment</title>
      <p>Individual significantly associated pathways may have distinct modes of behavior over the course of the pseudotime trajectory, with some showing rapid changes early on, while others are late-breaking. In order to provide a temporal understanding of these pathway dynamics, we further utilized the switchde package in R to help identify genes with switch-like expression characteristics [<xref rid="ref15" ref-type="bibr">15</xref>]. We can then visualize the distribution of switch points with respect to pseudotime for each individual pathway and subsequently compare these distributions to generate a temporal alignment.</p>
    </sec>
    <sec id="sec9">
      <title>SOM-based pathway selection</title>
      <p>Although the absolute order of pseudotime values may be arbitrarily assigned and is not dependent upon a unidirectional change in expression within a given gene list, researchers may be interested in focusing on investigating processes that do show continual increases or decreases expression over time. In order to accommodate this need, we implemented self-organizing maps (SOMs) to cluster the cells using the kohonen package in R [<xref rid="ref16" ref-type="bibr">16</xref>]. Users can select their pathways of interest from a dropdown menu to assess the direction while also choosing the number of nodes for the SOM that would best fit their interest. Pathways that display monotonic changes in behavior can thus be visualized in this manner. The SOM can also be used to help visually distinguish pathways with more complex expression kinetics.</p>
    </sec>
    <sec id="sec10">
      <title>Individual gene selection</title>
      <p>Although the approach outlined above is sufficient for identifying pathways that meaningfully contribute to an overall trajectory, it is oftentimes necessary to further clarify the exact genes that drive such a contribution. To address this question, we included three distinct methods for identifying critical genes within a pathway. First, we consider the genes with switch-like behavior recovered from switchde, as the singular and abrupt change in expression within these genes make them good candidates for functional screening and validation. Second, since other critical genes may display milder and monotonic changes in expression, we also compute the Pearson correlation between gene expression and pseudotime progression to help identify genes not found by switchde. Finally, since still other factors may display more complex changes in expression dynamics (alternating increases and decreases, or the like), we further weigh the relative contribution of a given gene on the pseudotime correlation of its parent pathway. Through these three distinct approaches contained in our final module, we can subsequently narrow down the range of candidate genes to consider for further validation work.</p>
    </sec>
    <sec id="sec11">
      <title>Analyzed datasets</title>
      <p>For our initial analysis of a simulated dataset, we used the splatter package in R with default settings to generate a dataset of 500 cells with 5000 expressed genes per cell via the simulating paths option [<xref rid="ref17" ref-type="bibr">17</xref>]. To enable analysis of the impact of technical dropout, we further used the dropout function in splatter to add in zero-inflation up through a range of median expression values. To clarify that these conclusions were also applicable to larger and more complex datasets, we further simulated datasets with 1, 2 and 3 distinct paths and larger numbers of cells, as well as a dense dataset of 5000 cells and a pool of 15 000 genes.</p>
    </sec>
    <sec id="sec12">
      <title>scRNAseq library construction and sequencing</title>
      <p>In order to provide a direct demonstration of the use of the TIPS framework on real scRNAseq data, we isolated peripheral blood mononuclear cells from whole blood provided by a healthy donor under approval of the Ethics Committee of Southwest Hospital as part of a pilot study. CD8+ T cells were acquired and FACS-sorted (Beckmann Coulter) into a 96-well plate following staining with antibodies against CD3, CD4 and CD8 (BD). Cells were then lysed, and libraries were prepared using the scSTATseq workflow that we have previously developed [<xref rid="ref18" ref-type="bibr">18</xref>]. Libraries were sequenced using the HiSeq 4500 platform (Illumina) and preprocessed as previously described. Alignment-free counting of reads relative to the reference human transcriptome was performed using Salmon [<xref rid="ref19" ref-type="bibr">19</xref>]. The resulting gene expression matrix was then read into the Seurat package in R, where quality control filtering was performed to remove cells with excess mitochondrial reads (&gt;10% of all reads), as well as outliers in terms of number of genes recovered (&lt;5000 or &gt;15 000). The remaining 69 libraries were then passed to the TIPS framework for further analysis and visualization.</p>
    </sec>
    <sec id="sec13">
      <title>Additional comparison datasets</title>
      <p>Additional data from scRNAseq libraries constructed using alternative methods were obtained from GSE133535, a benchmarking study of different library construction protocols [<xref rid="ref20" ref-type="bibr">20</xref>]. Since a mix of cells were used in the study, we individually downloaded each of the data matrices corresponding to a single method and filtered them based on metadata annotation to only retain human cells. Data on these cells were then loaded into Seurat for UMAP-based clustering in order to identify clusters of CD8+ T cells (based on positive expression of CD8, CD3D and lack of expression of CD4 and NCAM1). Transcriptome information from these CD8+ T cells was then passed to TIPS for additional analysis.</p>
      <p>For analysis of single CD8+ T cells from HCC patients, fully processed sparse matrix files were obtained from GSE98683, and annotated CD8+ populations were used for further analysis through TIPS [<xref rid="ref21" ref-type="bibr">21</xref>]. Data for the HCC samples treated with immune checkpoint blockade (ICB) were similarly processed from GSE125449 [<xref rid="ref22" ref-type="bibr">22</xref>]. For our analysis of endocrine cells from the pancreatic islets of patients with type II diabetes, data were obtained from GSE86469 [<xref rid="ref23" ref-type="bibr">23</xref>]. A summary of the gene expression characteristics of these datasets is included as <xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S11</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/.</p>
    </sec>
  </sec>
  <sec id="sec14">
    <title>Results</title>
    <sec id="sec15">
      <title>Testing of the TIPS workflow using simulated data</title>
      <p>In order to assess the robustness of the analysis workflow described, we first simulated a medium-sized scRNAseq dataset of 5000 genes and 500 cells ordered along a single path. We then compared the performance of different correlation metrics for comparing pathways to a common trajectory using 1000 randomly selected gene lists and 100 HVG lists. Since the baseline pseudotime trajectory was generated based on a complete list of HVGs, we anticipated that subsets of the HVG list would show true signal, while the completely random lists would reflect the range of noise. Interestingly, we observed that the HVG lists were essentially indistinguishable from random background when mean pathway gene expression level was considered (<xref rid="f7" ref-type="fig">Figure 2A</xref>). However, pseudotime-to-pseudotime correlations showed a clear separation between HVG lists and background (<xref rid="f7" ref-type="fig">Figure 2B</xref>). This phenomenon suggested that the TIPS workflow will highlight pathways as being highly significant regardless of average expression (<xref rid="f7" ref-type="fig">Figure 2C</xref>). Furthermore, this pattern held when datasets of larger size and containing multiple independent paths were considered, suggesting that it is highly robust (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S1</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/). Instead, we observed that the constituent genes from the highly correlated lists displayed balanced distribution, with a similar number of genes having increasing or decreasing expression (and changes of similar magnitude) over the course of the pseudotime trajectory (<xref rid="f7" ref-type="fig">Figure 2D</xref>). This trend could also be clearly identified in terms of specific genes from a single pathway (<xref rid="f7" ref-type="fig">Figure 2E</xref>). At the same time, we also observed a clear pattern wherein the addition of additional information from more HVGs led to higher correlation with the overall pseudotime (<xref rid="f7" ref-type="fig">Figure 2F</xref>). As such, these results suggest that pseudotime correlation provides a sensitive method for comparing trajectories, by accounting for genes with both increasing and decreasing expression.</p>
      <fig position="float" id="f7">
        <label>
Figure 2
</label>
        <caption>
          <p>Parameter testing using simulated data for parameter testing, we used a simulated dataset of 500 cells and 5000 genes per cell, comparable in information amount to most real single-cell datasets. We then generated 1000 lists of 100 genes each for background measurement and 100 lists of 100 genes each from the subset of HVGs (527 total) as our signal of interest. (A) Average gene expression is commonly used as a metric for identifying significantly associated pathways in bulk analyses. (B) When the lists were instead run through DDRTree to generate individual pseudotime vectors, pseudotime vectors derived from HVG lists showed very high levels of correlation, while few random lists showed significance. <italic toggle="yes">P</italic>-values shown in A and B are for the Pearson correlation statistic. (C) Dotplot of pseudotime correlation versus expression correlation demonstrates that the majority of HVG lists that showed high levels of pseudotime correlation had very little correlation in terms of expression (<italic toggle="yes">R</italic> &lt; 0.2). (D) Dotplot of the expression profiles of all HVGs of the simulated dataset derived from switchde. mu0 indicates the half-peak expression of a gene prior to the switch event, while <italic toggle="yes">k</italic> indicates the magnitude of the switch event, and <italic toggle="yes">t</italic>0 the timepoint along the trajectory at which the switch event takes place. (E) Taking one significantly associated HVG list as an example, we can observe that a given pathway may also include individual genes with increasing and decreasing expression. (F) By increasing or decreasing the size of the gene list considered, we can observe that the magnitude of the pseudotime correlation is highly sensitive to the size and amount of information considered. These results confirm that the method is sufficiently sensitive. (G) Real scRNAseq datasets can vary greatly in the numbers of cells sequenced. By subsetting the simulated set, we sought to measure the influence of changes in dataset size. Interestingly, while the smaller sets did display reduced correlation between the new pseudotime assignments for the cells subsetted and their original pseudotime values, most subsets retained a representative capability with <italic toggle="yes">R</italic> &gt; 0.9 at 50 cells. (H) Real scRNAseq may also display zero-inflation as a result of technical dropout or transcriptional burst. By artificially adding in zero-inflation to splatter, we observed that an increase in dropout could drive a sharp decrease in pseudotime correlation. Indeed, past a certain threshold, trajectory analysis would be essentially meaningless. (I) Real scRNAseq datasets may also measure and consider gene sets of different sizes. By changing the size of a randomly selected gene set, we also observed significant changes in the distribution of pseudotime correlation values; larger datasets naturally tended to have higher noise.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bbab124f2" position="float"/>
      </fig>
      <p>At the same time, we also assessed the potential influence of other factors on the accuracy of pseudotime mapping to clarify its range of applicability. Since scRNAseq libraries may vary greatly in terms of number of cells recovered, genes recovered and in sequencing quality, we controlled for each of these factors in turn. Interestingly, pseudotime mapping using subsampled cells demonstrated that decreasing the size of the dataset did not have a strong of an effect on correlation accuracy, such that a correlation above 0.9 could be maintained even when the dataset was downsampled to 10% of its original size (<xref rid="f7" ref-type="fig">Figure 2G</xref>). This trend held when we repeated this analysis in a much larger dataset of 5000 cells and 15 000 genes (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S2</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/). This result suggests that sequencing a smaller number of representative cells may be sufficient to map a trajectory. Since real scRNAseq data often face practical limitations regarding the numbers of cells recovered from a population of interest and can include multiple paths, these results show that the accuracy trajectory mapping will not be constrained by these limitations.</p>
      <p>However, the gene detection quality of the cells sequenced had a substantial impact on accuracy, as increasing the degree of technical dropout in the data led to a clear deterioration in the correlation (<xref rid="f7" ref-type="fig">Figure 2H</xref>). This deterioration demonstrates that pseudotime assignment is sensitive to information loss. In a similar vein, we observed that the number of genes considered for pseudotime assignment also had significant influence on its accuracy; larger sets of randomly selected genes tended to have significantly higher background noise than their smaller counterparts (<xref rid="f7" ref-type="fig">Figure 2I</xref>). Since a given dataset may only feature significant expression in a subset of all genes assigned to a given pathway, the relative size and representation rate of a pathway may also influence correlation interpretation. As such, we elected to run independent calculations of background noise using random lists for each pathway in order to control for differences in gene list size and representation. These latter two limitations are important caveats to consider for trajectory analysis as a whole and are not unique to using the TIPS framework. However, since TIPS relies on iterating the trajectory mapping process, TIPS is unlikely to infer many significant pathways from datasets with relatively poor quality in these two metrics.</p>
    </sec>
    <sec id="sec16">
      <title>TIPS confirms existing knowledge of CD8+ T cell differentiation</title>
      <p>To validate the utility and biological relevance of our workflow, we then analyzed 69 single-cell libraries of peripheral blood CD8+ T cells from a healthy donor using the scSTATseq method. UMAP clustering of the cells readily identified two prominent clusters of cells of similar size (<xref rid="f7" ref-type="fig">Figure 2A</xref>), and marker analysis demonstrated that cluster0 was composed of antigen-experienced effector cells positive for the effector molecules IFNG and GZMB, while cluster1 included naïve/memory cells that displayed high levels of CCR7 and S1PR1 (<xref rid="f7" ref-type="fig">Figure 2B</xref>). Pseudotime trajectory mapping based on the dispersed genes yielded a relatively simple arc, with the effector cells being assigned higher pseudotime values along this reference trajectory (<xref rid="f7" ref-type="fig">Figure 2C</xref>). We then generated iterated trajectory mappings using the curated hallmark signatures from three separate knowledgebases (Msigdb, KEGG, Reactome) and performed paired correlation analysis of the pseudotime values against the reference trajectory to identify pathways with close association and significant signal over noise based on gene set size (<xref rid="f7" ref-type="fig">Figure 2D</xref>). Consistent with our expectations, a relatively small portion of pathways showed significance, alleviating concerns about overfitting from our method (Supplementary Table S1, see Supplementary Data available online at http://bib.oxfordjournals.org/). Of note, no correlation was found between the number or percentage of HVGs in a given pathway and its inferred significance (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S3A and B</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/), demonstrating that the results obtainable from this approach are distinct from enrichment of the HVGs list. Instead, we observe that even pathways without an HVG can still be inferred to be functionally important, as a result of weaker, but consistent, changes in expression across large numbers of genes, while some lists containing large numbers of HVGs may still have insignificant contribution (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S3C and D</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/).</p>
      <p>From direct inspection of the top pathways displaying significant association via TIPS analysis, we found a number of well-characterized processes known to influence CD8 behavior, such as chemokine signaling and IL12 family signaling (<xref rid="f7" ref-type="fig">Figure 2E</xref>). At the same time, we also observed significance in less appreciated processes such as the Myd88-mediated, TLR-cascaded and SLC-mediated transmembrane transport. Overall temporal alignment of these four pathways of interest based on the order of their switched-on genes demonstrated that each of these pathways had factors that changed across multiple points of the overall pseudotime trajectory, although most of the changes were centered at an intermediate timepoint marking a changeover from memory to effector status (<xref rid="f7" ref-type="fig">Figure 2F</xref>). When we focused in on each pathway, we could observe that these changes included relatively critical constituents, such as the signaling kinase IRAK1 in the Myd88-mediated cascade. Many of these molecules have also previously been demonstrated to be of functional importance in the context of T cell immunity, such as the co-stimulatory molecule ICOS, the large neutral amino acid transporter SLC7A5 and the chemokine receptor CXCR1 [<xref rid="ref24" ref-type="bibr">24–26</xref>]. We also recovered several interesting molecules not characterized in this context, such as the iron exporter ferroportin (SLC40A1) and zinc importer SLC39A2. Taken together, these results demonstrate that the TIPS workflow can successfully recapitulate existing knowledge of a biological context while also yielding novel candidates for further validation.</p>
      <p>In order to put these pathway inferences relating to CD8+ T cells in context, we also further analyzed three additional scRNAseq datasets of CD8+ T cells generated using other library construction methods. From direct inspection, we noted that of the pathways of interest we described above, four were found to be conserved across at least three of the four datasets, with particularly strong conservation of the chemokine signaling pathway we highlighted (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S4A</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/). This conservation could be found despite sharp differences between datasets in terms of information recovered (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S4B</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/). For instance, we could observe sharp differences in dropout rate and background noise levels between the scSTATseq and 10X libraries (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S5</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/). As such, we believe that the pathway inferences drawn through TIPS may be reproducible across multiple independent datasets.</p>
    </sec>
    <sec id="sec17">
      <title>Individual gene selection</title>
      <p>In the results described above, we relied on picking genes with significant changes in switch-like expression as representative genes in a given pathway. However, it is well appreciated that not all genes may display this type of expression characteristic. As such, in order to develop a broader mechanism for identifying critical genes in a given pathway, we further explored using two other scoring approaches to assess gene significance. One approach is to perform a direct Pearson correlation between gene expression level for each cell with its assigned pseudotime, to capture genes with steady and monotonic expression changes. The other is to further iterate the DDRTree algorithm on a pathway-level and calculate the impact removing a single given gene would have on the strength of the pseudotime correlation (DDRTree influence). When applied to the simulated dataset described above, we found that the correlation metric was highly associated with the switchde-based results and did not help to discover more significantly associated genes (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S6A</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/). However, we found that the DDRTree influence metric recovered an independent pool of genes that did not follow switch-like behavior (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S6C</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/). These results were even more pronounced when applied to real data, as assessing DDRTree influence led to the identification of genes with complex expression dynamics (alternatively increasing then decreasing) (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S7</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/). Since these two metrics captured distinct pools of genes that are meaningful in different context, we elected to incorporate both of these methods for gene selection to help maximize the amount of information obtainable from TIPS and assist in downstream screening.</p>
    </sec>
    <sec id="sec18">
      <title>TIPS analysis of complex progression trajectories</title>
      <p>While differentiation trajectories may sometimes involve a simple progression from one dominant state to another, real biological trajectories are oftentimes more complex and involve multiple stable intermediate states. In order to understand if the TIPS workflow is sufficiently robust to handle these complex trajectories, we next applied it to analyze the differentiation trajectory of CD8+ tumor-infiltrating lymphocytes (TILs). TILs reside in a complex tumor-immune microenvironment, wherein different types of cellular and metabolic interactions may influence their behavior. CD8+ TILs in particular have been demonstrated to become functionally exhausted in many types of solid tumors, and prevention/reversal of exhaustion has been the focus of intensive research. To examine the processes underlying CD8+ TIL behavior, we applied the TIPS workflow to a dataset of CD8+ TILs derived from hepatocellular carcinoma (HCC) patients that were generated using the plate-based SMARTseq2 library construction.</p>
      <p>From our initial dimension reduction via UMAP, we were able to observe a number of separate clusters that roughly corresponded to the published cellular annotations (<xref rid="f22" ref-type="fig">Figure 4A</xref>). These cell types progressed in our trajectory analysis in a somewhat irregular manner, with an undefined population of cells marking the pseudotime endpoint (<xref rid="f22" ref-type="fig">Figure 4B and C</xref>). A relatively small portion of curated pathways (51/1114) were found to have significant association with this trajectory (Supplementary Table S2, see Supplementary Data available online at http://bib.oxfordjournals.org/), from which we could identify a few pathways that have been previously validated, such as receptor-tyrosine kinase signaling and TLR cascade (<xref rid="f22" ref-type="fig">Figure 4D and E</xref>). From further exploration of the unannotated cluster, we found that the cluster was dominated by ribosomal signatures, explaining the inclusion of significant correlations with ribosome-related pathways in our inference (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S8</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/). More interestingly, however, we also uncovered pathways that have been reported to influence CD8+ T cell behavior in other contexts, such as the ROBO receptors and ERBB2 signaling pathways [<xref rid="ref27" ref-type="bibr">27</xref>, <xref rid="ref28" ref-type="bibr">28</xref>]. These pathways largely underwent substantial changes in gene expression early on in the pseudotime trajectory, although a portion of the ROBO receptor pathway shifted later on (<xref rid="f22" ref-type="fig">Figure 4F</xref>). Manual inspection of the genes within these pathways demonstrated that while the expression of ROBO receptors themselves did not show strong changes with respect to pseudotime, we could observe increases in the chemokine receptor CXCR4 that has been shown to rely on ROBO cooperation (<xref rid="f22" ref-type="fig">Figure 4I</xref>). Similarly, while ERBB2 itself did not show significant changes in expression, we did note a decreased expression in its downstream signal mediator KRAS at the endstage of the pseudotime trajectory (<xref rid="f22" ref-type="fig">Figure 4J</xref>). Taken together, these results suggest that both of these pathways may also play significant roles in regulating CD8+ TIL behavior.</p>
    </sec>
    <sec id="sec19">
      <title>TIPS analysis of CD8+ TIL trajectory during checkpoint blockade</title>
      <p>The recent development of ICB antibodies targeting PD-1/PD-L1 and CTLA-4 has opened a new avenue for cancer therapy. While these inhibitors are expected to have a significant impact on the behavior of TILs, the exact molecular mechanisms and processes that are altered as a result of their application are not yet fully understood. To extend our analysis of TIL behavior in HCC from above, we next analyzed a droplet-based dataset of TILs taken from patients who had undergone direct surgical resection only, or otherwise received anti-PD-L1 and anti-CTLA4 or anti-PD-1 treatment prior to resection. After subsetting out the population of CD8+ T cells from the dataset, we observed from dimension reduction that there was substantial separation between cells taken from the patients who had received differential treatment. This separation was also clear in our trajectory construction, where cells derived from untreated patients marked the end stage, while those from patients treated with anti-PD-L1 and anti-CTLA4 marked the start point.</p>
      <p>Application of TIPS using the Reactome and KEGG knowledgebase once again yielded a small pool of (52 out of 965) pathways with significant associations (Supplementary Table S3, see Supplementary Data available online at http://bib.oxfordjournals.org/). As a whole, these pathways were significantly different from those recovered from the previous analysis of HCC samples above. However, we were able to recover pathways such as cellular senescence and TCA cycle, which have been previously implicated to be altered as a result of ICB [<xref rid="ref29" ref-type="bibr">29</xref>, <xref rid="ref30" ref-type="bibr">30</xref>] (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S9</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/). At the same time, we also uncovered a number of pathways that have not characterized in this context, such as WNT signaling and estrogen-dependent gene expression. Whether these pathways and their downstream molecules may also be important contributors to ICB success remains an open question for future validation.</p>
    </sec>
    <sec id="sec20">
      <title>Identification of pathways involved in beta cell dysfunction in T2D</title>
      <p>To further demonstrate the applicability of the TIPS workflow in other biological contexts, we additionally analyzed a dataset of endocrine cells derived from pancreatic islets of patients with type II diabetes (T2D) or healthy controls. UMAP clustering of the dataset cleanly stratified the seven annotated populations, with visible stratification in the beta cell cluster based on patient condition (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S10A</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/). Through trajectory analysis, we were able to observe that beta cells derived from T2D patients tended to be separate from controls and occupy the end of the trajectory, a phenomenon not seen in alpha cells (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S10D–I</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/). Via pathway inference, we observed contribution by pathways involved in physiological beta cell function (such as ion channel transport and IRS-related events triggered by IGF1R), as well as others associated with inflammation (such as cytokine signaling and adaptive immunity) (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S10K</xref>, <xref rid="sup2" ref-type="supplementary-material">Supplementary Table S4</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/). Of note, direct inspection of the cytokine signaling pathway demonstrated that the genes displaying changes included downstream effectors, such as the transcription factor FOXO3 and cell death regulator CASP3, suggesting that the inference was due to the influence of cytokine stimulus on beta cells, and not direct beta cell production of cytokines (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S10L</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/). These findings are consistent with previous reports and show that our TIPS analytical framework can provide pathway inferences in other settings [<xref rid="ref31" ref-type="bibr">31</xref>].</p>
    </sec>
    <sec id="sec21">
      <title>Extension of TIPS using other trajectory inference algorithms</title>
      <p>While the results above utilize the DDRTree algorithm for trajectory mapping, many other trajectory inference algorithms also exist, and some researchers may have preferences for alternative algorithms [<xref rid="ref32" ref-type="bibr">32</xref>]. On a conceptual level, the TIPS workflow is not reliant on any particular trajectory inference algorithm, so long as the algorithm returns accurate pseudotime mapping results. As such, we also compared the results from application of the TIPS workflow using DDRTree with results obtainable using other trajectory inference algorithms. Using five previously benchmarked algorithms in the dynverse collection (Slingshot, Embeddr, Component1, MATCHER and Angle) for comparison, we analyzed the correlations seen between KEGG pathways and random gene lists in the scSTATseq CD8 + T cell dataset described above in <xref rid="f21" ref-type="fig">Figure 3</xref>. On a general level, we observed that two approaches (Component1 and MATCHER) yielded the highest number of pathways with inferred contribution but also had the highest background signal when used to analyze randomly selected lists (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S12A and B</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/). Angle, which is intended to recover cyclical trajectories, showed no correlation with the other methods. Since the dataset itself is not expected to display cyclical behavior on a biological level (effector CD8 + T cells are not expected to have the capability to revert back into naïve CD8 + T cells), its application here is improper. Two other approaches (DDRTree and Slingshot) showed relatively similar results (<xref rid="sup2" ref-type="supplementary-material">Supplementary Figure S12C and D</xref>, see Supplementary Data available online at http://bib.oxfordjournals.org/), with Slingshot detecting more pathways at higher correlation values, but also having somewhat higher background noise. From these analyses, we observe that the signal-to-noise tradeoff may be an important component to consider when selecting trajectory inference algorithms for TIPS and that DDRTree use in this case appears to offer high sensitivity for pathway inference. However, the ideal algorithm in each use case may vary because of the contextual influence and other advantages/disadvantages of each algorithm (runtime, stability, accessibility, etc.). As such, we recommend users of the TIPS workflow to also consider alternative trajectory inference algorithms based on dataset fit. For reference, the runtimes using DDRTree for the datasets analyzed in this manuscript are included as <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>.</p>
      <fig position="float" id="f21">
        <label>
Figure 3
</label>
        <caption>
          <p>TIPS workflow applied to CD8+ T cells. (A) UMAP reduction and clustering of the sorted CD8+ T cells identifies two prominent clusters reflective of effector and naïve/memory like populations. (B) Violin plot of four prominent markers of T cell state demonstrate that the effector cluster features high expression of the functional molecules GZMB and IFNG, while the memory cluster shows elevated expression of CCR7 and S1PR1. (C) Trajectory mapping of these cells reveals a simple arcing path with ordered progression from memory to effector cells. (D) Volcano plot of the distribution of pseudotime correlation values and FDRs for all pathways derived from three databases considered. Notably, a number of larger pathways do display high levels of pseudotime correlation, but at a level functionally indistinguishable from randomly selected gene sets of matching size. (E) Dotplot visualization of 10 pathways of interest that had significant correlation. While TIPS includes a default option for picking the top10 pathways, users may also wish to highlight specific pathways of interest. (F) Temporal ordering of four pathways of interest using the switch points of significant genes along the trajectory. While the majority of the switch events occur at the point of change between memory and effector populations, a significant portion also occurs at earlier and later points, indicating that the changes do not simply describe DEGs between the two clusters. (G–J) Plots of the scaled expression of specific genes of interest from each pathway visualized over the course of pseudotime progression. These include genes that changed late in the trajectory, such as CXCR1 from the chemokine signaling pathway, as well as genes that change earlier on, such as IL12A from the IL-12 family signaling pathway.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bbab124f3" position="float"/>
      </fig>
      <fig position="float" id="f22">
        <label>
Figure 4
</label>
        <caption>
          <p>Application of TIPS to identify pathways associated with CD8 TIL function. (A) UMAP reduction of the subset of CD8+ TILs taken from tumor regions (annotated as TTC in original data) shows relatively clean separation between the 5 types of annotated cell populations described in the original analysis, with some overlap caused by differences in dimension reduction method and HVG selection. (B and C) Trajectory mapping of these cells shows some stratification between cell states along the pseudotime trajectory, with a relatively prominent placement of unannotated cells at the end point of the trajectory. (D) Distribution of pathways according to pseudotime correlation and FDR shows relatively few significant pathways. (E) Dotplot visualization of several significant pathways. (F) Temporal ordering of selected pathways shows that most changes occur early on along the trajectory, although the ROBO receptors pathway includes a secondary peak of changes at the middle of the trajectory. (G–J) Plots of the scaled expression of specific genes of interest from each pathway visualized over the course of pseudotime progression.</p>
        </caption>
        <graphic xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="bbab124f4" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec id="sec22">
    <title>Discussion</title>
    <p>While a large number of methods have been developed in recent years to help order cells along a single and/or multiple trajectories, obtaining information of biological significance of from such analysis has somewhat lagged behind [<xref rid="ref33" ref-type="bibr">33</xref>]. In particular, although it has been demonstrated through a number of methods that trajectory analysis can recapitulate the known order of cellular maturation over the course of hematopoiesis, few studies have been able to discover novel transcription factors and/or biological processes that influence this process. In an attempt to redress this deficiency, we have presented the TIPS framework as described above to help uncover these molecular mechanisms. By relying on pseudotime trajectories as our point of comparison, we can maintain the single-cell nature of the data and thereby identify pathways that change across multiple clusters. Furthermore, we can leverage existing tools for identifying gene changes with respect to pseudotime to give an overview of the temporal order in which pathways undergo significant changes. This latter form of temporal information is an additional vantage point that may of particular use in examining interdependent pathway relationships.</p>
    <p>Although our current pseudotime workflow is built upon the DDRTree algorithm implemented in Monocle, the TIPS workflow is not limited to this method for pseudotime assignment. Instead, the relative simplicity of our conceptual framework allows it to be readily implemented with other assignment algorithms and thus provides flexibility for further optimization through trajectory mapping algorithms with faster runtimes and improved accuracy. We hope to be able to continually update our TIPS server to incorporate these newer methods for pseudotime assignment and develop a recommendation scheme for trajectory inference algorithms based on dataset metrics in the future. Similarly, we currently rely on the switchde concept of finding genes with single, abrupt changes in expression, to define the order at which a pathway may be activating. This approach may be particularly suitable for genes with pronounced burst [<xref rid="ref34" ref-type="bibr">34</xref>]. However, not all genes will follow this pattern of expression; some may have substantially more gradual increases in response to stimuli as a result of a higher basal level of expression, while others may display more complex expression kinetics with multiple on/off switch points. Further development of gene kinetic modeling and regulatory inference algorithms may be able to identify ways to successfully capture the signal of these genes with respect to pseudotime and help refine our understanding of pathway kinetics [<xref rid="ref35" ref-type="bibr">35</xref>]. Additional developments in systems to calibrate single-gene weight within pathway gene sets may also help to further refine the sensitivity of our kinetic inference results.</p>
    <p>In short, our conceptual approach is not limited by the type of single-cell library construction method used; we present worked examples of TIPS analysis as performed on multiple different datasets from independent sources and generated with different workflows. These datasets vary significantly in the numbers of cells sequenced, the numbers of genes detected per cell and in their rate of technical dropout. This latter source of variation may have particularly significant ramifications on the accuracy of pseudotime alignment. A number of informatics tools have been designed to impute and correct for this variation [<xref rid="ref36" ref-type="bibr">36</xref>]. However, as further advances in library construction lead to increasingly precise and accurate single-cell profiles, technical dropout may also be significantly ameliorated. Together with further refinement and expansion of knowledgebase data, we anticipate that the analytical framework we describe in this manuscript will only improve in accuracy and predictive power over time.</p>
    <boxed-text id="box01" position="float">
      <sec id="sec25">
        <title>Key Points</title>
        <list list-type="bullet">
          <list-item>
            <p>The TIPS framework can be used to infer which biological pathways are significantly associated with progression along a central pseudotime trajectory.</p>
          </list-item>
          <list-item>
            <p>Additional contextual information on the relative order of pathway changes, and the specific genes driving such changes, can also be identified.</p>
          </list-item>
          <list-item>
            <p>TIPS opens up new modes of information recoverable from trajectory analysis.</p>
          </list-item>
        </list>
      </sec>
    </boxed-text>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>supplementaryvideo_bbab124</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="supplementaryvideo_bbab124.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material id="sup2" position="float" content-type="local-data">
      <label>supplemetaryfigures_20210312_bbab124</label>
      <media xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="supplemetaryfigures_20210312_bbab124.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec sec-type="data-availability" id="sec23">
    <title>Data Availability</title>
    <p>All publicly available scRNAseq data analyzed in this study are available through GEO under the accessions GSE133535 (CD8+ T cell libraries constructed using other methods), GSE98683 (SMARTseq2 sequencing of CD8+ TILs from HCC patients) and GSE125449 (10X Genomics sequencing of CD8+ TILs from HCC patients after immune checkpoint blockade). scSTATseq sequenced libraries of CD8+T cells are available through the Genome Sequence Archive (accession HRA000723).</p>
  </sec>
  <sec id="bbab124-ack">
    <title>Acknowledgements</title>
    <p>The authors would like to thank the other members of lab for their constructive feedback during discussion and writing of this manuscript. In addition, the authors thank Prof. Hongtao Li (Southwest University, Chongqing) for assistance in the production and purification of the Tn5 transposase used in library construction for scSTATseq.</p>
  </sec>
  <sec id="sec27">
    <title>Funding</title>
    <p>National Science Foundation of China, National Key Project of China (2017YFA0700404 and 2016YFA0502201) to W.Y.; National Science Foundation of China (81971546) to L.Z.; Natural Science Foundation of Shenzhen (JCYJ20190808150009605) to S.J.</p>
  </sec>
  <notes id="AN1">
    <p><bold>Zihan Zheng</bold> is a bioinformatician working on biological applications of trajectory analysis.</p>
    <p><bold>Xin Qiu</bold> is a technician specializing in performing and optimizing methods for single-cell library construction.</p>
    <p><bold>Haiyang Wu</bold> is a bioinformatician working on identifying antigen-specific T cell clones through single-cell sequencing.</p>
    <p><bold>Ling Chang</bold> is a PhD student at Army Medical University working on applying scRNAseq to interrogate T cell differentiation and clonal behavior in autoimmune diseases.</p>
    <p><bold>Xiangyu Tang</bold> is a PhD student at Army Medical University working on applying scRNAseq to identify new mechanisms involved in osteoclast differentiation.</p>
    <p><bold>Liyun Zou</bold> is an Assistant Professor at Army Medical University working in the fields of antigen presentation and autoimmunity.</p>
    <p><bold>Jingyi Li</bold> is a Clinician and an Assistant Professor in the Department of Rheumatology and Immunology who specializes in autoimmune diseases and has projects focused on exploring the impact of pharmaceutical intervention on immune response.</p>
    <p><bold>Yuzhang Wu</bold> is the Director of the Immunology Institute at Army Medical University who specializes in T cell immunology during autoimmunity and chronic infection.</p>
    <p><bold>Jianzhi Zhou</bold> is the Research Director at Biowavelet Ltd., a company working on developing hardware and software for automation of high-throughput sequencing library construction.</p>
    <p><bold>Shan Jiang</bold> is an Assistant Professor at Shenzhen University working in the field of T cell development and differentiation.</p>
    <p><bold>Ying Wan</bold> is the Director of the Biomedical Analysis Center at Army Medical University and has led work focused on single cell sequencing and vesicular transport.</p>
    <p><bold>Qingshan Ni</bold> is a bioinformatician and lecturer at Army Medical University whose main research focus is on data analysis for high-throughput sequencing.</p>
  </notes>
  <ref-list id="bib1">
    <title>References</title>
    <ref id="ref1">
      <label>[1]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aibar</surname><given-names>S</given-names></string-name>, <string-name><surname>González-Blas</surname><given-names>CB</given-names></string-name>, <string-name><surname>Moerman</surname><given-names>T</given-names></string-name>, <etal>et al.</etal></person-group><article-title>SCENIC: single-cell regulatory network inference and clustering</article-title>. <source>Nat Methods</source><year>2017</year>;<volume>14</volume>(<issue>11</issue>):<fpage>1083</fpage>–<lpage>6</lpage>. doi: <pub-id pub-id-type="doi">10.1038/nmeth.4463</pub-id>.<pub-id pub-id-type="pmid">28991892</pub-id></mixed-citation>
    </ref>
    <ref id="ref2">
      <label>[2]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>la Manno</surname><given-names>G</given-names></string-name>, <string-name><surname>Soldatov</surname><given-names>R</given-names></string-name>, <string-name><surname>Zeisel</surname><given-names>A</given-names></string-name>, <etal>et al.</etal></person-group><article-title>RNA velocity of single cells</article-title>. <source>Nature</source><year>2018</year>;<volume>560</volume>(<issue>7719</issue>):<fpage>494</fpage>–<lpage>8</lpage>. doi: <pub-id pub-id-type="doi">10.1038/s41586-018-0414-6</pub-id><pub-id pub-id-type="pmid">30089906</pub-id></mixed-citation>
    </ref>
    <ref id="ref3">
      <label>[3]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Efremova</surname><given-names>M</given-names></string-name>, <string-name><surname>Vento-Tormo</surname><given-names>M</given-names></string-name>, <string-name><surname>Teichmann</surname><given-names>SA</given-names></string-name>, <etal>et al.</etal></person-group><article-title>CellPhoneDB: inferring cell-cell communication from combined expression of multi-subunit ligand-receptor complexes</article-title>. <source>Nat Protoc</source><year>2020</year>;<volume>15</volume>(<issue>4</issue>):<fpage>1484</fpage>–<lpage>506</lpage>. doi: <pub-id pub-id-type="doi">10.1038/s41596-020-0292-x</pub-id>.<pub-id pub-id-type="pmid">32103204</pub-id></mixed-citation>
    </ref>
    <ref id="ref4">
      <label>[4]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lähnemann</surname><given-names>D</given-names></string-name>, <string-name><surname>Köster</surname><given-names>J</given-names></string-name>, <string-name><surname>Szczurek</surname><given-names>E</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Eleven grand challenges in single-cell data science</article-title>. <source>Genome Biol</source><year>2020</year>;<volume>21</volume>(<issue>1</issue>):<fpage>31</fpage>. doi: <pub-id pub-id-type="doi">10.1186/s13059-020-1926-6</pub-id><pub-id pub-id-type="pmid">32033589</pub-id></mixed-citation>
    </ref>
    <ref id="ref5">
      <label>[5]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andrews</surname><given-names>TS</given-names></string-name>, <string-name><surname>Hemberg</surname><given-names>M</given-names></string-name></person-group>. <article-title>False signals induced by single-cell imputation. Version 2</article-title>. <source>F1000Res</source><year>2018</year>;<volume>7</volume>:<fpage>1740</fpage>. doi: <pub-id pub-id-type="doi">10.12688/f1000research.16613.2</pub-id>.<pub-id pub-id-type="pmid">30906525</pub-id></mixed-citation>
    </ref>
    <ref id="ref6">
      <label>[6]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baran</surname><given-names>Y</given-names></string-name>, <string-name><surname>Bercovich</surname><given-names>A</given-names></string-name>, <string-name><surname>Sebe-Pedros</surname><given-names>A</given-names></string-name>, <etal>et al.</etal></person-group><article-title>MetaCell: analysis of single-cell RNA-seq data using K-nn graph partitions</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>206</fpage>. doi: <pub-id pub-id-type="doi">10.1186/s13059-019-1812-2</pub-id><pub-id pub-id-type="pmid">31604482</pub-id></mixed-citation>
    </ref>
    <ref id="ref7">
      <label>[7]</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name name-style="given-only"><given-names>Aibar</given-names></string-name>, <etal>et al.</etal></person-group><part-title>AUCell: Analysis of 'gene set' activity in single-cell RNA-seq data</part-title>. <year>2016</year>, <comment>R/Bioconductor package</comment>.</mixed-citation>
    </ref>
    <ref id="ref8">
      <label>[8]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hänzelmann</surname><given-names>S</given-names></string-name>, <string-name><surname>Castelo</surname><given-names>R</given-names></string-name>, <string-name><surname>Guinney</surname><given-names>J</given-names></string-name></person-group>. <article-title>GSVA: gene set variation analysis for microarray and RNA-seq data</article-title>. <source>BMC Bioinformatics</source><year>2013</year>;<volume>14</volume>:<fpage>7</fpage>. doi: <pub-id pub-id-type="doi">10.1186/1471-2105-14-7</pub-id>.<pub-id pub-id-type="pmid">23323831</pub-id></mixed-citation>
    </ref>
    <ref id="ref9">
      <label>[9]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M</given-names></string-name>, <string-name><surname>Sato</surname><given-names>Y</given-names></string-name></person-group>. <article-title>KEGG mapper for inferring cellular functions from protein sequences</article-title>. <source>Protein Sci</source>. Nature Biotechnol 2020;<volume>29</volume>(<issue>1</issue>):28–35. doi: <pub-id pub-id-type="doi">10.1002/pro.3711</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref10">
      <label>[10]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jassal</surname><given-names>B</given-names></string-name>, <string-name><surname>Matthews</surname><given-names>L</given-names></string-name>, <string-name><surname>Viteri</surname><given-names>G</given-names></string-name>, <etal>et al.</etal></person-group><article-title>The reactome pathway knowledgebase</article-title>. <source>Nucleic Acids Res</source><year>2020</year>;<volume>48</volume>(<issue>D1</issue>):<fpage>D498</fpage>–<lpage>503</lpage>. doi: <pub-id pub-id-type="doi">10.1093/nar/gkz1031</pub-id>.<pub-id pub-id-type="pmid">31691815</pub-id></mixed-citation>
    </ref>
    <ref id="ref11">
      <label>[11]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Subramanian</surname><given-names>A</given-names></string-name>, <string-name><surname>Tamayo</surname><given-names>P</given-names></string-name>, <string-name><surname>Mootha</surname><given-names>VK</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc Natl Acad Sci U S A</source><year>2005</year>;<volume>102</volume>(<issue>43</issue>):<fpage>15545</fpage>–<lpage>50</lpage>. doi: <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id><pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="ref12">
      <label>[12]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname><given-names>A</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P</given-names></string-name>, <string-name><surname>Smibert</surname><given-names>P</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat Biotechnol</source><year>2018</year>;<volume>36</volume>(<issue>5</issue>):<fpage>411</fpage>–<lpage>20</lpage>. doi: <pub-id pub-id-type="doi">10.1038/nbt.4096</pub-id><pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="ref13">
      <label>[13]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Becht</surname><given-names>E</given-names></string-name>, <string-name><surname>McInnes</surname><given-names>L</given-names></string-name>, <string-name><surname>Healy</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>. <source>Nat Biotechnol</source><year>2019</year>;<volume>37</volume>:<fpage>38</fpage>–<lpage>44</lpage>. doi: <pub-id pub-id-type="doi">10.1038/nbt.4314</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref14">
      <label>[14]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trapnell</surname><given-names>C</given-names></string-name>, <string-name><surname>Cacchiarelli</surname><given-names>D</given-names></string-name>, <string-name><surname>Grimsby</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat Biotechnol</source><year>2014</year>;<volume>32</volume>(<issue>4</issue>):<fpage>381</fpage>–<lpage>6</lpage>. doi: <pub-id pub-id-type="doi">10.1038/nbt.2859</pub-id><pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation>
    </ref>
    <ref id="ref15">
      <label>[15]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Campbell</surname><given-names>KR</given-names></string-name>, <string-name><surname>Yau</surname><given-names>C</given-names></string-name></person-group>. <article-title>Switchde: inference of switch-like differential expression along single-cell trajectories</article-title>. <source>Bioinformatics</source><year>2017</year>;<volume>33</volume>(<issue>8</issue>):<fpage>1241</fpage>–<lpage>2</lpage>. doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btw798</pub-id>.<pub-id pub-id-type="pmid">28011787</pub-id></mixed-citation>
    </ref>
    <ref id="ref16">
      <label>[16]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wehrens</surname><given-names>R</given-names></string-name>, <string-name><surname>Kruisselbrink</surname><given-names>J</given-names></string-name></person-group>. <article-title>Flexible self-organizing maps in kohonen 3.0</article-title>. <source>J Stat Softw</source><year>2018</year>;<volume>87</volume>(<issue>7</issue>):<fpage>1</fpage>–<lpage>18</lpage>. doi: <pub-id pub-id-type="doi">10.18637/jss.v087.i07</pub-id>.</mixed-citation>
    </ref>
    <ref id="ref17">
      <label>[17]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zappia</surname><given-names>L</given-names></string-name>, <string-name><surname>Phipson</surname><given-names>B</given-names></string-name>, <string-name><surname>Oshlack</surname><given-names>A</given-names></string-name></person-group>. <article-title>Splatter: simulation of single-cell RNA sequencing data</article-title>. <source>Genome Biol</source><year>2017</year>;<volume>18</volume>(<issue>1</issue>):<fpage>174</fpage>. doi: <pub-id pub-id-type="doi">10.1186/s13059-017-1305-0</pub-id><pub-id pub-id-type="pmid">28899397</pub-id></mixed-citation>
    </ref>
    <ref id="ref18">
      <label>[18]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>Z</given-names></string-name>, <string-name><surname>Tang</surname><given-names>X</given-names></string-name>, <string-name><surname>Qiu</surname><given-names>X</given-names></string-name>, <etal>et al.</etal></person-group><article-title>scSTATseq: diminishing technical dropout enables core transcriptome recovery and comprehensive single-cell trajectory mapping</article-title>. <source>Preprint: Biorxiv</source>. doi: <pub-id pub-id-type="doi">10.1101/2020.04.15.042408</pub-id> April 17, 2020, preprint: not peer reviewed.</mixed-citation>
    </ref>
    <ref id="ref19">
      <label>[19]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patro</surname><given-names>R</given-names></string-name>, <string-name><surname>Duggal</surname><given-names>G</given-names></string-name>, <string-name><surname>Love</surname><given-names>MI</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Salmon provides fast and bias-aware quantification of transcript expression</article-title>. <source>Nat Methods</source><year>2017</year>;<volume>14</volume>(<issue>4</issue>):<fpage>417</fpage>–<lpage>9</lpage>. doi: <pub-id pub-id-type="doi">10.1038/nmeth.4197</pub-id><pub-id pub-id-type="pmid">28263959</pub-id></mixed-citation>
    </ref>
    <ref id="ref20">
      <label>[20]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mereu</surname><given-names>E</given-names></string-name>, <string-name><surname>Lafzi</surname><given-names>A</given-names></string-name>, <string-name><surname>Moutinho</surname><given-names>C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Benchmarking single-cell RNA-sequencing protocols for cell atlas projects</article-title>. <source>Nat Biotechnol</source><year>2020</year>;<volume>38</volume>(<issue>6</issue>):<fpage>747</fpage>–<lpage>55</lpage>. doi: <pub-id pub-id-type="doi">10.1038/s41587-020-0469-4</pub-id><pub-id pub-id-type="pmid">32518403</pub-id></mixed-citation>
    </ref>
    <ref id="ref21">
      <label>[21]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Q</given-names></string-name>, <string-name><surname>He</surname><given-names>Y</given-names></string-name>, <string-name><surname>Luo</surname><given-names>N</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Landscape and dynamics of single immune cells in hepatocellular carcinoma</article-title>. <source>Cell</source><year>2019</year>;<volume>179</volume>(<issue>4</issue>):<fpage>829</fpage>, <elocation-id>e20</elocation-id>–<lpage>45</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.cell.2019.10.003</pub-id>.<pub-id pub-id-type="pmid">31675496</pub-id></mixed-citation>
    </ref>
    <ref id="ref22">
      <label>[22]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ma</surname><given-names>L</given-names></string-name>, <string-name><surname>Hernandez</surname><given-names>MO</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>Y</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Tumor cell biodiversity drives microenvironmental reprogramming in liver cancer</article-title>. <source>Cancer Cell</source><year>2019</year>;<volume>36</volume>(<issue>4</issue>):<fpage>418</fpage>, <elocation-id>e6</elocation-id>–<lpage>30</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.ccell.2019.08.007</pub-id>.<pub-id pub-id-type="pmid">31588021</pub-id></mixed-citation>
    </ref>
    <ref id="ref23">
      <label>[23]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lawlor</surname><given-names>N</given-names></string-name>, <string-name><surname>George</surname><given-names>J</given-names></string-name>, <string-name><surname>Bolisetty</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Single-cell transcriptomes identify human islet cell signatures and reveal cell-type-specific expression changes in type 2 diabetes</article-title>. <source>Genome Res</source><year>2017</year>;<volume>27</volume>(<issue>2</issue>):<fpage>208</fpage>–<lpage>22</lpage>.<pub-id pub-id-type="pmid">27864352</pub-id></mixed-citation>
    </ref>
    <ref id="ref24">
      <label>[24]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wallin</surname><given-names>JJ</given-names></string-name>, <string-name><surname>Liang</surname><given-names>L</given-names></string-name>, <string-name><surname>Bakardjiev</surname><given-names>A</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Enhancement of CD8+ T cell responses by ICOS/B7h costimulation</article-title>. <source>J Immunol</source><year>2001</year>;<volume>167</volume>(<issue>1</issue>):<fpage>132</fpage>–<lpage>9</lpage>. doi: <pub-id pub-id-type="doi">10.4049/jimmunol.167.1.132</pub-id><pub-id pub-id-type="pmid">11418641</pub-id></mixed-citation>
    </ref>
    <ref id="ref25">
      <label>[25]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hess</surname><given-names>C</given-names></string-name>, <string-name><surname>Means</surname><given-names>TK</given-names></string-name>, <string-name><surname>Autissier</surname><given-names>P</given-names></string-name>, <etal>et al.</etal></person-group><article-title>IL-8 responsiveness defines a subset of CD8 T cells poised to kill</article-title>. <source>Blood</source><year>2004</year>;<volume>104</volume>(<issue>12</issue>):<fpage>3463</fpage>–<lpage>71</lpage>. doi: <pub-id pub-id-type="doi">10.1182/blood-2004-03-1067</pub-id>.<pub-id pub-id-type="pmid">15292066</pub-id></mixed-citation>
    </ref>
    <ref id="ref26">
      <label>[26]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sinclair</surname><given-names>LV</given-names></string-name>, <string-name><surname>Howden</surname><given-names>AJ</given-names></string-name>, <string-name><surname>Brenes</surname><given-names>A</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Antigen receptor control of methionine metabolism in T cells</article-title>. <source>Elife</source><year>2019</year>;<volume>8</volume>:<elocation-id>e44210</elocation-id>. doi: <pub-id pub-id-type="doi">10.7554/eLife.44210</pub-id><pub-id pub-id-type="pmid">30916644</pub-id></mixed-citation>
    </ref>
    <ref id="ref27">
      <label>[27]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Prasad</surname><given-names>A</given-names></string-name>, <string-name><surname>Qamri</surname><given-names>Z</given-names></string-name>, <string-name><surname>Wu</surname><given-names>J</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Slit-2/Robo-1 modulates the CXCL12/CXCR4-induced chemotaxis of T cells</article-title>. <source>J Leukoc Biol</source><year>2007</year>;<volume>82</volume>(<issue>3</issue>):<fpage>465</fpage>–<lpage>76</lpage>. doi: <pub-id pub-id-type="doi">10.1189/jlb.1106678</pub-id><pub-id pub-id-type="pmid">17565045</pub-id></mixed-citation>
    </ref>
    <ref id="ref28">
      <label>[28]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lozano</surname><given-names>T</given-names></string-name>, <string-name><surname>Chocarro</surname><given-names>S</given-names></string-name>, <string-name><surname>Martin</surname><given-names>C</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Genetic modification of CD8(+) T cells to express EGFR: potential application for adoptive T cell therapies</article-title>. <source>Front Immunol</source><year>2019</year>;<volume>10</volume>:<fpage>2990</fpage>. doi: <pub-id pub-id-type="doi">10.3389/fimmu.2019.02990</pub-id><pub-id pub-id-type="pmid">31921216</pub-id></mixed-citation>
    </ref>
    <ref id="ref29">
      <label>[29]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Im</surname><given-names>SJ</given-names></string-name>, <string-name><surname>Hashimoto</surname><given-names>M</given-names></string-name>, <string-name><surname>Gerner</surname><given-names>MY</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Defining CD8+ T cells that provide the proliferative burst after PD-1 therapy</article-title>. <source>Nature</source><year>2016</year>;<volume>537</volume>(<issue>7620</issue>):<fpage>417</fpage>–<lpage>21</lpage>. doi: <pub-id pub-id-type="doi">10.1038/nature19330</pub-id><pub-id pub-id-type="pmid">27501248</pub-id></mixed-citation>
    </ref>
    <ref id="ref30">
      <label>[30]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>LaFleur</surname><given-names>MW</given-names></string-name>, <string-name><surname>Nguyen</surname><given-names>TH</given-names></string-name>, <string-name><surname>Coxe</surname><given-names>MA</given-names></string-name>, <etal>et al.</etal></person-group><article-title>PTPN2 regulates the generation of exhausted CD8(+) T cell subpopulations and restrains tumor immunity</article-title>. <source>Nat Immunol</source><year>2019</year>;<volume>20</volume>(<issue>10</issue>):<fpage>1335</fpage>–<lpage>47</lpage>. doi: <pub-id pub-id-type="doi">10.1038/s41590-019-0480-4</pub-id>.<pub-id pub-id-type="pmid">31527834</pub-id></mixed-citation>
    </ref>
    <ref id="ref31">
      <label>[31]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eguchi</surname><given-names>K</given-names></string-name>, <string-name><surname>Nagai</surname><given-names>R</given-names></string-name></person-group>. <article-title>Islet inflammation in type 2 diabetes and physiology</article-title>. <source>J Clin Invest</source><year>2017</year>;<volume>127</volume>(<issue>1</issue>):<fpage>14</fpage>–<lpage>23</lpage>. doi: <pub-id pub-id-type="doi">10.1172/JCI88877</pub-id>.<pub-id pub-id-type="pmid">28045399</pub-id></mixed-citation>
    </ref>
    <ref id="ref32">
      <label>[32]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname><given-names>AF</given-names></string-name>, <string-name><surname>Hamey</surname><given-names>FK</given-names></string-name>, <string-name><surname>Plass</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>PAGA: graph abstraction reconciles clustering with trajectory inference through a topology preserving map of single cells</article-title>. <source>Genome Biol</source><year>2019</year>;<volume>20</volume>(<issue>1</issue>):<fpage>59</fpage>. doi: <pub-id pub-id-type="doi">10.1186/s13059-019-1663-x</pub-id><pub-id pub-id-type="pmid">30890159</pub-id></mixed-citation>
    </ref>
    <ref id="ref33">
      <label>[33]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saelens</surname><given-names>W</given-names></string-name>, <string-name><surname>Cannoodt</surname><given-names>R</given-names></string-name>, <string-name><surname>Todorov</surname><given-names>H</given-names></string-name>, <etal>et al.</etal></person-group><article-title>A comparison of single-cell trajectory inference methods</article-title>. <source>Nat Biotechnol</source><year>2019</year>;<volume>37</volume>(<issue>5</issue>):<fpage>547</fpage>–<lpage>54</lpage>. doi: <pub-id pub-id-type="doi">10.1038/s41587-019-0071-9</pub-id><pub-id pub-id-type="pmid">30936559</pub-id></mixed-citation>
    </ref>
    <ref id="ref34">
      <label>[34]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Larsson</surname><given-names>AJM</given-names></string-name>, <string-name><surname>Johnsson</surname><given-names>P</given-names></string-name>, <string-name><surname>Hagemann-Jensen</surname><given-names>M</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Genomic encoding of transcriptional burst kinetics</article-title>. <source>Nature</source><year>2019</year>;<volume>565</volume>(<issue>7738</issue>):<fpage>251</fpage>–<lpage>4</lpage>. doi: <pub-id pub-id-type="doi">10.1038/s41586-018-0836-1</pub-id><pub-id pub-id-type="pmid">30602787</pub-id></mixed-citation>
    </ref>
    <ref id="ref35">
      <label>[35]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pratapa</surname><given-names>A</given-names></string-name>, <string-name><surname>Jalihal</surname><given-names>AP</given-names></string-name>, <string-name><surname>Law</surname><given-names>JN</given-names></string-name>, <etal>et al.</etal></person-group><article-title>Benchmarking algorithms for gene regulatory network inference from single-cell transcriptomic data</article-title>. <source>Nat Methods</source><year>2020</year>;<volume>17</volume>(<issue>2</issue>):<fpage>147</fpage>–<lpage>54</lpage>. doi: <pub-id pub-id-type="doi">10.1038/s41592-019-0690-6</pub-id>.<pub-id pub-id-type="pmid">31907445</pub-id></mixed-citation>
    </ref>
    <ref id="ref36">
      <label>[36]</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lan</surname><given-names>T</given-names></string-name>, <string-name><surname>Hutvagner</surname><given-names>G</given-names></string-name>, <string-name><surname>Lan</surname><given-names>Q</given-names></string-name><etal>et al.</etal></person-group><article-title>Sequencing dropout-and-batch effect normalization for single-cell mRNA profiles: a survey and comparative analysis</article-title>. <source>Brief Bioinform</source><year>2020</year>;<elocation-id>bbaa248</elocation-id>. doi: <pub-id pub-id-type="doi">10.1093/bib/bbaa248</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
