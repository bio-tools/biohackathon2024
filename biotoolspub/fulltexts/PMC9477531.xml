<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9477531</article-id>
    <article-id pub-id-type="pmid">35924984</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btac541</article-id>
    <article-id pub-id-type="publisher-id">btac541</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Gene Expression</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ASURAT: functional annotation-driven unsupervised clustering of single-cell transcriptomes</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1076-830X</contrib-id>
        <name>
          <surname>Iida</surname>
          <given-names>Keita</given-names>
        </name>
        <aff><institution>Institute for Protein Research, Osaka University</institution>, Suita, Osaka 565-0871, <country country="JP">Japan</country></aff>
        <xref rid="btac541-cor1" ref-type="corresp"/>
        <!--kiida@protein.osaka-u.ac.jp-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kondo</surname>
          <given-names>Jumpei</given-names>
        </name>
        <aff><institution>Division of Health Sciences, Osaka University Graduate School of Medicine</institution>, Suita, Osaka 565-0871, <country country="JP">Japan</country></aff>
        <aff><institution>Department of Clinical Bio-Resource Research and Development, Graduate School of Medicine Kyoto University</institution>, Kyoto 606-8501, <country country="JP">Japan</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wibisana</surname>
          <given-names>Johannes Nicolaus</given-names>
        </name>
        <aff><institution>Institute for Protein Research, Osaka University</institution>, Suita, Osaka 565-0871, <country country="JP">Japan</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Inoue</surname>
          <given-names>Masahiro</given-names>
        </name>
        <aff><institution>Department of Clinical Bio-Resource Research and Development, Graduate School of Medicine Kyoto University</institution>, Kyoto 606-8501, <country country="JP">Japan</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Okada</surname>
          <given-names>Mariko</given-names>
        </name>
        <aff><institution>Institute for Protein Research, Osaka University</institution>, Suita, Osaka 565-0871, <country country="JP">Japan</country></aff>
        <aff><institution>Center for Drug Design and Research, National Institutes of Biomedical Innovation, Health and Nutrition</institution>, Ibaraki, Osaka 567-0085, <country country="JP">Japan</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Boeva</surname>
          <given-names>Valentina</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btac541-cor1">To whom correspondence should be addressed. Email: <email>kiida@protein.osaka-u.ac.jp</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>9</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-08-04">
      <day>04</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>04</day>
      <month>8</month>
      <year>2022</year>
    </pub-date>
    <volume>38</volume>
    <issue>18</issue>
    <fpage>4330</fpage>
    <lpage>4336</lpage>
    <history>
      <date date-type="received">
        <day>13</day>
        <month>10</month>
        <year>2021</year>
      </date>
      <date date-type="rev-recd">
        <day>04</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>29</day>
        <month>7</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>01</day>
        <month>8</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>11</day>
        <month>8</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution-NonCommercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">https://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btac541.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Single-cell RNA sequencing (scRNA-seq) analysis reveals heterogeneity and dynamic cell transitions. However, conventional gene-based analyses require intensive manual curation to interpret biological implications of computational results. Hence, a theory for efficiently annotating individual cells remains warranted.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present ASURAT, a computational tool for simultaneously performing unsupervised clustering and functional annotation of disease, cell type, biological process and signaling pathway activity for single-cell transcriptomic data, using a correlation graph decomposition for genes in database-derived functional terms. We validated the usability and clustering performance of ASURAT using scRNA-seq datasets for human peripheral blood mononuclear cells, which required fewer manual curations than existing methods. Moreover, we applied ASURAT to scRNA-seq and spatial transcriptome datasets for human small cell lung cancer and pancreatic ductal adenocarcinoma, respectively, identifying previously overlooked subpopulations and differentially expressed genes. ASURAT is a powerful tool for dissecting cell subpopulations and improving biological interpretability of complex and noisy transcriptomic data.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>ASURAT is published on Bioconductor (<ext-link xlink:href="https://doi.org/10.18129/B9.bioc.ASURAT" ext-link-type="uri">https://doi.org/10.18129/B9.bioc.ASURAT</ext-link>). The codes for analyzing data in this article are available at Github (<ext-link xlink:href="https://github.com/keita-iida/ASURATBI" ext-link-type="uri">https://github.com/keita-iida/ASURATBI</ext-link>) and figshare (<ext-link xlink:href="https://doi.org/10.6084/m9.figshare.19200254.v3" ext-link-type="uri">https://doi.org/10.6084/m9.figshare.19200254.v4</ext-link>).</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>JSPS KAKENHI</institution>
          </institution-wrap>
        </funding-source>
        <award-id>20K14361</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Honjo International Scholarship Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100005951</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Shin Bunya Kaitaku Shien Program of Institute for Protein Research</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Osaka University</institution>
            <institution-id institution-id-type="DOI">10.13039/501100004206</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>JSPS KAKENHI</institution>
          </institution-wrap>
        </funding-source>
        <award-id>17H06299</award-id>
        <award-id>17H06302</award-id>
        <award-id>18H04031</award-id>
        <award-id>JPMJMI19G7</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>JST CREST</institution>
          </institution-wrap>
        </funding-source>
        <award-id>JPMJCR21N3</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Japan Agency for Medical Research and Development</institution>
            <institution-id institution-id-type="DOI">10.13039/100009619</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>JST Moonshot R&amp;D</institution>
          </institution-wrap>
        </funding-source>
        <award-id>JPMJMS2021</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="7"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Single-cell RNA sequencing (scRNA-seq) has deepened our knowledge of biological complexity in terms of heterogeneity and dynamic transition of cell populations, and this knowledge has immense potential for helping elucidate the regulatory principles underlying our body plans (<xref rid="btac541-B30" ref-type="bibr">La Manno <italic toggle="yes">et al.</italic>, 2018</xref>). scRNA-seq has been widely used to improve the molecular understanding of malignant cells in lymphoma (<xref rid="btac541-B58" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2019</xref>), intra- and intertumoral heterogeneity in drug-treated cancer populations (<xref rid="btac541-B52" ref-type="bibr">Stewart <italic toggle="yes">et al.</italic>, 2020</xref>), ligand–receptor interaction in tumor immune microenvironments (<xref rid="btac541-B10" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2020</xref>) and effects of viral infection on immune cell populations (<xref rid="btac541-B14" ref-type="bibr">Devitt <italic toggle="yes">et al.</italic>, 2019</xref>). Various clustering methods based on gene expression similarity have been proposed (<xref rid="btac541-B43" ref-type="bibr">Pasquini <italic toggle="yes">et al.</italic>, 2021</xref>) and applied to annotate cell types (<xref rid="btac541-B26" ref-type="bibr">Kim <italic toggle="yes">et al.</italic>, 2020</xref>). However, conventional gene-based analyses require intensive manual curation to annotate clustering results; hence, efficient and unbiased interpretation of single-cell data remains challenging (<xref rid="btac541-B1" ref-type="bibr">Andrews <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac541-B2" ref-type="bibr">Aran <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btac541-B27" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
    <p>Conventionally, single-cell transcriptomes are analyzed and interpreted by means of unsupervised clustering followed by manual curation of marker genes selected from a large number of differentially expressed genes (DEGs) (<xref rid="btac541-B1" ref-type="bibr">Andrews <italic toggle="yes">et al.</italic>, 2021</xref>). Here, manual curations are based on literature searches of biological functions of DEGs. Today, several computational tools for cell type inference are available, as detailed in a review by <xref rid="btac541-B43" ref-type="bibr">Pasquini <italic toggle="yes">et al.</italic> (2021)</xref>. However, manual curation is often difficult because a single gene is generally multifunctional and therefore associated with multiple biological function terms (<xref rid="btac541-B7" ref-type="bibr">Cancer Genome Atlas Research Network <italic toggle="yes">et al.</italic>, 2017</xref>). In cancer transcriptomics, this difficulty is exacerbated by the complex interdependence between disease-related genes and their heterogeneous expressions, associated with numerous biological function terms.</p>
    <p>A possible solution is to realize clustering and interpretation simultaneously. Recently, reference component analysis has been used for accurate clustering of single-cell transcriptomes along with unbiased cell-type annotation based on similarity to reference transcriptome panels (<xref rid="btac541-B32" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2017</xref>). Yet, these methods require transcriptomic data of well-characterized reference cells as learning datasets, which might not always be available. Another approach is using functionally annotated gene sets for scoring cells, implemented in R packages including PAGODA (<xref rid="btac541-B18" ref-type="bibr">Fan <italic toggle="yes">et al.</italic>, 2016</xref>) and ssGSEA (<xref rid="btac541-B53" ref-type="bibr">Subramanian <italic toggle="yes">et al.</italic>, 2005</xref>). Given single-cell transcriptome data, these methods use statistical methods, such as principal component analysis (PCA) and gene set enrichment analysis (GSEA), for providing each cell with scores of annotations against functionally annotated gene sets, such as signaling pathway modules. Nevertheless, correlations of gene expressions are complex with positive and negative (<xref rid="btac541-B47" ref-type="bibr">Saxena <italic toggle="yes">et al.</italic>, 2006</xref>), strong and weak and non-linear relationships, which can be poorly captured using the existing methods (see also Section 4).</p>
    <p>To overcome these limitations, a nonlinear framework defining biological terms in a more interpretable way is needed. Therefore, we propose the computational tool, ASURAT (functional annotation-driven unsupervised clustering of single-cell transcriptomes), which simultaneously performs unsupervised clustering and biological interpretation in terms of cell type, disease, biological process and signaling pathway, using a nonlinear correlation graph decomposition for functionally annotated gene sets. In this study, we demonstrate the clustering performance of ASURAT using scRNA-seq datasets for healthy and disease human peripheral blood mononuclear cells (PBMCs), small cell lung cancer (SCLC) and spatial transcriptome (ST) datasets for pancreatic ductal adenocarcinoma (PDAC). Our results suggest that ASURAT can greatly improve functional understanding of single-cell transcriptomes, adding a new layer of biological interpretability to conventional gene-based analyses.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Overview of ASURAT workflow</title>
      <p>ASURAT is a computational tool for simultaneously clustering and interpreting single-cell transcriptomes (<xref rid="btac541-F1" ref-type="fig">Fig. 1</xref>) using functionally annotated gene sets collected from knowledge-based databases for cell type, disease, biological process and signaling pathway activity, such as Cell Ontology (CO) (<xref rid="btac541-B15" ref-type="bibr">Diehl <italic toggle="yes">et al.</italic>, 2016</xref>), Disease Ontology (DO) (<xref rid="btac541-B57" ref-type="bibr">Yu <italic toggle="yes">et al.</italic>, 2015</xref>), Gene Ontology (GO) (<xref rid="btac541-B56" ref-type="bibr">Yu <italic toggle="yes">et al.</italic>, 2012</xref>) and Kyoto Encyclopedia of Genes and Genomes (KEGG) (<xref rid="btac541-B25" ref-type="bibr">Kanehisa and Goto, 2000</xref>) (<xref rid="btac541-F1" ref-type="fig">Fig. 1b</xref>). ASURAT creates multiple biological terms using single-cell transcriptome data and annotated gene sets (<xref rid="btac541-F1" ref-type="fig">Fig. 1c</xref>). We called such biological terms ‘signs’. Then, ASURAT creates sign-by-sample matrices (SSMs), in which rows and columns stand for signs and samples (cells), respectively (<xref rid="btac541-F1" ref-type="fig">Fig. 1d</xref>). SSM is analogous to a read count table, where the rows represent signs with biological meaning instead of individual genes and the values contained are ‘sign scores’ instead of read counts. By analyzing SSMs, individual cells can be characterized by various biological terms (<xref rid="btac541-F1" ref-type="fig">Fig. 1e</xref>).</p>
      <fig position="float" id="btac541-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Workflow of ASURAT. (<bold>a</bold>) Flowchart of ASURAT. (<bold>b</bold>) Collection of databases. (<bold>c</bold>) Creation of signs and (<bold>d</bold>) SSMs. (<bold>e</bold>) Analysis of SSMs to infer cell types, diseases, biological processes and signaling pathway activities</p>
        </caption>
        <graphic xlink:href="btac541f1" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.2 Sign</title>
      <p>Let <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi>A</mml:mi></mml:math></inline-formula> be a read count table of size <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:math></inline-formula> from single-cell transcriptomic data, whose rows and columns are <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi>p</mml:mi></mml:math></inline-formula> genes, represented by <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>p</mml:mi><mml:mo>}</mml:mo></mml:math></inline-formula>, and <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mi>n</mml:mi></mml:math></inline-formula> cells, respectively, and <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>R</mml:mi></mml:math></inline-formula> a ‘rapport’ (e.g. correlation matrix) among <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mi mathvariant="normal">Ω</mml:mi></mml:math></inline-formula>. Let <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mi mathvariant="script">F</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="{" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>⊂</mml:mo><mml:mi mathvariant="normal">Ω</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>q</mml:mi><mml:mo>}</mml:mo></mml:math></inline-formula> be a set of ordered pairs, where <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are biological description and the annotated gene set, respectively. Consider an <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mi>R</mml:mi></mml:math></inline-formula>-dependent representation <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:msub><mml:mi mathvariant="normal">Ω</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∪</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mi mathvariant="normal">Ω</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>, where <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is an integer, for <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>q</mml:mi></mml:math></inline-formula>; then, the triplet <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is termed a sign, in particular <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> a parent sign. Our definition is based on Saussure’s semiology. According to Maruyama, the original notion of a <italic toggle="yes">signe</italic> is a segment of ‘a thing of interest’, created by an arbitrary decomposition based on its relations. For example, ‘rainbow’ is a continuum of varying light input, from which we see distinct colors of red, yellow, green and blue by our subjective decomposition based on their spectral relationships (<xref rid="btac541-B12" ref-type="bibr">Couper, 2015</xref>).</p>
    </sec>
    <sec>
      <title>2.3 Correlated gene set</title>
      <p>Let <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mi>R</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> be a correlation matrix of size <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>p</mml:mi></mml:math></inline-formula> defined by <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mi>A</mml:mi></mml:math></inline-formula> and a certain measure (e.g. Spearman’s measure), whose diagonal elements are 1s. Let <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula> be positive and negative constants satisfying <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:mo>α</mml:mo><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> and <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mo>β</mml:mo><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, respectively. Let us arbitrarily fix <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>∈</mml:mo><mml:mi mathvariant="script">F</mml:mi></mml:math></inline-formula> and consider the following subsets of <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>:
<disp-formula id="E1"><mml:math id="M1" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo>α</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>∃</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mtext>such that</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo>β</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>∃</mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mo>Ω</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mtext>such that</mml:mtext><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mo>β</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mo>≠</mml:mo><mml:mi>j</mml:mi><mml:mo>}</mml:mo><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>α</mml:mo><mml:mo>,</mml:mo><mml:mo>β</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo>α</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mo>∪</mml:mo><mml:mo> </mml:mo></mml:msup><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo>β</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math></disp-formula></p>
      <p>Hereinafter we omit the arguments <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mo>α</mml:mo></mml:math></inline-formula> and <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mo>β</mml:mo></mml:math></inline-formula> for simplicity. Let <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>∼</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> be a submatrix of <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi>R</mml:mi></mml:math></inline-formula>. Let us identify the row vectors of <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:math></inline-formula> with points in <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></inline-formula>-dimensional Euclidean space and denote the set of those points as <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>∼</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Then, let us identify all the elements in <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> with those in <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>∼</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> through the subscripts of <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>∼</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. If <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is not empty, decompose <inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>∼</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> into two disjoint subsets <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> by Partitioning Around Medoids (PAM) clustering (<xref rid="btac541-B48" ref-type="bibr">Schubert and Rousseeuw, 2019</xref>), from which we obtain
<disp-formula id="E2"><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mo>∼</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>∪</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p>Otherwise, if <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>V</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is empty, let <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>U</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo>ϕ</mml:mo></mml:math></inline-formula> (empty). Thus, <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is decomposed into three parts as follows:
<disp-formula id="E3"><label>(1)</label><mml:math id="M3" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>∪</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="normal">v</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>∪</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi mathvariant="normal">w</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">w</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Let <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub></mml:math></inline-formula> be submatrices of <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mi>R</mml:mi></mml:math></inline-formula> and let <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> (resp. <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>) be the mean of off-diagonal elements of <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub></mml:math></inline-formula> (<inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:msub></mml:math></inline-formula>). We assume <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:msubsup><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> without loss of generality. If <inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mo>μ</mml:mo></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mo>α</mml:mo></mml:math></inline-formula>, then <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>, <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">w</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> are termed strongly, variably and weakly correlated gene sets, which are hereafter abbreviated as SCG, VCG and WCG, respectively. Otherwise, correlated gene sets cannot be defined for <inline-formula id="IE58"><mml:math id="IM58" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>.</p>
      <p><xref rid="btac541-F2" ref-type="fig">Figure 2</xref> shows that the SCG and VCG include <italic toggle="yes">KRT18</italic> and <italic toggle="yes">ASCL1</italic>, which have negative and positive contributions for lung small cell carcinoma, respectively. Thus, we interpret that <inline-formula id="IE59"><mml:math id="IM59" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula id="IE60"><mml:math id="IM60" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> for DOID 5409 relate positively and negatively with this cell type, respectively. Though there exist simpler methods for decomposing graphs, such as one-shot PAM clustering, hierarchical clustering and tree cutting (<xref rid="btac541-B41" ref-type="bibr">Murtagh and Legendre, 2014</xref>), PCA-based methods (<xref rid="btac541-B21" ref-type="bibr">Hyvarinen, 1999</xref>) and several graph statistical approaches (<xref rid="btac541-B4" ref-type="bibr">Blondel <italic toggle="yes">et al.</italic>, 2008</xref>; <xref rid="btac541-B5" ref-type="bibr">Bodenhofer <italic toggle="yes">et al.</italic>, 2011</xref>), we found that the VCG definition is critical for clustering cells. In fact, we tried replacing our decomposition method (1) with one-shot PAM clustering, but the results often exhibited deteriorated performance since both VCG and WCG (obtained from the one-shot clustering) included weakly correlated genes.</p>
      <fig position="float" id="btac541-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Representation of correlation graph decomposition. From scRNA-seq data and a Disease Ontology term with DOID 5409, which concerns SCLC, three signs <inline-formula id="IE61"><mml:math id="IM61" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, <inline-formula id="IE62"><mml:math id="IM62" display="inline" overflow="scroll"><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">w</mml:mi><mml:mo>}</mml:mo></mml:math></inline-formula>, were produced from their parent sign <inline-formula id="IE63"><mml:math id="IM63" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> by decomposing the correlation graph <inline-formula id="IE64"><mml:math id="IM64" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>R</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> into strongly, variably and weakly correlated gene sets (e.g. positive and negative correlations are observed between <italic toggle="yes">KRT18</italic> and <italic toggle="yes">CD9</italic>, and <italic toggle="yes">KRT18</italic> and <italic toggle="yes">IGFBP2</italic>, respectively). The edge width indicates the strength of the correlation.</p>
        </caption>
        <graphic xlink:href="btac541f2" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>2.4 Sign-by-sample matrix</title>
      <p>Let <inline-formula id="IE65"><mml:math id="IM65" display="inline" overflow="scroll"><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:math></inline-formula> be a gene-by-cell matrix of size <inline-formula id="IE66"><mml:math id="IM66" display="inline" overflow="scroll"><mml:mi>p</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:math></inline-formula> from a single-cell transcriptomic data, whose entries stand for normalized-and-centered gene expression levels. For simplicity, let us assume that annotated gene sets <inline-formula id="IE67"><mml:math id="IM67" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> can be decomposed into non-empty <inline-formula id="IE68"><mml:math id="IM68" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>, <inline-formula id="IE69"><mml:math id="IM69" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula id="IE70"><mml:math id="IM70" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">w</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>, for <inline-formula id="IE71"><mml:math id="IM71" display="inline" overflow="scroll"><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>q</mml:mi></mml:math></inline-formula>. Let <inline-formula id="IE72"><mml:math id="IM72" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula>, <inline-formula id="IE73"><mml:math id="IM73" display="inline" overflow="scroll"><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="normal">v</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="normal">w</mml:mi><mml:mo>}</mml:mo></mml:math></inline-formula>, be matrices of size <inline-formula id="IE74"><mml:math id="IM74" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:math></inline-formula>, whose entries are defined as follows:
<disp-formula id="E4"><mml:math id="M4" display="block" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE75"><mml:math id="IM75" display="inline" overflow="scroll"><mml:mo>|</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>|</mml:mo></mml:math></inline-formula> stands for the number of elements in <inline-formula id="IE76"><mml:math id="IM76" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>. Additionally, let <inline-formula id="IE77"><mml:math id="IM77" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:math></inline-formula>, <inline-formula id="IE78"><mml:math id="IM78" display="inline" overflow="scroll"><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="normal">v</mml:mi><mml:mo>}</mml:mo></mml:math></inline-formula>, be <inline-formula id="IE79"><mml:math id="IM79" display="inline" overflow="scroll"><mml:mi>q</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:math></inline-formula> matrices, whose entries are defined as follows:
<disp-formula id="E5"><label>(2)</label><mml:math id="M5" display="block" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:msup></mml:mrow></mml:mfenced><mml:msubsup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">w</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:math></disp-formula>where <inline-formula id="IE80"><mml:math id="IM80" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula>, <inline-formula id="IE81"><mml:math id="IM81" display="inline" overflow="scroll"><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msup><mml:mrow><mml:mo>ω</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>, are weight constants. Here, <inline-formula id="IE82"><mml:math id="IM82" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">s</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula id="IE83"><mml:math id="IM83" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">v</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:math></inline-formula> are termed SSMs for SCG and VCG, respectively, while the entry <inline-formula id="IE84"><mml:math id="IM84" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> as sign score of the <inline-formula id="IE85"><mml:math id="IM85" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula>th sign for <inline-formula id="IE86"><mml:math id="IM86" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>th sample (cell). Sign score profiles can be represented as points in a Euclidean space, termed sign space in this article. Notably, the ensemble means of sign scores across cells are zeros since SSMs are derived from the centered gene expression matrix <inline-formula id="IE87"><mml:math id="IM87" display="inline" overflow="scroll"><mml:mi>A</mml:mi></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>2.5 Significant sign</title>
      <p>Using ASURAT, one can create multiple signs and SSMs by setting the appropriate parameters (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S1</xref> and <xref rid="sup1" ref-type="supplementary-material">Fig. S1</xref>). Using SSMs, we can infer cell states by performing unsupervised clustering and investigating significant signs, where ‘significant’ means that the sign scores (2) are specifically upregulated or downregulated at the cluster level. Significant signs are analogous to DEGs. Here, naïve usages of statistical tests and fold change analyses should be avoided because the row vectors of SSMs are centered. Hence, we propose a nonparametric separation index, which quantifies the extent of separation between two sets of random variables (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S2</xref> and <xref rid="sup1" ref-type="supplementary-material">Fig. S2</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Clustering single-cell transcriptomes of PBMCs from healthy donors</title>
      <p>To validate the clustering and interpretation performances of ASURAT in comparison with existing methods, we analyzed two public scRNA-seq datasets, namely PBMCs 4k and 6k (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S3</xref>), in which the cell types were inferred via computational tools based on prior assumptions (<xref rid="btac541-B8" ref-type="bibr">Cao <italic toggle="yes">et al.</italic>, 2020</xref>). We first excluded low-quality genes and cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S4</xref>); the resulting read count tables were supplied to ASURAT and four other methods: scran (<xref rid="btac541-B35" ref-type="bibr">Lun <italic toggle="yes">et al.</italic>, 2016</xref>), Seurat (<xref rid="btac541-B20" ref-type="bibr">Hao <italic toggle="yes">et al.</italic>, 2021</xref>), Monocle 3 (<xref rid="btac541-B54" ref-type="bibr">Trapnell <italic toggle="yes">et al.</italic>, 2014</xref>) and SC3 (<xref rid="btac541-B28" ref-type="bibr">Kiselev <italic toggle="yes">et al.</italic>, 2017</xref>). To infer the cell types, we used existing methods, performed unsupervised clustering of cells, and annotated each cluster by manually investigating DEGs based on the adjusted <italic toggle="yes">P</italic>-values <inline-formula id="IE88"><mml:math id="IM88" display="inline" overflow="scroll"><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> or false discovery rates <inline-formula id="IE89"><mml:math id="IM89" display="inline" overflow="scroll"><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S5</xref>). Using ASURAT, we created SSMs from CO, Molecular Signatures Database (MSigDB) (<xref rid="btac541-B53" ref-type="bibr">Subramanian <italic toggle="yes">et al.</italic>, 2005</xref>) and CellMarker databases (<xref rid="btac541-B60" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2019</xref>) for cell type, GO database for biological process and KEGG for signaling pathway. Then, cells were clustered via <italic toggle="yes">k</italic>-nearest neighbor graph generation and the Louvain algorithm (<xref rid="btac541-B20" ref-type="bibr">Hao <italic toggle="yes">et al.</italic>, 2021</xref>) based on the SSM for cell type and annotated by significant signs and DEGs.</p>
      <p>Among all methods used, Seurat, Monocle 3 and ASURAT could robustly reproduce most blood cell types (<xref rid="btac541-F3" ref-type="fig">Fig. 3a</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>), as inferred by <xref rid="btac541-B8" ref-type="bibr">Cao <italic toggle="yes">et al.</italic> (2020)</xref>. We found that manual annotations provided comparable population ratios with previous results (<xref rid="btac541-B8" ref-type="bibr">Cao <italic toggle="yes">et al.</italic>, 2020</xref>). Yet, it was quite laborious to manually investigate marker genes from numerous DEGs (<xref rid="btac541-F3" ref-type="fig">Fig. 3b</xref>). To avoid such laborious process, we applied scCATCH (<xref rid="btac541-B50" ref-type="bibr">Shao <italic toggle="yes">et al.</italic>, 2020</xref>) to automatically annotate the clustering results of Seurat. Nevertheless, population ratios inferred by scCATCH were less consistent than those by manual annotation (<xref rid="btac541-F3" ref-type="fig">Fig. 3a</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). We also used ssGSEA (<xref rid="btac541-B53" ref-type="bibr">Subramanian <italic toggle="yes">et al.</italic>, 2005</xref>) for providing each cell with enrichment scores against ‘cell type signature gene sets’ defined in MSigDB without relying on DEGs (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S5</xref>). Although ssGSEA seemed to have imperfect clustering performance (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S3e and S4e</xref>), the resulting scores were approximately consistent with Seurat annotations with a few exceptions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>).</p>
      <fig position="float" id="btac541-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Identification of cell types in peripheral blood mononuclear cell 4k single-cell transcriptome. (<bold>a</bold>) Population ratios predicted via seven different methods. (<bold>b</bold>) Uniform manifold approximation and projection (UMAP) plots, computed using Seurat and Monocle 3, for the manual investigation of DEGs based on the adjusted <italic toggle="yes">P</italic>-values <inline-formula id="IE90"><mml:math id="IM90" display="inline" overflow="scroll"><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>. (<bold>c</bold>) SSMs and scaled log-transformed read count table, which are vertically concatenated and clustered based on the SSM for cell type. Only top significant signs and DEGs are shown in rows. (<bold>d</bold>) UMAP plot of the SSM for cell type. (<bold>e</bold>) Violin plots showing sign scores of significant signs, in which separation indices (<italic toggle="yes">I</italic>) for the clusters marked with asterisks against the others show ***<inline-formula id="IE91"><mml:math id="IM91" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.9</mml:mn></mml:math></inline-formula>. Suffixes ‘-S’ and ‘-V’ after IDs indicate the signs are defined by strongly and variably correlated gene sets, respectively</p>
        </caption>
        <graphic xlink:href="btac541f3" position="float"/>
      </fig>
      <p>Using ASURAT, we identified six cell types, including dendritic cell and megakaryocyte (<xref rid="btac541-F3" ref-type="fig">Fig. 3a</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>), by primarily investigating significant signs for cell type and secondarily the other signs and DEGs (<xref rid="btac541-F3" ref-type="fig">Fig. 3c–e</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>). The population ratios were approximately consistent with the reported values (<xref rid="btac541-B8" ref-type="bibr">Cao <italic toggle="yes">et al.</italic>, 2020</xref>), except for the small dendritic cell population possibly included in PBMCs (<xref rid="btac541-B55" ref-type="bibr">Villani <italic toggle="yes">et al.</italic>, 2017</xref>). Such a small discrepancy was unavoidable, since <xref rid="btac541-B8" ref-type="bibr">Cao <italic toggle="yes">et al.</italic> (2020)</xref> used author-defined DEGs and preselected cell types to identify the most preferable ones. Our results were robust against variations of the number of cells by randomly downsampling the cells from PBMC 4k data and analyzing these data using Seurat and ASURAT with almost the same parameters (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S6</xref>). These results demonstrate that ASURAT can perform robust clustering for single-cell transcriptomes.</p>
    </sec>
    <sec>
      <title>3.2 Clustering single-cell transcriptomes of PBMCs from control and sepsis donors</title>
      <p>ASURAT uses database-derived biological terms for clustering single-cell transcriptomes, which inevitably introduces annotation bias; some biological terms are associated with many genes, while others are associated with few (<xref rid="btac541-B19" ref-type="bibr">Gaudet and Dessimoz, 2017</xref>). Hence, it is important to validate the clustering performance in terms of cell state granularity. Here, we analyzed scRNA-seq datasets of PBMC published by the clinical cohort study for bacterial sepsis (<xref rid="btac541-B46" ref-type="bibr">Reyes <italic toggle="yes">et al.</italic>, 2020</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S3</xref>), in which 65 subjects with different health conditions were included, total of 106 545 CD45<sup>+</sup> cells and 19 806 LIN<sup>−</sup>CD14<sup>−</sup>HLA-DR<sup>+</sup> dendritic cells were profiled, 16 immune-cell states were defined and the immune signatures of sepsis against bacterial infection were studied.</p>
      <p>After excluding low-quality genes and cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S4</xref>), we inferred the cell types, using scran, Seurat, Monocle 3 and ASURAT with almost the same parameters as in the analyses of PBMCs 4k and 6k (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S7</xref>). Among all the methods, ASURAT could reproduce most immune cell types (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>), which was consistent with the previous report (<xref rid="btac541-B46" ref-type="bibr">Reyes <italic toggle="yes">et al.</italic>, 2020</xref>). ASURAT identified 11 clusters by performing an unsupervised clustering of the SSM for cell type (<xref rid="btac541-F4" ref-type="fig">Fig. 4a</xref>). Among these, we identified three monocyte subpopulations (<xref rid="btac541-F4" ref-type="fig">Fig. 4a–c</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref>): M1 and M2, opposite subtypes with decreased and increased functions of fatty acid degradation; M3, similar to T cells, are characterized by increased function of cell adhesion, containing CD2, CD8A and CD58 (<xref rid="btac541-F4" ref-type="fig">Fig. 4c</xref>).</p>
      <fig position="float" id="btac541-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Identification of cell states in peripheral blood mononuclear cell single-cell transcriptomes from control and sepsis donors. (<bold>a</bold>) t-distributed stochastic neighbor embedding (t-SNE) plots of the SSM for cell type, showing (top) the clustering result and (bottom) reported labels for CD45<sup>+</sup> cells and dendritic cells (DCs) by <xref rid="btac541-B46" ref-type="bibr">Reyes <italic toggle="yes">et al.</italic> (2020)</xref>. (<bold>b</bold> and <bold>c</bold>) Violin plots showing sign scores of significant signs, in which separation indices (<italic toggle="yes">I</italic>) for the clusters marked with asterisks against the others show ***<inline-formula id="IE92"><mml:math id="IM92" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.9</mml:mn></mml:math></inline-formula>, **<inline-formula id="IE93"><mml:math id="IM93" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.6</mml:mn></mml:math></inline-formula> and *<inline-formula id="IE94"><mml:math id="IM94" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.4</mml:mn></mml:math></inline-formula>. (<bold>d</bold>) Population ratios of total monocytes (M1, M2 and M3) and subcluster M2 to all cells except for the inferred dendritic cells across each subject type. Control, uninfected and healthy control; Leuk-UTI, subjects with urinary tract infection (UTI) with leukocytosis but no organ dysfunction; Int-URO and URO, subjects with UTI with mild (or transient) and clear (or persistent) organ dysfunction, respectively; Bac-SEP, bacteremic subjects with sepsis in hospital wards; ICU-SEP and ICU-NoSEP, bacteremic subjects admitted to the intensive care unit with and without sepsis, respectively</p>
        </caption>
        <graphic xlink:href="btac541f4" position="float"/>
      </fig>
      <p>We investigated the differences in cell state composition across each subject type and found that the fractions of total monocytes in subjects with infections (Leuk-UTI, Int-URO, URO, Bac-SEP, ICU-SEP and ICU-NoSEP) are larger than those in healthy controls (Control) (<xref rid="btac541-F4" ref-type="fig">Fig. 4d</xref>), which is consistent with the reported result (<xref rid="btac541-B46" ref-type="bibr">Reyes <italic toggle="yes">et al.</italic>, 2020</xref>). Moreover, the fractions of M2 in subjects with organ dysfunction (Int-URO, URO, Bac-SEP and ICU-SEP) are smaller than those in subjects without organ dysfunction (Control and Leuk-UTI) except for severely ill patients without infection (ICU-NoSEP). Our results suggest that sepsis is associated with impairments of lipid metabolism in monocytes, supported by a previous proteomic study (<xref rid="btac541-B51" ref-type="bibr">Sharma <italic toggle="yes">et al.</italic>, 2019</xref>). These results demonstrate that ASURAT can cluster cells in fine-grained manners and identify functional subtypes.</p>
    </sec>
    <sec>
      <title>3.3 Clustering a single-cell transcriptome of SCLC</title>
      <p>SCLC tumors undergo a transition from chemosensitivity to chemoresistance states against platinum-based therapy through changes in transcriptional heterogeneity (<xref rid="btac541-B52" ref-type="bibr">Stewart <italic toggle="yes">et al.</italic>, 2020</xref>). The ability of SCLC to change phenotype in response to environmental cues involves multiple physiological states of cells, such as pathological states, cell cycle phases (<xref rid="btac541-B16" ref-type="bibr">Dominguez <italic toggle="yes">et al.</italic>, 2016</xref>) and metabolic processes (<xref rid="btac541-B24" ref-type="bibr">Jalili <italic toggle="yes">et al.</italic>, 2021</xref>). However, functional states cannot be readily identified using conventional gene-based analysis alone, and hence the mechanism behind chemoresistance remains unclear. To better understand cancer subtypes in chemoresistant tumors, we applied Seurat and ASURAT to the SCLC scRNA-seq data with cisplatin treatments, obtained from circulating tumor cell-derived xenografts generated from treatment-naïve lung cancer patients (<xref rid="btac541-B52" ref-type="bibr">Stewart <italic toggle="yes">et al.</italic>, 2020</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S3</xref>).</p>
      <p>First, we examined the expression levels of known SCLC marker genes (<xref rid="btac541-B22" ref-type="bibr">Ireland <italic toggle="yes">et al.</italic>, 2020</xref>), namely <italic toggle="yes">ASCL1</italic>, <italic toggle="yes">NEUROD1</italic>, <italic toggle="yes">YAP1</italic> and <italic toggle="yes">POU2F3</italic>, and confirmed that almost all of the cells are of the <italic toggle="yes">ASCL1</italic> single-positive subtype (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S13</xref>), which is consistent with the previous report (<xref rid="btac541-B52" ref-type="bibr">Stewart <italic toggle="yes">et al.</italic>, 2020</xref>). Then, we excluded low-quality genes and cells (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S4</xref>). To investigate molecular subtypes and potential resistance pathways, we performed unsupervised clustering of cells, using Seurat (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S8</xref>). We found that the populations assigned to G1, S and G2M phases are sequentially distributed in the uniform manifold approximation and projection (UMAP) space (<xref rid="btac541-F5" ref-type="fig">Fig. 5a</xref>), while few clusters were observed when we regressed out the cell cycle effects (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S14</xref>), indicating that cell cycle signals are informative in SCLC heterogeneity. Next, we performed KEGG pathway enrichment analysis based on the DEGs with adjusted <italic toggle="yes">P</italic>-values &lt;<inline-formula id="IE95"><mml:math id="IM95" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, the approximate highest threshold where meaningful enrichments of KEGG terms were obtained, but chemoresistance-related terms were not primarily enriched (<xref rid="btac541-F5" ref-type="fig">Fig. 5b</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S8</xref>).</p>
      <fig position="float" id="btac541-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Clustering result of a single-cell transcriptome of SCLCs. (<bold>a</bold>) Uniform manifold approximation and projection (UMAP) plots, showing (left) the clustering result and (right) cell cycle phases computed using Seurat. (<bold>b</bold>) Pathway enrichment analysis for the clustering result in (a), based on the DEGs with adjusted <italic toggle="yes">P</italic>-values<inline-formula id="IE96"><mml:math id="IM96" display="inline" overflow="scroll"><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, in which top five enriched terms are shown. (<bold>c</bold>) SSMs and scaled log-transformed read count table, which are vertically concatenated and clustered based on the SSM for disease. Only top significant signs and DEGs are shown in rows. (<bold>d</bold>) Diffusion map plots of the SSM for disease, showing (top) the clustering result and (bottom) cell cycle phases. (<bold>e</bold>) Violin plots showing sign scores of significant signs, in which separation indices (<italic toggle="yes">I</italic>) for the clusters marked with asterisks against the others show **<inline-formula id="IE97"><mml:math id="IM97" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.6</mml:mn></mml:math></inline-formula> and *<inline-formula id="IE98"><mml:math id="IM98" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.4</mml:mn></mml:math></inline-formula></p>
        </caption>
        <graphic xlink:href="btac541f5" position="float"/>
      </fig>
      <p>Subsequently, to investigate functional subtypes of SCLCs, we used ASURAT to create SSMs from DO, GO and KEGG databases for disease, biological process and signaling pathway, respectively (<xref rid="btac541-F5" ref-type="fig">Fig. 5c</xref>). We performed a dimensionality reduction using a diffusion map (<xref rid="btac541-B11" ref-type="bibr">Coifman and Lafon, 2006</xref>), followed by unsupervised clustering of cells using MERLoT (<xref rid="btac541-B42" ref-type="bibr">Parra <italic toggle="yes">et al.</italic>, 2019</xref>) based on the SSM for disease (<xref rid="btac541-F5" ref-type="fig">Fig. 5d</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S8</xref>). Investigating significant signs and DEGs based on the separation indices <inline-formula id="IE99"><mml:math id="IM99" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0.4</mml:mn></mml:math></inline-formula> and adjusted <italic toggle="yes">P</italic>-values &lt;<inline-formula id="IE100"><mml:math id="IM100" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>70</mml:mn></mml:mrow></mml:msup></mml:math></inline-formula>, respectively, we found three SCLC subpopulations (<xref rid="btac541-F5" ref-type="fig">Fig. 5c–e</xref>): S1, cancer cells characterized by significant signs for hematopoietic system disease and DEGs for ribosomal protein (<italic toggle="yes">RPS12</italic>, <italic toggle="yes">RPL18A</italic>, etc.); S2, characterized by significant signs for platinum drug resistance and DEGs for cancer-related genes (<italic toggle="yes">HMGB1</italic>, <italic toggle="yes">PTTG1</italic>, etc.); and S3, characterized by significant signs for programmed death ligand 1 (PD-L1) expression-mediated immunosuppression and DEGs for proto-oncogenes (<italic toggle="yes">FOS</italic>, <italic toggle="yes">JUN</italic>, etc.). Although SCLC molecular subtypes have been extensively studied (<xref rid="btac541-B3" ref-type="bibr">Balanis <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btac541-B9" ref-type="bibr">Chen <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btac541-B22" ref-type="bibr">Ireland <italic toggle="yes">et al.</italic>, 2020</xref>; <xref rid="btac541-B49" ref-type="bibr">Schwendenwein <italic toggle="yes">et al.</italic>, 2021</xref>), these functional subpopulations have been previously overlooked. Identifying <italic toggle="yes">de novo</italic> SCLC subtypes by future work will validate our clustering results. ASURAT provides a novel clue for the clinical improvements for relapsed SCLC tumors.</p>
    </sec>
    <sec>
      <title>3.4 Clustering an ST of PDAC</title>
      <p>Recent studies of spatially resolved transcriptomic profiling for human PDAC tumors have uncovered that cancer and non-cancer cells are spatially distributed in the distinct tissue regions of primary tumors, and that PDAC cells are accompanied by inflammatory fibroblasts and immune cells (<xref rid="btac541-B17" ref-type="bibr">Elosua-Bayes <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac541-B38" ref-type="bibr">Moncada <italic toggle="yes">et al.</italic>, 2020</xref>). In an original study (<xref rid="btac541-B38" ref-type="bibr">Moncada <italic toggle="yes">et al.</italic>, 2020</xref>), the cellular resolutions of the STs were estimated at 20–70 cells per ST spot, far lower than those of scRNA-seq. Thus, computational methods have been proposed to predict existing cell types by integrating ST and scRNA-seq datasets (<xref rid="btac541-B17" ref-type="bibr">Elosua-Bayes <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac541-B38" ref-type="bibr">Moncada <italic toggle="yes">et al.</italic>, 2020</xref>). Here, we applied Seurat and ASURAT to the published PDAC ST and scRNA-seq data (<xref rid="btac541-B38" ref-type="bibr">Moncada <italic toggle="yes">et al.</italic>, 2020</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S3</xref>), aiming to compare the clustering results of ASURAT with those of existing methods.</p>
      <p>First, we combined all scRNA-seq datasets after confirming minimal batch effects (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S15</xref>). We excluded low-quality genes and cells from the ST and scRNA-seq data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S4</xref>). To cluster the ST with reference to the combined scRNA-seq data, we integrated these two data, using a canonical correlation analysis-based data integration method (<xref rid="btac541-B6" ref-type="bibr">Butler <italic toggle="yes">et al.</italic>, 2018</xref>) (<xref rid="btac541-F6" ref-type="fig">Fig. 6a</xref>). Then, we used Seurat to perform unsupervised clustering for the integrated data. Unexpectedly, batch effects were not corrected between ST and scRNA-seq datasets after data integration (<xref rid="btac541-F6" ref-type="fig">Fig. 6b</xref>); nevertheless, the inferred cancer and non-cancer regions were approximately consistent with the previously annotated histological regions (<xref rid="btac541-B38" ref-type="bibr">Moncada <italic toggle="yes">et al.</italic>, 2020</xref>) (<xref rid="btac541-F6" ref-type="fig">Fig. 6c</xref>), wherein several marker genes such as <italic toggle="yes">S100P</italic> and <italic toggle="yes">FSCN1</italic> were identified as DEGs for the putative cancer cluster (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S9</xref>).</p>
      <fig position="float" id="btac541-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Clustering results of a ST of PDAC. (<bold>a</bold>) Canonical correlation analysis-based data integration of ST and scRNA-seq data using Seurat functions. (<bold>b</bold>–<bold>g</bold>) t-distributed stochastic neighbor embedding (t-SNE) plots and clustering results shown in the PDAC tissue, based on the indicated methods: (b), (d) and (f), showing (left) the labels for ST and scRNA-seq data and (right) annotation results by manual investigation based on the DEGs with adjusted <italic toggle="yes">P</italic>-values <inline-formula id="IE101"><mml:math id="IM101" display="inline" overflow="scroll"><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mi mathvariant="normal">00</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and significant signs; (c), (e) and (g), showing the clustering results, in which labels are the same with those in (b), (d) and (f), respectively. The black colored spots pointed by the arrows indicate the spots newly predicted as atypical region, which might be a normal pancreas involved in cancer. (<bold>h</bold>) Profiles of sign scores in the PDAC tissue, predicting cancer, inflammation and pancreas spots</p>
        </caption>
        <graphic xlink:href="btac541f6" position="float"/>
      </fig>
      <p>Next, to investigate complex cell state composition of the PDAC tissue, we used ASURAT to create SSMs from DO, CO, MSigDB and CellMarker databases for cell type and disease, GO database for biological process and KEGG for signaling pathway. Then, we performed unsupervised clustering of the integrated data based on the SSMs for cell type and disease, and biological process (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S9</xref>). Remarkably, ASURAT could remove the aforementioned batch effects (<xref rid="btac541-F6" ref-type="fig">Fig. 6d and f</xref>) and identify cancer and non-cancer populations (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S16 and S17</xref>). Moreover, we noticed that the spots grouped in the same cluster with PDAC cells are dispersed within the normal pancreas region, which might be a normal pancreas involved in cancer (<xref rid="btac541-F6" ref-type="fig">Fig. 6e and g</xref>).</p>
      <p>To further investigate the cell states in these spots, we profiled all sign scores for 4282 signs across the tissue (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S18</xref>). The sign scores for PDAC were increased in the ST spots approximately matching the reported PDAC region (<xref rid="btac541-B38" ref-type="bibr">Moncada <italic toggle="yes">et al.</italic>, 2020</xref>), while those for micro RNAs in cancer were increased both in the previously annotated PDAC spots and the newly predicted atypical spots (<xref rid="btac541-F6" ref-type="fig">Fig. 6h</xref>). These newly predicted spots were also annotated by a sign for Th17 cell differentiation, suggesting tumor-associated inflammation or antitumor immunity through intercellular communications between Th17 and cancer cells (<xref rid="btac541-B40" ref-type="bibr">Muller-Hubenthal <italic toggle="yes">et al.</italic>, 2009</xref>), which remains to be elucidated in PDAC (<xref rid="btac541-B33" ref-type="bibr">Liu <italic toggle="yes">et al.</italic>, 2019</xref>). In more than 90% of PDAC cases, <italic toggle="yes">KRAS</italic> is mutated at the G domain of the 12th residue (<xref rid="btac541-B23" ref-type="bibr">Ischenko <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac541-B34" ref-type="bibr">Luchini <italic toggle="yes">et al.</italic>, 2020</xref>). Hence, we speculated that it is possible to validate our clustering results of cancer and non-cancer spots by comparing the frequencies of <italic toggle="yes">KRAS</italic> mutations using ST data. Unfortunately, we were unable to detect any read mapped to the specific reported region, possibly owing to the shallow read depth and inherent 3′ bias present in the data. Simultaneous genetic and transcriptional profiling may address this problem in the future (<xref rid="btac541-B31" ref-type="bibr">Lee <italic toggle="yes">et al.</italic>, 2020</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>We developed ASURAT, an original computational tool for simultaneous cell clustering and biological interpretation using database-derived functional terms. ASURAT performs correlation graph decompositions of functionally annotated gene sets to define multiple biological terms, termed signs. The notions of SCG and VCG are critical for capturing complex correlation structures compared with existing methods such as PAGODA2 (<xref rid="btac541-B18" ref-type="bibr">Fan <italic toggle="yes">et al.</italic>, 2016</xref>) and ssGSEA (<xref rid="btac541-B53" ref-type="bibr">Subramanian <italic toggle="yes">et al.</italic>, 2005</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S10</xref> and <xref rid="sup1" ref-type="supplementary-material">Fig. S19</xref>). ASURAT then transforms scRNA-seq data into SSMs, whose rows and columns represent signs and samples (cells), respectively. This SSM plays a key role in characterizing individual cells by various biological terms. Applying ASURAT to several single-cell and ST datasets for PBMCs, SCLC and PDAC, we robustly reproduced the previously reported blood cell types and identified putative subtypes of chemoresistant SCLC and distinct regions within the PDAC tissue.</p>
    <p>ASURAT uses database-derived biological terms for clustering single-cell transcriptomes, which inevitably introduces annotation bias (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note S11</xref>); some biological terms are associated with many genes, whereas others are associated with only a few genes (<xref rid="btac541-B19" ref-type="bibr">Gaudet and Dessimoz, 2017</xref>). Moreover, in some cases, there might be no functional category for a cell type of interest. Nevertheless, users still have a means to manually characterize cells using combinations of significant signs in different functional categories as well as DEGs. Automatic curation will be a potential addition to ASURAT in the future.</p>
    <p>Conventionally, single-cell transcriptomes are analyzed and interpreted by means of unsupervised clustering followed by manual curation of marker genes selected from DEGs, which has been a common bottleneck of gene-based analyses (<xref rid="btac541-B1" ref-type="bibr">Andrews <italic toggle="yes">et al.</italic>, 2021</xref>; <xref rid="btac541-B2" ref-type="bibr">Aran <italic toggle="yes">et al.</italic>, 2019</xref>). The statistical significance of individual genes, typically defined by <italic toggle="yes">P</italic>-value or fold change, is dependent on clustering results. ASURAT can provide an alternative approach and demonstrates superior performance for identifying functional subtypes even within a fairly homogeneous population such as isolated cancer cells. In practice, complementing ASURAT with existing methods (<xref rid="btac541-B6" ref-type="bibr">Butler <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac541-B30" ref-type="bibr">La Manno <italic toggle="yes">et al.</italic>, 2018</xref>) will provide a more comprehensive understanding of single-cell and STs, shedding light on putative transdifferentiation of neuroendocrine cancers (<xref rid="btac541-B3" ref-type="bibr">Balanis <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btac541-B29" ref-type="bibr">Kubota <italic toggle="yes">et al.</italic>, 2020</xref>), intercellular communication in tumor immune microenvironments (<xref rid="btac541-B36" ref-type="bibr">Maynard <italic toggle="yes">et al.</italic>, 2020</xref>) and virus infection on immune cell populations.</p>
    <p>In omics data analyses, knowledge databases are used to interpret computational results: pathway and motif enrichment analyses are often used for transcriptomic and epigenomic analyses (<xref rid="btac541-B37" ref-type="bibr">McLeay and Bailey, 2010</xref>; <xref rid="btac541-B44" ref-type="bibr">Reimand <italic toggle="yes">et al.</italic>, 2019</xref>). In contrast, we propose a unique computational workflow, in which such databases are used for simultaneous clustering and biological interpretation by defining signs. This framework is potentially applicable to any multivariate data with variables linked with annotation information. We can also find such datasets in studies of T cell receptor sequencing (<xref rid="btac541-B13" ref-type="bibr">De Simone <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btac541-B45" ref-type="bibr">Rempala <italic toggle="yes">et al.</italic>, 2011</xref>) along with a pan-immune repertoire (<xref rid="btac541-B59" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2020</xref>). We anticipate that ASURAT will allow for the identification of various inter-sample differences among T cell receptor repertoires in terms of cellular subtype, antigen–antibody interaction, genetic and pathological backgrounds.</p>
    <p>Since ASURAT can create multivariate data (i.e. SSMs) from multiple signs, ranging from cell types to biological functions, it will be valuable to consider graphical models of signs, from which we may infer conditional independence structures. A non-Gaussian Markov random field theory is one of the most promising approaches to address this problem, although requires a large number of samples for achieving true graph edges (<xref rid="btac541-B39" ref-type="bibr">Morrison <italic toggle="yes">et al.</italic>, 2017</xref>). As the increase in size and diversity of the available data, biological interpretation will become increasingly important. Hence, future work should improve methods for prioritizing biological terms more efficiently than manual screening. We believe that ASURAT will greatly expand our understanding of various biological data and open new means of general functional annotation-driven data analysis.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btac541_Supplementary_Data</label>
      <media xlink:href="btac541_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank Takeya Kasukawa for the comments that improved the analysis pipeline.</p>
    <sec>
      <title>Funding</title>
      <p>K.I. was supported by the JSPS KAKENHI [20K14361]. J.N.W. was supported by the Honjo International Scholarship Foundation. K.I., J.K. and M.I. were supported by the Shin Bunya Kaitaku Shien Program of Institute for Protein Research, Osaka University. M.O. was supported by the JSPS KAKENHI [17H06299, 17H06302 and 18H04031; JST-Mirai program number JPMJMI19G7; and JST CREST program number JPMJCR21N3]. M.O. and M.I. were supported by the P-CREATE, Japan Agency for Medical Research and Development. M.O. and K.I. were supported by the JST Moonshot R&amp;D [JPMJMS2021].</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>The PBMCs datasets from healthy donors are available in the 10x Genomics repository at <ext-link xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets" ext-link-type="uri">https://support.10xgenomics.com/single-cell-gene-expression/datasets</ext-link>: ‘4k PBMCs from a Healthy Donor’ and ‘6k PBMCs from a Healthy Donor’. The PBMCs datasets from control and sepsis donors are available in the Broad Institute Single Cell Portal at <ext-link xlink:href="https://singlecell.broadinstitute.org/single_cell" ext-link-type="uri">https://singlecell.broadinstitute.org/single_cell</ext-link>: SCP548, which are referenced in <xref rid="btac541-B46" ref-type="bibr">Reyes <italic toggle="yes">et al.</italic> (2020)</xref>. The SCLC and PDAC datasets are available in Gene Expression Omnibus with accession codes GSM4104164 and GSM3036909, GSM3036910, GSM3036911, GSM3405527, GSM3405528, GSM3405529 and GSM3405530, which are referenced in <xref rid="btac541-B52" ref-type="bibr">Stewart <italic toggle="yes">et al.</italic> (2020)</xref> and <xref rid="btac541-B38" ref-type="bibr">Moncada <italic toggle="yes">et al.</italic> (2020)</xref>, respectively. All the data analyzed in this article are available at Github (<ext-link xlink:href="https://github.com/keita-iida/ASURATBI" ext-link-type="uri">https://github.com/keita-iida/ASURATBI</ext-link>) and figshare (<ext-link xlink:href="https://doi.org/10.6084/m9.figshare.19200254.v4" ext-link-type="uri">https://doi.org/10.6084/m9.figshare.19200254.v4</ext-link>).</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btac541-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andrews</surname><given-names>T.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Tutorial: guidelines for the computational analysis of single-cell RNA sequencing data</article-title>. <source>Nat. Protoc</source>., <volume>16</volume>, <fpage>1</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">33288955</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aran</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Reference-based analysis of lung single-cell sequencing reveals a transitional profibrotic macrophage</article-title>. <source>Nat. Immunol</source>., <volume>20</volume>, <fpage>163</fpage>–<lpage>172</lpage>.<pub-id pub-id-type="pmid">30643263</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Balanis</surname><given-names>N.G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Pan-cancer convergence to a small-cell neuroendocrine phenotype that shares susceptibilities with hematological malignancies</article-title>. <source>Cancer Cell</source>, <volume>36</volume>, <fpage>17</fpage>–<lpage>34.e7</lpage>.<pub-id pub-id-type="pmid">31287989</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blondel</surname><given-names>V.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) <article-title>Fast unfolding of communities in large networks</article-title>. <source>J. Stat. Mech</source>., <volume>2008</volume>, <fpage>P10008</fpage>.</mixed-citation>
    </ref>
    <ref id="btac541-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bodenhofer</surname><given-names>U.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>APCluster: an R package for affinity propagation clustering</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>2463</fpage>–<lpage>2464</lpage>.<pub-id pub-id-type="pmid">21737437</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat. Biotechnol</source>., <volume>36</volume>, <fpage>411</fpage>–<lpage>420</lpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B7">
      <mixed-citation publication-type="journal"><collab>Cancer Genome Atlas Research Network</collab>. <etal>et al</etal> (<year>2017</year>) <article-title>Integrated genomic and molecular characterization of cervical cancer</article-title>. <source>Nature</source>, <volume>543</volume>, <fpage>378</fpage>–<lpage>384</lpage>.<pub-id pub-id-type="pmid">28112728</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cao</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>SCSA: a cell type annotation tool for single-cell RNA-seq data</article-title>. <source>Front. Genet</source>., <volume>11</volume>, <fpage>490</fpage>.<pub-id pub-id-type="pmid">32477414</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>H.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Generation of pulmonary neuroendocrine cells and SCLC-like tumors from human embryonic stem cells</article-title>. <source>J. Exp. Med</source>., <volume>216</volume>, <fpage>674</fpage>–<lpage>687</lpage>.<pub-id pub-id-type="pmid">30737256</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname><given-names>Z.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Ligand-receptor interaction atlas within and between tumor cells and T cells in lung adenocarcinoma</article-title>. <source>Int. J. Biol. Sci</source>., <volume>16</volume>, <fpage>2205</fpage>–<lpage>2219</lpage>.<pub-id pub-id-type="pmid">32549766</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Coifman</surname><given-names>R.R.</given-names></string-name>, <string-name><surname>Lafon</surname><given-names>S.</given-names></string-name></person-group> (<year>2006</year>) <article-title>Diffusion maps</article-title>. <source>Appl. Comput. Harmon. Anal</source>., <volume>21</volume>, <fpage>5</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
    <ref id="btac541-B12">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Couper</surname><given-names>P.</given-names></string-name></person-group> (<year>2015</year>) <italic toggle="yes">A Student’s Introduction to Geographical Thought: Theories, Philosophies, Methodologies</italic>. SAGE Publications, Inc., Los Angeles.</mixed-citation>
    </ref>
    <ref id="btac541-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Simone</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>Single cell T cell receptor sequencing: techniques and future challenges</article-title>. <source>Front. Immunol</source>., <volume>9</volume>, <fpage>1638</fpage>.<pub-id pub-id-type="pmid">30072991</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Devitt</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Single-cell RNA sequencing reveals cell type-specific HPV expression in hyperplastic skin lesions</article-title>. <source>Virology</source>, <volume>537</volume>, <fpage>14</fpage>–<lpage>19</lpage>.<pub-id pub-id-type="pmid">31425970</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Diehl</surname><given-names>A.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>The cell ontology 2016: enhanced content, modularization, and ontology interoperability</article-title>. <source>J. Biomed. Semantics</source>, <volume>7</volume>, <fpage>44</fpage>.<pub-id pub-id-type="pmid">27377652</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dominguez</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>A high-resolution transcriptome map of cell cycle reveals novel connections between periodic genes and cancer</article-title>. <source>Cell Res</source>., <volume>26</volume>, <fpage>946</fpage>–<lpage>962</lpage>.<pub-id pub-id-type="pmid">27364684</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elosua-Bayes</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>SPOTlight: seeded NMF regression to deconvolute spatial transcriptomics spots with single-cell transcriptomes</article-title>. <source>Nucleic Acids Res</source>., <volume>49</volume>, <fpage>e50</fpage>.<pub-id pub-id-type="pmid">33544846</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fan</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Characterizing transcriptional heterogeneity through pathway and gene set overdispersion analysis</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>241</fpage>–<lpage>244</lpage>.<pub-id pub-id-type="pmid">26780092</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gaudet</surname><given-names>P.</given-names></string-name>, <string-name><surname>Dessimoz</surname><given-names>C.</given-names></string-name></person-group> (<year>2017</year>) <article-title>Gene ontology: pitfalls, biases, and remedies</article-title>. <source>Methods Mol. Biol</source>., <volume>1446</volume>, <fpage>189</fpage>–<lpage>205</lpage>.<pub-id pub-id-type="pmid">27812944</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hao</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Integrated analysis of multimodal single-cell data</article-title>. <source>Cell</source>, <volume>184</volume>, <fpage>3573</fpage>–<lpage>3587. e3529</lpage>.<pub-id pub-id-type="pmid">34062119</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hyvarinen</surname><given-names>A.</given-names></string-name></person-group> (<year>1999</year>) <article-title>Fast and robust fixed-point algorithms for independent component analysis</article-title>. <source>IEEE Trans. Neural Netw</source>., <volume>10</volume>, <fpage>626</fpage>–<lpage>634</lpage>.<pub-id pub-id-type="pmid">18252563</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ireland</surname><given-names>A.S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>MYC drives temporal evolution of small cell lung cancer subtypes by reprogramming neuroendocrine fate</article-title>. <source>Cancer Cell</source>, <volume>38</volume>, <fpage>60</fpage>–<lpage>78.e12</lpage>.<pub-id pub-id-type="pmid">32473656</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ischenko</surname><given-names>I.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>KRAS drives immune evasion in a genetic model of pancreatic cancer</article-title>. <source>Nat. Commun</source>., <volume>12</volume>, <fpage>1482</fpage>.<pub-id pub-id-type="pmid">33674596</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jalili</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Exploring the metabolic heterogeneity of cancers: a benchmark study of context-specific models</article-title>. <source>J. Pers. Med</source>., <volume>11</volume>, <fpage>496</fpage>.<pub-id pub-id-type="pmid">34205912</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanehisa</surname><given-names>M.</given-names></string-name>, <string-name><surname>Goto</surname><given-names>S.</given-names></string-name></person-group> (<year>2000</year>) <article-title>KEGG: Kyoto encyclopedia of genes and genomes</article-title>. <source>Nucleic Acids Res</source>., <volume>28</volume>, <fpage>27</fpage>–<lpage>30</lpage>.<pub-id pub-id-type="pmid">10592173</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Single-cell RNA sequencing demonstrates the molecular and cellular reprogramming of metastatic lung adenocarcinoma</article-title>. <source>Nat. Commun</source>., <volume>11</volume>, <fpage>2285</fpage>.<pub-id pub-id-type="pmid">32385277</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>V.Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Challenges in unsupervised clustering of single-cell RNA-seq data</article-title>. <source>Nat. Rev. Genet</source>., <volume>20</volume>, <fpage>273</fpage>–<lpage>282</lpage>.<pub-id pub-id-type="pmid">30617341</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname><given-names>V.Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>483</fpage>–<lpage>486</lpage>.<pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kubota</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Dedifferentiation of neuroendocrine carcinoma of the uterine cervix in hypoxia</article-title>. <source>Biochem. Biophys. Res. Commun</source>., <volume>524</volume>, <fpage>398</fpage>–<lpage>404</lpage>.<pub-id pub-id-type="pmid">32007268</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>La Manno</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) <article-title>RNA velocity of single cells</article-title>. <source>Nature</source>, <volume>560</volume>, <fpage>494</fpage>–<lpage>498</lpage>.<pub-id pub-id-type="pmid">30089906</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Single-cell multiomics: technologies and data analysis methods</article-title>. <source>Exp. Mol. Med</source>., <volume>52</volume>, <fpage>1428</fpage>–<lpage>1442</lpage>.<pub-id pub-id-type="pmid">32929225</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Reference component analysis of single-cell transcriptomes elucidates cellular heterogeneity in human colorectal tumors</article-title>. <source>Nat. Genet</source>., <volume>49</volume>, <fpage>708</fpage>–<lpage>718</lpage>.<pub-id pub-id-type="pmid">28319088</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>The reciprocal regulation between host tissue and immune cells in pancreatic ductal adenocarcinoma: new insights and therapeutic implications</article-title>. <source>Mol. Cancer</source>, <volume>18</volume>, <fpage>184</fpage>.<pub-id pub-id-type="pmid">31831007</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luchini</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>KRAS wild-type pancreatic ductal adenocarcinoma: molecular pathology and therapeutic opportunities</article-title>. <source>J. Exp. Clin. Cancer Res</source>., <volume>39</volume>, <fpage>227</fpage>.<pub-id pub-id-type="pmid">33115526</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lun</surname><given-names>A.T.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) <article-title>Pooling across cells to normalize single-cell RNA sequencing data with many zero counts</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>75</fpage>.<pub-id pub-id-type="pmid">27122128</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maynard</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Therapy-Induced evolution of human lung cancer revealed by Single-Cell RNA sequencing</article-title>. <source>Cell</source>, <volume>182</volume>, <fpage>1232</fpage>–<lpage>1251.e22</lpage>.<pub-id pub-id-type="pmid">32822576</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McLeay</surname><given-names>R.C.</given-names></string-name>, <string-name><surname>Bailey</surname><given-names>T.L.</given-names></string-name></person-group> (<year>2010</year>) <article-title>Motif enrichment analysis: a unified framework and an evaluation on ChIP data</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>165</fpage>.<pub-id pub-id-type="pmid">20356413</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moncada</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Integrating microarray-based spatial transcriptomics and single-cell RNA-seq reveals tissue architecture in pancreatic ductal adenocarcinomas</article-title>. <source>Nat. Biotechnol</source>., <volume>38</volume>, <fpage>333</fpage>–<lpage>342</lpage>.<pub-id pub-id-type="pmid">31932730</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morrison</surname><given-names>R.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <part-title>Beyond normality: learning sparse probabilistic graphical models in the non-Gaussian setting</part-title>. In: <italic toggle="yes">Advances in Neural Information Processing Systems</italic>, Vol. <volume>30</volume>, pp. <fpage>2356</fpage>–<lpage>2366</lpage>.</mixed-citation>
    </ref>
    <ref id="btac541-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muller-Hubenthal</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) <article-title>Tumour biology: tumour-associated inflammation versus antitumor immunity</article-title>. <source>Anticancer Res</source>., <volume>29</volume>, <fpage>4795</fpage>–<lpage>4805</lpage>.<pub-id pub-id-type="pmid">20032438</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Murtagh</surname><given-names>F.</given-names></string-name>, <string-name><surname>Legendre</surname><given-names>P.</given-names></string-name></person-group> (<year>2014</year>) <article-title>Ward’s hierarchical agglomerative clustering method: which algorithms implement ward’s criterion?</article-title>  <source>J. Classif</source>., <volume>31</volume>, <fpage>274</fpage>–<lpage>295</lpage>.</mixed-citation>
    </ref>
    <ref id="btac541-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parra</surname><given-names>R.G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Reconstructing complex lineage trees from scRNA-seq data using MERLoT</article-title>. <source>Nucleic Acids Res</source>., <volume>47</volume>, <fpage>8961</fpage>–<lpage>8974</lpage>.<pub-id pub-id-type="pmid">31428793</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pasquini</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Automated methods for cell type annotation on scRNA-seq data</article-title>. <source>Comput. Struct. Biotechnol. J</source>., <volume>19</volume>, <fpage>961</fpage>–<lpage>969</lpage>.<pub-id pub-id-type="pmid">33613863</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reimand</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Pathway enrichment analysis and visualization of omics data using g:Profiler, GSEA, Cytoscape and EnrichmentMap</article-title>. <source>Nat. Protoc</source>., <volume>14</volume>, <fpage>482</fpage>–<lpage>517</lpage>.<pub-id pub-id-type="pmid">30664679</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rempala</surname><given-names>G.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) <article-title>Model for comparative analysis of antigen receptor repertoires</article-title>. <source>J. Theor. Biol</source>., <volume>269</volume>, <fpage>1</fpage>–<lpage>15</lpage>.<pub-id pub-id-type="pmid">20955715</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reyes</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>An immune-cell signature of bacterial sepsis</article-title>. <source>Nat. Med</source>., <volume>26</volume>, <fpage>333</fpage>–<lpage>340</lpage>.<pub-id pub-id-type="pmid">32066974</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saxena</surname><given-names>V.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2006</year>) <article-title>Absolute enrichment: gene set enrichment analysis for homeostatic systems</article-title>. <source>Nucleic Acids Res</source>., <volume>34</volume>, <fpage>e151</fpage>.<pub-id pub-id-type="pmid">17130162</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B48">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Schubert</surname><given-names>E.</given-names></string-name>, <string-name><surname>Rousseeuw</surname><given-names>P.J.</given-names></string-name></person-group> (<year>2019</year>) Faster k-medoids clustering: improving the PAM, CLARA, and CLARANS algorithms. In: <italic toggle="yes">International Conference on Similarity Search and Applications 2019</italic>, Vol. 11807, pp. <fpage>171</fpage>–<lpage>187</lpage>.</mixed-citation>
    </ref>
    <ref id="btac541-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schwendenwein</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2021</year>) <article-title>Molecular profiles of small cell lung cancer subtypes: therapeutic implications</article-title>. <source>Mol. Ther. Oncolytics</source>, <volume>20</volume>, <fpage>470</fpage>–<lpage>483</lpage>.<pub-id pub-id-type="pmid">33718595</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shao</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>scCATCH: automatic annotation on cell types of clusters from Single-Cell RNA sequencing data</article-title>. <source>iScience</source>, <volume>23</volume>, <fpage>100882</fpage>.<pub-id pub-id-type="pmid">32062421</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sharma</surname><given-names>N.K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Lipid metabolism impairment in patients with sepsis secondary to hospital acquired pneumonia, a proteomic analysis</article-title>. <source>Clin. Proteomics</source>, <volume>16</volume>, <fpage>29</fpage>.<pub-id pub-id-type="pmid">31341447</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stewart</surname><given-names>C.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>Single-cell analyses reveal increased intratumoral heterogeneity after the onset of therapy resistance in small-cell lung cancer</article-title>. <source>Nat. Cancer</source>, <volume>1</volume>, <fpage>423</fpage>–<lpage>436</lpage>.<pub-id pub-id-type="pmid">33521652</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Subramanian</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2005</year>) <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>102</volume>, <fpage>15545</fpage>–<lpage>15550</lpage>.<pub-id pub-id-type="pmid">16199517</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trapnell</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>381</fpage>–<lpage>386</lpage>.<pub-id pub-id-type="pmid">24658644</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Villani</surname><given-names>A.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) <article-title>Single-cell RNA-seq reveals new types of human blood dendritic cells, monocytes, and progenitors</article-title>. <source>Science</source>, <volume>356</volume>, <fpage>eaah4573</fpage>.<pub-id pub-id-type="pmid">28428369</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) <article-title>clusterProfiler: an R package for comparing biological themes among gene clusters</article-title>. <source>OMICS</source>, <volume>16</volume>, <fpage>284</fpage>–<lpage>287</lpage>.<pub-id pub-id-type="pmid">22455463</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) <article-title>DOSE: an R/bioconductor package for disease ontology semantic and enrichment analysis</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>608</fpage>–<lpage>609</lpage>.<pub-id pub-id-type="pmid">25677125</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>A.W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>Probabilistic cell-type assignment of single-cell RNA-seq for tumor microenvironment profiling</article-title>. <source>Nat. Methods</source>, <volume>16</volume>, <fpage>1007</fpage>–<lpage>1015</lpage>.<pub-id pub-id-type="pmid">31501550</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) <article-title>PIRD: pan immune repertoire database</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>897</fpage>–<lpage>903</lpage>.<pub-id pub-id-type="pmid">31373607</pub-id></mixed-citation>
    </ref>
    <ref id="btac541-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) <article-title>CellMarker: a manually curated resource of cell markers in human and mouse</article-title>. <source>Nucleic Acids Res</source>., <volume>47</volume>, <fpage>D721</fpage>–<lpage>D728</lpage>.<pub-id pub-id-type="pmid">30289549</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
