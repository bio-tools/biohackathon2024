<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10026520</article-id>
    <article-id pub-id-type="publisher-id">5223</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05223-1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Snapshot: a package for clustering and visualizing epigenetic history during cell differentiation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Xiang</surname>
          <given-names>Guanjue</given-names>
        </name>
        <address>
          <email>guanjuexiang@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Giardine</surname>
          <given-names>Belinda</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>An</surname>
          <given-names>Lin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sun</surname>
          <given-names>Chen</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Keller</surname>
          <given-names>Cheryl A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Heuston</surname>
          <given-names>Elisabeth F.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Anderson</surname>
          <given-names>Stacie M.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kirby</surname>
          <given-names>Martha</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bodine</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Yu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4084-7516</contrib-id>
        <name>
          <surname>Hardison</surname>
          <given-names>Ross C.</given-names>
        </name>
        <address>
          <email>rch8@psu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.29857.31</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 4281</institution-id><institution>The Bioinformatics and Genomics Program, </institution><institution>Huck Institutes of the Life Sciences, The Pennsylvania State University, </institution></institution-wrap>University Park, PA USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.29857.31</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 4281</institution-id><institution>Department of Biochemistry and Molecular Biology, </institution><institution>The Pennsylvania State University, </institution></institution-wrap>University Park, PA USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.29857.31</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 4281</institution-id><institution>Department of Computer Science and Engineering, </institution><institution>The Pennsylvania State University, </institution></institution-wrap>University Park, PA USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.280128.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2233 9230</institution-id><institution>NHGRI Hematopoiesis Section, GMBB, </institution></institution-wrap>Bethesda, MD USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.280128.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2233 9230</institution-id><institution>NHGRI Flow Cytometry Core, </institution></institution-wrap>Bethesda, MD USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.29857.31</institution-id><institution-id institution-id-type="ISNI">0000 0001 2097 4281</institution-id><institution>Department of Statistics, </institution><institution>The Pennsylvania State University, </institution></institution-wrap>University Park, PA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>20</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>102</elocation-id>
    <history>
      <date date-type="received">
        <day>11</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>7</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Epigenetic modification of chromatin plays a pivotal role in regulating gene expression during cell differentiation. The scale and complexity of epigenetic data pose significant challenges for biologists to identify the regulatory events controlling cell differentiation.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">To reduce the complexity, we developed a package, called Snapshot, for clustering and visualizing candidate cis-regulatory elements (cCREs) based on their epigenetic signals during cell differentiation. This package first introduces a binarized indexing strategy for clustering the cCREs. It then provides a series of easily interpretable figures for visualizing the signal and epigenetic state patterns of the cCREs clusters during the cell differentiation. It can also use different hierarchies of cell types to highlight the epigenetic history specific to any particular cell lineage. We demonstrate the utility of Snapshot using data from a consortium project for <bold>V</bold>al<bold>I</bold>dated <bold>S</bold>ystematic <bold>I</bold>ntegrati<bold>ON</bold> (VISION) of epigenomic data in hematopoiesis.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p id="Par3">The package Snapshot can identify all distinct clusters of genomic locations with unique epigenetic signal patterns during cell differentiation. It outperforms other methods in terms of interpreting and reproducing the identified cCREs clusters. The package of Snapshot is available at GitHub: <ext-link ext-link-type="uri" xlink:href="https://github.com/guanjue/Snapshot">https://github.com/guanjue/Snapshot</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>cCRE indexing</kwd>
      <kwd>cCRE Clustering and Visualization</kwd>
      <kwd>Epigenetic state visualization</kwd>
      <kwd>Cell differentiation</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Institutes of Health</institution>
        </funding-source>
        <award-id>GM121613</award-id>
        <award-id>DK106766</award-id>
        <principal-award-recipient>
          <name>
            <surname>Hardison</surname>
            <given-names>Ross C.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000051</institution-id>
            <institution>National Human Genome Research Institute</institution>
          </institution-wrap>
        </funding-source>
        <award-id>Internal funds</award-id>
        <principal-award-recipient>
          <name>
            <surname>Bodine</surname>
            <given-names>David</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par21">The gene regulation community has generated thousands of epigenomic datasets, and integration of these data has become a powerful step in facilitating studies to better understand the biological meaning of combinations of epigenetic events [<xref ref-type="bibr" rid="CR2">2</xref>–<xref ref-type="bibr" rid="CR7">7</xref>]. Experiments such as ATAC-seq and DNase-seq, which measure the accessibility of genomic regions in chromatin [<xref ref-type="bibr" rid="CR8">8</xref>–<xref ref-type="bibr" rid="CR10">10</xref>], have been widely used to identify candidate cis-regulatory elements (cCREs). The cCREs are often defined as having a strong peak-like signals for ATAC-seq or DNase-seq in one or multiple cell types, indicating these DNA segments are more exposed in chromatin. This greater accessibility of the DNA may result from nucleosome destabilization and transcription factor binding, and hence these DNA segments may be inferred to have potential function on regulating proximal and/or distal genes [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR10">10</xref>]. Additional information about the potential activity of cCREs in a cell type can come from data on histone modifications and other epigenetic features in the cCREs and surrounding chromatin. This information can be concisely summarized by learning the unique combinations of epigenetic features that frequently occur in chromatin, which are referred to as epigenetic states [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR13">13</xref>]. Annotating cCREs by their accessibility and/or their epigenetic states across a series of cell types can enhance our understanding of the roles they play in gene regulation [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR7">7</xref>].</p>
    <p id="Par22">One common analysis of cCREs compares the intensity of specific epigenomic signals between two cell types. The cCREs that exhibit differential patterns can provide insights into gene regulation mechanisms, such as identifying cell type-specific transcription factors operating at the cCREs [<xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR15">15</xref>]. As more sets of epigenomic data are generated, it has become common to cluster and analyze patterns of epigenomic signal at cCREs across multiple cell types. For example, clustering cCREs based on their DNase-seq signal across multiple cell types can reveal both cell type-specific actuation of cCREs and cCREs with more complex functions within different groups of cell types [<xref ref-type="bibr" rid="CR10">10</xref>]. Furthermore, methods have been developed to infer the epigenetic states at cCREs more accurately by borrowing information across multiple cell types [<xref ref-type="bibr" rid="CR11">11</xref>] or by leveraging information from multiple cell types to correct potential false differential epigenomic calls [<xref ref-type="bibr" rid="CR16">16</xref>].</p>
    <p id="Par23">Clustering candidate cCREs based on their presence or absence or based on signal intensity across multiple cell types is a commonly used approach to uncover activity patterns of cCREs, and hence their potential regulatory function, across various cell types [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. For example, the distance-based methods such as K-means and hierarchical clustering can group the cCREs into different categories based on their chromatin accessibility signals across multiple cell types [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR21">21</xref>]. However, these methods implicitly assume that the signals of cCREs in different cell types are independent from each other, which is problematic because some cell types are related by the process of cell differentiation. To account for the association of cCRE signals, some model-based methods treat the signals of cCREs across multiple cell types as multivariate observations [<xref ref-type="bibr" rid="CR22">22</xref>]. The covariance of the multivariate observations can be used to capture the signal associations. Some methods treat the cell types along a cell differentiation lineage as a time series and use Gaussian process mixture model to cluster cCREs [<xref ref-type="bibr" rid="CR23">23</xref>]. Several methods further use either infinite Gaussian mixture models or Dirichlet processes to automatically determine the number of the clusters [<xref ref-type="bibr" rid="CR24">24</xref>–<xref ref-type="bibr" rid="CR26">26</xref>]. However, these model-based methods tend to create large clusters of cCREs, while smaller but unique cCRE clusters are often lost by being merged into the larger ones. Furthermore, these methods do not consider any existing biological knowledge about the cell type relationships. As a result, interpreting the biological meaning of the identified cCRE clusters can be difficult and irreproducible, especially when the number of cell types is large. In addition, for some of methods, such as the method using Gaussian process mixture model, the computational costs can be high for large datasets [<xref ref-type="bibr" rid="CR23">23</xref>]. These clustering methods find informative groups of discrete genomic elements, such as cCREs, that are not contiguous in the genome. Such clustering results can be complemented by different unsupervised methods examining contiguous epigenomic signals, such as ChromHMM running in the stacked modeling mode [<xref ref-type="bibr" rid="CR27">27</xref>]. The latter approach can find epigenetic states that are restricted to certain cell types as well as states found in all examined cells, which could correspond to some of the groups of cCREs identified by clustering methods.</p>
    <p id="Par24">Here we present a package, called Snapshot, for clustering and visualizing the cCREs and their epigenetic states during cell differentiation. The package uses a binarized indexing strategy for grouping the cCREs into different clusters (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). The strategy will identify all binarized cCRE clusters in the data, and it further merges them into interpretable groups. It automatically determines the number of clusters to analyze. Furthermore, the clusters and the corresponding dominant epigenetic states in each of the cell types can be visualized by incorporating a user provided cell differentiation tree, and thus can highlight the epigenetic history specific to any particular cell lineage. In this paper, we used the data generated by the VISION project [<xref ref-type="bibr" rid="CR5">5</xref>, <xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref>] to demonstrate the improved performance of Snapshot over existing methods in terms of interpretability, comprehensiveness, and robustness of understanding the biological functions of the hematopoietic cCRE clusters.<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of Snapshot. <bold>A</bold> Step1: cCRE indexing. A binarized index is created for each cCRE based on the presence/absence pattern of the cCRE across all cell types. <bold>B</bold> Step2: cCRE clustering and Step3: filtering. The cCREs with the same index were clustered into an Index-Set (IS). For example, the cCREs with 0_0_0_1_0 index were clustered into the IS in blue dash box. The cCREs in the less abundant ISs, highlighted by a black dash box, were filtered. <bold>C</bold> Step4: cCREs rescuing. The cCREs in the filtered ISs were re-classified as members of the abundant ISs based on their posterior probabilities of multivariate Gaussian distributions (using a Quadratic Discriminant Analysis (QDA) model) of the abundant ISs. The heatmaps in panels B and C were generated by deeptools [<xref ref-type="bibr" rid="CR50">50</xref>]. <bold>D</bold> The mean signal matrix for all 68 abundant Index-Sets and an additional Index-Set, which included all remaining cCREs not assigned to an abundant IS. <bold>E</bold> The cCRE mean signal heatmap for the 19 Meta-Index-Sets (Meta-ISs) merged from 69 ISs. The number of Meta-ISs are automatically determined by AIC. <bold>F</bold> The bar plot for the number of cCRE within each Meta-ISs in log scale. <bold>G</bold> The frequency at which the signal pattern of a of Meta-IS was observed in 100 rounds of K-means clustering</p></caption><graphic xlink:href="12859_2023_5223_Fig1_HTML" id="MO1"/></fig></p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <sec id="Sec3">
      <title>Description of the snapshot <italic>package</italic></title>
      <p id="Par25">This sub-section presents an overview of the Snapshot package, and subsequent sub-sections explain specifics of individual steps and components. The first step of Snapshot is to cluster the cCREs across cell types, e.g. across hematopoietic cell differentiation for the datasets examined here. To capture all distinct and abundant clusters, we first use a binarized index to encode the signals of each cCRE across multiple cell types (Step1: cCRE indexing, Fig. <xref rid="Fig1" ref-type="fig">1</xref>A). All the cCREs with the same index are assigned to the same initial cluster (Step2: cCRE clustering, Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). We name each cluster an Index-Set (IS), and the size of the IS is defined as the number of cCREs in it. The first two steps can produce a large number of ISs that only have a few cCREs (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). We hypothesize that those ISs are minor variations of the abundant ISs or spurious ISs resulting from peak calling errors, and thus the cCREs within them should be re-classified into the abundant ISs. Thus, we introduce a filtering step followed by a rescuing step to achieve those goals. We first filter (temporarily) any ISs that are smaller than a size threshold determined automatically (or specified by the user) (Step3: IS filtering, Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). We then fit the signals of the cCREs in each of the remaining, abundant ISs to a multivariate Gaussian distribution (MVN). Then, the fitted MVNs are used as prior distributions to re-classify the cCREs inside the filtered ISs, which adds many of cCREs that were in small initial ISs to larger ISs (Step4: cCRE rescuing, Fig. <xref rid="Fig1" ref-type="fig">1</xref>C). All the cCREs that have a posterior probability less than 0.5 were put into one set as a null cluster. This filtering procedure followed by rescue can not only greatly reduce the number of ISs, but it also can correct the potential errors in peak calling results by replacing the original indices of some cCREs by the indices of their newly assigned ISs. The ISs that result from the filtering and rescue are one output of the Snapshot package, e.g. the package placed the 83,701 human blood cell cCREs into 69 ISs (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D). For some analyses, a smaller number of clusters may be desirable, and thus we added a merging step, using hierarchical clustering of the mean signal vectors of ISs, to further group the ISs into Meta-Index Sets (Meta-ISs), which comprise an additional output from the Snapshot package. For example, the 69 ISs for the VISION cCREs were combined into 19 Meta-ISs (Fig. <xref rid="Fig1" ref-type="fig">1</xref>E). The Snapshot package also generates a set of figures to visualize the average cCRE signals and the abundant epigenetic states across multiple cell types during cell differentiation for each IS and each Meta-IS. These visualizations are shown in subsequent sub-sections.<fig id="Fig2"><label>Fig. 2</label><caption><p>Distribution of cCRE count per IS before <bold>A</bold> and after <bold>B</bold> rescuing cCREs. In these histograms, the number of ISs on the y-axis is shown on a log (base 10) scale, and the number of cCREs per IS is shown on a log (base 2) scale. The red dashed lines indicate the cCRE threshold (173) for abundant IS, which is determined based on FDR adjusted p-value (&lt; 1e-2) calculated using a negative binomial model for the count of cCREs in each IS</p></caption><graphic xlink:href="12859_2023_5223_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title><italic>cCREs</italic> indexing and <italic>cCRE</italic> clustering</title>
      <p id="Par26">The motivation for developing Snapshot arose from our observation that conventional clustering methods did not bring out important but small cCRE clusters. We reasoned that an indexing strategy would be guaranteed to capture all distinct clusters of cCREs. Our goal is to identify clusters of cCREs such that each represents a unique pattern of presence and absence calls of cCREs, which in turn can be inferred to represent a common potential gene regulatory function. For the first step in Snapshot, we use the binarized presence/absence status of chromatin accessibility peak calls across all cell types to create a cCRE index to represent the unique pattern. The number of bits in the index equals the number of cell types. The order of bits is the order of cell types derived from a user-provided cell differentiation tree. The order of the bits can be shifted by the user to focus on different aspects of the series of cell types. The indices readily group the cCREs into distinct clusters by assigning the ones with the same index to the same cluster. We define each of the clusters as an index-set (IS).</p>
    </sec>
    <sec id="Sec5">
      <title>IS filtering</title>
      <p id="Par27">Simply clustering on the indices can generate such a large number of ISs that the results are difficult to interpret biologically. We conduct a filtering step to restrict the ISs to those whose size exceeds an abundance threshold (Fig. <xref rid="Fig1" ref-type="fig">1</xref>B). The next sub-section describes a rescue procedure to re-assign the filtered cCREs to closely matching, larger ISs. In a system with N cell types, there can be 2^N possible ISs. In practice, we observed a large number of ISs, but most of them contain only a few cCREs (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). The filtering step in Snapshot temporarily removes all ISs whose size is smaller than an abundance threshold, which can be provided by the user or determined automatically in Snapshot by assuming a negative binomial (NB) background. To do so, we first fit a NB background model based on the sizes of initial ISs. When fitting the NB model, the most abundant ISs (top 5%) were excluded to avoid bias from outliers. We then compute the FDR adjusted p-values for the sizes of all ISs based on the NB background model. The size corresponding to an adjusted p-value of 0.01 was used as the abundance threshold. The clustering results were robust to changes in these thresholds; specifically, similar results were obtained after varying the percentage of most abundant ISs filtered from 2.5% to 10% and varying the adjusted p-value between 0.001 and 0.2.</p>
    </sec>
    <sec id="Sec6">
      <title>cCRE rescuing</title>
      <p id="Par28">The cCREs in the filtered, smaller sized ISs were then rescued by adding them back to the closest matching, larger sized ISs. These smaller sized ISs may consist of cCREs that have spurious peak calls resulting from noise in the chromatin accessibility data in one or a few cell types. Thus, we hypothesize that many of the smaller sized ISs are minor variations of the larger ISs, separating from the larger ISs because of cCREs with spurious peak calls. Even so, we can still assume that the peak calling results for these cCREs are accurate in most cell types, and matching the cCREs in the filtered ISs could be used to correct erroneous peak calling results in other cell types. Therefore, we developed a rescuing strategy to re-classify the filtered cCREs to one of the abundant ISs. To do so, we assume the epigenetic signals of cCREs across cell types in each IS follow one multivariate Gaussian distribution (MVN). Inside the filtered ISs, the cCREs’ posterior probabilities for these MVNs can be calculated to re-classify them into one of the abundant ISs (Fig. <xref rid="Fig1" ref-type="fig">1</xref>C). Specifically, we use all the abundant ISs remaining after filtering to train the Quadratic Discriminant Analysis (QDA) model [<xref ref-type="bibr" rid="CR31">31</xref>]. Then, we use the trained model to re-classify each filtered cCREs to an abundant IS based on posterior probabilities across all abundant ISs. Let <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{x}$$\end{document}</tex-math><mml:math id="M2"><mml:mi mathvariant="normal">x</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5223_Article_IEq1.gif"/></alternatives></inline-formula> denote the binary signal vector of each cCRE across cell types. The posterior probabilities <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{P}}_{i}\left(\mathrm{x}\right)$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:msub><mml:mi mathvariant="normal">P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mi mathvariant="normal">x</mml:mi></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5223_Article_IEq2.gif"/></alternatives></inline-formula> of a cCRE for the i-th IS is calculated by:<disp-formula id="Equa"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$P_{i} (x) = - \frac{1}{2}log\left|\sum_{{\text{i}}} \right| - \frac{1}{2}(x -\upmu _{i} ){^{\prime}}\sum_{i}^{( - 1)} (x -\upmu _{i} ) + logP0_{{\text{i}}} ,$$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mfenced close="|" open="|"><mml:munder><mml:mo>∑</mml:mo><mml:mtext>i</mml:mtext></mml:munder></mml:mfenced><mml:mo>-</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msup><mml:mrow/><mml:mo>′</mml:mo></mml:msup><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">μ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mi>P</mml:mi><mml:msub><mml:mn>0</mml:mn><mml:mtext>i</mml:mtext></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5223_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq3"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\upmu }_{\mathrm{i}}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi mathvariant="normal">μ</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5223_Article_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\Sigma }_{\mathrm{i}}$$\end{document}</tex-math><mml:math id="M10"><mml:msub><mml:mi mathvariant="normal">Σ</mml:mi><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5223_Article_IEq4.gif"/></alternatives></inline-formula> denotes the mean vector and the covariance matrix of the i-th IS, and <inline-formula id="IEq5"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{P}0}_{\mathrm{i}}$$\end{document}</tex-math><mml:math id="M12"><mml:msub><mml:mrow><mml:mi mathvariant="normal">P</mml:mi><mml:mn>0</mml:mn></mml:mrow><mml:mi mathvariant="normal">i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5223_Article_IEq5.gif"/></alternatives></inline-formula> denotes the proportion of cCREs in the i-th IS. The model will assign the cCRE to the IS with the highest posterior probabilities. The cCREs with the highest posterior probabilities less than 0.5 are assigned into a null class. Thus, all cCREs in the filtered ISs are re-assigned to either an abundant IS or the null IS. For each rescued cCRE, the initial index is replaced by the index of the abundant IS to which they were re-classified. This replacement can help correct any erroneous peak calling results for the cCRE in some cell types.</p>
    </sec>
    <sec id="Sec7">
      <title>Merge ISs into <italic>meta-ISs</italic></title>
      <p id="Par29">For some applications, a smaller number of groups of cCREs could improve interpretability, so we implemented a second round of clustering to group the ISs with a similar mean signal vector into Meta-Index-Sets (Meta-IS). Here, the rationale is that the Snapshot index-based strategy can identify all cluster patterns, including those that are rare but important, but some of the ISs showed similar patterns (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D). The second round of clustering utilizes the mean signal vector of each IS as the basis for clustering, which removes any dependency on the number of cCREs within each IS. For example, the relatively small ISs with erythroid cCREs are retained as Meta-IS 8 (Fig. <xref rid="Fig1" ref-type="fig">1</xref>F and G). This approach reduces the likelihood of missing rare but important cluster patterns, whereas cluster center initialization may miss these patterns due to their rarity. The merging into Meta-ISs uses the hclust R function followed by cutree R function. The number of clusters in the cutree function is determined based on the Akaike information criterion (AIC) [<xref ref-type="bibr" rid="CR32">32</xref>].</p>
    </sec>
    <sec id="Sec8">
      <title>Optional data normalization within <italic>snapshot</italic></title>
      <p id="Par30">The Snapshot package expects normalized input signals to reduce the influence of technical variations in signal scaling or signal-to-noise ratio on the clustering. However, many public datasets are not normalized, which can complicate the clustering and interpretation of results. To address this issue, we included several optional internal normalization methods, including scaling, quantile normalization, and S3norm [<xref ref-type="bibr" rid="CR33">33</xref>]. For S3norm, Snapshot can first identify the IS containing cCREs that are common peaks across all cell types (common-peak-IS) and the IS containing cCREs that are in common background regions across all cell types (common-background-IS). It then adjusts the signal-to-noise ratio by scaling each dataset to an average reference signal-to-noise based on the mean signal difference between the common-peak-IS and common-background-IS.</p>
    </sec>
    <sec id="Sec9">
      <title>Assigning epigenetic states to cCREs, ISs, and meta-ISs</title>
      <p id="Par31">Many of the visualizations from the Snapshot package utilize the annotations of cCREs by their epigenetic states. Such annotations are often used to infer potential functions of each cCRE [<xref ref-type="bibr" rid="CR5">5</xref>]. In Snapshot, we use bedtools [<xref ref-type="bibr" rid="CR34">34</xref>] to assign an epigenetic state to each cCRE in each cell type. Since each 200 bp bin was annotated with one epigenetic state in each cell type, one cCRE that covers more than 200 bp genomic regions can simultaneously intersect with multiple 200 bp bins with different epigenetic states. For many downstream analyses, it is desirable to assign a single, dominant epigenetic state to each cCRE in each cell type. We systematically assign the single state using the following criteria. First, if a cCRE intersects with a non-quiescent state, it will not be assigned with quiescent state, i.e. one with undetectable signal for all epigenetic features examined. Second, when a cCRE intersects with multiple non-quiescent states, the state that covers the largest proportion of the cCRE region is assigned to the cCRE. Third, when a cCRE intersects with multiple non-quiescent states that cover the same proportion of the cCRE region, the state with a midpoint closest to the cCRE midpoint will be assigned to the cCRE. Fourth, when a cCRE intersect with multiple non-quiescent states that cover same proportion of the cCRE region and their midpoints to the cCRE midpoints are the same, the state that covers more base-pairs on the cCRE will be assigned to the cCRE. In practice, we have found that those four rules sufficed to assign a single epigenetic state each cCRE in a large collection, such as those in the VISION project for blood cells [<xref ref-type="bibr" rid="CR5">5</xref>]. After assigning epigenetic states to all cCREs across all cell types, the Snapshot algorithm uses the most prevalent epigenetic states (those that cumulatively covering more than 50% of the cCREs in the IS or Meta-IS) as the representative state for each cell type in each IS or Meta-IS. One Snapshot output is a cell differentiation tree for each IS or Meta-IS, with each cell type colored by a summary of the representative epigenetic states. The color assigned to each cell type is determined as the weighted average of these representative states, with the weight being the proportion of cCREs in the IS or Meta-IS that are assigned to a representative state.</p>
    </sec>
    <sec id="Sec10">
      <title>Snapshot visualization module</title>
      <p id="Par32">Snapshot provides a set of visualizations to show various aspects of the ISs and their epigenetic features. One output is a collection of maps showing the binary patterns (e.g., Fig. <xref rid="Fig3" ref-type="fig">3</xref>A), a heatmap for the average ATAC-seq/DNase-seq signals (e.g., Fig. <xref rid="Fig1" ref-type="fig">1</xref>D and E), and a heatmap for the representative functional epigenetic state in each of the cell types in each of the ISs. A second output contains cell differentiation trees colored by either the average ATAC-seq/DNase-seq signals or the representative functional epigenetic states for each of the ISs. A third visualization provides bar-plots for the proportions of all epigenetic states in each of the cell type for each of the ISs. A fourth visualization has violin-plots for the ATAC-seq/DNase-seq signal distributions in each of the cell type for each of the ISs.<fig id="Fig3"><label>Fig. 3</label><caption><p>Comparison between the Snapshot IS clustering method and other existing clustering methods. <bold>A</bold> The binary map of the presence (black) or absence (white) pattern of cCREs across 13 cell types. Each row represents a cCRE, which has been ordered by the indices identified by Snapshot. The binary maps or results from clustering by K-means, Mclust, and the Hierarchical method are shown in panel <bold>B-D</bold>. <bold>E</bold> The Shannon Entropy (SE) of the binary map. The y-axis is the SE value. The x-axis represents the number of cell types used to calculate the SE. The 3 figures are shown the result using different settings for the height of scanning window (5, 10, or 50 adjacent cCRE at each step of scanning) in the SE calculation</p></caption><graphic xlink:href="12859_2023_5223_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec11">
      <title>Inputs for <italic>snapshot</italic></title>
      <p id="Par33">Snapshot takes the following files as input: (1) peak calling results of epigenetic features in bed format [<xref ref-type="bibr" rid="CR35">35</xref>]; (2) signal strength of the epigenetic feature across the whole genome in bigWig format; (3) functional epigenetic state labels in bigBed format; (4) a list of colors for each functional epigenetic state; and (5) a pairwise cell type relationship in cell differentiation tree. In addition, there is an option to provide a Master peak list of cCREs or other epigenetic features. Genome-wide data on any epigenetic feature (epigenomic data) can be used as input to Snapshot, as long as the epigenomic datasets have peak calls and signal tracks. The epigenetic features include DNase-seq, ATAC-seq, ChIP-seq for histone modifications and transcription factors, and DNA methylation. Furthermore, transcriptomic data can be used as inputs to study gene expression patterns across cell types.</p>
    </sec>
    <sec id="Sec12">
      <title>Evaluating interpretability of clustering results</title>
      <p id="Par34">The purpose of unsupervised clustering is to identify the de novo patterns in the data in an unbiased manner. Due to the high complexity of epigenetic signals across multiple cell types, the utility of the results is related to the interpretability of the de novo patterns in the clustering results. To quantify the interpretability of various clustering results, we employed the Shannon Entropy (SE) [<xref ref-type="bibr" rid="CR36">36</xref>] as a metric. Our reasoning is that a more random clustering result is more difficult to interpret as it is less clear how the data points are grouped together. Conversely, if a user can easily understand the formation of each cluster, such as through the identification of active or inactive patterns in a specific group of related cell types, we believe the clustering result can be more easily interpreted and serve as a foundation for generating new ideas. Following this rationale, we used the SE to estimate the randomness of the clustering results obtained from various methods. A lower SE indicates that the clustering result is less random and therefore more likely to be interpretable. Thus, the SE provides a metric to quantitatively compare the interpretability of different clustering methods.</p>
      <p id="Par35">In the specific procedure employed here (Fig. <xref rid="Fig4" ref-type="fig">4</xref>), the first step is to establish a 2-dimensional (2D) window for scanning and extracting local patterns in a binary index map. This window has a fixed height of N adjacent cCREs and a width of M cell types, which define the local region for each scanning step. The second step slides the 2D window one cCRE at a time to scan to binary index map from top to bottom. The sliding window works like the convolutional layer in convolutional neural network [<xref ref-type="bibr" rid="CR37">37</xref>]. At each step, a N-by-M binary pattern is extracted. In the third step, we calculate the SE using the count of each unique N-by-M binary pattern generated from the scanning process. We calculate the probability of each unique N-by-M binary pattern by dividing the number of its occurrences by the total number of scanning steps. This probability was used as the <inline-formula id="IEq6"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathrm{P}}_{i}$$\end{document}</tex-math><mml:math id="M14"><mml:msub><mml:mi mathvariant="normal">P</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5223_Article_IEq6.gif"/></alternatives></inline-formula> for the following SE formula:<disp-formula id="Equb"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\text{SE}} = - \mathop \sum \limits_{{\text{i}}} {\text{P}}_{{\text{i}}} \ln {\text{P}}_{{\text{i}}} ,$$\end{document}</tex-math><mml:math id="M16" display="block"><mml:mrow><mml:mtext>SE</mml:mtext><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:munder><mml:mo movablelimits="false">∑</mml:mo><mml:mtext>i</mml:mtext></mml:munder><mml:msub><mml:mtext>P</mml:mtext><mml:mtext>i</mml:mtext></mml:msub><mml:mo>ln</mml:mo><mml:msub><mml:mtext>P</mml:mtext><mml:mtext>i</mml:mtext></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5223_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>where i denotes the i-th unique N-by-M binary pattern. We further calculate the SE for larger local regions by increasing the number of cell types (M cell types, where M ranges from 2 to 13) in the sliding window. This allows us to evaluate the interpretability of each clustering method when focusing on different subsets of cell types in the results.<fig id="Fig4"><label>Fig. 4</label><caption><p>Illustration of the process for using Shannon Entropy (SE) to assess the interpretability of various clustering results. Panel <bold>A</bold> outlines the three key steps for the SE calculation. <bold>B</bold> The comparison of SE values obtained from Snapshot and other clustering methods, using different N-adjacent cCREs scanning windows for SE calculation, including comparisons with fewer clusters (K = 19)</p></caption><graphic xlink:href="12859_2023_5223_Fig4_HTML" id="MO4"/></fig></p>
    </sec>
    <sec id="Sec13">
      <title>Evaluating performance of K-means clustering in identifying rare clusters</title>
      <p id="Par36">To evaluate the performance of the K-means clustering method in identifying rare cCRE clusters (Fig. <xref rid="Fig1" ref-type="fig">1</xref>G), we performed 100 rounds of K-means (K = 19) clustering on the same data matrix with different random seeds. For each round, we calculated the cosine distance between the mean signal vectors of all K-means clusters and the mean signal vectors of all Snapshot Meta-IS clusters. If at least one K-means cluster was closest to a Meta-IS, we add one to the number of times the Meta-IS appearing in the 100 rounds of K-means clustering.</p>
    </sec>
    <sec id="Sec14">
      <title>Preparing a master peak list across multiple cell type</title>
      <p id="Par37">In the Snapshot package, users have the option to either provide their own master peak list for analysis or utilize Snapshot's built-in function to generate a master peak list from the input peak bed files. In the latter case, Snapshot will concatenate the peaks in all cell types into one peak file, and then merge those with at least 1 bp of overlap, using the “bedtools merge -d 0” command, into a master peak list for downstream analysis. This “pooling and merging” strategy can potentially create broader peaks that do not accurately reflect the true positions of epigenetic modifications, particularly when many cell types with strong signals are present. Therefore, we recommend the use of master cCRE lists generated by data consortia project such as ENCODE [<xref ref-type="bibr" rid="CR6">6</xref>], or generation of a master peak list by using peak calling methods that are designed to handle datasets across multiple cell types, such as S3V2-IDEAS package’s Intensity State mode [<xref ref-type="bibr" rid="CR38">38</xref>]. In this study, we used a cCRE list generated by the S3V2-IDEAS package’s Intensity State mode with default settings.</p>
    </sec>
    <sec id="Sec15">
      <title>Determining the number of clusters for different clustering methods</title>
      <p id="Par38">For K-means, Mclust, and hierarchical clustering followed by branch trimming using “cutree” function, we set the number of clusters (K) equal to 69. This number matches the number of clusters from Snapshot, which was automatically determined by the distribution of the number of cCREs per IS.</p>
    </sec>
    <sec id="Sec16">
      <title>Evaluating reproducibility of clustering results by <italic>adjusted random index</italic></title>
      <p id="Par39">To evaluate the reproducibility of the clustering results, we repeatedly clustered the same data after adding random noise 5 times for each clustering method, using different random noise each time. We computed the random noise as a set of uniformly distributed random numbers ranging from -0.1 to 0.1. We then calculated the pairwise adjusted random index (ARI) of the 5 clustering results [<xref ref-type="bibr" rid="CR39">39</xref>, <xref ref-type="bibr" rid="CR40">40</xref>]. The ARI is a widely used measure of the consistency between two sets of clustering results. When ARI equals 1, it means two sets of clustering results are exactly the same. When ARI is close to 0, it means two sets of clustering results are equivalent to two sets of randomly ordered labels. To reduce the computational time, we perform this analysis in randomly selected subsets of row from the original data matrix for Hclust and Mclust analysis.</p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Results</title>
    <sec id="Sec18">
      <title>Clustering and visualizing <italic>cCREs</italic> in the <italic>hematopoietic system</italic></title>
      <p id="Par40">We developed the Snapshot package to help find and analyze informative groups of cCREs in blood cells, using resources from the VISION project [<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref>, <xref ref-type="bibr" rid="CR41">41</xref>]. In this report, we use a set of cCREs identified in human blood cell types [<xref ref-type="bibr" rid="CR42">42</xref>]. We first called peaks on the chromatin accessibility data in 13 hematopoietic primary cell types (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D). Then, we downloaded from the VISION project website [<xref ref-type="bibr" rid="CR43">43</xref>] the list of 200,342 human hematopoietic cCREs, which were determined on a larger number of cell types and cell lines. The subset of 83,701 cCREs that intersect with at least one peak in these 13 hematopoietic cell types was used for analysis in Snapshot.</p>
      <p id="Par41">We treat each of the 83,701 genomic locations as a cCRE. To find clusters of cCREs, each cCRE is labeled with a 13-digit binarized index, in which each digit corresponds to the presence (1) or absence (0) of a peak call for that cCRE in each of the 13 hematopoietic cell types (step 1, Fig. <xref rid="Fig1" ref-type="fig">1</xref>A). Grouping cCREs by their indices produced 1,806 ISs, with each IS containing cCREs with identical indices (step2, Fig. <xref rid="Fig1" ref-type="fig">1</xref>B)). Most ISs only contains a few cCREs (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). By default, Snapshot filtered (temporarily removed) 1,738 ISs (step3, Fig. <xref rid="Fig1" ref-type="fig">1</xref>B) and retained 68 abundant ISs that contained more than 173 cCREs (red dashed line in Fig. <xref rid="Fig2" ref-type="fig">2</xref>A). For the cCREs in the filtered ISs, about 85% (17,024 cCREs) of them were then re-classified into one of the abundant ISs in the rescuing step (step4, Fig. <xref rid="Fig1" ref-type="fig">1</xref>C), which is based on matching the profile of the cCRE to the distribution of signals for each IS. The filtering and rescue steps increased the sizes of ISs that passed the abundance threshold (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B). The remaining cCREs, specifically those with a re-classification posterior probability less than 0.5, were clustered into one additional null class IS. To improve the interpretability and simplify the results, we employed a second-round clustering procedure to merge the 69 ISs (Fig. <xref rid="Fig1" ref-type="fig">1</xref>D) into 19 Meta-ISs (Fig. <xref rid="Fig1" ref-type="fig">1</xref>E) based on their average signal across all 13 cell types.</p>
      <p id="Par42">We next compared the results from Snapshot to those from three existing methods, namely K-means clustering, hierarchical clustering (Hclust), and Gaussian Mixture Modeling for Model-Based Clustering (Mclust), in terms of the interpretability, comprehensiveness, and reproducibility.</p>
    </sec>
    <sec id="Sec19">
      <title>Comparison of clusters by interpretability</title>
      <p id="Par43">The comparison of interpretability is based on the patterns of binary peak calls for clustered cCREs across cell types. We constructed two dimensional (2D) maps for the clustering results from each method, with the binary peak calls displayed for each cCRE across cell types (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A–D). For the y-axis in the map of Snapshot results, we sorted the ISs by the indices of ISs along a linearized representation of the cell differentiation tree (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). For maps of results of other clustering methods, the cCREs were ordered by using their cluster labels (K-means and Mclust) or cluster output orders (Hclust) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B–D).</p>
      <p id="Par44">The 2D map of Snapshot results shows the ISs and the corresponding cCRE accessibility history during the cell differentiation. For example, a large group of cCREs are in accessible chromatin in common myeloid progenitors (CMP), with a subset remaining accessible in megakaryocytic erythroid progenitors (MEP), and a smaller subset that remain accessible during erythroid (ERY) maturation (red box in Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). Illustrating the ability of Snapshot to find meaningful but small ISs, the IS with cCREs that are only accessible in T-CD8 cells can be clearly identified (purple box in Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). The maps of results of the other methods show many interpretable clusters, such as those specific to a particular cell type or lineage, but they are mixed with a large number of less interpretable clusters (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B–D). The order of clusters from the other methods cannot be easily sorted by the same approach as used in Snapshot, because their clustering space is continuous while the cell type space is categorical. Thus, even if their clustering results captured patterns of accessibility across cell types similar to those from Snapshot, the organization of these clusters in the 2D map makes it difficult to distinguish the more meaningful clusters from other clusters that may be less informative.</p>
      <p id="Par45">We also compared the 2D representation of the clustering results quantitatively by Shannon Entropy (SE), making the underlying assumption that clustering patterns with lower entropy, and hence less randomness, may represent better interpretability. The specific procedures for calculating SE are described in the Implementation section. Computing the SE using a series of sliding 2D windows over the binarized clustering maps (Fig. <xref rid="Fig4" ref-type="fig">4</xref>) gave consistently lower SE values for Snapshot results compared to the results of other methods (Fig. <xref rid="Fig3" ref-type="fig">3</xref>E). The lower SE values, and inferred greater interpretability, for Snapshot were observed robustly across a series of settings varying the number of adjacent cCREs or number of cell types included in the 2D window used in the measurement (Fig. <xref rid="Fig3" ref-type="fig">3</xref>E).</p>
    </sec>
    <sec id="Sec20">
      <title>Snapshot index identifies detailed <italic>cCRE</italic> patterns within other clustering results</title>
      <p id="Par46">The next evaluation is based on the reasoning that if Snapshot is better able to find interpretable clusters, then it should be able to uncover finer-resolution sub-clusters within the results generated by other commonly used clustering methods, especially in the larger clusters. To investigate this hypothesis, we constructed pairs of heatmaps for the different clustering methods (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A–D). In the left-side heatmap of each pair, the cCREs within each cluster were ordered based on the default output of each clustering methods, while in the right-side heatmap, the cCREs within each cluster were reordered by their Snapshot indices. For K-means (K = 19 and 69), Hclust (K = 19), and Mclust (K = 19), the clusters reordered by the Snapshot indices show more detailed and organized patterns. For example, in one cluster from K-means (K = 19) reordered by the Snapshot indices, the cCREs that are specifically activated in MEP, ERY, and granulocyte/macrophage progenitor (GMP) cells become identifiable (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A cyan box). Similar improvements after the Snapshot index reordering are highlighted with cyan boxes in other heatmaps. The results from Hclust can identify some small but distinct clusters. Its output cluster labels, however, are decided by the cutting point of the hierarchical tree. As a result, those distinct clusters are merged into larger ones (Fig. <xref rid="Fig5" ref-type="fig">5</xref>C cyan box). Using K-means (K = 69) did reveal some detailed patterns (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B), showing that K-means with a sufficiently large number of clusters can identify rare clusters. However, it is challenging to determine the appropriate number of clusters needed for K-means to reveal the rare clusters.<fig id="Fig5"><label>Fig. 5</label><caption><p>The results of re-sorting by Snapshot indices of cCREs in clusters resulting from four existing methods: <bold>A</bold> K-means clustering (K = 19);<bold> B</bold> K-means clustering (K = 69);<bold> C</bold> Hierarchical clustering (K = 19); <bold>D</bold> Mclust clustering (K = 19). The left-side heatmap displays the clustering results with the cCREs within each cluster ordered based on the default outputs of each method. The cluster labels are represented by the bars with different colors, where each color indicates a unique cluster label. In the right side heatmap, the cCREs within each cluster are reordered based on the indices generated by Snapshot</p></caption><graphic xlink:href="12859_2023_5223_Fig5_HTML" id="MO5"/></fig></p>
    </sec>
    <sec id="Sec21">
      <title>Snapshot identifies highly reproducible <italic>cCRE patterns</italic></title>
      <p id="Par47">Some level of technical noise is inevitable in high throughput sequencing data, and thus, clustering methods that are robust to technical noise are valuable for identifying reproducible and reliable patterns in the data. To evaluate the reproducibility of the clustering results, we repeatedly clustered the same data after adding different random noises (uniformly distributed from -0.1 to 0.1) for 5 times for each clustering method. We then calculated the pairwise Adjusted Rand Index (ARI) between different sets of clustering results for each method [<xref ref-type="bibr" rid="CR39">39</xref>]. The results of the Snapshot method had significantly higher overall ARIs (Wilcoxon test using the wilcox.test function in R, p-value = 5.4e-6 (K = 69) and 2.4e-4 (K = 19)) than those from other methods (Fig. <xref rid="Fig6" ref-type="fig">6</xref>), which indicates the results are more robust to the addition of simulated noises and thus should be more reproducible than other examined methods when analyzing real data.<fig id="Fig6"><label>Fig. 6</label><caption><p>Comparing the robustness of four Clustering Methods after adding random noise to the signal matrix. The robustness is quantified by pairwise Adjusted Rand Index (ARI) between cluster labels generated by 5 rounds of clustering runs. The number of output clusters used in all methods are equal to 69 (panel <bold>A</bold>) and 19 (panel <bold>B</bold>)</p></caption><graphic xlink:href="12859_2023_5223_Fig6_HTML" id="MO6"/></fig></p>
    </sec>
    <sec id="Sec22">
      <title>Validate the biological significance of Meta-IS through orthogonal data</title>
      <p id="Par48">The output of Snapshot can reveal specific ISs and Meta-ISs of interest that may be missed by other clustering methods. For example, Meta-IS-8, a cluster containing 427 cCREs (Fig. <xref rid="Fig1" ref-type="fig">1</xref>F), contains cCREs that may be involved in erythroid gene activation, but it is only rarely revealed in 100 rounds of K-means clustering (Fig. <xref rid="Fig1" ref-type="fig">1</xref>G). The Snapshot clustering of chromatin accessibility peaks indicated that the cCREs in Meta-IS-8 are actuated (called as peaks) primarily in the progenitor and mature erythroid cells (Fig. <xref rid="Fig1" ref-type="fig">1</xref>E), indicating a role in erythroid gene regulation. This inference is supported by orthogonal evidence, and the visualization output from Snapshot gives insight into the epigenetic transitions of these cCREs during differentiation (Fig. <xref rid="Fig7" ref-type="fig">7</xref>). Specifically, the nuclease accessibility of cCREs in this Meta-IS gradually increased from the progenitor cells to the erythroblasts, and the number of cCREs annotated with an active epigenetic state increased as cells differentiate along the path from CMP to ERY (Fig. <xref rid="Fig7" ref-type="fig">7</xref>A). The epigenetic state annotation was generated by the IDEAS 2D genome segmentation method [<xref ref-type="bibr" rid="CR11">11</xref>] in the VISION project [<xref ref-type="bibr" rid="CR42">42</xref>]. These observations suggested a hypothesis that these cCREs may be critical for erythroid differentiation. This hypothesis predicted that the functional ontology terms of the genes regulated by this set of cCREs should be enriched for erythropoiesis, and that the cCREs would be enriched in DNA binding motifs for erythroid transcription factors. To test the hypothesis, we examined the Mouse Phenotype terms of genes associated with these regions using GREAT [<xref ref-type="bibr" rid="CR44">44</xref>], and we confirmed that the cCREs in Meta-IS-8 were significantly associated with hemoglobin and erythroid related terms (Fig. <xref rid="Fig7" ref-type="fig">7</xref>B). Furthermore, the most significantly enriched transcription factor binding motifs (from DREME) [<xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR46">46</xref>] were those for the GATA transcription factor family (Fig. <xref rid="Fig7" ref-type="fig">7</xref>C). It is known that two GATA factors, GATA1 and GATA2, are critically important for erythroid cell differentiation [<xref ref-type="bibr" rid="CR47">47</xref>].<fig id="Fig7"><label>Fig. 7</label><caption><p>The Snapshot visualizations for Meta-IS-8. <bold>A</bold> The hematopoietic cell differentiation tree colored by average chromatin accessibility signal of the cCREs in Meta-IS-8 (left). The distributions of those accessibility signals in each cell type are shown as violin plots (right top). The bar plot (right bottom) displays the proportion of each epigenetic state annotation of the cCREs in this Meta-IS. The single column heat map (far right) shows the emission frequencies of epigenetic features from the dominant epigenetic state labeled ENA (enhancer, nuclease accessible, activated). <bold>B</bold> The mouse phenotype terms in GREAT analysis that are significantly enriched in Meta-IS-8. <bold>C</bold> The most significantly enriched TF binding motif in Meta-IS-8 identified by DREME analysis in the GATA motif (E-value = 3e-73)</p></caption><graphic xlink:href="12859_2023_5223_Fig7_HTML" id="MO7"/></fig></p>
      <p id="Par49">Meta-IS-11 and Meta-IS-15 are additional examples of metaclusters discovered by Snapshot but not found frequently by K-means clustering (Fig. <xref rid="Fig1" ref-type="fig">1</xref>G). The cCREs in both of these metaclusters are actuated in stem and progenitor cells, but they differ in their actuation in lymphocytes (Fig. <xref rid="Fig8" ref-type="fig">8</xref>A and B). Specifically, the cCREs in Meta-IS-11 are also actuated in natural killer (NK), CD4 + T, and CD8 + T cells, but weakly in B cells. In contrast, the cCREs in Meta-IS-15 are actuated in B cells and the common lymphoid progenitors (CLP), but not in NK, CD4 + T, and CD8 + T cells. These different patterns of cCRE actuation suggested the hypothesis that the cCREs in the two metaclusters may be involved in regulating genes needed in the different branches of lymphopoiesis. To test this hypothesis, we used the GREAT tool to find enrichment for mouse phenotype terms for genes associated with the cCREs in each metacluster, which confirmed the hypothesized functional association. The cCREs in both metaclusters showed enrichment for immune-related terms, but those in Meta-IS-11 were associated with several T cell terms and B cell terms whereas those in Meta-IS-15 were mainly associated with B cell related terms (Fig. <xref rid="Fig8" ref-type="fig">8</xref>).<fig id="Fig8"><label>Fig. 8</label><caption><p>Chromatin accessibility and functional term enrichments for cCREs in Meta-IS-11(<bold>A</bold>) and Meta-IS-15 (<bold>B</bold>). The top heatmap in each panel displays the average chromatin accessibility signals of the cCREs in the Meta-IS cluster across 13 cell types. The bottom part of each panel presents mouse phenotype terms and their corresponding -log10 p-values based on binomial background model. In the GREAT analysis for enrichment of function-related terms, the proximal regions are defined as TSS -5 kb to + 1 kb, and the distal regions are set to be proximal regions ± 100 kb</p></caption><graphic xlink:href="12859_2023_5223_Fig8_HTML" id="MO8"/></fig></p>
      <p id="Par50">These findings illustrate the effectiveness of Snapshot in identifying biologically meaningful clusters that may be missed by other commonly used clustering methods.</p>
    </sec>
  </sec>
  <sec id="Sec23">
    <title>Conclusions</title>
    <p id="Par51">The Snapshot package can automatically generate ISs of cCREs or other epigenetic or transcriptomic features in a manner that readily aligns with cellular progression, such as a cell differentiation series. This index-based clustering strategy easily reveals all distinct clusters of lineage-specific or stage-specific epigenetic events without requiring predetermined parameters such as the number of clusters. While the index-based approach can produce a large number of clusters initially, one can leverage the imbalance in the sizes of clusters to obtain a manageable number of clusters after the filtering and rescuing procedures. The number of groups can be reduced further by an additional round of clustering to merge ISs into Meta-ISs, which can give a more easily interpretable final set of metaclusters. In addition, the rescue step in Snapshot borrows information across multiple cell types to correct potential peak calling errors, which can help to improve the accuracy of clustering based in epigenetic features across different cell types or conditions [<xref ref-type="bibr" rid="CR48">48</xref>]. While we have demonstrated the Snapshot package for analyzing cCREs across blood cell differentiation, it can be used to study any progression of cell types, such as those responding to hormones or signaling factors or those along a developmental series. Larger sets of epigenomic data are allowed in the Snapshot package. Exploring the utility of Snapshot for much larger numbers of datasets, especially examining the metaclusters of ISs, could be a productive future direction. Furthermore, the clustering and visualizations from Snapshot can reveal groups of elements that may play roles in key transitions in the transcriptome and epigenome during the cellular progression being studied. All these features together make Snapshot a package that can improve the interpretability, comprehensiveness, and robustness for clustering and interpreting the cCREs or other epigenetic events across multiple cell types in a system.</p>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>VISION</term>
        <def>
          <p id="Par4">ValIdated systematic integration of hematopoietic epigenomes</p>
        </def>
      </def-item>
      <def-item>
        <term>cCRE</term>
        <def>
          <p id="Par5">Candidate cis-regulatory-element</p>
        </def>
      </def-item>
      <def-item>
        <term>IS</term>
        <def>
          <p id="Par6">Index-set</p>
        </def>
      </def-item>
      <def-item>
        <term>Meta-IS</term>
        <def>
          <p id="Par7">Meta-Index Set</p>
        </def>
      </def-item>
      <def-item>
        <term>MVN</term>
        <def>
          <p id="Par8">Multivariate Gaussian distribution</p>
        </def>
      </def-item>
      <def-item>
        <term>NB</term>
        <def>
          <p id="Par9">Negative binomial</p>
        </def>
      </def-item>
      <def-item>
        <term>QDA</term>
        <def>
          <p id="Par10">Quadratic discriminant analysis</p>
        </def>
      </def-item>
      <def-item>
        <term>Hclust</term>
        <def>
          <p id="Par11">Hierarchical clustering</p>
        </def>
      </def-item>
      <def-item>
        <term>Mclust</term>
        <def>
          <p id="Par12">Model-based clustering</p>
        </def>
      </def-item>
      <def-item>
        <term>SE</term>
        <def>
          <p id="Par13">Shannon entropy</p>
        </def>
      </def-item>
      <def-item>
        <term>ARI</term>
        <def>
          <p id="Par14">Adjusted random index</p>
        </def>
      </def-item>
      <def-item>
        <term>SD</term>
        <def>
          <p id="Par15">Standard deviation</p>
        </def>
      </def-item>
      <def-item>
        <term>GMP</term>
        <def>
          <p id="Par16">Granulocyte/macrophage progenitor</p>
        </def>
      </def-item>
      <def-item>
        <term>CMP</term>
        <def>
          <p id="Par17">Common myeloid progenitors</p>
        </def>
      </def-item>
      <def-item>
        <term>MEP</term>
        <def>
          <p id="Par18">Megakaryocytic erythroid progenitors</p>
        </def>
      </def-item>
      <def-item>
        <term>ERY</term>
        <def>
          <p id="Par19">Erythroid</p>
        </def>
      </def-item>
      <def-item>
        <term>MK</term>
        <def>
          <p id="Par20">Megakaryocytic</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>GX, YZ, and RH conceived the method. GX developed and implemented the Snapshot package. BG, LA, CK, EH, SA, MK, and DB provided data and the corresponding data pre-processing. GX, YZ, and RCH wrote the manuscript with assistance from the other authors. CS developed the GUI for the Snapshot package. All authors read and approved the final manuscirpt.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>The work was supported by NIH Grants GM121613 and DK106766 and NHGRI Intramural funds.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The Snapshot package is available at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/guanjue/Snapshot">https://github.com/guanjue/Snapshot</ext-link> [<xref ref-type="bibr" rid="CR1">1</xref>]) with MIT License. The main part of Snapshot is written in python with some R scripts for visualization. For running Snapshot, we provided a conda environment that can be deployed in both MacOS and Linux operating system. Files for raw signals, p-value converted signals, and signals from S3norm are available both for download and for viewing from the VISION website (<ext-link ext-link-type="uri" xlink:href="http://usevision.org">http://usevision.org</ext-link> [<xref ref-type="bibr" rid="CR43">43</xref>]). The list of links for the files used in this paper can be found in this link (<ext-link ext-link-type="uri" xlink:href="https://github.com/guanjue/snapshot/blob/main/test_data/Snapshot_paper.all.file.links.txt">https://github.com/guanjue/snapshot/blob/main/test_data/Snapshot_paper.all.file.links.txt</ext-link> [<xref ref-type="bibr" rid="CR49">49</xref>]).</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par52">Not applicable.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par53">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par54">The authors declare that they have no competing interests.</p>
    </notes>
    <notes id="FPar4">
      <title>Other notes</title>
      <p id="Par55">Proofreading for some sentences was done using the ChatGPT model by inputting the phrase 'improve this sentence: ' followed by the sentence into the ChatGPT input box. The output was manually reviewed to ensure it accurately conveyed the original meaning, and any newly identified typographical errors were corrected. All text was subsequently edited by the authors.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">Snapshot GitHub paper. <ext-link ext-link-type="uri" xlink:href="https://github.com/guanjue/snapshot">https://github.com/guanjue/snapshot</ext-link> (Accessed 03 Feb 2023).</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>ENCODE Project Consortium</collab>
        </person-group>
        <article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <fpage>57</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11247</pub-id>
        <pub-id pub-id-type="pmid">22955616</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yue</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Breschi</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Vierstra</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Ryba</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A comparative encyclopedia of DNA elements in the mouse genome</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>515</volume>
        <fpage>355</fpage>
        <lpage>364</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13992</pub-id>
        <?supplied-pmid 25409824?>
        <pub-id pub-id-type="pmid">25409824</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bernstein</surname>
            <given-names>BE</given-names>
          </name>
          <name>
            <surname>Stamatoyannopoulos</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Costello</surname>
            <given-names>JF</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Milosavljevic</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Meissner</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The NIH roadmap epigenomics mapping consortium</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>1045</fpage>
        <lpage>1048</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt1010-1045</pub-id>
        <?supplied-pmid 20944595?>
        <pub-id pub-id-type="pmid">20944595</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Heuston</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Giardine</surname>
            <given-names>BM</given-names>
          </name>
          <name>
            <surname>An</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Wixom</surname>
            <given-names>AQ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An integrative view of the regulatory and transcriptional landscapes in mouse hematopoiesis</article-title>
        <source>Genome Res</source>
        <year>2020</year>
        <volume>30</volume>
        <fpage>472</fpage>
        <lpage>484</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.255760.119</pub-id>
        <?supplied-pmid 32132109?>
        <pub-id pub-id-type="pmid">32132109</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moore</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Purcaro</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Pratt</surname>
            <given-names>HE</given-names>
          </name>
          <name>
            <surname>Epstein</surname>
            <given-names>CB</given-names>
          </name>
          <name>
            <surname>Shoresh</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Adrian</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Expanded encyclopaedias of DNA elements in the human and mouse genomes</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>583</volume>
        <fpage>699</fpage>
        <lpage>710</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2493-4</pub-id>
        <?supplied-pmid 32728249?>
        <pub-id pub-id-type="pmid">32728249</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Libbrecht MW, Chan RCW, Hoffman MM. Segmentation and genome annotation algorithms for identifying chromatin state and other genomic patterns. PLoS computational biology. 2021;17.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Giresi</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Zaba</surname>
            <given-names>LC</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>HY</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>WJ</given-names>
          </name>
        </person-group>
        <article-title>Transposition of native chromatin for fast and sensitive epigenomic profiling of open chromatin, DNA-binding proteins and nucleosome position</article-title>
        <source>Nat Methods</source>
        <year>2013</year>
        <volume>10</volume>
        <fpage>1213</fpage>
        <lpage>1218</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2688</pub-id>
        <?supplied-pmid 24097267?>
        <pub-id pub-id-type="pmid">24097267</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Boyle</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shulha</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Meltzer</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Margulies</surname>
            <given-names>EH</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>High-resolution mapping and characterization of open chromatin across the genome</article-title>
        <source>Cell</source>
        <year>2008</year>
        <volume>132</volume>
        <fpage>311</fpage>
        <lpage>322</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2007.12.014</pub-id>
        <?supplied-pmid 18243105?>
        <pub-id pub-id-type="pmid">18243105</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Meuleman</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Muratov</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rynes</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Halow</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Bates</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Index and biological spectrum of human DNase I hypersensitive sites</article-title>
        <source>Nature</source>
        <year>2020</year>
        <volume>584</volume>
        <fpage>244</fpage>
        <lpage>251</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2559-3</pub-id>
        <?supplied-pmid 32728217?>
        <pub-id pub-id-type="pmid">32728217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>An</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Hardison</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Jointly characterizing epigenetic dynamics across multiple human cell types</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>6721</fpage>
        <lpage>6731</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw278</pub-id>
        <?supplied-pmid 27095202?>
        <pub-id pub-id-type="pmid">27095202</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ernst</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>ChromHMM: automating chromatin-state discovery and characterization</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>215</fpage>
        <lpage>216</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1906</pub-id>
        <?supplied-pmid 22373907?>
        <pub-id pub-id-type="pmid">22373907</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoffman</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Buske</surname>
            <given-names>OJ</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Bilmes</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>WS</given-names>
          </name>
        </person-group>
        <article-title>Unsupervised pattern discovery in human chromatin structure through genomic segmentation</article-title>
        <source>Nat Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <fpage>473</fpage>
        <lpage>476</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1937</pub-id>
        <?supplied-pmid 22426492?>
        <pub-id pub-id-type="pmid">22426492</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Anders S, Huber W. Differential expression analysis for sequence count data. Genome Biol. 2010;11.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shao</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>G-C</given-names>
          </name>
          <name>
            <surname>Orkin</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Waxman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>MAnorm: a robust model for quantitative comparison of ChIP-Seq data sets</article-title>
        <source>Genome Biol</source>
        <year>2012</year>
        <volume>13</volume>
        <fpage>R16</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2012-13-3-r16</pub-id>
        <?supplied-pmid 22424423?>
        <pub-id pub-id-type="pmid">22424423</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Koch H, Keller CA, Xiang G, Giardine B, Zhang F, Wang Y, et al. CLIMB: High-dimensional association detection in large scale genomic data. Nat Commun. 2022;13.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corces</surname>
            <given-names>MR</given-names>
          </name>
          <name>
            <surname>Buenrostro</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Greenside</surname>
            <given-names>PG</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Koenig</surname>
            <given-names>JL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Lineage-specific and single-cell chromatin accessibility charts human hematopoiesis and leukemia evolution</article-title>
        <source>Nat Genet</source>
        <year>2016</year>
        <volume>48</volume>
        <fpage>1193</fpage>
        <lpage>1203</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.3646</pub-id>
        <?supplied-pmid 27526324?>
        <pub-id pub-id-type="pmid">27526324</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Spencer</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Young</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Lamprecht</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Helton</surname>
            <given-names>NM</given-names>
          </name>
          <name>
            <surname>Fulton</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>O’Laughlin</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Epigenomic analysis of the HOX gene loci reveals mechanisms that may control canonical expression patterns in AML and normal hematopoietic cells</article-title>
        <source>Leukemia</source>
        <year>2015</year>
        <volume>29</volume>
        <fpage>1279</fpage>
        <lpage>1289</lpage>
        <pub-id pub-id-type="doi">10.1038/leu.2015.6</pub-id>
        <?supplied-pmid 25600023?>
        <pub-id pub-id-type="pmid">25600023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tavazoie</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Campbell</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Cho</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>GM</given-names>
          </name>
        </person-group>
        <article-title>Systematic determination of genetic network architecture</article-title>
        <source>Nat Genet</source>
        <year>1999</year>
        <volume>22</volume>
        <fpage>281</fpage>
        <lpage>285</lpage>
        <pub-id pub-id-type="doi">10.1038/10343</pub-id>
        <?supplied-pmid 10391217?>
        <pub-id pub-id-type="pmid">10391217</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eisen</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Spellman</surname>
            <given-names>PT</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>PO</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Cluster analysis and display of genome-wide expression patterns</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>1998</year>
        <volume>95</volume>
        <fpage>14863</fpage>
        <lpage>14868</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.95.25.14863</pub-id>
        <?supplied-pmid 9843981?>
        <pub-id pub-id-type="pmid">9843981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Hoon</surname>
            <given-names>MJL</given-names>
          </name>
          <name>
            <surname>Imoto</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Nolan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Miyano</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Open source clustering software</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>1453</fpage>
        <lpage>1454</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth078</pub-id>
        <?supplied-pmid 14871861?>
        <pub-id pub-id-type="pmid">14871861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fraley</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Raftery</surname>
            <given-names>AE</given-names>
          </name>
        </person-group>
        <article-title>Model-based clustering, discriminant analysis, and density estimation</article-title>
        <source>J Am Stat Assoc</source>
        <year>2002</year>
        <volume>97</volume>
        <fpage>611</fpage>
        <lpage>631</lpage>
        <pub-id pub-id-type="doi">10.1198/016214502760047131</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McDowell</surname>
            <given-names>IC</given-names>
          </name>
          <name>
            <surname>Manandhar</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Vockley</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Schmid</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>TE</given-names>
          </name>
          <name>
            <surname>Engelhardt</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <article-title>Clustering gene expression time series data using an infinite Gaussian process mixture model</article-title>
        <source>PLoS Comput Biol</source>
        <year>2018</year>
        <volume>14</volume>
        <fpage>e1005896</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005896</pub-id>
        <?supplied-pmid 29337990?>
        <pub-id pub-id-type="pmid">29337990</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Rasmussen CE. The infinite gaussian mixture model. Advances in Neural Information Processing Systems 12. 2000.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Medvedovic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yeung</surname>
            <given-names>KY</given-names>
          </name>
          <name>
            <surname>Bumgarner</surname>
            <given-names>RE</given-names>
          </name>
        </person-group>
        <article-title>Bayesian mixture model based clustering of replicated microarray data</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>1222</fpage>
        <lpage>1232</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth068</pub-id>
        <?supplied-pmid 14871871?>
        <pub-id pub-id-type="pmid">14871871</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qin</surname>
            <given-names>ZS</given-names>
          </name>
        </person-group>
        <article-title>Clustering microarray gene expression data using weighted Chinese restaurant process</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1988</fpage>
        <lpage>1997</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl284</pub-id>
        <?supplied-pmid 16766561?>
        <pub-id pub-id-type="pmid">16766561</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <mixed-citation publication-type="other">Vu H, Ernst J. Universal annotation of the human genome through integration of over a thousand epigenomic datasets. Genome Biol. 2022;23.</mixed-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oudelaar</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Hanssen</surname>
            <given-names>LLP</given-names>
          </name>
          <name>
            <surname>Hardison</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Kassouf</surname>
            <given-names>MT</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Higgs</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Between form and function: the complexity of genome folding</article-title>
        <source>Hum Mol Genet</source>
        <year>2017</year>
        <volume>26</volume>
        <fpage>R208</fpage>
        <lpage>R215</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddx306</pub-id>
        <?supplied-pmid 28977451?>
        <pub-id pub-id-type="pmid">28977451</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Philipsen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hardison</surname>
            <given-names>RC</given-names>
          </name>
        </person-group>
        <article-title>Evolution of hemoglobin loci and their regulatory elements</article-title>
        <source>Blood Cells Mol Dis</source>
        <year>2018</year>
        <volume>70</volume>
        <fpage>2</fpage>
        <lpage>12</lpage>
        <pub-id pub-id-type="doi">10.1016/j.bcmd.2017.08.001</pub-id>
        <?supplied-pmid 28811072?>
        <pub-id pub-id-type="pmid">28811072</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heuston</surname>
            <given-names>EF</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Lichtenberg</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Giardine</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Anderson</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Hardison</surname>
            <given-names>RC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Establishment of regulatory elements during erythro-megakaryopoiesis identifies hematopoietic lineage-commitment points</article-title>
        <source>Epigenet Chromatin</source>
        <year>2018</year>
        <volume>11</volume>
        <fpage>22</fpage>
        <pub-id pub-id-type="doi">10.1186/s13072-018-0195-z</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lachenbruch</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Goldstein</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Discriminant analysis</article-title>
        <source>Biometrics</source>
        <year>1979</year>
        <volume>35</volume>
        <fpage>69</fpage>
        <pub-id pub-id-type="doi">10.2307/2529937</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <mixed-citation publication-type="other">Akaike information criterion statistics. Math Comput Simul. 1987;29.</mixed-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xiang</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Giardine</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>An</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Q</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>S3norm: simultaneous normalization of sequencing depth and signal-to-noise ratio in epigenomic data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2020</year>
        <volume>48</volume>
        <fpage>e43</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkaa105</pub-id>
        <?supplied-pmid 32086521?>
        <pub-id pub-id-type="pmid">32086521</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <mixed-citation publication-type="other">Quinlan AR. BEDTools: The swiss-army tool for genome feature analysis. Curr Protoc Bioinformatics. 2014;47:11.12.1–11.12.34.</mixed-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kent</surname>
            <given-names>WJ</given-names>
          </name>
          <name>
            <surname>Sugnet</surname>
            <given-names>CW</given-names>
          </name>
          <name>
            <surname>Furey</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Roskin</surname>
            <given-names>KM</given-names>
          </name>
          <name>
            <surname>Pringle</surname>
            <given-names>TH</given-names>
          </name>
          <name>
            <surname>Zahler</surname>
            <given-names>AM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The human genome browser at UCSC</article-title>
        <source>Genome Res</source>
        <year>2002</year>
        <volume>12</volume>
        <fpage>996</fpage>
        <lpage>1006</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.229102</pub-id>
        <?supplied-pmid 12045153?>
        <pub-id pub-id-type="pmid">12045153</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shannon</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <article-title>A mathematical theory of communication</article-title>
        <source>Bell Syst Tech J</source>
        <year>1948</year>
        <volume>27</volume>
        <fpage>379</fpage>
        <lpage>423</lpage>
        <pub-id pub-id-type="doi">10.1002/j.1538-7305.1948.tb01338.x</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Günther</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Pilarski</surname>
            <given-names>PM</given-names>
          </name>
          <name>
            <surname>Helfrich</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Diepold</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>First steps towards an intelligent laser welding architecture using deep neural networks and reinforcement learning</article-title>
        <source>Procedia Technol</source>
        <year>2014</year>
        <volume>15</volume>
        <fpage>474</fpage>
        <lpage>483</lpage>
        <pub-id pub-id-type="doi">10.1016/j.protcy.2014.09.007</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Xiang G, Giardine BM, Mahony S, Zhang Y, Hardison RC. S3V2-IDEAS: a package for normalizing, denoising and integrating epigenomic datasets across different cell types. Bioinformatics. 2021; March:1–3.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rand</surname>
            <given-names>WM</given-names>
          </name>
        </person-group>
        <article-title>Objective criteria for the evaluation of clustering methods</article-title>
        <source>J Am Stat Assoc</source>
        <year>1971</year>
        <volume>66</volume>
        <fpage>846</fpage>
        <lpage>850</lpage>
        <pub-id pub-id-type="doi">10.1080/01621459.1971.10482356</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hubert</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Arabie</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Comparing partitions</article-title>
        <source>J Classif</source>
        <year>1985</year>
        <volume>2</volume>
        <fpage>193</fpage>
        <lpage>218</lpage>
        <pub-id pub-id-type="doi">10.1007/BF01908075</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">Xiang G, Keller CA, Heuston E, Giardine BM, An L, Wixom AQ, et al. An integrative view of the regulatory and transcriptional landscapes in mouse hematopoiesis. 2019;:814–63.</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Xiang G, He X, Giardine B, Jansen Camden, Weaver K, Taylor D, et al. Cross-species regulatory landscapes and elements revealed by novel joint systematic integration of human and mouse blood cell epigenomes. 2023.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">VISION project website . usevision.org (Accessed 03 Feb 2023).</mixed-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McLean</surname>
            <given-names>CY</given-names>
          </name>
          <name>
            <surname>Bristor</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hiller</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Schaar</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Lowe</surname>
            <given-names>CB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GREAT improves functional interpretation of cis-regulatory regions</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>495</fpage>
        <lpage>501</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1630</pub-id>
        <?supplied-pmid 20436461?>
        <pub-id pub-id-type="pmid">20436461</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bailey</surname>
            <given-names>TL</given-names>
          </name>
        </person-group>
        <article-title>DREME: motif discovery in transcription factor ChIP-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>1653</fpage>
        <lpage>1659</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr261</pub-id>
        <?supplied-pmid 21543442?>
        <pub-id pub-id-type="pmid">21543442</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Machanick</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Bailey</surname>
            <given-names>TL</given-names>
          </name>
        </person-group>
        <article-title>MEME-ChIP: motif analysis of large DNA datasets</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <fpage>1696</fpage>
        <lpage>1697</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr189</pub-id>
        <?supplied-pmid 21486936?>
        <pub-id pub-id-type="pmid">21486936</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katsumura</surname>
            <given-names>KR</given-names>
          </name>
          <name>
            <surname>Bresnick</surname>
            <given-names>EH</given-names>
          </name>
        </person-group>
        <article-title>The GATA factor revolution in hematology</article-title>
        <source>Blood</source>
        <year>2017</year>
        <volume>129</volume>
        <fpage>2092</fpage>
        <lpage>2102</lpage>
        <pub-id pub-id-type="doi">10.1182/blood-2016-09-687871</pub-id>
        <?supplied-pmid 28179282?>
        <pub-id pub-id-type="pmid">28179282</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <mixed-citation publication-type="other">Luan J, Xiang G, Gómez-García PA, Tome JM, Zhang Z, Vermunt MW, et al. Distinct properties and functions of CTCF revealed by a rapidly inducible degron system. Cell Rep. 2021;34.</mixed-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <mixed-citation publication-type="other">The list of links for the files used in Snapshot paper. <ext-link ext-link-type="uri" xlink:href="https://github.com/guanjue/snapshot/blob/main/test_data/Snapshot_paper.all.file.links.txt">https://github.com/guanjue/snapshot/blob/main/test_data/Snapshot_paper.all.file.links.txt</ext-link> (Accessed 03 Feb 2023).</mixed-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ramírez</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Ryan</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Grüning</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Bhardwaj</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Kilpert</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Richter</surname>
            <given-names>AS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>deepTools2: a next generation web server for deep-sequencing data analysis</article-title>
        <source>Nucleic Acids Res</source>
        <year>2016</year>
        <volume>44</volume>
        <fpage>W160</fpage>
        <lpage>W165</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw257</pub-id>
        <?supplied-pmid 27079975?>
        <pub-id pub-id-type="pmid">27079975</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
