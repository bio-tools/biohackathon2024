<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10463720</article-id>
    <article-id pub-id-type="pmid">37608264</article-id>
    <article-id pub-id-type="publisher-id">5432</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05432-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>iDESC: identifying differential expression in single-cell RNA sequencing data with multiple subjects</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Yunqing</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhao</surname>
          <given-names>Jiayi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Adams</surname>
          <given-names>Taylor S.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Ningya</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schupp</surname>
          <given-names>Jonas C.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Weimiao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McDonough</surname>
          <given-names>John E.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chupp</surname>
          <given-names>Geoffrey L.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kaminski</surname>
          <given-names>Naftali</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Zuoheng</given-names>
        </name>
        <address>
          <email>zuoheng.wang@yale.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8688-9004</contrib-id>
        <name>
          <surname>Yan</surname>
          <given-names>Xiting</given-names>
        </name>
        <address>
          <email>xiting.yan@yale.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.47100.32</institution-id><institution-id institution-id-type="ISNI">0000000419368710</institution-id><institution>Department of Biostatistics, </institution><institution>Yale School of Public Health, </institution></institution-wrap>New Haven, CT 06520 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.47100.32</institution-id><institution-id institution-id-type="ISNI">0000000419368710</institution-id><institution>Section of Pulmonary, Critical Care and Sleep Medicine, </institution><institution>Yale School of Medicine, </institution></institution-wrap>New Haven, CT 06520 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.452624.3</institution-id><institution>Department of Respiratory Medicine, Hannover Medical School and Biomedical Research in End-Stage and Obstructive Lung Disease Hannover, </institution><institution>German Center for Lung Research (DZL), </institution></institution-wrap>Hannover, Germany </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01zbnvs85</institution-id><institution-id institution-id-type="GRID">grid.453567.6</institution-id><institution-id institution-id-type="ISNI">0000 0004 0615 529X</institution-id><institution>Meta Platforms, Inc, </institution></institution-wrap>Cambridge, USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>318</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>7</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023, corrected publication 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Single-cell RNA sequencing (scRNA-seq) technology has enabled assessment of transcriptome-wide changes at single-cell resolution. Due to the heterogeneity in environmental exposure and genetic background across subjects, subject effect contributes to the major source of variation in scRNA-seq data with multiple subjects, which severely confounds cell type specific differential expression (DE) analysis. Moreover, dropout events are prevalent in scRNA-seq data, leading to excessive number of zeroes in the data, which further aggravates the challenge in DE analysis.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed iDESC to detect cell type specific DE genes between two groups of subjects in scRNA-seq data. iDESC uses a zero-inflated negative binomial mixed model to consider both subject effect and dropouts. The prevalence of dropout events (dropout rate) was demonstrated to be dependent on gene expression level, which is modeled by pooling information across genes. Subject effect is modeled as a random effect in the log-mean of the negative binomial component. We evaluated and compared the performance of iDESC with eleven existing DE analysis methods. Using simulated data, we demonstrated that iDESC had well-controlled type I error and higher power compared to the existing methods. Applications of those methods with well-controlled type I error to three real scRNA-seq datasets from the same tissue and disease showed that the results of iDESC achieved the best consistency between datasets and the best disease relevance.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">iDESC was able to achieve more accurate and robust DE analysis results by separating subject effect from disease effect with consideration of dropouts to identify DE genes, suggesting the importance of considering subject effect and dropouts in the DE analysis of scRNA-seq data with multiple subjects.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05432-8.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell RNA sequencing</kwd>
      <kwd>Differential expression analysis</kwd>
      <kwd>Subject effect</kwd>
      <kwd>Zero-inflated negative binomial mixed model</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000027</institution-id>
            <institution>National Institute on Alcohol Abuse and Alcoholism</institution>
          </institution-wrap>
        </funding-source>
        <award-id>K01AA023321</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wang</surname>
            <given-names>Zuoheng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000092</institution-id>
            <institution>U.S. National Library of Medicine</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R21LM012884</award-id>
        <award-id>R01LM014087</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yan</surname>
            <given-names>Xiting</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DMS1916246</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wang</surname>
            <given-names>Zuoheng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par10">Recent advances in droplet-based single-cell RNA sequencing (scRNA-seq) technology have enabled investigators to assess transcriptome-wide differences at single-cell resolution [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. Instead of pooling RNAs from all cells together, droplet-based scRNA-seq technology isolates cells using oil droplets, in which each cell is lysed and a cell barcode and a unique molecular identifier (UMI) are added onto the amplified cDNAs. Using these cell barcodes and UMIs, sequencing reads are demultiplexed into different cells and transcripts, which enables single-cell transcriptome profiling without PCR amplification bias. In recent years, scRNA-seq has been used to study cellular heterogeneity and gene expression variability across different cell types in diverse human tissues [<xref ref-type="bibr" rid="CR4">4</xref>] and diseases (chronic diseases [<xref ref-type="bibr" rid="CR5">5</xref>], infectious diseases [<xref ref-type="bibr" rid="CR6">6</xref>], autoimmune diseases [<xref ref-type="bibr" rid="CR7">7</xref>], and cancers [<xref ref-type="bibr" rid="CR8">8</xref>]). These applications have revealed disease-related cell type specific transcriptomic changes [<xref ref-type="bibr" rid="CR9">9</xref>], rare cell types [<xref ref-type="bibr" rid="CR10">10</xref>], and cell type composition changes [<xref ref-type="bibr" rid="CR11">11</xref>], providing important insights into disease pathogenesis and facilitating the development of personalized treatment of diseases [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>].</p>
    <p id="Par11">Despite the great potential of scRNA-seq technology, challenges remain in the corresponding data analysis. Specifically, one common task in scRNA-seq data analysis is to identify cell type specific differentially expressed (DE) genes between two groups of subjects [<xref ref-type="bibr" rid="CR14">14</xref>], which can be challenging due to prevalent dropout events and substantial subject effect, or so-called between biological replicate variation [<xref ref-type="bibr" rid="CR15">15</xref>]. Dropout refers to the event when a given gene is observed at a moderate expression level in one cell but is not detected in another cell of the same type from the same sample [<xref ref-type="bibr" rid="CR16">16</xref>], leading to underestimation of gene expression level and overestimation of variation in the data which may generate false positive results. Moreover, with the popularity of multi-sample scRNA-seq datasets from different diseases, tissues, and cell types, many of them have consistently shown that within the same cell type, cells of the same subject cluster together but separate well from cells of other subjects [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. This suggests that there exists a large variation across subjects possibly due to heterogeneous genetic backgrounds or environmental exposures and this variation is much larger than the within-subject variation across cells of the same type. Dominant subject effect severely confounds the DE analysis of scRNA-seq data because genes driving differences across subjects are likely to also be significantly different between two groups [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. Taken together, in the DE analysis of scRNA-seq data with multiple subjects, it is critical to separate subject effect from disease effect with consideration of dropout events.</p>
    <p id="Par12">Technical batch effect is one possible reason for the large variation across subjects because many studies processed cells and cDNA libraries from different subjects in different batches due to the requirement of sample freshness in certain tissue types and early-stage scRNA-seq protocols. This may lead to batch effect in the data so that cells of the same type from different subjects have different expression profiles. However, in the scRNA-seq dataset from patients with idiopathic pulmonary fibrosis (IPF), the large variation across subjects was still present after adjusting for batch effect using scVI [<xref ref-type="bibr" rid="CR21">21</xref>]. In addition, recent advances in combining scRNA-seq with upstream cell cryopreservation using dimethyl sulfoxide (DMSO) have enabled preservation of cells so that samples from different subjects can be processed together [<xref ref-type="bibr" rid="CR22">22</xref>]. Comparison between scRNA-seq data from the same sputum sample with and without DMSO preservation showed no significant difference between the fresh and DMSO data but significant separation between different subjects was still present (unpublished data). Since the fresh and DMSO data from the same sample were generated in two different batches, this confirmed that the large between-subject variation was a consequence of biological subject effect but not technical batch effect. Therefore, it is inadequate to consider this variation as technical batch effect and remove it using batch effect adjustment tools in scRNA-seq data. In fact, removing this variation as technical batch effect may remove the disease effect of interest because subject effect confounds with disease effect.</p>
    <p id="Par13">Many DE analysis methods for scRNA-seq data have been developed and compared [<xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR25">25</xref>]. They can be classified into two categories depending on whether subject effect is considered. Although methods that ignore subject effect have been used in DE analysis, they are more suitable for identification of marker genes for a given cell type, which is fundamentally different from DE analysis.</p>
    <p id="Par14">Within the category of methods that ignore subject effect, there are methods specifically designed for scRNA-seq data and methods adopted from bulk RNA-seq DE analysis. Among the methods designed for scRNA-seq data, BASiCS [<xref ref-type="bibr" rid="CR26">26</xref>] and TASC [<xref ref-type="bibr" rid="CR27">27</xref>] require external RNA spike-ins to provide information on technical variation and use a Bayesian hierarchical Poisson-Gamma model and a hierarchical Poisson-lognormal model, respectively, to fit data. Monocle [<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref>] and NBID [<xref ref-type="bibr" rid="CR31">31</xref>] model UMI counts of each gene using a negative binomial distribution without considering dropouts. To account for dropouts, a group of methods were developed including DEsingle [<xref ref-type="bibr" rid="CR32">32</xref>], DESCENT [<xref ref-type="bibr" rid="CR33">33</xref>], SC2P [<xref ref-type="bibr" rid="CR34">34</xref>], SCDE [<xref ref-type="bibr" rid="CR16">16</xref>] and MAST [<xref ref-type="bibr" rid="CR35">35</xref>]. These methods utilize mixture models or hierarchical models, mostly zero-inflated, to model dropouts and captured transcripts. DEsingle fits a zero-inflated negative binomial model in each group and conducts a likelihood ratio test for significance assessment. DESCENT models UMI counts using a hierarchical model which assumes that the true underlying expression follows a zero-inflated negative binomial distribution and the capturing process generating the observed data follows a beta-binomial distribution. SC2P models dropout events using a zero-inflated Poisson distribution and fits the detected transcripts using a lognormal-Poisson distribution. The assumption in SC2P that the cell-specific dropout rate and dropout distribution are shared by all genes may eliminate the natural stochasticity in scRNA-seq data. SCDE employs a two-component mixture model with a negative binomial and a low-magnitude Poisson component to model efficiently amplified read-outs and dropout events, respectively. The dropout rate for a given gene is determined by its true underlying expression level in the cell, which is estimated based on a selected subset of highly expressed genes. MAST uses a two-part hurdle model in which dropout rates are modeled by a logistic regression model and non-zero expression follows a Gaussian distribution. SC2P, SCDE and MAST were originally designed for Transcript Per Kilobase Million (TPM) data which has different technical noise and data distribution from UMI count data [<xref ref-type="bibr" rid="CR36">36</xref>]. Multimodality has been observed in scRNA-seq data due to cellular heterogeneity within the same cell type. To consider multimodality, scDD [<xref ref-type="bibr" rid="CR37">37</xref>] was designed to model count data with a Dirichlet process to detect genes with difference in mean expression, proportion of the same component, or modality between groups. D3E [<xref ref-type="bibr" rid="CR38">38</xref>], a nonparametric method, fits a bursting model for transcriptional regulation and compares the gene expression distribution between two groups. It was previously reported to generate false-positive results on negative control datasets [<xref ref-type="bibr" rid="CR24">24</xref>]. A recent study [<xref ref-type="bibr" rid="CR23">23</xref>] showed that bulk RNA-seq analysis methods, including DESeq2 [<xref ref-type="bibr" rid="CR39">39</xref>], limma-trend [<xref ref-type="bibr" rid="CR40">40</xref>], and Wilcoxon rank sum test [<xref ref-type="bibr" rid="CR41">41</xref>], have comparable performance to methods designed for scRNA-seq data when applied to the cell-level UMI count data, especially after filtering out lowly expressed genes.</p>
    <p id="Par15">All the methods mentioned above treat cells from the same subject as independent, which may be efficient for identifying cell type marker genes, but inappropriate for DE analysis to identify disease or phenotype associated genes due to the presence of dominant subject effect confounded with disease effect as described above. One simple and straightforward solution is to aggregate expression levels of cells from the same subject by averaging and then to compare the aggregated sample-level “pseudo-bulk” expression levels between two groups of subjects using Student’s t test. We denote this method as subject-t-test (subT). Furthermore, two recent studies proposed the following three DE analysis methods to consider subject effect in scRNA-seq data. Zimmerman et al. [<xref ref-type="bibr" rid="CR19">19</xref>] developed MAST-RE by adding a subject random effect to the non-zero expression part of the hurdle model in MAST. The muscat package [<xref ref-type="bibr" rid="CR20">20</xref>] provides two approaches to consider subject effect: (1) muscat-PB that aggregates cell-level UMI counts into sample-level “pseudo-bulk” counts which are then compared between two groups using edgeR that was developed for DE analysis in bulk RNA-seq data; and (2) muscat-MM that fits a generalized linear mixed model (GLMM) on the cell-level UMI counts to account for subject variation. Both muscat-PB and muscat-MM were compared to other methods and shown to have power gain by considering subject effect [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    <p id="Par16">In this article, we develop a new statistical model to identify DE genes in scRNA-seq data with multiple subjects, named iDESC. A zero-inflated negative binomial mixed model is used to consider both subject effect and dropouts. iDESC models dropout events as inflated zeros by pooling information across genes and assuming that genes with similar expression share similar dropout rates. In addition, iDESC allows dropout rate to be subject/batch specific. The non-dropout events are modeled by a negative binomial distribution. In the negative binomial component, a random effect is used to separate subject effect from disease effect. Wald statistic is used to assess the significance of disease effect. We compared iDESC with 11 existing DE analysis methods based on type I error, statistical power, between-dataset consistency and validation using both simulated and real datasets.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Dependency of dropout rate on gene expression</title>
      <p id="Par17">Previous studies reported that the dropout rate of a gene in a given cell depends on the expected expression level of the gene in the cell and dropout events are more prevalent for genes with lower expression [<xref ref-type="bibr" rid="CR16">16</xref>]. As expected, in both macrophage and fibroblast across the three real datasets, we observed decreasing patterns in the gene-level proportion of zeros when the average log-normalized UMI count across all cells increases (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, b). Assuming that genes with similar average expression share similar dropout rates, we pooled information across genes to obtain an S-shape curve describing the dependency of dropout rate on gene expression level using locally estimated scatterplot smoothing (LOESS) regression. Heterogeneity of this dependency across different subjects was also observed when we stratified cells by subjects to obtain the subject-level LOESS curves, suggesting that dropout rate is likely to be subject/batch specific (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c, d).<fig id="Fig1"><label>Fig. 1</label><caption><p>Dependency of dropout rate on gene expression. Plots showing the gene-level proportion of zeros in relation to the average log-normalize UMI count across all cells in <bold>a</bold> the Kaminski and Misharin macrophage datasets and <bold>b</bold> the Kaminski and Kropski fibroblast datasets. The LOESS curves (red lines) described decreasing patterns of dropout rate on gene expression level. The subject-level LOESS curves in <bold>c</bold> the Kaminski and Misharin macrophage datasets and <bold>d</bold> the Kaminski and Kropski fibroblast datasets demonstrated heterogeneity of this dependency across different subjects</p></caption><graphic xlink:href="12859_2023_5432_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Method performance evaluation overview</title>
      <p id="Par18">We evaluated and compared the performance of iDESC and eleven existing DE analysis methods (Table <xref rid="Tab1" ref-type="table">1</xref>) using both simulation studies and three real datasets. We divide these methods into two categories, based on whether subject effect is considered. The first category of methods considers subject effect, including iDESC, MAST-RE, muscat-PB, muscat-MM and subT. Among them, iDESC, MAST-RE and muscat-MM are mixed model-based methods, whereas muscat-PB and subT are aggregation-based methods. iDESC and MAST-RE also consider dropouts in scRNA-seq data. The other category of methods does not consider subject effect. Within this category, DEsingle, MAST and scDD consider dropouts while NBID, DESeq2, limma-trend and Wilcoxon rank sum test do not. DEsingle considers dropout in the fitted model but tests for differences in both group means and dropout rates instead of difference in group means only. Therefore, unlike most DE methods, DEsingle identifies genes with composite differences in group means and dropout rates. Comparison of these methods enabled us to assess the benefit of considering dropout evens and/or subject effect in the DE analysis of scRNA-seq data.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Overview of the twelve DE analysis methods for comparison</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Dropout</th><th align="left">Subject effect</th><th align="left">Test</th><th align="left">Model</th></tr></thead><tbody><tr><td align="left">iDESC</td><td align="left">✓</td><td align="left">Mixed model</td><td align="left">Wald test</td><td align="left">Zero-inflated negative binomial mixed model</td></tr><tr><td align="left">MAST-RE</td><td align="left">✓</td><td align="left">Mixed model</td><td align="left">Likelihood ratio test</td><td align="left">Two-part hurdle mixed model</td></tr><tr><td align="left">Muscat-MM</td><td align="left">×</td><td align="left">Mixed model</td><td align="left">Wald test</td><td align="left">Negative binomial mixed model</td></tr><tr><td align="left">Muscat-PB</td><td align="left">×</td><td align="left">Aggregation</td><td align="left">Quasi-likelihood F-test</td><td align="left">EdgeR on sample-level aggregated data</td></tr><tr><td align="left">subT</td><td align="left">×</td><td align="left">Aggregation</td><td align="left">Student’s T test</td><td align="left">T test on sample-level aggregated data</td></tr><tr><td align="left">DEsingle</td><td align="left">✓</td><td align="left">×</td><td align="left">Likelihood ratio test</td><td align="left">Group-specific zero-inflated negative binomial model</td></tr><tr><td align="left">MAST</td><td align="left">✓</td><td align="left">×</td><td align="left">Likelihood ratio test</td><td align="left">Two-part hurdle model</td></tr><tr><td align="left">scDD</td><td align="left">✓</td><td align="left">×</td><td align="left">Kolmogorov–Smirnov test</td><td align="left">Dirichlet process mixture of normals</td></tr><tr><td align="left">NBID</td><td align="left">×</td><td align="left">×</td><td align="left">Likelihood ratio test</td><td align="left">Negative binomial model with group-specific dispersion</td></tr><tr><td align="left">DESeq2</td><td align="left">×</td><td align="left">×</td><td align="left">Wald test</td><td align="left">Negative binomial model with the same dispersion between groups</td></tr><tr><td align="left">limma</td><td align="left">×</td><td align="left">×</td><td align="left">Moderated T test</td><td align="left">Linear regression model</td></tr><tr><td align="left">Wilcoxon</td><td align="left">×</td><td align="left">×</td><td align="left">Wilcoxon rank sum test</td><td align="left">Nonparametric test</td></tr></tbody></table></table-wrap></p>
      <p id="Par19">We compared method performance based on type I error, statistical power, and consistency of the identified DE genes in three independent scRNA-seq datasets on the same disease, the Kaminski dataset [<xref ref-type="bibr" rid="CR18">18</xref>], the Kropski dataset [<xref ref-type="bibr" rid="CR42">42</xref>] and the Misharin dataset [<xref ref-type="bibr" rid="CR17">17</xref>]. All datasets measured scRNA-seq data of whole lung tissue from patients with IPF and normal controls.</p>
    </sec>
    <sec id="Sec5">
      <title>Type I error assessment</title>
      <p id="Par20">To assess type I error, we permuted the group labels of subjects in both Kaminski and Kropski datasets 500 times. All twelve methods were applied to the permuted datasets to identify DE genes in macrophages. For each gene, we calculated the empirical type I error as the proportion of permuted datasets with a <italic>p</italic> value &lt; 0.05 and compared it to the nominal level 0.05. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the empirical type I error of each method. In both datasets, methods that account for subject effect, including iDESC, MAST-RE, muscat-MM, muscat-PB and subT, had well-controlled type I error. Among these methods, MAST-RE had slightly inflated type I error for some genes, likely due to the deviation of log-normalized UMI counts from the assumed Gaussian distribution. In contrast, the type I error of the methods that do not consider subject effect were severely inflated. The inflation of type I error was more prominent in the Kropski dataset for these methods, indicating a larger subject effect in the data. Among these methods, DEsingle, MAST and scDD had the largest inflation in type I error. DESeq2 had the largest variation in type I error across all genes. Taken together, these results suggested that it is important to consider subject effect for type I error control in the DE analysis of scRNA-seq data with multiple subjects.<fig id="Fig2"><label>Fig. 2</label><caption><p>Empirical type I error of all methods on the two permuted real datasets. Boxplots showing the median (center line), interquartile range (hinges), and 1.5 times the interquartile (whiskers) of empirical type I error at the nominal level of 0.05. Confidence interval of type I error is marked by two dashed lines (0.031–0.069)</p></caption><graphic xlink:href="12859_2023_5432_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Power comparison</title>
      <p id="Par21">To compare power, we simulated scRNA-seq data with 150 true DE genes and 300 non-DE genes under a wide range of parameter settings estimated from the Kaminski macrophage dataset. Expression data of the DE genes was simulated to have a fold-change of <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}^{\beta }$$\end{document}</tex-math><mml:math id="M2"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>β</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq1.gif"/></alternatives></inline-formula> between the two groups of subjects. The number of cells per subject (<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M4"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq2.gif"/></alternatives></inline-formula>), the magnitude of capture efficiency (<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta$$\end{document}</tex-math><mml:math id="M6"><mml:mi>δ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq3.gif"/></alternatives></inline-formula>) and the log fold change (<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M8"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq4.gif"/></alternatives></inline-formula>) were varied at different levels to simulate different datasets. We then applied all twelve methods to each simulated dataset for DE analysis. Method performance was assessed by the area under a receiver operating characteristic curve (AUC) that describes the sensitivity and specificity of the identified DE genes under different significance levels. The sensitivity and specificity under the p-value threshold of 0.05 are also demonstrated.</p>
      <p id="Par22">Figures <xref rid="Fig3" ref-type="fig">3</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S1 show that all methods had improved sensitivity and AUC when the number of cells per subject increased except scDD. Under most simulation settings, iDESC performed the best with the highest sensitivity and AUC when compared to methods considering subject effect (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, c, d). In the setting with 20 cells per subject and negative group effect, iDESC had comparable or higher AUC than other methods. When capture efficiency was high (<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta =0.5$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq5.gif"/></alternatives></inline-formula>) corresponding to low dropout rate, muscat-MM had the second highest sensitivity and AUC but was better than iDESC in the setting with 20 cells per subject and negative disease effect. When capture efficiency was low (<inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta =1, 1.5$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq6.gif"/></alternatives></inline-formula>) corresponding to high dropout rate, the other four methods that consider subject effect, MAST-RE, muscat-MM, muscat-PB and subT, were comparable and had lower sensitivity and AUC than iDESC. The specificity of iDESC, muscat-MM and sub-T were around 0.95 at the p-value threshold of 0.05, while MAST-RE and muscat-PB had lower specificity especially when the group effect was large (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). When we compared iDESC with the other seven methods that do not consider subject effect, DEseq2 had comparable or even higher sensitivity and AUC than iDESC when capture efficiency was low (<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta =1, 1.5$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq7.gif"/></alternatives></inline-formula>), but performed worse when capture efficiency was high (<inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta =0.5$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq8.gif"/></alternatives></inline-formula>) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S1a, S1c and S1d). DEseq2 and Wilcoxon had lower specificity especially when capture efficiency was high (<inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta =0.5$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq9.gif"/></alternatives></inline-formula>) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1b). All other methods had lower sensitivity, specificity and AUC. scDD and NBID had compromised performance in most of the simulation settings. In summary, iDESC had comparable or the highest sensitivity and AUC, and maintained the correct specificity across all simulation settings.<fig id="Fig3"><label>Fig. 3</label><caption><p>Power comparison of methods considering subject effect in simulated datasets. Evaluation criteria including <bold>a</bold> sensitivity and <bold>b</bold> specificity under the p-value threshold of 0.05, and <bold>c</bold> area under an ROC curve (AUC) to measure the accuracy of identified DE genes under three levels of capture efficiency (δ) and number of cells per subject (<inline-formula id="IEq84"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M20"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq84.gif"/></alternatives></inline-formula>). <bold>d</bold> ROC curves and the corresponding AUC scores when <inline-formula id="IEq85"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta =0.4, \delta =1, m=50$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn><mml:mo>,</mml:mo><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq85.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="12859_2023_5432_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Consistency and validation of results in three independent scRNA-seq datasets</title>
      <p id="Par23">We used two cell types, macrophage and fibroblast, from three independent scRNA-seq datasets (Kaminski, Kropski and Misharin) of whole lung tissue from IPF patients and normal controls [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR42">42</xref>] to demonstrate and compare the between-dataset consistency of DE results by different methods. Both cell types have been reported to have significant transcriptomic changes in IPF patients [<xref ref-type="bibr" rid="CR43">43</xref>–<xref ref-type="bibr" rid="CR50">50</xref>]. Since different datasets have different cell type nomenclature, we overlaid the data from all three datasets to find subpopulations of cells that overlap well across the three datasets on the UMAP of integrated data by Seurat (Figs. <xref rid="Fig4" ref-type="fig">4</xref>a and <xref rid="Fig5" ref-type="fig">5</xref>a). This step was performed to ensure that DE analysis was conducted on the same type of cells across three datasets so that results are comparable. For each cell type, we selected datasets with a median number of cells per subject larger than 10 to conduct the consistency analysis. Eventually, the DE analysis results in macrophage were compared between the Kaminski and Misharin datasets and in fibroblast between the Kaminski and Kropski datasets. Five methods that consider subject effect, including iDESC, MAST-RE, muscat-MM, muscat-PB and subT, were applied. After data preprocessing, we had 7,128 genes in 43,028 macrophages from the Kaminski dataset, and 8,409 genes in 3,635 macrophages from the Misharin dataset. For fibroblast, we had 10,860 genes in 2,290 fibroblasts from the Kaminski dataset, and 9,325 genes in 1,615 fibroblasts from the Kropski dataset. We further had 7,653 genes in 8,663 macrophages from the Kropski dataset for external validation.<fig id="Fig4"><label>Fig. 4</label><caption><p>DE analysis using iDESC on the two IPF macrophage datasets. <bold>a</bold> UMAP of nomenclature matched macrophages in the Kaminski and Misharin datasets colored by subject (left) and group (right). <bold>b</bold> Heatmap of subject-level average expression for the top 10 upregulated and top 10 downregulated genes. <bold>c</bold> Violin plots demonstrate cell-level contributions to the group fold-change within each subject. Each violin corresponds to one subject and is colored by group</p></caption><graphic xlink:href="12859_2023_5432_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>DE analysis using iDESC on the two IPF fibroblast datasets. <bold>a</bold> UMAP of nomenclature matched fibroblasts in the Kaminski and Kropski datasets colored by subject (left) and group (right). <bold>b</bold> Heatmap of subject-level average expression for the top 10 upregulated and top 10 downregulated genes. <bold>c</bold> Violin plots demonstrate cell-level contributions to the group fold-change within each subject. Each violin corresponds to one subject and is colored by group</p></caption><graphic xlink:href="12859_2023_5432_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par24">At the threshold of <italic>p</italic> value &lt; 0.01, iDESC identified 5,577 and 1,124 DE genes in Kaminski and Misharin macrophage datasets, respectively, and 417 and 534 DE genes in Kaminski and Kropski fibroblast datasets, respectively. The top upregulated DE genes in IPF macrophage (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b), such as <italic>FN</italic>1, <italic>CCL</italic>18 and <italic>SPP</italic>1, were previously reported to be upregulated in IPF and related to IPF pathogenesis in macrophages [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR44">44</xref>, <xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR48">48</xref>, <xref ref-type="bibr" rid="CR51">51</xref>]. In fibroblast, <italic>CXCL</italic>14 and <italic>SFRP</italic>1 were identified among the top upregulated DE genes in IPF (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b), which were also found to be potential signatures of IPF in previous studies [<xref ref-type="bibr" rid="CR49">49</xref>, <xref ref-type="bibr" rid="CR50">50</xref>, <xref ref-type="bibr" rid="CR52">52</xref>–<xref ref-type="bibr" rid="CR54">54</xref>]. iDESC also identified <italic>CXCL</italic>12, a gene potentially related to the pulmonary fibrosis progression [<xref ref-type="bibr" rid="CR55">55</xref>, <xref ref-type="bibr" rid="CR56">56</xref>], to be upregulated in IPF fibroblast. To examine subject variations in these three datasets, we calculated cell-level effect coefficients [<xref ref-type="bibr" rid="CR20">20</xref>] for each subject in macrophage (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c) and fibroblast (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). Cell-level effect coefficients summarized the extent to which each cell reflects the group-level fold-change. For each cell type, both inter- and intra-subject variations of effect coefficients are different between the two chosen datasets, suggesting that the level of subject variation varies across different datasets potentially due to variations in biological background of subjects.</p>
      <p id="Par25">We further evaluated method performance based on the consistency of DE genes between datasets. For each method in each cell type, we overlapped the identified DE genes from the two chosen datasets (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a, b). Fisher’s exact test was conducted to assess the significance of overlap and Jaccard index was calculated to measure the similarity between the two DE gene lists for each method (Table <xref rid="Tab2" ref-type="table">2</xref>). The higher the overlap is, the more consistent the results are between datasets, indicating a better performance. Figure <xref rid="Fig6" ref-type="fig">6</xref>a shows that iDESC identified the largest number of between-dataset overlapping DE genes (808 genes) in macrophage. Although iDESC did not achieve the most between-dataset overlapping DE genes in fibroblast (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b), Table <xref rid="Tab2" ref-type="table">2</xref> shows that iDESC had the most significant between-dataset overlap in both cell types (macrophage: <italic>p</italic> = 1 × 10<sup>–5</sup>, fibroblast: <italic>p</italic> = 4 × 10<sup>–21</sup>), followed by muscat-PB (macrophage: <italic>p</italic> = 1 × 10<sup>–5</sup>, fibroblast: <italic>p</italic> = 2 × 10<sup>–7</sup>). In contrast, MAST-RE, muscat-MM and subT did not achieve significant between-dataset overlap in macrophage. They had significant overlap in fibroblast while their p-values were much larger than iDESC and others. In addition, iDESC had the largest Jaccard Index in both cell types (macrophage: JI = 0.137, fibroblast: JI = 0.077), followed by muscat-MM (macrophage: JI = 0.108, fibroblast: JI = 0.071).<fig id="Fig6"><label>Fig. 6</label><caption><p>Consistency and validation of DE genes overlapping between real datasets in macrophage and fibroblast. <bold>a</bold> Barplots showing the number of DE genes identified in the Kaminski (purple), Misharin (yellow) datasets and the overlap (grey) between them in macrophage. <bold>b</bold> Barplots showing the number of DE genes identified in the Kaminski (purple), Kropski (yellow) datasets and the overlap (grey) between them in fibroblast. <bold>c</bold> Barplots showing the percentage of IPF-related genes in the Harmonizome database identified in both the Kaminski and Misharin macrophage datasets</p></caption><graphic xlink:href="12859_2023_5432_Fig6_HTML" id="MO6"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption><p>Fisher’s exact test and Jaccard index measuring the DE genes overlapping between the two chosen scRNA-seq datasets in macrophage and fibroblast</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left"/><th align="left">iDESC</th><th align="left">MAST-RE</th><th align="left">Muscat-MM</th><th align="left">Muscat-PB</th><th align="left">subT</th></tr></thead><tbody><tr><td align="left" rowspan="2">Macrophage</td><td align="left"> <italic>P</italic> value</td><td align="left"><inline-formula id="IEq86"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\times {10}^{-5}$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq86.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq87"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.000$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mn>1.000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq87.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq88"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.269$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mn>0.269</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq88.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq89"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\times {10}^{-5}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq89.gif"/></alternatives></inline-formula></td><td char="." align="char">0.085</td></tr><tr><td align="left"> Jaccard Index</td><td align="left">0.137</td><td align="left"><inline-formula id="IEq90"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.061$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mn>0.061</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq90.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq91"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.108$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mn>0.108</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq91.gif"/></alternatives></inline-formula></td><td align="left">0.055</td><td char="." align="char">0.028</td></tr><tr><td align="left" rowspan="2">Fibroblast</td><td align="left"> <italic>P</italic> value</td><td align="left"><inline-formula id="IEq92"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4\times {10}^{-21}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq92.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq93"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4\times {10}^{-6}$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq93.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq94"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\times {10}^{-5}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq94.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq95"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2\times {10}^{-7}$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq95.gif"/></alternatives></inline-formula></td><td char="." align="char">0.011</td></tr><tr><td align="left"> Jaccard Index</td><td align="left">0.077</td><td align="left">0.067</td><td align="left">0.071</td><td align="left">0.035</td><td char="." align="char">0.024</td></tr></tbody></table></table-wrap></p>
      <p id="Par26">Lastly, we used a list of 83 IPF-related genes in the Harmonizome database [<xref ref-type="bibr" rid="CR57">57</xref>] to validate the between-dataset overlapping DE genes in each cell type identified by each method (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). In macrophage, iDESC had the highest proportion of validated genes (9.52%), followed by muscat-MM (8.73%), muscat-PB (7.94%), MAST-RE (7.14%) and subT (4.76%). In fibroblast, none of the methods had more than 3 genes that were found in the Harmonizome gene list, thus the validation results were not suitable for comparison.</p>
      <p id="Par27">To validate the top DE genes identified in the Kaminski macrophage dataset, we used the Kropski and Misharin macrophage datasets. Table <xref rid="Tab3" ref-type="table">3</xref> demonstrates that the top 10 upregulated DE genes identified using iDESC in the Kaminski macrophage dataset, if captured in either of the two validation datasets, were also significant (<italic>p</italic> &lt; 0.01) by iDESC in the Kropski and Misharin macrophage datasets. We also examined the expression distribution of the top 3 DE genes, <italic>FN</italic>1, <italic>CCL</italic>18 and <italic>SPP</italic>1, identified in the Kaminski macrophage dataset, in the three IPF macrophage datasets. Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2 shows that all three genes were differentially expressed between IPF and control (<italic>p</italic> &lt; 0.01, Wilcoxon rank sum test) in the three IPF macrophage datasets.<table-wrap id="Tab3"><label>Table 3</label><caption><p>DE analysis results using iDESC of the top 10 up-regulated DE genes, identified in the Kaminski macrophage dataset, in the three IPF macrophage datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Gene</th><th align="left" colspan="2">Kaminski</th><th align="left" colspan="2">Kropski</th><th align="left" colspan="2">Misharin</th></tr><tr><th align="left">Fold change</th><th align="left"><italic>P</italic> value</th><th align="left">Fold change</th><th align="left"><italic>P</italic> value</th><th align="left">Fold change</th><th align="left"><italic>P</italic> value</th></tr></thead><tbody><tr><td align="left"><italic>FN1</italic></td><td char="." align="char">2.882</td><td char="." align="char">7.01×10<sup>−32</sup></td><td align="left">2.639</td><td align="left">3.69×10<sup>−10</sup></td><td align="left"><italic>NA</italic></td><td align="left"><italic>NA</italic></td></tr><tr><td align="left"><italic>CCL18</italic></td><td char="." align="char">2.528</td><td char="." align="char">3.95×10<sup>−22</sup></td><td align="left">2.594</td><td align="left">3.68×10<sup>−4</sup></td><td align="left">1.725</td><td align="left">5.79×10<sup>−4</sup></td></tr><tr><td align="left"><italic>SPP1</italic></td><td char="." align="char">2.201</td><td char="." align="char">6.39×10<sup>−13</sup></td><td align="left">2.444</td><td align="left">1.63×10<sup>−3</sup></td><td align="left"><italic>NA</italic></td><td align="left"><italic>NA</italic></td></tr><tr><td align="left"><italic>S100A10</italic></td><td char="." align="char">1.827</td><td char="." align="char">2.75×10<sup>−17</sup></td><td align="left">2.418</td><td align="left">3.27×10<sup>−4</sup></td><td align="left"><italic>NA</italic></td><td align="left"><italic>NA</italic></td></tr><tr><td align="left"><italic>VIM</italic></td><td char="." align="char">1.807</td><td char="." align="char">1.19×10<sup>−29</sup></td><td align="left"><italic>NA</italic></td><td align="left"><italic>NA</italic></td><td align="left">1.392</td><td align="left">1.14×10<sup>−3</sup></td></tr><tr><td align="left"><italic>CSTB</italic></td><td char="." align="char">1.777</td><td char="." align="char">2.79×10<sup>−21</sup></td><td align="left">2.247</td><td align="left">3.11×10<sup>−8</sup></td><td align="left">2.106</td><td align="left">2.35×10<sup>−3</sup></td></tr><tr><td align="left"><italic>CD9</italic></td><td char="." align="char">1.702</td><td char="." align="char">2.71×10<sup>−17</sup></td><td align="left">1.517</td><td align="left">8.90×10<sup>−3</sup></td><td align="left">1.677</td><td align="left">2.44×10<sup>−3</sup></td></tr><tr><td align="left"><italic>LGALS1</italic></td><td char="." align="char">1.690</td><td char="." align="char">8.79×10<sup>−11</sup></td><td align="left">2.033</td><td align="left">2.22×10<sup>−6</sup></td><td align="left">1.633</td><td align="left">9.19×10<sup>−4</sup></td></tr><tr><td align="left"><italic>ACTB</italic></td><td char="." align="char">1.568</td><td char="." align="char">6.02×10<sup>−9</sup></td><td align="left"><italic>NA</italic></td><td align="left"><italic>NA</italic></td><td align="left">1.597</td><td align="left">7.35×10<sup>−3</sup></td></tr><tr><td align="left"><italic>LGALS3</italic></td><td char="." align="char">1.508</td><td char="." align="char">1.00×10<sup>−13</sup></td><td align="left">1.929</td><td align="left">1.83×10<sup>−3</sup></td><td align="left">1.530</td><td align="left">4.30×10<sup>−3</sup></td></tr></tbody></table><table-wrap-foot><p>NA represents that the gene was filtered and not included in the DE analysis in the corresponding dataset</p></table-wrap-foot></table-wrap></p>
      <p id="Par28">In summary, we evaluated method performance using real datasets based on consistency of results across different datasets and validation using previously reported IPF associated genes in public database and literatures. Our method, iDESC, achieved the best performance based on both evaluation criteria. The top DE genes identified by iDESC were highly biologically relevant, well supported by literatures, and validated by two other independent datasets.</p>
    </sec>
    <sec id="Sec8">
      <title>Computation time</title>
      <p id="Par29">The runtime of iDESC is 33.3 and 24.6 min to analyze the Kaminski and Kropski fibroblast datasets, respectively, using a 10-core, 100 GB RAM, Intel Xeon 2.6 GHz CPU machine. The computation time of iDESC is relatively long because of the mixed model fitting for subject effect and the consideration of dropouts. For a dataset of 50–100 subjects and ~ 2000 cells per sample, iDESC took about 50 h using a 10-core, 100 GB RAM, Intel Xeon 2.6 GHz CPU machine. To provide more information on computation time, we recorded the time of the five methods that consider subject effect, iDESC, MAST-RE, muscat-MM, muscat-PB and subT, on 10 genes in the Kaminski fibroblast dataset that includes 2,290 fibroblasts. Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1 displays the runtime on a single core. With parallel computing, the runtime of the mixed model-based methods, iDESC and muscat-MM, was further reduced to 9.74 and 9.51 s, respectively, on a 10-core machine.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Discussion</title>
    <p id="Par30">We have developed a new method, iDESC, to detect cell type specific DE genes between two groups of subjects in scRNA-seq data. iDESC fits a zero-inflated GLMM assuming dropouts to have zero count and captured expression to have a negative binomial distribution. Information across genes were pooled to model the dependency of dropout rate on gene expression level. Subject effect is modeled as a random effect in the log-mean of the negative binomial component. Wald test is used to assess the group mean difference in captured transcripts. We compared the performance of iDESC with elevent exiting DE analysis methods using both simulated data and real datasets. Permutation analysis using real data demonstrated that the type I errors of methods that consider subject effect were well calibrated, whereas the type I errors of methods that ignore subject effect were highly inflated. Using simulated data based on parameters estimated from real datasets, we showed that iDESC achieved comparable or higher power among methods that consider subject effect. In three independent scRNA-seq datasets of IPF patients and healthy controls, several of the top DE genes identified by iDESC were well supported by literatures regarding their important roles in IPF pathogenesis. Moreover, iDESC achieved the most consistent and validated results between independent datasets and using public database, respectively. These results demonstrated superior performance of iDESC over the other existing methods, suggesting the importance of considering subject effect and dropouts in the DE analysis of scRNA-seq data with multiple subjects.</p>
    <p id="Par31">Like most DE analysis methods for scRNA-seq data, iDESC requires accurate cell type annotation, which is a key step to ensure the validity and biological relevance of the downstream DE analysis. Cell clustering and cell type annotation are commonly performed with the removal of technical (batch) or biological (subject) effects through data integration. During this step, group/disease effect will be removed along with subject effect. Therefore, the downstream DE analysis will be performed on the original count or normalized data in each annotated cell type instead of the integrated data. Inaccurate cell typing may lead to data distribution deviated from the negative binomial distribution or with multiple modes. Possible remedies to reduce the negative impact of inaccurate cell type annotation include the following strategies. First, we strongly recommend examining the cell distribution through data visualization using UMAP and/or t-SNE plots and performing cell clustering to detect potential incorrect cell annotations. Second, a goodness-of-fit test for iDESC and/or replacing the negative binomial distribution with a multi-modal distribution or a mixture model may improve model fitting.</p>
    <p id="Par32">Despite the advantages of iDESC over the other DE analysis methods shown in this article, iDESC can be improved in several directions. First, in some cell types, when the cell-to-cell heterogeneity of certain genes is high or heterogeneous cell subtypes exist, negative binomial distribution may not fit the data well. Especially when heterogeneous cell subtypes are present in the data, the distribution of expression may be multi-modal. Data transformation, a goodness-of-fit test for iDESC and/or replacing negative binomial distribution with a multi-modal distribution or a mixture model may improve the model fitting. Second, estimation of dispersion parameter in a negative binomial distribution has been shown to be challenging. Multiple dispersion correction approaches [<xref ref-type="bibr" rid="CR39">39</xref>, <xref ref-type="bibr" rid="CR58">58</xref>–<xref ref-type="bibr" rid="CR60">60</xref>] that have been developed to improve accuracy can be used to further improve the performance of iDESC.</p>
    <p id="Par33">The computational speed of iDESC is relatively slow due to its consideration of dropouts and subject effect, which are critical for iDESC to achieve significant improvement in performance. Besides implementing parallel computing on high performance computers, the following two future work can potentially reduce the runtime of iDESC. First, the “glmmTMB” package uses the Template Model Builder (TMB) framework to calculate the first and second order derivatives of the likelihood function by automatic differentiation (AD). It is possible to speed up the algorithm by specifying the calculation of first and second order derivatives for the quasi-likelihood function of our model to skip this process. Second, the objective function of iDESC was optimized using the "nlminb" optimizer in an iterative scheme, which is an unconstrained quasi-Newton method optimizer. Replacing nlminb with a more efficient algorithm such as stochastic gradient descent (SGD) may further reduce the runtime.</p>
  </sec>
  <sec id="Sec10">
    <title>Conclusions</title>
    <p id="Par34">We developed iDESC, a zero-inflated negative binomial mixed model that considers both subject effect and dropouts, to identify cell type specific differentially expressed genes in scRNA-seq data with multiple subjects. iDESC had well-calibrated type I error and comparable or higher power than other existing DE methods. When applied to three independent scRNA-seq datasets with IPF patients and healthy controls, iDESC achieved the highest between-dataset consistency and validation rate based on genes found to be associated with IPF in public database.</p>
  </sec>
  <sec id="Sec11">
    <title>Materials and methods</title>
    <sec id="Sec12">
      <title>Statistical model</title>
      <p id="Par35">To identify cell type specific DE genes between two groups of subjects, iDESC uses a zero-inflated negative binomial mixed model to consider both subject effect and dropout events in scRNA-seq data with multiple subjects. The model includes two components: a zero component representing dropouts and a negative binomial component representing captured expression.</p>
      <p id="Par36">Suppose cells are collected from <inline-formula id="IEq10"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M44"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq10.gif"/></alternatives></inline-formula> subjects. In a given cell type of interest, subject <inline-formula id="IEq11"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M46"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq11.gif"/></alternatives></inline-formula> has <inline-formula id="IEq12"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}_{i}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq12.gif"/></alternatives></inline-formula> cells so that there are in total <inline-formula id="IEq13"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N={\sum }_{i=1}^{n}{m}_{i}$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq13.gif"/></alternatives></inline-formula> cells of the given type. Let <inline-formula id="IEq14"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{i}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq14.gif"/></alternatives></inline-formula> be the group label of subject <inline-formula id="IEq15"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M54"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq15.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq16"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{i}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq16.gif"/></alternatives></inline-formula> is 0 if subject <inline-formula id="IEq17"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M58"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq17.gif"/></alternatives></inline-formula> belongs to group 1 and 1 if subject <inline-formula id="IEq18"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M60"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq18.gif"/></alternatives></inline-formula> belongs to group 2. For each gene, let <inline-formula id="IEq19"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ijk}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq19.gif"/></alternatives></inline-formula> denote the observed UMI count of gene <inline-formula id="IEq20"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M64"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq20.gif"/></alternatives></inline-formula> in cell <inline-formula id="IEq21"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M66"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq21.gif"/></alternatives></inline-formula> from subject <inline-formula id="IEq22"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M68"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq22.gif"/></alternatives></inline-formula>. We model the UMI count as:<disp-formula id="Equa"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ijk}\left|{\pi }_{ijk},{\lambda }_{ik},{d}_{k}\right.\sim {\pi }_{ijk}\times {\mathbb{I}}_{\left\{{Y}_{ijk}=0\right\}}+\left(1-{\pi }_{ijk}\right)\times NB\left({S}_{ij}{\lambda }_{ik},{d}_{k}\right),$$\end{document}</tex-math><mml:math id="M70" display="block"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mfenced open="|"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo>∼</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:msub><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5432_Article_Equa.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equb"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{log}\left({\lambda }_{ik}\right)={\alpha }_{k}+{\beta }_{k}{X}_{i}+{\gamma }_{ik},$$\end{document}</tex-math><mml:math id="M72" display="block"><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5432_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq23"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\pi }_{ijk}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq23.gif"/></alternatives></inline-formula> is the dropout rate representing the probability of gene <inline-formula id="IEq24"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M76"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq24.gif"/></alternatives></inline-formula> being dropped out in cell <inline-formula id="IEq25"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M78"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq25.gif"/></alternatives></inline-formula> from subject <inline-formula id="IEq26"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M80"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq26.gif"/></alternatives></inline-formula>, <inline-formula id="IEq27"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{I}}_{\left\{\cdot \right\}}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{"><mml:mo>·</mml:mo></mml:mfenced></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq27.gif"/></alternatives></inline-formula> is the indicator function that takes value 1 when the condition in the brackets is satisfied, 0 otherwise, <inline-formula id="IEq28"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{ij}$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq28.gif"/></alternatives></inline-formula> is the total UMI counts of cell <inline-formula id="IEq29"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M86"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq29.gif"/></alternatives></inline-formula> from subject <inline-formula id="IEq30"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M88"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq30.gif"/></alternatives></inline-formula>, <inline-formula id="IEq31"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{ik}$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq31.gif"/></alternatives></inline-formula> is the rate parameter of the negative binomial distribution representing the true underlying relative gene expression level, and <inline-formula id="IEq32"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${d}_{k}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq32.gif"/></alternatives></inline-formula> is the dispersion parameter of gene <inline-formula id="IEq33"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M94"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq33.gif"/></alternatives></inline-formula>. The rate parameter <inline-formula id="IEq34"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{ik}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq34.gif"/></alternatives></inline-formula> is further modeled using a GLMM with log link, where <inline-formula id="IEq35"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{k}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>α</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq35.gif"/></alternatives></inline-formula> is the intercept, <inline-formula id="IEq36"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{k}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq36.gif"/></alternatives></inline-formula> is the group effect representing the log fold change of mean expression of gene <inline-formula id="IEq37"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M102"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq37.gif"/></alternatives></inline-formula> between the two groups, and <inline-formula id="IEq38"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\gamma }_{ik}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq38.gif"/></alternatives></inline-formula> is the gene-specific subject random effect, assumed to be independent and <inline-formula id="IEq39"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\gamma }_{ik} \sim N\left(0,{\sigma }_{k}^{2}\right)$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq39.gif"/></alternatives></inline-formula>.</p>
      <p id="Par37">Previous research found that the dropout rate of a given gene in a given cell depends on the expression level of the gene in the cell. Genes with lower expression level tend to have a higher dropout rate [<xref ref-type="bibr" rid="CR16">16</xref>]. In addition, the dropout rates vary among cells and are influenced by the quality of sequencing library, cell type and RNA-seq protocol [<xref ref-type="bibr" rid="CR16">16</xref>]. To quantify this dependency, we pooled information across genes and assumed that genes of similar average expression share similar dropout rates. In iDESC, we first calculated the proportion of zeros for each gene, and then fit a locally estimated scatterplot smoothing (LOESS) curve of the zero proportions against the log of gene-level average log-normalized UMI count across all cells. This overall LOESS curve captured the dependency of dropout rate on gene expression level and produced an initial estimate of dropout rates for all genes, denotes as <inline-formula id="IEq40"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\pi }_{k}^{0}$$\end{document}</tex-math><mml:math id="M108"><mml:msubsup><mml:mi>π</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq40.gif"/></alternatives></inline-formula>. Notice that the LOESS curve was obtained by assuming that the average log-normalized UMI count across all cells represents the true underlying gene expression. To relax this assumption, we introduce a parameter <inline-formula id="IEq41"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M110"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq41.gif"/></alternatives></inline-formula> to allow the true dropout rate to deviate from the initial estimate when the single-cell gene expression is zero. Furthermore, the subject-level LOESS curves obtained from cells of the same subject have slight variations from the overall LOESS curve, suggesting that dropout rate is likely to be subject/batch specific. Putting together, we model the dropout rate <inline-formula id="IEq42"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\pi }_{ijk}$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq42.gif"/></alternatives></inline-formula> as a GLMM with logit link:<disp-formula id="Equc"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{logit}\left({\pi }_{ijk}\right)=\mathrm{logit}\left({\pi }_{k}^{0}\right)+\theta \times {\mathbb{I}}_{\left\{{Y}_{ijk}=0\right\}}+{\eta }_{ik},$$\end{document}</tex-math><mml:math id="M114" display="block"><mml:mrow><mml:mi mathvariant="normal">logit</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">logit</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>π</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:mi>θ</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5432_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq43"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M116"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq43.gif"/></alternatives></inline-formula> is the deviation from the initial estimate for a gene when its expression level is zero, and <inline-formula id="IEq44"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\eta }_{ik}$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq44.gif"/></alternatives></inline-formula> is the gene-specific subject/batch random effect, assumed to be independent and <inline-formula id="IEq45"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\eta }_{ik} \sim N\left(0, {\tau }_{k}^{2}\right)$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq45.gif"/></alternatives></inline-formula>.</p>
      <p id="Par38">To test if gene <inline-formula id="IEq46"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M122"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq46.gif"/></alternatives></inline-formula> is differentially expressed between the two groups, we constructed a Wald statistic to test <inline-formula id="IEq47"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{0}: {\beta }_{k}=0$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq47.gif"/></alternatives></inline-formula> against <inline-formula id="IEq48"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{1}: {\beta }_{k}\ne 0$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq48.gif"/></alternatives></inline-formula> using an R package ‘glmmTMB’ [<xref ref-type="bibr" rid="CR61">61</xref>].</p>
    </sec>
    <sec id="Sec13">
      <title>Real datasets</title>
      <p id="Par39">We evaluated the performance of iDESC and other methods using three scRNA-seq datasets of whole lung samples from three independent IPF studies generated using the 10X Genomics Chromium platform. All datasets included IPF patients and healthy controls. In this article, we chose to focus on macrophage and fibroblast because both cell types have been recognized to play a significant role in IPF pathogenesis [<xref ref-type="bibr" rid="CR43">43</xref>–<xref ref-type="bibr" rid="CR50">50</xref>].</p>
      <p id="Par40">Kaminski refers to the scRNA-seq dataset of frozen distal lung parenchyma samples from 32 IPF and 28 control donor lungs in Adams et al. [<xref ref-type="bibr" rid="CR18">18</xref>]. The raw data include 38,070 genes, 101,230 macrophages and 2,290 fibroblasts.</p>
      <p id="Par41">Kropski refers to the scRNA-seq dataset of fresh whole lungs from 10 IPF patients and 8 healthy donors in Habermann et al. [<xref ref-type="bibr" rid="CR42">42</xref>]. The raw data include 31,054 genes, 11,532 macrophages and 1,644 fibroblasts.</p>
      <p id="Par42">Misharin refers to the scRNA-seq dataset of fresh lung tissues from 4 IPF patients and 8 transplant donors in Reyfman et al. [<xref ref-type="bibr" rid="CR17">17</xref>]. The raw data include 21,807 genes, 8,534 macrophages and 2,468 fibroblasts.</p>
    </sec>
    <sec id="Sec14">
      <title>Data preprocessing</title>
      <p id="Par43">The raw UMI count matrices of all three datasets were downloaded from the links provided in the publications. We integrated the three datasets for data visualization and noticed that the cell type nomenclature in these three datasets were quite different. For example, the fibroblasts in the Kaminski dataset were distinguished by expressing <italic>IGF</italic>1 and <italic>MFAP</italic>5, and these cells do not express <italic>ITGA</italic>8 or <italic>MYLK</italic> as the myofibroblasts in the Kaminski dataset. However, a good portion of the fibroblasts in the Misharin dataset and the <italic>PLIN</italic>2+ fibroblasts in the Kropski dataset expressed <italic>ITGA</italic>8 and <italic>MYLK</italic>, suggesting that they are similar to the myofibroblasts in the Kaminski dataset but not the fibroblasts. The difference in cell type nomenclature may lead the DE analysis results to be invalidated across the three datasets. To ensure cells of the same type were compared across the three datasets so that DE analysis results were comparable, we conducted integration analysis across the three datasets using Seurat [<xref ref-type="bibr" rid="CR62">62</xref>]. The graph-based Louvain clustering algorithm [<xref ref-type="bibr" rid="CR63">63</xref>] was applied to cluster cells. Cell clusters with substantial overlap across the three datasets in the UMAP of integrated data were extracted for downstream DE analysis. Based on this nomenclature matching, we had 43,028 macrophages and 2,290 fibroblasts from the Kaminski dataset, 3,635 macrophages from the Misharin dataset, and 8,663 macrophages and 1,615 fibroblasts from the Kropski dataset. For each cell type, we filtered out genes that were expressed in less than 5% of cells and removed subjects with less than 5 cells. When choosing datasets to evaluate the between-dataset consistency of DE analysis results by each method, we selected datasets with a median number of cells per subject larger than 10 to ensure sample size in the analysis.</p>
    </sec>
    <sec id="Sec15">
      <title>Type I error assessment</title>
      <p id="Par44">To assess type I error, we randomly permuted the group labels of subjects in both Kaminski and Kropski datasets so that no model assumptions were made in data generation and the within-subject cell-to-cell correlation structure was preserved in the data. The permuted datasets were not expected to show transcriptomic difference between the two groups. We performed 500 permutations on each dataset and applied all DE analysis methods to the permuted datasets. Genes with a <italic>p</italic> value &lt; 0.05 were considered significant. The empirical type I error for each gene was calculated as the proportion of permuted datasets having a <italic>p</italic> value &lt; 0.05 for the given gene.</p>
    </sec>
    <sec id="Sec16">
      <title>Power comparison</title>
      <p id="Par45">To compare the statistical power of all methods, we simulated single-cell expression data with ground truth to mimic the real datasets. Macrophages in the Kaminski dataset were used for this analysis. First, for each gene, we fit the following ZINB model on the macrophage data from all subjects in the Kaminski dataset to estimate gene-level dispersion <inline-formula id="IEq49"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${d}_{k}$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq49.gif"/></alternatives></inline-formula>, subject-specific dropout rate <inline-formula id="IEq50"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\pi }_{ik}$$\end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq50.gif"/></alternatives></inline-formula> and subject-specific relative gene expression level <inline-formula id="IEq51"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{ik}$$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq51.gif"/></alternatives></inline-formula>: <inline-formula id="IEq52"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ijk}\left|{\pi }_{ik},{\lambda }_{ik},{d}_{k}\right.\sim {\pi }_{ik}\times {\mathbb{I}}_{\left\{{Y}_{ijk}=0\right\}}+\left(1-{\pi }_{ik}\right)\times NB\left({S}_{ij}{\lambda }_{ik},{d}_{k}\right)$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mfenced open="|"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo>∼</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:msub><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq52.gif"/></alternatives></inline-formula>. The estimated <inline-formula id="IEq53"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{\pi }}_{ik}, {\widehat{\lambda }}_{ik}$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq53.gif"/></alternatives></inline-formula> and <inline-formula id="IEq54"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{d}}_{k}$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq54.gif"/></alternatives></inline-formula> were used in the simulation model to mimic real data. Second, we randomly sampled 30 subjects (15 IPF patients and 15 healthy controls) from the Kaminski dataset and extracted their <inline-formula id="IEq55"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{\pi }}_{ik}, {\widehat{\lambda }}_{ik}$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq55.gif"/></alternatives></inline-formula> and <inline-formula id="IEq56"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{d}}_{k}$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq56.gif"/></alternatives></inline-formula> to set up the simulation model. For each subject, <inline-formula id="IEq57"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M144"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq57.gif"/></alternatives></inline-formula> macrophages (<inline-formula id="IEq58"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m=20, 50, 100$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq58.gif"/></alternatives></inline-formula>) were simulated and their sequencing depths (<inline-formula id="IEq59"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{ij}$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq59.gif"/></alternatives></inline-formula>’s) were randomly sampled without replacement from the sequencing depths of all cells from the given subject. For each subject <inline-formula id="IEq60"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M150"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq60.gif"/></alternatives></inline-formula>, based on its parameter setting (<inline-formula id="IEq61"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{ij}$$\end{document}</tex-math><mml:math id="M152"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq61.gif"/></alternatives></inline-formula>’s, <inline-formula id="IEq62"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{\pi }}_{ik}, {\widehat{\lambda }}_{ik}$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq62.gif"/></alternatives></inline-formula> and <inline-formula id="IEq63"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{d}}_{k}$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq63.gif"/></alternatives></inline-formula>), two samples were simulated, one for each of the two groups. Let <inline-formula id="IEq64"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ijk}^{1}$$\end{document}</tex-math><mml:math id="M158"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq64.gif"/></alternatives></inline-formula> and <inline-formula id="IEq65"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ijk}^{2}$$\end{document}</tex-math><mml:math id="M160"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq65.gif"/></alternatives></inline-formula> be the simulated UMI counts of gene <inline-formula id="IEq66"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M162"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq66.gif"/></alternatives></inline-formula> in cell <inline-formula id="IEq67"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M164"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq67.gif"/></alternatives></inline-formula> for group 1 and group 2 samples generated from subject <inline-formula id="IEq68"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M166"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq68.gif"/></alternatives></inline-formula>, respectively, we have<disp-formula id="Equd"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\forall l\in \left\{1, 2\right\}: {Y}_{ijk}^{l}\sim {\pi }_{ijk}\times {\mathbb{I}}_{\left\{{Y}_{ijk}^{l}=0\right\}}+\left(1-{\pi }_{ijk}\right)\times NB\left({S}_{ij}{\widehat{\lambda }}_{ik}{e}^{{\beta }_{k}{\mathbb{I}}_{\left\{l=2\right\}}}, d\right),$$\end{document}</tex-math><mml:math id="M168" display="block"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mfenced><mml:mo>:</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo>∼</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:msub><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{"><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mfenced></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5432_Article_Equd.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Eque"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{logit}\left({\pi }_{ijk}\right)\sim N\left(\delta \times \mathrm{logit}\left({\widehat{\pi }}_{ik}\right), {\sigma }_{\pi }^{2}\right),$$\end{document}</tex-math><mml:math id="M170" display="block"><mml:mrow><mml:mi mathvariant="normal">logit</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mi>δ</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="normal">logit</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5432_Article_Eque.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq69"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l$$\end{document}</tex-math><mml:math id="M172"><mml:mi>l</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq69.gif"/></alternatives></inline-formula> is 1 for group 1 sample and 2 for group 2 sample, <inline-formula id="IEq70"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{k}$$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq70.gif"/></alternatives></inline-formula> is the log fold change of gene <inline-formula id="IEq71"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M176"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq71.gif"/></alternatives></inline-formula>’s expression between the two groups, <inline-formula id="IEq72"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d$$\end{document}</tex-math><mml:math id="M178"><mml:mi>d</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq72.gif"/></alternatives></inline-formula> is the dispersion, <inline-formula id="IEq73"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta$$\end{document}</tex-math><mml:math id="M180"><mml:mi>δ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq73.gif"/></alternatives></inline-formula> is capture efficiency, and <inline-formula id="IEq74"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{\pi }^{2}$$\end{document}</tex-math><mml:math id="M182"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq74.gif"/></alternatives></inline-formula> is the variability of dropout rate. Based on the median of <inline-formula id="IEq75"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{d}}_{k}$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq75.gif"/></alternatives></inline-formula> and the empirical estimation of variance of cell-level dropout rate, we set <inline-formula id="IEq76"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d=1$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq76.gif"/></alternatives></inline-formula> and <inline-formula id="IEq77"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{\pi }^{2}=2000$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>2000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq77.gif"/></alternatives></inline-formula> in all simulations. To choose genes with moderate to high expression level, we randomly selected 450 genes with <inline-formula id="IEq78"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{\lambda }}_{ik}\ge \frac{1}{{S}_{ij}}$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq78.gif"/></alternatives></inline-formula> for all cells and subjects, among which 150 were chosen to be DE genes and the remaining were non-DE genes. In each simulated dataset, for non-DE genes, the log fold change was set to <inline-formula id="IEq79"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{k}=0$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq79.gif"/></alternatives></inline-formula> and for the DE genes, <inline-formula id="IEq80"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{k}$$\end{document}</tex-math><mml:math id="M194"><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq80.gif"/></alternatives></inline-formula> was set to be the same value <inline-formula id="IEq81"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M196"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq81.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq82"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M198"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq82.gif"/></alternatives></inline-formula> varied from − 0.7 to − 0.1 and 0.1 to 0.7 with an increment of 0.1 across datasets. To simulate datasets with different levels of dropout rates, we set <inline-formula id="IEq83"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta =0.5, 1, 1.5$$\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq83.gif"/></alternatives></inline-formula>, where the higher the capture efficiency is the fewer zeros exist in the simulated data.</p>
      <p id="Par46">We applied all methods to the simulated datasets to identify DE genes under different p-value threshold. By comparing the identified DE genes to the ground truth, the area under an ROC curve (AUC) score as well as the sensitivity and specificity under the p-value threshold of 0.05 were calculated for each method to evaluate method performance.</p>
    </sec>
    <sec id="Sec17">
      <title>scRNA-seq data analysis</title>
      <p id="Par47">We applied the DE analysis methods that consider subject effect to macrophage and fibroblast separately from the three real datasets. Method performance was assessed based on the consistency of the identified DE genes between datasets. Genes with a <italic>p</italic> value &lt; 0.01 were considered to be differentially expressed. The cell-level effect coefficient [<xref ref-type="bibr" rid="CR20">20</xref>] was used to demonstrate subject variation. To calculate the effect coefficient for each cell, we calculated dot products of log-normalized expression and the estimated group effects across the DE genes identified by iDESC and then scaled to a maximum absolute value of 1. To compare the consistency of DE genes between datasets, Fisher’s exact test was used to assess the significance of overlap and Jaccard index was calculated to measure the similarity between the two DE gene lists. For the overlapping DE genes between the two chosen datasets identified by each method in each cell type, we validated them using a list of 83 genes that are related to IPF in the Harmonizome database (<ext-link ext-link-type="uri" xlink:href="https://maayanlab.cloud/Harmonizome/">https://maayanlab.cloud/Harmonizome/</ext-link>). The proportion of validated genes was calculated as the percentage of 83 genes that were the between-dataset overlapping DE genes.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec18">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5432_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Figure S1.</bold> Power comparison of iDESC and 7 methods without considering subject effect in simulated datasets. Evaluation criteria including (a) sensitivity and (b) specificity under the p-value threshold of 0.05, and (c) area under an ROC curve (AUC) to measure the accuracy of identified DE genes under three levels of capture efficiency (δ) and number of cells per subject (<italic>m</italic>). (d) ROC curves and the corresponding AUC scores when <italic>β</italic> = 0.4, <italic>δ</italic> = 1, <italic>m</italic> = 50.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2023_5432_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2: Figure S2.</bold> Boxplots showing the expression distribution of the top 3 DE genes, FN1, CCL18 and SPP1, in the three IPF macrophage datasets.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2023_5432_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 3: Table S1.</bold> Runtime of five methods using a single core.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p id="Par4">Single-cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>UMI</term>
        <def>
          <p id="Par5">Unique Molecular Identifier</p>
        </def>
      </def-item>
      <def-item>
        <term>IPF</term>
        <def>
          <p id="Par6">Idiopathic pulmonary fibrosis</p>
        </def>
      </def-item>
      <def-item>
        <term>DMSO</term>
        <def>
          <p id="Par7">Dimethyl sulfoxide</p>
        </def>
      </def-item>
      <def-item>
        <term>ROC</term>
        <def>
          <p id="Par8">Receiver operating characteristic</p>
        </def>
      </def-item>
      <def-item>
        <term>AUC</term>
        <def>
          <p id="Par9">Area under the curve</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>The original version of this article was revised: table 2 has been updated</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>
        <bold>Change history</bold>
      </p>
      <p>10/19/2023</p>
      <p>A Correction to this paper has been published: 10.1186/s12859-023-05523-6</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Ningshan Li, Qile Dai, Ran Tu and the Kaminski Lab for insightful comments and suggestions that helped improve the quality of the manuscript.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>YL, ZW and XY conceived the idea, developed the method, and designed the study. YL implemented the software and performed the analyses. JZ and TSA contributed to real data analysis. NW contributed to simulation data collection. TSA, JCS and NK provided IPF lung scRNA-seq data. TSA, JCS, WW, JEM, GLC and NK aided result interpretation. YL, ZW and XY wrote the manuscript. ZW and XY supervised the research. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was funded by National Institutes of Health Grants K01AA023321, R21LM012884, R01LM014087 and National Science Foundation Grant DMS1916246. The funders played no roles in the design of the study, analysis, interpretation of results, and preparation of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All analyses were run in R v3.5.3. An R package implementing the proposed method is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/yl883/iDESC">https://github.com/yl883/iDESC</ext-link> under the MIT license and was deposited to Zenodo (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.6929851">https://doi.org/10.5281/zenodo.6929851</ext-link>). The description of used data sets is in the “Real datasets” section. Barcodes of cells used for analysis can be found at Zenodo.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par48">No ethical approval was required for this study. All public datasets used in the paper were generated by other organizations that have obtained ethical approval.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par49">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par50">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gawad</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Koh</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Single-cell genome sequencing: current state of the science</article-title>
        <source>Nat Rev Genet</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>3</issue>
        <fpage>175</fpage>
        <lpage>188</lpage>
        <?supplied-pmid 26806412?>
        <pub-id pub-id-type="pmid">26806412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>5</issue>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <?supplied-pmid 26000488?>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>GX</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>14049</fpage>
        <?supplied-pmid 28091601?>
        <pub-id pub-id-type="pmid">28091601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stephenson</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq of rheumatoid arthritis synovial tissue using low-cost microfluidic instrumentation</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>791</fpage>
        <?supplied-pmid 29476078?>
        <pub-id pub-id-type="pmid">29476078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>
        <source>Cell Metab</source>
        <year>2016</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <?supplied-pmid 27667667?>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yao</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq reveals TOX as a key regulator of CD8(+) T cell persistence in chronic infection</article-title>
        <source>Nat Immunol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>7</issue>
        <fpage>890</fpage>
        <?supplied-pmid 31209400?>
        <pub-id pub-id-type="pmid">31209400</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pop</surname>
            <given-names>SM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single cell analysis shows decreasing FoxP3 and TGF beta 1 coexpressing CD4(+)CD25(+) regulatory T cells during autoimmune diabetes</article-title>
        <source>J Exp Med</source>
        <year>2005</year>
        <volume>201</volume>
        <issue>8</issue>
        <fpage>1333</fpage>
        <lpage>1346</lpage>
        <?supplied-pmid 15837817?>
        <pub-id pub-id-type="pmid">15837817</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chung</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq enables comprehensive tumour and immune cell profiling in primary breast cancer</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>15081</fpage>
        <?supplied-pmid 28474673?>
        <pub-id pub-id-type="pmid">28474673</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vieira Braga</surname>
            <given-names>FA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A cellular census of human lungs identifies novel cell states in health and in asthma</article-title>
        <source>Nat Med</source>
        <year>2019</year>
        <volume>25</volume>
        <issue>7</issue>
        <fpage>1153</fpage>
        <lpage>1163</lpage>
        <?supplied-pmid 31209336?>
        <pub-id pub-id-type="pmid">31209336</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grun</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>525</volume>
        <issue>7568</issue>
        <fpage>251</fpage>
        <?supplied-pmid 26287467?>
        <pub-id pub-id-type="pmid">26287467</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>2</issue>
        <fpage>155</fpage>
        <lpage>160</lpage>
        <?supplied-pmid 25599176?>
        <pub-id pub-id-type="pmid">25599176</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>GC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Challenges and emerging directions in single-cell analysis</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>84</fpage>
        <?supplied-pmid 28482897?>
        <pub-id pub-id-type="pmid">28482897</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Benson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Single-cell analyses to tailor treatments</article-title>
        <source>Sci Transl Med</source>
        <year>2017</year>
        <volume>9</volume>
        <issue>408</issue>
        <fpage>eaan4730</fpage>
        <?supplied-pmid 28931656?>
        <pub-id pub-id-type="pmid">28931656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luecken</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Current best practices in single-cell RNA-seq analysis: a tutorial</article-title>
        <source>Mol Syst Biol</source>
        <year>2019</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>e8746</fpage>
        <?supplied-pmid 31217225?>
        <pub-id pub-id-type="pmid">31217225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Squair</surname>
            <given-names>JW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Confronting false discoveries in single-cell differential expression</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>5692</fpage>
        <?supplied-pmid 34584091?>
        <pub-id pub-id-type="pmid">34584091</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kharchenko</surname>
            <given-names>PV</given-names>
          </name>
          <name>
            <surname>Silberstein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Scadden</surname>
            <given-names>DT</given-names>
          </name>
        </person-group>
        <article-title>Bayesian approach to single-cell differential expression analysis</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>7</issue>
        <fpage>740</fpage>
        <lpage>742</lpage>
        <?supplied-pmid 24836921?>
        <pub-id pub-id-type="pmid">24836921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reyfman</surname>
            <given-names>PA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomic analysis of human lung provides insights into the pathobiology of pulmonary fibrosis</article-title>
        <source>Am J Respir Crit Care Med</source>
        <year>2019</year>
        <volume>199</volume>
        <issue>12</issue>
        <fpage>1517</fpage>
        <lpage>1536</lpage>
        <?supplied-pmid 30554520?>
        <pub-id pub-id-type="pmid">30554520</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adams</surname>
            <given-names>TS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq reveals ectopic and aberrant lung-resident cell populations in idiopathic pulmonary fibrosis</article-title>
        <source>Sci Adv</source>
        <year>2020</year>
        <volume>6</volume>
        <issue>28</issue>
        <fpage>eaba1983</fpage>
        <?supplied-pmid 32832599?>
        <pub-id pub-id-type="pmid">32832599</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zimmerman</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Espeland</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Langefeld</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>A practical solution to pseudoreplication bias in single-cell studies</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>738</fpage>
        <?supplied-pmid 33531494?>
        <pub-id pub-id-type="pmid">33531494</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crowell</surname>
            <given-names>HL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>muscat detects subpopulation-specific state transitions from multi-sample multi-condition single-cell transcriptomics data</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>6077</fpage>
        <?supplied-pmid 33257685?>
        <pub-id pub-id-type="pmid">33257685</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep generative modeling for single-cell transcriptomics</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>1053</fpage>
        <lpage>1058</lpage>
        <?supplied-pmid 30504886?>
        <pub-id pub-id-type="pmid">30504886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wohnhaas</surname>
            <given-names>CT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DMSO cryopreservation is the method of choice to preserve cells for droplet-based single-cell RNA sequencing</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>10699</fpage>
        <?supplied-pmid 31337793?>
        <pub-id pub-id-type="pmid">31337793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>4</issue>
        <fpage>255</fpage>
        <lpage>261</lpage>
        <?supplied-pmid 29481549?>
        <pub-id pub-id-type="pmid">29481549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dal Molin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Baruzzo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Di Camillo</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-sequencing: assessment of differential expression analysis methods</article-title>
        <source>Front Genet</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>62</fpage>
        <pub-id pub-id-type="pmid">28588607</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaakkola</surname>
            <given-names>MK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of methods to detect differentially expressed genes between single-cell populations</article-title>
        <source>Brief Bioinform</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>5</issue>
        <fpage>735</fpage>
        <lpage>743</lpage>
        <?supplied-pmid 27373736?>
        <pub-id pub-id-type="pmid">27373736</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vallejos</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>BASiCS: Bayesian analysis of single-cell sequencing data</article-title>
        <source>PLoS Comput Biol</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>6</issue>
        <fpage>e1004333</fpage>
        <?supplied-pmid 26107944?>
        <pub-id pub-id-type="pmid">26107944</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accounting for technical noise in differential expression analysis of single-cell RNA sequencing data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>19</issue>
        <fpage>10978</fpage>
        <lpage>10988</lpage>
        <?supplied-pmid 29036714?>
        <pub-id pub-id-type="pmid">29036714</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell mRNA quantification and differential analysis with Census</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>3</issue>
        <fpage>309</fpage>
        <lpage>315</lpage>
        <?supplied-pmid 28114287?>
        <pub-id pub-id-type="pmid">28114287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reversed graph embedding resolves complex single-cell trajectories</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>10</issue>
        <fpage>979</fpage>
        <lpage>982</lpage>
        <?supplied-pmid 28825705?>
        <pub-id pub-id-type="pmid">28825705</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <issue>4</issue>
        <fpage>381</fpage>
        <lpage>386</lpage>
        <?supplied-pmid 24658644?>
        <pub-id pub-id-type="pmid">24658644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>UMI-count modeling and differential expression analysis for single-cell RNA sequencing</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>70</fpage>
        <?supplied-pmid 29855333?>
        <pub-id pub-id-type="pmid">29855333</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miao</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DEsingle for detecting three types of differential expression in single-cell RNA-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>18</issue>
        <fpage>3223</fpage>
        <lpage>3224</lpage>
        <?supplied-pmid 29688277?>
        <pub-id pub-id-type="pmid">29688277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ye</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Salim</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>DECENT: differential expression with capture efficiency adjustmeNT for single-cell RNA-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>24</issue>
        <fpage>5155</fpage>
        <lpage>5162</lpage>
        <?supplied-pmid 31197307?>
        <pub-id pub-id-type="pmid">31197307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Two-phase differential expression analysis for single cell RNA-seq</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>19</issue>
        <fpage>3340</fpage>
        <lpage>3348</lpage>
        <?supplied-pmid 29688282?>
        <pub-id pub-id-type="pmid">29688282</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>278</fpage>
        <?supplied-pmid 26653891?>
        <pub-id pub-id-type="pmid">26653891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vieth</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A systematic evaluation of single cell RNA-seq analysis pipelines</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>4667</fpage>
        <?supplied-pmid 31604912?>
        <pub-id pub-id-type="pmid">31604912</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korthauer</surname>
            <given-names>KD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A statistical approach for identifying differential distributions in single-cell RNA-seq experiments</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>222</fpage>
        <?supplied-pmid 27782827?>
        <pub-id pub-id-type="pmid">27782827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delmans</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Discrete distributional differential expression (D3E)–a tool for gene expression analysis of single-cell RNA-seq data</article-title>
        <source>BMC Bioinform</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>110</fpage>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>550</fpage>
        <?supplied-pmid 25516281?>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ritchie</surname>
            <given-names>ME</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>7</issue>
        <fpage>e47</fpage>
        <?supplied-pmid 25605792?>
        <pub-id pub-id-type="pmid">25605792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilcoxon</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Individual comparisons of grouped data by ranking methods</article-title>
        <source>J Econ Entomol</source>
        <year>1946</year>
        <volume>39</volume>
        <fpage>269</fpage>
        <?supplied-pmid 20983181?>
        <pub-id pub-id-type="pmid">20983181</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Habermann</surname>
            <given-names>AC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA sequencing reveals profibrotic roles of distinct epithelial and mesenchymal lineages in pulmonary fibrosis</article-title>
        <source>Sci Adv</source>
        <year>2020</year>
        <volume>6</volume>
        <issue>28</issue>
        <fpage>eaba1972</fpage>
        <?supplied-pmid 32832598?>
        <pub-id pub-id-type="pmid">32832598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wynes</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Riches</surname>
            <given-names>DW</given-names>
          </name>
        </person-group>
        <article-title>Transcription of macrophage IGF-I exon 1 is positively regulated by the 5'-untranslated region and negatively regulated by the 5'-flanking region</article-title>
        <source>Am J Physiol Lung Cell Mol Physiol</source>
        <year>2005</year>
        <volume>288</volume>
        <issue>6</issue>
        <fpage>L1089</fpage>
        <lpage>L1098</lpage>
        <?supplied-pmid 15681396?>
        <pub-id pub-id-type="pmid">15681396</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Morse C et al. Proliferating SPP1/MERTK-expressing macrophages in idiopathic pulmonary fibrosis. Eur Respir J. 2019;54(2):1802441.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioinformatics analysis on differentially expressed genes of alveolar macrophage in IPF</article-title>
        <source>Exp Lung Res</source>
        <year>2019</year>
        <volume>45</volume>
        <issue>9–10</issue>
        <fpage>288</fpage>
        <lpage>296</lpage>
        <?supplied-pmid 31762326?>
        <pub-id pub-id-type="pmid">31762326</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Bargagli E et al. Macrophage-derived biomarkers of idiopathic pulmonary fibrosis. Pulm Med 2011;2011:717130.</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schupp</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Macrophage activation in acute exacerbation of idiopathic pulmonary fibrosis</article-title>
        <source>PLoS ONE</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>e0116775</fpage>
        <?supplied-pmid 25590613?>
        <pub-id pub-id-type="pmid">25590613</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prasse</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CCL18 as an indicator of pulmonary fibrotic activity in idiopathic interstitial pneumonias and systemic sclerosis</article-title>
        <source>Arthritis Rheum</source>
        <year>2007</year>
        <volume>56</volume>
        <issue>5</issue>
        <fpage>1685</fpage>
        <lpage>1693</lpage>
        <?supplied-pmid 17469163?>
        <pub-id pub-id-type="pmid">17469163</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peyser</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Defining the activated fibroblast population in lung fibrosis using single-cell sequencing</article-title>
        <source>Am J Respir Cell Mol Biol</source>
        <year>2019</year>
        <volume>61</volume>
        <issue>1</issue>
        <fpage>74</fpage>
        <lpage>85</lpage>
        <?supplied-pmid 30848683?>
        <pub-id pub-id-type="pmid">30848683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rodriguez</surname>
            <given-names>LR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Global gene expression analysis in an in vitro fibroblast model of idiopathic pulmonary fibrosis reveals potential role for CXCL14/CXCR4</article-title>
        <source>Sci Rep</source>
        <year>2018</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>3983</fpage>
        <?supplied-pmid 29507348?>
        <pub-id pub-id-type="pmid">29507348</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Wan H. et al. Identification of hub genes and pathways associated with idiopathic pulmonary fibrosis via bioinformatics analysis. Front Mol Biosci 2021;8:711239.</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Selman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pardo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kaminski</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Idiopathic pulmonary fibrosis: Aberrant recapitulation of developmental programs?</article-title>
        <source>PLoS Med</source>
        <year>2008</year>
        <volume>5</volume>
        <issue>3</issue>
        <fpage>e62</fpage>
        <?supplied-pmid 18318599?>
        <pub-id pub-id-type="pmid">18318599</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CXCL14 is a candidate biomarker for Hedgehog signalling in idiopathic pulmonary fibrosis</article-title>
        <source>Thorax</source>
        <year>2017</year>
        <volume>72</volume>
        <issue>9</issue>
        <fpage>780</fpage>
        <lpage>787</lpage>
        <?supplied-pmid 28250200?>
        <pub-id pub-id-type="pmid">28250200</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Ishii T. et al. Elevated levels of BRAK/CXCL14 from patients with idiopathic pulmonary fibrosis. C103. Pathogenesis, Biomarkers, and Risk Factors for Interstitial Lung Disease: from Bench to Bedside. 2012; p. A5178.</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shu</surname>
            <given-names>H-KG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inhibition of the CXCL12/CXCR4-axis as preventive therapy for radiation-induced pulmonary fibrosis</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>11</issue>
        <fpage>e79768</fpage>
        <?supplied-pmid 24244561?>
        <pub-id pub-id-type="pmid">24244561</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chow</surname>
            <given-names>LN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Impact of a CXCL12/CXCR4 antagonist in bleomycin (BLM) induced pulmonary fibrosis and carbon tetrachloride (CCl4) induced hepatic fibrosis in mice</article-title>
        <source>PLoS ONE</source>
        <year>2016</year>
        <volume>11</volume>
        <issue>3</issue>
        <fpage>e0151765</fpage>
        <?supplied-pmid 26998906?>
        <pub-id pub-id-type="pmid">26998906</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Rouillard AD et al. The harmonizome: a collection of processed datasets gathered to serve and mine knowledge about genes and proteins<italic>.</italic> Database. 2016;2016:baw100.</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Small-sample estimation of negative binomial dispersion, with applications to SAGE data</article-title>
        <source>Biostatistics</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>321</fpage>
        <lpage>332</lpage>
        <?supplied-pmid 17728317?>
        <pub-id pub-id-type="pmid">17728317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lloyd-Smith</surname>
            <given-names>JO</given-names>
          </name>
        </person-group>
        <article-title>maximum likelihood estimation of the negative binomial dispersion parameter for highly overdispersed data, with applications to infectious diseases</article-title>
        <source>PLoS ONE</source>
        <year>2007</year>
        <volume>2</volume>
        <issue>2</issue>
        <fpage>e180</fpage>
        <?supplied-pmid 17299582?>
        <pub-id pub-id-type="pmid">17299582</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>CR</given-names>
          </name>
        </person-group>
        <article-title>Large sample tests of statistical hypotheses concerning several parameters with applications to problems of estimation</article-title>
        <source>Proc Camb Philos Soc</source>
        <year>1948</year>
        <volume>44</volume>
        <issue>1</issue>
        <fpage>50</fpage>
        <lpage>57</lpage>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brooks</surname>
            <given-names>ME</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>glmmTMB balances speed and flexibility among packages for zero-inflated generalized linear mixed modeling</article-title>
        <source>R J</source>
        <year>2017</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>378</fpage>
        <lpage>400</lpage>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive Integration of Single-Cell Data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <issue>7</issue>
        <fpage>1888</fpage>
        <lpage>1902</lpage>
        <?supplied-pmid 31178118?>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blondel</surname>
            <given-names>VD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast unfolding of communities in large networks</article-title>
        <source>J Stat Mech Theory Exp</source>
        <year>2008</year>
        <volume>2008</volume>
        <fpage>10008</fpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10463720</article-id>
    <article-id pub-id-type="pmid">37608264</article-id>
    <article-id pub-id-type="publisher-id">5432</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-023-05432-8</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>iDESC: identifying differential expression in single-cell RNA sequencing data with multiple subjects</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Liu</surname>
          <given-names>Yunqing</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhao</surname>
          <given-names>Jiayi</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Adams</surname>
          <given-names>Taylor S.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Ningya</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schupp</surname>
          <given-names>Jonas C.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Weimiao</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McDonough</surname>
          <given-names>John E.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chupp</surname>
          <given-names>Geoffrey L.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kaminski</surname>
          <given-names>Naftali</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Wang</surname>
          <given-names>Zuoheng</given-names>
        </name>
        <address>
          <email>zuoheng.wang@yale.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8688-9004</contrib-id>
        <name>
          <surname>Yan</surname>
          <given-names>Xiting</given-names>
        </name>
        <address>
          <email>xiting.yan@yale.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.47100.32</institution-id><institution-id institution-id-type="ISNI">0000000419368710</institution-id><institution>Department of Biostatistics, </institution><institution>Yale School of Public Health, </institution></institution-wrap>New Haven, CT 06520 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.47100.32</institution-id><institution-id institution-id-type="ISNI">0000000419368710</institution-id><institution>Section of Pulmonary, Critical Care and Sleep Medicine, </institution><institution>Yale School of Medicine, </institution></institution-wrap>New Haven, CT 06520 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.452624.3</institution-id><institution>Department of Respiratory Medicine, Hannover Medical School and Biomedical Research in End-Stage and Obstructive Lung Disease Hannover, </institution><institution>German Center for Lung Research (DZL), </institution></institution-wrap>Hannover, Germany </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ROR">https://ror.org/01zbnvs85</institution-id><institution-id institution-id-type="GRID">grid.453567.6</institution-id><institution-id institution-id-type="ISNI">0000 0004 0615 529X</institution-id><institution>Meta Platforms, Inc, </institution></institution-wrap>Cambridge, USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>22</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>22</day>
      <month>8</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>318</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>7</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023, corrected publication 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold> This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Single-cell RNA sequencing (scRNA-seq) technology has enabled assessment of transcriptome-wide changes at single-cell resolution. Due to the heterogeneity in environmental exposure and genetic background across subjects, subject effect contributes to the major source of variation in scRNA-seq data with multiple subjects, which severely confounds cell type specific differential expression (DE) analysis. Moreover, dropout events are prevalent in scRNA-seq data, leading to excessive number of zeroes in the data, which further aggravates the challenge in DE analysis.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We developed iDESC to detect cell type specific DE genes between two groups of subjects in scRNA-seq data. iDESC uses a zero-inflated negative binomial mixed model to consider both subject effect and dropouts. The prevalence of dropout events (dropout rate) was demonstrated to be dependent on gene expression level, which is modeled by pooling information across genes. Subject effect is modeled as a random effect in the log-mean of the negative binomial component. We evaluated and compared the performance of iDESC with eleven existing DE analysis methods. Using simulated data, we demonstrated that iDESC had well-controlled type I error and higher power compared to the existing methods. Applications of those methods with well-controlled type I error to three real scRNA-seq datasets from the same tissue and disease showed that the results of iDESC achieved the best consistency between datasets and the best disease relevance.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">iDESC was able to achieve more accurate and robust DE analysis results by separating subject effect from disease effect with consideration of dropouts to identify DE genes, suggesting the importance of considering subject effect and dropouts in the DE analysis of scRNA-seq data with multiple subjects.</p>
      </sec>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s12859-023-05432-8.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Single-cell RNA sequencing</kwd>
      <kwd>Differential expression analysis</kwd>
      <kwd>Subject effect</kwd>
      <kwd>Zero-inflated negative binomial mixed model</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000027</institution-id>
            <institution>National Institute on Alcohol Abuse and Alcoholism</institution>
          </institution-wrap>
        </funding-source>
        <award-id>K01AA023321</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wang</surname>
            <given-names>Zuoheng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000092</institution-id>
            <institution>U.S. National Library of Medicine</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R21LM012884</award-id>
        <award-id>R01LM014087</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yan</surname>
            <given-names>Xiting</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000001</institution-id>
            <institution>National Science Foundation</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DMS1916246</award-id>
        <principal-award-recipient>
          <name>
            <surname>Wang</surname>
            <given-names>Zuoheng</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© BioMed Central Ltd., part of Springer Nature 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par10">Recent advances in droplet-based single-cell RNA sequencing (scRNA-seq) technology have enabled investigators to assess transcriptome-wide differences at single-cell resolution [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR3">3</xref>]. Instead of pooling RNAs from all cells together, droplet-based scRNA-seq technology isolates cells using oil droplets, in which each cell is lysed and a cell barcode and a unique molecular identifier (UMI) are added onto the amplified cDNAs. Using these cell barcodes and UMIs, sequencing reads are demultiplexed into different cells and transcripts, which enables single-cell transcriptome profiling without PCR amplification bias. In recent years, scRNA-seq has been used to study cellular heterogeneity and gene expression variability across different cell types in diverse human tissues [<xref ref-type="bibr" rid="CR4">4</xref>] and diseases (chronic diseases [<xref ref-type="bibr" rid="CR5">5</xref>], infectious diseases [<xref ref-type="bibr" rid="CR6">6</xref>], autoimmune diseases [<xref ref-type="bibr" rid="CR7">7</xref>], and cancers [<xref ref-type="bibr" rid="CR8">8</xref>]). These applications have revealed disease-related cell type specific transcriptomic changes [<xref ref-type="bibr" rid="CR9">9</xref>], rare cell types [<xref ref-type="bibr" rid="CR10">10</xref>], and cell type composition changes [<xref ref-type="bibr" rid="CR11">11</xref>], providing important insights into disease pathogenesis and facilitating the development of personalized treatment of diseases [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>].</p>
    <p id="Par11">Despite the great potential of scRNA-seq technology, challenges remain in the corresponding data analysis. Specifically, one common task in scRNA-seq data analysis is to identify cell type specific differentially expressed (DE) genes between two groups of subjects [<xref ref-type="bibr" rid="CR14">14</xref>], which can be challenging due to prevalent dropout events and substantial subject effect, or so-called between biological replicate variation [<xref ref-type="bibr" rid="CR15">15</xref>]. Dropout refers to the event when a given gene is observed at a moderate expression level in one cell but is not detected in another cell of the same type from the same sample [<xref ref-type="bibr" rid="CR16">16</xref>], leading to underestimation of gene expression level and overestimation of variation in the data which may generate false positive results. Moreover, with the popularity of multi-sample scRNA-seq datasets from different diseases, tissues, and cell types, many of them have consistently shown that within the same cell type, cells of the same subject cluster together but separate well from cells of other subjects [<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>]. This suggests that there exists a large variation across subjects possibly due to heterogeneous genetic backgrounds or environmental exposures and this variation is much larger than the within-subject variation across cells of the same type. Dominant subject effect severely confounds the DE analysis of scRNA-seq data because genes driving differences across subjects are likely to also be significantly different between two groups [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR19">19</xref>, <xref ref-type="bibr" rid="CR20">20</xref>]. Taken together, in the DE analysis of scRNA-seq data with multiple subjects, it is critical to separate subject effect from disease effect with consideration of dropout events.</p>
    <p id="Par12">Technical batch effect is one possible reason for the large variation across subjects because many studies processed cells and cDNA libraries from different subjects in different batches due to the requirement of sample freshness in certain tissue types and early-stage scRNA-seq protocols. This may lead to batch effect in the data so that cells of the same type from different subjects have different expression profiles. However, in the scRNA-seq dataset from patients with idiopathic pulmonary fibrosis (IPF), the large variation across subjects was still present after adjusting for batch effect using scVI [<xref ref-type="bibr" rid="CR21">21</xref>]. In addition, recent advances in combining scRNA-seq with upstream cell cryopreservation using dimethyl sulfoxide (DMSO) have enabled preservation of cells so that samples from different subjects can be processed together [<xref ref-type="bibr" rid="CR22">22</xref>]. Comparison between scRNA-seq data from the same sputum sample with and without DMSO preservation showed no significant difference between the fresh and DMSO data but significant separation between different subjects was still present (unpublished data). Since the fresh and DMSO data from the same sample were generated in two different batches, this confirmed that the large between-subject variation was a consequence of biological subject effect but not technical batch effect. Therefore, it is inadequate to consider this variation as technical batch effect and remove it using batch effect adjustment tools in scRNA-seq data. In fact, removing this variation as technical batch effect may remove the disease effect of interest because subject effect confounds with disease effect.</p>
    <p id="Par13">Many DE analysis methods for scRNA-seq data have been developed and compared [<xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR25">25</xref>]. They can be classified into two categories depending on whether subject effect is considered. Although methods that ignore subject effect have been used in DE analysis, they are more suitable for identification of marker genes for a given cell type, which is fundamentally different from DE analysis.</p>
    <p id="Par14">Within the category of methods that ignore subject effect, there are methods specifically designed for scRNA-seq data and methods adopted from bulk RNA-seq DE analysis. Among the methods designed for scRNA-seq data, BASiCS [<xref ref-type="bibr" rid="CR26">26</xref>] and TASC [<xref ref-type="bibr" rid="CR27">27</xref>] require external RNA spike-ins to provide information on technical variation and use a Bayesian hierarchical Poisson-Gamma model and a hierarchical Poisson-lognormal model, respectively, to fit data. Monocle [<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref>] and NBID [<xref ref-type="bibr" rid="CR31">31</xref>] model UMI counts of each gene using a negative binomial distribution without considering dropouts. To account for dropouts, a group of methods were developed including DEsingle [<xref ref-type="bibr" rid="CR32">32</xref>], DESCENT [<xref ref-type="bibr" rid="CR33">33</xref>], SC2P [<xref ref-type="bibr" rid="CR34">34</xref>], SCDE [<xref ref-type="bibr" rid="CR16">16</xref>] and MAST [<xref ref-type="bibr" rid="CR35">35</xref>]. These methods utilize mixture models or hierarchical models, mostly zero-inflated, to model dropouts and captured transcripts. DEsingle fits a zero-inflated negative binomial model in each group and conducts a likelihood ratio test for significance assessment. DESCENT models UMI counts using a hierarchical model which assumes that the true underlying expression follows a zero-inflated negative binomial distribution and the capturing process generating the observed data follows a beta-binomial distribution. SC2P models dropout events using a zero-inflated Poisson distribution and fits the detected transcripts using a lognormal-Poisson distribution. The assumption in SC2P that the cell-specific dropout rate and dropout distribution are shared by all genes may eliminate the natural stochasticity in scRNA-seq data. SCDE employs a two-component mixture model with a negative binomial and a low-magnitude Poisson component to model efficiently amplified read-outs and dropout events, respectively. The dropout rate for a given gene is determined by its true underlying expression level in the cell, which is estimated based on a selected subset of highly expressed genes. MAST uses a two-part hurdle model in which dropout rates are modeled by a logistic regression model and non-zero expression follows a Gaussian distribution. SC2P, SCDE and MAST were originally designed for Transcript Per Kilobase Million (TPM) data which has different technical noise and data distribution from UMI count data [<xref ref-type="bibr" rid="CR36">36</xref>]. Multimodality has been observed in scRNA-seq data due to cellular heterogeneity within the same cell type. To consider multimodality, scDD [<xref ref-type="bibr" rid="CR37">37</xref>] was designed to model count data with a Dirichlet process to detect genes with difference in mean expression, proportion of the same component, or modality between groups. D3E [<xref ref-type="bibr" rid="CR38">38</xref>], a nonparametric method, fits a bursting model for transcriptional regulation and compares the gene expression distribution between two groups. It was previously reported to generate false-positive results on negative control datasets [<xref ref-type="bibr" rid="CR24">24</xref>]. A recent study [<xref ref-type="bibr" rid="CR23">23</xref>] showed that bulk RNA-seq analysis methods, including DESeq2 [<xref ref-type="bibr" rid="CR39">39</xref>], limma-trend [<xref ref-type="bibr" rid="CR40">40</xref>], and Wilcoxon rank sum test [<xref ref-type="bibr" rid="CR41">41</xref>], have comparable performance to methods designed for scRNA-seq data when applied to the cell-level UMI count data, especially after filtering out lowly expressed genes.</p>
    <p id="Par15">All the methods mentioned above treat cells from the same subject as independent, which may be efficient for identifying cell type marker genes, but inappropriate for DE analysis to identify disease or phenotype associated genes due to the presence of dominant subject effect confounded with disease effect as described above. One simple and straightforward solution is to aggregate expression levels of cells from the same subject by averaging and then to compare the aggregated sample-level “pseudo-bulk” expression levels between two groups of subjects using Student’s t test. We denote this method as subject-t-test (subT). Furthermore, two recent studies proposed the following three DE analysis methods to consider subject effect in scRNA-seq data. Zimmerman et al. [<xref ref-type="bibr" rid="CR19">19</xref>] developed MAST-RE by adding a subject random effect to the non-zero expression part of the hurdle model in MAST. The muscat package [<xref ref-type="bibr" rid="CR20">20</xref>] provides two approaches to consider subject effect: (1) muscat-PB that aggregates cell-level UMI counts into sample-level “pseudo-bulk” counts which are then compared between two groups using edgeR that was developed for DE analysis in bulk RNA-seq data; and (2) muscat-MM that fits a generalized linear mixed model (GLMM) on the cell-level UMI counts to account for subject variation. Both muscat-PB and muscat-MM were compared to other methods and shown to have power gain by considering subject effect [<xref ref-type="bibr" rid="CR15">15</xref>].</p>
    <p id="Par16">In this article, we develop a new statistical model to identify DE genes in scRNA-seq data with multiple subjects, named iDESC. A zero-inflated negative binomial mixed model is used to consider both subject effect and dropouts. iDESC models dropout events as inflated zeros by pooling information across genes and assuming that genes with similar expression share similar dropout rates. In addition, iDESC allows dropout rate to be subject/batch specific. The non-dropout events are modeled by a negative binomial distribution. In the negative binomial component, a random effect is used to separate subject effect from disease effect. Wald statistic is used to assess the significance of disease effect. We compared iDESC with 11 existing DE analysis methods based on type I error, statistical power, between-dataset consistency and validation using both simulated and real datasets.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Dependency of dropout rate on gene expression</title>
      <p id="Par17">Previous studies reported that the dropout rate of a gene in a given cell depends on the expected expression level of the gene in the cell and dropout events are more prevalent for genes with lower expression [<xref ref-type="bibr" rid="CR16">16</xref>]. As expected, in both macrophage and fibroblast across the three real datasets, we observed decreasing patterns in the gene-level proportion of zeros when the average log-normalized UMI count across all cells increases (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, b). Assuming that genes with similar average expression share similar dropout rates, we pooled information across genes to obtain an S-shape curve describing the dependency of dropout rate on gene expression level using locally estimated scatterplot smoothing (LOESS) regression. Heterogeneity of this dependency across different subjects was also observed when we stratified cells by subjects to obtain the subject-level LOESS curves, suggesting that dropout rate is likely to be subject/batch specific (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c, d).<fig id="Fig1"><label>Fig. 1</label><caption><p>Dependency of dropout rate on gene expression. Plots showing the gene-level proportion of zeros in relation to the average log-normalize UMI count across all cells in <bold>a</bold> the Kaminski and Misharin macrophage datasets and <bold>b</bold> the Kaminski and Kropski fibroblast datasets. The LOESS curves (red lines) described decreasing patterns of dropout rate on gene expression level. The subject-level LOESS curves in <bold>c</bold> the Kaminski and Misharin macrophage datasets and <bold>d</bold> the Kaminski and Kropski fibroblast datasets demonstrated heterogeneity of this dependency across different subjects</p></caption><graphic xlink:href="12859_2023_5432_Fig1_HTML" id="MO1"/></fig></p>
    </sec>
    <sec id="Sec4">
      <title>Method performance evaluation overview</title>
      <p id="Par18">We evaluated and compared the performance of iDESC and eleven existing DE analysis methods (Table <xref rid="Tab1" ref-type="table">1</xref>) using both simulation studies and three real datasets. We divide these methods into two categories, based on whether subject effect is considered. The first category of methods considers subject effect, including iDESC, MAST-RE, muscat-PB, muscat-MM and subT. Among them, iDESC, MAST-RE and muscat-MM are mixed model-based methods, whereas muscat-PB and subT are aggregation-based methods. iDESC and MAST-RE also consider dropouts in scRNA-seq data. The other category of methods does not consider subject effect. Within this category, DEsingle, MAST and scDD consider dropouts while NBID, DESeq2, limma-trend and Wilcoxon rank sum test do not. DEsingle considers dropout in the fitted model but tests for differences in both group means and dropout rates instead of difference in group means only. Therefore, unlike most DE methods, DEsingle identifies genes with composite differences in group means and dropout rates. Comparison of these methods enabled us to assess the benefit of considering dropout evens and/or subject effect in the DE analysis of scRNA-seq data.<table-wrap id="Tab1"><label>Table 1</label><caption><p>Overview of the twelve DE analysis methods for comparison</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left"/><th align="left">Dropout</th><th align="left">Subject effect</th><th align="left">Test</th><th align="left">Model</th></tr></thead><tbody><tr><td align="left">iDESC</td><td align="left">✓</td><td align="left">Mixed model</td><td align="left">Wald test</td><td align="left">Zero-inflated negative binomial mixed model</td></tr><tr><td align="left">MAST-RE</td><td align="left">✓</td><td align="left">Mixed model</td><td align="left">Likelihood ratio test</td><td align="left">Two-part hurdle mixed model</td></tr><tr><td align="left">Muscat-MM</td><td align="left">×</td><td align="left">Mixed model</td><td align="left">Wald test</td><td align="left">Negative binomial mixed model</td></tr><tr><td align="left">Muscat-PB</td><td align="left">×</td><td align="left">Aggregation</td><td align="left">Quasi-likelihood F-test</td><td align="left">EdgeR on sample-level aggregated data</td></tr><tr><td align="left">subT</td><td align="left">×</td><td align="left">Aggregation</td><td align="left">Student’s T test</td><td align="left">T test on sample-level aggregated data</td></tr><tr><td align="left">DEsingle</td><td align="left">✓</td><td align="left">×</td><td align="left">Likelihood ratio test</td><td align="left">Group-specific zero-inflated negative binomial model</td></tr><tr><td align="left">MAST</td><td align="left">✓</td><td align="left">×</td><td align="left">Likelihood ratio test</td><td align="left">Two-part hurdle model</td></tr><tr><td align="left">scDD</td><td align="left">✓</td><td align="left">×</td><td align="left">Kolmogorov–Smirnov test</td><td align="left">Dirichlet process mixture of normals</td></tr><tr><td align="left">NBID</td><td align="left">×</td><td align="left">×</td><td align="left">Likelihood ratio test</td><td align="left">Negative binomial model with group-specific dispersion</td></tr><tr><td align="left">DESeq2</td><td align="left">×</td><td align="left">×</td><td align="left">Wald test</td><td align="left">Negative binomial model with the same dispersion between groups</td></tr><tr><td align="left">limma</td><td align="left">×</td><td align="left">×</td><td align="left">Moderated T test</td><td align="left">Linear regression model</td></tr><tr><td align="left">Wilcoxon</td><td align="left">×</td><td align="left">×</td><td align="left">Wilcoxon rank sum test</td><td align="left">Nonparametric test</td></tr></tbody></table></table-wrap></p>
      <p id="Par19">We compared method performance based on type I error, statistical power, and consistency of the identified DE genes in three independent scRNA-seq datasets on the same disease, the Kaminski dataset [<xref ref-type="bibr" rid="CR18">18</xref>], the Kropski dataset [<xref ref-type="bibr" rid="CR42">42</xref>] and the Misharin dataset [<xref ref-type="bibr" rid="CR17">17</xref>]. All datasets measured scRNA-seq data of whole lung tissue from patients with IPF and normal controls.</p>
    </sec>
    <sec id="Sec5">
      <title>Type I error assessment</title>
      <p id="Par20">To assess type I error, we permuted the group labels of subjects in both Kaminski and Kropski datasets 500 times. All twelve methods were applied to the permuted datasets to identify DE genes in macrophages. For each gene, we calculated the empirical type I error as the proportion of permuted datasets with a <italic>p</italic> value &lt; 0.05 and compared it to the nominal level 0.05. Figure <xref rid="Fig2" ref-type="fig">2</xref> shows the empirical type I error of each method. In both datasets, methods that account for subject effect, including iDESC, MAST-RE, muscat-MM, muscat-PB and subT, had well-controlled type I error. Among these methods, MAST-RE had slightly inflated type I error for some genes, likely due to the deviation of log-normalized UMI counts from the assumed Gaussian distribution. In contrast, the type I error of the methods that do not consider subject effect were severely inflated. The inflation of type I error was more prominent in the Kropski dataset for these methods, indicating a larger subject effect in the data. Among these methods, DEsingle, MAST and scDD had the largest inflation in type I error. DESeq2 had the largest variation in type I error across all genes. Taken together, these results suggested that it is important to consider subject effect for type I error control in the DE analysis of scRNA-seq data with multiple subjects.<fig id="Fig2"><label>Fig. 2</label><caption><p>Empirical type I error of all methods on the two permuted real datasets. Boxplots showing the median (center line), interquartile range (hinges), and 1.5 times the interquartile (whiskers) of empirical type I error at the nominal level of 0.05. Confidence interval of type I error is marked by two dashed lines (0.031–0.069)</p></caption><graphic xlink:href="12859_2023_5432_Fig2_HTML" id="MO2"/></fig></p>
    </sec>
    <sec id="Sec6">
      <title>Power comparison</title>
      <p id="Par21">To compare power, we simulated scRNA-seq data with 150 true DE genes and 300 non-DE genes under a wide range of parameter settings estimated from the Kaminski macrophage dataset. Expression data of the DE genes was simulated to have a fold-change of <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${e}^{\beta }$$\end{document}</tex-math><mml:math id="M2"><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mi>β</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq1.gif"/></alternatives></inline-formula> between the two groups of subjects. The number of cells per subject (<inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M4"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq2.gif"/></alternatives></inline-formula>), the magnitude of capture efficiency (<inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta$$\end{document}</tex-math><mml:math id="M6"><mml:mi>δ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq3.gif"/></alternatives></inline-formula>) and the log fold change (<inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M8"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq4.gif"/></alternatives></inline-formula>) were varied at different levels to simulate different datasets. We then applied all twelve methods to each simulated dataset for DE analysis. Method performance was assessed by the area under a receiver operating characteristic curve (AUC) that describes the sensitivity and specificity of the identified DE genes under different significance levels. The sensitivity and specificity under the p-value threshold of 0.05 are also demonstrated.</p>
      <p id="Par22">Figures <xref rid="Fig3" ref-type="fig">3</xref> and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: S1 show that all methods had improved sensitivity and AUC when the number of cells per subject increased except scDD. Under most simulation settings, iDESC performed the best with the highest sensitivity and AUC when compared to methods considering subject effect (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a, c, d). In the setting with 20 cells per subject and negative group effect, iDESC had comparable or higher AUC than other methods. When capture efficiency was high (<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta =0.5$$\end{document}</tex-math><mml:math id="M10"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq5.gif"/></alternatives></inline-formula>) corresponding to low dropout rate, muscat-MM had the second highest sensitivity and AUC but was better than iDESC in the setting with 20 cells per subject and negative disease effect. When capture efficiency was low (<inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta =1, 1.5$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq6.gif"/></alternatives></inline-formula>) corresponding to high dropout rate, the other four methods that consider subject effect, MAST-RE, muscat-MM, muscat-PB and subT, were comparable and had lower sensitivity and AUC than iDESC. The specificity of iDESC, muscat-MM and sub-T were around 0.95 at the p-value threshold of 0.05, while MAST-RE and muscat-PB had lower specificity especially when the group effect was large (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b). When we compared iDESC with the other seven methods that do not consider subject effect, DEseq2 had comparable or even higher sensitivity and AUC than iDESC when capture efficiency was low (<inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta =1, 1.5$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq7.gif"/></alternatives></inline-formula>), but performed worse when capture efficiency was high (<inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta =0.5$$\end{document}</tex-math><mml:math id="M16"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq8.gif"/></alternatives></inline-formula>) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figs. S1a, S1c and S1d). DEseq2 and Wilcoxon had lower specificity especially when capture efficiency was high (<inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta =0.5$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq9.gif"/></alternatives></inline-formula>) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1b). All other methods had lower sensitivity, specificity and AUC. scDD and NBID had compromised performance in most of the simulation settings. In summary, iDESC had comparable or the highest sensitivity and AUC, and maintained the correct specificity across all simulation settings.<fig id="Fig3"><label>Fig. 3</label><caption><p>Power comparison of methods considering subject effect in simulated datasets. Evaluation criteria including <bold>a</bold> sensitivity and <bold>b</bold> specificity under the p-value threshold of 0.05, and <bold>c</bold> area under an ROC curve (AUC) to measure the accuracy of identified DE genes under three levels of capture efficiency (δ) and number of cells per subject (<inline-formula id="IEq84"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M20"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq84.gif"/></alternatives></inline-formula>). <bold>d</bold> ROC curves and the corresponding AUC scores when <inline-formula id="IEq85"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta =0.4, \delta =1, m=50$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>0.4</mml:mn><mml:mo>,</mml:mo><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>50</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq85.gif"/></alternatives></inline-formula></p></caption><graphic xlink:href="12859_2023_5432_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>Consistency and validation of results in three independent scRNA-seq datasets</title>
      <p id="Par23">We used two cell types, macrophage and fibroblast, from three independent scRNA-seq datasets (Kaminski, Kropski and Misharin) of whole lung tissue from IPF patients and normal controls [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR42">42</xref>] to demonstrate and compare the between-dataset consistency of DE results by different methods. Both cell types have been reported to have significant transcriptomic changes in IPF patients [<xref ref-type="bibr" rid="CR43">43</xref>–<xref ref-type="bibr" rid="CR50">50</xref>]. Since different datasets have different cell type nomenclature, we overlaid the data from all three datasets to find subpopulations of cells that overlap well across the three datasets on the UMAP of integrated data by Seurat (Figs. <xref rid="Fig4" ref-type="fig">4</xref>a and <xref rid="Fig5" ref-type="fig">5</xref>a). This step was performed to ensure that DE analysis was conducted on the same type of cells across three datasets so that results are comparable. For each cell type, we selected datasets with a median number of cells per subject larger than 10 to conduct the consistency analysis. Eventually, the DE analysis results in macrophage were compared between the Kaminski and Misharin datasets and in fibroblast between the Kaminski and Kropski datasets. Five methods that consider subject effect, including iDESC, MAST-RE, muscat-MM, muscat-PB and subT, were applied. After data preprocessing, we had 7,128 genes in 43,028 macrophages from the Kaminski dataset, and 8,409 genes in 3,635 macrophages from the Misharin dataset. For fibroblast, we had 10,860 genes in 2,290 fibroblasts from the Kaminski dataset, and 9,325 genes in 1,615 fibroblasts from the Kropski dataset. We further had 7,653 genes in 8,663 macrophages from the Kropski dataset for external validation.<fig id="Fig4"><label>Fig. 4</label><caption><p>DE analysis using iDESC on the two IPF macrophage datasets. <bold>a</bold> UMAP of nomenclature matched macrophages in the Kaminski and Misharin datasets colored by subject (left) and group (right). <bold>b</bold> Heatmap of subject-level average expression for the top 10 upregulated and top 10 downregulated genes. <bold>c</bold> Violin plots demonstrate cell-level contributions to the group fold-change within each subject. Each violin corresponds to one subject and is colored by group</p></caption><graphic xlink:href="12859_2023_5432_Fig4_HTML" id="MO4"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>DE analysis using iDESC on the two IPF fibroblast datasets. <bold>a</bold> UMAP of nomenclature matched fibroblasts in the Kaminski and Kropski datasets colored by subject (left) and group (right). <bold>b</bold> Heatmap of subject-level average expression for the top 10 upregulated and top 10 downregulated genes. <bold>c</bold> Violin plots demonstrate cell-level contributions to the group fold-change within each subject. Each violin corresponds to one subject and is colored by group</p></caption><graphic xlink:href="12859_2023_5432_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par24">At the threshold of <italic>p</italic> value &lt; 0.01, iDESC identified 5,577 and 1,124 DE genes in Kaminski and Misharin macrophage datasets, respectively, and 417 and 534 DE genes in Kaminski and Kropski fibroblast datasets, respectively. The top upregulated DE genes in IPF macrophage (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b), such as <italic>FN</italic>1, <italic>CCL</italic>18 and <italic>SPP</italic>1, were previously reported to be upregulated in IPF and related to IPF pathogenesis in macrophages [<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR44">44</xref>, <xref ref-type="bibr" rid="CR45">45</xref>, <xref ref-type="bibr" rid="CR47">47</xref>, <xref ref-type="bibr" rid="CR48">48</xref>, <xref ref-type="bibr" rid="CR51">51</xref>]. In fibroblast, <italic>CXCL</italic>14 and <italic>SFRP</italic>1 were identified among the top upregulated DE genes in IPF (Fig. <xref rid="Fig5" ref-type="fig">5</xref>b), which were also found to be potential signatures of IPF in previous studies [<xref ref-type="bibr" rid="CR49">49</xref>, <xref ref-type="bibr" rid="CR50">50</xref>, <xref ref-type="bibr" rid="CR52">52</xref>–<xref ref-type="bibr" rid="CR54">54</xref>]. iDESC also identified <italic>CXCL</italic>12, a gene potentially related to the pulmonary fibrosis progression [<xref ref-type="bibr" rid="CR55">55</xref>, <xref ref-type="bibr" rid="CR56">56</xref>], to be upregulated in IPF fibroblast. To examine subject variations in these three datasets, we calculated cell-level effect coefficients [<xref ref-type="bibr" rid="CR20">20</xref>] for each subject in macrophage (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c) and fibroblast (Fig. <xref rid="Fig5" ref-type="fig">5</xref>c). Cell-level effect coefficients summarized the extent to which each cell reflects the group-level fold-change. For each cell type, both inter- and intra-subject variations of effect coefficients are different between the two chosen datasets, suggesting that the level of subject variation varies across different datasets potentially due to variations in biological background of subjects.</p>
      <p id="Par25">We further evaluated method performance based on the consistency of DE genes between datasets. For each method in each cell type, we overlapped the identified DE genes from the two chosen datasets (Fig. <xref rid="Fig6" ref-type="fig">6</xref>a, b). Fisher’s exact test was conducted to assess the significance of overlap and Jaccard index was calculated to measure the similarity between the two DE gene lists for each method (Table <xref rid="Tab2" ref-type="table">2</xref>). The higher the overlap is, the more consistent the results are between datasets, indicating a better performance. Figure <xref rid="Fig6" ref-type="fig">6</xref>a shows that iDESC identified the largest number of between-dataset overlapping DE genes (808 genes) in macrophage. Although iDESC did not achieve the most between-dataset overlapping DE genes in fibroblast (Fig. <xref rid="Fig6" ref-type="fig">6</xref>b), Table <xref rid="Tab2" ref-type="table">2</xref> shows that iDESC had the most significant between-dataset overlap in both cell types (macrophage: <italic>p</italic> = 1 × 10<sup>–5</sup>, fibroblast: <italic>p</italic> = 4 × 10<sup>–21</sup>), followed by muscat-PB (macrophage: <italic>p</italic> = 1 × 10<sup>–5</sup>, fibroblast: <italic>p</italic> = 2 × 10<sup>–7</sup>). In contrast, MAST-RE, muscat-MM and subT did not achieve significant between-dataset overlap in macrophage. They had significant overlap in fibroblast while their p-values were much larger than iDESC and others. In addition, iDESC had the largest Jaccard Index in both cell types (macrophage: JI = 0.137, fibroblast: JI = 0.077), followed by muscat-MM (macrophage: JI = 0.108, fibroblast: JI = 0.071).<fig id="Fig6"><label>Fig. 6</label><caption><p>Consistency and validation of DE genes overlapping between real datasets in macrophage and fibroblast. <bold>a</bold> Barplots showing the number of DE genes identified in the Kaminski (purple), Misharin (yellow) datasets and the overlap (grey) between them in macrophage. <bold>b</bold> Barplots showing the number of DE genes identified in the Kaminski (purple), Kropski (yellow) datasets and the overlap (grey) between them in fibroblast. <bold>c</bold> Barplots showing the percentage of IPF-related genes in the Harmonizome database identified in both the Kaminski and Misharin macrophage datasets</p></caption><graphic xlink:href="12859_2023_5432_Fig6_HTML" id="MO6"/></fig><table-wrap id="Tab2"><label>Table 2</label><caption><p>Fisher’s exact test and Jaccard index measuring the DE genes overlapping between the two chosen scRNA-seq datasets in macrophage and fibroblast</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Method</th><th align="left"/><th align="left">iDESC</th><th align="left">MAST-RE</th><th align="left">Muscat-MM</th><th align="left">Muscat-PB</th><th align="left">subT</th></tr></thead><tbody><tr><td align="left" rowspan="2">Macrophage</td><td align="left"> <italic>P</italic> value</td><td align="left"><inline-formula id="IEq86"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\times {10}^{-5}$$\end{document}</tex-math><mml:math id="M24"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq86.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq87"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1.000$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mn>1.000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq87.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq88"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.269$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mn>0.269</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq88.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq89"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1\times {10}^{-5}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq89.gif"/></alternatives></inline-formula></td><td char="." align="char">0.085</td></tr><tr><td align="left"> Jaccard Index</td><td align="left">0.137</td><td align="left"><inline-formula id="IEq90"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.061$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mn>0.061</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq90.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq91"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$0.108$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mn>0.108</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq91.gif"/></alternatives></inline-formula></td><td align="left">0.055</td><td char="." align="char">0.028</td></tr><tr><td align="left" rowspan="2">Fibroblast</td><td align="left"> <italic>P</italic> value</td><td align="left"><inline-formula id="IEq92"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4\times {10}^{-21}$$\end{document}</tex-math><mml:math id="M36"><mml:mrow><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>21</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq92.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq93"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$4\times {10}^{-6}$$\end{document}</tex-math><mml:math id="M38"><mml:mrow><mml:mn>4</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>6</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq93.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq94"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$3\times {10}^{-5}$$\end{document}</tex-math><mml:math id="M40"><mml:mrow><mml:mn>3</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq94.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq95"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$2\times {10}^{-7}$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:mn>2</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mn>7</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq95.gif"/></alternatives></inline-formula></td><td char="." align="char">0.011</td></tr><tr><td align="left"> Jaccard Index</td><td align="left">0.077</td><td align="left">0.067</td><td align="left">0.071</td><td align="left">0.035</td><td char="." align="char">0.024</td></tr></tbody></table></table-wrap></p>
      <p id="Par26">Lastly, we used a list of 83 IPF-related genes in the Harmonizome database [<xref ref-type="bibr" rid="CR57">57</xref>] to validate the between-dataset overlapping DE genes in each cell type identified by each method (Fig. <xref rid="Fig6" ref-type="fig">6</xref>c). In macrophage, iDESC had the highest proportion of validated genes (9.52%), followed by muscat-MM (8.73%), muscat-PB (7.94%), MAST-RE (7.14%) and subT (4.76%). In fibroblast, none of the methods had more than 3 genes that were found in the Harmonizome gene list, thus the validation results were not suitable for comparison.</p>
      <p id="Par27">To validate the top DE genes identified in the Kaminski macrophage dataset, we used the Kropski and Misharin macrophage datasets. Table <xref rid="Tab3" ref-type="table">3</xref> demonstrates that the top 10 upregulated DE genes identified using iDESC in the Kaminski macrophage dataset, if captured in either of the two validation datasets, were also significant (<italic>p</italic> &lt; 0.01) by iDESC in the Kropski and Misharin macrophage datasets. We also examined the expression distribution of the top 3 DE genes, <italic>FN</italic>1, <italic>CCL</italic>18 and <italic>SPP</italic>1, identified in the Kaminski macrophage dataset, in the three IPF macrophage datasets. Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Figure S2 shows that all three genes were differentially expressed between IPF and control (<italic>p</italic> &lt; 0.01, Wilcoxon rank sum test) in the three IPF macrophage datasets.<table-wrap id="Tab3"><label>Table 3</label><caption><p>DE analysis results using iDESC of the top 10 up-regulated DE genes, identified in the Kaminski macrophage dataset, in the three IPF macrophage datasets</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left" rowspan="2">Gene</th><th align="left" colspan="2">Kaminski</th><th align="left" colspan="2">Kropski</th><th align="left" colspan="2">Misharin</th></tr><tr><th align="left">Fold change</th><th align="left"><italic>P</italic> value</th><th align="left">Fold change</th><th align="left"><italic>P</italic> value</th><th align="left">Fold change</th><th align="left"><italic>P</italic> value</th></tr></thead><tbody><tr><td align="left"><italic>FN1</italic></td><td char="." align="char">2.882</td><td char="." align="char">7.01×10<sup>−32</sup></td><td align="left">2.639</td><td align="left">3.69×10<sup>−10</sup></td><td align="left"><italic>NA</italic></td><td align="left"><italic>NA</italic></td></tr><tr><td align="left"><italic>CCL18</italic></td><td char="." align="char">2.528</td><td char="." align="char">3.95×10<sup>−22</sup></td><td align="left">2.594</td><td align="left">3.68×10<sup>−4</sup></td><td align="left">1.725</td><td align="left">5.79×10<sup>−4</sup></td></tr><tr><td align="left"><italic>SPP1</italic></td><td char="." align="char">2.201</td><td char="." align="char">6.39×10<sup>−13</sup></td><td align="left">2.444</td><td align="left">1.63×10<sup>−3</sup></td><td align="left"><italic>NA</italic></td><td align="left"><italic>NA</italic></td></tr><tr><td align="left"><italic>S100A10</italic></td><td char="." align="char">1.827</td><td char="." align="char">2.75×10<sup>−17</sup></td><td align="left">2.418</td><td align="left">3.27×10<sup>−4</sup></td><td align="left"><italic>NA</italic></td><td align="left"><italic>NA</italic></td></tr><tr><td align="left"><italic>VIM</italic></td><td char="." align="char">1.807</td><td char="." align="char">1.19×10<sup>−29</sup></td><td align="left"><italic>NA</italic></td><td align="left"><italic>NA</italic></td><td align="left">1.392</td><td align="left">1.14×10<sup>−3</sup></td></tr><tr><td align="left"><italic>CSTB</italic></td><td char="." align="char">1.777</td><td char="." align="char">2.79×10<sup>−21</sup></td><td align="left">2.247</td><td align="left">3.11×10<sup>−8</sup></td><td align="left">2.106</td><td align="left">2.35×10<sup>−3</sup></td></tr><tr><td align="left"><italic>CD9</italic></td><td char="." align="char">1.702</td><td char="." align="char">2.71×10<sup>−17</sup></td><td align="left">1.517</td><td align="left">8.90×10<sup>−3</sup></td><td align="left">1.677</td><td align="left">2.44×10<sup>−3</sup></td></tr><tr><td align="left"><italic>LGALS1</italic></td><td char="." align="char">1.690</td><td char="." align="char">8.79×10<sup>−11</sup></td><td align="left">2.033</td><td align="left">2.22×10<sup>−6</sup></td><td align="left">1.633</td><td align="left">9.19×10<sup>−4</sup></td></tr><tr><td align="left"><italic>ACTB</italic></td><td char="." align="char">1.568</td><td char="." align="char">6.02×10<sup>−9</sup></td><td align="left"><italic>NA</italic></td><td align="left"><italic>NA</italic></td><td align="left">1.597</td><td align="left">7.35×10<sup>−3</sup></td></tr><tr><td align="left"><italic>LGALS3</italic></td><td char="." align="char">1.508</td><td char="." align="char">1.00×10<sup>−13</sup></td><td align="left">1.929</td><td align="left">1.83×10<sup>−3</sup></td><td align="left">1.530</td><td align="left">4.30×10<sup>−3</sup></td></tr></tbody></table><table-wrap-foot><p>NA represents that the gene was filtered and not included in the DE analysis in the corresponding dataset</p></table-wrap-foot></table-wrap></p>
      <p id="Par28">In summary, we evaluated method performance using real datasets based on consistency of results across different datasets and validation using previously reported IPF associated genes in public database and literatures. Our method, iDESC, achieved the best performance based on both evaluation criteria. The top DE genes identified by iDESC were highly biologically relevant, well supported by literatures, and validated by two other independent datasets.</p>
    </sec>
    <sec id="Sec8">
      <title>Computation time</title>
      <p id="Par29">The runtime of iDESC is 33.3 and 24.6 min to analyze the Kaminski and Kropski fibroblast datasets, respectively, using a 10-core, 100 GB RAM, Intel Xeon 2.6 GHz CPU machine. The computation time of iDESC is relatively long because of the mixed model fitting for subject effect and the consideration of dropouts. For a dataset of 50–100 subjects and ~ 2000 cells per sample, iDESC took about 50 h using a 10-core, 100 GB RAM, Intel Xeon 2.6 GHz CPU machine. To provide more information on computation time, we recorded the time of the five methods that consider subject effect, iDESC, MAST-RE, muscat-MM, muscat-PB and subT, on 10 genes in the Kaminski fibroblast dataset that includes 2,290 fibroblasts. Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S1 displays the runtime on a single core. With parallel computing, the runtime of the mixed model-based methods, iDESC and muscat-MM, was further reduced to 9.74 and 9.51 s, respectively, on a 10-core machine.</p>
    </sec>
  </sec>
  <sec id="Sec9">
    <title>Discussion</title>
    <p id="Par30">We have developed a new method, iDESC, to detect cell type specific DE genes between two groups of subjects in scRNA-seq data. iDESC fits a zero-inflated GLMM assuming dropouts to have zero count and captured expression to have a negative binomial distribution. Information across genes were pooled to model the dependency of dropout rate on gene expression level. Subject effect is modeled as a random effect in the log-mean of the negative binomial component. Wald test is used to assess the group mean difference in captured transcripts. We compared the performance of iDESC with elevent exiting DE analysis methods using both simulated data and real datasets. Permutation analysis using real data demonstrated that the type I errors of methods that consider subject effect were well calibrated, whereas the type I errors of methods that ignore subject effect were highly inflated. Using simulated data based on parameters estimated from real datasets, we showed that iDESC achieved comparable or higher power among methods that consider subject effect. In three independent scRNA-seq datasets of IPF patients and healthy controls, several of the top DE genes identified by iDESC were well supported by literatures regarding their important roles in IPF pathogenesis. Moreover, iDESC achieved the most consistent and validated results between independent datasets and using public database, respectively. These results demonstrated superior performance of iDESC over the other existing methods, suggesting the importance of considering subject effect and dropouts in the DE analysis of scRNA-seq data with multiple subjects.</p>
    <p id="Par31">Like most DE analysis methods for scRNA-seq data, iDESC requires accurate cell type annotation, which is a key step to ensure the validity and biological relevance of the downstream DE analysis. Cell clustering and cell type annotation are commonly performed with the removal of technical (batch) or biological (subject) effects through data integration. During this step, group/disease effect will be removed along with subject effect. Therefore, the downstream DE analysis will be performed on the original count or normalized data in each annotated cell type instead of the integrated data. Inaccurate cell typing may lead to data distribution deviated from the negative binomial distribution or with multiple modes. Possible remedies to reduce the negative impact of inaccurate cell type annotation include the following strategies. First, we strongly recommend examining the cell distribution through data visualization using UMAP and/or t-SNE plots and performing cell clustering to detect potential incorrect cell annotations. Second, a goodness-of-fit test for iDESC and/or replacing the negative binomial distribution with a multi-modal distribution or a mixture model may improve model fitting.</p>
    <p id="Par32">Despite the advantages of iDESC over the other DE analysis methods shown in this article, iDESC can be improved in several directions. First, in some cell types, when the cell-to-cell heterogeneity of certain genes is high or heterogeneous cell subtypes exist, negative binomial distribution may not fit the data well. Especially when heterogeneous cell subtypes are present in the data, the distribution of expression may be multi-modal. Data transformation, a goodness-of-fit test for iDESC and/or replacing negative binomial distribution with a multi-modal distribution or a mixture model may improve the model fitting. Second, estimation of dispersion parameter in a negative binomial distribution has been shown to be challenging. Multiple dispersion correction approaches [<xref ref-type="bibr" rid="CR39">39</xref>, <xref ref-type="bibr" rid="CR58">58</xref>–<xref ref-type="bibr" rid="CR60">60</xref>] that have been developed to improve accuracy can be used to further improve the performance of iDESC.</p>
    <p id="Par33">The computational speed of iDESC is relatively slow due to its consideration of dropouts and subject effect, which are critical for iDESC to achieve significant improvement in performance. Besides implementing parallel computing on high performance computers, the following two future work can potentially reduce the runtime of iDESC. First, the “glmmTMB” package uses the Template Model Builder (TMB) framework to calculate the first and second order derivatives of the likelihood function by automatic differentiation (AD). It is possible to speed up the algorithm by specifying the calculation of first and second order derivatives for the quasi-likelihood function of our model to skip this process. Second, the objective function of iDESC was optimized using the "nlminb" optimizer in an iterative scheme, which is an unconstrained quasi-Newton method optimizer. Replacing nlminb with a more efficient algorithm such as stochastic gradient descent (SGD) may further reduce the runtime.</p>
  </sec>
  <sec id="Sec10">
    <title>Conclusions</title>
    <p id="Par34">We developed iDESC, a zero-inflated negative binomial mixed model that considers both subject effect and dropouts, to identify cell type specific differentially expressed genes in scRNA-seq data with multiple subjects. iDESC had well-calibrated type I error and comparable or higher power than other existing DE methods. When applied to three independent scRNA-seq datasets with IPF patients and healthy controls, iDESC achieved the highest between-dataset consistency and validation rate based on genes found to be associated with IPF in public database.</p>
  </sec>
  <sec id="Sec11">
    <title>Materials and methods</title>
    <sec id="Sec12">
      <title>Statistical model</title>
      <p id="Par35">To identify cell type specific DE genes between two groups of subjects, iDESC uses a zero-inflated negative binomial mixed model to consider both subject effect and dropout events in scRNA-seq data with multiple subjects. The model includes two components: a zero component representing dropouts and a negative binomial component representing captured expression.</p>
      <p id="Par36">Suppose cells are collected from <inline-formula id="IEq10"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M44"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq10.gif"/></alternatives></inline-formula> subjects. In a given cell type of interest, subject <inline-formula id="IEq11"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M46"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq11.gif"/></alternatives></inline-formula> has <inline-formula id="IEq12"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}_{i}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq12.gif"/></alternatives></inline-formula> cells so that there are in total <inline-formula id="IEq13"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N={\sum }_{i=1}^{n}{m}_{i}$$\end{document}</tex-math><mml:math id="M50"><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq13.gif"/></alternatives></inline-formula> cells of the given type. Let <inline-formula id="IEq14"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{i}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq14.gif"/></alternatives></inline-formula> be the group label of subject <inline-formula id="IEq15"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M54"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq15.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq16"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${X}_{i}$$\end{document}</tex-math><mml:math id="M56"><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq16.gif"/></alternatives></inline-formula> is 0 if subject <inline-formula id="IEq17"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M58"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq17.gif"/></alternatives></inline-formula> belongs to group 1 and 1 if subject <inline-formula id="IEq18"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M60"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq18.gif"/></alternatives></inline-formula> belongs to group 2. For each gene, let <inline-formula id="IEq19"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ijk}$$\end{document}</tex-math><mml:math id="M62"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq19.gif"/></alternatives></inline-formula> denote the observed UMI count of gene <inline-formula id="IEq20"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M64"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq20.gif"/></alternatives></inline-formula> in cell <inline-formula id="IEq21"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M66"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq21.gif"/></alternatives></inline-formula> from subject <inline-formula id="IEq22"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M68"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq22.gif"/></alternatives></inline-formula>. We model the UMI count as:<disp-formula id="Equa"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ijk}\left|{\pi }_{ijk},{\lambda }_{ik},{d}_{k}\right.\sim {\pi }_{ijk}\times {\mathbb{I}}_{\left\{{Y}_{ijk}=0\right\}}+\left(1-{\pi }_{ijk}\right)\times NB\left({S}_{ij}{\lambda }_{ik},{d}_{k}\right),$$\end{document}</tex-math><mml:math id="M70" display="block"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mfenced open="|"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo>∼</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:msub><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5432_Article_Equa.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equb"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{log}\left({\lambda }_{ik}\right)={\alpha }_{k}+{\beta }_{k}{X}_{i}+{\gamma }_{ik},$$\end{document}</tex-math><mml:math id="M72" display="block"><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5432_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq23"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\pi }_{ijk}$$\end{document}</tex-math><mml:math id="M74"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq23.gif"/></alternatives></inline-formula> is the dropout rate representing the probability of gene <inline-formula id="IEq24"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M76"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq24.gif"/></alternatives></inline-formula> being dropped out in cell <inline-formula id="IEq25"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M78"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq25.gif"/></alternatives></inline-formula> from subject <inline-formula id="IEq26"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M80"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq26.gif"/></alternatives></inline-formula>, <inline-formula id="IEq27"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\mathbb{I}}_{\left\{\cdot \right\}}$$\end{document}</tex-math><mml:math id="M82"><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{"><mml:mo>·</mml:mo></mml:mfenced></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq27.gif"/></alternatives></inline-formula> is the indicator function that takes value 1 when the condition in the brackets is satisfied, 0 otherwise, <inline-formula id="IEq28"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{ij}$$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq28.gif"/></alternatives></inline-formula> is the total UMI counts of cell <inline-formula id="IEq29"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M86"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq29.gif"/></alternatives></inline-formula> from subject <inline-formula id="IEq30"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M88"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq30.gif"/></alternatives></inline-formula>, <inline-formula id="IEq31"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{ik}$$\end{document}</tex-math><mml:math id="M90"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq31.gif"/></alternatives></inline-formula> is the rate parameter of the negative binomial distribution representing the true underlying relative gene expression level, and <inline-formula id="IEq32"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${d}_{k}$$\end{document}</tex-math><mml:math id="M92"><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq32.gif"/></alternatives></inline-formula> is the dispersion parameter of gene <inline-formula id="IEq33"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M94"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq33.gif"/></alternatives></inline-formula>. The rate parameter <inline-formula id="IEq34"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{ik}$$\end{document}</tex-math><mml:math id="M96"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq34.gif"/></alternatives></inline-formula> is further modeled using a GLMM with log link, where <inline-formula id="IEq35"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\alpha }_{k}$$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>α</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq35.gif"/></alternatives></inline-formula> is the intercept, <inline-formula id="IEq36"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{k}$$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq36.gif"/></alternatives></inline-formula> is the group effect representing the log fold change of mean expression of gene <inline-formula id="IEq37"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M102"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq37.gif"/></alternatives></inline-formula> between the two groups, and <inline-formula id="IEq38"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\gamma }_{ik}$$\end{document}</tex-math><mml:math id="M104"><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq38.gif"/></alternatives></inline-formula> is the gene-specific subject random effect, assumed to be independent and <inline-formula id="IEq39"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\gamma }_{ik} \sim N\left(0,{\sigma }_{k}^{2}\right)$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:msub><mml:mi>γ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq39.gif"/></alternatives></inline-formula>.</p>
      <p id="Par37">Previous research found that the dropout rate of a given gene in a given cell depends on the expression level of the gene in the cell. Genes with lower expression level tend to have a higher dropout rate [<xref ref-type="bibr" rid="CR16">16</xref>]. In addition, the dropout rates vary among cells and are influenced by the quality of sequencing library, cell type and RNA-seq protocol [<xref ref-type="bibr" rid="CR16">16</xref>]. To quantify this dependency, we pooled information across genes and assumed that genes of similar average expression share similar dropout rates. In iDESC, we first calculated the proportion of zeros for each gene, and then fit a locally estimated scatterplot smoothing (LOESS) curve of the zero proportions against the log of gene-level average log-normalized UMI count across all cells. This overall LOESS curve captured the dependency of dropout rate on gene expression level and produced an initial estimate of dropout rates for all genes, denotes as <inline-formula id="IEq40"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\pi }_{k}^{0}$$\end{document}</tex-math><mml:math id="M108"><mml:msubsup><mml:mi>π</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq40.gif"/></alternatives></inline-formula>. Notice that the LOESS curve was obtained by assuming that the average log-normalized UMI count across all cells represents the true underlying gene expression. To relax this assumption, we introduce a parameter <inline-formula id="IEq41"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M110"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq41.gif"/></alternatives></inline-formula> to allow the true dropout rate to deviate from the initial estimate when the single-cell gene expression is zero. Furthermore, the subject-level LOESS curves obtained from cells of the same subject have slight variations from the overall LOESS curve, suggesting that dropout rate is likely to be subject/batch specific. Putting together, we model the dropout rate <inline-formula id="IEq42"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\pi }_{ijk}$$\end{document}</tex-math><mml:math id="M112"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq42.gif"/></alternatives></inline-formula> as a GLMM with logit link:<disp-formula id="Equc"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{logit}\left({\pi }_{ijk}\right)=\mathrm{logit}\left({\pi }_{k}^{0}\right)+\theta \times {\mathbb{I}}_{\left\{{Y}_{ijk}=0\right\}}+{\eta }_{ik},$$\end{document}</tex-math><mml:math id="M114" display="block"><mml:mrow><mml:mi mathvariant="normal">logit</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:mi mathvariant="normal">logit</mml:mi><mml:mfenced close=")" open="("><mml:msubsup><mml:mi>π</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msubsup></mml:mfenced><mml:mo>+</mml:mo><mml:mi>θ</mml:mi><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5432_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq43"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\theta$$\end{document}</tex-math><mml:math id="M116"><mml:mi>θ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq43.gif"/></alternatives></inline-formula> is the deviation from the initial estimate for a gene when its expression level is zero, and <inline-formula id="IEq44"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\eta }_{ik}$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq44.gif"/></alternatives></inline-formula> is the gene-specific subject/batch random effect, assumed to be independent and <inline-formula id="IEq45"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\eta }_{ik} \sim N\left(0, {\tau }_{k}^{2}\right)$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq45.gif"/></alternatives></inline-formula>.</p>
      <p id="Par38">To test if gene <inline-formula id="IEq46"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M122"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq46.gif"/></alternatives></inline-formula> is differentially expressed between the two groups, we constructed a Wald statistic to test <inline-formula id="IEq47"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{0}: {\beta }_{k}=0$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq47.gif"/></alternatives></inline-formula> against <inline-formula id="IEq48"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{1}: {\beta }_{k}\ne 0$$\end{document}</tex-math><mml:math id="M126"><mml:mrow><mml:msub><mml:mi>H</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>:</mml:mo><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq48.gif"/></alternatives></inline-formula> using an R package ‘glmmTMB’ [<xref ref-type="bibr" rid="CR61">61</xref>].</p>
    </sec>
    <sec id="Sec13">
      <title>Real datasets</title>
      <p id="Par39">We evaluated the performance of iDESC and other methods using three scRNA-seq datasets of whole lung samples from three independent IPF studies generated using the 10X Genomics Chromium platform. All datasets included IPF patients and healthy controls. In this article, we chose to focus on macrophage and fibroblast because both cell types have been recognized to play a significant role in IPF pathogenesis [<xref ref-type="bibr" rid="CR43">43</xref>–<xref ref-type="bibr" rid="CR50">50</xref>].</p>
      <p id="Par40">Kaminski refers to the scRNA-seq dataset of frozen distal lung parenchyma samples from 32 IPF and 28 control donor lungs in Adams et al. [<xref ref-type="bibr" rid="CR18">18</xref>]. The raw data include 38,070 genes, 101,230 macrophages and 2,290 fibroblasts.</p>
      <p id="Par41">Kropski refers to the scRNA-seq dataset of fresh whole lungs from 10 IPF patients and 8 healthy donors in Habermann et al. [<xref ref-type="bibr" rid="CR42">42</xref>]. The raw data include 31,054 genes, 11,532 macrophages and 1,644 fibroblasts.</p>
      <p id="Par42">Misharin refers to the scRNA-seq dataset of fresh lung tissues from 4 IPF patients and 8 transplant donors in Reyfman et al. [<xref ref-type="bibr" rid="CR17">17</xref>]. The raw data include 21,807 genes, 8,534 macrophages and 2,468 fibroblasts.</p>
    </sec>
    <sec id="Sec14">
      <title>Data preprocessing</title>
      <p id="Par43">The raw UMI count matrices of all three datasets were downloaded from the links provided in the publications. We integrated the three datasets for data visualization and noticed that the cell type nomenclature in these three datasets were quite different. For example, the fibroblasts in the Kaminski dataset were distinguished by expressing <italic>IGF</italic>1 and <italic>MFAP</italic>5, and these cells do not express <italic>ITGA</italic>8 or <italic>MYLK</italic> as the myofibroblasts in the Kaminski dataset. However, a good portion of the fibroblasts in the Misharin dataset and the <italic>PLIN</italic>2+ fibroblasts in the Kropski dataset expressed <italic>ITGA</italic>8 and <italic>MYLK</italic>, suggesting that they are similar to the myofibroblasts in the Kaminski dataset but not the fibroblasts. The difference in cell type nomenclature may lead the DE analysis results to be invalidated across the three datasets. To ensure cells of the same type were compared across the three datasets so that DE analysis results were comparable, we conducted integration analysis across the three datasets using Seurat [<xref ref-type="bibr" rid="CR62">62</xref>]. The graph-based Louvain clustering algorithm [<xref ref-type="bibr" rid="CR63">63</xref>] was applied to cluster cells. Cell clusters with substantial overlap across the three datasets in the UMAP of integrated data were extracted for downstream DE analysis. Based on this nomenclature matching, we had 43,028 macrophages and 2,290 fibroblasts from the Kaminski dataset, 3,635 macrophages from the Misharin dataset, and 8,663 macrophages and 1,615 fibroblasts from the Kropski dataset. For each cell type, we filtered out genes that were expressed in less than 5% of cells and removed subjects with less than 5 cells. When choosing datasets to evaluate the between-dataset consistency of DE analysis results by each method, we selected datasets with a median number of cells per subject larger than 10 to ensure sample size in the analysis.</p>
    </sec>
    <sec id="Sec15">
      <title>Type I error assessment</title>
      <p id="Par44">To assess type I error, we randomly permuted the group labels of subjects in both Kaminski and Kropski datasets so that no model assumptions were made in data generation and the within-subject cell-to-cell correlation structure was preserved in the data. The permuted datasets were not expected to show transcriptomic difference between the two groups. We performed 500 permutations on each dataset and applied all DE analysis methods to the permuted datasets. Genes with a <italic>p</italic> value &lt; 0.05 were considered significant. The empirical type I error for each gene was calculated as the proportion of permuted datasets having a <italic>p</italic> value &lt; 0.05 for the given gene.</p>
    </sec>
    <sec id="Sec16">
      <title>Power comparison</title>
      <p id="Par45">To compare the statistical power of all methods, we simulated single-cell expression data with ground truth to mimic the real datasets. Macrophages in the Kaminski dataset were used for this analysis. First, for each gene, we fit the following ZINB model on the macrophage data from all subjects in the Kaminski dataset to estimate gene-level dispersion <inline-formula id="IEq49"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${d}_{k}$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq49.gif"/></alternatives></inline-formula>, subject-specific dropout rate <inline-formula id="IEq50"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\pi }_{ik}$$\end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq50.gif"/></alternatives></inline-formula> and subject-specific relative gene expression level <inline-formula id="IEq51"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\lambda }_{ik}$$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq51.gif"/></alternatives></inline-formula>: <inline-formula id="IEq52"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ijk}\left|{\pi }_{ik},{\lambda }_{ik},{d}_{k}\right.\sim {\pi }_{ik}\times {\mathbb{I}}_{\left\{{Y}_{ijk}=0\right\}}+\left(1-{\pi }_{ik}\right)\times NB\left({S}_{ij}{\lambda }_{ik},{d}_{k}\right)$$\end{document}</tex-math><mml:math id="M134"><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mfenced open="|"><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced><mml:mo>∼</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:msub><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq52.gif"/></alternatives></inline-formula>. The estimated <inline-formula id="IEq53"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{\pi }}_{ik}, {\widehat{\lambda }}_{ik}$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq53.gif"/></alternatives></inline-formula> and <inline-formula id="IEq54"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{d}}_{k}$$\end{document}</tex-math><mml:math id="M138"><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq54.gif"/></alternatives></inline-formula> were used in the simulation model to mimic real data. Second, we randomly sampled 30 subjects (15 IPF patients and 15 healthy controls) from the Kaminski dataset and extracted their <inline-formula id="IEq55"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{\pi }}_{ik}, {\widehat{\lambda }}_{ik}$$\end{document}</tex-math><mml:math id="M140"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq55.gif"/></alternatives></inline-formula> and <inline-formula id="IEq56"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{d}}_{k}$$\end{document}</tex-math><mml:math id="M142"><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq56.gif"/></alternatives></inline-formula> to set up the simulation model. For each subject, <inline-formula id="IEq57"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M144"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq57.gif"/></alternatives></inline-formula> macrophages (<inline-formula id="IEq58"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m=20, 50, 100$$\end{document}</tex-math><mml:math id="M146"><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>20</mml:mn><mml:mo>,</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq58.gif"/></alternatives></inline-formula>) were simulated and their sequencing depths (<inline-formula id="IEq59"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{ij}$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq59.gif"/></alternatives></inline-formula>’s) were randomly sampled without replacement from the sequencing depths of all cells from the given subject. For each subject <inline-formula id="IEq60"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M150"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq60.gif"/></alternatives></inline-formula>, based on its parameter setting (<inline-formula id="IEq61"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${S}_{ij}$$\end{document}</tex-math><mml:math id="M152"><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq61.gif"/></alternatives></inline-formula>’s, <inline-formula id="IEq62"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{\pi }}_{ik}, {\widehat{\lambda }}_{ik}$$\end{document}</tex-math><mml:math id="M154"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq62.gif"/></alternatives></inline-formula> and <inline-formula id="IEq63"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{d}}_{k}$$\end{document}</tex-math><mml:math id="M156"><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq63.gif"/></alternatives></inline-formula>), two samples were simulated, one for each of the two groups. Let <inline-formula id="IEq64"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ijk}^{1}$$\end{document}</tex-math><mml:math id="M158"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow><mml:mn>1</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq64.gif"/></alternatives></inline-formula> and <inline-formula id="IEq65"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${Y}_{ijk}^{2}$$\end{document}</tex-math><mml:math id="M160"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq65.gif"/></alternatives></inline-formula> be the simulated UMI counts of gene <inline-formula id="IEq66"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M162"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq66.gif"/></alternatives></inline-formula> in cell <inline-formula id="IEq67"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j$$\end{document}</tex-math><mml:math id="M164"><mml:mi>j</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq67.gif"/></alternatives></inline-formula> for group 1 and group 2 samples generated from subject <inline-formula id="IEq68"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M166"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq68.gif"/></alternatives></inline-formula>, respectively, we have<disp-formula id="Equd"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\forall l\in \left\{1, 2\right\}: {Y}_{ijk}^{l}\sim {\pi }_{ijk}\times {\mathbb{I}}_{\left\{{Y}_{ijk}^{l}=0\right\}}+\left(1-{\pi }_{ijk}\right)\times NB\left({S}_{ij}{\widehat{\lambda }}_{ik}{e}^{{\beta }_{k}{\mathbb{I}}_{\left\{l=2\right\}}}, d\right),$$\end{document}</tex-math><mml:math id="M168" display="block"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="}" open="{"><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mfenced><mml:mo>:</mml:mo><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo>∼</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub><mml:mo>×</mml:mo><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{"><mml:msubsup><mml:mi>Y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mfenced></mml:msub><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>×</mml:mo><mml:mi>N</mml:mi><mml:mi>B</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close="}" open="{"><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mfenced></mml:msub></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mi>d</mml:mi></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5432_Article_Equd.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Eque"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{logit}\left({\pi }_{ijk}\right)\sim N\left(\delta \times \mathrm{logit}\left({\widehat{\pi }}_{ik}\right), {\sigma }_{\pi }^{2}\right),$$\end{document}</tex-math><mml:math id="M170" display="block"><mml:mrow><mml:mi mathvariant="normal">logit</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>π</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijk</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>∼</mml:mo><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mi>δ</mml:mi><mml:mo>×</mml:mo><mml:mi mathvariant="normal">logit</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:math><graphic xlink:href="12859_2023_5432_Article_Eque.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq69"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l$$\end{document}</tex-math><mml:math id="M172"><mml:mi>l</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq69.gif"/></alternatives></inline-formula> is 1 for group 1 sample and 2 for group 2 sample, <inline-formula id="IEq70"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{k}$$\end{document}</tex-math><mml:math id="M174"><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq70.gif"/></alternatives></inline-formula> is the log fold change of gene <inline-formula id="IEq71"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M176"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq71.gif"/></alternatives></inline-formula>’s expression between the two groups, <inline-formula id="IEq72"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d$$\end{document}</tex-math><mml:math id="M178"><mml:mi>d</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq72.gif"/></alternatives></inline-formula> is the dispersion, <inline-formula id="IEq73"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta$$\end{document}</tex-math><mml:math id="M180"><mml:mi>δ</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq73.gif"/></alternatives></inline-formula> is capture efficiency, and <inline-formula id="IEq74"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{\pi }^{2}$$\end{document}</tex-math><mml:math id="M182"><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq74.gif"/></alternatives></inline-formula> is the variability of dropout rate. Based on the median of <inline-formula id="IEq75"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{d}}_{k}$$\end{document}</tex-math><mml:math id="M184"><mml:msub><mml:mover accent="true"><mml:mi>d</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq75.gif"/></alternatives></inline-formula> and the empirical estimation of variance of cell-level dropout rate, we set <inline-formula id="IEq76"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$d=1$$\end{document}</tex-math><mml:math id="M186"><mml:mrow><mml:mi>d</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq76.gif"/></alternatives></inline-formula> and <inline-formula id="IEq77"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\sigma }_{\pi }^{2}=2000$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>2000</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq77.gif"/></alternatives></inline-formula> in all simulations. To choose genes with moderate to high expression level, we randomly selected 450 genes with <inline-formula id="IEq78"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{\lambda }}_{ik}\ge \frac{1}{{S}_{ij}}$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="italic">ik</mml:mi></mml:mrow></mml:msub><mml:mo>≥</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq78.gif"/></alternatives></inline-formula> for all cells and subjects, among which 150 were chosen to be DE genes and the remaining were non-DE genes. In each simulated dataset, for non-DE genes, the log fold change was set to <inline-formula id="IEq79"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{k}=0$$\end{document}</tex-math><mml:math id="M192"><mml:mrow><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq79.gif"/></alternatives></inline-formula> and for the DE genes, <inline-formula id="IEq80"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\beta }_{k}$$\end{document}</tex-math><mml:math id="M194"><mml:msub><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq80.gif"/></alternatives></inline-formula> was set to be the same value <inline-formula id="IEq81"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M196"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq81.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq82"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M198"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq82.gif"/></alternatives></inline-formula> varied from − 0.7 to − 0.1 and 0.1 to 0.7 with an increment of 0.1 across datasets. To simulate datasets with different levels of dropout rates, we set <inline-formula id="IEq83"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\delta =0.5, 1, 1.5$$\end{document}</tex-math><mml:math id="M200"><mml:mrow><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.5</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1.5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12859_2023_5432_Article_IEq83.gif"/></alternatives></inline-formula>, where the higher the capture efficiency is the fewer zeros exist in the simulated data.</p>
      <p id="Par46">We applied all methods to the simulated datasets to identify DE genes under different p-value threshold. By comparing the identified DE genes to the ground truth, the area under an ROC curve (AUC) score as well as the sensitivity and specificity under the p-value threshold of 0.05 were calculated for each method to evaluate method performance.</p>
    </sec>
    <sec id="Sec17">
      <title>scRNA-seq data analysis</title>
      <p id="Par47">We applied the DE analysis methods that consider subject effect to macrophage and fibroblast separately from the three real datasets. Method performance was assessed based on the consistency of the identified DE genes between datasets. Genes with a <italic>p</italic> value &lt; 0.01 were considered to be differentially expressed. The cell-level effect coefficient [<xref ref-type="bibr" rid="CR20">20</xref>] was used to demonstrate subject variation. To calculate the effect coefficient for each cell, we calculated dot products of log-normalized expression and the estimated group effects across the DE genes identified by iDESC and then scaled to a maximum absolute value of 1. To compare the consistency of DE genes between datasets, Fisher’s exact test was used to assess the significance of overlap and Jaccard index was calculated to measure the similarity between the two DE gene lists. For the overlapping DE genes between the two chosen datasets identified by each method in each cell type, we validated them using a list of 83 genes that are related to IPF in the Harmonizome database (<ext-link ext-link-type="uri" xlink:href="https://maayanlab.cloud/Harmonizome/">https://maayanlab.cloud/Harmonizome/</ext-link>). The proportion of validated genes was calculated as the percentage of 83 genes that were the between-dataset overlapping DE genes.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <sec id="Sec18">
      <title>Supplementary Information</title>
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12859_2023_5432_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Figure S1.</bold> Power comparison of iDESC and 7 methods without considering subject effect in simulated datasets. Evaluation criteria including (a) sensitivity and (b) specificity under the p-value threshold of 0.05, and (c) area under an ROC curve (AUC) to measure the accuracy of identified DE genes under three levels of capture efficiency (δ) and number of cells per subject (<italic>m</italic>). (d) ROC curves and the corresponding AUC scores when <italic>β</italic> = 0.4, <italic>δ</italic> = 1, <italic>m</italic> = 50.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12859_2023_5432_MOESM2_ESM.pdf">
            <caption>
              <p><bold>Additional file 2: Figure S2.</bold> Boxplots showing the expression distribution of the top 3 DE genes, FN1, CCL18 and SPP1, in the three IPF macrophage datasets.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12859_2023_5432_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 3: Table S1.</bold> Runtime of five methods using a single core.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>scRNA-seq</term>
        <def>
          <p id="Par4">Single-cell RNA sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>UMI</term>
        <def>
          <p id="Par5">Unique Molecular Identifier</p>
        </def>
      </def-item>
      <def-item>
        <term>IPF</term>
        <def>
          <p id="Par6">Idiopathic pulmonary fibrosis</p>
        </def>
      </def-item>
      <def-item>
        <term>DMSO</term>
        <def>
          <p id="Par7">Dimethyl sulfoxide</p>
        </def>
      </def-item>
      <def-item>
        <term>ROC</term>
        <def>
          <p id="Par8">Receiver operating characteristic</p>
        </def>
      </def-item>
      <def-item>
        <term>AUC</term>
        <def>
          <p id="Par9">Area under the curve</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>The original version of this article was revised: table 2 has been updated</p>
    </fn>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>
        <bold>Change history</bold>
      </p>
      <p>10/19/2023</p>
      <p>A Correction to this paper has been published: 10.1186/s12859-023-05523-6</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Ningshan Li, Qile Dai, Ran Tu and the Kaminski Lab for insightful comments and suggestions that helped improve the quality of the manuscript.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author contributions</title>
    <p>YL, ZW and XY conceived the idea, developed the method, and designed the study. YL implemented the software and performed the analyses. JZ and TSA contributed to real data analysis. NW contributed to simulation data collection. TSA, JCS and NK provided IPF lung scRNA-seq data. TSA, JCS, WW, JEM, GLC and NK aided result interpretation. YL, ZW and XY wrote the manuscript. ZW and XY supervised the research. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was funded by National Institutes of Health Grants K01AA023321, R21LM012884, R01LM014087 and National Science Foundation Grant DMS1916246. The funders played no roles in the design of the study, analysis, interpretation of results, and preparation of the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>All analyses were run in R v3.5.3. An R package implementing the proposed method is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/yl883/iDESC">https://github.com/yl883/iDESC</ext-link> under the MIT license and was deposited to Zenodo (<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.6929851">https://doi.org/10.5281/zenodo.6929851</ext-link>). The description of used data sets is in the “Real datasets” section. Barcodes of cells used for analysis can be found at Zenodo.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar1">
      <title>Ethics approval and consent to participate</title>
      <p id="Par48">No ethical approval was required for this study. All public datasets used in the paper were generated by other organizations that have obtained ethical approval.</p>
    </notes>
    <notes id="FPar2">
      <title>Consent for publication</title>
      <p id="Par49">Not applicable.</p>
    </notes>
    <notes id="FPar3" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par50">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gawad</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Koh</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Single-cell genome sequencing: current state of the science</article-title>
        <source>Nat Rev Genet</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>3</issue>
        <fpage>175</fpage>
        <lpage>188</lpage>
        <?supplied-pmid 26806412?>
        <pub-id pub-id-type="pmid">26806412</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Macosko</surname>
            <given-names>EZ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>
        <source>Cell</source>
        <year>2015</year>
        <volume>161</volume>
        <issue>5</issue>
        <fpage>1202</fpage>
        <lpage>1214</lpage>
        <?supplied-pmid 26000488?>
        <pub-id pub-id-type="pmid">26000488</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>GX</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>14049</fpage>
        <?supplied-pmid 28091601?>
        <pub-id pub-id-type="pmid">28091601</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stephenson</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq of rheumatoid arthritis synovial tissue using low-cost microfluidic instrumentation</article-title>
        <source>Nat Commun</source>
        <year>2018</year>
        <volume>9</volume>
        <fpage>791</fpage>
        <?supplied-pmid 29476078?>
        <pub-id pub-id-type="pmid">29476078</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>
        <source>Cell Metab</source>
        <year>2016</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <?supplied-pmid 27667667?>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yao</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq reveals TOX as a key regulator of CD8(+) T cell persistence in chronic infection</article-title>
        <source>Nat Immunol</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>7</issue>
        <fpage>890</fpage>
        <?supplied-pmid 31209400?>
        <pub-id pub-id-type="pmid">31209400</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pop</surname>
            <given-names>SM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single cell analysis shows decreasing FoxP3 and TGF beta 1 coexpressing CD4(+)CD25(+) regulatory T cells during autoimmune diabetes</article-title>
        <source>J Exp Med</source>
        <year>2005</year>
        <volume>201</volume>
        <issue>8</issue>
        <fpage>1333</fpage>
        <lpage>1346</lpage>
        <?supplied-pmid 15837817?>
        <pub-id pub-id-type="pmid">15837817</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chung</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq enables comprehensive tumour and immune cell profiling in primary breast cancer</article-title>
        <source>Nat Commun</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>15081</fpage>
        <?supplied-pmid 28474673?>
        <pub-id pub-id-type="pmid">28474673</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vieira Braga</surname>
            <given-names>FA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A cellular census of human lungs identifies novel cell states in health and in asthma</article-title>
        <source>Nat Med</source>
        <year>2019</year>
        <volume>25</volume>
        <issue>7</issue>
        <fpage>1153</fpage>
        <lpage>1163</lpage>
        <?supplied-pmid 31209336?>
        <pub-id pub-id-type="pmid">31209336</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grun</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell messenger RNA sequencing reveals rare intestinal cell types</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>525</volume>
        <issue>7568</issue>
        <fpage>251</fpage>
        <?supplied-pmid 26287467?>
        <pub-id pub-id-type="pmid">26287467</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Buettner</surname>
            <given-names>F</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2015</year>
        <volume>33</volume>
        <issue>2</issue>
        <fpage>155</fpage>
        <lpage>160</lpage>
        <?supplied-pmid 25599176?>
        <pub-id pub-id-type="pmid">25599176</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yuan</surname>
            <given-names>GC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Challenges and emerging directions in single-cell analysis</article-title>
        <source>Genome Biol</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>84</fpage>
        <?supplied-pmid 28482897?>
        <pub-id pub-id-type="pmid">28482897</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Benson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Single-cell analyses to tailor treatments</article-title>
        <source>Sci Transl Med</source>
        <year>2017</year>
        <volume>9</volume>
        <issue>408</issue>
        <fpage>eaan4730</fpage>
        <?supplied-pmid 28931656?>
        <pub-id pub-id-type="pmid">28931656</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luecken</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Theis</surname>
            <given-names>FJ</given-names>
          </name>
        </person-group>
        <article-title>Current best practices in single-cell RNA-seq analysis: a tutorial</article-title>
        <source>Mol Syst Biol</source>
        <year>2019</year>
        <volume>15</volume>
        <issue>6</issue>
        <fpage>e8746</fpage>
        <?supplied-pmid 31217225?>
        <pub-id pub-id-type="pmid">31217225</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Squair</surname>
            <given-names>JW</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Confronting false discoveries in single-cell differential expression</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>5692</fpage>
        <?supplied-pmid 34584091?>
        <pub-id pub-id-type="pmid">34584091</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kharchenko</surname>
            <given-names>PV</given-names>
          </name>
          <name>
            <surname>Silberstein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Scadden</surname>
            <given-names>DT</given-names>
          </name>
        </person-group>
        <article-title>Bayesian approach to single-cell differential expression analysis</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>7</issue>
        <fpage>740</fpage>
        <lpage>742</lpage>
        <?supplied-pmid 24836921?>
        <pub-id pub-id-type="pmid">24836921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Reyfman</surname>
            <given-names>PA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell transcriptomic analysis of human lung provides insights into the pathobiology of pulmonary fibrosis</article-title>
        <source>Am J Respir Crit Care Med</source>
        <year>2019</year>
        <volume>199</volume>
        <issue>12</issue>
        <fpage>1517</fpage>
        <lpage>1536</lpage>
        <?supplied-pmid 30554520?>
        <pub-id pub-id-type="pmid">30554520</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adams</surname>
            <given-names>TS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA-seq reveals ectopic and aberrant lung-resident cell populations in idiopathic pulmonary fibrosis</article-title>
        <source>Sci Adv</source>
        <year>2020</year>
        <volume>6</volume>
        <issue>28</issue>
        <fpage>eaba1983</fpage>
        <?supplied-pmid 32832599?>
        <pub-id pub-id-type="pmid">32832599</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zimmerman</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Espeland</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Langefeld</surname>
            <given-names>CD</given-names>
          </name>
        </person-group>
        <article-title>A practical solution to pseudoreplication bias in single-cell studies</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>738</fpage>
        <?supplied-pmid 33531494?>
        <pub-id pub-id-type="pmid">33531494</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crowell</surname>
            <given-names>HL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>muscat detects subpopulation-specific state transitions from multi-sample multi-condition single-cell transcriptomics data</article-title>
        <source>Nat Commun</source>
        <year>2020</year>
        <volume>11</volume>
        <issue>1</issue>
        <fpage>6077</fpage>
        <?supplied-pmid 33257685?>
        <pub-id pub-id-type="pmid">33257685</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lopez</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Deep generative modeling for single-cell transcriptomics</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>1053</fpage>
        <lpage>1058</lpage>
        <?supplied-pmid 30504886?>
        <pub-id pub-id-type="pmid">30504886</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wohnhaas</surname>
            <given-names>CT</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DMSO cryopreservation is the method of choice to preserve cells for droplet-based single-cell RNA sequencing</article-title>
        <source>Sci Rep</source>
        <year>2019</year>
        <volume>9</volume>
        <issue>1</issue>
        <fpage>10699</fpage>
        <?supplied-pmid 31337793?>
        <pub-id pub-id-type="pmid">31337793</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soneson</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
        </person-group>
        <article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title>
        <source>Nat Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>4</issue>
        <fpage>255</fpage>
        <lpage>261</lpage>
        <?supplied-pmid 29481549?>
        <pub-id pub-id-type="pmid">29481549</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dal Molin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Baruzzo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Di Camillo</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA-sequencing: assessment of differential expression analysis methods</article-title>
        <source>Front Genet</source>
        <year>2017</year>
        <volume>8</volume>
        <fpage>62</fpage>
        <pub-id pub-id-type="pmid">28588607</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaakkola</surname>
            <given-names>MK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparison of methods to detect differentially expressed genes between single-cell populations</article-title>
        <source>Brief Bioinform</source>
        <year>2017</year>
        <volume>18</volume>
        <issue>5</issue>
        <fpage>735</fpage>
        <lpage>743</lpage>
        <?supplied-pmid 27373736?>
        <pub-id pub-id-type="pmid">27373736</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vallejos</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>BASiCS: Bayesian analysis of single-cell sequencing data</article-title>
        <source>PLoS Comput Biol</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>6</issue>
        <fpage>e1004333</fpage>
        <?supplied-pmid 26107944?>
        <pub-id pub-id-type="pmid">26107944</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Accounting for technical noise in differential expression analysis of single-cell RNA sequencing data</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>19</issue>
        <fpage>10978</fpage>
        <lpage>10988</lpage>
        <?supplied-pmid 29036714?>
        <pub-id pub-id-type="pmid">29036714</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell mRNA quantification and differential analysis with Census</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>3</issue>
        <fpage>309</fpage>
        <lpage>315</lpage>
        <?supplied-pmid 28114287?>
        <pub-id pub-id-type="pmid">28114287</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Qiu</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Reversed graph embedding resolves complex single-cell trajectories</article-title>
        <source>Nat Methods</source>
        <year>2017</year>
        <volume>14</volume>
        <issue>10</issue>
        <fpage>979</fpage>
        <lpage>982</lpage>
        <?supplied-pmid 28825705?>
        <pub-id pub-id-type="pmid">28825705</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Trapnell</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>
        <source>Nat Biotechnol</source>
        <year>2014</year>
        <volume>32</volume>
        <issue>4</issue>
        <fpage>381</fpage>
        <lpage>386</lpage>
        <?supplied-pmid 24658644?>
        <pub-id pub-id-type="pmid">24658644</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>UMI-count modeling and differential expression analysis for single-cell RNA sequencing</article-title>
        <source>Genome Biol</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>70</fpage>
        <?supplied-pmid 29855333?>
        <pub-id pub-id-type="pmid">29855333</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Miao</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>DEsingle for detecting three types of differential expression in single-cell RNA-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>18</issue>
        <fpage>3223</fpage>
        <lpage>3224</lpage>
        <?supplied-pmid 29688277?>
        <pub-id pub-id-type="pmid">29688277</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ye</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
          <name>
            <surname>Salim</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>DECENT: differential expression with capture efficiency adjustmeNT for single-cell RNA-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>24</issue>
        <fpage>5155</fpage>
        <lpage>5162</lpage>
        <?supplied-pmid 31197307?>
        <pub-id pub-id-type="pmid">31197307</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Two-phase differential expression analysis for single cell RNA-seq</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>19</issue>
        <fpage>3340</fpage>
        <lpage>3348</lpage>
        <?supplied-pmid 29688282?>
        <pub-id pub-id-type="pmid">29688282</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>
        <source>Genome Biol</source>
        <year>2015</year>
        <volume>16</volume>
        <fpage>278</fpage>
        <?supplied-pmid 26653891?>
        <pub-id pub-id-type="pmid">26653891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vieth</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A systematic evaluation of single cell RNA-seq analysis pipelines</article-title>
        <source>Nat Commun</source>
        <year>2019</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>4667</fpage>
        <?supplied-pmid 31604912?>
        <pub-id pub-id-type="pmid">31604912</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Korthauer</surname>
            <given-names>KD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A statistical approach for identifying differential distributions in single-cell RNA-seq experiments</article-title>
        <source>Genome Biol</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>222</fpage>
        <?supplied-pmid 27782827?>
        <pub-id pub-id-type="pmid">27782827</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delmans</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Discrete distributional differential expression (D3E)–a tool for gene expression analysis of single-cell RNA-seq data</article-title>
        <source>BMC Bioinform</source>
        <year>2016</year>
        <volume>17</volume>
        <fpage>110</fpage>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Love</surname>
            <given-names>MI</given-names>
          </name>
          <name>
            <surname>Huber</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Anders</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>
        <source>Genome Biol</source>
        <year>2014</year>
        <volume>15</volume>
        <issue>12</issue>
        <fpage>550</fpage>
        <?supplied-pmid 25516281?>
        <pub-id pub-id-type="pmid">25516281</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ritchie</surname>
            <given-names>ME</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>limma powers differential expression analyses for RNA-sequencing and microarray studies</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>7</issue>
        <fpage>e47</fpage>
        <?supplied-pmid 25605792?>
        <pub-id pub-id-type="pmid">25605792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilcoxon</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Individual comparisons of grouped data by ranking methods</article-title>
        <source>J Econ Entomol</source>
        <year>1946</year>
        <volume>39</volume>
        <fpage>269</fpage>
        <?supplied-pmid 20983181?>
        <pub-id pub-id-type="pmid">20983181</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Habermann</surname>
            <given-names>AC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Single-cell RNA sequencing reveals profibrotic roles of distinct epithelial and mesenchymal lineages in pulmonary fibrosis</article-title>
        <source>Sci Adv</source>
        <year>2020</year>
        <volume>6</volume>
        <issue>28</issue>
        <fpage>eaba1972</fpage>
        <?supplied-pmid 32832598?>
        <pub-id pub-id-type="pmid">32832598</pub-id>
      </element-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wynes</surname>
            <given-names>MW</given-names>
          </name>
          <name>
            <surname>Riches</surname>
            <given-names>DW</given-names>
          </name>
        </person-group>
        <article-title>Transcription of macrophage IGF-I exon 1 is positively regulated by the 5'-untranslated region and negatively regulated by the 5'-flanking region</article-title>
        <source>Am J Physiol Lung Cell Mol Physiol</source>
        <year>2005</year>
        <volume>288</volume>
        <issue>6</issue>
        <fpage>L1089</fpage>
        <lpage>L1098</lpage>
        <?supplied-pmid 15681396?>
        <pub-id pub-id-type="pmid">15681396</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <mixed-citation publication-type="other">Morse C et al. Proliferating SPP1/MERTK-expressing macrophages in idiopathic pulmonary fibrosis. Eur Respir J. 2019;54(2):1802441.</mixed-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Bioinformatics analysis on differentially expressed genes of alveolar macrophage in IPF</article-title>
        <source>Exp Lung Res</source>
        <year>2019</year>
        <volume>45</volume>
        <issue>9–10</issue>
        <fpage>288</fpage>
        <lpage>296</lpage>
        <?supplied-pmid 31762326?>
        <pub-id pub-id-type="pmid">31762326</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <mixed-citation publication-type="other">Bargagli E et al. Macrophage-derived biomarkers of idiopathic pulmonary fibrosis. Pulm Med 2011;2011:717130.</mixed-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schupp</surname>
            <given-names>JC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Macrophage activation in acute exacerbation of idiopathic pulmonary fibrosis</article-title>
        <source>PLoS ONE</source>
        <year>2015</year>
        <volume>10</volume>
        <issue>1</issue>
        <fpage>e0116775</fpage>
        <?supplied-pmid 25590613?>
        <pub-id pub-id-type="pmid">25590613</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Prasse</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CCL18 as an indicator of pulmonary fibrotic activity in idiopathic interstitial pneumonias and systemic sclerosis</article-title>
        <source>Arthritis Rheum</source>
        <year>2007</year>
        <volume>56</volume>
        <issue>5</issue>
        <fpage>1685</fpage>
        <lpage>1693</lpage>
        <?supplied-pmid 17469163?>
        <pub-id pub-id-type="pmid">17469163</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Peyser</surname>
            <given-names>R</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Defining the activated fibroblast population in lung fibrosis using single-cell sequencing</article-title>
        <source>Am J Respir Cell Mol Biol</source>
        <year>2019</year>
        <volume>61</volume>
        <issue>1</issue>
        <fpage>74</fpage>
        <lpage>85</lpage>
        <?supplied-pmid 30848683?>
        <pub-id pub-id-type="pmid">30848683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rodriguez</surname>
            <given-names>LR</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Global gene expression analysis in an in vitro fibroblast model of idiopathic pulmonary fibrosis reveals potential role for CXCL14/CXCR4</article-title>
        <source>Sci Rep</source>
        <year>2018</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>3983</fpage>
        <?supplied-pmid 29507348?>
        <pub-id pub-id-type="pmid">29507348</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <mixed-citation publication-type="other">Wan H. et al. Identification of hub genes and pathways associated with idiopathic pulmonary fibrosis via bioinformatics analysis. Front Mol Biosci 2021;8:711239.</mixed-citation>
    </ref>
    <ref id="CR52">
      <label>52.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Selman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Pardo</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kaminski</surname>
            <given-names>N</given-names>
          </name>
        </person-group>
        <article-title>Idiopathic pulmonary fibrosis: Aberrant recapitulation of developmental programs?</article-title>
        <source>PLoS Med</source>
        <year>2008</year>
        <volume>5</volume>
        <issue>3</issue>
        <fpage>e62</fpage>
        <?supplied-pmid 18318599?>
        <pub-id pub-id-type="pmid">18318599</pub-id>
      </element-citation>
    </ref>
    <ref id="CR53">
      <label>53.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jia</surname>
            <given-names>G</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>CXCL14 is a candidate biomarker for Hedgehog signalling in idiopathic pulmonary fibrosis</article-title>
        <source>Thorax</source>
        <year>2017</year>
        <volume>72</volume>
        <issue>9</issue>
        <fpage>780</fpage>
        <lpage>787</lpage>
        <?supplied-pmid 28250200?>
        <pub-id pub-id-type="pmid">28250200</pub-id>
      </element-citation>
    </ref>
    <ref id="CR54">
      <label>54.</label>
      <mixed-citation publication-type="other">Ishii T. et al. Elevated levels of BRAK/CXCL14 from patients with idiopathic pulmonary fibrosis. C103. Pathogenesis, Biomarkers, and Risk Factors for Interstitial Lung Disease: from Bench to Bedside. 2012; p. A5178.</mixed-citation>
    </ref>
    <ref id="CR55">
      <label>55.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shu</surname>
            <given-names>H-KG</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Inhibition of the CXCL12/CXCR4-axis as preventive therapy for radiation-induced pulmonary fibrosis</article-title>
        <source>PLoS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>11</issue>
        <fpage>e79768</fpage>
        <?supplied-pmid 24244561?>
        <pub-id pub-id-type="pmid">24244561</pub-id>
      </element-citation>
    </ref>
    <ref id="CR56">
      <label>56.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chow</surname>
            <given-names>LN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Impact of a CXCL12/CXCR4 antagonist in bleomycin (BLM) induced pulmonary fibrosis and carbon tetrachloride (CCl4) induced hepatic fibrosis in mice</article-title>
        <source>PLoS ONE</source>
        <year>2016</year>
        <volume>11</volume>
        <issue>3</issue>
        <fpage>e0151765</fpage>
        <?supplied-pmid 26998906?>
        <pub-id pub-id-type="pmid">26998906</pub-id>
      </element-citation>
    </ref>
    <ref id="CR57">
      <label>57.</label>
      <mixed-citation publication-type="other">Rouillard AD et al. The harmonizome: a collection of processed datasets gathered to serve and mine knowledge about genes and proteins<italic>.</italic> Database. 2016;2016:baw100.</mixed-citation>
    </ref>
    <ref id="CR58">
      <label>58.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>Small-sample estimation of negative binomial dispersion, with applications to SAGE data</article-title>
        <source>Biostatistics</source>
        <year>2008</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>321</fpage>
        <lpage>332</lpage>
        <?supplied-pmid 17728317?>
        <pub-id pub-id-type="pmid">17728317</pub-id>
      </element-citation>
    </ref>
    <ref id="CR59">
      <label>59.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lloyd-Smith</surname>
            <given-names>JO</given-names>
          </name>
        </person-group>
        <article-title>maximum likelihood estimation of the negative binomial dispersion parameter for highly overdispersed data, with applications to infectious diseases</article-title>
        <source>PLoS ONE</source>
        <year>2007</year>
        <volume>2</volume>
        <issue>2</issue>
        <fpage>e180</fpage>
        <?supplied-pmid 17299582?>
        <pub-id pub-id-type="pmid">17299582</pub-id>
      </element-citation>
    </ref>
    <ref id="CR60">
      <label>60.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>CR</given-names>
          </name>
        </person-group>
        <article-title>Large sample tests of statistical hypotheses concerning several parameters with applications to problems of estimation</article-title>
        <source>Proc Camb Philos Soc</source>
        <year>1948</year>
        <volume>44</volume>
        <issue>1</issue>
        <fpage>50</fpage>
        <lpage>57</lpage>
      </element-citation>
    </ref>
    <ref id="CR61">
      <label>61.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brooks</surname>
            <given-names>ME</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>glmmTMB balances speed and flexibility among packages for zero-inflated generalized linear mixed modeling</article-title>
        <source>R J</source>
        <year>2017</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>378</fpage>
        <lpage>400</lpage>
      </element-citation>
    </ref>
    <ref id="CR62">
      <label>62.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive Integration of Single-Cell Data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <issue>7</issue>
        <fpage>1888</fpage>
        <lpage>1902</lpage>
        <?supplied-pmid 31178118?>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR63">
      <label>63.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Blondel</surname>
            <given-names>VD</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Fast unfolding of communities in large networks</article-title>
        <source>J Stat Mech Theory Exp</source>
        <year>2008</year>
        <volume>2008</volume>
        <fpage>10008</fpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
