<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version v40?>
<?ConverterInfo.XSLTName bmc2nlm.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2736174</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-10-242</article-id>
    <article-id pub-id-type="pmid">19660130</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-10-242</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>R/BHC: fast Bayesian hierarchical clustering for microarray data</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Savage</surname>
          <given-names>Richard S</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>r.s.savage@warwick.ac.uk</email>
      </contrib>
      <contrib id="A2" contrib-type="author">
        <name>
          <surname>Heller</surname>
          <given-names>Katherine</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>heller@gatsby.ucl.ac.uk</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Xu</surname>
          <given-names>Yang</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>yang_xu_ch@yahoo.com</email>
      </contrib>
      <contrib id="A4" contrib-type="author">
        <name>
          <surname>Ghahramani</surname>
          <given-names>Zoubin</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>zoubin@eng.cam.ac.uk</email>
      </contrib>
      <contrib id="A5" contrib-type="author">
        <name>
          <surname>Truman</surname>
          <given-names>William M</given-names>
        </name>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>W.M.Truman@exeter.ac.uk</email>
      </contrib>
      <contrib id="A6" contrib-type="author">
        <name>
          <surname>Grant</surname>
          <given-names>Murray</given-names>
        </name>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>M.R.Grant@exeter.ac.uk</email>
      </contrib>
      <contrib id="A7" contrib-type="author">
        <name>
          <surname>Denby</surname>
          <given-names>Katherine J</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>k.j.denby@warwick.ac.uk</email>
      </contrib>
      <contrib id="A8" corresp="yes" contrib-type="author">
        <name>
          <surname>Wild</surname>
          <given-names>David L</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>d.l.wild@warwick.ac.uk</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Systems Biology Centre, University of Warwick, Coventry House, Coventry, CV4 7AL, UK</aff>
    <aff id="I2"><label>2</label>Warwick HRI, University of Warwick, Wellesbourne, CV35 9EF, UK</aff>
    <aff id="I3"><label>3</label>Department of Engineering, University of Cambridge, Cambridge CB2 1PZ, UK</aff>
    <aff id="I4"><label>4</label>School of Biosciences, University of Exeter, Exeter, EX4 4QD, UK</aff>
    <pub-date pub-type="collection">
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <volume>10</volume>
    <fpage>242</fpage>
    <lpage>242</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/10/242"/>
    <history>
      <date date-type="received">
        <day>19</day>
        <month>11</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>6</day>
        <month>8</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2009 Savage et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2009</copyright-year>
      <copyright-holder>Savage et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Savage
               S
               Richard
               
               r.s.savage@warwick.ac.uk
            </dc:author><dc:title>
            R/BHC: fast Bayesian hierarchical clustering for microarray data
         </dc:title><dc:date>2009</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 10(1): 242-. (2009)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2009)10:1&#x0003c;242&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Although the use of clustering methods has rapidly become one of the standard computational approaches in the literature of microarray gene expression data analysis, little attention has been paid to uncertainty in the results obtained.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present an R/Bioconductor port of a fast novel algorithm for Bayesian agglomerative hierarchical clustering and demonstrate its use in clustering gene expression microarray data. The method performs bottom-up hierarchical clustering, using a Dirichlet Process (infinite mixture) to model uncertainty in the data and Bayesian model selection to decide at each step which clusters to merge.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>Biologically plausible results are presented from a well studied data set: expression profiles of <italic>A. thaliana </italic>subjected to a variety of biotic and abiotic stresses. Our method avoids several limitations of traditional methods, for example how many clusters there should be and how to choose a principled distance metric.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Although the use of clustering methods has rapidly become one of the standard computational approaches in the literature of microarray gene expression data analysis [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B3">3</xref>], little attention has been paid to uncertainty in the results obtained. In clustering, the patterns of expression of different genes across time, treatments, and tissues are grouped into distinct clusters (perhaps organized hierarchically), in which genes in the same cluster are assumed to be potentially functionally related or to be influenced by a common upstream factor. Such cluster structure is often used to aid the elucidation of regulatory networks. Agglomerative hierarchical clustering [<xref ref-type="bibr" rid="B1">1</xref>] is one of the most frequently used methods for clustering gene expression profiles. However, commonly used methods for agglomerative hierarchical clustering rely on the setting of some score threshold to distinguish members of a particular cluster from non-members, making the determination of the number of clusters arbitrary and subjective. The algorithm provides no guide to choosing the "correct" number of clusters or the level at which to prune the tree. It is often difficult to know which distance metric to choose, especially for structured data such as gene expression profiles. Moreover, these approaches do not provide a measure of uncertainty about the clustering, making it difficult to compute the predictive quality of the clustering and to make comparisons between clusterings based on different model assumptions (e.g. numbers of clusters, shapes of clusters, etc.). Attempts to address these problems in a classical statistical framework have focused on the use of bootstrapping [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B5">5</xref>] or the use of permutation procedures to calculate local <italic>p</italic>-values for the significance of branching in a dendrogram produced by agglomerative hierarchical clustering [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>].</p>
    <p>A commonly used computational method of <italic>non-hierarchical clustering</italic>, based on measuring Euclidean distance between feature vectors is given by the k-means algorithm [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>]. However, the k-means algorithm requires the number of clusters to be predefined, and has been shown to be inadequate for describing clusters of unequal size or shape [<xref ref-type="bibr" rid="B10">10</xref>], which limits its applicability to many biological datasets.</p>
    <p>Bayesian methods provide a principled approach to these types of analyses and are becoming increasingly popular in a variety of problems across many disciplines: clustering stocks with different price dynamics in finance [<xref ref-type="bibr" rid="B11">11</xref>], clustering regions with different growth patterns in economics [<xref ref-type="bibr" rid="B12">12</xref>], in signal processing applications [<xref ref-type="bibr" rid="B13">13</xref>], as well as in computational biology and genetics [<xref ref-type="bibr" rid="B14">14</xref>].</p>
    <p>Bayesian approaches to hierarchical clustering of gene expression data have been described by Neal [<xref ref-type="bibr" rid="B15">15</xref>], who used a Dirichlet diffusion tree model, and by Heard et al. [<xref ref-type="bibr" rid="B16">16</xref>,<xref ref-type="bibr" rid="B17">17</xref>] who describe a Bayesian model-based approach for clustering time series, based on regression models and nonlinear basis functions. In previous work [<xref ref-type="bibr" rid="B18">18</xref>] we have also described an approach to the problem of automatically clustering gene expression profiles, based on the theory of Dirichlet process (i.e. countably infinite) mixtures. However, all this work, like most Bayesian approaches, is based on sampling using Markov Chain Monte Carlo (MCMC) methods. While MCMC has useful theoretical guarantees, its applicability to large post-genomic datasets is limited by its speed.</p>
    <p>In this paper, we present an R/Bioconductor port of the fast novel algorithm for Bayesian agglomerative hierarchical clustering (BHC) introduced by Heller and Ghahramani [<xref ref-type="bibr" rid="B19">19</xref>]. This algorithm is based on evaluating the marginal likelihoods of a probabilistic model, and may be interpreted as a bottom-up approximate inference method for a Dirichlet process mixture model (DPM). A DPM is a widely used model for clustering [<xref ref-type="bibr" rid="B20">20</xref>] which has the interesting property that the prior probability of a new data point joining a cluster is proportional to the number of points already in that cluster. Moreover, with a probability proportional to α/<italic>n </italic>the (<italic>n </italic>+ 1)th data point forms a new cluster. Here α is a hyperparameter controlling the expected number of clusters as a function of the number of data points <italic>n</italic>. The BHC algorithm uses a model based criterion based on the marginal likelihoods of a DPM to merge clusters, rather than using an ad-hoc distance metric. Bayesian hypothesis testing is used to decide which cluster merges increase the tree quality. Importantly, the optimum tree depth is also calculated, resulting in the best number and size of clusters to fit the data.</p>
    <sec>
      <title>Implementation</title>
      <p>The BHC algorithm is similar to traditional agglomerative clustering in that it is a one-pass, bottom-up method which initializes each data point in its own cluster and iteratively merges pairs of clusters. However, instead of distance, the algorithm uses a statistical hypothesis test to choose which clusters to merge.</p>
      <p>Let <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i1.gif"/></inline-formula> = {<bold><italic>x</italic></bold><sup>(1)</sup>,..., <bold><italic>x</italic></bold><sup>(<italic>n</italic>)</sup>} denote the entire data set, and <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i2.gif"/></inline-formula> the set of data points at the leaves of the subtree <italic>T</italic><sub><italic>i</italic></sub>. The algorithm is initialized with <italic>n </italic>trivial trees, {<italic>T</italic><sub><italic>i </italic></sub>: <italic>i </italic>= 1...<italic>n</italic>} each containing a single data point <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i3.gif"/></inline-formula> = {<bold>x</bold><sup>(<italic>i</italic>)</sup>}. At each stage the algorithm considers merging all pairs of existing trees. In considering each merge, two hypotheses are compared. The first hypothesis, denoted by <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i4.gif"/></inline-formula> is that all the data in <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i5.gif"/></inline-formula> were in fact generated independently and identically from the <italic>same probabilistic model</italic>, <italic>p</italic>(<bold>x</bold>|<italic>θ</italic>) with unknown parameters <italic>θ</italic>. The alternative hypothesis, denoted by <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i6.gif"/></inline-formula> would be that the data in <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i5.gif"/></inline-formula> has two or more clusters in it.</p>
      <p>To evaluate the probability of the data under hypothesis <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i4.gif"/></inline-formula>, we need to specify some prior over the parameters of the model, <italic>p</italic>(<italic>θ</italic>|<italic>β</italic>) with hyperparameters <italic>β</italic>. We now have the ingredients to compute the probability of the data <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i5.gif"/></inline-formula> under <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i4.gif"/></inline-formula>:</p>
      <p>
        <disp-formula id="bmcM1">
          <label>(1)</label>
          <graphic xlink:href="1471-2105-10-242-i7.gif"/>
        </disp-formula>
      </p>
      <p>This calculates the probability that all the data in <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i5.gif"/></inline-formula> were generated from the same parameter values assuming a model of the form <italic>p</italic>(<bold>x</bold>/<italic>θ</italic>). This is a natural model-based criterion for measuring how well the data fit into one cluster.</p>
      <p>The probability of the data under the alternative hypothesis, <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i6.gif"/></inline-formula> (if we restrict ourselves to clusterings that partition the data in a manner that is consistent with the subtrees <italic>T</italic><sub><italic>i </italic></sub>and <italic>T</italic><sub><italic>j</italic></sub>, where <italic>T</italic><sub><italic>i </italic></sub>and <italic>T</italic><sub><italic>j </italic></sub>are the two subtrees of <italic>T</italic><sub><italic>k</italic></sub>), is simply a product over the subtrees <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i8.gif"/></inline-formula> where the probability of a data set under a tree (e.g. <italic>p</italic>(<inline-formula><inline-graphic xlink:href="1471-2105-10-242-i3.gif"/></inline-formula>|<italic>T</italic><sub><italic>i</italic></sub>)) is defined below. Combining the probability of the data under hypotheses <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i4.gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i6.gif"/></inline-formula>, weighted by the prior that all points in <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i5.gif"/></inline-formula> belong to one cluster, <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i9.gif"/></inline-formula>, we obtain the marginal probability of the data in tree <italic>T</italic><sub><italic>k</italic></sub>:</p>
      <p>
        <disp-formula id="bmcM2">
          <label>(2)</label>
          <graphic xlink:href="1471-2105-10-242-i10.gif"/>
        </disp-formula>
      </p>
      <p>The prior for the merged hypothesis, <italic>π</italic><sub><italic>k</italic></sub>, can be defined such a manner that BHC efficiently computes probabilities of clusterings consistent with the widely used Dirichlet process mixture model. Note that <italic>π</italic><sub><italic>k </italic></sub>is not an estimated parameter but rather a deterministic function of <italic>α </italic>and the number of points in a given subtree. It is computed bottom-up as the tree is built as described in [<xref ref-type="bibr" rid="B19">19</xref>].</p>
      <p>The posterior probability of the merged hypothesis <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i11.gif"/></inline-formula> is then obtained using Baye's rule:</p>
      <p>
        <disp-formula id="bmcM3">
          <label>(3)</label>
          <graphic xlink:href="1471-2105-10-242-i12.gif"/>
        </disp-formula>
      </p>
      <p>If this posterior probability <italic>r</italic><sub><italic>k </italic></sub>&gt; 0.5 it means that the merged hypothesis is more probable than the alternative partitionings and therefore sub-trees should be left intact. Conversely, if <italic>r</italic><sub><italic>k </italic></sub>&lt; 0.5 then the branches constitute separate clusters.</p>
      <p>The BHC algorithm is very simple and is shown in the Appendix. Full details of the algorithm and underlying theory, as well as validation results based on synthetic and real non-biological datasets (including comparisons to traditional agglomerative hierarchical clustering using a Euclidean distance metric and average, single and complete linkage methods) can be found in [<xref ref-type="bibr" rid="B19">19</xref>].</p>
    </sec>
    <sec>
      <title>Evaluating the Quality of Clustering</title>
      <p>For a data set which has labelled classes, it is possible to compare the quality of hierarchical clusterings obtained from different methods to these known classes. However, the literature is notably lacking in quantitative measures of dendrogram quality suitable for use with the BHC algorithm.</p>
      <p>For instance, most of the quality indices implemented in the clValid package [<xref ref-type="bibr" rid="B21">21</xref>] require a distance metric: since BHC does not use a distance metric these indices are unsuitable for our comparisons. Another commonly used index for measuring the agreement between two clusterings is the adjusted Rand index [<xref ref-type="bibr" rid="B22">22</xref>]: large values for the adjusted Rand index mean better agreement between two clusterings. A value of unity would indicate a perfect match between the clustering partition and ground truth, with zero being the expected result for a random partition. However, this index is only really of use if the true clustering structure is known. In most real-world applications of clustering to microarray data, the biological ground truth is unknown. Nevertheless, the adjusted Rand index has been used to evaluate the performance of a variety of clustering algorithms on experimental microarray data by Yeung et al [<xref ref-type="bibr" rid="B23">23</xref>]. These authors used a subset of the data described by Ideker et al. [<xref ref-type="bibr" rid="B24">24</xref>], a set of 997 mRNA profiles across 20 experiments representing systematic perturbations of the yeast galactose-utilization pathway. A subset of 205 of these genes were assigned to four functional categories (biosynthesis, protein metabolism and modification; energy pathways, carbohydrate metabolism, catabolism; nucleobase, nucleoside, nucleotide and nucleic acid metabolism; transport), based on Gene Ontology (GO) annotations. However, in their supplementary material, Yeung et al. note that since this array data may not fully reflect these functional categories, this classification should be used with caution.</p>
      <p>For the purposes of comparison, we have applied our BHC algorithm to this data set, treating the four assigned classes as "ground truth", with the caveat above. The BHC algorithm automatically correctly identifies four classes in the data, as shown by the dendrogram [see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>]. The adjusted Rand index is 0.955, which is in the upper range of those calculated by Yeung et al. [<xref ref-type="bibr" rid="B23">23</xref>]. For comparison, standard hierarchical clustering using average linkage and a correlation distance metric gives an adjusted Rand index of 0.866. The shrinkage correlation coefficient (SCC) of Yao et al. [<xref ref-type="bibr" rid="B25">25</xref>], which used the same data set as a benchmark, gives an adjusted Rand index of 0.876.</p>
      <sec>
        <title>Quality Measures</title>
        <p>In order to perform the comparison of two dendrograms produced by different clustering methods, we have devised a new quantitative measure: <bold>DendrogramPurity</bold>, which takes as input a dendrogram tree structure <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i13.gif"/></inline-formula> and a set of class labels <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i14.gif"/></inline-formula> for the leaves of the tree and outputs a single number measuring how "pure" the subtrees of <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i13.gif"/></inline-formula> are with respect to the class labels <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i14.gif"/></inline-formula>.</p>
        <p><bold>DendrogramPurity</bold>(<inline-formula><inline-graphic xlink:href="1471-2105-10-242-i13.gif"/></inline-formula>, <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i14.gif"/></inline-formula>): where T is a binary tree (dendrogram) with set of leaves ℒ = {1 ..., <italic>L</italic>} and <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i14.gif"/></inline-formula> = {<italic>c</italic><sub>1</sub>,..., <italic>c</italic><sub><italic>L</italic></sub>} is the set of known class assignments for each leaf. The DendrogramPurity is defined to be the measure obtained from this random process: pick a leaf ℓ uniformly at random. Pick another leaf <italic>j </italic>in the same class, i.e. <italic>c</italic><sub>ℓ </sub>= <italic>c</italic><sub><italic>j</italic></sub>. Find the smallest subtree containing ℓ and <italic>j</italic>. Measure the fraction of leaves in that subtree which are in the same class, i.e. <italic>c</italic><sub>ℓ</sub>. The expected value of this fraction is the DendrogramPurity. This measure can be computed efficiently using a bottom up recursion (without needing to resort to sampling). The overall tree purity is 1 if and only if all leaves in each class are contained within some pure subtree.</p>
        <p>For each leaf of the tree it also useful to measure how well it fits in with the labels of the leaves in the surrounding subtree. Leaves which do not fit well contribute to decreasing the overall dendrogram purity. These may highlight unusual or misclassified genes, drugs or cell lines. We define the <bold>LeafHarmony </bold>of a leaf ℓ as a measure of how well that leaf fits in.</p>
        <p><bold>LeafHarmony</bold>(ℓ,<inline-formula><inline-graphic xlink:href="1471-2105-10-242-i13.gif"/></inline-formula>, <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i14.gif"/></inline-formula>): Pick a random leaf <italic>j </italic>in same class as leaf ℓ, i.e. <italic>c</italic><sub><italic>j </italic></sub>= <italic>c</italic><sub>ℓ</sub>, <italic>j </italic>≠ ℓ. Find the smallest subtree containing ℓ and <italic>j</italic>. Measure the fraction of leaves in that subtree which are in class <italic>c</italic><sub>ℓ</sub>. The expected value of this fraction is the LeafHarmony for ℓ and it measures the contribution of that leaf to the DendrogramPurity.</p>
        <p>For the case of data sets where there are not clearly defined class labels these measures are not applicable so we have defined a third measure, the <bold>LeafDisparity</bold>, which highlights differences between two hierarchical clusterings (i.e. dendrograms) of the same data. Intuitively, this measures for each leaf of one dedrogram how similar the surrounding subtree is to the corresponding subtree in the other dendrogram. Define the correlation between two sets <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i15.gif"/></inline-formula> and ℛ to be <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i16.gif"/></inline-formula>, where |·| denotes the number of elements in a set. <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i17.gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i18.gif"/></inline-formula>. Note that a tree <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i13.gif"/></inline-formula> can be converted into a set-of-sets representation <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i13.gif"/></inline-formula> = {<italic>τ</italic><sub>1</sub>,..., <italic>τ</italic><sub><italic>k</italic></sub>}. For each node <italic>j </italic>in the tree, <italic>τ</italic><sub><italic>j </italic></sub>is the set of the leaves in the subtree descending from <italic>j</italic>. (Thus in a binary tree with <italic>n </italic>leaves contains <italic>n </italic>- 1 non-leaf internal nodes, so <italic>k </italic>= 2<italic>n </italic>- 1).</p>
        <p><bold>LeafDisparity</bold>(ℓ,<inline-formula><inline-graphic xlink:href="1471-2105-10-242-i13.gif"/></inline-formula>, <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i19.gif"/></inline-formula>): Convert each tree into a set-of-sets representation. Align the trees: For each set <italic>τ</italic><sub><italic>j </italic></sub>in <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i13.gif"/></inline-formula>, find the set <italic>ρ</italic><sub><italic>k </italic></sub>in <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i19.gif"/></inline-formula> such that the correlation is greatest: <italic>r</italic><sub><italic>j </italic></sub>= max<sub><italic>k</italic></sub><italic>c</italic>(<italic>τ</italic><sub><italic>j</italic></sub>, <italic>ρ</italic><sub><italic>k</italic></sub>). For each leaf ℓ find the average of <italic>r</italic><sub><italic>j </italic></sub>over all sets that contain ℓ, calling this <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i20.gif"/></inline-formula>(ℓ). If the element ℓ appears in both <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i13.gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i19.gif"/></inline-formula> let its disparity be the minimum of 1 - <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i20.gif"/></inline-formula>(ℓ) in either tree. Thus this measure will be symmetric and sensitive to disagreement between the hierarchical clustering given by each tree.</p>
      </sec>
    </sec>
    <sec>
      <title>Software Implementation</title>
      <p>The R/Bioconductor port consists of two functions, <italic>bhc </italic>and <italic>WriteOutClusterLabels</italic>. The <italic>bhc </italic>function calls efficient C++ routines for the special case of the BHC algorithm as described in this paper. The algorithm has a computational complexity of order <italic>N</italic><sup>2 </sup>for <italic>N </italic>data points, and runs in about 8 minutes on a Macbook Pro 2 GHz laptop for a data-set of size 880 and dimensionality 31 (i.e. the NASC data set used in this paper). The reverse clustering (i.e. size 31 with dimensionality 880) runs in approximately a minute. For runtimes for data sets of various sizes [see Additional file <xref ref-type="supplementary-material" rid="S2">2</xref>].</p>
      <p>The <italic>WriteOutClusterLabels </italic>function outputs the resulting cluster labels to an ASCII file. Because the <italic>bhc </italic>function outputs its results in a standard R <italic>dendrogram </italic>object, a graphical representation of the output can be obtained by calling the standard R <italic>plot </italic>function. A 2D heat-map visualization of the clustering can be generated using the standard R function <italic>heatmap</italic>.</p>
      <p>In our model the hyperparameters are the concentration parameter, <italic>α</italic>, which controls the distribution of the prior weight assigned to each cluster in the DPM, and is directly related to the expected number of clusters, and the hyperparameters, <italic>β</italic>, of the probabilistic model defining each component of the mixture. The concentration parameter, <italic>α</italic>, was fixed to a small, positive value (0.001). The hyperparameters for the individual mixture component (Dirichlet) priors <italic>β </italic>are scaled by a single additional hyperparameter, giving the data model greater flexibility. This additional hyperparameter was determined by optimising the overall model Evidence (marginal likelihood), using a combination of golden section search and successive parabolic interpolation (as implemented in the R function <italic>optimize</italic>). The unscaled <italic>β </italic>hyperparameters were set by using the whole data-set as a measure of the relative proportions of each discrete value for each gene.</p>
    </sec>
    <sec>
      <title>Application to Microarray Data</title>
      <p>We illustrate our methods with application to a published data set of GeneChip expression profiles of <italic>A. thaliana </italic>subjected to a variety of biotic and abiotic stresses, derived from the AtGenExpress consortium (NASC), identical to that used by Torres-Zabala et al. [<xref ref-type="bibr" rid="B26">26</xref>]. The expression profiles were selected, normalized and interpreted by the GC content-adjusted robust multi-array algorithm (GCRMA) [<xref ref-type="bibr" rid="B27">27</xref>] exactly as in the original manuscript. Continuous transcript levels were discretised into three levels (unchanged, under- or over-expressed) by dividing the levels at fixed quantiles for each given gene. This makes our analyses more robust to any experimental systematics, as well as simplifying the algorithm by using multinomial distributions and their conjugate Dirichlet priors. By discretizing mRNA levels we model the important qualitative changes in mRNA levels without making strong unjustifiable assumptions (e.g. Gaussianity) about the form of the noise in microarray experiments. We note that such an approach has also been used by other workers in the field [<xref ref-type="bibr" rid="B28">28</xref>]. In order to identify the optimal discretization thresholds we utilized the following procedure. The discretization threshold is parameterised via the quantiles, <italic>x</italic>, of the data for a given gene, such that the data counts are distributed in the proportions <italic>x </italic>: (1 - 2<italic>x</italic>): <italic>x</italic>. We can then optimise <italic>x </italic>jointly over all the genes by running the BHC algorithm for different <italic>x </italic>values (and hence discretisations) and using the lower bound on the overall model Evidence, modified to account for the above parameterisation by dividing the Evidence by the relevant bin width for each data point. Evidence values and the optimal value for the hyperparameter mentioned in the previous section are shown [see Additional files <xref ref-type="supplementary-material" rid="S3">3</xref> and <xref ref-type="supplementary-material" rid="S4">4</xref>]. These results indicate that the optimal quantitles for the discretization of this data set are 20/60/20 and 25/50/25 for the experiment and gene clustering, respectively.</p>
    </sec>
  </sec>
  <sec>
    <title>Results</title>
    <p>Clustering of the Arabidopsis genes and experimental conditions was carried out using our BHC algorithm and a biologically plausible clustering pattern was observed (Figure <xref ref-type="fig" rid="F1">1</xref>). This was compared to the conventional agglomerative hierarchical clustering of the same data carried out by de Torres-Zabala et al. [<xref ref-type="bibr" rid="B26">26</xref>], using an uncentred correlation coefficient as a distance metric and complete linkage. We observed that the essential features of the hierarchical clustering of experimental conditions were reproduced, but with more specific clusters as evidenced by the DendrogramPurity measure of 0.968 (BHC) versus 0.473 (agglomerative hierarchical clustering). LeafHarmony measures for the BHC clustering [see Additional file <xref ref-type="supplementary-material" rid="S5">5</xref>] show that most leaves have a value of 1.0, indicating the consistency of the clusters produced. In particular, we observed specific clusters for drought, osmotic stress and salt. In the case of pathogen infection (DC3000) and the phytohormone abscisic acid (ABA) treatment, we find that each group of experiments forms a well-defined cluster. We note that in the clustering of de Torres-Zabala et al. [<xref ref-type="bibr" rid="B26">26</xref>] only two of the ABA experiments (30 min and 1 h) cluster at the lowest level, and splitting the dendrogram at this level places the ABA 3 h experiment in a separate cluster with salt and osmotic stress experiments. The clustering produced by BHC thus seems more intuitive, with the ABA 3 h experiment appearing unconnected in the dendrogram. An advantage of the BHC method over conventional hierarchical clustering is that Bayesian hypothesis testing is used to decide which clusters to merge.</p>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>Clustering of 880 genes and 31 conditions of A. thaliana</bold>. Clustering of 880 genes and 31 conditions of <italic>A. thaliana</italic>, subjected to a variety of biotic and abiotic stresses (as used by [<xref ref-type="bibr" rid="B26">26</xref>]). Shown are transcript profile clustering (left), condition clustering (above and below) and the corresponding 2D heat map, aligned with the 1D dendrograms. Red dashed lines are merges our algorithm prefers not to make. The numbers on the branches are the log odds for merging (<inline-formula><inline-graphic xlink:href="1471-2105-10-242-i21.gif"/></inline-formula>).</p>
      </caption>
      <graphic xlink:href="1471-2105-10-242-1"/>
    </fig>
    <p>The overall dendrogram structures, are, however, demonstrably different, as evidenced by the comparatively low values of LeafDisparity [see Additional file <xref ref-type="supplementary-material" rid="S6">6</xref>] and the adjusted Rand indices of 0.299 for the gene clusters and 0.325 for the experiment clusters.</p>
    <p>For the genes, we find that BHC produces a clustering of finer granularity; for instance, genes highlighted in clusters I-IV in de Torres-Zabala et al. [<xref ref-type="bibr" rid="B26">26</xref>] are split between a number of smaller clusters (see Additional files <xref ref-type="supplementary-material" rid="S7">7</xref> and <xref ref-type="supplementary-material" rid="S8">8</xref>). Most of the genes in clusters I and II are divided between our clusters 5 and 7. Cluster 5 contains 22 out of the 28 genes in cluster II, including six PP2Cs, NCED3 and three NAC domain transcription factors, all of which are known to be regulated by ABA. Genes in cluster III are all in BHC cluster 16, which is enriched with Gene Ontology annotations indicating chloroplast function (see below). To further validate the quality of the clusters produced by BHC we have analyzed the statistically significantly over-represented GO annotations related to a given cluster of genes. The probability that this over-representation is not found by chance can be calculated by the use of a hypergeometric test, implemented in the R/Bioconductor package <italic>GOstats </italic>[<xref ref-type="bibr" rid="B29">29</xref>]. Because of the effects of multiple testing, a subsequent correction of the <italic>p</italic>-values is necessary. We apply a Bonferroni correction, which gives a conservative (and easily calculated) correction for multiple testing. We extract the lowest levels of the ontology graphs using the <italic>GOstats </italic>command 'sigCategories'. In the supplementary material we show the lowest level GO annotations for the BHC clusters which are significant at a Bonferroni-corrected <italic>p</italic>-value of 0.05. We compared the enriched GO annotations for the BHC clusters to those from the agglomerative hierarchical clustering of Torres-Zabala et al. (see Additional files <xref ref-type="supplementary-material" rid="S9">9</xref> and <xref ref-type="supplementary-material" rid="S10">10</xref>). To quantify this comparison, we calculated the Biological Homogeneity Index (BHI) of Datta and Datta [<xref ref-type="bibr" rid="B30">30</xref>] as implemented in the clValid package of Brock et al. [<xref ref-type="bibr" rid="B21">21</xref>]. This index provides a measure the 'biological meaning' of clusters based on the homogeneity of functional classes represented by the GO annotations. Taking the number of clusters to be 29, as found by BHC, we calculate a BHI of 0.179 (BHC) versus 0.161 (agglomerative hierarchical clustering), indicating more biologically homogeneous clusters in the former case.</p>
    <p>As mentioned above, we observe some overlap between significant GO annotations for two of these clusters (II with BHC cluster 5; III with BHC cluster 16). However, many biologically significant terms are enriched only in the BHC clusters (for example camalexin biosynthesis in BHC cluster 29), indicating that the BHC clusters represent a more refined view of the data, which enables processes important in defence to be identified. This can be illustrated by examining the GO groupings of the BHC clusters that are intuitively meaningful in the context of plant-microbe interactions.</p>
    <p>For example, cluster 16 comprises a major cluster of genes associated with chloroplast function and chlorophyll biosynthesis. Chloroplasts are emerging as a key target of bacterial effector function [<xref ref-type="bibr" rid="B31">31</xref>].</p>
    <p>Interestingly, cluster 10 is strongly biased towards genes involved in ion homeostasis, and changes in ion fluxes represent the earliest physiological changes associated with plant defences. Rapid ion changes are often associated with changes in phosphorylation status of transporters, and cluster 5 is over-represented by cellular components associated with phosphorylation. Reconfiguration of secondary metabolism is central to the ability to modify plant defences. Notably, clusters 29 and 6 elegantly capture pathway components of indolic and jasmonic acid metabolism. Within this context, cluster 19 is worthy of further investigation. Members of cluster 19 directly impact upon the secondary metabolism defined in clusters 29 and 6 above. Thus the BHC approach may have revealed a set of co-regulated genes whose biological activity is responsible for activating the biosynthetic networks highlighted in clusters 29 and 6.</p>
    <p>Experiments to address this hypothesis are currently underway.</p>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>We have presented an R/Bioconductor port of a fast novel algorithm for Bayesian agglomerative hierarchical clustering and have demonstrated its use in clustering gene expression microarray data. Biologically plausible results are presented from a well studied data set: expression profiles of <italic>A. thaliana </italic>subjected to a variety of biotic and abiotic stresses. The BHC approach has identified a new avenue of research not revealed by the previous clustering analyses of this data. The use of a probabilistic approach to model uncertainty in the data, and Bayesian model selection to decide at each step which clusters to merge, avoids several limitations of traditional clustering methods, such as how many clusters there should be and how to choose a principled distance metric. Extensions of the algorithm described here are straightforward for other distributions in the exponential family, such as Gaussians [<xref ref-type="bibr" rid="B19">19</xref>], which may be useful when such distributions are well justified for the data in question.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>Available under the Gnu GPL from <ext-link ext-link-type="uri" xlink:href="http://wsbc.warwick.ac.uk/www/software/index.html"/> and through the Bioconductor website. Online supplementary data is available at the journal's web site.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>RS and YX wrote the code. RS carried out the computational analyses. KH and ZG developed the algorithm. WMT and MG provided the Arabidopsis data. KD, MG, ZG and DLW wrote the paper. ZG and DLW directed the research. All authors read and approved the final version of the manuscript.</p>
  </sec>
  <sec>
    <title>Appendix</title>
    <p>   <bold>input: </bold>data <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i1.gif"/></inline-formula> = {<bold>x</bold><sup>(1) </sup>... <bold>x</bold><sup>(<italic>n</italic>)</sup>}, model <italic>p</italic>(<bold>x</bold>|θ), prior <italic>p</italic>(<italic>θ</italic>|<italic>β</italic>)</p>
    <p>   <bold>initialize: </bold>number of clusters <italic>c </italic>= <italic>n</italic>, and <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i3.gif"/></inline-formula> = {<bold>x</bold><sup>(<italic>i</italic>)</sup>} for <italic>i </italic>= 1 ...<italic>n</italic></p>
    <p>   <bold>while </bold><italic>c </italic>&gt; 1 <bold>do</bold></p>
    <p>      Find the pair <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i3.gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i22.gif"/></inline-formula> with the highest probability of the merged hypothesis:</p>
    <p>
      <disp-formula>
        <graphic xlink:href="1471-2105-10-242-i23.gif"/>
      </disp-formula>
    </p>
    <p>      Merge <inline-formula><inline-graphic xlink:href="1471-2105-10-242-i24.gif"/></inline-formula>, <italic>T</italic><sub><italic>k </italic></sub>← (<italic>T</italic><sub><italic>i</italic></sub>, <italic>T</italic><sub><italic>j</italic></sub>)</p>
    <p>      Delete <italic>D</italic><sub><italic>i </italic></sub>and <italic>D</italic><sub><italic>j</italic></sub>, <italic>c </italic>← <italic>c </italic>- 1</p>
    <p>   <bold>end while</bold></p>
    <p>   <bold>output: </bold>Bayesian mixture model where each tree node is a mixture component</p>
    <p>The tree can be cut at points where <italic>r</italic><sub><italic>k </italic></sub>&lt; 0.5</p>
    <p>Algorithm 1: Bayesian Hierarchical Clustering Algorithm</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Figure 2</bold>. Gene clustering dendrogram of a subset of the Ideker et al. data, showing leaf harmony values</p>
      </caption>
      <media xlink:href="1471-2105-10-242-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>Table 1 – Speed-trial of the BHC algorithm</bold>. Trials were based on the NASC data (880 genes, 31 features), clustering over genes. In each case, the data were duplicated or a subset of genes taken as appropriate to get the required number genes and features. All trials were run on a single 2 GHz CPU core on a Macbook Pro laptop.</p>
      </caption>
      <media xlink:href="1471-2105-10-242-S2.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p><bold>Table 2</bold>. Data discretisation for NASC experiment clustering</p>
      </caption>
      <media xlink:href="1471-2105-10-242-S3.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S4">
      <caption>
        <title>Additional file 4</title>
        <p><bold>Table 3</bold>. Data discretisation for NASC gene clustering</p>
      </caption>
      <media xlink:href="1471-2105-10-242-S4.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S5">
      <caption>
        <title>Additional file 5</title>
        <p><bold>Figure 3</bold>. Condition clustering dendrogram for the NASC data.</p>
      </caption>
      <media xlink:href="1471-2105-10-242-S5.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S6">
      <caption>
        <title>Additional file 6</title>
        <p><bold>LeafDisparity values for the NASC experiments</bold>. The BHC clustering dendrogram is compared to a standard hierarchical method using uncentred correlation coefficients and complete linnkage.</p>
      </caption>
      <media xlink:href="1471-2105-10-242-S6.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S7">
      <caption>
        <title>Additional file 7</title>
        <p><bold>Figure 4</bold>. Gene clustering dendrogram for the NASC data.</p>
      </caption>
      <media xlink:href="1471-2105-10-242-S7.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S8">
      <caption>
        <title>Additional file 8</title>
        <p><bold>BHC cluster membership</bold>. BHC cluster membership</p>
      </caption>
      <media xlink:href="1471-2105-10-242-S8.zip" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S9">
      <caption>
        <title>Additional file 9</title>
        <p><bold>GO annotations for BHC clusters</bold>. Statistically significantly over-represented GO annotations for BHC clusters (Bonferroni-corrected <italic>p</italic>-value &lt; 0.05)</p>
      </caption>
      <media xlink:href="1471-2105-10-242-S9.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S10">
      <caption>
        <title>Additional file 10</title>
        <p><bold>GO annotations for agglomerative hierarchical clustering</bold>. Statistically significantly over-represented GO annotations for clusters manually identified from agglomerative hierarchical clustering (Bonferroni-corrected <italic>p</italic>-value &lt; 0.05)</p>
      </caption>
      <media xlink:href="1471-2105-10-242-S10.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>This work is supported by the Engineering and Physical Sciences Research Council (EP/F027400/1, Life Sciences Interface), the Biotechnology and Biological Sciences Research Council (BB/F005806/1) and an EU Marie-Curie IRG Fellowship (46444).</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eisen</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Spellman</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Cluster Analysis and Display of Genome-wide Expression</article-title>
        <source>PNAS</source>
        <year>1998</year>
        <volume>95</volume>
        <fpage>14863</fpage>
        <lpage>14868</lpage>
        <pub-id pub-id-type="pmid">9843981</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.95.25.14863</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alon</surname>
            <given-names>U</given-names>
          </name>
          <name>
            <surname>Barkai</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Notterman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Ybarra</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mack</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Broad Patterns of Gene Expression Revealed by Clustering Analysis of Tumor and Normal Colon Tissues Probed by Oligonucleotide Arrays</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>1999</year>
        <volume>96</volume>
        <fpage>6745</fpage>
        <lpage>6750</lpage>
        <pub-id pub-id-type="pmid">10359783</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.96.12.6745</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McLachlan</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Bean</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Peel</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>A mixture model-based approach to the clustering of microarray expression data</article-title>
        <source>Bioinformatics</source>
        <year>2002</year>
        <volume>18</volume>
        <fpage>413</fpage>
        <lpage>422</lpage>
        <pub-id pub-id-type="pmid">11934740</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/18.3.413</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kerr</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Churchill</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Bootstrapping cluster analysis: assessing the reliability of conclusions from microarray experiments</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <year>2001</year>
        <volume>98</volume>
        <fpage>8961</fpage>
        <pub-id pub-id-type="doi">10.1073/pnas.161273698</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Assessing reliability of gene clusters from gene expression data</article-title>
        <source>Funct Integr Genomics</source>
        <year>2000</year>
        <volume>1</volume>
        <fpage>156</fpage>
        <lpage>173</lpage>
        <pub-id pub-id-type="pmid">11793234</pub-id>
        <pub-id pub-id-type="doi">10.1007/s101420000019</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hughes</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Marton</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Jones</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Roberts</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stoughton</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Armour</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bennett</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Coffey</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Kidd</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Slade</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lum</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stepaniants</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Shoemaker</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gachotte</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Chakraburtty</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bard</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Friend</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Functional Discovery via a Compendium of Expression Profiles</article-title>
        <source>Cell</source>
        <year>2000</year>
        <volume>102</volume>
        <fpage>109</fpage>
        <lpage>126</lpage>
        <pub-id pub-id-type="pmid">10929718</pub-id>
        <pub-id pub-id-type="doi">10.1016/S0092-8674(00)00015-5</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levenstien</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Ott</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Statistical significance for hierarchical clustering in genetic association and microarray expression studies</article-title>
        <source>BMC bioinformatics</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>62</fpage>
        <pub-id pub-id-type="pmid">14667254</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-4-62</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Hartigan</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>Clustering Algorithms</source>
        <year>1975</year>
        <publisher-name>New York: Wiley</publisher-name>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yeung</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Haynor</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ruzzo</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Validating clustering for gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2001</year>
        <volume>17</volume>
        <fpage>309</fpage>
        <lpage>318</lpage>
        <pub-id pub-id-type="pmid">11301299</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/17.4.309</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Mackay</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <source>Information Theory, Inference and Learning Algorithms</source>
        <year>2003</year>
        <publisher-name>Cambridge: Cambridge University Press</publisher-name>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bauwens</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Rombouts</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Bayesian clustering of many GARCH models</article-title>
        <source>Econometric Reviews</source>
        <year>2007</year>
        <volume>26</volume>
        <fpage>365</fpage>
        <lpage>386</lpage>
        <pub-id pub-id-type="doi">10.1080/07474930701220576</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frühwirth-Schnatter</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kaufmann</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Model-based clustering of multiple time series</article-title>
        <source>Journal of Business and Economic Statistics</source>
        <year>2008</year>
        <volume>26</volume>
        <fpage>78</fpage>
        <lpage>89</lpage>
        <pub-id pub-id-type="doi">10.1198/073500107000000106</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jackson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Davy</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Doucet</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Fitzgerald</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Bayesian Unsupervised Signal Classification by Dirichlet Process Mixtures of Gaussian Processes</article-title>
        <source>IEEE International Conference on Acoustics, Speech and Signal Processing, 2007 ICASSP 2007</source>
        <year>2007</year>
        <volume>3</volume>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beaumont</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rannala</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>The Bayesian revolution in genetics</article-title>
        <source>Nat Rev Genet</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>251</fpage>
        <lpage>261</lpage>
        <pub-id pub-id-type="pmid">15131649</pub-id>
        <pub-id pub-id-type="doi">10.1038/nrg1318</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Neal</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Bernardo J, Bayarri M, Berger J, Dawid A, Heckerman D, Smith A, West M</surname>
          </name>
        </person-group>
        <article-title>Density Modeling and Clustering Using Dirichlet Diffusion Trees</article-title>
        <source>Bayesian Statistics</source>
        <year>2003</year>
        <volume>7</volume>
        <fpage>619</fpage>
        <lpage>629</lpage>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heard</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Hand</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Dimopoulos</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Bayesian coclustering of Anopheles gene expression time series: Study of immune defense response to multiple experimental challenges</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>16939</fpage>
        <lpage>16944</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.0408393102</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Heard</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>A Quantitative Study of Gene Regulation Involved in the Immune Response of Anopheline Mosquitoes: An Application of Bayesian Hierarchical Clustering of Curves</article-title>
        <source>JOURNAL-AMERICAN STATISTICAL ASSOCIATION</source>
        <year>2006</year>
        <volume>101</volume>
        <fpage>18</fpage>
        <pub-id pub-id-type="doi">10.1198/016214505000000187</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Rasmussen</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>de la Cruz</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Ghahramani</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wild</surname>
            <given-names>DL</given-names>
          </name>
        </person-group>
        <article-title>Modeling and Visualizing Uncertainty in Gene Expression Clusters using Dirichlet Process Mixtures</article-title>
        <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics</source>
        <year>2007</year>
        <ext-link ext-link-type="uri" xlink:href="http://doi.ieeecomputersociety.org/10.1109/TCBB.2007.70269"/>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Heller</surname>
            <given-names>KA</given-names>
          </name>
          <name>
            <surname>Ghahramani</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>Bayesian Hierarchical Clustering</article-title>
        <source>Twenty-second International Conference on Machine Learning (ICML-2005)</source>
        <year>2005</year>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Rasmussen</surname>
            <given-names>CE</given-names>
          </name>
        </person-group>
        <person-group person-group-type="editor">
          <name>
            <surname>Solla SA, Leen TK, Muller KR</surname>
          </name>
        </person-group>
        <article-title>The Infinite Gaussian Mixture Model</article-title>
        <source>Advances in Neural Information Processing Systems 12</source>
        <year>2000</year>
        <publisher-name>MIT Press; Cambridge, Massachusetts</publisher-name>
        <fpage>554</fpage>
        <lpage>560</lpage>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Brock</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Pihur</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Datta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Datta</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>clValid, an R package for cluster validation</article-title>
        <source>Journal of Statistical Software</source>
        <year>2008</year>
        <volume>25</volume>
        <fpage>1</fpage>
        <lpage>22</lpage>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rand</surname>
            <given-names>W</given-names>
          </name>
        </person-group>
        <article-title>Objective criteria for the evaluation of clustering methods</article-title>
        <source>Journal of the American Statistical association</source>
        <year>1971</year>
        <fpage>846</fpage>
        <lpage>850</lpage>
        <pub-id pub-id-type="doi">10.2307/2284239</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yeung</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Medvedovic</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bumgarner</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Clustering gene-expression data with repeated measurements</article-title>
        <source>Genome Biol</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>R34</fpage>
        <pub-id pub-id-type="pmid">12734014</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2003-4-5-r34</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ideker</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Thorsson</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Ranish</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Christmas</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Buhler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Eng</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bumgarner</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Goodlett</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Aebersold</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Hood</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Integrated genomic and proteomic analyses of a systematically perturbed metabolic network</article-title>
        <source>Science</source>
        <year>2001</year>
        <volume>292</volume>
        <fpage>929</fpage>
        <lpage>934</lpage>
        <pub-id pub-id-type="pmid">11340206</pub-id>
        <pub-id pub-id-type="doi">10.1126/science.292.5518.929</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Salmi</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hung</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Loraine</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Roux</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Genome-scale cluster analysis of replicated microarrays using shrinkage correlation coefficient</article-title>
        <source>BMC bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>288</fpage>
        <pub-id pub-id-type="pmid">18564431</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-288</pub-id>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>de Torres-Zabala</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Truman</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Bennett</surname>
            <given-names>MH</given-names>
          </name>
          <name>
            <surname>Lafforgue</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Mansfield</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Egea</surname>
            <given-names>PR</given-names>
          </name>
          <name>
            <surname>Böge</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Grant</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title><italic>Pseudomonas syringae </italic>pv. <italic>tomato </italic>hijacks the <italic>Arabidopsis </italic>abscisic acid signalling pathway to cause disease</article-title>
        <source>EMBO Journal</source>
        <year>2007</year>
        <volume>26</volume>
        <fpage>1434</fpage>
        <lpage>1443</lpage>
        <pub-id pub-id-type="pmid">17304219</pub-id>
        <pub-id pub-id-type="doi">10.1038/sj.emboj.7601575</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Irizarry</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Martinez-Murillo</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Spencer</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>A model-based background adjustment for oligonucleotide expression arrays</article-title>
        <source>Journal of the American Statistical Association</source>
        <year>2004</year>
        <volume>99</volume>
        <fpage>909</fpage>
        <lpage>917</lpage>
        <pub-id pub-id-type="doi">10.1198/016214504000000683</pub-id>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerber</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Dowell</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Jaakkola</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Gifford</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Sidow</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Automated discovery of functional generality of human gene expression programs</article-title>
        <source>PLoS Comput Biol</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>e148</fpage>
        <pub-id pub-id-type="pmid">17696603</pub-id>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.0030148</pub-id>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Falcon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Using GOstats to test gene lists for GO term association</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>257</fpage>
        <pub-id pub-id-type="pmid">17098774</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl567</pub-id>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Datta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Datta</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Methods for evaluating clustering algorithms for gene expression data using a reference set of functional classes</article-title>
        <source>BMC bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>397</fpage>
        <pub-id pub-id-type="pmid">16945146</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-7-397</pub-id>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jelenska</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yao</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Vinatzer</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Brodsky</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Greenberg</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>AJ domain virulence effector of Pseudomonas syringae remodels host chloroplasts and suppresses defenses</article-title>
        <source>Current Biology</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>499</fpage>
        <lpage>508</lpage>
        <pub-id pub-id-type="pmid">17350264</pub-id>
        <pub-id pub-id-type="doi">10.1016/j.cub.2007.02.028</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
