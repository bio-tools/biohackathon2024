<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Med Inform Decis Mak</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Med Inform Decis Mak</journal-id>
    <journal-title-group>
      <journal-title>BMC Medical Informatics and Decision Making</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1472-6947</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8461864</article-id>
    <article-id pub-id-type="publisher-id">1617</article-id>
    <article-id pub-id-type="doi">10.1186/s12911-021-01617-4</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Clinical connectivity map for drug repurposing: using laboratory results to bridge drugs and diseases</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Wen</surname>
          <given-names>Qianlong</given-names>
        </name>
        <address>
          <email>qianlongwen0118@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" equal-contrib="yes">
        <name>
          <surname>Liu</surname>
          <given-names>Ruoqi</given-names>
        </name>
        <address>
          <email>liu.7324@osu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4601-0779</contrib-id>
        <name>
          <surname>Zhang</surname>
          <given-names>Ping</given-names>
        </name>
        <address>
          <email>mail.pingzhang@gmail.com</email>
        </address>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Department of Electrical and Computer Engineering, </institution><institution>The Ohio State University, </institution></institution-wrap>2015 Neil Ave, Columbus, Ohio 43210 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Department of Computer Science and Engineering, </institution><institution>The Ohio State University, </institution></institution-wrap>2015 Neil Ave, Columbus, Ohio 43210 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.261331.4</institution-id><institution-id institution-id-type="ISNI">0000 0001 2285 7943</institution-id><institution>Department of Biomedical Informatics, </institution><institution>The Ohio State University, </institution></institution-wrap>1800 Cannon Drive, Columbus, Ohio 43210 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>24</day>
      <month>9</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>21</volume>
    <issue>Suppl 8</issue>
    <issue-sponsor>Publication of this supplement has not been supported by sponsorship. Information about the source of funding for publication charges can be found in the individual articles. The articles have undergone the journal's standard peer review process for supplements. Supplement Editors were not involved in the peer review of any article that they co-authored. The Supplement Editors declare that they have no other competing interests.</issue-sponsor>
    <elocation-id>263</elocation-id>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>8</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Drug repurposing, the process of identifying additional therapeutic uses for existing drugs, has attracted increasing attention from both the pharmaceutical industry and the research community. Many existing computational drug repurposing methods rely on preclinical data (e.g., chemical structures, drug targets), resulting in translational problems for clinical trials.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">In this study, we propose a novel framework based on clinical connectivity mapping for drug repurposing to analyze therapeutic effects of drugs on diseases. We firstly establish clinical drug effect vectors (i.e., drug-laboratory results associations) by applying a continuous self-controlled case series model on a longitudinal electronic health record data, then establish clinical disease sign vectors (i.e., disease-laboratory results associations) by applying a Wilcoxon rank sum test on a large-scale national survey data. Eventually, a repurposing possibility score for each drug-disease pair is computed by applying a dot product-based scoring function on clinical disease sign vectors and clinical drug effect vectors. During the experiment, we comprehensively evaluate 392 drugs for 6 important chronic diseases (include asthma, coronary heart disease, congestive heart failure, heart attack, type 2 diabetes, and stroke). The experiment results not only reflect known associations between diseases and drugs, but also include some hidden drug-disease associations. The code for this paper is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/HoytWen/CCMDR">https://github.com/HoytWen/CCMDR</ext-link></p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">The proposed clinical connectivity map framework uses laboratory results found from electronic clinical information to bridge drugs and diseases, which make their relations explainable and has better translational power than existing computational methods. Experimental results demonstrate the effectiveness of our proposed framework, further case analysis also proves our method can be used to repurposing existing drugs opportunities.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Drug repurposing</kwd>
      <kwd>Connectivity map</kwd>
      <kwd>Electronic health record</kwd>
      <kwd>National Health and Nutrition Examination Survey</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000009</institution-id>
            <institution>Foundation for the National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>CTSA Grant UL1TR002733</award-id>
        <principal-award-recipient>
          <name>
            <surname>Zhang</surname>
            <given-names>Ping</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <conference xlink:href="https://icibm2020.iaibm.org/index.htm">
      <conf-name>The International Conference on Intelligent Biology and Medicine (ICIBM) 2020</conf-name>
      <conf-acronym>ICIBM 2020</conf-acronym>
      <conf-loc>Virtual</conf-loc>
      <conf-date>9-10 August 2020</conf-date>
    </conference>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par11">Traditional <italic>de novo</italic> drug discovery is a long and complicated process [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>], which usually takes more than 15 years [<xref ref-type="bibr" rid="CR3">3</xref>], and costs 800 million to 1 billion US dollars [<xref ref-type="bibr" rid="CR4">4</xref>] to develop a new drug. Drug repurposing, investigation of potential additional uses for existing drugs, is becoming an appealing research field given its potential in lowering overall costs and shortening drug development timelines [<xref ref-type="bibr" rid="CR5">5</xref>].</p>
    <p id="Par12">There has been a surge of computational methods proposed for drug repurposing in recent years, which can be roughly classified into two categories based on different data sources: preclinical data-based and clinical data-based. Preclinical data-based methods often build machine learning models based on preclinical data, such as drug chemical structure, protein targets and gene expression information, to identify potential drug-disease associations. For example, Keiser et al. [<xref ref-type="bibr" rid="CR6">6</xref>] use drug structural similarity as the measurements to find the drugs with similar effects. Lamb et al. [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>] raise the connectivity map (CMap) approach for drug repurposing by using gene expression data, which is based on molecular activity. Luo et al. [<xref ref-type="bibr" rid="CR9">9</xref>] develop a server named DPDR-CPI which predicts the new indications of existing drugs by analyzing the chemical-protein interactome (CPI) profile. Some researchers also tried to construct computational frameworks that integrated several kinds of data sources and even disease similarity measurement profiles to make better predictions. PreDR model proposed by Wang et al. [<xref ref-type="bibr" rid="CR10">10</xref>] integrated drug structure, drug target, side-effects and disease phenotype data to find the novel drug indications. Zhang et al. The similarity constrained matrix factorization method raised by [<xref ref-type="bibr" rid="CR11">11</xref>] take known drug-disease associations, drug features and disease semantic information as input to predict drug-disease association. However, all of these methods rely heavily on preclinical information to make predictions. This will cause a large translation gap when we apply the drugs on humans. It is estimated that of all compounds effective in cell assays, only 30% of them could work in animals and only 5% of them could work in humans [<xref ref-type="bibr" rid="CR12">12</xref>].</p>
    <p id="Par13">Compared with preclinical data, clinical data provide more applicable and reliable data sources for drug repurposing as clinical information (e.g., laboratory test results) because it records direct read-outs drug effects on patients, so there is no need to consider about the translational problems. Many computational frameworks based on clinical information has been raised due to the large amount of available electronica clinical data.</p>
    <p id="Par14">Jung et al. [<xref ref-type="bibr" rid="CR13">13</xref>] find the connection between drugs and diseases in clinical diagnose notes by literature mining, but it does not include any other structured data, like laboratory test results. Jang et al. [<xref ref-type="bibr" rid="CR14">14</xref>] propose a framework that use laboratory test results to reflect the influence of drugs and diseases on human physiological activities, and the method they use to establish drug effects is counting co-occurrence between drug and laboratory tests. However, it is not efficient enough to dig the hidden relation between drugs and laboratory tests, especially when we have a large dataset and include many laboratory and existing drugs in our experiment. Kuang et al. [<xref ref-type="bibr" rid="CR15">15</xref>] and Ghalwash et al. [<xref ref-type="bibr" rid="CR16">16</xref>] raised more advanced methods to compute the influence of drugs on laboratory tests, however, they reflect the effect of drugs on single laboratory (e.g., blood sugar level), which it is not enough to represent the state of the complex human system. It would be more efficient and accurate if we build an electronic clinical information-based drug repurposing framework and implement it by more efficient statistical analysis methods designed for large datasets. During this process, we will include as many laboratory tests as we can in our experiment to completely represent the state of human biological system. The idea of CMap raised by Lamb et al. [<xref ref-type="bibr" rid="CR7">7</xref>, <xref ref-type="bibr" rid="CR8">8</xref>] which uses gene expression values to bridge drugs and diseases, directly inspires us to formulate and leverage all the laboratory tests involved in our experiment to build associations between drugs and diseases from clinical perspective.</p>
    <p id="Par15">In this paper, we propose a clinical connectivity map framework for drug repurposing (CCMDR) by leveraging laboratory tests to analyze the influence of drugs and diseases on the human biological system. The overall framework is illustrated in Fig. <xref rid="Fig1" ref-type="fig">1</xref>. Experimental results show that our method can not only retrieve the known drug-disease associations in high accuracy but also can find potential indications, which can be verified from medical literature. Moreover, the associations between the predicted drug-disease can be clearly and vividly represented via the corresponding complementarity between laboratory tests of drug effect vectors and disease sign vectors, which make our results more explainable. Thus, the evaluation performance and explainability show the potential that our method could be used in future drug repurposing tasks.<fig id="Fig1"><label>Fig. 1</label><caption><p>This figure presents the pipeline of our framework. The framework contains three main components: (1) establishing clinical drug effect vectors by applying a continuous self-controlled case series model on a longitudinal electronic health record data (EHR), (2) establishing clinical disease sign vectors by applying a Wilcoxon rank sum test on a large-scale national survey data (NHANES), (3) computing repurposing possibility score for each drug-disease pair by applying a dot product-based scoring function on clinical disease sign vectors and clinical drug effect vectors. We do a terminology mapping before we establish the clinical drug effect vectors and clinical disease sign vectors to make sure each clinical vector includes the same laboratory tests. There are three kinds of relation types in the clinical vectors (“Up”, “Down”, “No”), which represent increasing, decreasing and not significantly changing laboratory tests level, respectively</p></caption><graphic xlink:href="12911_2021_1617_Fig1_HTML" id="MO1"/></fig></p>
    <p id="Par16">In brief, the contribution of the paper can be summarized as below:<list list-type="bullet"><list-item><p id="Par17">We propose a clinical connectivity mapping framework for drug repurposing. The new framework solely based on the clinical patient data, thus with less translational problems.</p></list-item><list-item><p id="Par18">We evaluate our framework for 392 drugs on 6 important chronic diseases (include asthma, coronary heart disease, congestive heart failure, heart attack, type 2 diabetes, and stroke). Experimental results show that our method achieves high accuracy in retrieving the known indications of drugs.</p></list-item><list-item><p id="Par19">We study the predicted drug repurposing candidates via the corresponding complementarity between laboratory tests of drug effect vectors and disease sign vectors. Case studies with literature support show the potential of our method to discover previously unknown indications of existing drugs.</p></list-item></list></p>
  </sec>
  <sec id="Sec2">
    <title>Methods</title>
    <sec id="Sec3">
      <title>Dataset and data preprocess</title>
      <p id="Par20">We use the questionnaire and laboratory results from the National Health and Nutrition Examination Survey (NHANES) [<xref ref-type="bibr" rid="CR17">17</xref>] to establish the clinical disease sign vectors. According to the questionnaire survey (e.g., “Has been diagnosed with type 2 diabetes?”), individual samples are divided into disease group (who answered “yes”) and healthy group (who answered “no”). Next, we perform the statistical analysis to identify those disease-related clinical variables from collected laboratory results in NHANES data. We extract 87,464 individual samples, 986 numerical clinical variables and more than 30 disease conditions from NHANES data range from 1999 to 2016. Here, we only consider the disease conditions with more than 1000 individual samples, which results in 6 unique diseases (i.e., asthma, coronary heart disease, congestive heart failure, heart attack, type 2 diabetes and stroke).</p>
      <p id="Par21">We use the prescription and laboratory result histories of patients in a proprietary deidentified Electronic Health Record (EHR) to establish the clinical drug effect vectors. We transform the prescription records of patients into matrixes based on medication use situations. To study the associations between prescribed drugs and laboratory results, we apply a continuous self-controlled case series model [<xref ref-type="bibr" rid="CR15">15</xref>] to analyze the effects of a drug on the laboratory results. We only consider patients with complete records (i.e., having both prescription and its corresponding laboratory results), which results in 91,934 patients, 1344 kinds of treatments and 65 kinds of laboratory results. After excluding those prescriptions with less than 1000 patients, we obtain 392 unique prescribed drugs.</p>
      <p id="Par22">We bridge the drug and disease using the laboratory results obtained from each side. Since the laboratory results are from different data resources (i.e., national survey data and electronic health records), we need to standardize those laboratory results for further analysis. The laboratory results that appear in both datasets are included and mapped to a standard list with consistent names. Also, the non-numerical laboratory results are excluded. Finally, we obtain 35 laboratory results considered as clinical variables. The full list of the 35 clinical variables can be found in Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Table S1. Our inference of a drug-disease pair is based on the complementary and adverse effects that each drug candidate and disease condition has on the 35 clinical variables.</p>
    </sec>
    <sec id="Sec4">
      <title>Clinical disease sign vector</title>
      <p id="Par23">We extract 6 disease conditions and 35 clinical variables from NHANES after preprocessing to establish the clinical disease sign vector. The dimension of each disease sign vector is <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \times 35$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:mn>35</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq1.gif"/></alternatives></inline-formula>. There are three types of relations between a disease and clinical vectors (i.e., “Up”, “Down” and “No”), which represents increasing, decreasing and not significantly changing of laboratory results level, respectively. As mentioned above, the combined data is divided into disease group and control group according to the questionnaire data, we apply Wilcoxon rank sum test (a.k.a., Mann Whitney <italic>U</italic> test) on two groups to calculate the <italic>p</italic>-value for each clinical variable. Certain <italic>p</italic>-value cut-off is used to examine whether the value change is significant or not [<xref ref-type="bibr" rid="CR18">18</xref>]. In our work, the <italic>p</italic>-value threshold is set to be 0.05. Only the clinical variables satisfy the condition that <italic>p</italic>-values are less than 0.05 can be regarded as significant clinical variables concerning the disease. We consult the Mann–Whitney table of <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha =0.05$$\end{document}</tex-math><mml:math id="M4"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>0.05</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq2.gif"/></alternatives></inline-formula>. If the smaller value of <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{1}$$\end{document}</tex-math><mml:math id="M6"><mml:msub><mml:mi>U</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq3.gif"/></alternatives></inline-formula> and <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$U_{2}$$\end{document}</tex-math><mml:math id="M8"><mml:msub><mml:mi>U</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq4.gif"/></alternatives></inline-formula> is larger than the value given in the table, the null hypothesis is true otherwise false. Then we assign relation direction to this clinical variable by comparing the average clinical variable value of the disease group and control group. Up relation (“<inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M10"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq5.gif"/></alternatives></inline-formula>”) indicates a significant value increase in the disease group compared with the control group, while down relation (“<inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\downarrow$$\end{document}</tex-math><mml:math id="M12"><mml:mo stretchy="false">↓</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq6.gif"/></alternatives></inline-formula>”) means the laboratory value of the disease group is significantly lower than that of the control group, no relation (“-”) indicate the laboratory result level will not be significantly influenced by the disease.</p>
    </sec>
    <sec id="Sec5">
      <title>Clinical drug effect vector</title>
      <p id="Par24">To establish clinical drug effect vectors, we extract 392 drugs and 35 clinical variables from EHR data. The clinical variables used here are the same as ones in establishing the disease sign vectors. So, the dimension of each drug effect vector is <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \times 35$$\end{document}</tex-math><mml:math id="M14"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:mn>35</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq7.gif"/></alternatives></inline-formula>. We need to consider the prescription records of patients and their corresponding laboratory results records simultaneously, and the EHR dataset we use is a large dataset that includes millions of records. So, we need to find a way to analyze the high-dimensional longitudinal data. In our work, we adopt the continuous self-controlled case Series (CSCCS) model proposed by Kuang et al. [<xref ref-type="bibr" rid="CR15">15</xref>], it is a lasso regression analysis model designed to do the data analytical work for EHR dataset.</p>
      <p id="Par25">Assuming there are N patients with a specific kind of clinical variable measurement and M kinds of drugs in EHR dataset. Continuous variable <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{i j}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq8.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \{1,2, \ldots , N\}$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq9.gif"/></alternatives></inline-formula>, <inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j \in \{1,2, \ldots , J_{i}\}$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq10.gif"/></alternatives></inline-formula>, indicates the value of <inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j_{t h}$$\end{document}</tex-math><mml:math id="M22"><mml:msub><mml:mi>j</mml:mi><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq11.gif"/></alternatives></inline-formula> clinical variable measurement taken among a total number of <inline-formula id="IEq12"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{i}$$\end{document}</tex-math><mml:math id="M24"><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq12.gif"/></alternatives></inline-formula> measurements for the <inline-formula id="IEq13"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{t h}$$\end{document}</tex-math><mml:math id="M26"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq13.gif"/></alternatives></inline-formula> patient, while binary variable <inline-formula id="IEq14"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$x_{i j m}$$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijm</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq14.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq15"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i \in \{1,2, \ldots , N\}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq15.gif"/></alternatives></inline-formula>, <inline-formula id="IEq16"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j \in \{1,2, \ldots , J_{i}\}$$\end{document}</tex-math><mml:math id="M32"><mml:mrow><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq16.gif"/></alternatives></inline-formula>, <inline-formula id="IEq17"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m \in \{1,2, \ldots , M\}$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq17.gif"/></alternatives></inline-formula>, are used to indicated the drug whether <inline-formula id="IEq18"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{t h }$$\end{document}</tex-math><mml:math id="M36"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq18.gif"/></alternatives></inline-formula> patient are exposed to the <inline-formula id="IEq19"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{t h}$$\end{document}</tex-math><mml:math id="M38"><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq19.gif"/></alternatives></inline-formula> drug when the <inline-formula id="IEq20"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$j_{t h }$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mi>j</mml:mi><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq20.gif"/></alternatives></inline-formula> clinical variable measurement is taken. 0 represents no and 1 represents yes.</p>
      <p id="Par26"><inline-formula id="IEq21"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{i j}$$\end{document}</tex-math><mml:math id="M42"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq21.gif"/></alternatives></inline-formula> is regard as the output variables when we fit the structured data into the linear regression model, so we have:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} y_{i j} | {\varvec{x}}_{i j}= &amp; {} \alpha _{i}+\varvec{\beta }^{\top } {\varvec{x}}_{i j}+\epsilon _{i j}, \quad \epsilon _{i j} {\mathop {\sim }\limits ^{i i d}} N\left( 0, \sigma ^{2}\right) \nonumber \\ \varvec{\beta }= &amp; {} \begin{bmatrix} \beta _{1}&amp;\beta _{2}&amp;\cdots&amp;\beta _{M} \end{bmatrix}^{\top },\nonumber \\ {\varvec{x}}_{i j}= &amp; {} \begin{bmatrix} x_{i j 1}&amp;x_{i j 2}&amp;\cdots&amp;x_{i j M} \end{bmatrix}^{\top } \end{aligned}$$\end{document}</tex-math><mml:math id="M44" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="1em"/><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mover><mml:mo>∼</mml:mo><mml:mrow><mml:mi mathvariant="italic">iid</mml:mi></mml:mrow></mml:mover><mml:mi>N</mml:mi><mml:mfenced close=")" open="("><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>β</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>β</mml:mi><mml:mi>M</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi mathvariant="italic">ijM</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mi>⊤</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12911_2021_1617_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula><inline-formula id="IEq22"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha _{i}$$\end{document}</tex-math><mml:math id="M46"><mml:msub><mml:mi>α</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq22.gif"/></alternatives></inline-formula> in Eq. (<xref rid="Equ1" ref-type="">1</xref>) represents the average baseline level of <inline-formula id="IEq23"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$y_{ij}$$\end{document}</tex-math><mml:math id="M48"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq23.gif"/></alternatives></inline-formula> on <inline-formula id="IEq24"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i_{th}$$\end{document}</tex-math><mml:math id="M50"><mml:msub><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq24.gif"/></alternatives></inline-formula> patient. That means it is independent of the date the measurement was taken and drugs the patient used when the measurement was taken. Each patient has an individual baseline value. <inline-formula id="IEq25"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\epsilon _{ij}$$\end{document}</tex-math><mml:math id="M52"><mml:msub><mml:mi>ϵ</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq25.gif"/></alternatives></inline-formula> here is an independent and identically distributed Gaussian noises with zero means and fixed but unknown variance <inline-formula id="IEq26"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\sigma ^{2}$$\end{document}</tex-math><mml:math id="M54"><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq26.gif"/></alternatives></inline-formula>. Then the linear model can be easily converted to a least square problem as follows:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \arg \min _{\varvec{\alpha },\varvec{\beta }}{\mathcal {L}}(\varvec{\alpha },\varvec{\beta })=\arg \min _{\varvec{\alpha },\varvec{\beta }}\frac{1}{2} \begin{Vmatrix} {\varvec{y}}- \begin{bmatrix} {\varvec{Z}}&amp;{\varvec{X}} \end{bmatrix} \begin{bmatrix} \varvec{\alpha }\\ \varvec{\beta } \end{bmatrix} \end{Vmatrix}^{2}_{2} \end{aligned}$$\end{document}</tex-math><mml:math id="M56" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>arg</mml:mo><mml:munder><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mi mathvariant="script">L</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>arg</mml:mo><mml:munder><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mfenced close="∥" open="∥"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow/><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mn>2</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12911_2021_1617_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula>where<disp-formula id="Equ8"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned}{}&amp;\varvec{\alpha }= \begin{bmatrix} \alpha _{1}&amp;\alpha _{2}&amp;\cdots&amp;\alpha _{N} \end{bmatrix}^{\top }, {\varvec{Z}}={\text {diag}} \begin{pmatrix} {\mathbf {1}}_{1}, \cdots , {\mathbf {1}}_{N} \end{pmatrix},\\&amp;{\varvec{y}}= \begin{bmatrix} y_{11}&amp;\cdots&amp;y_{1 J_{1}}&amp;{\cdots }&amp;y_{N 1}&amp;\cdots&amp;y_{N J_{N}} \end{bmatrix}^{\top },\\&amp;{\varvec{X}}= \begin{bmatrix} {\varvec{x}}_{11}&amp;\cdots&amp;{\varvec{x}}_{1 J_{1}}&amp;\cdots&amp;{\varvec{x}}_{N 1}&amp;\cdots&amp;{\varvec{x}}_{N J_{N}} \end{bmatrix}^{\top } \end{aligned}$$\end{document}</tex-math><mml:math id="M58" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>α</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:msub><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>α</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mtext>diag</mml:mtext><mml:mfenced close=")" open="("><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>y</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>J</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mfenced close="]" open="["><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>11</mml:mn></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd><mml:mtd><mml:mo>⋯</mml:mo></mml:mtd><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>J</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mi>⊤</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12911_2021_1617_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{Z}}$$\end{document}</tex-math><mml:math id="M60"><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq27.gif"/></alternatives></inline-formula> is a block diagonal matrix and <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{1_{i}}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:msub><mml:mn mathvariant="bold">1</mml:mn><mml:mi mathvariant="bold-italic">i</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq28.gif"/></alternatives></inline-formula> is a <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$J_{i} \times 1$$\end{document}</tex-math><mml:math id="M64"><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq29.gif"/></alternatives></inline-formula> vector in which all the components are 1. By solving this problem, we can get the optimized parameter <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }$$\end{document}</tex-math><mml:math id="M66"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq30.gif"/></alternatives></inline-formula>, which is also the interest of our task. <inline-formula id="IEq31"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }$$\end{document}</tex-math><mml:math id="M68"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq31.gif"/></alternatives></inline-formula> is a <inline-formula id="IEq32"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$1 \times M$$\end{document}</tex-math><mml:math id="M70"><mml:mrow><mml:mn>1</mml:mn><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq32.gif"/></alternatives></inline-formula> parameter vector, parameter <inline-formula id="IEq33"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta _{m}}$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">β</mml:mi><mml:mi mathvariant="bold-italic">m</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq33.gif"/></alternatives></inline-formula> in <inline-formula id="IEq34"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }$$\end{document}</tex-math><mml:math id="M74"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq34.gif"/></alternatives></inline-formula> indicates the effect of <inline-formula id="IEq35"><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m_{t h}$$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq35.gif"/></alternatives></inline-formula> drug on the output variable <inline-formula id="IEq36"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\varvec{y}}$$\end{document}</tex-math><mml:math id="M78"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq36.gif"/></alternatives></inline-formula>. The optimized parameter we get with the CSCCS model is numerical. Positive and negative parameters in this vector represent the corresponding drugs that may increase and decrease the level of output variable respectively, while 0 indicates the corresponding drugs do not influence it. In the CSCCS model, parameter <inline-formula id="IEq37"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\alpha }$$\end{document}</tex-math><mml:math id="M80"><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq37.gif"/></alternatives></inline-formula> is regarded as a nuisance parameter, our interest is parameter <inline-formula id="IEq38"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }$$\end{document}</tex-math><mml:math id="M82"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq38.gif"/></alternatives></inline-formula> so we do not need to care the value of <inline-formula id="IEq39"><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\alpha }$$\end{document}</tex-math><mml:math id="M84"><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq39.gif"/></alternatives></inline-formula>. To eliminate the effect of <inline-formula id="IEq40"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\alpha }$$\end{document}</tex-math><mml:math id="M86"><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq40.gif"/></alternatives></inline-formula>, [<xref ref-type="bibr" rid="CR15">15</xref>] consider:<disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \frac{\partial {\mathcal {L}}(\varvec{\alpha }, \varvec{\beta })}{\partial \varvec{\alpha }}={\mathbf {0}} \Rightarrow \varvec{\alpha }=\left( {\varvec{Z}}^{\top } {\varvec{Z}}\right) ^{-1} {\varvec{Z}}^{\top }({\varvec{y}}-{\varvec{X}} \varvec{\beta })=\overline{{\varvec{y}}}-\overline{{\varvec{X}}} \varvec{\beta } \end{aligned}$$\end{document}</tex-math><mml:math id="M88" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi><mml:mi mathvariant="script">L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>∂</mml:mi><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn mathvariant="bold">0</mml:mn><mml:mo stretchy="false">⇒</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mfenced close=")" open="("><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow></mml:mfenced><mml:mrow><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow></mml:mrow><mml:mi>⊤</mml:mi></mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12911_2021_1617_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>Where <inline-formula id="IEq41"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{{\varvec{y}}}$$\end{document}</tex-math><mml:math id="M90"><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq41.gif"/></alternatives></inline-formula> is a <inline-formula id="IEq42"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\times 1$$\end{document}</tex-math><mml:math id="M92"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq42.gif"/></alternatives></inline-formula> vector which includes the average value of clinical value among <italic>N</italic> patients, <inline-formula id="IEq43"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{y_{i}} = \frac{1}{J_{i}} \sum _{j=1}^{J_{i}} y_{i j}$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mover><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq43.gif"/></alternatives></inline-formula>. <inline-formula id="IEq44"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{{\varvec{X}}}$$\end{document}</tex-math><mml:math id="M96"><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq44.gif"/></alternatives></inline-formula> is a <inline-formula id="IEq45"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N \times M$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:mi>N</mml:mi><mml:mo>×</mml:mo><mml:mi>M</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq45.gif"/></alternatives></inline-formula> matrix and <inline-formula id="IEq46"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\overline{{\varvec{X}}}_{i}=\frac{1}{J_{i}} \sum _{j=1}^{J_{i}} {\varvec{x}}_{i j}^{\top }$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:msub><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">ij</mml:mi></mml:mrow><mml:mi>⊤</mml:mi></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq46.gif"/></alternatives></inline-formula>. So, the expression of CSCCS model below, which is free of <inline-formula id="IEq47"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\alpha }$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mi mathvariant="bold-italic">α</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq47.gif"/></alternatives></inline-formula>, is derived by substituting Eq. (<xref rid="Equ3" ref-type="">3</xref>) into Eq. (<xref rid="Equ2" ref-type="">2</xref>):<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \arg \min _{\beta } \frac{1}{2}\Vert {\varvec{y}}-{\varvec{Z}} \overline{{\varvec{y}}}-({\varvec{X}}-{\varvec{Z}} \overline{{\varvec{X}}}) \varvec{\beta }\Vert _{2}^{2} \end{aligned}$$\end{document}</tex-math><mml:math id="M104" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>arg</mml:mo><mml:munder><mml:mo movablelimits="true">min</mml:mo><mml:mi>β</mml:mi></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12911_2021_1617_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>When we apply the CSCCS model on the high-dimensional longitudinal EHR data, we will add a <inline-formula id="IEq48"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{1}$$\end{document}</tex-math><mml:math id="M106"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq48.gif"/></alternatives></inline-formula> penalty term because there is an assumption that the level of clinical variables will only be significantly influenced by a small portion of drugs. The <inline-formula id="IEq49"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L_{1}$$\end{document}</tex-math><mml:math id="M108"><mml:msub><mml:mi>L</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq49.gif"/></alternatives></inline-formula> penalization drives most components of <inline-formula id="IEq50"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq50.gif"/></alternatives></inline-formula> to zero or closed to zero [<xref ref-type="bibr" rid="CR19">19</xref>]. In other words, we simply want to know the drugs which are most correlated to the level change of clinical variables. So the final expression of the CSCCS model we apply to this problem is:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \arg \min _{\varvec{\beta }} \frac{1}{2}\Vert {\varvec{y}}-{\varvec{Z}} \overline{{\varvec{y}}}-({\varvec{X}}-{\varvec{Z}} \overline{{\varvec{X}}}) \varvec{\beta }\Vert _{2}^{2}+\lambda \Vert \varvec{\beta }\Vert _{1} \end{aligned}$$\end{document}</tex-math><mml:math id="M112" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>arg</mml:mo><mml:munder><mml:mo movablelimits="true">min</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:munder><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow></mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo>-</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>-</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msub><mml:mrow><mml:mo stretchy="false">‖</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow><mml:mo stretchy="false">‖</mml:mo></mml:mrow><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12911_2021_1617_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq51"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda &gt;0$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:mi>λ</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq51.gif"/></alternatives></inline-formula>, <inline-formula id="IEq52"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\lambda$$\end{document}</tex-math><mml:math id="M116"><mml:mi>λ</mml:mi></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq52.gif"/></alternatives></inline-formula> decides the sparsity of optimized result so we need to tune this parameter to get a final result with proper sparsity level.</p>
      <p id="Par27">In order to further filter out the drugs which do not have a significant effect on clinical variables, our implementation also returns the <italic>p</italic>-value of each component in <inline-formula id="IEq53"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }$$\end{document}</tex-math><mml:math id="M118"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq53.gif"/></alternatives></inline-formula>. We apply the same <italic>p</italic>-value cut-off strategy on the optimized result. Parameters with a <italic>p</italic>-value greater than 0.05 in <inline-formula id="IEq54"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\varvec{\beta }$$\end{document}</tex-math><mml:math id="M120"><mml:mrow><mml:mi mathvariant="bold-italic">β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq54.gif"/></alternatives></inline-formula> are regarded as insignificant effect and we assume their corresponding drugs are uncorrelated with clinical variable level change. The significant effects can be divided into increasing or decreasing effect based on the coefficient value is positive or negative. Then we assign each drug-clinical variable pair up (“<inline-formula id="IEq55"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M122"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq55.gif"/></alternatives></inline-formula>”), down (“<inline-formula id="IEq56"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\downarrow$$\end{document}</tex-math><mml:math id="M124"><mml:mo stretchy="false">↓</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq56.gif"/></alternatives></inline-formula>”) and no (“-”) relation type just like clinical disease sign vectors.</p>
    </sec>
    <sec id="Sec6">
      <title>Scoring function</title>
      <p id="Par28">After we establish the clinical vectors for each drug-disease pair, we need to define a scoring function to calculate the repurposing possibility score for each drug-disease pair. The inference for each drug-disease pair is based on complementary and adverse effects. Specifically, complementary effect refers to the opposed relation type between a clinical disease sign vector and clinical drug effect vector on the same clinical variables, while adverse effect refers to the same relation type between a clinical disease sign vector and clinical drug effect vector on the same clinical variables. The complementary relation direction between the two vectors will increase the final repurposing possibility score of a drug-disease pair while adverse relation direction will decrease it. Here, we use a dot product-based scoring function to consider both complementary and adverse effects of a drug candidate on a disease. The scoring function can be written as follow:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \hbox {TS}_{\mathrm{disease-drug}}=-\hbox {CV}_{\mathrm{Drug}} \cdot \hbox {CV}_{\mathrm{Disease}} \end{aligned}$$\end{document}</tex-math><mml:math id="M126" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>TS</mml:mtext><mml:mrow><mml:mi mathvariant="normal">disease</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="normal">drug</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>-</mml:mo><mml:msub><mml:mtext>CV</mml:mtext><mml:mi mathvariant="normal">Drug</mml:mi></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mtext>CV</mml:mtext><mml:mi mathvariant="normal">Disease</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12911_2021_1617_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq57"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {CV}_{\mathrm{Drug}}$$\end{document}</tex-math><mml:math id="M128"><mml:msub><mml:mtext>CV</mml:mtext><mml:mi mathvariant="normal">Drug</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq57.gif"/></alternatives></inline-formula> is the clinical drug effect vector, and <inline-formula id="IEq58"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\hbox {CV}_{\mathrm{Disease}}$$\end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mtext>CV</mml:mtext><mml:mi mathvariant="normal">Disease</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq58.gif"/></alternatives></inline-formula> is the clinical disease sign vector. We transform the 3 kinds of relation type in clinical vectors (“<inline-formula id="IEq59"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M132"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq59.gif"/></alternatives></inline-formula>”, “<inline-formula id="IEq60"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\downarrow$$\end{document}</tex-math><mml:math id="M134"><mml:mo stretchy="false">↓</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq60.gif"/></alternatives></inline-formula>” and “−”) into numerical values (1.0, <inline-formula id="IEq61"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$-1.0$$\end{document}</tex-math><mml:math id="M136"><mml:mrow><mml:mo>-</mml:mo><mml:mn>1.0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq61.gif"/></alternatives></inline-formula>, 0.0) for the convenience of calculation. To rank the drugs in descending order and emphasize the most powerful drug candidates predicted by our model, we add a minus sign before the product of the two vectors. So, the positive result calculated by this scoring function means there are more complementary relation directions than adverse relation directions between a drug candidate and a disease, while negative results indicate more adverse relation directions between this pair.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Results and discussion</title>
    <sec id="Sec8">
      <title>Evaluation metrics</title>
      <p id="Par29">After we calculate the repurposing possibility score of each drug-disease pair, we need to prove that the score is qualified enough to serve as a metric to show whether a drug candidate is likely to be the potential treatment or not. The final drug candidate list is sorted by the repurposing possibility score in a descending order for the convenience of validation. The validation data we use comes from Side Effect Resource(SIDER) [<xref ref-type="bibr" rid="CR20">20</xref>]. It contains drugs with indications or side-effects for many kinds of disease conditions. We take it for ground truth to testify whether our method can retrieve known indications of drugs. The hypothesis is that drug candidates with higher repurposing possibility score are more likely to be the treatment of the disease, which means most of the top-ranking drugs can be found in the drugs with indication and most of the bottom ranking drugs can be found in the drugs with side-effects provided by SIDER. In this case, those drugs can not be found in the validation data but still predicted with high repurposing possibility score by our model could be served as a potential treatment of the disease. So we need to use some evaluation metrics to test whether the known drug-diseases pairs are enriched at the top of our prediction list. We will use two kinds of evaluation metrics to validate our prediction.</p>
      <sec id="Sec9">
        <title>Precision at K</title>
        <p id="Par30">The First kind of evaluation metric is precision at K. The top K precision value is the ratio of known treatment for a disease among the top K drug candidates for the disease predicted by our framework.</p>
        <p id="Par31">For each disease, we rank the drugs using the calculated repurposing possibility score. Then we compute the precision at <italic>K</italic> (<inline-formula id="IEq62"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K \in \{5, 10, 15, 20\}$$\end{document}</tex-math><mml:math id="M138"><mml:mrow><mml:mi>K</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>15</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq62.gif"/></alternatives></inline-formula>) of each disease using the top-ranked <italic>K</italic> drugs (e.g., precision at 10 corresponds to the proportion of correct retrieved drugs among the top 10 ranked drugs).</p>
      </sec>
      <sec id="Sec10">
        <title>Fold-enrichment test</title>
        <p id="Par32">Another evaluation metric to access whether our repurposing possibility score is correlated with the likelihood that disease-drug pair occurs or not is the fold-enrichment (FE) test. FE score can be defined by the following formula:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{aligned} \hbox {FE Score}=\frac{(n/m)}{(N/M)} \end{aligned}$$\end{document}</tex-math><mml:math id="M140" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>FE Score</mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>N</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="12911_2021_1617_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula>where <italic>M</italic> is the number of all the mapped drugs and <italic>N</italic> is the number of drugs in the gold-standard dataset corresponding to each kind of disease condition. We will divide all the mapped drugs evenly into several groups according to their repurposing possibility score. So, <italic>m</italic> is the total number of drugs in one group and <italic>n</italic> is the number of drugs involved in the gold-standard dataset within the group. FE test can demonstrate the enrichment of known disease-drug pair (we assume the drug-disease pairs in SIDER is ground truth) within different score ranges. Our prediction can be proved to be reasonable if the FE test score is positively correlated with the repurposing possibility score. There are 392 drug-disease pairs for each kind of disease condition in our experiment, and all of them are ranked by repurposing possibility score and binned into groups of 80 pairs (the last group contains 72 drug-disease pairs). The scoring function is reasonable if the FE score is decreasing with the ascending order of the 5 groups because the average repurposing possibility score of each group is decreasing in that order.</p>
      </sec>
    </sec>
    <sec id="Sec11">
      <title>Established disease and drug vectors</title>
      <p id="Par33">In our experiment, we first establish all of the clinical diseases and drug vectors. All the clinical disease sign vectors are represented in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2, and all the clinical drug effect vectors are represented in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3.</p>
      <p id="Par34">Then, we calculate the repurposing possibility score of 392 kinds of drugs on six disease conditions (asthma, coronary heart disease, congestive heart failure, heart attack, type 2 diabetes and stroke). The repurposing possibility score of each drug-disease pair is listed in Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Table S4. We also transform the table into a heat map Fig. <xref rid="Fig4" ref-type="fig">4</xref> to vividly present the repurposing possibility score. Due to page limitation, we just present the drugs that have an influence on any of the 6 diseases in our experiment (153 kinds of drugs). The complete heat map can be is in Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Fig. S3. Then we perform validations on our prediction for each of the six disease conditions. Each of the six disease conditions has enough sample size which can make our validation result more confident. We extract a list of drugs from the drug indication information resources for each of the six disease conditions provided by SIDER. All of the drugs in the six lists are known to treat the six disease conditions respectively, so we assume them as the ground truth and further compare them with our prediction.</p>
    </sec>
    <sec id="Sec12">
      <title>Evaluation of known drug-disease associations</title>
      <p id="Par35">The results of the prediction at K for 6 disease conditions are shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. The figure demonstrates the precision of our prediction at <inline-formula id="IEq63"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K\in \{5,10,15,20\}$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:mi>K</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>15</mml:mn><mml:mo>,</mml:mo><mml:mn>20</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq63.gif"/></alternatives></inline-formula>. For type 2 diabetes, stroke, heart attack and congestive heart failure, it is clear that most of the drugs can be mapped into the ground truth(SIDER drug list) when the K is small, the precisions of all the four disease conditions in the figure are greater than or equal to 0.8 when <inline-formula id="IEq64"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$K=5$$\end{document}</tex-math><mml:math id="M144"><mml:mrow><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq64.gif"/></alternatives></inline-formula>, their precision will decrease with the increase of K. However, the results of asthma and coronary heart disease were not as expected. For coronary heart disease, there is not so many known drug-disease pair in SIDER, which could be a reason for the low precision of this disease condition. Some of the clinical variables, like cholesterol, LDL (low-density lipoprotein), HDL (high-density lipoprotein) and triglycerides are more salient features than other clinical variables. So, our analysis for the disease condition which does not have a strong correlation with these clinical variables could have low precision. Apart from those known treatments of each target disease that can be found in the ground truth, there could be some unknown drug candidates which are likely to be the treatment of target disease.<fig id="Fig2"><label>Fig. 2</label><caption><p>Top K precision of each disease condition demonstrates the proportion of known drug-disease pairs among the top K ranking drugs in our prediction list. This prediction list is ranked by repurposing possibility score</p></caption><graphic xlink:href="12911_2021_1617_Fig2_HTML" id="MO10"/></fig></p>
      <p id="Par36">The results of the FE test are shown in Fig. <xref rid="Fig3" ref-type="fig">3</xref>. As we can see, there is a negative linear relationship between the FE score and the group order. Since the average FE test score is decreasing with the ascending order of groups, so there is a positive linear relationship between FE score and average repurposing possibility score. The result in Fig. <xref rid="Fig3" ref-type="fig">3</xref> shows that all 6 disease conditions demonstrate a negative linear relationship between their FE score and group order. Therefore, our scoring function is proven to be reasonable.<fig id="Fig3"><label>Fig. 3</label><caption><p>Fold-enrichment result of each disease condition, we divide the drug-disease pair into 5 groups with the descending order of average repurposing possibility score. So, the negative linear relations between the group order and FE score indicate the positive relationship between the average repurposing possibility score. It shows our scoring function is useful in finding the drugs which have a therapeutic effect on target diseases</p></caption><graphic xlink:href="12911_2021_1617_Fig3_HTML" id="MO11"/></fig></p>
    </sec>
    <sec id="Sec13">
      <title>Case study and explainability</title>
      <p id="Par37">Having presented that our model successfully identified known associations between drugs and diseases, we further demonstrate the explainability of our model via corresponding complementarity between laboratory results of drug effect vectors and disease sign vectors. To exemplify this, we select 5 drug-disease association pairs (i.e., Type 2 diabetes-Clopidogrel hydrogen sulfate, Type 2 diabetes-Doxycycline hyclate, Coronary heart disease-Alendronate sodium, Congestive heart failure-Alendronate sodium and Heart attack-Alendronate sodium). For a given disease, the selected drugs are in its top-20 predicted list but not have been indicated as the treatment. In order to vividly compare the clinical vectors of the drug candidates and the corresponding disease, we present the clinical variables which contribute to their repurposing possibility score in Table <xref rid="Tab1" ref-type="table">1</xref>. All the detailed clinical vectors can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2 and Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S3. Combining the clinical disease vectors with clinical drug effect vectors, we can analyze why the drug candidates we select are potential treatments for corresponding disease conditions from the standpoint of clinical variables included in our experiment.<table-wrap id="Tab1"><label>Table 1</label><caption><p>This table presents the selected previously unknown drug-disease pairs predicted by our method, we just show the clinical variables that contribute to the final repurposing possibility of each drug-disease pair in the table</p></caption><table frame="hsides" rules="groups"><thead><tr><th align="left">Laboratory result</th><th align="left"/><th align="left">Alkaline phosphatase</th><th align="left">Cholesterol</th><th align="left">Glucose</th><th align="left">HDL</th><th align="left">LDL</th><th align="left">Triglycerides</th></tr></thead><tbody><tr><td align="left">Disease</td><td align="left">Type 2 diabetes</td><td align="left"><inline-formula id="IEq65"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\downarrow$$\end{document}</tex-math><mml:math id="M146"><mml:mo stretchy="false">↓</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq65.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq66"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M148"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq66.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq67"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M150"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq67.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq68"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\downarrow$$\end{document}</tex-math><mml:math id="M152"><mml:mo stretchy="false">↓</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq68.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq69"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M154"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq69.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq70"><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M156"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq70.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Drug</td><td align="left">Clopidogrel Hydrogen sulfate</td><td align="left">–</td><td align="left"><inline-formula id="IEq71"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\downarrow$$\end{document}</tex-math><mml:math id="M158"><mml:mo stretchy="false">↓</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq71.gif"/></alternatives></inline-formula></td><td align="left">–</td><td align="left">–</td><td align="left"><inline-formula id="IEq72"><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\downarrow$$\end{document}</tex-math><mml:math id="M160"><mml:mo stretchy="false">↓</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq72.gif"/></alternatives></inline-formula></td><td align="left">–</td></tr><tr><td align="left">Disease</td><td align="left">Type 2 Diabetes</td><td align="left"><inline-formula id="IEq73"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\downarrow$$\end{document}</tex-math><mml:math id="M162"><mml:mo stretchy="false">↓</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq73.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq74"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M164"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq74.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq75"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M166"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq75.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq76"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\downarrow$$\end{document}</tex-math><mml:math id="M168"><mml:mo stretchy="false">↓</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq76.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq77"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M170"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq77.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq78"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M172"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq78.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Drug</td><td align="left">Doxycycline hyclate</td><td align="left">–</td><td align="left">–</td><td align="left"><inline-formula id="IEq79"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\downarrow$$\end{document}</tex-math><mml:math id="M174"><mml:mo stretchy="false">↓</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq79.gif"/></alternatives></inline-formula></td><td align="left">–</td><td align="left">–</td><td align="left">–</td></tr><tr><td align="left">Disease</td><td align="left">Coronary heart disease</td><td align="left"><inline-formula id="IEq80"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M176"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq80.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq81"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M178"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq81.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq82"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M180"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq82.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq83"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\downarrow$$\end{document}</tex-math><mml:math id="M182"><mml:mo stretchy="false">↓</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq83.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq84"><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M184"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq84.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq85"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M186"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq85.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Drug</td><td align="left">Alendronate sodium</td><td align="left"><inline-formula id="IEq86"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\downarrow$$\end{document}</tex-math><mml:math id="M188"><mml:mo stretchy="false">↓</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq86.gif"/></alternatives></inline-formula></td><td align="left">–</td><td align="left">–</td><td align="left"><inline-formula id="IEq87"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M190"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq87.gif"/></alternatives></inline-formula></td><td align="left">–</td><td align="left">–</td></tr><tr><td align="left">Disease</td><td align="left">Congestive heart failure</td><td align="left"><inline-formula id="IEq88"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M192"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq88.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq89"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M194"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq89.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq90"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M196"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq90.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq91"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\downarrow$$\end{document}</tex-math><mml:math id="M198"><mml:mo stretchy="false">↓</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq91.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq92"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M200"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq92.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq93"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M202"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq93.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Drug</td><td align="left">Alendronate sodium</td><td align="left"><inline-formula id="IEq94"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\downarrow$$\end{document}</tex-math><mml:math id="M204"><mml:mo stretchy="false">↓</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq94.gif"/></alternatives></inline-formula></td><td align="left">–</td><td align="left">–</td><td align="left"><inline-formula id="IEq95"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M206"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq95.gif"/></alternatives></inline-formula></td><td align="left">–</td><td align="left">–</td></tr><tr><td align="left">Disease</td><td align="left">Heart attack</td><td align="left"><inline-formula id="IEq96"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M208"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq96.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq97"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M210"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq97.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq98"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M212"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq98.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq99"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\downarrow$$\end{document}</tex-math><mml:math id="M214"><mml:mo stretchy="false">↓</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq99.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq100"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M216"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq100.gif"/></alternatives></inline-formula></td><td align="left"><inline-formula id="IEq101"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M218"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq101.gif"/></alternatives></inline-formula></td></tr><tr><td align="left">Drug</td><td align="left">Alendronate sodium</td><td align="left"><inline-formula id="IEq102"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\downarrow$$\end{document}</tex-math><mml:math id="M220"><mml:mo stretchy="false">↓</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq102.gif"/></alternatives></inline-formula></td><td align="left">–</td><td align="left">–</td><td align="left"><inline-formula id="IEq103"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\uparrow$$\end{document}</tex-math><mml:math id="M222"><mml:mo stretchy="false">↑</mml:mo></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq103.gif"/></alternatives></inline-formula></td><td align="left">–</td><td align="left">–</td></tr></tbody></table></table-wrap></p>
      <p id="Par38">In the case of type 2 diabetes, we found that clopidogrel hydrogen sulfate could have a therapeutic effect on type 2 diabetes and Doxycycline Hyclate. Clopidogrel hydrogen sulfate is an antiplatelet medication and can be used to reduce the risk of myocardial infarction and stroke [<xref ref-type="bibr" rid="CR21">21</xref>]. A study reported that clopidogrel will alleviate insulin resistance and improve glycemic control in type 2 diabetic patients [<xref ref-type="bibr" rid="CR22">22</xref>], which is an important cause of insulin resistance. From the clinical drug effect vector of clopidogrel and clinical disease sign vector of type 2 diabetes, we can see clopidogrel and type 2 diabetes have the opposite effect on the cholesterol and LDL level. Lower cholesterol and LDL levels are biological markers of good glycaemic control [<xref ref-type="bibr" rid="CR23">23</xref>], which is also corresponding to the literature study. Doxycycline Hyclate is an antibiotic which is primarily used to treat a wide range of bacterial infections. From the clinical vectors of Doxycycline and type 2 diabetes, we can see they have the opposite effect on the serum glucose level. High fasting blood glucose level is a common biological marker among type 2 diabetes patients. This finding is supported by a medical study that doxycycline can improve insulin resistance and fasting blood glucose level [<xref ref-type="bibr" rid="CR24">24</xref>]. The analysis based on the opposite effect of type 2 diabetes and clopidogrel proves our prediction is reasonable, clopidogrel and doxycycline may be used as treatments for type 2 diabetes.</p>
      <p id="Par39">Alendronate sodium is usually used to treat osteoporosis [<xref ref-type="bibr" rid="CR25">25</xref>]. We found it can potentially have a therapeutic effect on cardiovascular disease, including congestive heart failure, heart attack and coronary heart disease. Experiments show that alendronate can induce significantly lower cardiovascular mortality and reduce the risk of cardiovascular incidents [<xref ref-type="bibr" rid="CR26">26</xref>]. A possible explanation given by this study is that bone and cardiovascular remodeling share some biological markers. From the clinical drug effect vectors of alendronate, we can see alendronate can lower alkaline phosphatase (ALP) and elevate the HDL level. Researches show that ALP can catalyze the inhibitor of vascular calcification, thus high-level ALP may lead to vascular hardening and promotes the atherosclerotic process [<xref ref-type="bibr" rid="CR27">27</xref>]. On the other hand, HDL will promote reverse cholesterol transport, which could reduce the risk of cardiovascular events [<xref ref-type="bibr" rid="CR28">28</xref>]. Thus, it seems possible that alendronate could be repurposed as a treatment for cardiovascular disease.</p>
    </sec>
    <sec id="Sec14">
      <title>Highly related drugs and diseases</title>
      <p id="Par40">In Fig. <xref rid="Fig4" ref-type="fig">4</xref>, we demonstrate part of the repurposing possibility scores in the form of heat map. To further digging the relation within different drugs or diseases, we use bi-clustering algorithm to do a clustering for the drugs and diseases in Fig. <xref rid="Fig4" ref-type="fig">4</xref>. Bi-clustering is a data mining technology that simultaneous clustering of both row and column sets in a data matrix [<xref ref-type="bibr" rid="CR29">29</xref>]. Given an <inline-formula id="IEq104"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m \times n$$\end{document}</tex-math><mml:math id="M224"><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq104.gif"/></alternatives></inline-formula>, bi-clustering algorithm will generate new <inline-formula id="IEq105"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m \times n$$\end{document}</tex-math><mml:math id="M226"><mml:mrow><mml:mi>m</mml:mi><mml:mo>×</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="12911_2021_1617_Article_IEq105.gif"/></alternatives></inline-formula> matrix that a subset of rows which exhibit similar behavior across a subset of columns, or vice versa. In our work, we use bi-clustering algorithm to find different drugs with similar effect on some a disease and different diseases which can be treated with same kind of drug. The clustering result is plotted in Fig. <xref rid="Fig5" ref-type="fig">5</xref>. As shown in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, type 2 diabetes has a strong correlation with heart diseases and stroke. We can also find many drugs that can decrease blood lipid or sugar level have a therapy effect on those diseases. In the further, these findings can help to find potential drug-disease pairs.<fig id="Fig4"><label>Fig. 4</label><caption><p>Heat map of drug-disease repurposing possibility scores. X-axis stands for the 6 disease conditions and Y-axis is the name of the 153 drugs that have an influence on any of the diseases involved in our experiment. The color bar above the heat map annotates the scores that different colors in the heat map stand for</p></caption><graphic xlink:href="12911_2021_1617_Fig4_HTML" id="MO12"/></fig><fig id="Fig5"><label>Fig. 5</label><caption><p>The heat map after bi-clustering, X-axis stands for the 6 disease conditions and Y-axis is the name of the 153 drugs that have an influence on any of the diseases involved in our experiment. The color bar above the heat map annotates the scores that different colors in the heat map stand for</p></caption><graphic xlink:href="12911_2021_1617_Fig5_HTML" id="MO13"/></fig></p>
    </sec>
    <sec id="Sec15">
      <title>Limitations and further work</title>
      <p id="Par41">The verification results above show that our framework may identify some potential drug indications and thus help researchers find novel uses of existing drugs. However, our framework still has some limitations and space to improve.</p>
      <p id="Par42">First of all, we only include 6 kinds of diseases and 392 kinds of drugs in the our work. Actually, there are some other disease conditions and drugs that can be found in NHANES and EHR dataset. The reason we just include a part of drugs and diseases is that many of them have a small sample size so that we can not get a reliable result from them. To guarantee the results we get from the dataset are reliable enough, the sample size of each drug and disease that included in this work is larger than 1000. Due to this threshold, the experiments are conducted on 6 diseases conditions and 392 drugs, but the results we get are reliable and robust. In the future, we can include more drug-disease pairs with a large-scaled dataset.</p>
      <p id="Par43">The second limitation is the clinical variables involved in the experiment. Hundreds of clinical variables (laboratory results) can be found in the NHANES dataset, but we still need to match them with the clinical variables in the EHR dataset. However, 35 kinds of clinical variables cannot completely reflect the human physiological activity, so it would be also addressed if we have a larger EHR dataset that contains more clinical variables.</p>
    </sec>
  </sec>
  <sec id="Sec16">
    <title>Conclusion</title>
    <p id="Par44">In this paper, we establish a drug repurposing computational framework by using the electronic clinical information from the National Health and Nutrition Examination Survey (NHANES) and Electronic Health Records(EHR). We consider both of the opposite and same expressions between clinical disease sign vector and clinical drug effect vector in each drug-disease pair to calculate the repurposing possibility score. Our inferences of the novel use for different drugs are based on their repurposing possibility score with different disease conditions. We verify our predictions by fold-enrichment test and top K precision. Then, we further prove the feasibility of our model by doing a literature analysis of our prediction result. The result shows that our framework can not only retrieve the known indications of existing drugs but also find the previously unknown indications of existing drugs. So our framework can be potentially used in the drug repurposing tasks.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec17">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="12911_2021_1617_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1: Table S2</bold>. Clinical Disease Sign Vector. This table presents 6 kinds of disease conditions involved in our experiment and their influences on the 35 kinds of laboratory results</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="12911_2021_1617_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2: Table S3</bold>. Clinical Drug Effect Vector. This table presents 392 kinds of existing drugs or drug combinations involved in our experiment and their influences on the 35 kinds of laboratory results</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="12911_2021_1617_MOESM3_ESM.png">
            <caption>
              <p><bold>Additional file 3: Figure S3</bold> Detailed Drug-Disease Heat Map. We transform the repurposing possibility score table into heat map and present it in this figure. This version includes the repurposing possibility scores of all the drug-disease pair.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="12911_2021_1617_MOESM4_ESM.xlsx">
            <caption>
              <p><bold>Additional file 4: Table S4</bold>. Repurposing Possibility Score. This table include the repurposing possibility score of each drug-disease pair in our experiment</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="12911_2021_1617_MOESM5_ESM.pdf">
            <caption>
              <p><bold>Additional file 5: Table S1.</bold> Laboratory Result List. This table includes the name of 35 kinds of laboratory result involved in ourexperiments and their corresponding NHANES code. <bold>Figure S1.</bold> Disease Clinical Variable Statistics. The figure present number of diseases will increase (Up) or decrease(Down) the level of each clinical variables. X-axis is the name of eachclinical variable, Y-axis is the number diseases. Blue bar stands for the “Up”relation, red bar stands for the “Down” relation. <bold>Figure S2.</bold> Drug Clinical Variable Statistics. The number of drugs will increase (Up) or decrease (Down) the level ofeach clinical variables. X-axis is the name of each clinical variable, Y-axis isthe number diseases. Blue bar stands for the “Up” relation, red bar standsfor the “Down” relation.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>NHANES</term>
        <def>
          <p id="Par4">National Health and Nutrition Examination Survey</p>
        </def>
      </def-item>
      <def-item>
        <term>EHR</term>
        <def>
          <p id="Par5">Electronic health record</p>
        </def>
      </def-item>
      <def-item>
        <term>LDL</term>
        <def>
          <p id="Par6">Low-density lipoprotein</p>
        </def>
      </def-item>
      <def-item>
        <term>HDL</term>
        <def>
          <p id="Par7">High-density lipoprotein</p>
        </def>
      </def-item>
      <def-item>
        <term>ALP</term>
        <def>
          <p id="Par8">Alkaline phosphatase</p>
        </def>
      </def-item>
      <def-item>
        <term>CSCCS</term>
        <def>
          <p id="Par9">Continuous self-controlled case series</p>
        </def>
      </def-item>
      <def-item>
        <term>FE</term>
        <def>
          <p id="Par10">Fold enrichment</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
    <fn>
      <p>Qianlong Wen and Ruoqi Liu have contributed equally to this work.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary Information</title>
    <p>The online version contains supplementary material available at 10.1186/s12911-021-01617-4.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
    <sec id="FPar20">
      <title>About this supplement</title>
      <p id="Par45">This article has been published as part of BMC Medical Informatics and Decision Making Volume 21 Supplement 8 2021: Informatics and machine learning methods for health applications (part 3). The full contents of the supplement are available at <ext-link ext-link-type="uri" xlink:href="https://bmcmedinformdecismak.biomedcentral.com/articles/supplements/volume-21-supplement-8">https://bmcmedinformdecismak.biomedcentral.com/articles/supplements/volume-21-supplement-8</ext-link>.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Author Contributions</title>
    <p>PZ conceived the project. QW, RL, and PZ developed the method. QW conducted the experiments. QW, RL, and PZ analyzed experimental results. QW, RL, and PZ wrote the manuscript. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was funded in part by the National Center for Advancing Translational Research of the National Institutes of Health under award number CTSA Grant UL1TR002733. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>NHANES data analysed in the study is available on National Center for Health Statistics. The source code is provided for reproducing and is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/HoytWen/CCMDR">https://github.com/HoytWen/CCMDR</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar2">
      <title>Ethics approval and consent to participate</title>
      <p id="Par46">As a secondary data analysis based on existing and deidentified data, this work was not classified as human subjects research and did not require Institutional Review Board approval.</p>
    </notes>
    <notes id="FPar3">
      <title>Consent for publication</title>
      <p id="Par47">Not applicable.</p>
    </notes>
    <notes id="FPar4" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par48">PZ is the member of the editorial board of BMC Medical Informatics and Decision Making. The authors declare that they have no other competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <mixed-citation publication-type="other">O’Connor KA, Roth BL. Finding new tricks for old drugs: an efficient route for public-sector drug discovery. Nat Rev Drug Discov. 2005;4(12):1005.</mixed-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chong</surname>
            <given-names>CR</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>DJ</given-names>
            <suffix>Jr</suffix>
          </name>
        </person-group>
        <article-title>New uses for old drugs</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>448</volume>
        <issue>7154</issue>
        <fpage>645</fpage>
        <?supplied-pmid 17687303?>
        <pub-id pub-id-type="pmid">17687303</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>DiMasi</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>New drug development in the united states from 1963 to 1999</article-title>
        <source>Clin Pharmacol Ther</source>
        <year>2001</year>
        <volume>69</volume>
        <issue>5</issue>
        <fpage>286</fpage>
        <lpage>296</lpage>
        <?supplied-pmid 11371996?>
        <pub-id pub-id-type="pmid">11371996</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adams</surname>
            <given-names>CP</given-names>
          </name>
          <name>
            <surname>Brantner</surname>
            <given-names>VV</given-names>
          </name>
        </person-group>
        <article-title>Estimating the cost of new drug development: is it really 802 million?</article-title>
        <source>Health Aff</source>
        <year>2006</year>
        <volume>25</volume>
        <issue>2</issue>
        <fpage>420</fpage>
        <lpage>428</lpage>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pushpakom</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Iorio</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Eyers</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Escott</surname>
            <given-names>KJ</given-names>
          </name>
          <name>
            <surname>Hopper</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wells</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Doig</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Guilliams</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Latimer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>McNamee</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Drug repurposing: progress, challenges and recommendations</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2019</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>41</fpage>
        <lpage>58</lpage>
        <?supplied-pmid 30310233?>
        <pub-id pub-id-type="pmid">30310233</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keiser</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Setola</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Irwin</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Laggner</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Abbas</surname>
            <given-names>AI</given-names>
          </name>
          <name>
            <surname>Hufeisen</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>NH</given-names>
          </name>
          <name>
            <surname>Kuijer</surname>
            <given-names>MB</given-names>
          </name>
          <name>
            <surname>Matos</surname>
            <given-names>RC</given-names>
          </name>
          <name>
            <surname>Tran</surname>
            <given-names>TB</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Predicting new molecular targets for known drugs</article-title>
        <source>Nature</source>
        <year>2009</year>
        <volume>462</volume>
        <issue>7270</issue>
        <fpage>175</fpage>
        <?supplied-pmid 19881490?>
        <pub-id pub-id-type="pmid">19881490</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lamb</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Crawford</surname>
            <given-names>ED</given-names>
          </name>
          <name>
            <surname>Peck</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Modell</surname>
            <given-names>JW</given-names>
          </name>
          <name>
            <surname>Blat</surname>
            <given-names>IC</given-names>
          </name>
          <name>
            <surname>Wrobel</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Lerner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Brunet</surname>
            <given-names>J-P</given-names>
          </name>
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ross</surname>
            <given-names>KN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The connectivity map: using gene-expression signatures to connect small molecules, genes, and disease</article-title>
        <source>Science</source>
        <year>2006</year>
        <volume>313</volume>
        <issue>5795</issue>
        <fpage>1929</fpage>
        <lpage>1935</lpage>
        <?supplied-pmid 17008526?>
        <pub-id pub-id-type="pmid">17008526</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lamb</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The connectivity map: a new tool for biomedical research</article-title>
        <source>Nat Rev Cancer</source>
        <year>2007</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>54</fpage>
        <lpage>60</lpage>
        <?supplied-pmid 17186018?>
        <pub-id pub-id-type="pmid">17186018</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Luo</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Cao</surname>
            <given-names>XH</given-names>
          </name>
          <name>
            <surname>Du</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Wan</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dpdr-cpi, a server that predicts drug positioning and drug repositioning via chemical-protein interactome</article-title>
        <source>Sci Rep</source>
        <year>2016</year>
        <volume>6</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>9</lpage>
        <pub-id pub-id-type="pmid">28442746</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Deng</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Drug repositioning by kernel-based integration of molecular structure, molecular activity, and phenotype data</article-title>
        <source>PLOS ONE</source>
        <year>2013</year>
        <volume>8</volume>
        <issue>11</issue>
        <fpage>78518</fpage>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>F</given-names>
          </name>
        </person-group>
        <article-title>Predicting drug-disease associations by using similarity constrained matrix factorization</article-title>
        <source>BMC Bioinform</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>12</lpage>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pammolli</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Magazzini</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Riccaboni</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>The productivity crisis in pharmaceutical RD</article-title>
        <source>Nat Rev Drug Discov</source>
        <year>2011</year>
        <volume>10</volume>
        <issue>6</issue>
        <fpage>428</fpage>
        <lpage>438</lpage>
        <?supplied-pmid 21629293?>
        <pub-id pub-id-type="pmid">21629293</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jung</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Inferring disease association using clinical factors in a combinatorial manner and their use in drug repositioning</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>16</issue>
        <fpage>2017</fpage>
        <lpage>2023</lpage>
        <?supplied-pmid 23749956?>
        <pub-id pub-id-type="pmid">23749956</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jang</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Inferring new drug indications using the complementarity between clinical disease signatures and drug effects</article-title>
        <source>J Biomed Inform</source>
        <year>2016</year>
        <volume>59</volume>
        <fpage>248</fpage>
        <lpage>257</lpage>
        <?supplied-pmid 26707452?>
        <pub-id pub-id-type="pmid">26707452</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Kuang Z, Thomson J, Caldwell M, Peissig P, Stewart R, Page D. Computational drug repositioning using continuous self-controlled case series. In: Proceedings of the 22nd ACM SIGKDD international conference on knowledge discovery and data mining, 2016; p. 491–500. ACM.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Ghalwash M, Li Y, Zhang P, Hu J. Exploiting electronic health records to mine drug effects on laboratory test results. In: Proceedings of the 2017 ACM on conference on information and knowledge management, 2017; p. 1837–1846.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <mixed-citation publication-type="other">Cdc C. National health and nutrition examination survey. NCFHS (NCHS). US Department of Health and Human Services. Centers for Disease Control and Prevention. 2005.</mixed-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Statistical significance for genomewide studies</article-title>
        <source>Proc Natl Acad Sci</source>
        <year>2003</year>
        <volume>100</volume>
        <issue>16</issue>
        <fpage>9440</fpage>
        <lpage>9445</lpage>
        <?supplied-pmid 12883005?>
        <pub-id pub-id-type="pmid">12883005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Regression shrinkage and selection via the lasso</article-title>
        <source>J Roy Stat Soc Ser B (Methodol)</source>
        <year>1996</year>
        <volume>58</volume>
        <issue>1</issue>
        <fpage>267</fpage>
        <lpage>288</lpage>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kuhn</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Letunic</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Jensen</surname>
            <given-names>LJ</given-names>
          </name>
          <name>
            <surname>Bork</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>The sider database of drugs and side effects</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>44</volume>
        <issue>D1</issue>
        <fpage>1075</fpage>
        <lpage>1079</lpage>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jarvis</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Simpson</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Clopidogrel</article-title>
        <source>Drugs</source>
        <year>2000</year>
        <volume>60</volume>
        <issue>2</issue>
        <fpage>347</fpage>
        <lpage>377</lpage>
        <?supplied-pmid 10983738?>
        <pub-id pub-id-type="pmid">10983738</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taher</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Nassir</surname>
            <given-names>ES</given-names>
          </name>
        </person-group>
        <article-title>Beneficial effects of clopidogrel on glycemic indices and oxidative stress in patients with type 2 diabetes</article-title>
        <source>Saudi Pharm J</source>
        <year>2011</year>
        <volume>19</volume>
        <issue>2</issue>
        <fpage>107</fpage>
        <lpage>113</lpage>
        <?supplied-pmid 23960748?>
        <pub-id pub-id-type="pmid">23960748</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khan</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Sobki</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khan</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Association between glycaemic control and serum lipids profile in type 2 diabetic patients: HbA 1c predicts dyslipidaemia</article-title>
        <source>Clin Exp Med</source>
        <year>2007</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>24</fpage>
        <lpage>29</lpage>
        <?supplied-pmid 17380302?>
        <pub-id pub-id-type="pmid">17380302</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>X</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>H-Q</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>P-J</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>S-J</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Y-C</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Y-X</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>W-C</given-names>
          </name>
          <name>
            <surname>Wei</surname>
            <given-names>C.-j</given-names>
          </name>
        </person-group>
        <article-title>Low dose doxycycline decreases systemic inflammation and improves glycemic control, lipid profiles, and islet morphology and function in db/db mice</article-title>
        <source>Sci Rep</source>
        <year>2017</year>
        <volume>7</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>15</lpage>
        <?supplied-pmid 28127051?>
        <pub-id pub-id-type="pmid">28127051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Porras</surname>
            <given-names>AG</given-names>
          </name>
          <name>
            <surname>Holland</surname>
            <given-names>SD</given-names>
          </name>
          <name>
            <surname>Gertz</surname>
            <given-names>BJ</given-names>
          </name>
        </person-group>
        <article-title>Pharmacokinetics of alendronate</article-title>
        <source>Clin Pharmacokinet</source>
        <year>1999</year>
        <volume>36</volume>
        <issue>5</issue>
        <fpage>315</fpage>
        <lpage>328</lpage>
        <?supplied-pmid 10384857?>
        <pub-id pub-id-type="pmid">10384857</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sing</surname>
            <given-names>C-W</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>AY</given-names>
          </name>
          <name>
            <surname>Kiel</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Cheung</surname>
            <given-names>EY</given-names>
          </name>
          <name>
            <surname>Lam</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>Cheung</surname>
            <given-names>TT</given-names>
          </name>
          <name>
            <surname>Chan</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Kung</surname>
            <given-names>AW</given-names>
          </name>
          <name>
            <surname>Wong</surname>
            <given-names>IC</given-names>
          </name>
          <name>
            <surname>Cheung</surname>
            <given-names>C-L</given-names>
          </name>
        </person-group>
        <article-title>Association of alendronate and risk of cardiovascular events in patients with hip fracture</article-title>
        <source>J Bone Miner Res</source>
        <year>2018</year>
        <volume>33</volume>
        <issue>8</issue>
        <fpage>1422</fpage>
        <lpage>1434</lpage>
        <?supplied-pmid 29744914?>
        <pub-id pub-id-type="pmid">29744914</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Panh</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ruidavets</surname>
            <given-names>JB</given-names>
          </name>
          <name>
            <surname>Rousseau</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Petermann</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Bongard</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Bérard</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Taraszkiewicz</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Lairez</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Galinier</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Carrié</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Association between serum alkaline phosphatase and coronary artery calcification in a sample of primary cardiovascular prevention patients</article-title>
        <source>Atherosclerosis</source>
        <year>2017</year>
        <volume>260</volume>
        <fpage>81</fpage>
        <lpage>86</lpage>
        <?supplied-pmid 28371683?>
        <pub-id pub-id-type="pmid">28371683</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rader</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Hovingh</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>HDL and cardiovascular disease</article-title>
        <source>Lancet</source>
        <year>2014</year>
        <volume>384</volume>
        <issue>9943</issue>
        <fpage>618</fpage>
        <lpage>625</lpage>
        <?supplied-pmid 25131981?>
        <pub-id pub-id-type="pmid">25131981</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Mirkin</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <source>Mathematical Classification and Clustering</source>
        <year>2013</year>
        <publisher-loc>Berlin</publisher-loc>
        <publisher-name>Springer Science and Business Media</publisher-name>
      </element-citation>
    </ref>
  </ref-list>
</back>
