<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7703766</article-id>
    <article-id pub-id-type="pmid">31501853</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz702</article-id>
    <article-id pub-id-type="publisher-id">btz702</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>EpiSAFARI: sensitive detection of valleys in epigenetic signals for enhancing annotations of functional elements</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-9696-1118</contrib-id>
        <name>
          <surname>Harmanci</surname>
          <given-names>Arif</given-names>
        </name>
        <aff><institution>School of Biomedical Informatics, Center for Precision Health</institution>, <country country="US">USA</country></aff>
        <xref rid="btz702-cor1" ref-type="corresp"/>
        <!--arif.o.harmanci@uth.tmc.edu-->
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-9696-1118</contrib-id>
        <name>
          <surname>Harmanci</surname>
          <given-names>Akdes Serin</given-names>
        </name>
        <aff><institution>School of Biomedical Informatics, Center for Systems Medicine, University of Texas Health Science Center</institution>, Houston, TX 77030, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Swaminathan</surname>
          <given-names>Jyothishmathi</given-names>
        </name>
        <aff><institution>Department of Pediatrics</institution>, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gopalakrishnan</surname>
          <given-names>Vidya</given-names>
        </name>
        <aff><institution>Department of Pediatrics</institution>, <country country="US">USA</country></aff>
        <aff><institution>Department of Molecular and Cellular Oncology</institution>, <country country="US">USA</country></aff>
        <aff><institution>Brain Tumor Center</institution>, <country country="US">USA</country></aff>
        <aff><institution>Center for Cancer Epigenetics, University of Texas, M.D. Anderson Cancer Center</institution>, Houston, TX 77030, <country country="US">USA</country></aff>
        <aff><institution>M.D. Anderson UTHealth Graduate School of Biomedical Sciences</institution>, Houston, TX 77030, <country country="US">USA</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Birol</surname>
          <given-names>Inanc</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btz702-cor1">To whom correspondence should be addressed. <email>arif.o.harmanci@uth.tmc.edu</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>2</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-09-10">
      <day>10</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>10</day>
      <month>9</month>
      <year>2019</year>
    </pub-date>
    <volume>36</volume>
    <issue>4</issue>
    <fpage>1014</fpage>
    <lpage>1021</lpage>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>3</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>22</day>
        <month>7</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>05</day>
        <month>9</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz702.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Functional genomics experiments generate genomewide signal profiles that are dense information sources for annotating the regulatory elements. These profiles measure epigenetic activity at the nucleotide resolution and they exhibit distinctive patterns as they fluctuate along the genome. Most notable of these patterns are the valley patterns that are prevalently observed in assays such as ChIP Sequencing and bisulfite sequencing. The genomic positions of valleys pinpoint locations of cis-regulatory elements such as enhancers and insulators. Systematic identification of the valleys provides novel information for delineating the annotation of regulatory elements. Nevertheless, the valleys are not reported by majority of the analysis pipelines.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We describe EpiSAFARI, a computational method for sensitive detection of valleys from diverse types of epigenetic profiles. EpiSAFARI employs a novel smoothing method for decreasing noise in signal profiles and accounts for technical factors such as sparse signals, mappability and nucleotide content. In performance comparisons, EpiSAFARI performs favorably in terms of accuracy. The histone modification valleys detected by EpiSAFARI exhibit high conservation, transcription factor binding and they are enriched in nascent transcription. In addition, the large clusters of histone valleys are found to be enriched at the promoters of the developmentally associated genes. Differential histone valleys exhibit concordance with differential DNase signal at cell line specific valleys. DNA methylation valleys exhibit elevated conservation and high transcription factor binding. Specifically, we observed enriched binding of transcription factors associated with chromatin structure around methyl-valleys.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>EpiSAFARI is publicly available at <ext-link xlink:href="https://github.com/harmancilab/EpiSAFARI" ext-link-type="uri">https://github.com/harmancilab/EpiSAFARI</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution>National Institutes of Health of The United States</institution>
        </funding-source>
        <award-id>5R01NS079715</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Sequencing based functional genomics experiments (<xref rid="btz702-B11" ref-type="bibr">ENCODE Project Consortium, 2012</xref>; <xref rid="btz702-B15" ref-type="bibr">Hasin <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btz702-B32" ref-type="bibr">Sharing Epigenomes Globally, 2018</xref>), such as chromatin immunoprecipitation sequencing (ChIP-Seq), are being widely used to study the regulatory processes underpinning phenotypic variation (<xref rid="btz702-B12" ref-type="bibr">Esteller, 2008</xref>; <xref rid="btz702-B25" ref-type="bibr">McVicker <italic toggle="yes">et al.</italic>, 2013</xref>), such as PheWAS (<xref rid="btz702-B7" ref-type="bibr">Denny <italic toggle="yes">et al.</italic>, 2016</xref>), HAWAS (<xref rid="btz702-B33" ref-type="bibr">Sun <italic toggle="yes">et al.</italic>, 2016</xref>), and understanding epigenetic control of gene expression (<xref rid="btz702-B9" ref-type="bibr">Dong and Weng, 2013</xref>; <xref rid="btz702-B38" ref-type="bibr">Zhang and Reinberg, 2001</xref>). Most commonly, the data from these assays are summarized into signal profiles that represent epigenetic measurements at the signal nucleotide resolution, e.g. the fold-change signal or the read coverage at each nucleotide. Although the signal profiles can provide biological insight for comprehensive discovery and annotation of functional elements in the genome, most of the current analysis pipelines focus mainly on the identification of broad regions with signal enrichments, such as peaks (<xref rid="btz702-B14" ref-type="bibr">Harmanci <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btz702-B29" ref-type="bibr">Rozowsky <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="btz702-B34" ref-type="bibr">Thomas <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="btz702-B37" ref-type="bibr">Zhang <italic toggle="yes">et al.</italic>, 2008</xref>). In particular, there is much information that is encoded in the fluctuations of the signal profiles along the genome. Most notable of these fluctuations are the <italic toggle="yes">troughs</italic>, <italic toggle="yes">valleys, or canyons</italic> in the genomewide signal profiles. Troughs and valleys are generally used in the literature to refer to the punctate regions where signal profile exhibits ‘V’ shaped patterns such that a dip in the signal is observed between two summits (<xref rid="btz702-B31" ref-type="bibr">Sethi <italic toggle="yes">et al.</italic>, 2018</xref>). Previous studies have generally focused on punctate valleys at the length scales of up to 5kbs. Canyons are generally used in the context of DNA methylation to refer to broad regions with depleted signals. The signal profile over canyons are similar to a broad ‘U’ shaped pattern with large basins (<xref rid="btz702-B17" ref-type="bibr">Jeong <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btz702-B36" ref-type="bibr">Xie <italic toggle="yes">et al.</italic>, 2013</xref>). A recent publication referred to these broad canyon domains as ‘nadirs’ (<xref rid="btz702-B16" ref-type="bibr">Jeong <italic toggle="yes">et al.</italic>, 2017</xref>). Canyons have large spectrum of lengths from punctate (several kilobases) to very broad (upto megabases).</p>
    <p>The valleys are commonly observed in the signal profiles generated from many epigenetic assays such as ChIP-Seq, DNA methylation (bisulfite sequencing) (<xref rid="btz702-B22" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btz702-B36" ref-type="bibr">Xie <italic toggle="yes">et al.</italic>, 2013</xref>), open chromatin measurement [DNase sequencing (<xref rid="btz702-B24" ref-type="bibr">Madrigal and Krajewski, 2012</xref>) and MNase-Seq] and replication timing sequencing (<xref rid="btz702-B1" ref-type="bibr">Audit <italic toggle="yes">et al.</italic>, 2013</xref>; <xref rid="btz702-B10" ref-type="bibr">Dorschner <italic toggle="yes">et al.</italic>, 2009</xref>). Among these, the replication timing valleys show the largest length scales (tens of megabases) and DNase valleys show the shortest length scales (At the order of 20 base pairs). In this study we are focusing on punctate valleys at the order of 100 base pairs to 5kbs. The main reason for this is that recent literature shows that the valleys at this length scale are enriched in cis-regulatory elements which can help enhance annotation of functional elements detected from functional genomics signals.</p>
    <p>The valleys are important information bearing regions within the epigenetic signal profiles that can pinpoint the locations of cis-regulatory elements such as enhancers and insulators. Thus, the valleys can potentially enable researchers to anatomize and enhance the annotations of regulatory elements. The efficient and systematic identification of valleys can substantially increase the utility of functional genomics experiments. The information that are encoded in the valleys are currently left under-utilized because they are not reported explicitly by most of the analysis pipelines.</p>
    <p>Here we present EpiSAFARI, which performs sensitive statistical detection of punctate valleys from the fluctuations in the genome-wide signal profiles. The core algorithm is based on spline smoothing of the epigenetic signal profiles followed by valley detection using the smoothed signal profile. EpiSAFARI can analyze sparse signals such as DNA methylation signals that are non-zero only at cytosine residues on the genome. EpiSAFARI integrates technical factors such as sequence context and mappability. These factors can impact the valleys by causing ‘non-biological valleys’ to manifest (<xref rid="btz702-B4" ref-type="bibr">Benjamini and Speed, 2012</xref>; <xref rid="btz702-B14" ref-type="bibr">Harmanci <italic toggle="yes">et al.</italic>, 2014</xref>). Overall, EpiSAFARI performs favorably compared to other tools and can potentially help elucidate functional information about regulatory elements.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 EpiSAFARI algorithm</title>
      <p>The input to EpiSAFARI is the signal profile or the mapped reads (<xref rid="btz702-F1" ref-type="fig">Fig. 1</xref>). First, EpiSAFARI smooths the signal profile. To smooth the signal, EpiSAFARI divides genome into non-overlapping windows of length <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> base pairs and applies spline-based smoothing to the raw signal profile in each window (<xref rid="btz702-F1" ref-type="fig">Fig. 1</xref>, step 2, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). Although other smoothing approaches have been proposed (<xref rid="btz702-B14" ref-type="bibr">Harmanci <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btz702-B19" ref-type="bibr">Knijnenburg <italic toggle="yes">et al.</italic>, 2014</xref>), basis spline curves are advantageous because they do not rely on a model, they are flexible and they guarantee a continuous smoothed signal (<xref rid="btz702-B35" ref-type="bibr">Unser <italic toggle="yes">et al.</italic>, 1993</xref>).
</p>
      <fig position="float" id="btz702-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Illustration of the steps in EpiSAFARI algorithm. The input can be one of read coverage signal (bedGraph, wig, bigwig formatted) or mapped reads (sam formatted). The read coverage signal profile, <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mi>X</mml:mi></mml:math></inline-formula>, is smoothed using spline-based fitting in the second step. Smoothing computes the minimum least square fit of <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mi>X</mml:mi></mml:math></inline-formula> using the spline basis functions (<inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mi>B</mml:mi></mml:math></inline-formula>). The smoothed signal (<inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mi>S</mml:mi></mml:math></inline-formula>) is plotted with lightly colored original signal to illustrate the effect of smoothing. In third step, valleys are detected. Red and green dashed lines indicate the minima (dip) and maxima locations (summits), respectively. A valley is defined as a dip surrounded by two summits. The blow-up illustrates the summit positions (<inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula>) and the dip of a valley (<inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula>) and the signal level at these locations denoted by <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Next, the valleys are filtered with respect to distance between dip-to-summit distance (<inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) and the ratio between signal level at the summits to the dip (<inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>). The valleys that are removed are illustrated with grey shaded lines. In step 4, hill score, mappability and nucleotide content are assigned. In this step, multi-mappability profile and genome sequence are used as input. In the final step, statistical significance for the valleys are assigned. For each valley, the signal enrichment is estimated using binomial test for comparing the signal within <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> base pair vicinity of the summits compared to the signal around <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> base vicinity of the dip. The output from EpiSAFARI are the smoothed signal profiles (bedGraph formatted) and the valleys (bed formatted)</p>
        </caption>
        <graphic xlink:href="btz702f1" position="float"/>
      </fig>
      <p>The spline curves are defined by a set of ‘knots’ and the degree of the polynomial (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S1 and S2</xref>). The knots represent the positions where the polynomials meet such that the derivative of the curves are continuous up to the selected degree of the spline functions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). While knot positions affect the accuracy of spline-based smoothing, general knot selection is a complex and open problem (<xref rid="btz702-B13" ref-type="bibr">Foley and Nielson, 1989</xref>). We compared 3 different knot selection procedures using different knot numbers and observed that uniform knot selection performs comparably in terms of accuracy to the random knot selection, and derivative-based knot selection procedures (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). Since EpiSAFARI smooths signal with non-overlapping windows, the smoothing is performed for each window separately. We observed that uniform knot selection biases the detected valley dips periodically on the windows. When derivative or random knot selection is used, this bias is removed (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3i</xref>–k). However, we observed slight enrichment of valley dips at the ends of the windows. These biases are removed when overlapping windows are used for spline smoothing (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3l</xref>). For this, EpiSAFARI slides the windows with a stepping length that is smaller than window length. This way, each position is covered by multiple windows.</p>
      <p>The degree of the splines represents the degree of the polynomials that make up the basis curves. By default, EpiSAFARI uses splines of degree 5 with 7 knots. We observed that increasing (or decreasing) the spline degree or knot numbers may decrease valley detection accuracy because they may cause underfitting or overfitting in the smoothing process (See <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>). The spline degree and knot number parameters tune the complexity of smoothing and they can be changed by the user. After basis function generation, a linear minimum square error fit of the signal to the spline basis functions is computed.
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi mathvariant="italic">argmi</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>{</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mi>X</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="italic">Bc</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>}</mml:mo></mml:math></disp-formula>
 <disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:mi>S</mml:mi><mml:mo>=</mml:mo><mml:mi>B</mml:mi><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup></mml:math></disp-formula>where <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:mi>X</mml:mi></mml:math></inline-formula> represents the vector that contains the original signal profile in the current window, <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mi>B</mml:mi></mml:math></inline-formula> denotes the set of spline basis functions and <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">*</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> denotes the error minimizing weights. In order to decrease computational complexity, <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mi>X</mml:mi></mml:math></inline-formula> is formed by using the signal levels at points of interest in each window. The points of interest are selected as the positions where signal changes value. For sparse signals (e.g. WGBS-based DNA methylation), the points of interest are chosen such that only locations with non-zero signal values are selected. As the smoothing does not make any assumptions on the underlying signal, EpiSAFARI is applicable for analysis of the signal profiles generated diverse set of assays including microarray-based assays (<xref rid="btz702-B30" ref-type="bibr">Schumacher <italic toggle="yes">et al.</italic>, 2006</xref>). The window length parameter, <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, determines the number of points of interest and can impact accuracy (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4a</xref>–c).</p>
      <p>After smoothing, EpiSAFARI evaluates the maximum error among the points of interest. If the maximum error is higher than an anticipated error, EpiSAFARI increases the knot number and the spline degrees and re-iterates signal smoothing with the updated parameters. After all the windows on a chromosome are processed, they are concatenated to form the final smoothed profile. To ensure continuity of the signal, EpiSAFARI filters the concatenated signal profile using a median filter (of length <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">post</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> base pairs) that can be changed by the user. By default, EpiSAFARI sets <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">post</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> equal to 50 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4g</xref>).</p>
    </sec>
    <sec>
      <title>2.2 Valley detection</title>
      <p>After smoothing the signal profile, next step is detection of the local extrema, i.e. local minima and maxima. The local extrema are identified as the genomic coordinates where derivative changes sign:
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="{" close="|" separators="|"><mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="italic">d</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="italic">d</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="italic">i</mml:mi></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:math></disp-formula>
 <disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo>=</mml:mo><mml:mfenced open="{" close="|" separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mi>d</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi>d</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:math></disp-formula>
 <disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:mi>d</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></disp-formula>where <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denotes the smoothed signal value at <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">th</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> genomic position. In (3) ad (4), <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:math></inline-formula> and <inline-formula id="IE26"><mml:math id="IM26" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">M</mml:mi></mml:math></inline-formula> denotes the set of minima and maxima coordinates, respectively.</p>
      <p>The valleys are defined by a local minimum (i.e. dip) and two nearby maxima (i.e. summits) located upstream and downstream the dip (<xref rid="btz702-F1" ref-type="fig">Fig. 1</xref>, step 3). The candidate valleys satisfy following constraints:
<disp-formula id="E6"><label>(6)</label><mml:math id="M6" display="block" overflow="scroll"><mml:mi mathvariant="bold-italic">V</mml:mi><mml:mo>=</mml:mo><mml:mo>{</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal">|</mml:mi></mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mo> </mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mfenced open="{" close="}" separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>⊂</mml:mo><mml:mi mathvariant="bold-italic">M</mml:mi><mml:mo>,</mml:mo><mml:mo> </mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="bold-italic">μ</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mrow><mml:mrow><mml:mi mathvariant="normal">max</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mfenced open="|" close="|" separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo></mml:mrow></mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mi>m</mml:mi><mml:mi mathvariant="italic">in</mml:mi><mml:mo>⁡</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>}</mml:mo></mml:math></disp-formula>where <inline-formula id="IE27"><mml:math id="IM27" display="inline" overflow="scroll"><mml:mi mathvariant="bold-italic">V</mml:mi></mml:math></inline-formula> denotes the set of valleys, which are triplets of genomic positions <inline-formula id="IE28"><mml:math id="IM28" display="inline" overflow="scroll"><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:math></inline-formula>. <inline-formula id="IE29"><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula id="IE30"><mml:math id="IM30" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> denote the summit coordinates and <inline-formula id="IE31"><mml:math id="IM31" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula> denotes the position of valley’s dip between <inline-formula id="IE32"><mml:math id="IM32" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula id="IE33"><mml:math id="IM33" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> such that maximum (minimum) distance from <inline-formula id="IE34"><mml:math id="IM34" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula> and <inline-formula id="IE35"><mml:math id="IM35" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> to <inline-formula id="IE36"><mml:math id="IM36" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula> are bounded by <inline-formula id="IE37"><mml:math id="IM37" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> (<inline-formula id="IE38"><mml:math id="IM38" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>) parameter. This ensures that the summits are not very far from (or near to) the dip. In addition, the ratio of the signal levels at both summits to the dip are bounded below by <inline-formula id="IE39"><mml:math id="IM39" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> to ensure that there is difference between the signal levels at summits and signal at the dip. We set <inline-formula id="IE40"><mml:math id="IM40" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1.2</mml:mn></mml:math></inline-formula> for sensitive detection of valleys in the experiments (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4f</xref>).</p>
    </sec>
    <sec>
      <title>2.3 Assignment of hill scores</title>
      <p>For each valley, EpiSAFARI computes a quality score for the two ‘hills’ on each valley (<xref rid="btz702-F1" ref-type="fig">Fig. 1</xref>). A hill is the genomic region between the dip and the (left or right) summits. A good hill shows a monotonic increase between the dip and the summits (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5a</xref>). To measure this, EpiSAFARI computes the fraction of positions in the left and right hill where the signal is increasing (i.e. going up-hill) while moving away from the dip to the summit. Hill score is computed as
<disp-formula id="E7"><label>(7)</label><mml:math id="M7" display="block" overflow="scroll"><mml:mi>h</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">min</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>a</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>δ</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mi>d</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>a</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo>δ</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mi>d</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE41"><mml:math id="IM41" display="inline" overflow="scroll"><mml:mi>h</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>denotes the hill score and <inline-formula id="IE42"><mml:math id="IM42" display="inline" overflow="scroll"><mml:mo>δ</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mi>d</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced></mml:math></inline-formula> is an indicator function:
<disp-formula id="E8"><label>(8)</label><mml:math id="M8" display="block" overflow="scroll"><mml:mo>δ</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mi>d</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfenced open="{" close="" separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:maligngroup/><mml:mn>1</mml:mn><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="italic">if</mml:mi><mml:mo> </mml:mo><mml:mi>d</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:maligngroup/><mml:mn>0</mml:mn><mml:mo>;</mml:mo><mml:mo> </mml:mo><mml:mi mathvariant="italic">otherwise</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></disp-formula></p>
      <p>For a good valley, the hill score is close to 1.0, indicating that both hills to the left and right of the dip exhibit a monotonically increasing signal while moving away from the dip. If there are any segments with a down-hill trend, the hill score decreases (Step 4 in <xref rid="btz702-F1" ref-type="fig">Fig. 1</xref>). Using a high hill score cutoff increases the topological quality of valleys but may adversely impact sensitivity of the valley detection (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>). On the other hand, decreasing the cutoff causes the reported valleys to overlap with each other (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5b</xref>). We observed that the valleys with high qualities are separated in the distribution of the hill scores at the very high end of the distribution (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods, Supplementary Figs S5e–g and S6</xref>). We therefore use high hill score cutoff (0.90) to report only the valleys with high topological quality.</p>
      <p>The mappability of valleys is very important to distinguish valleys caused by low mappability versus the real valleys caused by biological signal fluctuation. For this, EpiSAFARI uses the precomputed multi-mappability signal (<xref rid="btz702-B14" ref-type="bibr">Harmanci <italic toggle="yes">et al.</italic>, 2014</xref>) profile. For each valley, EpiSAFARI computes the average and the maximum of the multi-mappability signal. In general, high multi-mappability corresponds to a low mappable region and these regions are filtered out in the downstream analysis.</p>
    </sec>
    <sec>
      <title>2.4 Assignment of statistical significance</title>
      <p>The next step is assignment of statistical significance to the detected valleys (<xref rid="btz702-F1" ref-type="fig">Fig. 1</xref>). By statistical significance, we refer to how significant the depletion of the signal at the dip is compared to the signal levels at the summits. Thus, valleys with low <italic toggle="yes">P</italic>-value correspond to deep valleys. The assigned <italic toggle="yes">P</italic>-values are used to sort the valleys while performing enrichment analysis.</p>
      <p>For a valley at <inline-formula id="IE43"><mml:math id="IM43" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>, EpiSAFARI first computes the signal around the vicinity of the dip and the summits using
<disp-formula id="E9"><label>(9)</label><mml:math id="M9" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mi>a</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E10"><label>(10)</label><mml:math id="M10" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mi>a</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E11"><label>(11)</label><mml:math id="M11" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>&lt;</mml:mo><mml:mi>a</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE44"><mml:math id="IM44" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE45"><mml:math id="IM45" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula id="IE46"><mml:math id="IM46" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> denote the average signal in the <inline-formula id="IE47"><mml:math id="IM47" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> base pair (100 base pairs by default) vicinity of the summits <inline-formula id="IE48"><mml:math id="IM48" display="inline" overflow="scroll"><mml:mi>i</mml:mi></mml:math></inline-formula>, <inline-formula id="IE49"><mml:math id="IM49" display="inline" overflow="scroll"><mml:mi>j</mml:mi></mml:math></inline-formula> and the dip <inline-formula id="IE50"><mml:math id="IM50" display="inline" overflow="scroll"><mml:mi>k</mml:mi></mml:math></inline-formula> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>). Next, EpiSAFARI computes the binomial <italic toggle="yes">P</italic>-value of enrichment of signal around summits compared to the dip:
<disp-formula id="E12"><label>(12)</label><mml:math id="M12" display="block" overflow="scroll"><mml:mi mathvariant="italic">bin</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>a</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>·</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula>
 <disp-formula id="E13"><label>(13)</label><mml:math id="M13" display="block" overflow="scroll"><mml:mi mathvariant="italic">bin</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:munderover><mml:mo stretchy="false">∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>a</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>·</mml:mo><mml:mfenced separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:math></disp-formula>where <inline-formula id="IE51"><mml:math id="IM51" display="inline" overflow="scroll"><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>a</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:math></inline-formula> number of combinations for selecting <inline-formula id="IE52"><mml:math id="IM52" display="inline" overflow="scroll"><mml:mi>a</mml:mi></mml:math></inline-formula> items within <inline-formula id="IE53"><mml:math id="IM53" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> items:
<disp-formula id="E14"><label>(14)</label><mml:math id="M14" display="block" overflow="scroll"><mml:mfenced separators="|"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>a</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:mfenced><mml:mo>!</mml:mo><mml:mo>·</mml:mo><mml:mi>a</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac></mml:math></disp-formula></p>
      <p>In order to assign the final <italic toggle="yes">P</italic>-value to the valley, we combine the <italic toggle="yes">P</italic>-values that are assigned to enrichment of the signal at the two summits. This process corresponds to combining the null models that are used to assign the two <italic toggle="yes">P</italic>-values for the observed summit-to-dip signal enrichment. We first use intersection of the null models as the joint null model (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7a</xref>). Assuming that the left and right hills are independent, this corresponds to the direct multiplication of the <italic toggle="yes">P</italic>-values:
<disp-formula id="E15"><label>(15)</label><mml:math id="M15" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi>p</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="italic">valu</mml:mi><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>∩</mml:mo></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="italic">bin</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">log</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced separators="|"><mml:mrow><mml:mi mathvariant="italic">bin</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math></disp-formula></p>
      <p><inline-formula id="IE54"><mml:math id="IM54" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo>-</mml:mo><mml:mi mathvariant="italic">valu</mml:mi><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>∩</mml:mo></mml:mrow></mml:msub></mml:math></inline-formula> denotes the <italic toggle="yes">P</italic>-value computed by intersection-based combination of the <italic toggle="yes">P</italic>-values assigned to observed summit-to-dip signal enrichment (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S7 and S8</xref>).</p>
      <p>After the <italic toggle="yes">P</italic>-values are assigned, the false discovery rate at which each valley would be deemed significant is estimated using Benjamini-Hochberg procedure (<xref rid="btz702-B3" ref-type="bibr">Benjamini, 2010</xref>).</p>
      <p>The valleys that EpiSAFARI detected may overlap with each other although we generally observed that the overlap between detected valleys tends to be very small. To ensure that a non-redundant set of minima are reported, EpiSAFARI filters out the valleys whose dips are close to each other by selecting the most significant valley (i.e. lowest <italic toggle="yes">P</italic>-value) around local minima positions. Finally, EpiSAFARI annotates valleys with respect to genes and transcription factor binding peaks. We created a GFF file from the transcription factor binding peak regions from ENCODE project (<xref rid="btz702-B11" ref-type="bibr">ENCODE Project Consortium, 2012</xref>), which contains the transcription factor peaks that are identified by 690 ChIP-Seq experiments performed on cell lines and uniformly processed by the ENCODE Project. The smoothed signal profiles can be used for visualizing the signal (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>).</p>
      <p>An important factor about detecting valleys is the required sequencing depth. For analyzing the required read depth, we used a high depth H3K4me3 ChIP-Sequencing data from NA12878 sample (<xref rid="btz702-B18" ref-type="bibr">Kasowski <italic toggle="yes">et al.</italic>, 2013</xref>) and identified valleys. We next computed the increase in the number of valleys with increasing read depth and the increase in the fraction of identified functional elements (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4i and j</xref>). We found that beyond 35-40 million reads, the valley detection does not provide substantial additional information.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Performance benchmarking</title>
      <p>We first focused on comparing the valleys detected by EpiSAFARI with the existing tools. While several studies have focused on analysis of valleys in different contexts, we found that PARE (<xref rid="btz702-B27" ref-type="bibr">Pundhir <italic toggle="yes">et al.</italic>, 2016</xref>) is available with implementation that can be used for comparison. In the comparison, we used the H3K4me3 histone modification ChIP-Seq data for NA12878 individual from the ENCODE Project (<xref rid="btz702-B11" ref-type="bibr">ENCODE Project Consortium, 2012</xref>). In general, H3K4me3 modification marks the promoters of the active genes. We have focused specifically on this modification because firstly it is a well-characterized mark and secondly PARE algorithm is tuned for analysis of this mark so that we are fair in comparison of the tools. We downloaded the two replicates that are available and pooled the reads from the replicates. PARE algorithm is run with default settings except that we extended the search space to 2000 base pairs (-v option) and we relaxed the FDR cutoff to 0.1 (-t option). For EpiSAFARI, we set the FDR cutoff to 0.05, filtered out the valleys with hill scores lower than 0.90. In general, we observed that EpiSAFARI identifies many more valleys compared to PARE. To make the comparison fair, we sorted the EpiSAFARI valleys with respect to increasing FDR (i.e. more significant first) and we sorted the PARE valleys with respect to decreasing score (i.e. higher score first) assigned by the algorithm. We then focused on the top 2000 valleys.</p>
      <p>Currently, ChIP-Seq datasets are analyzed primarily in terms of peaks. To include the peaks in the comparison, we identified the peaks for the H3K4me3 data using MUSIC (<xref rid="btz702-B14" ref-type="bibr">Harmanci <italic toggle="yes">et al.</italic>, 2014</xref>) and extracted the 200 base pair vicinity of the summits and used the summit regions in comparison with the valleys. Since we do not have a set of valleys that can directly serve as ground truth, we used different hypotheses to evaluate whether the identified valleys are biologically meaningful and used these to assess performance of methods.</p>
      <p>We first focused on comparison of transcription factor binding activity around the valleys. We hypothesized that the real valleys must be enriched in transcription factor binding. ENCODE project supplies a large number of ChIP-Seq experiments and uniformly processed peak calls for many transcription factors for NA12878 sample. We pooled the available peaks calls from the 90 ChIP-Seq experiments for NA12878 sample. We then evaluated the fraction of top valleys that overlap with a transcription factor peak. In order to correct for the valley lengths reported by the methods, we used the valleys that are reported by PARE as they are and we used only the 200 base pair vicinity of the valley dips (i.e. dip location ± 100 base pairs) reported by EpiSAFARI. <xref rid="btz702-F2" ref-type="fig">Figure 2a</xref> shows the fraction of top valleys (and summits) that overlap with a transcription factor peak while the number of top peaks is increased (x-axis). We observed that more than 90% of the top EpiSAFARI valleys that we evaluated overlap with a peak. The fraction of overlap decreases slowly as we increase the number of top valleys. PARE valleys, in contrast, show a fairly low overlap with a transcription factor peak (starting at 50%) and the overlap fraction increases as the number of top valleys is increased. Around 90% of the peak summits contain a transcription factor binding. This result indicates that the valleys (and the scores) detected by EpiSAFARI represent a better representative set of transcription factor activity compared to the other methods.
</p>
      <fig position="float" id="btz702-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Comparisons. Comparison of the top H3K4me3 valleys in NA12878 sample as detected by EpiSAFARI (blue), by PARE (red) and peak summit regions detected by MUSIC (green). (<bold>a</bold>) The fraction of top valleys and summits that overlap with a transcription factor peak. X-axis shows the number of top valleys (summits) and y-axis shows the fraction of valleys that overlap with a transcription factor peak. (<bold>b</bold>) The fraction of top valleys that overlap with a DNase peak. (<bold>c</bold>) The fraction of top valleys (summits) that overlap with an active promoter. (<bold>d</bold>) Overlap fraction of the of valleys detected from the two replicates of GM12878 H3K4me3 dataset. (<bold>e</bold>) The memory requirements of EpiSAFARI and PARE with increasing read depth. X-axis shows the total number of reads and y-axis shows the required maximum main memory in gigabytes. (<bold>f</bold>) The time requirements of EpiSAFARI and PARE. X-axis shows the total number of reads and y-axis shows the required wall time in seconds</p>
        </caption>
        <graphic xlink:href="btz702f2" position="float"/>
      </fig>
      <p>Another hypothesis about the valleys is that they are enriched in terms of open chromatin. To measure this, we downloaded the peaks of the DNase-1 hypersensitive site sequencing (DNase-Seq) data from the ENCODE project for NA12878 sample. These peaks represent the experimentally detected locations of genomic positions for accessible DNA. Similar to the previous comparison, we overlapped the top valleys detected by EpiSAFARI and PARE with the DNase peaks. <xref rid="btz702-F2" ref-type="fig">Figure 2b</xref> shows the fraction of top valleys that overlap with a DNase peak. Similar to previous analysis, we used the 200 bp vicinity of the valley dip for EpiSAFARI valleys for this comparison. We observed that EpiSAFARI valleys show a much higher overlap fraction to the DNase peaks compared to PARE and peak summits. In addition, PARE valleys also show an increasing overlap fraction with decreasing score while EpiSAFARI valleys show a slowly decreasing overlap fraction with decreasing significance. This result indicates that EpiSAFARI valleys are better representatives of the accessible DNA positions compared to the valleys detected by PARE. The peak summits exhibit around 50% overlap with the DNase peaks.</p>
      <p>We hypothesized that the top valleys of the H3K4me3 modification must be enriched in the active gene promoters. To identify the active gene promoters, we used the transcript expression quantifications from the ENCODE project for NA12878. We first identified the transcripts whose reported expression levels in terms of reads per kilobase per million mapped reads (RPKM) are higher than 0.05. We next extracted the 1000 base pair vicinity of the transcription start site of each transcript. These constitute the set of active promoters. We then overlapped the valleys with the active promoters and computed the fraction of top valleys that overlap with active promoters. <xref rid="btz702-F2" ref-type="fig">Figure 2c</xref> shows the overlap fraction of top valleys with active promoters. EpiSAFARI shows a fairly high overlap (higher than 90%) at the top valleys and decreases as the number of top valleys decrease. For the top 2000 valleys, the overlap is always higher than 80%. The top valleys identified by PARE show 50% overlap with active promoters and the overlap increases as the number of top valleys is increased. The peak summits show around 90% overlap with the active promoter regions. This result shows that EpiSAFARI valleys capture the active promoter information better than PARE while detecting valleys. In comparison to peak summits, EpiSAFARI valleys exhibit higher accuracy for top 2000 valleys. We also compared the reproducibility of the valleys (and summits) identified by the methods. For this, we randomly divided the reads for NA12878 H3K4me3 to generate 2 replicates. We identified the valleys using EpiSAFARI and PARE and the peaks using MUSIC. We finally compared the replicates and computed the average consistency among identified valleys and summits. <xref rid="btz702-F4" ref-type="fig">Figure 4d</xref> shows the replicate overlap for the top valleys and peak summits. All the methods show low replicate consistency for the top elements and consistency increases up to 50% as top element number is increased. In comparison, EpiSAFARI valleys (and peak summits) exhibit higher replicate consistency compared to PARE valleys. We also compared the run time and main memory requirements of EpiSAFARI and PARE (<xref rid="btz702-F2" ref-type="fig">Fig. 2e and f</xref>). We found that PARE uses less memory than EpiSAFARI and EpiSAFARI has lower run time requirements.</p>
    </sec>
    <sec>
      <title>3.2 Histone valleys are enriched in functional activity</title>
      <p>We next computed the average conservation on the valleys identified by EpiSAFARI. To measure the conservation around the valleys, we aggregated the PhyloP conservation score (<xref rid="btz702-B20" ref-type="bibr">Kuhn <italic toggle="yes">et al.</italic>, 2013</xref>) around the 20 000 base pair vicinity of the reported dips of the valleys (<xref rid="btz702-F3" ref-type="fig">Fig. 3a</xref>). There is a substantial increase in the average conservation signal around the valley dip and conservation decreases with increasing distance to the dip. We also found that the valleys that do not overlap with H3K4me3 peaks (or with promoters) show increased conservation compared to random regions (<xref rid="btz702-F3" ref-type="fig">Fig. 3a</xref>). These valleys potentially represent the novel elements that EpiSAFARI identified that could have been missed by peak callers.
</p>
      <fig position="float" id="btz702-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Conservation and Transcription around Histone Valleys. (<bold>a</bold>) Average conservation within 20 000 base pairs of the valley dips. X-axis shows the distance from the dip and y-axis shows the average PhyloP conservation score. The conservation around all valleys (blue), valleys that do not overlap with any H3K4me3 peaks (red), valleys that do not overlap with neither promoters nor peaks (cyan) and randomized regions (green) are shown. (<bold>b</bold>) The aggregation of GRO-Seq signal within 20 000 base pairs of left-to-right valleys (blue) and random regions (green). The bottom illustration points out the fact that left summit is taller than right summit. (<bold>c</bold>) The aggregation of GRO-Seq signal within 20 000 base pairs of right-to-left valleys where right summits are taller than left summits</p>
        </caption>
        <graphic xlink:href="btz702f3" position="float"/>
      </fig>
      <p>We also hypothesized that the valleys as detected by EpiSAFARI may contain cis-regulatory elements such as promoters and enhancers (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>). One line of evidence for existence of these elements is the nascent transcription at the valleys. To study this, we used the global run-on sequencing (GRO-Seq) data for NA12878 sample (See Data Availability). GRO-Seq data represent the genome-wide measurement of nascent transcription, i.e. RNA that has just been transcribed (or being transcribed) at each location in the genome (<xref rid="btz702-B6" ref-type="bibr">Core <italic toggle="yes">et al.</italic>, 2008</xref>). We observed that there is an increased GRO-Seq signal on both positive and negative strands around the dip of the valley (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10a and b</xref>).</p>
      <p>An important observation about the valleys is that valleys may show asymmetry with respect to the signal levels at the left and right summit positions and this relates to transcriptional activity (<xref rid="btz702-B21" ref-type="bibr">Kundaje <italic toggle="yes">et al.</italic>, 2012</xref>). In order to study the relation between valley shape asymmetry and transcriptional activity around the valleys, we divided the valleys into two groups. First group, we call left-to-right valleys (Bottom illustration in <xref rid="btz702-F3" ref-type="fig">Fig. 3b</xref>), have higher signal on the left summit compared to right summit. Second group, right-to-left valleys, (Bottom illustration in <xref rid="btz702-F3" ref-type="fig">Fig. 3c</xref>) contains higher signal on the right summit compared to the left summit. <xref rid="btz702-F3" ref-type="fig">Figure 3b and c</xref> shows the average GRO-Seq signal around the 20 000 base pairs vicinity of the valley dips for left-to-right and right-to-left valleys, respectively. For left-to-right valleys, there is a sharp peak on the negative strand signal to the left of the dip position. The positive signal, while still high, does not show a corresponding sharp peak. In other words, left-to-right valleys are enriched in terms of negatively oriented nascent transcription. Similar pattern is seen for the right-to-left valleys (<xref rid="btz702-F3" ref-type="fig">Fig. 3c</xref>) albeit on the positive strand. Overall, these results provide supporting evidence that the valleys detected by EpiSAFARI contain genomic elements of potential functional role. Furthermore, the valleys’ asymmetry can delineate the directionality of transcriptional activity around them.</p>
      <p>An important downstream analysis is comparison of valleys from two samples. We studied the ‘differential valley detection’ to identify the valleys that are specific to samples under different conditions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S13a</xref>). To compare the valleys from two samples (e.g. cell lines with different treatments) and to identify valleys specific to first sample, we first pool the valleys identified in the two samples. We next compute the difference profile by subtracting the signal profile for second sample from that of the first sample. This profile quantifies enrichment of signal at the valleys when sample 1 is compared to sample 2. Finally, we compute the significance of each of the pooled valleys using the difference profile (<xref rid="sup1" ref-type="supplementary-material">Supplementary Material</xref>). We compared the valleys from NA12878 and K562 cell lines, and identified the NA12878 and K562 specific valleys. To characterize the sample specific valleys, we analyzed the DNase signal from both cell lines and computed the fold-change at the cell line specific valleys. This analysis revealed that cell line specific valleys show significantly increased DNase signal (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S13b and c</xref>) compared to all valleys.</p>
    </sec>
    <sec>
      <title>3.3 Methyl-valleys are enriched in chromatin structure associated transcription factor binding</title>
      <p>As another application of EpiSAFARI, we next focused on analysis of the valleys in the DNA methylation signal of H1 embryonic stem cell line (H1hESC) measured by the whole genome bisulfite sequencing (WGBS) data from Roadmap Epigenome Project. The valleys in DNA methylation signals have been shown to contribute to important biological phenomena (<xref rid="btz702-B17" ref-type="bibr">Jeong <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btz702-B22" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2018</xref>). We first downloaded the processed the WGBS signal profile from Roadmap Epigenome Project (<xref rid="btz702-B28" ref-type="bibr">Romanoski <italic toggle="yes">et al.</italic>, 2015</xref>). This signal profile measures the fraction of methylated versus non-methylated cytosine residues at the CpG di-nucleotides. We identified valleys in DNA methylation signal, i.e. methyl-valleys, using sparse mode of EpiSAFARI. In valley detection, we set <inline-formula id="IE55"><mml:math id="IM55" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">min</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:math></inline-formula>, <inline-formula id="IE56"><mml:math id="IM56" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">max</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="normal"> </mml:mi><mml:mn>000</mml:mn></mml:math></inline-formula> and excluded the valleys that contain less than 20 CpG di-nucleotides as these may correspond to valleys with very sparse signals. While smoothing DNA methylation signals, <inline-formula id="IE57"><mml:math id="IM57" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>5000</mml:mn></mml:math></inline-formula> is used (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4k–n</xref>).</p>
      <p>The methyl-valleys generally show elevated conservation (<xref rid="btz702-F4" ref-type="fig">Fig. 4a</xref>) compared to their surroundings. We overlapped the valleys with the transcription factor ChIP-Seq peaks for H1hESC cell line. The top methyl-valleys (including valleys that do not overlap promoters) are highly enriched in terms of transcription factor binding peaks (<xref rid="btz702-F4" ref-type="fig">Fig. 4b</xref>). We next identified the fraction of transcription factors whose peaks overlap with the top 1000 valleys (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref>). Large fraction of methyl-valleys overlaps with transcription factors such as CTCF (60%), Rad21 (50%) and Znf143 (50%), which are known regulators of three-dimensional chromatin structure (<xref rid="btz702-F4" ref-type="fig">Fig. 4c</xref>). A similar result has been reported in another study (<xref rid="btz702-B23" ref-type="bibr">Lin <italic toggle="yes">et al.</italic>, 2017</xref>) where the authors show that chromatin structure associated transcription factors are enriched in undermethylated regions. We also used EpiSAFARI to detect the methyl-valleys for NA12878 cell line using a publicly available dataset (See Data Availability). While we did observe that the top methyl-valleys are enriched in transcription factor binding (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12a</xref>), we did not observe the enrichment of the chromatin structure associated transcription factors (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 12b</xref>). These results provide evidence that the stratification of the transcription factor binding on the valleys can provide biological insight in epigenetic data analysis.
</p>
      <fig position="float" id="btz702-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>Conservation and Transcription around Histone Valleys. (<bold>a</bold>) Characterization of the methyl-valleys. (a) Conservation around the 20 000 base pair vicinity of the dips of methyl-valleys as reported by EpiSAFARI. All valleys (blue), valleys that do not overlap with promoters (red) and random regions (green) are shown. (<bold>b</bold>) The fraction of the top methyl-valleys that overlap with a H1hESC transcription factor binding peaks. X-axis shows the top number of valleys and y-axis shows the fraction of valleys that overlap with at least one transcription factor peak. (<bold>c</bold>) Heatmap of the transcription factor binding on the top 1000 methyl-valleys. Each row is a methyl-valley and each column is a transcription factor. Within a row, white color indicates an overlap with the valley corresponding to the row and the peaks of the transcription factor that is corresponding to the column. Red indicates no overlap between the transcription factor’s peaks and the valley. The rows and columns are sorted by hierarchical clustering</p>
        </caption>
        <graphic xlink:href="btz702f4" position="float"/>
      </fig>
    </sec>
    <sec>
      <title>3.4 Supervalleys are enriched at promoters of developmental genes in embryonic stem cell line</title>
      <p>It was previously shown that the broad domains of histone modification enrichments may represent super-enhancer regions (<xref rid="btz702-B26" ref-type="bibr">Pott and Lieb, 2015</xref>), which are associated with important biological phenomena such as cancer initiation. In addition, several studies showed that the broad H3K4me3 peaks are enriched around genes with certain biological roles (<xref rid="btz702-B2" ref-type="bibr">Benayoun <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btz702-B8" ref-type="bibr">Dincer <italic toggle="yes">et al.</italic>, 2015</xref>). We overlapped the H3K4me3 valleys for H1hESC cell line with the promoters and we identified the top 500 genes whose promoters overlap with highest number of valleys (<xref rid="btz702-F5" ref-type="fig">Fig. 5a</xref>), which we refer to as supervalleys. Interestingly, these genes are significantly related to development, differentiation and DNA binding (<xref rid="btz702-F5" ref-type="fig">Fig. 5b</xref>). Consequently, the clustering of the valleys with respect to proximity in genomic coordinates may be an indicator of elements with important biological functions. When we performed the supervalley analysis using H3K4me3 valleys of NA12878 cell line, we did not find any significant functional category.
</p>
      <fig position="float" id="btz702-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Functional enrichment of the genes whose promoters overlap with supervalleys. (<bold>a</bold>) Illustration of a simple valley and a H3K4me3 supervalley. The simple valley consists of a double-peak pattern with a valley in it. The supervalleys contain many consecutive valleys that are clustered within a small genomic distance. Block diagram below illustrates the detection of supervalleys on promoters. The valleys are assigned to gene promoters such that a promoter is defined as the 20 kb vicinity of the transcription start site (TSS). The genes whose promoters overlap with the largest number of valleys are identified. The top 500 genes are used in gene ontology enrichment. (<bold>b</bold>) The most significant 10 GO terms (x-axis) that are detected from ontology enrichment as sorted with respect to enrichment false discovery rate (y-axis)</p>
        </caption>
        <graphic xlink:href="btz702f5" position="float"/>
      </fig>
    </sec>
  </sec>
  <sec>
    <title>4. Discussion</title>
    <p>We presented EpiSAFARI as a new method for detecting the valleys in epigenetic signal profiles. One of the main challenges related to the valley-centric analysis of epigenetic data is concretizing the definition ‘valley calling’ process. EpiSAFARI treats the valleys to be dips in the signal that are between two summits but this definition could potentially be revised to ensure that the valleys represent the functionally most meaningful regions. Another limitation that we have faced is defining quality metrics for the detected valleys. The hill score aims to measure the valley quality but we observed that it may be affected to a certain extent by the signal smoothing parameters. More robust measures of valley quality can elucidate the valley quality. Another challenge is defining statistical models for valley calling. Although we evaluated several statistical models that evaluate the significance of the valleys, the definition of statistical significance of valleys should be studied in more detail.</p>
    <p>Several previous methods have utilized valleys in different contexts. These methods rely on smoothing of signal using kernel-based approaches [such as Gaussian (<xref rid="btz702-B19" ref-type="bibr">Knijnenburg <italic toggle="yes">et al.</italic>, 2014</xref>) and wavelet filtering (<xref rid="btz702-B1" ref-type="bibr">Audit <italic toggle="yes">et al.</italic>, 2013</xref>)] or modeling of the read clusters (such as PARE). In comparison, EpiSAFARI is advantageous to these methods for two reasons. Firstly, EpiSAFARI incorporates mappability and nucleotide content in filtering of the detected valleys. As we have demonstrated, these factors may create false positive valleys. Secondly, the kernel smoothing-based methods may fail to smooth sparse signals (such as DNA methylation) because smoothing of sparse signals will introduce many false positive valleys. On the other hand, EpiSAFARI computes an interpolation of the sparse signal to efficiently build a continuous smoothing of the sparse signals. Thus, the spline-based modeling of EpiSAFARI separates it from previous methods for modeling of both continuous and sparse signal profiles. EpiSAFARI utilizes a parametric spline-based strategy to smooth the signal before detection of the valleys. We studied extensively the impact of the parameters on valley detection accuracy. While knot selection may slightly bias results, these can be mitigated by using overlapping windows.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btz702_Supplementary_Data</label>
      <media xlink:href="btz702_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>None.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by National Institutes of Health of The United States grant 5R01NS079715 to VG.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz702-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Audit</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Multiscale analysis of genome-wide replication timing profiles using a wavelet-based signal-processing algorithm</article-title>. <source>Nat. Protoc</source>., <volume>8</volume>, <fpage>98</fpage>–<lpage>110</lpage>.<pub-id pub-id-type="pmid">23237832</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benayoun</surname><given-names>B.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>H3K4me3 breadth is linked to cell identity and transcriptional consistency</article-title>. <source>Cell</source>, <volume>158</volume>, <fpage>673</fpage>–<lpage>688</lpage>.<pub-id pub-id-type="pmid">25083876</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benjamini</surname><given-names>Y.</given-names></string-name></person-group> (<year>2010</year>) 
<article-title>Discovering the false discovery rate</article-title>. <source>J. R. Stat. Soc. Ser. B</source>, <volume>72</volume>, <fpage>405</fpage>–<lpage>416</lpage>.</mixed-citation>
    </ref>
    <ref id="btz702-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benjamini</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Speed</surname><given-names>T.P.</given-names></string-name></person-group> (<year>2012</year>) 
<article-title>Summarizing and correcting the GC content bias in high-throughput sequencing</article-title>. <source>Nucleic Acids Res</source>., <volume>40</volume>, <fpage>e72</fpage>.<pub-id pub-id-type="pmid">22323520</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buenrostro</surname><given-names>J.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Transposition of native chromatin for fast and sensitive epigenomic profiling of open chromatin, DNA-binding proteins and nucleosome position</article-title>. <source>Nat. Methods</source>, <volume>10</volume>, <fpage>1213</fpage>–<lpage>1218</lpage>.<pub-id pub-id-type="pmid">24097267</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Core</surname><given-names>L.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) 
<article-title>Nascent RNA sequencing reveals widespread pausing and divergent initiation at human promoters</article-title>. <source>Science</source>, <volume>322</volume>, <fpage>1845</fpage>–<lpage>1848</lpage>.<pub-id pub-id-type="pmid">19056941</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Denny</surname><given-names>J.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Phenome-wide association studies as a tool to advance precision medicine</article-title>. <source>Annu. Rev. Genomics Hum. Genet</source>., <volume>17</volume>, <fpage>353</fpage>–<lpage>373</lpage>.<pub-id pub-id-type="pmid">27147087</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dincer</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>Deciphering H3K4me3 broad domains associated with gene-regulatory networks and conserved epigenomic landscapes in the human brain</article-title>. <source>Transl. Psychiatry</source>, <volume>5</volume>, <fpage>e679.</fpage><pub-id pub-id-type="pmid">26575220</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dong</surname><given-names>X.</given-names></string-name>, <string-name><surname>Weng</surname><given-names>Z.</given-names></string-name></person-group> (<year>2013</year>) 
<article-title>The correlation between histone modifications and gene expression</article-title>. <source>Epigenomics</source>, <volume>5</volume>, <fpage>113</fpage>–<lpage>116</lpage>.<pub-id pub-id-type="pmid">23566087</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dorschner</surname><given-names>M.O.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) 
<article-title>Sequencing newly replicated DNA reveals widespread plasticity in human replication timing</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>107</volume>, <fpage>139</fpage>–<lpage>144</lpage>.<pub-id pub-id-type="pmid">19966280</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B11">
      <mixed-citation publication-type="journal">ENCODE Project Consortium. (<year>2012</year>) 
<article-title>An integrated encyclopedia of DNA elements in the human genome</article-title>. <source>Nature</source>, <volume>489</volume>, <fpage>57</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">22955616</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Esteller</surname><given-names>M.</given-names></string-name></person-group> (<year>2008</year>) 
<article-title>Epigenetics in Cancer</article-title>. <source>N. Engl. J. Med</source>., <volume>358</volume>, <fpage>1148</fpage>–<lpage>1159</lpage>.<pub-id pub-id-type="pmid">18337604</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B13">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Foley</surname><given-names>T.A.</given-names></string-name>, <string-name><surname>Nielson</surname><given-names>G.M.</given-names></string-name></person-group> (<year>1989</year>) Knot selection for parametric spline interpolation. In: <italic toggle="yes">Mathematical Methods in Computer Aided Geometric Design</italic>, pp. <fpage>261</fpage>–<lpage>271</lpage>.</mixed-citation>
    </ref>
    <ref id="btz702-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harmanci</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>MUSIC: identification of enriched regions in ChIP-Seq experiments using a mappability-corrected multiscale signal processing framework</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>474.</fpage><pub-id pub-id-type="pmid">25292436</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hasin</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>Multi-omics approaches to disease</article-title>. <source>Genome Biol</source>., <volume>18</volume>.</mixed-citation>
    </ref>
    <ref id="btz702-B16">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Jeong</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) A Cell type-specific Class of Chromatin Loops Anchored at Large DNA Methylation Nadirs. <italic toggle="yes">bioRxiv</italic>, 212928.</mixed-citation>
    </ref>
    <ref id="btz702-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jeong</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>Large conserved domains of low DNA methylation maintained by Dnmt3a</article-title>. <source>Nat. Genet</source>., <volume>46</volume>, <fpage>17</fpage>–<lpage>23</lpage>.<pub-id pub-id-type="pmid">24270360</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kasowski</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Extensive variation in chromatin states across humans</article-title>. <source>Science (New York, NY)</source>, <volume>342</volume>, <fpage>750</fpage>–<lpage>752</lpage>.</mixed-citation>
    </ref>
    <ref id="btz702-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Knijnenburg</surname><given-names>T.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>Multiscale representation of genomic signals</article-title>. <source>Nat. Methods</source>, <fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
    </ref>
    <ref id="btz702-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kuhn</surname><given-names>R.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>The UCSC genome browser and associated tools</article-title>. <source>Brief. Bioinform</source>., <volume>14</volume>, <fpage>144</fpage>–<lpage>161</lpage>.<pub-id pub-id-type="pmid">22908213</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kundaje</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) 
<article-title>Ubiquitous heterogeneity and asymmetry of the chromatin environment at regulatory elements</article-title>. <source>Genome Res</source>., <volume>22</volume>, <fpage>1735</fpage>–<lpage>1747</lpage>.<pub-id pub-id-type="pmid">22955985</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Genome-wide analyses reveal a role of Polycomb in promoting hypomethylation of DNA methylation valleys</article-title>. <source>Genome Biol</source>., <volume>19</volume>.</mixed-citation>
    </ref>
    <ref id="btz702-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>Sparse conserved under-methylated CpGs are associated with high-order chromatin structure</article-title>. <source>Genome Biol</source>., <volume>18</volume>, <fpage>163.</fpage><pub-id pub-id-type="pmid">28859663</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Madrigal</surname><given-names>P.</given-names></string-name>, <string-name><surname>Krajewski</surname><given-names>P.</given-names></string-name></person-group> (<year>2012</year>) 
<article-title>Current bioinformatic approaches to identify DNase I hypersensitive sites and genomic footprints from DNase-seq data</article-title>. <source>Front. Genet</source>., <volume>3</volume>, <fpage>230</fpage>.<pub-id pub-id-type="pmid">23118738</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McVicker</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Identification of genetic variants that affect histone modifications in human cells</article-title>. <source>Science (New York, NY)</source>, <volume>342</volume>, <fpage>747</fpage>–<lpage>749</lpage>.</mixed-citation>
    </ref>
    <ref id="btz702-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pott</surname><given-names>S.</given-names></string-name>, <string-name><surname>Lieb</surname><given-names>J.D.</given-names></string-name></person-group> (<year>2015</year>) 
<article-title>What are super-enhancers?</article-title>  <source>Nat. Genet</source>., <volume>47</volume>, <fpage>8</fpage>–<lpage>12</lpage>.<pub-id pub-id-type="pmid">25547603</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pundhir</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Peak-valley-peak pattern of histone modifications delineates active regulatory elements and their directionality</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>4037</fpage>–<lpage>4051</lpage>.<pub-id pub-id-type="pmid">27095194</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Romanoski</surname><given-names>C.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>Epigenomics: roadmap for regulation</article-title>. <source>Nature</source>, <volume>518</volume>, <fpage>314</fpage>–<lpage>316</lpage>.<pub-id pub-id-type="pmid">25693562</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rozowsky</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) 
<article-title>PeakSeq enables systematic scoring of ChIP-seq experiments relative to controls</article-title>. <source>Nat. Biotechnol</source>., <volume>27</volume>, <fpage>66</fpage>–<lpage>75</lpage>.<pub-id pub-id-type="pmid">19122651</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schumacher</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2006</year>) 
<article-title>Microarray-based DNA methylation profiling: technology and applications</article-title>. <source>Nucleic Acids Res</source>., <volume>34</volume>, <fpage>528</fpage>–<lpage>542</lpage>.<pub-id pub-id-type="pmid">16428248</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B31">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Sethi</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) A cross-organism framework for supervised enhancer prediction with epigenetic pattern recognition and targeted validation. <italic toggle="yes">bioRxiv</italic>, 385237.</mixed-citation>
    </ref>
    <ref id="btz702-B32">
      <mixed-citation publication-type="journal">Sharing Epigenomes Globally (<year>2018</year>) Editorial. <source>Nat. Methods</source>, <volume>15</volume>, <fpage>151</fpage>.</mixed-citation>
    </ref>
    <ref id="btz702-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Histone acetylome-wide association study of autism spectrum disorder</article-title>. <source>Cell</source>, <volume>167</volume>, <fpage>1385</fpage>–<lpage>1397.e11</lpage>.<pub-id pub-id-type="pmid">27863250</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thomas</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>Features that define the best ChIP-seq peak calling algorithms</article-title>. <source>Brief. Bioinform</source>, <volume>18</volume>, <fpage>441</fpage>–<lpage>450</lpage>.<pub-id pub-id-type="pmid">27169896</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Unser</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1993</year>) 
<article-title>B-spline signal processing. I. Theory</article-title>. <source>IEEE Trans. Signal Process</source>, <volume>41</volume>, <fpage>821</fpage>–<lpage>833</lpage>.</mixed-citation>
    </ref>
    <ref id="btz702-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xie</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Epigenomic analysis of multilineage differentiation of human embryonic stem cells</article-title>. <source>Cell</source>, <volume>153</volume>, <fpage>1134</fpage>–<lpage>1148</lpage>.<pub-id pub-id-type="pmid">23664764</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) 
<article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>. <source>Genome Biol</source>., <volume>9</volume>, <fpage>R137.</fpage><pub-id pub-id-type="pmid">18798982</pub-id></mixed-citation>
    </ref>
    <ref id="btz702-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Reinberg</surname><given-names>D.</given-names></string-name></person-group> (<year>2001</year>) 
<article-title>Transcription regulation by histone methylation: interplay between different covalent modifications of the core histone tails</article-title>. <source>Genes Dev</source>., <volume>15</volume>, <fpage>2343</fpage>–<lpage>2360</lpage>.<pub-id pub-id-type="pmid">11562345</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
