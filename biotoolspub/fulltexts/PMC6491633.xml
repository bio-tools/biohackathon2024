<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Front Genet</journal-id>
    <journal-id journal-id-type="iso-abbrev">Front Genet</journal-id>
    <journal-id journal-id-type="publisher-id">Front. Genet.</journal-id>
    <journal-title-group>
      <journal-title>Frontiers in Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1664-8021</issn>
    <publisher>
      <publisher-name>Frontiers Media S.A.</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6491633</article-id>
    <article-id pub-id-type="doi">10.3389/fgene.2019.00350</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Genetics</subject>
        <subj-group>
          <subject>Original Research</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>An Adaptive Multivariate Two-Sample Test With Application to Microbiome Differential Abundance Analysis</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Banerjee</surname>
          <given-names>Kalins</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/668173/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhao</surname>
          <given-names>Ni</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/685248/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Srinivasan</surname>
          <given-names>Arun</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/712282/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xue</surname>
          <given-names>Lingzhou</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/685236/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hicks</surname>
          <given-names>Steven D.</given-names>
        </name>
        <xref ref-type="aff" rid="aff4">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Middleton</surname>
          <given-names>Frank A.</given-names>
        </name>
        <xref ref-type="aff" rid="aff5">
          <sup>5</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/152955/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wu</surname>
          <given-names>Rongling</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/29737/overview"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhan</surname>
          <given-names>Xiang</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="c001">
          <sup>*</sup>
        </xref>
        <uri xlink:type="simple" xlink:href="http://loop.frontiersin.org/people/628873/overview"/>
      </contrib>
    </contrib-group>
    <aff id="aff1"><sup>1</sup><institution>Department of Public Health Sciences, Pennsylvania State University</institution>, <addr-line>Hershey, PA</addr-line>, <country>United States</country></aff>
    <aff id="aff2"><sup>2</sup><institution>Department of Biostatistics, Johns Hopkins University</institution>, <addr-line>Baltimore, MD</addr-line>, <country>United States</country></aff>
    <aff id="aff3"><sup>3</sup><institution>Department of Statistics, Pennsylvania State University</institution>, <addr-line>University Park, PA</addr-line>, <country>United States</country></aff>
    <aff id="aff4"><sup>4</sup><institution>Department of Pediatrics, Pennsylvania State University</institution>, <addr-line>Hershey, PA</addr-line>, <country>United States</country></aff>
    <aff id="aff5"><sup>5</sup><institution>Department of Neuroscience, State University of New York Upstate Medical University</institution>, <addr-line>Syracuse, NY</addr-line>, <country>United States</country></aff>
    <author-notes>
      <fn fn-type="edited-by">
        <p>Edited by: Lingling An, University of Arizona, United States</p>
      </fn>
      <fn fn-type="edited-by">
        <p>Reviewed by: Michael B. Sohn, University of Rochester, United States; Hongmei Jiang, Northwestern University, United States</p>
      </fn>
      <corresp id="c001">*Correspondence: Xiang Zhan <email>xyz5074@psu.edu</email></corresp>
      <fn fn-type="other" id="fn001">
        <p>This article was submitted to Statistical Genetics and Methodology, a section of the journal Frontiers in Genetics</p>
      </fn>
    </author-notes>
    <pub-date pub-type="epub">
      <day>24</day>
      <month>4</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>10</volume>
    <elocation-id>350</elocation-id>
    <history>
      <date date-type="received">
        <day>08</day>
        <month>1</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>01</day>
        <month>4</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2019 Banerjee, Zhao, Srinivasan, Xue, Hicks, Middleton, Wu and Zhan.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <copyright-holder>Banerjee, Zhao, Srinivasan, Xue, Hicks, Middleton, Wu and Zhan</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Differential abundance analysis is a crucial task in many microbiome studies, where the central goal is to identify microbiome taxa associated with certain biological or clinical conditions. There are two different modes of microbiome differential abundance analysis: the individual-based univariate differential abundance analysis and the group-based multivariate differential abundance analysis. The univariate analysis identifies differentially abundant microbiome taxa subject to multiple correction under certain statistical error measurements such as false discovery rate, which is typically complicated by the high-dimensionality of taxa and complex correlation structure among taxa. The multivariate analysis evaluates the overall shift in the abundance of microbiome composition between two conditions, which provides useful preliminary differential information for the necessity of follow-up validation studies. In this paper, we present a novel <bold>A</bold>daptive multivariate two-sample test for <bold>M</bold>icrobiome <bold>D</bold>ifferential <bold>A</bold>nalysis (<bold>AMDA</bold>) to examine whether the composition of a taxa-set are different between two conditions. Our simulation studies and real data applications demonstrated that the AMDA test was often more powerful than several competing methods while preserving the correct type I error rate. A free implementation of our AMDA method in R software is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/xyz5074/AMDA">https://github.com/xyz5074/AMDA</ext-link>.</p>
    </abstract>
    <kwd-group>
      <kwd>adaptive microbiome differential analysis (AMDA)</kwd>
      <kwd>maximum mean discrepancy (MMD)</kwd>
      <kwd>multivariate two-sample test</kwd>
      <kwd>permutation</kwd>
      <kwd>subset testing</kwd>
      <kwd>taxa-set</kwd>
    </kwd-group>
    <counts>
      <fig-count count="3"/>
      <table-count count="2"/>
      <equation-count count="3"/>
      <ref-count count="48"/>
      <page-count count="11"/>
      <word-count count="8087"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="s1">
    <title>1. Introduction</title>
    <p>The human microbiome, referred as the aggregate of microorganisms that resides on or within any human tissues and biofluids, has recently gained substantial scientific interest due to its vital role in many human health and disease conditions, including but are not limited to obesity (Turnbaugh et al., <xref rid="B36" ref-type="bibr">2009</xref>), type 2 diabetes (Qin et al., <xref rid="B30" ref-type="bibr">2012</xref>), rheumatoid arthritis (Zhang et al., <xref rid="B46" ref-type="bibr">2015</xref>), inflammatory bowel disease (Morgan et al., <xref rid="B26" ref-type="bibr">2015</xref>), bacterial vaginosis (Mitchell et al., <xref rid="B25" ref-type="bibr">2017</xref>), and colorectal cancer (Louis et al., <xref rid="B22" ref-type="bibr">2014</xref>). High-throughput sequencing technologies have revolutionized microbiome research by allowing culture-free profiling of entire microbiome community. For the most part, 16S rRNA gene amplicon sequencing and metagenomics shotgun sequencing are routinely used for quantitative characterization of microbiome composition (Wang and Jia, <xref rid="B38" ref-type="bibr">2016</xref>). Although data produced by high-throughput sequencing has been proven extremely useful for quantification of microbiome composition, yet appropriate analysis of such microbiome composition data is still computationally and statistically challenging due to some technical aspects of the data, including high-dimensionality, count or compositional data structure, sparsity (zero-inflation), over-dispersion, among others.</p>
    <p>In many microbiome studies, the investigators are often interested in studying how the abundance of microbiome is related with clinical characteristics of the samples, such as health/disease status, smoking status, or dietary habit (high-calorie or low-calorie). That is, many studies attempt to detect differentially abundant microbiome features (species/OTUs) between two predefined classes of samples, where a microbiome feature is considered differentially abundant, if its mean proportion is significantly different between two conditions. This type of analysis can improve understanding the pathology of the disease from a microbiome perspective and potentially lead to preventive or therapeutic strategies (Virgin and Todd, <xref rid="B37" ref-type="bibr">2011</xref>). Microbiome differential abundance analysis (MDA) is a direct analogy to differential expression analysis for gene expression and RNA-seq data, however, the distinct nature of microbiome data renders classic differential expression analysis methods such as DESeq (Anders and Huber, <xref rid="B3" ref-type="bibr">2010</xref>) and edgeR (Robinson et al., <xref rid="B31" ref-type="bibr">2010</xref>) inappropriate for microbiome data (McMurdie and Holmes, <xref rid="B24" ref-type="bibr">2014</xref>; Weiss et al., <xref rid="B39" ref-type="bibr">2017</xref>). Thus, new statistical methods for microbiome differential abundance analysis are desired.</p>
    <p>Similar to individual gene-based and pathway-based differential expression analysis, there are two types of microbiome differential analyses: individual taxon-based univariate analysis and taxa set-based multivariate analysis. Along with the recent huge scientific interest in microbiome studies, many statistical methods for microbiome differential analysis have also been proposed (Sohn et al., <xref rid="B32" ref-type="bibr">2015</xref>; Zhao et al., <xref rid="B47" ref-type="bibr">2015</xref>; Zhang et al., <xref rid="B45" ref-type="bibr">2016</xref>; Chen et al., <xref rid="B14" ref-type="bibr">2017</xref>), with most of them focus on examining whether a single taxon is differentially abundant between two different conditions, followed by multiple testing correction methods adjusting for individual taxon <italic>p</italic>-values (e.g., the Benjamini-Hochberg/BH procedure, Benjamini and Hochberg, <xref rid="B7" ref-type="bibr">1995</xref>). The control of False Discovery Rate (FDR) is necessary, as an excess of false discoveries may lead to costly follow-up validation studies on false positive taxa, which essentially are not differentially abundant. Despite their potential usefulness in identifying differentially abundant taxa, these individual analyses may suffer from the following inherent limitations. First, the type I error of an individual microbiome differential analysis may not be correct (Hawinkel et al., <xref rid="B18" ref-type="bibr">2017</xref>). The BH procedure or its variant can control FDR when individual tests are either independent or under positive dependence assumptions (Benjamini and Hochberg, <xref rid="B7" ref-type="bibr">1995</xref>; Benjamini and Yekutieli, <xref rid="B8" ref-type="bibr">2001</xref>), while negative correlation among taxa abundance is common in microbiome data, especially for compositional data. It is possible that these BH procedures (Benjamini and Hochberg, <xref rid="B7" ref-type="bibr">1995</xref>; Benjamini and Yekutieli, <xref rid="B8" ref-type="bibr">2001</xref>) may fail to control FDR in presence of negative correlations (Hawinkel et al., <xref rid="B18" ref-type="bibr">2017</xref>). Second, the high-dimensionality nature of microbiome data increases multiple correction burden of individual analyses, which reduces the power of detecting differentially abundant taxa. Third, as widely observed in literature, the performance of most individual microbiome differential analysis methods heavily rely on the normalization and/or transformation, leading to challenges in independent replication studies (McMurdie and Holmes, <xref rid="B24" ref-type="bibr">2014</xref>; Sohn et al., <xref rid="B32" ref-type="bibr">2015</xref>; Weiss et al., <xref rid="B39" ref-type="bibr">2017</xref>).</p>
    <p>An alternative approach to taxon-level microbiome differential analysis is to compare the microbiome composition at the level of taxa-set. Examples of such a taxa set can be either a group of OTUs belonging to the same upper-level taxonomic rank (e.g., phylum, class, order, family, or genus) or even all OTUs in the microbiome community. The multivariate-type microbiome differential analysis usually gains power by reducing the multiple testing correction burden and aggregating modest effects across multiple taxa. Moreover, the multivariate analysis is typically less sensitive to normalization/transformation compared to individual analysis as it has a much larger analysis unit. Motivated by this, many statistical methods for microbiome community-level analysis have been recently proposed (McArdle and Anderson, <xref rid="B23" ref-type="bibr">2001</xref>; Zhao et al., <xref rid="B47" ref-type="bibr">2015</xref>; Tang et al., <xref rid="B33" ref-type="bibr">2016</xref>, <xref rid="B34" ref-type="bibr">2017</xref>; Plantinga et al., <xref rid="B29" ref-type="bibr">2017</xref>; Zhan et al., <xref rid="B42" ref-type="bibr">2017a</xref>).</p>
    <p>Despite of the potential power gain, a major critique of these existing multivariate microbiome analyses (e.g., differential analysis) is that the result of the test is global and is unable to identify specific taxon in the taxa-set that are differentially abundant. Besides the limitation in results' interpretation, it may also jeopardize the power of the test when the taxa-set contains many taxa that are not differentially abundant (Cao et al., <xref rid="B12" ref-type="bibr">2017</xref>). To enhance both interpretation and power of existing multivariate analysis in the framework of MDA, we propose a two-stage Adaptive Microbiome Differential Analysis (AMDA) procedure, which first selects some putative taxa that are more likely to be differentially abundant between two conditions, and then examines the differential abundances of the selected taxa-set with a multivariate two-sample test using Maximum Mean Discrepancy (MMD) (Gretton et al., <xref rid="B16" ref-type="bibr">2007</xref>, <xref rid="B17" ref-type="bibr">2012</xref>). Since the test is applied to a subset of taxa that are more likely to be differentially abundant, permutations are used to establish statistical significance to avoid inflated type I error. Despite being a set-based multivariate test that does not target at identifying individual differentially abundant microbial taxa, the intermediate testing subset selection procedure in AMDA can provide useful information regarding the importance of individual taxon in the taxa-set. Simulation studies and real data applications demonstrate the potential usefulness of the new proposed AMDA method and show its superior performance over existing methods across a wide range of scenarios.</p>
  </sec>
  <sec sec-type="materials and methods" id="s2">
    <title>2. Materials and Methods</title>
    <sec>
      <title>2.1. Data and Normalization</title>
      <p>Assume that we have measured the microbiome abundances of a community of <italic>p</italic> taxa from <italic>n</italic>(= <italic>n</italic><sub>1</sub>+<italic>n</italic><sub>2</sub>) samples collected from two groups with sizes of <italic>n</italic><sub>1</sub> and <italic>n</italic><sub>2</sub>, respectively. Here, the term community refers as a taxa-set, which typically consists of taxa from the same taxonomic rank such as genus, family, phylum, or bacteria kingdom. Let <inline-formula><mml:math id="M1"><mml:msup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>X</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> be the observed <italic>n</italic><sub><italic>k</italic></sub> × <italic>p</italic> OTU matrix for group <italic>k</italic>(<italic>k</italic> = 1, 2), where <inline-formula><mml:math id="M2"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>;</mml:mo><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> represents a <italic>p</italic> × 1 microbiome composition vector (subject to appropriate normalization or transformation). Suppose that, <inline-formula><mml:math id="M3"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> are two independent samples, from <italic>p</italic>-dimensional multivariate distribution with mean parameters <bold>μ</bold><sup>(1)</sup> and <bold>μ</bold><sup>(2)</sup>, respectively. In many practical problems, the hypothesis of interest is to examine whether microbiome abundances are different under two different conditions, that is,</p>
      <disp-formula id="E1">
        <label>(1)</label>
        <mml:math id="M4">
          <mml:mrow>
            <mml:msub>
              <mml:mi>H</mml:mi>
              <mml:mn>0</mml:mn>
            </mml:msub>
            <mml:mo>:</mml:mo>
            <mml:msup>
              <mml:mi>μ</mml:mi>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:msup>
            <mml:mo>=</mml:mo>
            <mml:msup>
              <mml:mi>μ</mml:mi>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mn>2</mml:mn>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:msup>
            <mml:mtext> </mml:mtext>
            <mml:mi>v</mml:mi>
            <mml:mi>s</mml:mi>
            <mml:mo>.</mml:mo>
            <mml:mtext>  </mml:mtext>
            <mml:msub>
              <mml:mi>H</mml:mi>
              <mml:mn>1</mml:mn>
            </mml:msub>
            <mml:mo>:</mml:mo>
            <mml:msup>
              <mml:mi>μ</mml:mi>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:msup>
            <mml:mo>≠</mml:mo>
            <mml:msup>
              <mml:mi>μ</mml:mi>
              <mml:mrow>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mn>2</mml:mn>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:msup>
            <mml:mo>.</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>For microbiome data, due to the varying amount of DNA yielding materials across different samples, the count of microbiome sequencing reads can vary greatly from sample to sample. The normalization of the raw sequencing read counts to relative abundances makes the microbial abundances comparable across samples. Therefore, it is a common practice to analyze high-dimensional microbiome compositional data with a unit sum (Li, <xref rid="B21" ref-type="bibr">2015</xref>). As such, applying standard statistical methods developed for unconstrained data to analyze microbiome composition data is usually underpowered and sometimes can render inappropriate results (Cao et al., <xref rid="B12" ref-type="bibr">2017</xref>; Weiss et al., <xref rid="B39" ref-type="bibr">2017</xref>).</p>
      <p>A popular approach to relax the compositional constraint of microbiome data is to perform the statistical analysis through log-ratio transformations (Aitchison, <xref rid="B2" ref-type="bibr">1982</xref>). In particular, the centered log-ratio transformation has been widely used among various form of log-ratio transformations (Cao et al., <xref rid="B12" ref-type="bibr">2017</xref>; Zhao et al., <xref rid="B48" ref-type="bibr">2018</xref>). Specifically, the centered log-ratio transformation <inline-formula><mml:math id="M5"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> of microbiome relative abundance <inline-formula><mml:math id="M6"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> is defined as</p>
      <disp-formula id="E2">
        <label>(2)</label>
        <mml:math id="M7">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msubsup>
                  <mml:mi>Z</mml:mi>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>k</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mi>log</mml:mi>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>X</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:mi>k</mml:mi>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                        </mml:msubsup>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msup>
                          <mml:mrow>
                            <mml:mo stretchy="false">(</mml:mo>
                            <mml:msubsup>
                              <mml:mo>Π</mml:mo>
                              <mml:mrow>
                                <mml:mi>j</mml:mi>
                                <mml:mo>=</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mi>p</mml:mi>
                            </mml:msubsup>
                            <mml:msubsup>
                              <mml:mi>X</mml:mi>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                                <mml:mi>j</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>k</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:mo stretchy="false">)</mml:mo>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mn>1</mml:mn>
                            <mml:mo>/</mml:mo>
                            <mml:mi>p</mml:mi>
                          </mml:mrow>
                        </mml:msup>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>,</mml:mo>
                <mml:mtext> </mml:mtext>
                <mml:mi>i</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mo>…</mml:mo>
                <mml:mo>,</mml:mo>
                <mml:msub>
                  <mml:mi>n</mml:mi>
                  <mml:mi>k</mml:mi>
                </mml:msub>
                <mml:mo>,</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mo>…</mml:mo>
                <mml:mo>,</mml:mo>
                <mml:mi>p</mml:mi>
                <mml:mo>,</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mtext>     </mml:mtext>
                <mml:mi>k</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mn>2.</mml:mn>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>To avoid a zero relative abundance in Equation (2), as a common practice, a zero count is usually replaced by a pseudo count of 0.5 before the relative abundance normalization and centered log-ratio transformation (Li, <xref rid="B21" ref-type="bibr">2015</xref>; Cao et al., <xref rid="B12" ref-type="bibr">2017</xref>). For community-based multivariate differential abundance analysis, it has been shown that testing equality of two compositional vectors is equivalent to testing <inline-formula><mml:math id="M8"><mml:msubsup><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow><mml:mrow><mml:mi>′</mml:mi></mml:mrow></mml:msubsup><mml:mo>:</mml:mo><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mn>μ</mml:mn></mml:mstyle></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mn>μ</mml:mn></mml:mstyle></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> (Cao et al., <xref rid="B12" ref-type="bibr">2017</xref>), where <inline-formula><mml:math id="M9"><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mn>μ</mml:mn></mml:mstyle></mml:mrow><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> is the mean of centered log-ratio transformed compositional vector <inline-formula><mml:math id="M10"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula>, <italic>i</italic> = 1, …, <italic>n</italic><sub><italic>k</italic></sub> and <italic>k</italic> = 1, 2. We will develop our AMDA method based on these centered log-ratio transformed relative abundances in the rest of this paper.</p>
    </sec>
    <sec>
      <title>2.2. A Multivariate Two-Sample Test Using Maximum Mean Discrepancy</title>
      <p>Two-sample testing on the equality of two high-dimensional means has been well studied in the statistical literature (Bai and Saranadasa, <xref rid="B5" ref-type="bibr">1996</xref>; Chen et al., <xref rid="B15" ref-type="bibr">2010</xref>; Cai et al., <xref rid="B10" ref-type="bibr">2014</xref>). These methods are typically not applicable to MDA analysis due to the following two reasons. First, existing methods usually assume normal data, which is not the case for microbiome compositional data. It has been observed that classic statistical methods developed for multivariate Gaussian data may fail for microbiome compositional data (Li, <xref rid="B21" ref-type="bibr">2015</xref>; Cao et al., <xref rid="B12" ref-type="bibr">2017</xref>; Zhao et al., <xref rid="B48" ref-type="bibr">2018</xref>). Second, most existing methods require estimating the covariance matrix. Given the small or modest sample size in a typical microbiome study, the relatively large estimation error of covariance matrix probably deteriorates the performance of two-sample test, as observed in microbiome association tests (Zhan et al., <xref rid="B43" ref-type="bibr">2017b</xref>, <xref rid="B44" ref-type="bibr">2018</xref>).</p>
      <p>An alternative approach to test hypothesis (Equation 1)is to use a non-parametric test that does not need to estimate the covariance matrix. One such test is the kernel-based maximum mean discrepancy (MMD) test (Gretton et al., <xref rid="B16" ref-type="bibr">2007</xref>, <xref rid="B17" ref-type="bibr">2012</xref>), originally proposed to examine whether the underlying distribution of two samples are identical. An MMD test first maps the two distributions into a reproducing kernel Hilbert space (RKHS) and then the maximum mean discrepancy metric between the two distributions is defined as the distance of their corresponding images in the RKHS. A good property about MMD is that, MMD is zero if and only if two distributions are identical when the RKHS is sufficiently rich (contain a large enough class of functions). Since the test can be used to examine equality of two multivariate distributions, it suffices for testing (Equation 1), that is, to examine the equality of the mean parameters of two underlying distributions.</p>
      <p>In particular, the MMD statistic between two independent samples <inline-formula><mml:math id="M11"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M12"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> is defined as</p>
      <disp-formula id="E3">
        <label>(3)</label>
        <mml:math id="M13">
          <mml:mtable columnalign="left">
            <mml:mtr>
              <mml:mtd>
                <mml:msup>
                  <mml:mtext>MMD</mml:mtext>
                  <mml:mn>2</mml:mn>
                </mml:msup>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mn>1</mml:mn>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>n</mml:mi>
                      <mml:mn>1</mml:mn>
                      <mml:mn>2</mml:mn>
                    </mml:msubsup>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mi>k</mml:mi>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msubsup>
                  <mml:mi>X</mml:mi>
                  <mml:mi>i</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>,</mml:mo>
                <mml:msubsup>
                  <mml:mi>X</mml:mi>
                  <mml:mi>j</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>+</mml:mo>
                <mml:mfrac>
                  <mml:mn>1</mml:mn>
                  <mml:mrow>
                    <mml:msubsup>
                      <mml:mi>n</mml:mi>
                      <mml:mn>2</mml:mn>
                      <mml:mn>2</mml:mn>
                    </mml:msubsup>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mn>2</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mi>k</mml:mi>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msubsup>
                  <mml:mi>X</mml:mi>
                  <mml:mi>i</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>,</mml:mo>
                <mml:msubsup>
                  <mml:mi>X</mml:mi>
                  <mml:mi>j</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mtd>
            </mml:mtr>
            <mml:mtr>
              <mml:mtd>
                <mml:mtext>                 </mml:mtext>
                <mml:mo>−</mml:mo>
                <mml:mfrac>
                  <mml:mn>2</mml:mn>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>n</mml:mi>
                      <mml:mn>1</mml:mn>
                    </mml:msub>
                    <mml:msub>
                      <mml:mi>n</mml:mi>
                      <mml:mn>2</mml:mn>
                    </mml:msub>
                  </mml:mrow>
                </mml:mfrac>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mn>1</mml:mn>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>n</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munderover>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>n</mml:mi>
                            <mml:mn>2</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                      </mml:munderover>
                      <mml:mi>k</mml:mi>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msubsup>
                  <mml:mi>X</mml:mi>
                  <mml:mi>i</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>,</mml:mo>
                <mml:msubsup>
                  <mml:mi>X</mml:mi>
                  <mml:mi>j</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mn>2</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>,</mml:mo>
              </mml:mtd>
            </mml:mtr>
          </mml:mtable>
        </mml:math>
      </disp-formula>
      <p>where <italic>k</italic>(·, ·) is a characteristic kernel (Gretton et al., <xref rid="B16" ref-type="bibr">2007</xref>, <xref rid="B17" ref-type="bibr">2012</xref>), which spans a RKHS which is sufficiently large that MMD is zero if and only if two samples are from the same underlying distribution. Examples of characteristic kernel include the Gaussian kernel and the Laplace kernel. Under the null hypothesis of identical distribution, the population-level MMD<sup>2</sup> statistic is zero, and thus, a larger MMD<sup>2</sup> statistic indicates a larger discrepancy between the two distributions. Asymptotically, MMD<sup>2</sup> follows a mixture of <inline-formula><mml:math id="M14"><mml:msubsup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> distribution (Gretton et al., <xref rid="B16" ref-type="bibr">2007</xref>, <xref rid="B17" ref-type="bibr">2012</xref>). As observed in literature, the asymptotic mixture of <inline-formula><mml:math id="M15"><mml:msubsup><mml:mrow><mml:mi>χ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> distribution is typically not accurate for a statistic calculated from a small sample size, as frequently encountered in microbiome studies (Chen et al., <xref rid="B13" ref-type="bibr">2016</xref>; Zhan et al., <xref rid="B43" ref-type="bibr">2017b</xref>, <xref rid="B44" ref-type="bibr">2018</xref>). A more accurate approach to establish significance is using resamplings (e.g., permuting the group label of each observation) (Wu et al., <xref rid="B40" ref-type="bibr">2016</xref>).</p>
    </sec>
    <sec>
      <title>2.3. An Adaptive Two-Sample Test for Microbiome Differential Abundance Analysis</title>
      <p>A limitation of the aforementioned MMD test is that it equally utilizes information in all dimensions. When the signal is sparse, the MMD test typically has a low power due to the high degrees of freedom paid for many noise variables. The same phenomenon has been widely observed in the field of set-based genetic association studies (Cai et al., <xref rid="B9" ref-type="bibr">2012</xref>; Pan et al., <xref rid="B27" ref-type="bibr">2014</xref>, <xref rid="B28" ref-type="bibr">2015</xref>; Zhan et al., <xref rid="B41" ref-type="bibr">2015</xref>) and community-based microbiome association studies (Wu et al., <xref rid="B40" ref-type="bibr">2016</xref>; Koh et al., <xref rid="B20" ref-type="bibr">2017</xref>). There are in general two types of two-sample test of high-dimensional means. One is based on the sum of squares of mean differences of each dimension [e.g., MiRKAT proposed in Zhao et al., <xref rid="B47" ref-type="bibr">2015</xref>], and the other is based on the largest componentwise mean difference (e.g., the max-type test proposed in Cao et al. (<xref rid="B12" ref-type="bibr">2017</xref>)). For microbiome differential abundance analysis, the max-type test tends to be more powerful when only a few taxa are truly differentially abundant. On the other hand, the MiRKAT-type test can be more powerful than the max-type test under the scenario of dense signals. In practice, the true underlying biological scenario is never known and thus adaptive methods for microbiome differential abundance analysis are desired.</p>
      <p>A common adaptive approach in a multivariate association test or two-sample test is to assign different weights to variables so that important variables are up-weighted and non-informative variables are down-weighted (Cai et al., <xref rid="B9" ref-type="bibr">2012</xref>; Pan et al., <xref rid="B27" ref-type="bibr">2014</xref>, <xref rid="B28" ref-type="bibr">2015</xref>; Wu et al., <xref rid="B40" ref-type="bibr">2016</xref>; Koh et al., <xref rid="B20" ref-type="bibr">2017</xref>). Yet it is often difficult to determine the optimal weights. Some authors propose another loop of permutations to combine multiple sets of weights, which may be computationally challenging since most adaptive tests already need permutations to establish significance (Pan et al., <xref rid="B27" ref-type="bibr">2014</xref>, <xref rid="B28" ref-type="bibr">2015</xref>). In this paper, we propose a different adaptive method, which tests the hypothesis in a selected subset of microbiome features. In other words, instead of applying the MMD test to all <italic>p</italic> taxa <bold>X</bold> = (<italic>X</italic><sub>1</sub>, …, <italic>X</italic><sub><italic>p</italic></sub>), we apply the test on a putative testing subset <bold>X</bold><sub><italic>S</italic></sub>, where <italic>S</italic>⊂{1, …, <italic>p</italic>}. Our method can also be viewed as a weighted approach in the sense that a zero weight is assigned to a feature that is not selected in the testing subset, and an equal weight is assigned to each feature in the testing subset. We defer details of selecting such a testing subset to the next section and present our adaptive microbiome differential analysis (AMDA) procedure in <xref rid="T3" ref-type="table">Algorithm 1</xref>:</p>
      <table-wrap id="T3" position="float">
        <label>Algorithm 1</label>
        <caption>
          <p>An adaptive two-sample test for microbiome differential abundance analysis</p>
        </caption>
        <table frame="hsides" rules="groups">
          <tbody>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"><bold>Input:</bold> A <italic>n</italic>×<italic>p</italic> microbiome composition matrix <inline-formula><mml:math id="M16"><mml:mstyle mathvariant="bold"><mml:mtext>X</mml:mtext></mml:mstyle><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and a <italic>n</italic> × 1 group label vector <italic>y</italic> = (1, …, 1, 2, …, 2) associated with the microbiome compositions.</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1"><bold>Output:</bold> A <italic>p</italic>-value for <inline-formula><mml:math id="M17"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mn>μ</mml:mn></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mn>μ</mml:mn></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mstyle class="text"><mml:mtext class="textit" mathvariant="italic">  vs.</mml:mtext></mml:mstyle><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mn>μ</mml:mn></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>≠</mml:mo><mml:msup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mn>μ</mml:mn></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula>.</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">
                <bold>Procedure:</bold>
                <list list-type="order">
                  <list-item>
                    <p>Apply the centered log-ratio transformation Equation (2) to the microbiome composition matrix. Without loss of generality, we still use <bold>X</bold> to denote the centered log-ratio transformed data.</p>
                  </list-item>
                  <list-item>
                    <p>Use the testing subset selection procedure described in section 2.4 to select a testing subset <inline-formula><mml:math id="M18"><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>X</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="-tex-caligraphic">S</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> from <bold>X</bold>, and then calculate the MMD statistic using <inline-formula><mml:math id="M19"><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>X</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="-tex-caligraphic">S</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> and <italic>y</italic>. Denote this statistic as <inline-formula><mml:math id="M20"><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula>.</p>
                  </list-item>
                  <list-item>
                    <p>For <italic>b</italic> = 1, …, <italic>B</italic>, permute the group label of observations to obtain ỹ and use ỹ to repeat Step 2 with <bold>X</bold> and ỹ. Calculate the corresponding statistics as <inline-formula><mml:math id="M21"><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:math></inline-formula> for <italic>b</italic> = 1, …, <italic>B</italic>.</p>
                  </list-item>
                  <list-item>
                    <p>Calculate the final <italic>p</italic>-value as <inline-formula><mml:math id="M22"><mml:mi>p</mml:mi><mml:mi>v</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:mfrac><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>B</mml:mi></mml:mrow></mml:munderover><mml:mi>I</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mo>≥</mml:mo><mml:mi>M</mml:mi><mml:mi>M</mml:mi><mml:msubsup><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>o</mml:mi><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula>, where <italic>I</italic>[·] is the indicator function.</p>
                  </list-item>
                </list>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>2.4. A New Permutation-Based Testing Subset Selection Procedure</title>
      <p>There is a vast statistical literature on high-dimensional variable selection. Some famous examples include the lasso (Tibshirani, <xref rid="B35" ref-type="bibr">1996</xref>) and the knockoff filter (Barber and Candès, <xref rid="B6" ref-type="bibr">2015</xref>; Candes et al., <xref rid="B11" ref-type="bibr">2018</xref>). The lasso has proven to be a versatile tool with nice asymptotic estimation and prediction properties, yet its performance under small sample size is not guaranteed. On the other hand, knockoff is able to select variables under FDR control with finite samples. But it tends to select a smaller set of variables with less false positives to achieve FDR control (see <xref ref-type="supplementary-material" rid="SM1">Table S1</xref> in the online supplemental material). As a consequence, many signals are not selected by knockoff, typically leading to a less powerful test. Recall that, our ultimate goal is to construct a differential test with relatively high power. For this reason, we prefer a procedure that can select a testing subset that contains as many signals as possible. To achieve this goal, we propose the following permutation-based testing subset selection procedure.</p>
      <p>We first randomly permute the row indices of matrix <bold>X</bold> (defined in <xref rid="T3" ref-type="table">Algorithm 1</xref>) and obtain a permuted microbiome composition matrix <inline-formula><mml:math id="M23"><mml:mover accent="true"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>X</mml:mtext></mml:mstyle></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula>. By the nature of its construction, <inline-formula><mml:math id="M24"><mml:mover accent="true"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>X</mml:mtext></mml:mstyle></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula> is not related to outcome <italic>y</italic>. Next, a one-dimensional two-sample test (e.g., the Kolmogorov-Smirnov test) is applied to each dimension of <bold>X</bold> and <inline-formula><mml:math id="M25"><mml:mover accent="true"><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>X</mml:mtext></mml:mstyle></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:math></inline-formula>, and we denote the corresponding <italic>p</italic>-values as <italic>p</italic><sub>1</sub>, …, <italic>p</italic><sub><italic>p</italic></sub> and <inline-formula><mml:math id="M26"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, respectively. Because the dimension <italic>p</italic> is typically much larger than sample size in microbiome studies, we calculate the marginal <italic>p</italic>-values rather than joint <italic>p</italic>-values for testing subset selection. For a truly differentially expressed variable <italic>X</italic><sub><italic>j</italic></sub>, as <inline-formula><mml:math id="M27"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is not constructed to be outcome-related, it is expected that <inline-formula><mml:math id="M28"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>. Hence, we select the testing subset as <inline-formula><mml:math id="M29"><mml:mrow><mml:mi mathvariant="-tex-caligraphic">S</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mo>~</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> and conduct our MMD test based on the sub-design matrix <inline-formula><mml:math id="M30"><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>X</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="-tex-caligraphic">S</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula>. Finally, as we are testing <inline-formula><mml:math id="M31"><mml:msub><mml:mrow><mml:mi>H</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>:</mml:mo><mml:msup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mn>μ</mml:mn></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mn>μ</mml:mn></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> using microbiome features that are more likely to be differentially expressed, to avoid inflated type I error, resampling methods are required to establish the significance (see details in <xref rid="T3" ref-type="table">Algorithm 1</xref>).</p>
      <p>It should be noted that the aforementioned permutation-based procedure is one way to achieve testing subset selection but not the only way, and it is possible to select testing subset <inline-formula><mml:math id="M32"><mml:msub><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>X</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="-tex-caligraphic">S</mml:mi></mml:mrow></mml:mrow></mml:msub></mml:math></inline-formula> using other methods such as lasso and knockoff. We conduct comprehensive simulation studies to compare the power of adaptive two-sample test using different testing subset selection procedures and report the results in the online <xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref>. As can be observed there, adaptive test based on our permutation-based procedure is more powerful than both lasso-based and knockoff-based tests, as both lasso and knockoff tend to miss more true signals for the sake of achieving sparsity (lasso) or FDR control (knockoff).</p>
    </sec>
  </sec>
  <sec sec-type="results" id="s3">
    <title>3. Results</title>
    <sec>
      <title>3.1. Simulation Settings</title>
      <p>A comprehensive simulation study has been conducted to compare the performance of AMDA to a wide range of existing microbiome association tests in the framework of microbiome differential abundance analysis. The five other tests evaluated in this simulation include the MiRKAT (Zhao et al., <xref rid="B47" ref-type="bibr">2015</xref>), the original MMD test without testing subset selection (Gretton et al., <xref rid="B16" ref-type="bibr">2007</xref>, <xref rid="B17" ref-type="bibr">2012</xref>), the Quasi-Conditional Association Test/QCAT (Tang et al., <xref rid="B34" ref-type="bibr">2017</xref>), the maximum-type (MAX) test based on the largest sample mean difference (Cao et al., <xref rid="B12" ref-type="bibr">2017</xref>) and the optimal microbiome-based association test/OMiAT (Koh et al., <xref rid="B20" ref-type="bibr">2017</xref>). AMDA, MiRKAT, MMD, QCAT, and MAX are a single test, while OMiAT takes advantage of two series of tests. One is the MiSPU tests (Wu et al., <xref rid="B40" ref-type="bibr">2016</xref>) with different weighting schemes on each individual taxon in the taxa-set. The other is the MiRKAT tests with different kernel functions. The spirit of OMiAT can be easily implemented in AMDA, MiRKAT, and MMD by evaluating multiple kernels and taking the optimal kernel test with minimum <italic>p</italic>-value. We do not incorporate this strategy, for ease of presenting, and only evaluate the Gaussian kernel-based test for AMDA, MiRKAT, and MMD in this simulation. Correspondingly, we evaluate the OMiAT as the optimal of a series of MiSPU tests (without MiRKAT tests of different kernels) for fair comparison. With a slight abuse of notation, we still term this test as OMiAT, though it does not contain the MiRKAT component compared to the original one (Koh et al., <xref rid="B20" ref-type="bibr">2017</xref>). Moreover, QCAT and MAX tests with asymptotic <italic>p</italic>-values are found to have inflated type I errors (data not shown). For this reason, we use permutations to calculate the MAX test <italic>p</italic>-value and the resampling option in the QCAT software (Tang et al., <xref rid="B34" ref-type="bibr">2017</xref>) to calculate QCAT <italic>p</italic>-value. Finally, the permutation-based procedure is used to select testing subset in the intermediate stage of AMDA in this simulation. The performance of AMDA test based on other subset selection methods such as lasso and knockoff were evaluated in additional simulation studies presented in the online <xref ref-type="supplementary-material" rid="SM1">Supplementary Material</xref>.</p>
      <p>We closely followed the simulation design of the MAX test (Cao et al., <xref rid="B12" ref-type="bibr">2017</xref>) to generate microbiome relative abundances data using the logistic normal distribution (Atchison and Shen, <xref rid="B4" ref-type="bibr">1980</xref>). We first simulated <inline-formula><mml:math id="M33"><mml:msubsup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mtext>W</mml:mtext></mml:mstyle></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>~</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mstyle mathvariant="bold"><mml:mn>μ</mml:mn></mml:mstyle></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:mstyle mathvariant="bold"><mml:mn>Σ</mml:mn></mml:mstyle></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> for <italic>i</italic> = 1, 2, …, <italic>n</italic>, <italic>k</italic> = 1, 2 and then calculated the microbiome relative abundances as <inline-formula><mml:math id="M34"><mml:msubsup><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo class="qopname">exp</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:munderover accentunder="false" accent="false"><mml:mrow><mml:mo class="qopname">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:munderover><mml:mo class="qopname">exp</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>W</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math></inline-formula> and its centered log-ratio transformation <inline-formula><mml:math id="M35"><mml:msubsup><mml:mrow><mml:mi>Z</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> according to Equation (2). Following the simulation design of MAX (Cao et al., <xref rid="B12" ref-type="bibr">2017</xref>), the components of <bold>μ</bold><sup>(1)</sup> were drawn from a uniform distribution Unif(0,10) and we considered the banded covariance structure <bold>Σ</bold> = <bold>D</bold><sup>1/2</sup><bold>AD</bold><sup>1/2</sup>, where <bold>D</bold> is a diagonal matrix with entries randomly drawn from Unif(1,3) and <bold>A</bold> has nonzero entries <italic>a</italic><sub><italic>jj</italic></sub> = 1, <italic>a</italic><sub><italic>j,j</italic>−1</sub> = <italic>a</italic><sub><italic>j</italic>−1,<italic>j</italic></sub> = −0.5. Under the null model, we set <bold>μ</bold><sup>(2)</sup> = <bold>μ</bold><sup>(1)</sup>. Under the alternative model, we randomly picked a subset <inline-formula><mml:math id="M36"><mml:mrow><mml:mi mathvariant="-tex-caligraphic">S</mml:mi></mml:mrow><mml:mo>⊂</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>p</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> such that <inline-formula><mml:math id="M37"><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>μ</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, where <italic>e</italic><sub><italic>j</italic></sub> ~ <italic>Unif</italic>(−0.5, 0.5) for all <inline-formula><mml:math id="M38"><mml:mi>j</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mi mathvariant="-tex-caligraphic">S</mml:mi></mml:mrow></mml:math></inline-formula>. For the size of signal set <inline-formula><mml:math id="M39"><mml:mrow><mml:mi mathvariant="-tex-caligraphic">S</mml:mi></mml:mrow></mml:math></inline-formula> (number of taxa that are truly differentially abundant), we considered low, medium and high signal density levels: <inline-formula><mml:math id="M40"><mml:msup><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mo>*</mml:mo></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mo>|</mml:mo><mml:mrow><mml:mi mathvariant="-tex-caligraphic">S</mml:mi></mml:mrow><mml:mo>|</mml:mo><mml:mo>=</mml:mo><mml:mn>10</mml:mn><mml:mi>%</mml:mi><mml:mi>p</mml:mi></mml:math></inline-formula>, 30<italic>%p</italic> and 50<italic>%p</italic> with the indices randomly chosen from {1, 2, …, <italic>p</italic>}. Throughout this simulation, we varied <italic>n</italic> = 50, 100, 200 with <italic>n</italic><sub>1</sub> = <italic>n</italic><sub>2</sub> = <italic>n</italic>/2 to investigate the test's performance under different sample sizes, and considered <italic>p</italic> = 50, 100, 200, 500 representing taxa-sets under different taxonomic ranks.</p>
      <p>After the data were simulated, we applied AMDA, MAX, OMiAT, MMD, MiRKAT, and QCAT to examine the two-sample differences. The first three tests AMDA, MAX, OMiAT are adaptive in the sense that they either use a testing subset of the taxa (AMDA and MAX) or assign a different weight for each taxon in the set (OMiAT) to conduct the multivariate two-sample test. The Gaussian kernel (<italic>k</italic>(<italic>x, y</italic>) = exp{−||<italic>x</italic>−<italic>y</italic>||<sup>2</sup>/ρ}, where <italic>x</italic> and <italic>y</italic> are two microbiome compositional vectors) was used in AMDA, MMD, and MiRKAT with the shape parameter ρ selected as the median of sample pairwise Euclidean distance ||<italic>x</italic> − <italic>y</italic>||<sup>2</sup>. The type I error was evaluated using 5,000 replicates generated under the null model and the power of test was assessed with 1,000 replicates under the alternative model. Without loss of generality, we set the nominal significance level α = 0.05 throughout this simulation.</p>
    </sec>
    <sec>
      <title>3.2. Simulation Results</title>
      <p>The type I error of different tests are reported in <xref rid="T1" ref-type="table">Table 1</xref>, where one can see that all tests have the correct type I error across all (<italic>n, p</italic>)-configurations. The power of different tests are reported <xref ref-type="fig" rid="F1">Figure 1</xref> (<italic>p</italic> = 50 and 100) and <xref ref-type="fig" rid="F2">Figure 2</xref> (<italic>p</italic> = 200 and 500). Since the effect size was arbitrarily chosen to avoid power saturation, we care about the relative power among different methods rather than their absolute magnitudes. As can be seen from both figures, adaptive tests (AMDA, MAX, and OMiAT) are consistently more powerful than the non-adaptive ones (MMD, MiRKAT, and QCAT). This is because the scenarios considered in our simulation studies are relatively sparse (<italic>p</italic><sup>*</sup>/<italic>p</italic> ≤ 50%), and the adaptive tests can largely boost the power by treating variables (signals and noises) differently.</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Empirical type I errors of different tests for microbiome differential abundance analysis under nominal significance level α = 0.05.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">
                <bold>p</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>n</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>AMDA</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>MAX</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>OMiAT</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>MMD</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>MiRKAT</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>QCAT</bold>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">50</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0478</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0478</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0506</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0516</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0508</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0436</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">50</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0464</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0458</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0492</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0536</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0540</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0488</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">200</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0504</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0542</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0530</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0534</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0548</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0480</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">50</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0486</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0478</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0490</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0434</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0424</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0532</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">100</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0464</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0494</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0492</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0544</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0542</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0478</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">200</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0524</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0558</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0514</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0440</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0424</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0470</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">50</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0454</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0498</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0492</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0438</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0400</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0490</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">200</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0514</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0476</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0464</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0530</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0516</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0538</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">200</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0464</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0510</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0506</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0542</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0530</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0476</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">50</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0480</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0464</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0504</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0556</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0442</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0474</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">500</td>
              <td valign="top" align="center" rowspan="1" colspan="1">100</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0540</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0544</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0566</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0570</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0498</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0468</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">200</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0556</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0576</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0456</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0490</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0442</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0.0336</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p><italic>Results are averaged over 5,000 replicates</italic>.</p>
        </table-wrap-foot>
      </table-wrap>
      <fig id="F1" position="float">
        <label>Figure 1</label>
        <caption>
          <p>Empirical power of different tests under <italic>p</italic> = 50 (first row) and <italic>p</italic> = 100 (second row). The Y-axis represents the power and the X-axis represents the sparsity level at 10, 30, and 50%.</p>
        </caption>
        <graphic xlink:href="fgene-10-00350-g0001"/>
      </fig>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p>Empirical power of different tests under <italic>p</italic> = 200 (first row) and <italic>p</italic> = 500 (second row). The Y-axis represents the power and the X-axis represents the sparsity level at 10, 30, and 50%.</p>
        </caption>
        <graphic xlink:href="fgene-10-00350-g0002"/>
      </fig>
      <p>Among three non-adaptive tests, MMD and MiRKAT have similar power under each scenario. On the other hand, QCAT has the highest power when the dimension of taxa-set is relatively low (<xref ref-type="fig" rid="F1">Figure 1</xref>) especially when the sample size is relatively large (<italic>n</italic> = 200). When the dimension of taxa-set increases, QCAT can quickly lose power and become less powerful than both MMD and MiRKAT (<xref ref-type="fig" rid="F2">Figure 2</xref>).</p>
      <p>Among the three more powerful adaptive tests, MAX seems to be slightly more powerful than AMDA and OMiAT when the density of signal is sparse (<italic>p</italic><sup>*</sup>/<italic>p</italic> = 10%) and dimension is relatively low (<italic>p</italic> = 50,100, and 200) as indicated in <xref ref-type="fig" rid="F1">Figure 1</xref> and the top row of <xref ref-type="fig" rid="F2">Figure 2</xref>. Compared to AMDA, MAX only utilizes the strongest signal, which could be beneficial when the signals are extremely sparse. When <italic>p</italic> = 500, there are <italic>p</italic><sup>*</sup> = 50 even under the sparse scenario and AMDA can be more powerful than MAX by including more signals in the testing subset (bottom row of <xref ref-type="fig" rid="F2">Figure 2</xref>). On the other hand, when the signal level is moderate (<italic>p</italic><sup>*</sup>/<italic>p</italic> = 30%) or relatively dense (<italic>p</italic><sup>*</sup>/<italic>p</italic> = 50%), AMDA is much more powerful than MAX under most scenarios in both <xref ref-type="fig" rid="F1">Figures 1</xref>, <xref ref-type="fig" rid="F2">2</xref>. Finally, as seen from both figures, AMDA is always more powerful than OMiAT across all scenarios. AMDA and OMiAT treat variables in different ways. AMDA selects some variables and excludes the rest for further subset testing, while OMiAT assigns different weights for different variables when calculating the multivariate score test statistic. Despite that a small non-zero weight may be assigned to a noise variable in OMiAT, due to the relatively sparse signal density (<italic>p</italic><sup>*</sup>/<italic>p</italic> ≤ 50%, which means there are much more noises than signals), the accumulated adverse effects of noise variables can still deteriorate the performance of OMiAT. As a comparison, a zero weight is assigned to a noise variable (by excluding it from the testing subset) in AMDA, which explains power gain in AMDA over OiMAT.</p>
      <p>To conclude, like five other methods, the proposed AMDA method is able to preserve the nominal type I error in microbiome differential abundance analysis. Power-wise speaking, there is no uniformly most powerful test in our simulations. However, the proposed AMDA method is always the most powerful one among all six tests being evaluated in this simulation under most scenarios, and the power advantage of AMDA over the other five methods can be huge (<xref ref-type="fig" rid="F1">Figures 1</xref>, <xref ref-type="fig" rid="F2">2</xref>). Under only a few particular scenarios with extremely sparse signal (<italic>p</italic><sup>*</sup>/<italic>p</italic> = 10%) under relative low dimensions (<italic>p</italic> = 50,100, and 200), MAX can be slightly more powerful than AMDA.</p>
    </sec>
    <sec>
      <title>3.3. Application to Oral Microbiome Data Collected From Children With Autism Spectrum Disorder</title>
      <p>We applied the proposed AMDA method to a study investigating how the oral microbiome differs across children with autistic behaviors (Hicks et al., <xref rid="B19" ref-type="bibr">2018</xref>). The study enrolled 346 children (between 2 and 6 years old), which were divided into three groups according to the severity of disorder/developmental status: autism spectrum disorder (ASD, <italic>n</italic> = 180), non-autistic developmental delay (DD, <italic>n</italic> = 60), and typically developing (TD, <italic>n</italic> = 106). The ASD group was defined using criteria specified in the Diagnostic and Statistical Manual of Mental Disorders (DSM–5) by the American Psychiatric Association. The DD group included children who did not meet DSM-5 criteria for ASD but had developmental delay symptoms (e.g., expressive speech delay and intellectual disability). TD children included children with negative ASD screening and met typical developmental milestones on standardized physician assessment. The oral microbiome composition of these children was quantified with next generation sequencing. The data along with details of data processing are available in the previous publication (Hicks et al., <xref rid="B19" ref-type="bibr">2018</xref>).</p>
      <p>Taxonomic reads were further filtered to include only the taxa with counts of more than 10, in more than 20% samples, which ended up with a oral microbiome community of 753 taxa. Sequence alignment with the k-SLAM (Ainsworth et al., <xref rid="B1" ref-type="bibr">2017</xref>) method was used for comprehensive taxonomic classification, and these 753 taxa were classified into 457 species, 266 genera, 142 families, 73 orders, 33 classes, and 16 phyla (each rank had a Unclassified group for taxonomic sequence not identified at that rank). Because the proposed AMDA method is an adaptive multivariate two-sample test, we focused our analysis on higher taxonomic ranks (family, order, class, phylum, and the community of all 753 taxa), as many lower taxonomic ranks contain only a single taxon (e.g., 410 of the 457 species are a singleton). Similarly, for the taxonomic ranks (family, order, class, and phylum) being considered, we further limited our analysis to a particular taxa-set that contains more than two taxa. As a result, 52 families, 34 orders, 18 classes, and 10 phyla were tested in our data analysis. We applied AMDA, MAX, OMiAT, MMD, MiRKAT, and QCAT to this data to examine the oral microbiome differences among three different children developmental profile groups (particularly, ASD vs. DD and ASD vs. TD) at different taxonomic ranks. As 52 families/34 orders/18 classes/10 phyla were tested, we adjusted for multiple testing using the Bonferroni correction to control the family-wise error rate at α = 0.05. Correspondingly, <italic>B</italic> = 10, 000 permutations/resamplings were used in AMDA, MAX, OMiAT, MMD, and QCAT to increase the precision of the test <italic>p</italic>-values, while the MiRKAT calculates the <italic>p</italic>-value analytically.</p>
      <p>We first applied these tests to examine whether there is an overall shift in oral microbiome composition between different developmental groups by testing the differential abundances of all 753 taxa as a whole community. For the comparison of ASD vs. DD, the test <italic>p</italic>-values of AMDA, MAX, OMiAT, MMD, MiRKAT, and QCAT are 0.0113, 0.1409, 0.5244, 0.1321, 0.1377, and 0.9802, respectively. AMDA is the only method that is able to detect a significant (<italic>p</italic>-value &lt; 0.05) difference of microbiome community profiles between ASD and DD. For the comparison of ASD vs. TD, the test <italic>p</italic>-values of AMDA, MAX, OMiAT, MMD, MiRKAT, and QCAT are 0.0021, 0.0017, 0.0323, 0.3039, 0.3099, and 0.1782, respectively. All three adaptive methods (AMDA, MAX, and OMiAT) are able to detect a significant difference between ASD and TD. In the original study (Hicks et al., <xref rid="B19" ref-type="bibr">2018</xref>), the Mann-Whitney <italic>U</italic>-test based individual differential analysis was applied to each taxon and only three/six taxa were differentially abundant between ASD vs. DD/ASD vs. TD under FDR = 0.05 [see <xref rid="T2" ref-type="table">Table 2</xref> of Hicks et al. (<xref rid="B19" ref-type="bibr">2018</xref>)]. According to the previous simulation results, when the number of signals is relatively small (<italic>p</italic><sup>*</sup> = 3 or 6 as suggested in the original analysis) compared to the number of variables (<italic>p</italic> = 753), the non-adaptive tests have a low power. This explains that MMD/MiRKAT/QCAT methods are not able to detect a significant difference of microbiome profiles between two conditions in this data. Finally, the AMDA/MAX/OMiAT <italic>p</italic>-value of comparison ASD vs. TD is much smaller than that of comparison ASD vs. DD, indicating a more significant overall oral microbiome composition difference between ASD vs. TD than the between ASD vs. DD, which is consistent with the severity of disorder.</p>
      <table-wrap id="T2" position="float">
        <label>Table 2</label>
        <caption>
          <p>Number of significant differential abundant taxa-set at each taxonomic rank detected by different methods under family-wise error rate of 0.05.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th valign="top" align="left" rowspan="1" colspan="1">
                <bold>Comparison</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>Rank</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>AMDA</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>MAX</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>OMiAT</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>MMD</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>MiRKAT</bold>
              </th>
              <th valign="top" align="center" rowspan="1" colspan="1">
                <bold>QCAT</bold>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">Phylum (10)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">ASD vs. DD</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Class (18)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">Order (34)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">Family (52)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">Phylum (10)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">0</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td valign="top" align="left" rowspan="1" colspan="1">ASD vs. TD</td>
              <td valign="top" align="center" rowspan="1" colspan="1">Class (18)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">4</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">5</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">Order (34)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">3</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1"/>
              <td valign="top" align="center" rowspan="1" colspan="1">Family (52)</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">1</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
              <td valign="top" align="center" rowspan="1" colspan="1">2</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p><italic>Number in parentheses denotes the total number of tests conducted at that rank</italic>.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Next, we shift our analysis unit to lower ranks than the community-level to comprehensively assess taxa-set (with multiple taxa) at each taxonomic rank that are differentially abundant among different developmental status groups. The testing results are summarized here in <xref rid="T2" ref-type="table">Table 2</xref>. Based on this table, one can observe that the proposed AMDA always declares more significant differences than the other two tests except for one scenario (class-level differential analysis between ASD and TD). The absolute difference among three methods presented in <xref rid="T2" ref-type="table">Table 2</xref> may be small due to the conservativeness of the Bonferroni correction. To observe the relative trends of different tests, the <italic>p</italic>-values of these tests at family-level are presented in <xref ref-type="fig" rid="F3">Figure 3</xref> (<italic>p</italic>-values at other taxonomic ranks have the similar pattern and hence are not reported). The AMDA <italic>p</italic>-values tend to be the smallest among <italic>p</italic>-values of all six tests. Therefore, our method has a clear advantage over the other methods in terms of detecting more significant differences in this oral microbiome data differential abundance analysis.</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><italic>P</italic>-values of AMDA, MAX, OMiAT, MMD, MiRKAT, and QCAT for family-level differential abundance analysis. The left panel corresponds to the comparison between ASD and DD, and right panel corresponds to the comparison between ASD and TD.</p>
        </caption>
        <graphic xlink:href="fgene-10-00350-g0003"/>
      </fig>
    </sec>
  </sec>
  <sec sec-type="discussion" id="s4">
    <title>4. Discussion</title>
    <p>With the ever-increasing availability of microbiome and metagenomics data generated by next generation sequencing technology, the need to develop and implement efficient statistical analysis for the data is important to ensure both statistical rigor and biological relevance. In this paper, we consider the problem of differential abundance analysis for microbiome data, which leads to a better understanding of the behavior of microbiome communities. Most existing methods tackle this problem using individual taxon-based approach followed by multiple testing adjustment. However, as taxa living in the same community do not grow independently, the complicated interactions among taxa result in complicated correlation structures among taxa relative abundances, which may violate the correlation assumptions (among individual tests) of existing multiple correction methods (Hawinkel et al., <xref rid="B18" ref-type="bibr">2017</xref>). On the other hand, the newly proposed AMDA examines the differential abundance of a taxa-set typically containing taxa from the same genus/family/order/class/phylum, which provides an invaluable compliment to the individual taxon-based differential abundance analysis. Given evidence of an association of a taxa-set with the outcome and assuming that at least one outcome-associated taxon within the set exist, applying AMDA to a high taxonomic rank can provide a useful preliminary screening of the whole microbiome (all species in the community) and facilitate more targeted downstream laboratory-based microbiome fine-mapping and functional studies (Wang and Jia, <xref rid="B38" ref-type="bibr">2016</xref>).</p>
    <p>The AMDA method has two main advantages compared to a traditional individual taxon-based approach. First, it can provide new biological and biomedical insights. The joint modeling of all taxa in the set is able to capture conditional effects of taxa that are missed in the traditional individual taxon-based approach, and thus new insights can be gained by shifting the analysis unit to a higher taxonomic rank. Second, it is statistically powerful by aggregating marginal signals of individual taxon and reducing the multiple testing burden. By adaptively choosing the subset being tested, our AMDA further boosts the statistical testing power compared to existing taxa set-based differential abundance analyses (e.g., MiRKAT). Moreover, the adaptive strategy used in AMDA could be easily extended to other hypothesis testing framework (e.g., association testing) beyond the two-sample problem considered in this paper. We conducted comprehensive numerical simulation studies to show the superior performance of AMDA over existing approaches in terms of maintaining the correct type I error while having a higher power to detect a true difference. The potential usefulness of AMDA was further demonstrated via its application to an oral microbiome data, where AMDA tends to detect more significant differences than its competitors.</p>
    <p>For illustration of our method, we applied the Gaussian kernel-based MMD test, which has been shown to be a consistent two-sample test (Gretton et al., <xref rid="B16" ref-type="bibr">2007</xref>, <xref rid="B17" ref-type="bibr">2012</xref>). The numerical performance of AMDA using other kernels including Unifrac and Bray-Curtis (Zhao et al., <xref rid="B47" ref-type="bibr">2015</xref>) is similar to the one based on the Gaussian kernel (data not shown). As the field matures, more complex (such as family-based and longitudinal) study designs have become increasingly popular in the scientific community to study the association between microbiome and various clinical and biological covariates. This is partially because these advanced designs can be more efficient to control potential confounders compared to the population-based studies with unrelated individuals. The current adaptive multivariate microbiome differential abundance analysis is developed for independent samples. It is of further interest to extend it to accommodate correlated microbiome samples collected from a study using such a complex design. The current permutation-based testing subset selection procedure has been shown to have better numerical performance in terms of selecting more signals into testing subset than existing methods across a wide range of scenarios. Yet, any theoretical guarantees of this permutation-based selection procedure is largely unknown. It is also of interest to further incorporate the phylogenetic tree information into AMDA to facilitate a comprehensive microbiome differential abundance analysis besides applying AMDA to one taxonnomic rank of the tree each time. We believe these issues are of importance and warrant further investigation.</p>
  </sec>
  <sec id="s5">
    <title>Ethics Statement</title>
    <p>This study involves only secondary analyses, where all the utilized data sets are published in a previous study.</p>
  </sec>
  <sec id="s6">
    <title>Author Contributions</title>
    <p>KB and NZ analyzed the data, drafted the paper, prepared figures and tables, AS and LX conducted the testing subset simulations, SH and FM provided and helped analyze the oral microbiome data. RW contributed substantial expertise to improve the paper and revised the paper. XZ conceived and designed the experiments, analyzed the data, wrote the paper, and software. All authors read and approved the final manuscript.</p>
    <sec>
      <title>Conflict of Interest Statement</title>
      <p>The authors declare that this study received funding from a National Institutes of Mental Health STTR award (R41 MH111347) to Quadrant Biosciences, Inc. Quadrant Biosciences was involved with study design, and data collection for the RNA sequencing results employed in this study's secondary data analysis (autism microbiome data). SH and FM serve on the scientific and medical advisory boards of Quadrant Biosciences Inc., and SH is a paid consultant for Quadrant Biosciences Inc. The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.</p>
    </sec>
  </sec>
</body>
<back>
  <ack>
    <p>The authors would like to thank the Associate Editor and two reviewers for their insightful comments that improved the paper. Funding was provided by Quadrant Biosciences Inc. (Research agreement with SH) and NIH STAR (R41 MH111347).</p>
  </ack>
  <fn-group>
    <fn fn-type="financial-disclosure">
      <p><bold>Funding.</bold> This work was supported by Quadrant Biosciences Inc. (Research agreement with SH), the National Institutes of Health grants R41 MH111347 (FM), P50 DA039838 (LX) and National Science Foundation grant DMS-1811552 (LX).</p>
    </fn>
  </fn-group>
  <sec sec-type="supplementary-material" id="s7">
    <title>Supplementary Material</title>
    <p>The Supplementary Material for this article can be found online at: <ext-link ext-link-type="uri" xlink:href="https://www.frontiersin.org/articles/10.3389/fgene.2019.00350/full#supplementary-material">https://www.frontiersin.org/articles/10.3389/fgene.2019.00350/full#supplementary-material</ext-link></p>
    <supplementary-material content-type="local-data" id="SM1">
      <media xlink:href="Data_Sheet_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
  <ref-list>
    <title>References</title>
    <ref id="B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ainsworth</surname><given-names>D.</given-names></name><name><surname>Sternberg</surname><given-names>M. J.</given-names></name><name><surname>Raczy</surname><given-names>C.</given-names></name><name><surname>Butcher</surname><given-names>S. A.</given-names></name></person-group> (<year>2017</year>). <article-title>k-slam: accurate and ultra-fast taxonomic classification and gene identification for large metagenomic data sets</article-title>. <source>Nucleic Acids Res.</source>
<volume>45</volume>, <fpage>1649</fpage>–<lpage>1656</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkw1248</pub-id><?supplied-pmid 27965413?><pub-id pub-id-type="pmid">27965413</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Aitchison</surname><given-names>J.</given-names></name></person-group> (<year>1982</year>). <article-title>The statistical analysis of compositional data</article-title>. <source>J. R. Stat. Soc. Ser. B</source>
<volume>44</volume>, <fpage>139</fpage>–<lpage>177</lpage>.</mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S.</given-names></name><name><surname>Huber</surname><given-names>W.</given-names></name></person-group> (<year>2010</year>). <article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biol.</source>
<volume>11</volume>:<fpage>R106</fpage>. <pub-id pub-id-type="doi">10.1186/gb-2010-11-10-r106</pub-id><?supplied-pmid 20979621?><pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Atchison</surname><given-names>J.</given-names></name><name><surname>Shen</surname><given-names>S. M.</given-names></name></person-group> (<year>1980</year>). <article-title>Logistic-normal distributions: Some properties and uses</article-title>. <source>Biometrika</source>
<volume>67</volume>, <fpage>261</fpage>–<lpage>272</lpage>.</mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Bai</surname><given-names>Z.</given-names></name><name><surname>Saranadasa</surname><given-names>H.</given-names></name></person-group> (<year>1996</year>). <article-title>Effect of high dimension: by an example of a two sample problem</article-title>. <source>Stat. Sin.</source>
<volume>6</volume>, <fpage>311</fpage>–<lpage>329</lpage>.</mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Barber</surname><given-names>R. F.</given-names></name><name><surname>Candès</surname><given-names>E. J.</given-names></name></person-group> (<year>2015</year>). <article-title>Controlling the false discovery rate via knockoffs</article-title>. <source>Ann. Stat.</source>
<volume>43</volume>, <fpage>2055</fpage>–<lpage>2085</lpage>. <pub-id pub-id-type="doi">10.1214/15-AOS1337</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname><given-names>Y.</given-names></name><name><surname>Hochberg</surname><given-names>Y.</given-names></name></person-group> (<year>1995</year>). <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>J. R. Stat. Soc. Ser.</source>
<volume>57</volume>, <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Benjamini</surname><given-names>Y.</given-names></name><name><surname>Yekutieli</surname><given-names>D.</given-names></name></person-group> (<year>2001</year>). <article-title>The control of the false discovery rate in multiple testing under dependency</article-title>. <source>Ann. Stat.</source>
<volume>29</volume>, <fpage>1165</fpage>–<lpage>1188</lpage>. <pub-id pub-id-type="doi">10.1214/aos/1013699998</pub-id></mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cai</surname><given-names>T.</given-names></name><name><surname>Lin</surname><given-names>X.</given-names></name><name><surname>Carroll</surname><given-names>R. J.</given-names></name></person-group> (<year>2012</year>). <article-title>Identifying genetic marker sets associated with phenotypes via an efficient adaptive score test</article-title>. <source>Biostatistics</source>
<volume>13</volume>, <fpage>776</fpage>–<lpage>790</lpage>. <pub-id pub-id-type="doi">10.1093/biostatistics/kxs015</pub-id><?supplied-pmid 22734045?><pub-id pub-id-type="pmid">22734045</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cai</surname><given-names>T.</given-names></name><name><surname>Liu</surname><given-names>W.</given-names></name><name><surname>Xia</surname><given-names>Y.</given-names></name></person-group> (<year>2014</year>). <article-title>Two-sample test of high dimensional means under dependence</article-title>. <source>J. R. Stat. Soc.</source>
<volume>76</volume>, <fpage>349</fpage>–<lpage>372</lpage>. <pub-id pub-id-type="doi">10.1111/rssb.12034</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Candes</surname><given-names>E.</given-names></name><name><surname>Fan</surname><given-names>Y.</given-names></name><name><surname>Janson</surname><given-names>L.</given-names></name><name><surname>Lv</surname><given-names>J.</given-names></name></person-group> (<year>2018</year>). <article-title>Panning for gold: model–X knockoffs for high dimensional controlled variable selection</article-title>. <source>J. R. Stat. Soc.</source>
<volume>80</volume>, <fpage>551</fpage>–<lpage>577</lpage>. <pub-id pub-id-type="doi">10.1111/rssb.12265</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Cao</surname><given-names>Y.</given-names></name><name><surname>Lin</surname><given-names>W.</given-names></name><name><surname>Li</surname><given-names>H.</given-names></name></person-group> (<year>2017</year>). <article-title>Two-sample tests of high-dimensional means for compositional data</article-title>. <source>Biometrika</source>
<volume>105</volume>, <fpage>115</fpage>–<lpage>132</lpage>. <pub-id pub-id-type="doi">10.1093/biomet/asx060</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J.</given-names></name><name><surname>Chen</surname><given-names>W.</given-names></name><name><surname>Zhao</surname><given-names>N.</given-names></name><name><surname>Wu</surname><given-names>M. C.</given-names></name><name><surname>Schaid</surname><given-names>D. J.</given-names></name></person-group> (<year>2016</year>). <article-title>Small sample kernel association tests for human genetic and microbiome association studies</article-title>. <source>Genet. Epidemiol.</source>
<volume>40</volume>, <fpage>5</fpage>–<lpage>19</lpage>. <pub-id pub-id-type="doi">10.1002/gepi.21934</pub-id><?supplied-pmid 26643881?><pub-id pub-id-type="pmid">26643881</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>J.</given-names></name><name><surname>King</surname><given-names>E.</given-names></name><name><surname>Deek</surname><given-names>R.</given-names></name><name><surname>Wei</surname><given-names>Z.</given-names></name><name><surname>Yu</surname><given-names>Y.</given-names></name><name><surname>Grill</surname><given-names>D.</given-names></name><etal/></person-group>. (<year>2017</year>). <article-title>An omnibus test for differential distribution analysis of microbiome sequencing data</article-title>. <source>Bioinformatics</source><volume>34</volume>, <fpage>643</fpage>–<lpage>651</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btx650</pub-id><?supplied-pmid 29040451?><pub-id pub-id-type="pmid">29040451</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Chen</surname><given-names>S. X.</given-names></name><name><surname>Qin</surname><given-names>Y.-L.</given-names></name></person-group> (<year>2010</year>). <article-title>A two-sample test for high-dimensional data with applications to gene-set testing</article-title>. <source>Ann. Stat.</source>
<volume>38</volume>, <fpage>808</fpage>–<lpage>835</lpage>. <pub-id pub-id-type="doi">10.1214/09-AOS716</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name><surname>Gretton</surname><given-names>A.</given-names></name><name><surname>Borgwardt</surname><given-names>K.</given-names></name><name><surname>Rasch</surname><given-names>M.</given-names></name><name><surname>Schölkopf</surname><given-names>B.</given-names></name><name><surname>Smola</surname><given-names>A.</given-names></name></person-group> (<year>2007</year>). <article-title>A kernel method for the two-sample problem</article-title>, in <source>NIPS</source>
<volume>513</volume>–<fpage>520</fpage>
<publisher-loc>Cambridge, MA</publisher-loc>: <publisher-name>MIT Press</publisher-name>.</mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gretton</surname><given-names>A.</given-names></name><name><surname>Borgwardt</surname><given-names>K. M.</given-names></name><name><surname>Rasch</surname><given-names>M. J.</given-names></name><name><surname>Schölkopf</surname><given-names>B.</given-names></name><name><surname>Smola</surname><given-names>A.</given-names></name></person-group> (<year>2012</year>). <article-title>A kernel two-sample test</article-title>. <source>J. Mach. Learn. Res.</source>
<volume>13</volume>, <fpage>723</fpage>–<lpage>773</lpage>.</mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hawinkel</surname><given-names>S.</given-names></name><name><surname>Mattiello</surname><given-names>F.</given-names></name><name><surname>Bijnens</surname><given-names>L.</given-names></name><name><surname>Thas</surname><given-names>O.</given-names></name></person-group> (<year>2017</year>). <article-title>A broken promise: microbiome differential abundance methods do not control the false discovery rate</article-title>. <source>Brief. Bioinform.</source>
<volume>20</volume>, <fpage>210</fpage>–<lpage>221</lpage>. <pub-id pub-id-type="doi">10.1093/bib/bbx104</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Hicks</surname><given-names>S. D.</given-names></name><name><surname>Uhlig</surname><given-names>R.</given-names></name><name><surname>Afshari</surname><given-names>P.</given-names></name><name><surname>Williams</surname><given-names>J.</given-names></name><name><surname>Chroneos</surname><given-names>M.</given-names></name><name><surname>Tierney-Aves</surname><given-names>C.</given-names></name><etal/></person-group>. (<year>2018</year>). <article-title>Oral microbiome activity in children with autism spectrum disorder</article-title>. <source>Aut. Res.</source><volume>11</volume>, <fpage>1286</fpage>–<lpage>1299</lpage>. <pub-id pub-id-type="doi">10.1002/aur.1972</pub-id><?supplied-pmid 30107083?><pub-id pub-id-type="pmid">30107083</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Koh</surname><given-names>H.</given-names></name><name><surname>Blaser</surname><given-names>M. J.</given-names></name><name><surname>Li</surname><given-names>H.</given-names></name></person-group> (<year>2017</year>). <article-title>A powerful microbiome-based association test and a microbial taxa discovery framework for comprehensive association mapping</article-title>. <source>Microbiome</source>
<volume>5</volume>:<fpage>45</fpage>. <pub-id pub-id-type="doi">10.1186/s40168-017-0262-x</pub-id><?supplied-pmid 28438217?><pub-id pub-id-type="pmid">28438217</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Li</surname><given-names>H.</given-names></name></person-group> (<year>2015</year>). <article-title>Microbiome, metagenomics and high-dimensional compositional data analysis</article-title>. <source>Ann. Rev. Stat. Appl.</source>
<volume>2</volume>, <fpage>73</fpage>–<lpage>94</lpage>. <pub-id pub-id-type="doi">10.1146/annurev-statistics-010814-020351</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Louis</surname><given-names>P.</given-names></name><name><surname>Hold</surname><given-names>G. L.</given-names></name><name><surname>Flint</surname><given-names>H. J.</given-names></name></person-group> (<year>2014</year>). <article-title>The gut microbiota, bacterial metabolites and colorectal cancer</article-title>. <source>Nat. Rev. Microbiol.</source>
<volume>12</volume>:<fpage>661</fpage>. <pub-id pub-id-type="doi">10.1038/nrmicro3344</pub-id><?supplied-pmid 25198138?><pub-id pub-id-type="pmid">25198138</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McArdle</surname><given-names>B. H.</given-names></name><name><surname>Anderson</surname><given-names>M. J.</given-names></name></person-group> (<year>2001</year>). <article-title>Fitting multivariate models to community data: a comment on distance-based redundancy analysis</article-title>. <source>Ecology</source>
<volume>82</volume>, <fpage>290</fpage>–<lpage>297</lpage>. <pub-id pub-id-type="doi">10.1890/0012-9658(2001)082&lt;0290:FMMTCD&gt;2.0.CO;2</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McMurdie</surname><given-names>P. J.</given-names></name><name><surname>Holmes</surname><given-names>S.</given-names></name></person-group> (<year>2014</year>). <article-title>Waste not, want not: why rarefying microbiome data is inadmissible</article-title>. <source>PLoS Comp. Biol.</source>
<volume>10</volume>:<fpage>e1003531</fpage>
<pub-id pub-id-type="doi">10.1371/journal.pcbi.1003531</pub-id></mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mitchell</surname><given-names>C. M.</given-names></name><name><surname>Srinivasan</surname><given-names>S.</given-names></name><name><surname>Zhan</surname><given-names>X.</given-names></name><name><surname>Wu</surname><given-names>M. C.</given-names></name><name><surname>Reed</surname><given-names>S. D.</given-names></name><name><surname>Guthrie</surname><given-names>K. A.</given-names></name><etal/></person-group>. (<year>2017</year>). <article-title>Vaginal microbiota and genitourinary menopausal symptoms: a cross-sectional analysis</article-title>. <source>Menopause</source><volume>24</volume>, <fpage>1160</fpage>–<lpage>1166</lpage>. <pub-id pub-id-type="doi">10.1097/GME.0000000000000904</pub-id><?supplied-pmid 28640154?><pub-id pub-id-type="pmid">28640154</pub-id></mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Morgan</surname><given-names>X. C.</given-names></name><name><surname>Kabakchiev</surname><given-names>B.</given-names></name><name><surname>Waldron</surname><given-names>L.</given-names></name><name><surname>Tyler</surname><given-names>A. D.</given-names></name><name><surname>Tickle</surname><given-names>T. L.</given-names></name><name><surname>Milgrom</surname><given-names>R.</given-names></name><etal/></person-group>. (<year>2015</year>). <article-title>Associations between host gene expression, the mucosal microbiome, and clinical outcome in the pelvic pouch of patients with inflammatory bowel disease</article-title>. <source>Gen. Biol.</source><volume>16</volume>:<fpage>67</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-015-0637-x</pub-id><?supplied-pmid 25887922?><pub-id pub-id-type="pmid">25887922</pub-id></mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pan</surname><given-names>W.</given-names></name><name><surname>Kim</surname><given-names>J.</given-names></name><name><surname>Zhang</surname><given-names>Y.</given-names></name><name><surname>Shen</surname><given-names>X.</given-names></name><name><surname>Wei</surname><given-names>P.</given-names></name></person-group> (<year>2014</year>). <article-title>A powerful and adaptive association test for rare variants</article-title>. <source>Genetics</source>
<volume>197</volume>, <fpage>1081</fpage>–<lpage>95</lpage>. <pub-id pub-id-type="doi">10.1534/genetics.114.165035</pub-id><?supplied-pmid 24831820?><pub-id pub-id-type="pmid">24831820</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Pan</surname><given-names>W.</given-names></name><name><surname>Kwak</surname><given-names>I.-Y.</given-names></name><name><surname>Wei</surname><given-names>P.</given-names></name></person-group> (<year>2015</year>). <article-title>A powerful pathway-based adaptive test for genetic association with common or rare variants</article-title>. <source>Am. J. Hum. Genet.</source>
<volume>97</volume>, <fpage>86</fpage>–<lpage>98</lpage>. <pub-id pub-id-type="doi">10.1016/j.ajhg.2015.05.018</pub-id><pub-id pub-id-type="pmid">26119817</pub-id></mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plantinga</surname><given-names>A.</given-names></name><name><surname>Zhan</surname><given-names>X.</given-names></name><name><surname>Zhao</surname><given-names>N.</given-names></name><name><surname>Chen</surname><given-names>J.</given-names></name><name><surname>Jenq</surname><given-names>R. R.</given-names></name><name><surname>Wu</surname><given-names>M. C.</given-names></name></person-group> (<year>2017</year>). <article-title>Mirkat-s: a community-level test of association between the microbiota and survival times</article-title>. <source>Microbiome</source>
<volume>5</volume>:<fpage>17</fpage>
<pub-id pub-id-type="doi">10.1186/s40168-017-0239-9</pub-id><pub-id pub-id-type="pmid">28179014</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qin</surname><given-names>J.</given-names></name><name><surname>Li</surname><given-names>Y.</given-names></name><name><surname>Cai</surname><given-names>Z.</given-names></name><name><surname>Li</surname><given-names>S.</given-names></name><name><surname>Zhu</surname><given-names>J.</given-names></name><name><surname>Zhang</surname><given-names>F.</given-names></name><etal/></person-group>. (<year>2012</year>). <article-title>A metagenome-wide association study of gut microbiota in type 2 diabetes</article-title>. <source>Nature</source><volume>490</volume>:<fpage>55</fpage>–<lpage>60</lpage>. <pub-id pub-id-type="doi">10.1038/nature11450</pub-id><?supplied-pmid 23023125?><pub-id pub-id-type="pmid">23023125</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Robinson</surname><given-names>M. D.</given-names></name><name><surname>McCarthy</surname><given-names>D. J.</given-names></name><name><surname>Smyth</surname><given-names>G. K.</given-names></name></person-group> (<year>2010</year>). <article-title>edger: a bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics</source>
<volume>26</volume>, <fpage>139</fpage>–<lpage>140</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id><?supplied-pmid 19910308?><pub-id pub-id-type="pmid">19910308</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sohn</surname><given-names>M. B.</given-names></name><name><surname>Du</surname><given-names>R.</given-names></name><name><surname>An</surname><given-names>L.</given-names></name></person-group> (<year>2015</year>). <article-title>A robust approach for identifying differentially abundant features in metagenomic samples</article-title>. <source>Bioinformatics</source>
<volume>31</volume>, <fpage>2269</fpage>–<lpage>2275</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv165</pub-id><?supplied-pmid 25792553?><pub-id pub-id-type="pmid">25792553</pub-id></mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>Z. Z.</given-names></name><name><surname>Chen</surname><given-names>G.</given-names></name><name><surname>Alekseyenko</surname><given-names>A. V.</given-names></name></person-group> (<year>2016</year>). <article-title>Permanova-s: association test for microbial community composition that accommodates confounders and multiple distances</article-title>. <source>Bioinformatics</source>
<volume>32</volume>, <fpage>2618</fpage>–<lpage>2625</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btw311</pub-id><?supplied-pmid 27197815?><pub-id pub-id-type="pmid">27197815</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tang</surname><given-names>Z. Z.</given-names></name><name><surname>Chen</surname><given-names>G.</given-names></name><name><surname>Alekseyenko</surname><given-names>A. V.</given-names></name><name><surname>Li</surname><given-names>H.</given-names></name></person-group> (<year>2017</year>). <article-title>A general framework for association analysis of microbial communities on a taxonomic tree</article-title>. <source>Bioinformatics</source>
<volume>33</volume>, <fpage>1278</fpage>–<lpage>1285</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btw804</pub-id><?supplied-pmid 28003264?><pub-id pub-id-type="pmid">28003264</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Tibshirani</surname><given-names>R.</given-names></name></person-group> (<year>1996</year>). <article-title>Regression shrinkage and selection via the lasso</article-title>. <source>J. R. Stat. Soc. Ser.</source>
<volume>58</volume>, <fpage>267</fpage>–<lpage>288</lpage>.</mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Turnbaugh</surname><given-names>P. J.</given-names></name><name><surname>Hamady</surname><given-names>M.</given-names></name><name><surname>Yatsunenko</surname><given-names>T.</given-names></name><name><surname>Cantarel</surname><given-names>B. L.</given-names></name><name><surname>Duncan</surname><given-names>A.</given-names></name><name><surname>Ley</surname><given-names>R. E.</given-names></name><etal/></person-group>. (<year>2009</year>). <article-title>A core gut microbiome in obese and lean twins</article-title>. <source>Nature</source><volume>457</volume>, <fpage>480</fpage>–<lpage>484</lpage>. <pub-id pub-id-type="doi">10.1038/nature07540</pub-id><?supplied-pmid 19043404?><pub-id pub-id-type="pmid">19043404</pub-id></mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Virgin</surname><given-names>H. W.</given-names></name><name><surname>Todd</surname><given-names>J. A.</given-names></name></person-group> (<year>2011</year>). <article-title>Metagenomics and personalized medicine</article-title>. <source>Cell</source>
<volume>147</volume>, <fpage>44</fpage>–<lpage>56</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2011.09.009</pub-id><?supplied-pmid 21962506?><pub-id pub-id-type="pmid">21962506</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>J.</given-names></name><name><surname>Jia</surname><given-names>H.</given-names></name></person-group> (<year>2016</year>). <article-title>Metagenome-wide association studies: fine-mining the microbiome</article-title>. <source>Nat. Rev. Microbiol.</source>
<volume>14</volume>:<fpage>508</fpage>. <pub-id pub-id-type="doi">10.1038/nrmicro.2016.83</pub-id><?supplied-pmid 27396567?><pub-id pub-id-type="pmid">27396567</pub-id></mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Weiss</surname><given-names>S.</given-names></name><name><surname>Xu</surname><given-names>Z. Z.</given-names></name><name><surname>Peddada</surname><given-names>S.</given-names></name><name><surname>Amir</surname><given-names>A.</given-names></name><name><surname>Bittinger</surname><given-names>K.</given-names></name><name><surname>Gonzalez</surname><given-names>A.</given-names></name><etal/></person-group>. (<year>2017</year>). <article-title>Normalization and microbial differential abundance strategies depend upon data characteristics</article-title>. <source>Microbiome</source><volume>5</volume>:<fpage>27</fpage>. <pub-id pub-id-type="doi">10.1186/s40168-017-0237-y</pub-id><?supplied-pmid 28253908?><pub-id pub-id-type="pmid">28253908</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wu</surname><given-names>C.</given-names></name><name><surname>Chen</surname><given-names>J.</given-names></name><name><surname>Kim</surname><given-names>J.</given-names></name><name><surname>Pan</surname><given-names>W.</given-names></name></person-group> (<year>2016</year>). <article-title>An adaptive association test for microbiome data</article-title>. <source>Gen. Med.</source>
<volume>8</volume>:<fpage>56</fpage>. <pub-id pub-id-type="doi">10.1186/s13073-016-0302-3</pub-id><?supplied-pmid 27198579?><pub-id pub-id-type="pmid">27198579</pub-id></mixed-citation>
    </ref>
    <ref id="B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhan</surname><given-names>X.</given-names></name><name><surname>Epstein</surname><given-names>M. P.</given-names></name><name><surname>Ghosh</surname><given-names>D.</given-names></name></person-group> (<year>2015</year>). <article-title>An adaptive genetic association test using double kernel machines</article-title>. <source>Stat. Biosci.</source>
<volume>7</volume>, <fpage>262</fpage>–<lpage>281</lpage>. <pub-id pub-id-type="doi">10.1007/s12561-014-9116-2</pub-id><?supplied-pmid 26640602?><pub-id pub-id-type="pmid">26640602</pub-id></mixed-citation>
    </ref>
    <ref id="B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhan</surname><given-names>X.</given-names></name><name><surname>Plantinga</surname><given-names>A.</given-names></name><name><surname>Zhao</surname><given-names>N.</given-names></name><name><surname>Wu</surname><given-names>M. C.</given-names></name></person-group> (<year>2017a</year>). <article-title>A fast small-sample kernel independence test for microbiome community-level association analysis</article-title>. <source>Biometrics</source>
<volume>73</volume>, <fpage>1453</fpage>–<lpage>1463</lpage>. <pub-id pub-id-type="doi">10.1111/biom.12684</pub-id><?supplied-pmid 28295177?><pub-id pub-id-type="pmid">28295177</pub-id></mixed-citation>
    </ref>
    <ref id="B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhan</surname><given-names>X.</given-names></name><name><surname>Tong</surname><given-names>X.</given-names></name><name><surname>Zhao</surname><given-names>N.</given-names></name><name><surname>Maity</surname><given-names>A.</given-names></name><name><surname>Wu</surname><given-names>M. C.</given-names></name><name><surname>Chen</surname><given-names>J.</given-names></name></person-group> (<year>2017b</year>). <article-title>A small-sample multivariate kernel machine test for microbiome association studies</article-title>. <source>Gen. Epidemiol.</source>
<volume>41</volume>, <fpage>210</fpage>–<lpage>220</lpage>. <pub-id pub-id-type="doi">10.1002/gepi.22030</pub-id><?supplied-pmid 28019040?><pub-id pub-id-type="pmid">28019040</pub-id></mixed-citation>
    </ref>
    <ref id="B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhan</surname><given-names>X.</given-names></name><name><surname>Xue</surname><given-names>L.</given-names></name><name><surname>Zheng</surname><given-names>H.</given-names></name><name><surname>Plantinga</surname><given-names>A.</given-names></name><name><surname>Wu</surname><given-names>M. C.</given-names></name><name><surname>Schaid</surname><given-names>D. J.</given-names></name><etal/></person-group>. (<year>2018</year>). <article-title>A small-sample kernel association test for correlated data with application to microbiome association studies</article-title>. <source>Gen. Epidemiol.</source><volume>42</volume>, <fpage>772</fpage>–<lpage>782</lpage>. <pub-id pub-id-type="doi">10.1002/gepi.22160</pub-id><?supplied-pmid 30218543?><pub-id pub-id-type="pmid">30218543</pub-id></mixed-citation>
    </ref>
    <ref id="B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>X.</given-names></name><name><surname>Mallick</surname><given-names>H.</given-names></name><name><surname>Yi</surname><given-names>N.</given-names></name></person-group> (<year>2016</year>). <article-title>Zero-inflated negative binomial regression for differential abundance testing in microbiome studies</article-title>. <source>J. Bioinform. Genom.</source>
<volume>2</volume>:<fpage>1</fpage>
<pub-id pub-id-type="doi">10.18454/jbg.2016.2.2.1</pub-id></mixed-citation>
    </ref>
    <ref id="B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhang</surname><given-names>X.</given-names></name><name><surname>Zhang</surname><given-names>D.</given-names></name><name><surname>Jia</surname><given-names>H.</given-names></name><name><surname>Feng</surname><given-names>Q.</given-names></name><name><surname>Wang</surname><given-names>D.</given-names></name><name><surname>Liang</surname><given-names>D.</given-names></name><etal/></person-group>. (<year>2015</year>). <article-title>The oral and gut microbiomes are perturbed in rheumatoid arthritis and partly normalized after treatment</article-title>. <source>Nat. Med.</source><volume>21</volume>:<fpage>895</fpage>. <pub-id pub-id-type="doi">10.1038/nm.3914</pub-id><?supplied-pmid 26214836?><pub-id pub-id-type="pmid">26214836</pub-id></mixed-citation>
    </ref>
    <ref id="B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>N.</given-names></name><name><surname>Chen</surname><given-names>J.</given-names></name><name><surname>Carroll</surname><given-names>I. M.</given-names></name><name><surname>Ringel-Kulka</surname><given-names>T.</given-names></name><name><surname>Epstein</surname><given-names>M. P.</given-names></name><name><surname>Zhou</surname><given-names>H.</given-names></name><etal/></person-group>. (<year>2015</year>). <article-title>Testing in microbiome-profiling studies with mirkat, the microbiome regression-based kernel association test</article-title>. <source>Am. J. Hum. Gen.</source><volume>96</volume>, <fpage>797</fpage>–<lpage>807</lpage>. <pub-id pub-id-type="doi">10.1016/j.ajhg.2015.04.003</pub-id><?supplied-pmid 25957468?><pub-id pub-id-type="pmid">25957468</pub-id></mixed-citation>
    </ref>
    <ref id="B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Zhao</surname><given-names>N.</given-names></name><name><surname>Zhan</surname><given-names>X.</given-names></name><name><surname>Guthrie</surname><given-names>K. A.</given-names></name><name><surname>Mitchell</surname><given-names>C. M.</given-names></name><name><surname>Larson</surname><given-names>J.</given-names></name></person-group> (<year>2018</year>). <article-title>Generalized hotelling's test for paired compositional data with application to human microbiome studies</article-title>. <source>Gen. Epidemiol.</source>
<volume>42</volume>, <fpage>459</fpage>–<lpage>469</lpage>.<pub-id pub-id-type="doi">10.1002/gepi.22127</pub-id><?supplied-pmid 29737047?><pub-id pub-id-type="pmid">29737047</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
