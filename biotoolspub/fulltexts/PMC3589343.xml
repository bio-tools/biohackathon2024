<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-archivearticle1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">PLoS One</journal-id>
    <journal-id journal-id-type="iso-abbrev">PLoS ONE</journal-id>
    <journal-id journal-id-type="publisher-id">plos</journal-id>
    <journal-id journal-id-type="pmc">plosone</journal-id>
    <journal-title-group>
      <journal-title>PLoS ONE</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1932-6203</issn>
    <publisher>
      <publisher-name>Public Library of Science</publisher-name>
      <publisher-loc>San Francisco, USA</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3589343</article-id>
    <article-id pub-id-type="pmid">23472154</article-id>
    <article-id pub-id-type="publisher-id">PONE-D-12-33007</article-id>
    <article-id pub-id-type="doi">10.1371/journal.pone.0058173</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Biology</subject>
        <subj-group>
          <subject>Microbiology</subject>
          <subj-group>
            <subject>Bacterial Pathogens</subject>
            <subj-group>
              <subject>Gram Negative</subject>
              <subject>Salmonella</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Host-Pathogen Interaction</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Computer Science</subject>
        <subj-group>
          <subject>Computer Applications</subject>
          <subj-group>
            <subject>Web-Based Applications</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Computer Modeling</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Mathematics</subject>
        <subj-group>
          <subject>Probability Theory</subject>
          <subj-group>
            <subject>Markov Model</subject>
          </subj-group>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="Discipline-v2">
        <subject>Medicine</subject>
        <subj-group>
          <subject>Clinical Research Design</subject>
          <subj-group>
            <subject>Modeling</subject>
          </subj-group>
        </subj-group>
        <subj-group>
          <subject>Infectious Diseases</subject>
          <subj-group>
            <subject>Infectious Disease Modeling</subject>
          </subj-group>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>T3_MM: A Markov Model Effectively Classifies Bacterial Type III Secretion Signals</article-title>
      <alt-title alt-title-type="running-head">Bacterial Type III Signal Analysis</alt-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Yejun</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sun</surname>
          <given-names>Ming'an</given-names>
        </name>
        <xref ref-type="aff" rid="aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bao</surname>
          <given-names>Hongxia</given-names>
        </name>
        <xref ref-type="aff" rid="aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>White</surname>
          <given-names>Aaron P.</given-names>
        </name>
        <xref ref-type="aff" rid="aff3">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="cor1">
          <sup>*</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="aff1">
      <label>1</label>
      <addr-line>Genomics Research Center, Haerbin Medical University, Harbin, China</addr-line>
    </aff>
    <aff id="aff2">
      <label>2</label>
      <addr-line>School of Life Science, the Chinese University of Hong Kong, Shatin, New Territories, Hong Kong</addr-line>
    </aff>
    <aff id="aff3">
      <label>3</label>
      <addr-line>Vaccine and Infectious Disease Organization, University of Saskatchewan, Saskatoon, Saskatchewan, Canada</addr-line>
    </aff>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Stekel</surname>
          <given-names>Dov Joseph</given-names>
        </name>
        <role>Editor</role>
        <xref ref-type="aff" rid="edit1"/>
      </contrib>
    </contrib-group>
    <aff id="edit1">
      <addr-line>University of Nottingham, United Kingdom</addr-line>
    </aff>
    <author-notes>
      <corresp id="cor1">* E-mail: <email>yejun.wang@gmail.com</email> (YW); <email>Aaron.White@usask.ca</email> (APW)</corresp>
      <fn fn-type="COI-statement">
        <p><bold>Competing Interests: </bold>The authors have declared that no competing interests exist.</p>
      </fn>
      <fn fn-type="con">
        <p>Developed the algorithms: YW MS. Developed the software: YW MS HB. Conceived and designed the experiments: YW. Analyzed the data: YW AW MS HB. Wrote the paper: YW AW.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>5</day>
      <month>3</month>
      <year>2013</year>
    </pub-date>
    <volume>8</volume>
    <issue>3</issue>
    <elocation-id>e58173</elocation-id>
    <history>
      <date date-type="received">
        <day>25</day>
        <month>10</month>
        <year>2012</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>1</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© 2013 Wang et al</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Wang et al</copyright-holder>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are properly credited.</license-p>
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Motivation</title>
        <p>Type III Secretion Systems (T3SSs) play important roles in the interaction between gram-negative bacteria and their hosts. T3SSs function by translocating a group of bacterial effector proteins into the host cytoplasm. The details of specific type III secretion process are yet to be clarified. This research focused on comparing the amino acid composition within the N-terminal 100 amino acids from type III secretion (T3S) signal sequences or non-T3S proteins, specifically whether each residue exerts a constraint on residues found in adjacent positions. We used these comparisons to set up a statistic model to quantitatively model and effectively distinguish T3S effectors.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>In this study, the amino acid composition (Aac) probability profiles conditional on its sequentially preceding position and corresponding amino acids were compared between N-terminal sequences of T3S and non-T3S proteins. The profiles are generally different. A Markov model, namely T3_MM, was consequently designed to calculate the total Aac conditional probability difference, i.e., the likelihood ratio of a sequence being a T3S or a non-T3S protein. With T3_MM, known T3S and non-T3S proteins were found to well approximate two distinct normal distributions. The model could distinguish validated T3S and non-T3S proteins with a 5-fold cross-validation sensitivity of 83.9% at a specificity of 90.3%. T3_MM was also shown to be more robust, accurate, simple, and statistically quantitative, when compared with other T3S protein prediction models. The high effectiveness of T3_MM also indicated the overall Aac difference between N-termini of T3S and non-T3S proteins, and the constraint of Aac exerted by its preceding position and corresponding Aac.</p>
      </sec>
      <sec>
        <title>Availability</title>
        <p>An R package for T3_MM is freely downloadable from: <ext-link ext-link-type="uri" xlink:href="http://biocomputer.bio.cuhk.edu.hk/softwares/T3_MM">http://biocomputer.bio.cuhk.edu.hk/softwares/T3_MM</ext-link>. T3_MM web server: <ext-link ext-link-type="uri" xlink:href="http://biocomputer.bio.cuhk.edu.hk/T3DB/T3_MM.php">http://biocomputer.bio.cuhk.edu.hk/T3DB/T3_MM.php</ext-link>.</p>
      </sec>
    </abstract>
    <funding-group>
      <funding-statement>The authors have no support or funding to report.</funding-statement>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="s1">
    <title>Introduction</title>
    <p>The bacterial type III secretion system (T3SS) is a needle-like hollow secretion apparatus which is expressed on the surface of a wide variety of gram-negative bacteria <xref rid="pone.0058173-Hueck1" ref-type="bibr">[1]</xref>–<xref rid="pone.0058173-Izor1" ref-type="bibr">[4]</xref>. T3SS can mediate the translocation of a group of proteins from bacteria into the cytoplasm of host cells; therefore, it plays an important role in the interactions between bacteria and their hosts <xref rid="pone.0058173-Hueck1" ref-type="bibr">[1]</xref>, <xref rid="pone.0058173-Lindeberg1" ref-type="bibr">[5]</xref>–<xref rid="pone.0058173-Feng1" ref-type="bibr">[6]</xref>. The proteins specifically recognized, secreted and translocated by the T3SS are called type III secreted (T3S) effectors, which exert their biological activities in host cells in concert to cause pathogenicity <xref rid="pone.0058173-Galn1" ref-type="bibr">[7]</xref>.</p>
    <p>The N-termini of T3S effectors have been shown to contain important signals that guide their specific recognition by T3SSs <xref rid="pone.0058173-Karavolos1" ref-type="bibr">[8]</xref>–<xref rid="pone.0058173-Subtil1" ref-type="bibr">[14]</xref>. Due to great diversity, no consensus sequences or common motifs have been identified from this region of T3S effectors <xref rid="pone.0058173-Lloyd2" ref-type="bibr">[10]</xref>, <xref rid="pone.0058173-Arnold1" ref-type="bibr">[15]</xref>–<xref rid="pone.0058173-Arnold2" ref-type="bibr">[16]</xref>. The limited physicochemical property preference of amino acids (e.g., charged and polar) only gave few clues about the specificity of T3S signals <xref rid="pone.0058173-Arnold1" ref-type="bibr">[15]</xref>. It was suggested that N-termini of T3S effectors frequently adopted more flexible secondary or tertiary structure <xref rid="pone.0058173-Galn1" ref-type="bibr">[7]</xref>. However, integration of these secondary structure features and others (such as solvent accessibility) did not facilitate the identification of T3S signal sequences, indicating that these properties in T3S proteins couldn't be distinct from those in non-T3S proteins, and they couldn't be the major factors guiding specific type III recognition <xref rid="pone.0058173-Arnold1" ref-type="bibr">[15]</xref>, <xref rid="pone.0058173-Wang3" ref-type="bibr">[17]</xref>. Till now, very few N-terminal sequences of T3S effectors have been resolved for three-dimensional structures, hindering the observation and inference of the possible recognition specificity of T3S signals. No simple, general and comprehensively-representative features have been observed, which could well distinguish T3S and non-T3S proteins. Consequently, instead, multiple-aspect, subtle, and partially-representative properties of T3S signal sequences were analysed, extracted and combined to train different non-linear classification models <xref rid="pone.0058173-Arnold1" ref-type="bibr">[15]</xref>, <xref rid="pone.0058173-Wang3" ref-type="bibr">[17]</xref>–<xref rid="pone.0058173-Yang1" ref-type="bibr">[20]</xref>. These models greatly prompted the identification of new effectors, and meanwhile facilitated our understanding of type III secretion mechanisms and the evolution of T3S effectors.</p>
    <p>Here, we further explored the features differently represented by T3S and non-T3S proteins. Different amino acids have been observed to be preferred in T3S N-terminal sequences generally <xref rid="pone.0058173-Arnold1" ref-type="bibr">[15]</xref> and position-specifically <xref rid="pone.0058173-Wang3" ref-type="bibr">[17]</xref>. For example, serine is most preferred by T3S signal sequences generally and specifically in most positions <xref rid="pone.0058173-Lloyd2" ref-type="bibr">[10]</xref>, <xref rid="pone.0058173-Arnold1" ref-type="bibr">[15]</xref>, <xref rid="pone.0058173-Wang3" ref-type="bibr">[17]</xref>. Does this mean that a stretch of serines should be theoretically the best optimal T3S signal sequence? Could amino acids in a T3S signal sequence exert some constraint on amino acid composition (Aac) at their sequentially succeeded positions? Furthermore, is this constraint different from that of non-T3S sequences? If so, could these features be used for discriminating T3S proteins? This study aimed to answer these questions.</p>
  </sec>
  <sec id="s2">
    <title>Results</title>
    <sec id="s2a">
      <title>Different Aac Probability Profiles Conditional on Amino Acids at Sequentially Preceding Position</title>
      <p>We previously reported that specific type III secretion guiding signals were buried in the N-terminal 100 amino acid region of T3S effectors <xref rid="pone.0058173-Wang3" ref-type="bibr">[17]</xref>. In this study, N-terminal 100 amino acids of T3S and non-T3S proteins were extracted for feature analysis. The absolute composition of each species of amino acid was calculated and compared between T3S and non-T3S sequences. Furthermore, to observe the constraint of specific amino acids on the Aac at succeeding positions, the conditional probability of each amino acid on each amino acid at the preceding position was also calculated and compared.</p>
      <p>As for absolute composition of single amino acids, T3S sequences had higher proportion of serine, leucine and alanine and lower proportion of tryptophan, cysteine, tyrosine and methionine (<xref ref-type="supplementary-material" rid="pone.0058173.s001">Fig. S1</xref>). However, T3S and non-T3S sequences didn't show marked differences except for serine and tryptophan, with serine being enriched and tryptophan being depleted in T3S sequences (<xref ref-type="supplementary-material" rid="pone.0058173.s001">Fig. S1</xref>).</p>
      <p>For each amino acid, the probability conditional on each type of preceding amino acid was compared with its absolute probability. As shown in <xref ref-type="supplementary-material" rid="pone.0058173.s002">Fig. S2</xref> (marked with star above the bar), there were many amino acids for which the conditional probability was significantly different from their absolute probability in T3S sequences (p&lt;0.05), indicating probabilistic dependence of Aac on its sequentially preceding amino acid. The difference was not significant in non-T3S sequences (data not shown), indicating there was a T3S-specific Aac dependence or constraint. An alternative binomial distribution-based statistics was also adopted to compare the real conditional probability of each amino acid with its expected value under independent hypothesis. The results further confirmed the conclusion about position dependency in T3S sequences (<xref ref-type="fig" rid="pone-0058173-g001">Fig. 1</xref>; red and grey background representing significantly enriched and depleted amino acids in real T3S sequence, respectively; significance set as FDR &lt;0.05). The T3S-specific Aac dependence was tested further with the third strategy. On each amino acid, the conditional probability of its succeeding amino acid was ordered and ranked. The rank difference between the conditional and the absolute probability of each type of succeeding amino acid was calculated. There were a lot of cases, which were observed with significant rank difference (absolute value of difference ≥5; <xref ref-type="supplementary-material" rid="pone.0058173.s002">Fig. S2</xref>, marked with upward or downward arrow above the bar). The results further confirmed that the Aac in T3S sequences was influenced by its preceding position.</p>
      <fig id="pone-0058173-g001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0058173.g001</object-id>
        <label>Figure 1</label>
        <caption>
          <title>Distribution of bi-amino acids (bi-aa) with significant difference of Aac conditional probability in T3S signal sequences.</title>
          <p>The vertical and horizontal axis represents the 1<sup>st</sup> and 2<sup>nd</sup> amino acid respectively. A binomial distribution-based statistic test was performed to each amino acid at the second position given the first amino acid. The second amino acid with significantly biased composition compared with theoretical random distribution was highlighted in red (enriched) or grey (depleted) background. The second amino acid with significantly biased composition compared with non-T3S sequences was indicated with an upward (higher in T3S sequences) or downward (depleted in T3S sequences) arrow. Benjamini &amp; Hochberg correction for multiple tests was adopted to control the type I errors <xref rid="pone.0058173-Benjamini1" ref-type="bibr">[30]</xref>. The False Discovery Rate (FDR) was set as ≤0.05.</p>
        </caption>
        <graphic xlink:href="pone.0058173.g001"/>
      </fig>
      <p>Many Aac conditional probabilities on each amino acid at preceding position were significantly different between T3S and non-T3S sequences (<xref ref-type="fig" rid="pone-0058173-g001">Fig. 1</xref>, with upward or downward arrow; significance set as FDR &lt;0.05). Notably, the proportion of leucine was generally lower in T3S sequences than in non-T3S sequences, though it was frequently enriched after different types of amino acids in T3S sequences (<xref ref-type="fig" rid="pone-0058173-g001">Fig. 1</xref>). Similarly, alanine was no longer differentially composed between T3S and non-T3S sequences; cysteine, histidine and methionine were not strikingly depleted in T3S sequences compared with non-T3S sequences (<xref ref-type="fig" rid="pone-0058173-g001">Fig. 1</xref>). Some other amino acids, e.g., aspartic acid and glutamine, were frequently higher while valine was frequently lower in T3S than non-T3S sequences, though they were not significantly enriched or depleted in T3S sequences (<xref ref-type="fig" rid="pone-0058173-g001">Fig. 1</xref>).</p>
      <p>The ranks of Aac conditional probabilities on each amino acid at preceding position also showed an apparent difference between T3S and non-T3S sequences (<xref ref-type="supplementary-material" rid="pone.0058173.s002">Fig. S2</xref>; marked with backward or forward arrow below the bar). This difference could be caused by the superimposed or loosened constraint by adjacent position in T3S proteins (or in non-T3S proteins). For example, when the first position is isoleucine, the ranks of asparagine and valine were apparently different in T3S and non-T3S sequences (<xref ref-type="supplementary-material" rid="pone.0058173.s002">Fig. S2</xref>). The higher and lower order of asparagine and valine composition in T3S than non-T3S sequences, was potentially caused by the increased and decreased asparagine and valine after isoleucine, respectively, in T3S sequences (<xref ref-type="supplementary-material" rid="pone.0058173.s002">Fig. S2</xref>). There were many similar examples, such as ‘NI’ and ‘NG’, ‘PP’ and ‘PR’, ‘WN’ and ‘WK’, and so on (<xref ref-type="supplementary-material" rid="pone.0058173.s002">Fig. S2</xref>). Therefore, there were different Aac probability profiles conditional on amino acids at sequentially preceding position in T3S and non-T3S sequences.</p>
      <p><xref ref-type="supplementary-material" rid="pone.0058173.s002">Fig. S2</xref> also demonstrated a trend that serine was preferred after each type of amino acid in the preceding position in T3S sequences. However, statistically, the dimer ‘SS’ was not most significantly enriched when compared to other dimers (<xref ref-type="supplementary-material" rid="pone.0058173.s002">Fig. S2</xref>). The occurrence rank of ‘SS’ among dimers beginning with ‘S’ was not most significantly different between T3S and non-T3S sequences (<xref ref-type="supplementary-material" rid="pone.0058173.s002">Fig. S2</xref>). This might partly explain why a continual stretch of serines was not frequently found in N-terminal sequences of T3S proteins.</p>
    </sec>
    <sec id="s2b">
      <title>Probabilistic Modeling of the Overall Difference of Conditional Probability Profiles between T3S and Non-T3S Proteins</title>
      <p>A sequential likelihood ratio variable based on Markov model, <italic>R</italic>, was created to measure the overall difference of conditional probability profiles on position-adjacent Aac between T3S and non-T3S proteins (<xref ref-type="sec" rid="s4">Methods</xref>). The <italic>R</italic> values were calculated and statistically analyzed for T3S and non-T3S sequences.</p>
      <p>As shown in <xref ref-type="fig" rid="pone-0058173-g002">Fig. 2A</xref>, the <italic>R</italic> values for T3S and non-T3S sequences could be fit to two distinct distributions. According to the forms, the distribution of T3S <italic>R</italic> values was approximated to a normal distribution with a mean of 0.28 and a standard deviation of 0.26, while the distribution of non-T3S <italic>R</italic> values was approximated to another normal distribution with a mean of −0.28 and a standard deviation of 0.22 (<xref ref-type="fig" rid="pone-0058173-g002">Fig. 2A</xref>). Both normal Q–Q plot analysis and Shapiro-Wilk normality test supported the normal approximation for the two distributions (<xref ref-type="fig" rid="pone-0058173-g002">Fig. 2A</xref>).</p>
      <fig id="pone-0058173-g002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0058173.g002</object-id>
        <label>Figure 2</label>
        <caption>
          <title>Probabilistically modelling the overall difference of conditional probability profiles of T3S and non-T3S sequences.</title>
          <p>The distribution (black curves) and normal approximations (grey curves) of T3S and non-T3S <italic>R</italic> values (A) and weighted <italic>R</italic> values (B) were shown. The means of approximated normal distributions were also indicated. For each normal approximation, the Normal Q–Q plot and Shapiro-Wilk normality test results were shown nearby corresponding distribution curve.</p>
        </caption>
        <graphic xlink:href="pone.0058173.g002"/>
      </fig>
      <p>The absolute probabilities of individual amino acids were considered as coefficients to calculate the weighted <italic>R</italic> values of T3S and non-T3S sequences. Like <italic>R</italic> values, the weighted <italic>R</italic> values of two types of proteins also followed distinct approximated normal distribution (mean and standard deviation were respectively 0.29 and 0.24 for T3S sequences, and −0.29 and 0.22 for non-T3S sequences) (<xref ref-type="fig" rid="pone-0058173-g002">Fig. 2B</xref>).</p>
    </sec>
    <sec id="s2c">
      <title>Classification of T3S Signal Sequences Based on <italic>R</italic> and Derived Values</title>
      <p>Based on the probabilistic modeling results, a protein could be classified as T3S or non-T3S sequence according to a selected cutoff <italic>R</italic> value. The training dataset with 154 putative T3S effectors and 308 non-T3S proteins were used for classifying performance evaluation (<xref ref-type="supplementary-material" rid="pone.0058173.s008">Text S1</xref>).</p>
      <p>With T3_MM, the prediction model based on distribution of <italic>R</italic> values, the sensitivity and selectivity varied with different cutoff values (<xref ref-type="fig" rid="pone-0058173-g003">Fig. 3</xref>). According to the ROC curve, an optimized cutoff was selected, ensuring the best distinguishing power. For T3_MM, a cutoff <italic>R</italic> value of 0 could well distinguish T3S sequences, with a sensitivity of 89.6% at a selectivity of 90.9% (<xref ref-type="fig" rid="pone-0058173-g003">Fig. 3</xref> and <xref ref-type="table" rid="pone-0058173-t001">Table 1</xref>). The cutoff based on ROC curve was very similar to the discriminant function resulted value (−0.025, <xref ref-type="sec" rid="s4">Methods</xref>).</p>
      <fig id="pone-0058173-g003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0058173.g003</object-id>
        <label>Figure 3</label>
        <caption>
          <title>Receiver Operating Characteristic curves of different T3S protein classification models.</title>
          <p>The point of cutoff value (<italic>R</italic> = 0) was indicated with a black rectangle and an arrow.</p>
        </caption>
        <graphic xlink:href="pone.0058173.g003"/>
      </fig>
      <table-wrap id="pone-0058173-t001" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0058173.t001</object-id>
        <label>Table 1</label>
        <caption>
          <title>The classifying performance of different models on T3S and non-T3S training data.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0058173-t001-1" xlink:href="pone.0058173.t001"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Model</td>
                <td align="left" rowspan="1" colspan="1">Cutoff value</td>
                <td align="left" rowspan="1" colspan="1"><italic>S<sub>n</sub></italic> (%) vs. <italic>S<sub>p</sub></italic> (%)</td>
                <td align="left" rowspan="1" colspan="1"><italic>A</italic> (%)</td>
                <td align="left" rowspan="1" colspan="1">MCC</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">T3_MM</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">89.61 vs. 90.91</td>
                <td align="left" rowspan="1" colspan="1">90.48</td>
                <td align="left" rowspan="1" colspan="1">0.7911</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">wT3_MM</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">87.66 vs. 90.26</td>
                <td align="left" rowspan="1" colspan="1">89.39</td>
                <td align="left" rowspan="1" colspan="1">0.7666</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">T3_iAA</td>
                <td align="left" rowspan="1" colspan="1">0</td>
                <td align="left" rowspan="1" colspan="1">79.22 vs. 86.04</td>
                <td align="left" rowspan="1" colspan="1">83.77</td>
                <td align="left" rowspan="1" colspan="1">0.6420</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt101">
            <label/>
            <p>The parameters were calculated based on training-reclassifying results for training dataset.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>The performance of weighted <italic>R</italic> values based model (wT3_MM) and individual amino acid probability based model (T3_iAA) were also evaluated, and compared with that of T3_MM (<xref ref-type="fig" rid="pone-0058173-g003">Fig. 3</xref> and <xref ref-type="table" rid="pone-0058173-t001">Table 1</xref>). As shown by the ROC figure and different performance parameters, T3_MM was best among all three models, though the difference between T3_MM and wT3_MM was not striking (<xref ref-type="fig" rid="pone-0058173-g003">Fig. 3</xref> and <xref ref-type="table" rid="pone-0058173-t001">Table 1</xref>). Both T3_MM and wT3_MM significantly outperformed T3_iAA, with respect to sensitivity, specificity, accuracy, MCC, and others (<xref ref-type="fig" rid="pone-0058173-g003">Fig. 3</xref> and <xref ref-type="table" rid="pone-0058173-t001">Table 1</xref>).</p>
      <p>Support Vector Machine (SVM), Generalized Linear Model (GLM) and RandomForest (RF) models were also used to train the Aac conditional probability features. Among them, SVM could achieve a better specificity but at a loss of sensitivity and accuracy (<xref ref-type="supplementary-material" rid="pone.0058173.s003">Table S1</xref>). The other two models, however, performed significantly worse than T3_MM (<xref ref-type="supplementary-material" rid="pone.0058173.s003">Table S1</xref>).</p>
    </sec>
    <sec id="s2d">
      <title>Performance Evaluation and Comparison of T3_MM and other Established T3S Protein Prediction <xref ref-type="sec" rid="s4">Methods</xref>
</title>
      <p>To better evaluate the performance of T3_MM to predict T3S signal sequences, a 5-fold cross validation strategy was adopted to the training datasets. As shown in <xref ref-type="table" rid="pone-0058173-t002">Table 2</xref>, the method achieved an average sensitivity of ∼ 83.9% at a specificity of ∼ 90.3%. There are other well-established software programs to predict T3S proteins, among which BPBAac and Effective T3 were reported with best performance <xref rid="pone.0058173-Arnold1" ref-type="bibr">[15]</xref>, <xref rid="pone.0058173-Wang3" ref-type="bibr">[17]</xref>. With the same training dataset, all the parameters including sensitivity, specificity, accuracy, and MCC, showed that, T3_MM performed better than Effective T3 (<xref ref-type="table" rid="pone-0058173-t002">Table 2</xref>) and other softwares such as SIEVE, SSE-ACC, etc. (data not shown). However, BPBAac achieved better performance than T3_MM (<xref ref-type="table" rid="pone-0058173-t002">Table 2</xref>).</p>
      <table-wrap id="pone-0058173-t002" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0058173.t002</object-id>
        <label>Table 2</label>
        <caption>
          <title>Performance comparison between T3_MM, BPBAac and Effective T3 on training dataset.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0058173-t002-2" xlink:href="pone.0058173.t002"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Software</td>
                <td align="left" rowspan="1" colspan="1"><italic>S<sub>n</sub></italic> (%)</td>
                <td align="left" rowspan="1" colspan="1"><italic>S<sub>p</sub></italic> (%)</td>
                <td align="left" rowspan="1" colspan="1"><italic>A</italic> (%)</td>
                <td align="left" rowspan="1" colspan="1">MCC</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">T3_MM</td>
                <td align="left" rowspan="1" colspan="1">83.87 (±5.10)</td>
                <td align="left" rowspan="1" colspan="1">90.32 (±5.93)</td>
                <td align="left" rowspan="1" colspan="1">88.17 (±3.10)</td>
                <td align="left" rowspan="1" colspan="1">0.7362</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">BPBAac</td>
                <td align="left" rowspan="1" colspan="1">90.97 (±7.70)</td>
                <td align="left" rowspan="1" colspan="1">97.42 (±4.05)</td>
                <td align="left" rowspan="1" colspan="1">95.27 (±2.57)</td>
                <td align="left" rowspan="1" colspan="1">0.8929</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Effective T3</td>
                <td align="left" rowspan="1" colspan="1">82.53 (±6.69)</td>
                <td align="left" rowspan="1" colspan="1">86.63 (±5.42)</td>
                <td align="left" rowspan="1" colspan="1">86.69 (±3.68)</td>
                <td align="left" rowspan="1" colspan="1">0.6852</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt102">
            <label/>
            <p>The parameters were evaluated based on a 5-fold cross-validation strategy. The standard deviations for <italic>Sn</italic>, <italic>Sp</italic> and <italic>A</italic> were also indicated.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Other new test datasets, of which the sequences were not included in the training dataset, were also collected to further compare the performance of models. A <italic>Ralstonia</italic> T3S and non-T3S protein dataset was tested, from which all the sequences were not included in the training data of T3_MM or Effective T3, and were excluded from the training data of BPBAac model (<xref ref-type="sec" rid="s4">Methods</xref>; <xref ref-type="supplementary-material" rid="pone.0058173.s009">Text S2</xref>) <xref rid="pone.0058173-Mukaihara1" ref-type="bibr">[21]</xref>. As shown in <xref ref-type="table" rid="pone-0058173-t003">Table 3</xref>, T3_MM could most effectively distinguish the T3S and non-T3S proteins, whereas the BPBAac and Effective T3 seemed not very stable, with a quite low recall value even at a comparable (or slightly higher) selectivity.</p>
      <table-wrap id="pone-0058173-t003" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0058173.t003</object-id>
        <label>Table 3</label>
        <caption>
          <title>Performance comparison between T3_MM, BPBAac and Effective T3 on new datasets.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0058173-t003-3" xlink:href="pone.0058173.t003"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Dataset</td>
                <td align="left" rowspan="1" colspan="1">Software</td>
                <td align="left" rowspan="1" colspan="1">Recall (%)<sup>a</sup>
</td>
                <td align="left" rowspan="1" colspan="1">Selectivity (%)<xref ref-type="table-fn" rid="nt104">b</xref>
</td>
                <td align="left" rowspan="1" colspan="1"><italic>A</italic> (%)</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Mukaihara2010</td>
                <td align="left" rowspan="1" colspan="1">T3_MM</td>
                <td align="left" rowspan="1" colspan="1">32/35 (91.43)</td>
                <td align="left" rowspan="1" colspan="1">64/70(91.43)</td>
                <td align="left" rowspan="1" colspan="1">91.43</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">BPBAac</td>
                <td align="left" rowspan="1" colspan="1">21/35 (60.00)</td>
                <td align="left" rowspan="1" colspan="1">67/70(94.87)</td>
                <td align="left" rowspan="1" colspan="1">83.81</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Effective T3</td>
                <td align="left" rowspan="1" colspan="1">20/35(57.14)</td>
                <td align="left" rowspan="1" colspan="1">70/78(92.86)</td>
                <td align="left" rowspan="1" colspan="1">80.95</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Baltrus 2011</td>
                <td align="left" rowspan="1" colspan="1">T3_MM</td>
                <td align="left" rowspan="1" colspan="1">275/291 (94.50)</td>
                <td align="left" rowspan="1" colspan="1">539/582 (92.61)</td>
                <td align="left" rowspan="1" colspan="1">93.24</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">BPBAac</td>
                <td align="left" rowspan="1" colspan="1">234/291 (80.41)</td>
                <td align="left" rowspan="1" colspan="1">558/582 (95.88)</td>
                <td align="left" rowspan="1" colspan="1">90.72</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">Effective T3</td>
                <td align="left" rowspan="1" colspan="1">223/291 (76.63)</td>
                <td align="left" rowspan="1" colspan="1">533/582 (91.58)</td>
                <td align="left" rowspan="1" colspan="1">86.60</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt103">
            <label/>
            <p>Note: <sup>a</sup>‘Recall’ was adopted here instead of sensitivity to describe the number of validated T3S proteins correctly predicted from the total number of T3S proteins. The recall percentage was noted within parentheses after recall value, which was identical to the sensitivity.</p>
          </fn>
          <fn id="nt104">
            <label>b</label>
            <p>‘Selectivity’ was adopted here instead of specificity, to describe the number of non-T3S proteins correctly predicted from the total number of non-T3S proteins. The selectivity percentage was noted within parentheses after selectivity value, which was identical to the specificity.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>To avoid overestimating the general prediction performance of T3_MM based on a specific genus or species, another large-scale T3S dataset from different <italic>Pseudomonas</italic> strains was also included for performance evaluation <xref rid="pone.0058173-Baltrus1" ref-type="bibr">[22]</xref>. Again, T3_MM showed the best classification performance, with marked increase of recall value and general prediction accuracy, at a cost of slightly lowered selectivity (<xref ref-type="table" rid="pone-0058173-t003">Table 3</xref>).</p>
      <p>It is still possible that T3_MM only works well for some specific genera and is not generally applicable. An inter-genera cross validation strategy (<xref ref-type="sec" rid="s4">Methods</xref>) was adopted to observe the inter-genera prediction capability of this <italic>R</italic> value-based model. For most genera, the recall percentage of known effectors was high (∼ 80%) at an acceptable specificity (&gt;85%) (<xref ref-type="fig" rid="pone-0058173-g004">Fig. 4</xref>). Even in the worst case scenario (i.e., classification of <italic>Chlamydia</italic> effectors based on non-<italic>Chlamydia</italic> model), 68% of the known effectors (13/19) were correctly recognized (<xref ref-type="fig" rid="pone-0058173-g004">Fig. 4</xref>).</p>
      <fig id="pone-0058173-g004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0058173.g004</object-id>
        <label>Figure 4</label>
        <caption>
          <title>Inter-species cross validation of the T3S effector predictions.</title>
          <p>The sensitivity (Sn) and specificity (Sp) of classification were shown in blue and purple, respectively. The T3S effector recall of each representative genera or subgroup was also indicated. Genus names are listed below each series of dots.</p>
        </caption>
        <graphic xlink:href="pone.0058173.g004"/>
      </fig>
      <p>Taken together, the T3_MM algortithm was able to efficiently classify T3S proteins from non-T3S proteins with high sensitivity and general prediction accuracy. The model could also be applied to different bacterial genera or phyla. The actual specificity of T3_MM could be higher since the “non-T3S” sequences in the training or testing datasets could contain some unknown effectors.</p>
    </sec>
    <sec id="s2e">
      <title>Amino Acid Composition Properties of T3S Signal Sequences</title>
      <p>Based on the probability matrix and T3_MM model, any given peptide sequence could be calculated for its probability to be a T3S sequence. However, it is extremely computationally demanding to calculate or compare the probability of all possible peptides of length 100 aa. To analyze the preferred and unfavorable amino acid composition in T3S signal sequences, a selected group of continual bi-amino acid (bi-aa) sequences were computationally simulated and classified using T3_MM and BPBAac, respectively (<xref ref-type="supplementary-material" rid="pone.0058173.s004">Table S2</xref>). According to the general composition of single amino acids and the relative composition preference in T3S and non-T3S proteins (<xref ref-type="supplementary-material" rid="pone.0058173.s001">Fig. S1</xref>), a sequence purely composed by serine was expected to have the highest prediction value. Consistent with this hypothesis, BPBAac gave the sequence formed by continuous serines the highest score, since the serine composition in most positions was apparently higher than other amino acids and different between T3S and non-T3S proteins (<xref ref-type="supplementary-material" rid="pone.0058173.s004">Table S2</xref>; <xref ref-type="table" rid="pone-0058173-t004">Table 4</xref>). T3_MM, however, predicted that a string of proline and ‘NS’ (together with ‘SN’ because ‘SN’ could not be excluded from the continual ‘NS’ string) were more likely to be T3S secreted sequences (<xref ref-type="supplementary-material" rid="pone.0058173.s004">Table S2</xref>; <xref ref-type="table" rid="pone-0058173-t004">Table 4</xref>). The discrepancy between T3_MM and BPBAac results was likely caused by the different basis of the T3_MM model: dependence on sequentially adjacent amino acids rather than absolute or relative composition of individual amino acids. The bi-aa composition of ‘PP’ or ‘NS’ was significantly different between T3S and non-T3S sequences, and the difference was more marked than ‘SS’, leading to the higher T3_MM prediction score for ‘PP’ or ‘NS’ than ‘SS’ string (<xref ref-type="fig" rid="pone-0058173-g001">Fig. 1</xref>). Similarly, BPBAac frequently scored bi-aa strings higher values if either of the two amino acids were selectively preferred by T3S proteins, such as ‘SX’ or ‘XS’, where ‘X’ represented any amino acid (<xref ref-type="supplementary-material" rid="pone.0058173.s004">Table S2</xref>; <xref ref-type="table" rid="pone-0058173-t004">Table 4</xref>). In contrast, T3_MM often gave these bi-aa strings different prediction values. For example, all the ‘SX’ or ‘XS’ strings were predicted with high scores using BPBAac, while the scores predicted by T3_MM were apparently different, with 3 pairs of strings (‘SC’/‘CS’, ‘SW’/’WS’, and ‘SM’/‘MS’) classified as non-T3S sequences (<xref ref-type="supplementary-material" rid="pone.0058173.s004">Table S2</xref>). Moreover, some amino acids were either not enriched in T3S signal sequences, or not differently preferred by T3S and non-T3S sequences, such as isoleucine and cysteine (<xref ref-type="supplementary-material" rid="pone.0058173.s001">Fig. S1</xref>). Therefore, most ‘CX’/‘XC’ and ‘IX’/‘XI’ strings (including ‘CI’/‘IC’ string) were predicted by BPBAac to be non-T3S sequences (<xref ref-type="supplementary-material" rid="pone.0058173.s004">Table S2</xref>). T3_MM also classified strings solely composed of isoleucine or cysteine as non-T3S proteins (<xref ref-type="supplementary-material" rid="pone.0058173.s004">Table S2</xref>). However, the bi-aa composition of ‘IC’ or ‘CI’ conditional on the preceding amino acid (‘I’ or ‘C’, respectively) was significantly different between T3S and non-T3S proteins, and consequently, T3_MM gave ‘IC’/‘CI’ strings quite high score and classified them to be T3S sequences (<xref ref-type="supplementary-material" rid="pone.0058173.s004">Table S2</xref>). The 30 bi-aa sequences given the highest and lowest prediction scores with T3_MM and BPBAac, respectively are shown in <xref ref-type="table" rid="pone-0058173-t004">Table 4</xref>.</p>
      <table-wrap id="pone-0058173-t004" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0058173.t004</object-id>
        <label>Table 4</label>
        <caption>
          <title>The 30 simulated bi-aa sequences of highest (Pos) and lowest (Neg) prediction scores with T3_MM and BPBAac.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0058173-t004-4" xlink:href="pone.0058173.t004"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">T3_MM_Pos</td>
                <td align="left" rowspan="1" colspan="1">T3_MM_Neg</td>
                <td align="left" rowspan="1" colspan="1">BPBAac_Pos</td>
                <td align="left" rowspan="1" colspan="1">BPBAac_Neg</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">(PP)<sub>50</sub>
<sup>a</sup>
</td>
                <td align="left" rowspan="1" colspan="1">(PW|WP)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(SS)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(VV)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(NS|SN)<sub>50</sub>
<sup> b</sup>
</td>
                <td align="left" rowspan="1" colspan="1">(HY|YH)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(PS)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(VD)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(SS)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(DW|WD)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(TS)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(VY)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(NI|IN)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(RC|CR)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(QS)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(VI)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(IC|CI)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(RW|WR)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(RS)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(VG)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(TT)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(GC|CG)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(SP)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(VF)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(ST|TS)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(YY)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(NS)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(FV)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(DH|HD)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(WY|YW)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(ST)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(VK)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(MY|YM)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(WK|KW)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(ES)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(VM)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(CL|LC)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(TC|CT)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(GS)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(FD)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(NH|HN)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(WI|IW)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(IS)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(KV)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(NN)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(HW|WH)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(SN)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(VW)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(QT|TQ)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(WA|AW)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(SR)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(FG)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(AP|PA)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(WF|FW)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(SQ)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(VC)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(NT|TN)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(DY|YD)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(DS)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(KD)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(PS|SP)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(LW|WL)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(LS)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(VE)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(PT|TP)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(KC|CK)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(SE)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(KY)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(IQ|QI)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(MV|VM)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(AS)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(FI)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(HK|KH)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(MC|CM)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(KS)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(FY)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(KF|FK)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(CA|AC)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(SG)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(KI)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(HM|MH)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(DC|CD)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(SA)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(YV)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(QS|SQ)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(VI|IV)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(SL)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(KG)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(AS|SA)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(VY|YV)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(VS)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(FF)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(HH)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(TW|WT)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(SK)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(KF)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(CN|NC)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(QC|CQ)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(SV)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(FK)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(VN|NV)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(YF|FY)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(SD)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(VL)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(ME|EM)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(GM|MG)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(SI)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(YD)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(KK)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(CC)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(HS)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(YG)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(KM|MK)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(MA|AM)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(PP)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(KK)<sub>50</sub>
</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">(QH|HQ)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(VV)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(SH)<sub>50</sub>
</td>
                <td align="left" rowspan="1" colspan="1">(GY)<sub>50</sub>
</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
        <table-wrap-foot>
          <fn id="nt105">
            <label/>
            <p>Note: <sup>a.</sup> (bi-residue)<sub>50</sub> means a 100-residue sequence with 50-time repeats of the indicated bi-residue. <sup>b.</sup> The character ‘|’ means ‘or’. The higher <italic>R</italic> value for T3_MM or SVM score for BPBAac, the more possibly being T3S effectors; vice versa.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Because there are too many combinations of amino acids in 100 positions, we cannot test all possible peptides with the method described above. A dynamic programming algorithm was further designed to find out the most favorable and unfavorable signal sequences for T3S recognition. The results were shown in <xref ref-type="table" rid="pone-0058173-t005">Table 5</xref>. The continual stretch of proline was found to be most favorable. Interestingly, in the most unfavorable T3S sequence, proline covered nearly 1/3 of the total 100 positions (<xref ref-type="table" rid="pone-0058173-t005">Table 5</xref>) further demonstrating the significant constraint imposed by adjacent amino acids in T3S sequences. The most favorable and unfavorable T3S sequences were also classified with BPBAac, with a confidently high and a low SVM score, respectively (<xref ref-type="table" rid="pone-0058173-t005">Table 5</xref>).</p>
      <table-wrap id="pone-0058173-t005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0058173.t005</object-id>
        <label>Table 5</label>
        <caption>
          <title>The most favorable and unfavorable T3S peptide sequence inferred by dynamic programming algorithm.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0058173-t005-5" xlink:href="pone.0058173.t005"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Property</td>
                <td align="left" rowspan="1" colspan="1">Sequence</td>
                <td align="left" rowspan="1" colspan="1">T3_MM_<italic>R</italic>_value</td>
                <td align="left" rowspan="1" colspan="1">BPBAac_SVM</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">Most_favorable</td>
                <td align="left" rowspan="1" colspan="1">PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP</td>
                <td align="left" rowspan="1" colspan="1">4.09</td>
                <td align="left" rowspan="1" colspan="1">1.72</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Least_favorable</td>
                <td align="left" rowspan="1" colspan="1">YHWKPWKPWKPWKPWKPWKPWKPWPWKPWKPWKPWKPWKPWKPWKPWKPWKPWKPWKPWKPWKPWKPWKPWKPWKPWKPWKPWKPWPWKPWKPWKPWKPW</td>
                <td align="left" rowspan="1" colspan="1">−4.97</td>
                <td align="left" rowspan="1" colspan="1">−1.13</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
    <sec id="s2f">
      <title>Prediction and Comparison of <italic>Salmonella</italic> T3S Effectors</title>
      <p>T3_MM was applied to predict T3S effectors from <italic>Salmonella</italic> genomes of different serovars (<xref ref-type="sec" rid="s4">Methods</xref>). The number of predicted effectors was generally proportional to the genome size, with the number of T3_MM predicted effectors representing 12.2±1.3% of the total number of genome-encoding proteins. In comparison, the ratio of effector proteins predicted by BPBAac was 5.6±0.5% (<xref ref-type="supplementary-material" rid="pone.0058173.s005">Table S3</xref> and <xref ref-type="supplementary-material" rid="pone.0058173.s006">S4</xref>; <xref ref-type="fig" rid="pone-0058173-g005">Fig. 5</xref> and <xref ref-type="table" rid="pone-0058173-t006">Table 6</xref>). A stable percentage of effectors (about 25% of the number predicted by BPBAac) were predicted by both software programs (<xref ref-type="table" rid="pone-0058173-t006">Table 6</xref>; <xref ref-type="supplementary-material" rid="pone.0058173.s007">Table S5</xref>). For each strain, the number of effectors predicted by T3_MM was about 2-fold of that predicted with BPBAac (2.18±0.29; <xref ref-type="table" rid="pone-0058173-t006">Table 6</xref>). Some recently identified effectors were successfully predicted by T3_MM but not BPBAac. For example, GtgE (i.e., SL14028 STM14_1196 and its orthologs in <italic>S. Typhimurium</italic> strains) was an effector validated recently, which could render <italic>S. typhi</italic> the ability to infect mice (<xref ref-type="supplementary-material" rid="pone.0058173.s005">Table S3</xref> and <xref ref-type="supplementary-material" rid="pone.0058173.s006">S4</xref>) <xref rid="pone.0058173-Span1" ref-type="bibr">[23]</xref>–<xref rid="pone.0058173-Span2" ref-type="bibr">[24]</xref>. GtgE was not included in the training dataset of T3_MM or BPBAac, but it could be recalled by T3_MM rather than BPBAac. Therefore, though at the cost of more possible false positives, the larger number of candidates predicted by T3_MM should also provide more true T3S effectors.</p>
      <fig id="pone-0058173-g005" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0058173.g005</object-id>
        <label>Figure 5</label>
        <caption>
          <title>Summary of the total genome-encoding proteins, T3_MM predicted T3S effectors and BPBAac predicted T3S effectors in <italic>Salmonella</italic>.</title>
          <p>The total protein number for each <italic>Salmonella</italic> strain was depicted and linked with a line in red, while the number of T3S effectors predicted by T3_MM and BPBAac was shown in blue and purple, respectively. The patterns of these three lines were generally similar with moderate difference.</p>
        </caption>
        <graphic xlink:href="pone.0058173.g005"/>
      </fig>
      <table-wrap id="pone-0058173-t006" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0058173.t006</object-id>
        <label>Table 6</label>
        <caption>
          <title>Summary of <italic>Salmonella</italic> effectors predicted by T3_MM and BPBAac.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0058173-t006-6" xlink:href="pone.0058173.t006"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">Strain</td>
                <td align="left" rowspan="1" colspan="1">Total_protein</td>
                <td align="left" rowspan="1" colspan="1">T3_MM_predicted</td>
                <td align="left" rowspan="1" colspan="1">BPBAac_predicted</td>
                <td align="left" rowspan="1" colspan="1">Shared</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">SL1344</td>
                <td align="left" rowspan="1" colspan="1">4527</td>
                <td align="left" rowspan="1" colspan="1">413</td>
                <td align="left" rowspan="1" colspan="1">218</td>
                <td align="left" rowspan="1" colspan="1">51</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">14028s</td>
                <td align="left" rowspan="1" colspan="1">5312</td>
                <td align="left" rowspan="1" colspan="1">746</td>
                <td align="left" rowspan="1" colspan="1">281</td>
                <td align="left" rowspan="1" colspan="1">74</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">LT2</td>
                <td align="left" rowspan="1" colspan="1">4425</td>
                <td align="left" rowspan="1" colspan="1">533</td>
                <td align="left" rowspan="1" colspan="1">263</td>
                <td align="left" rowspan="1" colspan="1">70</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">DT104</td>
                <td align="left" rowspan="1" colspan="1">4585</td>
                <td align="left" rowspan="1" colspan="1">418</td>
                <td align="left" rowspan="1" colspan="1">210</td>
                <td align="left" rowspan="1" colspan="1">53</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">CT18</td>
                <td align="left" rowspan="1" colspan="1">4395</td>
                <td align="left" rowspan="1" colspan="1">528</td>
                <td align="left" rowspan="1" colspan="1">267</td>
                <td align="left" rowspan="1" colspan="1">71</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">Ty2</td>
                <td align="left" rowspan="1" colspan="1">4318</td>
                <td align="left" rowspan="1" colspan="1">516</td>
                <td align="left" rowspan="1" colspan="1">257</td>
                <td align="left" rowspan="1" colspan="1">68</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">287_91</td>
                <td align="left" rowspan="1" colspan="1">3965</td>
                <td align="left" rowspan="1" colspan="1">462</td>
                <td align="left" rowspan="1" colspan="1">245</td>
                <td align="left" rowspan="1" colspan="1">62</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">AKU_12601</td>
                <td align="left" rowspan="1" colspan="1">4074</td>
                <td align="left" rowspan="1" colspan="1">484</td>
                <td align="left" rowspan="1" colspan="1">245</td>
                <td align="left" rowspan="1" colspan="1">65</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">ATCC9150</td>
                <td align="left" rowspan="1" colspan="1">4093</td>
                <td align="left" rowspan="1" colspan="1">483</td>
                <td align="left" rowspan="1" colspan="1">239</td>
                <td align="left" rowspan="1" colspan="1">63</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">CT_02021853</td>
                <td align="left" rowspan="1" colspan="1">4513</td>
                <td align="left" rowspan="1" colspan="1">586</td>
                <td align="left" rowspan="1" colspan="1">250</td>
                <td align="left" rowspan="1" colspan="1">61</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">CVM19633</td>
                <td align="left" rowspan="1" colspan="1">4501</td>
                <td align="left" rowspan="1" colspan="1">575</td>
                <td align="left" rowspan="1" colspan="1">233</td>
                <td align="left" rowspan="1" colspan="1">60</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">NCTC_12419</td>
                <td align="left" rowspan="1" colspan="1">3863</td>
                <td align="left" rowspan="1" colspan="1">455</td>
                <td align="left" rowspan="1" colspan="1">239</td>
                <td align="left" rowspan="1" colspan="1">67</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">P125109</td>
                <td align="left" rowspan="1" colspan="1">4206</td>
                <td align="left" rowspan="1" colspan="1">499</td>
                <td align="left" rowspan="1" colspan="1">260</td>
                <td align="left" rowspan="1" colspan="1">65</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">RKS4594</td>
                <td align="left" rowspan="1" colspan="1">4574</td>
                <td align="left" rowspan="1" colspan="1">571</td>
                <td align="left" rowspan="1" colspan="1">260</td>
                <td align="left" rowspan="1" colspan="1">64</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">RSK2980</td>
                <td align="left" rowspan="1" colspan="1">4500</td>
                <td align="left" rowspan="1" colspan="1">572</td>
                <td align="left" rowspan="1" colspan="1">256</td>
                <td align="left" rowspan="1" colspan="1">64</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SC-B67</td>
                <td align="left" rowspan="1" colspan="1">4427</td>
                <td align="left" rowspan="1" colspan="1">554</td>
                <td align="left" rowspan="1" colspan="1">279</td>
                <td align="left" rowspan="1" colspan="1">69</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SL254</td>
                <td align="left" rowspan="1" colspan="1">4613</td>
                <td align="left" rowspan="1" colspan="1">583</td>
                <td align="left" rowspan="1" colspan="1">252</td>
                <td align="left" rowspan="1" colspan="1">64</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SL476</td>
                <td align="left" rowspan="1" colspan="1">4651</td>
                <td align="left" rowspan="1" colspan="1">575</td>
                <td align="left" rowspan="1" colspan="1">242</td>
                <td align="left" rowspan="1" colspan="1">60</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SL483</td>
                <td align="left" rowspan="1" colspan="1">4562</td>
                <td align="left" rowspan="1" colspan="1">579</td>
                <td align="left" rowspan="1" colspan="1">235</td>
                <td align="left" rowspan="1" colspan="1">57</td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">SPB7</td>
                <td align="left" rowspan="1" colspan="1">5591</td>
                <td align="left" rowspan="1" colspan="1">815</td>
                <td align="left" rowspan="1" colspan="1">280</td>
                <td align="left" rowspan="1" colspan="1">67</td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
      <p>The shared effectors predicted by both T3_MM and BPBAac were further analyzed since these effectors should have both position-specific and adjacent-constraint T3S signal features and therefore could be more likely to be true ones (<xref ref-type="supplementary-material" rid="pone.0058173.s007">Table S5</xref>). There were 70 effectors predicted by both programs in <italic>S. enterica serovar</italic> Typhimurium LT2 (<xref ref-type="table" rid="pone-0058173-t006">Table 6</xref>); 17 (24.3%) of these were currently known T3S effectors (<xref ref-type="supplementary-material" rid="pone.0058173.s007">Table S5</xref>, Type I or II). Another 3 of the predicted genes, STM2584, STM1318 and STM2050, may also encode T3S effectors (<xref ref-type="supplementary-material" rid="pone.0058173.s007">Table S5</xref>, Type III), based on predictions taking into account various structural features (Wang <italic>et al.</italic>, unpublished data). 13 genes (18.6%, 13/70) were hypothetical with unknown function, or originated from bacteriophages (<xref ref-type="supplementary-material" rid="pone.0058173.s007">Table S5</xref>, Type IV). Two other genes, invE and STM1082, were closely related with T3SS function (<xref ref-type="supplementary-material" rid="pone.0058173.s007">Table S5</xref>, Type V). InvE encodes an accessory protein which is necessary for type 3 secretion of substrates while <italic>STM1082</italic> encodes an AraC-family transcriptional regulator, an important type of T3SS gene regulator <xref rid="pone.0058173-Wang1" ref-type="bibr">[2]</xref>. It is worth noting that there were also predicted effectors (11.4%, 8/70), which were annotated as flagella-related proteins (<xref ref-type="supplementary-material" rid="pone.0058173.s007">Table S5</xref>, Type VI). T3SSs were reported to be evolutionarily related to flagella, and therefore, the flagella-related proteins and T3S effectors could share many sequence properties. These genes could also be improperly annotated as flagella-related proteins. The remaining 27 predicted effectors could participate in different biological processes or pathways (<xref ref-type="supplementary-material" rid="pone.0058173.s007">Table S5</xref>, Type VII).</p>
      <p>The number of predicted effectors was different in different <italic>Salmonella</italic> strains (<xref ref-type="supplementary-material" rid="pone.0058173.s007">Table S5</xref>). It is interesting to identify strain-specific effectors. A comprehensive comparison was consequently performed to the effector sets in 3 <italic>Salmonella</italic> serovar Typhimurium strains, LT2, 14028s, and SL1344. The LT2 genome was sequenced ten years ago, while the genomes of 14028s and SL1344 were published recently <xref rid="pone.0058173-Jarvik1" ref-type="bibr">[25]</xref>–<xref rid="pone.0058173-Krger1" ref-type="bibr">[26]</xref>. <xref ref-type="table" rid="pone-0058173-t007">Table 7</xref> showed the specific effectors of individual strains. Two LT2-specific genes, STM2703 and STM0909, both encoding hypothetical proteins with unknown function, did not have orthologs in 14028s or SL1344 (<xref ref-type="table" rid="pone-0058173-t007">Table 7</xref>, in bold). It is possible that STM2703 and STM0909 were obtained by horizontal transfer events. SL1344 and 14028s have two and four potential horizontally-acquired strain-specific genes, respectively, including known sopE (SL2674) in SL1344 (<xref ref-type="table" rid="pone-0058173-t007">Table 7</xref>, in bold). In addition to the possible effectors without sequence homologs, each Typhimurium strain also had strain-specific effectors with sequence homologs in at least one other strain (<xref ref-type="table" rid="pone-0058173-t007">Table 7</xref>, in italic). Closer analysis of the homologous sequences in other strains indicated they may have lost T3S signal features as a result of mutation and therefore were not recognized by T3SS.</p>
      <table-wrap id="pone-0058173-t007" orientation="portrait" position="float">
        <object-id pub-id-type="doi">10.1371/journal.pone.0058173.t007</object-id>
        <label>Table 7</label>
        <caption>
          <title>Predicted strain-specific T3S effectors.</title>
        </caption>
        <alternatives>
          <graphic id="pone-0058173-t007-7" xlink:href="pone.0058173.t007"/>
          <table frame="hsides" rules="groups">
            <colgroup span="1">
              <col align="left" span="1"/>
              <col align="center" span="1"/>
              <col align="center" span="1"/>
            </colgroup>
            <thead>
              <tr>
                <td align="left" rowspan="1" colspan="1">LT2</td>
                <td align="left" rowspan="1" colspan="1">SL1344</td>
                <td align="left" rowspan="1" colspan="1">14028s</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>STM2727</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>SL2674</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>STM14_4922</italic>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>STM4377</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>SL1076</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>STM14_1479</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>STM2703</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>SL2715</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>STM14_2428</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <bold>STM0909</bold>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>SL4268</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>STM14_5051</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>STM4539</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>SL0536</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <bold>STM14_1417</bold>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1">
                  <italic>STM4202</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>SL3702</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>STM14_0039</italic>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>SL2941</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>STM14_0118</italic>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>SL0277</italic>
                </td>
                <td align="left" rowspan="1" colspan="1">
                  <italic>STM14_0489</italic>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>STM14_3042</italic>
                </td>
              </tr>
              <tr>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1"/>
                <td align="left" rowspan="1" colspan="1">
                  <italic>STM14_5206</italic>
                </td>
              </tr>
            </tbody>
          </table>
        </alternatives>
      </table-wrap>
    </sec>
  </sec>
  <sec id="s3">
    <title>Discussion</title>
    <p>It is still an enigma how bacterial type III effectors are specifically recognized and secreted by type III secretion conduits. Previous experimental and bioinformatic analysis indicated that the signal sequences of type III effectors contained specific amino acid composition, such as being enriched in serine residues <xref rid="pone.0058173-Lloyd2" ref-type="bibr">[10]</xref>, <xref rid="pone.0058173-Arnold1" ref-type="bibr">[15]</xref>, <xref rid="pone.0058173-Wang3" ref-type="bibr">[17]</xref>. It is not yet known whether the amino acid composition influences the specificity of type III secretion, although some researchers have hypothesized that the amino acid composition is important for keeping the sequence more flexible and useful for specific recognition <xref rid="pone.0058173-Galn1" ref-type="bibr">[7]</xref>. In this research, we further analyzed specific Aac features of T3S proteins. Our results highlighted the existence of Aac dependence relationship between adjacent positions in T3S signal sequences (<xref ref-type="fig" rid="pone-0058173-g001">Fig. 1</xref>). A closer observation and exploration of the dependence between adjacent amino acids could possibly provide interesting clues about the evolution and recognition mechanisms of type III signal sequences.</p>
    <p>In this research, we used a simple Markov model-based variable for the Aac dependent on adjacent residues, followed by an observation and approximation of the variable distribution, for prediction of new T3S effectors <xref rid="pone.0058173-Arnold1" ref-type="bibr">[15]</xref>, <xref rid="pone.0058173-Wang3" ref-type="bibr">[17]</xref>–<xref rid="pone.0058173-Yang1" ref-type="bibr">[20]</xref>. The Markov model was adopted because it is simple, statistically sound and can be well fit to time or space sequences. It also has been widely applied in biological sequence modeling. Our model was proved to be both effective and quantitative for predicting T3S effectors. The simplicity of the model suggests that further exploration of the Aac features of T3S signal sequences could yield important information about secretion recognition. Simplicity also ensures a more stable classification performance of the model, as was demonstrated by training data and different test datasets (<xref ref-type="table" rid="pone-0058173-t001">Tables 1</xref>, <xref ref-type="table" rid="pone-0058173-t002">2</xref>, <xref ref-type="table" rid="pone-0058173-t003">3</xref>). We also tried other learning and classifying models, including widely adopted SVM, GLM and RF. However, none of these methods was comparable to T3_MM, to classify the T3S and non-T3S proteins based on the conditional Aac features (<xref ref-type="supplementary-material" rid="pone.0058173.s003">Table S1</xref>). This could be caused by the conditional Aac features, which are sequence-based and therefore more suitable for a sequence-based Markov model. The T3_MM model is sequence-based rather than position-based, therefore, the model is tolerant to insertion or deletion of one or several amino acids, or the possibility of alternative start codons (data not shown). In addition, the T3_MM model is not sensitive to the variance of sequence length because it has been normalized for sequence length. We also developed a wT3_MM model weighted by the probabilities of individual amino acids. Although the wT3_MM R values seemed better fit to known normal distributions, the classifying performance was not as good as that of original R values (<xref ref-type="fig" rid="pone-0058173-g003">Fig. 3</xref> and <xref ref-type="table" rid="pone-0058173-t001">Table 1</xref>). Therefore, we recommend that T3_MM be applied in practice instead of wT3_MM.</p>
    <p>Effective T3 and BPBAac are two T3S effector prediction tools with the best prediction performance. The T3_MM model consistently outperformed Effective T3 with the training dataset and on test datasets from <italic>Ralstonia</italic> and <italic>Pseudomonas</italic> species (<xref ref-type="table" rid="pone-0058173-t002">Table 2</xref> and <xref ref-type="table" rid="pone-0058173-t003">3</xref>). BPBAac performed best for classification of the training dataset (<xref ref-type="table" rid="pone-0058173-t002">Table 2</xref>), but significantly worse than T3_MM when new independent datasets were used, especially for sensitivity and accuracy (<xref ref-type="table" rid="pone-0058173-t003">Table 3</xref>). Excellent inter-genera classification results further demonstrated the stable performance of T3_MM (<xref ref-type="fig" rid="pone-0058173-g004">Fig. 4</xref>). In practice, users are suggested to adopt different strategies to apply the software for different objectives. T3_MM is a better choice when more effectors are expected to be found, because T3_MM can predict more true effectors which other software cannot predict correctly (e.g., the effector GtgE in <italic>S. Typhimurium</italic>, <xref ref-type="supplementary-material" rid="pone.0058173.s005">Tables S3</xref> and <xref ref-type="supplementary-material" rid="pone.0058173.s006">S4</xref>). This is especially useful for identification of new effectors in model species, in which many effectors have been found and highly-specific software, such as BPBAac, could not provide new candidates. To combine T3_MM and BPBAac is also a good choice when higher specificity is desired. The prediction results of this combinational strategy have both sequential bi-residue composition features and position-specific Aac features, and these candidates are more specific, though with a tradeoff being a loss of many new effectors. In this research, we first predicted <italic>Salmonella</italic> T3S effectors with T3_MM, and found it could give a larger number of possible candidates, some of which were recently validated by experiments and not predicted by BPBAac. A combined prediction strategy was further used to screen more specific effectors for further comparison and analysis (the percentage of known effectors in all predictions was increased to ∼25% from ∼5% for T3_MM and ∼9% for BPBAac). Many candidates were predicted by both programs, and most of them were conserved among different <italic>Salmonella</italic> serovars and stains (<xref ref-type="supplementary-material" rid="pone.0058173.s007">Table S5</xref>). In addition to the conserved and well-characterized effectors, the strain-specific ones, especially those whose encoding genes reside in a mobile region (e.g., prophage), are more interesting (<xref ref-type="table" rid="pone-0058173-t007">Table 7</xref>). These potential effectors could be obtained through strain-specific horizontal gene transfer events, and exert a strain-specific molecular function. Careful comparison of the effectors among different bacterial strains would give some clues about the evolution or other knowledge of T3S effectors. For example, <italic>Salmonella</italic> was diverged to two currently observable species, <italic>S. enterica</italic> and <italic>S. bongori</italic>. All <italic>S. enterica</italic> strains contain two T3SSs (SPI-1 and SPI-2) while <italic>S. bongori</italic> didn’t obtain the SPI-2 T3SS <xref rid="pone.0058173-Fookes1" ref-type="bibr">[27]</xref>. Comparison of the <italic>S. bongori</italic> predictions with those of <italic>S. enterica</italic> strains, indicated that none of known SPI-2 T3S effectors were present while most SPI-1 effectors were present in <italic>S. bongori.</italic> This indicates that SPI-1 effectors were likely acquired before divergence of <italic>Salmonella</italic> species and that SPI-2 effectors may have been acquired in <italic>S. enterica</italic> subspecies or strains after the species divergence (<xref ref-type="supplementary-material" rid="pone.0058173.s007">Table S5</xref>; data not shown). The effector SlrP, which was previously considered as an effector of both SPI-1 and SPI-2 T3SSs <xref rid="pone.0058173-BurnalBayard1" ref-type="bibr">[28]</xref>, was present in <italic>S. bongori</italic>. This is an indication that <italic>slrP</italic>, as well as other inter-species conserved candidate effector genes, could participate in the SPI-1 T3SS activities. There were also many predicted <italic>S. bongori</italic> effectors that were not identified in <italic>S. enterica</italic>. These predicted SPI-1 T3SS effectors could potentially play important, species-specific and phenotype-specific roles in <italic>S. bongori</italic> and its interaction with cold-blooded hosts <xref rid="pone.0058173-Fookes1" ref-type="bibr">[27]</xref>.</p>
    <p>Based on the likelihood ratio matrices of adjacent bi-residues (and the first-position residues) between T3S and non-T3S proteins, the most favored and unfavored T3S sequence compositions were calculated using a dynamic programming algorithm (<xref ref-type="table" rid="pone-0058173-t005">Table 5</xref>). The most preferred sequence was not composed of a stretch of serine resiudes, as was expected. This was also demonstrated by modelling analysis (<xref ref-type="table" rid="pone-0058173-t004">Table 4</xref>). The results indicate that, due to the constraint exerted by neighbouring positions, the most significant preference of some residue (eg., serine) doesn’t necessarily mean the similar preference of continuous composition of that residue. In simulating analysis, however, we found a stretch of proline was most favorable, though proline was not as preferred by T3S proteins as serine in most N-terminal positions (<xref ref-type="table" rid="pone-0058173-t004">Table 4</xref> and <xref ref-type="table" rid="pone-0058173-t005">5</xref>). Experiments are required to test whether this is the case. Interestingly, the proline was also present in about 1/3 of the positions in the most unfavorable T3S sequence, further indicating the constraint of amino acid composition cause by its adjacent position (<xref ref-type="table" rid="pone-0058173-t005">Table 5</xref>). It should be pointed out that in this modeling process, position information (i.e., position-specific bi-residue composition) was not considered, which could be more accurate theoretically but requires more known T3S proteins. Based on currently available validated T3S effectors, we calculated the most favorable T3S sequence by dynamic programming algorithms. The results were far different (e.g., the most favorable sequence of N-terminal 10-aa peptide being ‘TSWFAGDEKK’), and yet they were not stable, especially for the residues close to the C-termini. As more T3S effectors are validated, modeling based on position-specific bi-residue composition will become more feasible. These types of models are more likely to reveal hidden T3S motifs or unique amino acid composition features.</p>
    <p>In conclusion, the T3_MM model that we have developed can be applied to identify new effectors from different bacterial species based on their genome sequences. As more T3S proteins are experimentally identified, the estimated parameters can be optimized and the model can be improved.</p>
  </sec>
  <sec sec-type="methods" id="s4">
    <title>Methods</title>
    <sec id="s4a">
      <title>Data Source</title>
      <p>The T3S and non-T3S training protein dataset was described in detail previously (<xref ref-type="supplementary-material" rid="pone.0058173.s008">Text S1</xref>) <xref rid="pone.0058173-Wang3" ref-type="bibr">[17]</xref>. The dataset consisted of 154 non-homologous validated T3S proteins and 308 non-T3S proteins. The proteins were manually collected from different animal and plant pathogens or symbiotic bacteria, except <italic>Ralstonia</italic>
<xref rid="pone.0058173-Wang1" ref-type="bibr">[2]</xref>, <xref rid="pone.0058173-Wang3" ref-type="bibr">[17]</xref>. The non-T3S proteins were selected from the proteins encoded by different bacteria strains after removing the known effectors.</p>
      <p>Two independent datasets were used for testing and comparing the performance of T3_MM and other software programs. For the first test dataset, the <italic>Ralstonia</italic> validated effectors were collected from a recent large-scale experimental study <xref rid="pone.0058173-Mukaihara1" ref-type="bibr">[21]</xref>. These effectors were identified by Cya translocation assay <xref rid="pone.0058173-Mukaihara1" ref-type="bibr">[21]</xref>. In total, 35 effectors and randomly selected 70 non-effectors from <italic>Ralstonia</italic> were included in this dataset (<xref ref-type="supplementary-material" rid="pone.0058173.s009">Text S2</xref>). None of the <italic>Ralstonia</italic> proteins were used in training dataset. The other testing dataset consists the most comprehensive list of known <italic>Pseudomonas</italic> effectors (<xref ref-type="supplementary-material" rid="pone.0058173.s010">Text S3</xref>) <xref rid="pone.0058173-Baltrus1" ref-type="bibr">[22]</xref>. These effectors were annotated from literature with different experimental evidence <xref rid="pone.0058173-Baltrus1" ref-type="bibr">[22]</xref>. 291 known effectors and 582 randomly selected control proteins from <italic>Pseudomonas</italic> were included. The control proteins were selected with a strategy similar with that of the training dataset. The ratio of size between positive and negative training/testing sequences was maintained at 1∶2, according to previous experience and related reports <xref rid="pone.0058173-Wang3" ref-type="bibr">[17]</xref>, <xref rid="pone.0058173-Kim1" ref-type="bibr">[29]</xref>.</p>
    </sec>
    <sec id="s4b">
      <title>Assumption, Definition and Markov Model</title>
      <p>Let vector <inline-formula><inline-graphic xlink:href="pone.0058173.e001.jpg"/></inline-formula> denotes a peptide sequence in which <italic>A</italic> represents amino acid while the number represents position and n represents the total length of <italic>S</italic>. Besides, let <italic>A</italic>
<sub>0</sub> denotes a hypothetically initial state of sequence <italic>S</italic>. Assume <italic>A</italic>
<sub>0</sub> probability <italic>P</italic>(<italic>A</italic>
<sub>0</sub>) is 1 for each sequence <italic>S</italic>. The conditional probability of <italic>A</italic>
<sub>i+1</sub> on the amino acid at sequentially preceding position is denoted as: <italic>P</italic>(<italic>A</italic>
<sub>i+1</sub>|<italic>A</italic>
<sub>i</sub>), where 0≤<italic>i</italic>&lt;n. Assume the amino acid composition at one position is only dependent on its sequentially preceding position; consequently, the generating probability of an sequence <italic>S</italic> could be described as an one-order Markov chain:<disp-formula id="pone.0058173.e002"><graphic xlink:href="pone.0058173.e002.jpg" position="anchor" orientation="portrait"/></disp-formula>
</p>
      <p>Assume there are two categories of sequences (<italic>C</italic>
<sub>1</sub> and <italic>C</italic>
<sub>2</sub>), and S could be sampled either from <italic>C</italic>
<sub>1</sub> or <italic>C</italic>
<sub>2</sub>. The likelihood of sequence S belonging to category <italic>C</italic> is:<disp-formula id="pone.0058173.e003"><graphic xlink:href="pone.0058173.e003.jpg" position="anchor" orientation="portrait"/></disp-formula>where <italic>C</italic> represents <italic>C</italic>
<sub>1</sub> or <italic>C</italic>
<sub>2</sub>.</p>
      <p>For each sequence <italic>S</italic>, a statistic variable <italic>R</italic>, is constructed to describe logarithm of the likelihood ratio between <italic>P</italic>(<italic>S</italic>|<italic>C</italic>
<sub>1</sub>) and <italic>P</italic>(<italic>S</italic>|<italic>C</italic>
<sub>2</sub>), i.e.,<disp-formula id="pone.0058173.e004"><graphic xlink:href="pone.0058173.e004.jpg" position="anchor" orientation="portrait"/></disp-formula>where the base is set as 2, and log[<italic>P</italic>(<italic>A</italic>
<sub>i+1</sub>|<italic>A</italic>
<sub>i</sub>,<italic>C</italic>
<sub>1</sub>)/<italic>P</italic>(<italic>A</italic>
<sub>i+1</sub>|<italic>A</italic>
<sub>i</sub>,<italic>C</italic>
<sub>2</sub>)] is predefined as zero when <italic>P</italic>(<italic>A</italic>
<sub>i+1</sub>|<italic>A</italic>
<sub>i</sub>,<italic>C</italic>) equals to 0.</p>
      <p>For the models studied in this work, <italic>C</italic>
<sub>1</sub> and <italic>C</italic>
<sub>2</sub> represent T3S and non-T3S proteins, respectively. The probabilities of individual amino acids for T3S and non-T3S proteins, are used as the coefficients for weighted T3_MM model (wT3_MM).</p>
      <p>T3_iAA assumes that amino acids in sequence <italic>S</italic> are independent on each other, and the probabilities of different <italic>S</italic> with fixed length of n sum to 1. Therefore, the probability of <italic>S</italic> equals to the probability product of each constitute amino acid. T3_iAA also calculates the logarithm value of likelihood ratio that <italic>S</italic> being T3S or non-T3S protein.</p>
      <p>All the conditional probabilities, <italic>P</italic>(<italic>A</italic>
<sub>i</sub>|<italic>C</italic>) or <italic>P</italic>(<italic>A</italic>
<sub>i+1</sub>|<italic>A</italic>
<sub>i</sub>,<italic>C</italic>) (0≤<italic>i</italic>&lt;n, <italic>C</italic> = <italic>C</italic>
<sub>1</sub> or <italic>C</italic>
<sub>2</sub>), are estimated using maximum likelihood method. The negative logarithm of probability is also calculated for more direct comparison and observation.</p>
    </sec>
    <sec id="s4c">
      <title>Probability Distribution, Parameter Estimation and Decision Function</title>
      <p>The <italic>R</italic> values for each T3S protein are calculated, and a histogram is drawn afterwards to represent the <italic>R</italic> distribution. A density curve is derived from the normal Q–Q plot and Shapiro-Wilk normality test are further adopted to test whether the observed distribution is a normal distribution. For normal distribution, the parameters, mean (μ) and standard deviation (σ), are estimated using a maximum likelihood method. The <italic>R</italic> values for non-T3S proteins, and weighted <italic>R</italic> values for T3S and non-T3S proteins, are all calculated and analysed with the same strategy.</p>
      <p><italic>R</italic> values of T3S and non-T3S proteins are ideally fitting to two distinct probability distributions: <italic>F</italic>
<sub>C1</sub> and <italic>F</italic>
<sub>C2</sub>, respectively. Suppose mean μ(<italic>F</italic>
<sub>C1</sub>) is not smaller than μ(<italic>F</italic>
<sub>C2</sub>). For any sequence S and its <italic>R</italic> value <italic>r</italic>, <italic>P</italic>
<sub>C1</sub>(<italic>R</italic>|<italic>R≤r</italic>) and <italic>P</italic>
<sub>C2</sub>(<italic>R</italic>|<italic>R≥r</italic>) represent the probability of <italic>S</italic> according to <italic>F</italic>
<sub>C1</sub> and <italic>F</italic>
<sub>C2</sub> distribution, respectively. Let discriminant function D(<italic>r</italic>) = <italic>P</italic>
<sub>C1</sub>(<italic>R</italic>|<italic>R≤r</italic>)−<italic>P</italic>
<sub>C2</sub>(<italic>R</italic>|<italic>R≥r</italic>). If D(<italic>r</italic>)≥0, <italic>r</italic> follows <italic>F</italic>
<sub>C1</sub> distribution and <italic>S</italic> belongs to <italic>C</italic>
<sub>1</sub> or T3S proteins; otherwise, D(<italic>r</italic>)&lt;0, r follows <italic>F</italic>
<sub>C2</sub> distribution and <italic>S</italic> belongs to <italic>C</italic>
<sub>2</sub>. When <italic>r</italic> follows <italic>F</italic>
<sub>C1</sub> distribution, the probability of S being a <italic>C</italic>
<sub>1</sub> or T3S protein is the mean of <italic>P</italic>
<sub>C1</sub>(<italic>R</italic>|<italic>R≤r</italic>) and 1−<italic>P</italic>
<sub>C2</sub>(<italic>R</italic>|<italic>R≥r</italic>). When <italic>r</italic> follows <italic>F</italic>
<sub>C2</sub> distribution, the probability of S being a <italic>C</italic>
<sub>2</sub> or non-T3S protein is the mean of <italic>P</italic>
<sub>C2</sub>(<italic>R</italic>|<italic>R≥r</italic>) and 1−<italic>P</italic>
<sub>C1</sub>(<italic>R</italic>|<italic>R≤r</italic>).</p>
    </sec>
    <sec id="s4d">
      <title>Performance Assessment</title>
      <p>Accuracy (<italic>A</italic>), Specificity (<italic>Sp</italic>), Sensitivity (<italic>Sn</italic>), Receiver Operating Characteristic (<italic>ROC</italic>) curve and Matthews Correlation Coefficient (<italic>MCC</italic>) were utilized to assess the predictive performance. In the following formula, <italic>A</italic> denotes the percentage of both positive instances (T3S) and negative instances (non-T3S) correctly predicted. <italic>Sn</italic> (true positive rate) and <italic>Sp</italic> (true negative rate) respectively represent the percentage of positive instances (T3S) and the percentage of negative instances (non-T3S) correctly predicted. An <italic>ROC</italic> curve is a plot of Sn versus (1-<italic>Sp</italic>), and is generated by shifting the decision threshold. <italic>AUC</italic> gives a measure of classifier performance. <italic>MCC</italic> takes into account true and false positives and false negatives and is generally regarded as a balanced measure which can be used even if the classes are of very different sizes.<disp-formula id="pone.0058173.e005"><graphic xlink:href="pone.0058173.e005.jpg" position="anchor" orientation="portrait"/></disp-formula>where <italic>TP</italic>, <italic>TN</italic>, <italic>FP</italic> and <italic>FN</italic> denotes the number of true positives, true negatives, false positives and false negatives, respectively.</p>
      <p>To avoid overfitting of T3_MM, a 5-fold cross-validation strategy was adopted to evaluate its classification performance. The training dataset was divided into 5 subsets, each with identical number of positive and negative sequences. Four subsets were put together for training and the remaining subset was used for testing. The process was repeated so that all sequences were tested once. The performance parameters were evaluated as the average values of the cross-validation results.</p>
      <p>To test the robustness of T3_MM, an inter-species cross-validation strategy was adopted. The T3S and non-T3S proteins of a targeted genus (or phylum/subgroup) were extracted from the training dataset at first. The remaining sequences were used to re-train the model, which in turn was used to test the proteins of targeted genus (or phylum/subgroup). The sensitivity and specificity were calculated thereafter.</p>
    </sec>
    <sec id="s4e">
      <title>Comparison with other Software Programs</title>
      <p>The Support Vector Machine (SVM), Generalized Linear Model (GLM) and RandomForest (RF) were also used for training the conditional Aac features. Because the size of features was large (400), and the length of signal sequences was 100 aa, only the bi-residues statistically different between T3S and non-T3S sequences were included for training (binomial test, <italic>FDR</italic>-corrected p&lt;0.05). R packages were adopted to implement SVM (‘e1071’), GLM (‘faraway’) and RF (‘RandomForest’), respectively (<ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/">http://cran.r-project.org/</ext-link>).</p>
      <p>The performance of T3_MM was also compared with other established T3S protein prediction models, Effective T3 <xref rid="pone.0058173-Arnold1" ref-type="bibr">[15]</xref> and BPBAac <xref rid="pone.0058173-Wang3" ref-type="bibr">[17]</xref>. The original methods and optimal parameters were used for re-training the models with new training datasets. To compare the performance of each type of software to classify the two testing datasets, the default parameters were used, except sensitive cutoff values were adopted for either model (a probability of 0.95 for Effective T3 and an SVM value of 0.0 for BPBAac), since selective cutoff values for both models gave quite low recalls for the test datasets <xref rid="pone.0058173-Arnold1" ref-type="bibr">[15]</xref>, <xref rid="pone.0058173-Wang3" ref-type="bibr">[17]</xref>.</p>
    </sec>
    <sec id="s4f">
      <title>Most and Least Possible T3S Signal Sequences</title>
      <p>A dynamic programming algorithm was designed to find out the most and least possible T3S signal sequences based on the log odds of probabilities of individual amino acids and di-residues. Local maximal (minimal) sum of log odds of first-position individual amino acids and sequential di-residues between T3S and non-T3S sequences were recursively calculated. The path for continual local maximal (minimal) values was recorded and it was recognized as the most (least) possible T3S signal sequence.</p>
    </sec>
    <sec id="s4g">
      <title>Prediction, Comparison and Annotation of <italic>Salmonella</italic> Effectors</title>
      <p>Genome and genome-encoding protein sequences of Salmonella strains were downloaded from the NCBI website: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/genome">http://www.ncbi.nlm.nih.gov/genome</ext-link>. The strains and their genome accessions included: <italic>S. typhimurium</italic> LT2 (NC_003197), 14028s (CP001363), SL1344 (NC_016810), DT104, <italic>S. typhi</italic> CT18 (NC_003198), Ty2 (NC_004631), <italic>S. paratyphi</italic> A AKU_12601 (NC_011147), ATCC9150 (NC_006511), <italic>S. paratyphi</italic> B SPB7 (NC_010102), <italic>S. paratyphi</italic> C RKS4594 (NC_012125), <italic>S. enteritidis</italic> P125109 (AM933172), <italic>S. gallinarum</italic> 287/91 (NC_011274), <italic>S. dublin</italic> CT_02021853 (NC_011205), <italic>S. Schwarzengrund</italic> CVM19633 (NC_011094), <italic>S. newport</italic> SL254 (NC_011080), <italic>S. heidelberg</italic> SL476 (NC_011083), <italic>S. choleraesuis</italic> SC-B67 (NC_006905), <italic>S. agona</italic> SL483 (NC_011149), <italic>S. bongori</italic> NCTC_12419 (NC_015761), and <italic>S. arizonae</italic> RSK2980 (NC_010067). The genome-encoding sequences were input to the T3_MM server (<ext-link ext-link-type="uri" xlink:href="http://biocomputer.bio.cuhk.edu.hk/T3_MM.php">http://biocomputer.bio.cuhk.edu.hk/T3_MM.php</ext-link>) with default parameters for T3S protein prediction. BPBAac (<ext-link ext-link-type="uri" xlink:href="http://biocomputer.bio.cuhk.edu.hk/BPBAac.php">http://biocomputer.bio.cuhk.edu.hk/BPBAac.php</ext-link>) was also used to predict effectors in different bacteria. A sensitive cutoff value, 0.0, was set for BPBAac prediction. To find out the orthologs of two strains, a reciprocal alignment was performed to the protein sequences of any pair of genomes with blast program (blastp, evalue &lt;0.0005). The orthologs were defined as the mutual best alignment hits. Gene order information was also analyzed and used as additional evidence. The Genbank annotations for LT2 and other genomes were referred for function annotation of predicted effectors.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material" id="s5">
    <title>Supporting Information</title>
    <supplementary-material content-type="local-data" id="pone.0058173.s001">
      <label>Figure S1</label>
      <caption>
        <p><bold>Amino acid composition difference between T3S and non-T3S sequences.</bold> Horizontal axis: twenty types of amino acids. Vertical axis: negative logarithm of the composition probability of corresponding amino acid.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0058173.s001.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0058173.s002">
      <label>Figure S2</label>
      <caption>
        <p><bold>Comparison of Aac probability profiles conditional on preceding-position amino acid.</bold> Horizontal axis: sequentially adjacent two amino acids. Vertical axis: negative logarithm of the conditional probability of corresponding bi-amino acids (bi-aa). T3S and non-T3S sequences were shown in black bars and grey bars, repectively. WW, WY and MV were not present in T3S sequences, therefore, the probability for these residues was replaced with 1/1000 so as to avoid an infinite logarithm value. Bi-aa with conditional probability significantly different from absolute probability in T3S sequences but not significant in non-T3S sequences were marked with a star above the bar (T test, <italic>p</italic>&lt;0.05). Among bi-aas with the same first-position residue in T3S sequences, bi-aa with the rank of conditional probability significantly different from that of absolute probability was marked with an upward (rank difference between conditional and absolute probability ≤−5; the smaller the rank value, the higher the probability) or downward arrow (difference ≥5) above the bar. Similarly, among bi-aas with the same first-position residue, bi-aa with the rank of conditional probability in T3S sequences significantly different from that of non-T3S sequences was marked with a backward arrow (rank difference between conditional probability of T3S and non-T3S sequences ≤−5) or forward arrow (difference ≥5) below the bar.</p>
        <p>(PDF)</p>
      </caption>
      <media xlink:href="pone.0058173.s002.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0058173.s003">
      <label>Table S1</label>
      <caption>
        <p>
          <bold>Performance comparison for Markov model (T3_MM), SVM, GLM and RF training the conditional Aac features.</bold>
        </p>
        <p>(DOC)</p>
      </caption>
      <media xlink:href="pone.0058173.s003.doc">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0058173.s004">
      <label>Table S2</label>
      <caption>
        <p>
          <bold>Predicted score of simulated sequences.</bold>
        </p>
        <p>(XLS)</p>
      </caption>
      <media xlink:href="pone.0058173.s004.xls">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0058173.s005">
      <label>Table S3</label>
      <caption>
        <p>
          <bold>T3_MM predicted </bold>
          <bold>
            <italic>Salmonella</italic>
          </bold>
          <bold> effectors.</bold>
        </p>
        <p>(XLS)</p>
      </caption>
      <media xlink:href="pone.0058173.s005.xls">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0058173.s006">
      <label>Table S4</label>
      <caption>
        <p>
          <bold>BPBAac predicted </bold>
          <bold>
            <italic>Salmonella</italic>
          </bold>
          <bold> effectors.</bold>
        </p>
        <p>(XLS)</p>
      </caption>
      <media xlink:href="pone.0058173.s006.xls">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0058173.s007">
      <label>Table S5</label>
      <caption>
        <p>
          <bold>
            <italic>Salmonella</italic>
          </bold>
          <bold> effectors predicted by T3_MM and BPBAac.</bold>
        </p>
        <p>(XLS)</p>
      </caption>
      <media xlink:href="pone.0058173.s007.xls">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0058173.s008">
      <label>Text S1</label>
      <caption>
        <p>
          <bold>Training sequences.</bold>
        </p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pone.0058173.s008.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0058173.s009">
      <label>Text S2</label>
      <caption>
        <p>
          <bold>Mukaihara 2010 </bold>
          <bold>
            <italic>Ralstonia</italic>
          </bold>
          <bold> T3S proteins.</bold>
        </p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pone.0058173.s009.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="pone.0058173.s010">
      <label>Text S3</label>
      <caption>
        <p>
          <bold>Baltrus 2011 comprehensive </bold>
          <bold>
            <italic>Pseudomonas</italic>
          </bold>
          <bold> T3S protein.</bold>
        </p>
        <p>(TXT)</p>
      </caption>
      <media xlink:href="pone.0058173.s010.txt">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="pone.0058173-Hueck1">
      <label>1</label>
      <mixed-citation publication-type="other">Hueck CJ (1998) Type III protein secretion systems in bacterial pathogens of animals and plants. Mol. Biol. Rev., 62, 379–433.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Wang1">
      <label>2</label>
      <mixed-citation publication-type="journal"><name><surname>Wang</surname><given-names>Y</given-names></name>, <name><surname>Huang</surname><given-names>H</given-names></name>, <name><surname>Sun</surname><given-names>M</given-names></name>, <name><surname>Zhang</surname><given-names>Q</given-names></name>, <name><surname>Guo</surname><given-names>D</given-names></name> (<year>2012</year>) <article-title>T3DB: an integrated database for bacterial Type III Secretion System</article-title>. <source>BMC Bioinformatics</source>
<volume>13</volume>: <fpage>66</fpage>.<pub-id pub-id-type="pmid">22545727</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0058173-Enninga1">
      <label>3</label>
      <mixed-citation publication-type="other">Enninga J, Rosenshine I (2009) Imaging the assembly, structure and activity of type III secretion systems.Cell Microbiol., 11, 1462–1470.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Izor1">
      <label>4</label>
      <mixed-citation publication-type="other">Izoré T, Job V, Dessen A (2011) Biogenesis, regulation, and targeting of the type III secretion system. Structure, 19, 603–12.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Lindeberg1">
      <label>5</label>
      <mixed-citation publication-type="other">Lindeberg M, Collmer A (2009) Gene Ontology for type III effectors: capturing processes at the host-pathogen interface. Trends Microbiol., 17, 304–11.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Feng1">
      <label>6</label>
      <mixed-citation publication-type="other">Feng F, Zhou JM (2012) Plant-bacterial pathogen interactions mediated by type III effectors. Curr Opin Plant Biol., 15, 469–476.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Galn1">
      <label>7</label>
      <mixed-citation publication-type="other">Galán JE, Wolf-Watz H (2006) Protein delivery into eukaryotic cells by type III secretion machines. Nature, 444, 567–73.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Karavolos1">
      <label>8</label>
      <mixed-citation publication-type="other">Karavolos MH, Roe AJ, Wilson M, Henderson J, Lee JJ, <etal>et al</etal>.. (2005) Type III secretion of the Salmonella effector protein SopE is mediated via an N-terminal amino acid signal and not an mRNA sequence. J. Bacteriol., 187, 1559–1567.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Lloyd1">
      <label>9</label>
      <mixed-citation publication-type="other">Lloyd SA, Norman M, Rosqvist R, Wolf-Watz H (2001) Yersinia YopE is targeted for type III secretion by N-terminal, not mRNA, signals. Mol. Microbiol., 39, 520–531.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Lloyd2">
      <label>10</label>
      <mixed-citation publication-type="other">Lloyd SA, Sjöström M, Andersson S, Wolf-Watz H (2002) Molecular characterization of type III secretion signals via analysis of synthetic N-terminal amino acid sequences. Mol. Microbiol., 43, 51–59.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Rssmann1">
      <label>11</label>
      <mixed-citation publication-type="other">Rüssmann H, Kubori T, Sauer J, Galán JE (2002) Molecular and functional analysis of the type III secretion signal of the Salmonella enterica InvJ protein. Mol. Microbiol., 46, 769–779.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Stebbins1">
      <label>12</label>
      <mixed-citation publication-type="other">Stebbins CE, Galán JE (2001) Maintenance of an unfolded polypeptide by a cognate chaperone in bacterial type III secretion. Nature, 414, 77–81.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Wang2">
      <label>13</label>
      <mixed-citation publication-type="other">Wang Y, Hou Y, Huang H, Liu GR, White AP, <etal>et al</etal>.. (2008) Two oral HBx vaccines delivered by live attenuated Salmonella: both eliciting effective anti-tumor immunity. Cancer Lett, 263, 67–76.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Subtil1">
      <label>14</label>
      <mixed-citation publication-type="other">Subtil A, Delevoye C, Balañá ME, Tastevin L, Perrinet S, <etal>et al</etal>.. (2005) A directed screen for chlamydial proteins secreted by a type III mechanism identifies a translocated protein and numerous other new candidates. Mol. Microbiol., 56,1636–47.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Arnold1">
      <label>15</label>
      <mixed-citation publication-type="other">Arnold R, Brandmaiers, Kleie F, Tischler P, Heinz E, <etal>et al</etal>.. (2009) Sequence-based prediction of type III secreted proteins. PLoS pathogens, 5, e1000376.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Arnold2">
      <label>16</label>
      <mixed-citation publication-type="other">Arnold R, Jehl A, Rattei T (2010) Targeting effectors: the molecular recognition of Type III secreted proteins. Microbes Infect., 12, 346–358.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Wang3">
      <label>17</label>
      <mixed-citation publication-type="other">Wang Y, Zhang Q, Sun MA, Guo D (2011) High-accuracy prediction of bacterial type III secreted effectors based on position-specific amino acid composition profiles. Bioinformatics, 2011, 27, 777–84.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Lwer1">
      <label>18</label>
      <mixed-citation publication-type="other">Löwer M, Schneider G (2009) Prediction of type III secretion signals in genomes of gram-negative bacteria. PloS one, 4, e5917.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Samudrala1">
      <label>19</label>
      <mixed-citation publication-type="other">Samudrala R, Heffron F, McDermott JE (2009) Accurate prediction of secreted substrates and identification of a conserved putative secretion signal for type III secretion systems. PLoS pathogens, 5, e1000375.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Yang1">
      <label>20</label>
      <mixed-citation publication-type="other">Yang Y, Zhao J, Morgan RL, Ma W, Jiang T (2010) Computational prediction of type III secreted proteins from gram-negative bacteria. BMC Bioinformatics, 11 Suppl 1, S47.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Mukaihara1">
      <label>21</label>
      <mixed-citation publication-type="other">Mukaihara T, Tamura N, Iwabuchi M (2010) Genome-wide identification of a large repertoire of Ralstonia solanacearum type III effector proteins by a new functional screen. MPMI, 23, 251–262.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Baltrus1">
      <label>22</label>
      <mixed-citation publication-type="journal"><name><surname>Baltrus</surname><given-names>DA</given-names></name>, <name><surname>Nishimura</surname><given-names>MT</given-names></name>, <name><surname>Romanchuk</surname><given-names>A</given-names></name>, <name><surname>Chang</surname><given-names>JH</given-names></name>, <name><surname>Mukhtar</surname><given-names>MS</given-names></name>, <etal>et al</etal> (<year>2011</year>) <article-title>Dynamic Evolution of Pathogenicity Revealed by Sequencing and Comparative Genomics of 19 Pseudomonas syringae Isolates</article-title>. <source>PLoS Pathog</source>
<volume>7(7)</volume>: <fpage>e1002132</fpage>.<pub-id pub-id-type="pmid">21799664</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0058173-Span1">
      <label>23</label>
      <mixed-citation publication-type="journal"><name><surname>Spanò</surname><given-names>S</given-names></name>, <name><surname>Liu</surname><given-names>X</given-names></name>, <name><surname>Galán</surname><given-names>JE</given-names></name> (<year>2011</year>) <article-title>Proteolytic targeting of Rab29 by an effector protein distinguishes the intracellular compartments of human-adapted and broad-host Salmonella. Proc Natl Acad Sci U S A</article-title>. <volume>108</volume>: <fpage>18418</fpage>–<lpage>18423</lpage>.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Span2">
      <label>24</label>
      <mixed-citation publication-type="journal"><name><surname>Spanò</surname><given-names>S</given-names></name>, <name><surname>Galán</surname><given-names>JE</given-names></name> (<year>2012</year>) <article-title>A Rab32-dependent pathway contributes to Salmonella typhi host restriction</article-title>. <source>Science</source>
<volume>338</volume>: <fpage>960</fpage>–<lpage>963</lpage>.<pub-id pub-id-type="pmid">23162001</pub-id></mixed-citation>
    </ref>
    <ref id="pone.0058173-Jarvik1">
      <label>25</label>
      <mixed-citation publication-type="other">Jarvik T, Smillie C, GroismanEA, Ochman H (2010) Short-term signatures of evolutionary change in the Salmonella enterica serovar typhimurium 14028 genome. J. Bacteriol., 192 (2), 560–7.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Krger1">
      <label>26</label>
      <mixed-citation publication-type="other">Kröger C, Dillon SC, Cameron AD, Papenfort K, Sivasankaran SK, <etal>et al</etal>.. (2012) The transcriptional landscape and small RNAs of Salmonella enterica serovar Typhimurium. Proc. Natl. Acad. Sci. U S A., 109 (20), E1277–86.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Fookes1">
      <label>27</label>
      <mixed-citation publication-type="other">Fookes M, Schroeder GN, Langridge GC, Blondel CJ, Mammina C, <etal>et al</etal>.. (2011) Salmonella bongori provides insights into the evolution of the Salmonellae. PLoS Pathog., 7(8), e1002191.</mixed-citation>
    </ref>
    <ref id="pone.0058173-BurnalBayard1">
      <label>28</label>
      <mixed-citation publication-type="other">Burnal-Bayard J, Cardenal-Munoz E, Ramos-Morales F (2010) The Salmonella type III secretion effector, Salmonella leucine-rich repeat protein (SlrP), targets the human chaperone ERdj3. J Bio Chem., 285(21), 16360–16368.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Kim1">
      <label>29</label>
      <mixed-citation publication-type="other">Kim JH, Lee J, Oh B, Kimm K, Koh I (2004) Prediction of phosphorylation sites using SVMs. Bioinformatics, 20, 3179–3184.</mixed-citation>
    </ref>
    <ref id="pone.0058173-Benjamini1">
      <label>30</label>
      <mixed-citation publication-type="journal"><name><surname>Benjamini</surname><given-names>Y</given-names></name>, <name><surname>Hochberg</surname><given-names>Y</given-names></name> (<year>1995</year>) <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>Journal of the Royal Statistical Society: Series B</source>
<volume>57</volume>: <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
