<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7931819</article-id>
    <article-id pub-id-type="pmid">33590861</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/giab008</article-id>
    <article-id pub-id-type="publisher-id">giab008</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00960</subject>
        <subject>AcademicSubjects/SCI02254</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Twelve years of SAMtools and BCFtools</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4159-1666</contrib-id>
        <name>
          <surname>Danecek</surname>
          <given-names>Petr</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6447-4112</contrib-id>
        <name>
          <surname>Bonfield</surname>
          <given-names>James K</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1059-1230</contrib-id>
        <name>
          <surname>Liddle</surname>
          <given-names>Jennifer</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1216-5457</contrib-id>
        <name>
          <surname>Marshall</surname>
          <given-names>John</given-names>
        </name>
        <aff><institution>Wolfson Wohl Cancer Research Centre, Institute of Cancer Sciences, University of Glasgow</institution>, Switchback Road, Glasgow, G61 1QH, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0532-6021</contrib-id>
        <name>
          <surname>Ohan</surname>
          <given-names>Valeriu</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8738-0920</contrib-id>
        <name>
          <surname>Pollard</surname>
          <given-names>Martin O</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8117-400X</contrib-id>
        <name>
          <surname>Whitwham</surname>
          <given-names>Andrew</given-names>
        </name>
        <!--<email>samtools@sanger.ac.uk</email>-->
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7532-6898</contrib-id>
        <name>
          <surname>Keane</surname>
          <given-names>Thomas</given-names>
        </name>
        <aff><institution>EMBL-EBI, Wellcome Genome Campus, Hinxton, Cambridgeshire</institution>, CB10 1SD, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2715-4187</contrib-id>
        <name>
          <surname>McCarthy</surname>
          <given-names>Shane A</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9983-1378</contrib-id>
        <name>
          <surname>Davies</surname>
          <given-names>Robert M</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4874-2874</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <aff><institution>Department of Data Sciences, Dana-Farber Cancer Institute, 450 Brookline Avenue</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Informatics, Harvard Medical School, 10 Shattuck Street</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><bold>Correspondence address</bold>. Andrew Whitwham, Wellcome Sanger Institute, Wellcome Genome Campus, Hinxton, Cambridgeshire, CB10 1SA, UK. Tel: +44 (0)1223 834244; E-mail: <email>samtools@sanger.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="epub" iso-8601-date="2021-02-16">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>10</volume>
    <issue>2</issue>
    <elocation-id>giab008</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press GigaScience.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="giab008.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="abs1">
        <title>Background</title>
        <p>SAMtools and BCFtools are widely used programs for processing and analysing high-throughput sequencing data. They include tools for file format conversion and manipulation, sorting, querying, statistics, variant calling, and effect analysis amongst other methods.</p>
      </sec>
      <sec id="abs2">
        <title>Findings</title>
        <p>The first version appeared online 12 years ago and has been maintained and further developed ever since, with many new features and improvements added over the years. The SAMtools and BCFtools packages represent a unique collection of tools that have been used in numerous other software projects and countless genomic pipelines.</p>
      </sec>
      <sec id="abs3">
        <title>Conclusion</title>
        <p>Both SAMtools and BCFtools are freely available on GitHub under the permissive MIT licence, free for both non-commercial and commercial use. Both packages have been installed &gt;1 million times via Bioconda. The source code and documentation are available from <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>samtools</kwd>
      <kwd>bcftools</kwd>
      <kwd>high-throughput sequencing</kwd>
      <kwd>next generation sequencing</kwd>
      <kwd>variant calling</kwd>
      <kwd>data analysis</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>206194</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Background</title>
    <p>With the advancement of genome sequencing technologies and large-scale sequencing projects, new data formats became necessary for interoperability, compact storage, and efficient analysis of the data. Among the most common formats used in this field today are SAM [<xref rid="bib1" ref-type="bibr">1</xref>] and VCF [<xref rid="bib2" ref-type="bibr">2</xref>], developed by the 1000 Genomes Project [<xref rid="bib3" ref-type="bibr">3</xref>]. These specialized formats for storing read alignments (SAM) and genetic variants (VCF) are row-oriented tab-delimited text files, which are easy to process using custom scripts but slow to parse and can be inefficient to store. Therefore in practice, the binary counterparts BAM or CRAM are used for alignment data and, when parsing of large VCF files becomes prohibitively slow, BCF provides a more efficient format for processing variation data.</p>
    <p>Despite the conceptual simplicity of the underlying DNA sequence, the alignment and variant data carry rich information. These data undergo a number of processing steps, many of which are algorithmically complex and require specialized software. Also more programming effort and expertise are necessary to parse binary formats. Therefore programs and toolkits that encompass functionality for the most common tasks have been developed. These include tools for file manipulation, quality control, and data analyses, such as sambamba [<xref rid="bib4" ref-type="bibr">4</xref>], biobambam [<xref rid="bib5" ref-type="bibr">5</xref>], FastQC [<xref rid="bib6" ref-type="bibr">6</xref>], and GATK [<xref rid="bib7" ref-type="bibr">7</xref>]. A successful bioinformatics tool must keep up with advancements in sequencing technologies (e.g., substantial increase in sequencing read length), scale well with ever-increasing amounts of data (from single to hundreds of thousands of genomes), and expand focus to encompass new analyses and more complex types of variation. New species also bring challenges such as large chromosomes not representable by 32 bits (&gt;2 Gb) or assumptions about the ploidy of an organism. In this article we describe the status, new features, and developments in SAMtools and BCFtools.</p>
    <p>SAMtools was originally published in 2009 [<xref rid="bib1" ref-type="bibr">1</xref>]. Readers of the online edition of that article would have been able to download release 0.1.4. The package included not only utilities to convert and manipulate SAM and BAM files but also a variant caller, which was soon restructured into the BCFtools subpackage (2010, release 0.1.9). Later it became apparent that third-party projects were trying to use code from SAMtools despite it not being designed to be embedded in that way. Therefore the decision was taken in August 2014 (release 1.0) to split the SAMtools package into a stand-alone library with a well-defined API (HTSlib, currently 82k lines of code) [<xref rid="bib8" ref-type="bibr">8</xref>], a project for variant calling and manipulation of variant data (BCFtools, 71k lines), and SAMtools for working with alignment data (42k lines). All 3 projects are maintained in parallel, and improvements to HTSlib naturally filter into new releases of SAMtools and BCFtools. Since the original release the combined size of HTSlib, SAMtools, and BCFtools has doubled.</p>
  </sec>
  <sec id="sec2">
    <title>Findings</title>
    <sec id="sec2-1">
      <title>SAMtools</title>
      <p>Since the initial release there have been &gt;2,200 commits to the code repository and 52 releases, the most recent being version 1.11 in September 2020 [<xref rid="bib9" ref-type="bibr">9</xref>].</p>
      <p>The main part of the SAMtools package is a single executable that offers various commands for working on alignment data. The “view" command performs format conversion, file filtering, and extraction of sequence ranges. Files can be reordered, joined, and split in various ways using the commands sort, collate, merge, cat, and split. Files can be indexed for fast random access using “index" for alignment files and “faidx" for reference sequences in the FASTA format. File content can be manipulated with commands like addreplacerg, calmd, fixmate, and reheader. Duplicated reads, caused by artefacts in the library creation and sequencing process, can be flagged using markdup. Various statistics on alignment files can be calculated using idxstats, flagstat, stats, depth, and bedcov. Data can be converted to legacy formats using fasta and fastq. For position-ordered files, the sequence alignment can be viewed using tview or output via mpileup in a way that can be used for ongoing processing (e.g., variant calling). Most recently SAMtools has gained support for amplicon-based sequencing projects via ampliconclip and ampliconstats.</p>
      <p>For a complete list of SAMtools commands with a short summary, version, and date of the initial commit see <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S1</xref>. Full documentation for these commands is included with the package in the form of UNIX man pages and can also be found online [<xref rid="bib28_175_1612547700797" ref-type="bibr">10</xref>].</p>
      <p>Early releases of SAMtools could read and write alignment data in the SAM and BAM formats. The 1.0 release introduced support for the better-compressed CRAM format [<xref rid="bib10" ref-type="bibr">11</xref>]. Originally, the program required the use of command line options to select the input format, and most commands were tied to using BAM files. These restrictions were removed as SAMtools transitioned to use HTSlib, so by release 1.0 most commands could automatically detect the input file format and could directly read and write SAM, BAM, and CRAM files. In particular, there is rarely any need to convert SAM to BAM using “samtools view -b” before running commands like “samtools sort,” although regrettably this idiom still appears in a large number of online tutorials. We encourage readers to follow best practices and workflows published at [<xref rid="bib29_162_1612547803367" ref-type="bibr">12</xref>].</p>
      <p>SAMtools has also become faster, most notably by gaining the ability to use threads to take better advantage of the parallelism available on modern multicore systems. Thread support first arrived in version 0.1.19 (March 2013), which enabled them for sorting and BAM file writing in the view command. The number of tasks using threads has slowly increased, so now (thanks to improvements in HTSlib) it is possible to use them for both reading and writing SAM, BAM, and CRAM formats in most of the commands. Another time-saving improvement is the ability to index files as they are written (added in 1.10). This allows pipelines that need to index files to remove the separate “samtools index” stage and associated read-through of the file being indexed.</p>
    </sec>
    <sec id="sec2-2">
      <title>BCFtools</title>
      <p>The original purpose of the BCFtools package was to divide the I/O- and CPU-intensive tasks of variant calling into separate steps.</p>
      <p>The first step, initially “samtools mpileup” but subsequently moved to “bcftools mpileup,” reads the alignments and for each position of the genome constructs a vertical slice across all reads covering the position (“pileup”). Genotype likelihoods are then calculated, representing how consistent are the observed data with the possible diploid genotypes. The calculation takes into account mapping qualities of the reads, base qualities, and the probability of local misalignment, per-base alignment quality (BAQ) [<xref rid="bib11" ref-type="bibr">13</xref>]. The second step, “bcftools call” (known in the initial release as “bcftools view”), then evaluates the most likely genotype under the assumption of Hardy-Weinberg equilibrium (in the sample context customizable by the user) using allele frequencies estimated from the data or provided explicitly by the user. In 2016 (release 1.4) genotype likelihood generation was moved from SAMtools to BCFtools to make both variant-calling steps part of the same package and to prevent errors arising from the possible use of incompatible versions of the 2 programs.</p>
      <p>Today BCFtools is a full-featured program that consists of 21 commands and 38 plugins (single-purpose tools) with &gt;230 documented command line switches and options. As of writing, there have been &gt;2,300 commits and 29 releases since 2012, with the most recent, 1.11, released in September 2020 [<xref rid="bib12" ref-type="bibr">14</xref>].</p>
      <p>The “bcftools view” command provides conversion between the text VCF and the binary BCF format, where both formats can be either plain (uncompressed) or block-compressed with BGZF for random access and compact size. The plain text VCF output is useful for visual inspection, for processing with custom scripts, and as a data exchange format. It should not be used when performance is critical because BCFtools internally uses the binary BCF representation and the conversion between the text VCF format and the binary BCF format is costly. Also compression and decompression is CPU intensive, and therefore when streaming between multiple commands in a pipeline it is recommended to stream uncompressed BCF by appending the option “-Ou.”</p>
      <p>The program can do much more than convert between VCF and BCF formats. It can also process third-party formats (using the “convert" command) and manipulate variant files in many ways. It can be used to index, sort, and normalize variants (“norm"), replace headers (“reheader"), add and remove annotations (“annotate"), and subset samples (“view"). Most commands can filter sites either by a region, list of sites, or a general Boolean expression involving any combination of VCF tags (--include, --exclude). Multiple files can be compared, splitting common and file-specific variants into separate files according to custom rules (isec). Files sorted by position can also be combined using the merge command (input files have different samples) or concat command (input files have the same samples). Arbitrary fields can be extracted and formatted into a custom text output (query), a feature that, among other things, is useful for scripting.</p>
      <p>Apart from file manipulation, the program offers variant callers and algorithms useful for analysis. For calling single-nucleotide polymorphisms and short indels from read alignment files, BCFtools implements 2 variant-calling models. In addition to the original biallelic caller (“bcftools call -c” [<xref rid="bib13" ref-type="bibr">15</xref>]) there is a newer model available, capable of handling positions with multiple alternate alleles (“bcftools call -m”) and supporting gVCF output [<xref rid="bib14" ref-type="bibr">16</xref>]. (For a recent comparison of the variant-calling component of the software see [<xref rid="bib15" ref-type="bibr">17–20</xref>].) The package implements a hidden Markov model caller for detection of runs of homozygosity (roh [<xref rid="bib19" ref-type="bibr">21</xref>]), copy-number variation calling from single-nucleotide polymorphism array data (cnv [<xref rid="bib20" ref-type="bibr">22</xref>]), and the detection of whole-chromosome aberrations (polysomy). The program can construct a consensus sequence given a FASTA and a variant file (consensus), perform sample identity checks (gtcheck), and collect various statistics (stats).</p>
      <p>In addition to built-in commands, the program supports a dynamic plugin mechanism for specific single-purpose tasks with a diverse range of functions. Examples from a large and ever-growing collection include the plugin split-vep for convenient querying and extraction of VEP annotations [<xref rid="bib21" ref-type="bibr">23</xref>]; trio-dnm for ascertainment of <italic>de novo</italic> variants and their parental origin (parental-origin), or for collection of statistics (trio-stats) in trio data; gVCF manipulation (gvcfz); and many more.</p>
      <p>For a complete list of BCFtools commands and plugins with a short summary, version, and date of the initial commit see <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S2</xref>. Full documentation for these commands is included with the package in the form of UNIX man pages and can also be found online together with short tutorials, math notes, and other documentation at [<xref rid="bib30_604_1612548058839" ref-type="bibr">24</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec3">
    <title>Discussion</title>
    <p>SAMtools and BCFtools represent a unique collection of tools useful for processing and analysis of sequencing data. Their development has been driven by the need of both large projects and individual user requests issued via GitHub. The code has been installed &gt;1 million times via Bioconda [<xref rid="bib22" ref-type="bibr">25</xref>] and GitHub releases [<xref rid="bib9" ref-type="bibr">9</xref>, <xref rid="bib12" ref-type="bibr">14</xref>], and &gt;1600 support and feature requests have been resolved on GitHub.</p>
    <p>The programs are written in the C programming language and optimized for low memory consumption and high speed. For example, the “bcftools csq” command for prediction of functional consequences in a haplotype-aware manner requires only a fraction of the memory required by VEP and is 2 orders of magnitude faster [<xref rid="bib23" ref-type="bibr">26</xref>].</p>
    <p>Much work has been done to increase the reliability of SAMtools and BCFtools. The test harnesses now include ∼700 tests in SAMtools and ∼1,400 in BCFtools. Continuous integration services run all of the tests on a variety of platforms (including Linux, MacOS, and Windows) whenever code is checked into the source repository, ensuring that bugs are discovered and fixed rapidly. Code quality is also assured by checking for memory errors, originally using Valgrind memcheck [<xref rid="bib24" ref-type="bibr">27</xref>] and more recently with AddressSanitizer [<xref rid="bib25" ref-type="bibr">28</xref>]. Additionally, UndefinedBehaviorSanitizer is used to detect violations of the C standard.</p>
    <p>Despite the ever-growing sample sizes and rapid increases in the amount of sequenced data, the programs have withstood the test of time. However, extremely big files are produced by large projects and their processing requires a high degree of parallelization on computing clusters. Future versions of SAMtools and BCFtools are expected to make more use of threaded code to allow faster processing of such files. Sometimes even the limits of BCF representation itself can be reached. For example, highly polymorphic sites can contain dozens of alternate indel alleles, which, in files with tens of thousands of samples, exceed the internal limit of 4 GB per site due to quadratic scaling of annotations such as FORMAT/PL. An extension of the VCF specification has been proposed to address this problem by introducing a localized version of such annotations with linear scaling [<xref rid="bib26" ref-type="bibr">29</xref>] and has been implemented in BCFtools.</p>
    <p>The programs have been used to process and analyze sequencing data from all types of species: vertebrates, invertebrates, pathogens, plants, and viruses. This provides interesting challenges and opportunities for future development. For example, some of the BCFtools commands are limited to handling haploid and diploid organisms and the support for large “64-bit” genomes is currently only partial. More work is also planned to overcome difficulties stemming from ambiguities in VCF allele encoding (such as operations of atomization and deatomization) and to improve visualization of results, and there are &gt;50 feature requests currently registered on GitHub to investigate.</p>
  </sec>
  <sec id="sec4">
    <title>Availability of Supporting Source Code and Requirements</title>
    <p>Project name: SAMtools</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/samtools">https://github.com/samtools/samtools</ext-link></p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: C</p>
    <p>License: MIT/Expat</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_002105">RRID:SCR_002105</ext-link>
    </p>
    <p>biotools: samtools</p>
    <p>Project name: BCFtools</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/bcftools">https://github.com/samtools/bcftools</ext-link></p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: C</p>
    <p>Other requirements: Optional use of GNU Scientific Library (GSL)</p>
    <p>License: MIT/Expat</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_002105">RRID:SCR_002105</ext-link>
    </p>
    <p>biotools: bcftools</p>
  </sec>
  <sec sec-type="data-availability" id="sec5">
    <title>Data Availability</title>
    <p>Snapshots of the code and tabular files are available from the <italic>GigaScience</italic> GigaDB repository [<xref rid="bib27" ref-type="bibr">30</xref>].</p>
  </sec>
  <sec id="sec6">
    <title>Editors Note</title>
    <p>An accompanying article describing the HTSlib software library for providing programmatic access is published alongside this article [<xref rid="bib8" ref-type="bibr">8</xref>].</p>
  </sec>
  <sec id="sec7">
    <title>Additional Files</title>
    <p>Supplementary Table S1: Table of SAMtools commands</p>
    <p>Supplementary Table S2: Table of BCFtools commands</p>
  </sec>
  <sec id="h1content1612547370513">
    <title>Abbreviations</title>
    <p>API: Application Programming Interface; CPU: central processing unit; GATK: Genome Analysis Toolkit; Gb: gigabase pairs.</p>
  </sec>
  <sec id="sec8">
    <title>Competing Interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec id="sec9">
    <title>Funding</title>
    <p>This work was supported by a Wellcome Trust grant (206194).</p>
  </sec>
  <sec id="sec10">
    <title>Authors' Contributions</title>
    <p>J.K.B., P.D., R.M.D., H.L., J.M., M.O.P., V.O., and A.W. wrote the SAMtools software with J.L. and S.A.M. supporting; R.M.D., T.K., and J.M. provided supervision.</p>
    <p>P.D. and S.A.M. wrote the BCFtools software with J.K.B., R.M.D., H.L., J.M., and V.O. supporting; S.A.M. also provided supervision.</p>
    <p>J.K.B., P.D., R.M.D., V.O., and A.W. wrote the original draft of the manuscript with all authors reviewing.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>giab008_GIGA-D-20-00369_Original_Submission</label>
      <media xlink:href="giab008_giga-d-20-00369_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>giab008_GIGA-D-20-00369_Revision_1</label>
      <media xlink:href="giab008_giga-d-20-00369_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>giab008_Response_to_Reviewer_Comments_Original_Submission</label>
      <media xlink:href="giab008_response_to_reviewer_comments_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>giab008_Reviewer_1_Report_Original_Submission</label>
      <caption>
        <p>Fan Zhang -- 1/3/2021 Reviewed</p>
      </caption>
      <media xlink:href="giab008_reviewer_1_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>giab008_Reviewer_2_Report_Original_Submission</label>
      <caption>
        <p>Chris Chang -- 1/6/2021 Reviewed</p>
      </caption>
      <media xlink:href="giab008_reviewer_2_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>giab008_Supplemental_Files</label>
      <media xlink:href="giab008_supplemental_files.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Handsaker</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Wysoker</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>2078</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Auton</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Abecasis</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2156</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>The 1000 Genomes Project Consortium</collab>.</person-group>  <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>. <year>2015</year>;<volume>526</volume>:<fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarasov</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Vilella</surname>  <given-names>AJ</given-names></string-name>, <string-name><surname>Cuppen</surname>  <given-names>E</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Sambamba: fast processing of NGS alignment formats</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>:<fpage>2032</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">25697820</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tischler</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Leonard</surname>  <given-names>S</given-names></string-name></person-group><article-title>biobambam: tools for read pair collation based algorithms on BAM files</article-title>. <source>Source Code Biol Med</source>. <year>2014</year>;<volume>9</volume>:<fpage>2078</fpage>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Babraham Bioinformatics</collab>.</person-group>  <year>2019</year>
<source>FastQC: A quality control tool for high throughput sequence data</source>. <comment>Version 0.11.9. <ext-link ext-link-type="uri" xlink:href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">https://www.bioinformatics.babraham.ac.uk/projects/fastqc/</ext-link>. Accessed 29 June 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DePristo</surname>  <given-names>MA</given-names></string-name>, <string-name><surname>Banks</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Poplin</surname>  <given-names>R</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nat Genet</source>. <year>2011</year>;<volume>43</volume>:<fpage>491</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21478889</pub-id></mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Marshall</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>HTSlib - C library for reading/writing high-throughput sequencing data</article-title>. <source>Gigascience</source>. <year>2021</year>;<bold>10</bold>(2): doi:10.1093/gigascience/giab007</mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2020</year>
<comment>SAMtools, Version 1.11. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/samtools/releases/tag/1.11">https://github.com/samtools/samtools/releases/tag/1.11</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib28_175_1612547700797">
      <label>10.</label>
      <mixed-citation publication-type="journal"><comment>SAMtools - Documentation</comment>, <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org/doc/">https://www.htslib.org/doc/</ext-link>  <comment>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib10">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hsi-Yang Fritz</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Leinonen</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Cochrane</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Efficient storage of high throughput DNA sequencing data using reference-based compression</article-title>. <source>Genome Res</source>. <year>2011</year>;<volume>21</volume>:<fpage>734</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">21245279</pub-id></mixed-citation>
    </ref>
    <ref id="bib29_162_1612547803367">
      <label>12.</label>
      <mixed-citation publication-type="journal"><comment>SAMtools - Workflow</comment>, <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org/workflow/">https://www.htslib.org/workflow/</ext-link>  <comment>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib11">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>Improving SNP discovery by base alignment quality</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>1157</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21320865</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2020</year>
<comment>BCFtools, Version 1.11. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/bcftools/releases/tag/1.11">https://github.com/samtools/bcftools/releases/tag/1.11</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib13">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2987</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <label>16.</label>
      <mixed-citation publication-type="journal">
        <comment>gvcftools</comment>
        <year>2020</year>
        <comment>Version 0.17.0. <ext-link ext-link-type="uri" xlink:href="https://sites.google.com/site/gvcftools">https://sites.google.com/site/gvcftools</ext-link>. Accessed 6 November 2020.</comment>
      </mixed-citation>
    </ref>
    <ref id="bib15">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schilbert</surname>  <given-names>HM</given-names></string-name>, <string-name><surname>Rempel</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Pucker</surname>  <given-names>B</given-names></string-name></person-group><article-title>Comparison of read mapping and variant calling tools for the analysis of plant NGS data</article-title>. <source>Plants (Basel)</source>. <year>2020</year>;<volume>9</volume>(<issue>4</issue>):<fpage>439</fpage>.</mixed-citation>
    </ref>
    <ref id="bib16">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pightling</surname>  <given-names>AW</given-names></string-name>, <string-name><surname>Petronella</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Pagotto</surname>  <given-names>F</given-names></string-name></person-group><article-title>Choice of reference-guided sequence assembler and SNP caller for analysis of <italic>Listeria monocytogenes</italic> short-read sequence data greatly influences rates of error</article-title>. <source>BMC Res Notes</source>. <year>2015</year>;<volume>8</volume>:<fpage>748</fpage>.<pub-id pub-id-type="pmid">26643440</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R</given-names></string-name></person-group><article-title>Crumble: reference free lossy compression of sequence quality values</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>:<fpage>337</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29992288</pub-id></mixed-citation>
    </ref>
    <ref id="bib18">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>L</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Systematic comparative analysis of single-nucleotide variant detection methods from single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>. <year>2019</year>;<volume>20</volume>:<fpage>242</fpage>.<pub-id pub-id-type="pmid">31744515</pub-id></mixed-citation>
    </ref>
    <ref id="bib19">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Narasimhan</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Scally</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>BCFtools/RoH: a hidden Markov model approach for detecting autozygosity from next-generation sequencing data</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>:<fpage>1749</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">26826718</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>HipSci</surname>  <given-names>Consortium</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R</given-names></string-name></person-group><article-title>A method for checking genomic integrity in cultured cell lines from SNP genotyping data</article-title>. <source>PLoS One</source>. <year>2016</year>;<volume>11</volume>(<issue>5</issue>):<fpage>e0155014</fpage>.<pub-id pub-id-type="pmid">27176002</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McLaren</surname>  <given-names>W</given-names></string-name>, <string-name><surname>Gil</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Hunt</surname>  <given-names>SE</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The Ensembl Variant Effect Predictor</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>122</fpage>.<pub-id pub-id-type="pmid">27268795</pub-id></mixed-citation>
    </ref>
    <ref id="bib30_604_1612548058839">
      <label>24.</label>
      <mixed-citation publication-type="journal"><comment>BCFtools <ext-link ext-link-type="uri" xlink:href="https://samtools.github.io/bcftools/">https://samtools.github.io/bcftools/</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib22">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grüning</surname>  <given-names>B</given-names></string-name>, <string-name><surname>The Bioconda</surname>  <given-names>Team</given-names></string-name>, <string-name><surname>Dale</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Sjödin</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Bioconda: sustainable and comprehensive software distribution for the life sciences</article-title>. <source>Nat Methods</source>. <year>2018</year>:<fpage>475</fpage>–<lpage>6</lpage>..<pub-id pub-id-type="pmid">29967506</pub-id></mixed-citation>
    </ref>
    <ref id="bib23">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name></person-group><article-title>BCFtools/csq: haplotype-aware variant consequences</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>:<fpage>2037</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">28205675</pub-id></mixed-citation>
    </ref>
    <ref id="bib24">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nethercote</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Seward</surname>  <given-names>J</given-names></string-name></person-group><article-title>Valgrind: a framework for heavyweight dynamic binary instrumentation</article-title>. <source>SIGPLAN Not</source>. <year>2007</year>;<volume>42</volume>:<fpage>89</fpage>–<lpage>100</lpage>.</mixed-citation>
    </ref>
    <ref id="bib25">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Serebryany</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Bruening</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Potapenko</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>AddressSanitizer: a fast address sanity checker</article-title>. <comment>Proceedings of the 2012 USENIX Annual Technical Conference</comment>
<year>2012</year>
<comment><ext-link ext-link-type="uri" xlink:href="https://www.usenix.org/system/files/conference/atc12/atc12-final39.pdf">https://www.usenix.org/system/files/conference/atc12/atc12-final39.pdf</ext-link>. Accessed 6 November 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib26">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2019</year>
<comment>Define Local Alleles in VCF to allow for sparser format by yfarjoun. Pull Request #434. samtools/hts-specs. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/hts-specs/pull/434">https://github.com/samtools/hts-specs/pull/434</ext-link>. Accessed 10 July 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib27">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Liddle</surname>  <given-names>J</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Supporting data for “Twelve years of SAMtools and BCFtools.”</article-title>. <source>GigaScience Database</source>. <year>2021</year>
<pub-id pub-id-type="doi">10.5524/100866</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7931819</article-id>
    <article-id pub-id-type="pmid">33590861</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/giab008</article-id>
    <article-id pub-id-type="publisher-id">giab008</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00960</subject>
        <subject>AcademicSubjects/SCI02254</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Twelve years of SAMtools and BCFtools</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4159-1666</contrib-id>
        <name>
          <surname>Danecek</surname>
          <given-names>Petr</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6447-4112</contrib-id>
        <name>
          <surname>Bonfield</surname>
          <given-names>James K</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1059-1230</contrib-id>
        <name>
          <surname>Liddle</surname>
          <given-names>Jennifer</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1216-5457</contrib-id>
        <name>
          <surname>Marshall</surname>
          <given-names>John</given-names>
        </name>
        <aff><institution>Wolfson Wohl Cancer Research Centre, Institute of Cancer Sciences, University of Glasgow</institution>, Switchback Road, Glasgow, G61 1QH, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0532-6021</contrib-id>
        <name>
          <surname>Ohan</surname>
          <given-names>Valeriu</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8738-0920</contrib-id>
        <name>
          <surname>Pollard</surname>
          <given-names>Martin O</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8117-400X</contrib-id>
        <name>
          <surname>Whitwham</surname>
          <given-names>Andrew</given-names>
        </name>
        <!--<email>samtools@sanger.ac.uk</email>-->
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7532-6898</contrib-id>
        <name>
          <surname>Keane</surname>
          <given-names>Thomas</given-names>
        </name>
        <aff><institution>EMBL-EBI, Wellcome Genome Campus, Hinxton, Cambridgeshire</institution>, CB10 1SD, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2715-4187</contrib-id>
        <name>
          <surname>McCarthy</surname>
          <given-names>Shane A</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9983-1378</contrib-id>
        <name>
          <surname>Davies</surname>
          <given-names>Robert M</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4874-2874</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <aff><institution>Department of Data Sciences, Dana-Farber Cancer Institute, 450 Brookline Avenue</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Informatics, Harvard Medical School, 10 Shattuck Street</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><bold>Correspondence address</bold>. Andrew Whitwham, Wellcome Sanger Institute, Wellcome Genome Campus, Hinxton, Cambridgeshire, CB10 1SA, UK. Tel: +44 (0)1223 834244; E-mail: <email>samtools@sanger.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="epub" iso-8601-date="2021-02-16">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>10</volume>
    <issue>2</issue>
    <elocation-id>giab008</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press GigaScience.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="giab008.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="abs1">
        <title>Background</title>
        <p>SAMtools and BCFtools are widely used programs for processing and analysing high-throughput sequencing data. They include tools for file format conversion and manipulation, sorting, querying, statistics, variant calling, and effect analysis amongst other methods.</p>
      </sec>
      <sec id="abs2">
        <title>Findings</title>
        <p>The first version appeared online 12 years ago and has been maintained and further developed ever since, with many new features and improvements added over the years. The SAMtools and BCFtools packages represent a unique collection of tools that have been used in numerous other software projects and countless genomic pipelines.</p>
      </sec>
      <sec id="abs3">
        <title>Conclusion</title>
        <p>Both SAMtools and BCFtools are freely available on GitHub under the permissive MIT licence, free for both non-commercial and commercial use. Both packages have been installed &gt;1 million times via Bioconda. The source code and documentation are available from <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>samtools</kwd>
      <kwd>bcftools</kwd>
      <kwd>high-throughput sequencing</kwd>
      <kwd>next generation sequencing</kwd>
      <kwd>variant calling</kwd>
      <kwd>data analysis</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>206194</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Background</title>
    <p>With the advancement of genome sequencing technologies and large-scale sequencing projects, new data formats became necessary for interoperability, compact storage, and efficient analysis of the data. Among the most common formats used in this field today are SAM [<xref rid="bib1" ref-type="bibr">1</xref>] and VCF [<xref rid="bib2" ref-type="bibr">2</xref>], developed by the 1000 Genomes Project [<xref rid="bib3" ref-type="bibr">3</xref>]. These specialized formats for storing read alignments (SAM) and genetic variants (VCF) are row-oriented tab-delimited text files, which are easy to process using custom scripts but slow to parse and can be inefficient to store. Therefore in practice, the binary counterparts BAM or CRAM are used for alignment data and, when parsing of large VCF files becomes prohibitively slow, BCF provides a more efficient format for processing variation data.</p>
    <p>Despite the conceptual simplicity of the underlying DNA sequence, the alignment and variant data carry rich information. These data undergo a number of processing steps, many of which are algorithmically complex and require specialized software. Also more programming effort and expertise are necessary to parse binary formats. Therefore programs and toolkits that encompass functionality for the most common tasks have been developed. These include tools for file manipulation, quality control, and data analyses, such as sambamba [<xref rid="bib4" ref-type="bibr">4</xref>], biobambam [<xref rid="bib5" ref-type="bibr">5</xref>], FastQC [<xref rid="bib6" ref-type="bibr">6</xref>], and GATK [<xref rid="bib7" ref-type="bibr">7</xref>]. A successful bioinformatics tool must keep up with advancements in sequencing technologies (e.g., substantial increase in sequencing read length), scale well with ever-increasing amounts of data (from single to hundreds of thousands of genomes), and expand focus to encompass new analyses and more complex types of variation. New species also bring challenges such as large chromosomes not representable by 32 bits (&gt;2 Gb) or assumptions about the ploidy of an organism. In this article we describe the status, new features, and developments in SAMtools and BCFtools.</p>
    <p>SAMtools was originally published in 2009 [<xref rid="bib1" ref-type="bibr">1</xref>]. Readers of the online edition of that article would have been able to download release 0.1.4. The package included not only utilities to convert and manipulate SAM and BAM files but also a variant caller, which was soon restructured into the BCFtools subpackage (2010, release 0.1.9). Later it became apparent that third-party projects were trying to use code from SAMtools despite it not being designed to be embedded in that way. Therefore the decision was taken in August 2014 (release 1.0) to split the SAMtools package into a stand-alone library with a well-defined API (HTSlib, currently 82k lines of code) [<xref rid="bib8" ref-type="bibr">8</xref>], a project for variant calling and manipulation of variant data (BCFtools, 71k lines), and SAMtools for working with alignment data (42k lines). All 3 projects are maintained in parallel, and improvements to HTSlib naturally filter into new releases of SAMtools and BCFtools. Since the original release the combined size of HTSlib, SAMtools, and BCFtools has doubled.</p>
  </sec>
  <sec id="sec2">
    <title>Findings</title>
    <sec id="sec2-1">
      <title>SAMtools</title>
      <p>Since the initial release there have been &gt;2,200 commits to the code repository and 52 releases, the most recent being version 1.11 in September 2020 [<xref rid="bib9" ref-type="bibr">9</xref>].</p>
      <p>The main part of the SAMtools package is a single executable that offers various commands for working on alignment data. The “view" command performs format conversion, file filtering, and extraction of sequence ranges. Files can be reordered, joined, and split in various ways using the commands sort, collate, merge, cat, and split. Files can be indexed for fast random access using “index" for alignment files and “faidx" for reference sequences in the FASTA format. File content can be manipulated with commands like addreplacerg, calmd, fixmate, and reheader. Duplicated reads, caused by artefacts in the library creation and sequencing process, can be flagged using markdup. Various statistics on alignment files can be calculated using idxstats, flagstat, stats, depth, and bedcov. Data can be converted to legacy formats using fasta and fastq. For position-ordered files, the sequence alignment can be viewed using tview or output via mpileup in a way that can be used for ongoing processing (e.g., variant calling). Most recently SAMtools has gained support for amplicon-based sequencing projects via ampliconclip and ampliconstats.</p>
      <p>For a complete list of SAMtools commands with a short summary, version, and date of the initial commit see <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S1</xref>. Full documentation for these commands is included with the package in the form of UNIX man pages and can also be found online [<xref rid="bib28_175_1612547700797" ref-type="bibr">10</xref>].</p>
      <p>Early releases of SAMtools could read and write alignment data in the SAM and BAM formats. The 1.0 release introduced support for the better-compressed CRAM format [<xref rid="bib10" ref-type="bibr">11</xref>]. Originally, the program required the use of command line options to select the input format, and most commands were tied to using BAM files. These restrictions were removed as SAMtools transitioned to use HTSlib, so by release 1.0 most commands could automatically detect the input file format and could directly read and write SAM, BAM, and CRAM files. In particular, there is rarely any need to convert SAM to BAM using “samtools view -b” before running commands like “samtools sort,” although regrettably this idiom still appears in a large number of online tutorials. We encourage readers to follow best practices and workflows published at [<xref rid="bib29_162_1612547803367" ref-type="bibr">12</xref>].</p>
      <p>SAMtools has also become faster, most notably by gaining the ability to use threads to take better advantage of the parallelism available on modern multicore systems. Thread support first arrived in version 0.1.19 (March 2013), which enabled them for sorting and BAM file writing in the view command. The number of tasks using threads has slowly increased, so now (thanks to improvements in HTSlib) it is possible to use them for both reading and writing SAM, BAM, and CRAM formats in most of the commands. Another time-saving improvement is the ability to index files as they are written (added in 1.10). This allows pipelines that need to index files to remove the separate “samtools index” stage and associated read-through of the file being indexed.</p>
    </sec>
    <sec id="sec2-2">
      <title>BCFtools</title>
      <p>The original purpose of the BCFtools package was to divide the I/O- and CPU-intensive tasks of variant calling into separate steps.</p>
      <p>The first step, initially “samtools mpileup” but subsequently moved to “bcftools mpileup,” reads the alignments and for each position of the genome constructs a vertical slice across all reads covering the position (“pileup”). Genotype likelihoods are then calculated, representing how consistent are the observed data with the possible diploid genotypes. The calculation takes into account mapping qualities of the reads, base qualities, and the probability of local misalignment, per-base alignment quality (BAQ) [<xref rid="bib11" ref-type="bibr">13</xref>]. The second step, “bcftools call” (known in the initial release as “bcftools view”), then evaluates the most likely genotype under the assumption of Hardy-Weinberg equilibrium (in the sample context customizable by the user) using allele frequencies estimated from the data or provided explicitly by the user. In 2016 (release 1.4) genotype likelihood generation was moved from SAMtools to BCFtools to make both variant-calling steps part of the same package and to prevent errors arising from the possible use of incompatible versions of the 2 programs.</p>
      <p>Today BCFtools is a full-featured program that consists of 21 commands and 38 plugins (single-purpose tools) with &gt;230 documented command line switches and options. As of writing, there have been &gt;2,300 commits and 29 releases since 2012, with the most recent, 1.11, released in September 2020 [<xref rid="bib12" ref-type="bibr">14</xref>].</p>
      <p>The “bcftools view” command provides conversion between the text VCF and the binary BCF format, where both formats can be either plain (uncompressed) or block-compressed with BGZF for random access and compact size. The plain text VCF output is useful for visual inspection, for processing with custom scripts, and as a data exchange format. It should not be used when performance is critical because BCFtools internally uses the binary BCF representation and the conversion between the text VCF format and the binary BCF format is costly. Also compression and decompression is CPU intensive, and therefore when streaming between multiple commands in a pipeline it is recommended to stream uncompressed BCF by appending the option “-Ou.”</p>
      <p>The program can do much more than convert between VCF and BCF formats. It can also process third-party formats (using the “convert" command) and manipulate variant files in many ways. It can be used to index, sort, and normalize variants (“norm"), replace headers (“reheader"), add and remove annotations (“annotate"), and subset samples (“view"). Most commands can filter sites either by a region, list of sites, or a general Boolean expression involving any combination of VCF tags (--include, --exclude). Multiple files can be compared, splitting common and file-specific variants into separate files according to custom rules (isec). Files sorted by position can also be combined using the merge command (input files have different samples) or concat command (input files have the same samples). Arbitrary fields can be extracted and formatted into a custom text output (query), a feature that, among other things, is useful for scripting.</p>
      <p>Apart from file manipulation, the program offers variant callers and algorithms useful for analysis. For calling single-nucleotide polymorphisms and short indels from read alignment files, BCFtools implements 2 variant-calling models. In addition to the original biallelic caller (“bcftools call -c” [<xref rid="bib13" ref-type="bibr">15</xref>]) there is a newer model available, capable of handling positions with multiple alternate alleles (“bcftools call -m”) and supporting gVCF output [<xref rid="bib14" ref-type="bibr">16</xref>]. (For a recent comparison of the variant-calling component of the software see [<xref rid="bib15" ref-type="bibr">17–20</xref>].) The package implements a hidden Markov model caller for detection of runs of homozygosity (roh [<xref rid="bib19" ref-type="bibr">21</xref>]), copy-number variation calling from single-nucleotide polymorphism array data (cnv [<xref rid="bib20" ref-type="bibr">22</xref>]), and the detection of whole-chromosome aberrations (polysomy). The program can construct a consensus sequence given a FASTA and a variant file (consensus), perform sample identity checks (gtcheck), and collect various statistics (stats).</p>
      <p>In addition to built-in commands, the program supports a dynamic plugin mechanism for specific single-purpose tasks with a diverse range of functions. Examples from a large and ever-growing collection include the plugin split-vep for convenient querying and extraction of VEP annotations [<xref rid="bib21" ref-type="bibr">23</xref>]; trio-dnm for ascertainment of <italic>de novo</italic> variants and their parental origin (parental-origin), or for collection of statistics (trio-stats) in trio data; gVCF manipulation (gvcfz); and many more.</p>
      <p>For a complete list of BCFtools commands and plugins with a short summary, version, and date of the initial commit see <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S2</xref>. Full documentation for these commands is included with the package in the form of UNIX man pages and can also be found online together with short tutorials, math notes, and other documentation at [<xref rid="bib30_604_1612548058839" ref-type="bibr">24</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec3">
    <title>Discussion</title>
    <p>SAMtools and BCFtools represent a unique collection of tools useful for processing and analysis of sequencing data. Their development has been driven by the need of both large projects and individual user requests issued via GitHub. The code has been installed &gt;1 million times via Bioconda [<xref rid="bib22" ref-type="bibr">25</xref>] and GitHub releases [<xref rid="bib9" ref-type="bibr">9</xref>, <xref rid="bib12" ref-type="bibr">14</xref>], and &gt;1600 support and feature requests have been resolved on GitHub.</p>
    <p>The programs are written in the C programming language and optimized for low memory consumption and high speed. For example, the “bcftools csq” command for prediction of functional consequences in a haplotype-aware manner requires only a fraction of the memory required by VEP and is 2 orders of magnitude faster [<xref rid="bib23" ref-type="bibr">26</xref>].</p>
    <p>Much work has been done to increase the reliability of SAMtools and BCFtools. The test harnesses now include ∼700 tests in SAMtools and ∼1,400 in BCFtools. Continuous integration services run all of the tests on a variety of platforms (including Linux, MacOS, and Windows) whenever code is checked into the source repository, ensuring that bugs are discovered and fixed rapidly. Code quality is also assured by checking for memory errors, originally using Valgrind memcheck [<xref rid="bib24" ref-type="bibr">27</xref>] and more recently with AddressSanitizer [<xref rid="bib25" ref-type="bibr">28</xref>]. Additionally, UndefinedBehaviorSanitizer is used to detect violations of the C standard.</p>
    <p>Despite the ever-growing sample sizes and rapid increases in the amount of sequenced data, the programs have withstood the test of time. However, extremely big files are produced by large projects and their processing requires a high degree of parallelization on computing clusters. Future versions of SAMtools and BCFtools are expected to make more use of threaded code to allow faster processing of such files. Sometimes even the limits of BCF representation itself can be reached. For example, highly polymorphic sites can contain dozens of alternate indel alleles, which, in files with tens of thousands of samples, exceed the internal limit of 4 GB per site due to quadratic scaling of annotations such as FORMAT/PL. An extension of the VCF specification has been proposed to address this problem by introducing a localized version of such annotations with linear scaling [<xref rid="bib26" ref-type="bibr">29</xref>] and has been implemented in BCFtools.</p>
    <p>The programs have been used to process and analyze sequencing data from all types of species: vertebrates, invertebrates, pathogens, plants, and viruses. This provides interesting challenges and opportunities for future development. For example, some of the BCFtools commands are limited to handling haploid and diploid organisms and the support for large “64-bit” genomes is currently only partial. More work is also planned to overcome difficulties stemming from ambiguities in VCF allele encoding (such as operations of atomization and deatomization) and to improve visualization of results, and there are &gt;50 feature requests currently registered on GitHub to investigate.</p>
  </sec>
  <sec id="sec4">
    <title>Availability of Supporting Source Code and Requirements</title>
    <p>Project name: SAMtools</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/samtools">https://github.com/samtools/samtools</ext-link></p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: C</p>
    <p>License: MIT/Expat</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_002105">RRID:SCR_002105</ext-link>
    </p>
    <p>biotools: samtools</p>
    <p>Project name: BCFtools</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/bcftools">https://github.com/samtools/bcftools</ext-link></p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: C</p>
    <p>Other requirements: Optional use of GNU Scientific Library (GSL)</p>
    <p>License: MIT/Expat</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_002105">RRID:SCR_002105</ext-link>
    </p>
    <p>biotools: bcftools</p>
  </sec>
  <sec sec-type="data-availability" id="sec5">
    <title>Data Availability</title>
    <p>Snapshots of the code and tabular files are available from the <italic>GigaScience</italic> GigaDB repository [<xref rid="bib27" ref-type="bibr">30</xref>].</p>
  </sec>
  <sec id="sec6">
    <title>Editors Note</title>
    <p>An accompanying article describing the HTSlib software library for providing programmatic access is published alongside this article [<xref rid="bib8" ref-type="bibr">8</xref>].</p>
  </sec>
  <sec id="sec7">
    <title>Additional Files</title>
    <p>Supplementary Table S1: Table of SAMtools commands</p>
    <p>Supplementary Table S2: Table of BCFtools commands</p>
  </sec>
  <sec id="h1content1612547370513">
    <title>Abbreviations</title>
    <p>API: Application Programming Interface; CPU: central processing unit; GATK: Genome Analysis Toolkit; Gb: gigabase pairs.</p>
  </sec>
  <sec id="sec8">
    <title>Competing Interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec id="sec9">
    <title>Funding</title>
    <p>This work was supported by a Wellcome Trust grant (206194).</p>
  </sec>
  <sec id="sec10">
    <title>Authors' Contributions</title>
    <p>J.K.B., P.D., R.M.D., H.L., J.M., M.O.P., V.O., and A.W. wrote the SAMtools software with J.L. and S.A.M. supporting; R.M.D., T.K., and J.M. provided supervision.</p>
    <p>P.D. and S.A.M. wrote the BCFtools software with J.K.B., R.M.D., H.L., J.M., and V.O. supporting; S.A.M. also provided supervision.</p>
    <p>J.K.B., P.D., R.M.D., V.O., and A.W. wrote the original draft of the manuscript with all authors reviewing.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>giab008_GIGA-D-20-00369_Original_Submission</label>
      <media xlink:href="giab008_giga-d-20-00369_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>giab008_GIGA-D-20-00369_Revision_1</label>
      <media xlink:href="giab008_giga-d-20-00369_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>giab008_Response_to_Reviewer_Comments_Original_Submission</label>
      <media xlink:href="giab008_response_to_reviewer_comments_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>giab008_Reviewer_1_Report_Original_Submission</label>
      <caption>
        <p>Fan Zhang -- 1/3/2021 Reviewed</p>
      </caption>
      <media xlink:href="giab008_reviewer_1_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>giab008_Reviewer_2_Report_Original_Submission</label>
      <caption>
        <p>Chris Chang -- 1/6/2021 Reviewed</p>
      </caption>
      <media xlink:href="giab008_reviewer_2_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>giab008_Supplemental_Files</label>
      <media xlink:href="giab008_supplemental_files.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Handsaker</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Wysoker</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>2078</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Auton</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Abecasis</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2156</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>The 1000 Genomes Project Consortium</collab>.</person-group>  <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>. <year>2015</year>;<volume>526</volume>:<fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarasov</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Vilella</surname>  <given-names>AJ</given-names></string-name>, <string-name><surname>Cuppen</surname>  <given-names>E</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Sambamba: fast processing of NGS alignment formats</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>:<fpage>2032</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">25697820</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tischler</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Leonard</surname>  <given-names>S</given-names></string-name></person-group><article-title>biobambam: tools for read pair collation based algorithms on BAM files</article-title>. <source>Source Code Biol Med</source>. <year>2014</year>;<volume>9</volume>:<fpage>2078</fpage>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Babraham Bioinformatics</collab>.</person-group>  <year>2019</year>
<source>FastQC: A quality control tool for high throughput sequence data</source>. <comment>Version 0.11.9. <ext-link ext-link-type="uri" xlink:href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">https://www.bioinformatics.babraham.ac.uk/projects/fastqc/</ext-link>. Accessed 29 June 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DePristo</surname>  <given-names>MA</given-names></string-name>, <string-name><surname>Banks</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Poplin</surname>  <given-names>R</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nat Genet</source>. <year>2011</year>;<volume>43</volume>:<fpage>491</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21478889</pub-id></mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Marshall</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>HTSlib - C library for reading/writing high-throughput sequencing data</article-title>. <source>Gigascience</source>. <year>2021</year>;<bold>10</bold>(2): doi:10.1093/gigascience/giab007</mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2020</year>
<comment>SAMtools, Version 1.11. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/samtools/releases/tag/1.11">https://github.com/samtools/samtools/releases/tag/1.11</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib28_175_1612547700797">
      <label>10.</label>
      <mixed-citation publication-type="journal"><comment>SAMtools - Documentation</comment>, <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org/doc/">https://www.htslib.org/doc/</ext-link>  <comment>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib10">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hsi-Yang Fritz</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Leinonen</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Cochrane</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Efficient storage of high throughput DNA sequencing data using reference-based compression</article-title>. <source>Genome Res</source>. <year>2011</year>;<volume>21</volume>:<fpage>734</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">21245279</pub-id></mixed-citation>
    </ref>
    <ref id="bib29_162_1612547803367">
      <label>12.</label>
      <mixed-citation publication-type="journal"><comment>SAMtools - Workflow</comment>, <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org/workflow/">https://www.htslib.org/workflow/</ext-link>  <comment>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib11">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>Improving SNP discovery by base alignment quality</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>1157</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21320865</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2020</year>
<comment>BCFtools, Version 1.11. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/bcftools/releases/tag/1.11">https://github.com/samtools/bcftools/releases/tag/1.11</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib13">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2987</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <label>16.</label>
      <mixed-citation publication-type="journal">
        <comment>gvcftools</comment>
        <year>2020</year>
        <comment>Version 0.17.0. <ext-link ext-link-type="uri" xlink:href="https://sites.google.com/site/gvcftools">https://sites.google.com/site/gvcftools</ext-link>. Accessed 6 November 2020.</comment>
      </mixed-citation>
    </ref>
    <ref id="bib15">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schilbert</surname>  <given-names>HM</given-names></string-name>, <string-name><surname>Rempel</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Pucker</surname>  <given-names>B</given-names></string-name></person-group><article-title>Comparison of read mapping and variant calling tools for the analysis of plant NGS data</article-title>. <source>Plants (Basel)</source>. <year>2020</year>;<volume>9</volume>(<issue>4</issue>):<fpage>439</fpage>.</mixed-citation>
    </ref>
    <ref id="bib16">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pightling</surname>  <given-names>AW</given-names></string-name>, <string-name><surname>Petronella</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Pagotto</surname>  <given-names>F</given-names></string-name></person-group><article-title>Choice of reference-guided sequence assembler and SNP caller for analysis of <italic>Listeria monocytogenes</italic> short-read sequence data greatly influences rates of error</article-title>. <source>BMC Res Notes</source>. <year>2015</year>;<volume>8</volume>:<fpage>748</fpage>.<pub-id pub-id-type="pmid">26643440</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R</given-names></string-name></person-group><article-title>Crumble: reference free lossy compression of sequence quality values</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>:<fpage>337</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29992288</pub-id></mixed-citation>
    </ref>
    <ref id="bib18">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>L</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Systematic comparative analysis of single-nucleotide variant detection methods from single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>. <year>2019</year>;<volume>20</volume>:<fpage>242</fpage>.<pub-id pub-id-type="pmid">31744515</pub-id></mixed-citation>
    </ref>
    <ref id="bib19">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Narasimhan</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Scally</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>BCFtools/RoH: a hidden Markov model approach for detecting autozygosity from next-generation sequencing data</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>:<fpage>1749</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">26826718</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>HipSci</surname>  <given-names>Consortium</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R</given-names></string-name></person-group><article-title>A method for checking genomic integrity in cultured cell lines from SNP genotyping data</article-title>. <source>PLoS One</source>. <year>2016</year>;<volume>11</volume>(<issue>5</issue>):<fpage>e0155014</fpage>.<pub-id pub-id-type="pmid">27176002</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McLaren</surname>  <given-names>W</given-names></string-name>, <string-name><surname>Gil</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Hunt</surname>  <given-names>SE</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The Ensembl Variant Effect Predictor</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>122</fpage>.<pub-id pub-id-type="pmid">27268795</pub-id></mixed-citation>
    </ref>
    <ref id="bib30_604_1612548058839">
      <label>24.</label>
      <mixed-citation publication-type="journal"><comment>BCFtools <ext-link ext-link-type="uri" xlink:href="https://samtools.github.io/bcftools/">https://samtools.github.io/bcftools/</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib22">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grüning</surname>  <given-names>B</given-names></string-name>, <string-name><surname>The Bioconda</surname>  <given-names>Team</given-names></string-name>, <string-name><surname>Dale</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Sjödin</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Bioconda: sustainable and comprehensive software distribution for the life sciences</article-title>. <source>Nat Methods</source>. <year>2018</year>:<fpage>475</fpage>–<lpage>6</lpage>..<pub-id pub-id-type="pmid">29967506</pub-id></mixed-citation>
    </ref>
    <ref id="bib23">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name></person-group><article-title>BCFtools/csq: haplotype-aware variant consequences</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>:<fpage>2037</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">28205675</pub-id></mixed-citation>
    </ref>
    <ref id="bib24">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nethercote</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Seward</surname>  <given-names>J</given-names></string-name></person-group><article-title>Valgrind: a framework for heavyweight dynamic binary instrumentation</article-title>. <source>SIGPLAN Not</source>. <year>2007</year>;<volume>42</volume>:<fpage>89</fpage>–<lpage>100</lpage>.</mixed-citation>
    </ref>
    <ref id="bib25">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Serebryany</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Bruening</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Potapenko</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>AddressSanitizer: a fast address sanity checker</article-title>. <comment>Proceedings of the 2012 USENIX Annual Technical Conference</comment>
<year>2012</year>
<comment><ext-link ext-link-type="uri" xlink:href="https://www.usenix.org/system/files/conference/atc12/atc12-final39.pdf">https://www.usenix.org/system/files/conference/atc12/atc12-final39.pdf</ext-link>. Accessed 6 November 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib26">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2019</year>
<comment>Define Local Alleles in VCF to allow for sparser format by yfarjoun. Pull Request #434. samtools/hts-specs. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/hts-specs/pull/434">https://github.com/samtools/hts-specs/pull/434</ext-link>. Accessed 10 July 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib27">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Liddle</surname>  <given-names>J</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Supporting data for “Twelve years of SAMtools and BCFtools.”</article-title>. <source>GigaScience Database</source>. <year>2021</year>
<pub-id pub-id-type="doi">10.5524/100866</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7931819</article-id>
    <article-id pub-id-type="pmid">33590861</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/giab008</article-id>
    <article-id pub-id-type="publisher-id">giab008</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00960</subject>
        <subject>AcademicSubjects/SCI02254</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Twelve years of SAMtools and BCFtools</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4159-1666</contrib-id>
        <name>
          <surname>Danecek</surname>
          <given-names>Petr</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6447-4112</contrib-id>
        <name>
          <surname>Bonfield</surname>
          <given-names>James K</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1059-1230</contrib-id>
        <name>
          <surname>Liddle</surname>
          <given-names>Jennifer</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1216-5457</contrib-id>
        <name>
          <surname>Marshall</surname>
          <given-names>John</given-names>
        </name>
        <aff><institution>Wolfson Wohl Cancer Research Centre, Institute of Cancer Sciences, University of Glasgow</institution>, Switchback Road, Glasgow, G61 1QH, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0532-6021</contrib-id>
        <name>
          <surname>Ohan</surname>
          <given-names>Valeriu</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8738-0920</contrib-id>
        <name>
          <surname>Pollard</surname>
          <given-names>Martin O</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8117-400X</contrib-id>
        <name>
          <surname>Whitwham</surname>
          <given-names>Andrew</given-names>
        </name>
        <!--<email>samtools@sanger.ac.uk</email>-->
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7532-6898</contrib-id>
        <name>
          <surname>Keane</surname>
          <given-names>Thomas</given-names>
        </name>
        <aff><institution>EMBL-EBI, Wellcome Genome Campus, Hinxton, Cambridgeshire</institution>, CB10 1SD, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2715-4187</contrib-id>
        <name>
          <surname>McCarthy</surname>
          <given-names>Shane A</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9983-1378</contrib-id>
        <name>
          <surname>Davies</surname>
          <given-names>Robert M</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4874-2874</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <aff><institution>Department of Data Sciences, Dana-Farber Cancer Institute, 450 Brookline Avenue</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Informatics, Harvard Medical School, 10 Shattuck Street</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><bold>Correspondence address</bold>. Andrew Whitwham, Wellcome Sanger Institute, Wellcome Genome Campus, Hinxton, Cambridgeshire, CB10 1SA, UK. Tel: +44 (0)1223 834244; E-mail: <email>samtools@sanger.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="epub" iso-8601-date="2021-02-16">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>10</volume>
    <issue>2</issue>
    <elocation-id>giab008</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press GigaScience.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="giab008.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="abs1">
        <title>Background</title>
        <p>SAMtools and BCFtools are widely used programs for processing and analysing high-throughput sequencing data. They include tools for file format conversion and manipulation, sorting, querying, statistics, variant calling, and effect analysis amongst other methods.</p>
      </sec>
      <sec id="abs2">
        <title>Findings</title>
        <p>The first version appeared online 12 years ago and has been maintained and further developed ever since, with many new features and improvements added over the years. The SAMtools and BCFtools packages represent a unique collection of tools that have been used in numerous other software projects and countless genomic pipelines.</p>
      </sec>
      <sec id="abs3">
        <title>Conclusion</title>
        <p>Both SAMtools and BCFtools are freely available on GitHub under the permissive MIT licence, free for both non-commercial and commercial use. Both packages have been installed &gt;1 million times via Bioconda. The source code and documentation are available from <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>samtools</kwd>
      <kwd>bcftools</kwd>
      <kwd>high-throughput sequencing</kwd>
      <kwd>next generation sequencing</kwd>
      <kwd>variant calling</kwd>
      <kwd>data analysis</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>206194</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Background</title>
    <p>With the advancement of genome sequencing technologies and large-scale sequencing projects, new data formats became necessary for interoperability, compact storage, and efficient analysis of the data. Among the most common formats used in this field today are SAM [<xref rid="bib1" ref-type="bibr">1</xref>] and VCF [<xref rid="bib2" ref-type="bibr">2</xref>], developed by the 1000 Genomes Project [<xref rid="bib3" ref-type="bibr">3</xref>]. These specialized formats for storing read alignments (SAM) and genetic variants (VCF) are row-oriented tab-delimited text files, which are easy to process using custom scripts but slow to parse and can be inefficient to store. Therefore in practice, the binary counterparts BAM or CRAM are used for alignment data and, when parsing of large VCF files becomes prohibitively slow, BCF provides a more efficient format for processing variation data.</p>
    <p>Despite the conceptual simplicity of the underlying DNA sequence, the alignment and variant data carry rich information. These data undergo a number of processing steps, many of which are algorithmically complex and require specialized software. Also more programming effort and expertise are necessary to parse binary formats. Therefore programs and toolkits that encompass functionality for the most common tasks have been developed. These include tools for file manipulation, quality control, and data analyses, such as sambamba [<xref rid="bib4" ref-type="bibr">4</xref>], biobambam [<xref rid="bib5" ref-type="bibr">5</xref>], FastQC [<xref rid="bib6" ref-type="bibr">6</xref>], and GATK [<xref rid="bib7" ref-type="bibr">7</xref>]. A successful bioinformatics tool must keep up with advancements in sequencing technologies (e.g., substantial increase in sequencing read length), scale well with ever-increasing amounts of data (from single to hundreds of thousands of genomes), and expand focus to encompass new analyses and more complex types of variation. New species also bring challenges such as large chromosomes not representable by 32 bits (&gt;2 Gb) or assumptions about the ploidy of an organism. In this article we describe the status, new features, and developments in SAMtools and BCFtools.</p>
    <p>SAMtools was originally published in 2009 [<xref rid="bib1" ref-type="bibr">1</xref>]. Readers of the online edition of that article would have been able to download release 0.1.4. The package included not only utilities to convert and manipulate SAM and BAM files but also a variant caller, which was soon restructured into the BCFtools subpackage (2010, release 0.1.9). Later it became apparent that third-party projects were trying to use code from SAMtools despite it not being designed to be embedded in that way. Therefore the decision was taken in August 2014 (release 1.0) to split the SAMtools package into a stand-alone library with a well-defined API (HTSlib, currently 82k lines of code) [<xref rid="bib8" ref-type="bibr">8</xref>], a project for variant calling and manipulation of variant data (BCFtools, 71k lines), and SAMtools for working with alignment data (42k lines). All 3 projects are maintained in parallel, and improvements to HTSlib naturally filter into new releases of SAMtools and BCFtools. Since the original release the combined size of HTSlib, SAMtools, and BCFtools has doubled.</p>
  </sec>
  <sec id="sec2">
    <title>Findings</title>
    <sec id="sec2-1">
      <title>SAMtools</title>
      <p>Since the initial release there have been &gt;2,200 commits to the code repository and 52 releases, the most recent being version 1.11 in September 2020 [<xref rid="bib9" ref-type="bibr">9</xref>].</p>
      <p>The main part of the SAMtools package is a single executable that offers various commands for working on alignment data. The “view" command performs format conversion, file filtering, and extraction of sequence ranges. Files can be reordered, joined, and split in various ways using the commands sort, collate, merge, cat, and split. Files can be indexed for fast random access using “index" for alignment files and “faidx" for reference sequences in the FASTA format. File content can be manipulated with commands like addreplacerg, calmd, fixmate, and reheader. Duplicated reads, caused by artefacts in the library creation and sequencing process, can be flagged using markdup. Various statistics on alignment files can be calculated using idxstats, flagstat, stats, depth, and bedcov. Data can be converted to legacy formats using fasta and fastq. For position-ordered files, the sequence alignment can be viewed using tview or output via mpileup in a way that can be used for ongoing processing (e.g., variant calling). Most recently SAMtools has gained support for amplicon-based sequencing projects via ampliconclip and ampliconstats.</p>
      <p>For a complete list of SAMtools commands with a short summary, version, and date of the initial commit see <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S1</xref>. Full documentation for these commands is included with the package in the form of UNIX man pages and can also be found online [<xref rid="bib28_175_1612547700797" ref-type="bibr">10</xref>].</p>
      <p>Early releases of SAMtools could read and write alignment data in the SAM and BAM formats. The 1.0 release introduced support for the better-compressed CRAM format [<xref rid="bib10" ref-type="bibr">11</xref>]. Originally, the program required the use of command line options to select the input format, and most commands were tied to using BAM files. These restrictions were removed as SAMtools transitioned to use HTSlib, so by release 1.0 most commands could automatically detect the input file format and could directly read and write SAM, BAM, and CRAM files. In particular, there is rarely any need to convert SAM to BAM using “samtools view -b” before running commands like “samtools sort,” although regrettably this idiom still appears in a large number of online tutorials. We encourage readers to follow best practices and workflows published at [<xref rid="bib29_162_1612547803367" ref-type="bibr">12</xref>].</p>
      <p>SAMtools has also become faster, most notably by gaining the ability to use threads to take better advantage of the parallelism available on modern multicore systems. Thread support first arrived in version 0.1.19 (March 2013), which enabled them for sorting and BAM file writing in the view command. The number of tasks using threads has slowly increased, so now (thanks to improvements in HTSlib) it is possible to use them for both reading and writing SAM, BAM, and CRAM formats in most of the commands. Another time-saving improvement is the ability to index files as they are written (added in 1.10). This allows pipelines that need to index files to remove the separate “samtools index” stage and associated read-through of the file being indexed.</p>
    </sec>
    <sec id="sec2-2">
      <title>BCFtools</title>
      <p>The original purpose of the BCFtools package was to divide the I/O- and CPU-intensive tasks of variant calling into separate steps.</p>
      <p>The first step, initially “samtools mpileup” but subsequently moved to “bcftools mpileup,” reads the alignments and for each position of the genome constructs a vertical slice across all reads covering the position (“pileup”). Genotype likelihoods are then calculated, representing how consistent are the observed data with the possible diploid genotypes. The calculation takes into account mapping qualities of the reads, base qualities, and the probability of local misalignment, per-base alignment quality (BAQ) [<xref rid="bib11" ref-type="bibr">13</xref>]. The second step, “bcftools call” (known in the initial release as “bcftools view”), then evaluates the most likely genotype under the assumption of Hardy-Weinberg equilibrium (in the sample context customizable by the user) using allele frequencies estimated from the data or provided explicitly by the user. In 2016 (release 1.4) genotype likelihood generation was moved from SAMtools to BCFtools to make both variant-calling steps part of the same package and to prevent errors arising from the possible use of incompatible versions of the 2 programs.</p>
      <p>Today BCFtools is a full-featured program that consists of 21 commands and 38 plugins (single-purpose tools) with &gt;230 documented command line switches and options. As of writing, there have been &gt;2,300 commits and 29 releases since 2012, with the most recent, 1.11, released in September 2020 [<xref rid="bib12" ref-type="bibr">14</xref>].</p>
      <p>The “bcftools view” command provides conversion between the text VCF and the binary BCF format, where both formats can be either plain (uncompressed) or block-compressed with BGZF for random access and compact size. The plain text VCF output is useful for visual inspection, for processing with custom scripts, and as a data exchange format. It should not be used when performance is critical because BCFtools internally uses the binary BCF representation and the conversion between the text VCF format and the binary BCF format is costly. Also compression and decompression is CPU intensive, and therefore when streaming between multiple commands in a pipeline it is recommended to stream uncompressed BCF by appending the option “-Ou.”</p>
      <p>The program can do much more than convert between VCF and BCF formats. It can also process third-party formats (using the “convert" command) and manipulate variant files in many ways. It can be used to index, sort, and normalize variants (“norm"), replace headers (“reheader"), add and remove annotations (“annotate"), and subset samples (“view"). Most commands can filter sites either by a region, list of sites, or a general Boolean expression involving any combination of VCF tags (--include, --exclude). Multiple files can be compared, splitting common and file-specific variants into separate files according to custom rules (isec). Files sorted by position can also be combined using the merge command (input files have different samples) or concat command (input files have the same samples). Arbitrary fields can be extracted and formatted into a custom text output (query), a feature that, among other things, is useful for scripting.</p>
      <p>Apart from file manipulation, the program offers variant callers and algorithms useful for analysis. For calling single-nucleotide polymorphisms and short indels from read alignment files, BCFtools implements 2 variant-calling models. In addition to the original biallelic caller (“bcftools call -c” [<xref rid="bib13" ref-type="bibr">15</xref>]) there is a newer model available, capable of handling positions with multiple alternate alleles (“bcftools call -m”) and supporting gVCF output [<xref rid="bib14" ref-type="bibr">16</xref>]. (For a recent comparison of the variant-calling component of the software see [<xref rid="bib15" ref-type="bibr">17–20</xref>].) The package implements a hidden Markov model caller for detection of runs of homozygosity (roh [<xref rid="bib19" ref-type="bibr">21</xref>]), copy-number variation calling from single-nucleotide polymorphism array data (cnv [<xref rid="bib20" ref-type="bibr">22</xref>]), and the detection of whole-chromosome aberrations (polysomy). The program can construct a consensus sequence given a FASTA and a variant file (consensus), perform sample identity checks (gtcheck), and collect various statistics (stats).</p>
      <p>In addition to built-in commands, the program supports a dynamic plugin mechanism for specific single-purpose tasks with a diverse range of functions. Examples from a large and ever-growing collection include the plugin split-vep for convenient querying and extraction of VEP annotations [<xref rid="bib21" ref-type="bibr">23</xref>]; trio-dnm for ascertainment of <italic>de novo</italic> variants and their parental origin (parental-origin), or for collection of statistics (trio-stats) in trio data; gVCF manipulation (gvcfz); and many more.</p>
      <p>For a complete list of BCFtools commands and plugins with a short summary, version, and date of the initial commit see <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S2</xref>. Full documentation for these commands is included with the package in the form of UNIX man pages and can also be found online together with short tutorials, math notes, and other documentation at [<xref rid="bib30_604_1612548058839" ref-type="bibr">24</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec3">
    <title>Discussion</title>
    <p>SAMtools and BCFtools represent a unique collection of tools useful for processing and analysis of sequencing data. Their development has been driven by the need of both large projects and individual user requests issued via GitHub. The code has been installed &gt;1 million times via Bioconda [<xref rid="bib22" ref-type="bibr">25</xref>] and GitHub releases [<xref rid="bib9" ref-type="bibr">9</xref>, <xref rid="bib12" ref-type="bibr">14</xref>], and &gt;1600 support and feature requests have been resolved on GitHub.</p>
    <p>The programs are written in the C programming language and optimized for low memory consumption and high speed. For example, the “bcftools csq” command for prediction of functional consequences in a haplotype-aware manner requires only a fraction of the memory required by VEP and is 2 orders of magnitude faster [<xref rid="bib23" ref-type="bibr">26</xref>].</p>
    <p>Much work has been done to increase the reliability of SAMtools and BCFtools. The test harnesses now include ∼700 tests in SAMtools and ∼1,400 in BCFtools. Continuous integration services run all of the tests on a variety of platforms (including Linux, MacOS, and Windows) whenever code is checked into the source repository, ensuring that bugs are discovered and fixed rapidly. Code quality is also assured by checking for memory errors, originally using Valgrind memcheck [<xref rid="bib24" ref-type="bibr">27</xref>] and more recently with AddressSanitizer [<xref rid="bib25" ref-type="bibr">28</xref>]. Additionally, UndefinedBehaviorSanitizer is used to detect violations of the C standard.</p>
    <p>Despite the ever-growing sample sizes and rapid increases in the amount of sequenced data, the programs have withstood the test of time. However, extremely big files are produced by large projects and their processing requires a high degree of parallelization on computing clusters. Future versions of SAMtools and BCFtools are expected to make more use of threaded code to allow faster processing of such files. Sometimes even the limits of BCF representation itself can be reached. For example, highly polymorphic sites can contain dozens of alternate indel alleles, which, in files with tens of thousands of samples, exceed the internal limit of 4 GB per site due to quadratic scaling of annotations such as FORMAT/PL. An extension of the VCF specification has been proposed to address this problem by introducing a localized version of such annotations with linear scaling [<xref rid="bib26" ref-type="bibr">29</xref>] and has been implemented in BCFtools.</p>
    <p>The programs have been used to process and analyze sequencing data from all types of species: vertebrates, invertebrates, pathogens, plants, and viruses. This provides interesting challenges and opportunities for future development. For example, some of the BCFtools commands are limited to handling haploid and diploid organisms and the support for large “64-bit” genomes is currently only partial. More work is also planned to overcome difficulties stemming from ambiguities in VCF allele encoding (such as operations of atomization and deatomization) and to improve visualization of results, and there are &gt;50 feature requests currently registered on GitHub to investigate.</p>
  </sec>
  <sec id="sec4">
    <title>Availability of Supporting Source Code and Requirements</title>
    <p>Project name: SAMtools</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/samtools">https://github.com/samtools/samtools</ext-link></p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: C</p>
    <p>License: MIT/Expat</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_002105">RRID:SCR_002105</ext-link>
    </p>
    <p>biotools: samtools</p>
    <p>Project name: BCFtools</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/bcftools">https://github.com/samtools/bcftools</ext-link></p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: C</p>
    <p>Other requirements: Optional use of GNU Scientific Library (GSL)</p>
    <p>License: MIT/Expat</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_002105">RRID:SCR_002105</ext-link>
    </p>
    <p>biotools: bcftools</p>
  </sec>
  <sec sec-type="data-availability" id="sec5">
    <title>Data Availability</title>
    <p>Snapshots of the code and tabular files are available from the <italic>GigaScience</italic> GigaDB repository [<xref rid="bib27" ref-type="bibr">30</xref>].</p>
  </sec>
  <sec id="sec6">
    <title>Editors Note</title>
    <p>An accompanying article describing the HTSlib software library for providing programmatic access is published alongside this article [<xref rid="bib8" ref-type="bibr">8</xref>].</p>
  </sec>
  <sec id="sec7">
    <title>Additional Files</title>
    <p>Supplementary Table S1: Table of SAMtools commands</p>
    <p>Supplementary Table S2: Table of BCFtools commands</p>
  </sec>
  <sec id="h1content1612547370513">
    <title>Abbreviations</title>
    <p>API: Application Programming Interface; CPU: central processing unit; GATK: Genome Analysis Toolkit; Gb: gigabase pairs.</p>
  </sec>
  <sec id="sec8">
    <title>Competing Interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec id="sec9">
    <title>Funding</title>
    <p>This work was supported by a Wellcome Trust grant (206194).</p>
  </sec>
  <sec id="sec10">
    <title>Authors' Contributions</title>
    <p>J.K.B., P.D., R.M.D., H.L., J.M., M.O.P., V.O., and A.W. wrote the SAMtools software with J.L. and S.A.M. supporting; R.M.D., T.K., and J.M. provided supervision.</p>
    <p>P.D. and S.A.M. wrote the BCFtools software with J.K.B., R.M.D., H.L., J.M., and V.O. supporting; S.A.M. also provided supervision.</p>
    <p>J.K.B., P.D., R.M.D., V.O., and A.W. wrote the original draft of the manuscript with all authors reviewing.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>giab008_GIGA-D-20-00369_Original_Submission</label>
      <media xlink:href="giab008_giga-d-20-00369_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>giab008_GIGA-D-20-00369_Revision_1</label>
      <media xlink:href="giab008_giga-d-20-00369_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>giab008_Response_to_Reviewer_Comments_Original_Submission</label>
      <media xlink:href="giab008_response_to_reviewer_comments_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>giab008_Reviewer_1_Report_Original_Submission</label>
      <caption>
        <p>Fan Zhang -- 1/3/2021 Reviewed</p>
      </caption>
      <media xlink:href="giab008_reviewer_1_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>giab008_Reviewer_2_Report_Original_Submission</label>
      <caption>
        <p>Chris Chang -- 1/6/2021 Reviewed</p>
      </caption>
      <media xlink:href="giab008_reviewer_2_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>giab008_Supplemental_Files</label>
      <media xlink:href="giab008_supplemental_files.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Handsaker</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Wysoker</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>2078</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Auton</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Abecasis</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2156</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>The 1000 Genomes Project Consortium</collab>.</person-group>  <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>. <year>2015</year>;<volume>526</volume>:<fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarasov</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Vilella</surname>  <given-names>AJ</given-names></string-name>, <string-name><surname>Cuppen</surname>  <given-names>E</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Sambamba: fast processing of NGS alignment formats</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>:<fpage>2032</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">25697820</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tischler</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Leonard</surname>  <given-names>S</given-names></string-name></person-group><article-title>biobambam: tools for read pair collation based algorithms on BAM files</article-title>. <source>Source Code Biol Med</source>. <year>2014</year>;<volume>9</volume>:<fpage>2078</fpage>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Babraham Bioinformatics</collab>.</person-group>  <year>2019</year>
<source>FastQC: A quality control tool for high throughput sequence data</source>. <comment>Version 0.11.9. <ext-link ext-link-type="uri" xlink:href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">https://www.bioinformatics.babraham.ac.uk/projects/fastqc/</ext-link>. Accessed 29 June 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DePristo</surname>  <given-names>MA</given-names></string-name>, <string-name><surname>Banks</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Poplin</surname>  <given-names>R</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nat Genet</source>. <year>2011</year>;<volume>43</volume>:<fpage>491</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21478889</pub-id></mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Marshall</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>HTSlib - C library for reading/writing high-throughput sequencing data</article-title>. <source>Gigascience</source>. <year>2021</year>;<bold>10</bold>(2): doi:10.1093/gigascience/giab007</mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2020</year>
<comment>SAMtools, Version 1.11. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/samtools/releases/tag/1.11">https://github.com/samtools/samtools/releases/tag/1.11</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib28_175_1612547700797">
      <label>10.</label>
      <mixed-citation publication-type="journal"><comment>SAMtools - Documentation</comment>, <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org/doc/">https://www.htslib.org/doc/</ext-link>  <comment>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib10">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hsi-Yang Fritz</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Leinonen</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Cochrane</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Efficient storage of high throughput DNA sequencing data using reference-based compression</article-title>. <source>Genome Res</source>. <year>2011</year>;<volume>21</volume>:<fpage>734</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">21245279</pub-id></mixed-citation>
    </ref>
    <ref id="bib29_162_1612547803367">
      <label>12.</label>
      <mixed-citation publication-type="journal"><comment>SAMtools - Workflow</comment>, <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org/workflow/">https://www.htslib.org/workflow/</ext-link>  <comment>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib11">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>Improving SNP discovery by base alignment quality</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>1157</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21320865</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2020</year>
<comment>BCFtools, Version 1.11. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/bcftools/releases/tag/1.11">https://github.com/samtools/bcftools/releases/tag/1.11</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib13">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2987</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <label>16.</label>
      <mixed-citation publication-type="journal">
        <comment>gvcftools</comment>
        <year>2020</year>
        <comment>Version 0.17.0. <ext-link ext-link-type="uri" xlink:href="https://sites.google.com/site/gvcftools">https://sites.google.com/site/gvcftools</ext-link>. Accessed 6 November 2020.</comment>
      </mixed-citation>
    </ref>
    <ref id="bib15">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schilbert</surname>  <given-names>HM</given-names></string-name>, <string-name><surname>Rempel</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Pucker</surname>  <given-names>B</given-names></string-name></person-group><article-title>Comparison of read mapping and variant calling tools for the analysis of plant NGS data</article-title>. <source>Plants (Basel)</source>. <year>2020</year>;<volume>9</volume>(<issue>4</issue>):<fpage>439</fpage>.</mixed-citation>
    </ref>
    <ref id="bib16">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pightling</surname>  <given-names>AW</given-names></string-name>, <string-name><surname>Petronella</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Pagotto</surname>  <given-names>F</given-names></string-name></person-group><article-title>Choice of reference-guided sequence assembler and SNP caller for analysis of <italic>Listeria monocytogenes</italic> short-read sequence data greatly influences rates of error</article-title>. <source>BMC Res Notes</source>. <year>2015</year>;<volume>8</volume>:<fpage>748</fpage>.<pub-id pub-id-type="pmid">26643440</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R</given-names></string-name></person-group><article-title>Crumble: reference free lossy compression of sequence quality values</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>:<fpage>337</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29992288</pub-id></mixed-citation>
    </ref>
    <ref id="bib18">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>L</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Systematic comparative analysis of single-nucleotide variant detection methods from single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>. <year>2019</year>;<volume>20</volume>:<fpage>242</fpage>.<pub-id pub-id-type="pmid">31744515</pub-id></mixed-citation>
    </ref>
    <ref id="bib19">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Narasimhan</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Scally</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>BCFtools/RoH: a hidden Markov model approach for detecting autozygosity from next-generation sequencing data</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>:<fpage>1749</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">26826718</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>HipSci</surname>  <given-names>Consortium</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R</given-names></string-name></person-group><article-title>A method for checking genomic integrity in cultured cell lines from SNP genotyping data</article-title>. <source>PLoS One</source>. <year>2016</year>;<volume>11</volume>(<issue>5</issue>):<fpage>e0155014</fpage>.<pub-id pub-id-type="pmid">27176002</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McLaren</surname>  <given-names>W</given-names></string-name>, <string-name><surname>Gil</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Hunt</surname>  <given-names>SE</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The Ensembl Variant Effect Predictor</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>122</fpage>.<pub-id pub-id-type="pmid">27268795</pub-id></mixed-citation>
    </ref>
    <ref id="bib30_604_1612548058839">
      <label>24.</label>
      <mixed-citation publication-type="journal"><comment>BCFtools <ext-link ext-link-type="uri" xlink:href="https://samtools.github.io/bcftools/">https://samtools.github.io/bcftools/</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib22">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grüning</surname>  <given-names>B</given-names></string-name>, <string-name><surname>The Bioconda</surname>  <given-names>Team</given-names></string-name>, <string-name><surname>Dale</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Sjödin</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Bioconda: sustainable and comprehensive software distribution for the life sciences</article-title>. <source>Nat Methods</source>. <year>2018</year>:<fpage>475</fpage>–<lpage>6</lpage>..<pub-id pub-id-type="pmid">29967506</pub-id></mixed-citation>
    </ref>
    <ref id="bib23">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name></person-group><article-title>BCFtools/csq: haplotype-aware variant consequences</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>:<fpage>2037</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">28205675</pub-id></mixed-citation>
    </ref>
    <ref id="bib24">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nethercote</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Seward</surname>  <given-names>J</given-names></string-name></person-group><article-title>Valgrind: a framework for heavyweight dynamic binary instrumentation</article-title>. <source>SIGPLAN Not</source>. <year>2007</year>;<volume>42</volume>:<fpage>89</fpage>–<lpage>100</lpage>.</mixed-citation>
    </ref>
    <ref id="bib25">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Serebryany</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Bruening</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Potapenko</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>AddressSanitizer: a fast address sanity checker</article-title>. <comment>Proceedings of the 2012 USENIX Annual Technical Conference</comment>
<year>2012</year>
<comment><ext-link ext-link-type="uri" xlink:href="https://www.usenix.org/system/files/conference/atc12/atc12-final39.pdf">https://www.usenix.org/system/files/conference/atc12/atc12-final39.pdf</ext-link>. Accessed 6 November 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib26">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2019</year>
<comment>Define Local Alleles in VCF to allow for sparser format by yfarjoun. Pull Request #434. samtools/hts-specs. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/hts-specs/pull/434">https://github.com/samtools/hts-specs/pull/434</ext-link>. Accessed 10 July 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib27">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Liddle</surname>  <given-names>J</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Supporting data for “Twelve years of SAMtools and BCFtools.”</article-title>. <source>GigaScience Database</source>. <year>2021</year>
<pub-id pub-id-type="doi">10.5524/100866</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7931819</article-id>
    <article-id pub-id-type="pmid">33590861</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/giab008</article-id>
    <article-id pub-id-type="publisher-id">giab008</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00960</subject>
        <subject>AcademicSubjects/SCI02254</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Twelve years of SAMtools and BCFtools</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4159-1666</contrib-id>
        <name>
          <surname>Danecek</surname>
          <given-names>Petr</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6447-4112</contrib-id>
        <name>
          <surname>Bonfield</surname>
          <given-names>James K</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1059-1230</contrib-id>
        <name>
          <surname>Liddle</surname>
          <given-names>Jennifer</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1216-5457</contrib-id>
        <name>
          <surname>Marshall</surname>
          <given-names>John</given-names>
        </name>
        <aff><institution>Wolfson Wohl Cancer Research Centre, Institute of Cancer Sciences, University of Glasgow</institution>, Switchback Road, Glasgow, G61 1QH, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0532-6021</contrib-id>
        <name>
          <surname>Ohan</surname>
          <given-names>Valeriu</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8738-0920</contrib-id>
        <name>
          <surname>Pollard</surname>
          <given-names>Martin O</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8117-400X</contrib-id>
        <name>
          <surname>Whitwham</surname>
          <given-names>Andrew</given-names>
        </name>
        <!--<email>samtools@sanger.ac.uk</email>-->
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7532-6898</contrib-id>
        <name>
          <surname>Keane</surname>
          <given-names>Thomas</given-names>
        </name>
        <aff><institution>EMBL-EBI, Wellcome Genome Campus, Hinxton, Cambridgeshire</institution>, CB10 1SD, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2715-4187</contrib-id>
        <name>
          <surname>McCarthy</surname>
          <given-names>Shane A</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9983-1378</contrib-id>
        <name>
          <surname>Davies</surname>
          <given-names>Robert M</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4874-2874</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <aff><institution>Department of Data Sciences, Dana-Farber Cancer Institute, 450 Brookline Avenue</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Informatics, Harvard Medical School, 10 Shattuck Street</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><bold>Correspondence address</bold>. Andrew Whitwham, Wellcome Sanger Institute, Wellcome Genome Campus, Hinxton, Cambridgeshire, CB10 1SA, UK. Tel: +44 (0)1223 834244; E-mail: <email>samtools@sanger.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="epub" iso-8601-date="2021-02-16">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>10</volume>
    <issue>2</issue>
    <elocation-id>giab008</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press GigaScience.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="giab008.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="abs1">
        <title>Background</title>
        <p>SAMtools and BCFtools are widely used programs for processing and analysing high-throughput sequencing data. They include tools for file format conversion and manipulation, sorting, querying, statistics, variant calling, and effect analysis amongst other methods.</p>
      </sec>
      <sec id="abs2">
        <title>Findings</title>
        <p>The first version appeared online 12 years ago and has been maintained and further developed ever since, with many new features and improvements added over the years. The SAMtools and BCFtools packages represent a unique collection of tools that have been used in numerous other software projects and countless genomic pipelines.</p>
      </sec>
      <sec id="abs3">
        <title>Conclusion</title>
        <p>Both SAMtools and BCFtools are freely available on GitHub under the permissive MIT licence, free for both non-commercial and commercial use. Both packages have been installed &gt;1 million times via Bioconda. The source code and documentation are available from <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>samtools</kwd>
      <kwd>bcftools</kwd>
      <kwd>high-throughput sequencing</kwd>
      <kwd>next generation sequencing</kwd>
      <kwd>variant calling</kwd>
      <kwd>data analysis</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>206194</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Background</title>
    <p>With the advancement of genome sequencing technologies and large-scale sequencing projects, new data formats became necessary for interoperability, compact storage, and efficient analysis of the data. Among the most common formats used in this field today are SAM [<xref rid="bib1" ref-type="bibr">1</xref>] and VCF [<xref rid="bib2" ref-type="bibr">2</xref>], developed by the 1000 Genomes Project [<xref rid="bib3" ref-type="bibr">3</xref>]. These specialized formats for storing read alignments (SAM) and genetic variants (VCF) are row-oriented tab-delimited text files, which are easy to process using custom scripts but slow to parse and can be inefficient to store. Therefore in practice, the binary counterparts BAM or CRAM are used for alignment data and, when parsing of large VCF files becomes prohibitively slow, BCF provides a more efficient format for processing variation data.</p>
    <p>Despite the conceptual simplicity of the underlying DNA sequence, the alignment and variant data carry rich information. These data undergo a number of processing steps, many of which are algorithmically complex and require specialized software. Also more programming effort and expertise are necessary to parse binary formats. Therefore programs and toolkits that encompass functionality for the most common tasks have been developed. These include tools for file manipulation, quality control, and data analyses, such as sambamba [<xref rid="bib4" ref-type="bibr">4</xref>], biobambam [<xref rid="bib5" ref-type="bibr">5</xref>], FastQC [<xref rid="bib6" ref-type="bibr">6</xref>], and GATK [<xref rid="bib7" ref-type="bibr">7</xref>]. A successful bioinformatics tool must keep up with advancements in sequencing technologies (e.g., substantial increase in sequencing read length), scale well with ever-increasing amounts of data (from single to hundreds of thousands of genomes), and expand focus to encompass new analyses and more complex types of variation. New species also bring challenges such as large chromosomes not representable by 32 bits (&gt;2 Gb) or assumptions about the ploidy of an organism. In this article we describe the status, new features, and developments in SAMtools and BCFtools.</p>
    <p>SAMtools was originally published in 2009 [<xref rid="bib1" ref-type="bibr">1</xref>]. Readers of the online edition of that article would have been able to download release 0.1.4. The package included not only utilities to convert and manipulate SAM and BAM files but also a variant caller, which was soon restructured into the BCFtools subpackage (2010, release 0.1.9). Later it became apparent that third-party projects were trying to use code from SAMtools despite it not being designed to be embedded in that way. Therefore the decision was taken in August 2014 (release 1.0) to split the SAMtools package into a stand-alone library with a well-defined API (HTSlib, currently 82k lines of code) [<xref rid="bib8" ref-type="bibr">8</xref>], a project for variant calling and manipulation of variant data (BCFtools, 71k lines), and SAMtools for working with alignment data (42k lines). All 3 projects are maintained in parallel, and improvements to HTSlib naturally filter into new releases of SAMtools and BCFtools. Since the original release the combined size of HTSlib, SAMtools, and BCFtools has doubled.</p>
  </sec>
  <sec id="sec2">
    <title>Findings</title>
    <sec id="sec2-1">
      <title>SAMtools</title>
      <p>Since the initial release there have been &gt;2,200 commits to the code repository and 52 releases, the most recent being version 1.11 in September 2020 [<xref rid="bib9" ref-type="bibr">9</xref>].</p>
      <p>The main part of the SAMtools package is a single executable that offers various commands for working on alignment data. The “view" command performs format conversion, file filtering, and extraction of sequence ranges. Files can be reordered, joined, and split in various ways using the commands sort, collate, merge, cat, and split. Files can be indexed for fast random access using “index" for alignment files and “faidx" for reference sequences in the FASTA format. File content can be manipulated with commands like addreplacerg, calmd, fixmate, and reheader. Duplicated reads, caused by artefacts in the library creation and sequencing process, can be flagged using markdup. Various statistics on alignment files can be calculated using idxstats, flagstat, stats, depth, and bedcov. Data can be converted to legacy formats using fasta and fastq. For position-ordered files, the sequence alignment can be viewed using tview or output via mpileup in a way that can be used for ongoing processing (e.g., variant calling). Most recently SAMtools has gained support for amplicon-based sequencing projects via ampliconclip and ampliconstats.</p>
      <p>For a complete list of SAMtools commands with a short summary, version, and date of the initial commit see <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S1</xref>. Full documentation for these commands is included with the package in the form of UNIX man pages and can also be found online [<xref rid="bib28_175_1612547700797" ref-type="bibr">10</xref>].</p>
      <p>Early releases of SAMtools could read and write alignment data in the SAM and BAM formats. The 1.0 release introduced support for the better-compressed CRAM format [<xref rid="bib10" ref-type="bibr">11</xref>]. Originally, the program required the use of command line options to select the input format, and most commands were tied to using BAM files. These restrictions were removed as SAMtools transitioned to use HTSlib, so by release 1.0 most commands could automatically detect the input file format and could directly read and write SAM, BAM, and CRAM files. In particular, there is rarely any need to convert SAM to BAM using “samtools view -b” before running commands like “samtools sort,” although regrettably this idiom still appears in a large number of online tutorials. We encourage readers to follow best practices and workflows published at [<xref rid="bib29_162_1612547803367" ref-type="bibr">12</xref>].</p>
      <p>SAMtools has also become faster, most notably by gaining the ability to use threads to take better advantage of the parallelism available on modern multicore systems. Thread support first arrived in version 0.1.19 (March 2013), which enabled them for sorting and BAM file writing in the view command. The number of tasks using threads has slowly increased, so now (thanks to improvements in HTSlib) it is possible to use them for both reading and writing SAM, BAM, and CRAM formats in most of the commands. Another time-saving improvement is the ability to index files as they are written (added in 1.10). This allows pipelines that need to index files to remove the separate “samtools index” stage and associated read-through of the file being indexed.</p>
    </sec>
    <sec id="sec2-2">
      <title>BCFtools</title>
      <p>The original purpose of the BCFtools package was to divide the I/O- and CPU-intensive tasks of variant calling into separate steps.</p>
      <p>The first step, initially “samtools mpileup” but subsequently moved to “bcftools mpileup,” reads the alignments and for each position of the genome constructs a vertical slice across all reads covering the position (“pileup”). Genotype likelihoods are then calculated, representing how consistent are the observed data with the possible diploid genotypes. The calculation takes into account mapping qualities of the reads, base qualities, and the probability of local misalignment, per-base alignment quality (BAQ) [<xref rid="bib11" ref-type="bibr">13</xref>]. The second step, “bcftools call” (known in the initial release as “bcftools view”), then evaluates the most likely genotype under the assumption of Hardy-Weinberg equilibrium (in the sample context customizable by the user) using allele frequencies estimated from the data or provided explicitly by the user. In 2016 (release 1.4) genotype likelihood generation was moved from SAMtools to BCFtools to make both variant-calling steps part of the same package and to prevent errors arising from the possible use of incompatible versions of the 2 programs.</p>
      <p>Today BCFtools is a full-featured program that consists of 21 commands and 38 plugins (single-purpose tools) with &gt;230 documented command line switches and options. As of writing, there have been &gt;2,300 commits and 29 releases since 2012, with the most recent, 1.11, released in September 2020 [<xref rid="bib12" ref-type="bibr">14</xref>].</p>
      <p>The “bcftools view” command provides conversion between the text VCF and the binary BCF format, where both formats can be either plain (uncompressed) or block-compressed with BGZF for random access and compact size. The plain text VCF output is useful for visual inspection, for processing with custom scripts, and as a data exchange format. It should not be used when performance is critical because BCFtools internally uses the binary BCF representation and the conversion between the text VCF format and the binary BCF format is costly. Also compression and decompression is CPU intensive, and therefore when streaming between multiple commands in a pipeline it is recommended to stream uncompressed BCF by appending the option “-Ou.”</p>
      <p>The program can do much more than convert between VCF and BCF formats. It can also process third-party formats (using the “convert" command) and manipulate variant files in many ways. It can be used to index, sort, and normalize variants (“norm"), replace headers (“reheader"), add and remove annotations (“annotate"), and subset samples (“view"). Most commands can filter sites either by a region, list of sites, or a general Boolean expression involving any combination of VCF tags (--include, --exclude). Multiple files can be compared, splitting common and file-specific variants into separate files according to custom rules (isec). Files sorted by position can also be combined using the merge command (input files have different samples) or concat command (input files have the same samples). Arbitrary fields can be extracted and formatted into a custom text output (query), a feature that, among other things, is useful for scripting.</p>
      <p>Apart from file manipulation, the program offers variant callers and algorithms useful for analysis. For calling single-nucleotide polymorphisms and short indels from read alignment files, BCFtools implements 2 variant-calling models. In addition to the original biallelic caller (“bcftools call -c” [<xref rid="bib13" ref-type="bibr">15</xref>]) there is a newer model available, capable of handling positions with multiple alternate alleles (“bcftools call -m”) and supporting gVCF output [<xref rid="bib14" ref-type="bibr">16</xref>]. (For a recent comparison of the variant-calling component of the software see [<xref rid="bib15" ref-type="bibr">17–20</xref>].) The package implements a hidden Markov model caller for detection of runs of homozygosity (roh [<xref rid="bib19" ref-type="bibr">21</xref>]), copy-number variation calling from single-nucleotide polymorphism array data (cnv [<xref rid="bib20" ref-type="bibr">22</xref>]), and the detection of whole-chromosome aberrations (polysomy). The program can construct a consensus sequence given a FASTA and a variant file (consensus), perform sample identity checks (gtcheck), and collect various statistics (stats).</p>
      <p>In addition to built-in commands, the program supports a dynamic plugin mechanism for specific single-purpose tasks with a diverse range of functions. Examples from a large and ever-growing collection include the plugin split-vep for convenient querying and extraction of VEP annotations [<xref rid="bib21" ref-type="bibr">23</xref>]; trio-dnm for ascertainment of <italic>de novo</italic> variants and their parental origin (parental-origin), or for collection of statistics (trio-stats) in trio data; gVCF manipulation (gvcfz); and many more.</p>
      <p>For a complete list of BCFtools commands and plugins with a short summary, version, and date of the initial commit see <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S2</xref>. Full documentation for these commands is included with the package in the form of UNIX man pages and can also be found online together with short tutorials, math notes, and other documentation at [<xref rid="bib30_604_1612548058839" ref-type="bibr">24</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec3">
    <title>Discussion</title>
    <p>SAMtools and BCFtools represent a unique collection of tools useful for processing and analysis of sequencing data. Their development has been driven by the need of both large projects and individual user requests issued via GitHub. The code has been installed &gt;1 million times via Bioconda [<xref rid="bib22" ref-type="bibr">25</xref>] and GitHub releases [<xref rid="bib9" ref-type="bibr">9</xref>, <xref rid="bib12" ref-type="bibr">14</xref>], and &gt;1600 support and feature requests have been resolved on GitHub.</p>
    <p>The programs are written in the C programming language and optimized for low memory consumption and high speed. For example, the “bcftools csq” command for prediction of functional consequences in a haplotype-aware manner requires only a fraction of the memory required by VEP and is 2 orders of magnitude faster [<xref rid="bib23" ref-type="bibr">26</xref>].</p>
    <p>Much work has been done to increase the reliability of SAMtools and BCFtools. The test harnesses now include ∼700 tests in SAMtools and ∼1,400 in BCFtools. Continuous integration services run all of the tests on a variety of platforms (including Linux, MacOS, and Windows) whenever code is checked into the source repository, ensuring that bugs are discovered and fixed rapidly. Code quality is also assured by checking for memory errors, originally using Valgrind memcheck [<xref rid="bib24" ref-type="bibr">27</xref>] and more recently with AddressSanitizer [<xref rid="bib25" ref-type="bibr">28</xref>]. Additionally, UndefinedBehaviorSanitizer is used to detect violations of the C standard.</p>
    <p>Despite the ever-growing sample sizes and rapid increases in the amount of sequenced data, the programs have withstood the test of time. However, extremely big files are produced by large projects and their processing requires a high degree of parallelization on computing clusters. Future versions of SAMtools and BCFtools are expected to make more use of threaded code to allow faster processing of such files. Sometimes even the limits of BCF representation itself can be reached. For example, highly polymorphic sites can contain dozens of alternate indel alleles, which, in files with tens of thousands of samples, exceed the internal limit of 4 GB per site due to quadratic scaling of annotations such as FORMAT/PL. An extension of the VCF specification has been proposed to address this problem by introducing a localized version of such annotations with linear scaling [<xref rid="bib26" ref-type="bibr">29</xref>] and has been implemented in BCFtools.</p>
    <p>The programs have been used to process and analyze sequencing data from all types of species: vertebrates, invertebrates, pathogens, plants, and viruses. This provides interesting challenges and opportunities for future development. For example, some of the BCFtools commands are limited to handling haploid and diploid organisms and the support for large “64-bit” genomes is currently only partial. More work is also planned to overcome difficulties stemming from ambiguities in VCF allele encoding (such as operations of atomization and deatomization) and to improve visualization of results, and there are &gt;50 feature requests currently registered on GitHub to investigate.</p>
  </sec>
  <sec id="sec4">
    <title>Availability of Supporting Source Code and Requirements</title>
    <p>Project name: SAMtools</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/samtools">https://github.com/samtools/samtools</ext-link></p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: C</p>
    <p>License: MIT/Expat</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_002105">RRID:SCR_002105</ext-link>
    </p>
    <p>biotools: samtools</p>
    <p>Project name: BCFtools</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/bcftools">https://github.com/samtools/bcftools</ext-link></p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: C</p>
    <p>Other requirements: Optional use of GNU Scientific Library (GSL)</p>
    <p>License: MIT/Expat</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_002105">RRID:SCR_002105</ext-link>
    </p>
    <p>biotools: bcftools</p>
  </sec>
  <sec sec-type="data-availability" id="sec5">
    <title>Data Availability</title>
    <p>Snapshots of the code and tabular files are available from the <italic>GigaScience</italic> GigaDB repository [<xref rid="bib27" ref-type="bibr">30</xref>].</p>
  </sec>
  <sec id="sec6">
    <title>Editors Note</title>
    <p>An accompanying article describing the HTSlib software library for providing programmatic access is published alongside this article [<xref rid="bib8" ref-type="bibr">8</xref>].</p>
  </sec>
  <sec id="sec7">
    <title>Additional Files</title>
    <p>Supplementary Table S1: Table of SAMtools commands</p>
    <p>Supplementary Table S2: Table of BCFtools commands</p>
  </sec>
  <sec id="h1content1612547370513">
    <title>Abbreviations</title>
    <p>API: Application Programming Interface; CPU: central processing unit; GATK: Genome Analysis Toolkit; Gb: gigabase pairs.</p>
  </sec>
  <sec id="sec8">
    <title>Competing Interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec id="sec9">
    <title>Funding</title>
    <p>This work was supported by a Wellcome Trust grant (206194).</p>
  </sec>
  <sec id="sec10">
    <title>Authors' Contributions</title>
    <p>J.K.B., P.D., R.M.D., H.L., J.M., M.O.P., V.O., and A.W. wrote the SAMtools software with J.L. and S.A.M. supporting; R.M.D., T.K., and J.M. provided supervision.</p>
    <p>P.D. and S.A.M. wrote the BCFtools software with J.K.B., R.M.D., H.L., J.M., and V.O. supporting; S.A.M. also provided supervision.</p>
    <p>J.K.B., P.D., R.M.D., V.O., and A.W. wrote the original draft of the manuscript with all authors reviewing.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>giab008_GIGA-D-20-00369_Original_Submission</label>
      <media xlink:href="giab008_giga-d-20-00369_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>giab008_GIGA-D-20-00369_Revision_1</label>
      <media xlink:href="giab008_giga-d-20-00369_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>giab008_Response_to_Reviewer_Comments_Original_Submission</label>
      <media xlink:href="giab008_response_to_reviewer_comments_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>giab008_Reviewer_1_Report_Original_Submission</label>
      <caption>
        <p>Fan Zhang -- 1/3/2021 Reviewed</p>
      </caption>
      <media xlink:href="giab008_reviewer_1_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>giab008_Reviewer_2_Report_Original_Submission</label>
      <caption>
        <p>Chris Chang -- 1/6/2021 Reviewed</p>
      </caption>
      <media xlink:href="giab008_reviewer_2_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>giab008_Supplemental_Files</label>
      <media xlink:href="giab008_supplemental_files.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Handsaker</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Wysoker</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>2078</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Auton</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Abecasis</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2156</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>The 1000 Genomes Project Consortium</collab>.</person-group>  <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>. <year>2015</year>;<volume>526</volume>:<fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarasov</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Vilella</surname>  <given-names>AJ</given-names></string-name>, <string-name><surname>Cuppen</surname>  <given-names>E</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Sambamba: fast processing of NGS alignment formats</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>:<fpage>2032</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">25697820</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tischler</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Leonard</surname>  <given-names>S</given-names></string-name></person-group><article-title>biobambam: tools for read pair collation based algorithms on BAM files</article-title>. <source>Source Code Biol Med</source>. <year>2014</year>;<volume>9</volume>:<fpage>2078</fpage>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Babraham Bioinformatics</collab>.</person-group>  <year>2019</year>
<source>FastQC: A quality control tool for high throughput sequence data</source>. <comment>Version 0.11.9. <ext-link ext-link-type="uri" xlink:href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">https://www.bioinformatics.babraham.ac.uk/projects/fastqc/</ext-link>. Accessed 29 June 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DePristo</surname>  <given-names>MA</given-names></string-name>, <string-name><surname>Banks</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Poplin</surname>  <given-names>R</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nat Genet</source>. <year>2011</year>;<volume>43</volume>:<fpage>491</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21478889</pub-id></mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Marshall</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>HTSlib - C library for reading/writing high-throughput sequencing data</article-title>. <source>Gigascience</source>. <year>2021</year>;<bold>10</bold>(2): doi:10.1093/gigascience/giab007</mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2020</year>
<comment>SAMtools, Version 1.11. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/samtools/releases/tag/1.11">https://github.com/samtools/samtools/releases/tag/1.11</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib28_175_1612547700797">
      <label>10.</label>
      <mixed-citation publication-type="journal"><comment>SAMtools - Documentation</comment>, <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org/doc/">https://www.htslib.org/doc/</ext-link>  <comment>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib10">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hsi-Yang Fritz</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Leinonen</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Cochrane</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Efficient storage of high throughput DNA sequencing data using reference-based compression</article-title>. <source>Genome Res</source>. <year>2011</year>;<volume>21</volume>:<fpage>734</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">21245279</pub-id></mixed-citation>
    </ref>
    <ref id="bib29_162_1612547803367">
      <label>12.</label>
      <mixed-citation publication-type="journal"><comment>SAMtools - Workflow</comment>, <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org/workflow/">https://www.htslib.org/workflow/</ext-link>  <comment>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib11">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>Improving SNP discovery by base alignment quality</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>1157</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21320865</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2020</year>
<comment>BCFtools, Version 1.11. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/bcftools/releases/tag/1.11">https://github.com/samtools/bcftools/releases/tag/1.11</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib13">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2987</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <label>16.</label>
      <mixed-citation publication-type="journal">
        <comment>gvcftools</comment>
        <year>2020</year>
        <comment>Version 0.17.0. <ext-link ext-link-type="uri" xlink:href="https://sites.google.com/site/gvcftools">https://sites.google.com/site/gvcftools</ext-link>. Accessed 6 November 2020.</comment>
      </mixed-citation>
    </ref>
    <ref id="bib15">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schilbert</surname>  <given-names>HM</given-names></string-name>, <string-name><surname>Rempel</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Pucker</surname>  <given-names>B</given-names></string-name></person-group><article-title>Comparison of read mapping and variant calling tools for the analysis of plant NGS data</article-title>. <source>Plants (Basel)</source>. <year>2020</year>;<volume>9</volume>(<issue>4</issue>):<fpage>439</fpage>.</mixed-citation>
    </ref>
    <ref id="bib16">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pightling</surname>  <given-names>AW</given-names></string-name>, <string-name><surname>Petronella</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Pagotto</surname>  <given-names>F</given-names></string-name></person-group><article-title>Choice of reference-guided sequence assembler and SNP caller for analysis of <italic>Listeria monocytogenes</italic> short-read sequence data greatly influences rates of error</article-title>. <source>BMC Res Notes</source>. <year>2015</year>;<volume>8</volume>:<fpage>748</fpage>.<pub-id pub-id-type="pmid">26643440</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R</given-names></string-name></person-group><article-title>Crumble: reference free lossy compression of sequence quality values</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>:<fpage>337</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29992288</pub-id></mixed-citation>
    </ref>
    <ref id="bib18">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>L</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Systematic comparative analysis of single-nucleotide variant detection methods from single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>. <year>2019</year>;<volume>20</volume>:<fpage>242</fpage>.<pub-id pub-id-type="pmid">31744515</pub-id></mixed-citation>
    </ref>
    <ref id="bib19">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Narasimhan</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Scally</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>BCFtools/RoH: a hidden Markov model approach for detecting autozygosity from next-generation sequencing data</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>:<fpage>1749</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">26826718</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>HipSci</surname>  <given-names>Consortium</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R</given-names></string-name></person-group><article-title>A method for checking genomic integrity in cultured cell lines from SNP genotyping data</article-title>. <source>PLoS One</source>. <year>2016</year>;<volume>11</volume>(<issue>5</issue>):<fpage>e0155014</fpage>.<pub-id pub-id-type="pmid">27176002</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McLaren</surname>  <given-names>W</given-names></string-name>, <string-name><surname>Gil</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Hunt</surname>  <given-names>SE</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The Ensembl Variant Effect Predictor</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>122</fpage>.<pub-id pub-id-type="pmid">27268795</pub-id></mixed-citation>
    </ref>
    <ref id="bib30_604_1612548058839">
      <label>24.</label>
      <mixed-citation publication-type="journal"><comment>BCFtools <ext-link ext-link-type="uri" xlink:href="https://samtools.github.io/bcftools/">https://samtools.github.io/bcftools/</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib22">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grüning</surname>  <given-names>B</given-names></string-name>, <string-name><surname>The Bioconda</surname>  <given-names>Team</given-names></string-name>, <string-name><surname>Dale</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Sjödin</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Bioconda: sustainable and comprehensive software distribution for the life sciences</article-title>. <source>Nat Methods</source>. <year>2018</year>:<fpage>475</fpage>–<lpage>6</lpage>..<pub-id pub-id-type="pmid">29967506</pub-id></mixed-citation>
    </ref>
    <ref id="bib23">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name></person-group><article-title>BCFtools/csq: haplotype-aware variant consequences</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>:<fpage>2037</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">28205675</pub-id></mixed-citation>
    </ref>
    <ref id="bib24">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nethercote</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Seward</surname>  <given-names>J</given-names></string-name></person-group><article-title>Valgrind: a framework for heavyweight dynamic binary instrumentation</article-title>. <source>SIGPLAN Not</source>. <year>2007</year>;<volume>42</volume>:<fpage>89</fpage>–<lpage>100</lpage>.</mixed-citation>
    </ref>
    <ref id="bib25">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Serebryany</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Bruening</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Potapenko</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>AddressSanitizer: a fast address sanity checker</article-title>. <comment>Proceedings of the 2012 USENIX Annual Technical Conference</comment>
<year>2012</year>
<comment><ext-link ext-link-type="uri" xlink:href="https://www.usenix.org/system/files/conference/atc12/atc12-final39.pdf">https://www.usenix.org/system/files/conference/atc12/atc12-final39.pdf</ext-link>. Accessed 6 November 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib26">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2019</year>
<comment>Define Local Alleles in VCF to allow for sparser format by yfarjoun. Pull Request #434. samtools/hts-specs. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/hts-specs/pull/434">https://github.com/samtools/hts-specs/pull/434</ext-link>. Accessed 10 July 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib27">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Liddle</surname>  <given-names>J</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Supporting data for “Twelve years of SAMtools and BCFtools.”</article-title>. <source>GigaScience Database</source>. <year>2021</year>
<pub-id pub-id-type="doi">10.5524/100866</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7931819</article-id>
    <article-id pub-id-type="pmid">33590861</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/giab008</article-id>
    <article-id pub-id-type="publisher-id">giab008</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00960</subject>
        <subject>AcademicSubjects/SCI02254</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Twelve years of SAMtools and BCFtools</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4159-1666</contrib-id>
        <name>
          <surname>Danecek</surname>
          <given-names>Petr</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6447-4112</contrib-id>
        <name>
          <surname>Bonfield</surname>
          <given-names>James K</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1059-1230</contrib-id>
        <name>
          <surname>Liddle</surname>
          <given-names>Jennifer</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1216-5457</contrib-id>
        <name>
          <surname>Marshall</surname>
          <given-names>John</given-names>
        </name>
        <aff><institution>Wolfson Wohl Cancer Research Centre, Institute of Cancer Sciences, University of Glasgow</institution>, Switchback Road, Glasgow, G61 1QH, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0532-6021</contrib-id>
        <name>
          <surname>Ohan</surname>
          <given-names>Valeriu</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8738-0920</contrib-id>
        <name>
          <surname>Pollard</surname>
          <given-names>Martin O</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8117-400X</contrib-id>
        <name>
          <surname>Whitwham</surname>
          <given-names>Andrew</given-names>
        </name>
        <!--<email>samtools@sanger.ac.uk</email>-->
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7532-6898</contrib-id>
        <name>
          <surname>Keane</surname>
          <given-names>Thomas</given-names>
        </name>
        <aff><institution>EMBL-EBI, Wellcome Genome Campus, Hinxton, Cambridgeshire</institution>, CB10 1SD, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2715-4187</contrib-id>
        <name>
          <surname>McCarthy</surname>
          <given-names>Shane A</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9983-1378</contrib-id>
        <name>
          <surname>Davies</surname>
          <given-names>Robert M</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4874-2874</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <aff><institution>Department of Data Sciences, Dana-Farber Cancer Institute, 450 Brookline Avenue</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Informatics, Harvard Medical School, 10 Shattuck Street</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><bold>Correspondence address</bold>. Andrew Whitwham, Wellcome Sanger Institute, Wellcome Genome Campus, Hinxton, Cambridgeshire, CB10 1SA, UK. Tel: +44 (0)1223 834244; E-mail: <email>samtools@sanger.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="epub" iso-8601-date="2021-02-16">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>10</volume>
    <issue>2</issue>
    <elocation-id>giab008</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press GigaScience.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="giab008.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="abs1">
        <title>Background</title>
        <p>SAMtools and BCFtools are widely used programs for processing and analysing high-throughput sequencing data. They include tools for file format conversion and manipulation, sorting, querying, statistics, variant calling, and effect analysis amongst other methods.</p>
      </sec>
      <sec id="abs2">
        <title>Findings</title>
        <p>The first version appeared online 12 years ago and has been maintained and further developed ever since, with many new features and improvements added over the years. The SAMtools and BCFtools packages represent a unique collection of tools that have been used in numerous other software projects and countless genomic pipelines.</p>
      </sec>
      <sec id="abs3">
        <title>Conclusion</title>
        <p>Both SAMtools and BCFtools are freely available on GitHub under the permissive MIT licence, free for both non-commercial and commercial use. Both packages have been installed &gt;1 million times via Bioconda. The source code and documentation are available from <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>samtools</kwd>
      <kwd>bcftools</kwd>
      <kwd>high-throughput sequencing</kwd>
      <kwd>next generation sequencing</kwd>
      <kwd>variant calling</kwd>
      <kwd>data analysis</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>206194</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Background</title>
    <p>With the advancement of genome sequencing technologies and large-scale sequencing projects, new data formats became necessary for interoperability, compact storage, and efficient analysis of the data. Among the most common formats used in this field today are SAM [<xref rid="bib1" ref-type="bibr">1</xref>] and VCF [<xref rid="bib2" ref-type="bibr">2</xref>], developed by the 1000 Genomes Project [<xref rid="bib3" ref-type="bibr">3</xref>]. These specialized formats for storing read alignments (SAM) and genetic variants (VCF) are row-oriented tab-delimited text files, which are easy to process using custom scripts but slow to parse and can be inefficient to store. Therefore in practice, the binary counterparts BAM or CRAM are used for alignment data and, when parsing of large VCF files becomes prohibitively slow, BCF provides a more efficient format for processing variation data.</p>
    <p>Despite the conceptual simplicity of the underlying DNA sequence, the alignment and variant data carry rich information. These data undergo a number of processing steps, many of which are algorithmically complex and require specialized software. Also more programming effort and expertise are necessary to parse binary formats. Therefore programs and toolkits that encompass functionality for the most common tasks have been developed. These include tools for file manipulation, quality control, and data analyses, such as sambamba [<xref rid="bib4" ref-type="bibr">4</xref>], biobambam [<xref rid="bib5" ref-type="bibr">5</xref>], FastQC [<xref rid="bib6" ref-type="bibr">6</xref>], and GATK [<xref rid="bib7" ref-type="bibr">7</xref>]. A successful bioinformatics tool must keep up with advancements in sequencing technologies (e.g., substantial increase in sequencing read length), scale well with ever-increasing amounts of data (from single to hundreds of thousands of genomes), and expand focus to encompass new analyses and more complex types of variation. New species also bring challenges such as large chromosomes not representable by 32 bits (&gt;2 Gb) or assumptions about the ploidy of an organism. In this article we describe the status, new features, and developments in SAMtools and BCFtools.</p>
    <p>SAMtools was originally published in 2009 [<xref rid="bib1" ref-type="bibr">1</xref>]. Readers of the online edition of that article would have been able to download release 0.1.4. The package included not only utilities to convert and manipulate SAM and BAM files but also a variant caller, which was soon restructured into the BCFtools subpackage (2010, release 0.1.9). Later it became apparent that third-party projects were trying to use code from SAMtools despite it not being designed to be embedded in that way. Therefore the decision was taken in August 2014 (release 1.0) to split the SAMtools package into a stand-alone library with a well-defined API (HTSlib, currently 82k lines of code) [<xref rid="bib8" ref-type="bibr">8</xref>], a project for variant calling and manipulation of variant data (BCFtools, 71k lines), and SAMtools for working with alignment data (42k lines). All 3 projects are maintained in parallel, and improvements to HTSlib naturally filter into new releases of SAMtools and BCFtools. Since the original release the combined size of HTSlib, SAMtools, and BCFtools has doubled.</p>
  </sec>
  <sec id="sec2">
    <title>Findings</title>
    <sec id="sec2-1">
      <title>SAMtools</title>
      <p>Since the initial release there have been &gt;2,200 commits to the code repository and 52 releases, the most recent being version 1.11 in September 2020 [<xref rid="bib9" ref-type="bibr">9</xref>].</p>
      <p>The main part of the SAMtools package is a single executable that offers various commands for working on alignment data. The “view" command performs format conversion, file filtering, and extraction of sequence ranges. Files can be reordered, joined, and split in various ways using the commands sort, collate, merge, cat, and split. Files can be indexed for fast random access using “index" for alignment files and “faidx" for reference sequences in the FASTA format. File content can be manipulated with commands like addreplacerg, calmd, fixmate, and reheader. Duplicated reads, caused by artefacts in the library creation and sequencing process, can be flagged using markdup. Various statistics on alignment files can be calculated using idxstats, flagstat, stats, depth, and bedcov. Data can be converted to legacy formats using fasta and fastq. For position-ordered files, the sequence alignment can be viewed using tview or output via mpileup in a way that can be used for ongoing processing (e.g., variant calling). Most recently SAMtools has gained support for amplicon-based sequencing projects via ampliconclip and ampliconstats.</p>
      <p>For a complete list of SAMtools commands with a short summary, version, and date of the initial commit see <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S1</xref>. Full documentation for these commands is included with the package in the form of UNIX man pages and can also be found online [<xref rid="bib28_175_1612547700797" ref-type="bibr">10</xref>].</p>
      <p>Early releases of SAMtools could read and write alignment data in the SAM and BAM formats. The 1.0 release introduced support for the better-compressed CRAM format [<xref rid="bib10" ref-type="bibr">11</xref>]. Originally, the program required the use of command line options to select the input format, and most commands were tied to using BAM files. These restrictions were removed as SAMtools transitioned to use HTSlib, so by release 1.0 most commands could automatically detect the input file format and could directly read and write SAM, BAM, and CRAM files. In particular, there is rarely any need to convert SAM to BAM using “samtools view -b” before running commands like “samtools sort,” although regrettably this idiom still appears in a large number of online tutorials. We encourage readers to follow best practices and workflows published at [<xref rid="bib29_162_1612547803367" ref-type="bibr">12</xref>].</p>
      <p>SAMtools has also become faster, most notably by gaining the ability to use threads to take better advantage of the parallelism available on modern multicore systems. Thread support first arrived in version 0.1.19 (March 2013), which enabled them for sorting and BAM file writing in the view command. The number of tasks using threads has slowly increased, so now (thanks to improvements in HTSlib) it is possible to use them for both reading and writing SAM, BAM, and CRAM formats in most of the commands. Another time-saving improvement is the ability to index files as they are written (added in 1.10). This allows pipelines that need to index files to remove the separate “samtools index” stage and associated read-through of the file being indexed.</p>
    </sec>
    <sec id="sec2-2">
      <title>BCFtools</title>
      <p>The original purpose of the BCFtools package was to divide the I/O- and CPU-intensive tasks of variant calling into separate steps.</p>
      <p>The first step, initially “samtools mpileup” but subsequently moved to “bcftools mpileup,” reads the alignments and for each position of the genome constructs a vertical slice across all reads covering the position (“pileup”). Genotype likelihoods are then calculated, representing how consistent are the observed data with the possible diploid genotypes. The calculation takes into account mapping qualities of the reads, base qualities, and the probability of local misalignment, per-base alignment quality (BAQ) [<xref rid="bib11" ref-type="bibr">13</xref>]. The second step, “bcftools call” (known in the initial release as “bcftools view”), then evaluates the most likely genotype under the assumption of Hardy-Weinberg equilibrium (in the sample context customizable by the user) using allele frequencies estimated from the data or provided explicitly by the user. In 2016 (release 1.4) genotype likelihood generation was moved from SAMtools to BCFtools to make both variant-calling steps part of the same package and to prevent errors arising from the possible use of incompatible versions of the 2 programs.</p>
      <p>Today BCFtools is a full-featured program that consists of 21 commands and 38 plugins (single-purpose tools) with &gt;230 documented command line switches and options. As of writing, there have been &gt;2,300 commits and 29 releases since 2012, with the most recent, 1.11, released in September 2020 [<xref rid="bib12" ref-type="bibr">14</xref>].</p>
      <p>The “bcftools view” command provides conversion between the text VCF and the binary BCF format, where both formats can be either plain (uncompressed) or block-compressed with BGZF for random access and compact size. The plain text VCF output is useful for visual inspection, for processing with custom scripts, and as a data exchange format. It should not be used when performance is critical because BCFtools internally uses the binary BCF representation and the conversion between the text VCF format and the binary BCF format is costly. Also compression and decompression is CPU intensive, and therefore when streaming between multiple commands in a pipeline it is recommended to stream uncompressed BCF by appending the option “-Ou.”</p>
      <p>The program can do much more than convert between VCF and BCF formats. It can also process third-party formats (using the “convert" command) and manipulate variant files in many ways. It can be used to index, sort, and normalize variants (“norm"), replace headers (“reheader"), add and remove annotations (“annotate"), and subset samples (“view"). Most commands can filter sites either by a region, list of sites, or a general Boolean expression involving any combination of VCF tags (--include, --exclude). Multiple files can be compared, splitting common and file-specific variants into separate files according to custom rules (isec). Files sorted by position can also be combined using the merge command (input files have different samples) or concat command (input files have the same samples). Arbitrary fields can be extracted and formatted into a custom text output (query), a feature that, among other things, is useful for scripting.</p>
      <p>Apart from file manipulation, the program offers variant callers and algorithms useful for analysis. For calling single-nucleotide polymorphisms and short indels from read alignment files, BCFtools implements 2 variant-calling models. In addition to the original biallelic caller (“bcftools call -c” [<xref rid="bib13" ref-type="bibr">15</xref>]) there is a newer model available, capable of handling positions with multiple alternate alleles (“bcftools call -m”) and supporting gVCF output [<xref rid="bib14" ref-type="bibr">16</xref>]. (For a recent comparison of the variant-calling component of the software see [<xref rid="bib15" ref-type="bibr">17–20</xref>].) The package implements a hidden Markov model caller for detection of runs of homozygosity (roh [<xref rid="bib19" ref-type="bibr">21</xref>]), copy-number variation calling from single-nucleotide polymorphism array data (cnv [<xref rid="bib20" ref-type="bibr">22</xref>]), and the detection of whole-chromosome aberrations (polysomy). The program can construct a consensus sequence given a FASTA and a variant file (consensus), perform sample identity checks (gtcheck), and collect various statistics (stats).</p>
      <p>In addition to built-in commands, the program supports a dynamic plugin mechanism for specific single-purpose tasks with a diverse range of functions. Examples from a large and ever-growing collection include the plugin split-vep for convenient querying and extraction of VEP annotations [<xref rid="bib21" ref-type="bibr">23</xref>]; trio-dnm for ascertainment of <italic>de novo</italic> variants and their parental origin (parental-origin), or for collection of statistics (trio-stats) in trio data; gVCF manipulation (gvcfz); and many more.</p>
      <p>For a complete list of BCFtools commands and plugins with a short summary, version, and date of the initial commit see <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S2</xref>. Full documentation for these commands is included with the package in the form of UNIX man pages and can also be found online together with short tutorials, math notes, and other documentation at [<xref rid="bib30_604_1612548058839" ref-type="bibr">24</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec3">
    <title>Discussion</title>
    <p>SAMtools and BCFtools represent a unique collection of tools useful for processing and analysis of sequencing data. Their development has been driven by the need of both large projects and individual user requests issued via GitHub. The code has been installed &gt;1 million times via Bioconda [<xref rid="bib22" ref-type="bibr">25</xref>] and GitHub releases [<xref rid="bib9" ref-type="bibr">9</xref>, <xref rid="bib12" ref-type="bibr">14</xref>], and &gt;1600 support and feature requests have been resolved on GitHub.</p>
    <p>The programs are written in the C programming language and optimized for low memory consumption and high speed. For example, the “bcftools csq” command for prediction of functional consequences in a haplotype-aware manner requires only a fraction of the memory required by VEP and is 2 orders of magnitude faster [<xref rid="bib23" ref-type="bibr">26</xref>].</p>
    <p>Much work has been done to increase the reliability of SAMtools and BCFtools. The test harnesses now include ∼700 tests in SAMtools and ∼1,400 in BCFtools. Continuous integration services run all of the tests on a variety of platforms (including Linux, MacOS, and Windows) whenever code is checked into the source repository, ensuring that bugs are discovered and fixed rapidly. Code quality is also assured by checking for memory errors, originally using Valgrind memcheck [<xref rid="bib24" ref-type="bibr">27</xref>] and more recently with AddressSanitizer [<xref rid="bib25" ref-type="bibr">28</xref>]. Additionally, UndefinedBehaviorSanitizer is used to detect violations of the C standard.</p>
    <p>Despite the ever-growing sample sizes and rapid increases in the amount of sequenced data, the programs have withstood the test of time. However, extremely big files are produced by large projects and their processing requires a high degree of parallelization on computing clusters. Future versions of SAMtools and BCFtools are expected to make more use of threaded code to allow faster processing of such files. Sometimes even the limits of BCF representation itself can be reached. For example, highly polymorphic sites can contain dozens of alternate indel alleles, which, in files with tens of thousands of samples, exceed the internal limit of 4 GB per site due to quadratic scaling of annotations such as FORMAT/PL. An extension of the VCF specification has been proposed to address this problem by introducing a localized version of such annotations with linear scaling [<xref rid="bib26" ref-type="bibr">29</xref>] and has been implemented in BCFtools.</p>
    <p>The programs have been used to process and analyze sequencing data from all types of species: vertebrates, invertebrates, pathogens, plants, and viruses. This provides interesting challenges and opportunities for future development. For example, some of the BCFtools commands are limited to handling haploid and diploid organisms and the support for large “64-bit” genomes is currently only partial. More work is also planned to overcome difficulties stemming from ambiguities in VCF allele encoding (such as operations of atomization and deatomization) and to improve visualization of results, and there are &gt;50 feature requests currently registered on GitHub to investigate.</p>
  </sec>
  <sec id="sec4">
    <title>Availability of Supporting Source Code and Requirements</title>
    <p>Project name: SAMtools</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/samtools">https://github.com/samtools/samtools</ext-link></p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: C</p>
    <p>License: MIT/Expat</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_002105">RRID:SCR_002105</ext-link>
    </p>
    <p>biotools: samtools</p>
    <p>Project name: BCFtools</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/bcftools">https://github.com/samtools/bcftools</ext-link></p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: C</p>
    <p>Other requirements: Optional use of GNU Scientific Library (GSL)</p>
    <p>License: MIT/Expat</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_002105">RRID:SCR_002105</ext-link>
    </p>
    <p>biotools: bcftools</p>
  </sec>
  <sec sec-type="data-availability" id="sec5">
    <title>Data Availability</title>
    <p>Snapshots of the code and tabular files are available from the <italic>GigaScience</italic> GigaDB repository [<xref rid="bib27" ref-type="bibr">30</xref>].</p>
  </sec>
  <sec id="sec6">
    <title>Editors Note</title>
    <p>An accompanying article describing the HTSlib software library for providing programmatic access is published alongside this article [<xref rid="bib8" ref-type="bibr">8</xref>].</p>
  </sec>
  <sec id="sec7">
    <title>Additional Files</title>
    <p>Supplementary Table S1: Table of SAMtools commands</p>
    <p>Supplementary Table S2: Table of BCFtools commands</p>
  </sec>
  <sec id="h1content1612547370513">
    <title>Abbreviations</title>
    <p>API: Application Programming Interface; CPU: central processing unit; GATK: Genome Analysis Toolkit; Gb: gigabase pairs.</p>
  </sec>
  <sec id="sec8">
    <title>Competing Interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec id="sec9">
    <title>Funding</title>
    <p>This work was supported by a Wellcome Trust grant (206194).</p>
  </sec>
  <sec id="sec10">
    <title>Authors' Contributions</title>
    <p>J.K.B., P.D., R.M.D., H.L., J.M., M.O.P., V.O., and A.W. wrote the SAMtools software with J.L. and S.A.M. supporting; R.M.D., T.K., and J.M. provided supervision.</p>
    <p>P.D. and S.A.M. wrote the BCFtools software with J.K.B., R.M.D., H.L., J.M., and V.O. supporting; S.A.M. also provided supervision.</p>
    <p>J.K.B., P.D., R.M.D., V.O., and A.W. wrote the original draft of the manuscript with all authors reviewing.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>giab008_GIGA-D-20-00369_Original_Submission</label>
      <media xlink:href="giab008_giga-d-20-00369_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>giab008_GIGA-D-20-00369_Revision_1</label>
      <media xlink:href="giab008_giga-d-20-00369_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>giab008_Response_to_Reviewer_Comments_Original_Submission</label>
      <media xlink:href="giab008_response_to_reviewer_comments_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>giab008_Reviewer_1_Report_Original_Submission</label>
      <caption>
        <p>Fan Zhang -- 1/3/2021 Reviewed</p>
      </caption>
      <media xlink:href="giab008_reviewer_1_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>giab008_Reviewer_2_Report_Original_Submission</label>
      <caption>
        <p>Chris Chang -- 1/6/2021 Reviewed</p>
      </caption>
      <media xlink:href="giab008_reviewer_2_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>giab008_Supplemental_Files</label>
      <media xlink:href="giab008_supplemental_files.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Handsaker</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Wysoker</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>2078</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Auton</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Abecasis</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2156</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>The 1000 Genomes Project Consortium</collab>.</person-group>  <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>. <year>2015</year>;<volume>526</volume>:<fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarasov</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Vilella</surname>  <given-names>AJ</given-names></string-name>, <string-name><surname>Cuppen</surname>  <given-names>E</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Sambamba: fast processing of NGS alignment formats</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>:<fpage>2032</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">25697820</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tischler</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Leonard</surname>  <given-names>S</given-names></string-name></person-group><article-title>biobambam: tools for read pair collation based algorithms on BAM files</article-title>. <source>Source Code Biol Med</source>. <year>2014</year>;<volume>9</volume>:<fpage>2078</fpage>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Babraham Bioinformatics</collab>.</person-group>  <year>2019</year>
<source>FastQC: A quality control tool for high throughput sequence data</source>. <comment>Version 0.11.9. <ext-link ext-link-type="uri" xlink:href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">https://www.bioinformatics.babraham.ac.uk/projects/fastqc/</ext-link>. Accessed 29 June 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DePristo</surname>  <given-names>MA</given-names></string-name>, <string-name><surname>Banks</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Poplin</surname>  <given-names>R</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nat Genet</source>. <year>2011</year>;<volume>43</volume>:<fpage>491</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21478889</pub-id></mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Marshall</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>HTSlib - C library for reading/writing high-throughput sequencing data</article-title>. <source>Gigascience</source>. <year>2021</year>;<bold>10</bold>(2): doi:10.1093/gigascience/giab007</mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2020</year>
<comment>SAMtools, Version 1.11. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/samtools/releases/tag/1.11">https://github.com/samtools/samtools/releases/tag/1.11</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib28_175_1612547700797">
      <label>10.</label>
      <mixed-citation publication-type="journal"><comment>SAMtools - Documentation</comment>, <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org/doc/">https://www.htslib.org/doc/</ext-link>  <comment>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib10">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hsi-Yang Fritz</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Leinonen</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Cochrane</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Efficient storage of high throughput DNA sequencing data using reference-based compression</article-title>. <source>Genome Res</source>. <year>2011</year>;<volume>21</volume>:<fpage>734</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">21245279</pub-id></mixed-citation>
    </ref>
    <ref id="bib29_162_1612547803367">
      <label>12.</label>
      <mixed-citation publication-type="journal"><comment>SAMtools - Workflow</comment>, <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org/workflow/">https://www.htslib.org/workflow/</ext-link>  <comment>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib11">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>Improving SNP discovery by base alignment quality</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>1157</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21320865</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2020</year>
<comment>BCFtools, Version 1.11. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/bcftools/releases/tag/1.11">https://github.com/samtools/bcftools/releases/tag/1.11</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib13">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2987</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <label>16.</label>
      <mixed-citation publication-type="journal">
        <comment>gvcftools</comment>
        <year>2020</year>
        <comment>Version 0.17.0. <ext-link ext-link-type="uri" xlink:href="https://sites.google.com/site/gvcftools">https://sites.google.com/site/gvcftools</ext-link>. Accessed 6 November 2020.</comment>
      </mixed-citation>
    </ref>
    <ref id="bib15">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schilbert</surname>  <given-names>HM</given-names></string-name>, <string-name><surname>Rempel</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Pucker</surname>  <given-names>B</given-names></string-name></person-group><article-title>Comparison of read mapping and variant calling tools for the analysis of plant NGS data</article-title>. <source>Plants (Basel)</source>. <year>2020</year>;<volume>9</volume>(<issue>4</issue>):<fpage>439</fpage>.</mixed-citation>
    </ref>
    <ref id="bib16">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pightling</surname>  <given-names>AW</given-names></string-name>, <string-name><surname>Petronella</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Pagotto</surname>  <given-names>F</given-names></string-name></person-group><article-title>Choice of reference-guided sequence assembler and SNP caller for analysis of <italic>Listeria monocytogenes</italic> short-read sequence data greatly influences rates of error</article-title>. <source>BMC Res Notes</source>. <year>2015</year>;<volume>8</volume>:<fpage>748</fpage>.<pub-id pub-id-type="pmid">26643440</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R</given-names></string-name></person-group><article-title>Crumble: reference free lossy compression of sequence quality values</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>:<fpage>337</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29992288</pub-id></mixed-citation>
    </ref>
    <ref id="bib18">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>L</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Systematic comparative analysis of single-nucleotide variant detection methods from single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>. <year>2019</year>;<volume>20</volume>:<fpage>242</fpage>.<pub-id pub-id-type="pmid">31744515</pub-id></mixed-citation>
    </ref>
    <ref id="bib19">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Narasimhan</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Scally</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>BCFtools/RoH: a hidden Markov model approach for detecting autozygosity from next-generation sequencing data</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>:<fpage>1749</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">26826718</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>HipSci</surname>  <given-names>Consortium</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R</given-names></string-name></person-group><article-title>A method for checking genomic integrity in cultured cell lines from SNP genotyping data</article-title>. <source>PLoS One</source>. <year>2016</year>;<volume>11</volume>(<issue>5</issue>):<fpage>e0155014</fpage>.<pub-id pub-id-type="pmid">27176002</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McLaren</surname>  <given-names>W</given-names></string-name>, <string-name><surname>Gil</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Hunt</surname>  <given-names>SE</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The Ensembl Variant Effect Predictor</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>122</fpage>.<pub-id pub-id-type="pmid">27268795</pub-id></mixed-citation>
    </ref>
    <ref id="bib30_604_1612548058839">
      <label>24.</label>
      <mixed-citation publication-type="journal"><comment>BCFtools <ext-link ext-link-type="uri" xlink:href="https://samtools.github.io/bcftools/">https://samtools.github.io/bcftools/</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib22">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grüning</surname>  <given-names>B</given-names></string-name>, <string-name><surname>The Bioconda</surname>  <given-names>Team</given-names></string-name>, <string-name><surname>Dale</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Sjödin</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Bioconda: sustainable and comprehensive software distribution for the life sciences</article-title>. <source>Nat Methods</source>. <year>2018</year>:<fpage>475</fpage>–<lpage>6</lpage>..<pub-id pub-id-type="pmid">29967506</pub-id></mixed-citation>
    </ref>
    <ref id="bib23">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name></person-group><article-title>BCFtools/csq: haplotype-aware variant consequences</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>:<fpage>2037</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">28205675</pub-id></mixed-citation>
    </ref>
    <ref id="bib24">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nethercote</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Seward</surname>  <given-names>J</given-names></string-name></person-group><article-title>Valgrind: a framework for heavyweight dynamic binary instrumentation</article-title>. <source>SIGPLAN Not</source>. <year>2007</year>;<volume>42</volume>:<fpage>89</fpage>–<lpage>100</lpage>.</mixed-citation>
    </ref>
    <ref id="bib25">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Serebryany</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Bruening</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Potapenko</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>AddressSanitizer: a fast address sanity checker</article-title>. <comment>Proceedings of the 2012 USENIX Annual Technical Conference</comment>
<year>2012</year>
<comment><ext-link ext-link-type="uri" xlink:href="https://www.usenix.org/system/files/conference/atc12/atc12-final39.pdf">https://www.usenix.org/system/files/conference/atc12/atc12-final39.pdf</ext-link>. Accessed 6 November 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib26">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2019</year>
<comment>Define Local Alleles in VCF to allow for sparser format by yfarjoun. Pull Request #434. samtools/hts-specs. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/hts-specs/pull/434">https://github.com/samtools/hts-specs/pull/434</ext-link>. Accessed 10 July 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib27">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Liddle</surname>  <given-names>J</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Supporting data for “Twelve years of SAMtools and BCFtools.”</article-title>. <source>GigaScience Database</source>. <year>2021</year>
<pub-id pub-id-type="doi">10.5524/100866</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Gigascience</journal-id>
    <journal-id journal-id-type="iso-abbrev">Gigascience</journal-id>
    <journal-id journal-id-type="publisher-id">gigascience</journal-id>
    <journal-title-group>
      <journal-title>GigaScience</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2047-217X</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7931819</article-id>
    <article-id pub-id-type="pmid">33590861</article-id>
    <article-id pub-id-type="doi">10.1093/gigascience/giab008</article-id>
    <article-id pub-id-type="publisher-id">giab008</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Technical Note</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI00960</subject>
        <subject>AcademicSubjects/SCI02254</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Twelve years of SAMtools and BCFtools</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-4159-1666</contrib-id>
        <name>
          <surname>Danecek</surname>
          <given-names>Petr</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-6447-4112</contrib-id>
        <name>
          <surname>Bonfield</surname>
          <given-names>James K</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1059-1230</contrib-id>
        <name>
          <surname>Liddle</surname>
          <given-names>Jennifer</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1216-5457</contrib-id>
        <name>
          <surname>Marshall</surname>
          <given-names>John</given-names>
        </name>
        <aff><institution>Wolfson Wohl Cancer Research Centre, Institute of Cancer Sciences, University of Glasgow</institution>, Switchback Road, Glasgow, G61 1QH, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0532-6021</contrib-id>
        <name>
          <surname>Ohan</surname>
          <given-names>Valeriu</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8738-0920</contrib-id>
        <name>
          <surname>Pollard</surname>
          <given-names>Martin O</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8117-400X</contrib-id>
        <name>
          <surname>Whitwham</surname>
          <given-names>Andrew</given-names>
        </name>
        <!--<email>samtools@sanger.ac.uk</email>-->
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
        <xref ref-type="corresp" rid="cor1"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7532-6898</contrib-id>
        <name>
          <surname>Keane</surname>
          <given-names>Thomas</given-names>
        </name>
        <aff><institution>EMBL-EBI, Wellcome Genome Campus, Hinxton, Cambridgeshire</institution>, CB10 1SD, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2715-4187</contrib-id>
        <name>
          <surname>McCarthy</surname>
          <given-names>Shane A</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-9983-1378</contrib-id>
        <name>
          <surname>Davies</surname>
          <given-names>Robert M</given-names>
        </name>
        <aff><institution>Wellcome Sanger Institute, Wellcome Genome Campus</institution>, Hinxton, Cambridgeshire CB10 1SA, <country country="GB">UK</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4874-2874</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Heng</given-names>
        </name>
        <aff><institution>Department of Data Sciences, Dana-Farber Cancer Institute, 450 Brookline Avenue</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
        <aff><institution>Department of Biomedical Informatics, Harvard Medical School, 10 Shattuck Street</institution>, Boston, MA 02215, <country country="US">USA</country></aff>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="cor1"><bold>Correspondence address</bold>. Andrew Whitwham, Wellcome Sanger Institute, Wellcome Genome Campus, Hinxton, Cambridgeshire, CB10 1SA, UK. Tel: +44 (0)1223 834244; E-mail: <email>samtools@sanger.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="epub" iso-8601-date="2021-02-16">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>2</month>
      <year>2021</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>10</volume>
    <issue>2</issue>
    <elocation-id>giab008</elocation-id>
    <history>
      <date date-type="received">
        <day>16</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>18</day>
        <month>1</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>28</day>
        <month>1</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press GigaScience.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="giab008.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="abs1">
        <title>Background</title>
        <p>SAMtools and BCFtools are widely used programs for processing and analysing high-throughput sequencing data. They include tools for file format conversion and manipulation, sorting, querying, statistics, variant calling, and effect analysis amongst other methods.</p>
      </sec>
      <sec id="abs2">
        <title>Findings</title>
        <p>The first version appeared online 12 years ago and has been maintained and further developed ever since, with many new features and improvements added over the years. The SAMtools and BCFtools packages represent a unique collection of tools that have been used in numerous other software projects and countless genomic pipelines.</p>
      </sec>
      <sec id="abs3">
        <title>Conclusion</title>
        <p>Both SAMtools and BCFtools are freely available on GitHub under the permissive MIT licence, free for both non-commercial and commercial use. Both packages have been installed &gt;1 million times via Bioconda. The source code and documentation are available from <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>.</p>
      </sec>
    </abstract>
    <kwd-group kwd-group-type="keywords">
      <kwd>samtools</kwd>
      <kwd>bcftools</kwd>
      <kwd>high-throughput sequencing</kwd>
      <kwd>next generation sequencing</kwd>
      <kwd>variant calling</kwd>
      <kwd>data analysis</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Wellcome Trust</institution>
            <institution-id institution-id-type="DOI">10.13039/100010269</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>206194</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="4"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>Background</title>
    <p>With the advancement of genome sequencing technologies and large-scale sequencing projects, new data formats became necessary for interoperability, compact storage, and efficient analysis of the data. Among the most common formats used in this field today are SAM [<xref rid="bib1" ref-type="bibr">1</xref>] and VCF [<xref rid="bib2" ref-type="bibr">2</xref>], developed by the 1000 Genomes Project [<xref rid="bib3" ref-type="bibr">3</xref>]. These specialized formats for storing read alignments (SAM) and genetic variants (VCF) are row-oriented tab-delimited text files, which are easy to process using custom scripts but slow to parse and can be inefficient to store. Therefore in practice, the binary counterparts BAM or CRAM are used for alignment data and, when parsing of large VCF files becomes prohibitively slow, BCF provides a more efficient format for processing variation data.</p>
    <p>Despite the conceptual simplicity of the underlying DNA sequence, the alignment and variant data carry rich information. These data undergo a number of processing steps, many of which are algorithmically complex and require specialized software. Also more programming effort and expertise are necessary to parse binary formats. Therefore programs and toolkits that encompass functionality for the most common tasks have been developed. These include tools for file manipulation, quality control, and data analyses, such as sambamba [<xref rid="bib4" ref-type="bibr">4</xref>], biobambam [<xref rid="bib5" ref-type="bibr">5</xref>], FastQC [<xref rid="bib6" ref-type="bibr">6</xref>], and GATK [<xref rid="bib7" ref-type="bibr">7</xref>]. A successful bioinformatics tool must keep up with advancements in sequencing technologies (e.g., substantial increase in sequencing read length), scale well with ever-increasing amounts of data (from single to hundreds of thousands of genomes), and expand focus to encompass new analyses and more complex types of variation. New species also bring challenges such as large chromosomes not representable by 32 bits (&gt;2 Gb) or assumptions about the ploidy of an organism. In this article we describe the status, new features, and developments in SAMtools and BCFtools.</p>
    <p>SAMtools was originally published in 2009 [<xref rid="bib1" ref-type="bibr">1</xref>]. Readers of the online edition of that article would have been able to download release 0.1.4. The package included not only utilities to convert and manipulate SAM and BAM files but also a variant caller, which was soon restructured into the BCFtools subpackage (2010, release 0.1.9). Later it became apparent that third-party projects were trying to use code from SAMtools despite it not being designed to be embedded in that way. Therefore the decision was taken in August 2014 (release 1.0) to split the SAMtools package into a stand-alone library with a well-defined API (HTSlib, currently 82k lines of code) [<xref rid="bib8" ref-type="bibr">8</xref>], a project for variant calling and manipulation of variant data (BCFtools, 71k lines), and SAMtools for working with alignment data (42k lines). All 3 projects are maintained in parallel, and improvements to HTSlib naturally filter into new releases of SAMtools and BCFtools. Since the original release the combined size of HTSlib, SAMtools, and BCFtools has doubled.</p>
  </sec>
  <sec id="sec2">
    <title>Findings</title>
    <sec id="sec2-1">
      <title>SAMtools</title>
      <p>Since the initial release there have been &gt;2,200 commits to the code repository and 52 releases, the most recent being version 1.11 in September 2020 [<xref rid="bib9" ref-type="bibr">9</xref>].</p>
      <p>The main part of the SAMtools package is a single executable that offers various commands for working on alignment data. The “view" command performs format conversion, file filtering, and extraction of sequence ranges. Files can be reordered, joined, and split in various ways using the commands sort, collate, merge, cat, and split. Files can be indexed for fast random access using “index" for alignment files and “faidx" for reference sequences in the FASTA format. File content can be manipulated with commands like addreplacerg, calmd, fixmate, and reheader. Duplicated reads, caused by artefacts in the library creation and sequencing process, can be flagged using markdup. Various statistics on alignment files can be calculated using idxstats, flagstat, stats, depth, and bedcov. Data can be converted to legacy formats using fasta and fastq. For position-ordered files, the sequence alignment can be viewed using tview or output via mpileup in a way that can be used for ongoing processing (e.g., variant calling). Most recently SAMtools has gained support for amplicon-based sequencing projects via ampliconclip and ampliconstats.</p>
      <p>For a complete list of SAMtools commands with a short summary, version, and date of the initial commit see <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S1</xref>. Full documentation for these commands is included with the package in the form of UNIX man pages and can also be found online [<xref rid="bib28_175_1612547700797" ref-type="bibr">10</xref>].</p>
      <p>Early releases of SAMtools could read and write alignment data in the SAM and BAM formats. The 1.0 release introduced support for the better-compressed CRAM format [<xref rid="bib10" ref-type="bibr">11</xref>]. Originally, the program required the use of command line options to select the input format, and most commands were tied to using BAM files. These restrictions were removed as SAMtools transitioned to use HTSlib, so by release 1.0 most commands could automatically detect the input file format and could directly read and write SAM, BAM, and CRAM files. In particular, there is rarely any need to convert SAM to BAM using “samtools view -b” before running commands like “samtools sort,” although regrettably this idiom still appears in a large number of online tutorials. We encourage readers to follow best practices and workflows published at [<xref rid="bib29_162_1612547803367" ref-type="bibr">12</xref>].</p>
      <p>SAMtools has also become faster, most notably by gaining the ability to use threads to take better advantage of the parallelism available on modern multicore systems. Thread support first arrived in version 0.1.19 (March 2013), which enabled them for sorting and BAM file writing in the view command. The number of tasks using threads has slowly increased, so now (thanks to improvements in HTSlib) it is possible to use them for both reading and writing SAM, BAM, and CRAM formats in most of the commands. Another time-saving improvement is the ability to index files as they are written (added in 1.10). This allows pipelines that need to index files to remove the separate “samtools index” stage and associated read-through of the file being indexed.</p>
    </sec>
    <sec id="sec2-2">
      <title>BCFtools</title>
      <p>The original purpose of the BCFtools package was to divide the I/O- and CPU-intensive tasks of variant calling into separate steps.</p>
      <p>The first step, initially “samtools mpileup” but subsequently moved to “bcftools mpileup,” reads the alignments and for each position of the genome constructs a vertical slice across all reads covering the position (“pileup”). Genotype likelihoods are then calculated, representing how consistent are the observed data with the possible diploid genotypes. The calculation takes into account mapping qualities of the reads, base qualities, and the probability of local misalignment, per-base alignment quality (BAQ) [<xref rid="bib11" ref-type="bibr">13</xref>]. The second step, “bcftools call” (known in the initial release as “bcftools view”), then evaluates the most likely genotype under the assumption of Hardy-Weinberg equilibrium (in the sample context customizable by the user) using allele frequencies estimated from the data or provided explicitly by the user. In 2016 (release 1.4) genotype likelihood generation was moved from SAMtools to BCFtools to make both variant-calling steps part of the same package and to prevent errors arising from the possible use of incompatible versions of the 2 programs.</p>
      <p>Today BCFtools is a full-featured program that consists of 21 commands and 38 plugins (single-purpose tools) with &gt;230 documented command line switches and options. As of writing, there have been &gt;2,300 commits and 29 releases since 2012, with the most recent, 1.11, released in September 2020 [<xref rid="bib12" ref-type="bibr">14</xref>].</p>
      <p>The “bcftools view” command provides conversion between the text VCF and the binary BCF format, where both formats can be either plain (uncompressed) or block-compressed with BGZF for random access and compact size. The plain text VCF output is useful for visual inspection, for processing with custom scripts, and as a data exchange format. It should not be used when performance is critical because BCFtools internally uses the binary BCF representation and the conversion between the text VCF format and the binary BCF format is costly. Also compression and decompression is CPU intensive, and therefore when streaming between multiple commands in a pipeline it is recommended to stream uncompressed BCF by appending the option “-Ou.”</p>
      <p>The program can do much more than convert between VCF and BCF formats. It can also process third-party formats (using the “convert" command) and manipulate variant files in many ways. It can be used to index, sort, and normalize variants (“norm"), replace headers (“reheader"), add and remove annotations (“annotate"), and subset samples (“view"). Most commands can filter sites either by a region, list of sites, or a general Boolean expression involving any combination of VCF tags (--include, --exclude). Multiple files can be compared, splitting common and file-specific variants into separate files according to custom rules (isec). Files sorted by position can also be combined using the merge command (input files have different samples) or concat command (input files have the same samples). Arbitrary fields can be extracted and formatted into a custom text output (query), a feature that, among other things, is useful for scripting.</p>
      <p>Apart from file manipulation, the program offers variant callers and algorithms useful for analysis. For calling single-nucleotide polymorphisms and short indels from read alignment files, BCFtools implements 2 variant-calling models. In addition to the original biallelic caller (“bcftools call -c” [<xref rid="bib13" ref-type="bibr">15</xref>]) there is a newer model available, capable of handling positions with multiple alternate alleles (“bcftools call -m”) and supporting gVCF output [<xref rid="bib14" ref-type="bibr">16</xref>]. (For a recent comparison of the variant-calling component of the software see [<xref rid="bib15" ref-type="bibr">17–20</xref>].) The package implements a hidden Markov model caller for detection of runs of homozygosity (roh [<xref rid="bib19" ref-type="bibr">21</xref>]), copy-number variation calling from single-nucleotide polymorphism array data (cnv [<xref rid="bib20" ref-type="bibr">22</xref>]), and the detection of whole-chromosome aberrations (polysomy). The program can construct a consensus sequence given a FASTA and a variant file (consensus), perform sample identity checks (gtcheck), and collect various statistics (stats).</p>
      <p>In addition to built-in commands, the program supports a dynamic plugin mechanism for specific single-purpose tasks with a diverse range of functions. Examples from a large and ever-growing collection include the plugin split-vep for convenient querying and extraction of VEP annotations [<xref rid="bib21" ref-type="bibr">23</xref>]; trio-dnm for ascertainment of <italic>de novo</italic> variants and their parental origin (parental-origin), or for collection of statistics (trio-stats) in trio data; gVCF manipulation (gvcfz); and many more.</p>
      <p>For a complete list of BCFtools commands and plugins with a short summary, version, and date of the initial commit see <xref ref-type="supplementary-material" rid="sup6">Supplementary Table S2</xref>. Full documentation for these commands is included with the package in the form of UNIX man pages and can also be found online together with short tutorials, math notes, and other documentation at [<xref rid="bib30_604_1612548058839" ref-type="bibr">24</xref>].</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="sec3">
    <title>Discussion</title>
    <p>SAMtools and BCFtools represent a unique collection of tools useful for processing and analysis of sequencing data. Their development has been driven by the need of both large projects and individual user requests issued via GitHub. The code has been installed &gt;1 million times via Bioconda [<xref rid="bib22" ref-type="bibr">25</xref>] and GitHub releases [<xref rid="bib9" ref-type="bibr">9</xref>, <xref rid="bib12" ref-type="bibr">14</xref>], and &gt;1600 support and feature requests have been resolved on GitHub.</p>
    <p>The programs are written in the C programming language and optimized for low memory consumption and high speed. For example, the “bcftools csq” command for prediction of functional consequences in a haplotype-aware manner requires only a fraction of the memory required by VEP and is 2 orders of magnitude faster [<xref rid="bib23" ref-type="bibr">26</xref>].</p>
    <p>Much work has been done to increase the reliability of SAMtools and BCFtools. The test harnesses now include ∼700 tests in SAMtools and ∼1,400 in BCFtools. Continuous integration services run all of the tests on a variety of platforms (including Linux, MacOS, and Windows) whenever code is checked into the source repository, ensuring that bugs are discovered and fixed rapidly. Code quality is also assured by checking for memory errors, originally using Valgrind memcheck [<xref rid="bib24" ref-type="bibr">27</xref>] and more recently with AddressSanitizer [<xref rid="bib25" ref-type="bibr">28</xref>]. Additionally, UndefinedBehaviorSanitizer is used to detect violations of the C standard.</p>
    <p>Despite the ever-growing sample sizes and rapid increases in the amount of sequenced data, the programs have withstood the test of time. However, extremely big files are produced by large projects and their processing requires a high degree of parallelization on computing clusters. Future versions of SAMtools and BCFtools are expected to make more use of threaded code to allow faster processing of such files. Sometimes even the limits of BCF representation itself can be reached. For example, highly polymorphic sites can contain dozens of alternate indel alleles, which, in files with tens of thousands of samples, exceed the internal limit of 4 GB per site due to quadratic scaling of annotations such as FORMAT/PL. An extension of the VCF specification has been proposed to address this problem by introducing a localized version of such annotations with linear scaling [<xref rid="bib26" ref-type="bibr">29</xref>] and has been implemented in BCFtools.</p>
    <p>The programs have been used to process and analyze sequencing data from all types of species: vertebrates, invertebrates, pathogens, plants, and viruses. This provides interesting challenges and opportunities for future development. For example, some of the BCFtools commands are limited to handling haploid and diploid organisms and the support for large “64-bit” genomes is currently only partial. More work is also planned to overcome difficulties stemming from ambiguities in VCF allele encoding (such as operations of atomization and deatomization) and to improve visualization of results, and there are &gt;50 feature requests currently registered on GitHub to investigate.</p>
  </sec>
  <sec id="sec4">
    <title>Availability of Supporting Source Code and Requirements</title>
    <p>Project name: SAMtools</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/samtools">https://github.com/samtools/samtools</ext-link></p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: C</p>
    <p>License: MIT/Expat</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_002105">RRID:SCR_002105</ext-link>
    </p>
    <p>biotools: samtools</p>
    <p>Project name: BCFtools</p>
    <p>Project home page: <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org">https://www.htslib.org</ext-link>, <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/bcftools">https://github.com/samtools/bcftools</ext-link></p>
    <p>Operating system(s): Platform independent</p>
    <p>Programming language: C</p>
    <p>Other requirements: Optional use of GNU Scientific Library (GSL)</p>
    <p>License: MIT/Expat</p>
    <p>
      <ext-link ext-link-type="uri" xlink:href="https://scicrunch.org/resolver/RRID:SCR_002105">RRID:SCR_002105</ext-link>
    </p>
    <p>biotools: bcftools</p>
  </sec>
  <sec sec-type="data-availability" id="sec5">
    <title>Data Availability</title>
    <p>Snapshots of the code and tabular files are available from the <italic>GigaScience</italic> GigaDB repository [<xref rid="bib27" ref-type="bibr">30</xref>].</p>
  </sec>
  <sec id="sec6">
    <title>Editors Note</title>
    <p>An accompanying article describing the HTSlib software library for providing programmatic access is published alongside this article [<xref rid="bib8" ref-type="bibr">8</xref>].</p>
  </sec>
  <sec id="sec7">
    <title>Additional Files</title>
    <p>Supplementary Table S1: Table of SAMtools commands</p>
    <p>Supplementary Table S2: Table of BCFtools commands</p>
  </sec>
  <sec id="h1content1612547370513">
    <title>Abbreviations</title>
    <p>API: Application Programming Interface; CPU: central processing unit; GATK: Genome Analysis Toolkit; Gb: gigabase pairs.</p>
  </sec>
  <sec id="sec8">
    <title>Competing Interests</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec id="sec9">
    <title>Funding</title>
    <p>This work was supported by a Wellcome Trust grant (206194).</p>
  </sec>
  <sec id="sec10">
    <title>Authors' Contributions</title>
    <p>J.K.B., P.D., R.M.D., H.L., J.M., M.O.P., V.O., and A.W. wrote the SAMtools software with J.L. and S.A.M. supporting; R.M.D., T.K., and J.M. provided supervision.</p>
    <p>P.D. and S.A.M. wrote the BCFtools software with J.K.B., R.M.D., H.L., J.M., and V.O. supporting; S.A.M. also provided supervision.</p>
    <p>J.K.B., P.D., R.M.D., V.O., and A.W. wrote the original draft of the manuscript with all authors reviewing.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>giab008_GIGA-D-20-00369_Original_Submission</label>
      <media xlink:href="giab008_giga-d-20-00369_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup2">
      <label>giab008_GIGA-D-20-00369_Revision_1</label>
      <media xlink:href="giab008_giga-d-20-00369_revision_1.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup3">
      <label>giab008_Response_to_Reviewer_Comments_Original_Submission</label>
      <media xlink:href="giab008_response_to_reviewer_comments_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup4">
      <label>giab008_Reviewer_1_Report_Original_Submission</label>
      <caption>
        <p>Fan Zhang -- 1/3/2021 Reviewed</p>
      </caption>
      <media xlink:href="giab008_reviewer_1_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup5">
      <label>giab008_Reviewer_2_Report_Original_Submission</label>
      <caption>
        <p>Chris Chang -- 1/6/2021 Reviewed</p>
      </caption>
      <media xlink:href="giab008_reviewer_2_report_original_submission.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="sup6">
      <label>giab008_Supplemental_Files</label>
      <media xlink:href="giab008_supplemental_files.docx">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="bib1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name>, <string-name><surname>Handsaker</surname>  <given-names>B</given-names></string-name>, <string-name><surname>Wysoker</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>:<fpage>2078</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="bib2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Auton</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Abecasis</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2156</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="bib3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>The 1000 Genomes Project Consortium</collab>.</person-group>  <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>. <year>2015</year>;<volume>526</volume>:<fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="bib4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tarasov</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Vilella</surname>  <given-names>AJ</given-names></string-name>, <string-name><surname>Cuppen</surname>  <given-names>E</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Sambamba: fast processing of NGS alignment formats</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>:<fpage>2032</fpage>–<lpage>4</lpage>.<pub-id pub-id-type="pmid">25697820</pub-id></mixed-citation>
    </ref>
    <ref id="bib5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tischler</surname>  <given-names>G</given-names></string-name>, <string-name><surname>Leonard</surname>  <given-names>S</given-names></string-name></person-group><article-title>biobambam: tools for read pair collation based algorithms on BAM files</article-title>. <source>Source Code Biol Med</source>. <year>2014</year>;<volume>9</volume>:<fpage>2078</fpage>.</mixed-citation>
    </ref>
    <ref id="bib6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Babraham Bioinformatics</collab>.</person-group>  <year>2019</year>
<source>FastQC: A quality control tool for high throughput sequence data</source>. <comment>Version 0.11.9. <ext-link ext-link-type="uri" xlink:href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">https://www.bioinformatics.babraham.ac.uk/projects/fastqc/</ext-link>. Accessed 29 June 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DePristo</surname>  <given-names>MA</given-names></string-name>, <string-name><surname>Banks</surname>  <given-names>E</given-names></string-name>, <string-name><surname>Poplin</surname>  <given-names>R</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nat Genet</source>. <year>2011</year>;<volume>43</volume>:<fpage>491</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21478889</pub-id></mixed-citation>
    </ref>
    <ref id="bib8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Marshall</surname>  <given-names>J</given-names></string-name>, <string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>HTSlib - C library for reading/writing high-throughput sequencing data</article-title>. <source>Gigascience</source>. <year>2021</year>;<bold>10</bold>(2): doi:10.1093/gigascience/giab007</mixed-citation>
    </ref>
    <ref id="bib9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2020</year>
<comment>SAMtools, Version 1.11. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/samtools/releases/tag/1.11">https://github.com/samtools/samtools/releases/tag/1.11</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib28_175_1612547700797">
      <label>10.</label>
      <mixed-citation publication-type="journal"><comment>SAMtools - Documentation</comment>, <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org/doc/">https://www.htslib.org/doc/</ext-link>  <comment>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib10">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hsi-Yang Fritz</surname>  <given-names>M</given-names></string-name>, <string-name><surname>Leinonen</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Cochrane</surname>  <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Efficient storage of high throughput DNA sequencing data using reference-based compression</article-title>. <source>Genome Res</source>. <year>2011</year>;<volume>21</volume>:<fpage>734</fpage>–<lpage>40</lpage>.<pub-id pub-id-type="pmid">21245279</pub-id></mixed-citation>
    </ref>
    <ref id="bib29_162_1612547803367">
      <label>12.</label>
      <mixed-citation publication-type="journal"><comment>SAMtools - Workflow</comment>, <ext-link ext-link-type="uri" xlink:href="https://www.htslib.org/workflow/">https://www.htslib.org/workflow/</ext-link>  <comment>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib11">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>Improving SNP discovery by base alignment quality</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>1157</fpage>–<lpage>8</lpage>.<pub-id pub-id-type="pmid">21320865</pub-id></mixed-citation>
    </ref>
    <ref id="bib12">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2020</year>
<comment>BCFtools, Version 1.11. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/bcftools/releases/tag/1.11">https://github.com/samtools/bcftools/releases/tag/1.11</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib13">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>  <given-names>H</given-names></string-name></person-group><article-title>A statistical framework for SNP calling, mutation discovery, association mapping and population genetical parameter estimation from sequencing data</article-title>. <source>Bioinformatics</source>. <year>2011</year>;<volume>27</volume>:<fpage>2987</fpage>–<lpage>93</lpage>.<pub-id pub-id-type="pmid">21903627</pub-id></mixed-citation>
    </ref>
    <ref id="bib14">
      <label>16.</label>
      <mixed-citation publication-type="journal">
        <comment>gvcftools</comment>
        <year>2020</year>
        <comment>Version 0.17.0. <ext-link ext-link-type="uri" xlink:href="https://sites.google.com/site/gvcftools">https://sites.google.com/site/gvcftools</ext-link>. Accessed 6 November 2020.</comment>
      </mixed-citation>
    </ref>
    <ref id="bib15">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schilbert</surname>  <given-names>HM</given-names></string-name>, <string-name><surname>Rempel</surname>  <given-names>A</given-names></string-name>, <string-name><surname>Pucker</surname>  <given-names>B</given-names></string-name></person-group><article-title>Comparison of read mapping and variant calling tools for the analysis of plant NGS data</article-title>. <source>Plants (Basel)</source>. <year>2020</year>;<volume>9</volume>(<issue>4</issue>):<fpage>439</fpage>.</mixed-citation>
    </ref>
    <ref id="bib16">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pightling</surname>  <given-names>AW</given-names></string-name>, <string-name><surname>Petronella</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Pagotto</surname>  <given-names>F</given-names></string-name></person-group><article-title>Choice of reference-guided sequence assembler and SNP caller for analysis of <italic>Listeria monocytogenes</italic> short-read sequence data greatly influences rates of error</article-title>. <source>BMC Res Notes</source>. <year>2015</year>;<volume>8</volume>:<fpage>748</fpage>.<pub-id pub-id-type="pmid">26643440</pub-id></mixed-citation>
    </ref>
    <ref id="bib17">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R</given-names></string-name></person-group><article-title>Crumble: reference free lossy compression of sequence quality values</article-title>. <source>Bioinformatics</source>. <year>2019</year>;<volume>35</volume>:<fpage>337</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">29992288</pub-id></mixed-citation>
    </ref>
    <ref id="bib18">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>  <given-names>F</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname>  <given-names>L</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Systematic comparative analysis of single-nucleotide variant detection methods from single-cell RNA sequencing data</article-title>. <source>Genome Biol</source>. <year>2019</year>;<volume>20</volume>:<fpage>242</fpage>.<pub-id pub-id-type="pmid">31744515</pub-id></mixed-citation>
    </ref>
    <ref id="bib19">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Narasimhan</surname>  <given-names>V</given-names></string-name>, <string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Scally</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>BCFtools/RoH: a hidden Markov model approach for detecting autozygosity from next-generation sequencing data</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>:<fpage>1749</fpage>–<lpage>51</lpage>.<pub-id pub-id-type="pmid">26826718</pub-id></mixed-citation>
    </ref>
    <ref id="bib20">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name>, <string-name><surname>HipSci</surname>  <given-names>Consortium</given-names></string-name>, <string-name><surname>Durbin</surname>  <given-names>R</given-names></string-name></person-group><article-title>A method for checking genomic integrity in cultured cell lines from SNP genotyping data</article-title>. <source>PLoS One</source>. <year>2016</year>;<volume>11</volume>(<issue>5</issue>):<fpage>e0155014</fpage>.<pub-id pub-id-type="pmid">27176002</pub-id></mixed-citation>
    </ref>
    <ref id="bib21">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McLaren</surname>  <given-names>W</given-names></string-name>, <string-name><surname>Gil</surname>  <given-names>L</given-names></string-name>, <string-name><surname>Hunt</surname>  <given-names>SE</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>The Ensembl Variant Effect Predictor</article-title>. <source>Genome Biol</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>122</fpage>.<pub-id pub-id-type="pmid">27268795</pub-id></mixed-citation>
    </ref>
    <ref id="bib30_604_1612548058839">
      <label>24.</label>
      <mixed-citation publication-type="journal"><comment>BCFtools <ext-link ext-link-type="uri" xlink:href="https://samtools.github.io/bcftools/">https://samtools.github.io/bcftools/</ext-link>. Accessed 9 February 2021</comment>.</mixed-citation>
    </ref>
    <ref id="bib22">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grüning</surname>  <given-names>B</given-names></string-name>, <string-name><surname>The Bioconda</surname>  <given-names>Team</given-names></string-name>, <string-name><surname>Dale</surname>  <given-names>R</given-names></string-name>, <string-name><surname>Sjödin</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Bioconda: sustainable and comprehensive software distribution for the life sciences</article-title>. <source>Nat Methods</source>. <year>2018</year>:<fpage>475</fpage>–<lpage>6</lpage>..<pub-id pub-id-type="pmid">29967506</pub-id></mixed-citation>
    </ref>
    <ref id="bib23">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>McCarthy</surname>  <given-names>SA</given-names></string-name></person-group><article-title>BCFtools/csq: haplotype-aware variant consequences</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>:<fpage>2037</fpage>–<lpage>9</lpage>.<pub-id pub-id-type="pmid">28205675</pub-id></mixed-citation>
    </ref>
    <ref id="bib24">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nethercote</surname>  <given-names>N</given-names></string-name>, <string-name><surname>Seward</surname>  <given-names>J</given-names></string-name></person-group><article-title>Valgrind: a framework for heavyweight dynamic binary instrumentation</article-title>. <source>SIGPLAN Not</source>. <year>2007</year>;<volume>42</volume>:<fpage>89</fpage>–<lpage>100</lpage>.</mixed-citation>
    </ref>
    <ref id="bib25">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Serebryany</surname>  <given-names>K</given-names></string-name>, <string-name><surname>Bruening</surname>  <given-names>D</given-names></string-name>, <string-name><surname>Potapenko</surname>  <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>AddressSanitizer: a fast address sanity checker</article-title>. <comment>Proceedings of the 2012 USENIX Annual Technical Conference</comment>
<year>2012</year>
<comment><ext-link ext-link-type="uri" xlink:href="https://www.usenix.org/system/files/conference/atc12/atc12-final39.pdf">https://www.usenix.org/system/files/conference/atc12/atc12-final39.pdf</ext-link>. Accessed 6 November 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib26">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>SAMtools</collab>.</person-group>  <year>2019</year>
<comment>Define Local Alleles in VCF to allow for sparser format by yfarjoun. Pull Request #434. samtools/hts-specs. <ext-link ext-link-type="uri" xlink:href="https://github.com/samtools/hts-specs/pull/434">https://github.com/samtools/hts-specs/pull/434</ext-link>. Accessed 10 July 2020.</comment></mixed-citation>
    </ref>
    <ref id="bib27">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname>  <given-names>P</given-names></string-name>, <string-name><surname>Bonfield</surname>  <given-names>JK</given-names></string-name>, <string-name><surname>Liddle</surname>  <given-names>J</given-names></string-name>, <etal>et al.</etal></person-group>  <article-title>Supporting data for “Twelve years of SAMtools and BCFtools.”</article-title>. <source>GigaScience Database</source>. <year>2021</year>
<pub-id pub-id-type="doi">10.5524/100866</pub-id>.</mixed-citation>
    </ref>
  </ref-list>
</back>
