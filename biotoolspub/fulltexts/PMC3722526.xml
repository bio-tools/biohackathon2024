<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.3 20070202//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.3?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3722526</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btt338</article-id>
    <article-id pub-id-type="publisher-id">btt338</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group>
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>UniNovo: a universal tool for <italic>de novo</italic> peptide sequencing</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Jeong</surname>
          <given-names>Kyowon</given-names>
        </name>
        <xref ref-type="aff" rid="btt338-AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="corresp" rid="btt338-COR1">*</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kim</surname>
          <given-names>Sangtae</given-names>
        </name>
        <xref ref-type="aff" rid="btt338-AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pevzner</surname>
          <given-names>Pavel A.</given-names>
        </name>
        <xref ref-type="aff" rid="btt338-AFF1">
          <sup>2</sup>
        </xref>
        <xref ref-type="corresp" rid="btt338-COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="btt338-AFF1"><sup>1</sup>Department of Electrical and Computer Engineering and <sup>2</sup>Department of Computer Science and Engineering, University of California, San Diego, CA 92093, USA</aff>
    <author-notes>
      <corresp id="btt338-COR1">*To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: Martin Bishop</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>8</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>12</day>
      <month>6</month>
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>12</day>
      <month>6</month>
      <year>2013</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>29</volume>
    <issue>16</issue>
    <fpage>1953</fpage>
    <lpage>1962</lpage>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>11</month>
        <year>2012</year>
      </date>
      <date date-type="rev-recd">
        <day>7</day>
        <month>5</month>
        <year>2013</year>
      </date>
      <date date-type="accepted">
        <day>10</day>
        <month>6</month>
        <year>2013</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2013. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/3.0/">http://creativecommons.org/licenses/by-nc/3.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> Mass spectrometry (MS) instruments and experimental protocols are rapidly advancing, but <italic>de novo</italic> peptide sequencing algorithms to analyze tandem mass (MS/MS) spectra are lagging behind. Although existing <italic>de novo</italic> sequencing tools perform well on certain types of spectra [e.g. Collision Induced Dissociation (CID) spectra of tryptic peptides], their performance often deteriorates on other types of spectra, such as Electron Transfer Dissociation (ETD), Higher-energy Collisional Dissociation (HCD) spectra or spectra of non-tryptic digests. Thus, rather than developing a new algorithm for each type of spectra, we develop a universal <italic>de novo</italic> sequencing algorithm called UniNovo that works well for all types of spectra or even for spectral pairs (e.g. CID/ETD spectral pairs). UniNovo uses an improved scoring function that captures the dependences between different ion types, where such dependencies are learned automatically using a modified offset frequency function.</p>
      <p><bold>Results:</bold> The performance of UniNovo is compared with PepNovo+, PEAKS and pNovo using various types of spectra. The results show that the performance of UniNovo is superior to other tools for ETD spectra and superior or comparable with others for CID and HCD spectra. UniNovo also estimates the probability that each reported reconstruction is correct, using simple statistics that are readily obtained from a small training dataset. We demonstrate that the estimation is accurate for all tested types of spectra (including CID, HCD, ETD, CID/ETD and HCD/ETD spectra of trypsin, LysC or AspN digested peptides).</p>
      <p><bold>Availability:</bold> UniNovo is implemented in JAVA and tested on Windows, Ubuntu and OS X machines. UniNovo is available at <ext-link ext-link-type="uri" xlink:href="http://proteomics.ucsd.edu/Software/UniNovo.html">http://proteomics.ucsd.edu/Software/UniNovo.html</ext-link> along with the manual.</p>
      <p><bold>Contact:</bold><email>kwj@ucsd.edu</email> or <email>ppevzner@ucsd.edu</email></p>
      <p><bold>Supplementary information:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="10"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 INTRODUCTION</title>
    <p><italic>De novo</italic> peptide sequencing by tandem mass (MS/MS) spectrometry is a valuable alternative to MS/MS database search. In contrast to the database search approach that utilizes the information from proteome, the <italic>de novo</italic> sequencing approach attempts to identify peptides only using the information from the input spectrum. Hence, most <italic>de novo</italic> sequencing algorithms are based on the prior knowledge of the fragmentation characteristics (e.g. ion types and their propensities) of MS/MS spectra (<xref ref-type="bibr" rid="btt338-B11">Frank, 2009</xref>; <xref ref-type="bibr" rid="btt338-B12">Frank and Pevzner, 2005</xref>; <xref ref-type="bibr" rid="btt338-B27">Ma <italic>et al.</italic>, 2003</xref>).</p>
    <p>The fragmentation characteristics are highly dependent on the fragmentation method used to generate the spectrum. Among several fragmentation methods available, the collision-induced dissociation (CID) is the most commonly used method. Accordingly, the fragmentation characteristics of CID have been well studied compared with recently introduced fragmentation methods, such as electron transfer dissociation (ETD) and higher-energy collisional dissociation (HCD) (<xref ref-type="bibr" rid="btt338-B2">Barton and Whittaker, 2009</xref>; <xref ref-type="bibr" rid="btt338-B4">Breci <italic>et al.</italic>, 2003</xref>; <xref ref-type="bibr" rid="btt338-B15">Huang <italic>et al.</italic>, 2005</xref>; <xref ref-type="bibr" rid="btt338-B18">Johnson <italic>et al.</italic>, 1987</xref>; <xref ref-type="bibr" rid="btt338-B35">Tabb <italic>et al.</italic>, 2004</xref>; <xref ref-type="bibr" rid="btt338-B36">Wysocki <italic>et al.</italic>, 2000</xref>). As a result, many <italic>de novo</italic> sequencing algorithms have been introduced for CID spectra; for example, PEAKS (<xref ref-type="bibr" rid="btt338-B27">Ma <italic>et al.</italic>, 2003</xref>) and PepNovo+ (<xref ref-type="bibr" rid="btt338-B11">Frank, 2009</xref>; <xref ref-type="bibr" rid="btt338-B12">Frank and Pevzner, 2005</xref>) are the state of the art <italic>de novo</italic> sequencing tools for CID spectra.</p>
    <p>Other fragmentation methods like ETD and HCD have a great potential for <italic>de novo</italic> sequencing. For example, for highly charged spectra, ETD provides better fragmentation and thus is better suited for <italic>de novo</italic> sequencing than CID (<xref ref-type="bibr" rid="btt338-B33">Swaney <italic>et al.</italic>, 2008</xref>; <xref ref-type="bibr" rid="btt338-B37">Zubarev <italic>et al.</italic>, 2008</xref>). Also, more complete fragmentation of peptide ions (especially in low mass regions) in HCD provides a better chance to obtain more accurate <italic>de novo</italic> reconstructions than CID (<xref ref-type="bibr" rid="btt338-B6">Chi <italic>et al.</italic>, 2010</xref>; <xref ref-type="bibr" rid="btt338-B30">Olsen <italic>et al.</italic>, 2007</xref>). Furthermore, modern mass spectrometers (e.g. LTQ-Orbitrap Velos) allow the generation of paired spectra (e.g. CID/ETD or HCD/ETD spectral pairs). Since CID (or HCD) and ETD spectra provide complementary information for peptide sequencing (<xref ref-type="bibr" rid="btt338-B8">Datta and Bern, 2009</xref>; <xref ref-type="bibr" rid="btt338-B14">He and Ma, 2010</xref>; <xref ref-type="bibr" rid="btt338-B32">Savitski <italic>et al.</italic>, 2005</xref>), such spectral pairs (or even triplets) enable more accurate <italic>de novo</italic> sequencing.</p>
    <p>Several <italic>de novo</italic> sequencing algorithms were recently presented to take advantage of those new fragmentation methods. For instance, <xref ref-type="bibr" rid="btt338-B25">Liu <italic>et al.</italic> (2010)</xref> proposed a <italic>de novo</italic> sequencing algorithm for ETD spectra, which is used by PEAKS. For HCD spectra, <xref ref-type="bibr" rid="btt338-B6">Chi <italic>et al.</italic> (2010)</xref> introduced a <italic>de novo</italic> sequencing tool, pNovo, that not only takes advantage of the high precision peaks in HCD spectra but also uses the information of abundant immonium and internal ions. In case of spectral pairs, <xref ref-type="bibr" rid="btt338-B32">Savitski <italic>et al.</italic> (2005)</xref> proposed a greedy algorithm (for CID/ECD spectral pairs) that significantly boosts the performance of <italic>de novo</italic> sequencing. <xref ref-type="bibr" rid="btt338-B8">Datta and Bern (2009)</xref> presented Spectrum Fusion, a <italic>de novo</italic> sequencing algorithm for CID/ETD spectral pairs. Spectrum Fusion constructs a combined spectrum from the input CID/ETD spectral pair using a Bayesian Network. It generates multiple <italic>de novo</italic> sequences using the combined spectrum and score them by the scoring function in ByOnic (<xref ref-type="bibr" rid="btt338-B3">Bern <italic>et al.</italic>, 2007</xref>). <xref ref-type="bibr" rid="btt338-B14">He and Ma (2010)</xref> also presented a <italic>de novo</italic> sequencing algorithm, ADEPTS, for CID/ETD spectral pairs. Given a CID/ETD spectral pair, ADEPTS first finds 1000 candidate <italic>de novo</italic> sequences from each spectrum, using PEAKS. The total 2000 candidate sequences are then rescored against the input spectral pair, and the best-scoring peptide is reported.</p>
    <p>While the above tools perform well for the spectra generated from the fragmentation method(s) that each tool targeted, they often generate inferior results for the spectra from other fragmentation methods. Moreover, if alternative proteases (e.g. LysC or AspN) are used for protein digestion, these tools may produce suboptimal results because different proteases often generate peptides with different fragmentation characteristics (<xref ref-type="bibr" rid="btt338-B24">Kim <italic>et al.</italic>, 2010</xref>).</p>
    <p>In case of the database search approach, <xref ref-type="bibr" rid="btt338-B24">Kim <italic>et al.</italic> (2010)</xref> recently introduced a universal algorithm MS-GFDB that shows a significantly better peptide identification performance than other existing database search tools such as Mascot + Percolator (<xref ref-type="bibr" rid="btt338-B19">Käll <italic>et al.</italic>, 2007</xref>; <xref ref-type="bibr" rid="btt338-B31">Perkins <italic>et al.</italic>, 1999</xref>). However, a universal <italic>de novo</italic> sequencing tool is still missing.</p>
    <p>We present UniNovo, a universal <italic>de novo</italic> sequencing tool that can be generalized for various <italic>types</italic> (i.e. the combinations of the fragmentation method and the protease used to digest sample proteins) of spectra. The scoring function of UniNovo is easily trainable using a training dataset consisting of thousands of annotated spectra. All information needed for <italic>de novo</italic> sequencing are learned from the training dataset, and the running time for training is &lt;5 h in a typical desktop environment. Currently, UniNovo is trained for CID, HCD and ETD spectra of trypsin, LysC or AspN digested peptides. We show that the performance of UniNovo is better than or comparable with PepNovo+, PEAKS and pNovo for various types of spectra.</p>
    <p>One of the biggest challenges in <italic>de novo</italic> sequencing is to estimate the error rate of the resulting <italic>de novo</italic> reconstructions. Unlike MS/MS database search tools that commonly uses the <italic>target-decoy approach</italic> (<xref ref-type="bibr" rid="btt338-B9">Elias and Gygi, 2007</xref>; <xref ref-type="bibr" rid="btt338-B28">Nesvizhskii, 2010</xref>) to estimate the statistical significance of the peptide identifications, <italic>de novo</italic> reconstructions have rarely been subjected to a statistical significance analysis in the past.</p>
    <p>Several <italic>de novo</italic> sequencing tools report the error rate of amino acid predictions (e.g. confidence scores in PEAKS), but this is often not sufficient because the overall quality of the sequence cannot be easily determined by the error rates of individual amino acid predictions. To our knowledge, only PepNovo+ reports the empirical probability that the output peptide is correct. PepNovo+ predicts the probabilities using logistic regression with multiple features of the reconstructions such as length and score, which are extracted from a training dataset consisting of hundreds of thousands of annotated spectra (<xref ref-type="bibr" rid="btt338-B11">Frank, 2009</xref>). However, PepNovo+ does not include an automated training procedure (that would allow to easily extend PepNovo+ for newly emerging mass spectrometry approaches) and is currently trained only for CID [Extending PepNovo+ beyond CID spectra requires training complex boosting-based re-ranking models for predicting peak ranks and rescoring peptide candidates. PepNovo+ training includes several manual steps and the availability of a very large corpus of training spectra (Ari Frank, personal communication, October 5, 2012)]. Thus, in case of non-CID fragmentation methods, it remains unclear how to obtain accurate error rate estimation for <italic>de novo</italic> reconstructions.</p>
    <p>UniNovo estimates the probability that each reported reconstruction is correct, using simple statistics that are readily obtained from a small training dataset. We demonstrate that the estimation is accurate for all tested types of spectra (including CID, HCD, ETD, CID/ETD and HCD/ETD spectra of trypsin, LysC or AspN digested peptides). This allows UniNovo to automatically filter out low quality spectra.</p>
  </sec>
  <sec>
    <title>2 METHODS</title>
    <p>Similar to <xref ref-type="bibr" rid="btt338-B22">Kim <italic>et al.</italic> (2009a)</xref>, we first describe the algorithm on a simplified model that assumes the following:
<list list-type="bullet"><list-item><p>the masses of amino acids are integers (e.g. the mass of Gly is 57).</p></list-item><list-item><p>the m/z (mass to charge ratio) of peaks (in spectra) are integers.</p></list-item><list-item><p>the intensity of all peaks is 1.</p></list-item><list-item><p>only N-terminal charge 1 ions are considered (e.g. <italic>b</italic>, <italic>c</italic>, or <inline-formula><inline-graphic xlink:href="btt338i1.jpg"/></inline-formula> ions, but not <italic>y</italic>-ion series).</p></list-item><list-item><p>the <italic>parent mass</italic> (the mass of the precursor ion) of a spectrum equals to the mass of the peptide that generated the spectrum.</p></list-item></list>
</p>
    <p>While such a simplified model is impractical, we chose to introduce our algorithm on this model for better understanding of the algorithm on a more complex and realistic model. The algorithm on a more realistic model is described in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S2</ext-link>.</p>
    <sec id="SEC2.1">
      <title>2.1 Terminology and definitions</title>
      <p>Let <italic>A</italic> be the set of amino acids with (integer) masses <italic>m</italic>(<italic>a</italic>) for <inline-formula><inline-graphic xlink:href="btt338i2.jpg"/></inline-formula>. A <italic>peptide</italic>
<inline-formula><inline-graphic xlink:href="btt338i3.jpg"/></inline-formula> is a sequence of amino acids, and the mass of a peptide is the total mass of amino acids in the peptide. We represent a peptide <inline-formula><inline-graphic xlink:href="btt338i4.jpg"/></inline-formula> with mass <italic>n</italic> by a Boolean vector <inline-formula><inline-graphic xlink:href="btt338i5.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="btt338i6.jpg"/></inline-formula> if <inline-formula><inline-graphic xlink:href="btt338i7.jpg"/></inline-formula> for <inline-formula><inline-graphic xlink:href="btt338i8.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="btt338i9.jpg"/></inline-formula> otherwise. If <inline-formula><inline-graphic xlink:href="btt338i10.jpg"/></inline-formula>, we call a mass <italic>i</italic> a <italic>fragmentation site</italic>. For example, suppose there are two amino acids <italic>A</italic> and <italic>B</italic> with masses 2 and 3, respectively. Then, the peptide <italic>ABBA</italic> has the mass of <inline-formula><inline-graphic xlink:href="btt338i11.jpg"/></inline-formula> and is represented by a Boolean vector (0,1,0,0,1,0,0,1,0,0). The fragmentation sites of this peptide are, thus, 2, 5 and 8.</p>
      <p>A <italic>spectrum</italic> is a list of peaks, where each peak is specified by an m/z. We represent a spectrum of parent mass <italic>n</italic> by a Boolean vector <inline-formula><inline-graphic xlink:href="btt338i12.jpg"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="btt338i13.jpg"/></inline-formula> if the peak of m/z <italic>i</italic> (or simply the peak <italic>i</italic>) is present and <inline-formula><inline-graphic xlink:href="btt338i14.jpg"/></inline-formula> otherwise (Representing peptides and spectra as vectors allows us to represent the generation of spectra from peptides by simple vector operations.).</p>
      <p>A <italic>peptide-spectrum match (PSM)</italic> is a pair <inline-formula><inline-graphic xlink:href="btt338i15.jpg"/></inline-formula> formed by a peptide <italic>P</italic> and a spectrum <italic>S</italic>. Given an integer δ called an <italic>ion type</italic> and a PSM <inline-formula><inline-graphic xlink:href="btt338i16.jpg"/></inline-formula>, we say a peak <italic>i</italic> is a <italic>δ-ion peak</italic> (with respect to <italic>P</italic>) if <inline-formula><inline-graphic xlink:href="btt338i17.jpg"/></inline-formula> is a fragmentation site, that is, <inline-formula><inline-graphic xlink:href="btt338i18.jpg"/></inline-formula>. In this model, the ion type can be any integer. In the connection to the experimental MS/MS spectra, ion types can represent common singly charged N-terminal ions; for example, the ion types 1 and −27 represent <italic>b</italic> and <italic>a</italic> ions, respectively.</p>
      <p>Given an integer <italic>f</italic> called a <italic>feature</italic> and a spectrum <italic>S</italic>, we say that a peak <italic>i satisfies f</italic> if another peak <italic>i</italic> + <italic>f</italic> is present in the spectrum, that is, <inline-formula><inline-graphic xlink:href="btt338i19.jpg"/></inline-formula>. For instance, a peak 30 satisfies a feature <inline-formula><inline-graphic xlink:href="btt338i20.jpg"/></inline-formula>, if <inline-formula><inline-graphic xlink:href="btt338i21.jpg"/></inline-formula>. In experimental spectra, various ions are often observed along with neutral losses (e.g. <italic>b</italic>-ion and <inline-formula><inline-graphic xlink:href="btt338i22.jpg"/></inline-formula>-ion) or with related ions (e.g. <italic>b</italic>-ion and <italic>a</italic>-ion). A feature describes the relation (the shift of m/z values in this simplified model) between two peaks that may correspond to a neutral loss or a mass gain/loss between related ions. For example, since we are dealing with only charge 1 ions, a water loss (from any ions) is represented by the feature <inline-formula><inline-graphic xlink:href="btt338i23.jpg"/></inline-formula>, and the mass gain from <italic>a</italic>-ion to <italic>b</italic>-ion is represented by the feature <inline-formula><inline-graphic xlink:href="btt338i24.jpg"/></inline-formula>. The possible interpretations of selected features are found in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary Tables S5–S37</ext-link> in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S12</ext-link>.</p>
    </sec>
    <sec id="SEC2.2">
      <title>2.2 Peptide-spectrum generative model</title>
      <p>We model how a peptide <italic>P</italic> of mass <italic>n</italic> generates a spectrum <italic>S</italic>. Apart from a 1-step generative model in <xref ref-type="bibr" rid="btt338-B1">Bandeira <italic>et al.</italic> (2008)</xref> or <xref ref-type="bibr" rid="btt338-B22">Kim <italic>et al.</italic> (2009a)</xref>, we introduce a more adequate 2-step probabilistic model in which the dependency between different ions can be described.</p>
      <p>Assume that we are given the set of ion types (the <italic>ion type set</italic> Δ) and the set of features (the <italic>feature set F</italic>). For simplicity, we consider the case where only one ion type <inline-formula><inline-graphic xlink:href="btt338i25.jpg"/></inline-formula> is in Δ and one feature <italic>f</italic> is in <italic>F</italic>. Given a peptide <italic>P</italic>, a <italic>partial-spectrum s</italic> is generated per each element <italic>P<sub>i</sub></italic> of <italic>P</italic> as follows: The probability that <inline-formula><inline-graphic xlink:href="btt338i26.jpg"/></inline-formula> is given by α if <inline-formula><inline-graphic xlink:href="btt338i27.jpg"/></inline-formula> or by β otherwise (the first generation step). This first step can be characterized by a <inline-formula><inline-graphic xlink:href="btt338i28.jpg"/></inline-formula> matrix called the <italic>ion type matrix</italic> (<xref ref-type="fig" rid="btt338-F1">Fig. 1</xref>). When <inline-formula><inline-graphic xlink:href="btt338i39.jpg"/></inline-formula>, the probability that <inline-formula><inline-graphic xlink:href="btt338i40.jpg"/></inline-formula> (i.e. the peak <italic>i</italic> satisfies <italic>f</italic>) is given by μ if <inline-formula><inline-graphic xlink:href="btt338i41.jpg"/></inline-formula> or ν otherwise (the second generation step). The second step is characterized by the <italic>feature-ion type matrix</italic> (<xref ref-type="fig" rid="btt338-F1">Fig. 1</xref>) (Given <inline-formula><inline-graphic xlink:href="btt338i42.jpg"/></inline-formula>, the probability that <inline-formula><inline-graphic xlink:href="btt338i43.jpg"/></inline-formula> is assumed to be 0.). The second step can describe the dependency between different ions (or an ion and its neutral loss) from the same fragmentation site. If multiple ion types and multiple features are considered, the ion type matrix should be defined per ion type, and the feature-ion type matrix per ion type and per feature. The spectrum <italic>S</italic> is generated by taking elementwise OR operation for the generated partial-spectra <italic>s</italic>.
<fig id="btt338-F1" position="float"><label>Fig. 1.</label><caption><p>(<bold>a</bold>) The generation of a partial-spectrum <italic>s</italic> for <italic>P<sub>i</sub></italic>. One ion type <inline-formula><inline-graphic xlink:href="btt338i29.jpg"/></inline-formula> and one feature <italic>f</italic> are considered. The probability that <inline-formula><inline-graphic xlink:href="btt338i30.jpg"/></inline-formula> is given by α if <inline-formula><inline-graphic xlink:href="btt338i31.jpg"/></inline-formula> or by β otherwise. When <inline-formula><inline-graphic xlink:href="btt338i32.jpg"/></inline-formula>, the probability that <inline-formula><inline-graphic xlink:href="btt338i33.jpg"/></inline-formula> (i.e., the peak <italic>i</italic> satisfies <italic>f</italic>) is given by μ if <inline-formula><inline-graphic xlink:href="btt338i34.jpg"/></inline-formula> or by ν otherwise. The spectrum is generated by taking elementwise OR operation for generated partial-spectra for all elements of <italic>P</italic>. (<bold>b</bold>) The calculation of the fragmentation probability vector <inline-formula><inline-graphic xlink:href="btt338i35.jpg"/></inline-formula> from a spectrum <italic>S</italic> (without knowing the peptide <italic>P</italic> that generated <italic>S</italic>). We consider one ion type <inline-formula><inline-graphic xlink:href="btt338i36.jpg"/></inline-formula> and two features <italic>f</italic><sub>1</sub> and <italic>f</italic><sub>2</sub>. The events ‘a peak satisfies <italic>f</italic><sub>1</sub>’ and ‘a peak satisfies <italic>f</italic><sub>2</sub>’ are assumed to be independent. To derive <inline-formula><inline-graphic xlink:href="btt338i37.jpg"/></inline-formula>, first we examine which features the peak <italic>i</italic> satisfies in the spectrum <italic>S</italic>. Denote the features the peak <italic>i</italic> satisfies by <italic>H</italic>. Second, given <italic>H</italic>, we calculate the probability that <inline-formula><inline-graphic xlink:href="btt338i38.jpg"/></inline-formula> [using the probabilities given in ion type matrix and feature-ion type matrix—see the <xref ref-type="disp-formula" rid="btt338-M1">equation (1)</xref>]</p></caption><graphic xlink:href="btt338f1p"/></fig></p>
    </sec>
    <sec id="SEC2.3">
      <title>2.3 Training UniNovo</title>
      <p>Since the ion type matrices and feature-ion type matrices fully describe the generation of a spectrum, in the training step, UniNovo learns these matrices from the <italic>training dataset</italic> (a set of PSMs). To define these matrices, the ion type set Δ and the feature set <italic>F</italic> should be formed. Using the <italic>offset frequency function</italic> introduced in <xref ref-type="bibr" rid="btt338-B7">Dancik <italic>et al.</italic> (1999)</xref>, we collect frequently observed ion types and form the ion type set Δ. To form the feature set <italic>F</italic>, we define the <italic>feature frequency function</italic> with which one can count how many times each possible feature is observed in the training dataset (see the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S1.2</ext-link>). Using the feature frequency function, we collect frequently observed features and form the feature set <italic>F</italic>. From here on, we only consider ion types in the ion type set Δ and features in the feature set <italic>F</italic>.</p>
      <p>Next UniNovo learns the ion type and feature-ion type matrices that characterize the generative model of the PSMs in the training dataset. For example, <inline-formula><inline-graphic xlink:href="btt338i44.jpg"/></inline-formula> can be empirically determined if partial-spectra <italic>s</italic> are given. However, it is not clear how to decompose a spectrum <italic>S</italic> into partial-spectra <italic>s</italic> (since partial spectra may share peaks in the spectrum). As a compromise, we learn <inline-formula><inline-graphic xlink:href="btt338i45.jpg"/></inline-formula> for estimation of α. Other probabilities are also empirically determined similarly by substituting the partial-spectra by the spectrum.</p>
      <p>We emphasize that all the above probabilities can be learned from a small set of PSMs (e.g. 5000 PSMs per charge state are often sufficient to avoid overfitting; see the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S15</ext-link>) even if there are many ion types in Δ and features in <italic>F</italic> because each probability is associated to an individual ion type or a combination of an ion type and a feature, not a combination of multiple ion types and multiple features.</p>
      <p>Lastly, we compute the probability that a random element of a peptide vector is a fragmentation site, i.e., <inline-formula><inline-graphic xlink:href="btt338i46.jpg"/></inline-formula> [When masses of amino acids are rounded to integers, <inline-formula><inline-graphic xlink:href="btt338i47.jpg"/></inline-formula>. However, if we consider more accurate amino acid masses (for the spectra of high resolution), this probability should be learned from the training dataset.]. This probability is called the <italic>prior fragmentation probability</italic> and denoted by <italic>p</italic>. The detailed description of UniNovo training is given in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S1</ext-link>.</p>
    </sec>
    <sec id="SEC2.4">
      <title>2.4 How to infer fragmentation sites from a spectrum</title>
      <p>Given a spectrum <italic>S</italic> of parent mass <italic>n</italic>, our goal is to predict the fragmentation sites of the (unknown) peptide <italic>P</italic> that generated <italic>S</italic>. For simplicity, assume that there exists a single ion type <inline-formula><inline-graphic xlink:href="btt338i48.jpg"/></inline-formula> is in the ion type set Δ (but multiple features in the feature set <italic>F</italic>). Given a peak <italic>i</italic>, define <italic>H</italic> as the set of features that the peak <italic>i</italic> satisfies. Then the fragmentation sites are predicted by solving the following Bayesian inference problem.</p>
      <p><bold>Fragmentation inference problem:</bold> Given the set of features <italic>H</italic> and <italic>P<sub>i</sub></italic> such that <inline-formula><inline-graphic xlink:href="btt338i49.jpg"/></inline-formula> (the prior fragmentation probability), derive the posterior probability <inline-formula><inline-graphic xlink:href="btt338i50.jpg"/></inline-formula>.</p>
      <p>Since we assumed that there is only one ion type, we have only one ion type matrix. On the other hand, per each feature we have a feature-ion type matrix. Let <inline-formula><inline-graphic xlink:href="btt338i51.jpg"/></inline-formula> and <inline-formula><inline-graphic xlink:href="btt338i52.jpg"/></inline-formula> denote μ and ν associated to the feature <italic>f</italic>, respectively. If we can assume that all features are independent (i.e., the events ‘<inline-formula><inline-graphic xlink:href="btt338i53.jpg"/></inline-formula>’ are independent for <inline-formula><inline-graphic xlink:href="btt338i54.jpg"/></inline-formula>), we obtain
<disp-formula id="btt338-M1"><label>(1)</label><graphic xlink:href="btt338m1"/></disp-formula>
where <inline-formula><inline-graphic xlink:href="btt338i55.jpg"/></inline-formula> (see the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S3</ext-link> for derivation). Denote the obtained probability in (1) as <inline-formula><inline-graphic xlink:href="btt338i56.jpg"/></inline-formula>. We define a <italic>fragmentation probability vector <italic>(</italic></italic><inline-formula><inline-graphic xlink:href="btt338i57.jpg"/></inline-formula><italic>)</italic> as a vector with <italic>n</italic> elements such that
<disp-formula><label>(2)</label><graphic xlink:href="btt338um1"/></disp-formula>
for <inline-formula><inline-graphic xlink:href="btt338i58.jpg"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="btt338i59.jpg"/></inline-formula> (see <xref ref-type="fig" rid="btt338-F1">Fig. 1</xref>b). <inline-formula><inline-graphic xlink:href="btt338i60.jpg"/></inline-formula> is an estimated probability that <inline-formula><inline-graphic xlink:href="btt338i61.jpg"/></inline-formula> (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary Figs S3</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">S4</ext-link>, blue bars). We use <inline-formula><inline-graphic xlink:href="btt338i62.jpg"/></inline-formula> for the generation of <italic>de novo</italic> reconstructions.</p>
      <p>The <xref ref-type="disp-formula" rid="btt338-M1">equation (1)</xref> is based on a simplified model in which a single one ion type and multiple independent features are used. However, some features are known to be strongly dependent on each other (e.g. a feature describing a single water loss and a double water losses), and usually multiple ion types are present in the ion type set. Thus, in practice, per each peak, UniNovo automatically selects a small number of features (&lt;10 out of thousands of features in the feature set) that are weakly correlated yet effective to determine the ion type of the peak. Assuming that the selected features are mutually independent, <inline-formula><inline-graphic xlink:href="btt338i63.jpg"/></inline-formula> is calculated per ion type using the <xref ref-type="disp-formula" rid="btt338-M1">equation (1)</xref>, and then the final <inline-formula><inline-graphic xlink:href="btt338i64.jpg"/></inline-formula> is given by a weighted summation of the <inline-formula><inline-graphic xlink:href="btt338i65.jpg"/></inline-formula>’s of different ion types. Note that there are many possible combinations of features due to the large number of all the features in the feature set (even if the number of the features to calculate <inline-formula><inline-graphic xlink:href="btt338i66.jpg"/></inline-formula> per peak is &lt;10). Since different combinations of features are selected for different peaks, UniNovo is able to use more diverse relations between different ions as compared with other tools that typically use fixed dependencies between ions (e.g. PepNovo). The detailed description and an example of the feature selection method and the calculation of <inline-formula><inline-graphic xlink:href="btt338i67.jpg"/></inline-formula> are given in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S3</ext-link>.</p>
    </sec>
    <sec id="SEC2.5">
      <title>2.5 Generating <italic>de novo</italic> reconstructions</title>
      <p>To generate <italic>de novo</italic> reconstructions, we first construct a <italic>spectrum graph</italic> (<xref ref-type="bibr" rid="btt338-B7">Dancik <italic>et al.</italic>, 1999</xref>). Given a spectrum <italic>S</italic> of parent mass <italic>n</italic> from an unknown peptide <italic>P</italic>, the spectrum graph <inline-formula><inline-graphic xlink:href="btt338i68.jpg"/></inline-formula> is defined as a directed acyclic graph whose vertex set <italic>V</italic> consists of 0 (the source), <italic>n</italic> (the sink) and integers <italic>i</italic> such that <inline-formula><inline-graphic xlink:href="btt338i69.jpg"/></inline-formula>. Two vertices <italic>i</italic> and <italic>j</italic> are connected by an edge <inline-formula><inline-graphic xlink:href="btt338i70.jpg"/></inline-formula> if <italic>j</italic> – <italic>i</italic> equals to the mass of an amino acid or the total mass of multiple amino acids (<italic>a mass gap</italic>). Any path from 0 (the source) to <italic>n</italic> (the sink) in a spectrum graph corresponds to a peptide (possibly containing mass gaps). We say that a vertex <italic>i</italic> is <italic>correct</italic> if <inline-formula><inline-graphic xlink:href="btt338i71.jpg"/></inline-formula> and an edge <inline-formula><inline-graphic xlink:href="btt338i72.jpg"/></inline-formula> is <italic>correct</italic> if both vertices <italic>i</italic> and <italic>j</italic> are correct. We also say that a path <italic>r</italic> is <italic>correct</italic> if all vertices in <italic>r</italic> are correct. The <italic>length</italic> of a reconstruction is defined by the total number of amino acids and mass gaps in the reconstruction.</p>
      <p>To score a <italic>de novo</italic> reconstruction, we use an additive (i.e., the score of a path is the sum of scores of vertices of the path) log likelihood ratio scoring [similar to <xref ref-type="bibr" rid="btt338-B7">Dancik <italic>et al.</italic> (1999)</xref>]. Given a vertex <italic>i</italic>, let <inline-formula><inline-graphic xlink:href="btt338i73.jpg"/></inline-formula>. The likelihoods of the following two hypothesis for the outcome <inline-formula><inline-graphic xlink:href="btt338i74.jpg"/></inline-formula> are tested: (i) the vertex <italic>i</italic> is correct and (ii) the vertex <italic>i</italic> is incorrect. Let <inline-formula><inline-graphic xlink:href="btt338i75.jpg"/></inline-formula>. Then, we have
<disp-formula id="btt338-M2"><label>(3)</label><graphic xlink:href="btt338m2"/></disp-formula>
</p>
      <p>The score of the vertex <italic>i</italic> with <inline-formula><inline-graphic xlink:href="btt338i76.jpg"/></inline-formula> is defined by <inline-formula><inline-graphic xlink:href="btt338i77.jpg"/></inline-formula> where <inline-formula><inline-graphic xlink:href="btt338i78.jpg"/></inline-formula> denotes the rounding to the nearest integer. Given a path <italic>r</italic>, the score of the path <italic>r</italic> is defined by <inline-formula><inline-graphic xlink:href="btt338i79.jpg"/></inline-formula>.</p>
      <p>Since an additive scoring is used, top scoring reconstructions can be efficiently generated using a dynamic programming as in <xref ref-type="bibr" rid="btt338-B7">Dancik <italic>et al.</italic> (1999)</xref>. We did not exclude symmetric paths in the spectrum graph that usually correspond to incorrect reconstructions. Considering only the antisymmetric paths would further enhance the performance of UniNovo (<xref ref-type="bibr" rid="btt338-B5">Chen <italic>et al.</italic>, 2001</xref>).</p>
      <p>After generating the reconstructions, a probability that each reconstruction is correct (termed the <italic>accuracy</italic> of the reconstruction) is predicted, using Hunter’s bound (<xref ref-type="bibr" rid="btt338-B16">Hunter, 1976</xref>) (see the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S4</ext-link> for the definition of the accuracy of reconstructions). Hunter’s bound can be calculated from relatively simple statistics that are readily learned from a small set of PSMs (about 5000 PSMs). <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary Figures S2</ext-link> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">S3</ext-link> (green bars) in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S9</ext-link> show that the accuracy of a reconstruction is a conservative estimate of the empirical probability of the reconstruction being correct.</p>
    </sec>
  </sec>
  <sec>
    <title>3 RESULTS</title>
    <sec id="SEC3.1">
      <title>3.1 Datasets</title>
      <p>To benchmark UniNovo, we used 13 different datasets with diverse fragmentation methods (CID/ETD/HCD), digested with diverse proteases (trypsin, LysC and AspN), and having diverse charge states (see <xref ref-type="table" rid="btt338-T1">Table 1</xref>). We re-analyzed the spectral datasets (<italic>original datasets</italic>) from Albert Heck’s and Joshua Coon’s laboratories that were previously analyzed in <xref ref-type="bibr" rid="btt338-B24">Kim <italic>et al.</italic> (2010)</xref>, <xref ref-type="bibr" rid="btt338-B34">Swaney <italic>et al.</italic> (2010)</xref> and <xref ref-type="bibr" rid="btt338-B13">Frese <italic>et al.</italic> (2011)</xref>. The CID and ETD spectra in these original datasets were acquired in a hybrid linear ion trap/Orbitrap mass spectrometers (high MS1 resolution and low MS2 resolution). The HCD spectra have high MS1 and MS2 resolution. All spectra in the original datasets were identified by MS-GFDB (ver. 01/06/2012) (<xref ref-type="bibr" rid="btt338-B24">Kim <italic>et al.</italic>, 2010</xref>) at 1% peptide-level FDR without allowing any modification except the carbamidomethylation of Cys (C + 57) as a fixed modification [In the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S13</ext-link>, we also re-analyzed the dataset reported in <xref ref-type="bibr" rid="btt338-B23">Kim <italic>et al.</italic> (2009b)</xref> that contains doubly charged CID spectra identified using Sequest (<xref ref-type="bibr" rid="btt338-B10">Eng <italic>et al.</italic>, 1994</xref>) and PeptideProphet (<xref ref-type="bibr" rid="btt338-B20">Keller <italic>et al.</italic>, 2002</xref>).]. Out of all identified spectra, we selected 1000 spectra (or pairs of spectra) from distinct peptides randomly and formed the 13 datasets listed in <xref ref-type="table" rid="btt338-T1">Table 1</xref>. The unselected identified spectra (about 5000 to 20 000 spectra depending on the type of spectra) were used for the training of UniNovo. The peptide contained in the training dataset were not contained in the above 13 datasets. See the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S10</ext-link> for the detailed description of these datasets.
<table-wrap id="btt338-T1" position="float"><label>Table 1.</label><caption><p>Summary of the datasets used for benchmarking</p></caption><table frame="hsides" rules="groups"><thead align="left"><tr><th rowspan="1" colspan="1">Dataset</th><th rowspan="1" colspan="1">CID2</th><th rowspan="1" colspan="1">CIDL2</th><th rowspan="1" colspan="1">CIDA2</th><th rowspan="1" colspan="1">ETD2</th><th rowspan="1" colspan="1">ETD3</th><th rowspan="1" colspan="1">ETDL3</th><th rowspan="1" colspan="1">ETDL4</th><th rowspan="1" colspan="1">ETDA3</th><th rowspan="1" colspan="1">ETDA4</th><th rowspan="1" colspan="1">HCD2</th><th rowspan="1" colspan="1">HCD3</th><th rowspan="1" colspan="1">CID/ETD2</th><th rowspan="1" colspan="1">CID/ETD3</th></tr><tr><th rowspan="1" colspan="1">Fragmentation</th><th rowspan="1" colspan="1">CID</th><th rowspan="1" colspan="1">CID</th><th rowspan="1" colspan="1">CID</th><th rowspan="1" colspan="1">ETD</th><th rowspan="1" colspan="1">ETD</th><th rowspan="1" colspan="1">ETD</th><th rowspan="1" colspan="1">ETD</th><th rowspan="1" colspan="1">ETD</th><th rowspan="1" colspan="1">ETD</th><th rowspan="1" colspan="1">HCD</th><th rowspan="1" colspan="1">HCD</th><th rowspan="1" colspan="1">CID/ETD</th><th rowspan="1" colspan="1">CID/ETD</th></tr></thead><tbody align="left"><tr><td rowspan="1" colspan="1">Charge</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">4</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">3</td><td rowspan="1" colspan="1">2</td><td rowspan="1" colspan="1">3</td></tr><tr><td rowspan="1" colspan="1">Enzyme</td><td rowspan="1" colspan="1">Tryp</td><td rowspan="1" colspan="1">LysC</td><td rowspan="1" colspan="1">AspN</td><td rowspan="1" colspan="1">Tryp</td><td rowspan="1" colspan="1">Tryp</td><td rowspan="1" colspan="1">LysC</td><td rowspan="1" colspan="1">LysC</td><td rowspan="1" colspan="1">AspN</td><td rowspan="1" colspan="1">AspN</td><td rowspan="1" colspan="1">Tryp</td><td rowspan="1" colspan="1">Tryp</td><td rowspan="1" colspan="1">Tryp</td><td rowspan="1" colspan="1">Tryp</td></tr><tr><td rowspan="1" colspan="1">Average pep. length</td><td rowspan="1" colspan="1">12.6</td><td rowspan="1" colspan="1">11.4</td><td rowspan="1" colspan="1">12.3</td><td rowspan="1" colspan="1">12.5</td><td rowspan="1" colspan="1">16.4</td><td rowspan="1" colspan="1">12.5</td><td rowspan="1" colspan="1">18.7</td><td rowspan="1" colspan="1">12.8</td><td rowspan="1" colspan="1">18.9</td><td rowspan="1" colspan="1">10.5</td><td rowspan="1" colspan="1">14.5</td><td rowspan="1" colspan="1">12.3</td><td rowspan="1" colspan="1">17.1</td></tr><tr><td rowspan="1" colspan="1">UniNovo</td><td rowspan="1" colspan="1"/><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td></tr><tr><td rowspan="1" colspan="1">PepNovo+</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">N/A</td></tr><tr><td rowspan="1" colspan="1">PEAKS</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">N/A</td></tr><tr><td rowspan="1" colspan="1">pNovo</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">*</td><td rowspan="1" colspan="1">N/A</td><td rowspan="1" colspan="1">N/A</td></tr></tbody></table><table-wrap-foot><fn id="btt338-TF1"><p><italic>Note:</italic> Number of spectra (or spectral pairs) is 1000 for each dataset. While UniNovo is applicable to all datasets, other tools are only applicable to (or optimized for) datasets marked by ‘*’. PEAKS was not tested for HCD datasets.</p></fn></table-wrap-foot></table-wrap></p>
    </sec>
    <sec id="SEC3.2">
      <title>3.2 Benchmarking UniNovo</title>
      <p>We benchmarked UniNovo, PepNovo+ (ver. 3.1 beta) (<xref ref-type="bibr" rid="btt338-B11">Frank, 2009</xref>), PEAKS (ver. 5.3, online) (<xref ref-type="bibr" rid="btt338-B27">Ma <italic>et al.</italic>, 2003</xref>) and pNovo (ver. 1.1) (<xref ref-type="bibr" rid="btt338-B6">Chi <italic>et al.</italic>, 2010</xref>) using the datasets in <xref ref-type="table" rid="btt338-T1">Table 1</xref>. For each tool, we generated <italic>N de novo</italic> reconstructions per each spectrum for <inline-formula><inline-graphic xlink:href="btt338i80.jpg"/></inline-formula> and 20. We say that a spectrum is <italic>correctly sequenced</italic> if at least one of <italic>N</italic> reconstructions generated from the spectrum is correct. To evaluate the performance of each tool, the number of correctly sequenced spectra and the average length of correct reconstructions were measured for each tool (Since mass gaps are allowed for reconstructions, often multiple correct reconstructions were reported for a spectrum. To calculate the average length of correct reconstructions, only the top scoring correct reconstruction was counted per a spectrum.).</p>
      <p>For UniNovo, the maximum number of mass gaps in a reconstruction was set to 2. UniNovo was tested for all datasets. For PepNovo+, also <italic>N</italic> top scoring reconstructions were generated per spectrum. PepNovo+ was used for CID2, CIDL2, CIDA2, HCD2 and HCD3 datasets. In case of PEAKS, we first generated 500 top scoring reconstructions per each spectrum. Then, for each reconstruction we converted amino acids with the local confidence &lt;30% into mass gaps. Such conversion is adopted because PEAKS generates reconstruction without mass gaps while UniNovo and PepNovo+ generate reconstructions with up to two mass gaps. In this procedure, multiple reconstructions without mass gaps were often converted into the same reconstruction with mass gaps. The score of a converted reconstruction is defined as the highest score of the reconstructions before conversion. Out of the converted reconstructions, <italic>N</italic> top high scoring (distinct) ones were chosen and used for further analysis. PEAKS was tested for all datasets except for HCD2 and HCD3 datasets. For pNovo, <italic>N</italic> top scoring reconstructions were generated per a spectrum (pNovo also generates reconstructions without mass gaps. However, the conversion of reconstructions as in PEAKS could not be applied to pNovo because pNovo does not report any local score.). Only HCD2 and HCD3 datasets were analyzed by pNovo. The parameters of each tool for each dataset is provided in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S8</ext-link>.</p>
      <p>We also indirectly compared UniNovo with MS-GFDB (<xref ref-type="bibr" rid="btt338-B24">Kim <italic>et al.</italic>, 2010</xref>), as both tools were developed to analyze diverse types of spectra. We replaced the scoring function of UniNovo with that of MS-GFDB and generated reconstructions using the replaced scoring method. More precisely, the spectrum graph was generated by MS-GFDB per each spectrum, and the reconstructions were generated by UniNovo on that spectrum graph (instead of the spectrum graph generated by UniNovo). This generation method is specified by MS-GFDBScore. All experimental parameters for MS-GFDBScore were the same as for UniNovo.</p>
      <p><xref ref-type="fig" rid="btt338-F2">Figure 2</xref> shows the comparison results for different datasets. UniNovo found the largest number of correctly sequenced spectra among all the tested tools in most datasets. In particular, for ETD spectra, UniNovo reported significantly more correctly sequenced spectra than PEAKS. For example, in case of ETD2 or ETDL4 dataset, the number of correctly sequenced spectra was more than twice for UniNovo than for PEAKS.
<fig id="btt338-F2" position="float"><label>Fig. 2.</label><caption><p>Comparison of <italic>de novo</italic> sequencing tools [as well as a database search tool MS-GFDB (<xref ref-type="bibr" rid="btt338-B24">Kim <italic>et al.</italic>, 2010</xref>) tweaked for <italic>de novo</italic> sequencing]. Per each spectrum, <italic>N</italic> top scoring reconstructions were generated by UniNovo, PepNovo+ (<xref ref-type="bibr" rid="btt338-B11">Frank, 2009</xref>; <xref ref-type="bibr" rid="btt338-B12">Frank and Pevzner, 2005</xref>), PEAKS (<xref ref-type="bibr" rid="btt338-B27">Ma <italic>et al.</italic>, 2003</xref>), pNovo (<xref ref-type="bibr" rid="btt338-B6">Chi <italic>et al.</italic>, 2010</xref>) and MS-GFDBScore. MS-GFDBScore provides UniNovo with MS-GFDB’s scoring function. The number of reported reconstructions per a spectrum (<italic>N</italic>) is set to 1, 5 and 20. A reconstruction is correct if all the fragmentation sites of the reconstruction are correct, and a spectrum is classified as correctly sequenced if at least one of the reconstructions generated from the spectrum is correct. Figures on the left side (<bold>a</bold>, <bold>c</bold> and <bold>e</bold>) show the number of correctly sequenced spectra in each dataset, and figures on the right side (<bold>b</bold>, <bold>d</bold> and <bold>f</bold>) show the average length of the correct reconstructions</p></caption><graphic xlink:href="btt338f2p"/></fig></p>
      <p>For CID spectra, UniNovo and PepNovo+ showed similar results. When <italic>N</italic> = 1, UniNovo and PepNovo+ found about the same number of correctly sequenced spectra in CID2 and CIDL2 datasets, but UniNovo found about 35% more correctly sequenced spectra than PepNovo+ in CIDA2 dataset.</p>
      <p>While trypsin and LysC-digested peptides generate the spectra of similar fragmentation characteristics, AspN-digested peptides generate spectra with distinct fragmentation propensities. UniNovo worked well with AspN-digested peptides, but PepNovo+ showed suboptimal results for the spectra of AspN-digested peptides [Training of the parameters for the Bayesian network of PepNovo (<xref ref-type="bibr" rid="btt338-B12">Frank and Pevzner, 2005</xref>) for the CID spectra of AspN- or LysC-digested peptides would lead to better results; however, as mentioned above, the re-ranking models of PepNovo+ (<xref ref-type="bibr" rid="btt338-B11">Frank, 2009</xref>), which are crucial for the superior performance of PepNovo+ for CID tryptic spectra (see the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S14</ext-link>), cannot be readily trained.]. The length of correct reconstructions for PepNovo+ was slightly longer than for UniNovo.</p>
      <p>The results on HCD spectra also demonstrate that UniNovo finds the largest number of correctly sequenced spectra in general. The reconstructions reported by pNovo were, however, longer than those by UniNovo (and PepNovo+) by two to three amino acids. This suggests that UniNovo still has room for improvement for HCD spectra (e.g. introducing features better reflecting the high mass resolution and information from immonium or internal ions).</p>
      <p>The results from UniNovo were superior to MS-GFDBScore in both terms of the number of correctly sequenced spectra and the average length of the correct reconstructions in all datasets.</p>
      <p>For each dataset, we drew the Venn diagrams of the correctly sequenced spectra (<xref ref-type="fig" rid="btt338-F3">Fig. 3</xref> and <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary Figs S5–S12</ext-link>) to see the overlaps of the spectra between different tools. For all datasets, the overlaps between different tools increase as <italic>N</italic> grows, as expected. Relatively small overlaps are observed for ETD spectra (as compared with CID or HCD spectra). It indicates that UniNovo may have been using some valuable features of ETD spectra missed by PEAKS (and vice versa) and suggests that combining UniNovo and PEAKS results may potentially lead to a promising <italic>de novo</italic> sequencing approach.
<fig id="btt338-F3" position="float"><label>Fig. 3.</label><caption><p>The Venn diagrams of the correctly sequenced spectra for CID2 (<bold>a–c</bold>), ETD3 (<bold>d–f</bold>) and HCD2 (<bold>g–i</bold>) datasets. For all datasets, the overlaps between different tools increase as <italic>N</italic> grows, as expected. Relatively small overlaps are observed for ETD spectra when compared with CID or HCD spectra. The Venn diagrams for other datasets are found in <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary Figures S5–S12</ext-link> in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S11</ext-link></p></caption><graphic xlink:href="btt338f3p"/></fig></p>
      <p>While the above results measure the sequence level accuracy, they do not directly show the amino acid level precision or recall. To measure the amino acid level precision and recall, the top scoring reconstruction was generated per spectrum for each tool (i.e. <italic>N</italic> = 1). For this experiment, MS-GFDB was not tested, and the reconstructions of PEAKS were not converted using the local confidence. From the generated reconstructions, the number of (predicted) fragmentation sites and the number of correct fragmentation sites are counted. Also, since the spectra are annotated, we can count the number of all fragmentation sites in test sets. The precision and recall are defined by
<disp-formula id="btt338-M3"><label>(4)</label><graphic xlink:href="btt338m3"/></disp-formula>
<disp-formula id="btt338-M4"><label>(5)</label><graphic xlink:href="btt338m4"/></disp-formula>
</p>
      <p><xref ref-type="fig" rid="btt338-F4">Figure 4</xref> shows the precision and recall values of the tested tools for different datasets. For all datasets, UniNovo showed the highest precision value. But the recall values of UniNovo tended to be lower than others in particular for CID spectra. For ETD2 and ETDL4 datasets, UniNovo had higher precision and recall than PEAKS. These observations are consistent with the sequence level results above; higher precision of UniNovo resulted in more accurate reconstructions, and lower recall resulted in shorter reconstructions.
<fig id="btt338-F4" position="float"><label>Fig. 4.</label><caption><p>Comparison of <italic>de novo</italic> sequencing tools in terms of amino acid level precision (<bold>a</bold>) and recall (<bold>b</bold>). The definitions of precision and recall are given in (4) and (5), respectively</p></caption><graphic xlink:href="btt338f4p"/></fig></p>
      <p>Both the sequence level and amino acid level results suggest that specific types of spectra are more suitable for <italic>de novo</italic> sequencing than others. For instance, in general, HCD spectra generated more accurate and longer reconstructions (or higher precision and recall in amino acid level) than ETD spectra. Further evaluation of the scoring function (i.e., spectrum graph) of UniNovo for different spectrum types is found in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S14</ext-link>, where we also compared the spectrum graphs from UniNovo, PepNovo and MS-GFDB for CID2 dataset.</p>
    </sec>
    <sec id="SEC3.3">
      <title>3.3 <italic>De novo</italic> sequencing of paired spectra</title>
      <p>UniNovo also can be used to sequence paired spectra (e.g. CID/ETD spectral pairs). Given multiple spectra from the same precursor ion, UniNovo first generates a spectrum graph from each of the spectra and next merges the spectrum graphs into a combined spectrum graph, on which the reconstructions are generated (refer to the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S5</ext-link> for the spectrum graph merging algorithm).</p>
      <p>To benchmark UniNovo in <italic>de novo</italic> sequencing of paired spectra, CID/ETD2 and CID/ETD3 datasets were analyzed by UniNovo. From CID/ETD2 dataset, two additional datasets were generated: CID/etd2 and cid/ETD2 datasets. CID/etd2 dataset was formed by taking only CID spectra, and cid/ETD2 dataset by taking only ETD spectra in CID/ETD2 dataset. CID/etd3 and cid/ETD3 datasets were generated similarly. For each dataset, we generated <inline-formula><inline-graphic xlink:href="btt338i81.jpg"/></inline-formula>, 5 and 20 top scoring reconstructions.</p>
      <p>The results are shown in <xref ref-type="fig" rid="btt338-F5">Figure 5</xref>. When precursor ions were doubly charged, the performance boost from the paired spectra was very modest. For <inline-formula><inline-graphic xlink:href="btt338i82.jpg"/></inline-formula> and 20, UniNovo reported 5% more correctly sequenced spectral pairs in CID/ETD2 datasets than in CID/etd2 dataset. The average length of correct reconstructions for CID/ETD2 dataset was slightly longer than for CID/etd2 dataset.
<fig id="btt338-F5" position="float"><label>Fig. 5.</label><caption><p><italic>De novo</italic> sequencing of paired spectra. CID/ETD spectral pairs were analyzed by UniNovo (in CID/ETD2 and CID/ETD3 datasets). To see if the spectral pairs are beneficial for <italic>de novo</italic> sequencing, CID/etd2 (cid/ETD2) dataset was generated from CID/ETD2 dataset by collecting only CID (ETD) spectra in CID/ETD2 dataset. Likewise, CID/etd3 and cid/ETD3 datasets were generated from CID/ETD3 dataset. (<bold>a</bold>) the number of correctly sequenced spectra (or spectral pairs), (<bold>b</bold>) the average length of correct reconstructions for each dataset. The spectral pairs resulted in more accurate and longer reconstructions, in particular for triply charged spectral pairs</p></caption><graphic xlink:href="btt338f5p"/></fig></p>
      <p>In contrast, for triply charged spectra, the use of paired spectra was highly beneficial for generating more accurate reconstructions. For example, when <italic>N</italic> = 1, UniNovo reported 100 and 50% more correctly sequenced spectral pairs in CID/ETD3 dataset than in CID/etd3 and cid/ETD3 datasets, respectively. The length of correct reconstructions typically increases by 1–2 amino acids by using the CID/ETD paired spectra.</p>
    </sec>
    <sec id="SEC3.4">
      <title>3.4 <italic>De novo</italic> sequencing with quality filtering</title>
      <p>Given a set of reconstructions generated from a spectrum, UniNovo estimates the probability that at least one reconstruction in the set is correct (i.e., a probability that the spectrum is correctly sequenced) based on the accuracies of reconstructions. The estimated probability is called the <italic>set accuracy</italic> (When multiple <italic>de novo</italic> reconstructions are reported, it is important to guarantee that one of them is correct.). Denote the set of reconstructions by <inline-formula><inline-graphic xlink:href="btt338i83.jpg"/></inline-formula>. If the events ‘<italic>r<sub>i</sub></italic> is correct’ for <inline-formula><inline-graphic xlink:href="btt338i84.jpg"/></inline-formula> are independent, the set accuracy is simply given by <inline-formula><inline-graphic xlink:href="btt338i85.jpg"/></inline-formula>. However, since the reconstructions are often similar to each other, the dependency between reconstructions should be taken into account. To model this dependency, we assume Markov property between the events ‘<italic>r<sub>i</sub></italic> is correct’ for <inline-formula><inline-graphic xlink:href="btt338i86.jpg"/></inline-formula> and compute the set accuracy. The derivation of the set accuracy is given in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S6</ext-link>.</p>
      <p>When the parameter <italic>N</italic> is set, one may want to choose <italic>N</italic> reconstructions with the highest accuracies to maximize the set accuracy. However, such a selection often results in a set of short reconstructions (because short reconstructions have relatively high accuracies). Since short reconstructions are not very useful in many cases (e.g. in follow-up homology searches), UniNovo uses a greedy algorithm to select long and accurate reconstructions. The inputs to the algorithm are the parameters <italic>SetAccuracyThreshold</italic> and <italic>N</italic>. The algorithm tries to form an output set of <italic>N</italic> reconstructions of set accuracy higher than <italic>SetAccuracyThreshold</italic> while maximizing the minimum length of the reconstructions (see the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btt338/-/DC1">Supplementary section S7</ext-link> for the description of the algorithm). If UniNovo fails to generate a set of <italic>N</italic> reconstructions with the set accuracy higher than <italic>SetAccuracyThreshold</italic>, it filters out the query spectrum.</p>
      <p>We set <inline-formula><inline-graphic xlink:href="btt338i87.jpg"/></inline-formula> and reanalyzed the datasets in <xref ref-type="table" rid="btt338-T1">Table 1</xref>. The maximum number of mass gaps per each reconstruction was set to 10. For each dataset, we measured the number of unfiltered spectra (termed <italic>qualified</italic> spectra) and the percentage of qualified spectra that were correctly sequenced (which is expected to be 80% since <inline-formula><inline-graphic xlink:href="btt338i88.jpg"/></inline-formula>). The average length of correct reconstructions was also measured.</p>
      <p>The results are given in <xref ref-type="fig" rid="btt338-F6">Figure 6</xref>. For all datasets, the number of qualified spectra increases sharply as the number of reconstructions <italic>N</italic> grows (<xref ref-type="fig" rid="btt338-F6">Fig. 6</xref>a). For example, UniNovo reported only few qualified spectra (&lt;5) from CIDA2 dataset when <italic>N</italic> = 1. When <italic>N</italic> = 20, it reported &gt;900 qualified spectra from the same dataset. In contrast to the dramatic changes in the number of qualified spectra, the percentage of qualified spectra that were correctly sequenced hardly changed across the datasets and the values of <italic>N</italic> (<xref ref-type="fig" rid="btt338-F6">Fig. 6</xref>b). As expected, the percentage was around 80% for all cases (including the datasets containing CID/ETD spectral pairs), which shows that the set accuracy reported by UniNovo is reliable. <xref ref-type="fig" rid="btt338-F6">Figure 6</xref>c shows the average length of correct reconstructions. As <italic>N</italic> decreases, the average length also decreases. This is because shorter reconstructions (with higher accuracies) are chosen by UniNovo when <italic>N</italic> is small to achieve high set accuracy.
<fig id="btt338-F6" position="float"><label>Fig. 6.</label><caption><p><italic>De novo</italic> sequencing with qualify filtering of spectra. Given a spectrum, if the parameter <italic>SetAccuracyThreshold</italic> is set, UniNovo attempts to achieve set accuracy (an estimated probability of the spectrum being correctly sequenced) exceeding <italic>SetAccuracyThreshold</italic>. If it fails to generate such a set, the spectrum is filtered out. An unfiltered spectrum is called a <italic>qualified spectrum</italic>. We set <inline-formula><inline-graphic xlink:href="btt338i89.jpg"/></inline-formula>. (<bold>a</bold>) the number of qualified spectrum, (<bold>b</bold>) the percentage of qualified spectra that were correctly sequenced, (<bold>c</bold>) the average length of correct reconstructions</p></caption><graphic xlink:href="btt338f6p"/></fig></p>
    </sec>
  </sec>
  <sec>
    <title>4 CONCLUSION</title>
    <p>We presented a universal <italic>de novo</italic> sequencing tool UniNovo that works well for various types of spectra. UniNovo can be easily trained for different types of spectra using only thousands of PSMs that typically can be obtained from a single MS/MS run. The experimental results show that UniNovo generates accurate and long <italic>de novo</italic> reconstructions from spectra of CID, ETD, HCD and CID/ETD fragmentation methods and spectra of trypsin, LysC or AspN digested peptides. We also showed that UniNovo is better than or comparable with other state of the art tools.</p>
    <p>As pointed out by <xref ref-type="bibr" rid="btt338-B26">Ma and Johnson (2011)</xref>, <italic>de novo</italic> sequences not only are valuable for the analysis of the novel peptides that are not present in proteome databases but also can facilitate the homology-based database searches. Since the reconstructions reported by UniNovo contain mass gaps representing the total mass of multiple amino acids [termed <italic>gapped peptides</italic> (<xref ref-type="bibr" rid="btt338-B29">Jeong <italic>et al.</italic>, 2011</xref>; <xref ref-type="bibr" rid="btt338-B23">Kim <italic>et </italic><italic>al.</italic>, 2009b</xref>)], MS-BPM algorithm (<xref ref-type="bibr" rid="btt338-B29">Ng <italic>et al.</italic>, 2011</xref>) can be used for fast exact or homology searches (UniNovo<inline-formula><inline-graphic xlink:href="btt338i90.jpg"/></inline-formula>MS-BPM). MS-BPM enables searches against a sequence database using gapped peptides as queries. Currently MS-BPM takes gapped peptides generated by MS-GappedDictionary (<xref ref-type="bibr" rid="btt338-B29">Jeong <italic>et al.</italic>, 2011</xref>) (MS-GappedDictionary<inline-formula><inline-graphic xlink:href="btt338i91.jpg"/></inline-formula>MS-BPM). However, the reconstructions from UniNovo are usually longer than those from MS-GappedDictionary (8–9 versus 5–6). Since the search time of MS-BPM strongly depends on the length of gapped peptides—the longer gapped peptides, the shorter search time—the running time of UniNovo<inline-formula><inline-graphic xlink:href="btt338i92.jpg"/></inline-formula>MS-BPM is smaller than MS-GappedDictionary<inline-formula><inline-graphic xlink:href="btt338i93.jpg"/></inline-formula>MS-BPM by an order of magnitude in a blind search against the IPI Human proteome database ver.3.87 (<xref ref-type="bibr" rid="btt338-B21">Kersey <italic>et al.</italic>, 2004</xref>) (data not shown).</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_29_16_1953__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btt338_SuppForBio.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <title>ACKNOWLEDGEMENT</title>
    <p>We are grateful to Albert Heck and Joshua Coon for making their spectral datasets available. We are also thankful to Ari Frank, Sunghee Woo and Nuno Bandeira for helpful discussion.</p>
    <p><italic>Funding</italic>: The research was supported by the <funding-source>National Center for Research Resources of NIH</funding-source> via grant <award-id>P-41-RR24851</award-id>.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </ack>
  <ref-list>
    <title>References</title>
    <ref id="btt338-B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bandeira</surname>
            <given-names>N</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multi-spectra peptide sequencing and its applications to multistage mass spectrometry</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>i416</fpage>
        <lpage>i423</lpage>
        <pub-id pub-id-type="pmid">18785330</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barton</surname>
            <given-names>SJ</given-names>
          </name>
          <name>
            <surname>Whittaker</surname>
            <given-names>JC</given-names>
          </name>
        </person-group>
        <article-title>Review of factors that influence the abundance of ions produced in a tandem mass spectrometer and statistical methods for discovering these factors</article-title>
        <source>Mass Spectrom. Rev.</source>
        <year>2009</year>
        <volume>28</volume>
        <fpage>177</fpage>
        <lpage>187</lpage>
        <pub-id pub-id-type="pmid">18680189</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bern</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Lookup peaks: a hybrid of <italic>de novo</italic> sequencing and database search for protein identification by tandem mass spectrometry</article-title>
        <source>Anal. Chem.</source>
        <year>2007</year>
        <volume>79</volume>
        <fpage>1393</fpage>
        <lpage>1400</lpage>
        <pub-id pub-id-type="pmid">17243770</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Breci</surname>
            <given-names>LA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cleavage n-terminal to proline: analysis of a database of peptide tandem mass spectra</article-title>
        <source>Anal. Chem.</source>
        <year>2003</year>
        <volume>75</volume>
        <fpage>1963</fpage>
        <lpage>1971</lpage>
        <pub-id pub-id-type="pmid">12720328</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A dynamic programming approach to <italic>de novo</italic> peptide sequencing via tandem mass spectrometry</article-title>
        <source>J. Comput. Biol.</source>
        <year>2001</year>
        <volume>8</volume>
        <fpage>325</fpage>
        <lpage>337</lpage>
        <pub-id pub-id-type="pmid">11535179</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chi</surname>
            <given-names>H</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>pNovo: <italic>de novo</italic> peptide sequencing and identification using HCD spectra</article-title>
        <source>J. Proteome Res.</source>
        <year>2010</year>
        <volume>9</volume>
        <fpage>2713</fpage>
        <lpage>2724</lpage>
        <pub-id pub-id-type="pmid">20329752</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dancik</surname>
            <given-names>V</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title><italic>De novo</italic> peptide sequencing via tandem mass spectrometry</article-title>
        <source>J. Comput. Biol.</source>
        <year>1999</year>
        <volume>6</volume>
        <fpage>327</fpage>
        <lpage>342</lpage>
        <pub-id pub-id-type="pmid">10582570</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B8">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Datta</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Bern</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Spectrum fusion: using multiple mass spectra for <italic>de novo</italic> peptide sequencing</article-title>
        <source>J. Comput. Biol.</source>
        <year>2009</year>
        <volume>16</volume>
        <fpage>1169</fpage>
        <lpage>1182</lpage>
        <pub-id pub-id-type="pmid">19645594</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B9">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Elias</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Gygi</surname>
            <given-names>SP</given-names>
          </name>
        </person-group>
        <article-title>Target-decoy search strategy for increased confidence in large-scale protein identifications by mass spectrometry</article-title>
        <source>Nat. Methods</source>
        <year>2007</year>
        <volume>4</volume>
        <fpage>207</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="pmid">17327847</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B10">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eng</surname>
            <given-names>JK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An approach to correlate tandem mass spectral data of peptides with amino acid sequences in a protein database</article-title>
        <source>J. Am. Soc. Mass Spectrom.</source>
        <year>1994</year>
        <volume>5</volume>
        <fpage>976</fpage>
        <lpage>989</lpage>
      </element-citation>
    </ref>
    <ref id="btt338-B11">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frank</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>A ranking-based scoring function for peptide-spectrum matches</article-title>
        <source>J. Proteome Res.</source>
        <year>2009</year>
        <volume>8</volume>
        <fpage>2241</fpage>
        <lpage>2252</lpage>
        <pub-id pub-id-type="pmid">19231891</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B12">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frank</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pevzner</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>PepNovo: <italic>de novo</italic> peptide sequencing via probabilistic network modeling</article-title>
        <source>Anal. Chem.</source>
        <year>2005</year>
        <volume>77</volume>
        <fpage>964</fpage>
        <lpage>973</lpage>
        <pub-id pub-id-type="pmid">15858974</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B13">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Frese</surname>
            <given-names>CK</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Improved peptide identification by targeted fragmentation using CID, HCD and ETD on an LTQ-Orbitrap velos</article-title>
        <source>J. Proteome Res.</source>
        <year>2011</year>
        <volume>10</volume>
        <fpage>2377</fpage>
        <lpage>2388</lpage>
        <pub-id pub-id-type="pmid">21413819</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B14">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>He</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>B</given-names>
          </name>
        </person-group>
        <article-title>ADEPTS: advanced peptide <italic>de novo</italic> sequencing with a pair of tandem mass spectra</article-title>
        <source>J. Bioinform. Comput. Biol.</source>
        <year>2010</year>
        <volume>8</volume>
        <fpage>981</fpage>
        <lpage>994</lpage>
        <pub-id pub-id-type="pmid">21121022</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B15">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Huang</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Statistical characterization of the charge state and residue dependence of low-energy CID peptide dissociation patterns</article-title>
        <source>Anal. Chem.</source>
        <year>2005</year>
        <volume>77</volume>
        <fpage>5800</fpage>
        <lpage>5813</lpage>
        <pub-id pub-id-type="pmid">16159109</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B16">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hunter</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>An upper bound for the probability of a union</article-title>
        <source>J. Appl. Probab.</source>
        <year>1976</year>
        <volume>13</volume>
        <fpage>597</fpage>
        <lpage>603</lpage>
      </element-citation>
    </ref>
    <ref id="btt338-B17">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jeong</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Gapped spectral dictionaries and their applications for database searches of tandem mass spectra</article-title>
        <source>Mol. Cell. Proteomics</source>
        <year>2011</year>
        <volume>10</volume>
        <comment>M110.002220</comment>
      </element-citation>
    </ref>
    <ref id="btt338-B18">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Johnson</surname>
            <given-names>RS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Novel fragmentation process of peptides by collision-induced decomposition in a tandem mass spectrometer: differentiation of leucine and isoleucine</article-title>
        <source>Anal. Chem.</source>
        <year>1987</year>
        <volume>59</volume>
        <fpage>2621</fpage>
        <lpage>2625</lpage>
        <pub-id pub-id-type="pmid">3688448</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B19">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Käll</surname>
            <given-names>L</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Semi-supervised learning for peptide identification from shotgun proteomics datasets</article-title>
        <source>Nat. Methods</source>
        <year>2007</year>
        <volume>4</volume>
        <fpage>923</fpage>
        <lpage>925</lpage>
        <pub-id pub-id-type="pmid">17952086</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B20">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Keller</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Empirical statistical model to estimate the accuracy of peptide identifications made by ms/ms and database search</article-title>
        <source>Anal. Chem.</source>
        <year>2002</year>
        <volume>74</volume>
        <fpage>5383</fpage>
        <lpage>92</lpage>
        <pub-id pub-id-type="pmid">12403597</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B21">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kersey</surname>
            <given-names>PJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The international protein index: an integrated database for proteomics experiments</article-title>
        <source>Proteomics</source>
        <year>2004</year>
        <volume>4</volume>
        <fpage>1985</fpage>
        <lpage>1988</lpage>
        <pub-id pub-id-type="pmid">15221759</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B22">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spectral dictionaries</article-title>
        <source>Mol. Cell. Proteomics</source>
        <year>2009a</year>
        <volume>8</volume>
        <fpage>53</fpage>
        <lpage>69</lpage>
        <pub-id pub-id-type="pmid">18703573</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B23">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Spectral profiles, a novel representation of tandem mass spectra and their applications for <italic>de novo</italic> peptide sequencing and identification</article-title>
        <source>Mol. Cell. Proteomics</source>
        <year>2009b</year>
        <volume>8</volume>
        <fpage>1391</fpage>
        <lpage>1400</lpage>
        <pub-id pub-id-type="pmid">19254948</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B24">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The generating function of CID, ETD, and CID/ETD pairs of tandem mass spectra: Applications to database search</article-title>
        <source>Mol. Cell. Proteomics</source>
        <year>2010</year>
        <volume>9</volume>
        <fpage>2840</fpage>
        <lpage>2852</lpage>
        <pub-id pub-id-type="pmid">20829449</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B25">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Better score function for peptide identification with ETD MS/MS spectra</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <issue>Suppl. 1</issue>
        <fpage>S4</fpage>
        <pub-id pub-id-type="pmid">20122213</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B26">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title><italic>De novo</italic> sequencing and homology searching</article-title>
        <source>Mol. Cell. Proteomics</source>
        <year>2011</year>
        <comment>O111.014902</comment>
      </element-citation>
    </ref>
    <ref id="btt338-B27">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ma</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PEAKS: powerful software for peptide <italic>de novo</italic> sequencing by tandem mass spectrometry</article-title>
        <source>Rapid Commun. Mass Spectrom.</source>
        <year>2003</year>
        <volume>17</volume>
        <fpage>2337</fpage>
        <lpage>2342</lpage>
        <pub-id pub-id-type="pmid">14558135</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B28">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nesvizhskii</surname>
            <given-names>AI</given-names>
          </name>
        </person-group>
        <article-title>A survey of computational methods and error rate estimation procedures for peptide and protein identification in shotgun proteomics</article-title>
        <source>J. Proteomics</source>
        <year>2010</year>
        <volume>73</volume>
        <fpage>2092</fpage>
        <lpage>123</lpage>
        <pub-id pub-id-type="pmid">20816881</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B29">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ng</surname>
            <given-names>J</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Blocked pattern matching problem and its applications in proteomics</article-title>
        <source>RECOMB 2011</source>
        <year>2011</year>
        <comment>Vancouver, Canada, pp. 298–319</comment>
      </element-citation>
    </ref>
    <ref id="btt338-B30">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Olsen</surname>
            <given-names>JV</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Higher-energy c-trap dissociation for peptide modification analysis</article-title>
        <source>Nat. Methods</source>
        <year>2007</year>
        <volume>4</volume>
        <fpage>709</fpage>
        <lpage>712</lpage>
        <pub-id pub-id-type="pmid">17721543</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B31">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Perkins</surname>
            <given-names>DN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Probability-based protein identification by searching sequence databases using mass spectrometry data</article-title>
        <source>Electrophoresis</source>
        <year>1999</year>
        <volume>20</volume>
        <fpage>3551</fpage>
        <lpage>3567</lpage>
        <pub-id pub-id-type="pmid">10612281</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B32">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Savitski</surname>
            <given-names>MM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Proteomics-Grade <italic>de novo</italic> sequencing approach</article-title>
        <source>J. Proteome Res.</source>
        <year>2005</year>
        <volume>4</volume>
        <fpage>2348</fpage>
        <lpage>2354</lpage>
        <pub-id pub-id-type="pmid">16335984</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B33">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Swaney</surname>
            <given-names>DL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Decision tree-driven tandem mass spectrometry for shotgun proteomics</article-title>
        <source>Nat. Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <fpage>959</fpage>
        <lpage>964</lpage>
        <pub-id pub-id-type="pmid">18931669</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B34">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Swaney</surname>
            <given-names>DL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Value of using multiple proteases for Large-Scale mass Spectrometry-Based proteomics</article-title>
        <source>J. Proteome Res.</source>
        <year>2010</year>
        <volume>9</volume>
        <fpage>1323</fpage>
        <lpage>1329</lpage>
        <pub-id pub-id-type="pmid">20113005</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B35">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tabb</surname>
            <given-names>DL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Influence of basic residue content on fragment ion peak intensities in Low-Energy Collision-Induced dissociation spectra of peptides</article-title>
        <source>Anal. Chem.</source>
        <year>2004</year>
        <volume>76</volume>
        <fpage>1243</fpage>
        <lpage>1248</lpage>
        <pub-id pub-id-type="pmid">14987077</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B36">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wysocki</surname>
            <given-names>VH</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mobile and localized protons: a framework for understanding peptide dissociation</article-title>
        <source>J. Mass Spectrom.</source>
        <year>2000</year>
        <volume>35</volume>
        <fpage>1399</fpage>
        <lpage>1406</lpage>
        <pub-id pub-id-type="pmid">11180630</pub-id>
      </element-citation>
    </ref>
    <ref id="btt338-B37">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zubarev</surname>
            <given-names>RA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Electron Capture/Transfer versus collisionally Activated/Induced dissociations: Solo or duet? <italic>J</italic></article-title>
        <source>Am. Soc. Mass Spectrom.</source>
        <year>2008</year>
        <volume>19</volume>
        <fpage>753</fpage>
        <lpage>761</lpage>
      </element-citation>
    </ref>
  </ref-list>
</back>
