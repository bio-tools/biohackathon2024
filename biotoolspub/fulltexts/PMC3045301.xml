<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3045301</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-12-39</article-id>
    <article-id pub-id-type="pmid">21281468</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-12-39</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>ChIPseqR: analysis of ChIP-seq experiments</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes" id="A1">
        <name>
          <surname>Humburg</surname>
          <given-names>Peter</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <xref ref-type="aff" rid="I4">4</xref>
        <email>peter.humburg@well.ox.ac.uk</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Helliwell</surname>
          <given-names>Chris A</given-names>
        </name>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>chris.helliwell@csiro.au</email>
      </contrib>
      <contrib contrib-type="author" id="A3">
        <name>
          <surname>Bulger</surname>
          <given-names>David</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>david.bulger@mq.edu.au</email>
      </contrib>
      <contrib contrib-type="author" id="A4">
        <name>
          <surname>Stone</surname>
          <given-names>Glenn</given-names>
        </name>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>glenn.stone@csiro.au</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Statistics, Macquarie University, North Ryde, NSW 2109, Australia</aff>
    <aff id="I2"><label>2</label>CSIRO Mathematical and Information Sciences, North Ryde, NSW 2113, Australia</aff>
    <aff id="I3"><label>3</label>CSIRO Plant Industry, GPO Box 1600, Canberra 2601, Australia</aff>
    <aff id="I4"><label>4</label>The Wellcome Trust Centre for Human Genetics, Oxford OX3 7BN, UK</aff>
    <pub-date pub-type="collection">
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>31</day>
      <month>1</month>
      <year>2011</year>
    </pub-date>
    <volume>12</volume>
    <fpage>39</fpage>
    <lpage>39</lpage>
    <history>
      <date date-type="received">
        <day>3</day>
        <month>1</month>
        <year>2010</year>
      </date>
      <date date-type="accepted">
        <day>31</day>
        <month>1</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2011 Humburg et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <copyright-holder>Humburg et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/12/39"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>The use of high-throughput sequencing in combination with chromatin immunoprecipitation (ChIP-seq) has enabled the study of genome-wide protein binding at high resolution. While the amount of data generated from such experiments is steadily increasing, the methods available for their analysis remain limited. Although several algorithms for the analysis of ChIP-seq data have been published they focus almost exclusively on transcription factor studies and are usually not well suited for the analysis of other types of experiments.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Here we present ChIPseqR, an algorithm for the analysis of nucleosome positioning and histone modification ChIP-seq experiments. The performance of this novel method is studied on short read sequencing data of <italic>Arabidopsis thaliana </italic>mononucleosomes as well as on simulated data.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>ChIPseqR is shown to improve sensitivity and spatial resolution over existing methods while maintaining high specificity. Further analysis of predicted nucleosomes reveals characteristic patterns in nucleosome sequences and placement.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>The recent advent of high-throughput sequencing technologies has enabled genome-wide studies of DNA-binding proteins at high resolution. In such studies the protein of interest is isolated together with a fragment of bound DNA, which is then separated from the protein and sequenced. This approach has been used to investigate several different proteins including the positioning of nucleosomes [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B4">4</xref>]. For this type of experiment DNA is typically digested with micrococcal nuclease (MNase) before isolating nucleosome-sized DNA fragments (~150 bp) that are then sequenced. This is the application considered here. Each nucleosome is expected to produce several sequence reads of approximately 35 - 100 bp from both strands. This leads to peaks in read density on either side of the nucleosome with the extent of the peaks and the distance between the two peaks determined by the length of DNA fragments and binding site. Since the DNA fragments produced by an MNase digest of nucleosomes are selected to be similar in length to the actual binding site the resulting peaks in read counts are expected to be relatively narrow and peaks on forward and reverse strand should be separated by a region that corresponds approximately to the nucleosome bound DNA. This region is expected to be depleted of sequence reads (Figure <xref ref-type="fig" rid="F1">1</xref>). However, the distance between adjacent nucleosomes is usually short (~30 - 60 bp) and this may lead to overlap between peaks. When analysed at low resolution this can lead to the detection of extended enriched regions rather than individual nucleosomes.</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p><bold>Nucleosome model</bold>. Schematic representation of a nucleosome (top) and corresponding binding site model (bottom). The signature of a protein binding event with high read density upstream and downstream of the binding site is partitioned into three regions. The support regions on the forward and reverse strand are flanking the binding region, capturing the peak in read density on the respective strand.</p>
      </caption>
      <graphic xlink:href="1471-2105-12-39-1"/>
    </fig>
    <p>In a related type of experiment a subset of nucleosomes is targeted through chromatin immunoprecipitation (ChIP) followed by high-throughput sequencing of ChIP fragments [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B6">6</xref>]. This technique, commonly known as ChIP-seq, has also been used to investigate the binding of transcription factors [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B8">8</xref>]. Due to the relatively short binding site of most transcription factors these studies typically produce wider, relatively isolated peaks in read counts compared to those obtained from nucleosome sequencing.</p>
    <p>The increasing number of ChIP-seq and nucleosome positioning studies has led to the development of various approaches to analyse these data. The analysis typically starts by mapping short sequence reads to a reference genome, ignoring reads with non-unique alignments. To identify protein binding sites from these mapped reads, many commonly used methods generate a strand-independent profile of windowed read counts by recording the total number of reads on both strands that fall into a sliding window, or alternatively the number of overlapping extended reads for each position in the genome [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B7">7</xref>-<xref ref-type="bibr" rid="B11">11</xref>]. In both cases the height of the read count profile corresponds to the total number of reads in the window, irrespective of strand. The read extension method implicitly uses separate windows for the two strands, combining the sequence reads in both windows into a single read count. Explicitly using two distinct windows to construct the read count profile allows for the inclusion of information about the length of the protein binding site [<xref ref-type="bibr" rid="B4">4</xref>]. Peaks in the resulting read count profile are usually assessed for significance based on total read counts compared to a control sample [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B9">9</xref>], background model [<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B10">10</xref>] or permutation of observed read counts [<xref ref-type="bibr" rid="B5">5</xref>]. The use of hidden Markov models (HMMs) [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B11">11</xref>] and kernel density estimators [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B13">13</xref>] has been suggested as an alternative way to identify significant peaks in the read count profile. Although this strand-independent approach to ChIP-seq analysis has been used frequently with apparent success, it ignores the fact that DNA binding proteins are expected to generate a similar number of reads on both strands adjacent to the binding site.</p>
    <p>The need for a new approach to ChIP-seq analysis that incorporates the characteristics of protein binding sites has been recognised and has led to the development of new strand-specific methods. Kharchenko <italic>et al</italic>. [<xref ref-type="bibr" rid="B14">14</xref>] suggest three different approaches to utilise strand-specific read counts that outperform established strand-independent methods [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B8">8</xref>]. The SISSRs algorithm of Jothi <italic>et al</italic>. [<xref ref-type="bibr" rid="B15">15</xref>] considers the difference of read counts on both strands in a sliding window and locates potential protein binding sites by identifying sign changes in this net read count. Although these methods were developed with transcription factor analysis in mind, the methods presented in [<xref ref-type="bibr" rid="B14">14</xref>] are general enough to be extended to a nucleosome related analysis. The SISSRs algorithm assumes that binding sites are isolated, i.e., peaks from neighbouring binding sites do not overlap. This is unlikely to be true for nucleosomes since they are expected to be located close to each other, which restricts SISSRs to the detection of extended regions of enrichment. This makes SISSRs unsuitable for the identification of individual nucleosome positions. A similar issue arises with the method proposed by Zang <italic>et al</italic>. [<xref ref-type="bibr" rid="B16">16</xref>]. Although their method was specifically designed to identify histone modifications from ChIP-seq data it focuses on the detection of broad regions of enrichment rather than individual nucleosome positions. Spyrou <italic>et al</italic>. [<xref ref-type="bibr" rid="B17">17</xref>] propose a strand specific HMM analysis of ChIP-seq experiments and demonstrate its utility on transcription factor and histone modification data. Although Spyrou <italic>et al</italic>. make a deliberate effort to obtain results at high resolution the HMM framework limits the resolution that can be achieved by this method, which may be insufficient to distinguish between adjacent nucleosomes.</p>
    <p>When sequencing nucleosomal DNA, either to determine nucleosome positioning or to identify specific histone modifications, it is important to realise that the binding site is substantially longer than for a typical transcription factor. While it may be acceptable to ignore the expected gap between peaks on forward and reverse strands when the binding site is small compared to the window used, as is often the case for transcription factor binding sites, this is not necessarily true for nucleosomes. Some studies choose the size of the sliding window to be the average DNA fragment length [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B9">9</xref>] while others choose a smaller window of 100 bp [<xref ref-type="bibr" rid="B7">7</xref>,<xref ref-type="bibr" rid="B10">10</xref>]. It should be noted that these window sizes are substantially larger than the transcription factor binding sites in question, but similar in length to or shorter than nucleosome-bound DNA. The use of 1 kb windows [<xref ref-type="bibr" rid="B5">5</xref>,<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B11">11</xref>] or even 1 Mb windows [<xref ref-type="bibr" rid="B9">9</xref>] has been suggested. Although the increased window size alleviates the need to model the length of binding sites explicitly, it also leads to a notable decrease in resolution.</p>
    <p>To locate nucleosomes at high resolution we propose to use an explicit model of protein binding site characteristics and of the resulting read patterns. This requires the model to be adjusted to the details of the experiment under consideration. In particular the impact of changes to the protocol used to isolate and purify nucleosomes has to be considered carefully. We demonstrate our approach to the high resolution analysis of ChIP-seq experiments by introducing ChIPseqR, an algorithm designed for the identification of nucleosomes. This method provides a number of parameters that allow it to be adjusted to different types of experiments but here we focus on the analysis of end-sequenced mononucleosomes after digestion with MNase. ChIPseqR is applied to simulated data on which it is shown to identify nucleosomes at high resolution while achieving better sensitivity and specificity than alternative methods. The favourable performance of ChIPseqR is confirmed through the application to end-sequenced mononucleosomes.</p>
  </sec>
  <sec>
    <title>Results</title>
    <sec>
      <title>Algorithm</title>
      <sec>
        <title>Background distribution of sequence reads</title>
        <p>To reliably identify nucleosome positions it is necessary to model the read counts associated with a binding event as well as read counts in the absence of protein binding. A frequently used assumption is that background sequence reads, which are unrelated to binding events, are independently and uniformly distributed throughout the genome [<xref ref-type="bibr" rid="B4">4</xref>,<xref ref-type="bibr" rid="B8">8</xref>,<xref ref-type="bibr" rid="B15">15</xref>]. This implies that the number of these background reads <italic>X</italic><sub>bg </sub>starting at each position of the genome follows a Poisson distribution with constant rate parameter <italic>λ</italic>. Examination of the read density in negative control samples suggests a heterogeneous distribution of background reads [<xref ref-type="bibr" rid="B14">14</xref>]. To allow for this heterogeneity the use of a background model that incorporates changes in read density by assuming that λ follows a gamma distribution has been suggested by Ji <italic>et al</italic>. [<xref ref-type="bibr" rid="B10">10</xref>].</p>
        <p>Here we propose a different approach to address this problem. Instead of estimating the background read density for the entire genome at once we estimate the local background read density in a window of width 2<italic>w</italic><sub>bg </sub>+ 1. Consider <italic>Y</italic><sub>bg</sub>(<italic>i</italic>) ~ Poisson(Λ<sub>bg</sub>(<italic>i</italic>)), the number of reads starting at position <italic>i</italic>. Then the number of background reads in a window centred at position <italic>i </italic>is</p>
        <p>
          <disp-formula id="bmcM1">
            <label>(1)</label>
            <mml:math id="M1" name="1471-2105-12-39-i1" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>X</mml:mi>
                  <mml:mrow>
                    <mml:mtext>bg</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munderover>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>j</mml:mi>
                      <mml:mo>=</mml:mo>
                      <mml:mi>i</mml:mi>
                      <mml:mo>−</mml:mo>
                      <mml:msub>
                        <mml:mi>w</mml:mi>
                        <mml:mrow>
                          <mml:mtext>bg</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>w</mml:mi>
                        <mml:mrow>
                          <mml:mtext>bg</mml:mtext>
                        </mml:mrow>
                      </mml:msub>
                    </mml:mrow>
                  </mml:munderover>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>Y</mml:mi>
                      <mml:mrow>
                        <mml:mtext>bg</mml:mtext>
                      </mml:mrow>
                    </mml:msub>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>~</mml:mo>
                <mml:mtext> </mml:mtext>
                <mml:mtext>Poisson</mml:mtext>
                <mml:mtext> </mml:mtext>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:msub>
                  <mml:mi>λ</mml:mi>
                  <mml:mrow>
                    <mml:mtext>bg</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo stretchy="false">)</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>with <inline-formula><mml:math id="M2" name="1471-2105-12-39-i2" overflow="scroll"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mo>Λ</mml:mo><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> For each position <italic>i </italic>the strand specific local background rate can be estimated as <inline-formula><mml:math id="M3" name="1471-2105-12-39-i3" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where <italic>x</italic><sub>bg</sub>(<italic>i</italic>) is the observed number of sequence reads in window <italic>i </italic>on the relevant strand. This background model adapts to locally observed read densities without imposing a distribution on <italic>λ</italic>.</p>
        <p>Confirming the observations made by Kharchenko <italic>et al</italic>. [<xref ref-type="bibr" rid="B14">14</xref>] we find that the background read density includes large peaks that are seemingly unrelated to the presence of nucleosomes. While the background estimation procedure described above adapts to changes in the background rate, the presence of large isolated peaks will lead to overestimation of the read rate for the surrounding area. A robust estimate of the background read rate is obtained by limiting the change in read rates between adjacent, non-overlapping, windows. If <inline-formula><mml:math id="M4" name="1471-2105-12-39-i4" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is positive we choose the robust estimate <inline-formula><mml:math id="M5" name="1471-2105-12-39-i5" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> as the largest value <italic>j </italic>such that <inline-formula><mml:math id="M6" name="1471-2105-12-39-i6" overflow="scroll"><mml:mrow><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M7" name="1471-2105-12-39-i7" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>≤</mml:mo><mml:mi>γ</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> for an appropriately chosen probability λ.</p>
      </sec>
      <sec>
        <title>Nucleosome model</title>
        <p>A nucleosome will produce several DNA fragments in the sample. During the sequencing process short reads are produced from the 5'-ends of both strands of the DNA fragment population. The start position of sequence reads generated from this population corresponds to the start and end positions of DNA fragments in the reference genome. Although these may vary due to differences in fragment length and relative position of the nucleosome within the fragment, all read start sites will be located in proximity to the nucleosome but not within the strech of histone bound DNA itself. This leads to a region of increased read density on the forward strand upstream of the nucleosome which is mirrored by a region of increased read density on the reverse strand downstream of the nucleosome. The nucleosome, located between the two peaks in read density, is relatively depleted of sequence reads. This creates a distinctive pattern that can be partitioned into three regions: forward support (fwd), binding (bind) and reverse support (rev) region (Figure <xref ref-type="fig" rid="F1">1</xref>). Note that the forward and reverse support regions only cover the respective strand, allowing for overlapping peaks from neighbouring binding sites.</p>
        <p>Consider a binding site of length <italic>b </italic>= 2<italic>w</italic><sub>bind </sub>+ 1 starting at position <italic>i </italic>containing <italic>X</italic><sub>bind</sub>(<italic>i</italic>) sequence reads from both strands, a support region on the forward strand of length <italic>s </italic>= 2<italic>w</italic><sub>sup </sub>+ 1 starting at position <italic>i </italic>- <italic>s </italic>containing <italic>X</italic><sub>fwd</sub>(<italic>i</italic>) forward strand reads and a support region on the reverse strand of the same length starting at position <italic>i </italic>+ <italic>b </italic>containing <italic>X</italic><sub>rev</sub>(<italic>i</italic>) reverse strand reads. Here we assume that the read counts in these regions follow Poisson distributions, i.e., <italic>X</italic><sub>region</sub>(<italic>i</italic>) ~ Poisson(λ<sub>region</sub>(<italic>i</italic>)), where <italic>region </italic>is one of <italic>fwd</italic>, <italic>bind </italic>or <italic>rev</italic>. Using the same assumptions as for the background distribution we consider <italic>X</italic><sub>region</sub>(<italic>i</italic>) to be the sum of <italic>w</italic><sub>region </sub>random variables <italic>Y</italic><sub>region </sub>(<italic>j</italic>) ~ Poisson(Λ<sub>region </sub>(<italic>i</italic>)).</p>
      </sec>
      <sec>
        <title>Scoring potential nucleosome positions</title>
        <p>If a nucleosome is starting at position <italic>i </italic>the following three relations should hold: λ<sub>fwd</sub>(<italic>i</italic>) &gt; λ<sub>bg</sub>(<italic>i</italic>), λ<sub>bind</sub>(<italic>i</italic>) &lt; λ<sub>bg</sub>(<italic>i</italic>), λ<sub>rev</sub>(<italic>i</italic>) &gt; λ<sub>bg</sub>(<italic>i</italic>). We assess these relations for each potential nucleosome position based on a likelihood ratio statistic, <italic>W</italic><sub>region</sub>. This statistic is computed for each of the three regions of the potential nucleosome position, comparing the estimated read rate in the region to the estimated local background rate (see Methods). If a nucleosome starts at position <italic>i </italic>one would expect λ<sub>fwd</sub>(<italic>i</italic>) and λ<sub>rev</sub>(<italic>i</italic>) to be equal. To account for this and to avoid inflated values of <italic>W</italic><sub>fwd </sub>in cases where a peak in read density in the forward support region is not matched by a comparable peak in the reverse support region, we use the truncated estimate</p>
        <p>
          <disp-formula id="bmcM2">
            <label>(2)</label>
            <mml:math id="M8" name="1471-2105-12-39-i8" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>λ</mml:mi>
                    <mml:mo>˜</mml:mo>
                  </mml:mover>
                  <mml:mrow>
                    <mml:mtext>fwd</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mi>max</mml:mi>
                <mml:mo>{</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo>:</mml:mo>
                <mml:mn>0</mml:mn>
                <mml:mo> &lt;</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo>≤</mml:mo>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>λ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mrow>
                    <mml:mtext>fwd</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mtext> </mml:mtext>
                <mml:mtext>and</mml:mtext>
                <mml:mtext> </mml:mtext>
                <mml:mi>P</mml:mi>
                <mml:mo stretchy="false">[</mml:mo>
                <mml:msub>
                  <mml:mi>X</mml:mi>
                  <mml:mrow>
                    <mml:mtext>fwd</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>≤</mml:mo>
                <mml:mi>j</mml:mi>
                <mml:mo stretchy="false">|</mml:mo>
                <mml:msub>
                  <mml:mi>λ</mml:mi>
                  <mml:mrow>
                    <mml:mtext>fwd</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mover accent="true">
                    <mml:mi>λ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mrow>
                    <mml:mtext>rev</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">]</mml:mo>
                <mml:mo>≤</mml:mo>
                <mml:mi>γ</mml:mi>
                <mml:mo>}</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>for a suitably chosen γ to calculate <italic>W</italic><sub>fwd</sub>. The truncated estimate <inline-formula><mml:math id="M9" name="1471-2105-12-39-i9" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mtext>rev</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> is defined similarly.</p>
        <p>For each of the three regions a score <italic>S</italic><sub>region </sub>is calculated. For the two support regions the score <italic>S</italic><sub>sup</sub>, sup ∈ {fwd, rev}, is defined as</p>
        <p>
          <disp-formula id="bmcM3">
            <label>(3)</label>
            <mml:math id="M10" name="1471-2105-12-39-i10" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>S</mml:mi>
                  <mml:mrow>
                    <mml:mi>sup</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mtable columnalign="right">
                      <mml:mtr columnalign="right">
                        <mml:mtd columnalign="right">
                          <mml:mrow>
                            <mml:mo>+</mml:mo>
                            <mml:msqrt>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>W</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>sup</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msqrt>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd columnalign="right">
                          <mml:mrow>
                            <mml:mtext>if</mml:mtext>
                            <mml:mtext> </mml:mtext>
                            <mml:msub>
                              <mml:mover accent="true">
                                <mml:mi>λ</mml:mi>
                                <mml:mo>˜</mml:mo>
                              </mml:mover>
                              <mml:mrow>
                                <mml:mi>sup</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>&gt;</mml:mo>
                            <mml:msub>
                              <mml:mover accent="true">
                                <mml:mi>λ</mml:mi>
                                <mml:mo>˜</mml:mo>
                              </mml:mover>
                              <mml:mrow>
                                <mml:mtext>bg</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr columnalign="right">
                        <mml:mtd columnalign="right">
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:msqrt>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>W</mml:mi>
                                  <mml:mrow>
                                    <mml:mi>sup</mml:mi>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msqrt>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd columnalign="right">
                          <mml:mrow>
                            <mml:mtext>otherwise</mml:mtext>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>and for the binding region as</p>
        <p>
          <disp-formula id="bmcM4">
            <label>(4)</label>
            <mml:math id="M11" name="1471-2105-12-39-i11" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>S</mml:mi>
                  <mml:mrow>
                    <mml:mtext>bind</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mrow>
                  <mml:mo>{</mml:mo>
                  <mml:mrow>
                    <mml:mtable columnalign="right">
                      <mml:mtr columnalign="right">
                        <mml:mtd columnalign="right">
                          <mml:mrow>
                            <mml:mo>−</mml:mo>
                            <mml:msqrt>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>W</mml:mi>
                                  <mml:mrow>
                                    <mml:mtext>bind</mml:mtext>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msqrt>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd columnalign="right">
                          <mml:mrow>
                            <mml:mtext>if </mml:mtext>
                            <mml:msub>
                              <mml:mover accent="true">
                                <mml:mi>λ</mml:mi>
                                <mml:mo>^</mml:mo>
                              </mml:mover>
                              <mml:mrow>
                                <mml:mtext>bind</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mtext> </mml:mtext>
                            <mml:mo>&gt;</mml:mo>
                            <mml:msub>
                              <mml:mover accent="true">
                                <mml:mi>λ</mml:mi>
                                <mml:mo>˜</mml:mo>
                              </mml:mover>
                              <mml:mrow>
                                <mml:mtext>bg</mml:mtext>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr columnalign="right">
                        <mml:mtd columnalign="right">
                          <mml:mrow>
                            <mml:mo>+</mml:mo>
                            <mml:msqrt>
                              <mml:mrow>
                                <mml:msub>
                                  <mml:mi>W</mml:mi>
                                  <mml:mrow>
                                    <mml:mtext>bind</mml:mtext>
                                  </mml:mrow>
                                </mml:msub>
                              </mml:mrow>
                            </mml:msqrt>
                            <mml:mo>,</mml:mo>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd columnalign="right">
                          <mml:mrow>
                            <mml:mtext>otherwise</mml:mtext>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                </mml:mrow>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>The three region scores for each potential nucleosome are combined into a single nucleosome score</p>
        <p>
          <disp-formula id="bmcM5">
            <label>(5)</label>
            <mml:math id="M12" name="1471-2105-12-39-i12" overflow="scroll">
              <mml:mrow>
                <mml:mi>S</mml:mi>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>=</mml:mo>
                <mml:msub>
                  <mml:mi>S</mml:mi>
                  <mml:mrow>
                    <mml:mtext>fwd</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mi>S</mml:mi>
                  <mml:mrow>
                    <mml:mtext>bind</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>+</mml:mo>
                <mml:msub>
                  <mml:mi>S</mml:mi>
                  <mml:mrow>
                    <mml:mtext>rev</mml:mtext>
                  </mml:mrow>
                </mml:msub>
                <mml:mo stretchy="false">(</mml:mo>
                <mml:mi>i</mml:mi>
                <mml:mo stretchy="false">)</mml:mo>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>Note that this score is only meaningful if there is at least one read in each of the two support regions and <inline-formula><mml:math id="M13" name="1471-2105-12-39-i13" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mtext>bg</mml:mtext></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula>.</p>
      </sec>
      <sec>
        <title>Significance test</title>
        <p>To assess the significance of nucleosome scores the distribution of <italic>S </italic>under the null hypothesis that no nucleosome starts at position <italic>i </italic>has to be determined. The nucleosome score for each position in the genome is the sum of the scores for the three regions of the potential nucleosome position (Equation (5)) and the score for each region is derived from the likelihood ratio statistic <italic>W</italic><sub>region </sub>(Equations (3) and (4)). If the null hypothesis is true <inline-formula><mml:math id="M14" name="1471-2105-12-39-i14" overflow="scroll"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mtext>region</mml:mtext></mml:mrow></mml:msub><mml:mover accent="true"><mml:mo>~</mml:mo><mml:mo>˙</mml:mo></mml:mover><mml:msubsup><mml:mi>χ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mtext> </mml:mtext><mml:mtext>and</mml:mtext><mml:mtext> </mml:mtext><mml:mtext>thus</mml:mtext><mml:mtext> </mml:mtext><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mtext>region</mml:mtext></mml:mrow></mml:msub><mml:mover accent="true"><mml:mo>~</mml:mo><mml:mo>˙</mml:mo></mml:mover><mml:mtext>N</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>O</mml:mtext><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula> This might suggest the use of <inline-formula><mml:math id="M15" name="1471-2105-12-39-i15" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mo>∼</mml:mo><mml:mtext>N</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mtext>0</mml:mtext><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msqrt><mml:mn>3</mml:mn></mml:msqrt><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> to model the distribution of binding site scores under the null hypothesis. However, it is important to realise that, even under the null hypothesis, <italic>S</italic><sub>fwd </sub>and <italic>S</italic><sub>rev </sub>are unlikely to be independent due to the use of truncated rate parameter estimates, and the asymptotic results may not hold. To avoid misleading <italic>p</italic>-values that may result from the use of an incorrectly specified null distribution we generalize the above model to <inline-formula><mml:math id="M16" name="1471-2105-12-39-i16" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi><mml:mo>~</mml:mo><mml:mtext>N</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>σ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math></inline-formula> where <inline-formula><mml:math id="M17" name="1471-2105-12-39-i17" overflow="scroll"><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula> is the sample median of the nucleosome scores and σ is estimated from the observed nucleosome scores. To obtain a good fit for the null distribution, and thus reliable <italic>p</italic>-values, it is necessary to identify a subset of scores that is representative of the null hypothesis.</p>
        <p>Observing that the presence of nucleosomes will lead to larger nucleosome scores we truncate <italic>S </italic>at the τ<sup>th </sup>and 50<sup>th </sup>percentile, where 0 ≤ τ &lt; 50 is chosen to exclude outliers in the lower tail while retaining a sufficiently large number of observations. This ensures that the vast majority of scores relating to protein binding events have no influence on the parameter estimation while also guarding against extreme values in the lower tail, which are observed when calculating nucleosome scores for positions that place unusually large numbers of sequence reads in the binding region. A maximum likelihood estimate for σ is obtained by fitting a truncated half-normal distribution to the selected subset of nucleosome scores.</p>
        <p>The <italic>p</italic>-values for all observed nucleosome scores are calculated based on the estimated null distribution and corrected for multiple testing. To control the false discovery rate (FDR) we use a Benjamini-Hochberg procedure [<xref ref-type="bibr" rid="B18">18</xref>]. If the data contain many nucleosomes it may be beneficial to modify this procedure to account for the estimated proportion of true null hypotheses. This is done using the αAFDR approach discussed in [<xref ref-type="bibr" rid="B19">19</xref>], where it is shown to be equivalent to the procedure proposed by Storey <italic>et al</italic>. [<xref ref-type="bibr" rid="B20">20</xref>].</p>
      </sec>
    </sec>
    <sec>
      <title>Testing</title>
      <p>To assess the performance of our method we compared it to a number of other peak-finding methods on simulated data. The three methods presented in [<xref ref-type="bibr" rid="B14">14</xref>], mirror strand peaks (MSP), mirror tag correlation (MTC) and window tag density (WTD), were chosen for comparison because they allow for strand specific peaks in read counts and employ different strategies to handle the expected gap between peaks. Briefly, WTD calculates a binding score based on the number of forward and reverse strand tags within a window upstream and downstream of a potential binding site. While this utilises the fact that a protein binding event should produce a peak in forward strand read counts upstream and a peak in reverse strand read counts downstream of the binding site, WTD does not require the two peaks to be similar in magnitude nor is the gap between peaks considered. MTC is similar to WTD but uses the correlation between forward strand and reverse strand reads to introduce a measure of similarity between the two peaks. Sequence reads close to the centre of the binding site are ignored when calculating the correlation coefficient which effectively introduces a gap between the two peaks. A Gaussian smoothing kernel is used by MSP to estimate local read densities for both strands and binding sites are required to lie between peaks of comparable magnitude. The R implementation of these methods provides the option to estimate the window size from the cross-correlation between the two strands. We found that this does not produce satisfactory results for the nucleosome data under consideration and used a 160 bp window instead. Unlike the methods proposed by Kharchenko <italic>et al</italic>. GeneTrack [<xref ref-type="bibr" rid="B13">13</xref>] was specifically designed for the detection of nucleosome positions. Like MSP, GeneTrack uses a Gaussian kernel to smooth read counts. The algorithm then proceeds to score each peak based on its height and reports the highest scoring set of non-overlapping peaks. GeneTrack makes no attempt to assess the significance of peaks, which results in a high number of nucleosome predictions but is likely to lead to many false positives if the data contains regions that are depleted of nucleosomes. To fairly evaluate GeneTrack's performance relative to methods that control the false discovery rate we choose a cut-off that leads to a similar number of significant predictions as the one produced by ChIPseqR. A further peculiarity of GeneTrack is that nucleosome predictions are centred on the peak in read counts. This results in predictions that are shifted by approximately half a nucleosome length compared to the actual position of the nucleosome. This inaccuracy was corrected for the purpose of this comparison. ChIPseqR was used with a binding region of 128 bp, support regions of 17 bp and a background window with <italic>w </italic>= 1000. These settings were found to perform well on real data (see Methods) and were used here for consistency.</p>
      <p>All methods were applied to simulated data (see Methods) and various performance metrics are reported. The number of predicted nucleosomes at each level of coverage (Table <xref ref-type="table" rid="T1">1</xref>) suggests very low sensitivity for WTD and MTC. At the lower coverage levels these methods failed to detect any nucleosomes and even for the 10 million read samples predicted nucleosome numbers remained very low. Better sensitivity was achieved by MSP and ChIPseqR. The lack of a significance threshold for GeneTrack makes it difficult to assess sensitivity in a meaningful way. However, a comparison of the percentage of stable nucleosomes identified suggests that GeneTrack's sensitivity is comparable with the one achieved by MSP at lower coverage levels and that it lies between the sensitivity of ChIPseqR and MSP for the 10 million read samples.</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Number of nucleosomes identified on simulated data by different methods at three levels of coverage</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th/>
              <th/>
              <th align="center">ChIPseqR</th>
              <th align="center">GeneTrack</th>
              <th align="center">MSP</th>
              <th align="center">MTC</th>
              <th align="center">WTD</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">3 M reads</td>
              <td align="left">Sample 1</td>
              <td align="center">8,386</td>
              <td align="center">8,386*</td>
              <td align="center">4,809</td>
              <td align="center">0</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td/>
              <td align="left">Sample 2</td>
              <td align="center">8,299</td>
              <td align="center">8,299*</td>
              <td align="center">4,726</td>
              <td align="center">0</td>
              <td align="center">4</td>
            </tr>
            <tr>
              <td/>
              <td align="left">Sample 3</td>
              <td align="center">8,388</td>
              <td align="center">8,388*</td>
              <td align="center">4,892</td>
              <td align="center">0</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td/>
              <td align="left">Total</td>
              <td align="center">25,073</td>
              <td align="center">25,073*</td>
              <td align="center">14,427</td>
              <td align="center">0</td>
              <td align="center">4</td>
            </tr>
            <tr>
              <td/>
              <td align="left">% stable</td>
              <td align="center">24.9%</td>
              <td align="center">4.7%</td>
              <td align="center">5.4%</td>
              <td align="center">-</td>
              <td align="center">25%</td>
            </tr>
            <tr>
              <td/>
              <td align="left">repeatability</td>
              <td align="center">0.07</td>
              <td align="center">0.02</td>
              <td align="center">0.007</td>
              <td align="center">-</td>
              <td align="center">-</td>
            </tr>
            <tr>
              <td align="left">6 M reads</td>
              <td align="left">Sample 1</td>
              <td align="center">6,257</td>
              <td align="center">6,257*</td>
              <td align="center">7,968</td>
              <td align="center">0</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td/>
              <td align="left">Sample 2</td>
              <td align="center">6,286</td>
              <td align="center">6,286*</td>
              <td align="center">7,912</td>
              <td align="center">0</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td/>
              <td align="left">Sample 3</td>
              <td align="center">6,431</td>
              <td align="center">6,431*</td>
              <td align="center">8,139</td>
              <td align="center">0</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td/>
              <td align="left">Total</td>
              <td align="center">18,974</td>
              <td align="center">18,974*</td>
              <td align="center">24,019</td>
              <td align="center">0</td>
              <td align="center">0</td>
            </tr>
            <tr>
              <td/>
              <td align="left">% stable</td>
              <td align="center">52.7%</td>
              <td align="center">6.7%</td>
              <td align="center">6.5%</td>
              <td align="center">-</td>
              <td align="center">-</td>
            </tr>
            <tr>
              <td/>
              <td align="left">repeatability</td>
              <td align="center">0.16</td>
              <td align="center">0.05</td>
              <td align="center">0.014</td>
              <td align="center">-</td>
              <td align="center">-</td>
            </tr>
            <tr>
              <td align="left">10 M reads</td>
              <td align="left">Sample 1</td>
              <td align="center">19,907</td>
              <td align="center">19,907*</td>
              <td align="center">9,989</td>
              <td align="center">542</td>
              <td align="center">142</td>
            </tr>
            <tr>
              <td/>
              <td align="left">Sample 2</td>
              <td align="center">20,359</td>
              <td align="center">20,359*</td>
              <td align="center">9,951</td>
              <td align="center">621</td>
              <td align="center">143</td>
            </tr>
            <tr>
              <td/>
              <td align="left">Sample 3</td>
              <td align="center">20,223</td>
              <td align="center">20,223*</td>
              <td align="center">9,851</td>
              <td align="center">545</td>
              <td align="center">192</td>
            </tr>
            <tr>
              <td/>
              <td align="left">Total</td>
              <td align="center">60,489</td>
              <td align="center">60,489*</td>
              <td align="center">29,791</td>
              <td align="center">1,708</td>
              <td align="center">477</td>
            </tr>
            <tr>
              <td/>
              <td align="left">% stable</td>
              <td align="center">32.5%</td>
              <td align="center">18.2%</td>
              <td align="center">7.7%</td>
              <td align="center">68.1%</td>
              <td align="center">48.8%</td>
            </tr>
            <tr>
              <td/>
              <td align="left">repeatability</td>
              <td align="center">0.31</td>
              <td align="center">0.16</td>
              <td align="center">0.06</td>
              <td align="center">0.10</td>
              <td align="center">0.04</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>*Cut-off was chosen to give the same number of significant predictions as ChIPseqR.</p>
          <p>For each sample the number of predicted nucleosomes is reported. The total number of significant predictions for each level of coverage is reported together with the proportion of stable nucleosomes that were identified in all three samples as well as a measure of repeatability of stable nucleosome predictions between samples (see text for details).</p>
        </table-wrap-foot>
      </table-wrap>
      <p>It may be instructive to consider the number of stable nucleosomes detected by each of the methods. For this purpose we considered a stable nucleosome to be detected if a given method produced a nucleosome prediction within 100 bp of the nucleosome centre. Although nucleosome predictions not corresponding to stable nucleosomes are not necessarily less valid, it is desirable to detect stable nucleosomes because their stability is likely to be related to a regulatory mechanism. Since the positions of these nucleosomes are stable it is straightforward to determine the distance between the location of the stable and predicted nucleosomes. MSP, GeneTrack and ChIPseqR produced a relatively large number of predictions at all coverage levels and identified increasing numbers of stable nucleosomes with increasing coverage. However, ChIPseqR consistently produced more stable nucleosome predictions than any of the other methods, indicating that it provides the best sensitivity of the methods in this comparison (Table <xref ref-type="table" rid="T1">1</xref>). Assessing the specificity of the nucleosome predictions is less straightforward since many nucleosomes do not have well defined positions and therefore predictions cannot be classified as incorrect in the usual sense. Instead we again focused on the methods' ability to identify stable nucleosomes. A method that accurately locates nucleosomes rather than random positions along the genome is expected to predict the location of stable nucleosomes with high confidence as these should be relatively easy to identify due to the well defined peaks associated with them. As the stability of nucleosomes decreases the corresponding reads are increasingly dispersed and peaks become less obvious. To assess how well the different methods are able to separate stable nucleosomes from other nucleosomes we considered all nucleosomes predicted from the third 10 M read sample by each method and rank predictions by score. Figure <xref ref-type="fig" rid="F2">2</xref> shows the fraction of predicted stable and non-stable nucleosomes considered significant with varying threshold. From this it is apparent that ChIPseqR not only identifies more nucleosomes than the other methods, it also is more reliable in terms of locating stable nucleosomes. Although GeneTrack produces a large number of nucleosome predictions, stable nucleosomes are not well distinguished from other nucleosomes.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>Specificity and spatial resolution of nucleosome predictions</bold>. (A) Fraction of predicted stable and non-stable nucleosomes considered significant at varying p-value cut-offs. A method that consistently produces smaller p-values for stable than for non-stable nucleosomes will result in a curve that gets closer to the top left corner than a method for which p-values and the stability of nucleosomes are unrelated. (B) Distance between nucleosome predictions from the third 10 M read sample and the location of stable nucleosomes. For each method observed distances are reported together with standard deviation of distances. A larger standard deviation corresponds to a lower resolution.</p>
        </caption>
        <graphic xlink:href="1471-2105-12-39-2"/>
      </fig>
      <p>To further investigate how reliably different methods identify stable nucleosomes we consider the stable nucleosomes identified from different samples at the same level of coverage (Table <xref ref-type="table" rid="T1">1</xref>). For each of the three samples the stable nucleosomes identified by a given method are recorded such that <italic>X<sub>i</sub></italic>(<italic>j</italic>) = 1 when the <italic>j</italic><sup>th </sup>stable nucleosome was detected in sample <italic>i </italic>and 0 otherwise. We assess a method's ability to reliably identify the same stable nucleosomes from different samples by computing the total correlation <italic>C</italic><sub>tot</sub>(<italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>, <italic>X</italic><sub>3</sub>) [<xref ref-type="bibr" rid="B21">21</xref>] between the three samples. This provides a measure of the information shared between the samples, i.e. it will be maximised if the same set of nucleosomes is identified for each sample. To obtain a measure of repeatability that is comparable between methods and different levels of coverage regardless of the number of identified nucleosomes, we divide <italic>C</italic><sub>tot</sub>(<italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>, <italic>X</italic><sub>3</sub>) by <italic>C</italic><sub>max</sub>(<italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>, <italic>X</italic><sub>3</sub>) which is calculated as the total correlation of a permutation of <italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>, <italic>X</italic><sub>3 </sub>that maximises the number of repeated nucleosome detections. This normalises the repeatability such that it lies in [01]. Over 50% of the stable nucleosomes predicted by ChIPseqR from the 10 M read samples were successfully identified in all three samples which corresponds to a repeatability of 0.31. None of the other methods achieved a repeatability of more than 0.16. It is worth noting that while MSP produces a relatively large number of predictions they tend to differ substantially between samples, leading to a very low repeatability.</p>
      <p>Another important performance measure is the resolution at which predictions are made, i.e., how close predicted nucleosome positions are to actual nucleosome locations. Peak-finding algorithms like the ones considered here typically involve a smoothing step to elucidate peaks. This comes at the cost of reducing the resolution of the raw data. To measure the resolution achieved by the four methods in this comparison we examined the distance between predicted stable nucleosomes and the underlying stable nucleosome positions (Figure <xref ref-type="fig" rid="F2">2</xref>). The best resolution was achieved by GeneTrack followed by MTC and ChIPseqR. While WTD appeared to produce predictions at an acceptable resolution, the low sensitivity of this method made an accurate assessment of the resolution difficult. The resolution of MSP was clearly the lowest in this comparison, limiting its usefulness for localising individual nucleosomes.</p>
      <sec>
        <title>Characteristics of predicted nucleosome sites</title>
        <p>To further investigate the utility of the proposed method we applied it to end sequenced mononucleosomes from <italic>Arabidopsis thaliana</italic>. Sequence reads were generated through Solexa sequencing of DNA fragments. Mononucleosome-sized DNA fragments were selected for sequencing after MNase digestion. Approximately 8 million uniquely mapped reads were used for the analysis.</p>
        <p>The nucleosome model and scoring procedure described above require the specification of several parameters. We conducted computational experiments to investigate the influence of these parameters on the performance of ChIPseqR (see Methods) and chose a background window of 2001 bp, i.e. <italic>w </italic>= 1000 as well as two separate sets of parameters (<italic>b </italic>= 147, <italic>s </italic>= 10 and <italic>b </italic>= 128, <italic>s </italic>= 17) for the length of the binding and support regions to investigate the properties of nucleosomes predicted from end-sequenced mononucleosome fragments. The first set of parameters only produced about 2,200 significant nucleosome predictions while the second set identified 8,393 nucleosomes. An example of nucleosome predictions in a selected region of the genome is shown in Figure <xref ref-type="fig" rid="F3">3</xref>. Characteristics of interest are the distance between predicted stable nucleosomes, the location of stable nucleosomes relative to annotated genes and the presence of DNA sequence motifs within nucleosome sequences.</p>
        <fig id="F3" position="float">
          <label>Figure 3</label>
          <caption>
            <p><bold>Predicted nucleosomes</bold>. Example of predicted nucleosomes from <italic>Arabidopsis thaliana </italic>dataset with <italic>b </italic>= 128 and <italic>s </italic>= 17. Vertical bars indicate read positions on forward (top) and reverse strand (bottom). The nucleosome score computed by ChIPseqR is shown as blue line. Blue ellipses indicate nucleosomes predicted by ChIPseqR. GeneTrack predictions are shown as red ellipses for comparison. The nucleosome shown in dark blue corresponds to a high confidence prediction (FDR &lt; 0.05). Lighter shades of blue indicate lower confidence predictions.</p>
          </caption>
          <graphic xlink:href="1471-2105-12-39-3"/>
        </fig>
        <p>The distribution of distances between adjacent predictions should provide some insights into the distribution of stable nucleosomes throughout the genome. Note that, while individual nucleosomes along the same chromosome cannot overlap within a single cell, the position of nucleosomes is expected to vary between cells or even between different copies of a chromosome within the same cell to some degree. This may lead to overlapping nucleosome predictions if there is sufficient evidence to support these alternative positions. Figure <xref ref-type="fig" rid="F4">4</xref> shows the distribution of distances between adjacent nucleosome predictions for <italic>b </italic>= 128 and <italic>s </italic>= 17. This distribution is characterised by a relatively large number of distances that are shorter than 15 bp followed by only ten cases with distances between 16 and 150 bp. The majority of distances between nucleosomes are larger than 200 bp. This suggests that some adjacent predictions correspond to adjacent stable nucleosomes while others have larger gaps between them. The relatively high abundance of overlapping predictions and the consistently small difference in position between them may represent some uncertainty about the location of these nucleosomes but also suggests that positioned nucleosomes are more likely to exhibit small rather than large changes in position depending on cell state. This observation is consistent with the findings of Albert <italic>et al</italic>. [<xref ref-type="bibr" rid="B1">1</xref>] regarding the translational and rotational settings of nucleosomes.</p>
        <fig id="F4" position="float">
          <label>Figure 4</label>
          <caption>
            <p><bold>Distances between adjacent nucleosome predictions</bold>. Distribution of distances between adjacent nucleosome predictions for <italic>b </italic>= 128 and <italic>s </italic>= 17. Many adjacent nucleosome predictions correspond to overlapping nucleosomes, most likely due to variations in nucleosome position between cells. The shift in position between overlapping nucleosomes tends to be small with only ten cases where the shift is larger than 15 bp. Distances larger than 200 bp are not shown.</p>
          </caption>
          <graphic xlink:href="1471-2105-12-39-4"/>
        </fig>
        <p>Previous studies of nucleosomes in various organisms have found evidence for nucleosome positioning relative to transcription start sites [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B4">4</xref>]. To investigate whether there is evidence of positioning relative to the 5' and 3' end of annotated genes in the two sets of predicted nucleosomes, we aligned the transcription start sites (TSS) and transcription end sites (TES) of all annotated <italic>Arabidopsis </italic>genes and determined the number of predicted nucleosomes centred at each position within 1 kb of the respective feature (Figure <xref ref-type="fig" rid="F5">5</xref>). There is clear evidence for positioned nucleosomes at both ends of genes. The +1 nucleosome is followed by a series of positioned nucleosomes of decreasing stability. The region upstream of the +1 nucleosome is depleted of nucleosomes. There is some evidence for nucleosome positioning upstream of the nucleosome free region (NFR) although this is much weaker than for the +1 nucleosome. The nucleosome positions predicted with <italic>b </italic>= 128 show some evidence of a nucleosome located in the NFR similar to the -1 nucleosome reported for some genes in humans [<xref ref-type="bibr" rid="B4">4</xref>].</p>
        <fig id="F5" position="float">
          <label>Figure 5</label>
          <caption>
            <p><bold>Phasing of predicted nucleosomes</bold>. Predicted nucleosomes are phased at transcription start and end sites. Predicted nucleosomes under both parameter sets ((<italic>b </italic>= 128, <italic>s </italic>= 17) (top) and (<italic>b </italic>= 147, <italic>s </italic>= 10) (bottom)) show clear evidence of phasing at TSS and TES. Vertical bars indicate the number of nucleosomes centred at each position. Red and green lines are smoothed nucleosome counts using smoothing splines and a moving average respectively.</p>
          </caption>
          <graphic xlink:href="1471-2105-12-39-5"/>
        </fig>
        <p>It has been suggested based on theoretical considerations as well as empirical findings that stable nucleosomes are associated with a periodic pattern of dinucleotides [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>,<xref ref-type="bibr" rid="B22">22</xref>]. To assess whether similar patterns play a role in nucleosome positioning in <italic>Arabidopsis </italic>and whether they can be detected based on the stable nucleosomes predicted by our method, we used the over 2200 non-overlapping nucleosome positions identified with <italic>b </italic>= 147, <italic>s </italic>= 10 to investigate the properties of nucleosome sequences. To this end the position specific frequency of all dinucleotides was determined in a ±500 bp window around the centre of predicted nucleosomes (see Methods).</p>
        <p>Dinucleotide frequencies throughout the predicted nucleosome sequences differ markedly from genome-wide frequencies while there is little evidence for this outside the nucleosome region (Figure <xref ref-type="fig" rid="F6">6(A)</xref>). Note that the A/T bias of MNase leads to a notable increase in the frequency of related dinucleotides in the flanking regions of predicted nucleosomes. Studies in yeast and <italic>Drosophila </italic>have reported a periodic pattern of A/T and C/G dinucleotides in nucleosome sequences [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>]. We observe a similar pattern that is dominated by alternating AA/TT and CC/GG dinucleotides (Figure <xref ref-type="fig" rid="F6">6(B)</xref>). These dinucleotides correspond to a subset of previously reported nucleosome-associated patterns. This may be an indication that such patterns vary between species as suggested by Kogan and Trifonov [<xref ref-type="bibr" rid="B23">23</xref>]. They also find AA to be the dominant pattern associated with periodic dinucleotide signals at gene splice sites in <italic>Arabidopsis</italic>. The periodic patterns observed in nucleosome binding DNA are accompanied by an increase in G/C content compared to the genome average (Figure <xref ref-type="fig" rid="F6">6(B)</xref>), which is consistent with previous observations in yeast [<xref ref-type="bibr" rid="B24">24</xref>,<xref ref-type="bibr" rid="B25">25</xref>] and humans [<xref ref-type="bibr" rid="B26">26</xref>].</p>
        <fig id="F6" position="float">
          <label>Figure 6</label>
          <caption>
            <p><bold>Dinucleotide frequencies in nucleosome sequences</bold>. (A) DNA sequences associated with predicted stable nucleosomes show clear evidence of specific dinucleotide patterns. (B) AA/TT and CC/GG/CG/GC dinucleotides show a periodic pattern in nucleosome sequences. In both panels open circles correspond to data points while solid curves show a three base pair moving average.</p>
          </caption>
          <graphic xlink:href="1471-2105-12-39-6"/>
        </fig>
      </sec>
      <sec>
        <title>Verification of predicted nucleosome positions</title>
        <p>Nine genomic regions containing 13 nucleosome predictions with different levels of confidence were selected for qPCR verification. Out of the 13 predicted nucleosomes 11 were verified (see Methods).</p>
        <p>The DNA abundance profiles obtained through qPCR show several well defined peaks. Many of these correspond to predicted nucleosomes while others appear to suggest the presence of adjacent nucleosomes that were not predicted by the initial analysis. To investigate this further we identified peaks in DNA abundance that may correspond to positions of additional nucleosomes that do not overlap predicted nucleosomes and tested them for significance using the same procedure as above. This results in the detection of additional nucleosomes in 10 of 14 potential nucleosome positions. The remaining four locations are characterised by flat DNA abundance profiles and may correspond either to nucleosome free regions or areas of delocalised "fuzzy" nucleosomes (see additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Figure S1).</p>
      </sec>
    </sec>
    <sec>
      <title>Implementation</title>
      <p>An R package implementing the method described here is freely available from Bioconductor and from the authors' web page at <ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.csiro.au/ChIPseqR">http://www.bioinformatics.csiro.au/ChIPseqR</ext-link> together with simulated datasets.</p>
    </sec>
  </sec>
  <sec>
    <title>Discussion</title>
    <p>Unlike the majority of existing methods for the analysis of ChIP-seq experiments the novel approach presented here is suitable for the detection of nucleosome positions. The explicit modelling of nucleosomes increases the sensitivity and makes it possible to detect their positions at low coverage levels. Combined with the relatively small amount of smoothing required for the analysis this enables ChIPseqR to reliably identify nucleosomes at high resolution. This is especially important for the analysis of nucleosome positions and histone modifications since this typically requires the sequencing of a much larger proportion of the genome than would be required for a transcription factor study, which results in lower coverage for the same amount of sequencing. Furthermore, nucleosome studies aim to distinguish binding sites that are usually located close to each other and may vary in location throughout the sample. It is therefore important to identify binding sites at high resolution and to allow for partially overlapping peaks in read counts associated with adjacent binding sites.</p>
    <sec>
      <title>High resolution and repeatability</title>
      <p>Although all methods compared here use strand specific read counts and all except WTD are able to handle overlapping peaks from adjacent binding sites only ChIPseqR achieved good sensitivity and high resolution. The high resolution achieved by ChIPseqR is further highlighted by the detection of periodic dinucleotide patterns in the DNA sequence of predicted binding sites. Strong evidence of these patterns was found without any further sequence alignment, suggesting that the predicted positions of stable nucleosomes are highly accurate. This result is also indicative of high specificity since false positives would dilute any sequence motifs. It should be noted that all methods in the comparison would benefit from a further increase in coverage. We expect that differences in performance will diminish as coverage saturates but achieving sufficient coverage to reach saturation is still costly which makes it desirable to obtain reliable results from low coverage data.</p>
      <p>Another performance measure of interest is an algorithm's ability to produce consistent results for repeated experiments. This is of particular interest when low coverage data is used since this is likely to result in the prediction of only a subset of all binding sites. Despite this one would like to obtain results that do not depend too much on the details of a particular sequencing run, i.e., the analysis should be robust towards moderate changes in read position. This is important to enable researchers to draw reliable conclusions from the analysis that can be expected to hold when the experiment is repeated. Although all methods in the comparison perform better than random, indicating that they all provide a core of consistently predicted nucleosomes, ChIPseqR provides substantially higher repeatability than any other method at all levels of coverage.</p>
    </sec>
    <sec>
      <title>Analysis of mononucleosomes</title>
      <p>The favourable performance of ChIPseqR observed in the comparison on simulated data is confirmed by its application to the mononucleosome dataset. Predicted nucleosomes are found close to transcription start and transcription end sites that are known to be associated with stable and phased nucleosomes [<xref ref-type="bibr" rid="B1">1</xref>-<xref ref-type="bibr" rid="B4">4</xref>], suggesting that ChIPseqR is well suited for the detection of moderately well positioned nucleosomes. This is confirmed by the results of the qPCR verification of selected nucleosome predictions. Considering the verification results it is evident that predicted nucleosomes corresponding to pronounced peaks in qPCR measurements, which are likely to represent stable or phased nucleosomes, were confirmed reliably. Closer inspection of the two unverified nucleosome predictions reveals that one of them is located within 30 bp of a significant peak in DNA abundance (Figure <xref ref-type="fig" rid="F7">7</xref> and additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Figure S1). It seems likely that the location of this nucleosome would be predicted more accurately with increased coverage. It should be noted that the peak in qPCR measurements appears to be wider than expected for a stable nucleosome and may suggest the presence of an alternative nucleosome position in the sample. The other unverified nucleosome position is located at what appears to be the start of a "fuzzy" nucleosome region. This makes it difficult to assess the exact location with any method. We note that the analysis of the short read data produced three distinct peaks in the binding site score located close to the predicted binding site (see additional file <xref ref-type="supplementary-material" rid="S1">1</xref>: Figure S1). This is consistent with the presence of overlapping nucleosome positions that one would expect from delocalised nucleosomes.</p>
      <fig id="F7" position="float">
        <label>Figure 7</label>
        <caption>
          <p><bold>Results of qPCR verification and amplicon design</bold>. Two of the regions chosen for verification are shown with log mean quantities of DNA measured on four replicates. The location of verified nucleosomes is indicated by dark green horizontal bars. A nucleosome prediction that is not supported by qPCR measurements is shown in red with an alternative position suggested by the PCR results indicated in blue. A light blue bar indicates the location of a nucleosome identified by qPCR that was not predicted by our analysis. Nucleosome scores are shown shaded in grey. Below the location of amplicons used to tile across the selected regions is shown relative to predicted nucleosomes.</p>
        </caption>
        <graphic xlink:href="1471-2105-12-39-7"/>
      </fig>
      <p>The regions chosen for qPCR verification were selected to encompass predictions with a range of FDRs. The fact that all low confidence predictions were verified suggests good specificity even for relatively high values of the nominal FDR. Consequently the FDR cut-off chosen for the initial analysis may be considered conservative.</p>
    </sec>
    <sec>
      <title>Influence of model parameters</title>
      <p>When discussing the performance of ChIPseqR it is important to realise that this depends on a number of parameters. Apart from the coverage provided by a given dataset, some of the model parameters will impact on the performance characteristics. Choosing <italic>b</italic>, the length of the binding region, close to the actual binding site length will result in high resolution and is expected to improve specificity. However, this will reduce the method's ability to detect less stable binding sites, thus reducing sensitivity. Such unstable binding sites can be detected more reliably if <italic>b </italic>is reduced while the length of the support regions is increased. This increases sensitivity but may lead to reduced resolution. It should be noted that the choice of <italic>b </italic>= 128 that was determined to be optimal for the data considered here is less than the 147 bp that may be expected for a nucleosome. However, this reduced binding region is consistent with the presence of alternative preferred positions of a stable nucleosome located ±10 bp from a central position that have been observed previously [<xref ref-type="bibr" rid="B27">27</xref>].</p>
      <p>Another important factor is the estimation of the background read rate λ<sub>bg</sub>. There are at least two different approaches to the estimation of this parameter. The one taken here relies on choosing a large window relative to the binding site which is applied to the same sample that contains the binding sites. The relatively large size of the background window results in an average read rate close to a base level even if there are binding sites within the window. However, the presence of binding sites will increase the estimated background rate above the actual background, thus producing conservative binding site scores. An alternative approach would use a separate control sample to assess the background read rate. This has the potential to produce more accurate results and is generally recommended but we note that it may be difficult and costly to obtain good control samples for this purpose. Even when a suitable control sample is available the issue of an appropriate normalisation method for this type of data has not been settled (see [<xref ref-type="bibr" rid="B28">28</xref>] for a discussion of some problems with current approaches). We therefore consider the single sample method presented here to be more practical at the moment, especially for nucleosome sequencing.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>The model proposed here was specifically designed for the analysis of end sequenced nucleosomes after MNase digestion. Although several ChIP-seq analysis algorithms are available for tasks like this they are typically designed for the analysis of transcription factor binding. Our analysis demonstrates that it is beneficial to take the substantial differences between transcription factor binding and nucleosome positioning experiments into account explicitly. Although some existing methods may be general enough to handle both transcription factor ChIP-seq and nucleosome sequencing data they will be outperformed by more specialised methods, especially on low coverage data. Although GeneTrack was designed for the analysis of nucleosome experiments and has been used for this purpose with apparent success [<xref ref-type="bibr" rid="B1">1</xref>] it does not take advantage of the characteristics of nucleosome experiments. This results in a performance similar to the general ChIP-seq methods.</p>
    <p>The main advantages of the model presented here are the high resolution of nucleosome predictions and its ability to operate on low coverage data. This makes it especially suitable for the analysis of nucleosome positions in situations where it is difficult to obtain high coverage, i.e. many reads per nucleosome position, because the genome under consideration is large or the sample contains a mixture of many cells (and therefore many different nucleosome configurations).</p>
    <p>The most important parameters of our model, <italic>b </italic>and <italic>s</italic>, are closely related to the underlying biology and length of DNA fragments used for sequencing. This makes ChIPseqR a flexible and versatile method for the analysis of nucleosome positioning and makes it possible to adapt the method to a range of different experiments. We have demonstrated its favourable performance in the context of nucleosome positioning experiments and similar performance is expected for other nucleosome related experiments, such as histone modification studies. More generally it should be possible to apply the approach demonstrated here to other ChIP-seq experiments. We note however that the binding site model should be adjusted to accommodate the differences in experimental procedures, especially when DNA is fragmented through sonication rather than MNase digestion.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Simulated data</title>
      <p>Data were simulated using the ChIPsim R package (available at <ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.csiro.au/ChIPsim">http://www.bioinformatics.csiro.au/ChIPsim</ext-link> and from Bioconductor) with default parameters. Briefly, ChIPsim generates a sequence of nucleosome features to cover a given genome. Each type of feature has its own characteristics, corresponding to different chromatin structures commonly observed in nucleosome positioning experiments. Here we distinguish between 'stable', 'phased', 'fuzzy' and 'nucleosome free' regions. The simulation assumes that sequence reads are generated from a population of cells, i.e., nucleosome positions are represented by distributions rather than discrete locations.</p>
      <p>For this study we generated nucleosome features to cover the <italic>Arabidopsis </italic>genome. These features include 13,758 stable nucleosomes, 16,313 regions of phased nucleosomes covering 82 Mb, 6,360 regions of fuzzy nucleosomes covering 32 Mb and 11,293 nucleosome free regions covering 1.3 Mb. A dataset containing 30 million sequence reads, each 36 bp long, was generated from the TAIR 8 assembly of the genome <ext-link ext-link-type="ftp" xlink:href="ftp://ftp.arabidopsis.org/Sequences/wholechromosomes/">ftp://ftp.arabidopsis.org/Sequences/wholechromosomes/</ext-link>. From this smaller datasets with three, six and ten million reads were created with three replicates at each level of coverage. All simulated datasets are available online from <ext-link ext-link-type="uri" xlink:href="http://www.bioinformatics.csiro.au/ChIPseqR">http://www.bioinformatics.csiro.au/ChIPseqR</ext-link>.</p>
    </sec>
    <sec>
      <title>Mononucleosome data</title>
      <p>To generate the mononucleosome fragments for end-sequencing and qPCR verification a lysate was prepared by grinding 1 g total seedling material of <italic>Arabidopsis </italic>ecotype Columbia to a fine powder in liquid nitrogen. The ground material was added to 10 ml lysis buffer (50 mM HEPES pH7.5, 150 mM NaCl, 1% (v/v) Triton TX-100, 0.1% (w/v) sodium deoxycholate, 0.1% (w/v) sodium dodecyl sulphate, 1× Plant Proteinase Inhibitor mix (Sigma St Louis, MO). 1 ml aliquots of the lysate were digested with 7.5 to 30 units micrococcal nuclease (Fermentas, Vilnius, Lithuania) for 15 minutes at 37°C, followed by proteinase K treatment and phenol extraction. DNA fragments were separated by agarose gel electrophoresis and the fragments in the size range of mononucleosome cores (~150 bp) were excised and purified. The purified mononucleosome cores were then used to generate a library for Illumina GS sequencing (carried out by Geneworks, Adelaide, Australia) or used for qPCR quantification. The data from Illumina GS sequencing are archived at the NCBI Sequence Read Archive (SRA) under accession number SRP001458.</p>
    </sec>
    <sec>
      <title>Verification of predicted nucleosome positions</title>
      <p>Nine genomic regions containing a subset of predicted nucleosomes were selected for qPCR verification. Regions were chosen to cover predictions with FDR values between 0 and 0.2 and large enough to contain between ten and twelve tiled amplicons. The resulting regions are between 438 bp and 563 bp in length and contain a total of 13 nucleosome predictions. Of these predictions four have p-values between 0 and 0.01, five have p-values between 0.01 and 0.05 and the remaining four predictions have p-values between 0.05 and 0.2.</p>
      <p>A PCR-based strategy was used to verify the nucleosome positions predicted from the analysis of the sequence data. A set of predicted nucleosome positions were selected and short (~80 bp) PCR amplicons were designed across each position with each amplicon shifted by ~40 bp relative to the previous one. The amplicons were designed so that two amplicons should fall within the boundaries of each predicted nucleosome position. A listing of primer sequences and positions of amplicons are shown in additional file <xref ref-type="supplementary-material" rid="S2">2</xref>: Table S1, the locations of predicted nucleosomes covered by amplicons are given in additional file <xref ref-type="supplementary-material" rid="S3">3</xref>: Table S2. The position of amplicons relative to predicted nucleosomes in two regions are shown in Figure <xref ref-type="fig" rid="F7">7</xref>. A quantitative PCR assay was then used to determine DNA abundance in four replicate mononucleosome isolations compared to uncut genomic DNA standards. Regions that are contained in the mononucleosome fractions should show enrichment in this assay. Similar results were obtained when micrococcal nuclease-digested DNA was assayed without purification of the mononucleosome cores (data not shown). The mean abundance of DNA was measured for each amplicon in four replicates. These measurements were converted into a continuous abundance profile for each replicate and region by averaging the abundance of different amplicons where they overlap. The resulting profiles were log transformed to account for differences in scale between replicates (Figure <xref ref-type="fig" rid="F7">7</xref>). To determine whether a predicted nucleosome position was confirmed by the qPCR data the DNA abundance at the centre of the predicted nucleosome was compared to the abundance at positions ±80 bp from the centre, which correspond to predicted linker DNA. The difference in abundance was tested for deviation from 0 at a significance level of 0.01 using a one-sided paired <italic>t</italic>-test. Predictions associated with significantly higher DNA abundance at the centre of predicted nucleosome cores than in the corresponding linker region were considered to be verified. Following this procedure eleven of the 13 nucleosome predictions were verified (Table <xref ref-type="table" rid="T2">2</xref>).</p>
      <table-wrap id="T2" position="float">
        <label>Table 2</label>
        <caption>
          <p>Number of predicted and verified nucleosomes in three significance bands</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th/>
              <th align="center">[0, 0.01)</th>
              <th align="center">[0.01, 0.05)</th>
              <th align="center">[0.05, 0.2)</th>
              <th align="center">total</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">predictions</td>
              <td align="center">4</td>
              <td align="center">5</td>
              <td align="center">4</td>
              <td align="center">13</td>
            </tr>
            <tr>
              <td align="left">verified</td>
              <td align="center">3</td>
              <td align="center">4</td>
              <td align="center">4</td>
              <td align="center">11</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Predicted binding sites with corresponding p-values ranging from 0 to 0.2 representing high, medium and low confidence predictions were chosen for verification.</p>
        </table-wrap-foot>
      </table-wrap>
      <sec>
        <title>Quantitative PCR Assays</title>
        <p>DNA protected from micrococcal nuclease digestion was quantified using an Applied Biosystems 7900HT realtime PCR machine. PCR conditions were 1× PCR buffer (Platinum Taq buffer, Invitrogen, CA), 3.5 mM MgCl<sub>2 </sub>0.2 mM dNTP mix, 0.4 <italic>μ</italic>M oligonucleotide primers, 1:20000 (v/v) SybrGreen, 0.025 U/<italic>μ</italic>l Platinum Taq. Nucleosome core samples were quantified against undigested genomic DNA standards.</p>
      </sec>
    </sec>
    <sec>
      <title>Choosing model parameters</title>
      <p>The binding site model and scoring procedure described above require the specification of several parameters. In this section we discuss possible choices of parameter values and their impact on the analysis. The parameters of the model itself are the length of the binding site <italic>b</italic>, the length of the support region <italic>s </italic>and the length of the background window <italic>w</italic>. The method used to score potential binding sites introduces a number of additional parameters, namely γ<sub>bg </sub>and γ<sub>sup </sub>to specify the cut-off in difference between rates for the background and supporting region read rate estimates and the cut-off <italic>τ </italic>used to exclude outliers when fitting the null distribution.</p>
      <p>To obtain a better understanding of how these parameters affect the analysis we considered a range of parameter combinations. The performance of different sets of parameter values was assessed based on the number of binding sites identified in the mononucleosome data and accompanying control sample where the latter are assumed to be false positives. We note that the coverage in the control sample is substantially lower than in the treatment. This may have an impact on the number of identified binding sites but we expect the general trends identified here to hold for control samples with higher coverage. In the following analysis we used a nominal false discovery rate of 0.05 and <italic>τ </italic>= 0.95. Since the length of nucleosome-bound DNA is known to be about 147 bp we initially chose <italic>b </italic>= 147 and <italic>s </italic>= 15. To investigate the effect of γ<sub>bg </sub>and γ<sub>sup </sub>we predicted binding sites using values of 0.5, 0.9, 0.99 and 1 for each of these parameters while the width of the background window was set to 1001 bp, 2001 bp and 3001 bp. The number of binding sites predicted in the treatment and control sample for all parameter combinations were recorded and compared to determine a set of parameters that provides high specificity and sensitivity. At this stage of the analysis we are mainly concerned with identifying parameter values that keep false positive predictions to a minimum while maintaining an acceptable number of predicted binding sites in the treatment sample, i.e. the focus is on specificity. To assess specificity we considered the ratio between the number of predicted binding sites in the control and treatment. Lower values of this ratio indicate higher specificity.</p>
      <p>Results are summarised in Figure <xref ref-type="fig" rid="F8">8</xref>. The choice of γ<sub>sup </sub>had the largest effect on specificity with γ<sub>sup </sub>= 0.9 generally outperforming the alternatives. The impact of other parameters was less pronounced. A background window width of 2001 bp appeared to perform slightly better than 1001 bp and 3001 bp windows. The choice of γ<sub>bg </sub>had very little influence on the specificity. The results suggest a small increase in specificity for γ<sub>bg </sub>= 0.99 and γ<sub>bg </sub>= 0.9 We note that an increasing value of γ<sub>bg </sub>tends to increase the number of predicted binding sites while also increasing the influence of unusually large peaks in the data. This may become more apparent as the overall coverage increases. Based on these considerations we chose γ<sub>bg </sub>= 0.9. as the conservative alternative.</p>
      <fig id="F8" position="float">
        <label>Figure 8</label>
        <caption>
          <p><bold>Number of binding sites identified in treatment and control sample using different sets of parameters</bold>. (A - C) Box-plots show the ratios of predicted binding site counts in treatment and control achieved with different parameter choices. Lower values suggest higher specificity. (D) The number of predicted nucleosomes in the control sample is plotted versus the number of nucleosomes identified from the mononucleosome sample. Different colours correspond to different background rate cut-offs while different symbols indicate different cut-off levels for support region rates.</p>
        </caption>
        <graphic xlink:href="1471-2105-12-39-8"/>
      </fig>
      <p>Using the parameter values determined above we then considered different values for the length of binding and support regions. While the length of DNA bound as part of a nucleosome is well established, it may be beneficial to use a shorter binding region. The sample under consideration contains a mixture of cells from various tissue types. With the position of most nucleosomes expected to vary between tissue types, or even between cells of the same type, only the most stable nucleosomes will produce a sequence read pattern with a binding region of 147 bp. As the stability of a given nucleosome decreases the resulting pattern will show a smaller binding region and larger support regions. We investigated how combinations of <italic>b </italic>∈ {125, . . . , 154} and <italic>s </italic>∈ {5, . . . , 20} affect the number of nucleosomes detected in treatment and control. For each combination of <italic>s </italic>and <italic>b </italic>the number of predicted nucleosomes in treatment (<bold>m</bold>) and control (<bold>M</bold>) was recorded, aiming to determine values for <italic>b </italic>and <italic>s </italic>that provide a favourable trade-off between sensitivity and specificity. Consider (<italic>M<sub>i</sub></italic>, <italic>m<sub>i</sub></italic>), the pair of nucleosome counts produced by the <italic>i</italic><sup>th </sup>parameter set. For each <italic>M<sub>i </sub></italic>∈ <bold>M </bold>we determined <italic>m<sub>k </sub></italic>such that <italic>m<sub>k </sub></italic>is the largest value in <bold>m </bold>for which <italic>M<sub>k </sub></italic>≤ <italic>M<sub>i</sub></italic>. Then</p>
      <p>
        <disp-formula id="bmcM6">
          <label>(6)</label>
          <mml:math id="M18" name="1471-2105-12-39-i18" overflow="scroll">
            <mml:mrow>
              <mml:mi>ℱ</mml:mi>
              <mml:mo>=</mml:mo>
              <mml:mo>{</mml:mo>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:msub>
                <mml:mi>M</mml:mi>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>i</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:msub>
              <mml:mo>,</mml:mo>
              <mml:mtext> </mml:mtext>
              <mml:msub>
                <mml:mi>m</mml:mi>
                <mml:mrow>
                  <mml:mi>k</mml:mi>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>i</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:msub>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mtext> </mml:mtext>
              <mml:mo>:</mml:mo>
              <mml:mtext> </mml:mtext>
              <mml:mi>k</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mi>i</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mi>arg</mml:mi>
              <mml:mi>max</mml:mi>
              <mml:mo stretchy="false">[</mml:mo>
              <mml:msub>
                <mml:mi>m</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:msub>
              <mml:mo stretchy="false">|</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>≤</mml:mo>
              <mml:mi>j</mml:mi>
              <mml:mo>≤</mml:mo>
              <mml:mn>480</mml:mn>
              <mml:mtext> </mml:mtext>
              <mml:mtext>and</mml:mtext>
              <mml:mtext> </mml:mtext>
              <mml:msub>
                <mml:mi>M</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:msub>
              <mml:mo>≤</mml:mo>
              <mml:msub>
                <mml:mi>M</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:msub>
              <mml:mo stretchy="false">]</mml:mo>
              <mml:mo>,</mml:mo>
              <mml:mtext> </mml:mtext>
              <mml:mn>1</mml:mn>
              <mml:mo>≤</mml:mo>
              <mml:mi>i</mml:mi>
              <mml:mo>≤</mml:mo>
              <mml:mn>480</mml:mn>
              <mml:mo>}</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>is a set of points representing parameter combinations that are optimal in the sense that neither sensitivity nor specificity can be improved without adversely affecting the other performance measure. While all points in ℱ are optimal in the above sense, some combinations of parameter values will be more useful in practice than others. Using <italic>b </italic>= 128 and <italic>s </italic>= 17 provides a favourable trade-off between the number of nucleosomes identified in treatment and control (Figure <xref ref-type="fig" rid="F9">9</xref>). We note that none of the parameter sets with <italic>b </italic>= 147 is in ℱ; indeed over 70% of optimal parameter combination have 125 ≤ <italic>b </italic>≤ 130. This suggests that only few nucleosome positions are maintained throughout the sample. Nucleosome positions predicted in the treatment sample with <italic>b </italic>= 128, <italic>s </italic>= 17 and <italic>b </italic>= 147, <italic>s </italic>= 10 were selected for further analysis.</p>
      <fig id="F9" position="float">
        <label>Figure 9</label>
        <caption>
          <p><bold>Number of nucleosomes identified in treatment and control with varying binding and support regions</bold>. (A) The scatter plot shows all combinations of nucleosome predictions in treatment and control obtained for the chosen range of parameter values. Points corresponding to maximum number of predicted nucleosomes in the treatment sample for a given number of predicted nucleosomes in the control are marked in green. Results from parameter sets where <italic>b </italic>= 147 are highlighted in red. Solid points indicate parameter combinations that were selected for further analysis. (B) Log ratio of the number of nucleosomes identified in treatment and control for each combination of binding and support region length. Parameter combinations corresponding to green points on the left are marked with ×. Green symbols indicate parameter combinations chosen for further analysis.</p>
        </caption>
        <graphic xlink:href="1471-2105-12-39-9"/>
      </fig>
    </sec>
    <sec>
      <title>Scoring potential nucleosomes</title>
      <p>To obtain the statistic for the comparison of read counts in two regions, consider the independent random variables <italic>Y</italic><sub>0<italic>j </italic></sub>~ Poisson(Λ<sub>0<italic>j</italic></sub>) and <italic>Y</italic><sub>1<italic>j </italic></sub>~ Poisson(Λ<sub>1<italic>j</italic></sub>). We then obtain two independent random variables <italic>X</italic><sub>0 </sub>and <italic>X</italic><sub>1 </sub>by summing over <italic>j</italic>:</p>
      <p>
        <disp-formula id="bmcM7">
          <label>(7)</label>
          <mml:math id="M19" name="1471-2105-12-39-i19" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mi>X</mml:mi>
                <mml:mi>k</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mstyle displaystyle="true">
                <mml:munderover>
                  <mml:mo>∑</mml:mo>
                  <mml:mrow>
                    <mml:mi>j</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>t</mml:mi>
                      <mml:mi>k</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                </mml:munderover>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>Y</mml:mi>
                    <mml:mrow>
                      <mml:mi>k</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                </mml:mrow>
              </mml:mstyle>
              <mml:mo>~</mml:mo>
              <mml:mtext> </mml:mtext>
              <mml:mtext>Poisson</mml:mtext>
              <mml:mtext> </mml:mtext>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:msub>
                <mml:mi>λ</mml:mi>
                <mml:mi>k</mml:mi>
              </mml:msub>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>,</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <inline-formula><mml:math id="M20" name="1471-2105-12-39-i20" overflow="scroll"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mo>Λ</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mover accent="true"><mml:mo>Λ</mml:mo><mml:mo>¯</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> with <inline-formula><mml:math id="M21" name="1471-2105-12-39-i21" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo>Λ</mml:mo><mml:mo>¯</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> the average of the Λ<italic><sub>kj </sub></italic><italic>s</italic>, <italic>t<sub>k </sub></italic>= 2<italic>w<sub>k </sub></italic>+ 1 and <italic>k </italic>= 0, 1. If we let <inline-formula><mml:math id="M22" name="1471-2105-12-39-i22" overflow="scroll"><mml:mrow><mml:mi>ϕ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo>Λ</mml:mo><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo>Λ</mml:mo><mml:mo>¯</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></inline-formula> then the probability of observing <italic>X</italic><sub>0 </sub>= <italic>x</italic><sub>0 </sub>and <italic>X</italic><sub>1 </sub>= <italic>x</italic><sub>1 </sub>is given by</p>
      <p>
        <disp-formula id="bmcM8">
          <label>(8)</label>
          <mml:math id="M23" name="1471-2105-12-39-i23" overflow="scroll">
            <mml:mrow>
              <mml:mi>P</mml:mi>
              <mml:mrow>
                <mml:mo>[</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>X</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mi>X</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">|</mml:mo>
                  <mml:mi>ϕ</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mi>λ</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>]</mml:mo>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:msup>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mo>(</mml:mo>
                    <mml:mrow>
                      <mml:mfrac>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>t</mml:mi>
                            <mml:mn>1</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:msub>
                            <mml:mi>t</mml:mi>
                            <mml:mn>0</mml:mn>
                          </mml:msub>
                        </mml:mrow>
                      </mml:mfrac>
                    </mml:mrow>
                    <mml:mo>)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
              </mml:msup>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>λ</mml:mi>
                    <mml:mn>0</mml:mn>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mn>0</mml:mn>
                      </mml:msub>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:msup>
                    <mml:mi>ϕ</mml:mi>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>x</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msup>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo>!</mml:mo>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo>!</mml:mo>
                </mml:mrow>
              </mml:mfrac>
              <mml:msup>
                <mml:mi>e</mml:mi>
                <mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mi>λ</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                </mml:mrow>
              </mml:msup>
              <mml:msup>
                <mml:mi>e</mml:mi>
                <mml:mrow>
                  <mml:mo>−</mml:mo>
                  <mml:mi>ϕ</mml:mi>
                  <mml:mi>λ</mml:mi>
                  <mml:mn>0</mml:mn>
                  <mml:mfrac>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>t</mml:mi>
                        <mml:mn>1</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>t</mml:mi>
                        <mml:mn>0</mml:mn>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mfrac>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Thus, the log likelihood is</p>
      <p>
        <disp-formula id="bmcM9">
          <label>(9)</label>
          <mml:math id="M24" name="1471-2105-12-39-i24" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mi>ℓ</mml:mi>
                <mml:mn>1</mml:mn>
              </mml:msub>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:mi>ϕ</mml:mi>
                  <mml:mo>,</mml:mo>
                  <mml:mtext> </mml:mtext>
                  <mml:msub>
                    <mml:mi>λ</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mo>=</mml:mo>
              <mml:mo>−</mml:mo>
              <mml:msub>
                <mml:mi>λ</mml:mi>
                <mml:mn>0</mml:mn>
              </mml:msub>
              <mml:mo>+</mml:mo>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mi>ln</mml:mi>
              <mml:msub>
                <mml:mi>λ</mml:mi>
                <mml:mn>0</mml:mn>
              </mml:msub>
              <mml:mo>−</mml:mo>
              <mml:mi>ϕ</mml:mi>
              <mml:msub>
                <mml:mi>λ</mml:mi>
                <mml:mn>0</mml:mn>
              </mml:msub>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mn>1</mml:mn>
              </mml:msub>
              <mml:mi>ln</mml:mi>
              <mml:mi>ϕ</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mn>1</mml:mn>
              </mml:msub>
              <mml:mi>ln</mml:mi>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>−</mml:mo>
              <mml:mi>ln</mml:mi>
              <mml:mo stretchy="false">[</mml:mo>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mn>0</mml:mn>
              </mml:msub>
              <mml:mo>!</mml:mo>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mn>1</mml:mn>
              </mml:msub>
              <mml:mo>!</mml:mo>
              <mml:mo stretchy="false">]</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>from which maximum likelihood estimates for <italic>ϕ </italic>and λ<sub>0 </sub>are obtained as</p>
      <p>
        <disp-formula id="bmcM10">
          <label>(10)</label>
          <mml:math id="M25" name="1471-2105-12-39-i25" overflow="scroll">
            <mml:mrow>
              <mml:mover accent="true">
                <mml:mi>ϕ</mml:mi>
                <mml:mo>^</mml:mo>
              </mml:mover>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM11">
          <label>(11)</label>
          <mml:math id="M26" name="1471-2105-12-39-i26" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mover accent="true">
                  <mml:mi>λ</mml:mi>
                  <mml:mo>^</mml:mo>
                </mml:mover>
                <mml:mn>0</mml:mn>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mn>0</mml:mn>
              </mml:msub>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>If <inline-formula><mml:math id="M27" name="1471-2105-12-39-i27" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo>Λ</mml:mo><mml:mo>¯</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M28" name="1471-2105-12-39-i28" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo>Λ</mml:mo><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are known to be equal, i.e. <italic>ϕ </italic>= 1, we obtain</p>
      <p>
        <disp-formula id="bmcM12">
          <label>(12)</label>
          <mml:math id="M29" name="1471-2105-12-39-i29" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mi>ℓ</mml:mi>
                <mml:mn>0</mml:mn>
              </mml:msub>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mtext> </mml:mtext>
              <mml:mi>λ</mml:mi>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mo>=</mml:mo>
              <mml:mo>−</mml:mo>
              <mml:mi>λ</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mrow>
                <mml:mo>(</mml:mo>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mo>)</mml:mo>
              </mml:mrow>
              <mml:mi>ln</mml:mi>
              <mml:mi>λ</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mi>λ</mml:mi>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>+</mml:mo>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mn>1</mml:mn>
              </mml:msub>
              <mml:mi>ln</mml:mi>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>−</mml:mo>
              <mml:mi>ln</mml:mi>
              <mml:mo stretchy="false">[</mml:mo>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mn>0</mml:mn>
              </mml:msub>
              <mml:mo>!</mml:mo>
              <mml:msub>
                <mml:mi>x</mml:mi>
                <mml:mn>1</mml:mn>
              </mml:msub>
              <mml:mo>!</mml:mo>
              <mml:mo stretchy="false">]</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>and</p>
      <p>
        <disp-formula id="bmcM13">
          <label>(13)</label>
          <mml:math id="M30" name="1471-2105-12-39-i30" overflow="scroll">
            <mml:mrow>
              <mml:mover accent="true">
                <mml:mi>λ</mml:mi>
                <mml:mo>^</mml:mo>
              </mml:mover>
              <mml:mo>=</mml:mo>
              <mml:msub>
                <mml:mi>t</mml:mi>
                <mml:mn>0</mml:mn>
              </mml:msub>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The likelihood ratio statistic can then be written as</p>
      <p>
        <disp-formula id="bmcM14">
          <label>(14)</label>
          <mml:math id="M31" name="1471-2105-12-39-i31" overflow="scroll">
            <mml:mtable>
              <mml:mtr>
                <mml:mtd>
                  <mml:mi>W</mml:mi>
                  <mml:mo>=</mml:mo>
                  <mml:mtext> </mml:mtext>
                  <mml:mn>2</mml:mn>
                  <mml:mtext> </mml:mtext>
                  <mml:mo>{</mml:mo>
                  <mml:msub>
                    <mml:mi>ℓ</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mover accent="true">
                    <mml:mi>ϕ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mo>,</mml:mo>
                  <mml:msub>
                    <mml:mover accent="true">
                      <mml:mi>λ</mml:mi>
                      <mml:mo>^</mml:mo>
                    </mml:mover>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mi>ℓ</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mover accent="true">
                    <mml:mi>λ</mml:mi>
                    <mml:mo>^</mml:mo>
                  </mml:mover>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>}</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>=</mml:mo>
                  <mml:mn>2</mml:mn>
                  <mml:mo>{</mml:mo>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>ln</mml:mi>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo>−</mml:mo>
                  <mml:mi>ln</mml:mi>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>ln</mml:mi>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo>−</mml:mo>
                  <mml:mi>ln</mml:mi>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mo>+</mml:mo>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi>ln</mml:mi>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>t</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">]</mml:mo>
                  <mml:mo>−</mml:mo>
                  <mml:mi>ln</mml:mi>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>0</mml:mn>
                  </mml:msub>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>x</mml:mi>
                    <mml:mn>1</mml:mn>
                  </mml:msub>
                  <mml:mo stretchy="false">]</mml:mo>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>}</mml:mo>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>If <inline-formula><mml:math id="M32" name="1471-2105-12-39-i32" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo>Λ</mml:mo><mml:mo>¯</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M33" name="1471-2105-12-39-i33" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mo>Λ</mml:mo><mml:mo>¯</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> are indeed equal, the asymptotic distribution of <italic>W </italic>is known to be <inline-formula><mml:math id="M34" name="1471-2105-12-39-i34" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>χ</mml:mi><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>.</mml:mo></mml:mrow></mml:math></inline-formula></p>
    </sec>
    <sec>
      <title>Scoring of nucleosome sequence motifs</title>
      <p>The observed frequencies of dinucleotides in DNA that is predicted to be part of the nucleosome core are compared to the genome-wide frequencies by calculating a position specific dinucleotide score <italic>S<sub>ij</sub></italic> (Equation (15)).</p>
      <p>
        <disp-formula id="bmcM15">
          <label>(15)</label>
          <mml:math id="M35" name="1471-2105-12-39-i35" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mi>S</mml:mi>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                  <mml:mi>j</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>o</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                  </mml:msub>
                  <mml:mo>−</mml:mo>
                  <mml:msub>
                    <mml:mi>e</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                </mml:mrow>
                <mml:mrow>
                  <mml:msqrt>
                    <mml:mrow>
                      <mml:msub>
                        <mml:mi>e</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:msqrt>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo>,</mml:mo>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>o<sub>ij </sub></italic>is the number of times dinucleotide <italic>j </italic>is observed at position <italic>i </italic>and <italic>e<sub>j </sub></italic>is the number of times one would expect to see dinucleotide <italic>i </italic>at any given position based on its relative abundance in the genome. Then the statistic <italic>S<sub>i </sub></italic>(Equation (16)) is asymptotically <italic>X</italic><sup>2 </sup>and can be used to determine regions where dinucleotide frequencies differ significantly from the background.</p>
      <p>
        <disp-formula id="bmcM16">
          <label>(16)</label>
          <mml:math id="M36" name="1471-2105-12-39-i36" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mi>S</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:msub>
              <mml:mo>=</mml:mo>
              <mml:mstyle displaystyle="true">
                <mml:munder>
                  <mml:mo>∑</mml:mo>
                  <mml:mi>j</mml:mi>
                </mml:munder>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>S</mml:mi>
                    <mml:mrow>
                      <mml:mi>i</mml:mi>
                      <mml:mi>j</mml:mi>
                    </mml:mrow>
                    <mml:mn>2</mml:mn>
                  </mml:msubsup>
                </mml:mrow>
              </mml:mstyle>
              <mml:mover accent="true">
                <mml:mo>~</mml:mo>
                <mml:mo>˙</mml:mo>
              </mml:mover>
              <mml:msubsup>
                <mml:mi>χ</mml:mi>
                <mml:mrow>
                  <mml:mn>15</mml:mn>
                </mml:mrow>
                <mml:mn>2</mml:mn>
              </mml:msubsup>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
    </sec>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>PH developed and implemented the model and carried out the analysis. CAH conceived, designed and carried out the experiment. PH and CAH wrote the manuscript. DB and GS provided supervision to PH. All authors approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Results of qPCR verification</bold>. The regions chosen for verification are shown with log mean quantities of DNA measured on four replicates. The location of verified nucleosomes is indicated by dark green horizontal bars. Two nucleosome predictions that are not supported by qPCR measurements are shown in red with an alternative position suggested by the PCR results indicated in blue for the nucleosome in region 6. Light blue bars indicate the location of nucleosomes identified by qPCR that were not predicted by our analysis.</p>
      </caption>
      <media xlink:href="1471-2105-12-39-S1.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>Primer sequence and location for amplicons used for qPCR verification of selected regions</bold>.</p>
      </caption>
      <media xlink:href="1471-2105-12-39-S2.XLS" mimetype="application" mime-subtype="vnd.ms-excel">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S3">
      <caption>
        <title>Additional file 3</title>
        <p><bold>Location and p-value of predicted nucleosomes selected for verification</bold>.</p>
      </caption>
      <media xlink:href="1471-2105-12-39-S3.XLS" mimetype="application" mime-subtype="vnd.ms-excel">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>The authors would like to thank Micheal Buckley for his insightful comments on the manuscript. PH is supported by an E-IPRS scholarship from Macquarie University and a top-up scholarship from CSIRO. Additional funding was provided by CSIRO's Transformational Biology Capability Platform.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Albert</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Mavrich</surname>
          <given-names>TN</given-names>
        </name>
        <name>
          <surname>Tomsho</surname>
          <given-names>LP</given-names>
        </name>
        <name>
          <surname>Qi</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Zanton</surname>
          <given-names>SJ</given-names>
        </name>
        <name>
          <surname>Schuster</surname>
          <given-names>SC</given-names>
        </name>
        <name>
          <surname>Pugh</surname>
          <given-names>BF</given-names>
        </name>
        <article-title>Translational and rotational settings of H2A.Z nucleosomes across the Saccharomyces cerevisiae genome</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>446</volume>
        <fpage>572</fpage>
        <lpage>576</lpage>
        <pub-id pub-id-type="doi">10.1038/nature05632</pub-id>
        <pub-id pub-id-type="pmid">17392789</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mavrich</surname>
          <given-names>TN</given-names>
        </name>
        <name>
          <surname>Jiang</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Ioshikhes</surname>
          <given-names>IP</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Venters</surname>
          <given-names>BJ</given-names>
        </name>
        <name>
          <surname>Zanton</surname>
          <given-names>SJ</given-names>
        </name>
        <name>
          <surname>Tomsho</surname>
          <given-names>LP</given-names>
        </name>
        <name>
          <surname>Qi</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Glaser</surname>
          <given-names>RL</given-names>
        </name>
        <name>
          <surname>Schuster</surname>
          <given-names>SC</given-names>
        </name>
        <name>
          <surname>Gilmour</surname>
          <given-names>DS</given-names>
        </name>
        <name>
          <surname>Albert</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Pugh</surname>
          <given-names>BF</given-names>
        </name>
        <article-title>Nucleosome organization in Drosophila</article-title>
        <source>Nature</source>
        <year>2008</year>
        <volume>453</volume>
        <fpage>358</fpage>
        <lpage>364</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06929</pub-id>
        <pub-id pub-id-type="pmid">18408708</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Valouev</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Ichikawa</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Tonthat</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Stuart</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Ranade</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Peckham</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Zeng</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Malek</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Costa</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Mckernan</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Sidow</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Fire</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Johnson</surname>
          <given-names>SM</given-names>
        </name>
        <article-title>A high-resolution, nucleosome position map of C. elegans reveals a lack of universal sequence-dictated positioning</article-title>
        <source>Genome Research</source>
        <year>2008</year>
        <volume>18</volume>
        <fpage>1051</fpage>
        <lpage>1063</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.076463.108</pub-id>
        <pub-id pub-id-type="pmid">18477713</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schones</surname>
          <given-names>DE</given-names>
        </name>
        <name>
          <surname>Cui</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Cuddapah</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Roh</surname>
          <given-names>TY</given-names>
        </name>
        <name>
          <surname>Barski</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Wei</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Dynamic Regulation of Nucleosome Positioning in the Human Genome</article-title>
        <source>Cell</source>
        <year>2008</year>
        <volume>132</volume>
        <fpage>887</fpage>
        <lpage>898</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2008.02.022</pub-id>
        <pub-id pub-id-type="pmid">18329373</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mikkelsen</surname>
          <given-names>TS</given-names>
        </name>
        <name>
          <surname>Ku</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Jaffe</surname>
          <given-names>DB</given-names>
        </name>
        <name>
          <surname>Issac</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Lieberman</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Giannoukos</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Alvarez</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Brockman</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>TK</given-names>
        </name>
        <name>
          <surname>Koche</surname>
          <given-names>RP</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Mendenhall</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>O'Donovan</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Presser</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Russ</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Xie</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Meissner</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Wernig</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Jaenisch</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Nusbaum</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Lander</surname>
          <given-names>ES</given-names>
        </name>
        <name>
          <surname>Bernstein</surname>
          <given-names>BE</given-names>
        </name>
        <article-title>Genome-wide maps of chromatin state in pluripotent and lineage-committed cells</article-title>
        <source>Nature</source>
        <year>2007</year>
        <volume>448</volume>
        <fpage>553</fpage>
        <lpage>560</lpage>
        <pub-id pub-id-type="doi">10.1038/nature06008</pub-id>
        <pub-id pub-id-type="pmid">17603471</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Barski</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Cuddapah</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Cui</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Roh</surname>
          <given-names>TY</given-names>
        </name>
        <name>
          <surname>Schones</surname>
          <given-names>DE</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>K</given-names>
        </name>
        <article-title>High-resolution profiling of histone methylations in the human genome</article-title>
        <source>Cell</source>
        <year>2007</year>
        <volume>129</volume>
        <fpage>823</fpage>
        <lpage>837</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2007.05.009</pub-id>
        <pub-id pub-id-type="pmid">17512414</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Johnson</surname>
          <given-names>DS</given-names>
        </name>
        <name>
          <surname>Motazavi</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Myers</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Wold</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Genome-wide mapping of in vivo protein-DNA interactions</article-title>
        <source>Science</source>
        <year>2007</year>
        <volume>316</volume>
        <fpage>1497</fpage>
        <lpage>1502</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1141319</pub-id>
        <pub-id pub-id-type="pmid">17540862</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Robertson</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Hirst</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Bainbridge</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Bilenky</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Zeng</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Euskirchen</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Bernier</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Varhol</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Delaney</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Thiessen</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Griffith</surname>
          <given-names>OL</given-names>
        </name>
        <name>
          <surname>He</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Marra</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Snyder</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Jones</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Genome-wide profiles of STAT1 DNA association using chromatin immunoprecipitation and massively parallel sequencing</article-title>
        <source>Nature Methods</source>
        <year>2007</year>
        <volume>4</volume>
        <issue>8</issue>
        <fpage>651</fpage>
        <lpage>657</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth1068</pub-id>
        <pub-id pub-id-type="pmid">17558387</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Rozowsky</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Euskirchen</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Auerbach</surname>
          <given-names>RK</given-names>
        </name>
        <name>
          <surname>Zhang</surname>
          <given-names>ZD</given-names>
        </name>
        <name>
          <surname>Gibson</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Bjornson</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Carriero</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Snyder</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Gerstein</surname>
          <given-names>MB</given-names>
        </name>
        <article-title>PeakSeq enables systematic scoring of ChIP-seq experiments relative to controls</article-title>
        <source>Nature Biotechnology</source>
        <year>2009</year>
        <volume>27</volume>
        <fpage>66</fpage>
        <lpage>75</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1518</pub-id>
        <pub-id pub-id-type="pmid">19122651</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ji</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Jiang</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Ma</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Johnson</surname>
          <given-names>DS</given-names>
        </name>
        <name>
          <surname>Myers</surname>
          <given-names>RM</given-names>
        </name>
        <name>
          <surname>Wong</surname>
          <given-names>WH</given-names>
        </name>
        <article-title>An integrated software system for analyzing ChIP-chip and ChIP-seq data</article-title>
        <source>Nature Biotechnology</source>
        <year>2008</year>
        <volume>26</volume>
        <issue>11</issue>
        <fpage>1293</fpage>
        <lpage>1300</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1505</pub-id>
        <pub-id pub-id-type="pmid">18978777</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Xu</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Wei</surname>
          <given-names>CL</given-names>
        </name>
        <name>
          <surname>Lin</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Sung</surname>
          <given-names>WK</given-names>
        </name>
        <article-title>An HMM approach to genome-wide identification of differential histone modification sites from ChIP-seq data</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>20</issue>
        <fpage>2344</fpage>
        <lpage>2349</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn402</pub-id>
        <pub-id pub-id-type="pmid">18667444</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Boyle</surname>
          <given-names>AP</given-names>
        </name>
        <name>
          <surname>Guinney</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Crawford</surname>
          <given-names>GE</given-names>
        </name>
        <name>
          <surname>Furey</surname>
          <given-names>TS</given-names>
        </name>
        <article-title>F-Seq: a feature density estimator for high-throughput sequence tags</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>21</issue>
        <fpage>2537</fpage>
        <lpage>2538</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn480</pub-id>
        <pub-id pub-id-type="pmid">18784119</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Albert</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Wachi</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Jiang</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Pugh</surname>
          <given-names>BF</given-names>
        </name>
        <article-title>GeneTrack: a genomic data processing and visualization framework</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <issue>10</issue>
        <fpage>1305</fpage>
        <lpage>1306</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btn119</pub-id>
        <pub-id pub-id-type="pmid">18388141</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kharchenko</surname>
          <given-names>PV</given-names>
        </name>
        <name>
          <surname>Tolstorukov</surname>
          <given-names>MY</given-names>
        </name>
        <name>
          <surname>Park</surname>
          <given-names>PJ</given-names>
        </name>
        <article-title>Design and analysis of ChIP-seq experiments for DNA-binding proteins</article-title>
        <source>Nature Biotechnology</source>
        <year>2008</year>
        <volume>26</volume>
        <issue>12</issue>
        <fpage>1351</fpage>
        <lpage>1359</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1508</pub-id>
        <pub-id pub-id-type="pmid">19029915</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Jothi</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Cuddapah</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Barski</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Cui</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Genome-wide identification of in vivo protein-DNA binding sites from ChIP-Seq data</article-title>
        <source>Nucleic Acid Research</source>
        <year>2008</year>
        <volume>36</volume>
        <issue>16</issue>
        <fpage>5221</fpage>
        <lpage>5231</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkn488</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zang</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Schones</surname>
          <given-names>DE</given-names>
        </name>
        <name>
          <surname>Zeng</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Cui</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Zhao</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Peng</surname>
          <given-names>W</given-names>
        </name>
        <article-title>A clustering approach for identification of enriched domains from histone modification ChIP-Seq data</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>15</issue>
        <fpage>1952</fpage>
        <lpage>1958</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp340</pub-id>
        <pub-id pub-id-type="pmid">19505939</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Spyrou</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Stark</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Lynch</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Tavare</surname>
          <given-names>S</given-names>
        </name>
        <article-title>BayesPeak: Bayesian analysis of ChIP-seq data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2009</year>
        <volume>10</volume>
        <fpage>299+</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-10-299</pub-id>
        <pub-id pub-id-type="pmid">19772557</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Benjamini</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Hochberg</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>Controlling false discovery rate: a practical and powerful approach to multiple testing</article-title>
        <source>Journal of the Royal Statistical Society B</source>
        <year>1995</year>
        <volume>57</volume>
        <fpage>289</fpage>
        <lpage>300</lpage>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="other">
        <name>
          <surname>Yin</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Soteros</surname>
          <given-names>CE</given-names>
        </name>
        <name>
          <surname>Bickis</surname>
          <given-names>MG</given-names>
        </name>
        <article-title>A clarifying comparison of methods for controlling the false discovery rate</article-title>
        <source>Journal of Statistical Planning and Inference</source>
        <year>2008</year>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Storey</surname>
          <given-names>JD</given-names>
        </name>
        <name>
          <surname>Taylor</surname>
          <given-names>JE</given-names>
        </name>
        <name>
          <surname>Siegmund</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Strong control, conservative point estimation and simultaneous conservative consistency of false discovery rates: a unified approach</article-title>
        <source>Journal of the Royal Statistical Society B</source>
        <year>2004</year>
        <volume>66</volume>
        <fpage>187</fpage>
        <lpage>205</lpage>
        <pub-id pub-id-type="doi">10.1111/j.1467-9868.2004.00439.x</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Watanabe</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Information Theoretical Analysis of Multivariate Correlation</article-title>
        <source>IBM Journal of Research and Development</source>
        <year>1960</year>
        <volume>4</volume>
        <fpage>66+</fpage>
        <pub-id pub-id-type="doi">10.1147/rd.41.0066</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Segal</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Mittendorf</surname>
          <given-names>YF</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Thåström</surname>
          <given-names>AC</given-names>
        </name>
        <name>
          <surname>Field</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Moore</surname>
          <given-names>IK</given-names>
        </name>
        <name>
          <surname>Widom</surname>
          <given-names>J</given-names>
        </name>
        <article-title>A genomic code for nucleosome positioning</article-title>
        <source>Nature</source>
        <year>2006</year>
        <volume>442</volume>
        <issue>17</issue>
        <fpage>772</fpage>
        <lpage>778</lpage>
        <pub-id pub-id-type="doi">10.1038/nature04979</pub-id>
        <pub-id pub-id-type="pmid">16862119</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kogan</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Trifonov</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Gene splice sites correlate with nucleosome positions</article-title>
        <source>Gene</source>
        <year>2005</year>
        <volume>352</volume>
        <fpage>57</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="doi">10.1016/j.gene.2005.03.004</pub-id>
        <pub-id pub-id-type="pmid">15862762</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lee</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Tillo</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Bray</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Morse</surname>
          <given-names>RH</given-names>
        </name>
        <name>
          <surname>Davis</surname>
          <given-names>RW</given-names>
        </name>
        <name>
          <surname>Hughes</surname>
          <given-names>TR</given-names>
        </name>
        <name>
          <surname>Nislow</surname>
          <given-names>C</given-names>
        </name>
        <article-title>A high-resolution atlas of nucleosome occupancy in yeast</article-title>
        <source>Nature Genetics</source>
        <year>2007</year>
        <volume>39</volume>
        <issue>10</issue>
        <fpage>1235</fpage>
        <lpage>1244</lpage>
        <pub-id pub-id-type="doi">10.1038/ng2117</pub-id>
        <pub-id pub-id-type="pmid">17873876</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Peckham</surname>
          <given-names>HE</given-names>
        </name>
        <name>
          <surname>Thurman</surname>
          <given-names>RE</given-names>
        </name>
        <name>
          <surname>Fu</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Stamatoyannopoulos</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Noble</surname>
          <given-names>WS</given-names>
        </name>
        <name>
          <surname>Struhl</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Weng</surname>
          <given-names>Z</given-names>
        </name>
        <article-title>Nucleosome positioning signals in genomic DNA</article-title>
        <source>Genome Research</source>
        <year>2007</year>
        <volume>17</volume>
        <issue>8</issue>
        <fpage>1170</fpage>
        <lpage>1177</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.6101007</pub-id>
        <pub-id pub-id-type="pmid">17620451</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kharchenko</surname>
          <given-names>PV</given-names>
        </name>
        <name>
          <surname>Woo</surname>
          <given-names>CJ</given-names>
        </name>
        <name>
          <surname>Tolstorukov</surname>
          <given-names>MY</given-names>
        </name>
        <name>
          <surname>Kingston</surname>
          <given-names>RE</given-names>
        </name>
        <name>
          <surname>Park</surname>
          <given-names>PJ</given-names>
        </name>
        <article-title>Nucleosome positioning in human HOX gene clusters</article-title>
        <source>Genome Research</source>
        <year>2008</year>
        <volume>18</volume>
        <issue>10</issue>
        <fpage>1554</fpage>
        <lpage>1561</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.075952.107</pub-id>
        <pub-id pub-id-type="pmid">18723689</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Jiang</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Pugh</surname>
          <given-names>BF</given-names>
        </name>
        <article-title>Nucleosome positioning and gene regulation: advances through genomics</article-title>
        <source>Nature Reviews Genetics</source>
        <year>2009</year>
        <volume>10</volume>
        <issue>3</issue>
        <fpage>161</fpage>
        <lpage>172</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg2522</pub-id>
        <pub-id pub-id-type="pmid">19204718</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Taslim</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Wu</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Yan</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Singer</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Parvin</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Huang</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Lin</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Huang</surname>
          <given-names>K</given-names>
        </name>
        <article-title>Comparative study on ChIP-seq data: normalization and binding pattern characterization</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <issue>18</issue>
        <fpage>2334</fpage>
        <lpage>2340</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp384</pub-id>
        <pub-id pub-id-type="pmid">19561022</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
