<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8023681</article-id>
    <article-id pub-id-type="pmid">33399819</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa1081</article-id>
    <article-id pub-id-type="publisher-id">btaa1081</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Accurate, scalable cohort variant calls using DeepVariant and GLnexus</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-6242-5536</contrib-id>
        <name>
          <surname>Yun</surname>
          <given-names>Taedong</given-names>
        </name>
        <aff><institution>Google Health</institution>, Cambridge, MA 02142, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-1145-6527</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Helen</given-names>
        </name>
        <aff><institution>Google Health</institution>, Palo Alto, CA 94304, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chang</surname>
          <given-names>Pi-Chuan</given-names>
        </name>
        <aff><institution>Google Health</institution>, Palo Alto, CA 94304, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Michael F</given-names>
        </name>
        <aff><institution>mlin.net LLC</institution>, Honolulu, HI 96816, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-4824-6689</contrib-id>
        <name>
          <surname>Carroll</surname>
          <given-names>Andrew</given-names>
        </name>
        <aff><institution>Google Health</institution>, Palo Alto, CA 94304, <country country="US">USA</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-9928-8216</contrib-id>
        <name>
          <surname>McLean</surname>
          <given-names>Cory Y</given-names>
        </name>
        <xref rid="btaa1081-cor1" ref-type="corresp"/>
        <aff><institution>Google Health</institution>, Cambridge, MA 02142, <country country="US">USA</country></aff>
        <!--cym@google.com-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Robinson</surname>
          <given-names>Peter</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa1081-cor1">To whom correspondence should be addressed. <email>cym@google.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>12</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2021-01-05">
      <day>05</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>1</month>
      <year>2021</year>
    </pub-date>
    <volume>36</volume>
    <issue>24</issue>
    <fpage>5582</fpage>
    <lpage>5589</lpage>
    <history>
      <date date-type="received">
        <day>03</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>27</day>
        <month>9</month>
        <year>2020</year>
      </date>
      <date date-type="editorial-decision">
        <day>10</day>
        <month>12</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>16</day>
        <month>12</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2021</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa1081.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Population-scale sequenced cohorts are foundational resources for genetic analyses, but processing raw reads into analysis-ready cohort-level variants remains challenging.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We introduce an open-source cohort-calling method that uses the highly accurate caller DeepVariant and scalable merging tool GLnexus. Using callset quality metrics based on variant recall and precision in benchmark samples and Mendelian consistency in father-mother-child trios, we optimize the method across a range of cohort sizes, sequencing methods and sequencing depths. The resulting callsets show consistent quality improvements over those generated using existing best practices with reduced cost. We further evaluate our pipeline in the deeply sequenced 1000 Genomes Project (1KGP) samples and show superior callset quality metrics and imputation reference panel performance compared to an independently generated GATK Best Practices pipeline.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>We publicly release the 1KGP individual-level variant calls and cohort callset (<ext-link xlink:href="https://console.cloud.google.com/storage/browser/brain-genomics-public/research/cohort/1KGP" ext-link-type="uri">https://console.cloud.google.com/storage/browser/brain-genomics-public/research/cohort/1KGP</ext-link>) to foster additional development and evaluation of cohort merging methods as well as broad studies of genetic variation. Both DeepVariant (<ext-link xlink:href="https://github.com/google/deepvariant" ext-link-type="uri">https://github.com/google/deepvariant</ext-link>) and GLnexus (<ext-link xlink:href="https://github.com/dnanexus-rnd/GLnexus" ext-link-type="uri">https://github.com/dnanexus-rnd/GLnexus</ext-link>) are open-source, and the optimized GLnexus setup discovered in this study is also integrated into GLnexus public releases v1.2.2 and later.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NHGRI</institution>
            <institution-id institution-id-type="DOI">10.13039/100000051</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>3UM1HG008901-03S1</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Google LLC</institution>
            <institution-id institution-id-type="DOI">10.13039/100006785</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Sequencing a single individual can identify variants informative for diseases (<xref rid="btaa1081-B48" ref-type="bibr">Yang et al., 2013</xref>), traits (<xref rid="btaa1081-B46" ref-type="bibr">Welter et al., 2014</xref>) and ancestry (<xref rid="btaa1081-B44" ref-type="bibr">The 1000 Genomes Project Consortium, 2010</xref>). Jointly using sequence data of multiple individuals can discover rare genetic diseases (<xref rid="btaa1081-B38" ref-type="bibr">Ramoni et al., 2017</xref>). Population-scale sequencing generates annotation resources for clinical sequencing, such as dbSNP (<xref rid="btaa1081-B41" ref-type="bibr">Sherry, 2001</xref>), ExAC (<xref rid="btaa1081-B23" ref-type="bibr">Lek <italic toggle="yes">et al.</italic>, 2016</xref>), DiscovEHR (<xref rid="btaa1081-B10" ref-type="bibr">Dewey et al., 2016</xref>), TOPMed (<xref rid="btaa1081-B43" ref-type="bibr">Taliun et al., 2019</xref>) and gnomAD (<xref rid="btaa1081-B18" ref-type="bibr">Karczewski <italic toggle="yes">et al.</italic>, 2020</xref>), and enables well-powered association studies (<xref rid="btaa1081-B35" ref-type="bibr">Ozaki et al., 2002</xref>) in large datasets of sequenced and phenotyped individuals (<xref rid="btaa1081-B5" ref-type="bibr">Bycroft et al., 2018</xref>).</p>
    <p>Single-sample variant calling methods (<xref rid="btaa1081-B13" ref-type="bibr">Garrison and Marth, 2012</xref>; <xref rid="btaa1081-B20" ref-type="bibr">Kim et al., 2018</xref>; <xref rid="btaa1081-B30" ref-type="bibr">Luo et al., 2019</xref>; <xref rid="btaa1081-B32" ref-type="bibr">McKenna et al., 2010</xref>; <xref rid="btaa1081-B37" ref-type="bibr">Poplin et al., 2018b</xref>) use sequence reads mapped to a reference genome to identify and genotype positions which differ from the reference. Many variant callers support the generation of Genome Variant Call Format (gVCF) outputs, which supplement the variant calls with block records of non-variant regions annotated with confidence estimates that the regions match the reference genome. Joint genotyping tools such as GATK GenotypeGVCFs (<xref rid="btaa1081-B36" ref-type="bibr">Poplin et al., 2018a</xref>) and GLnexus (<xref rid="btaa1081-B27" ref-type="bibr">Lin et al., 2018</xref>) transform a cohort of gVCFs into a project-level VCF that contains a complete matrix of every variant in a cohort with a call for each sample. Compared to a full joint-calling strategy, joint genotyping both substantially reduces the size of required input data and avoids the need to fully reprocess all samples when adding samples to an existing cohort.</p>
    <p>Joint genotyping of large cohorts introduces unique challenges. Harmonizing the representation of overlapping alleles is algorithmically intricate, and the number of overlapping alleles increases with cohort size. In addition, even with high single-sample variant calling accuracy, many samples will aggregate a large number of total errors. At the same time, large cohorts present unique opportunities to increase accuracy. Cross-referencing genotype likelihoods across a cohort can help refine calls and filter errors, for example by identifying recurrent artifacts that violate Hardy-Weinberg equilibrium (HWE) (<xref rid="btaa1081-B16" ref-type="bibr">Hardy, 1908</xref>).</p>
    <p>Here, we introduce a framework to generate highly accurate and scalable cohort callsets with DeepVariant, using its superior calibration of variant confidences and high single-sample accuracy (<xref rid="btaa1081-B37" ref-type="bibr">Poplin <italic toggle="yes">et al.</italic>, 2018b</xref>). We adapt the scalable joint genotyper GLnexus (<xref rid="btaa1081-B27" ref-type="bibr">Lin <italic toggle="yes">et al.</italic>, 2018</xref>) to DeepVariant gVCFs and tune filtering and genotyping parameters to optimize performance for whole-genome sequences (WGS) and whole-exome sequences (WES) across a range of sequence coverages and cohort sizes. We compare the resulting callsets to analogous callsets generated by the broadly used GATK Best Practices (<xref rid="btaa1081-B9" ref-type="bibr">DePristo et al., 2011</xref>) which serve as current state-of-the-art benchmarks. Finally, we apply the optimized method to the recent deep sequencing of the 1000 Genomes Project (1KGP) phase 3 samples (<xref rid="btaa1081-B45" ref-type="bibr">The 1000 Genomes Project Consortium, 2015</xref>). We evaluate the resulting callset across multiple quality metrics and performance as an imputation reference panel against a callset independently generated using a GATK Best Practices pipeline.</p>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <sec>
      <title>2.1 Data acquisition and preparation</title>
      <p>Throughout this study we use the human GRCh38 reference genome with no ALT contigs. We use 7 WGS samples (HG001-HG007), 2 WES samples (HG001, HG002) from Genome in a Bottle (GIAB) project (<xref rid="btaa1081-B50" ref-type="bibr">Zook <italic toggle="yes">et al.</italic>, 2014</xref>,<xref rid="btaa1081-B51" ref-type="bibr"> 2019</xref>), 929 WGS and 346 WES samples from Clinical Sequencing Evidence-Generating Research (CSER) (<xref rid="btaa1081-B1" ref-type="bibr">Amendola <italic toggle="yes">et al.</italic>, 2018</xref>), and finally 313 WGS samples from Population Architecture Using Genomics and Epidemiology (PAGE) (<xref rid="btaa1081-B31" ref-type="bibr">Matise <italic toggle="yes">et al.</italic>, 2011</xref>). All WGS samples are deeply sequenced at 40–50× coverage. We identify 249 disjoint trios in CSER WGS samples, among which we randomly selected five WGS trios and five WES trios (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>) among non-outliers to use for Mendelian violation rate estimation during callset evaluation. To identify the outlier samples, we examined six variant summary statistics for each sample: the number of total records, SNPs and indels, the Ti:Tv ratio, the mean SNP quality and the mean indel quality. Non-outliers are defined as the samples whose z-scores for all six statistics are at most one.</p>
      <p>We created custom WGS cohorts of size 3, 100, 333 and 1247 and a WES cohort of size 346 using the above samples (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2 and S8</xref>) for which both GIAB concordance and Mendelian violation rate could be evaluated. We used the GIAB benchmark variant v3.3.2 to evaluate concordance. Finally, we created 15× autosomal coverage BAMs from all BAM files from GIAB, CSER and PAGE datasets by downsampling the full BAMs with samtools (<xref rid="btaa1081-B26" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2009</xref>) (‘samtools view -s’).</p>
      <p>For our independent evaluation and demonstration with 1KGP, we used the recent deep sequencing (~30× coverage) of the 1KGP phase 3 cohort by New York Genome Center. We used third party tools such as samtools (Li <italic toggle="yes">et al.</italic>, 2009), BWA-MEM (<xref rid="btaa1081-B24" ref-type="bibr">Li, 2013</xref>), samblaster (<xref rid="btaa1081-B12" ref-type="bibr">Faust and Hall, 2014</xref>), etc. for data processing steps outlined above. Full details can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note</xref> S2.</p>
    </sec>
    <sec>
      <title>2.2 DeepVariant and GLnexus</title>
      <p>We used DeepVariant v0.8.0 and the publicly released WGS model v0.8.0 to generate the single-sample variant calls for all samples in GIAB, CSER and PAGE. A single-line command to run DeepVariant in a pre-built docker container is available on the DeepVariant public repository (<ext-link xlink:href="https://github.com/google/deepvariant" ext-link-type="uri">https://github.com/google/deepvariant</ext-link>). The DeepVariant calls for the sample from 1000 Genomes Project were generated using a custom model trained exclusively for the NovaSeq platform. Both the custom model and all single-sample DeepVariant calls generated by it are publicly available, as described in ‘Availability and Implementation’ in the Abstract.</p>
      <p>To merge and evaluate the multiple cohorts in parallel, we deployed the open-source GLnexus algorithm using Apache Beam (<ext-link xlink:href="https://beam.apache.org" ext-link-type="uri">https://beam.apache.org</ext-link>) on Google internal compute clusters. The Beam-based pipeline abstracts away the need to specify multi-threading on a single machine (as is done in the open-source GLnexus), and deploys hundreds of different parameter configurations on thousands of CPUs. The pipeline produces identical scientific results to the open-source GLnexus v1.2.2 when run with the same parameters. To both ensure our train/test dataset split is non-overlapping and limit computational costs of this study, we used separate individual chromosomes for pipeline optimization and evaluation. For consistency with previous studies (<xref rid="btaa1081-B27" ref-type="bibr">Lin <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btaa1081-B37" ref-type="bibr">Poplin <italic toggle="yes">et al.</italic>, 2018b</xref>), we used chromosome 2 to optimize the pipeline, and computed final performance benchmarks separately on chromosome 20. The optimized DeepVariant parameters from this study, which are discussed in detail in Results, are included in open-source GLnexus v1.2.2 or later versions in two presets: –<monospace>config DeepVariantWGS</monospace> for WGS and –<monospace>config DeepVariantWES</monospace> for WES. After installing the GLnexus command line tool, users can merge DeepVariant calls in these optimized setups using a single command like</p>
      <p>
        <disp-quote content-type="extract">
          <p>$ <monospace>glnexus_cli –config DeepVariantWGS \</monospace></p>
          <p>
            <monospace> deepvariant.*.g.vcf.gz &gt; cohort.bcf</monospace>
          </p>
        </disp-quote>
      </p>
      <p>In addition to parameter optimization, we modified the internals of both DeepVariant and GLnexus for better communication between the tools and to improve the joint-calling process. All modifications were incorporated into open-sourced DeepVariant (v0.8.0 or later) and GLnexus (v1.2.2 or later).</p>
    </sec>
    <sec>
      <title>2.3 GATK</title>
      <p>We followed GATK Best Practices v4.1.2.0 to establish the baseline performance of each callset generated from GIAB, CSER and PAGE data. Starting from the BAM files, prepared as described above, we ran HaplotypeCaller in GVCF mode to call single-sample variants, followed by GenomicsDBImport and GenotypeGVCFs to consolidate and jointly genotype the cohort, and finally VariantRecalibrator and ApplyVQSR for variant quality score recalibration (VQSR) (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Note</xref> S3 for full details). We performed the steps on each chromosome separately in parallel and combined calls at the end to speed up the process. Cost benchmarking was performed on chromosome 20. For the 1KGP samples, we downloaded the GATK cohort callset independently generated by the New York Genome Center using samtools v1.3.1, Picard v2.4.1 and GATK v3.5. The complete description of the pipeline used to generate this callset is available on the European Bioinformatics Institute’s FTP (<ext-link xlink:href="http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage/working/20190425_NYGC_GATK/1000G_README_2019April10_NYGCjointcalls.pdf" ext-link-type="uri">http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/data_collections/1000G_2504_high_coverage/working/20190425_NYGC_GATK/1000G_README_2019April10_NYGCjointcalls.pdf</ext-link>).</p>
    </sec>
    <sec>
      <title>2.4 Single-sample variant call statistics</title>
      <p>We used bcftools v1.9 (samtools.github.io/bcftools) and hap.py v0.3.9 (<xref rid="btaa1081-B21" ref-type="bibr">Krusche <italic toggle="yes">et al.</italic>, 2019</xref>) (github.com/illumina/hap.py) to generate basic call statistics from single-sample VCFs in the GIAB, PAGE and CSER datasets.</p>
    </sec>
    <sec>
      <title>2.5 GLnexus parameter optimization</title>
      <p>We used Google Vizier (<xref rid="btaa1081-B14" ref-type="bibr">Golovin et al., 2017</xref>), a Google-internal service for performing black-box optimization, for optimizing the configurable parameters of GLnexus (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>). We constructed an optimization objective function incorporating both GIAB benchmark call concordance and the rate of Mendelian violations, and optimized the parameters for this objective in two steps, first using Pareto-optimal search algorithm to reduce the search space and then performing an exhaustive grid search within the reduced parameter space. Complete details of this work can be found in Results and in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note</xref> S4.</p>
    </sec>
    <sec>
      <title>2.6 1KGP imputation reference panel creation</title>
      <p>We generated the 1KGP reference panels from DV-GLN-OPT and GATK-VQSR callsets (see Results) by applying identical minimal transformations to them and phasing them with Eagle2 (<xref rid="btaa1081-B29" ref-type="bibr">Loh et al., 2016</xref>). We followed a standard pipeline for generating a reference panel recommended in Eagle’s website. More details and a script used for these steps are included in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note</xref>s S2 and S5.</p>
    </sec>
    <sec>
      <title>2.7 Imputing pseudo-microarray variant calls</title>
      <p>To evaluate 1KGP imputation reference panels, we first generated pseudo-microarray variant calls from GIAB benchmark variants of HG002 and HG005 in the benchmark regions by extracting the variant sites used by a popular commercial microarray kit (Illumina Infinium OmniExpress-24). We obtained the microarray sites from the CSV manifest file (GRCh38 version) on Illumina’s official website (<ext-link xlink:href="http://ftp://webdata2:webdata2@ussd-ftp.illumina.com/downloads/productfiles/humanomniexpress-24/v1-2/infinium-omniexpress-24-v1-2-manifest-file-csv.zip" ext-link-type="uri">ftp://webdata2:webdata2@ussd-ftp.illumina.com/downloads/productfiles/humanomniexpress-24/v1-2/infinium-omniexpress-24-v1-2-manifest-file-csv.zip</ext-link>) and converted it to VCF format using Illumina’s GTCtoVCF tool (github.com/Illumina/GTCtoVCF).</p>
      <p>Starting from GIAB v3.3.2 benchmark variants for HG002 and HG005, we removed all existing phasing information from the VCF, extracted the high-confidence variants in the microarray sites using bcftools v1.9, and added homozygous-reference genotypes to all microarray sites not present in GIAB VCFs. We phased the resulting pseudo-microarray variants with Eagle v2.4.1 using the reference panel to evaluate (DV-GLN-OPT or GATK-VQSR, see Results) and the hg38 genetic map file released with Eagle.</p>
      <p>Finally, we imputed the phased pseudo-microarray variants with Beagle v5.0 (<xref rid="btaa1081-B4" ref-type="bibr">Browning et al., 2018</xref>) using the same reference panel used in the phasing step. A complete script for running Beagle can be found in <xref rid="sup1" ref-type="supplementary-material">Supplementary Note</xref> S6.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 Cohort variant call evaluation strategies</title>
      <p>In contrast to single-sample variant calling, for which the Genome in a Bottle (GIAB) (<xref rid="btaa1081-B50" ref-type="bibr">Zook et al., 2014</xref>, <xref rid="btaa1081-B51" ref-type="bibr">2019</xref>) dataset enables broadly accepted accuracy metrics to benchmark and compare tools and methods (<ext-link xlink:href="https://precision.fda.gov/challenges/truth" ext-link-type="uri">https://precision.fda.gov/challenges/truth</ext-link> and <ext-link xlink:href="https://precision.fda.gov/challenges/10" ext-link-type="uri">https://precision.fda.gov/challenges/10</ext-link>), for cohort variant calls there is no existing standard for comparison. Here we use four different measures of variant calling accuracy to optimize and evaluate cohort variant calls, for single nucleotide variants, small indels (excluding structural variants), and homozygous reference regions. For both optimization and evaluation, we examined two accuracy metrics: (i<bold>)</bold> we computed concordance of the Genome in a Bottle (GIAB) HG001-HG007 benchmark samples to directly measure variant accuracy within the well-characterized 83% of the genome in the GRCh38 GIAB v3.3.2 benchmark regions, and (ii<bold>)</bold> we computed Mendelian violation rates in trios to indirectly measure variant accuracy genome-wide. For evaluation only, we included two additional indirect measures of callset quality: (iii<bold>)</bold> we computed the ratio of transitions to transversions (Ti:Tv ratio) of single nucleotide polymorphisms (SNPs) for all samples to measure deviations from the expected genome-wide ratio of approximately 2.0–2.1 (<xref rid="btaa1081-B2" ref-type="bibr">Bainbridge et al., 2011</xref>), as random genotyping errors would reduce this ratio, and (iv<bold>)</bold> we computed deviations from HWE at the cohort level, which can be indicative of recurrent artifacts in a variant calling algorithm (<xref rid="btaa1081-B15" ref-type="bibr">Graffelman et al., 2017</xref>).</p>
    </sec>
    <sec>
      <title>3.2 Cohorts used in development and evaluation</title>
      <p>Four distinct data sources were used to optimize and evaluate cohort variant calls. The first data source is the aforementioned GIAB consortium which provides a well-characterized set of truth variants. To maximize the diversity of samples and sites used for evaluation, other trios in the cohort were used to compute Mendelian violation rates (with the sole exception being the three person HG002-HG003-HG004 cohort) and the children of GIAB trios were excluded from the GIAB metrics calculations. The second data source is the Clinical Sequencing Evidence-Generating Research (CSER) consortium (<xref rid="btaa1081-B1" ref-type="bibr">Amendola et al., 2018</xref>), which contains 929 WGS and 344 WES samples, including 249 WGS trios and 112 WES trios. The third data source is the Population Architecture using Genomics and Epidemiology (PAGE) consortium (<xref rid="btaa1081-B31" ref-type="bibr">Matise et al., 2011</xref>), which contains 313 WGS. The final data source is the recent 30× WGS of 2504 individuals from 1KGP. We fully withheld the 1KGP cohort from development, only using it as a final independent evaluation set. Within this cohort, a single cryptic trio (<xref rid="btaa1081-B39" ref-type="bibr">Roslin et al., 2016</xref>) was used to compute Mendelian violation rates.</p>
      <p>We performed analyses both at full sequence coverage as well as in the same cohorts downsampled to 15× coverage. We targeted robust performance across the diversity of sequencing projects by representing cohorts of high and low coverage, WES and WGS, those sequenced by various groups, on various instruments, and across a wide array of ancestries.</p>
    </sec>
    <sec>
      <title>3.3 Quality properties of single-sample variant calls</title>
      <p>We first investigated variant call properties of 1248 individuals from the GIAB (<italic toggle="yes">n</italic><bold> </bold>=<bold> </bold>6), CSER (<italic toggle="yes">n</italic><bold> </bold>=<bold> </bold>929) and PAGE (<italic toggle="yes">n</italic><bold> </bold>=<bold> </bold>313) cohorts. The total number of SNPs reported by DeepVariant is lower than GATK4 HaplotypeCaller for nearly all individuals, and the number of indels is also lower for most individuals. However, the Ti: Tv ratio measured in all individuals, and both precision and recall computed separately for SNPs and indels in the six GIAB individuals, are all higher in DeepVariant than GATK4 HaplotypeCaller (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>).</p>
      <p>To illustrate why different single-sample variant callers require separate calibration during joint genotyping, we compared Genotype Quality (GQ) scores estimated by each caller, defined as the Phred-scaled conditional probability that a genotype is incorrect, to GQ scores derived empirically from GIAB ground truth (<xref rid="btaa1081-F1" ref-type="fig">Fig. 1</xref>). In detail, we first binned the variants by their GQ values estimated by each caller, computed the empirical error rate for variants in each bin against the GIAB truth, and then converted the empirical error rate to Phred-scale to obtain the empirical GQ for each bin. DeepVariant shows markedly better GQ calibration than GATK4 HaplotypeCaller at all reported GQ scores (<xref rid="btaa1081-F1" ref-type="fig">Fig. 1A, B</xref>). DeepVariant is well-calibrated both across sequence coverages and when stratified by variant type, with a slight bias toward overconfidence in homozygous alternate SNPs (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>). To rigorously quantify GQ calibration, we computed the Brier score (<xref rid="btaa1081-B3" ref-type="bibr">Brier, 1950</xref>) and Spiegelhalter’s Z statistic (<xref rid="btaa1081-B42" ref-type="bibr">Spiegelhalter, 1986</xref>) by converting the Phred-scaled GQ into the caller’s estimated probability of correctly calling the genotype, and comparing it to the GIAB truth (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). Substantially lower Brier scores (0.000918 for DeepVariant and 0.005371 for GATK, averaged over all samples) and Spiegelhalter’s Z values (0.52 for DeepVariant and 1141.03 for GATK, averaged over all samples) confirm DeepVariant’s superior calibration.</p>
      <fig position="float" id="btaa1081-F1">
        <label>Fig. 1.</label>
        <caption>
          <p>Genotype quality (GQ) distribution properties of PASS variants. (<bold>A</bold>) Genotype quality calibration for DeepVariant v0.8.0. Reported GQ is plotted against the empirical GQ calculated using genome-wide GIAB benchmark variant calls at 40× coverage. Each data point is a set of variant calls with the same GQ (<italic toggle="yes">x</italic>-axis), and the <italic toggle="yes">y</italic>-axis value is the empirical error rate calculated from the GIAB truth set. Both axes are in Phred-scale. Marker areas are proportional to the square root of the number of variants. The dotted <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mrow><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow></mml:math></inline-formula> line represents perfect calibration. (<bold>B</bold>) Genotype quality calibration for GATK4 HaplotypeCaller, analogous to (A). (<bold>C</bold>) Distributions of reported GQ for DeepVariant v0.8.0 in all 1248 samples computed genome-wide. (<bold>D</bold>) Distributions of reported GQ for GATK4 HaplotypeCaller in all 1248 samples computed on chromosome 2 only. Note the broken y-axis and different scales. See also <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S4</xref></p>
        </caption>
        <graphic xlink:href="btaa1081f1" position="float"/>
      </fig>
      <p>The overall distribution of GQ scores within a sample determines the information content of the field. Substantial variant fractions occur across the GQ spectrum for DeepVariant calls (<xref rid="btaa1081-F1" ref-type="fig">Fig. 1C</xref>), and the DeepVariant GQ score distribution shifts smoothly toward higher qualities as sequence coverage increases (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). In contrast, GATK4 HaplotypeCaller both produces a consistently oscillating GQ distribution for variants with GQ &lt; 99 (<xref rid="btaa1081-F1" ref-type="fig">Fig. 1D</xref>) and frequently reports most variants as GQ = 99 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4A</xref>). When considered in conjunction with the GQ calibration comparisons (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>), these results suggest that joint genotyping algorithms may be able to more accurately refine individual genotypes produced by DeepVariant since joint genotyping algorithms refine individuals’ variant calls based on observed allele frequencies in the rest of the cohort, using GQ as a prior on genotype.</p>
      <p>The large-scale analysis of genomes and exomes in gnomAD identified variant quality normalized by read depth (QD) as the most important feature for discriminating true variants from artifacts in GATK calls (Karczewski <italic toggle="yes">et al.</italic>, 2020). Consistent with that observation, GATK single-sample QD is less uniformly biased than GQ (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4B</xref>) and has a more informative distribution across the cohorts (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4C</xref>).</p>
    </sec>
    <sec>
      <title>3.4 Optimized parameters for joint calling</title>
      <p>We adapted GLnexus (<xref rid="btaa1081-B27" ref-type="bibr">Lin <italic toggle="yes">et al.</italic>, 2018</xref>) for merging DeepVariant gVCFs because of its computational scalability to large cohorts, access to relevant parameters, performance on allele normalization and open-source license. To identify optimal parameters for merging DeepVariant gVCFs, we created four custom WGS cohorts of 3, 100, 333 and 1247 samples at both high coverage (40–50×) and low coverage (15×) on chromosome 2, resulting in eight total cohorts (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). The cohorts contain five mutually non-descendant GIAB samples used to evaluate benchmark calls and five non-GIAB trios used to compute Mendelian violation rates (<xref rid="sup1" ref-type="supplementary-material">Supplementary Tables S2B, C and S3</xref>).</p>
      <p>We focused on the four tunable GLnexus parameters (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>) most crucial to optimize: ‘<monospace>min_</monospace>’, the quality threshold applied to each discovered allele; ‘<monospace>min_</monospace>’, the quality threshold applied to alleles whose copy number is at least two; ‘<monospace>min_GQ</monospace>’, the minimum genotype quality to be used for copy number estimates for the alleles; and ‘<monospace>revise_genotypes</monospace>’, a boolean switch indicating whether to use cohort information to re-genotype low quality genotype calls.</p>
      <p>We extensively explored parameter configurations using Google Vizier (<xref rid="btaa1081-B14" ref-type="bibr">Golovin <italic toggle="yes">et al.</italic>, 2017</xref>) to optimize a multiple metric objective function. Minimization of Mendelian violation rate in trio samples encourages precision genome-wide. Maximization of concordance with GIAB samples, measured as the harmonic mean of SNP and indel F1 scores, encourages both precision and recall in the well-characterized subset of the genome. Together, the joint metric discourages strategies which improve Mendelian violation rate at the expense of genotype errors (for example, by filtering true variant sites). We first performed a Pareto-optimal search using Vizier’s default Bayesian hyperparameter selection algorithm to reduce the problem space, and then explored the reduced space using an exhaustive grid search. Many configurations simultaneously improve both Mendelian violation rate and concordance with GIAB when compared to the GLnexus configuration that performs no variant modification (<xref rid="btaa1081-F2" ref-type="fig">Fig. 2</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>).</p>
      <fig position="float" id="btaa1081-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Parameter search for <italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>1247, 15× cohort. Each data point represents a unique parameter combination explored by Vizier. The color indicates whether the GLnexus parameter to revise genotypes was true (orange) or false (blue), and the shape represents the search algorithm. The <italic toggle="yes">x</italic>-axis indicates Mendelian violation rate. The <italic toggle="yes">y</italic>-axis indicates errors on GIAB through the harmonic mean of SNP F1 and indel F1 (lower is more accurate). Points toward the lower left are more accurate on both metrics. The intersection of the green horizontal and vertical dotted lines indicates the performance using GLnexus with no variant modification (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>). <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S5</xref> shows the results for all cohort sizes and coverages. The red diamond indicates the parameter set we selected for the optimized DeepVariant+GLnexus pipeline</p>
        </caption>
        <graphic xlink:href="btaa1081f2" position="float"/>
      </fig>
      <p>The smooth Pareto-optimal boundary (<xref rid="btaa1081-F2" ref-type="fig">Fig. 2</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>) indicates that the tradeoff between recall and precision can be tuned in an application-specific manner. We investigated the extent to which parameter settings are applicable across cohort sizes and sequence coverage by summing the rate of error reduction across five metrics over the ‘no modification’ parameter setting (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Note S4</xref> for details). We selected the best-performing parameter configuration as the ‘optimized’ setting after verifying its strong performance across cohort sizes and sequence coverages (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S6–S8</xref>).</p>
      <p>Next, we compared four variant calling and merging methods across all 8 cohorts. The first and second methods use the GATK4 Best Practices (<xref rid="btaa1081-B9" ref-type="bibr">DePristo <italic toggle="yes">et al.</italic>, 2011</xref>; <xref rid="btaa1081-B32" ref-type="bibr">McKenna <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btaa1081-B36" ref-type="bibr">Poplin <italic toggle="yes">et al.</italic>, 2018a</xref>) pipeline and either retain all variants (‘GATK-Joint’) or retain only variants that pass variant quality score recalibration (‘GATK-VQSR’). The third method uses DeepVariant for single-sample calling and GLnexus to merge the calls, with DeepVariant run with default parameters and GLnexus run in a setting to avoid single-sample variant modification (‘DV-GLN-NOMOD’) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S4</xref>). The final method uses the optimized version of the DeepVariant+GLnexus pipeline (‘DV-GLN-OPT’) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Note</xref> S1). After verifying qualitatively similar callset properties on distinct chromosomes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S9</xref>), we generated all evaluation callsets on chromosome 20 to avoid overlap with the training data from chromosome 2.</p>
      <p>The callsets were evaluated on five measures of quality: SNP and indel false discovery rates, false negative rates and total Mendelian violation rate, for each cohort size and at both 15× and 40× sequence coverage. DV-GLN-OPT equals or exceeds both GATK-based methods in 38 of the 40 measured metrics (<xref rid="btaa1081-F3" ref-type="fig">Fig. 3</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref>), with only SNP false discovery rates in 15× coverage callsets not uniformly stronger. In the cohort of 1247 individuals at 40× coverage, DV-GLN-OPT has a 3.0-fold lower Mendelian violation rate (1.7% versus 5.0%), 17.6-fold lower SNP F1 error (0.07% versus 1.23%) and 2.6-fold lower indel F1 error (1.14% versus 2.92%) than GATK-VQSR. DV-GLN-OPT generally, though not strictly, also outperforms DV-GLN-NOMOD.</p>
      <fig position="float" id="btaa1081-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Comparison of four cohort callset creation methods. Four calling and merging pipelines are applied at both 15× and 40× sequence coverage for WGS cohorts of size <italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>3, 100, 333 and 1247. Five evaluation metrics are presented: Mendelian Violation Rate, SNP False Discovery Rate (1-Precision), SNP False Negative Rate (1-Recall), indel False Discovery Rate and indel False Negative Rate. In all cases, lower values are better. All evaluation metrics are computed on chr20. See <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5</xref> for the precise values and the variances of each metric</p>
        </caption>
        <graphic xlink:href="btaa1081f3" position="float"/>
      </fig>
      <p>We repeated the parameter search technique described above in a single WES cohort of 346 samples (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2B</xref>). Similarly to WGS, there exist many configurations that strictly outperform the ‘no modification’ parameter setting (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10</xref>) and the WES-optimized DV+GLnexus pipeline outperforms the GATK4 Best Practices in all metrics (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S5C</xref>).</p>
    </sec>
    <sec>
      <title>3.5 Evaluation on deeply sequenced 1000 Genomes Project phase 3</title>
      <p>To evaluate DV-GLN-OPT in an independent dataset, we generated a cohort callset for high-coverage sequencing reads of the 2504 samples in 1KGP (<xref rid="btaa1081-B45" ref-type="bibr">The 1000 Genomes Project Consortium, 2015</xref>), and made the cohort callset and all DeepVariant single-sample calls publicly available (see ‘Availability and Implementation’ in Abstract). We compared the single-sample variant calls from DeepVariant with those of GATK HaplotypeCaller, and the DV-GLN-OPT callset with that of an independently generated GATK-VQSR pipeline (see Section 2.3). Each sample has a higher Ti:Tv ratio in the DeepVariant-based variant calls in both cases (<xref rid="btaa1081-F4" ref-type="fig">Fig. 4A</xref>, in light green and blue, respectively). Taken together, these results provide indirect evidence that the DeepVariant calls are of higher quality.</p>
      <fig position="float" id="btaa1081-F4">
        <label>Fig. 4.</label>
        <caption>
          <p>1KGP cohort callset quality. (<bold>A</bold>) Ti:Tv ratios of 1KGP samples, from single-sample SNPs and joint-called SNPs, generated by DV-GLN-OPT and GATK pipeline. Each point represents the ratio in one of the 2504 samples across the whole genome. Each point cloud compares the Ti:Tv ratios in variant calls from the two systems, after equivalent steps are performed. The first cloud (in light green) compares the Ti:Tv ratios from DeepVariant (<italic toggle="yes">y</italic>-axis) and GATK HaplotypeCaller (<italic toggle="yes">x</italic>-axis) single sample calls. The second cloud (in turquoise) compares Ti:Tv after joint-genotyping is performed (optimized GLnexus for DeepVariant, and GenomicsDBImport+GenotypeGVCFs for GATK HaplotypeCaller). Finally the third cloud (in blue) compares the final outputs from the two systems, after VQSR is performed for GATK (<italic toggle="yes">x</italic>-axis), while no additional operation is performed for the optimized DeepVariant-GLnexus calls. (<bold>B</bold>) Fractional counts of autosomal variants with low HWE <italic toggle="yes">p</italic>-values, binned by non-major allele frequency in DV-GLN-OPT, GATK-VQSR and GATK-Joint. The major allele is the allele with the largest allele count in a given variant within the callset. The variants are aggregated in non-major-allele-frequency bins of size 0.0125, and the frequency is clipped at 0.5 for visualization purposes (for all methods the fractional counts in bins after 0.5 are less than <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>)</p>
        </caption>
        <graphic xlink:href="btaa1081f4" position="float"/>
      </fig>
      <p>Overall callset composition depends on the filtering methods applied. The GATK-VQSR callset contains substantially fewer total variants and rare variants compared to both DV-GLN-OPT and GATK-Joint (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref>). To identify recurrent variant calling and genotyping artifacts, we quantified the sites which violate HWE in each callset at various <italic toggle="yes">p</italic>-value thresholds (<xref rid="btaa1081-F4" ref-type="fig">Fig. 4B</xref>). Only 6.62% of autosomal sites in the DV-GLN-OPT callset have HWE <italic toggle="yes">p</italic> &lt; <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula> (7 443 684 of 112 451 553 total autosomal sites), compared to 8.05% in GATK-VQSR (8 276 874 of 102 804 074) and 9.77% in GATK-Joint (11 724 367 of 120 046 355). Finally, we observed that the GATK-based callsets limit the maximum number of alleles at any position to six, and thus exclude a number of alleles present at highly variable sites (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref>). Manual inspection confirmed that most highly multiallelic variants are short tandem repeats of varying lengths, with the bulk of calls attributable to few common alleles but a long tail of additional alleles (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S12</xref>).</p>
      <p>To further assess 1KGP callset quality, we evaluated Mendelian violation rate within a single cryptic trio present in the cohort (<xref rid="btaa1081-B39" ref-type="bibr">Roslin <italic toggle="yes">et al.</italic>, 2016</xref>). We first verified the trio’s relatedness (NA20882: mother, NA20891: father, NA20900: child, all of Gujarati Indian ancestry), and used this trio to compute Mendelian violations in DV-GLN-OPT, GATK-VQSR and GATK-Joint (<xref rid="btaa1081-F5" ref-type="fig">Fig. 5</xref>).</p>
      <fig position="float" id="btaa1081-F5">
        <label>Fig. 5.</label>
        <caption>
          <p>Mendelian violations in autosomes of a cryptic trio in 1KGP. (<bold>A</bold>) The percentage of variants that violate Mendelian inheritance in the trio NA20900-NA20891-NA20882 as a function of the number of variants considered. Variants are ranked by the minimum GQ within the trio. Callset variants with homozygous reference calls for all three trio samples, and those have indeterminate violation status due to missing genotype calls in the trio, are ignored. (<bold>B</bold>) Mendelian violation percentages of the same trio binned by minimum GQ in the trio using bin size 5</p>
        </caption>
        <graphic xlink:href="btaa1081f5" position="float"/>
      </fig>
      <p>To quantify the improvement to Mendelian violation rate and GQ calibration, we sorted variant calls from most to least confident using the minimum GQ in the trio, independently for each callset. Importantly, variant-level metrics such as QUAL were not used for this analysis because the call qualities for three samples in a trio may differ substantially from a variant quality metric computed over all 2504 samples. DV-GLN-OPT calls have a lower overall Mendelian violation rate, as evidenced by cumulative Mendelian violation rate plotted as a function of variants retained (<xref rid="btaa1081-F5" ref-type="fig">Fig. 5A</xref>). While all callsets show decreased Mendelian violation rates as the minimum GQ of the trio is increased (<xref rid="btaa1081-F5" ref-type="fig">Fig. 5B</xref>), the broader GQ distribution of DeepVariant (<xref rid="btaa1081-F1" ref-type="fig">Fig. 1</xref>) enables better separation of true and false calls. Remarkably, applying the maximally stringent GQ = 99 filter to the GATK-VQSR callset retains only 1.9 million sites (29.8%) at a Mendelian violation rate of 0.11%, whereas the DV-GLN-OPT callset can retain 5.5 million sites (90.6%) at a lower Mendelian violation rate of &lt; 0.1%.</p>
      <p>Finally, we annotated variants discovered in 1KGP using the Ensembl Variant Effect Predictor (VEP) (<xref rid="btaa1081-B33" ref-type="bibr">McLaren et al., 2016</xref>) to analyze their coding consequences. We analyzed variants in three groups: variants called by both DV-GLN-OPT and GATK-VQSR, by DV-GLN-OPT exclusively, and by GATK-VQSR exclusively (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S13</xref>). Among the annotations with the highest potential impact (‘stop gained’, ‘frameshift’, ‘stop lost’, ‘start lost’), we found more variants discovered exclusively by DV-GLN-OPT than by GATK-VQSR. We also analyzed the same groups of variants when restricted to variants detected exclusively in each 1KGP superpopulation (African, American, East Asian, European, South Asian). While the total number of variants exclusive to each superpopulation varied, the overall distribution of the annotations and the three groups of variants seems broadly consistent across populations.</p>
    </sec>
    <sec>
      <title>3.6 Evaluation of 1KGP callsets as imputation reference panels</title>
      <p>The 1KGP dataset is frequently used for population-based downstream applications, such as genotype phasing and imputation, due to its genetic diversity and large sample size (<xref rid="btaa1081-B8" ref-type="bibr">Delaneau <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btaa1081-B17" ref-type="bibr">Huang et al., 2012</xref>; <xref rid="btaa1081-B34" ref-type="bibr">Nikpay et al., 2015</xref>; <xref rid="btaa1081-B40" ref-type="bibr">Shaikho et al., 2017</xref>). To illustrate how the accuracy of the DV-GLN-OPT callset translates into improved results for these downstream analyses, we assessed the performance of imputing variants using it as a reference panel. We first created reference panels from the deeply sequenced DV-GLN-OPT and GATK-VQSR 1KGP callsets described in the previous section, by applying identical minimal transformations to both cohort VCFs (see Materials and Methods) and phasing the callsets with Eagle2 (<xref rid="btaa1081-B29" ref-type="bibr">Loh <italic toggle="yes">et al.</italic>, 2016</xref>).</p>
      <p>The DV-GLN-OPT panel contains 4.69% more variant sites than the GATK-VQSR panel generated from the same source. More than 99% of the GATK-VQSR panel sites are present in the DV-GLN-OPT panel, while fewer than 95% of the DV-GLN-OPT panel sites are present in the GATK-VQSR panel (<xref rid="btaa1081-F6" ref-type="fig">Fig. 6A</xref>).</p>
      <fig position="float" id="btaa1081-F6">
        <label>Fig. 6.</label>
        <caption>
          <p>Imputation accuracy of 1KGP reference panel. (<bold>A</bold>) Variant sites covered by DV-GLN-OPT and GATK panel. The DV-GLN-OPT reference panel generated from 1KGP samples covers 43 181 562 variant sites, while the GATK panel from the same samples covers 41 247 330 sites. The intersection of the two panel regions (marked in light blue) covers 40 972 007 sites, which is 94.88% of the DV-GLN-OPT panel and 99.33% of the GATK panel. (<bold>B</bold>) Imputed genotype accuracy for indels. The accuracy of the imputed variants are measured by computing concordance with the GIAB benchmark calls using hap.py. Blue colored markers are from DV-GLN-OPT panel while the red markers are from GATK panel. The shaped markers show precision and recall computed across the GIAB evaluation region for two samples. (<bold>C</bold>) Imputed genotype accuracy for SNPs. Shapes and colors as in (B)</p>
        </caption>
        <graphic xlink:href="btaa1081f6" position="float"/>
      </fig>
      <p>To evaluate the imputation quality of the two reference panels, we extracted variant calls for the approximately 710k sites assayed by the Illumina Infinium OmniExpress-24 microarray for two GIAB child samples (HG002 and HG005, of Ashkenazi Jewish and Han Chinese ancestry, respectively) in their benchmark regions. For each of the DV-GLN-OPT and GATK-VQSR reference panels, we phased the pseudo-microarray variants with Eagle2 and imputed the phased variants into the panel with Beagle 5.0 (<xref rid="btaa1081-B4" ref-type="bibr">Browning <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
      <p>The imputed variant calls were scored in two evaluation regions (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>). The first evaluation region, hereafter the ‘GIAB evaluation region,’ comprises the GIAB benchmark regions common to both HG002 and HG005, agnostic to either reference panel. This measures both the accuracy of the imputed genotypes and the number of benchmark variants absent in the reference panel. The second evaluation region, hereafter the ‘panel evaluation region,’ comprises a subset of the GIAB evaluation region additionally present in both the DV-GLN-OPT and the GATK-VQSR reference panels. This allows a direct comparison of variants, but provides limited information about overall individual panel quality.</p>
      <p>The DV-GLN-OPT panel outperforms the GATK panel in F1 score in all eight experiments (two samples, two variant types and two evaluation regions). Of note, DV-GLN-OPT produces substantially higher recall than GATK-VQSR for both indels and SNPs when evaluated in the GIAB evaluation region (<xref rid="btaa1081-F6" ref-type="fig">Fig. 6B, C</xref>). The DV-GLN-OPT panel produces on average 4.41% fewer false negative indels and 8.28% fewer false negative SNPs, while maintaining superior indel precision and indistinguishable SNP precision. As expected, evaluation metric differences are more subtle in the panel evaluation region, but the DV-GLN-OPT panel produces higher F1 scores for both samples and for both indels and SNPs (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S6</xref>).</p>
    </sec>
    <sec>
      <title>3.7 Cost benchmarking</title>
      <p>In large-scale sequencing projects, the temporal and financial cost of running bioinformatics tools can be prohibitively large. To compare the computational cost of the DeepVariant-GLnexus and GATK pipelines, we reanalyzed chromosome 22 in the 2504 1KGP samples. Starting from the aligned sequencing reads, we ran DeepVariant and GATK HaplotypeCaller to produce gVCFs on a separate virtual machine with a fixed machine type for each sample, using the Docker images published by the respective tool developers.</p>
      <p>Using machines with 8 virtual CPUs (vCPUs) each, DeepVariant finished each chr22 sample using 40% less average time elapsed (20.0 minutes) without GPU/TPU acceleration, than GATK HaplotypeCaller (33.2 minutes) (<xref rid="btaa1081-F7" ref-type="fig">Fig. 7A</xref>). The difference is mainly attributable to DeepVariant’s efficient internal multithreading (<xref rid="btaa1081-F7" ref-type="fig">Fig. 7B</xref>, <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S7</xref>). This implies that one can easily assign more vCPUs to each cloud machine to get a speedup almost proportional to the increased resources (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S14</xref>), without requiring an external workflow that splits the chromosome into smaller shards. Note that the cost difference between the two callers would expand significantly if the Base Quality Score Recalibration (BQSR) preprocessing step were included for GATK, which is part of GATK Best Practices but not recommended for DeepVariant.</p>
      <fig position="float" id="btaa1081-F7">
        <label>Fig. 7.</label>
        <caption>
          <p>Cost benchmarking DeepVariant-GLnexus and GATK pipeline. (<bold>A</bold>) Distribution of elapsed real times to generate single-sample gVCF (chr22 only) from aligned reads across <italic toggle="yes">n </italic>=<italic toggle="yes"> </italic>2504 1KGP samples, using DeepVariant and GATK HaplotypeCaller (BQSR not included) in 8-vCPU machine. GPU/TPU acceleration was not used for DeepVariant. (<bold>B</bold>) Elapsed real times to generate gVCF (chr22 only) of one sample (NA12878) using a cloud machine with varying number of vCPUs, with DeepVariant and GATK HaplotypeCaller (excluding BQSR). The default value for HaplotypeCaller’s HMM multithreading flag (–native-pair-hmm-threads) is 4 (red arrow) and it was practically ineffectual for 16 vCPUs and more (red dotted lines). (<bold>C</bold>) Elapsed real times to merge the chr22 gVCF files from (A) into a cohort VCF for <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:mn>10</mml:mn><mml:mo>,</mml:mo><mml:mn>100</mml:mn><mml:mo>,</mml:mo><mml:mn>1000</mml:mn><mml:mo>,</mml:mo><mml:mn>2504</mml:mn><mml:mo>}</mml:mo></mml:mrow></mml:math></inline-formula> nested subsets of the 1KGP samples, using GLnexus (for DeepVariant gVCFs) and GATK GenomicsDBImport + GenotypeGVCFs (for HaplotypeCaller gVCFs). GATK VQSR step was not included. (<bold>D</bold>) The file sizes of the whole-genome cohort VCFs and the single-sample gVCFs of 1KGP samples from DeepVariant-GLnexus and GATK pipeline</p>
        </caption>
        <graphic xlink:href="btaa1081f7" position="float"/>
      </fig>
      <p>Next, we processed the <italic toggle="yes">n</italic><bold> </bold>=<bold> </bold>2504 sample chromosome 22 gVCF files to produce cohort VCF files using GLnexus (from DeepVariant gVCFs), on the one hand, and GATK’s GenomicsDBImport and GenotypeGVCFs tools (from HaplotypeCaller gVCFs), on the other. While GLnexus supports internal multithreading, the two GATK tools are effectively single-threaded and require an external parallelization workflow to achieve practical runtimes, which we reproduced based on the developers’ specifications (subdividing the length of chromosome 22 to scatter across processes). Still, using a single 32-vCPU virtual machine, GLnexus is 8 times faster (0.84 hours) than the equivalent GATK tools (6.83 hours), with superior scalability to larger cohorts (<xref rid="btaa1081-F7" ref-type="fig">Fig. 7C</xref>). For this benchmark we did not run Variant Quality Score Recalibration (VQSR) for GATK, which is a recommended step after GenotypeGVCFs in its Best Practices and will add additional runtime to its pipeline. The runtime scalability of GLnexus up to 50 000 exomes compared to GATK can be found in <xref rid="btaa1081-B27" ref-type="bibr">Lin <italic toggle="yes">et al.</italic> 2018</xref> (<xref rid="btaa1081-F4" ref-type="fig">Fig. 4</xref>).</p>
      <p>Another relevant cost to users of these pipelines is the cost of storing the artifacts from them. In the standard block-compressed variant call format (<xref rid="btaa1081-B6" ref-type="bibr">Danecek <italic toggle="yes">et al.</italic>, 2011</xref>; <xref rid="btaa1081-B26" ref-type="bibr">Li <italic toggle="yes">et al.</italic>, 2009</xref>), the total size of the DeepVariant gVCFs for all chromosomes of 1KGP samples is 7 times smaller (total 2.20TB, average 878MB/sample) than GATK HaplotypeCaller gVCFs (total 15.16TB, average 6053 MB/sample) (<xref rid="btaa1081-F7" ref-type="fig">Fig. 7D</xref>), which is a result of DeepVariant’s efficient quantization of the reference records. Moreover, the final cohort VCF from DeepVariant-GLnexus pipeline is also 26% smaller (0.97TB) than the one from GATK pipeline (1.32TB). This reduction in file sizes directly translates to a similar ratio of cost savings in cloud storage services. To further reduce the sizes of the cohort VCF, one may consider using the BCF (binary VCF) format or other data formats designed for a large number of samples (<xref rid="btaa1081-B7" ref-type="bibr">Danek and Deorowicz, 2018</xref>; <xref rid="btaa1081-B19" ref-type="bibr">Kelleher et al., 2019</xref>; <xref rid="btaa1081-B22" ref-type="bibr">Layer <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa1081-B25" ref-type="bibr">Li, 2016</xref>; <xref rid="btaa1081-B28" ref-type="bibr">Lin et al., 2020</xref>; <xref rid="btaa1081-B49" ref-type="bibr">Zheng et al., 2017</xref>).</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>Population-scale sequenced cohorts are foundational resources for many genetic analyses, including genotype-phenotype discovery, variant interpretation and genotype imputation. As sequencing projects have grown to include hundreds of thousands of samples, the need for highly accurate variant calls and computationally efficient merging algorithms is increasingly acute. By optimizing GLnexus to merge single-sample DeepVariant calls, we demonstrated that the superior accuracy (<xref rid="btaa1081-B37" ref-type="bibr">Poplin <italic toggle="yes">et al.</italic>, 2018b</xref>) and generalizability across sequencing methods (<xref rid="btaa1081-B47" ref-type="bibr">Wenger et al., 2019</xref>) of DeepVariant can generate more accurate cohort callsets at large scale at lower cost. The callset quality metrics of the optimized pipeline consistently outperformed the GATK Best Practices across a range of cohort sizes and sequence coverages. In addition, we showed that variant confidences are well calibrated to Mendelian violation rate, allowing tuning of callsets for very high precision or for high recall.</p>
    <p>When optimizing callset creation, we investigated callset quality stratified by both sequencing coverage and cohort size. Results within a given sequencing coverage were qualitatively similar regardless of cohort size, suggesting that a major driver of parameter sensitivity is the distribution of individual call confidence estimates. Even so, when optimizing equally between benchmark callset accuracy and Mendelian violation rate, we observed a single parameter set that provides strong performance across the range of WGS cohorts analyzed.</p>
    <p>Although we demonstrated the strength of the DeepVariant+GLnexus method, there are multiple areas for future improvement. At both 15× and 40× coverage, the precision-recall curves of SNPs versus indels is markedly different. As expected, parameter variation can tune SNPs to improve recall at the expense of precision or vice versa. In contrast, indels appear to have nearly globally optimal parameters, suggesting that distinct handling of the two variant classes may further improve callset quality. Additionally, the tunable GLnexus parameters affect allele harmonization and genotyping, but do not apply any hard filtering to output calls. We observed an overrepresentation of Mendelian violations at very low GQ values, indicating that direct omission of low quality sites or genotypes also may improve callset quality. Finally, a small fraction (0.4%) of autosomal sites contain seven or more total alleles, and typically represent short tandem repeats (<xref rid="btaa1081-B11" ref-type="bibr">Fan and Chu, 2007</xref>). While these sites likely capture some of the known hypervariability of these regions, this benefit is weighed against the practical difficulty of representing and analyzing these sites in downstream applications.</p>
    <p>Comparison of cohort callsets is a less mature field than comparison of single-sample callsets. Here we focused on four evaluation metrics (accuracy of GIAB sample calls, Mendelian concordance, Ti:Tv ratio and HWE <italic toggle="yes">p</italic>-value distributions) to incorporate direct variant accuracy measures where possible, but also include indirect signals of quality genome-wide. We used the recent deep sequencing of 1KGP to perform an orthogonal analysis on a publicly available dataset. The resulting optimized DeepVariant+GLnexus callset possesses superior metrics to a GATK Best Practices callset generated independently, including a 32% reduction in sites violating HWE at <italic toggle="yes">p</italic> &lt; <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mn>10</mml:mn></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. Moreover, an imputation reference panel derived from the DeepVariant+GLnexus callset results in higher imputation accuracy, which shows that improving cohort-level variant calls yields improved performance in a common downstream application. Both the cohort callset and all DeepVariant single-sample calls are freely available at Google Cloud Storage (<ext-link xlink:href="https://console.cloud.google.com/storage/browser/brain-genomics-public/research/cohort/1KGP" ext-link-type="uri">https://console.cloud.google.com/storage/browser/brain-genomics-public/research/cohort/1KGP</ext-link>).</p>
    <p>To our knowledge, this is the most accurate 1KGP callset currently available as measured by the above metrics, and as such has substantial utility within the genomics community for studies of genetic variation. Furthermore, we hope this resource spurs additional innovation in the development and evaluation of population-scale cohorts.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa1081_Supplementary_Data</label>
      <media xlink:href="btaa1081_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors thank Babak Alipanahi, Thomas Colthurst, Greg Corrado and Mark DePristo for helpful discussions and feedback, and the New York Genome Center and its sponsors for the deep resequencing of the 1KGP samples.</p>
    <p>PAGE dataset: Samples and data of The Charles Bronfman Institute for Personalized Medicine (IPM) BioMe BioBank used in this study were provided by The Charles Bronfman Institute for Personalized Medicine at the Icahn School of Medicine at Mount Sinai (New York). Phenotype data collection was supported by The Andrea and Charles Bronfman Philanthropies. Funding support for genotyping, which was performed at The Center for Inherited Disease Research (CIDR), was provided by the NIH (U01HG007417). The datasets used for the analyses described in this manuscript were obtained from dbGaP at <ext-link xlink:href="http://www.ncbi.nlm.nih.gov/gap" ext-link-type="uri">http://www.ncbi.nlm.nih.gov/gap</ext-link> through dbGaP accession number phs000925.v1.p1.</p>
    <p>CSER dataset: These results are in whole or part based upon data generated by the Clinical Sequencing Exploratory Research (CSER) consortium established by the NHGRI. Funding support was provided through cooperative agreements with the NHGRI and NCI through grant numbers U01 HG007301 (Genomic Diagnosis in Children with Developmental Delay). Information about CSER and the investigators and institutions who comprise the CSER consortium can be found at <ext-link xlink:href="http://www.genome.gov/27846194" ext-link-type="uri">http://www.genome.gov/27846194</ext-link>.</p>
    <p>The 1000 Genomes Project high-coverage sequencing dataset: These data were generated at the New York Genome Center with funds provided by NHGRI Grant 3UM1HG008901-03S1.</p>
    <sec>
      <title>Funding</title>
      <p>All compute resources used in this work were provided by Google LLC. M.F.L. received compensation for contributions to this work under a consulting engagement with Google LLC.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: T.Y., H.L., P-C.C., A.C., and C.Y.M. are employees and equity owners of Google LLC. M.F.L. has consulting engagements with Google LLC and DNAnexus Inc., and equity in the latter.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa1081-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amendola</surname><given-names>L.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>The Clinical Sequencing Evidence-Generating Research Consortium: integrating genomic sequencing in diverse and medically underserved populations</article-title>. <source>Am. J. Hum. Genet</source>., <volume>103</volume>, <fpage>319</fpage>–<lpage>327</lpage>.<pub-id pub-id-type="pmid">30193136</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bainbridge</surname><given-names>M.N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) 
<article-title>Targeted enrichment beyond the consensus coding DNA sequence exome reveals exons with higher variant densities</article-title>. <source>Genome Biol</source>., <volume>12</volume>, <fpage>R68</fpage>.<pub-id pub-id-type="pmid">21787409</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brier</surname><given-names>G.W.</given-names></string-name></person-group> (<year>1950</year>) 
<article-title>Verification of forecasts expressed in terms of probability</article-title>. <source>Mon. Weather Rev</source>., <volume>78</volume>, <fpage>1</fpage>–<lpage>3</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa1081-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Browning</surname><given-names>B.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>A one-penny imputed genome from next-generation reference panels</article-title>. <source>Am. J. Hum. Genet</source>., <volume>103</volume>, <fpage>338</fpage>–<lpage>348</lpage>.<pub-id pub-id-type="pmid">30100085</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bycroft</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>The UK Biobank resource with deep phenotyping and genomic data</article-title>. <source>Nature</source>, <volume>562</volume>, <fpage>203</fpage>–<lpage>209</lpage>.<pub-id pub-id-type="pmid">30305743</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danecek</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal>; 1000 Genomes Project Analysis Group. (<year>2011</year>) 
<article-title>The variant call format and VCFtools</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>2156</fpage>–<lpage>2158</lpage>.<pub-id pub-id-type="pmid">21653522</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Danek</surname><given-names>A.</given-names></string-name>, <string-name><surname>Deorowicz</surname><given-names>S.</given-names></string-name></person-group> (<year>2018</year>) 
<article-title>GTC: how to maintain huge genotype collections in a compressed form</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>1834</fpage>–<lpage>1840</lpage>.<pub-id pub-id-type="pmid">29351600</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Delaneau</surname><given-names>O.</given-names></string-name></person-group>  <etal>et al</etal>; The 1000 Genomes Project Consortium. (<year>2014</year>) 
<article-title>Integrating sequence and array data to create an improved 1000 Genomes Project haplotype reference panel</article-title>. <source>Nat. Commun</source>., <volume>5</volume>, <fpage>3934</fpage>.<pub-id pub-id-type="pmid">25653097</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DePristo</surname><given-names>M.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) 
<article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nat. Genet</source>., <volume>43</volume>, <fpage>491</fpage>–<lpage>501</lpage>.<pub-id pub-id-type="pmid">21478889</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dewey</surname><given-names>F.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Distribution and clinical impact of functional variants in 50,726 whole-exome sequences from the DiscovEHR study</article-title>. <source>Science</source>, <volume>354</volume>, <fpage>aaf6814</fpage>.<pub-id pub-id-type="pmid">28008009</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fan</surname><given-names>H.</given-names></string-name>, <string-name><surname>Chu</surname><given-names>J.Y.</given-names></string-name></person-group> (<year>2007</year>) 
<article-title>A brief review of short tandem repeat mutation</article-title>. <source>Genomics Proteomics Bioinf</source>., <volume>5</volume>, <fpage>7</fpage>–<lpage>14</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa1081-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Faust</surname><given-names>G.G.</given-names></string-name>, <string-name><surname>Hall</surname><given-names>I.M.</given-names></string-name></person-group> (<year>2014</year>). <part-title>SAMBLASTER: fast duplicate marking and structural variant read extraction</part-title>. <source>Bioinformatics</source>, <volume>30</volume>, <fpage>2503</fpage>–<lpage>2505</lpage>.<pub-id pub-id-type="pmid">24812344</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Garrison</surname><given-names>E.</given-names></string-name>, <string-name><surname>Marth</surname><given-names>G.</given-names></string-name></person-group> (<year>2012</year>) 
<article-title>Haplotype-based variant detection from short-read sequencing</article-title>. <source><italic toggle="yes">arXiv</italic>, arXiv: 1207.3907</source>.</mixed-citation>
    </ref>
    <ref id="btaa1081-B14">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Golovin</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) Google vizier: A service for black-box optimization. In <italic toggle="yes">Proceedings of the ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</italic>, Vol. Part F1296 of <italic toggle="yes">KDD ’17</italic>, ACM. pp. <fpage>1487</fpage>–<lpage>1496</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa1081-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Graffelman</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>A genome-wide study of Hardy–Weinberg equilibrium with next generation sequence data</article-title>. <source>Hum. Genet</source>., <volume>136</volume>, <fpage>727</fpage>–<lpage>741</lpage>.<pub-id pub-id-type="pmid">28374190</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hardy</surname><given-names>G.H.</given-names></string-name></person-group> (<year>1908</year>) 
<article-title>Mendelian proportions in a mixed population</article-title>. <source>Science</source>, <volume>28</volume>, <fpage>49</fpage>–<lpage>50</lpage>.<pub-id pub-id-type="pmid">17779291</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2012</year>) 
<article-title>1000 Genomes-based imputation identifies novel and refined associations for the Wellcome Trust Case Control Consortium phase 1 Data</article-title>. <source>Eur. J. Hum. Genet</source>., <volume>20</volume>, <fpage>801</fpage>–<lpage>805</lpage>.<pub-id pub-id-type="pmid">22293688</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karczewski</surname><given-names>K.J.</given-names></string-name></person-group>  <etal>et al</etal>; Genome Aggregation Database Consortium. (<year>2020</year>) 
<article-title>The mutational constraint spectrum quantified from variation in 141,456 humans</article-title>. <source>Nature</source>, <volume>581</volume>, <fpage>434</fpage>–<lpage>443</lpage>.<pub-id pub-id-type="pmid">32461654</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kelleher</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Inferring whole-genome histories in large population datasets</article-title>. <source>Nat. Genet</source>., <volume>51</volume>, <fpage>1330</fpage>–<lpage>1338</lpage>.<pub-id pub-id-type="pmid">31477934</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>Strelka2: fast and accurate calling of germline and somatic variants</article-title>. <source>Nat. Methods</source>, <volume>15</volume>, <fpage>591</fpage>–<lpage>594</lpage>.<pub-id pub-id-type="pmid">30013048</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krusche</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal>; The Global Alliance for Genomics and Health Benchmarking Team. (<year>2019</year>) 
<article-title>Best practices for benchmarking germline small-variant calls in human genomes</article-title>. <source>Nat. Biotechnol</source>., <volume>37</volume>, <fpage>555</fpage>–<lpage>560</lpage>.<pub-id pub-id-type="pmid">30858580</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Layer</surname><given-names>R.M.</given-names></string-name></person-group>  <etal>et al</etal>; Exome Aggregation Consortium. (<year>2016</year>) 
<article-title>Efficient genotype compression and analysis of large genetic-variation data sets</article-title>. <source>Nat. Methods</source>, <volume>13</volume>, <fpage>63</fpage>–<lpage>65</lpage>.<pub-id pub-id-type="pmid">26550772</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lek</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal>; Exome Aggregation Consortium. (<year>2016</year>) 
<article-title>Analysis of protein-coding genetic variation in 60,706 humans</article-title>. <source>Nature</source>, <volume>536</volume>, <fpage>285</fpage>–<lpage>291</lpage>.<pub-id pub-id-type="pmid">27535533</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name></person-group> (<year>2013</year>) 
<article-title>Aligning sequence reads, clone sequences and assembly contigs with BWA-MEM</article-title>. <italic toggle="yes">arXiv</italic>, <source>arXiv: 1303.3997</source>.</mixed-citation>
    </ref>
    <ref id="btaa1081-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name></person-group> (<year>2016</year>) 
<article-title>BGT: efficient and flexible genotype query across many samples</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>590</fpage>–<lpage>592</lpage>.<pub-id pub-id-type="pmid">26500154</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>H.</given-names></string-name></person-group>  <etal>et al</etal>; 1000 Genome Project Data Processing Subgroup. (<year>2009</year>) 
<article-title>The sequence alignment/map format and SAMtools</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>2078</fpage>–<lpage>2079</lpage>.<pub-id pub-id-type="pmid">19505943</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>M.F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>GLnexus: joint variant calling for large cohort sequencing</article-title>. <italic toggle="yes">bioRxiv</italic>, <fpage>343970. doi: 10.1101/343970</fpage>.</mixed-citation>
    </ref>
    <ref id="btaa1081-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname><given-names>M.F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2020</year>) 
<article-title>Sparse Project VCF: efficient encoding of population genotype matrices</article-title>. <italic toggle="yes">Bioinformatics</italic>, doi: 10.1093/bioinformatics/btaa1004.</mixed-citation>
    </ref>
    <ref id="btaa1081-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Loh</surname><given-names>P.R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Reference-based phasing using the haplotype reference consortium panel</article-title>. <source>Nat. Genet</source>., <volume>48</volume>, <fpage>1443</fpage>–<lpage>1448</lpage>.<pub-id pub-id-type="pmid">27694958</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luo</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>A multi-task convolutional deep neural network for variant calling in single molecule sequencing</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>998</fpage>.<pub-id pub-id-type="pmid">30824707</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Matise</surname><given-names>T.C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2011</year>) 
<article-title>The next PAGE in understanding complex traits: design for the analysis of population architecture using genetics and epidemiology (PAGE) study</article-title>. <source>Am. J. Epidemiol</source>., <volume>174</volume>, <fpage>849</fpage>–<lpage>859</lpage>.<pub-id pub-id-type="pmid">21836165</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKenna</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>The genome analysis toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source>., <volume>20</volume>, <fpage>1297</fpage>–<lpage>1303</lpage>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McLaren</surname><given-names>W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>The ensembl variant effect predictor</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>122</fpage>.<pub-id pub-id-type="pmid">27268795</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nikpay</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>A comprehensive 1000 Genomes-based genome-wide association meta-analysis of coronary artery disease</article-title>. <source>Nat. Genet</source>., <volume>47</volume>, <fpage>1121</fpage>–<lpage>1130</lpage>.<pub-id pub-id-type="pmid">26343387</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ozaki</surname><given-names>K.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2002</year>) 
<article-title>Functional SNPs in the lymphotoxin- gene that are associated with susceptibility to myocardial infarction</article-title>. <source>Nat. Genet</source>., <volume>32</volume>, <fpage>650</fpage>–<lpage>654</lpage>.<pub-id pub-id-type="pmid">12426569</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Poplin</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018a</year>) 
<article-title>Scaling accurate genetic variant discovery to tens of thousands of samples</article-title>. <italic toggle="yes">bioRxiv</italic>, <lpage>201178</lpage>. doi: 10.1101/201178.</mixed-citation>
    </ref>
    <ref id="btaa1081-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Poplin</surname>,<given-names>R.</given-names></string-name></person-group><etal>et al</etal> (<year>2018b</year>) 
<article-title>A universal SNP and small-indel variant caller using deep neural networks</article-title>. <source>Nat. Biotechnol.</source>, <volume>36</volume>, <fpage>983</fpage>–<lpage>987</lpage>.<pub-id pub-id-type="pmid">30247488</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ramoni</surname><given-names>R.B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>The undiagnosed diseases network: accelerating discovery about health and disease</article-title>. <source>Am. J. Hum. Genet</source>., <volume>100</volume>, <fpage>185</fpage>–<lpage>192</lpage>.<pub-id pub-id-type="pmid">28157539</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roslin</surname><given-names>N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Quality control analysis of the 1000 Genomes Project Omni2.5 genotypes</article-title>. <italic toggle="yes">bioRxiv</italic>, <fpage>078600</fpage>. doi: 10.1101/078600.</mixed-citation>
    </ref>
    <ref id="btaa1081-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shaikho</surname><given-names>E.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>A phased SNP-based classification of sickle cell anemia HBB haplotypes</article-title>. <source>BMC Genomics</source>, <volume>18</volume>, <fpage>608</fpage>–<lpage>608</lpage>.<pub-id pub-id-type="pmid">28800727</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sherry</surname><given-names>S.T.</given-names></string-name></person-group> (<year>2001</year>) 
<article-title>dbSNP: the NCBI database of genetic variation</article-title>. <source>Nucleic Acids Res</source>., <volume>29</volume>, <fpage>308</fpage>–<lpage>311</lpage>.<pub-id pub-id-type="pmid">11125122</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Spiegelhalter</surname><given-names>D.J.</given-names></string-name></person-group> (<year>1986</year>) 
<article-title>Probabilistic prediction in patient management and clinical trials</article-title>. <source>Stat. Med</source>., <volume>5</volume>, <fpage>421</fpage>–<lpage>433</lpage>.<pub-id pub-id-type="pmid">3786996</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Taliun</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Sequencing of 53,831 diverse genomes from the NHLBI TOPMed Program</article-title>. <italic toggle="yes">bioRxiv</italic>, <lpage>563866</lpage>. doi: 10.1101/563866.</mixed-citation>
    </ref>
    <ref id="btaa1081-B44">
      <mixed-citation publication-type="journal">The 1000 Genomes Project Consortium. (<year>2010</year>) 
<article-title>A map of human genome variation from population-scale sequencing</article-title>. <source>Nature</source>, <volume>467</volume>, <fpage>1061</fpage>–<lpage>1073</lpage>.<pub-id pub-id-type="pmid">20981092</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B45">
      <mixed-citation publication-type="journal">The 1000 Genomes Project Consortium. (<year>2015</year>) 
<article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>, <volume>526</volume>, <fpage>68</fpage>–<lpage>74</lpage>.<pub-id pub-id-type="pmid">26432245</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Welter</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>The NHGRI GWAS Catalog, a curated resource of SNP-trait associations</article-title>. <source>Nucleic Acids Res</source>., <volume>42</volume>, <fpage>D1001</fpage>–<lpage>D1006</lpage>.<pub-id pub-id-type="pmid">24316577</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wenger</surname><given-names>A.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Accurate circular consensus long-read sequencing improves variant detection and assembly of a human genome</article-title>. <source>Nat. Biotechnol</source>., <volume>37</volume>, <fpage>1155</fpage>–<lpage>1162</lpage>.<pub-id pub-id-type="pmid">31406327</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Clinical whole-exome sequencing for the diagnosis of Mendelian disorders</article-title>. <source>N. Engl. J. Med</source>., <volume>369</volume>, <fpage>1502</fpage>–<lpage>1511</lpage>.<pub-id pub-id-type="pmid">24088041</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>X.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>SeqArray-a storage-efficient high-performance data format for WGS variant calls</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>2251</fpage>–<lpage>2257</lpage>.<pub-id pub-id-type="pmid">28334390</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zook</surname><given-names>J.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>Integrating human sequence data sets provides a resource of benchmark SNP and indel genotype calls</article-title>. <source>Nat. Biotechnol</source>., <volume>32</volume>, <fpage>246</fpage>–<lpage>251</lpage>.<pub-id pub-id-type="pmid">24531798</pub-id></mixed-citation>
    </ref>
    <ref id="btaa1081-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zook</surname><given-names>J.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>An open resource for accurately benchmarking small variant and reference calls</article-title>. <source>Nat. Biotechnol</source>., <volume>37</volume>, <fpage>561</fpage>–<lpage>566</lpage>.<pub-id pub-id-type="pmid">30936564</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
