<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6918570</article-id>
    <article-id pub-id-type="publisher-id">1893</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-019-1893-y</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>OnTAD: hierarchical domain structure reveals the divergence of activity among TADs and boundaries</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>An</surname>
          <given-names>Lin</given-names>
        </name>
        <address>
          <email>lua137@psu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Tao</given-names>
        </name>
        <address>
          <email>txy146@psu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yang</surname>
          <given-names>Jiahao</given-names>
        </name>
        <address>
          <email>yangjiahao0720@163.com</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nuebler</surname>
          <given-names>Johannes</given-names>
        </name>
        <address>
          <email>jnuebler@mit.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Xiang</surname>
          <given-names>Guanjue</given-names>
        </name>
        <address>
          <email>gzx103@psu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Hardison</surname>
          <given-names>Ross C.</given-names>
        </name>
        <address>
          <email>rch8@psu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0675-7648</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Qunhua</given-names>
        </name>
        <address>
          <email>qunhua.li@psu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Zhang</surname>
          <given-names>Yu</given-names>
        </name>
        <address>
          <email>yzz2@psu.edu</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2097 4281</institution-id><institution-id institution-id-type="GRID">grid.29857.31</institution-id><institution>Bioinformatics and Genomics Program, </institution><institution>Pennsylvania State University, </institution></institution-wrap>University Park, PA USA </aff>
      <aff id="Aff2"><label>2</label>Camp4 Therapeutics, Cambridge, MA USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 0662 3178</institution-id><institution-id institution-id-type="GRID">grid.12527.33</institution-id><institution>Department of Mathematics, </institution><institution>Tsinghua University, </institution></institution-wrap>Beijing, China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2341 2786</institution-id><institution-id institution-id-type="GRID">grid.116068.8</institution-id><institution>Institute for Medical Engineering and Science, </institution><institution>Massachusetts Institute of Technology, </institution></institution-wrap>Cambridge, MA USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2097 4281</institution-id><institution-id institution-id-type="GRID">grid.29857.31</institution-id><institution>Department of Biochemistry and Molecular Biology, </institution><institution>Pennsylvania State University, </institution></institution-wrap>University Park, PA USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="ISNI">0000 0001 2097 4281</institution-id><institution-id institution-id-type="GRID">grid.29857.31</institution-id><institution>Department of Statistics, </institution><institution>Pennsylvania State University, </institution></institution-wrap>University Park, PA USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>18</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>12</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2019</year>
    </pub-date>
    <volume>20</volume>
    <elocation-id>282</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>4</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>20</day>
        <month>11</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s). 2019</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution 4.0 International License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">The spatial organization of chromatin in the nucleus has been implicated in regulating gene expression. Maps of high-frequency interactions between different segments of chromatin have revealed topologically associating domains (TADs), within which most of the regulatory interactions are thought to occur. TADs are not homogeneous structural units but appear to be organized into a hierarchy. We present OnTAD, an optimized nested TAD caller from Hi-C data, to identify hierarchical TADs. OnTAD reveals new biological insights into the role of different TAD levels, boundary usage in gene regulation, the loop extrusion model, and compartmental domains. OnTAD is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/anlin00007/OnTAD">https://github.com/anlin00007/OnTAD</ext-link>.</p>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>National Institutes of Health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>R01 GM121613</award-id>
        <award-id>R01 GM109453</award-id>
        <award-id>R24 DK106766</award-id>
        <award-id>T32 GM102057</award-id>
        <principal-award-recipient>
          <name>
            <surname>Yang</surname>
            <given-names>Tao</given-names>
          </name>
          <name>
            <surname>Hardison</surname>
            <given-names>Ross C.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Qunhua</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Yu</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>National Institutes of Health (US)</institution>
        </funding-source>
        <award-id>U54 DK107980</award-id>
        <principal-award-recipient>
          <name>
            <surname>Nuebler</surname>
            <given-names>Johannes</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2019</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Previous studies have shown that the human genome is spatially organized at different levels in the nucleus, with each level of organization playing a role in gene regulation [<xref ref-type="bibr" rid="CR1">1</xref>]. Starting with the original Chromatin Conformation Capture (3C) assay [<xref ref-type="bibr" rid="CR2">2</xref>] for measuring chromatin interaction frequencies, many higher throughput, sequencing-based methods such as 4C, 5C, ChIA-PET, Hi-C, and Hi-ChIP have been developed to measure 3D interaction frequencies at different resolutions [<xref ref-type="bibr" rid="CR3">3</xref>–<xref ref-type="bibr" rid="CR8">8</xref>]. These maps of interaction frequencies between segments of chromatin are interpreted in terms of chromatin structures. Among the methods, Hi-C [<xref ref-type="bibr" rid="CR9">9</xref>] obtains measurement of chromatin interaction frequencies across the entire genome. Within some local regions in a genome, interactions are significantly higher than they are to adjacent regions; these highly interacting regions are termed “topologically associating domains” (TADs) [<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR11">11</xref>]. The proteins CTCF and cohesin are frequently enriched at TAD boundaries, and they have been implicated in the formation of an isolated local environment [<xref ref-type="bibr" rid="CR11">11</xref>]. Furthermore, the positions of many TADs are similar across different cell types and even conserved between species [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR12">12</xref>]. As a result, TADs have been widely interpreted as a basic architectural unit within which many gene regulatory interactions occur. To date, several computational methods have been developed to locate TADs in the genome. For example, Dixon et al. [<xref ref-type="bibr" rid="CR11">11</xref>] developed a “directionality index” based on the shift of interaction direction from upstream to downstream to estimate the boundaries of TADs. Other methods, such as TopDom [<xref ref-type="bibr" rid="CR13">13</xref>] and Insulation Score [<xref ref-type="bibr" rid="CR14">14</xref>], convert the TAD boundary finding problem to a local minimum identification problem by calculating the average interaction frequency of the surrounding regions at each locus.</p>
    <p id="Par3">While many earlier TAD calling methods treat TADs as a single structure, recent high-resolution studies have shown that TADs contain internal substructures, with subTADs nested within larger TADs [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR19">19</xref>] (Additional file <xref rid="MOESM2" ref-type="media">2</xref>). Several recently developed TAD calling methods aimed to identify nested TAD structures. For example, TADtree [<xref ref-type="bibr" rid="CR15">15</xref>] identifies TADs based on a relationship between the enrichment of contact frequency and TAD size and assembles TADs into a TAD tree that best fits the contact matrix. rGMAP [<xref ref-type="bibr" rid="CR16">16</xref>] assumes that the interaction frequency in subTADs is different from those in larger TADs and applies a Gaussian mixture model to identify both types of TADs. Arrowhead [<xref ref-type="bibr" rid="CR17">17</xref>] identifies corners of TADs at multiple sizes, allowing TADs and subTADs to be detected simultaneously. 3D-Net [<xref ref-type="bibr" rid="CR18">18</xref>] utilizes a maximization of network modularity to identify TADs at different levels. And finally, IC-Finder [<xref ref-type="bibr" rid="CR19">19</xref>] uses a hierarchical clustering method to identify the TAD hierarchy.</p>
    <p id="Par4">Although the aforementioned methods provide useful tools for identifying TADs and their internal substructure, we still lack a comprehensive understanding of the functions of the hierarchical structures within TADs. Recent work on low-resolution Hi-C data [<xref ref-type="bibr" rid="CR20">20</xref>] has shown that, at the large scale (&gt; 1 Mb), TADs can form a hierarchy of domains-within-domains (metaTAD) through TAD-TAD interactions, and the successive levels of metaTAD organization correlate with key epigenomic and expression features. This raises the natural question: Do the hierarchical levels within TADs also correlate with distinctive functional roles in chromosome organization and gene regulation? However, most existing TAD callers focus on identifying the locations of TADs and subTADs, rather than the hierarchical organization within TADs, making them less suitable for investigating the biological functions of the TAD hierarchy. Furthermore, many existing callers are computationally inefficient for high-resolution Hi-C data and often lack a principled approach to choosing algorithmic parameters [<xref ref-type="bibr" rid="CR16">16</xref>]. These issues limit the utility of existing TAD callers for investigating finer TAD structures using high-resolution data.</p>
    <p id="Par5">We present OnTAD, an optimized nested TAD caller that efficiently and robustly uncovers hierarchical TAD structures from Hi-C data. Our approach first identifies candidate TAD boundaries by scanning through the genome with a sliding window at a series of different window sizes. Then, the candidate boundaries are assembled into the optimized hierarchical TAD structures using a recursive dynamic programming algorithm based on a scoring function. Our systematic evaluation shows that OnTAD substantially outperforms existing TAD callers for both TAD boundary identification and hierarchical TAD assembly. Using OnTAD, we uncovered novel insights on the potential biological functions of TAD structures. In particular, we observed that active epigenetic states are substantially more enriched in inner TADs than in outer TADs. OnTAD results revealed two categories of TADs, those with or without hierarchical structures, that appear functionally distinct. Compared to non-hierarchical TADs, the boundaries of TADs with hierarchical structures show a higher CTCF enrichment, more active epigenetic states, and a higher level of gene expression. In addition, we observed an apparent asymmetry in TAD boundary sharing, supporting the asymmetric loop extrusion model for the formation of TADs [<xref ref-type="bibr" rid="CR21">21</xref>]. Together, these results demonstrate that OnTAD is a powerful tool for inferring different levels of chromatin organization across a genome in high-resolution Hi-C data, which should facilitate improved investigations into the roles of chromatin organization in gene regulation.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>The OnTAD algorithm</title>
      <p id="Par6">OnTAD takes a Hi-C contact matrix as the input and calls TADs in two steps. In the first step, the method finds candidate TAD boundaries using an adaptive local minimum search algorithm. Specifically, it scans along the diagonal of a Hi-C matrix using a <italic>W</italic> by <italic>W</italic> diamond-shaped window (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a), calculating the average contact frequency within each window. The locations at which the average contact frequency reaches a significant local minimum (1.96 standard deviations less than local maximum) are identified as candidate TAD boundaries (see the “<xref rid="Sec18" ref-type="sec">Methods</xref>” section for the details of the search algorithm). Because the sizes of TADs are unknown, OnTAD repeats the above steps using a series of window sizes, <italic>W</italic> = 1, 2., …, <italic>K</italic>, to uncover all possible boundaries for TADs in different sizes. Here, <italic>K</italic> depends on the resolution of the Hi-C matrix and the maximum TAD size that the user aims to call. For instance, for a 10-kb resolution Hi-C matrix and a maximum TAD size of 2 Mb, <italic>K</italic> = 2000/10 = 200. The union of the candidate boundaries of all window sizes is used to assemble TADs in the next step (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b).
<fig id="Fig1"><label>Fig. 1</label><caption><p>Overview of the OnTAD pipeline. <bold>a</bold> OnTAD uses a sliding diamond-shaped window to calculate the average contact frequency within the window at each locus on the genome. The five loci marked by letters “a”–“e” are examples being evaluated as potential TAD boundaries, with “d” being a clear false positive. <bold>b</bold> Identification of candidate TAD boundaries in OnTAD. Blue curve—the average contact frequency of the diamond-shaped windows, calculated at different window sizes (<italic>W</italic>) and different loci. Red arrows—the location of significant local minimums of the average contact frequency, i.e., candidate TAD boundaries. <bold>c</bold> OnTAD assembles candidate boundary pairs using a dynamic programming algorithm (see the “<xref rid="Sec18" ref-type="sec">Methods</xref>” section) <bold>d</bold> Visualization of the final output from OnTAD. In the genome browser, the identified hierarchical TAD is displayed as a series of horizontal bars, where each (sub) TAD is represented as a horizontal bar colored according to its TAD level</p></caption><graphic xlink:href="13059_2019_1893_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par7">In the second step, OnTAD assembles TADs by selectively connecting pairs of candidate boundaries using a dynamic programming algorithm (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c, see the “<xref rid="Sec18" ref-type="sec">Methods</xref>” section). To form a TAD between a pair of boundaries, OnTAD requires the mean contact frequency within the potential TAD area between the boundaries to exceed that of the surrounding area outside of the TAD by a user-defined margin (<italic>λ</italic>); otherwise, no TAD is formed between the boundaries. The dynamic programming algorithm is formulated to recursively identify the optimal partition of the genome for yielding the largest rightmost subTADs within each identified TAD according to a score function (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1) that de-convolutes the contact frequency signals across the TAD hierarchy (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2). At the end of the recursive procedure, the optimized solution that maximizes the score function is obtained (defined in the “<xref rid="Sec18" ref-type="sec">Methods</xref>” section), producing a hierarchical TAD organization that best fits the observed Hi-C contact matrix. The locations of the identified TADs are provided to the users as a plain text file and a bedgraph file ready for visualization on genome browsers.</p>
    </sec>
    <sec id="Sec4">
      <title>Comparison with existing TAD calling methods</title>
      <p id="Par8">We compared OnTAD with two representative non-hierarchical TAD calling methods (DomainCaller, TopDom) and three representative hierarchical TAD calling methods (rGMAP, Arrowhead, and TADtree) (Additional file <xref rid="MOESM2" ref-type="media">2</xref>), using the Hi-C data in GM12878 from Rao et al. [<xref ref-type="bibr" rid="CR17">17</xref>]. Each method was run using the settings recommended in its manual (see Additional file <xref rid="MOESM2" ref-type="media">2</xref> for the version and parameters for each method). All the evaluations were performed using 10-kb resolution for the normalized genome-wide Hi-C data, unless specified otherwise. We also tested OnTAD on raw data, and the results obtained were similar to those observed for normalized data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S9). The number of TADs, the distribution of TAD size, and the percentage of genome covered by TADs called by each method are summarized in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S11.</p>
      <sec id="Sec5">
        <title>Accuracy of TAD boundary detection</title>
        <p id="Par9">We first evaluated the accuracy of TAD boundary detection. It has been reported that chromatin domain boundaries are frequently occupied by genome architectural protein CTCF [<xref ref-type="bibr" rid="CR10">10</xref>] and cohesion complex [<xref ref-type="bibr" rid="CR21">21</xref>]; thus, these proteins are expected to be enriched at real TAD boundaries. We computed the average CTCF ChIP-seq signal in the boundaries identified by each TAD calling method as well as their neighborhood regions (± 100 kb). As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>a (left panel), all methods showed enrichment of CTCF signal in the identified TAD boundaries over that in the surrounding regions (fold change &gt; 1.63). Among them, OnTAD had the highest CTCF enrichment (mean signal 1.22× greater than that of the second-highest method, <italic>t</italic> test <italic>p</italic> value = 1.91e−28). A similar result was obtained for the enrichment of the RAD21 and SMC3 subunits of the cohesin complex. The boundaries identified by OnTAD showed a significantly higher enrichment of RAD21 and SMC3 signals than those identified by other methods (mean signal 1.14× and 1.04× greater than that of the second-highest method, <italic>t</italic> test <italic>p</italic> value = 9.34e−16 and 1.91e−12, respectively) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a, middle and right panels).
<fig id="Fig2"><label>Fig. 2</label><caption><p>Evaluation of TAD calling methods. <bold>a</bold> Average ChIP-seq signal at TAD boundaries and surrounding regions (± 10 bins) (from left to right, CTCF, SMC3, and RAD21). <bold>b</bold> Proportions of Hi-C signal variability explained by the called TADs (measured by TAD-adjR<sup>2</sup>) at a different genomic distance between two interacting loci (average TAD-adjR<sup>2</sup>: OnTAD 0.33, Arrowhead 0.26, DomainCaller 0.26, rGMAP 0.23, TopDom 0.08, and TADtree 0.06). <bold>c</bold>–<bold>e</bold> Reproducibility of TAD boundaries (Jaccard index): <bold>c</bold> between two biological replicates (GM12878, 10 kb), <bold>d</bold> between resolutions 5 kb vs 10 kb) and 10 kb vs 25 kb, and <bold>e</bold> across different down-sampled sequencing depths (GM12878, original vs 1/4, 1/8, 1/16, and 1/32 of the original sequencing depth, raw data was used). Note: TADtree was not included in <bold>d</bold>, because it has difficulty handling data with 5-kb resolution due to its large memory consumption. It also has difficulty for chr1–3 at 10-kb resolution either. Thus, these three chromosomes were excluded for all TAD callers in all comparisons. All <italic>p</italic> values are calculated based on two-sided <italic>t</italic> test</p></caption><graphic xlink:href="13059_2019_1893_Fig2_HTML" id="MO2"/></fig></p>
      </sec>
      <sec id="Sec6">
        <title>Accuracy of TAD assembly</title>
        <p id="Par10">We next evaluated the accuracy of TAD calling. If TADs are accurately called, one would expect that a high proportion of the variation in the contact frequencies in the Hi-C matrix is explained by TAD calls. We developed a metric called TAD-adjR<sup>2</sup>, which is a modified version of the adjusted <italic>R</italic><sup>2</sup> (see the “<xref rid="Sec18" ref-type="sec">Methods</xref>” section), to measure the proportion of Hi-C signal variation explained by TAD calls. Because contact frequencies decay over the genomic distance between a pair of interacting loci, we stratified the contacts by their genomic distance and calculated TAD-adjR<sup>2</sup> within each stratum. As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>b, OnTAD has a higher TAD-adjR<sup>2</sup> than that of the other methods across almost the entire span of genomic distances examined (0–1.5 Mb) (average TAD-adjR<sup>2</sup>: OnTAD 0.33, Arrowhead 0.26, DomainCaller 0.26, rGMAP 0.23, TopDom 0.08, and TADtree 0.06). This high level of explained Hi-C variance indicates that OnTAD produces a better classification between TADs and non-TAD regions compared to other methods.</p>
      </sec>
      <sec id="Sec7">
        <title>Reproducibility of TAD calls and boundaries</title>
        <p id="Par11">Another important criterion for TAD calling is the reproducibility of the identified TADs and their boundaries. We performed this analysis for the hierarchical callers of comparison. To measure the reproducibility of TAD boundaries, we calculated the agreement of boundaries (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c–e) between two TAD calling results using the Jaccard index. To measure the reproducibility of TADs, we treated each region covered by a TAD as a cluster of bins in the genome and then measured the agreement of cluster assignments between two TAD calling results using the adjusted Rand index (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3a-c). We evaluated the reproducibility in three scenarios: (1) between biological replicates (GM12878, 10 kb) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3a), (2) across different resolutions (5 kb, 10 kb, 25 kb) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3b), and (3) at different sequencing depths (original sequencing depth vs 1/4, 1/8, 1/16, and 1/32 of the total number of reads) (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3c). As shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>c–e and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S3b, both the boundaries and the TADs identified by OnTAD were fairly reproducible, consistently having either the highest or the second-highest Jaccard index or adjusted Rand index in all scenarios.</p>
      </sec>
      <sec id="Sec8">
        <title>Run time comparison</title>
        <p id="Par12">We recorded the run time of different methods on the same high-performance computing cluster (Xeon E5-2680CPU and 72 GB RAM). OnTAD ran notably faster than all the other methods (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). For example, it took OnTAD 655 s to analyze 10-kb resolution data for the whole genome, which was 2.6× faster than TopDom, 3× faster than Arrowhead, 24× faster than DomainCaller, 28× faster than rGMAP, and 263× faster than TADtree.</p>
      </sec>
    </sec>
    <sec id="Sec9">
      <title>Level of TAD hierarchy is related to gene activity and epigenomic states</title>
      <p id="Par13">We systematically studied the biological features of the TAD hierarchy, again using the Hi-C data in GM12878 from Rao et al. [<xref ref-type="bibr" rid="CR17">17</xref>]. Overall, 75.7% of the genome was covered by the TADs identified by OnTAD; the rest of the genome was not assigned to any TADs, and we refer to these TAD-free regions as gaps. Among all TADs identified by OnTAD, the majority (92.2%) contained or belonged to hierarchical structures, while a small fraction had no hierarchical structure. We referred to the former as “hierarchical TADs” or “nested TADs” and the latter as “singletons” (Fig. <xref rid="Fig3" ref-type="fig">3</xref>a). We hypothesized that chromatin organized into these two types of TADs may be playing distinctive roles in regulation, and thus, we examined their association with various epigenetic marks.
<fig id="Fig3"><label>Fig. 3</label><caption><p>Hierarchical TADs are more active than singletons. <bold>a</bold> An illustration of hierarchical levels of TADs. The levels are assigned from external to internal. The TADs covered by the cyan dash line are assigned to level 1, by blue dash line are assigned to level 2, by orange dash line are assigned to level 3, and singletons are also assigned to level 1 (cyan). <bold>b</bold> mean CTCF signal at the boundaries specific to hierarchical TADs (light green), specific to singletons (cyan), and shared between hierarchical TADs and singletons (orange). The boundaries of hierarchical TADs have the highest enrichment of CTCF signal. <bold>c</bold>, <bold>d</bold> Enrichment of epigenetic states at the regions covered by different levels of TADs. The enrichment (fold change) of active states (marked in orange in <bold>c</bold>) increases as the TAD level increases. The trend is visualized for the states of Tss, Enh, and PromCtcf in <bold>d</bold>. The whole-genome average is used as the background for calculating enrichments. <bold>e</bold>, <bold>f</bold> Density of expressed gene in different levels of TADs in GM12878 (<bold>e</bold>) and K562 (<bold>f</bold>)</p></caption><graphic xlink:href="13059_2019_1893_Fig3_HTML" id="MO3"/></fig></p>
      <sec id="Sec10">
        <title>Boundaries of hierarchical TADs have a higher CTCF enrichment</title>
        <p id="Par14">We first compared the CTCF enrichment (see the “<xref rid="Sec18" ref-type="sec">Methods</xref>” section) at the boundaries of the two types of TADs. Indeed, the boundaries of hierarchical TADs were substantially more enriched with CTCF signal than singleton boundaries (Fig. <xref rid="Fig3" ref-type="fig">3</xref>b) (mean CTCF signals are 3.51 and 2.25, respectively, <italic>t</italic> test <italic>p</italic> value = 1.52e−18). This enrichment of CTCF signal arose from a higher average number of CTCF peaks at the boundaries of hierarchical TADs. The mean number of CTCF peaks per boundary of a hierarchical TAD was 0.451, whereas it was only 0.181 for boundaries of singleton TADs (<italic>t</italic> test <italic>p</italic> value = 4.52e−30).</p>
      </sec>
      <sec id="Sec11">
        <title>Hierarchical TADs have a stronger association with active epigenetic states</title>
        <p id="Par15">Chromatin interactions are strongly associated with local, active epigenetic profiles [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. We thus expected to observe a positive association between the enrichment of active epigenetic states and the levels of TADs. Starting with the 36 epigenetic states defined by IDEAS segmentation [<xref ref-type="bibr" rid="CR23">23</xref>] on 6 ENCODE cell lines, we evaluated the association between active epigenetic states and TAD hierarchies. We classified hierarchical TADs into 5 levels, with level 1 being the outermost TADs, level 2 being the immediate subTADs nested under 1 layer of level 1 TAD, and so forth until level 5, which contains the subTADs nested under 4 or more layers of TADs in the hierarchy. We observed that the proportion of active epigenetic states increase along the levels of TADs (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c, d). In contrast, singletons are notably less active compared with hierarchical TADs (especially when level &gt; 2). In fact, singleton TADs showed enrichments similar to those for the gap regions. A similar pattern of enrichment for active states in hierarchical TADs was also observed in other cell types (K562 and HUVEC) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S4). Taken together, our results showed that hierarchical TADs are on average more active than singletons, and within hierarchical TADs, inner TADs (e.g., subTADs) are more active than outer TADs.</p>
      </sec>
      <sec id="Sec12">
        <title>Hierarchical TADs have more active gene expression</title>
        <p id="Par16">We further investigated how gene expression is associated with TAD hierarchies. Using the RNA-seq data of GM12878 from the ENCODE consortium (<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/">https://www.encodeproject.org/</ext-link>) [<xref ref-type="bibr" rid="CR24">24</xref>], we defined expressed genes as those with FPKM &gt; 5. Then, within TADs at each level, we computed the density of expressed genes (the number of expressed genes per bin, i.e., 10-kb region). If a gene was covered by more than one TAD, we associated it with the innermost TADs. We found that, as the TAD level increases, the density of expressed genes also increases, i.e., genes are more frequently activated within inner TADs than outer TADs (ANOVA test <italic>p</italic> value of &lt; 2.2e−16) (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e). Similarly, we observed the same trend of positive association between density of expressed genes and the TAD level (ANOVA test <italic>p</italic> value &lt; 2.2e−16) in the K562 cell line (Fig. <xref rid="Fig3" ref-type="fig">3</xref>f).</p>
      </sec>
    </sec>
    <sec id="Sec13">
      <title>Shared TAD boundaries are asymmetric and more active than other boundaries</title>
      <p id="Par17">It has been reported that TAD boundaries are enriched with actively expressed genes [<xref ref-type="bibr" rid="CR11">11</xref>]. We also observed that, for TADs at all levels, the number of expressed genes and the enrichment of active epigenetic states are significantly higher at the TAD boundaries than at the internal regions of TADs (all <italic>t</italic> test <italic>p</italic> values &lt; 0.001) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S5a&amp;b). Thus, we undertook an additional analysis of TAD boundaries.</p>
      <p id="Par18">We observed that the boundaries of hierarchical TADs were frequently shared by multiple TADs. We hypothesized that the boundary usage may play an important role in maintaining hierarchical structures and regulating gene activities. To investigate this hypothesis, we classified boundaries into five categories, according to the maximum number of TADs that use a boundary on one of the two sides of the boundary (Fig. <xref rid="Fig4" ref-type="fig">4</xref>a). A boundary is classified as level 1 if it is used by no more than one TAD on either side, level 2 if it is used by exactly two TADs on one side and less or equal to two TADs on the other side, and so forth to level 5 if it is used by five or more TADs on either side. For example, a boundary shared by two TADs to its left and three TADs to its right was classified as level 3. The number of boundaries assigned to each category is shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7.
<fig id="Fig4"><label>Fig. 4</label><caption><p>Hub-boundaries are highly active in gene regulation. <bold>a</bold> An illustration of the TAD boundary levels. The boundary levels are defined as the maximum number of TADs that use a boundary on either its left or right side. The yellow, purple, and red dots refer to the boundaries of levels 1, 2, and 3, respectively. <bold>b</bold> Enrichment of epigenetic states at different levels of TAD boundaries. Hub-boundaries (i.e., boundaries with level = 5) are enriched in active epigenetic states (marked in orange), especially the states associated with Tss (e.g., TssF, Tss, and TssCtcf). <bold>c</bold> Distribution of gene expression levels for genes whose transcription start sites overlap with TAD boundaries. Genes are classified by the level of TAD boundaries. <bold>d</bold> Illustration of hierarchical TAD and asymmetric loop extrusion. The red boundary denotes the “anchor” site that starts the loop extrusion in the asymmetric loop extrusion model. Boundaries in other colors are the stopping sites of the loop extrusion. The hierarchical TADs are formed by multiple stops of the loop extrusion which share the same start site. <bold>e</bold> TFs enriched (fold change &gt; 2) at hub-boundaries in GM12878 and K562 cell lines. The fold change of ChIP-seq TF peaks at hub-boundaries (level = 5) against level 1 boundaries is shown</p></caption><graphic xlink:href="13059_2019_1893_Fig4_HTML" id="MO4"/></fig></p>
      <sec id="Sec14">
        <title>Epigenetic and genomic profiles</title>
        <p id="Par19">We examined the enrichment of active epigenetic states at different boundary levels. We observed a significant positive correlation between the enrichment (fold change) of active epigenetic states and the number of times each boundary is shared (e.g., Tss state: Pearson coefficient = 0.89; TssCtcf state: Pearson coefficient = 0.92) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>b). We further studied the relationship between gene expression level and boundary sharing. Again, we observed a significant positive association between the number of times a boundary was shared and the gene expression level (ANOVA test <italic>p</italic> value = 1.97e−05). In particular, the gene expression level at the boundaries that were shared by five or more TADs was substantially higher than that at boundaries that were shared by fewer TADs (Fig. <xref rid="Fig4" ref-type="fig">4</xref>c). At a higher-level boundary, multiple genomic loci (the boundary plus the other ends of the TADs) must be in proximity in 3D space. This situation is reminiscent of chromatin hubs, and thus, we call the boundaries shared by five or more TADs “hub-boundaries.” We posited that hub-boundaries are more active in gene regulation than boundaries that are shared by fewer TADs.</p>
      </sec>
      <sec id="Sec15">
        <title>The asymmetric loop extrusion model</title>
        <p id="Par20">Interestingly, we also observed some asymmetry in boundary usage and TAD formation in hierarchical TADs. Specifically, we have observed (1) a significant difference in boundary usage between the left and the right boundaries of the same outer TAD (<italic>Z</italic> test <italic>p</italic> value &lt; 2.2e−16), (2) a significant difference in the numbers of TADs formed by a boundary on its left and right sides (<italic>Z</italic> test <italic>p</italic> value &lt; 2.2e−16) (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S2).</p>
        <p id="Par21">We therefore asked if the observed asymmetry is related to the mechanism of loop formation. A recent study in yeast suggested that loops are formed in an asymmetric process, where the loop extrusion complex anchors on one side and DNA reels through from the other side [<xref ref-type="bibr" rid="CR25">25</xref>]. We here hypothesize that loop extruders are preferentially loaded at or near a specific TAD boundary. Then, the asymmetric loop extrusion would start from this site on one end, and it could stop at different sites on the other end. Thus, the TADs formed by multiple stops of loop extrusion in this process would all share the anchor site as the boundary on one side, but each has a different boundary on the other side, leading to the observed asymmetric boundary usage (Fig. <xref rid="Fig4" ref-type="fig">4</xref>d). Another recent study in <italic>Drosophila</italic> Schneider 2 (S2) cells showed that promoters prefer to interact with enhancers downstream of the transcriptional unit [<xref ref-type="bibr" rid="CR26">26</xref>], leading to a directional preference in TAD formation. Indeed, as shown in Fig. <xref rid="Fig4" ref-type="fig">4</xref>b, the boundaries shared by multiple TADs are highly enriched with promoters; thus, the observed orientation asymmetry in TAD formation around these boundaries could reflect this interaction preference in promoters.</p>
        <p id="Par22">While some proteins (e.g., Ycg1 HEAT-repeat and Brn1 kleisin subunits) have been found to be related to the anchor sites in yeast [<xref ref-type="bibr" rid="CR27">27</xref>], little is known about the proteins supporting the anchor sites in humans. We therefore performed a transcription factor (TF) enrichment analysis using 161 TF ChIP-seq data from the ENCODE consortium [<xref ref-type="bibr" rid="CR28">28</xref>–<xref ref-type="bibr" rid="CR30">30</xref>]. By comparing the fold enrichment of each TF signal in hub-boundary (level 5) with the ones at low level (level 1), we found a group of TFs that were highly enriched in hub-boundaries (fold change &gt; 2 in either GM12878 (<italic>n</italic> = 8) or K562 (<italic>n</italic> = 37)) (Fig. <xref rid="Fig4" ref-type="fig">4</xref>e). These hub-boundary-enriched TFs were strongly associated with chromosome organization function in Gene Ontology (GO) analysis (FDR = 1.33e−06 from PANTHER). They were also shown to be highly connected (<italic>p</italic> value &lt; 1.0e−16) in the protein-protein interaction database, STRING (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S7), suggesting that they may potentially form a protein complex. Together, these results suggest that the enriched TFs may play an important role in forming the anchor sites in the asymmetric extrusion process.</p>
      </sec>
    </sec>
    <sec id="Sec16">
      <title>Hierarchical TAD calling unveils distinct epigenetic features of inner TADs</title>
      <p id="Par23">It has been reported that genomic loci within the same TADs tend to possess similar epigenetic features [<xref ref-type="bibr" rid="CR22">22</xref>], while loci in different adjacent TADs may show different epigenetic features [<xref ref-type="bibr" rid="CR17">17</xref>]. However, it remains unclear if the divergence of epigenetic profiles also takes place at the subTAD level. To explore the possible answer to this question, we performed OnTAD on Hi-C data from the mouse G1E-ER4 cell [<xref ref-type="bibr" rid="CR31">31</xref>]. We observed that the majority of TADs (87.1%) are in active compartments. As shown in the OnTAD genome browser track in Fig. <xref rid="Fig5" ref-type="fig">5</xref>, the region of chr19 (11.3–12.2 Mb) contains multiple nested TADs. Among them, two adjacent subTADs (11.8–11.9 Mb and 11.9–12.0 Mb) that belong to the same outer TAD (chr19, 11.6–12.0 Mb) exhibit distinct epigenetic features, with enriched repressive epigenetic signal (H3K27me3) in the left subTAD and enriched active epigenetic signal (H3K27ac, H3K4me3, and H3K36me3) in the right subTAD. This demonstrates that, although TADs were traditionally considered to be a fundamental unit of chromatin organization, epigenetic features can be distinctively different between subTADs. Our results show that the subTADs identified by OnTAD better represent homogeneous units associated with epigenetic functions, capturing distinct functional features within subTADs. By identifying these subTADs, OnTAD enables a finer investigation of the hierarchy of chromatin organization and its functionally homogeneous structures.
<fig id="Fig5"><label>Fig. 5</label><caption><p>subTADs exhibit distinctive epigenetic profiles. The captured region is chr19, 11.3–12.2 Mb in mouse G1E-ER4. The Hi-C heatmap (generated by the 3D Genome Browser [<xref ref-type="bibr" rid="CR43">43</xref>]) shows a nested TAD structure in this region. OnTAD results are displayed in the genome browser track: blue line denotes level 1 TAD, green line denotes level 2 TAD, purple denotes level 3 TAD, and orange denotes level 4 TAD. The two subTADs (orange lines) exhibit distinctive epigenetic features, with one enriched with repressive signals (H3K27me3) and silenced expression (low RNA-seq signal) and the other enriched with active signals (H3K27ac, H3K4me3, and H3K36me3) and expression (high RNA-seq signal). The shared boundary (marked by dash box) between these two subTADs has no CTCF peak, indicating the formation of these two subTADs may not involve loop extrusion</p></caption><graphic xlink:href="13059_2019_1893_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par24">Interestingly, we observed that whereas the outer TAD (11.8–12.0 Mb) had clear CTCF signals at its boundaries, the shared boundary between the two subTADs (11.8–11.9 Mb and 11.9–12.0 Mb) had no CTCF signals from the CTCF ChIP-seq data. This indicates that the formation of these two subTADs is probably independent of CTCF. Furthermore, we performed a high-resolution compartment analysis (see the “<xref rid="Sec18" ref-type="sec">Methods</xref>” section). It showed that the two subTADs fall in different compartments. These results can be interpreted within the framework of recently proposed “compartmental domains” [<xref ref-type="bibr" rid="CR32">32</xref>, <xref ref-type="bibr" rid="CR33">33</xref>], which are hypothesized to be formed by A/B compartment without the involvement of CTCF. We will discuss this mechanism further in the “<xref rid="Sec17" ref-type="sec">Discussion</xref>” section.</p>
    </sec>
  </sec>
  <sec id="Sec17">
    <title>Discussion</title>
    <p id="Par25">While hierarchical structures in TAD formation have been reported [<xref ref-type="bibr" rid="CR15">15</xref>, <xref ref-type="bibr" rid="CR16">16</xref>, <xref ref-type="bibr" rid="CR18">18</xref>, <xref ref-type="bibr" rid="CR19">19</xref>], the involvement of these hierarchies in gene regulation mechanisms remains poorly understood. This is partly due to the lack of a method that systematically identifies TAD hierarchies from Hi-C data and investigates the association of TAD hierarchies with epigenetic features. Here, we introduce OnTAD, a new method to uncover the hierarchical TAD structures from Hi-C data. Based on a dynamic programming procedure that recursively finds the best domain partition of the Hi-C contact matrix in a hierarchical manner, OnTAD identifies the hierarchy of TADs and their boundaries. It produces a convenient output for visualizing the hierarchy in a genome browser, greatly facilitating the investigation of the interplay between hierarchical TADs and other epigenetic features in gene regulation. Our comprehensive evaluation shows that OnTAD substantially outperforms the existing TAD calling methods in both accuracy and computational efficiency. These results demonstrated the effectiveness of OnTAD for identifying TAD hierarchies and investigating their biological functions.</p>
    <p id="Par26">Using the results from OnTAD, we investigated how hierarchies within TADs were associated with features related to function. In particular, we observed that, on average, hierarchical TADs were significantly more active than TADs without hierarchies (i.e., singletons). The active epigenetic states and active genes were also significantly more enriched in the boundaries shared by multiple TADs (e.g., hub-boundaries) than those used exclusively by a single TAD. These observations echo those on the hierarchy of metaTADs, which also showed a positive association between the enrichments in promotor activity and gene density and boundary usage [<xref ref-type="bibr" rid="CR20">20</xref>]. Interestingly, we also observed a significant asymmetry in boundary usage between the left and right boundaries in the hierarchical TADs and an asymmetry in the orientation of TAD formation around hub-boundaries, supporting the asymmetric loop extrusion model [<xref ref-type="bibr" rid="CR25">25</xref>] and preferential orientation of promoter interaction [<xref ref-type="bibr" rid="CR26">26</xref>]. Further experimental investigation is warranted to test these hypotheses.</p>
    <p id="Par27">Our results pose several interesting questions about the mechanisms utilized to form these structures. First, how are these hierarchical TAD structures formed? Are they produced by hierarchical chromatin folding in single cells, or does the nesting reflect a collection of different interaction patterns in individual cells that looks like a hierarchy when the data from a population of cells is aggregated in bulk cell Hi-C data? Single-allele chromatin interactions do reveal regulatory hubs [<xref ref-type="bibr" rid="CR34">34</xref>], supporting the interpretation that these complex interactions occur in individual cells. A recent single-cell analysis of high-throughput Oligopaint labeling and imaging on Chr21 of A549 cell showed that both TAD and subTAD structures exist in single cells [<xref ref-type="bibr" rid="CR35">35</xref>]. Furthermore, nested TAD structures could be formed by multi-site interactions in a single cell [<xref ref-type="bibr" rid="CR35">35</xref>]. However, as acknowledged by the authors, it is still possible that some other domain structures resulted from population averaging. In principle, OnTAD can also be applied to single-cell Hi-C data to explore this question. However, the genome coverage in current single-cell Hi-C data is still low and can only support the analysis at the resolution of ~100 kb, limiting the detection of finer domain structures (typically ~ 50 kb for subTADs we identified). Future studies with higher resolution single-cell Hi-C data will be valuable for addressing this question at a genome-wide scale.</p>
    <p id="Par28">Second, what are the mechanisms to form the hierarchical structures? As observed in our analyses (Fig. <xref rid="Fig5" ref-type="fig">5</xref>), though the majority of the outer TAD boundaries were bound by CTCF, some subTADs appear to be formed without CTCF binding at their boundaries. The formation of the latter can be explained by the recently proposed “compartmental domains” mechanism [<xref ref-type="bibr" rid="CR33">33</xref>], which forms domains by establishing A/B compartments without the involvement of CTCF or loop extrusion. Because OnTAD does not rely on CTCF information for TAD identification, it can capture all domain structures, regardless of the formation mechanisms. The example in Fig. <xref rid="Fig5" ref-type="fig">5</xref> could be explained by joint processes of loop extrusion (for the outer TAD) and establishment of “compartmental domains” [<xref ref-type="bibr" rid="CR33">33</xref>] for the inner TADs.</p>
    <p id="Par29">In summary, we have demonstrated that the hierarchies of TAD structures are associated with gene regulation and have provided a powerful tool for exploring this association. Though previous results based on low-resolution data suggest that the majority of TAD structures are similar across cell lines [<xref ref-type="bibr" rid="CR11">11</xref>], recent analyses found that certain locally frequent interaction regions within TADs are cell type specific [<xref ref-type="bibr" rid="CR36">36</xref>]. It will be particularly interesting to use OnTAD to systematically investigate how the finer domain structures within TADs differ across cell types, for example, how the levels of hierarchy differ across cell types, and how the changes in the hierarchy are associated with differential gene regulation. The biological insights generated by analyses of the finer domain structures should help improve our understanding of the role of chromatin conformation in gene regulation.</p>
  </sec>
  <sec id="Sec18">
    <title>Methods</title>
    <sec id="Sec19">
      <title>Notations and data preprocessing</title>
      <p id="Par30">Let <italic>X</italic> denote a symmetric Hi-C matrix, where each entry (<italic>i</italic>, <italic>j</italic>) in the matrix is a value quantifying the strength of the chromatin interaction between bins <italic>i</italic> and <italic>j</italic>. The Hi-C matrix can be a raw contact matrix or a normalized matrix produced by normalization procedures such as ICE [<xref ref-type="bibr" rid="CR37">37</xref>] and KR [<xref ref-type="bibr" rid="CR17">17</xref>]. Let <italic>X</italic> [<italic>a</italic>:<italic>b</italic>, <italic>c</italic>:<italic>d</italic>] = {(<italic>i</italic>, <italic>j</italic>): <italic>a</italic> ≤ <italic>i</italic> ≤ b, <italic>c</italic> ≤ <italic>j</italic> ≤ d} denote a submatrix of <italic>X</italic>. A candidate TAD between bins <italic>a</italic> and <italic>b</italic> corresponds to a diagonal block matrix <italic>X</italic><sub>[<italic>a</italic>,<italic>b</italic>]</sub> = <italic>X</italic> [<italic>a</italic>:<italic>b</italic>, <italic>a</italic>:<italic>b</italic>], where the mean of the entries in <italic>X</italic><sub>[<italic>a</italic>,<italic>b</italic>]</sub> is expected to be higher than that in its neighboring matrices. Because of the distance dependency in Hi-C data, i.e., the dependence of contact frequency on the proximity of the interaction loci, we normalize the Hi-C matrix before TAD calling by subtracting the mean counts at each distance.</p>
    </sec>
    <sec id="Sec20">
      <title>Identification of candidate TAD boundaries</title>
      <p id="Par31">We identify candidate TAD boundaries using an approach modified from the boundary detection procedure in the TopDom method [<xref ref-type="bibr" rid="CR13">13</xref>], a non-hierarchical TAD caller. Specifically, the TopDom boundary detection procedure scans the diagonal of the Hi-C matrix, using a square submatrix that slides its bottom corner on the diagonal (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). At each location, it computes the mean Hi-C signal within the submatrix, which will be referred to as the TopDom statistic thereafter. When the corner of the submatrix lands on a TAD boundary, the TopDom statistic reaches a local minimum. Thus, the local minimums of the TopDom statistic can be used as candidate boundaries for constructing TADs. As demonstrated in [<xref ref-type="bibr" rid="CR13">13</xref>], the boundaries obtained from this procedure at an optimal window size show enriched epigenetic characteristics of TADs boundaries.</p>
      <p id="Par32">However, the above procedure can only identify boundaries at a fixed window size; thus, it is unable to capture the TADs of different sizes on the TAD hierarchy. To identify all candidate TAD boundaries in the entire TAD hierarchy, OnTAD calculates the TopDom statistics at a series of window sizes (<italic>W</italic>), ranging from 1 to a maximum TAD size (<italic>d</italic>) specified by users. Here, we set the minimum size = 3 bins, because structures smaller than 3 bins are too small to form a domain. We set the maximum size = 200 for 10-kb Hi-C data, because TADs are known to be smaller than a few megabytes.</p>
      <p id="Par33">For each window size <italic>W</italic>, we first obtained a set of local minimums of the TopDom statistics, which are defined as the smallest value in the neighborhood of [<italic>i</italic> − Lsize, <italic>i</italic> + Lsize]. To reduce false positives due to noise, the local minimums that are not significantly smaller than the local maximums in the same neighborhood are pruned. Here, we required the local minimums to be at least 1.96S smaller than the local maximums to be qualified as a candidate boundary, where <italic>S</italic> is the standard deviation of the TopDom statistic in the entire matrix. The parameter 1.96 is chosen based on the 95% confidence level of a normal distribution, which reasonably approximates the distribution of the TopDom statistic.</p>
      <p id="Par34">Figure <xref rid="Fig1" ref-type="fig">1</xref>b shows examples of the local minimums on the genome at different window sizes. Because different window sizes capture the information of TADs in different sizes, we took the union of the pruned local minimums over all window sizes and used the corresponding bins as candidate TAD boundaries. We selected <italic>z</italic> according to the procedure described in the “<xref rid="Sec24" ref-type="sec">Parameter selection</xref>” section. For all the analyses in this work, we used Lsize = 5. It can be adjusted by users.</p>
    </sec>
    <sec id="Sec21">
      <title>Recursive TAD calling algorithm</title>
      <p id="Par35">We developed a TAD calling algorithm to assemble TADs from the candidate boundaries. Several issues need to be considered in the design of the algorithm in order to produce biologically meaningful TADs. First, because a region may be shared by multiple TADs, the scores of these TADs can be strongly correlated. Second, in the TADs with nested structures, the scores of the TADs and their nested subTADs are convoluted. Third, some boundaries may be shared between TADs. Last, the algorithm needs to be computationally efficient to call TADs on the genome scale.</p>
      <p id="Par36">To address these issues, we developed a recursive algorithm to identify the TADs that give the optimal partition of the genome according to a scoring function related to the strength of Hi-C signals (see the “<xref rid="Sec22" ref-type="sec">Evaluation of the violation of the hierarchical TAD assumption</xref>” section). Our algorithm assumes that any given two TADs are either disjoint (but can share one boundary) or nested (i.e., one TAD is completely within the other). This assumption is required for the dynamic programming to find an optimal solution in polynomial time. While this assumption sometimes may not be true, it greatly reduces the complexity of the problem while still enabling us to (1) de-convolute nested TAD structures, (2) impose shared boundaries, and (3) obtain an efficient algorithmic solution. Our evaluation showed that the majority of the genome follows this assumption (see the “<xref rid="Sec22" ref-type="sec">Evaluation of the violation of the hierarchical TAD assumption</xref>” section). Even when it is violated, i.e., the boundaries of the TADs cross each other, our method can still produce a reasonable approximation (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S1C).</p>
      <p id="Par37">Briefly, the algorithm works as follows. Given a matrix <italic>X</italic><sub>[<italic>a</italic>,<italic>b</italic>]</sub>, the algorithm starts at the root level to first find the best bin <italic>i</italic> (<italic>a</italic> ≤ <italic>i</italic> &lt; <italic>b</italic>) to partition the matrix into two submatrices, <italic>X</italic><sub>[<italic>a</italic>,<italic>i</italic>]</sub> and <italic>X</italic><sub>[<italic>i</italic>,<italic>b</italic>]</sub>, such that <italic>X</italic><sub>[<italic>i</italic>,<italic>b</italic>]</sub> is the largest right-most TAD in <italic>X</italic><sub>[<italic>a</italic>,<italic>b</italic>]</sub>. Since <italic>X</italic><sub>[<italic>a</italic>,<italic>i</italic>]</sub> and <italic>X</italic><sub>[<italic>i</italic>,<italic>b</italic>]</sub> are disjointed, the TADs within each submatrix can be called separately in a recursive manner. At each recursive step, the parent matrix is partitioned into two submatrices, and TADs are called within each submatrix using the same recursive formula (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2A). The recursion stops when <italic>i</italic> = <italic>a</italic>, i.e., the submatrix <italic>X</italic><sub>[<italic>a</italic>,<italic>i</italic>]</sub> contains no TAD. After a recursive step is completed, it identifies the best TADs in the current branch according to the scoring function, de-convolutes the TAD signals in the parent matrix by removing signals of inner TADs, and evaluates if the parent matrix itself is a TAD. This process is repeated until the recursion returns to the root level (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S2B). Note that, because every TAD is the largest right-most TAD of a parent matrix in a recursive branch, this recursive procedure guarantees to traverse all TADs, even though only the largest right-most TAD is called at each step.</p>
      <sec id="Sec22">
        <title>Evaluation of the violation of the hierarchical TAD assumption</title>
        <p id="Par38">To investigate the frequency of the violation of the hierarchical TAD assumption, we ran OnTAD on high-resolution (10 kb) in situ Hi-C data in GM12878. We segregated the regions around the corner of each TAD into four 5 × 5 quadrants and calculated the average contact frequency of each quadrant (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8). If this assumption holds, the interaction frequency is expected to be high in the quadrant within TAD (quadrant 1) and relatively low in at least one of the two quadrants (2 and 3) on the two sides outside of TAD corner. As shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S8, the mean frequency patterns of the four quadrants for most of the TAD corners are consistent with our expectations. This suggests that this assumption holds for a majority of the genome. The violation can be remedied by removing the signals from the called TADs and then rerunning OnTADs on the de-clumped Hi-C data to identify additional TADs.</p>
      </sec>
    </sec>
    <sec id="Sec23">
      <title>The scoring function</title>
      <p id="Par39">Our scoring function <italic>h</italic>(<italic>X</italic><sub>[<italic>a</italic>, <italic>b</italic>]</sub>) for matrix <italic>X</italic><sub>[<italic>a</italic>,<italic>b</italic>]</sub> is defined as:
<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ h\left({X}_{\left[a,b\right]}\right)=g\left({X}_{\left[a,b\right]}\right)+\Delta \left({X}_{\left[a,b\right]}|\mathrm{subTADs}\right) $$\end{document}</tex-math><mml:math id="M2" display="block"><mml:mi>h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="13059_2019_1893_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par40">where
<disp-formula id="Equa"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\displaystyle \begin{array}{c}g\left({X}_{\left[a,b\right]}\right)={\max}_i\Big\{\begin{array}{cc}0&amp; i=a\\ {}\max \left(0,t\left({X}_{\left[a,i\right]}\right)+t\left({X}_{\left[i,b\right]}\right)\right)&amp; i=a+1,\dots, b-1\end{array}\operatorname{}\\ {}\kern0ex \mathrm{and}t\left({X}_{\left[a,i\right]}\right)=\max \left(g\left({X}_{\left[a,i\right]}\right),h\left({X}_{\left[a,i\right]}\right)\right)\end{array}} $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mi>g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="center center" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable><mml:mo fence="true" stretchy="true" symmetric="true"/></mml:mrow><mml:mspace linebreak="newline"/><mml:mrow><mml:mi mathvariant="normal">a</mml:mi><mml:mi mathvariant="normal">n</mml:mi><mml:mi mathvariant="normal">d</mml:mi></mml:mrow><mml:mrow/><mml:mi>t</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mo form="prefix" movablelimits="true">max</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:math><graphic xlink:href="13059_2019_1893_Article_Equa.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par41">Here, <italic>g</italic>(<italic>X</italic><sub>[<italic>a</italic>, <italic>b</italic>]</sub>) is the score of TADs within <italic>X</italic><sub>[<italic>a</italic>,<italic>b</italic>]</sub>, not including the score for <italic>X</italic><sub>[<italic>a</italic>,<italic>b</italic>]</sub> itself being a TAD. It is calculated by finding the best left boundary of the largest right-most TAD in <italic>X</italic><sub>[<italic>a</italic>,<italic>b</italic>]</sub>. <italic>h</italic>(<italic>X</italic><sub>[<italic>i</italic>, <italic>b</italic>]</sub>) is the score of the largest right-most TAD in <italic>X</italic><sub>[<italic>a</italic>,<italic>b</italic>]</sub>. It is the sum of the score of TADs within <italic>X</italic><sub>[<italic>i</italic>, <italic>b</italic>]</sub> and the score of <italic>X</italic><sub>[<italic>i</italic>, <italic>b</italic>]</sub> itself being a TAD, namely Δ(<italic>X</italic><sub>[<italic>i</italic>, <italic>b</italic>]</sub>| subTADs). For any diagonal block matrix to be called a TAD, its mean signal is required to be greater than the means of its neighboring regions on both sides. We therefore define:
<disp-formula id="Equb"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \Delta \left({X}_{\left[i,b\right]}|\mathrm{subTADs}\right)=m\left({X}_{\left[i,b\right]}|\mathrm{subTADS}\right)-\max \left(\overline{X\left[\left(i-\left(b-i+1\right)\right):\left(b-\left(b-i+1\right)\right),i:b\right]},\overline{X\left[i:b,\left(i+\left(b-i+1\right)\right):\left(b+\left(b-i+1\right)\right)\right]}\right)-\lambda $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">s</mml:mi><mml:mi mathvariant="normal">u</mml:mi><mml:mi mathvariant="normal">b</mml:mi><mml:mi mathvariant="normal">T</mml:mi><mml:mi mathvariant="normal">A</mml:mi><mml:mi mathvariant="normal">D</mml:mi><mml:mi mathvariant="normal">S</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mo>max</mml:mo><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi><mml:mo>[</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>:</mml:mo><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>b</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo stretchy="false">−</mml:mo></mml:mover></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>X</mml:mi><mml:mo>[</mml:mo><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>:</mml:mo><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>]</mml:mo></mml:mrow><mml:mo stretchy="false">−</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:math><graphic xlink:href="13059_2019_1893_Article_Equb.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par43">where <italic>m</italic>(<italic>X</italic><sub>[<italic>i</italic>,<italic>b</italic>]</sub>|subTADs) denotes the mean of <italic>X</italic><sub>[<italic>i</italic>,<italic>b</italic>]</sub>, excluding the TADs within <italic>X</italic><sub>[<italic>i</italic>,<italic>b</italic>]</sub>, returned by the recursion; <italic>λ</italic> is a user-specified non-negative penalty parameter; <italic>X</italic>[(<italic>i</italic> − (<italic>b</italic> − <italic>i</italic> + 1)) : (<italic>b</italic> − (<italic>b</italic> − <italic>i</italic> + 1)), <italic>i</italic> : <italic>b</italic>] and <italic>X</italic>[<italic>i</italic> : <italic>b</italic>, (<italic>i</italic> + (<italic>b</italic> − <italic>i</italic> + 1)) : (<italic>b</italic> + (<italic>b</italic> − <italic>i</italic> + 1))] are the two (b − i + 1) by (b − i + 1) off-diagonal matrices in the adjacent flanking regions of <italic>X</italic><sub>[<italic>i</italic>,<italic>b</italic>]</sub>; and finally, <inline-formula id="IEq1"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overline{X} $$\end{document}</tex-math><mml:math id="M8" display="inline"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1893_Article_IEq1.gif"/></alternatives></inline-formula> denotes the mean of <italic>X</italic>. The parameter <italic>λ</italic> serves as a threshold for TAD calling. That is, a TAD will be called only when the mean contact frequency within the potential TAD area between the boundaries exceeds that of the surrounding area outside of the TAD by the margin of <italic>λ</italic>. The procedure for selecting <italic>λ</italic> is described in the “<xref rid="Sec24" ref-type="sec">Parameter selection</xref>” section.</p>
      <p id="Par44">When the score of a candidate TAD is &lt; 0, it is likely not a real TAD. We therefore set all negative scores as 0's after finishing the score calculation for the entire contact matrix and only output the TADs with positive scores.</p>
    </sec>
    <sec id="Sec24">
      <title>Parameter selection</title>
      <p id="Par45">We selected the value of <italic>λ</italic> based on the false discovery rate (FDR) of TAD identification. The FDR is calculated as follows. First, the entries in the real Hi-C matrix are permuted within each genomic distance. This results in a null Hi-C matrix that has the same marginal signal distribution as the original Hi-C matrix but without biologically meaningful TAD structures. Next, OnTAD is run on both the original and the permuted Hi-C matrices for a series of <italic>λ</italic>. The TADs identified from the original Hi-C matrix are treated as “discoveries” (<italic>R</italic>), which is a mixture of false and true discoveries, and those from the permuted Hi-C matrix are treated as “false discoveries” (<italic>V</italic>), which is used to approximate the proportion of false discoveries in <italic>R</italic>. Recall that OnTAD assigns each TAD a score according to the scoring function (1). Given a TAD size, the magnitude of the score reflects the strength of evidence to call TAD. Because larger TADs tend to have a lower mean contact frequency after removing their inner TADs, the score is usually smaller for larger TADs. Therefore, we computed the FDR accounting for TAD size. Specifically, for a given value of <italic>λ</italic>, the identified TADs are first stratified by their sizes and scores. Let <italic>n</italic> be the total number of TADs identified on the original matrices, and <italic>R</italic><sub><italic>i</italic></sub> and <italic>V</italic><sub><italic>i</italic></sub> be the numbers of TADs in the <italic>i</italic>th stratum from the original and the permuted matrices, respectively. Then, if a TAD (<italic>j</italic>) is in the <italic>i</italic>th stratum, the probability for the TAD to be a false discovery (a.k.a. local false discovery rate [<xref ref-type="bibr" rid="CR38">38</xref>] is <inline-formula id="IEq2"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {p}_j=\min \Big(\frac{V_i}{R_i},1 $$\end{document}</tex-math><mml:math id="M10" display="inline"><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>min</mml:mo><mml:mo stretchy="true">(</mml:mo><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfrac><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:math><inline-graphic xlink:href="13059_2019_1893_Article_IEq2.gif"/></alternatives></inline-formula>).</p>
      <p id="Par47">The overall FDR for the TAD identification is computed as the average of the probability to be a false discovery over all TADs identified on the original matrix, based on the relationship between local fdr and FDR [<xref ref-type="bibr" rid="CR38">38</xref>]:
<disp-formula id="Equc"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mathrm{FDR}=\frac{\sum_{j=1}^n{p}_j}{n} $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:mi>FDR</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:math><graphic xlink:href="13059_2019_1893_Article_Equc.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par48">The above FDR calculation is repeated for each value of <italic>λ</italic>, and the <italic>λ</italic> corresponding to the FDR cutoff of 0.05 is selected.</p>
      <p id="Par49">In our analysis, the stratum is formed by dividing the TAD calls into 25 equal shares according to the ranking of TAD size (or TAD score) on the real matrix. This leads to 25 × 25 = 625 strata in total. As shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S3, the FDR is close to 0.05 at λ = 0.1 for the GM12878 dataset (10 kb). To test the robustness of the tuned parameter, we also performed the same procedure on the mouse G1E-ER4 Hi-C data from Hsu et al. [<xref ref-type="bibr" rid="CR31">31</xref>] at 10-kb resolution. The FDR was also controlled at the 0.05 level when <italic>λ</italic> = 0.1 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S4). Therefore, we used <italic>λ</italic> = 0.1 as the default value in our analyses. In the OnTAD software, we allow users to specify the value of <italic>λ</italic> to offer more flexibility.</p>
      <p id="Par50">Another important tuning parameter is Lsize, which is the span of the interval (i.e., the interval size = 2 × Lsize + 1) for searching local minimums of the TOPDOM statistics. This parameter affects the selection of candidate boundaries. If Lsize is too large, some potential boundaries will be missed. If Lsize is too small, the candidate boundary set may include many false positives, increasing the computational burden for the assembly step and the quality of the final results. We chose Lsize in a similar way as for choosing <italic>λ</italic> on GM12878 data (10 kb). Specifically, we ran OnTAD for different values of Lsize (range = 3–10), corresponding to the interval size of 7–21 bins. We chose this range because it is sufficient to cover various TAD sizes. As shown in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S5, Lsize = 5 (i.e., interval size = 11) renders an FDR close to 0.05. Therefore, we chose Lsize = 5 for all analyses. To evaluate the robustness of this choice, we evaluate the similarity of the identified TAD structures between Lsize = 5 and Lsize = 6–10 and found that they are similar, with the median of the adjusted rand indices &gt; 0.75 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Figure S10). It indicates the result is relatively insensitive to the value of Lsize when Lsize = 5~10.</p>
    </sec>
    <sec id="Sec25">
      <title>Computation complexity of the TAD calling algorithm</title>
      <p id="Par51">We performed an analysis on the computational complexity for our recursive algorithm. For an <italic>l</italic> × <italic>l</italic> Hi-C matrix, if all bins are potential boundaries, then the recursion needs to visit <italic>l</italic>(<italic>l</italic> + 1)/2 diagonal block submatrices. As there are <italic>l</italic> size 1 diagonal block matrices, the computation complexity for computing the scores of all size 1 matrices is <italic>O</italic>(<italic>l</italic>). Given the scores of size 1 matrices, we can calculate the scores of size 2 matrices. There are (<italic>l</italic> − 1) of them, each enumerating through (2–1) partitions. Hence, the time complexity is <italic>O</italic>((2–1)(<italic>l</italic> − 1)). Following the same calculation, the scores of one submatrix of size <italic>k</italic> will be computed by enumerating (<italic>k</italic> − 1) partitions. As there are (<italic>l</italic> − <italic>k</italic> + 1) of them, the time complexity is <italic>O</italic>((<italic>k</italic> − 1)(<italic>l</italic> − <italic>k</italic> + 1)). A similar calculation can be done for the mean of submatrices. As a result, the total complexity to obtain the scores of all submatrices from size 1 to <italic>l</italic> is <italic>O</italic>(<italic>l</italic><sup><italic>3</italic></sup>).</p>
      <p id="Par52">Empirically, the computational complexity is much lower than the above due to some further reductions. First, because potential TAD boundaries are limited to the TOPDOM local minimums, this substantially reduces the number of partitions from <italic>O</italic>(<italic>l</italic><sup><italic>3</italic></sup>) to <italic>O</italic>(<italic>m</italic><sup><italic>3</italic></sup>), where <italic>m</italic> is the number of candidate boundaries. Second, because TADs usually are smaller than 2 Mb, the maximum TAD size to be called (<italic>d</italic>) typically is much smaller than <italic>l</italic>. This constraint effectively reduces the time complexity of our algorithm from <italic>O</italic>(<italic>m</italic><sup><italic>3</italic></sup>) to <italic>O</italic>(<italic>md</italic><sup><italic>2</italic></sup>). Furthermore, because TADs usually are formed between neighboring boundaries, we set a constraint in the recursive procedure to limit the TADs to be formed only between candidate boundaries that are no more than five neighbors apart.</p>
    </sec>
    <sec id="Sec26">
      <title>TAD-adjR<sup>2</sup> for assessing accuracy of TAD calling</title>
      <p id="Par53">Because TADs are regions with frequent local interactions, a reasonable TAD caller is expected to classify the regions with high contact frequencies as TADs and the regions with low contact frequencies as non-TADs, i.e., gaps between TADs. At any given genomic distance, the variation between Hi-C signals should be largely explained by the classification of TADs. How well the variation can be explained by the classification of TADs can reflect the accuracy of TAD calling. Based on this intuition, we developed a metric similar to the <italic>R</italic><sup>2</sup> in regression models to evaluate the accuracy of TAD calling. Let <italic>Y</italic><sub><italic>i</italic></sub> denote the contact frequency of the <italic>i</italic>th bin, <italic>n</italic> denote the number of bins at the same genomic distance as this bin, and <italic>p</italic> denote the number of called TADs whose sizes are greater than or equal to the genomic distance. For bins within TAD, <inline-formula id="IEq3"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{Y_i} $$\end{document}</tex-math><mml:math id="M14" display="inline"><mml:mover accent="true"><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1893_Article_IEq3.gif"/></alternatives></inline-formula> denotes the average contact frequency at a given genomic distance within that TAD, excluding regions covered by higher level TADs. For those bins not in any TADs, <inline-formula id="IEq4"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \hat{Y_i} $$\end{document}</tex-math><mml:math id="M16" display="inline"><mml:mover accent="true"><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1893_Article_IEq4.gif"/></alternatives></inline-formula> is the average of contact frequency in the gap region at that genomic distance. And <inline-formula id="IEq5"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \overline{Y} $$\end{document}</tex-math><mml:math id="M18" display="inline"><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2019_1893_Article_IEq5.gif"/></alternatives></inline-formula> denotes the overall mean contact frequency across all the bins at a given genomic distance. For each genomic distance, the TAD-adjR<sup>2</sup> is defined as:
<disp-formula id="Equd"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{R}}_{\mathrm{TAD}}^2=1-\frac{\frac{1}{n-p-1}{\sum}_{i=1}^n{\left({Y}_i-{\hat{Y}}_i\right)}^2}{\frac{1}{n-1}{\sum}_{i=1}^n{\left({Y}_i-\overline{Y}\right)}^2} $$\end{document}</tex-math><mml:math id="M20" display="block"><mml:msubsup><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>TAD</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>p</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:msup><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>Y</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2019_1893_Article_Equd.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par54">This quantity essentially measures the proportion of variance in the Hi-C signal that is explained by the classification of TADs, adjusting for the number of TADs and genomic distance.</p>
    </sec>
    <sec id="Sec27">
      <title>Enrichment of expressed genes</title>
      <p id="Par55">To evaluate the activity of gene expression, we downloaded the RNA-seq data from ENCODE (see Data), merged the biological replicates of RNA-seq data, and computed the average FPKM for each gene. Genes with FPKM &gt; 5 were deemed as expressed genes. For each TAD level, we compute the density of expressed gene as the number of expressed genes per 10 kb. For TADs with nested structures, genes covered by the inner level TADs are excluded in the calculation of gene density for outer TADs.</p>
    </sec>
    <sec id="Sec28">
      <title>Enrichment of CTCF or cohesin protein signals</title>
      <p id="Par56">To compute the enrichment of CTCF (or cohesin protein) signals at the identified boundaries and their surrounding regions, we computed the average CTCF (or cohesin proteins) signals from ChIP-seq data at the identified boundaries and the bins within their 10 bins flanking regions. The processed signals in bigwig file were used in this process.</p>
    </sec>
    <sec id="Sec29">
      <title>Epigenetic state enrichment</title>
      <p id="Par57">We downloaded the IDEAS segmentation (see Data), which segments the genome into 36 epigenetic states based on 10 epigenomic marks [<xref ref-type="bibr" rid="CR23">23</xref>]. We used it to evaluate the enrichment of epigenetic state in the identified (sub) TADs and boundaries. Let <italic>n</italic><sub><italic>i</italic></sub> denote the total number of 200-bp windows that have IDEAS-assigned epigenetic states at a TAD boundary <italic>i</italic>, and <italic>n</italic><sub><italic>s</italic>, <italic>i</italic></sub> denote the number of 200-bp windows annotated as state <italic>s</italic> at a TAD boundary <italic>i</italic>. For a given state <italic>s</italic>, its enrichment in a set of <italic>M</italic> boundaries is computed as:
<disp-formula id="Eque"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ E(s)=\frac{\sum_{i=1}^M{n}_{s,i}+1}{B_s{\sum}_{i=1}^M{n}_i+1} $$\end{document}</tex-math><mml:math id="M22" display="block"><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mi>s</mml:mi></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:math><graphic xlink:href="13059_2019_1893_Article_Eque.gif" position="anchor"/></alternatives></disp-formula>where <italic>B</italic><sub><italic>s</italic></sub> is the proportion of state <italic>s</italic> in the whole genome. The 1’s in the formula of <italic>E</italic>(<italic>s</italic>) are added to avoid dividing by 0.</p>
    </sec>
    <sec id="Sec30">
      <title>A/B compartment calling</title>
      <p id="Par58">We used CscoreTool [<xref ref-type="bibr" rid="CR39">39</xref>] to infer A/B compartments from mouse G1E-ER4 Hi-C data (10-kb resolution, default parameter). The A/B compartments are determined by the correlation coefficient between compartment score and ATAC-seq signal. If a positive correlation coefficient is observed, then regions with score &gt; 0 are in compartment A. Otherwise, if the correlation coefficient is below 0, the regions with score &lt; 0 are in compartment A. We reversed the compartment scores on the chromosomes that have correlation coefficient &lt; 0. Thus, compartment A is shown with a positive score, and compartment B is shown with a negative score.</p>
    </sec>
    <sec id="Sec31">
      <title>GO enrichment analysis</title>
      <p id="Par59">We performed GO enrichment analysis for hub-boundary-abundant TFs using PANTHER [<xref ref-type="bibr" rid="CR40">40</xref>] (<ext-link ext-link-type="uri" xlink:href="http://pantherdb.org/">http://pantherdb.org/</ext-link>), which computes the false discovery rate (FDR) for each gene set based on the <italic>p</italic> value of statistical overrepresentation of “biological process” obtained from the Fisher’s exact test. The FDR of the gene set for the hub-boundary-abundant TFs was reported in our analysis section.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec32">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2019_1893_MOESM1_ESM.docx">
            <caption>
              <p><bold>Additional file 1.</bold> Supplementary figures and tables.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2019_1893_MOESM2_ESM.txt">
            <caption>
              <p><bold>Additional file 2.</bold> Commands for running the TAD calling methods of comparison.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s13059-019-1893-y.</p>
  </sec>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>YZ and QL conceived the method. YZ and LA implemented the OnTAD. LA, TY, GX, and JY conducted the analyses. LA, YZ, QL, TY, and RCH wrote the manuscript with assistance from the other authors. JN assisted in the interpretation of the results. All authors read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by the NIH R01 GM121613, NIH R01GM109453, and NIH R24 DK106766; NIH training grant T32 GM102057 (CBIOS training program to The Pennsylvania State University); a Huck Graduate Research Innovation Grant; and 4D Nucleome NIH Initiative DK107980 (Center for 3D Structure and Physics of the Genome).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>OnTAD is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/anlin00007/OnTAD">https://github.com/anlin00007/OnTAD</ext-link>, under MIT license. The versions used in the manuscript are permanently available at 10.5281/zenodo.3370539 [<xref ref-type="bibr" rid="CR41">41</xref>].</p>
    <p>Hi-C data: The human Hi-C data is obtained from Rao et al. [<xref ref-type="bibr" rid="CR17">17</xref>] (GEO accession number: GSE63525). Among them, three cell types (B lymphoblastoid cells (GM12878), umbilical vein endothelial cells (HUVEC), and erythrocytic leukemia cells (K562)) were included in this study. The normalized (by Knight-Ruiz balancing method) Hi-C matrices at 5-kb, 10-kb, and 25-kb resolutions were used in this study. The mouse Hi-C data is obtained from Hsu et al. [<xref ref-type="bibr" rid="CR31">31</xref>] (GEO accession number: GSE95476 [<xref ref-type="bibr" rid="CR42">42</xref>]). The 10-kb raw Hi-C matrices from G1E-ER4 and two Brd2 knockouts were used in this study.</p>
    <p>Transcriptomic data: The gene expression data were downloaded from the ENCODE project (<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/)">https://www.encodeproject.org/</ext-link>). The processed signal (FPKM) was used to measure the expression activity.</p>
    <p>Epigenomic data: The histone modification data were downloaded from the NIH Roadmap Epigenomics project (<ext-link ext-link-type="uri" xlink:href="http://www.roadmapepigenomics.org/">http://www.roadmapepigenomics.org/</ext-link>), including H2A.Z, H3K27ac, H3K27me3, H3K36me3, H3K4me1, H3K4me2, H3K4me3, H3K79me2, H3K9ac, H3K9me3, and H4K20me1. The ChIP-seq data of CTCF and cohesin protein (Rad21 and Smc3) were downloaded from the ENCODE project (<ext-link ext-link-type="uri" xlink:href="https://www.encodeproject.org/">https://www.encodeproject.org/</ext-link>). The downloaded data were in BigWig format. The “bigWigAverageOverBed” was used to segment signal into windows according to the resolution of Hi-C data. The mouse ChIP-seq data were downloaded from the VISION project (<ext-link ext-link-type="uri" xlink:href="http://www.bx.psu.edu/~giardine/vision/">http://www.bx.psu.edu/~giardine/vision/</ext-link>).</p>
    <p>Epigenetic states: The IDEAS segmentation of the 6 ENCODE cell type/tissues (GM12878, H1h-ESC, Hela-S3, HepG2, HUVEC, K562) was downloaded from (<ext-link ext-link-type="uri" xlink:href="http://main.genome-browser.bx.psu.edu/">http://main.genome-browser.bx.psu.edu/</ext-link>). The 36-state IDEAS model trained on 10 marks (H3K4me1, H3K4me2, H3K4me3, H3K9ac, H3K27ac, H3K27me3, H3K36me3, H3K20me1, PolII, and CTCF), as well as DNase-seq and Faire-seq, was applied to this study.</p>
  </notes>
  <notes>
    <title>Ethics approval and consent to participate</title>
    <p id="Par60">Not applicable.</p>
  </notes>
  <notes>
    <title>Consent for publication</title>
    <p id="Par61">Not applicable.</p>
  </notes>
  <notes notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par62">The authors declare that they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Won</surname>
            <given-names>Hyejung</given-names>
          </name>
          <name>
            <surname>de la Torre-Ubieta</surname>
            <given-names>Luis</given-names>
          </name>
          <name>
            <surname>Stein</surname>
            <given-names>Jason L.</given-names>
          </name>
          <name>
            <surname>Parikshak</surname>
            <given-names>Neelroop N.</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Jerry</given-names>
          </name>
          <name>
            <surname>Opland</surname>
            <given-names>Carli K.</given-names>
          </name>
          <name>
            <surname>Gandal</surname>
            <given-names>Michael J.</given-names>
          </name>
          <name>
            <surname>Sutton</surname>
            <given-names>Gavin J.</given-names>
          </name>
          <name>
            <surname>Hormozdiari</surname>
            <given-names>Farhad</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>Daning</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>Changhoon</given-names>
          </name>
          <name>
            <surname>Eskin</surname>
            <given-names>Eleazar</given-names>
          </name>
          <name>
            <surname>Voineagu</surname>
            <given-names>Irina</given-names>
          </name>
          <name>
            <surname>Ernst</surname>
            <given-names>Jason</given-names>
          </name>
          <name>
            <surname>Geschwind</surname>
            <given-names>Daniel H.</given-names>
          </name>
        </person-group>
        <article-title>Chromosome conformation elucidates regulatory relationships in developing human brain</article-title>
        <source>Nature</source>
        <year>2016</year>
        <volume>538</volume>
        <issue>7626</issue>
        <fpage>523</fpage>
        <lpage>527</lpage>
        <pub-id pub-id-type="doi">10.1038/nature19847</pub-id>
        <pub-id pub-id-type="pmid">27760116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Capturing Chromosome Conformation</article-title>
        <source>Science</source>
        <year>2002</year>
        <volume>295</volume>
        <issue>5558</issue>
        <fpage>1306</fpage>
        <lpage>1311</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1067799</pub-id>
        <pub-id pub-id-type="pmid">11847345</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>Job</given-names>
          </name>
          <name>
            <surname>Marti-Renom</surname>
            <given-names>Marc A.</given-names>
          </name>
          <name>
            <surname>Mirny</surname>
            <given-names>Leonid A.</given-names>
          </name>
        </person-group>
        <article-title>Exploring the three-dimensional organization of genomes: interpreting chromatin interaction data</article-title>
        <source>Nature Reviews Genetics</source>
        <year>2013</year>
        <volume>14</volume>
        <issue>6</issue>
        <fpage>390</fpage>
        <lpage>403</lpage>
        <pub-id pub-id-type="doi">10.1038/nrg3454</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fullwood</surname>
            <given-names>Melissa J.</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>Yijun</given-names>
          </name>
        </person-group>
        <article-title>ChIP-based methods for the identification of long-range chromatin interactions</article-title>
        <source>Journal of Cellular Biochemistry</source>
        <year>2009</year>
        <volume>107</volume>
        <issue>1</issue>
        <fpage>30</fpage>
        <lpage>39</lpage>
        <pub-id pub-id-type="doi">10.1002/jcb.22116</pub-id>
        <pub-id pub-id-type="pmid">19247990</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mumbach</surname>
            <given-names>Maxwell R</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>Adam J</given-names>
          </name>
          <name>
            <surname>Flynn</surname>
            <given-names>Ryan A</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>Chao</given-names>
          </name>
          <name>
            <surname>Khavari</surname>
            <given-names>Paul A</given-names>
          </name>
          <name>
            <surname>Greenleaf</surname>
            <given-names>William J</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>Howard Y</given-names>
          </name>
        </person-group>
        <article-title>HiChIP: efficient and sensitive analysis of protein-directed genome architecture</article-title>
        <source>Nature Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>11</issue>
        <fpage>919</fpage>
        <lpage>922</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3999</pub-id>
        <pub-id pub-id-type="pmid">27643841</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dekker</surname>
            <given-names>Job</given-names>
          </name>
        </person-group>
        <article-title>The three 'C' s of chromosome conformation capture: controls, controls, controls</article-title>
        <source>Nature Methods</source>
        <year>2005</year>
        <volume>3</volume>
        <issue>1</issue>
        <fpage>17</fpage>
        <lpage>21</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth823</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dostie</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Richmond</surname>
            <given-names>T. A.</given-names>
          </name>
          <name>
            <surname>Arnaout</surname>
            <given-names>R. A.</given-names>
          </name>
          <name>
            <surname>Selzer</surname>
            <given-names>R. R.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>W. L.</given-names>
          </name>
          <name>
            <surname>Honan</surname>
            <given-names>T. A.</given-names>
          </name>
          <name>
            <surname>Rubio</surname>
            <given-names>E. D.</given-names>
          </name>
          <name>
            <surname>Krumm</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Lamb</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Nusbaum</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Green</surname>
            <given-names>R. D.</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Chromosome Conformation Capture Carbon Copy (5C): A massively parallel solution for mapping interactions between genomic elements</article-title>
        <source>Genome Research</source>
        <year>2006</year>
        <volume>16</volume>
        <issue>10</issue>
        <fpage>1299</fpage>
        <lpage>1309</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.5571506</pub-id>
        <pub-id pub-id-type="pmid">16954542</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhao</surname>
            <given-names>Zhihu</given-names>
          </name>
          <name>
            <surname>Tavoosidana</surname>
            <given-names>Gholamreza</given-names>
          </name>
          <name>
            <surname>Sjölinder</surname>
            <given-names>Mikael</given-names>
          </name>
          <name>
            <surname>Göndör</surname>
            <given-names>Anita</given-names>
          </name>
          <name>
            <surname>Mariano</surname>
            <given-names>Piero</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Sha</given-names>
          </name>
          <name>
            <surname>Kanduri</surname>
            <given-names>Chandrasekhar</given-names>
          </name>
          <name>
            <surname>Lezcano</surname>
            <given-names>Magda</given-names>
          </name>
          <name>
            <surname>Singh Sandhu</surname>
            <given-names>Kuljeet</given-names>
          </name>
          <name>
            <surname>Singh</surname>
            <given-names>Umashankar</given-names>
          </name>
          <name>
            <surname>Pant</surname>
            <given-names>Vinod</given-names>
          </name>
          <name>
            <surname>Tiwari</surname>
            <given-names>Vijay</given-names>
          </name>
          <name>
            <surname>Kurukuti</surname>
            <given-names>Sreenivasulu</given-names>
          </name>
          <name>
            <surname>Ohlsson</surname>
            <given-names>Rolf</given-names>
          </name>
        </person-group>
        <article-title>Circular chromosome conformation capture (4C) uncovers extensive networks of epigenetically regulated intra- and interchromosomal interactions</article-title>
        <source>Nature Genetics</source>
        <year>2006</year>
        <volume>38</volume>
        <issue>11</issue>
        <fpage>1341</fpage>
        <lpage>1347</lpage>
        <pub-id pub-id-type="doi">10.1038/ng1891</pub-id>
        <pub-id pub-id-type="pmid">17033624</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lieberman-Aiden</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>van Berkum</surname>
            <given-names>N. L.</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>Imakaev</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Ragoczy</surname>
            <given-names>T.</given-names>
          </name>
          <name>
            <surname>Telling</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Amit</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>B. R.</given-names>
          </name>
          <name>
            <surname>Sabo</surname>
            <given-names>P. J.</given-names>
          </name>
          <name>
            <surname>Dorschner</surname>
            <given-names>M. O.</given-names>
          </name>
          <name>
            <surname>Sandstrom</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Bender</surname>
            <given-names>M. A.</given-names>
          </name>
          <name>
            <surname>Groudine</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Stamatoyannopoulos</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Mirny</surname>
            <given-names>L. A.</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>E. S.</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>J.</given-names>
          </name>
        </person-group>
        <article-title>Comprehensive Mapping of Long-Range Interactions Reveals Folding Principles of the Human Genome</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>326</volume>
        <issue>5950</issue>
        <fpage>289</fpage>
        <lpage>293</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1181369</pub-id>
        <pub-id pub-id-type="pmid">19815776</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>Jesse R.</given-names>
          </name>
          <name>
            <surname>Gorkin</surname>
            <given-names>David U.</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>Bing</given-names>
          </name>
        </person-group>
        <article-title>Chromatin Domains: The Unit of Chromosome Organization</article-title>
        <source>Molecular Cell</source>
        <year>2016</year>
        <volume>62</volume>
        <issue>5</issue>
        <fpage>668</fpage>
        <lpage>680</lpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2016.05.018</pub-id>
        <pub-id pub-id-type="pmid">27259200</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>Jesse R.</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>Siddarth</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>Feng</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>Audrey</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Yan</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Yin</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Ming</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Jun S.</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>Bing</given-names>
          </name>
        </person-group>
        <article-title>Topological domains in mammalian genomes identified by analysis of chromatin interactions</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>485</volume>
        <issue>7398</issue>
        <fpage>376</fpage>
        <lpage>380</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11082</pub-id>
        <pub-id pub-id-type="pmid">22495300</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixon</surname>
            <given-names>Jesse R.</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>Inkyung</given-names>
          </name>
          <name>
            <surname>Selvaraj</surname>
            <given-names>Siddarth</given-names>
          </name>
          <name>
            <surname>Shen</surname>
            <given-names>Yin</given-names>
          </name>
          <name>
            <surname>Antosiewicz-Bourget</surname>
            <given-names>Jessica E.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>Ah Young</given-names>
          </name>
          <name>
            <surname>Ye</surname>
            <given-names>Zhen</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>Audrey</given-names>
          </name>
          <name>
            <surname>Rajagopal</surname>
            <given-names>Nisha</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>Wei</given-names>
          </name>
          <name>
            <surname>Diao</surname>
            <given-names>Yarui</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>Jing</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Huimin</given-names>
          </name>
          <name>
            <surname>Lobanenkov</surname>
            <given-names>Victor V.</given-names>
          </name>
          <name>
            <surname>Ecker</surname>
            <given-names>Joseph R.</given-names>
          </name>
          <name>
            <surname>Thomson</surname>
            <given-names>James A.</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>Bing</given-names>
          </name>
        </person-group>
        <article-title>Chromatin architecture reorganization during stem cell differentiation</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>518</volume>
        <issue>7539</issue>
        <fpage>331</fpage>
        <lpage>336</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14222</pub-id>
        <pub-id pub-id-type="pmid">25693564</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shin</surname>
            <given-names>Hanjun</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>Yi</given-names>
          </name>
          <name>
            <surname>Dai</surname>
            <given-names>Chao</given-names>
          </name>
          <name>
            <surname>Tjong</surname>
            <given-names>Harianto</given-names>
          </name>
          <name>
            <surname>Gong</surname>
            <given-names>Ke</given-names>
          </name>
          <name>
            <surname>Alber</surname>
            <given-names>Frank</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>Xianghong Jasmine</given-names>
          </name>
        </person-group>
        <article-title>TopDom: an efficient and deterministic method for identifying topological domains in genomes</article-title>
        <source>Nucleic Acids Research</source>
        <year>2015</year>
        <volume>44</volume>
        <issue>7</issue>
        <fpage>e70</fpage>
        <lpage>e70</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkv1505</pub-id>
        <pub-id pub-id-type="pmid">26704975</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Crane</surname>
            <given-names>Emily</given-names>
          </name>
          <name>
            <surname>Bian</surname>
            <given-names>Qian</given-names>
          </name>
          <name>
            <surname>McCord</surname>
            <given-names>Rachel Patton</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>Bryan R.</given-names>
          </name>
          <name>
            <surname>Wheeler</surname>
            <given-names>Bayly S.</given-names>
          </name>
          <name>
            <surname>Ralston</surname>
            <given-names>Edward J.</given-names>
          </name>
          <name>
            <surname>Uzawa</surname>
            <given-names>Satoru</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>Job</given-names>
          </name>
          <name>
            <surname>Meyer</surname>
            <given-names>Barbara J.</given-names>
          </name>
        </person-group>
        <article-title>Condensin-driven remodelling of X chromosome topology during dosage compensation</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>523</volume>
        <issue>7559</issue>
        <fpage>240</fpage>
        <lpage>244</lpage>
        <pub-id pub-id-type="doi">10.1038/nature14450</pub-id>
        <pub-id pub-id-type="pmid">26030525</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weinreb</surname>
            <given-names>Caleb</given-names>
          </name>
          <name>
            <surname>Raphael</surname>
            <given-names>Benjamin J.</given-names>
          </name>
        </person-group>
        <article-title>Identification of hierarchical chromatin domains</article-title>
        <source>Bioinformatics</source>
        <year>2015</year>
        <volume>32</volume>
        <issue>11</issue>
        <fpage>1601</fpage>
        <lpage>1609</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv485</pub-id>
        <pub-id pub-id-type="pmid">26315910</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Yu W, He B, Tan K. Identifying topologically associating domains and subdomains by Gaussian mixture model and proportion test. Nat Commun. 2017. 10.1038/s41467-017-00478-8.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rao</surname>
            <given-names>Suhas S.P.</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>Miriam H.</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>Neva C.</given-names>
          </name>
          <name>
            <surname>Stamenova</surname>
            <given-names>Elena K.</given-names>
          </name>
          <name>
            <surname>Bochkov</surname>
            <given-names>Ivan D.</given-names>
          </name>
          <name>
            <surname>Robinson</surname>
            <given-names>James T.</given-names>
          </name>
          <name>
            <surname>Sanborn</surname>
            <given-names>Adrian L.</given-names>
          </name>
          <name>
            <surname>Machol</surname>
            <given-names>Ido</given-names>
          </name>
          <name>
            <surname>Omer</surname>
            <given-names>Arina D.</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>Eric S.</given-names>
          </name>
          <name>
            <surname>Aiden</surname>
            <given-names>Erez Lieberman</given-names>
          </name>
        </person-group>
        <article-title>A 3D Map of the Human Genome at Kilobase Resolution Reveals Principles of Chromatin Looping</article-title>
        <source>Cell</source>
        <year>2014</year>
        <volume>159</volume>
        <issue>7</issue>
        <fpage>1665</fpage>
        <lpage>1680</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2014.11.021</pub-id>
        <pub-id pub-id-type="pmid">25497547</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Norton</surname>
            <given-names>Heidi K</given-names>
          </name>
          <name>
            <surname>Emerson</surname>
            <given-names>Daniel J</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Harvey</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>Jesi</given-names>
          </name>
          <name>
            <surname>Titus</surname>
            <given-names>Katelyn R</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>Shi</given-names>
          </name>
          <name>
            <surname>Bassett</surname>
            <given-names>Danielle S</given-names>
          </name>
          <name>
            <surname>Phillips-Cremins</surname>
            <given-names>Jennifer E</given-names>
          </name>
        </person-group>
        <article-title>Detecting hierarchical genome folding with network modularity</article-title>
        <source>Nature Methods</source>
        <year>2018</year>
        <volume>15</volume>
        <issue>2</issue>
        <fpage>119</fpage>
        <lpage>122</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.4560</pub-id>
        <pub-id pub-id-type="pmid">29334377</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <mixed-citation publication-type="other">Haddad N, Vaillant C, Jost D. IC-Finder: inferring robustly the hierarchical organization of chromatin folding. Nucleic Acids Res. 2017. 10.1093/nar/gkx036.</mixed-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Fraser</surname>
            <given-names>James</given-names>
          </name>
          <name>
            <surname>Ferrai</surname>
            <given-names>Carmelo</given-names>
          </name>
          <name>
            <surname>Chiariello</surname>
            <given-names>Andrea M</given-names>
          </name>
          <name>
            <surname>Schueler</surname>
            <given-names>Markus</given-names>
          </name>
          <name>
            <surname>Rito</surname>
            <given-names>Tiago</given-names>
          </name>
          <name>
            <surname>Laudanno</surname>
            <given-names>Giovanni</given-names>
          </name>
          <name>
            <surname>Barbieri</surname>
            <given-names>Mariano</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>Benjamin L</given-names>
          </name>
          <name>
            <surname>Kraemer</surname>
            <given-names>Dorothee CA</given-names>
          </name>
          <name>
            <surname>Aitken</surname>
            <given-names>Stuart</given-names>
          </name>
          <name>
            <surname>Xie</surname>
            <given-names>Sheila Q</given-names>
          </name>
          <name>
            <surname>Morris</surname>
            <given-names>Kelly J</given-names>
          </name>
          <name>
            <surname>Itoh</surname>
            <given-names>Masayoshi</given-names>
          </name>
          <name>
            <surname>Kawaji</surname>
            <given-names>Hideya</given-names>
          </name>
          <name>
            <surname>Jaeger</surname>
            <given-names>Ines</given-names>
          </name>
          <name>
            <surname>Hayashizaki</surname>
            <given-names>Yoshihide</given-names>
          </name>
          <name>
            <surname>Carninci</surname>
            <given-names>Piero</given-names>
          </name>
          <name>
            <surname>Forrest</surname>
            <given-names>Alistair RR</given-names>
          </name>
          <name>
            <surname>Semple</surname>
            <given-names>Colin A</given-names>
          </name>
          <name>
            <surname>Dostie</surname>
            <given-names>Josée</given-names>
          </name>
          <name>
            <surname>Pombo</surname>
            <given-names>Ana</given-names>
          </name>
          <name>
            <surname>Nicodemi</surname>
            <given-names>Mario</given-names>
          </name>
        </person-group>
        <article-title>Hierarchical folding and reorganization of chromosomes are linked to transcriptional changes in cellular differentiation</article-title>
        <source>Molecular Systems Biology</source>
        <year>2015</year>
        <volume>11</volume>
        <issue>12</issue>
        <fpage>852</fpage>
        <pub-id pub-id-type="doi">10.15252/msb.20156492</pub-id>
        <pub-id pub-id-type="pmid">26700852</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sanborn</surname>
            <given-names>Adrian L.</given-names>
          </name>
          <name>
            <surname>Rao</surname>
            <given-names>Suhas S. P.</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Su-Chen</given-names>
          </name>
          <name>
            <surname>Durand</surname>
            <given-names>Neva C.</given-names>
          </name>
          <name>
            <surname>Huntley</surname>
            <given-names>Miriam H.</given-names>
          </name>
          <name>
            <surname>Jewett</surname>
            <given-names>Andrew I.</given-names>
          </name>
          <name>
            <surname>Bochkov</surname>
            <given-names>Ivan D.</given-names>
          </name>
          <name>
            <surname>Chinnappan</surname>
            <given-names>Dharmaraj</given-names>
          </name>
          <name>
            <surname>Cutkosky</surname>
            <given-names>Ashok</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Jian</given-names>
          </name>
          <name>
            <surname>Geeting</surname>
            <given-names>Kristopher P.</given-names>
          </name>
          <name>
            <surname>Gnirke</surname>
            <given-names>Andreas</given-names>
          </name>
          <name>
            <surname>Melnikov</surname>
            <given-names>Alexandre</given-names>
          </name>
          <name>
            <surname>McKenna</surname>
            <given-names>Doug</given-names>
          </name>
          <name>
            <surname>Stamenova</surname>
            <given-names>Elena K.</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>Eric S.</given-names>
          </name>
          <name>
            <surname>Aiden</surname>
            <given-names>Erez Lieberman</given-names>
          </name>
        </person-group>
        <article-title>Chromatin extrusion explains key features of loop and domain formation in wild-type and engineered genomes</article-title>
        <source>Proceedings of the National Academy of Sciences</source>
        <year>2015</year>
        <volume>112</volume>
        <issue>47</issue>
        <fpage>E6456</fpage>
        <lpage>E6465</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1518552112</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ho</surname>
            <given-names>Joshua W. K.</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>Youngsook L.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Tao</given-names>
          </name>
          <name>
            <surname>Alver</surname>
            <given-names>Burak H.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>Soohyun</given-names>
          </name>
          <name>
            <surname>Ikegami</surname>
            <given-names>Kohta</given-names>
          </name>
          <name>
            <surname>Sohn</surname>
            <given-names>Kyung-Ah</given-names>
          </name>
          <name>
            <surname>Minoda</surname>
            <given-names>Aki</given-names>
          </name>
          <name>
            <surname>Tolstorukov</surname>
            <given-names>Michael Y.</given-names>
          </name>
          <name>
            <surname>Appert</surname>
            <given-names>Alex</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>Stephen C. J.</given-names>
          </name>
          <name>
            <surname>Gu</surname>
            <given-names>Tingting</given-names>
          </name>
          <name>
            <surname>Kundaje</surname>
            <given-names>Anshul</given-names>
          </name>
          <name>
            <surname>Riddle</surname>
            <given-names>Nicole C.</given-names>
          </name>
          <name>
            <surname>Bishop</surname>
            <given-names>Eric</given-names>
          </name>
          <name>
            <surname>Egelhofer</surname>
            <given-names>Thea A.</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Sheng'en Shawn</given-names>
          </name>
          <name>
            <surname>Alekseyenko</surname>
            <given-names>Artyom A.</given-names>
          </name>
          <name>
            <surname>Rechtsteiner</surname>
            <given-names>Andreas</given-names>
          </name>
          <name>
            <surname>Asker</surname>
            <given-names>Dalal</given-names>
          </name>
          <name>
            <surname>Belsky</surname>
            <given-names>Jason A.</given-names>
          </name>
          <name>
            <surname>Bowman</surname>
            <given-names>Sarah K.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Q. Brent</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>Ron A.-J.</given-names>
          </name>
          <name>
            <surname>Day</surname>
            <given-names>Daniel S.</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>Yan</given-names>
          </name>
          <name>
            <surname>Dose</surname>
            <given-names>Andrea C.</given-names>
          </name>
          <name>
            <surname>Duan</surname>
            <given-names>Xikun</given-names>
          </name>
          <name>
            <surname>Epstein</surname>
            <given-names>Charles B.</given-names>
          </name>
          <name>
            <surname>Ercan</surname>
            <given-names>Sevinc</given-names>
          </name>
          <name>
            <surname>Feingold</surname>
            <given-names>Elise A.</given-names>
          </name>
          <name>
            <surname>Ferrari</surname>
            <given-names>Francesco</given-names>
          </name>
          <name>
            <surname>Garrigues</surname>
            <given-names>Jacob M.</given-names>
          </name>
          <name>
            <surname>Gehlenborg</surname>
            <given-names>Nils</given-names>
          </name>
          <name>
            <surname>Good</surname>
            <given-names>Peter J.</given-names>
          </name>
          <name>
            <surname>Haseley</surname>
            <given-names>Psalm</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>Daniel</given-names>
          </name>
          <name>
            <surname>Herrmann</surname>
            <given-names>Moritz</given-names>
          </name>
          <name>
            <surname>Hoffman</surname>
            <given-names>Michael M.</given-names>
          </name>
          <name>
            <surname>Jeffers</surname>
            <given-names>Tess E.</given-names>
          </name>
          <name>
            <surname>Kharchenko</surname>
            <given-names>Peter V.</given-names>
          </name>
          <name>
            <surname>Kolasinska-Zwierz</surname>
            <given-names>Paulina</given-names>
          </name>
          <name>
            <surname>Kotwaliwale</surname>
            <given-names>Chitra V.</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>Nischay</given-names>
          </name>
          <name>
            <surname>Langley</surname>
            <given-names>Sasha A.</given-names>
          </name>
          <name>
            <surname>Larschan</surname>
            <given-names>Erica N.</given-names>
          </name>
          <name>
            <surname>Latorre</surname>
            <given-names>Isabel</given-names>
          </name>
          <name>
            <surname>Libbrecht</surname>
            <given-names>Maxwell W.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Xueqiu</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>Richard</given-names>
          </name>
          <name>
            <surname>Pazin</surname>
            <given-names>Michael J.</given-names>
          </name>
          <name>
            <surname>Pham</surname>
            <given-names>Hoang N.</given-names>
          </name>
          <name>
            <surname>Plachetka</surname>
            <given-names>Annette</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>Bo</given-names>
          </name>
          <name>
            <surname>Schwartz</surname>
            <given-names>Yuri B.</given-names>
          </name>
          <name>
            <surname>Shoresh</surname>
            <given-names>Noam</given-names>
          </name>
          <name>
            <surname>Stempor</surname>
            <given-names>Przemyslaw</given-names>
          </name>
          <name>
            <surname>Vielle</surname>
            <given-names>Anne</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Chengyang</given-names>
          </name>
          <name>
            <surname>Whittle</surname>
            <given-names>Christina M.</given-names>
          </name>
          <name>
            <surname>Xue</surname>
            <given-names>Huiling</given-names>
          </name>
          <name>
            <surname>Kingston</surname>
            <given-names>Robert E.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>Ju Han</given-names>
          </name>
          <name>
            <surname>Bernstein</surname>
            <given-names>Bradley E.</given-names>
          </name>
          <name>
            <surname>Dernburg</surname>
            <given-names>Abby F.</given-names>
          </name>
          <name>
            <surname>Pirrotta</surname>
            <given-names>Vincenzo</given-names>
          </name>
          <name>
            <surname>Kuroda</surname>
            <given-names>Mitzi I.</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>William S.</given-names>
          </name>
          <name>
            <surname>Tullius</surname>
            <given-names>Thomas D.</given-names>
          </name>
          <name>
            <surname>Kellis</surname>
            <given-names>Manolis</given-names>
          </name>
          <name>
            <surname>MacAlpine</surname>
            <given-names>David M.</given-names>
          </name>
          <name>
            <surname>Strome</surname>
            <given-names>Susan</given-names>
          </name>
          <name>
            <surname>Elgin</surname>
            <given-names>Sarah C. R.</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Xiaole Shirley</given-names>
          </name>
          <name>
            <surname>Lieb</surname>
            <given-names>Jason D.</given-names>
          </name>
          <name>
            <surname>Ahringer</surname>
            <given-names>Julie</given-names>
          </name>
          <name>
            <surname>Karpen</surname>
            <given-names>Gary H.</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>Peter J.</given-names>
          </name>
        </person-group>
        <article-title>Comparative analysis of metazoan chromatin organization</article-title>
        <source>Nature</source>
        <year>2014</year>
        <volume>512</volume>
        <issue>7515</issue>
        <fpage>449</fpage>
        <lpage>452</lpage>
        <pub-id pub-id-type="doi">10.1038/nature13415</pub-id>
        <pub-id pub-id-type="pmid">25164756</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>Yu</given-names>
          </name>
          <name>
            <surname>An</surname>
            <given-names>Lin</given-names>
          </name>
          <name>
            <surname>Yue</surname>
            <given-names>Feng</given-names>
          </name>
          <name>
            <surname>Hardison</surname>
            <given-names>Ross C.</given-names>
          </name>
        </person-group>
        <article-title>Jointly characterizing epigenetic dynamics across multiple human cell types</article-title>
        <source>Nucleic Acids Research</source>
        <year>2016</year>
        <volume>44</volume>
        <issue>14</issue>
        <fpage>6721</fpage>
        <lpage>6731</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkw278</pub-id>
        <pub-id pub-id-type="pmid">27095202</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Dunham I, Kundaje A, Aldred SF, Collins PJ, Davis CA, Doyle F, et al. An integrated encyclopedia of DNA elements in the human genome. Nature. 2012. 10.1038/nature11247.</mixed-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ganji</surname>
            <given-names>Mahipal</given-names>
          </name>
          <name>
            <surname>Shaltiel</surname>
            <given-names>Indra A.</given-names>
          </name>
          <name>
            <surname>Bisht</surname>
            <given-names>Shveta</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>Eugene</given-names>
          </name>
          <name>
            <surname>Kalichava</surname>
            <given-names>Ana</given-names>
          </name>
          <name>
            <surname>Haering</surname>
            <given-names>Christian H.</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>Cees</given-names>
          </name>
        </person-group>
        <article-title>Real-time imaging of DNA loop extrusion by condensin</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>360</volume>
        <issue>6384</issue>
        <fpage>102</fpage>
        <lpage>105</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aar7831</pub-id>
        <pub-id pub-id-type="pmid">29472443</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Tian</surname>
            <given-names>SZ</given-names>
          </name>
          <name>
            <surname>Capurso</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Maurya</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Multiplex chromatin interactions with single-molecule precision</article-title>
        <source>Nature.</source>
        <year>2019</year>
        <volume>566</volume>
        <fpage>558</fpage>
        <lpage>562</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-0949-1</pub-id>
        <?supplied-pmid 30778195?>
        <pub-id pub-id-type="pmid">30778195</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kschonsak</surname>
            <given-names>Marc</given-names>
          </name>
          <name>
            <surname>Merkel</surname>
            <given-names>Fabian</given-names>
          </name>
          <name>
            <surname>Bisht</surname>
            <given-names>Shveta</given-names>
          </name>
          <name>
            <surname>Metz</surname>
            <given-names>Jutta</given-names>
          </name>
          <name>
            <surname>Rybin</surname>
            <given-names>Vladimir</given-names>
          </name>
          <name>
            <surname>Hassler</surname>
            <given-names>Markus</given-names>
          </name>
          <name>
            <surname>Haering</surname>
            <given-names>Christian H.</given-names>
          </name>
        </person-group>
        <article-title>Structural Basis for a Safety-Belt Mechanism That Anchors Condensin to Chromosomes</article-title>
        <source>Cell</source>
        <year>2017</year>
        <volume>171</volume>
        <issue>3</issue>
        <fpage>588-600.e24</fpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2017.09.008</pub-id>
        <pub-id pub-id-type="pmid">28988770</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gerstein</surname>
            <given-names>Mark B.</given-names>
          </name>
          <name>
            <surname>Kundaje</surname>
            <given-names>Anshul</given-names>
          </name>
          <name>
            <surname>Hariharan</surname>
            <given-names>Manoj</given-names>
          </name>
          <name>
            <surname>Landt</surname>
            <given-names>Stephen G.</given-names>
          </name>
          <name>
            <surname>Yan</surname>
            <given-names>Koon-Kiu</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>Chao</given-names>
          </name>
          <name>
            <surname>Mu</surname>
            <given-names>Xinmeng Jasmine</given-names>
          </name>
          <name>
            <surname>Khurana</surname>
            <given-names>Ekta</given-names>
          </name>
          <name>
            <surname>Rozowsky</surname>
            <given-names>Joel</given-names>
          </name>
          <name>
            <surname>Alexander</surname>
            <given-names>Roger</given-names>
          </name>
          <name>
            <surname>Min</surname>
            <given-names>Renqiang</given-names>
          </name>
          <name>
            <surname>Alves</surname>
            <given-names>Pedro</given-names>
          </name>
          <name>
            <surname>Abyzov</surname>
            <given-names>Alexej</given-names>
          </name>
          <name>
            <surname>Addleman</surname>
            <given-names>Nick</given-names>
          </name>
          <name>
            <surname>Bhardwaj</surname>
            <given-names>Nitin</given-names>
          </name>
          <name>
            <surname>Boyle</surname>
            <given-names>Alan P.</given-names>
          </name>
          <name>
            <surname>Cayting</surname>
            <given-names>Philip</given-names>
          </name>
          <name>
            <surname>Charos</surname>
            <given-names>Alexandra</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>David Z.</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>Yong</given-names>
          </name>
          <name>
            <surname>Clarke</surname>
            <given-names>Declan</given-names>
          </name>
          <name>
            <surname>Eastman</surname>
            <given-names>Catharine</given-names>
          </name>
          <name>
            <surname>Euskirchen</surname>
            <given-names>Ghia</given-names>
          </name>
          <name>
            <surname>Frietze</surname>
            <given-names>Seth</given-names>
          </name>
          <name>
            <surname>Fu</surname>
            <given-names>Yao</given-names>
          </name>
          <name>
            <surname>Gertz</surname>
            <given-names>Jason</given-names>
          </name>
          <name>
            <surname>Grubert</surname>
            <given-names>Fabian</given-names>
          </name>
          <name>
            <surname>Harmanci</surname>
            <given-names>Arif</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>Preti</given-names>
          </name>
          <name>
            <surname>Kasowski</surname>
            <given-names>Maya</given-names>
          </name>
          <name>
            <surname>Lacroute</surname>
            <given-names>Phil</given-names>
          </name>
          <name>
            <surname>Leng</surname>
            <given-names>Jing</given-names>
          </name>
          <name>
            <surname>Lian</surname>
            <given-names>Jin</given-names>
          </name>
          <name>
            <surname>Monahan</surname>
            <given-names>Hannah</given-names>
          </name>
          <name>
            <surname>O’Geen</surname>
            <given-names>Henriette</given-names>
          </name>
          <name>
            <surname>Ouyang</surname>
            <given-names>Zhengqing</given-names>
          </name>
          <name>
            <surname>Partridge</surname>
            <given-names>E. Christopher</given-names>
          </name>
          <name>
            <surname>Patacsil</surname>
            <given-names>Dorrelyn</given-names>
          </name>
          <name>
            <surname>Pauli</surname>
            <given-names>Florencia</given-names>
          </name>
          <name>
            <surname>Raha</surname>
            <given-names>Debasish</given-names>
          </name>
          <name>
            <surname>Ramirez</surname>
            <given-names>Lucia</given-names>
          </name>
          <name>
            <surname>Reddy</surname>
            <given-names>Timothy E.</given-names>
          </name>
          <name>
            <surname>Reed</surname>
            <given-names>Brian</given-names>
          </name>
          <name>
            <surname>Shi</surname>
            <given-names>Minyi</given-names>
          </name>
          <name>
            <surname>Slifer</surname>
            <given-names>Teri</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Jing</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>Linfeng</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Xinqiong</given-names>
          </name>
          <name>
            <surname>Yip</surname>
            <given-names>Kevin Y.</given-names>
          </name>
          <name>
            <surname>Zilberman-Schapira</surname>
            <given-names>Gili</given-names>
          </name>
          <name>
            <surname>Batzoglou</surname>
            <given-names>Serafim</given-names>
          </name>
          <name>
            <surname>Sidow</surname>
            <given-names>Arend</given-names>
          </name>
          <name>
            <surname>Farnham</surname>
            <given-names>Peggy J.</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>Richard M.</given-names>
          </name>
          <name>
            <surname>Weissman</surname>
            <given-names>Sherman M.</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>Michael</given-names>
          </name>
        </person-group>
        <article-title>Architecture of the human regulatory network derived from ENCODE data</article-title>
        <source>Nature</source>
        <year>2012</year>
        <volume>489</volume>
        <issue>7414</issue>
        <fpage>91</fpage>
        <lpage>100</lpage>
        <pub-id pub-id-type="doi">10.1038/nature11245</pub-id>
        <pub-id pub-id-type="pmid">22955619</pub-id>
      </element-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Whitfield</surname>
            <given-names>T. W.</given-names>
          </name>
          <name>
            <surname>Greven</surname>
            <given-names>M. C.</given-names>
          </name>
          <name>
            <surname>Pierce</surname>
            <given-names>B. G.</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Kundaje</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Cheng</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Rando</surname>
            <given-names>O. J.</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>R. M.</given-names>
          </name>
          <name>
            <surname>Noble</surname>
            <given-names>W. S.</given-names>
          </name>
          <name>
            <surname>Snyder</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>Z.</given-names>
          </name>
        </person-group>
        <article-title>Sequence features and chromatin structure around the genomic regions bound by 119 human transcription factors</article-title>
        <source>Genome Research</source>
        <year>2012</year>
        <volume>22</volume>
        <issue>9</issue>
        <fpage>1798</fpage>
        <lpage>1812</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.139105.112</pub-id>
        <pub-id pub-id-type="pmid">22955990</pub-id>
      </element-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Iyer</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>X.-Y.</given-names>
          </name>
          <name>
            <surname>Greven</surname>
            <given-names>M. C.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>B.-H.</given-names>
          </name>
          <name>
            <surname>Moore</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Pierce</surname>
            <given-names>B. G.</given-names>
          </name>
          <name>
            <surname>Dong</surname>
            <given-names>X.</given-names>
          </name>
          <name>
            <surname>Virgil</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Birney</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Hung</surname>
            <given-names>J.-H.</given-names>
          </name>
          <name>
            <surname>Weng</surname>
            <given-names>Z.</given-names>
          </name>
        </person-group>
        <article-title>Factorbook.org: a Wiki-based database for transcription factor-binding data generated by the ENCODE consortium</article-title>
        <source>Nucleic Acids Research</source>
        <year>2012</year>
        <volume>41</volume>
        <issue>D1</issue>
        <fpage>D171</fpage>
        <lpage>D176</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gks1221</pub-id>
        <pub-id pub-id-type="pmid">23203885</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hsu</surname>
            <given-names>Sarah C.</given-names>
          </name>
          <name>
            <surname>Gilgenast</surname>
            <given-names>Thomas G.</given-names>
          </name>
          <name>
            <surname>Bartman</surname>
            <given-names>Caroline R.</given-names>
          </name>
          <name>
            <surname>Edwards</surname>
            <given-names>Christopher R.</given-names>
          </name>
          <name>
            <surname>Stonestrom</surname>
            <given-names>Aaron J.</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Peng</given-names>
          </name>
          <name>
            <surname>Emerson</surname>
            <given-names>Daniel J.</given-names>
          </name>
          <name>
            <surname>Evans</surname>
            <given-names>Perry</given-names>
          </name>
          <name>
            <surname>Werner</surname>
            <given-names>Michael T.</given-names>
          </name>
          <name>
            <surname>Keller</surname>
            <given-names>Cheryl A.</given-names>
          </name>
          <name>
            <surname>Giardine</surname>
            <given-names>Belinda</given-names>
          </name>
          <name>
            <surname>Hardison</surname>
            <given-names>Ross C.</given-names>
          </name>
          <name>
            <surname>Raj</surname>
            <given-names>Arjun</given-names>
          </name>
          <name>
            <surname>Phillips-Cremins</surname>
            <given-names>Jennifer E.</given-names>
          </name>
          <name>
            <surname>Blobel</surname>
            <given-names>Gerd A.</given-names>
          </name>
        </person-group>
        <article-title>The BET Protein BRD2 Cooperates with CTCF to Enforce Transcriptional and Architectural Boundaries</article-title>
        <source>Molecular Cell</source>
        <year>2017</year>
        <volume>66</volume>
        <issue>1</issue>
        <fpage>102-116.e7</fpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2017.02.027</pub-id>
        <pub-id pub-id-type="pmid">28388437</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rowley</surname>
            <given-names>M. Jordan</given-names>
          </name>
          <name>
            <surname>Nichols</surname>
            <given-names>Michael H.</given-names>
          </name>
          <name>
            <surname>Lyu</surname>
            <given-names>Xiaowen</given-names>
          </name>
          <name>
            <surname>Ando-Kuri</surname>
            <given-names>Masami</given-names>
          </name>
          <name>
            <surname>Rivera</surname>
            <given-names>I. Sarahi M.</given-names>
          </name>
          <name>
            <surname>Hermetz</surname>
            <given-names>Karen</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>Ping</given-names>
          </name>
          <name>
            <surname>Ruan</surname>
            <given-names>Yijun</given-names>
          </name>
          <name>
            <surname>Corces</surname>
            <given-names>Victor G.</given-names>
          </name>
        </person-group>
        <article-title>Evolutionarily Conserved Principles Predict 3D Chromatin Organization</article-title>
        <source>Molecular Cell</source>
        <year>2017</year>
        <volume>67</volume>
        <issue>5</issue>
        <fpage>837-852.e7</fpage>
        <pub-id pub-id-type="doi">10.1016/j.molcel.2017.07.022</pub-id>
        <pub-id pub-id-type="pmid">28826674</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rowley</surname>
            <given-names>M. Jordan</given-names>
          </name>
          <name>
            <surname>Corces</surname>
            <given-names>Victor G.</given-names>
          </name>
        </person-group>
        <article-title>Organizational principles of 3D genome architecture</article-title>
        <source>Nature Reviews Genetics</source>
        <year>2018</year>
        <volume>19</volume>
        <issue>12</issue>
        <fpage>789</fpage>
        <lpage>800</lpage>
        <pub-id pub-id-type="doi">10.1038/s41576-018-0060-8</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Oudelaar</surname>
            <given-names>A. Marieke</given-names>
          </name>
          <name>
            <surname>Davies</surname>
            <given-names>James O. J.</given-names>
          </name>
          <name>
            <surname>Hanssen</surname>
            <given-names>Lars L. P.</given-names>
          </name>
          <name>
            <surname>Telenius</surname>
            <given-names>Jelena M.</given-names>
          </name>
          <name>
            <surname>Schwessinger</surname>
            <given-names>Ron</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>Yu</given-names>
          </name>
          <name>
            <surname>Brown</surname>
            <given-names>Jill M.</given-names>
          </name>
          <name>
            <surname>Downes</surname>
            <given-names>Damien J.</given-names>
          </name>
          <name>
            <surname>Chiariello</surname>
            <given-names>Andrea M.</given-names>
          </name>
          <name>
            <surname>Bianco</surname>
            <given-names>Simona</given-names>
          </name>
          <name>
            <surname>Nicodemi</surname>
            <given-names>Mario</given-names>
          </name>
          <name>
            <surname>Buckle</surname>
            <given-names>Veronica J.</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>Job</given-names>
          </name>
          <name>
            <surname>Higgs</surname>
            <given-names>Douglas R.</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>Jim R.</given-names>
          </name>
        </person-group>
        <article-title>Single-allele chromatin interactions identify regulatory hubs in dynamic compartmentalized domains</article-title>
        <source>Nature Genetics</source>
        <year>2018</year>
        <volume>50</volume>
        <issue>12</issue>
        <fpage>1744</fpage>
        <lpage>1751</lpage>
        <pub-id pub-id-type="doi">10.1038/s41588-018-0253-2</pub-id>
        <pub-id pub-id-type="pmid">30374068</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bintu</surname>
            <given-names>Bogdan</given-names>
          </name>
          <name>
            <surname>Mateo</surname>
            <given-names>Leslie J.</given-names>
          </name>
          <name>
            <surname>Su</surname>
            <given-names>Jun-Han</given-names>
          </name>
          <name>
            <surname>Sinnott-Armstrong</surname>
            <given-names>Nicholas A.</given-names>
          </name>
          <name>
            <surname>Parker</surname>
            <given-names>Mirae</given-names>
          </name>
          <name>
            <surname>Kinrot</surname>
            <given-names>Seon</given-names>
          </name>
          <name>
            <surname>Yamaya</surname>
            <given-names>Kei</given-names>
          </name>
          <name>
            <surname>Boettiger</surname>
            <given-names>Alistair N.</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>Xiaowei</given-names>
          </name>
        </person-group>
        <article-title>Super-resolution chromatin tracing reveals domains and cooperative interactions in single cells</article-title>
        <source>Science</source>
        <year>2018</year>
        <volume>362</volume>
        <issue>6413</issue>
        <fpage>eaau1783</fpage>
        <pub-id pub-id-type="doi">10.1126/science.aau1783</pub-id>
        <pub-id pub-id-type="pmid">30361340</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schmitt</surname>
            <given-names>Anthony D.</given-names>
          </name>
          <name>
            <surname>Hu</surname>
            <given-names>Ming</given-names>
          </name>
          <name>
            <surname>Jung</surname>
            <given-names>Inkyung</given-names>
          </name>
          <name>
            <surname>Xu</surname>
            <given-names>Zheng</given-names>
          </name>
          <name>
            <surname>Qiu</surname>
            <given-names>Yunjiang</given-names>
          </name>
          <name>
            <surname>Tan</surname>
            <given-names>Catherine L.</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>Yun</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Shin</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>Yiing</given-names>
          </name>
          <name>
            <surname>Barr</surname>
            <given-names>Cathy L.</given-names>
          </name>
          <name>
            <surname>Ren</surname>
            <given-names>Bing</given-names>
          </name>
        </person-group>
        <article-title>A Compendium of Chromatin Contact Maps Reveals Spatially Active Regions in the Human Genome</article-title>
        <source>Cell Reports</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>8</issue>
        <fpage>2042</fpage>
        <lpage>2059</lpage>
        <pub-id pub-id-type="doi">10.1016/j.celrep.2016.10.061</pub-id>
        <pub-id pub-id-type="pmid">27851967</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Imakaev</surname>
            <given-names>Maxim</given-names>
          </name>
          <name>
            <surname>Fudenberg</surname>
            <given-names>Geoffrey</given-names>
          </name>
          <name>
            <surname>McCord</surname>
            <given-names>Rachel Patton</given-names>
          </name>
          <name>
            <surname>Naumova</surname>
            <given-names>Natalia</given-names>
          </name>
          <name>
            <surname>Goloborodko</surname>
            <given-names>Anton</given-names>
          </name>
          <name>
            <surname>Lajoie</surname>
            <given-names>Bryan R</given-names>
          </name>
          <name>
            <surname>Dekker</surname>
            <given-names>Job</given-names>
          </name>
          <name>
            <surname>Mirny</surname>
            <given-names>Leonid A</given-names>
          </name>
        </person-group>
        <article-title>Iterative correction of Hi-C data reveals hallmarks of chromosome organization</article-title>
        <source>Nature Methods</source>
        <year>2012</year>
        <volume>9</volume>
        <issue>10</issue>
        <fpage>999</fpage>
        <lpage>1003</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2148</pub-id>
        <pub-id pub-id-type="pmid">22941365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>Bradley</given-names>
          </name>
        </person-group>
        <article-title>Size, power and false discovery rates</article-title>
        <source>The Annals of Statistics</source>
        <year>2007</year>
        <volume>35</volume>
        <issue>4</issue>
        <fpage>1351</fpage>
        <lpage>1377</lpage>
        <pub-id pub-id-type="doi">10.1214/009053606000001460</pub-id>
      </element-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>Xiaobin</given-names>
          </name>
          <name>
            <surname>Zheng</surname>
            <given-names>Yixian</given-names>
          </name>
        </person-group>
        <article-title>CscoreTool: fast Hi-C compartment analysis at high resolution</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>34</volume>
        <issue>9</issue>
        <fpage>1568</fpage>
        <lpage>1570</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx802</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mi</surname>
            <given-names>Huaiyu</given-names>
          </name>
          <name>
            <surname>Muruganujan</surname>
            <given-names>Anushya</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>Dustin</given-names>
          </name>
          <name>
            <surname>Huang</surname>
            <given-names>Xiaosong</given-names>
          </name>
          <name>
            <surname>Thomas</surname>
            <given-names>Paul D</given-names>
          </name>
        </person-group>
        <article-title>PANTHER version 14: more genomes, a new PANTHER GO-slim and improvements in enrichment analysis tools</article-title>
        <source>Nucleic Acids Research</source>
        <year>2018</year>
        <volume>47</volume>
        <issue>D1</issue>
        <fpage>D419</fpage>
        <lpage>D426</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gky1038</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <mixed-citation publication-type="other">An, Lin; Yang, Tao; Yang, Jiahao; Nuebler, Johannes; Xiang, Guanjue; Hardison, Ross; Li, Qunhua; Zhang Y. anlin00007/OnTAD: OnTAD: hierarchical domain structure reveals the divergence of activity among TADs and boundaries. Github. 2019. 10.5281/ZENODO.3370539</mixed-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Hsu SC, Gilgenast TG, Blobel GA P-CJ. BRD2 cooperates with CTCF to enforce transcriptional and architectural boundaries. Gene Expression Omnibus. 2017; 66(1):102-116.e7.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <mixed-citation publication-type="other">Wang Y, Song F, Zhang B, Zhang L, Xu J, Kuang D, Li D, Choudhary MNK, Li Y, Hu M, Hardison R, Wang T, Yue F. The 3D Genome Browser: a web-based browser for visualizing 3D genome organization and long-range chromatin interactions. Genome Biol. 2018;19:151. 10.1186/s13059-018-1519-9.</mixed-citation>
    </ref>
  </ref-list>
</back>
