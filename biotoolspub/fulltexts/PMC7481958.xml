<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.0 20120330//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Comput Math Methods Med</journal-id>
    <journal-id journal-id-type="iso-abbrev">Comput Math Methods Med</journal-id>
    <journal-id journal-id-type="publisher-id">CMMM</journal-id>
    <journal-title-group>
      <journal-title>Computational and Mathematical Methods in Medicine</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1748-670X</issn>
    <issn pub-type="epub">1748-6718</issn>
    <publisher>
      <publisher-name>Hindawi</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7481958</article-id>
    <article-id pub-id-type="doi">10.1155/2020/7231205</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Research Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>DeepVariant-on-Spark: Small-Scale Genome Analysis Using a Cloud-Based Computing Framework</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-8728-8881</contrib-id>
        <name>
          <surname>Huang</surname>
          <given-names>Po-Jung</given-names>
        </name>
        <xref ref-type="aff" rid="I1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="I2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="I3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chang</surname>
          <given-names>Jui-Huan</given-names>
        </name>
        <xref ref-type="aff" rid="I2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lin</surname>
          <given-names>Hou-Hsien</given-names>
        </name>
        <xref ref-type="aff" rid="I4">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Yu-Xuan</given-names>
        </name>
        <xref ref-type="aff" rid="I2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-2912-7745</contrib-id>
        <name>
          <surname>Lee</surname>
          <given-names>Chi-Ching</given-names>
        </name>
        <xref ref-type="aff" rid="I5">
          <sup>5</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Su</surname>
          <given-names>Chung-Tsai</given-names>
        </name>
        <xref ref-type="aff" rid="I1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="I6">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Yun-Lung</given-names>
        </name>
        <xref ref-type="aff" rid="I1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="I6">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chang</surname>
          <given-names>Ming-Tai</given-names>
        </name>
        <xref ref-type="aff" rid="I1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="I6">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Weng</surname>
          <given-names>Sid</given-names>
        </name>
        <xref ref-type="aff" rid="I1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="I6">
          <sup>6</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-0100-7285</contrib-id>
        <name>
          <surname>Cheng</surname>
          <given-names>Wei-Hung</given-names>
        </name>
        <xref ref-type="aff" rid="I7">
          <sup>7</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-4324-7743</contrib-id>
        <name>
          <surname>Chiu</surname>
          <given-names>Cheng-Hsun</given-names>
        </name>
        <xref ref-type="aff" rid="I3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2779-0116</contrib-id>
        <name>
          <surname>Tang</surname>
          <given-names>Petrus</given-names>
        </name>
        <email>petang@mail.cgu.edu.tw</email>
        <xref ref-type="aff" rid="I2">
          <sup>2</sup>
        </xref>
        <xref ref-type="aff" rid="I3">
          <sup>3</sup>
        </xref>
        <xref ref-type="aff" rid="I7">
          <sup>7</sup>
        </xref>
      </contrib>
    </contrib-group>
    <aff id="I1"><sup>1</sup>Department of Biomedical Sciences, Chang Gung University, Taoyuan, Taiwan</aff>
    <aff id="I2"><sup>2</sup>Graduate Institute of Biomedical Sciences, College of Medicine, Chang Gung University, Taoyuan, Taiwan</aff>
    <aff id="I3"><sup>3</sup>Genomic Medicine Core Laboratory, Chang Gung Memorial Hospital, Linkou, Taiwan</aff>
    <aff id="I4"><sup>4</sup>Institute of Bioinformatics and Structural Biology, National Tsing Hua University, Hsinchu, Taiwan</aff>
    <aff id="I5"><sup>5</sup>Department of Computer Science and Information Engineering, Chang Gung University, Taoyuan, Taiwan</aff>
    <aff id="I6"><sup>6</sup>ATGENOMIX INC, Rm. 918, 9F, 96, Chia Hsin Bldg. (Second Bldg.) Sec. 2, Zhongshan N. Rd., Zhongshan Dist., Taipei, Taiwan</aff>
    <aff id="I7"><sup>7</sup>Department of Parasitology, College of Medicine, Chang Gung University, Taoyuan, Taiwan</aff>
    <author-notes>
      <fn fn-type="other">
        <p>Academic Editor: Maria E. Fantacci</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>1</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <volume>2020</volume>
    <elocation-id>7231205</elocation-id>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>4</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>15</day>
        <month>8</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>8</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2020 Po-Jung Huang et al.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an open access article distributed under the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p>Although sequencing a human genome has become affordable, identifying genetic variants from whole-genome sequence data is still a hurdle for researchers without adequate computing equipment or bioinformatics support. GATK is a gold standard method for the identification of genetic variants and has been widely used in genome projects and population genetic studies for many years. This was until the Google Brain team developed a new method, DeepVariant, which utilizes deep neural networks to construct an image classification model to identify genetic variants. However, the superior accuracy of DeepVariant comes at the cost of computational intensity, largely constraining its applications. Accordingly, we present DeepVariant-on-Spark to optimize resource allocation, enable multi-GPU support, and accelerate the processing of the DeepVariant pipeline. To make DeepVariant-on-Spark more accessible to everyone, we have deployed the DeepVariant-on-Spark to the Google Cloud Platform (GCP). Users can deploy DeepVariant-on-Spark on the GCP following our instruction within 20 minutes and start to analyze at least ten whole-genome sequencing datasets using free credits provided by the GCP. DeepVaraint-on-Spark is freely available for small-scale genome analysis using a cloud-based computing framework, which is suitable for pilot testing or preliminary study, while reserving the flexibility and scalability for large-scale sequencing projects.</p>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>Ministry of Science and Technology, Taiwan</funding-source>
        <award-id>108-2221-E-182-043-MY3</award-id>
      </award-group>
      <award-group>
        <funding-source>Chang Gung Memorial Hospital, Linkou</funding-source>
        <award-id>CMRPD1I0131/2/3</award-id>
      </award-group>
    </funding-group>
  </article-meta>
</front>
<body>
  <sec id="sec1">
    <title>1. Introduction</title>
    <p>As the cost of sequencing a human genome decreased dramatically, large-scale whole-genome sequencing projects were launched alongside the rising demand for precision medicine. Previous studies have stated that interethnic differences in drug response are substantial, and precision medicine relies on genotype-based prescribing decisions aimed at mitigating the risks and maximizing the efficacy of pharmacotherapy. Accordingly, national projects, such as those in the UK, United States, EU, Mexico, India, China, Sweden, Korea, and Taiwan biobank [<xref rid="B1" ref-type="bibr">1</xref>–<xref rid="B8" ref-type="bibr">8</xref>], have been launched and exemplify this trend.</p>
    <p>To the best of our knowledge, the GATK [<xref rid="B9" ref-type="bibr">9</xref>–<xref rid="B11" ref-type="bibr">11</xref>] is one of the dominant packages for the identification of germline genetic variants and has been widely used in genome projects [<xref rid="B12" ref-type="bibr">12</xref>–<xref rid="B15" ref-type="bibr">15</xref>] and applied to the analyses of 125,748 exomes and 15,708 genomes (<ext-link ext-link-type="uri" xlink:href="https://gnomad.broadinstitute.org/about">https://gnomad.broadinstitute.org/about</ext-link>) as part of population genetic studies. In 2016, the Google Brain team announced DeepVariant [<xref rid="B16" ref-type="bibr">16</xref>], which utilizes deep neural networks to construct an image classification model to identify genetic variants. DeepVariant outperforms GATK—a golden standard method for variant calling—and has won the PrecisionFDA Truth Challenge Award for the highest SNP performance. Supernat et al. have confirmed the results of the PrecisionFDA Truth Challenge, proving that DeepVariant is currently the most precise variant caller available [<xref rid="B16" ref-type="bibr">16</xref>].</p>
    <p>DeepVariant's superior accuracy comes at the cost of computational intensity, as it requires approximately two times longer wall-clock times than GATK in variant identification. DeepVariant is composed of three steps: (1) make_examples obtains BAM files and converts them to images, (2) call_variants performs the variant calling using the ML-trained model, and (3) post process_variants transforms the variant calling output into a standard VCF file. Following the authors' instructions, call_variants is the only step that can make use of GPUs to reduce the variant calling time by more than 50% [<xref rid="B16" ref-type="bibr">16</xref>]. However, overcoming the configuration hurdle of GPU hardware can be difficult for users without bioinformatics experience. Furthermore, the call_variants step currently only supports one GPU, and the other two steps of DeepVariant are not optimized for speed, indicating that there is room for improvement.</p>
    <p>Our specific aim in constructing DeepVariant-on-Spark is to enable multi-GPU support and optimize resource allocation in the DeepVariant pipeline. DeepVaraint-on-Spark leverages the Apache Spark and Hadoop technologies to launch DeepVariant processes in parallel and ensure that we can fully utilize all GPU resources. To make DeepVariant-on-Spark more accessible to everyone, we have deployed DeepVariant-on-Spark onto the Google Cloud Platform (GCP). Users can follow our step-by-step instruction, and all necessary packages can be installed automatically by Ansible [<xref rid="B17" ref-type="bibr">17</xref>] within 20 minutes. DeepVariant-on-Spark can analyze at least ten whole-genome sequencing tasks using the 300 free USD credits provided by the GCP, which is suitable for preliminary studies or pilot testing. On the other hand, DeepVariant-on-Spark also provides the flexibility and scalability for large-scale sequencing projects.</p>
  </sec>
  <sec id="sec2">
    <title>2. Materials and Methods</title>
    <sec id="sec2.1">
      <title>2.1. Deployment of DeepVariant-on-Spark</title>
      <p>DeepVariant-on-Spark is designed as a cloud-based application, utilizing Google Cloud Dataproc (<ext-link ext-link-type="uri" xlink:href="https://cloud.google.com/dataproc/">https://cloud.google.com/dataproc/</ext-link>) to manage services for running Apache Spark [<xref rid="B18" ref-type="bibr">18</xref>] and Hadoop [<xref rid="B19" ref-type="bibr">19</xref>] clusters in a fast, more straightforward, and efficient way. Installing the gsutil tool is the first step and enables users to access the Google Cloud Dataproc and publicly accessible objects (<ext-link ext-link-type="uri" xlink:href="https://cloud.google.com/storage/docs/gsutil_install">https://cloud.google.com/storage/docs/gsutil_install</ext-link>). Cloud Dataproc provides a mechanism for automating cluster resource management, which enables flexible addition and subtraction of cluster nodes. After successfully launching the DataProc cluster, Ansible is used to automate the deployment of all necessary packages to the entire cluster, which includes DeepVariant [<xref rid="B20" ref-type="bibr">20</xref>], Adam [<xref rid="B21" ref-type="bibr">21</xref>], SeqPiper, and PiedPiper, using the YAML language in the form of Ansible playbooks. Detailed installation instructions can be found on the tutorial page (<ext-link ext-link-type="uri" xlink:href="https://storage.cloud.google.com/sparkdv/performance-test/DeepVariant-On-Spark_Tutorial.html?hl=zh-TW">https://storage.cloud.google.com/sparkdv/performance-test/DeepVariant-On-Spark_Tutorial.html?hl=zh-TW</ext-link>).</p>
    </sec>
    <sec id="sec2.2">
      <title>2.2. Whole-Genome Sequencing and Alignment of the NA12878 Reference Sample</title>
      <p>The 30x whole-genome sequencing of the NA12878 reference sample was downloaded from the European Nucleotide Archive (ENA), which was sequenced by an Illumina NovaSeq 6000 instrument with a 150 bp paired-end sequencing protocol. Reads were aligned to the human reference genome—Gencode GRCh38.p13 by bwa-mem. We deposited the aligned sequences in Google Storage as a BAM file (gs://sparkdv/performance-test/NA12878-novaseq.bam) and used Qualimap2 to evaluate the alignment quality of the obtained BAM file [<xref rid="B22" ref-type="bibr">22</xref>].</p>
    </sec>
    <sec id="sec2.3">
      <title>2.3. Framework of DeepVariant-on-Spark</title>
      <p>Currently, DeepVariant only supports single GPU acceleration in variant calling, and we cannot obtain any benefit on machines with multiple GPUs. Therefore, DeepVariant-on-Spark was designed to leverage Apache Spark to launch multiple DeepVariant processes in parallel to address the scalability problem of variant calling. The input BAM file was first uploaded to the Hadoop Distributed File System (HDFS), followed by segmentation into several 1 Mbp data blocks. Then, we transformed the resulting data blocks into Apache Parquet file format (∗.parquet) to enhance the transfer performance through data compression. To overcome the load imbalance introduced by the uneven length of chromosomes, we aggregated those 1 Mbp data blocks into 155 approximately equal-sized BAM files according to contiguous unmasked regions of the human genome. These BAM files were transformed into resilient distributed datasets (RDD) data structure, which can be further partitioned and distributed across a Spark cluster. Finally, the Spark PipeRDD was used to parallelize the DeepVariant processes on Spark to ensure that all the GPU resources can be fully utilized across compute nodes (<xref ref-type="fig" rid="fig1">Figure 1</xref>).</p>
    </sec>
    <sec id="sec2.4">
      <title>2.4. Quality Evaluation of Variant Calling</title>
      <p>We performed variant calling using DeepVariant and DeepVariant-on-Spark to obtain variant call format (VCF) files from the NA12878 reference sample. DeepVariant version 0.7.0 was used for constructing the original DeepVariant pipeline and our accelerated DeepVariant-on-Spark pipeline on the cloud computing environment. The results from both pipelines with different CPU/GPU combinations were compared to the GIAB NIST v3.2.2 HG001 truth data [<xref rid="B23" ref-type="bibr">23</xref>, <xref rid="B24" ref-type="bibr">24</xref>] (<ext-link ext-link-type="ftp" xlink:href="ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/release/NA12878_HG001/NISTv3.3.2/GRCh38/">ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/release/NA12878_HG001/NISTv3.3.2/GRCh38/</ext-link>) to determine the <italic>F</italic>-score, recall, and precision values for SNPs and Indels. The RTG vcfeval tool (<ext-link ext-link-type="uri" xlink:href="https://github.com/RealTimeGenomics/rtg-tools">https://github.com/RealTimeGenomics/rtg-tools</ext-link>) was used to generate intermediate VCF for variant comparison [<xref rid="B25" ref-type="bibr">25</xref>]. Illumina's hap.py (<ext-link ext-link-type="uri" xlink:href="https://github.com/Illumina/hap.py/blob/master/doc/happy.md">https://github.com/Illumina/hap.py/blob/master/doc/happy.md</ext-link>), a quantify tool, was utilized to count and stratify variants.</p>
    </sec>
    <sec id="sec2.5">
      <title>2.5. Data Access</title>
      <p>The DeepVariant v0.7.0 used in this study is available on the following GitHub page: <ext-link ext-link-type="uri" xlink:href="https://github.com/google/deepvariant/releases/tag/v0.7.0">https://github.com/google/deepvariant/releases/tag/v0.7.0</ext-link>.</p>
      <p>The DeepVariant-on-Spark pipeline used in this study is available on the following GitHub page: <ext-link ext-link-type="uri" xlink:href="https://github.com/atgenomix/deepvariant-on-spark">https://github.com/atgenomix/deepvariant-on-spark</ext-link>.</p>
      <p>The GIAB NIST v3.3.2 true variant dataset used for evaluating variant caller performance can be downloaded through the following link: <ext-link ext-link-type="ftp" xlink:href="ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/release/NA12878_HG001/NISTv3.3.2/GRCh38/">ftp://ftp-trace.ncbi.nlm.nih.gov/giab/ftp/release/NA12878_HG001/NISTv3.3.2/GRCh38/</ext-link>.</p>
      <p>Variant evaluation and comparison tools can be obtained from <ext-link ext-link-type="uri" xlink:href="https://github.com/RealTimeGenomics/rtg-tools">https://github.com/RealTimeGenomics/rtg-tools</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://github.com/Illumina/hap.py">https://github.com/Illumina/hap.py</ext-link>.</p>
    </sec>
  </sec>
  <sec id="sec3">
    <title>3. Results</title>
    <sec id="sec3.1">
      <title>3.1. Comparison of the DeepVariant and DeepVariant-on-Spark for Analysis of Human 30x WGS Data</title>
      <p>First, we need to confirm that DeepVariant-on-Spark can achieve comparable accuracy to DeepVariant. Before we can perform a side-by-side comparison between DeepVariant-on-Spark and DeepVariant, we need to have a standard BAM file for the evaluation of the variant calling accuracy. The 30x WGS of the NA12878 reference sample with 611,997,146 reads was aligned to the GRCh38.p13 reference genome to obtain the BAM file, with 99.82% aligned reads, 41.25% GC, and 29.08x mean coverage. Our analysis showed that the <italic>F</italic>-scores, the harmonic mean of the recall, and precision, for both SNVs and Indels, were the same (<italic>F</italic>-scores of 0.99940 and 0.96168, respectively) for DeepVariant-on-Spark as compared to DeepVariant. As shown in <xref rid="tab1" ref-type="table">Table 1</xref>, the analyses have been comprehensively performed under different combinations of hardware settings, and the results were consistent.</p>
    </sec>
    <sec id="sec3.2">
      <title>3.2. The Computation Bottlenecks of DeepVariant</title>
      <p>To explore the bottleneck of DeepVariant, we evaluated the DeepVariant pipeline on the GCP using a virtual machine equipped with 16 CPUs (2.0 GHz) and 60 GB of memory, with flexibility for adding or removing CPU/GPU on existing virtual machine instances. The reference runtime for DeepVariant was established using 16 CPUs (2.0 GHz), which took 17.5 hours to finish variant calling from 30x WGS. The results show that “Make_Examples” and “Call_Variants” are computational bottlenecks of the DeepVariant pipeline. Increasing the number of CPUs may have improved both steps, but the impact on the “Call_Variants” step is not apparent (<xref ref-type="fig" rid="fig2">Figure 2(a)</xref>). However, when the number of CPUs increases, DeepVariant-on-Spark can provide a significant improvement in both the “Make_Examples” and “Call_Variants” steps, resulting in an ideal speedup ratio for the overall processes (Figures <xref ref-type="fig" rid="fig2">2(a)</xref> and <xref ref-type="fig" rid="fig2">2(b)</xref>). Only two compute nodes, which are equivalent to 32 CPUs, are required by DeepVariant-on-Spark to achieve the same computing performance as DeepVariant with 64 CPUs. In addition, the GCP has limited the maximum number of CPUs for a single virtual machine to 96, leading to poor scalability of DeepVariant. We present DeepVariant-on-Spark with a scalable architecture for parallel execution of DeepVariant based on the Apache Spark framework. The distributed Apache Spark framework provides an excellent solution for addressing this scalability issue. DeepVariant-on-Spark can accelerate the default DeepVariant pipeline by seven times, taking the full load of 128 CPUs through 8 compute nodes, thereby achieving high performance due to the memory-based computing and good scalability on multiple nodes. We can reduce the overall wall-clock time for the variant calling of 30x WGS from 17.5 to 2.5 hours using 128 CPUs under the DeepVariant-on-Spark frameworks.</p>
    </sec>
    <sec id="sec3.3">
      <title>3.3. Scalability Analysis of DeepVariant and DeepVariant-on-Spark Based on Heterogeneous Computing Architecture</title>
      <p>Heterogeneous computing, which uses a different type of processor (CPU or GPU) to gain efficiency and performance, therein incorporating specialized processing capabilities to handle specific tasks, has been gaining popularity in the past few years. Accordingly, we attempted to incorporate GPUs into existing virtual machine instances on the GCP. The results show that GPU acceleration is trivial at the “Make_Examples” step, whereas it introduces significant improvements at the “Call_Variants” step. The speedup rate increases after incorporating the GPUs (Figures <xref ref-type="fig" rid="fig2">2(b)</xref> and <xref ref-type="fig" rid="fig2">2(d)</xref>); however, we cannot find additional benefit from multiple GPUs, indicating that the current release of the DeepVariant pipeline supports a single GPU (<xref ref-type="fig" rid="fig2">Figure 2(b)</xref>). Accordingly, we introduce DeepVariant-on-Spark to unleash the full power of multiple GPUs. DeepVariant-on-Spark is evaluated on Google Cloud DataProc Spark clusters with 2, 4, and 8 compute nodes (Figures <xref ref-type="fig" rid="fig2">2(c)</xref> and <xref ref-type="fig" rid="fig2">2(d)</xref>). Each node is equipped with 16 CPUs (2.0 GHz), 104 GB of memory, and 1 NVIDIA Tesla P100 GPU processor. Through DeepVariant-on-Spark, not only the CPUs but also all the GPU resources can be fully utilized across multiple nodes, and we can reduce the wall-clock times for the “Call_Variants” step by ~45% when we double the number of GPUs. With eight compute nodes, which is equivalent to 128 CPUs and 8 NVIDIA Tesla P100 GPU processors, we can reduce the overall wall-clock time from 17.5 to 1.51 hours for the variant calling of 30x WGS. As shown in <xref ref-type="fig" rid="fig2">Figure 2(d)</xref>, when we use 128 CPUs and 8 GPUs, we can accelerate the pipeline by 11 times, and the speedup ratio is still increasing, indicating that DeepVariant-on-Spark can achieve a high CPU and GPU utilization rate and is more scalable than the original DeepVariant pipeline. <xref rid="tab2" ref-type="table"> Table 2</xref> describes the wall-clock times of DeepVariant-on-Spark and DeepVariant with 1, 2, 4, and 8 compute nodes equipped with different CPU and GPU processors.</p>
    </sec>
    <sec id="sec3.4">
      <title>3.4. The Cost Effectiveness and Cost Efficiency of DeepVariant and DeepVariant-on-Spark</title>
      <p>The primary purpose of this study is to provide a reference guide for users who plan to initiate a small-scale genome analysis to select their ideal solutions for their preliminary study. When computing time is not a major concern, the original DeepVariant pipeline with 16 CPUs can be a relatively cost-effective solution, which can analyze as many as 21 WGS datasets within the 300 USD free credits provided by the GCP. However, the default virtual machine architecture provided by the GCP has poor scalability, with a constraint on CPU number, making it difficult to optimize the trade-offs between cost and performance in running DeepVariant. At the same cost of 25 USD, DeepVariant takes 5.5 hours to finish a 30x WGS variant calling task with its inherited constraint of using 96 CPUs, while DeepVariant-on-Spark has the flexibility to adjust the cost-performance ratio to finish the same task in 2.5 hours. If pressed for time, DeepVariant-on-Spark would be a cost-efficient option that can finish the variant calling of 10 WGS data in just one day. <xref rid="tab2" ref-type="table"> Table 2</xref> summarizes the wall-clock times and cost estimates for analyzing 30x WGS on the GCP.</p>
    </sec>
  </sec>
  <sec id="sec4">
    <title>4. Discussion</title>
    <p>In this study, we provide a flexible and scalable framework for DeepVariant acceleration. DeepVariant is the most precise variant caller that outperforms existing tools in SNV and Indel identification, therein having great potential for implementation in routine genetic diagnosis. Our proposed framework, DeepVariant-on-Spark, can not only reduce the wall-clock time while maintaining the same accuracy but also break the limitation on the number of utilizable CPUs and GPUs of DeepVariant.</p>
    <p>The user needs to set up a new account on the GCP to receive the free credits, which can provide a convenient place to run DeepVariant with CPU and GPU support. Following the author's instructions, we can easily set up the CPU version of DeepVariant without any hurdles. However, we have to recompile a compatible NVIDIA GPU driver for a specific DeepVariant version on the GCP to enable the support of GPU hardware, which can be a challenge for inexperienced users. On the other hand, DeepVaraint-on-Spark provides step-by-step instructions on how to prepare a Google DataProc cluster. The installation script will recognize the hardware specifications and automatically deploy related drivers and packages to enable CPU or GPU acceleration of DeepVariant-on-Spark within 20 minutes. To the best of our knowledge, substantial efforts, such as Nextflow, DNAnexus, DNAstack, and Parabricks, have been devoted to accelerating the DeepVariant pipeline. Nextflow offers parallel processing of multiple samples for DeepVariant at a time [<xref rid="B26" ref-type="bibr">26</xref>], producing the results in a convenient and reproducible manner; however, the total wall-clock time for each sample is unchanged. DNAnexus and DNAstack can provide parallelized execution of DeepVariant with a GUI interface, but licenses are required to obtain the full functionality of these commercial packages. Parabricks introduced an accelerated DeepVaraint pipeline with multi-GPU support. However, license fees will be charged for all attached GPUs to receive their maximum performance. Google Genomics also suggests a cost-optimized configuration, using 32 virtual machines with 16 CPUs and 32 virtual machines with 32 CPUs for the “Make_Examples” and “Call_Variants” step, respectively, to complete the DeepVariant pipeline for 30x whole genome sample in 1 to 2 hours at a cost of between 3 USD and 4 USD. The configuration takes advance of CPUs from preemptible virtual machines, which are 80% cheaper than regular virtual machines. However, the compute engines might terminate at any time without guaranteeing turnaround time and are recommended only for fault-tolerant applications and users familiar with the GCP. Furthermore, a billable account is required to launch the preemptible virtual machines, and free credits for new users are not allowed for the acquisition of compute resources. Unlike most of the solutions mentioned above, DeepVariant-on-Spark is free for academic use. Despite not being the most cost-optimized solution available, DeepVariant-on-Spark can complete variant calling for 30x whole genome sample in 1.51 hours, which is comparable with the cost-optimized solution provided by Google Genomics. The reduction in wall-clock time to process a single 30X WGS sample is crucial in clinical settings where a result is needed to quickly take a diagnostic decision. When we were preparing this manuscript, multi-GPU support has been implemented in the recent release of DeepVaraint, making some of the benefits of DeepVariant-on-Spark become redundant. However, DeepVariant-on-Spark supports multi-GPU across multiple nodes, which seems to be conceptually better than limited to a single node.</p>
    <p>To conclude, we present DeepVariant-on-Spark, a flexible and scalable tool for variant calling based on the Spark framework. DeepVariant-on-Spark implements the parallelization of the DeepVariant algorithm on a multinode cluster and enables the support of multiple GPUs, therein accelerating the processing of the DeepVariant pipeline while maintaining accuracy. Following our instructions, users can easily deploy the DeepVariant-on-Spark on the GCP within 20 minutes and start to analyze WGS datasets on the GCP, which is also useful for researchers who plan to initiate a small-scale genome analysis for preliminary study and makes DeepVariant, the TensorFlow-based variant caller, more attractive to general users, simplifying the usage to catalyze DeepVairant to a more broadly used tool.</p>
  </sec>
</body>
<back>
  <ack>
    <title>Acknowledgments</title>
    <p>We would like to thank Dr. Chang-Fu Kuo and members from the Center for Artificial Intelligence in Medicine of Chang Gung Memorial Hospital for their help to improve the standalone version of DeepVariant-on-Spark. This work was supported by the Chang Gung Memorial Hospital, Linkou, Taiwan (CMRPD1I0131/2/3), and the Ministry of Science and Technology, Taiwan (MOST 108-2221-E-182-043-MY3). Funding for open access charge: Ministry of Science and Technology, Taiwan (MOST 108-2221-E-182-043-MY3).</p>
  </ack>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>The authors declare that the data supporting the findings of this study are available within the article.</p>
  </sec>
  <sec sec-type="COI-statement">
    <title>Conflicts of Interest</title>
    <p>The authors declare that they have no competing interests.</p>
  </sec>
  <sec>
    <title>Authors' Contributions</title>
    <p>PJH supervised this work and wrote the main manuscript. PT proofread the manuscript. JHC prepared Figures <xref ref-type="fig" rid="fig1">1</xref> and <xref ref-type="fig" rid="fig2">2</xref> and Tables <xref rid="tab1" ref-type="table">1</xref> and <xref rid="tab2" ref-type="table">2</xref>. JHC, HHL, YXL, CCL, and CHC performed the benchmarking tests. CTS, YLL, MTC, and SW constructed and fine-tuned the computing architecture. WHC prepared the documentation for installation.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <label>1</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tapia-Conyer</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Kuri-Morales</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Alegre-Díaz</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Cohort profile: the Mexico city prospective study</article-title>
        <source>
          <italic toggle="yes">International Journal of Epidemiology</italic>
        </source>
        <year>2006</year>
        <volume>35</volume>
        <issue>2</issue>
        <fpage>243</fpage>
        <lpage>249</lpage>
        <pub-id pub-id-type="doi">10.1093/ije/dyl042</pub-id>
        <pub-id pub-id-type="other">2-s2.0-33645812738</pub-id>
        <?supplied-pmid 16556648?>
        <pub-id pub-id-type="pmid">16556648</pub-id>
      </element-citation>
    </ref>
    <ref id="B2">
      <label>2</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>Z.</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Collins</surname>
            <given-names>R.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>China Kadoorie Biobank of 0.5 million people: survey methods, baseline characteristics and long-term follow-up</article-title>
        <source>
          <italic toggle="yes">International Journal of Epidemiology</italic>
        </source>
        <year>2011</year>
        <volume>40</volume>
        <issue>6</issue>
        <fpage>1652</fpage>
        <lpage>1666</lpage>
        <pub-id pub-id-type="doi">10.1093/ije/dyr120</pub-id>
        <pub-id pub-id-type="other">2-s2.0-83455213326</pub-id>
        <?supplied-pmid 22158673?>
        <pub-id pub-id-type="pmid">22158673</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <label>3</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lee</surname>
            <given-names>J.-E.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>J. H.</given-names>
          </name>
          <name>
            <surname>Hong</surname>
            <given-names>E. J.</given-names>
          </name>
          <name>
            <surname>Yoo</surname>
            <given-names>H. S.</given-names>
          </name>
          <name>
            <surname>Nam</surname>
            <given-names>H. Y.</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>O.</given-names>
          </name>
        </person-group>
        <article-title>National Biobank of Korea: quality control programs of collected-human biospecimens</article-title>
        <source>
          <italic toggle="yes">Osong Public Health and Research Perspectives</italic>
        </source>
        <year>2012</year>
        <volume>3</volume>
        <issue>3</issue>
        <fpage>185</fpage>
        <lpage>189</lpage>
        <pub-id pub-id-type="doi">10.1016/j.phrp.2012.07.007</pub-id>
        <pub-id pub-id-type="other">2-s2.0-84866867771</pub-id>
        <?supplied-pmid 24159512?>
        <pub-id pub-id-type="pmid">24159512</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <label>4</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mahmood</surname>
            <given-names>S. S.</given-names>
          </name>
          <name>
            <surname>Levy</surname>
            <given-names>D.</given-names>
          </name>
          <name>
            <surname>Vasan</surname>
            <given-names>R. S.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>T. J.</given-names>
          </name>
        </person-group>
        <article-title>The Framingham Heart Study and the epidemiology of cardiovascular disease: a historical perspective</article-title>
        <source>
          <italic toggle="yes">The Lancet</italic>
        </source>
        <year>2014</year>
        <volume>383</volume>
        <issue>9921</issue>
        <fpage>999</fpage>
        <lpage>1008</lpage>
        <pub-id pub-id-type="doi">10.1016/S0140-6736(13)61752-3</pub-id>
        <pub-id pub-id-type="other">2-s2.0-84896114187</pub-id>
        <?supplied-pmid 24084292?>
        <pub-id pub-id-type="pmid">24084292</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <label>5</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mora</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Angelini</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Bignami</surname>
            <given-names>F.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The EuroBioBank network: 10 years of hands-on experience of collaborative, transnational biobanking for rare diseases</article-title>
        <source>
          <italic toggle="yes">European Journal of Human Genetics</italic>
        </source>
        <year>2015</year>
        <volume>23</volume>
        <issue>9</issue>
        <fpage>1116</fpage>
        <lpage>1123</lpage>
        <pub-id pub-id-type="doi">10.1038/ejhg.2014.272</pub-id>
        <pub-id pub-id-type="other">2-s2.0-84939265617</pub-id>
        <?supplied-pmid 25537360?>
        <pub-id pub-id-type="pmid">25537360</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <label>6</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sudlow</surname>
            <given-names>C.</given-names>
          </name>
          <name>
            <surname>Gallacher</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Allen</surname>
            <given-names>N.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>UK biobank: an open access resource for identifying the causes of a wide range of complex diseases of middle and old age</article-title>
        <source>
          <italic toggle="yes">PLoS Medicine</italic>
        </source>
        <year>2015</year>
        <volume>12</volume>
        <issue>3, article e1001779</issue>
        <pub-id pub-id-type="doi">10.1371/journal.pmed.1001779</pub-id>
        <pub-id pub-id-type="other">2-s2.0-84926430250</pub-id>
        <?supplied-pmid 25826379?>
        <pub-id pub-id-type="pmid">25826379</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <label>7</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>C.-H.</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>J. H.</given-names>
          </name>
          <name>
            <surname>Chiang</surname>
            <given-names>C. W. K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Population structure of Han Chinese in the modern Taiwanese population based on 10,000 participants in the Taiwan Biobank project</article-title>
        <source>
          <italic toggle="yes">Human Molecular Genetics</italic>
        </source>
        <year>2016</year>
        <volume>25</volume>
        <issue>24</issue>
        <fpage>5321</fpage>
        <lpage>5331</lpage>
        <pub-id pub-id-type="doi">10.1093/hmg/ddw346</pub-id>
        <pub-id pub-id-type="other">2-s2.0-85016003844</pub-id>
        <?supplied-pmid 27798100?>
        <pub-id pub-id-type="pmid">27798100</pub-id>
      </element-citation>
    </ref>
    <ref id="B8">
      <label>8</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ameur</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Dahlberg</surname>
            <given-names>J.</given-names>
          </name>
          <name>
            <surname>Olason</surname>
            <given-names>P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SweGen: a whole-genome data resource of genetic variability in a cross-section of the Swedish population</article-title>
        <source>
          <italic toggle="yes">European Journal of Human Genetics</italic>
        </source>
        <year>2017</year>
        <volume>25</volume>
        <issue>11</issue>
        <fpage>1253</fpage>
        <lpage>1260</lpage>
        <pub-id pub-id-type="doi">10.1038/ejhg.2017.130</pub-id>
        <pub-id pub-id-type="other">2-s2.0-85031308203</pub-id>
        <?supplied-pmid 28832569?>
        <pub-id pub-id-type="pmid">28832569</pub-id>
      </element-citation>
    </ref>
    <ref id="B9">
      <label>9</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McKenna</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Hanna</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Banks</surname>
            <given-names>E.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>
        <source>
          <italic toggle="yes">Genome Research</italic>
        </source>
        <year>2010</year>
        <volume>20</volume>
        <issue>9</issue>
        <fpage>1297</fpage>
        <lpage>1303</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>
        <pub-id pub-id-type="other">2-s2.0-77956295988</pub-id>
        <?supplied-pmid 20644199?>
        <pub-id pub-id-type="pmid">20644199</pub-id>
      </element-citation>
    </ref>
    <ref id="B10">
      <label>10</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yi</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Zhao</surname>
            <given-names>Y.</given-names>
          </name>
          <name>
            <surname>Jia</surname>
            <given-names>L.</given-names>
          </name>
          <name>
            <surname>He</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Kebebew</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Stephens</surname>
            <given-names>R. M.</given-names>
          </name>
        </person-group>
        <article-title>Performance comparison of SNP detection tools with illumina exome sequencing data—an assessment using both family pedigree information and sample-matched SNP array data</article-title>
        <source>
          <italic toggle="yes">Nucleic Acids Research</italic>
        </source>
        <year>2014</year>
        <volume>42</volume>
        <issue>12</issue>
        <fpage>e101</fpage>
        <lpage>e101</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku392</pub-id>
        <pub-id pub-id-type="other">2-s2.0-84904006298</pub-id>
        <?supplied-pmid 24831545?>
        <pub-id pub-id-type="pmid">24831545</pub-id>
      </element-citation>
    </ref>
    <ref id="B11">
      <label>11</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hwang</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Kim</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>I.</given-names>
          </name>
          <name>
            <surname>Marcotte</surname>
            <given-names>E. M.</given-names>
          </name>
        </person-group>
        <article-title>Systematic comparison of variant calling pipelines using gold standard personal exome variants</article-title>
        <source>
          <italic toggle="yes">Scientific Reports</italic>
        </source>
        <year>2015</year>
        <volume>5</volume>
        <issue>1, article 17875</issue>
        <pub-id pub-id-type="doi">10.1038/srep17875</pub-id>
        <pub-id pub-id-type="other">2-s2.0-84949591330</pub-id>
      </element-citation>
    </ref>
    <ref id="B12">
      <label>12</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Consortium</surname>
            <given-names>G. P.</given-names>
          </name>
        </person-group>
        <article-title>A map of human genome variation from population-scale sequencing</article-title>
        <source>
          <italic toggle="yes">Nature</italic>
        </source>
        <year>2010</year>
        <volume>467</volume>
        <issue>7319</issue>
        <fpage>1061</fpage>
        <lpage>1073</lpage>
        <pub-id pub-id-type="doi">10.1038/nature09534</pub-id>
        <pub-id pub-id-type="other">2-s2.0-84975742565</pub-id>
        <?supplied-pmid 20981092?>
        <pub-id pub-id-type="pmid">20981092</pub-id>
      </element-citation>
    </ref>
    <ref id="B13">
      <label>13</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sudmant</surname>
            <given-names>P. H.</given-names>
          </name>
          <name>
            <surname>The 1000 Genomes Project Consortium</surname>
          </name>
          <name>
            <surname>Rausch</surname>
            <given-names>T.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An integrated map of structural variation in 2,504 human genomes</article-title>
        <source>
          <italic toggle="yes">Nature</italic>
        </source>
        <year>2015</year>
        <volume>526</volume>
        <issue>7571</issue>
        <fpage>75</fpage>
        <lpage>81</lpage>
        <pub-id pub-id-type="doi">10.1038/nature15394</pub-id>
        <pub-id pub-id-type="other">2-s2.0-84943182461</pub-id>
        <?supplied-pmid 26432246?>
        <pub-id pub-id-type="pmid">26432246</pub-id>
      </element-citation>
    </ref>
    <ref id="B14">
      <label>14</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Collins</surname>
            <given-names>R. L.</given-names>
          </name>
          <name>
            <surname>Genome Aggregation Database Production Team</surname>
          </name>
          <name>
            <surname>Brand</surname>
            <given-names>H.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>An open resource of structural variation for medical and population genetics</article-title>
        <source>
          <italic toggle="yes">Nature</italic>
        </source>
        <year>2020</year>
        <volume>581</volume>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2287-8</pub-id>
      </element-citation>
    </ref>
    <ref id="B15">
      <label>15</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Karczewski</surname>
            <given-names>K. J.</given-names>
          </name>
          <name>
            <surname>Genome Aggregation Database Consortium</surname>
          </name>
          <name>
            <surname>Francioli</surname>
            <given-names>L. C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Variation across 141,456 human exomes and genomes reveals the spectrum of loss-of-function intolerance across human protein-coding genes</article-title>
        <source>
          <italic toggle="yes">Nature</italic>
        </source>
        <year>2020</year>
        <volume>581</volume>
        <fpage>434</fpage>
        <lpage>443</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-020-2308-7</pub-id>
        <pub-id pub-id-type="pmid">32461654</pub-id>
      </element-citation>
    </ref>
    <ref id="B16">
      <label>16</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Supernat</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>Vidarsson</surname>
            <given-names>O. V.</given-names>
          </name>
          <name>
            <surname>Steen</surname>
            <given-names>V. M.</given-names>
          </name>
          <name>
            <surname>Stokowy</surname>
            <given-names>T.</given-names>
          </name>
        </person-group>
        <article-title>Comparison of three variant callers for human whole genome sequencing</article-title>
        <source>
          <italic toggle="yes">Scientific Reports</italic>
        </source>
        <year>2018</year>
        <volume>8</volume>
        <issue>1</issue>
        <fpage>17851</fpage>
        <lpage>17851</lpage>
        <pub-id pub-id-type="doi">10.1038/s41598-018-36177-7</pub-id>
        <pub-id pub-id-type="other">2-s2.0-85058642158</pub-id>
        <?supplied-pmid 30552369?>
        <pub-id pub-id-type="pmid">30552369</pub-id>
      </element-citation>
    </ref>
    <ref id="B17">
      <label>17</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Singh</surname>
            <given-names>N. K.</given-names>
          </name>
          <name>
            <surname>Thakur</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Chaurasiya</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Nagdev</surname>
            <given-names>H.</given-names>
          </name>
        </person-group>
        <article-title>Automated provisioning of application in IAAS cloud using Ansible configuration management</article-title>
        <conf-name>2015 1st International Conference on Next Generation Computing Technologies (NGCT)</conf-name>
        <conf-date>2015</conf-date>
        <conf-loc>Dehradun, India</conf-loc>
        <fpage>81</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1109/NGCT.2015.7375087</pub-id>
        <pub-id pub-id-type="other">2-s2.0-84964555269</pub-id>
      </element-citation>
    </ref>
    <ref id="B18">
      <label>18</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zaharia</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Xin</surname>
            <given-names>R. S.</given-names>
          </name>
          <name>
            <surname>Wendell</surname>
            <given-names>P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Apache Spark</article-title>
        <source>
          <italic toggle="yes">Communications of the ACM</italic>
        </source>
        <year>2016</year>
        <volume>59</volume>
        <issue>11</issue>
        <fpage>56</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1145/2934664</pub-id>
        <pub-id pub-id-type="other">2-s2.0-84994589486</pub-id>
      </element-citation>
    </ref>
    <ref id="B19">
      <label>19</label>
      <element-citation publication-type="confproc">
        <person-group person-group-type="author">
          <name>
            <surname>Shvachko</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Kuang</surname>
            <given-names>H.</given-names>
          </name>
          <name>
            <surname>Radia</surname>
            <given-names>S.</given-names>
          </name>
          <name>
            <surname>Chansler</surname>
            <given-names>R.</given-names>
          </name>
        </person-group>
        <article-title>The hadoop distributed file system</article-title>
        <conf-name>2010 IEEE 26th Symposium on Mass Storage Systems and Technologies (MSST).</conf-name>
        <conf-date>2010</conf-date>
        <conf-loc>Incline Village, NV, USA</conf-loc>
        <fpage>1</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1109/MSST.2010.5496972</pub-id>
        <pub-id pub-id-type="other">2-s2.0-77957838299</pub-id>
      </element-citation>
    </ref>
    <ref id="B20">
      <label>20</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Poplin</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Chang</surname>
            <given-names>P. C.</given-names>
          </name>
          <name>
            <surname>Alexander</surname>
            <given-names>D.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A universal SNP and small-indel variant caller using deep neural networks</article-title>
        <source>
          <italic toggle="yes">Nature Biotechnology</italic>
        </source>
        <year>2018</year>
        <volume>36</volume>
        <issue>10</issue>
        <fpage>983</fpage>
        <lpage>987</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.4235</pub-id>
        <pub-id pub-id-type="other">2-s2.0-85054719134</pub-id>
        <?supplied-pmid 30247488?>
        <pub-id pub-id-type="pmid">30247488</pub-id>
      </element-citation>
    </ref>
    <ref id="B21">
      <label>21</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Massie</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Nothaft</surname>
            <given-names>F.</given-names>
          </name>
          <name>
            <surname>Hartl</surname>
            <given-names>C.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Adam: genomics formats and processing patterns for cloud scale computing</article-title>
        <year>2013</year>
        <publisher-loc>Berkeley, CA, USA</publisher-loc>
        <publisher-name>Tech. Rep. UCB/EECS-2013 Electrical Engineering and Computer SciencesUniversity of California at Berkeley</publisher-name>
      </element-citation>
    </ref>
    <ref id="B22">
      <label>22</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Okonechnikov</surname>
            <given-names>K.</given-names>
          </name>
          <name>
            <surname>Conesa</surname>
            <given-names>A.</given-names>
          </name>
          <name>
            <surname>García-Alcalde</surname>
            <given-names>F.</given-names>
          </name>
        </person-group>
        <article-title>Qualimap 2: advanced multi-sample quality control for high-throughput sequencing data</article-title>
        <source>
          <italic toggle="yes">Bioinformatics</italic>
        </source>
        <year>2015</year>
        <volume>32</volume>
        <issue>2</issue>
        <fpage>292</fpage>
        <lpage>294</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv566</pub-id>
        <pub-id pub-id-type="other">2-s2.0-84959932296</pub-id>
        <pub-id pub-id-type="pmid">26428292</pub-id>
      </element-citation>
    </ref>
    <ref id="B23">
      <label>23</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zook</surname>
            <given-names>J. M.</given-names>
          </name>
          <name>
            <surname>Chapman</surname>
            <given-names>B.</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title> <italic>Integrating human sequence data sets provides a resource of benchmark SNP and indel genotype calls</italic></article-title>
        <source>
          <italic toggle="yes">Nature Biotechnology</italic>
        </source>
        <year>2014</year>
        <volume>32</volume>
        <issue>3</issue>
        <fpage>246</fpage>
        <lpage>251</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.2835</pub-id>
        <pub-id pub-id-type="other">2-s2.0-84897387657</pub-id>
      </element-citation>
    </ref>
    <ref id="B24">
      <label>24</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eberle</surname>
            <given-names>M. A.</given-names>
          </name>
          <name>
            <surname>Fritzilas</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Krusche</surname>
            <given-names>P.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A reference data set of 5.4 million phased human variants validated by genetic inheritance from sequencing a three-generation 17-member pedigree</article-title>
        <source>
          <italic toggle="yes">Genome Research</italic>
        </source>
        <year>2017</year>
        <volume>27</volume>
        <issue>1</issue>
        <fpage>157</fpage>
        <lpage>164</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.210500.116</pub-id>
        <pub-id pub-id-type="other">2-s2.0-85009151993</pub-id>
        <?supplied-pmid 27903644?>
        <pub-id pub-id-type="pmid">27903644</pub-id>
      </element-citation>
    </ref>
    <ref id="B25">
      <label>25</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Cleary</surname>
            <given-names>J. G.</given-names>
          </name>
          <name>
            <surname>Braithwaite</surname>
            <given-names>R.</given-names>
          </name>
          <name>
            <surname>Gaastra</surname>
            <given-names>K.</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comparing variant call files for performance benchmarking of next-generation sequencing variant calling pipelines</article-title>
        <source>
          <italic toggle="yes">BioRxiv</italic>
        </source>
        <year>2015</year>
        <pub-id pub-id-type="doi">10.1101/023754</pub-id>
      </element-citation>
    </ref>
    <ref id="B26">
      <label>26</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Di Tommaso</surname>
            <given-names>P.</given-names>
          </name>
          <name>
            <surname>Chatzou</surname>
            <given-names>M.</given-names>
          </name>
          <name>
            <surname>Floden</surname>
            <given-names>E. W.</given-names>
          </name>
          <name>
            <surname>Barja</surname>
            <given-names>P. P.</given-names>
          </name>
          <name>
            <surname>Palumbo</surname>
            <given-names>E.</given-names>
          </name>
          <name>
            <surname>Notredame</surname>
            <given-names>C.</given-names>
          </name>
        </person-group>
        <article-title>Nextflow enables reproducible computational. Workflows</article-title>
        <source>
          <italic toggle="yes">Nature Biotechnology</italic>
        </source>
        <year>2017</year>
        <volume>35</volume>
        <issue>4</issue>
        <fpage>316</fpage>
        <lpage>319</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.3820</pub-id>
        <pub-id pub-id-type="other">2-s2.0-85017333736</pub-id>
        <?supplied-pmid 28398311?>
        <pub-id pub-id-type="pmid">28398311</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
<floats-group>
  <fig id="fig1" orientation="portrait" position="float">
    <label>Figure 1</label>
    <caption>
      <p>Framework of DeepVaraint-on-Spark. DeepVariant-on-Spark is based on the Google Dataproc service. After importing the BAM file into the DeepVariant-on-Spark cluster, the BAM file will be segmented into several 1 Mbp blocks in the “Adam Transform” step, and these blocks will be merged into 155 small BAM files in the “Select BAM” step. The 1 Mbp blocks and small BAM files are stored in the HDFS. PiedPiper will pipe the path of each BAM file to SeqPiper, which launches DeepVariant to produce the VCF file. Finally, in the “Merge VCFs” steps, each VCF file will be merged into a complete VCF file.</p>
    </caption>
    <graphic xlink:href="CMMM2020-7231205.001"/>
  </fig>
  <fig id="fig2" orientation="portrait" position="float">
    <label>Figure 2</label>
    <caption>
      <p>Wall-clock time and speedup of DeepVariant and DeepVariant-on-Spark with different combinations of CPU/GPU. Runtime comparison of DeepVariant and DeepVariant-on-Spark with different combinations of CPU/GPU. (a) DeepVariant runs on the pure CPU machine. (b) DeepVariant runs on the CPU/GPU hybrid machine. (c) DeepVariant-on-Spark runs on the pure CPU cluster. (d) DeepVariant-on-Spark runs on the CPU/GPU hybrid cluster. AdamTransform, SelectBAM, Make_Examples, Call_Variants, Postprocess_Variants, and Merge VCF represent each step in DeepVariant or DeepVariant-on-Spark. Speedup represents how many times each condition is faster than DeepVariant's (16 CPU) mode. The speed improvement of DeepVariant-on-Spark over DeepVariant is provided above. DeepVariant-on-Spark using 128-CPU and 8-GPU configurations improved the wall-clock time by 11.58x compared to DeepVariant using 16 CPUs.</p>
    </caption>
    <graphic xlink:href="CMMM2020-7231205.002"/>
  </fig>
  <table-wrap id="tab1" orientation="portrait" position="float">
    <label>Table 1</label>
    <caption>
      <p>Comparison of variant calling results of DeepVariant and DeepVariant-on-Spark with different combinations of CPUs/GPUs.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="left" rowspan="1" colspan="1">Variant calling pipeline</th>
          <th align="center" rowspan="1" colspan="1">Variant type</th>
          <th align="center" rowspan="1" colspan="1">CPU<sup>a</sup></th>
          <th align="center" rowspan="1" colspan="1">GPU<sup>b</sup></th>
          <th align="center" rowspan="1" colspan="1">F1<sup>c</sup></th>
          <th align="center" rowspan="1" colspan="1">Recall</th>
          <th align="center" rowspan="1" colspan="1">Precision</th>
          <th align="center" rowspan="1" colspan="1">True positive</th>
          <th align="center" rowspan="1" colspan="1">False negative</th>
          <th align="center" rowspan="1" colspan="1">False positive</th>
          <th align="center" rowspan="1" colspan="1">Genotype mismatch</th>
          <th align="center" rowspan="1" colspan="1">Total number of SNV calls</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left" rowspan="8" colspan="1">DeepVariant</td>
          <td align="center" rowspan="14" colspan="1">SNP</td>
          <td align="center" rowspan="1" colspan="1">16</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.99940</td>
          <td align="center" rowspan="1" colspan="1">0.99937</td>
          <td align="center" rowspan="1" colspan="1">0.99943</td>
          <td align="center" rowspan="1" colspan="1">3040855</td>
          <td align="center" rowspan="1" colspan="1">1928</td>
          <td align="center" rowspan="1" colspan="1">1744</td>
          <td align="center" rowspan="1" colspan="1">363</td>
          <td align="center" rowspan="1" colspan="1">3886287</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">32</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.99940</td>
          <td align="center" rowspan="1" colspan="1">0.99937</td>
          <td align="center" rowspan="1" colspan="1">0.99943</td>
          <td align="center" rowspan="1" colspan="1">3040856</td>
          <td align="center" rowspan="1" colspan="1">1927</td>
          <td align="center" rowspan="1" colspan="1">1744</td>
          <td align="center" rowspan="1" colspan="1">363</td>
          <td align="center" rowspan="1" colspan="1">3886337</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">64</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.99940</td>
          <td align="center" rowspan="1" colspan="1">0.99937</td>
          <td align="center" rowspan="1" colspan="1">0.99943</td>
          <td align="center" rowspan="1" colspan="1">3040856</td>
          <td align="center" rowspan="1" colspan="1">1927</td>
          <td align="center" rowspan="1" colspan="1">1744</td>
          <td align="center" rowspan="1" colspan="1">363</td>
          <td align="center" rowspan="1" colspan="1">3886366</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">96</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.99940</td>
          <td align="center" rowspan="1" colspan="1">0.99937</td>
          <td align="center" rowspan="1" colspan="1">0.99943</td>
          <td align="center" rowspan="1" colspan="1">3040855</td>
          <td align="center" rowspan="1" colspan="1">1928</td>
          <td align="center" rowspan="1" colspan="1">1744</td>
          <td align="center" rowspan="1" colspan="1">363</td>
          <td align="center" rowspan="1" colspan="1">3886339</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">16</td>
          <td align="center" rowspan="1" colspan="1">1</td>
          <td align="center" rowspan="1" colspan="1">0.99940</td>
          <td align="center" rowspan="1" colspan="1">0.99937</td>
          <td align="center" rowspan="1" colspan="1">0.99943</td>
          <td align="center" rowspan="1" colspan="1">3040855</td>
          <td align="center" rowspan="1" colspan="1">1928</td>
          <td align="center" rowspan="1" colspan="1">1744</td>
          <td align="center" rowspan="1" colspan="1">363</td>
          <td align="center" rowspan="1" colspan="1">3886287</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">16</td>
          <td align="center" rowspan="1" colspan="1">4</td>
          <td align="center" rowspan="1" colspan="1">0.99940</td>
          <td align="center" rowspan="1" colspan="1">0.99937</td>
          <td align="center" rowspan="1" colspan="1">0.99943</td>
          <td align="center" rowspan="1" colspan="1">3040855</td>
          <td align="center" rowspan="1" colspan="1">1928</td>
          <td align="center" rowspan="1" colspan="1">1744</td>
          <td align="center" rowspan="1" colspan="1">363</td>
          <td align="center" rowspan="1" colspan="1">3886287</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">32</td>
          <td align="center" rowspan="1" colspan="1">2</td>
          <td align="center" rowspan="1" colspan="1">0.99940</td>
          <td align="center" rowspan="1" colspan="1">0.99937</td>
          <td align="center" rowspan="1" colspan="1">0.99943</td>
          <td align="center" rowspan="1" colspan="1">3040856</td>
          <td align="center" rowspan="1" colspan="1">1927</td>
          <td align="center" rowspan="1" colspan="1">1744</td>
          <td align="center" rowspan="1" colspan="1">363</td>
          <td align="center" rowspan="1" colspan="1">3886337</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">64</td>
          <td align="center" rowspan="1" colspan="1">4</td>
          <td align="center" rowspan="1" colspan="1">0.99940</td>
          <td align="center" rowspan="1" colspan="1">0.99937</td>
          <td align="center" rowspan="1" colspan="1">0.99943</td>
          <td align="center" rowspan="1" colspan="1">3040856</td>
          <td align="center" rowspan="1" colspan="1">1927</td>
          <td align="center" rowspan="1" colspan="1">1744</td>
          <td align="center" rowspan="1" colspan="1">363</td>
          <td align="center" rowspan="1" colspan="1">3886366</td>
        </tr>
        <tr>
          <td align="left" rowspan="6" colspan="1">DeepVariant-on-Spark</td>
          <td align="center" rowspan="1" colspan="1">32</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.99940</td>
          <td align="center" rowspan="1" colspan="1">0.99937</td>
          <td align="center" rowspan="1" colspan="1">0.99943</td>
          <td align="center" rowspan="1" colspan="1">3040856</td>
          <td align="center" rowspan="1" colspan="1">1927</td>
          <td align="center" rowspan="1" colspan="1">1744</td>
          <td align="center" rowspan="1" colspan="1">363</td>
          <td align="center" rowspan="1" colspan="1">3886403</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">64</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.99940</td>
          <td align="center" rowspan="1" colspan="1">0.99937</td>
          <td align="center" rowspan="1" colspan="1">0.99943</td>
          <td align="center" rowspan="1" colspan="1">3040856</td>
          <td align="center" rowspan="1" colspan="1">1927</td>
          <td align="center" rowspan="1" colspan="1">1744</td>
          <td align="center" rowspan="1" colspan="1">363</td>
          <td align="center" rowspan="1" colspan="1">3886403</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">128</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.99940</td>
          <td align="center" rowspan="1" colspan="1">0.99937</td>
          <td align="center" rowspan="1" colspan="1">0.99943</td>
          <td align="center" rowspan="1" colspan="1">3040856</td>
          <td align="center" rowspan="1" colspan="1">1927</td>
          <td align="center" rowspan="1" colspan="1">1744</td>
          <td align="center" rowspan="1" colspan="1">363</td>
          <td align="center" rowspan="1" colspan="1">3886403</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">32</td>
          <td align="center" rowspan="1" colspan="1">2</td>
          <td align="center" rowspan="1" colspan="1">0.99940</td>
          <td align="center" rowspan="1" colspan="1">0.99937</td>
          <td align="center" rowspan="1" colspan="1">0.99943</td>
          <td align="center" rowspan="1" colspan="1">3040856</td>
          <td align="center" rowspan="1" colspan="1">1927</td>
          <td align="center" rowspan="1" colspan="1">1744</td>
          <td align="center" rowspan="1" colspan="1">363</td>
          <td align="center" rowspan="1" colspan="1">3886403</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">64</td>
          <td align="center" rowspan="1" colspan="1">4</td>
          <td align="center" rowspan="1" colspan="1">0.99940</td>
          <td align="center" rowspan="1" colspan="1">0.99937</td>
          <td align="center" rowspan="1" colspan="1">0.99943</td>
          <td align="center" rowspan="1" colspan="1">3040856</td>
          <td align="center" rowspan="1" colspan="1">1927</td>
          <td align="center" rowspan="1" colspan="1">1744</td>
          <td align="center" rowspan="1" colspan="1">363</td>
          <td align="center" rowspan="1" colspan="1">3886404</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">128</td>
          <td align="center" rowspan="1" colspan="1">8</td>
          <td align="center" rowspan="1" colspan="1">0.99940</td>
          <td align="center" rowspan="1" colspan="1">0.99937</td>
          <td align="center" rowspan="1" colspan="1">0.99943</td>
          <td align="center" rowspan="1" colspan="1">3040856</td>
          <td align="center" rowspan="1" colspan="1">1927</td>
          <td align="center" rowspan="1" colspan="1">1744</td>
          <td align="center" rowspan="1" colspan="1">363</td>
          <td align="center" rowspan="1" colspan="1">3886403</td>
        </tr>
        <tr>
          <td align="center" colspan="12" rowspan="1">
            <hr/>
          </td>
        </tr>
        <tr>
          <td align="left" rowspan="8" colspan="1">DeepVariant</td>
          <td align="center" rowspan="14" colspan="1">Indel</td>
          <td align="center" rowspan="1" colspan="1">16</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.96168</td>
          <td align="center" rowspan="1" colspan="1">0.95711</td>
          <td align="center" rowspan="1" colspan="1">0.96628</td>
          <td align="center" rowspan="1" colspan="1">478265</td>
          <td align="center" rowspan="1" colspan="1">21432</td>
          <td align="center" rowspan="1" colspan="1">17373</td>
          <td align="center" rowspan="1" colspan="1">11151</td>
          <td align="center" rowspan="1" colspan="1">868527</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">32</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.96168</td>
          <td align="center" rowspan="1" colspan="1">0.95711</td>
          <td align="center" rowspan="1" colspan="1">0.96628</td>
          <td align="center" rowspan="1" colspan="1">478265</td>
          <td align="center" rowspan="1" colspan="1">21432</td>
          <td align="center" rowspan="1" colspan="1">17373</td>
          <td align="center" rowspan="1" colspan="1">11151</td>
          <td align="center" rowspan="1" colspan="1">868535</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">64</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.96168</td>
          <td align="center" rowspan="1" colspan="1">0.95711</td>
          <td align="center" rowspan="1" colspan="1">0.96628</td>
          <td align="center" rowspan="1" colspan="1">478265</td>
          <td align="center" rowspan="1" colspan="1">21432</td>
          <td align="center" rowspan="1" colspan="1">17373</td>
          <td align="center" rowspan="1" colspan="1">11151</td>
          <td align="center" rowspan="1" colspan="1">868520</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">96</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.96168</td>
          <td align="center" rowspan="1" colspan="1">0.95711</td>
          <td align="center" rowspan="1" colspan="1">0.96628</td>
          <td align="center" rowspan="1" colspan="1">478265</td>
          <td align="center" rowspan="1" colspan="1">21432</td>
          <td align="center" rowspan="1" colspan="1">17373</td>
          <td align="center" rowspan="1" colspan="1">11151</td>
          <td align="center" rowspan="1" colspan="1">868535</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">16</td>
          <td align="center" rowspan="1" colspan="1">1</td>
          <td align="center" rowspan="1" colspan="1">0.96168</td>
          <td align="center" rowspan="1" colspan="1">0.95711</td>
          <td align="center" rowspan="1" colspan="1">0.96628</td>
          <td align="center" rowspan="1" colspan="1">478265</td>
          <td align="center" rowspan="1" colspan="1">21432</td>
          <td align="center" rowspan="1" colspan="1">17373</td>
          <td align="center" rowspan="1" colspan="1">11151</td>
          <td align="center" rowspan="1" colspan="1">868527</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">16</td>
          <td align="center" rowspan="1" colspan="1">4</td>
          <td align="center" rowspan="1" colspan="1">0.96168</td>
          <td align="center" rowspan="1" colspan="1">0.95711</td>
          <td align="center" rowspan="1" colspan="1">0.96628</td>
          <td align="center" rowspan="1" colspan="1">478265</td>
          <td align="center" rowspan="1" colspan="1">21432</td>
          <td align="center" rowspan="1" colspan="1">17373</td>
          <td align="center" rowspan="1" colspan="1">11151</td>
          <td align="center" rowspan="1" colspan="1">868528</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">32</td>
          <td align="center" rowspan="1" colspan="1">2</td>
          <td align="center" rowspan="1" colspan="1">0.96168</td>
          <td align="center" rowspan="1" colspan="1">0.95711</td>
          <td align="center" rowspan="1" colspan="1">0.96628</td>
          <td align="center" rowspan="1" colspan="1">478265</td>
          <td align="center" rowspan="1" colspan="1">21432</td>
          <td align="center" rowspan="1" colspan="1">17373</td>
          <td align="center" rowspan="1" colspan="1">11151</td>
          <td align="center" rowspan="1" colspan="1">868535</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">64</td>
          <td align="center" rowspan="1" colspan="1">4</td>
          <td align="center" rowspan="1" colspan="1">0.96168</td>
          <td align="center" rowspan="1" colspan="1">0.95711</td>
          <td align="center" rowspan="1" colspan="1">0.96628</td>
          <td align="center" rowspan="1" colspan="1">478265</td>
          <td align="center" rowspan="1" colspan="1">21432</td>
          <td align="center" rowspan="1" colspan="1">17373</td>
          <td align="center" rowspan="1" colspan="1">11151</td>
          <td align="center" rowspan="1" colspan="1">868520</td>
        </tr>
        <tr>
          <td align="left" rowspan="6" colspan="1">DeepVariant-on-Spark</td>
          <td align="center" rowspan="1" colspan="1">32</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.96168</td>
          <td align="center" rowspan="1" colspan="1">0.95711</td>
          <td align="center" rowspan="1" colspan="1">0.96628</td>
          <td align="center" rowspan="1" colspan="1">478265</td>
          <td align="center" rowspan="1" colspan="1">21432</td>
          <td align="center" rowspan="1" colspan="1">17373</td>
          <td align="center" rowspan="1" colspan="1">11151</td>
          <td align="center" rowspan="1" colspan="1">868541</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">64</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.96168</td>
          <td align="center" rowspan="1" colspan="1">0.95711</td>
          <td align="center" rowspan="1" colspan="1">0.96628</td>
          <td align="center" rowspan="1" colspan="1">478265</td>
          <td align="center" rowspan="1" colspan="1">21432</td>
          <td align="center" rowspan="1" colspan="1">17373</td>
          <td align="center" rowspan="1" colspan="1">11151</td>
          <td align="center" rowspan="1" colspan="1">868541</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">128</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.96168</td>
          <td align="center" rowspan="1" colspan="1">0.95711</td>
          <td align="center" rowspan="1" colspan="1">0.96628</td>
          <td align="center" rowspan="1" colspan="1">478265</td>
          <td align="center" rowspan="1" colspan="1">21432</td>
          <td align="center" rowspan="1" colspan="1">17373</td>
          <td align="center" rowspan="1" colspan="1">11151</td>
          <td align="center" rowspan="1" colspan="1">868541</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">32</td>
          <td align="center" rowspan="1" colspan="1">2</td>
          <td align="center" rowspan="1" colspan="1">0.96168</td>
          <td align="center" rowspan="1" colspan="1">0.95711</td>
          <td align="center" rowspan="1" colspan="1">0.96628</td>
          <td align="center" rowspan="1" colspan="1">478265</td>
          <td align="center" rowspan="1" colspan="1">21432</td>
          <td align="center" rowspan="1" colspan="1">17373</td>
          <td align="center" rowspan="1" colspan="1">11151</td>
          <td align="center" rowspan="1" colspan="1">868542</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">64</td>
          <td align="center" rowspan="1" colspan="1">4</td>
          <td align="center" rowspan="1" colspan="1">0.96168</td>
          <td align="center" rowspan="1" colspan="1">0.95711</td>
          <td align="center" rowspan="1" colspan="1">0.96628</td>
          <td align="center" rowspan="1" colspan="1">478265</td>
          <td align="center" rowspan="1" colspan="1">21432</td>
          <td align="center" rowspan="1" colspan="1">17373</td>
          <td align="center" rowspan="1" colspan="1">11151</td>
          <td align="center" rowspan="1" colspan="1">868542</td>
        </tr>
        <tr>
          <td align="center" rowspan="1" colspan="1">128</td>
          <td align="center" rowspan="1" colspan="1">8</td>
          <td align="center" rowspan="1" colspan="1">0.96168</td>
          <td align="center" rowspan="1" colspan="1">0.95711</td>
          <td align="center" rowspan="1" colspan="1">0.96628</td>
          <td align="center" rowspan="1" colspan="1">478265</td>
          <td align="center" rowspan="1" colspan="1">21432</td>
          <td align="center" rowspan="1" colspan="1">17373</td>
          <td align="center" rowspan="1" colspan="1">11151</td>
          <td align="center" rowspan="1" colspan="1">868541</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn>
        <p><sup>a</sup>CPU means the number of CPU cores. <sup>b</sup>GPU means the number of NVIDIA Tesla P100 GPUs. <sup>c</sup>F1 means F1 score calculated by 2∗(recall∗precision)/(recall + precision).</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
  <table-wrap id="tab2" orientation="portrait" position="float">
    <label>Table 2</label>
    <caption>
      <p>Comparison of the wall-clock time of DeepVariant and DeepVariant-on-Spark with different combinations of CPUs/GPUs.</p>
    </caption>
    <table frame="hsides" rules="groups">
      <thead>
        <tr>
          <th align="left" rowspan="1" colspan="1">Variant caller</th>
          <th align="center" colspan="7" rowspan="1">DeepVariant</th>
          <th align="center" colspan="6" rowspan="1">DeepVariant-on-Spark</th>
        </tr>
        <tr>
          <th align="left" rowspan="1" colspan="1">Machine model</th>
          <th align="center" colspan="4" rowspan="1">CPU only</th>
          <th align="center" colspan="3" rowspan="1">CPU+GPU</th>
          <th align="center" colspan="3" rowspan="1">CPU only</th>
          <th align="center" colspan="3" rowspan="1">CPU+GPU</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td align="left" rowspan="1" colspan="1">CPU<sup>a</sup></td>
          <td align="center" rowspan="1" colspan="1">16</td>
          <td align="center" rowspan="1" colspan="1">32</td>
          <td align="center" rowspan="1" colspan="1">64</td>
          <td align="center" rowspan="1" colspan="1">96</td>
          <td align="center" rowspan="1" colspan="1">16</td>
          <td align="center" rowspan="1" colspan="1">32</td>
          <td align="center" rowspan="1" colspan="1">64</td>
          <td align="center" rowspan="1" colspan="1">32</td>
          <td align="center" rowspan="1" colspan="1">64</td>
          <td align="center" rowspan="1" colspan="1">128</td>
          <td align="center" rowspan="1" colspan="1">32</td>
          <td align="center" rowspan="1" colspan="1">64</td>
          <td align="center" rowspan="1" colspan="1">128</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">GPU<sup>b</sup></td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">1</td>
          <td align="center" rowspan="1" colspan="1">2</td>
          <td align="center" rowspan="1" colspan="1">4</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">2</td>
          <td align="center" rowspan="1" colspan="1">4</td>
          <td align="center" rowspan="1" colspan="1">8</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">Spark<sup>c</sup></td>
          <td align="center" rowspan="1" colspan="1">No</td>
          <td align="center" rowspan="1" colspan="1">No</td>
          <td align="center" rowspan="1" colspan="1">No</td>
          <td align="center" rowspan="1" colspan="1">No</td>
          <td align="center" rowspan="1" colspan="1">No</td>
          <td align="center" rowspan="1" colspan="1">No</td>
          <td align="center" rowspan="1" colspan="1">No</td>
          <td align="center" rowspan="1" colspan="1">Yes</td>
          <td align="center" rowspan="1" colspan="1">Yes</td>
          <td align="center" rowspan="1" colspan="1">Yes</td>
          <td align="center" rowspan="1" colspan="1">Yes</td>
          <td align="center" rowspan="1" colspan="1">Yes</td>
          <td align="center" rowspan="1" colspan="1">Yes</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">AdamTransform (hr)</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.56</td>
          <td align="center" rowspan="1" colspan="1">0.32</td>
          <td align="center" rowspan="1" colspan="1">0.2</td>
          <td align="center" rowspan="1" colspan="1">0.58</td>
          <td align="center" rowspan="1" colspan="1">0.31</td>
          <td align="center" rowspan="1" colspan="1">0.2</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">SelectBAM (hr)</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.5</td>
          <td align="center" rowspan="1" colspan="1">0.33</td>
          <td align="center" rowspan="1" colspan="1">0.23</td>
          <td align="center" rowspan="1" colspan="1">0.48</td>
          <td align="center" rowspan="1" colspan="1">0.29</td>
          <td align="center" rowspan="1" colspan="1">0.2</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">Make_examples (hr)</td>
          <td align="center" rowspan="1" colspan="1">6.13</td>
          <td align="center" rowspan="1" colspan="1">3.15</td>
          <td align="center" rowspan="1" colspan="1">1.73</td>
          <td align="center" rowspan="1" colspan="1">1.2</td>
          <td align="center" rowspan="1" colspan="1">5.93</td>
          <td align="center" rowspan="1" colspan="1">3.1</td>
          <td align="center" rowspan="1" colspan="1">1.6</td>
          <td align="center" rowspan="1" colspan="1">2.72</td>
          <td align="center" rowspan="1" colspan="1">1.6</td>
          <td align="center" rowspan="1" colspan="1">1</td>
          <td align="center" rowspan="1" colspan="1">2.82</td>
          <td align="center" rowspan="1" colspan="1">1.48</td>
          <td align="center" rowspan="1" colspan="1">0.83</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">Call_variants (hr)</td>
          <td align="center" rowspan="1" colspan="1">10.8</td>
          <td align="center" rowspan="1" colspan="1">6.53</td>
          <td align="center" rowspan="1" colspan="1">5.35</td>
          <td align="center" rowspan="1" colspan="1">3.83</td>
          <td align="center" rowspan="1" colspan="1">1.51</td>
          <td align="center" rowspan="1" colspan="1">1.52</td>
          <td align="center" rowspan="1" colspan="1">1.5</td>
          <td align="center" rowspan="1" colspan="1">3.66</td>
          <td align="center" rowspan="1" colspan="1">2.02</td>
          <td align="center" rowspan="1" colspan="1">0.98</td>
          <td align="center" rowspan="1" colspan="1">0.7</td>
          <td align="center" rowspan="1" colspan="1">0.38</td>
          <td align="center" rowspan="1" colspan="1">0.21</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">Postprocess_variants (hr)</td>
          <td align="center" rowspan="1" colspan="1">0.56</td>
          <td align="center" rowspan="1" colspan="1">0.54</td>
          <td align="center" rowspan="1" colspan="1">0.53</td>
          <td align="center" rowspan="1" colspan="1">0.48</td>
          <td align="center" rowspan="1" colspan="1">0.46</td>
          <td align="center" rowspan="1" colspan="1">0.46</td>
          <td align="center" rowspan="1" colspan="1">0.45</td>
          <td align="center" rowspan="1" colspan="1">0.2</td>
          <td align="center" rowspan="1" colspan="1">0.13</td>
          <td align="center" rowspan="1" colspan="1">0.07</td>
          <td align="center" rowspan="1" colspan="1">0.2</td>
          <td align="center" rowspan="1" colspan="1">0.1</td>
          <td align="center" rowspan="1" colspan="1">0.06</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">Merge VCF (hr)</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0</td>
          <td align="center" rowspan="1" colspan="1">0.02</td>
          <td align="center" rowspan="1" colspan="1">0.02</td>
          <td align="center" rowspan="1" colspan="1">0.02</td>
          <td align="center" rowspan="1" colspan="1">0.02</td>
          <td align="center" rowspan="1" colspan="1">0.02</td>
          <td align="center" rowspan="1" colspan="1">0.02</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">Total time (hr)</td>
          <td align="center" rowspan="1" colspan="1">17.49</td>
          <td align="center" rowspan="1" colspan="1">10.22</td>
          <td align="center" rowspan="1" colspan="1">7.61</td>
          <td align="center" rowspan="1" colspan="1">5.51</td>
          <td align="center" rowspan="1" colspan="1">7.9</td>
          <td align="center" rowspan="1" colspan="1">5.08</td>
          <td align="center" rowspan="1" colspan="1">3.55</td>
          <td align="center" rowspan="1" colspan="1">7.66</td>
          <td align="center" rowspan="1" colspan="1">4.42</td>
          <td align="center" rowspan="1" colspan="1">2.5</td>
          <td align="center" rowspan="1" colspan="1">4.8</td>
          <td align="center" rowspan="1" colspan="1">2.58</td>
          <td align="center" rowspan="1" colspan="1">1.52</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">USD/per genome</td>
          <td align="center" rowspan="1" colspan="1">14.02</td>
          <td align="center" rowspan="1" colspan="1">15.94</td>
          <td align="center" rowspan="1" colspan="1">20.77</td>
          <td align="center" rowspan="1" colspan="1">25.31</td>
          <td align="center" rowspan="1" colspan="1">17.86</td>
          <td align="center" rowspan="1" colspan="1">22.72</td>
          <td align="center" rowspan="1" colspan="1">31.76</td>
          <td align="center" rowspan="1" colspan="1">23.25</td>
          <td align="center" rowspan="1" colspan="1">23.98</td>
          <td align="center" rowspan="1" colspan="1">25.54</td>
          <td align="center" rowspan="1" colspan="1">28.57</td>
          <td align="center" rowspan="1" colspan="1">29.23</td>
          <td align="center" rowspan="1" colspan="1">33.17</td>
        </tr>
        <tr>
          <td align="left" rowspan="1" colspan="1">#genomes/300USD<sup>d</sup></td>
          <td align="center" rowspan="1" colspan="1">21</td>
          <td align="center" rowspan="1" colspan="1">18</td>
          <td align="center" rowspan="1" colspan="1">14</td>
          <td align="center" rowspan="1" colspan="1">11</td>
          <td align="center" rowspan="1" colspan="1">16</td>
          <td align="center" rowspan="1" colspan="1">13</td>
          <td align="center" rowspan="1" colspan="1">9</td>
          <td align="center" rowspan="1" colspan="1">12</td>
          <td align="center" rowspan="1" colspan="1">12</td>
          <td align="center" rowspan="1" colspan="1">11</td>
          <td align="center" rowspan="1" colspan="1">10</td>
          <td align="center" rowspan="1" colspan="1">10</td>
          <td align="center" rowspan="1" colspan="1">9</td>
        </tr>
      </tbody>
    </table>
    <table-wrap-foot>
      <fn>
        <p><sup>a</sup>CPU means the number of CPU cores. <sup>b</sup>GPU means the number of NVIDIA Tesla P100 GPU. <sup>c</sup>Spark means using Apache Spark or not. <sup>d</sup>#genomes/300USD means the numbers of whole-genome sequence jobs that can be completed under the trial credit of 300 USD.</p>
      </fn>
    </table-wrap-foot>
  </table-wrap>
</floats-group>
