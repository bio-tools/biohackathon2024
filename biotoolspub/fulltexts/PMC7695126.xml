<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7695126</article-id>
    <article-id pub-id-type="pmid">32637989</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btaa588</article-id>
    <article-id pub-id-type="publisher-id">btaa588</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TreeSAPP: the Tree-based Sensitive and Accurate Phylogenetic Profiler</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0002-6714-0898</contrib-id>
        <name>
          <surname>Morgan-Lang</surname>
          <given-names>Connor</given-names>
        </name>
        <aff><institution>Graduate Program in Bioinformatics, University of British Columbia, Genome Sciences Centre</institution>, Vancouver, British Columbia V5Z 4S6, <country country="CA">Canada</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>McLaughlin</surname>
          <given-names>Ryan</given-names>
        </name>
        <aff><institution>Graduate Program in Bioinformatics, University of British Columbia, Genome Sciences Centre</institution>, Vancouver, British Columbia V5Z 4S6, <country country="CA">Canada</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Armstrong</surname>
          <given-names>Zachary</given-names>
        </name>
        <aff><institution>Genome Science and Technology Program, University of British Columbia</institution>, Vancouver, BC V6T 1Z4, <country country="CA">Canada</country></aff>
        <xref rid="btaa588-cor2" ref-type="corresp"/>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Grace</given-names>
        </name>
        <aff><institution>Department of Electrical and Computer Engineering, University of British Columbia</institution>, Vancouver BC V6T 1Z4, <country country="CA">Canada</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Chan</surname>
          <given-names>Kevin</given-names>
        </name>
        <aff><institution>Department of Electrical and Computer Engineering, University of British Columbia</institution>, Vancouver BC V6T 1Z4, <country country="CA">Canada</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Hallam</surname>
          <given-names>Steven J</given-names>
        </name>
        <xref rid="btaa588-cor1" ref-type="corresp"/>
        <aff><institution>Graduate Program in Bioinformatics, University of British Columbia, Genome Sciences Centre</institution>, Vancouver, British Columbia V5Z 4S6, <country country="CA">Canada</country></aff>
        <aff><institution>Genome Science and Technology Program, University of British Columbia</institution>, Vancouver, BC V6T 1Z4, <country country="CA">Canada</country></aff>
        <aff><institution>Department of Electrical and Computer Engineering, University of British Columbia</institution>, Vancouver BC V6T 1Z4, <country country="CA">Canada</country></aff>
        <aff><institution>Department of Microbiology and Immunology, University of British Columbia</institution>, 2552-2350 Health Sciences Mall, Vancouver, British Columbia V6T 1Z3, <country country="CA">Canada</country></aff>
        <aff><institution>ECOSCOPE Training Program, University of British Columbia</institution>, Vancouver, British Columbia V6T 1Z, <country country="CA">Canada</country></aff>
        <!--shallam@mail.ubc.ca-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Elofsson</surname>
          <given-names>Arne</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="btaa588-cor1">To whom correspondence should be addressed. E-mail: <email>shallam@mail.ubc.ca</email></corresp>
      <corresp id="btaa588-cor2">Present address: Structural Biology Laboratory, Department of Chemistry, The University of York, York YO10 5DD, UK</corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>15</day>
      <month>9</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2020-07-08">
      <day>08</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>08</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <volume>36</volume>
    <issue>18</issue>
    <fpage>4706</fpage>
    <lpage>4713</lpage>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>1</month>
        <year>2020</year>
      </date>
      <date date-type="rev-recd">
        <day>11</day>
        <month>6</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>30</day>
        <month>6</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2020</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btaa588.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Microbial communities drive matter and energy transformations integral to global biogeochemical cycles, yet many taxonomic groups facilitating these processes remain poorly represented in biological sequence databases. Due to this missing information, taxonomic assignment of sequences from environmental genomes remains inaccurate.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present the Tree-based Sensitive and Accurate Phylogenetic Profiler (TreeSAPP) software for functionally and taxonomically classifying genes, reactions and pathways from genomes of cultivated and uncultivated microorganisms using reference packages representing coding sequences mediating multiple globally relevant biogeochemical cycles. TreeSAPP uses linear regression of evolutionary distance on taxonomic rank to improve classifications, assigning both closely related and divergent query sequences at the appropriate taxonomic rank. TreeSAPP is able to provide quantitative functional and taxonomic classifications for both assembled and unassembled sequences and files supporting interactive tree of life visualizations.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>TreeSAPP was developed in Python 3 as an open-source Python package and is available on GitHub at <ext-link xlink:href="https://github.com/hallamlab/TreeSAPP" ext-link-type="uri">https://github.com/hallamlab/TreeSAPP</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>US Department of Energy (DOE) Joint Genome Institute, an Office of Science User Facility</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Office of Science of the US Department of Energy</institution>
          </institution-wrap>
        </funding-source>
        <award-id>DE-AC02-05CH11231</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Facilities Integrating Collaborations for User Science (FICUS)</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>JGI</institution>
            <institution-id institution-id-type="DOI">10.13039/100015911</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>NERSC</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Natural Sciences and Engineering Research Council of Canada</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000038</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Genome British Columbia; Genome Canada</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Compute Canada</institution>
            <institution-id institution-id-type="DOI">10.13039/100013020</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Koonkie Inc</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>We live in a world dominated by prokaryotic (archaea and bacteria) microorganisms. The collective properties of this unseen majority have an enormous impact on the world, driving matter and energy transformations through networks of metabolite exchange (<xref rid="btaa588-B9" ref-type="bibr">Canfield <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btaa588-B20" ref-type="bibr">Falkowski <italic toggle="yes">et al.</italic>, 2008</xref>; <xref rid="btaa588-B26" ref-type="bibr">Hurwitz and Sullivan, 2013</xref>). Over geological time, these interactions have fundamentally transformed the surface chemistry of the earth and continue to shape elemental fluxes between atmospheric, terrestrial and aquatic compartments of the biosphere. A versatile set of functional genes that evolved early in the history of life are responsible for driving biogeochemical processes through largely defined metabolic pathways (<xref rid="btaa588-B20" ref-type="bibr">Falkowski <italic toggle="yes">et al.</italic>, 2008</xref>). Genes encoding diagnostic steps in these pathways (e.g. functional anchors) can be assembled into a phylogenetic framework that provides information on the distribution, abundance and taxonomic origin of environmental sequences. However, charting the diversity and distribution patterns of functional and taxonomic anchor genes is limited by our inability to quantitatively resolve microbial communities within a standard taxonomic hierarchy.</p>
    <p>Despite a plethora of published software (<xref rid="btaa588-B7" ref-type="bibr">Boyd <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btaa588-B8" ref-type="bibr">Buchfink <italic toggle="yes">et al.</italic>, 2015</xref>; <xref rid="btaa588-B16" ref-type="bibr">Darling <italic toggle="yes">et al.</italic>, 2014</xref>), taxonomic assignment remains an unsolved problem (<xref rid="btaa588-B49" ref-type="bibr">Peabody <italic toggle="yes">et al.</italic>, 2015</xref>). Many factors must be considered when interpreting taxonomic profiles but perhaps the most vexing are legacy misclassifications in biological sequence databases, which are particularly difficult to predict and fix (<xref rid="btaa588-B33" ref-type="bibr">Kozlov <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa588-B42" ref-type="bibr">Merchant <italic toggle="yes">et al.</italic>, 2014</xref>; <xref rid="btaa588-B44" ref-type="bibr">Nasko <italic toggle="yes">et al.</italic>, 2018</xref>). The potential for misclassification is exacerbated by the recent inclusion of composite metagenome-assembled genomes (MAGs) in such databases (<xref rid="btaa588-B55" ref-type="bibr">Shaiber and Eren, 2019</xref>). Moreover, despite enormous progress in high-throughput cultivation (<xref rid="btaa588-B14" ref-type="bibr">Cross <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa588-B45" ref-type="bibr">Nichols <italic toggle="yes">et al.</italic>, 2010</xref>) the majority of microorganisms from natural and engineered environments remain to be isolated in a laboratory setting (<xref rid="btaa588-B51" ref-type="bibr">Rappé and Giovannoni, 2003</xref>; <xref rid="btaa588-B56" ref-type="bibr">Solden <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa588-B60" ref-type="bibr">Steen <italic toggle="yes">et al.</italic>, 2019</xref>). This ‘cultivation gap’ poses a formidable issue for taxonomic assignment as many sequences derived from the environment are distantly related to representatives in sequence databases that underpin taxonomic classification software. Single-cell amplified genomes (SAGs) have the potential to bridge the gap by linking individual, environmental genotypes to specific taxonomic labels (<xref rid="btaa588-B52" ref-type="bibr">Rinke <italic toggle="yes">et al.</italic>, 2013</xref>). However, their utility in annotation pipelines has yet to be realized.</p>
    <p>Common methods for taxonomic classification include pairwise sequence alignment (<xref rid="btaa588-B1" ref-type="bibr">Altschul <italic toggle="yes">et al.</italic>, 1990</xref>; <xref rid="btaa588-B8" ref-type="bibr">Buchfink <italic toggle="yes">et al.</italic>, 2015</xref>), <italic toggle="yes">k</italic>-mer matching (<xref rid="btaa588-B31" ref-type="bibr">Kim <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa588-B46" ref-type="bibr">Ondov <italic toggle="yes">et al.</italic>, 2016</xref>) and phylogenetic placement (<xref rid="btaa588-B2" ref-type="bibr">Barbera <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa588-B3" ref-type="bibr">Berger and Stamatakis, 2011</xref>; <xref rid="btaa588-B39" ref-type="bibr">Matsen <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btaa588-B59" ref-type="bibr">Stark <italic toggle="yes">et al.</italic>, 2010</xref>). These methods rely on indexed files from either custom, curated sequence datasets or massive repositories. Distance between query and reference sequences can be estimated using sequence similarity, evolutionary distance or derivatives thereof. Current taxonomic assignment methods do not factor these measures into classification, instead using either a lowest common ancestor (LCA), best-hit or ensemble approach to yield a single taxonomic label (<xref rid="btaa588-B22" ref-type="bibr">Hanson <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="btaa588-B27" ref-type="bibr">Huson <italic toggle="yes">et al.</italic>, 2007</xref>; <xref rid="btaa588-B32" ref-type="bibr">Konwar <italic toggle="yes">et al.</italic>, 2013</xref>). This frequently leads to over-classification in the presence of unrepresented taxa. Phylogenetic placement methods are well-equipped to handle gene-centric assignment because the branch length distances between query and related reference sequences serve as a coordinate system when estimating taxonomic relationships (<xref rid="btaa588-B11" ref-type="bibr">Ciccarelli <italic toggle="yes">et al.</italic>, 2006</xref>). Applications that calibrate taxonomic rank thresholds to a phylogeny’s branch lengths have been developed (<xref rid="btaa588-B47" ref-type="bibr">Parks <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btaa588-B65" ref-type="bibr">Wu <italic toggle="yes">et al.</italic>, 2013</xref>). As part of the Genome Taxonomy Database (GTDB), nodes in reference phylogenies are calibrated by their relative evolutionary distance (RED) values (<xref rid="btaa588-B10" ref-type="bibr">Chaumeil <italic toggle="yes">et al.</italic>, 2019</xref>). However, the GTDB toolkit is not intended for gene-centric taxonomic assignment but for classifying genomes by placing concatenated single-copy marker genes sequences into pre-computed reference trees. Alternatively GraftM can use pplacer for phylogenetic placement of query sequences into gene trees but stops short of using evolutionary distance to correct for over-classification and annotates query sequences using one reference package at a time (<xref rid="btaa588-B7" ref-type="bibr">Boyd <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
    <p>Here, we present the Tree-based Sensitive and Accurate Phylogenetic Profiler (TreeSAPP), a gene-centric functional and taxonomic classification tool able to classify proteins and assembled or unassembled nucleotide sequences. Fragments per Kilobase per Million reads values can be calculated and used in all outputs for genomic or transcriptomic data with short-read sequences in FASTQ format. By using RAxML’s evolutionary placement algorithm (EPA), TreeSAPP leverages the evolutionary distance to reference sequences (EDR), a sum of the distal and pendant lengths as well as the mean length from the placement edge to all descendent leaf tips, correlated with taxonomic rank to recommend optimal taxonomic ranks for more accurate classifications. Structural and metabolic feature information can be annotated in the interactive tree of life (iTOL) and exported to allow for improved functional annotation of query sequences (<xref rid="btaa588-B37" ref-type="bibr">Letunic and Bork, 2016</xref>). In addition to a classification table, placement outputs are compatible with iTOL for easy creation of publication-quality figures (<xref rid="btaa588-F1" ref-type="fig">Fig. 1</xref>).
</p>
    <fig position="float" id="btaa588-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>The workflow of the current study. Sequences for building reference packages were sourced from the NCBI and FunGene databases. Sequences were downloaded from EggNOG for validating reference packages and benchmarking TreeSAPP against GraftM. IMG/M metagenomes were used to explore the global diversity of Mcr</p>
      </caption>
      <graphic xlink:href="btaa588f1" position="float"/>
    </fig>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p>TreeSAPP was developed in Python 3. It uses the Environment for Tree Exploration Python package for many tree manipulation operations (<xref rid="btaa588-B25" ref-type="bibr">Huerta-Cepas <italic toggle="yes">et al.</italic>, 2016b</xref>). The multiprocessing Python package is used to run executable processes in parallel unless it is more efficient to use the software’s native parallelization capabilities. BioPython is used for downloading lineage information from Entrez’s taxonomy database for each reference sequence when building new reference packages (<xref rid="btaa588-B12" ref-type="bibr">Cock <italic toggle="yes">et al.</italic>, 2009</xref>). Sequences for the reference packages described in this manuscript were primarily downloaded from the FunGene repository as this resource provides curated sequences for many of the functional anchor genes involved in major biogeochemical cycles (<xref rid="btaa588-B21" ref-type="bibr">Fish <italic toggle="yes">et al.</italic>, 2013</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). Additionally, to provide the most comprehensive reference trees, newly published sequences that were not included in FunGene 9.6 were included from GenBank and the Joint Genome Institute’s Integrated Microbial Genomes and Microbiomes (IMG/M) (<xref rid="btaa588-B5" ref-type="bibr">Borrel <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa588-B23" ref-type="bibr">Hua <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa588-B41" ref-type="bibr">McKay <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa588-B54" ref-type="bibr">Seitz <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa588-B62" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2019</xref>). All benchmarking was performed on a server with a 20 physical core (40 virtual) Intel Xeon CPU (E5-2650 v3), 264 GB of RAM and a 5 TB HDD. The operating system was Red Hat Enterprise Linux Server release 7.5 (Maipo).</p>
    <sec>
      <title>2.1 Building reference packages with TreeSAPP create</title>
      <p>TreeSAPP’s classification workflow requires a multiple sequence alignment (MSA), profile hidden Markov model (HMM), taxonomic lineages and phylogenetic tree for all reference sequences (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S1</xref>). Together these files constitute a reference package, built using <italic toggle="yes">treesapp create</italic>, and allow for rapid query sequence filtering, phylogenetic placement and taxonomic classification. Construction began with removing truncated sequences using either a provided HMM or a database’s filter prior to downloading. An empirically determined threshold of 60% profile HMM coverage was required of candidate reference sequences to balance inclusivity and profile quality. NCBI taxonomic lineages were then downloaded for each candidate reference sequence with a valid accession. Lineage information of unaccessioned sequences can be provided via either a table or the FASTA file using a custom header format. Optional taxonomy-based filtering was performed (e.g. to remove viral or eukaryotic sequences). This set can then be clustered using USEARCH at a specified proportional similarity (<xref rid="btaa588-B18" ref-type="bibr">Edgar, 2010</xref>). Non-homologous (i.e. outlier or mis-annotated) sequences were identified by OD-Seq and removed (<xref rid="btaa588-B29" ref-type="bibr">Jehl <italic toggle="yes">et al.</italic>, 2015</xref>). These automatically curated sequences were used to generate the reference MSA with MAFFT’s -‘auto’ algorithm (<xref rid="btaa588-B30" ref-type="bibr">Katoh and Standley, 2013</xref>). The resulting MSA was used by HMMER’s ‘hmmbuild’ module to build a new profile HMM (<xref rid="btaa588-B17" ref-type="bibr">Eddy, 1998</xref>). Before tree construction, the MSA was optionally trimmed using BMGE with the least conserved matrix, BLOSUM30 for proteins or PAM100 otherwise, to decrease the runtime required for phylogeny inference by removing non-conserved positions (<xref rid="btaa588-B13" ref-type="bibr">Criscuolo and Gribaldo, 2010</xref>).</p>
      <p>By default, RAxML is used for phylogenetic inference, automatically using the optimal substitution model (invoked with the -PROTGAMMAAUTO flag) and the minimum number of bootstraps necessary (using -‘autoMR’) (<xref rid="btaa588-B48" ref-type="bibr">Pattengale <italic toggle="yes">et al.</italic>, 2010</xref>; <xref rid="btaa588-B58" ref-type="bibr">Stamatakis, 2006</xref>). Yet, in light of cursory taxonomic classification performance results indicating little difference between RAxML and FastTree (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S6</xref>) with a drastic difference in compute time, FastTree is available as well (<xref rid="btaa588-B50" ref-type="bibr">Price <italic toggle="yes">et al.</italic>, 2010</xref>). In this case, a bootstrapped tree will not be generated and the LG amino acid substitution model is used unless the user specifies differently (<xref rid="btaa588-B36" ref-type="bibr">Le and Gascuel, 2008</xref>). To assign taxonomy at the most appropriate rank given a placement’s distance, a linear correlation of taxonomic rank with EDR is estimated for each reference package. Briefly, all sequences from a taxonomic group were removed from the reference tree before clustered sequences from the initial input FASTA file were mapped back to the tree using EPA. The placement distances were calculated and recorded before the next iteration involving a different taxon until all possible taxa have been exhaustively placed. Outliers are then removed from these data and rarefied to improve normality across the ranks before a linear model is fit.</p>
    </sec>
    <sec>
      <title>2.2 Testing classification performance with TreeSAPP evaluate</title>
      <p>TreeSAPP’s classification performance was evaluated using clade exclusion analysis (described below) and the binary classification metric, Matthews’ correlation coefficient (MCC) (<xref rid="btaa588-B40" ref-type="bibr">Matthews, 1975</xref> (<xref rid="sup1" ref-type="supplementary-material">Supplementary Equation S1</xref>). TreeSAPP was compared to GraftM and DIAMOND, as implemented in GraftM, using 15 taxonomic and 12 functional anchor reference packages (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>). Functional anchor reference packages were only used during clade exclusion analysis as their representation in the MCC test data (EggNOG) was too limited and potentially a source of bias. To consistently compare between methods, all performance analyses relied on the NCBI’s taxonomic hierarchy for determining each sequence’s optimal taxonomic assignment: the highest resolution taxonomic classification with respect to the taxonomic composition of the reference package (i.e. the LCA between the query and most closely related reference). Under these conditions, ‘taxonomic distance’ is defined as the number of ranks separating the LCA of the optimal taxonomic assignment and the taxon assigned by the software (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S4</xref>). Given there are eight conventional taxonomic ranks used in the classification of Bacteria and Archaea, the maximum taxonomic distance is eight while a perfect classification has a taxonomic distance of zero.</p>
      <p>Classification performance was measured utilizing 15 universal single-copy taxonomic anchor genes and the EggNOG database (v4.5.1) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>), with reference sequences from Bacteria and Archaea but excluding Eukaryotes to simplify the hierarchy. In addition to RecA, RadA and RpoB, nearly ubiquitous taxonomic anchor genes used by the GTDB were identified as being present in at least 90% of Archaea and Bacteria (<xref rid="btaa588-B47" ref-type="bibr">Parks <italic toggle="yes">et al.</italic>, 2018</xref>). Out of this set, 12 were selected that also had entries in the PFam database and were therefore easily accessed. Sequences that were either not in the PFam database or did not have an obvious corresponding orthologous group in EggNOG were omitted. For each taxonomic distance between zero and eight, sequence classifications matching their EggNOG annotations within the taxonomic distance threshold were counted as true positives. Sequences that were classified as taxa outside of the threshold or as the wrong gene were counted as false positives. EggNOG sequences that were orthologous to any of the 12 reference packages but were not classified counted as false negatives while all remaining sequences were true negatives. Classification performance was determined using MCC due to its ability to report reasonable values even with very different class sizes (<xref rid="btaa588-B6" ref-type="bibr">Boughorbel <italic toggle="yes">et al.</italic>, 2017</xref>).</p>
      <p>Taxonomic classification accuracy was estimated by clade exclusion analysis using functional anchor reference packages for dissimilatory sulphite reductase alpha and beta subunits (DsrAB), methyl coenzyme-M reductase alpha, beta and gamma subunits (McrA, McrB and McrG), periplasmic nitrate reductase (NapA), NO-forming nitrite reductase (NirK and NirS), nitrogenase molybdenum–iron protein alpha chain(NifD), nitric oxide reductase subunit B (NorB), nitrite oxidoreductase subunits A and B (NxrA and NxrB) and a combined particulate methane monooxygenase and ammonia monooxygenase (PmoA/AmoA). Clade exclusion analysis measures classification performance in scenarios where the query sequences lack a close relative in the reference set, as is typical during taxonomic classification of metagenomes (<xref rid="btaa588-B49" ref-type="bibr">Peabody <italic toggle="yes">et al.</italic>, 2015</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S3</xref>). The analysis required reference sequences with taxonomic lineages completely resolved to the rank evaluated. Sequences not resolved to the rank being evaluated (e.g. Archaea; Euryarchaeota; environmental samples for Class) were removed as their specific taxonomic relationship to other reference sequences was unknown. For each taxonomic rank tested, representative sequences were selected for each taxon (an arbitrary maximum of five so as to not introduce lineage-specific bias into the final estimate) and sequences belonging to that taxon were removed from the reference package. These representative sequences were then classified and compared to their optimal taxonomic assignment. Distances from their optimal taxonomic assignments were tabulated and reference sequences were returned to the reference package before the next taxon was tested. Only taxa that shared a common ancestor at the rank tested with one or more remaining reference sequences were evaluated. For example, evaluating the ability to classify at the rank of Class using sequences belonging to the order Methanosarcinales would require the reference package to contain other members of the parent taxonomic class Methanomicrobia that are not Methanosarcinales, such as Methanomicrobiales. This allows the software to optimally classify the sequences as Methanomicrobia.</p>
    </sec>
    <sec>
      <title>2.3 Classifying query sequences with TreeSAPP assign</title>
      <p>TreeSAPP begins by predicting open reading frames (ORFs) using Prodigal v2.6.3 if the inputs are nucleotide sequences, otherwise this step is skipped (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S2</xref>) (<xref rid="btaa588-B28" ref-type="bibr">Hyatt <italic toggle="yes">et al.</italic>, 2010</xref>). Resulting ORFs are conceptually translated into proteins that are then aligned to curated reference sequences using hmmalign, within the HMMER v3.1 package (<xref rid="btaa588-B17" ref-type="bibr">Eddy, 1998</xref>). Homologous sequences are then extracted and mapped onto the reference MSA with hmmalign. Optionally, alignments are trimmed using BMGE to remove non-conserved positions from the alignment file and reduce computation time (<xref rid="btaa588-B13" ref-type="bibr">Criscuolo and Gribaldo, 2010</xref>). BMGE uses the BLOSUM30 substitution matrix for protein sequences, as recommended by <xref rid="btaa588-B61" ref-type="bibr">Tan <italic toggle="yes">et al.</italic> (2015)</xref>. RAxML-EPA places the query sequences in the reference tree by finding the optimal phylogeny likelihood with the sequence inserted (<xref rid="btaa588-B3" ref-type="bibr">Berger and Stamatakis, 2011</xref>). Query sequence placements are filtered by evolutionary distance and likelihood weight ratio prior to predicting taxonomy at the linear-model recommended rank. The complete set of ORF sequences predicted by Prodigal (both nucleotide and amino acid forms), a FASTA file containing only the classified ORFs and a classification table with taxonomy and abundance information are included as outputs. JPlace files, containing reference tree placement coordinates for all queries classified, are additionally provided for each reference package. Along with colour and style information files made for a specific phylogeny, these placements may be visualized in iTOL (<xref rid="btaa588-B38" ref-type="bibr">Letunic and Bork, 2019</xref>).
</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>Many taxonomic assignment software methods are evaluated by a mock community of known, but severely limited diversity. So while these analyses are useful, their inherent oversimplification prohibits their performance estimates from being extensible to natural and engineered microbial communities. This is especially perplexing for gene-centric annotation software, where the total diversity of query sequences is reduced compared to whole-genome binning and profiling tools. Efforts are being made to provide well-designed mock communities for metagenome analysis, including taxonomic assignment, though they are still limited in their diversity (<xref rid="btaa588-B53" ref-type="bibr">Sczyrba <italic toggle="yes">et al.</italic>, 2017</xref>). Therefore, we decided to compare the taxonomic classification performance of TreeSAPP to GraftM and DIAMOND using the large, but still well curated, EggNOG database (v4.5) (<xref rid="btaa588-B24" ref-type="bibr">Huerta-Cepas <italic toggle="yes">et al.</italic>, 2016a</xref>) comprised of 2031 organisms for universal taxonomic anchor genes. Additionally, we used <italic toggle="yes">treesapp evaluate</italic> to simulate reference packages that do not represent taxa from Species to Class-level sequence divergence to determine how each tool classifies well and poorly represented query sequences. Finally, TreeSAPP was used to profile all metagenome-derived proteins in the IMG/M database.</p>
    <sec>
      <title>3.1 Performance</title>
      <p>Classification and runtime performance of TreeSAPP were benchmarked against GraftM with the default hmmsearch search strategy and pplacer placement method as well as DIAMOND-mode as a proxy for an alignment-based search and classification strategy (<xref rid="btaa588-B7" ref-type="bibr">Boyd <italic toggle="yes">et al.</italic>, 2018</xref>; <xref rid="btaa588-B8" ref-type="bibr">Buchfink <italic toggle="yes">et al.</italic>, 2015</xref>). Classifying the EggNOG database (version 4.5.0) (<xref rid="btaa588-B24" ref-type="bibr">Huerta-Cepas <italic toggle="yes">et al.</italic>, 2016a</xref>) with 12 single-copy taxonomic anchors revealed TreeSAPP’s overall classification performance was, with little exception, preferable to that of either a pairwise alignment strategy or GraftM (<xref rid="btaa588-F2" ref-type="fig">Fig. 2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S2</xref>). This is due in large part to TreeSAPP’s evolutionary distance-based filtering thresholds that favourably remove false positives without increasing false negatives, thereby increasing precision; GraftM and DIAMOND accrued over 3000 more false positives than TreeSAPP. Notably, this performance was achieved only using RAxML version 8.2.12 as we found pendant length distances were estimated accurately beginning with this version. Based on the performance of TreeSAPP using alignment trimming but assigning taxonomy to queries only by LCA (TreeSAPP-BMGE-Raw), adjusting a query’s assigned taxonomic rank by its EDR is worthwhile. However, relative to DIAMOND and GraftM, TreeSAPP’s recall was not as strong, mostly stemming from the initial HMM search, missing 1775 EggNOG sequences versus 561 and 789 for GraftM and DIAMOND at the most relaxed taxonomic rank distance allowed, respectively (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref> and <xref rid="sup1" ref-type="supplementary-material">Table S2</xref>). The vast majority of false negatives were accounted for by Eukaryotic sequences and this is sensible given the reference packages were built using only sequences from Bacteria and Archaea. Only 7.1% of unclassified sequences were bacterial or archaeal in origin. Still, 5420 Eukaryotic sequences were correctly classified suggesting TreeSAPP is able to accurately identify very distantly related homologous sequences. False negatives were unevenly distributed across the tested reference packages with over 60% from just 3 (minimum =1 from Ribosomal S3Ae family, maximum =653 from Ribosomal protein L1p/L10e family, median =23).</p>
      <fig position="float" id="btaa588-F2">
        <label>Fig. 2.</label>
        <caption>
          <p>Classification performance of TreeSAPP, GraftM and DIAMOND as evaluated by the MCC. TreeSAPP was run both with (TreeSAPP-BMGE) and without MSA trimming using BMGE. TreeSAPP-BMGE-Raw represents the classification performance of TreeSAPP with BMGE but without the linear-model-based rank recommendation. Distance from optimal rank is the accepted taxonomic distance in order for a classified sequence to be considered a true positive. Sequences that failed to meet the distance from optimal rank were included in the MCC calculation as false positives</p>
        </caption>
        <graphic xlink:href="btaa588f2" position="float"/>
      </fig>
      <p>Clade exclusion analysis was used to dually determine the accuracy of these methods using functional anchors with less congruent phylogenetic and taxonomic relations as compared to the ribosomal proteins, and how these methods perform when databases lack reference sequences that are closely related to query sequences. Query sequences were downloaded from FunGene version 9.6 and clustered at 99% similarity with USEARCH (<xref rid="btaa588-B18" ref-type="bibr">Edgar, 2010</xref>). EggNOG was not used in this case as its taxonomic breadth of 2031 organisms, many of which do not contain any of the functional markers, was deemed inadequate for reference package construction. Using <italic toggle="yes">treesapp evaluate</italic>, iterative clade exclusion analyses were performed for every testable taxon and each reference package was independently analysed. Classification performance was variable, but not considerably so, across the reference packages tested. McrA tended to yield the best assignments while PmoA/AmoA and DsrAB consistently performed poorly. GraftM and TreeSAPP both perform much better than DIAMOND when classifying divergent sequences (Class-, Order- and Family-level relations to closest relative in reference set) but comparable when query sequences were similar to the reference set (<xref rid="btaa588-F3" ref-type="fig">Fig. 3</xref>). Most of TreeSAPP’s classifications were &lt;2 taxonomic ranks away from the optimal assignment on average, regardless of sequence divergence, and sequences were classified with approximately equivalent accuracy across taxonomic ranks. Since false negatives were unavailable for this analysis the <italic toggle="yes">F</italic>1 score, the harmonic mean of precision and recall, was used to compare across all reference packages (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>). The difference in each of the methods’ ability to handle distantly related sequences is emphasized in these values. All did comparably well when classifying queries closely related to reference sequences (<italic toggle="yes">F</italic>1 scores between 0.71 and 0.92) but varied significantly for distantly related queries (between 0.04 and 0.8).
</p>
      <fig position="float" id="btaa588-F3">
        <label>Fig. 3.</label>
        <caption>
          <p>Average taxonomic distance across all taxa evaluated for 12 functional anchors. Colours correspond to the taxonomic rank evaluated by clade exclusion analysis and serve as a proxy for sequence divergence. Dashes along the <italic toggle="yes">y</italic>-axis show the distribution of points on a single plane. P_amoA is a reference package with sequences containing both PmoA and AmoA</p>
        </caption>
        <graphic xlink:href="btaa588f3" position="float"/>
      </fig>
      <p>Clade exclusion analysis was used again to confirm the results observed by classifying the taxonomic anchor genes in EggNOG. The mean distances and <italic toggle="yes">F</italic>1 scores were consistent with the functional anchor genes, with a few reference packages performing poorly (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S8 and S9</xref>). This could not be completed for DIAMOND and GraftM as one of its dependencies for building reference packages, Taxtastic (<ext-link xlink:href="https://github.com/fhcrc/taxtastic" ext-link-type="uri">https://github.com/fhcrc/taxtastic</ext-link>), would frequently timeout.</p>
      <p>Classification and JPlace files can be used for purposes beyond taxonomic and functional profiling; TreeSAPP can also discover genes, reactions and pathways associated with organismal genomes, SAGs or MAGs. To evaluate this aspect of the TreeSAPP pipeline, we developed a use case for McrA, because this reference package performed the best during benchmarking. The <italic toggle="yes">mcrA</italic> gene along with <italic toggle="yes">mcrB</italic> and <italic toggle="yes">mcrG</italic> encode the holoenzyme mediating the terminal step in biological methane production, though it is also capable of binding and activating methane in the anaerobic oxidation of methane and more recently may be used in the oxidation of short-chain alkanes (<xref rid="btaa588-B35" ref-type="bibr">Laso-Pérez <italic toggle="yes">et al.</italic>, 2016</xref>). The McrA phylogeny has been shown to be fairly congruent with both small subunit ribosomal RNA (SSU or 16S rRNA) gene and concatenated marker gene phylogenies, with limited recorded instances of lateral gene transfer, and is therefore more likely to perform well as a taxonomic anchor (<xref rid="btaa588-B19" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa588-B57" ref-type="bibr">Springer <italic toggle="yes">et al.</italic>, 1995</xref>). Moreover, methane-metabolism pathway information has been provided for each known clade and expected to be conserved, making accurate metabolic inferences directly from phylogenetic placement possible (<xref rid="btaa588-B19" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
    </sec>
    <sec>
      <title>3.2 Global McrA survey</title>
      <p>TreeSAPP was used to find and classify all McrABG sequences from the Joint Genome Institute’s IMG/M database image from January 10, 2017. There were 7.715×10<sup>9</sup> (∼1.2 TB) of putative amino acid sequences included in this analysis and 14 919 McrA, 11 825 McrB and 8609 McrG sequences were taxonomically classified. A total of 816 metagenomes were found to contain at least 1 of the 3 Mcr subunits. Sequences shorter than 84 AA, corresponding to the first quantile of length-sorted sequences, were removed to mitigate incorrect classifications leaving 11 256 McrA. About 58% (6533) of the McrA sequences were classified at the rank of Genus or Species and only 3.6% were classified as Archaea (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S10</xref>). Methanomicrobia and Methanobacteria were the most sampled classes with 5505 and 1572, respectively. Methanoculleus, Methanobrevibacter, Methanobacterium and Methanoregula were the most common genera accounting for 2891 sequences. Of all the McrA sequences classified 4251 sequences were resolved to at least Phylum (to reduce the chance they were false positives) and no further than Family. Even though 2764 of these were classified to the NCBI’s Phylum rank as either ‘environmental samples’ or ‘metagenomes’, they can still be considered novel with respect to cultured archaea. These novel sequences were from 432 metagenomes, primarily represented by wetland and hydrothermal vent communities. Strikingly, 89% of the 806 McrA sequences from hydrothermal vent metagenomes were considered novel. While the number of uniquely novel sequences was not determined, updating the reference tree after clustering all sequences at 97% similarity added 412 leaves, an increase of 180%.</p>
      <p>Additionally, the McrA tree was annotated with methane-metabolism pathway information for each known clade (<xref rid="btaa588-B4" ref-type="bibr">Borrel <italic toggle="yes">et al.</italic>, 2014</xref>, <xref rid="btaa588-B5" ref-type="bibr">2019</xref>; <xref rid="btaa588-B19" ref-type="bibr">Evans <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa588-B63" ref-type="bibr">Whitman <italic toggle="yes">et al.</italic>, 2006</xref>) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref>) and this was used to provide metabolic labels for an additional 10 839 sequences. A metabolic label was not assigned to sequences placed at a node where descendants possess multiple metabolic labels. CO<sup>2</sup>-dependent hydrogenotrophy was the most common metabolism by a large margin and methylotrophy was the least common. There were no signs of mutual exclusion among metabolisms or between metabolisms and broad ecosystem categories but some trends were identified for specific ecosystem sub-types. Hydrothermal vents, oil seeps, thermal springs and an asphaltene lake harboured relatively abundant McrA associated with short-chain alkane-oxidizing and anaerobic methanotrophic Archaea. Only thermal springs also hosted an abundant methanogenic population. McrA associated with CH<sup>3</sup>-dependent hydrogenotrophic methanogenesis were most prevalent in digestive systems and other environments rich in organic matter. The most aceticlastic McrA were found in soil and freshwater environments as well as anaerobic digesters.</p>
      <p>Together, using TreeSAPP’s phylogenetically derived taxonomic classifications, these metagenomic data indicate that there are plenty of novel methanogenic and short-chain alkane-oxidizing Archaeal lineages that remain to be described.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>TreeSAPP is a functional and taxonomic annotation software that uses phylogenetic placement for accurate classifications. It is readily able to classify sequences derived from organismal genomes, environmental genomes (SAGs, MAGs) and metagenomes—even those that are distantly related to reference genomes present in contemporary databases. Moreover, it capitalizes on the phylogenetic framework to transitively assign taxonomic and functional feature information. In cases of complex evolutionary histories, internalizing these features in the reference package, by annotating clades, ensures that distantly related genes are not mis-annotated, thereby reducing false discovery. TreeSAPP was designed to integrate with iTOL as well as biological sequence databases so sequences can be easily linked to their respective taxonomic lineages. We are looking to expand support for databases beyond EggNOG and Entrez so users can more easily create reference packages. Moreover, to keep reference packages as current as possible, query sequences that meet profile HMM proportion thresholds and are deemed sufficiently divergent from current reference sequences are used to readily rebuild reference MSA, profile HMM and tree using <italic toggle="yes">treesapp update</italic>. We do not plan to regularly update all reference packages centrally. Rather, in their current state, these are meant to be used as mutable objects that users can update as required to suit their unique efforts (<xref rid="btaa588-F4" ref-type="fig">Fig. 4</xref>).
</p>
    <fig position="float" id="btaa588-F4">
      <label>Fig. 4.</label>
      <caption>
        <p>Phylogenetic and metabolic analysis of IMG metagenome-derived McrA sequences. (<bold>A</bold>) All predicted metagenome-derived McrA sequences (14 919) from IMG/M (as of January 10, 2017) were classified using TreeSAPP and visualized in iTOL. The tree shown here contains 228 reference McrA sequences including most newly described lineages from the “divergent McrA” clade hypothesized to be involved in oxidizing higher alkanes. A version of the tree with leaf labels is available as <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12</xref>. (<bold>B</bold>) Proportion of sequences assigned at each taxonomic rank. (<bold>C</bold>) Putative methanogenesis and methanotrophic metabolisms supported in each ecosystem category as inferred by their placement on the reference McrA tree. Sequences that mapped deeply and converge across multiple annotated metabolisms were omitted</p>
      </caption>
      <graphic xlink:href="btaa588f4" position="float"/>
    </fig>
    <sec>
      <title>4.1 Performance</title>
      <p>Classification performance analyses indicate that TreeSAPP was better at both identifying and assigning taxonomy to query protein sequences than DIAMOND and GraftM, especially when query sequences were novel with respect to the reference sequences. The MCC values generated using EggNOG showed TreeSAPP’s taxonomic classifications were better than both GraftM and DIAMOND, though this was only achieved with taxonomic rank recommendation from linear models. Even still, it is important to point out that the pairwise alignment performance of DIAMOND shown here is not extensible to pairwise alignment in general because databases tend to be more comprehensive than reference packages used in this study. Unfortunately, we were unable to compare our classification results to those of the critical assessment of metagenome interpretation project since their performance summaries were based on classifications of DNA sequences (<xref rid="btaa588-B53" ref-type="bibr">Sczyrba <italic toggle="yes">et al.</italic>, 2017</xref>). A recent meta-analysis of taxonomic classification tools by <xref rid="btaa588-B66" ref-type="bibr">Ye <italic toggle="yes">et al.</italic> (2019)</xref>, though not directly comparable, produced <italic toggle="yes">F</italic>1 scores similar to our analyses for DIAMOND at the Genus and Species ranks (ranging from 0.1 to 0.4, <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>) indicating that both GraftM and TreeSAPP would outperform their tested ‘DNA-to-protein’ classifiers (tools that classify DNA sequences using protein databases).</p>
      <p>Through these analyses, we also found classification precision to vary by reference package. All classifiers struggled to accurately assign taxonomy with the DsrAB reference package [included reductive and oxidative forms of DsrA and DsrB, and validated with sequences from <xref rid="btaa588-B43" ref-type="bibr">Müller <italic toggle="yes">et al.</italic> (2015)</xref>]. DsrAB is a composite reference package containing the homologous subunits DsrA and DsrB, anaerobic sulphite reductase subunit C and a nitrite and sulphite reductase clade of Euryarchaeota. Including homologous but functionally diverse genes in a single phylogeny can safeguard from erroneous functional attributions by performing a second classification with additional tree decoration information, as implemented in <italic toggle="yes">treesapp layer</italic>, but may result in less accurate taxonomic assignments (<xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>). More research into building reference packages for complex gene families is needed.</p>
    </sec>
    <sec>
      <title>4.2 Application</title>
      <p>TreeSAPP was used to classify all metagenome-derived McrABG subunits in IMG/M. It identified several thousand novel sequences (i.e. not represented by either a Genus or Species) with respect to our contemporary, metabolically annotated reference McrA tree. Specifically, Gulf of California hydrothermal vent samples contained diverse methanotrophic and short-chain alkane-oxidizing Archaea, of which nearly 90% do not have a Genus-level representative. We also estimated the relative abundance of McrA associated with known methanogenic and alkanotrophic metabolisms, identifying CO<sup>2</sup>-dependent hydrogenotrophy as vastly more common than any other on a per-ORF basis. This use case illustrates the power of TreeSAPP in identifying new lineages and resolving quantitative functional differences between locations. This rich dataset is ripe for further diversity and correlation-based analyses to inform future sequencing and cultivation efforts.</p>
    </sec>
    <sec>
      <title>4.3 Future development</title>
      <p>In the process of developing and testing TreeSAPP several potential areas of improvement were recognized. TreeSAPP is slower and requires more RAM than GraftM (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S13</xref>) for a number of reasons. Intermediate files are written so runs can be restarted from checkpoints at the cost of more time spent performing I/O operations. TreeSAPP uses Prodigal for ORF prediction and conceptual translation (<xref rid="btaa588-B28" ref-type="bibr">Hyatt <italic toggle="yes">et al.</italic>, 2010</xref>), while GraftM employs the simple and significantly faster OrfM (<xref rid="btaa588-B64" ref-type="bibr">Woodcroft <italic toggle="yes">et al.</italic>, 2016</xref>). TreeSAPP uses one HMM for both search and profile multiple alignments. This is less sensitive than GraftM’s search-specific HMM where sequences were taxonomically deduplicated before building (data not shown). Adopting this strategy could be beneficial if it does not increase the false positive rate. Finally, RAxML’s EPA is used for phylogenetic placement, instead of the faster pplacer. While neither tool scales particularly well on a single compute node (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S14</xref>) future versions of TreeSAPP will see marked improvements in sequential and parallel computing efficiency by adopting the faster RAxML-NG and EPA-NG (<xref rid="btaa588-B2" ref-type="bibr">Barbera <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa588-B34" ref-type="bibr">Kozlov <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
      <p>Several developments in phylogenetic placement have been published recently that may lead to further improvements in efficiency and accuracy (<xref rid="btaa588-B2" ref-type="bibr">Barbera <italic toggle="yes">et al.</italic>, 2019</xref>; <xref rid="btaa588-B15" ref-type="bibr">Czech <italic toggle="yes">et al.</italic>, 2019</xref>). Among them is hierarchical phylogenetic placement, which involves placing query sequences onto a taxonomically broad and sparse backbone tree with subsequent placement onto high-resolution phylogenies based on the backbone edge position. This method has the potential to increase phylogenetic placement precision while reducing computational requirements (<xref rid="btaa588-B15" ref-type="bibr">Czech <italic toggle="yes">et al.</italic>, 2019</xref>). Moreover, new phylogenetically informed Bacterial and Archaeal taxonomic hierarchies are being introduced (<xref rid="btaa588-B47" ref-type="bibr">Parks <italic toggle="yes">et al.</italic>, 2018</xref>). Leveraging a principled taxonomic framework based on phylogenetic relationships will likely improve the taxonomic classifications of all phylogenetic methods.</p>
      <p>Modelling the relationship between taxonomic rank and EDR for rank recommendation benefits taxonomic classification performance (<xref rid="btaa588-F2" ref-type="fig">Fig. 2</xref>). It is most beneficial when classifying distantly related query sequences that map to either a leaf’s edge or a sparse clade resulting in a shallow (Species or Genus) LCA. However, generating the EDR data for training is currently a slow, iterative process. Moreover, a reliable model is not created if there is insufficient taxonomic redundancy within reference sequences (i.e. a single Order is representing a Class, so removing that Order removes the entire Class and next closest ancestor is at Phylum). Using distances directly from the tree, as was used in the GTDB-Tk (<xref rid="btaa588-B10" ref-type="bibr">Chaumeil <italic toggle="yes">et al.</italic>, 2019</xref>) with RED, would accelerate this process and benefit consistency.</p>
    </sec>
  </sec>
  <sec>
    <title>5 Conclusion</title>
    <p>We have developed a functional and taxonomic annotation software, TreeSAPP, with improved classification performance based on regression of evolutionary distances and taxonomic ranks to recommend more accurate taxonomic assignments. TreeSAPP is able to provide quantitative functional and taxonomic information for both assembled and unassembled sequences, classification tables and files supporting interactive iTOL visualizations. Using TreeSAPP, we explored the global distribution of McrA and recovered many new sequences associated with methane metabolizing archaea. With an expanded set of reference packages under development TreeSAPP will support community-driven taxonomic assignment and metabolic reconstruction on a truly global scale.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>btaa588_supplementary_data</label>
      <media xlink:href="btaa588_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>We would like to thank Tanya Woyke, Natalia Ivanova and Frederik Schulz at the Joint Genome Institute (JGI; Berkeley, California) and Daniel Udwary for providing metagenomic data from IMG/M and assistance with the National Energy Research Scientific Computing (NERSC) Center systems. Many thanks to Simonetta Gribaldo and Guillaume Borrel at the Institut Pasteur (Paris) for validating metabolic annotations and recommending BMGE. We also thank Kishori Konwar for formative conversations and preliminary code used to guide early TreeSAPP development cycles.</p>
    <sec>
      <title>Funding</title>
      <p>This work was performed under the auspices of the US Department of Energy (DOE) Joint Genome Institute, an Office of Science User Facility, supported by the Office of Science of the US Department of Energy under Contract DE-AC02-05CH11231 through the Facilities Integrating Collaborations for User Science (FICUS) initiative between JGI and NERSC; the Natural Sciences and Engineering Research Council of Canada; Genome British Columbia; Genome Canada; and Compute Canada through grants awarded to S.J.H. is a co-founder of Koonkie Inc., a bioinformatics consulting company that designs and provides scalable algorithmic and data analytics solutions in the cloud.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btaa588-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname><given-names>S.F.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1990</year>) 
<article-title>Basic local alignment search tool</article-title>. <source>J. Mol. Biol</source>., <volume>215</volume>, <fpage>403</fpage>–<lpage>410</lpage>.<pub-id pub-id-type="pmid">2231712</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barbera</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>EPA-ng: massively parallel evolutionary placement of genetic sequences</article-title>. <source>Syst. Biol</source>., <volume>68</volume>, <fpage>365</fpage>–<lpage>369</lpage>.<pub-id pub-id-type="pmid">30165689</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berger</surname><given-names>S.A.</given-names></string-name>, <string-name><surname>Stamatakis</surname><given-names>A.</given-names></string-name></person-group> (<year>2011</year>) 
<article-title>Aligning short reads to reference alignments and trees</article-title>. <source>Bioinformatics</source>, <volume>27</volume>, <fpage>2068</fpage>–<lpage>2075</lpage>.<pub-id pub-id-type="pmid">21636595</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Borrel</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>Comparative genomics highlights the unique biology of Methanomassiliicoccales, a Thermoplasmatales-related seventh order of methanogenic archaea that encodes pyrrolysine</article-title>. <source>BMC Genomics</source>, <volume>15</volume>, <fpage>679</fpage>–<lpage>624</lpage>.<pub-id pub-id-type="pmid">25124552</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Borrel</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Wide diversity of methane and short-chain alkane metabolisms in uncultured archaea</article-title>. <source>Nat. Microbiol</source>., <volume>4</volume>, <fpage>603</fpage>–<lpage>613</lpage>.<pub-id pub-id-type="pmid">30833729</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boughorbel</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>Optimal classifier for imbalanced data using Matthews Correlation Coefficient metric</article-title>. <source>PLoS One</source>, <volume>12</volume>, <fpage>e0177678</fpage>.<pub-id pub-id-type="pmid">28574989</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boyd</surname><given-names>J.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>GraftM: a tool for scalable, phylogenetically informed classification of genes within metagenomes</article-title>. <source>Nucleic Acids Res</source>., <volume>46</volume>, <fpage>e59</fpage>.<pub-id pub-id-type="pmid">29562347</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buchfink</surname><given-names>B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>Fast and sensitive protein alignment using DIAMOND</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>59</fpage>–<lpage>60</lpage>.<pub-id pub-id-type="pmid">25402007</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Canfield</surname><given-names>D.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>The evolution and future of earth’s nitrogen cycle</article-title>. <source>Science</source>, <volume>330</volume>, <fpage>192</fpage>–<lpage>196</lpage>.<pub-id pub-id-type="pmid">20929768</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chaumeil</surname><given-names>P.-A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>GTDB-Tk: a toolkit to classify genomes with the Genome Taxonomy Database</article-title>. <source>Bioinformatics</source>, <volume>36</volume>, <fpage>1</fpage>–<lpage>3</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa588-B11">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Ciccarelli</surname><given-names>F.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2006</year>) 
<article-title>Toward automatic reconstruction of a highly resolved tree of life</article-title>. Science, 311, 1283–1287.</mixed-citation>
    </ref>
    <ref id="btaa588-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cock</surname><given-names>P.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2009</year>) 
<article-title>Biopython: freely available Python tools for computational molecular biology and bioinformatics</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1422</fpage>–<lpage>1423</lpage>.<pub-id pub-id-type="pmid">19304878</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Criscuolo</surname><given-names>A.</given-names></string-name>, <string-name><surname>Gribaldo</surname><given-names>S.</given-names></string-name></person-group> (<year>2010</year>) 
<article-title>BMGE (Block Mapping and Gathering with Entropy): a new software for selection of phylogenetic informative regions from multiple sequence alignments</article-title>. <source>BMC Evol. Biol</source>., <volume>10</volume>, <fpage>210</fpage>.<pub-id pub-id-type="pmid">20626897</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cross</surname><given-names>K.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Targeted isolation and cultivation of uncultivated bacteria by reverse genomics</article-title>. <source>Nat. Biotechnol</source>., <volume>37</volume>, <fpage>1314</fpage>–<lpage>1321</lpage>.<pub-id pub-id-type="pmid">31570900</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Czech</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Methods for automatic reference trees and multilevel phylogenetic placement</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>1151</fpage>–<lpage>1158</lpage>.<pub-id pub-id-type="pmid">30169747</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Darling</surname><given-names>A.E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>PhyloSift: phylogenetic analysis of genomes and metagenomes</article-title>. <source>PeerJ</source>, <volume>2</volume>, <fpage>e243</fpage>.<pub-id pub-id-type="pmid">24482762</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eddy</surname><given-names>S.R.</given-names></string-name></person-group> (<year>1998</year>) 
<article-title>Profile hidden Markov models</article-title>. <source>Bioinformatics</source>, <volume>14</volume>, <fpage>755</fpage>–<lpage>763</lpage>.<pub-id pub-id-type="pmid">9918945</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Edgar</surname><given-names>R.C.</given-names></string-name></person-group> (<year>2010</year>) 
<article-title>Search and clustering orders of magnitude faster than BLAST</article-title>. <source>Bioinformatics</source>, <volume>26</volume>, <fpage>2460</fpage>–<lpage>2461</lpage>.<pub-id pub-id-type="pmid">20709691</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Evans</surname><given-names>P.N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>An evolving view of methane metabolism in the Archaea</article-title>. <source>Nat. Rev. Microbiol</source>., <volume>17</volume>, <fpage>219</fpage>–<lpage>232</lpage>.<pub-id pub-id-type="pmid">30664670</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Falkowski</surname><given-names>P.G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2008</year>) 
<article-title>The microbial engines that drive earth’s biogeochemical cycles</article-title>. <source>Science</source>, <volume>320</volume>, <fpage>1034</fpage>–<lpage>1039</lpage>.<pub-id pub-id-type="pmid">18497287</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fish</surname><given-names>J.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>FunGene: the functional gene pipeline and repository</article-title>. <source>Front. Microbiol</source>., <volume>4</volume>, <fpage>1</fpage>–<lpage>14</lpage>.<pub-id pub-id-type="pmid">23346082</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hanson</surname><given-names>N.W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>LCA*: an entropy-based measure for taxonomic assignment within assembled metagenomes</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>3535</fpage>–<lpage>3542</lpage>.<pub-id pub-id-type="pmid">27515739</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hua</surname><given-names>Z-s.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Insights into the ecological roles and evolution of methyl-coenzyme M reductase-containing hot spring Archaea</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>4574</fpage>.<pub-id pub-id-type="pmid">31594929</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huerta-Cepas</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>a) 
<article-title>eggNOG 4.5: a hierarchical orthology framework with improved functional annotations for eukaryotic, prokaryotic and viral sequences</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>D286</fpage>–<lpage>D293</lpage>.<pub-id pub-id-type="pmid">26582926</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huerta-Cepas</surname><given-names>J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>b) 
<article-title>ETE 3: reconstruction, analysis, and visualization of phylogenomic data</article-title>. <source>Mol. Biol. Evol</source>., <volume>33</volume>, <fpage>1635</fpage>–<lpage>1638</lpage>.<pub-id pub-id-type="pmid">26921390</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hurwitz</surname><given-names>B.L.</given-names></string-name></person-group> et al. (<year>2013</year>) <article-title>Metabolic reprogramming by viruses in the sunlit and dark ocean</article-title>. <source>Genome Biol</source>., <volume>14</volume>, <fpage>R123</fpage>.<pub-id pub-id-type="pmid">24200126</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huson</surname><given-names>D.H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2007</year>) 
<article-title>MEGAN analysis of metagenomic data</article-title>. <source>Genome Res</source>., <volume>17</volume>, <fpage>377</fpage>–<lpage>386</lpage>.<pub-id pub-id-type="pmid">17255551</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hyatt</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>Prodigal: prokaryotic gene recognition and translation initiation site identification</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>119</fpage>.<pub-id pub-id-type="pmid">20211023</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jehl</surname><given-names>P.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>OD-seq: outlier detection in multiple sequence alignments</article-title>. <source>BMC Bioinformatics</source>, <volume>16</volume>, <fpage>1</fpage>–<lpage>11</lpage>.<pub-id pub-id-type="pmid">25591917</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Katoh</surname><given-names>K.</given-names></string-name>, <string-name><surname>Standley</surname><given-names>D.M.</given-names></string-name></person-group> (<year>2013</year>) 
<article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol. Biol. Evol</source>., <volume>30</volume>, <fpage>772</fpage>–<lpage>780</lpage>.<pub-id pub-id-type="pmid">23329690</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Centrifuge: rapid and sensitive classification of metagenomic sequences</article-title>. <source>Genome Res</source>., <volume>26</volume>, <fpage>1721</fpage>–<lpage>1729</lpage>.<pub-id pub-id-type="pmid">27852649</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Konwar</surname><given-names>K.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>MetaPathways: a modular pipeline for constructing pathway/genome databases from environmental sequence information</article-title>. <source>BMC Bioinformatics</source>, <volume>14</volume>, <fpage>202</fpage>.<pub-id pub-id-type="pmid">23800136</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kozlov</surname><given-names>A.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Phylogeny-aware identification and correction of taxonomically mislabeled sequences</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>5022</fpage>–<lpage>5033</lpage>.<pub-id pub-id-type="pmid">27166378</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kozlov</surname><given-names>A.M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>RAxML-NG: a fast, scalable and user-friendly tool for maximum likelihood phylogenetic inference</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>4453</fpage>–<lpage>4455</lpage>.<pub-id pub-id-type="pmid">31070718</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Laso-Pérez</surname><given-names>R.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Thermophilic archaea activate butane via alkyl-coenzyme M formation</article-title>. <source>Nature</source>, <volume>539</volume>, <fpage>396</fpage>–<lpage>401</lpage>.<pub-id pub-id-type="pmid">27749816</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Le</surname><given-names>S.Q.</given-names></string-name>, <string-name><surname>Gascuel</surname><given-names>O.</given-names></string-name></person-group> (<year>2008</year>) 
<article-title>An improved general amino acid replacement matrix</article-title>. <source>Mol. Biol. Evol</source>., <volume>25</volume>, <fpage>1307</fpage>–<lpage>1320</lpage>.<pub-id pub-id-type="pmid">18367465</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Letunic</surname><given-names>I.</given-names></string-name>, <string-name><surname>Bork</surname><given-names>P.</given-names></string-name></person-group> (<year>2016</year>) 
<article-title>Interactive tree of life (iTOL) v3: an online tool for the display and annotation of phylogenetic and other trees</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>W242</fpage>–<lpage>W245</lpage>.<pub-id pub-id-type="pmid">27095192</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Letunic</surname><given-names>I.</given-names></string-name>, <string-name><surname>Bork</surname><given-names>P.</given-names></string-name></person-group> (<year>2019</year>) 
<article-title>Interactive Tree Of Life (iTOL) v4: recent updates and new developments</article-title>. <source>Nucleic Acids Res</source>., <volume>47</volume>, <fpage>W256</fpage>–<lpage>W259</lpage>.<pub-id pub-id-type="pmid">30931475</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Matsen</surname><given-names>F.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>pplacer: linear time maximum-likelihood and Bayesian phylogenetic placement of sequences onto a fixed reference tree</article-title>. <source>BMC Bioinformatics</source>, <volume>11</volume>, <fpage>538</fpage>.<pub-id pub-id-type="pmid">21034504</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Matthews</surname><given-names>B.W.</given-names></string-name></person-group> (<year>1975</year>) 
<article-title>Comparison of the predicted and observed secondary structure of T4 phage lysozyme</article-title>. <source>Biochim. Biophys. Acta</source>, <volume>405</volume>, <fpage>442</fpage>–<lpage>451</lpage>.<pub-id pub-id-type="pmid">1180967</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKay</surname><given-names>L.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Co-occurring genomic capacity for anaerobic methane and dissimilatory sulfur metabolisms discovered in the Korarchaeota</article-title>. <source>Nat. Microbiol</source>., <volume>4</volume>, <fpage>614</fpage>–<lpage>622</lpage>.<pub-id pub-id-type="pmid">30833730</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Merchant</surname><given-names>S.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2014</year>) 
<article-title>Unexpected cross-species contamination in genome sequencing projects</article-title>. <source>PeerJ</source>, <volume>2</volume>, <fpage>e675</fpage>.<pub-id pub-id-type="pmid">25426337</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Müller</surname><given-names>A.L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>Phylogenetic and environmental diversity of DsrAB-type dissimilatory (bi)sulfite reductases</article-title>. <source>ISME J</source>., <volume>9</volume>, <fpage>1152</fpage>–<lpage>1165</lpage>.<pub-id pub-id-type="pmid">25343514</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nasko</surname><given-names>D.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>RefSeq database growth influences the accuracy of k-mer-based lowest common ancestor species identification</article-title>. <source>Genome Biol</source>., <volume>19</volume>, <fpage>1</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">29301551</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nichols</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>Use of ichip for high-throughput in situ cultivation of “uncultivable microbial species”</article-title>. <source>Appl. Environ. Microbiol</source>., <volume>76</volume>, <fpage>2445</fpage>–<lpage>2450</lpage>.<pub-id pub-id-type="pmid">20173072</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B46">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ondov</surname><given-names>B.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>Mash: fast genome and metagenome distance estimation using MinHash</article-title>. <source>Genome Biol</source>., <volume>17</volume>, <fpage>132</fpage>.<pub-id pub-id-type="pmid">27323842</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B47">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parks</surname><given-names>D.H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2018</year>) 
<article-title>A standardized bacterial taxonomy based on genome phylogeny substantially revises the tree of life</article-title>. <source>Nat. Biotechnol</source>., <volume>36</volume>, <fpage>996</fpage>–<lpage>1004</lpage>.<pub-id pub-id-type="pmid">30148503</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B48">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pattengale</surname><given-names>N.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>How many bootstrap replicates are necessary?</article-title>  <source>J. Comput. Biol</source>., <volume>17</volume>, <fpage>337</fpage>–<lpage>354</lpage>.<pub-id pub-id-type="pmid">20377449</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B49">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peabody</surname><given-names>M.A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>Evaluation of shotgun metagenomics sequence classification methods using in silico and in vitro simulated communities</article-title>. <source>BMC Bioinformatics</source>, <volume>16</volume>, <fpage>363</fpage>.</mixed-citation>
    </ref>
    <ref id="btaa588-B50">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Price</surname><given-names>M.N.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>FastTree 2 - approximately maximum-likelihood trees for large alignments</article-title>. <source>PLoS One</source>, <volume>5</volume>, <fpage>e9490</fpage>.<pub-id pub-id-type="pmid">20224823</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B51">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rappé</surname><given-names>M.S.</given-names></string-name>, <string-name><surname>Giovannoni</surname><given-names>S.J.</given-names></string-name></person-group> (<year>2003</year>) 
<article-title>The uncultured microbial majority</article-title>. <source>Annu. Rev. Microbiol</source>., <volume>57</volume>, <fpage>369</fpage>–<lpage>394</lpage>.<pub-id pub-id-type="pmid">14527284</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B52">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rinke</surname><given-names>C.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>Insights into the phylogeny and coding potential of microbial dark matter</article-title>. <source>Nature</source>, <volume>499</volume>, <fpage>431</fpage>–<lpage>437</lpage>.<pub-id pub-id-type="pmid">23851394</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B53">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sczyrba</surname><given-names>A.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2017</year>) 
<article-title>Critical Assessment of Metagenome Interpretation-a benchmark of metagenomics software</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>1063</fpage>–<lpage>1071</lpage>.<pub-id pub-id-type="pmid">28967888</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B54">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Seitz</surname><given-names>K.W.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Asgard archaea capable of anaerobic hydrocarbon cycling</article-title>. <source>Nat. Commun</source>., <volume>10</volume>, <fpage>1822</fpage>.<pub-id pub-id-type="pmid">31015394</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B55">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shaiber</surname><given-names>A.</given-names></string-name>, <string-name><surname>Eren</surname><given-names>A.M.</given-names></string-name></person-group> (<year>2019</year>) 
<article-title>Composite metagenome-assembled genomes reduce the quality of public genome repositories</article-title>. <source>mBio</source>, <volume>10</volume>, <fpage>1</fpage>–<lpage>3</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa588-B56">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Solden</surname><given-names>L.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>The bright side of microbial dark matter: lessons learned from the uncultivated majority</article-title>. <source>Curr. Opin. Microbiol</source>., <volume>31</volume>, <fpage>217</fpage>–<lpage>226</lpage>.<pub-id pub-id-type="pmid">27196505</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B57">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Springer</surname><given-names>E.</given-names></string-name></person-group>  <etal>et al</etal> (<year>1995</year>) 
<article-title>Partial gene sequences for the A subunit of methyl-coenzyme M reductase (mcrI) as a phylogenetic tool for the family Methanosarcinaceae</article-title>. <source>Int. J. Syst. Bacteriol</source>., <volume>45</volume>, <fpage>554</fpage>–<lpage>559</lpage>.<pub-id pub-id-type="pmid">8590683</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B58">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stamatakis</surname><given-names>A.</given-names></string-name></person-group> (<year>2006</year>) 
<article-title>RAxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models</article-title>. <source>Bioinformatics</source>, <volume>22</volume>, <fpage>2688</fpage>–<lpage>2690</lpage>.<pub-id pub-id-type="pmid">16928733</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B59">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stark</surname><given-names>M.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2010</year>) 
<article-title>MLTreeMap - accurate Maximum Likelihood placement of environmental DNA sequences into taxonomic and functional reference phylogenies</article-title>. <source>BMC Genomics</source>, <volume>11</volume>, <fpage>461</fpage>.<pub-id pub-id-type="pmid">20687950</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B60">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steen</surname><given-names>A.D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>High proportions of bacteria and archaea across most biomes remain uncultured</article-title>. <source>ISME J</source>., <volume>13</volume>, <fpage>3126</fpage>–<lpage>3130</lpage>.<pub-id pub-id-type="pmid">31388130</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B61">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tan</surname><given-names>G.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2015</year>) 
<article-title>Current methods for automated filtering of multiple sequence alignments frequently worsen single-gene phylogenetic inference</article-title>. <source>Syst. Biol</source>., <volume>64</volume>, <fpage>778</fpage>–<lpage>791</lpage>.<pub-id pub-id-type="pmid">26031838</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B62">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>Y.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Expanding anaerobic alkane metabolism in the domain of Archaea</article-title>. <source>Nat. Microbiol</source>., <volume>4</volume>, <fpage>595</fpage>–<lpage>602</lpage>.<pub-id pub-id-type="pmid">30833728</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B63">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Whitman</surname><given-names>W.B.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2006</year>) <part-title>The methanogenic bacteria</part-title>. In: Dworkin,M. <italic toggle="yes">et al</italic>. (eds), <source>Prokaryotes</source>. 
<publisher-name>Springer</publisher-name>, 
<publisher-loc>New York, NY</publisher-loc>, pp. <fpage>165</fpage>–<lpage>207</lpage>.</mixed-citation>
    </ref>
    <ref id="btaa588-B64">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Woodcroft</surname><given-names>B.J.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2016</year>) 
<article-title>OrfM: A fast open reading frame predictor for metagenomic data</article-title>. <source>Bioinformatics</source>, <volume>32</volume>, <fpage>2702</fpage>–<lpage>2703</lpage>.<pub-id pub-id-type="pmid">27153669</pub-id></mixed-citation>
    </ref>
    <ref id="btaa588-B65">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname><given-names>D.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2013</year>) 
<article-title>TreeOTU: operational taxonomic unit classification based on phylogenetic trees</article-title>. <source>Preprint at <ext-link xlink:href="https://arxiv.org/abs/1308.6333" ext-link-type="uri">https://arxiv.org/abs/1308.6333</ext-link>.</source></mixed-citation>
    </ref>
    <ref id="btaa588-B66">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ye</surname><given-names>S.H.</given-names></string-name></person-group>  <etal>et al</etal> (<year>2019</year>) 
<article-title>Benchmarking metagenomics tools for taxonomic classification</article-title>. <source>Cell</source>, <volume>178</volume>, <fpage>779</fpage>–<lpage>794</lpage>.<pub-id pub-id-type="pmid">31398336</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
