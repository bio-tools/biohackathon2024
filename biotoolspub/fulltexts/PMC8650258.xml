<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">8650258</article-id>
    <article-id pub-id-type="publisher-id">2548</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-021-02548-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>geneBasis: an iterative approach for unsupervised selection of targeted gene panels from scRNA-seq</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Missarova</surname>
          <given-names>Alsu</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jain</surname>
          <given-names>Jaison</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Butler</surname>
          <given-names>Andrew</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ghazanfar</surname>
          <given-names>Shila</given-names>
        </name>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Stuart</surname>
          <given-names>Tim</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brusko</surname>
          <given-names>Maigan</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wasserfall</surname>
          <given-names>Clive</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Nick</surname>
          <given-names>Harry</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Brusko</surname>
          <given-names>Todd</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Atkinson</surname>
          <given-names>Mark</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Satija</surname>
          <given-names>Rahul</given-names>
        </name>
        <address>
          <email>rsatija@nygenome.org</email>
        </address>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9092-0852</contrib-id>
        <name>
          <surname>Marioni</surname>
          <given-names>John C.</given-names>
        </name>
        <address>
          <email>marioni@ebi.ac.uk</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.225360.0</institution-id><institution-id institution-id-type="ISNI">0000 0000 9709 7726</institution-id><institution>European Molecular Biology Laboratory, European Bioinformatics Institute, Wellcome Genome Campus, </institution></institution-wrap>Cambridge, UK </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.5335.0</institution-id><institution-id institution-id-type="ISNI">0000000121885934</institution-id><institution>Cancer Research UK Cambridge Institute, </institution><institution>University of Cambridge, </institution></institution-wrap>Cambridge, UK </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.429884.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 1791 0895</institution-id><institution>New York Genome Center, </institution></institution-wrap>New York, USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.137628.9</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8753</institution-id><institution>Center for Genomics and Systems Biology, NYU, </institution></institution-wrap>New York, USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.15276.37</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8091</institution-id><institution>Department of Pathology, Immunology, and Laboratory Medicine, College of Medicine, </institution><institution>University of Florida, </institution></institution-wrap>Jacksonville, USA </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.15276.37</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 8091</institution-id><institution>Department of Neuroscience, College of Medicine, </institution><institution>University of Florida, </institution></institution-wrap>Jacksonville, USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.10306.34</institution-id><institution-id institution-id-type="ISNI">0000 0004 0606 5382</institution-id><institution>Wellcome Sanger Institute, Wellcome Genome Campus, </institution></institution-wrap>Cambridge, UK </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>6</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>6</day>
      <month>12</month>
      <year>2021</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2021</year>
    </pub-date>
    <volume>22</volume>
    <elocation-id>333</elocation-id>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>7</month>
        <year>2021</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>11</month>
        <year>2021</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2021</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">scRNA-seq datasets are increasingly used to identify gene panels that can be probed using alternative technologies, such as spatial transcriptomics, where choosing the best subset of genes is vital. Existing methods are limited by a reliance on pre-existing cell type labels or by difficulties in identifying markers of rare cells. We introduce an iterative approach, geneBasis, for selecting an optimal gene panel, where each newly added gene captures the maximum distance between the true manifold and the manifold constructed using the currently selected gene panel. Our approach outperforms existing strategies and can resolve cell types and subtle cell state differences.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-021-02548-z.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
            <institution>national institutes of health</institution>
          </institution-wrap>
        </funding-source>
        <award-id>1OT2OD026673-01</award-id>
        <award-id>1OT2OD026673-01</award-id>
        <award-id>RM1HG011014-02</award-id>
        <award-id>K99HG011489-01</award-id>
        <award-id>U54AI142766</award-id>
        <award-id>U54AI142766</award-id>
        <award-id>U54AI142766</award-id>
        <award-id>U54AI142766</award-id>
        <principal-award-recipient>
          <name>
            <surname>Stuart</surname>
            <given-names>Tim</given-names>
          </name>
          <name>
            <surname>Wasserfall</surname>
            <given-names>Clive</given-names>
          </name>
          <name>
            <surname>Nick</surname>
            <given-names>Harry</given-names>
          </name>
          <name>
            <surname>Brusko</surname>
            <given-names>Todd</given-names>
          </name>
          <name>
            <surname>Atkinson</surname>
            <given-names>Mark</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>Rahul</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>John C.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>royal society (gb)</institution>
        </funding-source>
        <award-id>NIF\R1\181950</award-id>
        <principal-award-recipient>
          <name>
            <surname>Ghazanfar</surname>
            <given-names>Shila</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100007028</institution-id>
            <institution>leona m. and harry b. helmsley charitable trust</institution>
          </institution-wrap>
        </funding-source>
        <award-id>2004-03813</award-id>
        <award-id>2004-03813</award-id>
        <principal-award-recipient>
          <name>
            <surname>Brusko</surname>
            <given-names>Todd</given-names>
          </name>
          <name>
            <surname>Atkinson</surname>
            <given-names>Mark</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100000289</institution-id>
            <institution>cancer research uk</institution>
          </institution-wrap>
        </funding-source>
        <award-id>C9545/A29580</award-id>
        <principal-award-recipient>
          <name>
            <surname>Marioni</surname>
            <given-names>John C.</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>European Molecular Biology Laboratory (EMBL) (4843)</institution>
        </funding-source>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2021</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par2">Single-cell RNA sequencing (scRNA-seq) is a fundamental approach for studying transcriptional heterogeneity within individual tissues, organs, and organisms (reviewed in [<xref ref-type="bibr" rid="CR1">1</xref>]). A key step in the analysis of scRNA-seq data is the selection of a set of representative features, typically a subset of genes, that capture variability in the data and that can be used in downstream analysis. Established approaches for feature selection leverage quantitative per gene metrics that aim to identify genes that display more variability than expected by chance across the population of cells under study. Commonly used methods for detecting highly variable genes (HVG) utilize the relationship between mean and standard deviation of expression levels (reviewed in [<xref ref-type="bibr" rid="CR2">2</xref>]), GiniClust leverages Gini indices [<xref ref-type="bibr" rid="CR3">3</xref>], and M3Drop performs dropout-based feature selection [<xref ref-type="bibr" rid="CR4">4</xref>]. The number of selected genes is typically dependent on a user-defined threshold, but ordinarily is on the order of one to a few thousand genes [<xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR5">5</xref>]. A recently developed approach, scPNMF, further addresses the gene complexity problem by leveraging a Non-Negative Matrix Factorization (NMF) representation of scRNA-seq, with selected features being suggested to represent interesting biological variability in the data [<xref ref-type="bibr" rid="CR6">6</xref>]. scPNMF relies on the chosen dimension for the NMF representation and also does not directly compare informativeness between different factors, thus impeding the ability to compare the importance (i.e., gene weights) between different factors.</p>
    <p id="Par3">Framing the problem as searching for a <italic>fixed</italic> number of informative genes has recently gained practical relevance. Specifically, recent technological advances have given rise to multiple approaches where gene expression can be probed at single-cell resolution within a cell’s spatial context, thus enabling the relationship between individual cells and cell types to be studied (reviewed in [<xref ref-type="bibr" rid="CR7">7</xref>–<xref ref-type="bibr" rid="CR9">9</xref>]). One branch of spatial transcriptomics approaches builds on the concept of RNA fluorescence in situ hybridization (FISH), where probes are used to assay the number of molecules of a given gene present in a single cell [<xref ref-type="bibr" rid="CR10">10</xref>]. Newly developed approaches, such as seqFISH [<xref ref-type="bibr" rid="CR11">11</xref>–<xref ref-type="bibr" rid="CR14">14</xref>], MERFISH [<xref ref-type="bibr" rid="CR15">15</xref>–<xref ref-type="bibr" rid="CR17">17</xref>], and DARTFISH [<xref ref-type="bibr" rid="CR18">18</xref>], scale up classical RNA FISH strategies, allowing the expression of dozens to hundreds of genes to be assayed in parallel. The single-molecule resolution of these methods enables quantification of the location of individual RNA molecules inside a single cell, which has important implications for studying developmental, neuronal, and immune biology, where cell-cell interactions are highly informative. However, an important limitation of such methods is that the set of genes that can be probed is limited (typically in the low hundreds) and this set of genes needs to be selected prior to the experiment taking place. Additionally, carefully selected targeted libraries are relevant for CRISPR-seq screens [<xref ref-type="bibr" rid="CR19">19</xref>–<xref ref-type="bibr" rid="CR21">21</xref>] and, more recently, targeted single-cell gene expression assays [<xref ref-type="bibr" rid="CR22">22</xref>] have been developed, which improves capture efficiency and reduces experimental cost.</p>
    <p id="Par4">Current library design strategies leverage prior knowledge regarding the relevance of genes for the tissue of interest as well as using unsupervised marker selection, where matched scRNA-seq data is used to find genes of interest. If the goal is to identify genes that characterize clusters present in scRNA-seq data, existing marker selection methods can be applied, such as one-vs-all methods testing for genes that exhibit differential expression between clusters [<xref ref-type="bibr" rid="CR23">23</xref>–<xref ref-type="bibr" rid="CR26">26</xref>], ranking genes by correlation with the normalized boolean vectors corresponding to the clusters [<xref ref-type="bibr" rid="CR27">27</xref>] or random forest classification algorithms [<xref ref-type="bibr" rid="CR28">28</xref>, <xref ref-type="bibr" rid="CR29">29</xref>]. In addition to one-vs-all methods, the scGeneFit approach selects marker genes that jointly optimize cell type recovery using a label-aware compressive classification method, and returns the optimal set of markers given a user-defined panel size [<xref ref-type="bibr" rid="CR30">30</xref>].</p>
    <p id="Par5">The main drawback of these approaches is that they fundamentally rely on pre-determined cell type annotation, thus relying not only on the clustering algorithm but also that the correct granularity of clustering has been employed. By design, genes associated with intra-cell-type variation or genes that vary in expression over a subset of clustered cell types will not be captured by such approaches. While the latter type of signal is generally deemed uninteresting, in practice this will depend on the system and question in mind. For example, tracing stress response and DNA damage will be relevant when analyzing cancerous samples, and understanding proliferation rates and cell cycle state is important in numerous biological contexts.</p>
    <p id="Par6">These fundamental limitations of most existing marker selection methods can be resolved by deploying unsupervised selection methods that aim to capture features (genes) that describe all sources of variability present in scRNA-seq data, both within and across cell types. One recently developed method, SCMER, addresses this problem by aiming to find a set of genes that preserve the overall manifold structure of scRNA-seq data [<xref ref-type="bibr" rid="CR31">31</xref>]. While novel and algorithmically impressive, SCMER has limitations that hinder its utility in practice. First, SCMER strives to find a selection that preserves the whole manifold and returns a scalar estimate for how well the manifold is preserved in the form of a KL divergence between the “true” and the “selected” manifolds. However, this global score reflects the overall preservation of manifold structure and may not adequately weight or represent the local preservation of rare cell types. Additionally, to deal with batch effects, SCMER finds common sources of variation across most of the batches, which will be suboptimal for cell types that are present in only a few batches. This is not an uncommon case for datasets collected from different donors and different tissue sites.</p>
    <p id="Par7">To overcome these limitations, we have developed a novel cluster-free, batch-aware, and flexible approach, <italic>geneBasis</italic>, which takes scRNA-seq data and the number of genes to be selected and returns a ranked gene panel of the designated size. Importantly, we provide a comprehensive set of metrics—at multiple levels of granularity—that can be used to assess the completeness of the suggested panel. To incorporate expert knowledge, we allow users to preselect genes of interest. Additionally, by avoiding the use of predefined clusters, geneBasis allows discovery of genes that underpin transcriptional programs within any selected groups of cells (e.g., cell types). We demonstrate the power of our approach by applying it in a variety of biological contexts and compare its performance to existing state-of-the-art strategies.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>An algorithm for gene selection.</title>
      <p id="Par8">For a given scRNA-seq dataset, we represent transcriptional similarities between cells using <italic>k</italic>-nearest neighbor (<italic>k</italic>-NN) graphs (<xref ref-type="sec" rid="Sec11">Methods</xref>). A <italic>k</italic>-NN graph that is constructed using the entire transcriptome represents the “true” relationships between cells as manifested by the similarities in expression levels of individual genes between cells and their “true” neighbors. Subsequently, we aim to find a selection of genes that yields a <italic>k</italic>-NN graph similar to the “true” graph and is capable of predicting the true expression of any gene by using each cell’s neighbors.</p>
      <p id="Par9">Specifically, at each iteration (i.e., given the currently selected gene panel) we compare the graph constructed using the entire transcriptome (“true” <italic>k</italic>-NN graph) with a graph constructed using the current “selection” (“selection” graph). At a single gene level, we assess how well we can predict a gene’s expression levels across cells, using the cells neighbors in the “selection” graph compared to the “true” graph, and select the gene that shows the biggest discrepancy between the two graphs (Fig. <xref rid="Fig1" ref-type="fig">1</xref>). More precisely, for each gene, in the “true” graph we compute, across cells, the Minkowski distance between a gene’s expression in a given cell and its average expression in that cell’s <italic>k</italic>-nearest neighbors. Intuitively, this provides a baseline measure for how well a gene’s expression can be predicted by its nearest neighbors in a best-case scenario. Similarly, we compute the Minkowski distance for each gene using the “selection” graph. We then compute, for each gene, the difference in the distances between the “true” and “selection” graph and add the gene with the largest difference in distance to the selected set. This process is then repeated until the desired number of genes has been chosen.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Schematic overview of geneBasis. Below we describe the steps of the algorithm. (1) “True” <italic>k</italic>-NN graph is constructed, which represents the “ground truth” relationship between cells. Colors correspond to cell types for visualization but are not used by the algorithm. For each gene (<italic>Narf</italic> and <italic>Hba-a1</italic> are used as examples), we calculate the Minkowski distance between two vectors: the first vector corresponds to log-normalized expression for each cell (referred to as measured); the second vector corresponds to the average log-normalized expressions across the first <italic>k</italic> neighbors for each cell (referred to as predicted). (2) For the current selection the “Selection” graph is constructed to represent the relationship between cells using currently selected genes. As in (1), for each gene we calculate the Minkowski distance between measured and predicted counts. (3) The Minkowski distances are compared for each gene, and the gene with the biggest difference between Selected and True graphs (in the schematic - <italic>Hba-a1</italic>) is added to the current selection. (4) Steps (2)–(3) are repeated until the number of selected genes reaches the desired value</p></caption><graphic xlink:href="13059_2021_2548_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par10">An important limitation of existing methods is the inability to properly assess how complete and informative the designed gene panel is. To address this, we derived three metrics that evaluate gene panels at different levels of granularity: cell type, cell, and gene level.</p>
      <p id="Par11">The first metric explores whether cell types can be assigned in a specific and sensitive manner. Specifically, while geneBasis does not rely on clustering, for scRNA-seq datasets where annotations already exist, they can be exploited. To do so, we construct a <italic>k</italic>-NN graph for all cells using the selected gene panel and compare for each cell its (pre-determined) cell type label with the (pre-determined) labels assigned to its nearest neighbors (<xref ref-type="sec" rid="Sec11">Methods</xref>). This allows construction of a confusion matrix that provides insight into whether cells from the same type are grouped together in the graph constructed using the selected panel.</p>
      <p id="Par12">As a second metric, which does not rely on cell type annotation, we focused on examining how well an individual cell’s neighborhood is preserved. For each cell, we compute its nearest neighbors in the “true” and “selected” graph. Subsequently, in the “true” graph space, we compare the distance between each cell and these two sets of nearest neighbors (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). Intuitively, when the set of neighbors is identical in both the “true” and “selection” graph, this metric will output a score of 1, while a score close to 0 indicates that a cell’s neighbors in the “selection” graph are randomly distributed across the “true” manifold.</p>
      <p id="Par13">Finally, a third metric for assessing the quality of the selected gene panels focuses on individual genes (<xref ref-type="sec" rid="Sec11">Methods</xref>). For each gene, we compute the correlation (across cells) between its log-normalized expression values and its average log-normalized expression values across <italic>k</italic>-nearest neighbors in a graph. We compute correlations for the “true graph” and for the “selected graph,” and use the ratio (“selected”/“true”) as the final gene prediction score.</p>
    </sec>
    <sec id="Sec4">
      <title>geneBasis allows recovery of local and global variability</title>
      <p id="Par14">To evaluate whether geneBasis efficiently recovers a selection of genes that preserves both local and global structure, we applied geneBasis, as well as SCMER and scGeneFit (<xref ref-type="sec" rid="Sec11">Methods</xref>), to four diverse systems representing challenges that frequently arise in scRNA-seq datasets:
<list list-type="order"><list-item><p id="Par15">A study of mouse embryogenesis at embryonic day (E)8.5, coinciding with early organogenesis [<xref ref-type="bibr" rid="CR32">32</xref>]. This dataset contains both abundant and rare cell types as well as multiple different trajectories.</p></list-item><list-item><p id="Par16">A newly generated dataset profiling cells from the adult human spleen. As part of the lymphatic system, the spleen contains transcriptionally similar immune cell types that are not straightforward to resolve with a limited number of genes.</p></list-item><list-item><p id="Par17">Multiple independent studies of the adult human pancreas dataset, consisting of multiple batches from various donors and experiments [<xref ref-type="bibr" rid="CR33">33</xref>–<xref ref-type="bibr" rid="CR38">38</xref>].</p></list-item><list-item><p id="Par18">Transcriptional profiling of melanoma samples from 19 donors collected at different stages of disease progression [<xref ref-type="bibr" rid="CR39">39</xref>].</p></list-item></list></p>
      <p id="Par19">Overall, using the metrics defined above, the gene panels chosen by geneBasis (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Table S1) yield better performance than those chosen by SCMER (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B, C). This is true both in terms of preserving cell neighborhoods and in terms of the fraction of cells for which the neighborhood was poorly predicted (Fig. <xref rid="Fig2" ref-type="fig">2</xref>B, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2A). The effect was most noticeable when a small number of genes were selected, with differences in performance decreasing as the number of genes selected increased (with the exception of the spleen, where geneBasis consistently outperforms SCMER). This is of practical relevance for designing gene panels for FISH-based experiments, where the number of selected genes can be an important limiting factor.
<fig id="Fig2"><label>Fig. 2</label><caption><p>geneBasis preserves local and global structure. Each column represents the results for a different biological system. <bold>A</bold> Co-expression within top 10 selected by geneBasis genes. <bold>B</bold> Upper panel: The overall convergence of cell neighborhood preservation distributions for geneBasis (in red) and SCMER (in blue) as a function of the number of selected genes. Lower panel: the weight of tails of the distributions (i.e., fraction of cells with neighborhood preservation score &lt; 0.5). Values are rescaled as ln(<italic>x</italic> + 1). <bold>C</bold> The fraction of cells mapped to the correct cell type for geneBasis (in red) and scGeneFit (in orange) as a function of number of genes in the selection. <bold>D</bold> Upper panel: The distribution of neighborhood preservation scores (calculated for the first 150 genes) per cell type. Lower panel: UMAP representation colored by neighborhood preservation score (calculated for the first 150 genes). UMAP coordinates themselves were calculated using the whole transcriptome. For visualization purposes, cell neighborhood preservation scores lower than 0 were set equal to 0</p></caption><graphic xlink:href="13059_2021_2548_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par20">We hypothesize that the difference in performance arises due to the nature of the L1-regularization utilized by SCMER. In general, regularizations like Lasso tend to discourage redundancy among the selected features. However, this may not hold if the strength of the regularization is chosen manually and lies above an appropriately selected range [<xref ref-type="bibr" rid="CR40">40</xref>]. We empirically support this hypothesis by assessing the redundancy within selected gene panels for both geneBasis and SCMER (Fig. <xref rid="Fig2" ref-type="fig">2</xref>A, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S3). Specifically, when a low number of genes is selected, SCMER tends to select highly co-expressed genes.</p>
      <p id="Par21">Additionally, from the beginning of the search, geneBasis prioritizes genes that allow delineation of cell types as well as scGeneFit, a method that specifically addresses the task of cell type separation (Fig. <xref rid="Fig2" ref-type="fig">2</xref>C). Moreover, geneBasis robustly recovers genes that delineate cell types even if a preselected set of genes is provided (<xref ref-type="sec" rid="Sec11">Methods</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S4). Taken together, we suggest that geneBasis represents an efficient method to successfully resolve cell types and to preserve the overall manifold.</p>
      <p id="Par22">Another essential aspect of targeted gene panel design is to determine whether enough genes have been selected to capture variability in the dataset of interest. To this end, the cell neighborhood preservation metric can be exploited to investigate whether specific transcriptional neighborhoods are enriched for cells with low scores, suggesting that these neighborhoods are not preserved well by the current selection. Across the benchmarked datasets, we illustrate this by focusing on the first 150 selected genes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). We observe that although there exist subtle differences between cell types, the majority of cell types (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D, upper panel) and regions of the high-dimensional space (Fig. <xref rid="Fig2" ref-type="fig">2</xref>D, lower panel) were well covered by the selected panels, indicative of good performance (the only striking exception was in the melanoma dataset, in particular for cells that could not be assigned a clear label in the original analysis). Consistent with these results, we also observed high imputation accuracy for the expression of genes that were not among the selected set (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2B, C). More generally, we anticipate that a user may not necessarily want to select an exact number of genes, but rather may have an upper limit of genes that they could feasibly profile. In these cases, we advise running geneBasis until the limit is reached, before assessing when the cell neighborhood preservation and gene prediction score distributions converge as a function of the number of genes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S2). Finally, it is important to stress that the gene panel evaluation is independent of the selection method employed and can be used to compare two or more panels generated by any approach.</p>
    </sec>
    <sec id="Sec5">
      <title>geneBasis accounts for batch effect and handles unbalanced cell type composition</title>
      <p id="Par23">Careful consideration and adjustment for batch effects is one of the most challenging aspects of scRNA-seq data analysis [<xref ref-type="bibr" rid="CR41">41</xref>]. In the context of gene selection, SCMER performs gene selection for each sample individually, and then retains features identified in all/most samples. While this is an efficient way to discard genes that show technical variability, such an approach might also discard genes with strong biological relevance that are only captured in a small fraction of samples, e.g., cell type markers for cell types present in &lt; 50% of the batches. Importantly, such unbalanced cell type composition is not uncommon in practice.</p>
      <p id="Par24">To account for this, in cases where a batch is specified by a user (i.e., every cell is assigned to a batch), we construct <italic>k</italic>-NN graphs (“true” and “selection”) within each batch, thereby assigning nearest neighbors only from the same batch and mitigating technical effects. Minkowski distances per genes are calculated across all cells from every batch thus resulting in a single scalar value for each gene. Importantly, if a certain cell type is present only in one batch, cells from this cell type will be consistently “mismapped” if none of its marker genes are selected, and therefore, the algorithm will select one of the marker genes.</p>
      <p id="Par25">To assess our approach, we utilized the first dataset described above, which consisted of four independent batches (samples) from the same stage of mouse development (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5). In each batch, a considerable fraction of cells were associated with blood lineage (11–27%, <xref ref-type="sec" rid="Sec11">Methods</xref>). Next, we artificially removed cells in a batch-aware manner, thus keeping cells from the blood lineage in 1, 2, or 3 batches, as well as adding a positive control (retaining blood lineage in all the batches) and a negative control (removing blood lineage from all the batches). We applied geneBasis and SCMER to these different settings. geneBasis efficiently (among first 10 genes) selected one of the blood markers for each combination except for the negative control (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S5C). SCMER identified strong markers in the positive control setting and when the blood lineage was retained in at least 2 of the 4 samples. However, it did not select any blood markers when the blood lineage was retained in only one sample (overall fraction of blood lineage cells in this combination was nearly 5%), even though the selection provided by SCMER was identified by the algorithm as of satisfactory quality (all selected genes for this case and KL divergence are listed in Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Table S2).</p>
    </sec>
    <sec id="Sec6">
      <title>Computational complexity of geneBasis</title>
      <p id="Par26">With rapid increases in the size of scRNA-seq datasets, computational complexity of any algorithm is of increasing importance. Consequently, we sought to estimate the running time of geneBasis, to ensure its scalability. We established that three parameters are relevant for the computational complexity of the algorithm: <italic>n</italic> - number of cells, <italic>D</italic> - number of pre-filtered genes that undergo gene search, and <italic>p</italic> - number of genes we want to select. In practice, <italic>p</italic> will almost never exceed a few hundreds and <italic>D</italic> will never exceed 15,000–20,000, meaning that the limiting parameter is the number of cells. Accordingly, we estimated running time for a series of spleen scRNA-seq sub-datasets (<xref ref-type="sec" rid="Sec11">Methods</xref>), while varying <italic>n</italic> from ~ 5000 to ~ 30,000. We also varied <italic>D</italic> from 1000 to 10,000, and <italic>p</italic> from 50 to 150. For the selected range, we observe a linear relationship between elapsed time and number of cells, and exponential increase in complexity as a function of <italic>p</italic> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>A). As anticipated, change in <italic>n</italic> had a higher effect on the running time compared to change in <italic>D</italic> (Fig. <xref rid="Fig3" ref-type="fig">3</xref>B). Additionally, we compared computational complexity between geneBasis and SCMER and established that across the tested range of <italic>n</italic>, <italic>p</italic>, and <italic>D</italic> geneBasis outperforms SCMER (Fig. <xref rid="Fig3" ref-type="fig">3</xref>C, for the details of the comparison see <xref ref-type="sec" rid="Sec11">Methods</xref>). Note that this might not hold true for higher values of <italic>p</italic>, but since for all tested datasets selections with 150 genes appeared to be sufficient and complete (Fig. <xref rid="Fig2" ref-type="fig">2</xref>), we suggest that <italic>p</italic> &lt; = 150 is a reasonable assumption. We further suggest that if a greater reduction in computational complexity is desired, appropriate downsampling strategies can be applied (Additional file <xref rid="MOESM4" ref-type="media">4</xref>: Supplementary Note 1).
<fig id="Fig3"><label>Fig. 3</label><caption><p>Estimation of computational complexity. <bold>A</bold> Distribution of elapsed time as a function of number of geneBasis selected genes (<italic>X</italic>-axis) and number of cells present in a scRNA-seq dataset (in color). <bold>B</bold> Distribution of elapsed time as a function of number of geneBasis selected genes (<italic>X</italic>-axis) and initial number of genes (in color). <bold>C</bold> Distribution of elapsed time as a function of number of selected genes (in facets) and number of cells (<italic>X</italic>-axis). Colors correspond to different methods</p></caption><graphic xlink:href="13059_2021_2548_Fig3_HTML" id="MO3"/></fig></p>
    </sec>
    <sec id="Sec7">
      <title>geneBasis resolves rare cell types and unannotated inter-cell-type variability</title>
      <p id="Par27">Cellular identity, which is typically represented on the level of cell type, is a basic and essential unit of information that any gene library needs to recapitulate. In other words, a “biologically” complete gene library should delineate all cell types, including rare ones, for which statistical methods can be occasionally underpowered. However, it also should be able to capture intra-cell-type variability in cases where discrete clustering has not been performed to the appropriate resolution and identify genes that display gradual changes in expression across the high-dimensional space, consistent with developmental trajectories. To address whether geneBasis satisfies the above criteria, we focused on three datasets: mouse embryogenesis, human spleen, and human pancreas. All datasets contain annotated cell type labels and involve combinations of abundant and rare cell types (Fig. <xref rid="Fig4" ref-type="fig">4</xref>B, H, J; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6A; S7A,E). Moreover, each dataset contains cell types that are distinct and closely related, making them highly appropriate for the task (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6A; S7A,E).
<fig id="Fig4"><label>Fig. 4</label><caption><p>geneBasis delineates cell types regardless of their abundance and resolves unannotated inter-cell-type variability. Panels <bold>A</bold>–<bold>F</bold> correspond to mouse embryogenesis; <bold>G</bold>, <bold>H</bold> correspond to spleen, and <bold>I</bold>, <bold>J</bold> correspond to pancreas analysis. <bold>A</bold> Cell type confusion matrix for the first 100 selected genes (prog. = progenitors; mes. = mesoderm; Brain = Forebrain/Midbrain/Hindbrain). <bold>B</bold> Ordered bar plot representing relative cell type abundance. <bold>C</bold> Upper panel: UMAP representation of Cardiomyocytes, colored by clusters from Tyser et al, when integration between datasets was performed using all genes. Lower panel: UMAP representation of Cardiomyocytes, colored by mapped cardiac clusters, when integration between datasets was performed using selection from geneBasis. UMAP coordinates themselves were calculated using the whole transcriptome. <bold>D</bold> Confusion matrix for cardiac clusters, where the mapping using all genes is used to assign true identity and mapping using the geneBasis selection is used to represent a mapped cluster. <bold>E</bold> Upper panel: UMAP representation of Gut tube, colored by mapped organs (Nowotschin et al.), when integration between datasets was performed using all genes. Lower panel: UMAP representation of the Gut tube, colored by mapped organs, when integration between datasets was performed using the selection from geneBasis. UMAP coordinates themselves were calculated using the whole transcriptome. <bold>F</bold> Confusion matrix for the emerging organs present along the gut tube, where mapping using all genes are used to assign cells to a true cluster and the geneBasis selection is used to represent a mapped cluster. <bold>G</bold> Cell type confusion matrix generated using the first 100 selected genes. For cell types in spleen, we use abbreviations, see Table S2 for full annotations. <bold>H</bold> Ordered bar plot representing relative cell type abundance. <bold>I</bold> Cell type confusion matrix for the first 100 selected genes. <bold>J</bold> Ordered bar plot representing relative cell type abundance</p></caption><graphic xlink:href="13059_2021_2548_Fig4_HTML" id="MO4"/></fig></p>
      <p id="Par28">For the study of mouse embryogenesis, selecting only 20 genes accurately resolves most cell types (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6B), with 50–100 genes being sufficient to achieve nearly perfect matching (Fig. <xref rid="Fig4" ref-type="fig">4</xref>A; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6C). The minor exceptions comprise transcriptionally related cell types, such as the visceral endoderm and the gut, where only few (if any) differentiating markers exist and cell types, and cell type classification is made using the degree of expression of commonly shared markers. Nevertheless, in all such cases, geneBasis selects several genes that could in principle be used to differentiate the cell types (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6D, E).</p>
      <p id="Par29">Having determined that geneBasis identifies genes that characterize annotated cell types, we next asked whether it could find genes associated with more subtle biological signals present in the data. To this end, we exploited recently published studies focused on myocardium development [<xref ref-type="bibr" rid="CR42">42</xref>] and gut tube formation [<xref ref-type="bibr" rid="CR43">43</xref>] (<xref ref-type="sec" rid="Sec11">Methods</xref>). We first integrated (using all genes) cells annotated as cardiomyocytes from the scRNA-seq atlas for the whole embryo together with cells from [<xref ref-type="bibr" rid="CR42">42</xref>] that were isolated from the anterior cardiac region of mouse embryos, and assigned cluster identities to cardiomyocytes cells (<xref ref-type="sec" rid="Sec11">Methods</xref>; Fig. <xref rid="Fig4" ref-type="fig">4</xref>C). As expected, all cells were assigned to the mesodermal cardiac lineage, with the majority being assigned to the most differentiated cardiomyocytes (Me3). Consistent with Tyser et al., the integrated data also reveal two trajectories leading to the most differentiated Me3 cluster: an FHF-like differentiation trajectory linking Me5, Me4, and Me3 and a SHF-like trajectory via Me7. Importantly, when using only the first 100 genes selected by geneBasis, we were able to recapitulate this structure (Fig. <xref rid="Fig4" ref-type="fig">4</xref>C, D). Among the 100 genes, 13 were differentially expressed in cardiomyocytes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6F), including markers for the FHF-trajectory (<italic>Sfrp5</italic>), strong markers for the differentiated Me3-state (<italic>Myl2</italic>) and contractile markers (<italic>Ttn</italic>) that exhibit gradual expression along the differentiation trajectory of the myocardium (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6G). Additionally, the selection of genes when performed only within Cardiomyocytes also contains genes marking different Me-clusters (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6J). Similarly, when focusing on the gut tube, and using the refined annotation provided by [<xref ref-type="bibr" rid="CR43">43</xref>], we observed that the set of genes chosen by geneBasis recovered the distinct populations of cells arranged across the Anterior-Posterior axis (Fig. <xref rid="Fig4" ref-type="fig">4</xref>E, F; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S6H, I, K).</p>
      <p id="Par30">Next, we explored the ability of geneBasis to select genes that captured heterogeneity among the populations of immune cells present in the adult human spleen. As expected, compared to mouse development, the ability to discriminate between the set of transcriptionally similar cell types present in the spleen required more genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7B, C). Nevertheless, selection of 100 genes allowed most cell types to be identified in a sensitive and specific manner (Fig. <xref rid="Fig4" ref-type="fig">4</xref>G, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7D). Similarly to mouse embryogenesis, the occasional mismapping of cells occurred between transcriptionally similar cell types, such as follicular and marginal zone B cells, as well as CD4+ and CD8+ T cells and innate lymphoid cells. Of note, the difficulty of using only the transcriptome to distinguish between different types of T cells is well known [<xref ref-type="bibr" rid="CR44">44</xref>], and it has been suggested that a more precise annotation of T cells can be obtained by generating paired measurements of cellular transcriptomes and immunophenotypes [<xref ref-type="bibr" rid="CR45">45</xref>].</p>
      <p id="Par31">Finally, we benchmarked geneBasis on a thoroughly annotated and integrated dataset of human pancreas, containing numerous rare cell types—8 of the 13 annotated cell types account for less than 5% of the overall dataset. Nevertheless, and similarly to the previous examples, we quickly and accurately predict all cell types with the exception of rare cycling cells, which are occasionally conflated with highly abundant alpha cells (Fig. <xref rid="Fig4" ref-type="fig">4</xref>I; Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S7F, G).</p>
    </sec>
    <sec id="Sec8">
      <title>geneBasis captures signals associated with cell states</title>
      <p id="Par32">We next examined whether geneBasis could identify sources of biological variation that in principle can be recovered from scRNA-seq data but that are frequently overlooked because they do not contribute to cell identity per se. Examples of such genes include cell state markers associated with transient biological processes, such as cell cycle, DNA damage repair, and oxidative stress. Depending on the biological context, this cell state information can be highly relevant for in situ profiling. For example, cell cycle genes are typically not included in gene panels for spatial transcriptomics experiments [<xref ref-type="bibr" rid="CR11">11</xref>, <xref ref-type="bibr" rid="CR14">14</xref>, <xref ref-type="bibr" rid="CR16">16</xref>], partially due to high abundance of cyclin mRNAs and partially due to the notion that this signal is frequently deemed to be uninteresting. However, in the context of tumorigenesis, DNA damage, cell cycle, and proliferation of malignant cells are the hallmarks of disease progression, and mapping this information spatially could be highly insightful.</p>
      <p id="Par33">To illustrate that geneBasis successfully and sufficiently recovers cell state genes indicative of ongoing biological processes, we analyzed the set of genes recovered in two distinct biological settings: melanoma (Fig. <xref rid="Fig5" ref-type="fig">5</xref>A) as well as activated lymphocytes (Additional file <xref rid="MOESM5" ref-type="media">5</xref>: Supplementary Note 2, for CITE-seq dataset [<xref ref-type="bibr" rid="CR46">46</xref>]). The melanoma dataset consists of ~ 4500 cells isolated from 19 patients, containing malignant, immune, stromal, and endothelial cells. Within the first 100 genes selected, we identified 53 markers that were differentially expressed between the annotated cell types (<xref ref-type="sec" rid="Sec11">Methods</xref>) and verified that these resolve all cell types, including the rare population of NK cells that are transcriptionally similar to highly abundant T cells (Fig. <xref rid="Fig5" ref-type="fig">5</xref>B, C).
<fig id="Fig5"><label>Fig. 5</label><caption><p>geneBasis identifies cell state genes relevant for heterogeneity across multiple cell types in the context of cancer. <bold>A</bold> UMAP representation, colored by malignancy status and annotated cell types. UMAP coordinates themselves were calculated using the whole transcriptome. <bold>B</bold> Cell type confusion matrix for non-malignant cells. <bold>C</bold> Ordered barplot for cell type abundance. <bold>D</bold> Co-expression (within all cells, left panel; within malignant cells, right panel) for selected genes associated with various transcriptional programs identified in the original publication. Colors correspond to detected programs, corresponding legend is on the right</p></caption><graphic xlink:href="13059_2021_2548_Fig5_HTML" id="MO5"/></fig></p>
      <p id="Par34">The majority of the remaining genes were globally differentially expressed between malignant and non-malignant cells (8 and 26 genes were down- and upregulated respectively in malignant cells). In the original study, a substantial degree of transcriptional heterogeneity was characterized across individual cells, both malignant and healthy, mostly associated with cell cycle, variation in MITF and AXL levels, and activation of the exhaustion program in T cells. Importantly, among the upregulated genes, we identified markers of transcriptional programs described in the original study such as tumor progression and cell exhaustion.</p>
      <p id="Par35">Finally, 13 genes were neither identified as cell type markers nor significantly up- or downregulated in malignant cells. Among those we found <italic>JunB</italic>, <italic>B2M</italic>, and <italic>Narf2</italic>—markers of inflammation, cell exhaustion, and melanoma oncogenic programs taking place in malignant and T cells. Overall, we select cell state markers for all cell states characterized in the original publication programs including MITF and AXL (Fig. <xref rid="Fig5" ref-type="fig">5</xref>D). We observed a low degree of co-expression among these genes, with the exception of cell cycle genes and genes associated with the MITF program. Low co-expression is consistent both across all cells and within malignant cells, suggesting that these cell state genes are indicative of distinct transcriptional programs.</p>
    </sec>
    <sec id="Sec9">
      <title>geneBasis selects genes that resolve cell types in seqFISH+ data</title>
      <p id="Par36">Technical differences between scRNA-seq and FISH-based technologies affect the scaling, magnitude of variance, and overall distribution of the expression, either across multiple genes or in a gene-specific manner [<xref ref-type="bibr" rid="CR46">46</xref>]. To assess whether the panel selected by geneBasis resolves cell types not only in the scRNA-seq from which it was derived, but in the matched -FISH data themselves, we applied geneBasis to a published seqFISH+ study profiling the olfactory bulb of a mouse using a 10,000 gene probe set [<xref ref-type="bibr" rid="CR13">13</xref>]. To select a ranked gene panel, we used corresponding scRNA-seq from [<xref ref-type="bibr" rid="CR47">47</xref>], covering various anatomical units of a mouse brain.</p>
      <p id="Par37">First, to ensure that the reference scRNA-seq dataset sufficiently covers the heterogeneity captured in the seqFISH+ sample, we generated a joint embedding in the latent space between scRNA-seq and seqFISH+ cells (<xref ref-type="sec" rid="Sec11">Methods</xref>, Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8A). Both data sets contain cluster/cell type labels, and we confirm that cells from the same or comparable cell types fall in the same latent spaces (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8A, B). This suggests that biological variability between cells from different cell types outweigh technical differences between scRNA-seq and seqFISH technologies, thereby supporting the notion of using scRNA-seq data to select genes that are relevant for seqFISH.</p>
      <p id="Par38">Next we applied geneBasis to the corresponding scRNA-seq dataset and considered the top 150 genes (across genes probed in the seqFISH+ assay) and assessed whether the selected genes can resolve distinct seqFISH+ clusters identified using the full dataset. To do so, we estimated the cell type mapping accuracy for normalized logcounts from the seqFISH+ data using only the selected panel (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8C, left panel). To estimate how much scaling differences between scRNA-seq and seqFISH factor in the performance of the library, we added a positive control where we applied geneBasis to the seqFISH+ data itself, and then evaluated the performance of this panel using the seqFISH+ data (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8C, center panel). Finally, to estimate a per cell type upper bound of cell type mapping accuracy, we calculated cell type mapping accuracy on seqFISH+ data using all 10,000 genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8C, right panel). Overall, the selection from seqFISH+ shows a moderate increase in cell type mapping accuracy for some cell types when compared to the selection from scRNA-seq. Nevertheless, both selections show rapid convergence to the estimated upper limit with the exception of a small number of rare cell types (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S8C, D). Thus, we suggest that geneBasis captures biological heterogeneity that is capable of overcoming technical differences between scRNA-seq and seqFISH.</p>
    </sec>
  </sec>
  <sec id="Sec10">
    <title>Discussion and conclusions</title>
    <p id="Par39">For the last decade, scRNA-seq technology has transformed our ability to explore molecular heterogeneity in a variety of biological systems. More recent technological advances such as single-cell multi-omics assays, CRISPR screens, and spatial transcriptomics go beyond measuring only the transcriptome, thus facilitating a more complete understanding of the features that underpin cellular function. In many of these cases, particularly for a large number of spatial transcriptomics assays, selecting the set of genes to probe is an important parameter, which in turn necessitates the emergence of appropriate computational tools.</p>
    <p id="Par40">In this study, we introduce geneBasis, which uses existing scRNA-seq data to select genes in a cluster-free and highly flexible manner. We have shown that geneBasis outperforms existing methods, both in terms of computational speed and in identifying relevant sets of genes and that geneBasis selects genes that characterize both local and global axes of variation that can be recovered from a <italic>k</italic>-NN graph representation of transcriptional similarities. geneBasis also allows user knowledge to be directly incorporated by selecting, a priori, a set of genes of particular biological relevance, which are then augmented by the algorithm.</p>
    <p id="Par41">Although we have addressed several important challenges, our approach has limitations that need to be considered, especially when designing libraries for FISH-based experiments. Firstly, scRNA-seq and FISH-based technologies use different approaches for assessing the number of mRNA molecules that are associated with a given gene, which in turn creates discrepancies in capture efficiency between the two technologies [<xref ref-type="bibr" rid="CR46">46</xref>]. Practically, it is observed that FISH-based technologies capture more mRNAs per cell due to a high sequence specificity in probe design. Consequently, genes selected using scRNA-seq will likely have higher detection rates in FISH-based experiments. While this is beneficial for detection of cell types that rely on a low number of selected markers, it can be a problem since FISH-based experiments are experimentally limited by the total number of individual molecules that can be detected in any given cell. Accordingly, it is advised to limit the number of ubiquitously or highly expressed genes. By design, geneBasis does not perform initial pre-filtering of housekeeping genes (since some could be highly relevant, such as markers of the cell cycle) nor it does discard them from the selected libraries. Therefore, we provide an option for users to filter out ubiquitously expressed genes either in the initial submission or post hoc.</p>
    <p id="Par42">Another important aspect to be accounted for in the library design is redundancy (i.e., the presence of multiple genes that are co-expressed and that mark the same cell type(s)). In practice, although geneBasis is not explicitly designed to completely eliminate redundancy in the selection, we typically observed only a small number of redundant genes. In general, this is a desirable property, since it maximizes the number of distinct biological processes that can be examined. However, for cell types of specific interest, it may be useful to add a small number of redundant genes to the library to avoid risks associated with technical probe failure during the experiment.</p>
    <p id="Par43">Finally, since geneBasis does not rely upon clustering of the scRNA-seq data, it does not directly capture “positive” cell type markers. As an example, when examining the ability to detect primordial germ cells (PGCs), a rare population comprising ~ 0.1% of cells in the mouse embryo study, we showed above that selecting 100 genes successfully resolves all cell types including PGCs. However, manual annotation of the selected genes revealed that we do not select unique positive PGC markers in the selected set. Instead, we select two semi-specific PGC markers, <italic>Ifitm1</italic> and <italic>Phlda2</italic>, which are shared with other cell types such as somitic and extra-embryonic mesoderm, extra-embryonic endoderm, and allantois. The ability to discriminate PGCs from the other related cell types is possible due to the inclusion of genes that mark these related cell types as opposed to the inclusion of specific PGC marker genes (of note, among the top 200 genes we include <italic>Dppa3</italic>—a highly specific and sensitive PGC marker). Consequently, we suggest that in cases where sensitive and specific identification of cell types, particularly rare ones, is a high priority, that appropriate marker selection methods are applied alongside geneBasis, thus ensuring the inclusion of specific cell type markers.</p>
  </sec>
  <sec id="Sec11">
    <title>Methods</title>
    <sec id="Sec12">
      <title>Code availability</title>
      <p id="Par44">Scripts to generate data and to perform the above analysis are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/MarioniLab/am_geneBasis">https://github.com/MarioniLab/am_geneBasis</ext-link>.</p>
    </sec>
    <sec id="Sec13">
      <title>Detailed overview of the geneBasis algorithm</title>
      <p id="Par45">Below we describe the workflow of the algorithm, characterize optional parameters, and justify the default settings.</p>
      <sec id="Sec14">
        <title>Initial selection of genes</title>
        <p id="Par46">We perform initial pre-filtering of genes by using the function scran::modelGeneVar, var.threshold = 0. If the number of variable genes exceeds <italic>n</italic> = 10,000, we use the first 10,000 variable genes as default. Additionally, we filter out mitochondrial genes. If a user wants to perform more selective filtering, this can be done manually (by using scRNA-seq entries for only pre-filtered genes) or by tuning var.threshold and <italic>n</italic>.</p>
      </sec>
      <sec id="Sec15">
        <title><italic>k</italic>-NN graph representations for “true” and “selection” graphs</title>
        <p id="Par47">
          <list list-type="bullet">
            <list-item>
              <p id="Par48">We use log-normalized counts for scRNA-seq data as an input for the algorithm.</p>
            </list-item>
            <list-item>
              <p id="Par49">We construct <italic>k</italic>-NN graphs, for both true and selection graphs, by using the function BiocNeighbors::findKNN, and represent each cell’s neighborhood using the first 5 neighbors. As a default, we use n.neigh = 5 as an appropriate compromise between mitigating potential noise in scRNA-seq data together with the potential existence of very rare cell types, where n.neigh &gt; 5 can hide true biological variability. The same default is used to compute the cell neighborhood preservation and gene prediction scores. This variable can be tuned by the user.</p>
            </list-item>
            <list-item>
              <p id="Par50">For the “true” graph, we first compute principal components by using the function irlba::prcomp_irlba, <italic>n</italic> = 50, and apply BiocNeighbors::findKNN on the first 50 PCs.</p>
            </list-item>
            <list-item>
              <p id="Par51">For the “selection” graphs, the PCA step is optional and by default is not performed. In practice, we observed that omitting the PCA step for the construction of “selection” graphs did not lead to different results when selections are generated with fewer than 250 genes (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S9).</p>
            </list-item>
          </list>
        </p>
      </sec>
      <sec id="Sec16">
        <title>Identification of the first gene</title>
        <p id="Par52">To select the first gene, we generate a random gene count matrix thus mimicking a random transcriptional relationship between cells. Subsequently, we use this matrix to compute a random “selection” graph. Subsequently, to calculate the per gene Minkowski distance in the random “selection” graph, we compute the distance between the actual log-normalized expression values and the average of the “true” log-normalized expression values across neighbors in the random “selection” graph. To select the first gene, we choose the gene with the largest difference between Minkowski distance in the random “selection” graph and the “true” graph. We repeat this procedure five times and select the most frequently occurring gene. In the unlikely scenario of ties (5 different genes are calculated from 5 random graphs), we select the gene from the first random graph.</p>
      </sec>
      <sec id="Sec17">
        <title>Adding a new gene to the current gene panel</title>
        <p id="Par53">To add the next gene to the current gene panel (selection), we compare the graph constructed using the entire transcriptome (“true” <italic>k</italic>-NN graph, computed once) with a graph constructed using the current “selection” (“selection” graph, recomputed for every updated selection). For each gene in the “true” graph, we compute, across cells, the Minkowski distance between a gene’s expression in a given cell and its average expression in that cell’s <italic>k</italic>-nearest neighbors. Similarly, we compute the Minkowski distance for each gene using the “selection” graph. To add the next gene to the current gene panel, for each gene we calculate the difference in stance between “selection” and “true” graph and add the gene with the largest difference.</p>
      </sec>
      <sec id="Sec18">
        <title>Batch correction</title>
        <p id="Par54">In cases where a batch is specified by a user (i.e., every cell is assigned to a distinct batch), we construct <italic>k</italic>-NN graphs (“true” and “selections”) per batch thus identifying nearest neighbors only from the same batch. To calculate a per gene Minkowski distance between cells and their neighbors, we use cells from all batches. Note that the same accounting of the batch is performed to compute cell neighborhood preservation and gene prediction scores.</p>
      </sec>
      <sec id="Sec19">
        <title>Default order for Minkowski distance</title>
        <p id="Par55">The Minkowski distance of order <italic>p</italic> (<italic>p</italic> is an integer) between two vectors <italic>X</italic> = (<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>, …, <italic>x</italic><sub><italic>n</italic></sub>) and <italic>Y</italic> = (<italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>, …, <italic>y</italic><sub><italic>n</italic></sub>) ∈ <italic>R</italic><sup><italic>n</italic></sup> is defined as:</p>
        <p id="Par56">
          <disp-formula id="Equa">
            <alternatives>
              <tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ D\left(X,Y\right)={\left({\sum}_{i=1}^n{\left|{x}_i-{y}_i\right|}^p\right)}^{1/p} $$\end{document}</tex-math>
              <mml:math id="M2" display="block">
                <mml:mi>D</mml:mi>
                <mml:mfenced close=")" open="(" separators=",">
                  <mml:mi>X</mml:mi>
                  <mml:mi>Y</mml:mi>
                </mml:mfenced>
                <mml:mo>=</mml:mo>
                <mml:msup>
                  <mml:mfenced close=")" open="(">
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>n</mml:mi>
                      </mml:msubsup>
                      <mml:msup>
                        <mml:mfenced close="|" open="|">
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>x</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                            <mml:mo>−</mml:mo>
                            <mml:msub>
                              <mml:mi>y</mml:mi>
                              <mml:mi>i</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mfenced>
                        <mml:mi>p</mml:mi>
                      </mml:msup>
                    </mml:mrow>
                  </mml:mfenced>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mo>/</mml:mo>
                    <mml:mi>p</mml:mi>
                  </mml:mrow>
                </mml:msup>
              </mml:math>
              <graphic xlink:href="13059_2021_2548_Article_Equa.gif" position="anchor"/>
            </alternatives>
          </disp-formula>
        </p>
        <p id="Par558">.</p>
        <p id="Par58">The choice of <italic>p</italic> provides a balance between how much the computed distance weighs the number of cells that are currently “mismapped” (i.e., the assigned neighbors in the selection graph show different expression values from what would be expected from the “true” graph) against the magnitude of this “mismapping” (i.e., how much different). For example, when the Minkowski distance is calculated between vectors <italic>X</italic> and <italic>Y</italic> and <italic>p</italic> → ∞, then <italic>D</italic>(<italic>X</italic>, <italic>Y</italic>) → (| <italic>X</italic><sub><italic>i</italic></sub> − <italic>Y</italic><sub><italic>i</italic></sub>| ) thus prioritizing the magnitude of mismapping. By contrast, if <italic>p</italic> = 0 then the Minkowski distance emphasizes the number of mismapped cells regardless of the magnitude.</p>
        <p id="Par59">To select an appropriate <italic>p</italic>, we applied geneBasis for the range <italic>p</italic> = 1, 2, 3, 4, 5 (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10). Overall, we observe that different orders of Minkowski distance return robust selections that do not substantially affect either cell neighborhood preservation or gene prediction scores (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10A, B). We next sought to determine the degree of expression resolution that can be achieved for a given range of <italic>p</italic>. In other words, we assessed, for each value of <italic>p</italic> and varying number of selected genes, what is the most rarely expressed gene (measured as a fraction of cells in which non-zero counts are observed) that can be achieved. We observe that for all benchmarked datasets <italic>p</italic> &gt; 2 gives highly similar results and using <italic>p</italic> &gt; 2 allows the selection of relevant genes that are expressed in only ~ 0.1% of cells (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S10C). Applying geneBasis with <italic>p</italic> = 1, 2 shows less flexibility and does not select genes beyond a certain threshold of expression. As default, we thus select <italic>p</italic> = 3 as a good tradeoff between the number of mismapped cells and the size of the discrepancy.</p>
      </sec>
    </sec>
    <sec id="Sec20">
      <title>Gene prediction score (“gene score”)</title>
      <p id="Par60">To calculate the gene score for the selected library, we exploit the “selection” and “true” graphs. For each gene, we compute the Spearman correlation (across cells) between its log-normalized expression value in each cell and its average expression across (each cell’s) first 5 nearest neighbors. We perform this calculation separately for the “selection” and “true” graphs and compute the ratio [correlation in “selection”]/[correlation in “true”]. We discard genes with correlation in the “true” graph below 0.25 (i.e., we omit genes with unstructured expression across the manifold).</p>
    </sec>
    <sec id="Sec21">
      <title>Cell neighborhood preservation score (“cell score”).</title>
      <p id="Par61">To calculate the cell score, we exploit the “True <italic>k</italic>-NN graph.” In the “True <italic>k</italic>-NN graph” for each cell we compare the vector of distances to the assigned neighbors from the “true graph” and assigned neighbors from the “selection graph” (Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig. S1). To normalize vectors and provide an interpretable metric, for each cell we <italic>z</italic>-transform the distribution of distances to all other cells and multiply the vector by -1, thus higher distances reflect more transcriptionally similar cells. For each cell, the “cell score” is calculated as the ratio of the median of the scaled distances to the first <italic>k</italic> neighbors from the “selection” graph to the median across of the scaled distances to the first <italic>k</italic> neighbors from the “true” graph (we use <italic>k</italic> = 5). The upper limit for the score of 1 arises if a cell’s neighborhood perfectly overlaps between the “true” and the “selection” graph, while a score of 0 suggests that a cell’s neighbors from the “selection” graph are distributed randomly across the manifold.</p>
    </sec>
    <sec id="Sec22">
      <title>Cell type mapping.</title>
      <p id="Par62">To compute confusion matrices for cell type labelling using the selection, we use log-normalized counts of the selected genes, perform PCA, and use the first 50 components to build a <italic>k</italic>-NN graph. If batch is not provided, PCA is performed using the prcomp_irlba function from the irlba package. If batch is provided, we first perform PCA using the multiBatchPCA function from the batchelor package, and then perform MNN correction using the reducedMNN function from the batchelor package. For each cell, we assign the mapped cell type as the most frequent cell type label across the first 5 neighbors (in case of the ties, we assign the cell type label of the closest cell from tied cell types).</p>
    </sec>
    <sec id="Sec23">
      <title>Benchmarking</title>
      <sec id="Sec24">
        <title>Datasets</title>
        <p id="Par63">
          <list list-type="bullet">
            <list-item>
              <p id="Par64"><italic>Mouse embryogenesis</italic>: The dataset was downloaded using the MouseGastrulationData package in R, which contains data generated for [<xref ref-type="bibr" rid="CR32">32</xref>]. Further we selected samples for stage E8.5 and discarded cells annotated as doublets or stripped. The final dataset consists of 4 samples (i.e., batches), and we use the field “sample” as a batch identification for gene selection methods. For cell type mappings, we discard extremely rare cell types that are present only at earlier developmental stages: Paraxial Mesoderm, Notochord, and Rostral Neuroectoderm (&lt; 10 cells in the E8.5 dataset).</p>
            </list-item>
            <list-item>
              <p id="Par65"><italic>Spleen</italic>: scRNA-seq for spleen was downloaded from the HubMap portal [<xref ref-type="bibr" rid="CR48">48</xref>] (<ext-link ext-link-type="uri" xlink:href="https://portal.hubmapconsortium.org/">https://portal.hubmapconsortium.org</ext-link>). The HuBMAP dataset IDs are as follows:</p>
            </list-item>
            <list-item>
              <p id="Par66">HBM984.GRBB.858,</p>
            </list-item>
            <list-item>
              <p id="Par67">HBM472.NTNN.543,</p>
            </list-item>
            <list-item>
              <p id="Par68">HBM556.QMSM.776,</p>
            </list-item>
            <list-item>
              <p id="Par69">HBM336.FWTN.636,</p>
            </list-item>
            <list-item>
              <p id="Par70">HBM252.HMBK.543,</p>
            </list-item>
            <list-item>
              <p id="Par71">HBM749.WHLC.649.</p>
            </list-item>
          </list>
        </p>
        <p id="Par72">Raw counts were SCT transformed and integrated using Seurat RPCA workflow.</p>
        <p id="Par73">Annotation of cell types was performed using a manually curated list of previously characterized cell type markers (Additional file <xref rid="MOESM6" ref-type="media">6</xref>: Table S3). Cells that could not be confidently assigned to a single cell type based on these markers were denoted as “Unknown.” The dataset consists of samples from 6 donors (i.e., batches), and we use the field “donor” as a batch identifier for gene selection methods.
<list list-type="bullet"><list-item><p id="Par74"><italic>Pancreas</italic>: Annotated scRNA-seq datasets for the pancreas were obtained from the Azimuth portal [<xref ref-type="bibr" rid="CR49">49</xref>, <xref ref-type="bibr" rid="CR50">50</xref>]. The integrated dataset contains data from 6 individual studies [<xref ref-type="bibr" rid="CR33">33</xref>–<xref ref-type="bibr" rid="CR38">38</xref>], with each individual study also being composed of several batches or samples. We use a combination of study and batch within study as a meta-batch variable (20 in total).</p></list-item><list-item><p id="Par75"><italic>Melanoma</italic>: The melanoma dataset described by [<xref ref-type="bibr" rid="CR39">39</xref>] was downloaded from <ext-link ext-link-type="uri" xlink:href="http://ncbi.nlm.nih.gov">ncbi.nlm.nih.gov</ext-link> with accession number GSE72056. The dataset consists of samples from 19 donors at different stages of metastasis. Considering the highly variable and overall low number of cells per each donor (4645 cells across 19 donors), and, more importantly, substantial transcriptional variability across donors, we decided to perform gene selections for this study without performing batch correction. For cell type mappings, we only use annotated non-malignant cells.</p></list-item></list></p>
      </sec>
    </sec>
    <sec id="Sec25">
      <title>Benchmarked methods</title>
      <p id="Par76">
        <list list-type="bullet">
          <list-item>
            <p id="Par77">SCMER and scGeneFit require initial preselection of genes. We used HVG-based gene screening with defaults from SCMER and manually increased the search range for spleen due to the observation that the defaults in SCMER selected an insufficient number of genes that poorly represented the overall manifold. Other parameters of the algorithms were left as default.</p>
          </list-item>
          <list-item>
            <p id="Par78">For SCMER, we used the same batch identifications as for geneBasis. To get a range of gene selections for SCMER, we generated a coarse grid for regularization strength (the parameter that directly affects number of genes selected) and applied the method on the generated grid.</p>
          </list-item>
          <list-item>
            <p id="Par79">In order to perform a faithful comparison between scGeneFit and geneBasis, for scGeneFit we discarded the Unknown cell type for the spleen data and Paraxial Mesoderm, Notochord, and Rostral Neuroectoderm cell types for the Mouse embryo data. For all 4 datasets, we used the option “centers.”</p>
          </list-item>
        </list>
      </p>
    </sec>
    <sec id="Sec26">
      <title>Estimation of computational complexity for geneBasis and SCME</title>
      <p id="Par80">geneBasis and SCMER use distinct computational strategies that required us to approach the estimation of computational complexity separately for each method. To vary the number of cells, we used the spleen dataset containing samples from 6 donors (henceforth referred as samples). We applied both methods to subsets of the spleen dataset by varying which samples we included in the subsets. Below we explain how we then assessed computational complexity for both methods.
<list list-type="bullet"><list-item><p id="Par81"><italic>geneBasis</italic>: To vary the initial number of genes, we performed highly variable gene selection and selected the top 2000, 3000, 4000, 5000, 6000, 7000, 8000, 9000, or 10,000 highly variable genes. We then ran the algorithm to select the first 150 genes, and accordingly for every added gene, recorded the elapsed time.</p></list-item><list-item><p id="Par82"><italic>SCMER</italic>: SCMER requires the regularization strength <italic>λ</italic> to be inputted. Subsequently, given this parameter, a selected set of genes are returned. Alternatively, it can take a number of genes to be selected as an input, in which case it will run SCMER on the coarse grid of various values for <italic>λ</italic>, select an optimal <italic>λ</italic> to achieve the desired number of genes, and return the selection. By design, the latter takes longer to run since the algorithm has to first perform a grid search. Accordingly, to achieve a more faithful comparison, we selected the appropriate grid for <italic>λ</italic> ourselves, and for each value of the grid, we recorded the selected number of genes and elapsed time. The initial preselection of genes is not part of SCMER, and we varied the number of initial genes by selecting highly variable genes with scanpy.pp.highly_variable_genes with different values for min_disp (0, 0.25, 0.5).</p></list-item></list></p>
    </sec>
    <sec id="Sec27">
      <title>Generation of semi-random initial selections (for Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Fig S4)</title>
      <p id="Par86">To perform semi-random initial selections, for each dataset, we randomly chose half of the cell types and for each cell type we randomly selected a gene that was upregulated in the corresponding cell type. A union of these genes was used as initial selections.</p>
    </sec>
    <sec id="Sec28">
      <title>Integration with lineage-specific datasets for mouse embryo development</title>
      <p id="Par87">To integrate scRNA-seq data of the whole mouse embryo [<xref ref-type="bibr" rid="CR32">32</xref>] together with the lineage-specific dataset for cardiac development [<xref ref-type="bibr" rid="CR42">42</xref>], we concatenated log-normalized counts for cells from [<xref ref-type="bibr" rid="CR32">32</xref>] annotated as “Cardiomyocytes” and cells from [<xref ref-type="bibr" rid="CR42">42</xref>]. To integrate scRNA-seq data of the whole mouse embryo [<xref ref-type="bibr" rid="CR32">32</xref>] together with lineage-specific dataset for endodermal development [<xref ref-type="bibr" rid="CR43">43</xref>], we concatenated log-normalized counts for cells from [<xref ref-type="bibr" rid="CR32">32</xref>] annotated as “Gut” and cells collected at E8.75 from [<xref ref-type="bibr" rid="CR43">43</xref>].</p>
      <p id="Par88">For both integrations, we performed cosine normalization of log-normalized counts using batchelor::cosineNorm and performed PCA using batchelor::multiBatchNorm, using 20 PCs (using combination of + dataset + corresponding to the dataset batch entity as meta-batch). Mapping was then calculated using BiocNeighbors::findKNN. For each cell, we assigned the most common cluster across the first 5 neighbors.</p>
    </sec>
    <sec id="Sec29">
      <title>Joint embedding between seqFISH+ and scRNA-seq datasets for the mouse olfactory bulb</title>
      <p id="Par89">To create joint embedding between the two data modalities, we first selected genes for which we had entries in both datasets and performed cosine normalization using batchelor::cosineNorm to the log-normalized counts (i.e., logcounts) for both datasets. We then concatenated cosine normalized logcounts and performed PCA using batchelor::multiBatchNorm, using 25 PCs. Mapping was then calculated using BiocNeighbors::findKNN. For each cell, we assigned the most common cluster across the first 5 neighbors.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec30">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2021_2548_MOESM1_ESM.pdf">
            <caption>
              <p><bold>Additional file 1: Fig. S1.</bold> Schematic visualisation for cell neighbourhood preservation score workflow. <bold>Fig. S2.</bold> Systematic assessment of the ‘completeness’ of the generated gene panels. <bold>Fig. S3.</bold> SCMER introduces redundancy in the selections when selecting a small number of genes. <bold>Fig. S4.</bold> geneBasis is robust to initial selections and quickly finds missing sources of variation. <bold>Fig. S5.</bold> geneBasis accounts for batch effects even with highly unbalanced celltype composition. <bold>Fig. S6.</bold> Detailed analysis of the gene selection for mouse embryogenesis. <bold>Fig. S7.</bold> Detailed analysis of the selection for spleen and pancreas . Panels A-D correspond to spleen; panels E-G correspond to pancreas. <bold>Fig. S8.</bold> geneBasis selects genes that recover biological heterogeneity in seqFISH datasets. <bold>Fig. S9.</bold> Performing PCA for mapping manifolds with selections does not change cell neighborhood preservation score or gene prediction score. <bold>Fig. S10.</bold> Minkowski distance of order p=3 provides the resolution to select rare markers and genes expressed in a low fraction of cells.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2021_2548_MOESM2_ESM.xlsx">
            <caption>
              <p><bold>Additional file 2: Table S1.</bold> Top 150 genes selected by geneBasis for mouse embryo, spleen, pancreas and melanoma datasets.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2021_2548_MOESM3_ESM.xlsx">
            <caption>
              <p><bold>Additional file 3: Table S2.</bold> Selection of genes by SCMER for mouse embryo dataset, where blood lineage was retained in one sample.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2021_2548_MOESM4_ESM.pdf">
            <caption>
              <p><bold>Additional file 4: Supplementary Note 1.</bold> Analysis of robustness of geneBasis approach.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM5">
          <media xlink:href="13059_2021_2548_MOESM5_ESM.pdf">
            <caption>
              <p><bold>Additional file 5: Supplementary Note 2.</bold> Analysis of PBMC dataset.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM6">
          <media xlink:href="13059_2021_2548_MOESM6_ESM.xlsx">
            <caption>
              <p><bold>Additional file 6: Table S3.</bold> List of cell type specific markers for the spleen dataset.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM7">
          <media xlink:href="13059_2021_2548_MOESM7_ESM.docx">
            <caption>
              <p><bold>Additional file 7.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>We thank Emma Dann and Mike Morgan for useful discussions on the package development.</p>
    <sec id="FPar2">
      <title>Review history</title>
      <p id="Par90">The review history is available as Additional file <xref rid="MOESM7" ref-type="media">7</xref>.</p>
    </sec>
    <sec id="FPar3">
      <title>Peer review information</title>
      <p id="Par91">Barbara Cheifet was the primary editor of this article and managed its editorial process and peer review in collaboration with the rest of the editorial team.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>AM conceived the method, developed the algorithm, performed the analysis, and wrote the R package. MB, CW, HN, TB, and MA generated scRNA-seq data for the adult spleen. JJ preprocessed and annotated spleen scRNA-seq data. AB integrated pancreas data from the original publications. RS, JJ, AB, SG, and TS provided critical feedback and helped shape the methodology, analysis, and the package. AM and JM wrote the manuscript with the input from RS, JJ, AB, SG, and TS. RS and JM oversaw the project. The author(s) read and approved the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work is supported by the National Institutes of Health: RS and JM acknowledge 1OT2OD026673-01 which supports AM; RS acknowledge RM1HG011014-02; TS acknowledges K99HG011489-01; MA, HN, CW, and TB acknowledge U54AI142766. SG acknowledges Royal Society Newton International Fellowship (NIF\R1\181950). MA and TB acknowledge Helmsley Charitable Trust 2004-03813. JM acknowledges core funding from EMBL and core support from Cancer Research UK (C9545/A29580). In the past 3 years, RS has worked as a consultant for Bristol-Myers Squibb, Regeneron, and Kallyope, and served as an SAB member for ImmunAI, Resolve Biosciences, Nanostring, and the NYC Pandemic Response Lab. Open Access funding enabled and organized by Projekt DEAL.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>geneBasisR’s open-source code is maintained and documented on GitHub [<xref ref-type="bibr" rid="CR51">51</xref>] and is publicly available under the MIT license from the following Zenodo repository (DOI: 10.5281/zenodo.5675255).</p>
    <p>scRNA-seq mouse embryo dataset described by [<xref ref-type="bibr" rid="CR32">32</xref>] was obtained from MouseGastrulationData package in R.</p>
    <p>scRNA-seq spleen dataset was obtained from HubMap portal [<xref ref-type="bibr" rid="CR48">48</xref>] (<ext-link ext-link-type="uri" xlink:href="https://portal.hubmapconsortium.org">https://portal.hubmapconsortium.org</ext-link>). The HuBMAP dataset IDs are as follows: HBM984.GRBB.858; HBM472.NTNN.543; HBM556.QMSM.776; HBM336.FWTN.636; HBM252.HMBK.543; HBM749.WHLC.649.</p>
    <p>scRNA-seq pancreas datasets were obtained from the Azimuth portal [<xref ref-type="bibr" rid="CR49">49</xref>, <xref ref-type="bibr" rid="CR50">50</xref>].</p>
    <p>scRNA-seq melanoma dataset described by [<xref ref-type="bibr" rid="CR39">39</xref>] was downloaded from <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/">https://www.ncbi.nlm.nih.gov/</ext-link> with accession number GSE72056.</p>
    <p>scRNA-seq PBMC dataset described by [<xref ref-type="bibr" rid="CR46">46</xref>] was obtained from <ext-link ext-link-type="uri" xlink:href="https://data.humancellatlas.org/explore/projects/efea6426-510a-4b60-9a19-277e52bfa815">https://data.humancellatlas.org/explore/projects/efea6426-510a-4b60-9a19-277e52bfa815</ext-link>.</p>
    <p>SeqFISH+ mouse olfactory bulb dataset described by [<xref ref-type="bibr" rid="CR13">13</xref>] was obtained from <ext-link ext-link-type="uri" xlink:href="https://github.com/CaiGroup/seqFISH-PLUS">https://github.com/CaiGroup/seqFISH-PLUS</ext-link>.</p>
    <p>scRNA-seq mouse olfactory bulb dataset described by [<xref ref-type="bibr" rid="CR48">48</xref>] was obtained from <ext-link ext-link-type="uri" xlink:href="http://mousebrain.org/">http://mousebrain.org/</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar4">
      <title>Ethics approval and consent to participate</title>
      <p id="Par92">Not applicable.</p>
    </notes>
    <notes id="FPar5">
      <title>Consent for publication</title>
      <p id="Par93">Not applicable.</p>
    </notes>
    <notes id="FPar6" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par94">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hwang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Bang</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Single-cell RNA sequencing technologies and bioinformatics pipelines</article-title>
        <source>Exp Mol Med.</source>
        <year>2018</year>
        <volume>50</volume>
        <issue>8</issue>
        <fpage>1</fpage>
        <lpage>14</lpage>
        <pub-id pub-id-type="doi">10.1038/s12276-018-0071-8</pub-id>
        <?supplied-pmid 30416196?>
        <pub-id pub-id-type="pmid">30416196</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Yip</surname>
            <given-names>SH</given-names>
          </name>
          <name>
            <surname>Sham</surname>
            <given-names>PC</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of tools for highly variable gene discovery from single-cell RNA-seq data</article-title>
        <source>Brief Bioinform.</source>
        <year>2019</year>
        <volume>20</volume>
        <issue>4</issue>
        <fpage>1583</fpage>
        <lpage>1589</lpage>
        <pub-id pub-id-type="doi">10.1093/bib/bby011</pub-id>
        <?supplied-pmid 29481632?>
        <pub-id pub-id-type="pmid">29481632</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Pinello</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Yuan</surname>
            <given-names>G-C</given-names>
          </name>
        </person-group>
        <article-title>GiniClust: detecting rare cell types from single-cell gene expression data with Gini index</article-title>
        <source>Genome Biol.</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>144</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-016-1010-4</pub-id>
        <?supplied-pmid 27368803?>
        <pub-id pub-id-type="pmid">27368803</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andrews</surname>
            <given-names>TS</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>M3Drop: dropout-based feature selection for scRNASeq</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>16</issue>
        <fpage>2865</fpage>
        <lpage>2867</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty1044</pub-id>
        <?supplied-pmid 30590489?>
        <pub-id pub-id-type="pmid">30590489</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Liang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Kumar</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Navin</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>SCMarker: Ab initio marker selection for single cell transcriptome profiling</article-title>
        <source>PLoS Comput Biol.</source>
        <year>2019</year>
        <volume>15</volume>
        <issue>10</issue>
        <fpage>e1007445</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1007445</pub-id>
        <?supplied-pmid 31658262?>
        <pub-id pub-id-type="pmid">31658262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Song</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hemminger</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Wollman</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>scPNMF: sparse gene encoding of single cells to facilitate gene selection for targeted gene profiling</article-title>
        <source>bioRxiv</source>
        <year>2021</year>
        <volume>37</volume>
        <issue>Suppl_1</issue>
        <fpage>i358</fpage>
        <lpage>i366</lpage>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Larsson</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Frisén</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lundeberg</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Spatially resolved transcriptomics adds a new dimension to genomics</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>15</fpage>
        <lpage>18</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-01038-7</pub-id>
        <?supplied-pmid 33408402?>
        <pub-id pub-id-type="pmid">33408402</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Spatially resolved single-cell genomics and transcriptomics by imaging</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>18</fpage>
        <lpage>22</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-01037-8</pub-id>
        <?supplied-pmid 33408406?>
        <pub-id pub-id-type="pmid">33408406</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Close</surname>
            <given-names>JL</given-names>
          </name>
          <name>
            <surname>Long</surname>
            <given-names>BR</given-names>
          </name>
          <name>
            <surname>Zeng</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Spatially resolved transcriptomics in neuroscience</article-title>
        <source>Nat Methods</source>
        <year>2021</year>
        <volume>18</volume>
        <issue>1</issue>
        <fpage>23</fpage>
        <lpage>25</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-01040-z</pub-id>
        <?supplied-pmid 33408398?>
        <pub-id pub-id-type="pmid">33408398</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Raj</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>van den Bogaard</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Rifkin</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>van Oudenaarden</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tyagi</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Imaging individual mRNA molecules using multiple singly labeled probes</article-title>
        <source>Nat Methods</source>
        <year>2008</year>
        <volume>5</volume>
        <issue>10</issue>
        <fpage>877</fpage>
        <lpage>879</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.1253</pub-id>
        <?supplied-pmid 18806792?>
        <pub-id pub-id-type="pmid">18806792</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shah</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lubeck</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>In situ transcription profiling of single cells reveals spatial organization of cells in the mouse hippocampus</article-title>
        <source>Neuron</source>
        <year>2016</year>
        <volume>92</volume>
        <issue>2</issue>
        <fpage>342</fpage>
        <lpage>357</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuron.2016.10.001</pub-id>
        <?supplied-pmid 27764670?>
        <pub-id pub-id-type="pmid">27764670</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shah</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lubeck</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Zhou</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Cai</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>seqFISH accurately detects transcripts in single cells and reveals robust spatial organization in the hippocampus</article-title>
        <source>Neuron</source>
        <year>2017</year>
        <volume>94</volume>
        <fpage>752</fpage>
        <lpage>758.e1</lpage>
        <pub-id pub-id-type="doi">10.1016/j.neuron.2017.05.008</pub-id>
        <pub-id pub-id-type="pmid">28521130</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eng</surname>
            <given-names>C-HL</given-names>
          </name>
          <name>
            <surname>Lawson</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Transcriptome-scale super-resolved imaging in tissues by RNA seqFISH</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>568</volume>
        <issue>7751</issue>
        <fpage>235</fpage>
        <lpage>239</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1049-y</pub-id>
        <?supplied-pmid 30911168?>
        <pub-id pub-id-type="pmid">30911168</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <mixed-citation publication-type="other">Lohoff TS Ghazanfar A, Missarova N, Koulena N, Pierson JA, Griffiths ES, Bardot et al. “Integration of Spatial and Single-Cell Transcriptomic Data Elucidates Mouse Organogenesis.” Nature Biotechnology. 2021. 10.1038/s41587-021-01006-2.</mixed-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Moffitt</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>High-throughput single-cell gene-expression profiling with multiplexed error-robust fluorescence in situ hybridization</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2016</year>
        <volume>113</volume>
        <issue>39</issue>
        <fpage>11046</fpage>
        <lpage>11051</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1612826113</pub-id>
        <?supplied-pmid 27625426?>
        <pub-id pub-id-type="pmid">27625426</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <mixed-citation publication-type="other">Moffitt, J. R. , Bambah-Mukku D. Molecular, spatial, and functional single-cell profiling of the hypothalamic preoptic region. Science (2018):362, DOI: 10.1126/science.aau5324.</mixed-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Xia</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Fan</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Emanuel</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Hao</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhuang</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>Spatial transcriptome profiling by MERFISH reveals subcellular RNA compartmentalization and cell cycle-dependent gene expression</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2019</year>
        <volume>116</volume>
        <issue>39</issue>
        <fpage>19490</fpage>
        <lpage>19499</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1912459116</pub-id>
        <?supplied-pmid 31501331?>
        <pub-id pub-id-type="pmid">31501331</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Cai</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <source>Spatial mapping of single cells in human cerebral cortex using DARTFISH: a highly multiplexed method for in situ quantification of targeted RNA transcripts</source>
        <year>2019</year>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jaitin</surname>
            <given-names>DA</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Dissecting Immune Circuits by Linking CRISPR-pooled screens with single-cell RNA-Seq</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>167</volume>
        <fpage>1883</fpage>
        <lpage>1896.e15</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.11.039</pub-id>
        <pub-id pub-id-type="pmid">27984734</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dixit</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Perturb-Seq: dissecting molecular circuits with scalable single-cell RNA profiling of pooled genetic screens</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>167</volume>
        <fpage>1853</fpage>
        <lpage>1866.e17</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.11.038</pub-id>
        <pub-id pub-id-type="pmid">27984732</pub-id>
      </element-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Adamson</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A multiplexed single-cell CRISPR screening platform enables systematic dissection of the unfolded protein response</article-title>
        <source>Cell</source>
        <year>2016</year>
        <volume>167</volume>
        <fpage>1867</fpage>
        <lpage>1882.e21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2016.11.048</pub-id>
        <pub-id pub-id-type="pmid">27984733</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Schraivogel</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Gschwind</surname>
            <given-names>AR</given-names>
          </name>
        </person-group>
        <article-title>Targeted Perturb-seq enables genome-scale genetic screens in single cells</article-title>
        <source>Nat Methods</source>
        <year>2020</year>
        <volume>17</volume>
        <issue>6</issue>
        <fpage>629</fpage>
        <lpage>635</lpage>
        <pub-id pub-id-type="doi">10.1038/s41592-020-0837-5</pub-id>
        <?supplied-pmid 32483332?>
        <pub-id pub-id-type="pmid">32483332</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Robinson</surname>
            <given-names>MD</given-names>
          </name>
          <name>
            <surname>McCarthy</surname>
            <given-names>DJ</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>GK</given-names>
          </name>
        </person-group>
        <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>1</issue>
        <fpage>139</fpage>
        <lpage>140</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btp616</pub-id>
        <pub-id pub-id-type="pmid">19910308</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kharchenko</surname>
            <given-names>PV</given-names>
          </name>
          <name>
            <surname>Silberstein</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Scadden</surname>
            <given-names>DT</given-names>
          </name>
        </person-group>
        <article-title>Bayesian approach to single-cell differential expression analysis</article-title>
        <source>Nat Methods</source>
        <year>2014</year>
        <volume>11</volume>
        <issue>7</issue>
        <fpage>740</fpage>
        <lpage>742</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.2967</pub-id>
        <?supplied-pmid 24836921?>
        <pub-id pub-id-type="pmid">24836921</pub-id>
      </element-citation>
    </ref>
    <ref id="CR25">
      <label>25.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Finak</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>McDavid</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>MAST: a flexible statistical framework for assessing transcriptional changes and characterizing heterogeneity in single-cell RNA sequencing data</article-title>
        <source>Genome Biol.</source>
        <year>2015</year>
        <volume>16</volume>
        <issue>1</issue>
        <fpage>278</fpage>
        <pub-id pub-id-type="doi">10.1186/s13059-015-0844-5</pub-id>
        <?supplied-pmid 26653891?>
        <pub-id pub-id-type="pmid">26653891</pub-id>
      </element-citation>
    </ref>
    <ref id="CR26">
      <label>26.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Delmans</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hemberg</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>Discrete distributional differential expression (D3E)--a tool for gene expression analysis of single-cell RNA-seq data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2016</year>
        <volume>17</volume>
        <issue>1</issue>
        <fpage>110</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-016-0944-6</pub-id>
        <?supplied-pmid 26927822?>
        <pub-id pub-id-type="pmid">26927822</pub-id>
      </element-citation>
    </ref>
    <ref id="CR27">
      <label>27.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vargo</surname>
            <given-names>AHS</given-names>
          </name>
          <name>
            <surname>Gilbert</surname>
            <given-names>AC</given-names>
          </name>
        </person-group>
        <article-title>A rank-based marker selection method for high throughput scRNA-seq data</article-title>
        <source>BMC Bioinformatics</source>
        <year>2020</year>
        <volume>21</volume>
        <issue>1</issue>
        <fpage>477</fpage>
        <pub-id pub-id-type="doi">10.1186/s12859-020-03641-z</pub-id>
        <?supplied-pmid 33097004?>
        <pub-id pub-id-type="pmid">33097004</pub-id>
      </element-citation>
    </ref>
    <ref id="CR28">
      <label>28.</label>
      <mixed-citation publication-type="other">Aevermann, B. D. et al. A machine learning method for the discovery of minimum marker gene combinations for cell-type identification from single-cell RNA sequencing. Genome Res. (2021) doi:10.1101/gr.275569.121<ext-link ext-link-type="uri" xlink:href="http://paperpile.com/b/qavk7v/nSgZ3">.</ext-link></mixed-citation>
    </ref>
    <ref id="CR29">
      <label>29.</label>
      <mixed-citation publication-type="other">Nelson ME, Riva SG, Cvejic A. SMaSH: A scalable, general marker gene identification framework for single-cell RNA sequencing and Spatial Transcriptomics. bioRxiv. 2021.</mixed-citation>
    </ref>
    <ref id="CR30">
      <label>30.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dumitrascu</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Villar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mixon</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Engelhardt</surname>
            <given-names>BE</given-names>
          </name>
        </person-group>
        <article-title>Optimal marker gene selection for cell type discrimination in single cell analyses</article-title>
        <source>Nat Commun.</source>
        <year>2021</year>
        <volume>12</volume>
        <issue>1</issue>
        <fpage>1</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-21453-4</pub-id>
        <pub-id pub-id-type="pmid">33397941</pub-id>
      </element-citation>
    </ref>
    <ref id="CR31">
      <label>31.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Mohanty</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Single-cell manifold-preserving feature selection for detecting rare cell populations</article-title>
        <source>Nat Computational Sci</source>
        <year>2021</year>
        <volume>1</volume>
        <issue>5</issue>
        <fpage>374</fpage>
        <lpage>384</lpage>
        <pub-id pub-id-type="doi">10.1038/s43588-021-00070-7</pub-id>
      </element-citation>
    </ref>
    <ref id="CR32">
      <label>32.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pijuan-Sala</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Griffiths</surname>
            <given-names>JA</given-names>
          </name>
        </person-group>
        <article-title>A single-cell molecular map of mouse gastrulation and early organogenesis</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>566</volume>
        <issue>7745</issue>
        <fpage>490</fpage>
        <lpage>495</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-0933-9</pub-id>
        <?supplied-pmid 6522369?>
        <pub-id pub-id-type="pmid">30787436</pub-id>
      </element-citation>
    </ref>
    <ref id="CR33">
      <label>33.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Grün</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Muraro</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>De novo prediction of stem cell identity using single-cell transcriptome data</article-title>
        <source>Cell Stem Cell</source>
        <year>2016</year>
        <volume>19</volume>
        <issue>2</issue>
        <fpage>266</fpage>
        <lpage>277</lpage>
        <pub-id pub-id-type="doi">10.1016/j.stem.2016.05.010</pub-id>
        <?supplied-pmid 27345837?>
        <pub-id pub-id-type="pmid">27345837</pub-id>
      </element-citation>
    </ref>
    <ref id="CR34">
      <label>34.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Muraro</surname>
            <given-names>MJ</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptome atlas of the human pancreas</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>385</fpage>
        <lpage>394.e3</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.09.002</pub-id>
        <pub-id pub-id-type="pmid">27693023</pub-id>
      </element-citation>
    </ref>
    <ref id="CR35">
      <label>35.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Segerstolpe</surname>
            <given-names>Å</given-names>
          </name>
          <name>
            <surname>Palasantza</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Single-cell transcriptome profiling of human pancreatic islets in health and type 2 diabetes</article-title>
        <source>Cell Metab.</source>
        <year>2016</year>
        <volume>24</volume>
        <issue>4</issue>
        <fpage>593</fpage>
        <lpage>607</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cmet.2016.08.020</pub-id>
        <?supplied-pmid 27667667?>
        <pub-id pub-id-type="pmid">27667667</pub-id>
      </element-citation>
    </ref>
    <ref id="CR36">
      <label>36.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawlor</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>George</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Bolisetty</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kursawe</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Single-cell transcriptomes identify human islet cell signatures and reveal cell-type–specific expression changes in type 2 diabetes</article-title>
        <source>Genome</source>
        <year>2017</year>
        <volume>27</volume>
        <issue>2</issue>
        <fpage>208</fpage>
        <lpage>222</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.212720.116</pub-id>
      </element-citation>
    </ref>
    <ref id="CR37">
      <label>37.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Baron</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A single-cell transcriptomic map of the human and mouse pancreas reveals inter- and intra-cell population structure</article-title>
        <source>Cell Syst</source>
        <year>2016</year>
        <volume>3</volume>
        <fpage>346</fpage>
        <lpage>360.e4</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cels.2016.08.011</pub-id>
        <pub-id pub-id-type="pmid">27667365</pub-id>
      </element-citation>
    </ref>
    <ref id="CR38">
      <label>38.</label>
      <mixed-citation publication-type="other">Xin Y, et al. Single-cell RNA sequencing and analysis of human pancreatic islets. J Vis Exp. 2019. 10.3791/59866.</mixed-citation>
    </ref>
    <ref id="CR39">
      <label>39.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Tirosh, I</collab>
          <name>
            <surname>Izar</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Prakadan</surname>
            <given-names>SM</given-names>
          </name>
          <name>
            <surname>Wadsworth</surname>
            <given-names>MH</given-names>
            <suffix>II</suffix>
          </name>
          <name>
            <surname>Treacy</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Trombetta</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Rotem</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Rodman</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Lian</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Murphy</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Fallahi-Sichani</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Dutton-Regester</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Cohen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Shah</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Genshaft</surname>
            <given-names>AS</given-names>
          </name>
          <name>
            <surname>Hughes</surname>
            <given-names>TK</given-names>
          </name>
          <name>
            <surname>Ziegler</surname>
            <given-names>CGK</given-names>
          </name>
          <name>
            <surname>Kazer</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Gaillard</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kolb</surname>
            <given-names>KE</given-names>
          </name>
          <name>
            <surname>Villani</surname>
            <given-names>AC</given-names>
          </name>
          <name>
            <surname>Johannessen</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Andreev</surname>
            <given-names>AY</given-names>
          </name>
          <name>
            <surname>van Allen</surname>
            <given-names>EM</given-names>
          </name>
          <name>
            <surname>Bertagnolli</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Sorger</surname>
            <given-names>PK</given-names>
          </name>
          <name>
            <surname>Sullivan</surname>
            <given-names>RJ</given-names>
          </name>
          <name>
            <surname>Flaherty</surname>
            <given-names>KT</given-names>
          </name>
          <name>
            <surname>Frederick</surname>
            <given-names>DT</given-names>
          </name>
          <name>
            <surname>Jané-Valbuena</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Yoon</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Rozenblatt-Rosen</surname>
            <given-names>O</given-names>
          </name>
          <name>
            <surname>Shalek</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Regev</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Garraway</surname>
            <given-names>LA</given-names>
          </name>
        </person-group>
        <article-title>Dissecting the multicellular ecosystem of metastatic melanoma by single-cell RNA-seq</article-title>
        <source>Science</source>
        <year>2016</year>
        <volume>352</volume>
        <fpage>189</fpage>
        <lpage>196</lpage>
        <pub-id pub-id-type="doi">10.1126/science.aad0501</pub-id>
        <pub-id pub-id-type="pmid">27124452</pub-id>
      </element-citation>
    </ref>
    <ref id="CR40">
      <label>40.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hebiri</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Lederer</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>How correlations influence lasso prediction</article-title>
        <source>IEEE Trans Inf Theory</source>
        <year>2013</year>
        <volume>59</volume>
        <fpage>1846</fpage>
        <lpage>1854</lpage>
        <pub-id pub-id-type="doi">10.1109/TIT.2012.2227680</pub-id>
      </element-citation>
    </ref>
    <ref id="CR41">
      <label>41.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Chen</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ju</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Shaner</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Easton</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>X</given-names>
          </name>
        </person-group>
        <article-title>A comparison of methods accounting for batch effects in differential expression analysis of UMI count based single cell RNA sequencing</article-title>
        <source>Comput Struct Biotechnol J.</source>
        <year>2020</year>
        <volume>18</volume>
        <fpage>861</fpage>
        <lpage>873</lpage>
        <pub-id pub-id-type="doi">10.1016/j.csbj.2020.03.026</pub-id>
        <?supplied-pmid 32322368?>
        <pub-id pub-id-type="pmid">32322368</pub-id>
      </element-citation>
    </ref>
    <ref id="CR42">
      <label>42.</label>
      <mixed-citation publication-type="other">Tyser RCV, Ibarra-Soria X, McDole K, Arcot Jayaram S, Godwin J, van den Brand TAH, et al. Characterization of a common progenitor pool of the epicardium and myocardium. Science. 2021;371(6533). 10.1126/science.abb2986.</mixed-citation>
    </ref>
    <ref id="CR43">
      <label>43.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nowotschin</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Setty</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Kuo</surname>
            <given-names>YY</given-names>
          </name>
          <name>
            <surname>Liu</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Garg</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Sharma</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Simon</surname>
            <given-names>CS</given-names>
          </name>
          <name>
            <surname>Saiz</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Gardner</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Boutet</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Church</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Hoodless</surname>
            <given-names>PA</given-names>
          </name>
          <name>
            <surname>Hadjantonakis</surname>
            <given-names>AK</given-names>
          </name>
          <name>
            <surname>Pe’er</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>The emergent landscape of the mouse gut endoderm at single-cell resolution</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>569</volume>
        <issue>7756</issue>
        <fpage>361</fpage>
        <lpage>367</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1127-1</pub-id>
        <?supplied-pmid 6724221?>
        <pub-id pub-id-type="pmid">30959515</pub-id>
      </element-citation>
    </ref>
    <ref id="CR44">
      <label>44.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Andreatta</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Interpretation of T cell states from single-cell transcriptomics data using reference atlases</article-title>
        <source>Nat Commun</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>2965</fpage>
        <pub-id pub-id-type="doi">10.1038/s41467-021-23324-4</pub-id>
        <pub-id pub-id-type="pmid">34017005</pub-id>
      </element-citation>
    </ref>
    <ref id="CR45">
      <label>45.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hao</surname>
            <given-names>Y</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Integrated analysis of multimodal single-cell data</article-title>
        <source>Cell</source>
        <year>2021</year>
        <volume>184</volume>
        <fpage>3573</fpage>
        <lpage>3587.e29</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2021.04.048</pub-id>
        <pub-id pub-id-type="pmid">34062119</pub-id>
      </element-citation>
    </ref>
    <ref id="CR46">
      <label>46.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lawlor</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Nehar-Belaid</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Grassmann</surname>
            <given-names>JDS</given-names>
          </name>
          <name>
            <surname>Stoeckius</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Smibert</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Stitzel</surname>
            <given-names>ML</given-names>
          </name>
          <name>
            <surname>Pascual</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Banchereau</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Williams</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ucar</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Single cell analysis of blood mononuclear cells stimulated through either LPS or anti-CD3 and anti-CD28</article-title>
        <source>Front Immunol.</source>
        <year>2021</year>
        <volume>12</volume>
        <fpage>636720</fpage>
        <pub-id pub-id-type="doi">10.3389/fimmu.2021.636720</pub-id>
        <?supplied-pmid 33815388?>
        <pub-id pub-id-type="pmid">33815388</pub-id>
      </element-citation>
    </ref>
    <ref id="CR47">
      <label>47.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Asp</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Bergenstråhle</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lundeberg</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Spatially resolved transcriptomes-next generation tools for tissue exploration</article-title>
        <source>Bioessays</source>
        <year>2020</year>
        <volume>42</volume>
        <issue>10</issue>
        <fpage>e1900221</fpage>
        <pub-id pub-id-type="doi">10.1002/bies.201900221</pub-id>
        <?supplied-pmid 32363691?>
        <pub-id pub-id-type="pmid">32363691</pub-id>
      </element-citation>
    </ref>
    <ref id="CR48">
      <label>48.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zeisel</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Molecular architecture of the mouse nervous system</article-title>
        <source>Cell</source>
        <year>2018</year>
        <volume>174</volume>
        <fpage>999</fpage>
        <lpage>1014.e22</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2018.06.021</pub-id>
        <pub-id pub-id-type="pmid">30096314</pub-id>
      </element-citation>
    </ref>
    <ref id="CR49">
      <label>49.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <collab>Consortium, H. &amp; HuBMAP Consortium</collab>
        </person-group>
        <article-title>The human body at cellular resolution: the NIH Human Biomolecular Atlas Program</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>574</volume>
        <fpage>187</fpage>
        <lpage>192</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-1629-x</pub-id>
        <pub-id pub-id-type="pmid">31597973</pub-id>
      </element-citation>
    </ref>
    <ref id="CR50">
      <label>50.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Comprehensive integration of single-cell data</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>177</volume>
        <fpage>1888</fpage>
        <lpage>1902.e21</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.05.031</pub-id>
        <pub-id pub-id-type="pmid">31178118</pub-id>
      </element-citation>
    </ref>
    <ref id="CR51">
      <label>51.</label>
      <element-citation publication-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Missarova</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Jain</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ghazanfar</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Stuart</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Brusko</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Wasserfall</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Nick</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Brusko</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Atkinson</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Satija</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Marioni</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <source>geneBasis: an iterative approach for unsupervised selection of targeted gene panels from scRNA-seq. Github</source>
        <year>2021</year>
      </element-citation>
    </ref>
  </ref-list>
</back>
