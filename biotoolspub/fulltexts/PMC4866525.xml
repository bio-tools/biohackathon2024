<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d1 20130915//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 39.96?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">4866525</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btw028</article-id>
    <article-id pub-id-type="publisher-id">btw028</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MuCor: mutation aggregation and correlation</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Kroll</surname>
          <given-names>Karl W.</given-names>
        </name>
        <xref ref-type="aff" rid="btw028-aff1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Eisfeld</surname>
          <given-names>Ann-Katherin</given-names>
        </name>
        <xref ref-type="aff" rid="btw028-aff2">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lozanski</surname>
          <given-names>Gerard</given-names>
        </name>
        <xref ref-type="aff" rid="btw028-aff3">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Bloomfield</surname>
          <given-names>Clara D.</given-names>
        </name>
        <xref ref-type="aff" rid="btw028-aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btw028-aff4">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Byrd</surname>
          <given-names>John C.</given-names>
        </name>
        <xref ref-type="aff" rid="btw028-aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btw028-aff4">
          <sup>4</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Blachly</surname>
          <given-names>James S.</given-names>
        </name>
        <xref ref-type="aff" rid="btw028-aff1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="btw028-aff4">
          <sup>4</sup>
        </xref>
        <xref ref-type="corresp" rid="btw028-cor1">*</xref>
      </contrib>
      <aff id="btw028-aff1"><sup>1</sup>Division of Hematology, Department of Internal Medicine,</aff>
      <aff id="btw028-aff2"><sup>2</sup>Department of Human Cancer Genetics and Molecular Virology,</aff>
      <aff id="btw028-aff3"><sup>3</sup>Department of Pathology, The Ohio State University, Columbus, OH 43210 and</aff>
      <aff id="btw028-aff4"><sup>4</sup>The Ohio State University James Comprehensive Cancer Center, Columbus, OH 43210, USA</aff>
    </contrib-group>
    <author-notes>
      <corresp id="btw028-cor1">*To whom correspondence should be addressed.</corresp>
      <fn id="btw028-FN1">
        <p>Associate Editor: John Hancock</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>5</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>2</month>
      <year>2016</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>32</volume>
    <issue>10</issue>
    <fpage>1557</fpage>
    <lpage>1558</lpage>
    <history>
      <date date-type="received">
        <day>17</day>
        <month>7</month>
        <year>2015</year>
      </date>
      <date date-type="rev-recd">
        <day>30</day>
        <month>12</month>
        <year>2015</year>
      </date>
      <date date-type="accepted">
        <day>18</day>
        <month>1</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2016. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2016</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="creative-commons">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Motivation:</bold> There are many tools for variant calling and effect prediction, but little to tie together large sample groups. Aggregating, sorting and summarizing variants and effects across a cohort is often done with <italic>ad hoc</italic> scripts that must be re-written for every new project. In response, we have written MuCor, a tool to gather variants from a variety of input formats (including multiple files per sample), perform database lookups and frequency calculations, and write many types of reports. In addition to use in large studies with numerous samples, MuCor can also be employed to directly compare variant calls from the same sample across two or more platforms, parameters or pipelines. A companion utility, DepthGauge, measures coverage at regions of interest to increase confidence in calls.</p>
      <p><bold>Availability and implementation</bold>: Source code is freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/blachlylab/mucor">https://github.com/blachlylab/mucor</ext-link> and a Docker image is available at <ext-link ext-link-type="uri" xlink:href="https://hub.docker.com/r/blachlylab/mucor/">https://hub.docker.com/r/blachlylab/mucor/</ext-link></p>
      <p>
        <bold>Contact:</bold>
        <email>james.blachly@osumc.edu</email>
      </p>
      <p><bold>Supplementary data:</bold><ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw028/-/DC1">Supplementary data</ext-link> are available at <italic>Bioinformatics</italic> online.</p>
    </abstract>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Examination of genomic variants from multiple samples is a common procedure in bioinformatics. Whether to use existing tools or custom scripts depends on many factors, including the number of samples, source(s) of data and scope of the project. A typical workflow may involve variant annotation, extraction of variants from VCF files, binning loci into features, calculating summary statistics, filtering, limiting by region and writing to a tab-separated values table. Finally, this table is imported into a statistical package for calculations or to Microsoft Excel for use by end-users or inclusion as a data supplement to a paper.</p>
    <p>Existing tools provide only parts of this workflow. The Genome Analysis Toolkit (<xref rid="btw028-B4" ref-type="bibr">McKenna <italic>et al.</italic>, 2010</xref>; <xref rid="btw028-B2" ref-type="bibr">DePristo <italic>et al.</italic>, 2011</xref>) function CombineVariants, JoinX (<ext-link ext-link-type="uri" xlink:href="http://gmt.genome.wustl.edu/packages/joinx/">http://gmt.genome.wustl.edu/packages/joinx/</ext-link>), and vcftools all can merge records from VCF files, but produce only another VCF file in turn. The resultant VCF is necessarily focused on individual genomic locations, and a study of features (e.g. genes) requires additional work on the part of the bioinformatician. Further, a multi-sample VCF file may be viewed interactively in a genome browser but is not suitable as a locus-wise frequency table for the biologist or statistician. Transformation of such a VCF to a detailed report again requires additional processing. Some commercial products purport to be end-to-end solutions, but these are not available to all. Variant ToolChest (<xref rid="btw028-B3" ref-type="bibr">Ebbert <italic>et al.</italic>, 2014</xref>) is open-source, but is designed around subsetting and has only preliminary support for non-VCF reporting.</p>
    <p>Motivated by these factors, we developed MuCor, a flexible tool for variant aggregation and summarization. MuCor collects variants from an arbitrary number of sources, assigns them to user-defined features (typically but not necessarily genes), looks them up in variant databases, calculates metrics and generates reports, all within a configurable and extensible framework.</p>
  </sec>
  <sec>
    <title>2 Implementation and usage</title>
    <sec>
      <title>2.1 Implementation</title>
      <p>MuCor is written in Python2 (≥2.7.0) and uses the following libraries not included with the Python standard library: numpy (<xref rid="btw028-B5" ref-type="bibr">Van Der Walt <italic>et al.</italic>, 2011</xref>), <monospace>pandas</monospace> and <monospace>HTSeq</monospace> (<xref rid="btw028-B1" ref-type="bibr">Anders <italic>et al.</italic>, 2015</xref>). It can optionally make use of <monospace>pytabix</monospace> and <monospace>xlsxwriter</monospace> to enable additional functionality. MuCor is used in two stages: <italic>setup</italic> and <italic>run</italic>.</p>
      <p>Project setup can be as simple as running the configure script, yielding a JSON settings file. In ‘autodetect’ mode, the script scans the project directory recursively for all supported variant call files belonging to a supplied list of sample IDs; a single sample may have more than one associated VCF file (e.g. if SNV and indel detection are performed separately). The setup script also establishes links to variant databases against which the study samples will be checked. The final configuration can be adjusted prior to run phase.</p>
      <p>In the run phase, MuCor parses the JSON configuration file and reads samples, databases, annotation and region files in to the analysis core. It then groups variants according to features specified in the annotation, optionally limited to region(s) of interest, calculates summary metrics and reports the information about each variant, feature and sample in output reports. The key vehicle by which this is accomplished is the pandas DataFrame (df). By leveraging the grouping, aggregation and pivoting functions native to pandas, the variant data can be swiftly manipulated in myriad ways. For example, all variants can be condensed to the gene level using <monospace>df.groupby</monospace>, while data could be reformatted into a sample × gene matrix with <monospace>df.pivot</monospace> or <monospace>df.stack</monospace>.</p>
      <p>The three steps of the run phase—input, aggregation and analysis, and reporting—are distinctly separated to make MuCor easy to extend. New input and output formats are easily coded (see <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw028/-/DC1">Supplementary material</ext-link>), while any run can be limited to regions of interest and cross-referenced against an arbitrary number of variant databases with merely a configuration change. <xref ref-type="fig" rid="btw028-F1">Figure 1</xref> summarizes MuCor’s modular approach.
<fig id="btw028-F1" orientation="portrait" position="float"><label>Fig. 1.</label><caption><p>Schematic of MuCor’s inputs, engine and outputs. Many more input and output types are available. See <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw028/-/DC1">Supplementary materials</ext-link>
</p></caption><graphic xlink:href="btw028f1p"/></fig>
</p>
      <p>MuCor is not a variant annotator: functional effect prediction is better left to specialized tools. In support of this, MuCor accepts as input data that have already been decorated with a functional effect prediction, retains this information through processing and passes it through to the output. Furthermore, some MuCor reports are in a form suitable for further processing by variant effect prediction software, a more efficient approach for large cohorts (i.e. hundreds to thousands of samples) than per-sample effect prediction.</p>
    </sec>
    <sec>
      <title>2.2 Usage</title>
      <p>Detailed instructions and sample workflows are given in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw028/-/DC1">Supplementary material</ext-link>. Configuration begins by specifying an annotation in GTF/GFF3 format, a feature type for grouping, a list of samples and one or more report types. The user may optionally specify reference databases (e.g. dbSNP, 1000 Genomes, COSMIC) and limit analysis to regions of interest. Variant files are automatically detected. The resultant JSON file may be hand-edited prior to execution, or retained for reproducibility.</p>
      <p>A corresponding run requires only passing the configuration file; output is written to a prespecified directory. Reports range in scope from summary-level counts across broad regions of interest to variant-specific metrics on a per-sample basis. The <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw028/-/DC1">Supplementary material</ext-link> contains a list of all report types and some example reports.</p>
      <p>Finally, DepthGauge, a companion program, queries source BAM files for total reads at each defined region in all samples to improve confidence in the veracity of wild-type calls.</p>
      <p>The generality of MuCor makes it useful for additional applications beyond comparing variants across samples. We have also used it to compare sequencing platforms, variant calling tools and pipelines within a single sample. In this case, the comparisons reveal concordance and discordance between platforms or tools, rather than between samples as in the canonical usage. See example workflow 3 in the <ext-link ext-link-type="uri" xlink:href="http://bioinformatics.oxfordjournals.org/lookup/suppl/doi:10.1093/bioinformatics/btw028/-/DC1">Supplementary material</ext-link>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Conclusions</title>
    <p>We have created MuCor, a tool to aggregate and report genomic variants in configurable, meaningful groups. A key goal is generality, that it may replace the <italic>ad hoc</italic> scripting often performed in the course of routine bioinformatic analyses of multiple samples. A flexible runtime and modular architecture ensure broad applicability: we have applied MuCor for its intended use by aggregating hundreds to thousands of cases, but also for novel uses, such as comparing different variant calling software pipelines or different sequencing platforms. By separating input parsers, the annotation and analysis core, and output reporting into distinct components, MuCor is modular and expandable through new input plugins, new annotations or auxiliary databases, and definition of new output report formats.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by the <funding-source>National Institutes of Health</funding-source> [<award-id>P30 CA016058</award-id>] and in part by an allocation of computing resources from The Ohio Supercomputer Center. </p>
    <p><bold><italic>Conflict of</italic></bold><italic>Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="PMC_1" content-type="local-data">
      <caption>
        <title>Supplementary Data</title>
      </caption>
      <media mimetype="text" mime-subtype="html" xlink:href="supp_32_10_1557__index.html"/>
      <media xlink:role="associated-file" mimetype="application" mime-subtype="pdf" xlink:href="supp_btw028_mucor_supplement.pdf"/>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btw028-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Anders</surname><given-names>S</given-names></name></person-group><etal/> (<year>2015</year>) <article-title>HTSeq—a Python framework to work with high-throughput sequencing data</article-title>. <source>Bioinformatics</source>, <volume>31</volume>, <fpage>166</fpage>–<lpage>169</lpage>.<pub-id pub-id-type="pmid">25260700</pub-id></mixed-citation>
    </ref>
    <ref id="btw028-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>DePristo</surname><given-names>M.A</given-names></name></person-group><etal/> (<year>2011</year>) <article-title>A framework for variation discovery and genotyping using next-generation DNA sequencing data</article-title>. <source>Nat. Genet</source>., <volume>43</volume>, <fpage>491</fpage>–<lpage>498</lpage>.<pub-id pub-id-type="pmid">21478889</pub-id></mixed-citation>
    </ref>
    <ref id="btw028-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ebbert</surname><given-names>M.T.W</given-names></name></person-group><etal/> (<year>2014</year>) <article-title>Variant Tool Chest: an improved tool to analyze and manipulate variant call format (VCF) files</article-title>. <source>BMC Bioinformatics</source>, <volume>15</volume>, <fpage>S12</fpage>.<pub-id pub-id-type="pmid">25080132</pub-id></mixed-citation>
    </ref>
    <ref id="btw028-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>McKenna</surname><given-names>A</given-names></name></person-group><etal/> (<year>2010</year>) <article-title>The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source>., <volume>20</volume>, <fpage>1297</fpage>–<lpage>1303</lpage>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="btw028-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Van Der Walt</surname><given-names>S</given-names></name></person-group><etal/> (<year>2011</year>) <article-title>The NumPy array: a structure for efficient numerical computation</article-title>. <source>Comput. Sci. Eng</source>., <volume>13</volume>, <fpage>22</fpage>–<lpage>30</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
