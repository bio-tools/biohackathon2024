<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">5408848</article-id>
    <article-id pub-id-type="pmid">28110292</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btw821</article-id>
    <article-id pub-id-type="publisher-id">btw821</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Biomartr: genomic data retrieval with R</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Drost</surname>
          <given-names>Hajk-Georg</given-names>
        </name>
        <xref ref-type="aff" rid="btw821-aff1"/>
        <xref ref-type="corresp" rid="btw821-cor1"/>
        <!--<email>hgd23@cam.ac.uk</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Paszkowski</surname>
          <given-names>Jerzy</given-names>
        </name>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Hancock</surname>
          <given-names>John</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btw821-aff1">The Sainsbury Laboratory, University of Cambridge, Cambridge, United Kingdom</aff>
    <author-notes>
      <corresp id="btw821-cor1">To whom correspondence should be addressed. Email: <email>hgd23@cam.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>4</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-01-20">
      <day>20</day>
      <month>1</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>20</day>
      <month>1</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>33</volume>
    <issue>8</issue>
    <fpage>1216</fpage>
    <lpage>1217</lpage>
    <history>
      <date date-type="received">
        <day>20</day>
        <month>8</month>
        <year>2016</year>
      </date>
      <date date-type="rev-recd">
        <day>16</day>
        <month>12</month>
        <year>2016</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>12</month>
        <year>2016</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license xlink:href="http://creativecommons.org/licenses/by-nc/4.0/" license-type="cc-by-nc">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btw821.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="SA1">
        <title>Motivation</title>
        <p>Retrieval and reproducible functional annotation of genomic data are crucial in biology. However, the current poor usability and transparency of retrieval methods hinders reproducibility. Here we present an open source R package, <italic>biomartr</italic>, which provides a comprehensive easy-to-use framework for automating data retrieval and functional annotation for meta-genomic approaches. The functions of <italic>biomartr</italic> achieve a high degree of clarity, transparency and reproducibility of analyses.</p>
      </sec>
      <sec id="SA2">
        <title>Results</title>
        <p>The <italic>biomartr</italic> package implements straightforward functions for bulk retrieval of all genomic data or data for selected genomes, proteomes, coding sequences and annotation files present in databases hosted by the National Center for Biotechnology Information (NCBI) and European Bioinformatics Institute (EMBL-EBI). In addition, <italic>biomartr</italic> communicates with the BioMart database for functional annotation of retrieved sequences. Comprehensive documentation of <italic>biomartr</italic> functions and five tutorial vignettes provide step-by-step instructions on how to use the package in a reproducible manner.</p>
      </sec>
      <sec id="SA3">
        <title>Availability and Implementation</title>
        <p>The open source <italic>biomartr</italic> package is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/HajkD/biomartr">https://github.com/HajkD/biomartr</ext-link> and <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/biomartr/index.html">https://cran.r-project.org/web/packages/biomartr/index.html</ext-link>.</p>
      </sec>
      <sec id="SA4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">European Research Council</named-content>
          <named-content content-type="funder-identifier">10.13039/100010663</named-content>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">EVOBREED</named-content>
        </funding-source>
        <award-id>322621</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Gatsby Fellowship</named-content>
        </funding-source>
        <award-id>AT3273/GLE</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 Introduction</title>
    <p>Modern genome studies are no longer limited to single genome analyses or pairwise genomic comparisons but increasingly involve meta-genomic approaches. For this purpose, the NCBI and EMBL-EBI organize and maintain specialized sequence databases that fulfil various scientific requirements. Among the most important and best-curated databases are Genbank, RefSeq and ENSEMBL. Genbank is an annotated collection of all publicly available DNA sequences (<xref rid="btw821-B1" ref-type="bibr">Benson <italic>et al.</italic>, 2013</xref>). The RefSeq collection offers a comprehensive, integrated, non-redundant and well-annotated set of sequences, including genomic DNA, transcripts and proteins (<xref rid="btw821-B4" ref-type="bibr">Pruitt <italic>et al.</italic>, 2007</xref>). The ENSEMBL database provides DNA sequence assemblies and curated Ensembl gene builds from various projects (<xref rid="btw821-B6" ref-type="bibr">Yates <italic>et al.</italic>, 2016</xref>).</p>
    <p>Current meta-genomic pipelines consist of custom-prepared scripts that automatically retrieve selected genomes from these resources. Post-processing, handling and analysis usually uses the Perl, Python, or R programming languages. Although powerful sequence retrieval frameworks have been implemented in Perl (BioPerl), Python (BioPython) and R, their use requires appropriate programming expertise. Furthermore, none of these frameworks combines meta-genomic scale sequence retrieval with functional annotation. These deficiencies also apply to the currently available R packages <italic>seqinr</italic> and <italic>biomaRt</italic>. The <italic>seqinr</italic> package aims to automate sequence retrieval in R but is not designed for meta-genomic approaches and does not include functional annotation. The <italic>biomaRt</italic> package aims to provide functional annotation methods but these are also not designed for meta-genomic approaches and are not easy to use for non-programming experts. To provide a fast, transparent and easy-to-use framework for combined genomic data retrieval and efficient functional annotation of genetic features in meta-genomic approaches, we have designed the R package <italic>biomartr</italic> for use with the NCBI, ENSEMBL, ESNEMBLGENOMES and BioMart infrastructures (<xref rid="btw821-B5" ref-type="bibr">Smedley <italic>et al.</italic>, 2009</xref>). The major advantage of <italic>biomartr</italic> is that it does not require profound programming expertise. It is optimized to handle multiple genomes simultaneously and allows, for example, assignment of Gene Ontology (GO) information and sequence homology relationships between different organisms by communicating with the BioMart database. The interface functions communicating with the BioMart database use a novel organism centered notation for information retrieval. Instead of learning the underlying database and dataset linking convention of BioMart, users can type the scientific name of an organism of interest (e.g. ‘Homo sapiens’) to retrieve a list of all available information provided by BioMart for this particular organism of interest. In summary, the <italic>biomartr</italic> package provides researchers with a powerful tool for efficient, straightforward and reproducible handling of large-scale meta-genomic data and intuitive organism centered interface functions to retrieve functional annotation information from the BioMart database.</p>
  </sec>
  <sec>
    <title>2 Implementation</title>
    <p>The <italic>biomartr</italic> package is released under the GNU General Public License within the CRAN project (R Core Team). The package can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/biomartr/index.html">https://cran.r-project.org/web/packages/biomartr/index.html</ext-link>. The source code is publically available at <ext-link ext-link-type="uri" xlink:href="https://github.com/HajkD/biomartr">https://github.com/HajkD/biomartr</ext-link>. The <italic>biomartr</italic> package depends on the R packages <italic>Biostrings</italic>, <italic>data.table</italic>, <italic>dplyr</italic>, <italic>readr</italic>, <italic>downloader</italic>, <italic>RCurl</italic>, <italic>XML</italic>, <italic>biomaRt</italic> (<xref rid="btw821-B3" ref-type="bibr">Durinck <italic>et al.</italic>, 2005</xref>), <italic>httr</italic> and <italic>stringr</italic>. The functionality of packages such as <italic>biomaRt</italic> (<xref rid="btw821-B3" ref-type="bibr">Durinck <italic>et al.</italic>, 2005</xref>) and <italic>seqinr</italic> (<xref rid="btw821-B2" ref-type="bibr">Charif and Lobry, 2007</xref>) are included in <italic>biomartr</italic> and significantly extended. This is achieved by additional data retrieval functions and the direct combination of <italic>biomaRt</italic> and <italic>seqinr</italic> functionality with improved retrieval capability.</p>
  </sec>
  <sec>
    <title>3 Functions and examples</title>
    <p>Thirty-seven functions are provided by the <italic>biomartr</italic> package. For genome and database retrieval, the functions <italic>listDatabases()</italic>, <italic>listKingdoms()</italic>, <italic>listGroups()</italic>, <italic>listSubgroups(), listGenomes()</italic> and <italic>is.genome.available()</italic> enable the listing of all databases and genomic sequences that are available for automated retrieval.</p>
    <p>For example, the entire NCBI nr database can then be downloaded easily using just one command:<disp-quote content-type="extract"><p><italic>download.database.all(db = ‘nr’</italic>, <italic>path = ‘nr’)</italic></p></disp-quote></p>
    <p>Analogous to the retrieval of databases as described above, selected genomes can also be retrieved using the following function.</p>
    <p>As exemplified below by the human genome, download can be triggered by typing:<disp-quote content-type="extract"><p><italic>getGenome (db = ‘refseq’</italic>, <italic>organism = ‘Homo sapiens’)</italic></p></disp-quote></p>
    <p>The command <italic>getGenome()</italic> also documents the source and version of the downloaded files. Corresponding download of proteomes, coding sequences and annotation files can be obtained by applying</p>
    <p><italic>getProteome()</italic>, <italic>getCDS()</italic> and <italic>getGFF()</italic>, respectively. The <italic>db</italic> argument can be specified to retrieve genomes from other NCBI or ENSEMBL databases. For meta-genome approaches, <italic>biomartr</italic> includes the <italic>meta.retrieval()</italic> function to download the genomes of entire kingdoms:<disp-quote content-type="extract"><p># Download all vertebrate genomes</p><p><italic>meta.retrieval(kingdom = ‘vertebrate_mammalian’</italic>, <italic>type = ‘genome’)</italic></p></disp-quote></p>
    <p>Hence, for example, all mammalian genomes can be downloaded with just one command. The <italic>type</italic> argument can also be specified for proteomes, coding sequences and annotation files. For functional annotation, available datasets and BioMart connections for a specific organism of interest can be obtained by typing:<disp-quote content-type="extract"><p>organismBM(organism = ‘Homo sapiens’)</p></disp-quote></p>
    <p>For example, available sequence homology relationships to other organisms can be retrieved by running the command:<disp-quote content-type="extract"><p><italic>organismAttributes(organism = ‘Homo sapiens’</italic>, <italic>topic = ‘homolog’)</italic></p></disp-quote></p>
    <p>Finally, users can retrieve GO information for a particular gene or gene set, e.g. human gene <italic>GUCA2A</italic> by running the command:<disp-quote content-type="extract"><p><italic>getGO(organism = ‘Homo sapiens’</italic>,</p><p><italic>genes = ‘GUCA2A’</italic>,</p><p>filters = ‘hgnc_symbol’)</p></disp-quote></p>
    <p>Tutorials are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/HajkD/biomartr#tutorials">https://github.com/HajkD/biomartr#tutorials</ext-link> and also in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Tutorial</xref>.</p>
  </sec>
  <sec>
    <title>4 Conclusions</title>
    <p>The functions provided by <italic>biomartr</italic> enable fast data retrieval and functional annotation queries to prominent sequence and annotation databases such as NCBI, ENSEMBL, ENSEMBLGENOMES and BioMart. In addition, all data retrieval functions implemented in <italic>biomartr</italic> automatically archive and log the source, date, version, taxid and type of data retrieved. Thus, <italic>biomartr</italic> improves reproducibility and transparency in genomic data handling. It can be integrated easily into meta-genomic analyses.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work was supported by an European Research Council grant named EVOBREED [grant number 322621] (to JP) and a Gatsby Fellowship [grant number AT3273/GLE] (to JP).</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btw821_supp.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btw821-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Benson</surname><given-names>D.A.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Genbank</article-title>. <source>Nucleic Acids Res</source>., <volume>41</volume>, <fpage>D36</fpage>–<lpage>D42</lpage>.<pub-id pub-id-type="pmid">23193287</pub-id></mixed-citation>
    </ref>
    <ref id="btw821-B2">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Charif</surname><given-names>D.</given-names></name>, <name name-style="western"><surname>Lobry</surname><given-names>J.R.</given-names></name></person-group> (<year>2007</year>) <comment>SeqinR 1.0-2: a contributed package to the R project for statistical computing devoted to biological sequences retrieval and analysis. In <italic>Structural approaches to sequence evolution</italic>. Springer Berlin Heidelberg, pp.</comment><fpage>207</fpage>–<lpage>232</lpage>.</mixed-citation>
    </ref>
    <ref id="btw821-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Durinck</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2005</year>) 
<article-title>BioMart and Bioconductor: a powerful link between biological databases and microarray data analysis</article-title>. <source>Bioinformatics</source>, <volume>21</volume>, <fpage>3439</fpage>–<lpage>3440</lpage>.<pub-id pub-id-type="pmid">16082012</pub-id></mixed-citation>
    </ref>
    <ref id="btw821-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Pruitt</surname><given-names>K.D.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>NCBI reference sequences (RefSeq): a curated non-redundant sequence database of genomes, transcripts and proteins</article-title>. <source>Nucleic Acids Res</source>., <volume>35</volume>, <fpage>D61</fpage>–<lpage>D65</lpage>.<pub-id pub-id-type="pmid">17130148</pub-id></mixed-citation>
    </ref>
    <ref id="btw821-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Smedley</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>BioMart – biological queries made easy</article-title>. <source>BMC Genomics</source>, <volume>10</volume>, <fpage>22.</fpage><pub-id pub-id-type="pmid">19144180</pub-id></mixed-citation>
    </ref>
    <ref id="btw821-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Yates</surname></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Ensembl 2016</article-title>. <source>Nucleic Acids Res</source>., <volume>44</volume>, <fpage>D710</fpage>–<lpage>D716</lpage>.<pub-id pub-id-type="pmid">26687719</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
