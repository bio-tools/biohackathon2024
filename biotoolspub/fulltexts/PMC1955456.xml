<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">1955456</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-8-271</article-id>
    <article-id pub-id-type="pmid">17662141</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-8-271</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Accurate multiple sequence-structure alignment of RNA sequences using combinatorial optimization</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" corresp="yes" contrib-type="author">
        <name>
          <surname>Bauer</surname>
          <given-names>Markus</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I2">2</xref>
        <email>mbauer@inf.fu-berlin.de</email>
      </contrib>
      <contrib id="A2" corresp="yes" contrib-type="author">
        <name>
          <surname>Klau</surname>
          <given-names>Gunnar W</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <xref ref-type="aff" rid="I3">3</xref>
        <email>gunnar@math.fu-berlin.de</email>
      </contrib>
      <contrib id="A3" contrib-type="author">
        <name>
          <surname>Reinert</surname>
          <given-names>Knut</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>reinert@inf.fu-berlin.de</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Mathematics and Computer Science, Free University Berlin, 14195 Berlin, Germany</aff>
    <aff id="I2"><label>2</label>International Max Planck Research School for Computational Biology and Scientific Computing, Berlin, Germany</aff>
    <aff id="I3"><label>3</label>DFG Research Center Matheon, Berlin, Germany</aff>
    <pub-date pub-type="collection">
      <year>2007</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>27</day>
      <month>7</month>
      <year>2007</year>
    </pub-date>
    <volume>8</volume>
    <fpage>271</fpage>
    <lpage>271</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/8/271"/>
    <history>
      <date date-type="received">
        <day>30</day>
        <month>3</month>
        <year>2007</year>
      </date>
      <date date-type="accepted">
        <day>27</day>
        <month>7</month>
        <year>2007</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2007 Bauer et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2007</copyright-year>
      <copyright-holder>Bauer et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Bauer
               Markus
               
               
               mbauer@inf.fu-berlin.de
            </dc:author><dc:title>
            Accurate multiple sequence-structure alignment of RNA sequences using combinatorial optimization
         </dc:title><dc:date>2007</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 8(1): 271-. (2007)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2007)8:1&#x0003c;271&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>The discovery of functional non-coding RNA sequences has led to an increasing interest in algorithms related to RNA analysis. Traditional sequence alignment algorithms, however, fail at computing reliable alignments of low-homology RNA sequences. The spatial conformation of RNA sequences largely determines their function, and therefore RNA alignment algorithms have to take structural information into account.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present a graph-based representation for sequence-structure alignments, which we model as an integer linear program (ILP). We sketch how we compute an optimal or near-optimal solution to the ILP using methods from combinatorial optimization, and present results on a recently published benchmark set for RNA alignments.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The implementation of our algorithm yields better alignments in terms of two published scores than the other programs that we tested: This is especially the case with an increasing number of input sequences. Our program LARA is freely available for academic purposes from <ext-link ext-link-type="uri" xlink:href="http://www.planet-lisa.net"/>.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Background</title>
    <p>In recent years, research in RNA sequences and structures has dramatically increased: the discovery of functionally important, not protein-coding, RNA sequences has challenged the traditional picture of the flow of genetic information from DNA via RNA to proteins as functional units. It is now well-established that RNA molecules introduce an additional layer in genetic information processing. They play a significant active role in cell and developmental biology and carry out many tasks that were previously attributed exclusively to proteins. One of the most eminent examples is the class of microRNAs [<xref ref-type="bibr" rid="B1">1</xref>,<xref ref-type="bibr" rid="B2">2</xref>], an abundant class of small functional RNAs that regulate gene expression by binding to a target in the mRNA. Other examples include snoRNAs, which modify ribosomal RNA [<xref ref-type="bibr" rid="B3">3</xref>], <italic>signal recognition particle </italic>RNAs [<xref ref-type="bibr" rid="B4">4</xref>], <italic>cis</italic>-acting regulatory elements, and piRNAs [<xref ref-type="bibr" rid="B5">5</xref>], a novel class of ncRNAs whose function is still unclear. It is likely that only a small fraction of regulatory RNAs has been identified so far and that many more have yet to be discovered [<xref ref-type="bibr" rid="B6">6</xref>].</p>
    <p>Computational analyses have contributed largely to the discovery and advancement of biological knowledge. Heuristic methods, such as BLAST [<xref ref-type="bibr" rid="B7">7</xref>], or exact approaches based on dynamic programming, such as the Smith-Waterman algorithm [<xref ref-type="bibr" rid="B8">8</xref>], are used as everyday tools to analyze DNA and protein sequences. In case of RNA sequences, sequence information alone is not sufficient anymore. An RNA sequence folds back onto itself and forms hydrogen bonds between nucleotides. These bonds lead to the distinctive <italic>secondary structure </italic>of an RNA sequence.</p>
    <p>RNA sequences evolve more rapidly than the structure they are forming, because their evolutionary behavior follows the <italic>structure-function </italic>paradigm: RNA molecules with different sequences but same or similar secondary structure are likely to belong to the same functional family, in which the secondary structure is conserved by selective pressure. Hence, computational analysis of RNA molecules inevitably involves considering secondary structure information in addition to the primary sequence. Computing <italic>sequence-structure alignments </italic>is a key step in many important applications. These include finding homologous structures of known ncRNA families [<xref ref-type="bibr" rid="B9">9</xref>], phylogenetic fingerprinting (as conducted for example for the ITS2 database [<xref ref-type="bibr" rid="B10">10</xref>]), or the computation of a consensus structure of a set of RNA molecules [<xref ref-type="bibr" rid="B11">11</xref>]. A recent study shows that pure sequence-based pairwise alignments are unable to produce satisfactory results if the pairwise sequence identity drops below 50 to 60% [<xref ref-type="bibr" rid="B12">12</xref>]. Figure <xref ref-type="fig" rid="F1">1</xref> illustrates this situation and shows two different alignments of seven tRNA sequences with a pairwise sequence identity of 39%, where the upper alignment is based on sequence information alone and the lower alignment additionally rewards the conservation of structural elements. One can clearly see that the sequence-based alignment is unable to preserve the typical tRNA-cloverleaf structure, whereas the structural alignment conserves the structural features of the input sequences.</p>
    <fig position="float" id="F1">
      <label>Figure 1</label>
      <caption>
        <p><bold>Comparison between sequence and sequence-structure alignments</bold>. Comparison between sequence-based (upper, computed by the CLUSTALW program [60]) and sequence-structure-based alignment (lower, computed by LARA, an implementation of our new approach). The left and right consensus structures are based on the ClustalW and LaRA alignment, respectively (consensus structures generated using RNAalifold [11]).</p>
      </caption>
      <graphic xlink:href="1471-2105-8-271-1"/>
    </fig>
    <p>Unfortunately, considering structural information adds an additional level of complexity to the problem of aligning two or several sequences. In the remainder of this section, we present a classification of structural alignment problem variants including previous work. Section 2 describes our new approach to multiple sequence-structure alignment. We employ methods from mathematical programming and solve the problem as an integer linear program resulting from a graph-theoretical reformulation. Section 3 is dedicated to an extensive computational study. We describe LARA, the freely available implementation of our novel approach, and present detailed results of a comparative study including state-of-the-art programs on a recently published benchmark database of structural alignments. The results show that on average our software is currently the best program in terms of alignment quality, outperforming other programs with an increasing number of input sequences. Finally, we discuss our results and suggest future research directions in Sect. 4.</p>
    <p>In contrast to previous work [<xref ref-type="bibr" rid="B13">13</xref>-<xref ref-type="bibr" rid="B15">15</xref>] this article describes a full integer linear programming (ILP) formulation that does include arbitrary gap costs and an extensive performance analysis of our implementation for the first time. Due to page limits the mathematical fundament and all proofs are omitted: the interested reader is referred to the companion paper [<xref ref-type="bibr" rid="B16">16</xref>] that focuses on an in-depth description of the mathematical properties of the intricate multiple case containing all proofs.</p>
    <sec>
      <title>1.1 Previous approaches</title>
      <p>Depending on the available knowledge about the (putative) structures that we want to align, there are three different alignment scenarios for two RNA structures, which readily extend to the multiple case. Figure <xref ref-type="fig" rid="F2">2</xref> gives a cartoon illustration of the three scenarios.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>Input scenarios</bold>. Different input alignment scenarios of RNA sequences (pairwise case): (a) the alignment of two known structures, (b) of one known and one unknown structure, and (c) of two unknown structures.</p>
        </caption>
        <graphic xlink:href="1471-2105-8-271-2"/>
      </fig>
      <p>1. <italic>Structure-to-structure </italic>alignments align two known secondary structures, typically the <italic>minimum free energy </italic>structures. This scenario applies if one searches for common structural motifs that are shared by both structures and there is reason to believe that the secondary structures are correct.</p>
      <p>2. <italic>Structure-to-unknown </italic>alignments align a given structure to a sequence with unknown structure. Applications are finding homologous sequences by inferring a consensus structure to a sequence (this is done, for example, in the verification phase of the FASTR package [<xref ref-type="bibr" rid="B9">9</xref>]), or finding new family members of ncRNA families: This problem has recently sparked considerable interest in the context of searching homologous structures of noncoding-RNAs in large genomic sequences. See [<xref ref-type="bibr" rid="B17">17</xref>] for a survey.</p>
      <p>3. In the <italic>unknown-to-unknown </italic>alignment problem, no previous structural information is given. It applies when two RNA sequences are suspected to share a common, but still unknown, structure. We constrain the space of possible structures by the entire set of possible Watson-Crick and wobble pairs. A reduction of the size of this space is possible, for instance, by applying a folding algorithm to obtain the base pair probabilities [<xref ref-type="bibr" rid="B18">18</xref>] and then considering only those interactions whose probabilities are above a certain threshold.</p>
      <p>There are four major alignment models for RNA structures that tackle the previous described alignment scenarios: <italic>annotated sequences</italic>, <italic>tree models</italic>, <italic>probabilistic models</italic>, and <italic>graph-based models</italic>. We give small examples for each model in Fig. <xref ref-type="fig" rid="F3">3</xref>: Note that we did not show an example of probabilistic models because the representation of probabilistic and tree models are the same. The underlying algorithms, however, are completely different. Table <xref ref-type="table" rid="T1">1</xref> classifies previous work in the area of structural RNA alignment according to the different models and scenarios.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Classification of previous work</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td/>
              <td align="center">tree-based</td>
              <td align="center">annotated sequences</td>
              <td align="center">probabilistic</td>
              <td align="center">graph-based</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">structure-to-structure</td>
              <td align="center">[20-22,61]</td>
              <td align="center">[22,25,26,62]</td>
              <td align="center">[34]</td>
              <td align="center">[14,41,43]</td>
            </tr>
            <tr>
              <td align="left">structure-to-unknown</td>
              <td align="center">--</td>
              <td align="center">[22]</td>
              <td align="center">[34,38]</td>
              <td align="center">[14,41,43]</td>
            </tr>
            <tr>
              <td align="left">unknown-to-unknown</td>
              <td align="center">--</td>
              <td align="center">[22,27–29,31]</td>
              <td align="center">[37]</td>
              <td align="center">[14,41,43]</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <fig position="float" id="F3">
        <label>Figure 3</label>
        <caption>
          <p><bold>RNA representations</bold>. Different models representing RNA structures: (a) tree representation, (b) annotated sequences, and (c) graph-based models.</p>
        </caption>
        <graphic xlink:href="1471-2105-8-271-3"/>
      </fig>
      <sec>
        <title>Tree-based models</title>
        <p>Tree-based structural alignment algorithms view an RNA secondary structure as a tree. Depending on the particular model (either tree-editing [<xref ref-type="bibr" rid="B19">19</xref>] or tree alignment [<xref ref-type="bibr" rid="B20">20</xref>]), one either searches for the minimal number of operations (node inserting, node deletion, and node substitution) to transform one tree into the other, or into a common supertree. Algorithms employing the model from [<xref ref-type="bibr" rid="B20">20</xref>] have time complexities in <italic>O</italic>(<italic>n</italic><sup>4</sup>), thus making the computation expensive. Here and in the following, <italic>n </italic>denotes the size of the longest sequence. Tree-alignment algorithms have complexities that are on average only slightly worse than conventional sequence alignment. More precisely, their running time is in <italic>O</italic>(<italic>n</italic><sup>2</sup>·Δ<sup>2</sup>), where Δ denotes the maximum number of branches of a multiloop in the input structures.</p>
        <p>A tool that builds upon the tree paradigm is RNAFORESTER [<xref ref-type="bibr" rid="B21">21</xref>]. It computes multiple structure-to-structure alignments of RNA sequences by performing tree-alignment in a progressive fashion.</p>
      </sec>
      <sec>
        <title>Annotated sequences</title>
        <p>We call a sequence that is augmented by structural information an <italic>annotated sequence</italic>. Classical dynamic programming (DP) algorithms can be extended to annotated sequences. The DP solution for the structure-to-structure and structure-to-unknown problem then typically requires <italic>O</italic>(<italic>n</italic><sup>4</sup>) and <italic>O</italic>(<italic>n</italic><sup>3</sup>) in time and space, respectively. Bafna, Muthukrishnan, and Ravi describe an algorithm that simultaneously aligns the sequence and secondary structure of two RNA sequences [<xref ref-type="bibr" rid="B22">22</xref>]. Their method runs in time <italic>O</italic>(<italic>n</italic><sup>4</sup>), which still does not make it applicable to instances of realistic size. Eddy [<xref ref-type="bibr" rid="B23">23</xref>] proposes an algorithm that reduces the memory consumption to <italic>O</italic>(<italic>n</italic><sup>2 </sup>log <italic>n</italic>). The STRAL tool [<xref ref-type="bibr" rid="B24">24</xref>] uses the values of the <italic>base pair probability matrices</italic>, as given by the partition function [<xref ref-type="bibr" rid="B18">18</xref>], to compute the maximal pairing probability of a single nucleotide and to align the sequences in a CLUSTALW-like fashion.</p>
        <p>In the restricted structure-to-structure scenario, one can resort to more sophisticated edit-models like the one proposed by Jiang in [<xref ref-type="bibr" rid="B25">25</xref>] where the authors specify operations both on the sequence and the structure level. The dynamic programming algorithm is in <italic>O</italic>(<italic>n</italic><sup>4</sup>), making the computation rather tedious for longer sequences. A program that implements the Jiang model is MARNA [<xref ref-type="bibr" rid="B26">26</xref>]: it computes pairwise sequence-structure alignments, but is additionally able to compute multiple alignments. To this end, MARNA computes all pairwise structural alignment and uses T-COFFEE to compute the actual multiple alignment incorporating the structural information of the pairwise alignments.</p>
        <p>The unknown-to-unknown scenario requires the simultaneous computation of the alignment and consensus structure. The computational problem of simultaneously considering sequence and structure of an RNA molecule was initially addressed by Sankoff in [<xref ref-type="bibr" rid="B27">27</xref>], where the author proposed a DP algorithm to align and fold a set of RNA sequences at the same time. The CPU and memory requirements of the original algorithm are <italic>O</italic>(<italic>n</italic><sup>3<italic>k</italic></sup>) and <italic>O</italic>(<italic>n</italic><sup>2<italic>k</italic></sup>), respectively, where <italic>k </italic>is the number of sequences and <italic>n </italic>is their maximal length. Current implementations modify Sankoff's algorithm by imposing limits on the size or shape of substructures, e.g., DYNALIGN [<xref ref-type="bibr" rid="B28">28</xref>,<xref ref-type="bibr" rid="B29">29</xref>], or FOLDALIGN [<xref ref-type="bibr" rid="B30">30</xref>] that combine a sliding window and banded alignment approach. Hofacker, Bernhart, and Stadler [<xref ref-type="bibr" rid="B31">31</xref>] have presented the PMMULTI software to align base pair probability matrices. Their recursions are essentially the same as the ones given by Sankoff in [<xref ref-type="bibr" rid="B27">27</xref>] and subsequently used for sequence-structure alignment by Bafna et al. in [<xref ref-type="bibr" rid="B22">22</xref>] with the only difference that they consider probabilities instead of fixed structures. By banding the range of possible alignment positions they bring the time and space complexity of the pairwise case down to <italic>O</italic>(<italic>n</italic><sup>4</sup>) and <italic>O</italic>(<italic>n</italic><sup>3</sup>), respectively. For the multiple case, they align consensus base pair probability matrices in a progressive fashion. Similar in spirit are FOLDALIGNM [<xref ref-type="bibr" rid="B32">32</xref>] or LOCARNA [<xref ref-type="bibr" rid="B33">33</xref>], two recent reimplementations of the PMMULTI approach. FOLDALIGNM provides both several restrictions on the alignment and a two-stage procedure to fill the DP matrix: this further reduces the running time to <italic>O</italic>(<italic>n</italic><sup>2</sup><italic>δ</italic><sup>2</sup>) where <italic>n </italic>is the length of the longer sequence and <italic>d </italic>is the maximal length difference of the alignment of two subsequences. LOCARNA on the other hand takes advantage of the sparse base pair probabilities matrices to reduce the running time.</p>
      </sec>
      <sec>
        <title>Probabilistic models</title>
        <p>Eddy and Durbin [<xref ref-type="bibr" rid="B34">34</xref>] describe <italic>covariance models </italic>for measuring the secondary structure and primary sequence consensus of RNA sequence families. They present algorithms for analyzing and comparing RNA sequences as well as database search techniques. Since the basic operation in their approach is an expensive dynamic programming algorithm, their algorithms cannot analyze sequences longer than 150–200 nucleotides. Therefore, recent approaches reduce the running time by incorporating additional information, e.g. Holmes et al.'s STEMLOC [<xref ref-type="bibr" rid="B35">35</xref>,<xref ref-type="bibr" rid="B36">36</xref>] where the authors propose the concept of <italic>alignment/fold envelopes </italic>that constrain possible alignments. Along these lines, in [<xref ref-type="bibr" rid="B37">37</xref>] the authors keep a set of probabilistically derived alignment positions fixed: these alignment positions serve subsequently as anchors for the structural alignment which prune away large parts of the search space. The authors of [<xref ref-type="bibr" rid="B38">38</xref>] describe a method based on conditional random fields to align an RNA sequence with known structure to one with unknown structure. They estimate their parameters using conditional random fields and compute the alignment using the recursions from [<xref ref-type="bibr" rid="B39">39</xref>].</p>
      </sec>
      <sec>
        <title>Graph-based models</title>
        <p>Kececioglu [<xref ref-type="bibr" rid="B40">40</xref>] has introduced a graph-theoretical model for the classical primary sequence alignment problem. In [<xref ref-type="bibr" rid="B41">41</xref>] the authors present a first extension of this model to RNA structures and propose a branch-and-cut approach based on an integer linear programming formulation. Based on this formulation and inspired by the successful application of Lagrangian relaxation by Lancia and Caprara [<xref ref-type="bibr" rid="B42">42</xref>] to the related <italic>contact map overlap problem</italic>, in [<xref ref-type="bibr" rid="B43">43</xref>] the authors switch from branch-and-cut to the Lagrangian relaxation technique. They are able to solve instances a magnitude larger by simultaneously reducing the running time significantly. In [<xref ref-type="bibr" rid="B44">44</xref>] the authors give a graph-theoretic model for the computation of multiple sequence alignments with arbitrary gap costs. In the next section we will combine the formulations given in [<xref ref-type="bibr" rid="B43">43</xref>] and [<xref ref-type="bibr" rid="B44">44</xref>], resulting in a novel graph-based formulation for sequence-structure alignment with arbitrary gap costs.</p>
        <p>Note that the graph-based model naturally deals with all three alignment scenarios. In addition, unlike other algorithmic approaches, the graph-based algorithms do not restrict the input in any way and hence can handle arbitrary <italic>pseudoknots</italic>: Pseudoknots have been shown to play important roles in a variety of biological processes, see [<xref ref-type="bibr" rid="B45">45</xref>] for a recent review. Most DP-based algorithms assume nested secondary structures to compute subproblems efficiently. Few exceptions exist, for example [<xref ref-type="bibr" rid="B46">46</xref>], but these algorithms are always restricted to certain classes of pseudoknots (like H-type pseudoknots) and do not handle the general case.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>2 Results</title>
    <p>This section deals with our novel graph-based approach to structural RNA alignment. We first give the problem definition and then describe the graph-theoretical model we use, which combines the models presented in [<xref ref-type="bibr" rid="B43">43</xref>] and [<xref ref-type="bibr" rid="B44">44</xref>]. We convert the nucleotides of the input sequences into vertices of a graph, and we add edges between the vertices that represent either structural information or possible alignments of pairs of nucleotides. Based on the graph model we develop an integer linear programming formulation. We find solutions using an algorithmic approach employing methods from combinatorial optimization. For sake of simplicity, we will limit the description to the two-sequence case. We want to stress, however, that the model can be extended to the multiple case without changing the core algorithms and ideas. The interested reader is referred to an extensive theoretical description including proofs and a computational complexity discussion appearing elsewhere [<xref ref-type="bibr" rid="B16">16</xref>].</p>
    <sec>
      <title>2.1 Graph-theoretical model for structural RNA alignment</title>
      <sec>
        <title>Problem definition</title>
        <p>Given two RNA sequences, we denote by <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-8-271-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFaeFqaaa@3820@</mml:annotation></mml:semantics></mml:math></inline-formula> an alignment of the two sequences. Let <italic>s</italic><sub><italic>S</italic></sub>(<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-8-271-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFaeFqaaa@3820@</mml:annotation></mml:semantics></mml:math></inline-formula>) be the sequence score of alignment <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-8-271-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFaeFqaaa@3820@</mml:annotation></mml:semantics></mml:math></inline-formula> including gap penalties, and let <italic>s</italic><sub><italic>P</italic></sub>(<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-8-271-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFaeFqaaa@3820@</mml:annotation></mml:semantics></mml:math></inline-formula>) be the score of structural features that are conserved by the alignment <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-8-271-i1" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">A</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFaeFqaaa@3820@</mml:annotation></mml:semantics></mml:math></inline-formula>. We now aim at maximizing the combined sequence-structure score, that is, we search for an alignment <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-8-271-i2" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msup><mml:mi mathvariant="script">A</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFaeFqdaahaaWcbeqaaiabgEHiQaaaaaa@393C@</mml:annotation></mml:semantics></mml:math></inline-formula> with</p>
        <p>
          <disp-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-8-271-i3" overflow="scroll">
              <mml:semantics definitionURL="" encoding="">
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>s</mml:mi>
                    <mml:mi>S</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msup>
                    <mml:mi mathvariant="script">A</mml:mi>
                    <mml:mo>∗</mml:mo>
                  </mml:msup>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>s</mml:mi>
                    <mml:mi>P</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:msup>
                    <mml:mi mathvariant="script">A</mml:mi>
                    <mml:mo>∗</mml:mo>
                  </mml:msup>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>=</mml:mo>
                  <mml:munder>
                    <mml:mrow>
                      <mml:mi>max</mml:mi>
                      <mml:mo>⁡</mml:mo>
                    </mml:mrow>
                    <mml:mi mathvariant="script">A</mml:mi>
                  </mml:munder>
                  <mml:msub>
                    <mml:mi>s</mml:mi>
                    <mml:mi>S</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="script">A</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>s</mml:mi>
                    <mml:mi>P</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mi mathvariant="script">A</mml:mi>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>.</mml:mo>
                </mml:mrow>
                <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGZbWCdaWgaaWcbaGaem4uamfabeaakiadmcOGOaakt0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFaeFqdGaJaYbaaSqajWiGbGaJakadmcOHxiIkaaGccWaJakykaKIaey4kaSIaem4Cam3aaSbaaSqaaiabdcfaqbqabaGccqGGOaakcqWFaeFqdaahaaWcbeqaaiabgEHiQaaakiabcMcaPiabg2da9maaxababaGagiyBa0MaeiyyaeMaeiiEaGhaleaacqWFaeFqaeqaaOGaem4Cam3aaSbaaSqaaiabdofatbqabaGccqGGOaakcqWFaeFqcqGGPaqkcqGHRaWkcqWGZbWCdaWgaaWcbaGaemiuaafabeaakiabcIcaOiab=bq8bjabcMcaPiabc6caUaaa@61E3@</mml:annotation>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>Figure <xref ref-type="fig" rid="F4">4</xref> gives a toy example showing two annotated sequences and two possible alignments, one maximizing the score of sequence and structure, and the other one just the sequence score alone. This problem definition comprises the one addressed by Bafna et al. in [<xref ref-type="bibr" rid="B22">22</xref>]: Our model, however, also allows tertiary elements, which is not covered by their recursions.</p>
        <fig position="float" id="F4">
          <label>Figure 4</label>
          <caption>
            <p><bold>Problem statement</bold>. Given the annotated sequences on the left side as the input, we search for an alignment maximizing the sequence plus the induced structure score. The alignment in the middle conserves the entire annotation (highlighted in grey), whereas the alignment on the right hand side maximizes the sequence score and does not conserve any structure.</p>
          </caption>
          <graphic xlink:href="1471-2105-8-271-4"/>
        </fig>
      </sec>
      <sec>
        <title>Basic model</title>
        <p>Let <italic>s </italic>= <italic>s</italic><sub>1</sub>, ..., <italic>s</italic><sub><italic>n </italic></sub>be a sequence of length <italic>n </italic>over the alphabet Σ = {<italic>A</italic>, <italic>C</italic>, <italic>G</italic>, <italic>U</italic>}. A pair (<italic>s</italic><sub><italic>i</italic></sub><italic>, s</italic><sub><italic>j</italic></sub>) is called an <italic>interaction </italic>if <italic>i &lt; j</italic>, and nucleotide <italic>i </italic>pairs with <italic>j</italic>. In most cases, these pairs will be Watson-Crick or wobble base pairs. The set <italic>p </italic>of interactions is called the <italic>annotation </italic>of sequence <italic>s</italic>. Two interactions (<italic>s</italic><sub><italic>k</italic></sub><italic>, s</italic><sub><italic>l</italic></sub>) and (<italic>s</italic><sub><italic>m</italic></sub><italic>, s</italic><sub><italic>o</italic></sub>) are said to be <italic>inconsistent</italic>, if they share one base; they form a <italic>pseudoknot </italic>if they "cross" each other, that is, if <italic>k </italic>&lt;<italic>m </italic>&lt;<italic>l </italic>&lt;<italic>o </italic>or <italic>m </italic>&lt;<italic>k </italic>&lt;<italic>o </italic>&lt;<italic>l</italic>. A pair (<italic>s</italic>, <italic>p</italic>) is called an <italic>annotated sequence</italic>. Note that a structure where no pair of interactions is inconsistent with each other forms a valid secondary structure of an RNA sequence, possibly with pseudoknots.</p>
        <p>We are given two annotated sequences (<italic>s</italic><sup><italic>A</italic></sup>, <italic>p</italic><sup><italic>A</italic></sup>) and (<italic>s</italic><sup><italic>B</italic></sup>, <italic>p</italic><sup><italic>B</italic></sup>) and model the input as a <italic>structural graph G</italic><sub><italic>S </italic></sub>= (<italic>V, L</italic>). The set <italic>V </italic>denotes the vertices of the graph, in this case the bases of the sequences, and we write <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-8-271-i4" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG2bGDdaqhaaWcbaGaemyAaKgabaGaemyqaeeaaaaa@30B4@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-8-271-i5" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>B</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG2bGDdaqhaaWcbaGaemyAaKgabaGaemOqaieaaaaa@30B6@</mml:annotation></mml:semantics></mml:math></inline-formula> for the <italic>i</italic>th base in sequence <italic>A </italic>and <italic>B</italic>, respectively. The set <italic>L </italic>contains undirected <italic>alignment edges </italic>between vertices of sequences <italic>A </italic>and <italic>B</italic>, for sake of better distinction called <italic>lines</italic>. A line <italic>l </italic>∈ <italic>L </italic>with <italic>l </italic>= (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-8-271-i6" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>l</mml:mi><mml:mi>B</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG2bGDdaqhaaWcbaGaem4AaSgabaGaemyqaeeaaOGaeiilaWIaemODay3aa0baaSqaaiabdYgaSbqaaiabdkeacbaaaaa@35B2@</mml:annotation></mml:semantics></mml:math></inline-formula>) represents the alignment of the <italic>k</italic>-th character in sequence <italic>A </italic>with the <italic>l</italic>-th character in sequence <italic>B</italic>. By <italic>s</italic>(<italic>l</italic>) and <italic>t</italic>(<italic>l</italic>) we refer to the adjacent vertices of line <italic>l </italic>in sequence <italic>A </italic>and <italic>B</italic>, respectively. A subset <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M11" name="1471-2105-8-271-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi>ℒ</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFsectaaa@376D@</mml:annotation></mml:semantics></mml:math></inline-formula> ⊂ <italic>L </italic>represents a <italic>valid sequence alignment </italic>of sequence <italic>A </italic>and <italic>B</italic>, if there are no two lines <italic>k</italic>, <italic>l </italic>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M12" name="1471-2105-8-271-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi>ℒ</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFsectaaa@376D@</mml:annotation></mml:semantics></mml:math></inline-formula> such that <italic>k </italic>and <italic>l </italic>cross or touch each other [<xref ref-type="bibr" rid="B40">40</xref>]. Crossing or touching lines induce ordering conflicts in the alignment (see Fig. <xref ref-type="fig" rid="F5">5</xref> for an illustration). We denote with the set <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M13" name="1471-2105-8-271-i8" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFce=qdaWgaaWcbaGaemitaWeabeaaaaa@3971@</mml:annotation></mml:semantics></mml:math></inline-formula> the collection of all maximal sets of mutually conflicting lines.</p>
        <fig position="float" id="F5">
          <label>Figure 5</label>
          <caption>
            <p><bold>Crossing lines</bold>. Sequences <italic>s</italic><sup><italic>A </italic></sup>= <italic>AG </italic>and <italic>s</italic><sup><italic>B </italic></sup>= <italic>AU </italic>are given. The solid line between <italic>G </italic>and <italic>A </italic>represent the alignment of these two nucleotides. If we added the gray dashed line, this would induce an ordering conflict.</p>
          </caption>
          <graphic xlink:href="1471-2105-8-271-5"/>
        </fig>
        <p>We extend the original graph <italic>G</italic><sub><italic>S </italic></sub>= (<italic>V</italic>, <italic>L</italic>) by the edge set <italic>I </italic>to model the annotation of the input sequences in our graph. Consequently, we have <italic>interaction edges </italic>between vertices of the same sequence, i.e., an edge (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M14" name="1471-2105-8-271-i9" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>i</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>j</mml:mi><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG2bGDdaqhaaWcbaGaemyAaKgabaGaemyqaeeaaOGaeiilaWIaemODay3aa0baaSqaaiabdQgaQbqaaiabdgeabbaaaaa@35A8@</mml:annotation></mml:semantics></mml:math></inline-formula>) representing the interaction between nucleotides <italic>i </italic>and <italic>j </italic>in sequence <italic>A</italic>. Figure <xref ref-type="fig" rid="F6">6</xref> illustrates these definitions by means of an example. Note that at this stage gaps are not modelled in our formulation. Hence, we have to extend our model to incorporate gap penalties in our model.</p>
        <fig position="float" id="F6">
          <label>Figure 6</label>
          <caption>
            <p><bold>Initial graph model</bold>. (a) Initial graph model representing two annotated sequences <italic>s</italic><sup><italic>A </italic></sup>= GCAGCAU and <italic>s</italic><sup><italic>B </italic></sup>= AGAUUCC. Solid lines represent lines, dashed lines represent interaction edges. Please note that in this toy example minimum loop lengths constraints on the interaction edges are violated for sake of compactness of the illustration. Interactions (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M15" name="1471-2105-8-271-i10" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mi>B</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>B</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG2bGDdaqhaaWcbaGaeGymaedabaGaemOqaieaaOGaeiilaWIaemODay3aa0baaSqaaiabd6gaUjabgkHiTiabigdaXaqaaiabdkeacbaaaaa@3726@</mml:annotation></mml:semantics></mml:math></inline-formula>) and (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M16" name="1471-2105-8-271-i11" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mi>B</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG2bGDdaqhaaWcbaGaeGymaedabaGaemOqaieaaOGaeiilaWIaemODay3aa0baaSqaaiabd6gaUbqaaiabdkeacbaaaaa@3549@</mml:annotation></mml:semantics></mml:math></inline-formula>) are in conflict with each other, (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M17" name="1471-2105-8-271-i12" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mi>B</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>B</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG2bGDdaqhaaWcbaGaeGimaadabaGaemOqaieaaOGaeiilaWIaemODay3aa0baaSqaaiabd6gaUjabgkHiTiabikdaYaqaaiabdkeacbaaaaa@3726@</mml:annotation></mml:semantics></mml:math></inline-formula>) and (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M18" name="1471-2105-8-271-i11" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mn>1</mml:mn><mml:mi>B</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG2bGDdaqhaaWcbaGaeGymaedabaGaemOqaieaaOGaeiilaWIaemODay3aa0baaSqaaiabd6gaUbqaaiabdkeacbaaaaa@3549@</mml:annotation></mml:semantics></mml:math></inline-formula>) form a pseudoknot. Sequence <italic>s</italic><sup><italic>A </italic></sup>contains only nested interactions. (b) A subset of all possible lines is shown representing the alignment (c).</p>
          </caption>
          <graphic xlink:href="1471-2105-8-271-6"/>
        </fig>
      </sec>
      <sec>
        <title>Gap edges</title>
        <p>The initial model containing only lines (the set <italic>L</italic>) and interaction edges (the set <italic>I</italic>) is augmented by a set of <italic>gap edges G</italic>, which represents gaps in the alignment. For sake of compactness, we just describe the gap edges of sequence <italic>A</italic>, the gap edges of sequence <italic>B </italic>are defined analogously: We have an edge <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M19" name="1471-2105-8-271-i13" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGLbqzdaqhaaWcbaGaem4AaSMaemiBaWgabaGaemyqaeeaaaaa@31F7@</mml:annotation></mml:semantics></mml:math></inline-formula> from <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M20" name="1471-2105-8-271-i14" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG2bGDdaqhaaWcbaGaem4AaSgabaGaemyqaeeaaaaa@30B8@</mml:annotation></mml:semantics></mml:math></inline-formula> to <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M21" name="1471-2105-8-271-i15" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>l</mml:mi><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG2bGDdaqhaaWcbaGaemiBaWgabaGaemyqaeeaaaaa@30BA@</mml:annotation></mml:semantics></mml:math></inline-formula> with <italic>k</italic>, <italic>l </italic>∈ 1, ..., |<italic>s</italic><sup><italic>A</italic></sup>| representing the fact that no character of the substring <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M22" name="1471-2105-8-271-i16" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>k</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mn>...</mml:mn><mml:msubsup><mml:mi>s</mml:mi><mml:mi>l</mml:mi><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGZbWCdaqhaaWcbaGaem4AaSgabaGaemyqaeeaaOGaeiOla4IaeiOla4IaeiOla4Iaem4Cam3aa0baaSqaaiabdYgaSbqaaiabdgeabbaaaaa@3770@</mml:annotation></mml:semantics></mml:math></inline-formula> is aligned to any character of the sequence <italic>B</italic>, whereas <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M23" name="1471-2105-8-271-i17" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGZbWCdaqhaaWcbaGaem4AaSMaeyOeI0IaeGymaedabaGaemyqaeeaaaaa@328F@</mml:annotation></mml:semantics></mml:math></inline-formula> (if <italic>k </italic>- 1 &gt; 0) and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M24" name="1471-2105-8-271-i18" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGZbWCdaqhaaWcbaGaemiBaWMaey4kaSIaeGymaedabaGaemyqaeeaaaaa@3286@</mml:annotation></mml:semantics></mml:math></inline-formula> (if <italic>l </italic>+ 1 ≤ |<italic>s</italic><sup><italic>B</italic></sup>|) are aligned with some characters in sequence <italic>B</italic>. We say that <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M25" name="1471-2105-8-271-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>l</mml:mi><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG2bGDdaqhaaWcbaGaem4AaSgabaGaemyqaeeaaOGaeiilaWIaeiOla4IaeiOla4IaeiOla4IaeiilaWIaemODay3aa0baaSqaaiabdYgaSbqaaiabdgeabbaaaaa@393C@</mml:annotation></mml:semantics></mml:math></inline-formula> are <italic>spanned </italic>by the gap edge <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M26" name="1471-2105-8-271-i13" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGLbqzdaqhaaWcbaGaem4AaSMaemiBaWgabaGaemyqaeeaaaaa@31F7@</mml:annotation></mml:semantics></mml:math></inline-formula>. Figure <xref ref-type="fig" rid="F7">7</xref> shows the graph extended by gap edges.</p>
        <fig position="float" id="F7">
          <label>Figure 7</label>
          <caption>
            <p><bold>Graph model augmented gap edges</bold>. (a) Initial model additionally augmented with gap edges. The figure shows possible alignments edges and all gap edges starting from <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M27" name="1471-2105-8-271-i20" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mn>0</mml:mn><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG2bGDdaqhaaWcbaGaeGimaadabaGaemyqaeeaaaaa@3047@</mml:annotation></mml:semantics></mml:math></inline-formula> (for sake of clarity, all other gap edges and interaction edges are not displayed). Note, however, that every node has outgoing gap edges to all other nodes in the sequence. The subset of lines and gap edges (b) corresponds to the alignment (c).</p>
          </caption>
          <graphic xlink:href="1471-2105-8-271-7"/>
        </fig>
        <p>Two gap edges <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M28" name="1471-2105-8-271-i13" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGLbqzdaqhaaWcbaGaem4AaSMaemiBaWgabaGaemyqaeeaaaaa@31F7@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M29" name="1471-2105-8-271-i21" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGLbqzdaqhaaWcbaGaemyBa0MaemOBa4gabaGaemyqaeeaaaaa@31FF@</mml:annotation></mml:semantics></mml:math></inline-formula> ∈ <italic>G </italic>are <italic>in conflict </italic>with each other if {<italic>k</italic>, ..., <italic>l </italic>+ 1} ∩ {<italic>m</italic>, ..., <italic>n</italic>} ≠ ∅, that is, if they overlap or touch. This is intuitively clear, because we do not want to split a longer gap into two separate gaps: Consequently, there has to be at least one aligned character between any two realized gap edges. See Fig. <xref ref-type="fig" rid="F8">8</xref> for an example. We denote with the set <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M30" name="1471-2105-8-271-i22" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFce=qdaWgaaWcbaGaem4raCeabeaaaaa@3967@</mml:annotation></mml:semantics></mml:math></inline-formula> the collection of all maximal sets of mutually conflicting gap edges. Finally, we define <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M31" name="1471-2105-8-271-i23" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi>G</mml:mi><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>↔</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>l</mml:mi><mml:mi>A</mml:mi></mml:msubsup></mml:mrow></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGhbWrdaWgaaWcbaGaemODay3aa0baaWqaaiabdUgaRbqaaiabdgeabbaaliabgsziRkabdAha2naaDaaameaacqWGSbaBaeaacqWGbbqqaaaaleqaaaaa@380D@</mml:annotation></mml:semantics></mml:math></inline-formula> as the set of gap edges that span the nodes <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M32" name="1471-2105-8-271-i19" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>l</mml:mi><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG2bGDdaqhaaWcbaGaem4AaSgabaGaemyqaeeaaOGaeiilaWIaeiOla4IaeiOla4IaeiOla4IaeiilaWIaemODay3aa0baaSqaaiabdYgaSbqaaiabdgeabbaaaaa@393C@</mml:annotation></mml:semantics></mml:math></inline-formula>.</p>
        <fig position="float" id="F8">
          <label>Figure 8</label>
          <caption>
            <p><bold>Crossing gaps</bold>. Gaps have to be realized by exactly one gap edge (in this example represented by the solid gray line), and cannot be split into two separate smaller gaps (the two dotted gap edges in this example).</p>
          </caption>
          <graphic xlink:href="1471-2105-8-271-8"/>
        </fig>
      </sec>
      <sec>
        <title>Interaction match</title>
        <p>We call two interactions <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M33" name="1471-2105-8-271-i24" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>k</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>l</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mi>A</mml:mi></mml:msup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqGGOaakcqWGZbWCdaqhaaWcbaGaem4AaSgabaGaemyqaeeaaOGaeiilaWIaem4Cam3aa0baaSqaaiabdYgaSbqaaiabdgeabbaakiabcMcaPiabgIGiolabdchaWnaaCaaaleqabaGaemyqaeeaaaaa@3B85@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M34" name="1471-2105-8-271-i25" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>m</mml:mi><mml:mi>B</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:msup><mml:mi>p</mml:mi><mml:mi>B</mml:mi></mml:msup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqGGOaakcqWGZbWCdaqhaaWcbaGaemyBa0gabaGaemOqaieaaOGaeiilaWIaem4Cam3aa0baaSqaaiabd6gaUbqaaiabdkeacbaakiabcMcaPiabgIGiolabdchaWnaaCaaaleqabaGaemOqaieaaaaa@3B93@</mml:annotation></mml:semantics></mml:math></inline-formula> an <italic>interaction match </italic>if there exist two alignment edges <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M35" name="1471-2105-8-271-i26" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>m</mml:mi><mml:mi>B</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGHbqycqGH9aqpcqGGOaakcqWG2bGDdaqhaaWcbaGaem4AaSgabaGaemyqaeeaaOGaeiilaWIaemODay3aa0baaSqaaiabd2gaTbqaaiabdkeacbaakiabcMcaPaaa@39C1@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M36" name="1471-2105-8-271-i27" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>l</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>v</mml:mi><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGIbGycqGH9aqpcqGGOaakcqWG2bGDdaqhaaWcbaGaemiBaWgabaGaemyqaeeaaOGaeiilaWIaemODay3aa0baaSqaaiabd6gaUbqaaiabdkeacbaakiabcMcaPaaa@39C7@</mml:annotation></mml:semantics></mml:math></inline-formula> that do not cross each other. We say that a subset <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M37" name="1471-2105-8-271-i28" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">S</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFse=uaaa@3844@</mml:annotation></mml:semantics></mml:math></inline-formula> ⊆ <italic>L realizes </italic>the interaction match if {<italic>a</italic>, <italic>b</italic>} ⊆ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M38" name="1471-2105-8-271-i28" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">S</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFse=uaaa@3844@</mml:annotation></mml:semantics></mml:math></inline-formula>. Interaction matches realized by a set <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M39" name="1471-2105-8-271-i28" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">S</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFse=uaaa@3844@</mml:annotation></mml:semantics></mml:math></inline-formula> represent common interactions that are preserved by aligning the begin and end nucleotides of the interaction. Figure <xref ref-type="fig" rid="F9">9</xref> illustrates the definitions.</p>
        <fig position="float" id="F9">
          <label>Figure 9</label>
          <caption>
            <p><bold>Interaction match</bold>. The pairs (<italic>k</italic>, <italic>m</italic>) and (<italic>k</italic>, <italic>o</italic>) are valid interaction matches. The pair (<italic>l</italic>, <italic>n</italic>), however, is not a valid interaction match since <italic>l </italic>and <italic>n </italic>cross each other.</p>
          </caption>
          <graphic xlink:href="1471-2105-8-271-9"/>
        </fig>
      </sec>
      <sec>
        <title>Gapped structural trace</title>
        <p>A triple (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M40" name="1471-2105-8-271-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi>ℒ</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFsectaaa@376D@</mml:annotation></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M41" name="1471-2105-8-271-i29" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi>ℐ</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFqessaaa@3768@</mml:annotation></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M42" name="1471-2105-8-271-i30" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">G</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFge=raaa@382C@</mml:annotation></mml:semantics></mml:math></inline-formula>) with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M43" name="1471-2105-8-271-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi>ℒ</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFsectaaa@376D@</mml:annotation></mml:semantics></mml:math></inline-formula> ⊆ <italic>L</italic>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M44" name="1471-2105-8-271-i29" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi>ℐ</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFqessaaa@3768@</mml:annotation></mml:semantics></mml:math></inline-formula> ⊆ <italic>I</italic>, and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M45" name="1471-2105-8-271-i30" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">G</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFge=raaa@382C@</mml:annotation></mml:semantics></mml:math></inline-formula> ⊆ <italic>G </italic>is called a valid <italic>gapped structural trace </italic>if and only if the following constraints are satisfied:</p>
        <p>1. The vertices <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M46" name="1471-2105-8-271-i15" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>l</mml:mi><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG2bGDdaqhaaWcbaGaemiBaWgabaGaemyqaeeaaaaa@30BA@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M47" name="1471-2105-8-271-i31" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>v</mml:mi><mml:mi>k</mml:mi><mml:mi>B</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG2bGDdaqhaaWcbaGaem4AaSgabaGaemOqaieaaaaa@30BA@</mml:annotation></mml:semantics></mml:math></inline-formula> of sequences <italic>A </italic>and <italic>B </italic>are either incident to exactly one alignment edge <italic>e </italic>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M48" name="1471-2105-8-271-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi>ℒ</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFsectaaa@376D@</mml:annotation></mml:semantics></mml:math></inline-formula> or spanned by a gap edge <italic>g </italic>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M49" name="1471-2105-8-271-i30" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">G</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFge=raaa@382C@</mml:annotation></mml:semantics></mml:math></inline-formula>. In other words, a nucleotide is either aligned or "aligned" to a gap.</p>
        <p>2. A line <italic>l </italic>can realize at most one interaction match (<italic>l</italic>, <italic>m</italic>), because a nucleotide can pair with at most one other nucleotide in a valid RNA secondary structure.</p>
        <p>3. There are no two lines <italic>k</italic>, <italic>l </italic>∈ <italic>L </italic>that cross or touch each other: Crossing lines induce ordering conflicts in the alignment, whereas touching lines imply that two different nucleotides are mapped to the same nucleotide in the other sequence.</p>
        <p>4. There are no two gaps edges <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M50" name="1471-2105-8-271-i32" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGLbqzdaqhaaWcbaGaem4AaSMaemiBaWgabaGaemyqaeeaaOGaeiilaWIaemyzau2aa0baaSqaaiabd2gaTjabd6gaUbqaaiabdgeabbaakiabgIGioprtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaGabaiab=zq8hbaa@4542@</mml:annotation></mml:semantics></mml:math></inline-formula> such that <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M51" name="1471-2105-8-271-i13" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGLbqzdaqhaaWcbaGaem4AaSMaemiBaWgabaGaemyqaeeaaaaa@31F7@</mml:annotation></mml:semantics></mml:math></inline-formula> is in conflict with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M52" name="1471-2105-8-271-i21" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGLbqzdaqhaaWcbaGaemyBa0MaemOBa4gabaGaemyqaeeaaaaa@31FF@</mml:annotation></mml:semantics></mml:math></inline-formula>, and there are no two gaps edges <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M53" name="1471-2105-8-271-i33" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup><mml:mo>∈</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGLbqzdaqhaaWcbaGaem4AaSMaemiBaWgabaGaemOqaieaaOGaeiilaWIaemyzau2aa0baaSqaaiabd2gaTjabd6gaUbqaaiabdkeacbaakiabgIGioprtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaGabaiab=zq8hbaa@4546@</mml:annotation></mml:semantics></mml:math></inline-formula> such that <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M54" name="1471-2105-8-271-i34" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGLbqzdaqhaaWcbaGaem4AaSMaemiBaWgabaGaemOqaieaaaaa@31F9@</mml:annotation></mml:semantics></mml:math></inline-formula> is in conflict with <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M55" name="1471-2105-8-271-i35" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>e</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mi>B</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGLbqzdaqhaaWcbaGaemyBa0MaemOBa4gabaGaemOqaieaaaaa@3201@</mml:annotation></mml:semantics></mml:math></inline-formula>.</p>
        <p>Figure <xref ref-type="fig" rid="F10">10</xref> visualizes these properties by showing a toy example for a gapped structural trace.</p>
        <fig position="float" id="F10">
          <label>Figure 10</label>
          <caption>
            <p><bold>Valid gapped structural trace</bold>. Valid gapped structural trace: every vertex is incident to exactly one line or is spanned by a gap edge. There are no crossing lines, and every line is incident to at most one interaction match.</p>
          </caption>
          <graphic xlink:href="1471-2105-8-271-10"/>
        </fig>
        <p>We assign weights <italic>w</italic><sub><italic>l </italic></sub>and <italic>w</italic><sub><italic>kl </italic></sub>for each line <italic>l </italic>and interaction match (<italic>k</italic>, <italic>l</italic>) that represents the benefit of realizing <italic>l </italic>or (<italic>k</italic>, <italic>l</italic>). By default, we set these scores along the lines of standard scoring methods, e.g., BLOSUM matrices for the weight of the lines, <italic>base pair probabilities </italic>[<xref ref-type="bibr" rid="B18">18</xref>] for the interaction match scores, or by using the RIBOSUM scoring matrices derived from alignments of ribosomal RNAs [<xref ref-type="bibr" rid="B47">47</xref>]. Our model, however, is not limited to standard scoring schemes. Since we can set each (sequence or structure) weight separately, the user can assign completely arbitrary scores to each line or interaction match which makes the incorporation of expert knowledge into the computation of structural alignments easy. Furthermore, we assign negative weights to gap edges <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M56" name="1471-2105-8-271-i36" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mi>l</mml:mi></mml:mrow><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGHbqydaqhaaWcbaGaem4AaSMaemiBaWgabaGaemyqaeeaaaaa@31EF@</mml:annotation></mml:semantics></mml:math></inline-formula> with representing the gap penalty for aligning substring <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M57" name="1471-2105-8-271-i37" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msubsup><mml:mi>s</mml:mi><mml:mi>k</mml:mi><mml:mi>A</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mn>...</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mi>l</mml:mi><mml:mi>A</mml:mi></mml:msubsup></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGZbWCdaqhaaWcbaGaem4AaSgabaGaemyqaeeaaOGaeiilaWIaeiOla4IaeiOla4IaeiOla4IaeiilaWIaem4Cam3aa0baaSqaaiabdYgaSbqaaiabdgeabbaaaaa@3930@</mml:annotation></mml:semantics></mml:math></inline-formula> with gap characters. Note that the model allows for arbitrary, position-dependent gap scoring.</p>
        <p>Approaches for traditional sequence alignment aim at maximizing the score of edges in an alignment <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M58" name="1471-2105-8-271-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi>ℒ</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFsectaaa@376D@</mml:annotation></mml:semantics></mml:math></inline-formula>. Structural alignments, however, must also take the structural information encoded in the interaction edges into account. The problem of structurally aligning two annotated sequences (<italic>s</italic><sup><italic>A</italic></sup>, <italic>p</italic><sup><italic>A</italic></sup>) and (<italic>s</italic><sup><italic>B</italic></sup>, <italic>p</italic><sup><italic>B</italic></sup>) corresponds to finding an alignment such that the weight of the sequence part (i.e., the weight of selected lines plus gap penalties) plus the weight of the realized interaction matches is maximal. More formally, we seek to maximize <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M59" name="1471-2105-8-271-i38" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>l</mml:mi><mml:mo>∈</mml:mo><mml:mi>ℒ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>g</mml:mi><mml:mo>∈</mml:mo><mml:mi mathvariant="script">G</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∈</mml:mo><mml:mi>ℐ</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaaeqaqaaiabdEha3naaBaaaleaacqWGSbaBaeqaaaqaaiabdYgaSjabgIGioprtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaGabaiab=jrimbqab0GaeyyeIuoakiabgUcaRmaaqababaGaem4DaC3aaSbaaSqaaiabdEgaNbqabaaabaGaem4zaCMaeyicI4Sae8NbXFeabeqdcqGHris5aOGaey4kaSYaaabeaeaacqWG3bWDdaWgaaWcbaGaemyAaKMaemOAaOgabeaaaeaacqGGOaakcqWGPbqAcqGGSaalcqWGQbGAcqGGPaqkcqGHiiIZcqWFqessaeqaniabggHiLdaaaa@5876@</mml:annotation></mml:semantics></mml:math></inline-formula>, where (<inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M60" name="1471-2105-8-271-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi>ℒ</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFsectaaa@376D@</mml:annotation></mml:semantics></mml:math></inline-formula>, <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M61" name="1471-2105-8-271-i30" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">G</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFge=raaa@382C@</mml:annotation></mml:semantics></mml:math></inline-formula>) represents an alignment with arbitrary gap costs, and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M62" name="1471-2105-8-271-i29" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi>ℐ</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFqessaaa@3768@</mml:annotation></mml:semantics></mml:math></inline-formula> contains the interaction matches realized by <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M63" name="1471-2105-8-271-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi>ℒ</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFsectaaa@376D@</mml:annotation></mml:semantics></mml:math></inline-formula>. Observe that this graph-theoretical reformulation matches the problem statement given at the beginning of this section.</p>
      </sec>
      <sec>
        <title>Biological aspects</title>
        <p>The basic entities of our model are the alignment, interaction, and gap edges in the structural graph, which contribute to the objective function rather independently. Hence, one could argue that the model does not capture important features of RNA structures, like the incorporation of stacking energies or loop scores that depend on the actual size of the loop. We are aware of these limitations.</p>
        <p>Nevertheless, the results of our computational experiments presented in Sect. 3 show that this approach yields high-quality structural alignments. In the pairwise case, our graph-based model is competitive with state-of-the-art approaches and develops its strength with an increasing number of sequences, outperforming all other programs that we tested (for details see Sect. 3). Additionally, the authors of [<xref ref-type="bibr" rid="B48">48</xref>] showed that models that do not capture stacking energies and loops are still competitive.</p>
        <p>Beyond, our graph-based approach offers the possibility to change the model from nucleotides as the working entities to stems: Instead of taking single nucleotides as the vertices of the structural graph, we could search for <italic>candidate stems </italic>in the sequences and introduce a vertex for each half-stem. This would allow us to incorporate energy-based scoring into our model, which then, however, will have to be adapted to take into account overlapping stem candidates.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Integer linear program and Lagrangian relaxation</title>
      <p>Given the graph-theoretical model it is straightforward to transform it to an <italic>integer linear program </italic>(ILP). We associate binary variables with each line, interaction match, and gap edge, and model the constraints of a valid gapped structural trace by adding inequalities to the linear program.</p>
      <p>The handling of lines and gap edges is straightforward: We associate a <italic>x </italic>and <italic>z </italic>variable to each line and gap edge, respectively. We set <italic>x</italic><sub><italic>l </italic></sub>= 1 if and only if line <italic>l </italic>∈ <italic>L </italic>is part of the alignment <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M64" name="1471-2105-8-271-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi>ℒ</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFsectaaa@376D@</mml:annotation></mml:semantics></mml:math></inline-formula>, and <italic>z</italic><sub><italic>a </italic></sub>= 1 if and only if gap edge <italic>a </italic>∈ <italic>G </italic>is part of the alignment.</p>
      <p>Interaction matches, however, are treated slightly differently: Instead of assigning an ILP variable to each interaction edge, we split an interaction match (<italic>l</italic>, <italic>m</italic>) into two separate <italic>directed interaction matches </italic>(<italic>l</italic>, <italic>m</italic>) and (<italic>m, l</italic>) that are detached from each other. A directed interaction match (<italic>l</italic>, <italic>m</italic>) is <italic>realized </italic>by the line set <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M65" name="1471-2105-8-271-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi>ℒ</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFsectaaa@376D@</mml:annotation></mml:semantics></mml:math></inline-formula> if <italic>l </italic>∈ <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M66" name="1471-2105-8-271-i7" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi>ℒ</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFsectaaa@376D@</mml:annotation></mml:semantics></mml:math></inline-formula>. We then have <italic>y</italic><sub><italic>lm </italic></sub>= 1 if and only if the directed interaction match (<italic>l</italic>, <italic>m</italic>) is realized (note again that <italic>y</italic><sub><italic>lm </italic></sub>and <italic>y</italic><sub><italic>ml </italic></sub>are distinct variables). Figure <xref ref-type="fig" rid="F11">11</xref> gives an illustration of the variable splitting. Note that this does not change the underlying model, it just makes the ILP formulation more convenient for further processing. Splitting interaction matches has first been proposed by Caprara and Lancia in the context of contact map overlap [<xref ref-type="bibr" rid="B42">42</xref>].</p>
      <fig position="float" id="F11">
        <label>Figure 11</label>
        <caption>
          <p><bold>Splitting of interaction matches</bold>. One interaction match is split into two <italic>directed </italic>interaction matches.</p>
        </caption>
        <graphic xlink:href="1471-2105-8-271-11"/>
      </fig>
      <p>As described in Sect. 2.1, the sets <italic>L</italic>, <italic>I</italic>, and <italic>G </italic>refer to lines, interaction edges, and gap edges, and the sets <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M67" name="1471-2105-8-271-i8" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>L</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFce=qdaWgaaWcbaGaemitaWeabeaaaaa@3971@</mml:annotation></mml:semantics></mml:math></inline-formula> and <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M68" name="1471-2105-8-271-i22" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:msub><mml:mi mathvariant="script">C</mml:mi><mml:mi>G</mml:mi></mml:msub></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFce=qdaWgaaWcbaGaem4raCeabeaaaaa@3967@</mml:annotation></mml:semantics></mml:math></inline-formula> contain subsets of mutually conflicting lines or gap edges.</p>
      <p>We then give the following ILP formulation for the gapped structural trace problem:</p>
      <p>
        <disp-formula id="bmcM1">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M69" name="1471-2105-8-271-i39" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mi>max</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>l</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:mi>L</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mrow>
                    <mml:msub>
                      <mml:mi>w</mml:mi>
                      <mml:mi>l</mml:mi>
                    </mml:msub>
                    <mml:msub>
                      <mml:mi>x</mml:mi>
                      <mml:mi>l</mml:mi>
                    </mml:msub>
                  </mml:mrow>
                </mml:mstyle>
                <mml:mo>+</mml:mo>
                <mml:mstyle displaystyle="true">
                  <mml:munder>
                    <mml:mo>∑</mml:mo>
                    <mml:mrow>
                      <mml:mi>l</mml:mi>
                      <mml:mo>∈</mml:mo>
                      <mml:mi>L</mml:mi>
                    </mml:mrow>
                  </mml:munder>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:munder>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mo>∈</mml:mo>
                          <mml:mi>L</mml:mi>
                        </mml:mrow>
                      </mml:munder>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>w</mml:mi>
                          <mml:mrow>
                            <mml:mi>l</mml:mi>
                            <mml:mi>m</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:msub>
                          <mml:mi>y</mml:mi>
                          <mml:mrow>
                            <mml:mi>l</mml:mi>
                            <mml:mi>m</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo>+</mml:mo>
                        <mml:mstyle displaystyle="true">
                          <mml:munder>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>g</mml:mi>
                              <mml:mo>∈</mml:mo>
                              <mml:mi>G</mml:mi>
                            </mml:mrow>
                          </mml:munder>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>w</mml:mi>
                              <mml:mi>g</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mstyle>
                        <mml:msub>
                          <mml:mi>z</mml:mi>
                          <mml:mi>g</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                </mml:mstyle>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacyGGTbqBcqGGHbqycqGG4baEdaaeqbqaaiabdEha3naaBaaaleaacqWGSbaBaeqaaOGaemiEaG3aaSbaaSqaaiabdYgaSbqabaaabaGaemiBaWMaeyicI4SaemitaWeabeqdcqGHris5aOGaey4kaSYaaabuaeaadaaeqbqaaiabdEha3naaBaaaleaacqWGSbaBcqWGTbqBaeqaaOGaemyEaK3aaSbaaSqaaiabdYgaSjabd2gaTbqabaGccqGHRaWkdaaeqbqaaiabdEha3naaBaaaleaacqWGNbWzaeqaaaqaaiabdEgaNjabgIGiolabdEeahbqab0GaeyyeIuoakiabdQha6naaBaaaleaacqWGNbWzaeqaaaqaaiabd2gaTjabgIGiolabdYeambqab0GaeyyeIuoaaSqaaiabdYgaSjabgIGiolabdYeambqab0GaeyyeIuoaaaa@600F@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM2">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M70" name="1471-2105-8-271-i40" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mi>s</mml:mi>
                        <mml:mo>.</mml:mo>
                        <mml:mi>t</mml:mi>
                        <mml:mo>.</mml:mo>
                        <mml:mstyle displaystyle="true">
                          <mml:munder>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>l</mml:mi>
                              <mml:mo>∈</mml:mo>
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mi>L</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                          </mml:munder>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>x</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:msub>
                            <mml:mo>≤</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo>∀</mml:mo>
                        <mml:msub>
                          <mml:mi>C</mml:mi>
                          <mml:mi>L</mml:mi>
                        </mml:msub>
                        <mml:mo>∈</mml:mo>
                        <mml:msub>
                          <mml:mi mathvariant="script">C</mml:mi>
                          <mml:mi>L</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaafaqaaeqacaaabaacbaGae83Cam3exLMBbXgBcf2CPn2qVrwzqf2zLnharyavP1wzZbItLDhis9wBH5gaiqaacaGFUaGae8hDaqNaa4NlamaaqafabaGaemiEaG3aaSbaaSqaaiabdYgaSbqabaGccqGHKjYOcqaIXaqmaSqaaiabdYgaSjabgIGiolabdoeadnaaBaaameaacqWGmbataeqaaaWcbeqdcqGHris5aaGcbaGaeyiaIiIaem4qam0aaSbaaSqaaiabdYeambqabaGccqGHiiIZt0uy0HwzTfgDPnwy1egarCqtHrhAL1wy0L2yHvdaiuaacqqFce=qdaWgaaWcbaGaemitaWeabeaaaaaaaa@5CD6@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM3">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M71" name="1471-2105-8-271-i41" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:munder>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>a</mml:mi>
                              <mml:mo>∈</mml:mo>
                              <mml:msub>
                                <mml:mi>C</mml:mi>
                                <mml:mi>G</mml:mi>
                              </mml:msub>
                            </mml:mrow>
                          </mml:munder>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>z</mml:mi>
                              <mml:mi>a</mml:mi>
                            </mml:msub>
                            <mml:mo>≤</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo>∀</mml:mo>
                        <mml:msub>
                          <mml:mi>C</mml:mi>
                          <mml:mi>G</mml:mi>
                        </mml:msub>
                        <mml:mo>∈</mml:mo>
                        <mml:msub>
                          <mml:mi mathvariant="script">C</mml:mi>
                          <mml:mi>G</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaafaqaaeqacaaabaWaaabuaeaacqWG6bGEdaWgaaWcbaGaemyyaegabeaakiabgsMiJkabigdaXaWcbaGaemyyaeMaeyicI4Saem4qam0aaSbaaWqaaiabdEeahbqabaaaleqaniabggHiLdaakeaacqGHaiIicqWGdbWqdaWgaaWcbaGaem4raCeabeaakiabgIGioprtHrhAL1wy0L2yHvtyaeHbnfgDOvwBHrxAJfwnaGabaiab=jq8dnaaBaaaleaacqWGhbWraeqaaaaaaaa@4B20@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM4">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M72" name="1471-2105-8-271-i42" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>x</mml:mi>
                  <mml:mi>l</mml:mi>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:munder>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>a</mml:mi>
                              <mml:mo>∈</mml:mo>
                              <mml:msub>
                                <mml:mi>G</mml:mi>
                                <mml:mrow>
                                  <mml:mi>s</mml:mi>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mi>l</mml:mi>
                                  <mml:mo stretchy="false">)</mml:mo>
                                  <mml:mo>↔</mml:mo>
                                  <mml:mi>s</mml:mi>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mi>l</mml:mi>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:munder>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>z</mml:mi>
                              <mml:mi>a</mml:mi>
                            </mml:msub>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo>∀</mml:mo>
                        <mml:mi>l</mml:mi>
                        <mml:mo>∈</mml:mo>
                        <mml:mi>L</mml:mi>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG4baEdaWgaaWcbaGaemiBaWgabeaakiabgUcaRuaabaqabiaaaeaadaaeqbqaaiabdQha6naaBaaaleaacqWGHbqyaeqaaOGaeyypa0JaeGymaedaleaacqWGHbqycqGHiiIZcqWGhbWrdaWgaaadbaGaem4CamNaeiikaGIaemiBaWMaeiykaKIaeyiLHSQaem4CamNaeiikaGIaemiBaWMaeiykaKcabeaaaSqab0GaeyyeIuoaaOqaaiabgcGiIiabdYgaSjabgIGiolabdYeambaaaaa@4BAF@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM5">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M73" name="1471-2105-8-271-i43" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>x</mml:mi>
                  <mml:mi>l</mml:mi>
                </mml:msub>
                <mml:mo>+</mml:mo>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:munder>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>a</mml:mi>
                              <mml:mo>∈</mml:mo>
                              <mml:msub>
                                <mml:mi>G</mml:mi>
                                <mml:mrow>
                                  <mml:mi>t</mml:mi>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mi>l</mml:mi>
                                  <mml:mo stretchy="false">)</mml:mo>
                                  <mml:mo>↔</mml:mo>
                                  <mml:mi>t</mml:mi>
                                  <mml:mo stretchy="false">(</mml:mo>
                                  <mml:mi>l</mml:mi>
                                  <mml:mo stretchy="false">)</mml:mo>
                                </mml:mrow>
                              </mml:msub>
                            </mml:mrow>
                          </mml:munder>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>z</mml:mi>
                              <mml:mi>a</mml:mi>
                            </mml:msub>
                            <mml:mo>=</mml:mo>
                            <mml:mn>1</mml:mn>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo>∀</mml:mo>
                        <mml:mi>l</mml:mi>
                        <mml:mo>∈</mml:mo>
                        <mml:mi>L</mml:mi>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWG4baEdaWgaaWcbaGaemiBaWgabeaakiabgUcaRuaabaqabiaaaeaadaaeqbqaaiabdQha6naaBaaaleaacqWGHbqyaeqaaOGaeyypa0JaeGymaedaleaacqWGHbqycqGHiiIZcqWGhbWrdaWgaaadbaGaemiDaqNaeiikaGIaemiBaWMaeiykaKIaeyiLHSQaemiDaqNaeiikaGIaemiBaWMaeiykaKcabeaaaSqab0GaeyyeIuoaaOqaaiabgcGiIiabdYgaSjabgIGiolabdYeambaaaaa@4BB3@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM6">
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M74" name="1471-2105-8-271-i44" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:mtable columnalign="left">
                  <mml:mtr columnalign="left">
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mstyle displaystyle="true">
                          <mml:munder>
                            <mml:mo>∑</mml:mo>
                            <mml:mrow>
                              <mml:mi>m</mml:mi>
                              <mml:mo>∈</mml:mo>
                              <mml:mi>L</mml:mi>
                            </mml:mrow>
                          </mml:munder>
                          <mml:mrow>
                            <mml:msub>
                              <mml:mi>y</mml:mi>
                              <mml:mrow>
                                <mml:mi>l</mml:mi>
                                <mml:mi>m</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                            <mml:mo>≤</mml:mo>
                            <mml:msub>
                              <mml:mi>x</mml:mi>
                              <mml:mi>l</mml:mi>
                            </mml:msub>
                          </mml:mrow>
                        </mml:mstyle>
                      </mml:mrow>
                    </mml:mtd>
                    <mml:mtd columnalign="left">
                      <mml:mrow>
                        <mml:mo>∀</mml:mo>
                        <mml:mi>l</mml:mi>
                        <mml:mo>∈</mml:mo>
                        <mml:mi>L</mml:mi>
                      </mml:mrow>
                    </mml:mtd>
                  </mml:mtr>
                </mml:mtable>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaafaqaaeqacaaabaWaaabuaeaacqWG5bqEdaWgaaWcbaGaemiBaWMaemyBa0gabeaakiabgsMiJkabdIha4naaBaaaleaacqWGSbaBaeqaaaqaaiabd2gaTjabgIGiolabdYeambqab0GaeyyeIuoaaOqaaiabgcGiIiabdYgaSjabgIGiolabdYeambaaaaa@40E8@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM7"><italic>y</italic><sub><italic>lm </italic></sub>= <italic>y</italic><sub><italic>ml </italic></sub>    ∀<italic>l</italic>, <italic>m </italic>∈ <italic>L</italic></disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM8"><italic>x </italic>∈ {0, 1}<sup><italic>L </italic></sup><italic>y </italic>∈ {0, 1}<sup><italic>L</italic>×<italic>L </italic></sup><italic>z </italic>∈ {0, 1}<sup><italic>G</italic></sup></disp-formula>
      </p>
      <sec>
        <title>Lemma 2.1 (Proof in [<xref ref-type="bibr" rid="B16">16</xref>])</title>
        <p><italic>A feasible solution to the ILP </italic>(1)–(8) <italic>corresponds to a valid gapped structural trace of weight equal to the objective function and vice versa</italic>.</p>
        <p>Observe that constraints (2)–(6) exactly correspond to the properties of a gapped structural trace as described in Sect. 2.1.</p>
        <p>In [<xref ref-type="bibr" rid="B49">49</xref>] the authors show that the problem of computing an optimal gapped structural trace is already NP-hard, even without considering gap costs. Hence, we cannot hope to find an optimal solution to the problem in polynomial time.</p>
        <p>Commonly used mathematical programming techniques for NP-hard problems therefore resort to various <italic>relaxation techniques </italic>that are the basis for further processing. A relaxation results from the removal of constraints from the original ILP formulation, and is often solvable in polynomial time. A popular relaxation is the so called <italic>LP relaxation </italic>where the integrality constraints on the variables are dropped, yielding a standard linear program, for which solutions can be found efficiently.</p>
        <p>Another possible relaxation technique is <italic>Lagrangian relaxation</italic>: Instead of just dropping certain inequalities, we move them to the objective function, associated with a penalty term that becomes active if the dropped constraint is violated. By iteratively adapting those penalty terms using, for instance, <italic>subgradient optimization</italic>, we get better solutions with each iteration. A crucial parameter is therefore the number of iterations that we perform: the higher the number, the more likely it is to end up with an optimal or near-optimal solution.</p>
        <p>Inspired by the successful approach of Lancia and Caprara for the contact map overlap problem, we consider the relaxation resulting from moving constraint (7) into the objective function.</p>
      </sec>
      <sec>
        <title>Lemma 2.2 (Proof in [<xref ref-type="bibr" rid="B16">16</xref>])</title>
        <p><italic>The relaxed problem is equivalent to the pairwise sequence alignment problem with arbitrary gap costs</italic>.</p>
      </sec>
    </sec>
    <sec>
      <title>2.3 Algorithms for the pairwise and multiple case</title>
      <p>Our algorithm for the pairwise RNA structural alignment problem consists of iteratively solving the primary sequence alignment problem associated with the relaxation. The penalization of the relaxed inequality is reflected in an adapted scoring matrix for the primary alignment. Intuitively, these weights incorporate also the structural information. In each iteration we get a new lower bound for the problem by analyzing the primary sequence alignments and inferring the best <italic>structural completion </italic>of this alignment. In fact, this corresponds to solving a maximum weighted matching problem in a general graph. For details see [<xref ref-type="bibr" rid="B16">16</xref>]. In the course of the algorithm, these solutions get better and better. Furthermore, the value of the relaxation itself constitutes an upper bound on the problem, which decreases with an increasing number of iterations. When these bounds coincide, we have provably found an optimal solution, otherwise, we get near-optimal solutions with a quality guarantee. Assuming an upper bound on the number of interaction matches per line, which is typically the case with base pair probability matrices of RNA sequences, we get a running time of <italic>O</italic>(<italic>n</italic><sup>2</sup>) for each Lagrangian iteration. Since we fix the number of iterations, this leads to an overall time complexity of <italic>O</italic>(<italic>n</italic><sup>2</sup>).</p>
      <p>For the multiple case, similar in spirit to the MARNA software, we combine our pairwise method with the popular progressive alignment software T-COFFEE [<xref ref-type="bibr" rid="B50">50</xref>]. Progressive methods build multiple alignments from pairwise alignments. The pairwise distances are usually used to compute a guide tree which in turn determines the order in which the sequences are aligned to the evolving multiple alignment.</p>
      <p>Progressive approaches often suffer from their sensitivity to the order in which the sequences are chosen during the alignment process. T-COFFEE reduces this effect by making use of local alignment information from <italic>all </italic>pairwise sequence alignments during its progressive alignment phase. We supply such local alignment information based on all-against-all structural alignments computed with our pairwise approach, assigning a high score to conserved interaction matches. The structural information is subsequently passed on to T-COFFEE that computes a multiple alignment, taking into account the additional structural information.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Experiments</title>
    <p>The basis of our computational experiments is the recently published benchmark set BRALIBASE 2.1 [<xref ref-type="bibr" rid="B51">51</xref>]. We compared our program to four other alignment programs (MARNA, FOLDALIGNM, MAFFT, and STRAL) using two established measures for the quality of structural alignments (Compalign and SCI score). We performed all experiments with default parameters.</p>
    <sec>
      <title>3.1 BRAliBase 2.1</title>
      <p>We chose this data set, which is available from [<xref ref-type="bibr" rid="B52">52</xref>], as our test set, since it covers a greater range of typical noncoding-RNA families than the original BRALIBASE data set [<xref ref-type="bibr" rid="B12">12</xref>]. BRALIBASE 2.1 contains 36 different RNA families, ranging from approximately 26 nucleotides long Histone 3'UTR stem-loop motifs to approximately 300 nucleotides long eukaryotic SRP RNAs. See [<xref ref-type="bibr" rid="B51">51</xref>] for a detailed listing of all instances. BRALIBASE 2.1 reference alignments are based on manually curated seed alignments of the <italic>Rfam 7.0 </italic>database [<xref ref-type="bibr" rid="B53">53</xref>]. Out of the pool of all ncRNA families that have more than 50 sequences in their seed alignment, either 2, 3, 5, 7, 10 or 15 sequences were randomly drawn considering constraints on the sequences (e.g., average pairwise sequence identity or structural conservation). These subsets of the original seed alignments form the instances of BRALIBASE: in the following we stick to the BRALIBASE naming convention and refer to the sets of instances by <italic>k</italic>2, <italic>k</italic>3, <italic>k</italic>5, <italic>k</italic>7, <italic>k</italic>10, and <italic>k</italic>15, depending on the number of sequences per instance.</p>
    </sec>
    <sec>
      <title>3.2 Compalign and SCI</title>
      <p>We use two different scores to measure the quality of the computed alignments: the <italic>Compalign </italic>value codes the degree of similarity to a given reference alignment as given by the percentage of columns that are identically aligned as in the reference alignment. A value of 1 states that the reference and test alignment are the same, whereas 0 denotes that no column was correctly aligned with respect to the reference alignment.</p>
      <p>The second score is the so called <italic>structural conservation index </italic>[<xref ref-type="bibr" rid="B54">54</xref>] (or SCI in short). The SCI basically gives the degree of conservation of a consensus structure induced by a multiple alignment in relation to the <italic>minimum free energy </italic>structure of each sequence (to be more precise, not the actual structures are compared but their respective energy values). A SCI value of ≈ 1 indicates very high structural conservation, whereas a value around 0 indicates no structural conservation at all. Note that the SCI score can be greater than 1, because covariance information is additionally rewarded in the computation.</p>
      <p>We have used the programs <italic>compalignp </italic>and <italic>scif </italic>to compute the Compalign and SCI score. Both tools are freely available from the BRAliBase website.</p>
    </sec>
    <sec>
      <title>3.3 Other structural alignment programs</title>
      <p>We implemented our approach called LARA in C++ within the LISA framework. LISA (<italic>Li</italic>brary of <italic>S</italic>tructural <italic>A</italic>lignment algorithms) contains various methods for aligning protein and RNA structures as well as biological networks.</p>
      <p>Furthermore, we selected several other multiple structural alignment programs to compare the results. We used MARNA [<xref ref-type="bibr" rid="B26">26</xref>] (available from [<xref ref-type="bibr" rid="B55">55</xref>]) using an ensemble of three suboptimal structures as its input, STRAL [<xref ref-type="bibr" rid="B24">24</xref>] (a sequence based algorithm incorporating McCaskill's base pair probabilities, available from [<xref ref-type="bibr" rid="B56">56</xref>]), and a reimplementation of the PMCOMP approach called FOLDALIGNM [<xref ref-type="bibr" rid="B32">32</xref>] (a banded variant of Sankoff's algorithm that aligns base pair probability matrices, available from [<xref ref-type="bibr" rid="B57">57</xref>]). Furthermore, to compare the performance of the structure-based alignment programs to purely sequence-based ones, we performed the same tests with MAFFT [<xref ref-type="bibr" rid="B58">58</xref>], a recent multiple sequence alignment program which is available from [<xref ref-type="bibr" rid="B59">59</xref>]. We want to emphasize that we did not perform any parameter tuning for any program (this includes LARA), i.e., we downloaded the programs from the respective websites and performed the computations out of the box without specifying any optional parameters.</p>
      <p>Since earlier studies [<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B51">51</xref>] showed that structural alignments only contribute an additional benefit – compared to sequence-based approaches – if the pairwise sequence identity drops below ≈ 50 – 60%, we restricted the test set to instances of low homology, i.e., instances having a pairwise sequence identity below 50%.</p>
    </sec>
    <sec>
      <title>3.4 LaRA</title>
      <p>A scoring system for structural alignments has to provide two different kinds of scores: scores for the sequence and the structure part (in case of LARA, these correspond to weights for the alignment and interaction edges, respectively). Since the structure is considered to contain the necessary information for "correct" alignments, we have to make sure that the structure scores contribute the major part to the overall score.</p>
      <p>We do not generate the complete annotation for our input sequence, that is, an interaction edge between every possible interaction, but restrict interaction edges to those having base pair probabilities larger than a threshold <italic>p</italic><sub>min</sub>. For our experiments we resorted to a value of 0.003, similar as in PMCOMP. The impact of different <italic>p</italic><sub>min </sub>values is twofold: First, the lower the value is, the higher the structure scores are. Secondly, a high <italic>p</italic><sub>min </sub>value leads to a sparser structure graph.</p>
      <p>For the scoring of the edges, LARA provides two different schemes: First, a scoring system based on base pair probability matrices (BPP scoring in short) that rescales the scores in spirit of PMCOMP. More precisely, given the probability <italic>p</italic><sub><italic>ij </italic></sub>that nucleotide <italic>i </italic>and <italic>j </italic>pair, the actual score <italic>s</italic><sub><italic>ij </italic></sub>for the structural interaction between <italic>i </italic>and <italic>j </italic>is given by</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M75" name="1471-2105-8-271-i45" overflow="scroll">
            <mml:semantics definitionURL="" encoding="">
              <mml:mrow>
                <mml:msub>
                  <mml:mi>s</mml:mi>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mi>lg</mml:mi>
                <mml:mo>⁡</mml:mo>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>p</mml:mi>
                          <mml:mrow>
                            <mml:mi>i</mml:mi>
                            <mml:mi>j</mml:mi>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>p</mml:mi>
                          <mml:mrow>
                            <mml:mi>min</mml:mi>
                            <mml:mo>⁡</mml:mo>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mfrac>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
              </mml:mrow>
              <mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacqWGZbWCdaWgaaWcbaGaemyAaKMaemOAaOgabeaakiabg2da9iGbcYgaSjabcEgaNnaabmaabaWaaSaaaeaacqWGWbaCdaWgaaWcbaGaemyAaKMaemOAaOgabeaaaOqaaiabdchaWnaaBaaaleaacyGGTbqBcqGGPbqAcqGGUbGBaeqaaaaaaOGaayjkaiaawMcaaaaa@4078@</mml:annotation>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where lg is the natural logarithm. For the sequence scoring, we take the entries from the RIBOSUM matrices [<xref ref-type="bibr" rid="B47">47</xref>] as the actual sequence scores (that is the scores for pairs of nucleotides) and multiply them by a user-specific adjustment factor <italic>τ</italic>. The default value for <italic>τ </italic>is 0.05, leading to a small sequence score contribution to the overall score. If one knows, however, that sequence is equally or more important than the structure (e.g., in case of riboswitches), one simply has to increase the value of <italic>τ</italic>.</p>
      <p>The second scheme employs the RIBOSUM scoring matrices both for sequence and structure scoring: these matrices are based on given alignments of ribosomal RNAs from which log-odds scores were derived. They provide both sequence and structure scores, without rescaling the scores.</p>
      <p>The second crucial LARA parameter is the number of iterations: the more iterations LARA computes, the more often the penalty terms are adapted (yielding better alignments). As one can see in Fig. <xref ref-type="fig" rid="F12">12</xref> the number of iterations influences the quality of the computed alignment while the running time increases linearly with the number of iterations. In our experiments we set the number of iterations to 500.</p>
      <fig position="float" id="F12">
        <label>Figure 12</label>
        <caption>
          <p><bold>Different number of iterations</bold>. Comparison of all <italic>k</italic>10 instances of low homology between LARA running 100 or 500 iterations. Each dot correponds to one problem instance, the thick lines were computed using Lowess regression. The x-axis gives the average pairwise sequence identity (APSI). The y-axis codes the Compalign score.</p>
        </caption>
        <graphic xlink:href="1471-2105-8-271-12"/>
      </fig>
      <p>The scoring of gap edges follows the scheme of <italic>affine gap costs </italic>with an gap open and extension penalty of -6 and -2, respectively.</p>
      <sec>
        <title>Score vs. alignment accuracy</title>
        <p>We were interested to what extent the accuracy of our alignments correlates with the actual BPP score that we computed. Since the score depends on the length of the input sequences, we normalized the score with respect to the number of paired bases in the <italic>minimum free energy </italic>structure. Note that we did not use the actual structure, but the number of base pairs in the structure to get a rough estimate of how many pairings we expect in the structure. Then, let <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M76" name="1471-2105-8-271-i46" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGWbaCgaqcaaaa@2E25@</mml:annotation></mml:semantics></mml:math></inline-formula> and <italic>n </italic>be the average score and the number of base pairs in the MFE structure, then the <italic>base-pair normalized score </italic>is given by <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M77" name="1471-2105-8-271-i46" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mover accent="true"><mml:mi>p</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaacuWGWbaCgaqcaaaa@2E25@</mml:annotation></mml:semantics></mml:math></inline-formula>/<italic>n</italic>. The left side of Fig. <xref ref-type="fig" rid="F13">13</xref> shows the results for all 189 <italic>k</italic>10 instances with an average pairwise sequence identity less than 50%. The great majority of instances behaves as expected: the higher the bp-score is, the better is the corresponding Compalign score: There is, however, a group of 10 outliers (represented by the red boxes). Although they have a high bp-score (greater than 10.0), the alignment accuracy is bad: it turned out that these 10 instances are all SECIS-elements, indicating that the BPP scoring scheme is not appropriate for this group.</p>
        <fig position="float" id="F13">
          <label>Figure 13</label>
          <caption>
            <p><bold>Score vs. alignment accuracy</bold>. All 189 BRALIBASE <italic>k</italic>10 instances of low pairwise sequence identity where each cross or box corresponds to one instance: The x-axis gives the Compalign score. The y-axis codes either a structure-normalized score (left side), or the optimality ratio (right side). The red boxes mark the outliers.</p>
          </caption>
          <graphic xlink:href="1471-2105-8-271-13"/>
        </fig>
        <p>Furthermore, we assumed that there should a correlation between the actual performance of our algorithm and, again, the quality of our alignments: Remember that each Lagrange iteration results in a new valid solution and a new upper bound for the problem instance. Dividing the value of the highest lower bound by the value of the lowest upper bound gives an <italic>optimality ratio</italic>, i.e., a measure of how close the best solution is to an optimal one. Assuming an inverse correlation between the gap between lower and upper bound and the quality of the alignment, we again took all <italic>k</italic>10 BRALIBASE instances of low pairwise sequence identity and computed the arithmetic mean of the optimality ratios of all pairwise alignments. The right side of Fig. <xref ref-type="fig" rid="F13">13</xref> shows the plot for all 189 <italic>k</italic>10 instances with a sequence similarity lower than 50%. Most of the instances behave as expected: the higher the average optimality ratio is, the closer is the computed alignment to the reference alignment (and vice versa). There is, however, a group of 19 instances that behave differently (marked as red boxes in Fig. <xref ref-type="fig" rid="F13">13</xref>): Although their average optimality ratio is high (<italic>&gt; </italic>0.7), the corresponding Compalign value is rather low compared to instances of a similar average optimality ratio. A closer inspection revealed that all instances of the upper left corner (that is instances having a Compalign value lower than 0.65 and an average optimality ratio of greater than 0.7, represented by red boxes in Fig. <xref ref-type="fig" rid="F13">13</xref>) comprises almost all instances of either bacterial SRP RNAs or SECIS elements (just one SRP RNA instance is not among the 19 instances). We therefore increased the number of iterations for one SECIS instance to see whether this would positively influence the quality of the alignment. By setting the number of iterations to 500, 1000, and 2000 we got average optimality ratios of 0.83, 0.85, and 0.87, by simultaneously yielding Compalign values of 0.39, 0.38, and 0.36, respectively. Obviously, the better the computed alignments in terms of the optimality ratio are, the worse they got with respect to the reference alignment.</p>
        <p>Consequently, for the outlier instances described above, we changed the scoring from BPP to RIBOSUM scores. Figure <xref ref-type="fig" rid="F14">14</xref> shows the change in terms of the Compalign score and optimality ratio for the 19 outlier instances: 16 instances had better Compalign scores by using the RIBOSUM scoring, whereas the optimality ratio decreased in the majority of instances.</p>
        <fig position="float" id="F14">
          <label>Figure 14</label>
          <caption>
            <p><bold>Changing the scoring from BPP to RIBOSUM</bold>. Change of the Compalign score and optimality ratio after changing the scoring from BPP to RIBOSUM matrices for the 19 outlier instances.</p>
          </caption>
          <graphic xlink:href="1471-2105-8-271-14"/>
        </fig>
        <p>In general, however, our experiments showed that RIBOSUM scoring is not superior to BPP scoring (at least for the BRALIBASE benchmark and LARA): Figure <xref ref-type="fig" rid="F15">15</xref> shows a comparison of all low homology <italic>k</italic>5 instances using either base pair probability matrices or RIBOSUM scoring, and it is obvious that base pair probability scoring yields better results on these input instances.</p>
        <fig position="float" id="F15">
          <label>Figure 15</label>
          <caption>
            <p><bold>BPP vs. RIBOSUM scoring</bold>. Comparison between base pair probability (BPP) and RIBOSUM scoring. The x-axis gives the average pairwise sequence identity (APSI). The y-axis codes the Compalign score.</p>
          </caption>
          <graphic xlink:href="1471-2105-8-271-15"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>3.5 Comparison with other programs</title>
      <p>As described in Sect. 3.2 we used two different scores to assess the quality of the computed alignments: the Compalign (the degree of similarity between the test alignment to a given reference alignment) and the SCI score (the degree of structural conservation induced by the test alignment).</p>
      <p>FOLDALIGNM performs an alignment and clustering of the input sequences at the same time: in some instances, FOLDALIGNM splits the input sequences into two clusters. Since the scores that we use depend on the number of input sequences, we dropped those FOLDALIGNM alignments that did not contain all sequences in the final alignment: This leads to 43, 30, 11, 15, 19, and 6 instances that we did not consider in case of <italic>k</italic>2, <italic>k</italic>3, <italic>k</italic>5, <italic>k</italic>7, <italic>k</italic>10, and <italic>k</italic>15 instances.</p>
      <p>In Fig. <xref ref-type="fig" rid="F16">16</xref> we show the results of our experiments broken down to the different input classes (either <italic>k</italic>2, <italic>k</italic>3, <italic>k</italic>5, <italic>k</italic>7, <italic>k</italic>10, or <italic>k</italic>15). These graphics have the average pairwise sequence identity and the Compalign score as their <italic>x</italic>- and <italic>y</italic>-axis, respectively. The reference alignments therefore correspond to horizontal lines at a Compalign score of 1.0.</p>
      <fig position="float" id="F16">
        <label>Figure 16</label>
        <caption>
          <p><bold>Compalign results on low homology instances</bold>. Results on all low homology instances containing 2 (upper left), 3 (upper right), 5 (middle left), 7 (middle right), 10 (lower left), and 15 (lower right) instances from the BRALIBASE benchmark set. The <italic>x</italic>- and <italic>y</italic>-axes give the average pairwise sequence identity (APSI) and the Compalign score. The legend from the upper left plot applies to the other plots as well. Mind that the different APSI-ranges in the six plots are a result of the BRALIBASE benchmark set: there are, for example, no <italic>k</italic>15 instances in BRALIBASE below 38%.</p>
        </caption>
        <graphic xlink:href="1471-2105-8-271-16"/>
      </fig>
      <p>We have made several observations: First of all, in the pairwise case (i.e., the <italic>k</italic>2 instances) LARA has a similar performance as the Sankoff variant FOLDALIGNM up to a sequence identity of ≈ 42%. For the range of ≈ 42 – 50% all programs (even sequence-based MAFFT) have comparable performance (except for MARNA). With an increasing number of input sequences per instance, especially for the <italic>k</italic>10 and <italic>k</italic>15 sequences, the results change tremendously: LARA outperforms the other programs, yielding average Compalign scores of ≈ 90%, whereas the other structure-based alignment programs have scores around ≈ 55 – 75%. This is quite remarkable, especially considering that FOLDALIGNM and LARA show a similar performance in the pairwise case: FOLDALIGNM, however, computes multiple alignments in a progressive fashion, whereas LARA computes <italic>all </italic>pairwise alignments and leaves it to T-COFFEE to compute an alignment that is highly consistent with all pairwise alignments. With an increasing number of input sequences, the consistency-based approach generates better alignments than the progressive methods (at least in the case of our experimental setup).</p>
      <p>Another astonishing observation is the performance of MAFFT, a purely sequence-based program: the <italic>k</italic>2 and <italic>k</italic>3 instances show a comparable performance for instances above ≈ 42%, which is already surprising. With a growing number of input instances, the performance of MAFFT becomes even better: in case of 15 input instances, the program yields – on average – the second best results (behind LARA), outperforming even FOLDALIGNM and STRAL, which incorporate structural information. It has to be investigated whether the creation of the benchmark set has to be revisited, because these plots clearly contradict the hypothesis that sequence-based programs yields significantly worse results for input instances of a pairwise sequence identity below 50%.</p>
      <p>In Fig. <xref ref-type="fig" rid="F17">17</xref> we show the results with respect to the SCI score (remember that the SCI is a measure for the structural conservation of an alignment). The general trend is the same as in Fig. <xref ref-type="fig" rid="F16">16</xref>. In the pairwise case, the LARA curve has the same shape as the reference curve, but shifted to the bottom by about 0.1. FOLDALIGNM yields the best approximation to the reference line, having almost the same performance for instances with an APSI greater than 30%. With an increasing number of input sequences, the situation changes: from <italic>k</italic>5 on LARA generates the best approximation to the reference line, with FOLDALIGNM being the second best program. Taking a look at the various result plots puts the extraordinary performance of MAFFT into perspective regarding the <italic>k</italic>10 and <italic>k</italic>15 input sets.</p>
      <fig position="float" id="F17">
        <label>Figure 17</label>
        <caption>
          <p><bold>SCI results on low homology instances</bold>. Results on all low homology instances containing 2 (upper left), 3 (upper right), 5 (middle left), 7 (middle right), 10 (lower left), and 15 (lower right) instances from the BRALIBASE benchmark set. The <italic>y</italic>-axis gives the SCI score. The legend from the upper left plot applies to the other plots as well. Mind that the different APSI-ranges in the six plots are a result of the BRALIBASE benchmark set: there are, for example, no <italic>k</italic>15 instances in BRALIBASE below 38%.</p>
        </caption>
        <graphic xlink:href="1471-2105-8-271-17"/>
      </fig>
      <sec>
        <title>Comparison of running times</title>
        <p>We compared the programs tested on the same computing server with an Intel Xeon CPU running at 3.2 GHz, 3.5 GB RAM, and Linux kernel version 2.6.16. It turned out that memory requirement was not an issue, but the computation time instead: especially MARNA scales in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M78" name="1471-2105-8-271-i47" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFoe=taaa@383C@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>n</italic><sup>4</sup>), which makes the alignment of longer sequences (for example the SRP instances of BRALIBASE) rather time-consuming. This, however, is not the case with LARA and FOLDALIGNM, since these two programs have running times in <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M79" name="1471-2105-8-271-i47" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mi mathvariant="script">O</mml:mi><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaat0uy0HwzTfgDPnwy1egaryqtHrhAL1wy0L2yHvdaiqaacqWFoe=taaa@383C@</mml:annotation></mml:semantics></mml:math></inline-formula>(<italic>n</italic><sup>2</sup>). To evaluate the time consumption within reasonable time, we therefore set a time limit of 20 minutes per instance: If the computation was not finished within 20 minutes, the process was killed and we took 20 minutes as the actual running time. In Table <xref ref-type="table" rid="T2">2</xref> we list the number of instances that the corresponding program was not able to align within 20 minutes.</p>
        <table-wrap position="float" id="T2">
          <label>Table 2</label>
          <caption>
            <p>Failed instances. Unsolved instances within a time limit of 20 minutes.</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <td align="center">Program</td>
                <td align="center"><italic>k</italic>2</td>
                <td align="center"><italic>k</italic>3</td>
                <td align="center"><italic>k</italic>5</td>
                <td align="center"><italic>k</italic>7</td>
                <td align="center"><italic>k</italic>10</td>
                <td align="center"><italic>k</italic>15</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="center">LARA</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
              </tr>
              <tr>
                <td align="center">FOLDALIGNM</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
              </tr>
              <tr>
                <td align="center">STRAL</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
              </tr>
              <tr>
                <td align="center">MARNA</td>
                <td align="center">0</td>
                <td align="center">49</td>
                <td align="center">23</td>
                <td align="center">17</td>
                <td align="center">12</td>
                <td align="center">6</td>
              </tr>
              <tr>
                <td align="center">MAFFT</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">0</td>
              </tr>
            </tbody>
          </table>
        </table-wrap>
        <p>We were especially interested in how the running times of the programs that use structure information scaled with respect to the number of the input sequences: FOLDALIGNM is a progressive approach which computes (<italic>n </italic>- 1) pairwise alignments given <italic>n </italic>input sequences. MARNA and LARA, however, compute all <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M80" name="1471-2105-8-271-i48" overflow="scroll"><mml:semantics definitionURL="" encoding=""><mml:mrow><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:annotation encoding="MathType-MTEF">
 MathType@MTEF@5@5@+=feaafiart1ev1aaatCvAUfKttLearuWrP9MDH5MBPbIqV92AaeXatLxBI9gBaebbnrfifHhDYfgasaacH8akY=wiFfYdH8Gipec8Eeeu0xXdbba9frFj0=OqFfea0dXdd9vqai=hGuQ8kuc9pgc9s8qqaq=dirpe0xb9q8qiLsFr0=vr0=vr0dc8meaabaqaciaacaGaaeqabaqabeGadaaakeaadaWcaaqaaiabd6gaUjabcIcaOiabd6gaUjabgkHiTiabigdaXiabcMcaPaqaaiabikdaYaaaaaa@3407@</mml:annotation></mml:semantics></mml:math></inline-formula> pairwise alignments. Figure <xref ref-type="fig" rid="F18">18</xref> shows the execution time of all five programs on all <italic>k</italic>2, <italic>k</italic>3, <italic>k</italic>5, <italic>k</italic>7, <italic>k</italic>10, and <italic>k</italic>15 instances. As one can see, with an increasing number of input sequences, a progressive alignment strategy pays off compared to the computation of all pairwise alignments.</p>
        <fig position="float" id="F18">
          <label>Figure 18</label>
          <caption>
            <p><bold>Running times of sequence-structure alignment programs</bold>. The plot shows a comparison of the running times between the structural programs tested. With an increasing number of input sequences, a progressive alignment strategy pays off compared to the computation of all pairwise alignments. The <italic>x</italic>-axis lists the different input instances, either containing 2, 3, 5, 7, 10, or 15 sequences (denoted by <italic>k</italic>2, <italic>k</italic>3, <italic>k</italic>5, <italic>k</italic>7, <italic>k</italic>10, and <italic>k</italic>15, respetively). The numbers in brackets denote the number of instances per input class. The y-axis gives the number gives the computation time in seconds.</p>
          </caption>
          <graphic xlink:href="1471-2105-8-271-18"/>
        </fig>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>We have presented a novel method for computing high-quality pairwise structural RNA alignments. We approach the original problem using a flexible graph-based model, which naturally deals with pseudoknots.</p>
    <p>We find solutions in our model by means of an integer linear programming formulation and the Lagrangian relaxation technique. For the multiple case, we compute all-against-all pairwise solutions and pass this information to T-COFFEE, a progressive alignment algorithm.</p>
    <p>Our extensive computational experiments on a large set of benchmark alignments show that LARA, the implementation of our algorithm, is competitive with state-of-the art tools and outperforms alternative approaches with an increasing number of input sequences. The difference to other programs gets larger the more sequences that have to be aligned. In this context, we also find the performance of MAFFT, a purely sequence-based program, remarkable. MAFFT comes closer to manually curated reference alignments than all other structure-specific tools besides LARA for alignments of more than ten sequences.</p>
    <p>Our plans for the future include a local version of our alignment algorithm. Furthermore, we are currently implementing an exact branch-and-bound framework around the Lagrangian approach and will develop a stem-based variant of LARA. Furthermore, the openness to pseudoknots is the main advantage of LARA over alternative approaches, and we plan to adapt our method to produce high-quality alignments of pseudoknotted structures.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>LARA (Lagrangian relaxed alignments) is part of the <bold>C++ </bold>library LiSA and is freely available for academic purposes from <ext-link ext-link-type="uri" xlink:href="http://www.planet-lisa.net"/>. The binary runs under the Linux operating system.</p>
    <p>All alignments that we computed and the scripts for generating the plots are also available from <ext-link ext-link-type="uri" xlink:href="http://www.planet-lisa.net/"/>.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>MB, GWK, and KR developed the integer linear program model. MB coded the program and carried out the computational experiments. MB and GWK drafted the manuscript, GWK and KR coordinated the research. All authors read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p>This is a compressed tar file containing all alignments used in the experimental study.</p>
      </caption>
      <media xlink:href="1471-2105-8-271-S1.gz" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>This work has been partly supported by the DFG grant KL 1390/2-1. MB is additionally supported by the International Max Planck Research School for Computational Biology and Scientific Computing. The authors thank the anonymous referees for valuable comments.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lagos-Quintana</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rauhut</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lendeckel</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Tuschl</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Identification of novel genes coding for small expressed RNAs</article-title>
        <source>Science</source>
        <year>2001</year>
        <volume>294</volume>
        <fpage>853</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="pmid">11679670</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lau</surname>
            <given-names>NC</given-names>
          </name>
          <name>
            <surname>Lim</surname>
            <given-names>LP</given-names>
          </name>
          <name>
            <surname>Weinstein</surname>
            <given-names>EG</given-names>
          </name>
          <name>
            <surname>Bartel</surname>
            <given-names>DP</given-names>
          </name>
        </person-group>
        <article-title>An abundant class of tiny RNAs with probable regulatory roles in <italic>Caenorhabditis elegans</italic></article-title>
        <source>Science</source>
        <year>2001</year>
        <volume>294</volume>
        <fpage>858</fpage>
        <lpage>62</lpage>
        <pub-id pub-id-type="pmid">11679671</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Samarsky</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Fournier</surname>
            <given-names>MJ</given-names>
          </name>
        </person-group>
        <article-title>A comprehensive database for the small nucleolar RNAs from Saccharomyces cerevisiae</article-title>
        <source>Nucleic Acids Res</source>
        <year>1999</year>
        <volume>27</volume>
        <fpage>161</fpage>
        <lpage>164</lpage>
        <pub-id pub-id-type="pmid">9847166</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gorodkin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Knudsen</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zwieb</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Samuelsson</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>SRPDB (Signal Recognition Particle Database)</article-title>
        <source>Nucleic Acids Res</source>
        <year>2001</year>
        <volume>29</volume>
        <fpage>169</fpage>
        <lpage>170</lpage>
        <pub-id pub-id-type="pmid">11125080</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>VN</given-names>
          </name>
        </person-group>
        <article-title>Small RNAs just got bigger: Piwi-interacting RNAs (piRNAs) in mammalian testes</article-title>
        <source>Genes Dev</source>
        <year>2006</year>
        <volume>20</volume>
        <fpage>1993</fpage>
        <lpage>1997</lpage>
        <pub-id pub-id-type="pmid">16882976</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mattick</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>The functional genomics of noncoding RNA</article-title>
        <source>Science</source>
        <year>2005</year>
        <volume>309</volume>
        <fpage>1527</fpage>
        <lpage>1528</lpage>
        <pub-id pub-id-type="pmid">16141063</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Basic Local Alignment Search Tool</article-title>
        <source>J Mol Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smith</surname>
            <given-names>TF</given-names>
          </name>
          <name>
            <surname>Waterman</surname>
            <given-names>MS</given-names>
          </name>
        </person-group>
        <article-title>Identification of Common Molecular Subsequences</article-title>
        <source>J Mol Biol</source>
        <year>1981</year>
        <volume>147</volume>
        <fpage>195</fpage>
        <lpage>197</lpage>
        <pub-id pub-id-type="pmid">7265238</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Haas</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Eskin</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Bafna</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Searching Genomes for Noncoding RNA Using FastR</article-title>
        <source>IEEE/ACM Trans Comput Biol Bioinform</source>
        <year>2005</year>
        <volume>2</volume>
        <fpage>366</fpage>
        <lpage>379</lpage>
        <pub-id pub-id-type="pmid">17044173</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wolf</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Achtziger</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Schultz</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Dandekar</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Müller</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Homology modeling revealed more than 20,000 rRNA internal transcribed spacer 2 (ITS2) secondary structures</article-title>
        <source>RNA</source>
        <year>2005</year>
        <volume>11</volume>
        <fpage>1616</fpage>
        <lpage>1623</lpage>
        <pub-id pub-id-type="pmid">16244129</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Fekete</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
        </person-group>
        <article-title>Secondary Structure Prediction for Aligned RNA Sequences</article-title>
        <source>J Mol Biol</source>
        <year>2002</year>
        <volume>319</volume>
        <fpage>1059</fpage>
        <lpage>1066</lpage>
        <pub-id pub-id-type="pmid">12079347</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Gardner</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Washietl</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>A benchmark of multiple sequence alignment programs upon structural RNAs</article-title>
        <source>Nucl Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>2433</fpage>
        <lpage>2439</lpage>
        <pub-id pub-id-type="pmid">15860779</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bauer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <article-title>Structural Alignment of Two RNA Sequences with Lagrangian Relaxation</article-title>
        <source>Proc ISAAC'04, Volume 3341 of LNCS</source>
        <year>2004</year>
        <publisher-name>Springer-Verlag</publisher-name>
        <fpage>113</fpage>
        <lpage>125</lpage>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Bauer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Multiple Structural RNA Alignment with Lagrangian Relaxation</article-title>
        <source>Proc WABI'05, Volume 3692 of LNBI</source>
        <year>2005</year>
        <fpage>303</fpage>
        <lpage>314</lpage>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Bauer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Fast and Accurate Structural RNA Alignment by Progressive Lagrangian Relaxation</article-title>
        <source>Proc CompLife'05, Volume 3695 of LNBI</source>
        <year>2005</year>
        <fpage>217</fpage>
        <lpage>228</lpage>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bauer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>An Exact Mathematical Programming Approach to Multiple RNA Sequence-Structure Alignment</article-title>
        <source>Tech Rep TR-B-07-07</source>
        <year>2007</year>
        <publisher-name>Dept. of Mathematics and Computer Science, Free University Berlin</publisher-name>
        <ext-link ext-link-type="uri" xlink:href="http://www.inf.fu-berlin.de/inst/pubs"/>
        <comment>[Submitted to <bold>Algorithmic Operations Research</bold>]</comment>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Freyhult</surname>
            <given-names>EK</given-names>
          </name>
          <name>
            <surname>Bollback</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Gardner</surname>
            <given-names>PP</given-names>
          </name>
        </person-group>
        <article-title>Exploring genomic dark matter: A critical assessment of the performance of homology search methods on noncoding RNA</article-title>
        <source>Genome Research</source>
        <year>2007</year>
        <volume>17</volume>
        <fpage>117</fpage>
        <lpage>125</lpage>
        <pub-id pub-id-type="pmid">17151342</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>McCaskill</surname>
            <given-names>JS</given-names>
          </name>
        </person-group>
        <article-title>The Equilibrium Partition Function and Base Pair Binding Probabilities for RNA Secondary Structure</article-title>
        <source>Biopolymers</source>
        <year>1990</year>
        <volume>29</volume>
        <fpage>1105</fpage>
        <lpage>1119</lpage>
        <pub-id pub-id-type="pmid">1695107</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Shasha</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Simple fast algorithms for the editing distance between trees and related problems</article-title>
        <source>SIAM J Comput</source>
        <year>1989</year>
        <volume>18</volume>
        <fpage>1245</fpage>
        <lpage>1262</lpage>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Wang</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Alignment of Trees – An Alternative to Tree Edit</article-title>
        <source>Theor Comput Sci</source>
        <year>1995</year>
        <volume>143</volume>
        <fpage>137</fpage>
        <lpage>148</lpage>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Höchsmann</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Töller</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Giegerich</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Kurtz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Local Similarity in RNA Secondary Structures</article-title>
        <source>Proc IEEE Comput Soc Bioinform Conf</source>
        <year>2003</year>
        <volume>2</volume>
        <fpage>159</fpage>
        <lpage>168</lpage>
        <pub-id pub-id-type="pmid">16452790</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bafna</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Muthukrishnan</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ravi</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Computing similarity between RNA strings</article-title>
        <source>Proc of CPM'95, no 937 in LNCS</source>
        <year>1995</year>
        <publisher-name>Springer</publisher-name>
        <fpage>1</fpage>
        <lpage>16</lpage>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>A memory-efficient dynamic programming algorithm for optimal alignment of a sequence to an RNA secondary structure</article-title>
        <source>BMC Bioinformatics</source>
        <year>2002</year>
        <volume>3</volume>
        <fpage>18</fpage>
        <pub-id pub-id-type="pmid">12095421</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dalli</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mainz</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Steger</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>STRAL: progressive alignment of non-coding RNA using base pairing probability vectors in quadratic time</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <fpage>1593</fpage>
        <lpage>1599</lpage>
        <pub-id pub-id-type="pmid">16613908</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Lin</surname>
            <given-names>GH</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A general edit distance between RNA structures</article-title>
        <source>J Comput Biol</source>
        <year>2002</year>
        <volume>9</volume>
        <fpage>371</fpage>
        <lpage>388</lpage>
        <pub-id pub-id-type="pmid">12015887</pub-id>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Siebert</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>MARNA: Multiple alignment and consensus structure prediction of RNAs based on sequence structure comparisons</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3352</fpage>
        <lpage>3359</lpage>
        <pub-id pub-id-type="pmid">15972285</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sankoff</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Simultaneous solution of the RNA folding, alignment, and proto-sequence problems</article-title>
        <source>SIAM J Appl Math</source>
        <year>1985</year>
        <volume>45</volume>
        <fpage>810</fpage>
        <lpage>825</lpage>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathews</surname>
            <given-names>DH</given-names>
          </name>
          <name>
            <surname>Turner</surname>
            <given-names>DH</given-names>
          </name>
        </person-group>
        <article-title>Dynalign: An Algorithm for Finding Secondary Structures Common to Two RNA Sequences</article-title>
        <source>J Mol Biol</source>
        <year>2002</year>
        <volume>317</volume>
        <fpage>191</fpage>
        <lpage>203</lpage>
        <pub-id pub-id-type="pmid">11902836</pub-id>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mathews</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Predicting a set of minimal free energy RNA secondary structures common to two sequences</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>2246</fpage>
        <lpage>2253</lpage>
        <pub-id pub-id-type="pmid">15731207</pub-id>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hull Havgaard</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lyngsø</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Stormo</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Gorodkin</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Pairwise local structural alignment of RNA sequences with sequence similarity less than 40%</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>1815</fpage>
        <lpage>1824</lpage>
        <pub-id pub-id-type="pmid">15657094</pub-id>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Bernhart</surname>
            <given-names>SHF</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
        </person-group>
        <article-title>Alignment of RNABase Pairing Probability Matrices</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>2222</fpage>
        <lpage>2227</lpage>
        <pub-id pub-id-type="pmid">15073017</pub-id>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Torarinsson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Havgaard</surname>
            <given-names>JH</given-names>
          </name>
          <name>
            <surname>Gorodkin</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Multiple structural alignment and clustering of RNA sequences</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>926</fpage>
        <lpage>932</lpage>
        <pub-id pub-id-type="pmid">17324941</pub-id>
      </citation>
    </ref>
    <ref id="B33">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Will</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Reiche</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>IL</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>PF</given-names>
          </name>
          <name>
            <surname>Backofen</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Inferring Noncoding RNA Families and Classes by Means of Genome-Scale Structure-Based Clustering</article-title>
        <source>PLoS Comput Biol</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>e65</fpage>
        <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0030065"/>
        <pub-id pub-id-type="pmid">17432929</pub-id>
      </citation>
    </ref>
    <ref id="B34">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Eddy</surname>
            <given-names>SP</given-names>
          </name>
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>RNA sequence analysis using covariance models</article-title>
        <source>Nucleic Acids Res</source>
        <year>1994</year>
        <volume>22</volume>
        <fpage>2079</fpage>
        <lpage>2088</lpage>
        <pub-id pub-id-type="pmid">8029015</pub-id>
      </citation>
    </ref>
    <ref id="B35">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holmes</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>A probabilistic model for the evolution of RNA structure</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>166</fpage>
        <pub-id pub-id-type="pmid">15507142</pub-id>
      </citation>
    </ref>
    <ref id="B36">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Holmes</surname>
            <given-names>I</given-names>
          </name>
        </person-group>
        <article-title>Accelerated probabilistic inference of RNAstructure evolution</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>73</fpage>
        <pub-id pub-id-type="pmid">15186509</pub-id>
      </citation>
    </ref>
    <ref id="B37">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dowell</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Efficient pairwise RNA structure prediction and alignment using sequence alignment constraints</article-title>
        <source>BMC Bioinformatics</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>400</fpage>
        <pub-id pub-id-type="pmid">16952317</pub-id>
      </citation>
    </ref>
    <ref id="B38">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sato</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Sakakibara</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>RNA secondary structural alignment with conditional random fields</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>237</fpage>
        <lpage>242</lpage>
      </citation>
    </ref>
    <ref id="B39">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sakakibara</surname>
            <given-names>Y</given-names>
          </name>
        </person-group>
        <article-title>Pair hidden Markov models on tree structures</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>i232</fpage>
        <lpage>240</lpage>
        <pub-id pub-id-type="pmid">12855464</pub-id>
      </citation>
    </ref>
    <ref id="B40">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Kececioglu</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>The maximum weight trace problem inmultiple sequence alignment</article-title>
        <source>Proc CPM'93, Volume 684 of LNCS</source>
        <year>1993</year>
        <fpage>106</fpage>
        <lpage>119</lpage>
      </citation>
    </ref>
    <ref id="B41">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lenhof</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Vingron</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A Polyhedral Approach to RNA Sequence Structure Alignment</article-title>
        <source> J Comput Biol</source>
        <year>1998</year>
        <volume>5</volume>
        <fpage>517</fpage>
        <lpage>530</lpage>
        <pub-id pub-id-type="pmid">9773347</pub-id>
      </citation>
    </ref>
    <ref id="B42">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Caprara</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lancia</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Structural Alignment of Large-Size Proteins via Lagrangian Relaxation</article-title>
        <source>Proc of RECOMB'02</source>
        <year>2002</year>
        <publisher-name>ACM Press</publisher-name>
        <fpage>100</fpage>
        <lpage>108</lpage>
      </citation>
    </ref>
    <ref id="B43">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Bauer</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Klau</surname>
            <given-names>GW</given-names>
          </name>
        </person-group>
        <article-title>Structural Alignment of Two RNA Sequences with Lagrangian Relaxation</article-title>
        <source>Proc of ISAAC'04, no 3341 in LNCS</source>
        <year>2004</year>
        <publisher-name>Springer</publisher-name>
        <fpage>113</fpage>
        <lpage>123</lpage>
      </citation>
    </ref>
    <ref id="B44">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Althaus</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Caprara</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lenhof</surname>
            <given-names>HP</given-names>
          </name>
          <name>
            <surname>Reinert</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>A Branch-and-Cut Algorithm for Multiple Sequence Alignment</article-title>
        <source>Mathematical Programming</source>
        <year>2006</year>
        <volume>105</volume>
        <fpage>387</fpage>
        <lpage>425</lpage>
      </citation>
    </ref>
    <ref id="B45">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Staple</surname>
            <given-names>DW</given-names>
          </name>
          <name>
            <surname>Butcher</surname>
            <given-names>SE</given-names>
          </name>
        </person-group>
        <article-title>Pseudoknots: RNA Structures with Diverse Functions</article-title>
        <source>PLoS Biology</source>
        <year>2005</year>
        <volume>3</volume>
        <fpage>e213</fpage>
        <pub-id pub-id-type="pmid">15941360</pub-id>
      </citation>
    </ref>
    <ref id="B46">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Dost</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Han</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Bafna</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>Structural Alignment of Pseudoknotted RNA</article-title>
        <source>Proceedings of RECOMB</source>
        <year>2006</year>
        <fpage>143</fpage>
        <lpage>158</lpage>
      </citation>
    </ref>
    <ref id="B47">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Klein</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>RSEARCH: Finding homologs of single structured RNA sequences</article-title>
        <source>BMC Bioinformatics</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>44</fpage>
        <pub-id pub-id-type="pmid">14499004</pub-id>
      </citation>
    </ref>
    <ref id="B48">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dowell</surname>
            <given-names>RD</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>Evaluation of several lightweight stochastic context-free grammars for RNA secondary structure prediction</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>71</fpage>
        <pub-id pub-id-type="pmid">15180907</pub-id>
      </citation>
    </ref>
    <ref id="B49">
      <citation citation-type="other">
        <person-group person-group-type="author">
          <name>
            <surname>Goldman</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Papadimitriou</surname>
            <given-names>CH</given-names>
          </name>
          <name>
            <surname>Istrail</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Algorithmic Aspects of Protein Structure Similarity</article-title>
        <source>Proc FOCS'99</source>
        <year>1999</year>
        <fpage>512</fpage>
        <lpage>522</lpage>
      </citation>
    </ref>
    <ref id="B50">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Notredame</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Heringa</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>T-Coffee: A novel method for fast and accurate multiple sequence alignment</article-title>
        <source>Journal of Molecular Biology</source>
        <year>2000</year>
        <pub-id pub-id-type="pmid">10964570</pub-id>
      </citation>
    </ref>
    <ref id="B51">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wilm</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Mainz</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Steger</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>An enhanced RNA alignment benchmark for sequence alignment programs</article-title>
        <source>Algorithms for Molecular Biology</source>
        <year>2006</year>
        <volume>1</volume>
        <fpage>19</fpage>
        <pub-id pub-id-type="pmid">17062125</pub-id>
      </citation>
    </ref>
    <ref id="B52">
      <citation citation-type="other">
        <article-title>BRAliBase 2.1</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.biophys.uni-duesseldorf.de/bralibase/"/>
      </citation>
    </ref>
    <ref id="B53">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Griffiths-Jones</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Moxon</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Marshall</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Khanna</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>Bateman</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>Rfam: annotating non-coding RNAs in complete genomes</article-title>
        <source>Nucl Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>D121</fpage>
        <lpage>124</lpage>
        <pub-id pub-id-type="pmid">15608160</pub-id>
      </citation>
    </ref>
    <ref id="B54">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Washietl</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Hofacker</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Lukasser</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Hüttenhofer</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Stadler</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Mapping of conserved RNA secondary structures predicts thousands of functional noncoding RNAs in the human genome</article-title>
        <source>Nature Biotechnology</source>
        <year>2005</year>
        <volume>23</volume>
        <fpage>1383</fpage>
        <lpage>1390</lpage>
        <pub-id pub-id-type="pmid">16273071</pub-id>
      </citation>
    </ref>
    <ref id="B55">
      <citation citation-type="other">
        <article-title>MARNA</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://biwww2.informatik.uni-freiburg.de/Software/MARNA/index.html"/>
      </citation>
    </ref>
    <ref id="B56">
      <citation citation-type="other">
        <article-title>StrAl Webservice</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://www.biophys.uni-duesseldorf.de/stral/"/>
      </citation>
    </ref>
    <ref id="B57">
      <citation citation-type="other">
        <article-title>Foldalign</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://foldalign.ku.dk/software/index.html"/>
      </citation>
    </ref>
    <ref id="B58">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Katoh</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kuma</surname>
            <given-names>Ki</given-names>
          </name>
          <name>
            <surname>Toh</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Miyata</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>MAFFT version 5: improvement in accuracy of multiple sequence alignment</article-title>
        <source>Nucl Acids Res</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>511</fpage>
        <lpage>518</lpage>
        <pub-id pub-id-type="pmid">15661851</pub-id>
      </citation>
    </ref>
    <ref id="B59">
      <citation citation-type="other">
        <article-title>MAFFT – a multiple sequence alignment program</article-title>
        <ext-link ext-link-type="uri" xlink:href="http://align.bmr.kyushu-u.ac.jp/mafft/software/source.html"/>
      </citation>
    </ref>
    <ref id="B60">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Thompson</surname>
            <given-names>JD</given-names>
          </name>
          <name>
            <surname>Higgins</surname>
            <given-names>DG</given-names>
          </name>
          <name>
            <surname>Gibson</surname>
            <given-names>TJ</given-names>
          </name>
        </person-group>
        <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title>
        <source>Nucl Acids Res</source>
        <year>1994</year>
        <volume>22</volume>
        <fpage>4673</fpage>
        <lpage>4680</lpage>
        <pub-id pub-id-type="pmid">7984417</pub-id>
      </citation>
    </ref>
    <ref id="B61">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Shapiro</surname>
            <given-names>BA</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>K</given-names>
          </name>
        </person-group>
        <article-title>Comparing Multiple RNA Secondary Structures Using Tree Comparisons</article-title>
        <source>CABIOS</source>
        <year>1990</year>
        <volume>6</volume>
        <fpage>309</fpage>
        <lpage>318</lpage>
        <pub-id pub-id-type="pmid">1701685</pub-id>
      </citation>
    </ref>
    <ref id="B62">
      <citation citation-type="book">
        <person-group person-group-type="author">
          <name>
            <surname>Evans</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Finding Common Subsequences with Arcs and Pseudoknots</article-title>
        <source>Proc of CPM'99, no 1645 in LNCS</source>
        <year>1999</year>
        <publisher-name>Springer</publisher-name>
        <fpage>270</fpage>
        <lpage>280</lpage>
      </citation>
    </ref>
  </ref-list>
</back>
