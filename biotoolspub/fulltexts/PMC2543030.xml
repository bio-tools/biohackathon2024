<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-title>BMC Bioinformatics</journal-title>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2543030</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-9-362</article-id>
    <article-id pub-id-type="pmid">18764941</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-9-362</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methodology Article</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Testing gene set enrichment for subset of genes: Sub-GSE</article-title>
    </title-group>
    <contrib-group>
      <contrib id="A1" contrib-type="author">
        <name>
          <surname>Yan</surname>
          <given-names>Xiting</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>xitingya@usc.edu</email>
      </contrib>
      <contrib id="A2" corresp="yes" contrib-type="author">
        <name>
          <surname>Sun</surname>
          <given-names>Fengzhu</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>fsun@usc.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Molecular and Computational Biology Program, Department of Biological Sciences, University of Southern California, Los Angeles, CA 90089-2910, USA</aff>
    <pub-date pub-type="collection">
      <year>2008</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>2</day>
      <month>9</month>
      <year>2008</year>
    </pub-date>
    <volume>9</volume>
    <fpage>362</fpage>
    <lpage>362</lpage>
    <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/1471-2105/9/362"/>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>4</month>
        <year>2008</year>
      </date>
      <date date-type="accepted">
        <day>2</day>
        <month>9</month>
        <year>2008</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright © 2008 Yan and Sun; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2008</copyright-year>
      <copyright-holder>Yan and Sun; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0"/>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</p>
        <!--<rdf xmlns="http://web.resource.org/cc/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:dc="http://purl.org/dc/elements/1.1" xmlns:dcterms="http://purl.org/dc/terms"><Work xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:dcterms="http://purl.org/dc/terms/" rdf:about=""><license rdf:resource="http://creativecommons.org/licenses/by/2.0"/><dc:type rdf:resource="http://purl.org/dc/dcmitype/Text"/><dc:author>
               Yan
               Xiting
               
               xitingya@usc.edu
            </dc:author><dc:title>
            Testing gene set enrichment for subset of genes: Sub-GSE
         </dc:title><dc:date>2008</dc:date><dcterms:bibliographicCitation>BMC Bioinformatics 9(1): 362-. (2008)</dcterms:bibliographicCitation><dc:identifier type="sici">1471-2105(2008)9:1&#x0003c;362&#x0003e;</dc:identifier><dcterms:isPartOf>urn:ISSN:1471-2105</dcterms:isPartOf><License rdf:about="http://creativecommons.org/licenses/by/2.0"><permits rdf:resource="http://web.resource.org/cc/Reproduction" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/Distribution" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Notice" xmlns=""/><requires rdf:resource="http://web.resource.org/cc/Attribution" xmlns=""/><permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" xmlns=""/></License></Work></rdf>-->
      </license>
    </permissions>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Many methods have been developed to test the enrichment of genes related to certain phenotypes or cell states in gene sets. These approaches usually combine gene expression data with functionally related gene sets as defined in databases such as GeneOntology (GO), KEGG, or BioCarta. The results based on gene set analysis are generally more biologically interpretable, accurate and robust than the results based on individual gene analysis. However, while most available methods for gene set enrichment analysis test the enrichment of the entire gene set, it is more likely that only a subset of the genes in the gene set may be related to the phenotypes of interest.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>In this paper, we develop a novel method, termed Sub-GSE, which measures the enrichment of a predefined gene set, or pathway, by testing its subsets. The application of Sub-GSE to two simulated and two real datasets shows Sub-GSE to be more sensitive than previous methods, such as GSEA, GSA, and SigPath, in detecting gene sets assiated with a phenotype of interest. This is particularly true for cases in which only a fraction of the genes in the gene set are associated with the phenotypes. Furthermore, the application of Sub-GSE to two real data sets demonstrates that it can detect more biologically meaningful gene sets than GSEA.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>We developed a new method to measure the gene set enrichment. Applications to two simulated datasets and two real datasets show that this method is sensitive to the associations between gene sets and phenotype. The program Sub-GSE can be downloaded from <ext-link ext-link-type="uri" xlink:href="http://www-rcf.usc.edu/~fsun"/>.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Genome-wide gene expression profiling using microarray technologies has been ubiquitously used in biological research. An important problem is to identify gene sets that are significantly changed under a certain treatment (for example, two different cell lines or tissues or the same cell line under different conditions). A gene set is basically a group of genes with related functions, e.g., genes in a biological process or in the same complex. There are a variety of ways by which genes, and, ultimately, gene sets may be defined. For example, gene sets can be defined according to the information provided by several databases, such as GeneOntology [<xref ref-type="bibr" rid="B1">1</xref>], KEGG [<xref ref-type="bibr" rid="B2">2</xref>], Biocarta <ext-link ext-link-type="uri" xlink:href="http://www.biocarta.com"/>, and Pfam [<xref ref-type="bibr" rid="B3">3</xref>]. Gene sets may also be defined by cytogenetic bands, by region of genomic sequence or by establishing the functional relationships among them. Importantly, by using a gene set-based approach, a high power can potentially be achieved for detecting differentially expressed gene sets by integrating expression changes of genes inside the same gene set, even when the expression changes of individual genes are modest.</p>
    <p>Moreover, because the gene sets have already been annotated by their common functions in the databases, the biological interpretation for a given list of significant gene sets will also be clear. At least one study [<xref ref-type="bibr" rid="B4">4</xref>] showed that using such gene set-based approaches did increase the congruence of the identified gene sets between different data sets addressing the same biological problem. To detect differentially expressed gene sets, several methods have been proposed, which can be roughly categorized into three groups.</p>
    <p>The first group identifies a list of significant differentially expressed genes (DEGs) using individual gene analysis methods, and then examines the enrichment of gene sets within this gene list using different statistical tests, such as the binomial test, Fisher's exact test, or the hypergeometric test [<xref ref-type="bibr" rid="B5">5</xref>-<xref ref-type="bibr" rid="B11">11</xref>]. Khatri and Draghici [<xref ref-type="bibr" rid="B12">12</xref>] compared fourteen different methods within this group. Each of these methods is easy to implement, but flawed by 1) sensitivity to the cutoff value for defining the list of significant DEGs, 2) non-consideration of the relative position of genes inside the significant DEG list, and 3) assumption of independence between the genes, which may make the resulting p-value misleading.</p>
    <p>The second group of methods does not depend on the predefined DEG list. Instead, these methods calculate a gene-specific statistic, known as the "local" statistic, which measures the strength of association between the gene expression and the phenotype for each gene. A "global" statistic for a gene set is then constructed as a function of the local statistic for each gene in it. The significance of the global statistic is assessed by permutation test, and different methods arrive at this assessment in different ways [<xref ref-type="bibr" rid="B13">13</xref>-<xref ref-type="bibr" rid="B21">21</xref>]. In contrast to calculating a gene-specific statistic, the third group of methods directly combines the expression levels of all genes in the gene sets and they are represented as gene set-specific features. These features are then compared between the treatment and the control groups to identify significantly affected gene sets [<xref ref-type="bibr" rid="B22">22</xref>-<xref ref-type="bibr" rid="B27">27</xref>]. Some methods also integrated the interaction information between genes in the gene sets [<xref ref-type="bibr" rid="B28">28</xref>-<xref ref-type="bibr" rid="B31">31</xref>].</p>
    <p>The available methods generally tested the association of all the genes in a gene set with the phenotype. In reality, however, it is more likely that only genes in a subset of the gene set of interest are associated with the phenotype. Three possible factors may explain this. First, since the function annotation defined in the available databases, such as GO, KEGG, and Biocarta, are incomplete, or even erroneous, some of the genes in a gene set of interest may not truly belong to the set. Second, the gene sets are sometimes defined according to the genomic regions of the genes. Thus, the expression of the genes in the same set may not coordinate with each other. For example, although a group of gene sets has been defined by the cytogenetic bands on human chromosomes [<xref ref-type="bibr" rid="B14">14</xref>], the expression of genes on the same cytogenetic bands do not necessarily correlate with each other. The result is that only a subset of genes in a given cytogenetic band will then be correlated with a phenotype. Third, even if all the genes in the gene set have the same function, or belong to the same complex, it is possible that only genes in one branch of the pathway are associated with the phenotype. The cumulative effect of these considerations strongly suggests that the currently available methods for gene set enrichment analysis may not be powerful enough to detect the association of a given gene set with a phenotype, particularly in the case where only a subset of the genes is associated with the phenotype.</p>
    <p>In this paper, therefore, we extend a set-association strategy for genetic polymorphism association studies developed by [<xref ref-type="bibr" rid="B32">32</xref>] to a set-enrichment analysis. In so doing, we want to test the null hypothesis that no subsets of genes in the gene set are associated with the phenotype. We refer to the resulting method as Gene Set Enrichment by testing Subset association, or Sub-GSE. Using two simulated data sets, we first show that Sub-GSE has higher sensitivity in identifying gene sets associated with a phenotype compared to GSEA, SigPath, and GSA, when only a fraction of the genes are associated with the phenotype. Next, we apply Sub-GSE to two real data sets. One involves gene expression data related to gender and the other identified functional gene sets related to p53 mutation status. For the first dataset, Sub-GSE identified cytogenetic bands Xp22 as significantly associated with gender, while GSEA failed to detect this association. For the second dataset, Sub-GSE identified several novel functional gene sets, including DNA damage genes, cell cycle checkpoints genes and programmed cell death genes that are associated with p53 mutation status and that were also not detected by GSEA. Overall, this method provides a complementary approach for identifying gene sets associated with a phenotype, especially when only a subset of genes in a gene set is associated with the phenotype.</p>
  </sec>
  <sec>
    <title>Results and discussion</title>
    <p>In this section, we first give a brief overview of our method. Second, we apply Sub-GSE, GSEA, SigPathway, and GSA to two simulated data sets and compare their performance. Third, we apply Sub-GSE to two real datasets: one related to gender and the other related to p53 mutation status. We also show some new biological findings related to the two real data sets using Sub-GSE.</p>
    <sec>
      <title>Outline of the method</title>
      <p>To assess the enrichment of a given gene set, we construct a statistical hypothesis testing model. The null hypothesis is that no subsets of genes in the given gene set are associated with the phenotype.</p>
      <sec>
        <title>Defining the "strict subsets"</title>
        <p>Given the fact that the number of all subsets of a gene set increases exponentially with the number of genes in the gene set, it is impractical and less powerful to test every subset of the gene set. Therefore, we define the "strict subsets" to only those subsets that are more likely to be related with the phenotype. To define the "strict subsets" of a gene set, we first calculate the association strength between the gene expression and the phenotype for each gene in the gene set. Depending on the measurement levels of the phenotypic data, we calculate the absolute t-statistics for comparing the mean gene expression levels for binary phenotypic data, Kruskal-Wallis statistics for comparing the mean expression levels of different groups for discrete phenotypic data, and the absolute Pearson correlation coefficient between the gene expression levels and the phenotype for continuous data. All genes are sorted in decreasing order of the association strength measures. The "strict subsets" are defined to include genes up to each position from the top to the bottom in the ranked gene list, which are most strongly associated with the phenotype. That is to say, for each position in the ranked gene list, we define a strict subset that includes all the genes that are ranked higher than this position. Thus, if there are <italic>n </italic>genes in the gene set, there will be <italic>n </italic>"strict subsets" among which the <italic>i</italic>-th subset contains the top <italic>i </italic>genes in the ranked gene list according to the association strengths. In this way, the number of subsets to be tested increases linearly with the number of genes in the gene set. Since the strict subsets includes the genes that are most associated with the phenotype, we expect them to be more probable to be related with the phenotype. The strict subsets are defined to be contiguous to include as many as possible subsets that are expected to be more likely related with the phenotype. However, the method we propose here cannot detect the gene sets in which individual genes are not associated with the phenotype but they can interact with each other to affect the phenotype. To overcome the problem that the "strict subsets" contain too few genes, we add a tuning parameter to control the sizes of the "strict subsets". Throughout the paper, we set this tuning parameter to be 5 which means the "strict subsets" are required to contain at least 5 genes. The cutoff for the set size of the strict subsets is set to be 5 so that the method is not too sensitive to detect gene set which has only one gene strongly correlated with the phenotype. There are other ways of deciding the cutoff of the set size as discussed in the Conclusions section.</p>
      </sec>
      <sec>
        <title>Testing Statistic</title>
        <p>The hypothesis testing statistic is calculated in three steps. First, for each "strict subset", we calculate the average association strength across all member genes, which is also called the local set association statistic <italic>T</italic>. Second, the statistical significance (raw p-value) of the local set association statistic <italic>T </italic>for each "strict subset" is calculated by permuting the phenotypes of the individuals. Finally, the minimum raw p-value among all the "strict subsets" is evaluated and taken as the hypothesis testing statistic. If there is any strict subset related with the phenotype, the minimum p-value will be significantly small.</p>
      </sec>
      <sec>
        <title>Significance Assessment</title>
        <p>To assess the significance of the minimum p value, nested permutation is needed since we do not know the distribution of <italic>T </italic>under the null hypothesis However, nested permutation is computation intensive. Fortunately, previous work [<xref ref-type="bibr" rid="B33">33</xref>] has shown that a single set of permutation is sufficient to accomplish the significance assessment. For the permutation, we decide to permute the phenotypic data and keep the gene expression data intact due to the criticism on gene-based permutation which assumes the independence between genes [<xref ref-type="bibr" rid="B16">16</xref>].</p>
        <p>The phenotypic data is permuted for <italic>N </italic>times. After each permutation, the "strict subsets" are re-defined according to the newly calculated association strengths using the permuted phenotypic data. The strict subsets are defined in the same way as we did with the observed data including the threshold of set size.</p>
        <p>The only difference is that the phenotypic data is changed. By comparing the set association statistic <italic>T </italic>from the observed data and those from the permuted data, raw p values can be calculated for all the observed "strict subsets" and thus the observed <italic>P</italic><sub><italic>min </italic></sub>is obtained. To estimate the distribution of <italic>P</italic><sub><italic>min </italic></sub>under the null hypothesis, as classic permutation does, we replace the observed phenotypic data with every permuted phenotypic data and compare the set association statistic with those from all the other <italic>N </italic>- 1 permutations. In other words, we repeat exactly the same procedure to obtain the minimum raw p values for every permuted data. Finally, the significance of the gene set will be the percentage of permutations that result in minimum raw p values smaller than the observed <italic>P</italic><sub><italic>min</italic></sub>. If there are more than one given gene set, multiple testing correction can be done using any multiple testing correction method. In this paper, we use the QVALUE R package [<xref ref-type="bibr" rid="B34">34</xref>] to calculate the q-values for the two biological data sets so that the results by Sub-GSE are comparable with other gene set enrichment analysis methods.</p>
      </sec>
    </sec>
    <sec>
      <title>Simulation Studies</title>
      <p>We first elucidate that the p-values do not depend on the size of the gene set and the p-value has a uniform distribution in [0,1] under the null hypothesis. To achieve these objectives, we simulate a data set where all the gene sets have different set sizes and no gene sets are related to the phenotype. The simulation is implemented in the following steps:</p>
      <p>1. Generate 100 gene sets whose sizes are 5,6,7,8,...,104. The total number of genes is 5450;</p>
      <p>2. The gene expression levels in 100 samples for each gene are generated from a standard normal distribution. Different genes are independent of each other. Different samples are also independent of each other;</p>
      <p>3. Generate the phenotypic data from another independent standard normal distribution in 100 samples;</p>
      <p>4. Repeat steps 1–3 for 100 times;</p>
      <p>In total, the simulation generates 100 data sets that have gene expression data and a corresponding phenotypic data. We apply Sub-GSE to the 100 data sets separately.</p>
      <p>First, since the gene sets have different sizes, we plot the average p-values of all the gene sets across the 100 different data sets against their set sizes to see whether the gene set size affects the significance level. Figure <xref ref-type="fig" rid="F1">1</xref> shows that the set size does not affect the p-values.</p>
      <fig position="float" id="F1">
        <label>Figure 1</label>
        <caption>
          <p><bold>Effect of set size on the p-values</bold>. The average p-values of the 100 gene sets across the 100 different data sets are plotted against their corresponding set sizes.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-362-1"/>
      </fig>
      <p>Second, the phenotypic data is independent of the expression levels of all the genes. Therefore, Sub-GSE should not detect any significant gene sets. In Figure <xref ref-type="fig" rid="F2">2</xref>, the histogram of all the p-values of the 100 gene sets from the 100 data sets is shown. The histogram illustrates that the p-values from the Sub-GSE have a uniform distribution for gene sets that are not related to the phenotype, which is consistent with the theoretical uniform distribution under the null hypothesis.</p>
      <fig position="float" id="F2">
        <label>Figure 2</label>
        <caption>
          <p><bold>The distribution of p-values under the null hypothesis of no association</bold>. The histogram of the p-values under the null hypothesis of no association between the gene sets and the phenotype.</p>
        </caption>
        <graphic xlink:href="1471-2105-9-362-2"/>
      </fig>
      <sec>
        <title>Simulation 1</title>
        <p>We first evaluate the performance of Sub-GSE using simulated data in which gene expression profiles with different correlations within the gene set are generated. The expression profiles for 1000 genes in 100 samples are simulated. The genes are divided into 50 non-overlapping gene sets with 20 genes in each. The gene expression profiles for the 100 samples represent 100 independent vectors of random variables generated from a multivariate normal distribution. The multivariate normal distribution has 1000 dimensions corresponding to the 1000 genes. The mean is a vector of 1000 zeroes, and the variance of the expression levels of each gene is 1. To simulate the dependence between genes, we randomly select a certain percentage of correlated genes (PCG) = (0%, 10%, ⋯, 90%) in each gene set and let the correlation coefficient between any two of them be <italic>ρ </italic>= 0, 0.1, 0.2, ⋯, 0.9. The remaining genes are independent of each other and those that are chosen. We use this simulation strategy based on the following considerations. The chosen genes in the gene set correspond to those in the same complex or pathway; thus, their expression profiles are correlated. Also, since the remaining genes represent those not belonging to the group, they are more likely to be independent of the chosen genes and each other.</p>
        <p>If a given gene is among those that are chosen, we use its expression levels as the phenotype. The rationale of this step is to determine if our Sub-GSE method can identify the gene set to which this particular gene belongs. We repeat this process for all the chosen genes. Thus, we have a total of 1000 × <italic>PCG </italic>different phenotypic data. To avoid the problem where a gene has exactly the same expression profile as the phenotype, we eliminate the gene's expression profile from the expression data if it is used as the phenotype.</p>
        <p>We use the following approach to study the robustness of Sub-GSE. For each given correlation coefficient and PCG, we randomly choose one of the simulated phenotypic data and the corresponding gene expression data. Sub-GSE is applied to the chosen data set for 100 times. The standard deviations of the p-values across the 100 different runs are plotted against the average p-values for all the gene sets in Figure <xref ref-type="fig" rid="F3">3</xref>. The figure shows that the standard deviation of the p-value for the same gene set is smaller than 0.006 and even smaller when the p-value is close to either 1 or 0. The closer the p-value is to 0 or 1, the smaller the standard deviation is. The maximum standard deviation is achieved when the average p-value is around 0.5.</p>
        <fig position="float" id="F3">
          <label>Figure 3</label>
          <caption>
            <p><bold>The robustness of Sub-GSE based on simulation 1</bold>. The standard deviation of the p-values across the 100 runs of Sub-GSE on simulation 1 is plotted against the average p-values for all the gene sets.</p>
          </caption>
          <graphic xlink:href="1471-2105-9-362-3"/>
        </fig>
        <p>For each given pair of percentage of correlated genes (<italic>PCG</italic>) and correlation coefficient, we apply all four methods, Sub-GSE, GSEA, GSA, and SigPath, to the corresponding data. All the gene sets are ranked in an increasing order of their q-values so more significant gene sets have smaller rank. The rank of the gene set, some of whose member genes are correlated with the phenotypic data, is extracted to evaluate the performance of the methods. Figure <xref ref-type="fig" rid="F4">4</xref> shows the average rank of the gene set related to the phenotype for different combinations of <italic>PCG </italic>and correlation coefficient.</p>
        <fig position="float" id="F4">
          <label>Figure 4</label>
          <caption>
            <p><bold>Comparison results of the different tests based on simulation 1</bold>. The average ranks of the gene set related to the phenotype for Sub-GSE, GSEA, GSA, and SigPath for different percentages of correlated genes (<italic>PCG</italic>) and correlation coefficients within the chosen genes. The left panel compares the average ranks in 2-D plots in which each subplot corresponds to one value of <italic>PCG</italic>. For a given <italic>PCG</italic>, the average ranks from the four methods are plotted against the correlation coefficient between the correlated genes. The right panel shows the average rank versus the percentage of correlated genes and correlation coefficient in a 3-D plot.</p>
          </caption>
          <graphic xlink:href="1471-2105-9-362-4"/>
        </fig>
        <p>First, as seen in the left panel in Figure <xref ref-type="fig" rid="F4">4</xref>, for small <italic>PCG </italic>= 10%, 20% and 30%, the average rank of the gene set related to the phenotype based on Sub-GSE is always the lowest, irrespective of the coefficient value. On the other hand, for large <italic>PCG</italic>, the performance of Sub-GSE is similar or slightly worse than GSEA and GSA for small correlation. The right panel in Figure <xref ref-type="fig" rid="F4">4</xref> confirms this because the average rank of the gene set related to the phenotype based on Sub-GSE decreases much faster than those for the other methods when <italic>PCG </italic>is small. The results of Figure <xref ref-type="fig" rid="F4">4</xref> can be explained as follows. When <italic>PCG </italic>is low, only a small fraction of the genes in the target gene set are correlated with the phenotype. GSEA, GSA, and SigPath cannot distinguish the target gene set from the other gene sets since these methods consider all the genes in the gene set of interest in their statistics. In contrast, Sub-GSE incrementally tests each strict set and chooses the smallest p-value across all the strict sets as a test statistic, thus making the test more powerful.</p>
        <p>Second, across different combinations of <italic>PCG </italic>and correlation coefficient, we find that GSA and GSEA achieve similar results. Both GSA and GSEA use t-statistics to obtain the ranking list of genes. For applications in this article, the only diference between them is that GSA restandardizes the statistics before the permutation to reduce the effect of correlation between genes. However, in both panels of Figure <xref ref-type="fig" rid="F4">4</xref>, the average ranks of the target gene set by GSEA and GSA are quite similar, especially when the <italic>PCG </italic>is high. Consequently, restandardization in GSA does not seem to be very efficient in this simulation study, especially when there are many correlated genes.</p>
        <p>Third, to show the sensitivity and specificity of Sub-GSE, we need a group of gene sets that are related with the phenotype. Therefore, we do another set of simulations similar as simulation 1. The detailed descriptions of the simulation and the resulting ROC curves can be found in the supplementary materials [see Additional file <xref ref-type="supplementary-material" rid="S1">1</xref>]. The results show that the higher the PCG and the correlation coefficient are, the higher the AUC score is. Once the correlation coefficient is higher than 0.4, the AUC score is higher than 0.85 no matter what the PCG is. When PCG is higher than 0.5, the AUC score can be higher than 0.75 regardless of the correlation coefficient.</p>
      </sec>
      <sec>
        <title>Simulation 2</title>
        <p>In reality, most phenotypes are the joint effect of multiple genes, probably from multiple pathways. Therefore, we also simulate a more realistic case where the phenotypes are assumed to be a complex function of expression levels from two gene sets. As in simulation 1, we again consider 1000 genes divided equally into 50 non-overlapping gene sets of 20 genes in each. For fixed <italic>PCG </italic>and <italic>ρ</italic>,</p>
        <p>1. Simulate the expression profiles of the 1000 genes as in the first simulation for 100 individuals;</p>
        <p>2. Choose two gene sets <italic>K</italic><sub>1 </sub>and <italic>K</italic><sub>2 </sub>from the 50 gene sets. Let <italic>SK</italic><sub>1 </sub>and <italic>SK</italic><sub>2 </sub>be the correlated genes in <italic>K</italic><sub>1 </sub>and <italic>K</italic><sub>2</sub>, respectively. Define the phenotype for the <italic>j</italic>-th individual as</p>
        <p>
          <disp-formula>
            <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M1" name="1471-2105-9-362-i1" overflow="scroll">
              <mml:semantics>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>y</mml:mi>
                    <mml:mi>j</mml:mi>
                  </mml:msub>
                  <mml:mo>=</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>+</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>∈</mml:mo>
                        <mml:mi>S</mml:mi>
                        <mml:msub>
                          <mml:mi>K</mml:mi>
                          <mml:mn>1</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:munder>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>e</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msubsup>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mo>+</mml:mo>
                  <mml:mstyle displaystyle="true">
                    <mml:munder>
                      <mml:mo>∑</mml:mo>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo>∈</mml:mo>
                        <mml:mi>S</mml:mi>
                        <mml:msub>
                          <mml:mi>K</mml:mi>
                          <mml:mn>2</mml:mn>
                        </mml:msub>
                      </mml:mrow>
                    </mml:munder>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>e</mml:mi>
                        <mml:mrow>
                          <mml:mi>i</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:msubsup>
                      <mml:mo>+</mml:mo>
                      <mml:msub>
                        <mml:mi>ε</mml:mi>
                        <mml:mi>j</mml:mi>
                      </mml:msub>
                    </mml:mrow>
                  </mml:mstyle>
                  <mml:mo>,</mml:mo>
                </mml:mrow>
              </mml:semantics>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>ϵ</italic><sub><italic>j </italic></sub>has a normal distribution with mean 0 and variance 0.25.</p>
        <p>3. Analyze the data using GSEA, SigPath, GSA, and Sub-GSE to rank the gene sets. Rank all the gene sets in increasing order of their q-values.</p>
        <p>4. Repeat steps 1–3 100 times to assess the performance of the different analytic methods by the effects of the different gene expression data.</p>
        <p>We study the robustness of Sub-GSE as follows. Similar to the process in simulation 1, for each given correlation coefficient and PCG, we randomly choose a phenotypic data and the corresponding gene expression data. Sub-GSE is applied to the chosen data set for 100 times. The standard deviation of the p-values across the 100 runs for all the gene sets is plotted against the average p-values in Figure <xref ref-type="fig" rid="F5">5</xref>. Again, the standard deviation of the p-values across different runs for each gene set is smaller than 0.006. The closer the average p-value is to either 0 or 1, the smaller the standard deviation is. The maximum standard deviation is achieved when the average p-value is around 0.5.</p>
        <fig position="float" id="F5">
          <label>Figure 5</label>
          <caption>
            <p><bold>The robustness of Sub-GSE based on simulation 2</bold>. The standard deviation of the p-values across the 100 runs of Sub-GSE on simulation 2 is plotted against the average p-values for all the gene sets.</p>
          </caption>
          <graphic xlink:href="1471-2105-9-362-5"/>
        </fig>
        <p>For this simulation study, we again apply the four different methods to prioritize the gene sets as in the first simulation study and calculate the average rank of the two target gene sets. The results can be found in Figure <xref ref-type="fig" rid="F6">6</xref>.</p>
        <fig position="float" id="F6">
          <label>Figure 6</label>
          <caption>
            <p><bold>Comparison results of the different tests based on simulation 2</bold>. The average ranks of the target gene sets by Sub-GSE, GSEA, GSA and SigPath for different percentages of correlated genes and correlation coefficients in Simulation II. The left panel compares the average ranks in 2-D plots in which each subplot corresponds to one value of <italic>PCG</italic>. For a given <italic>PCG</italic>, the average ranks of the target sets from the four methods are plotted against the correlation coefficient between the correlated genes. The right panel shows the average ranks of the target sets versus the <italic>PCG </italic>and correlation coefficient in a 3-D plot. The four cubes correspond to Sub-GSE, GSEA, GSA and SigPath.</p>
          </caption>
          <graphic xlink:href="1471-2105-9-362-6"/>
        </fig>
        <p>As shown in Figure <xref ref-type="fig" rid="F6">6</xref>, the average ranks of the target gene sets based on all the methods are relatively high. This could result from the involvement of two different gene sets when simulating the phenotypic data and the fact that the phenotypic data are the sum of the squared expression levels of correlated genes. Another potential complicating factor is that the phenotype includes a noise in addition to the function of the gene expression levels of the component genes. All these facts can weaken the correlation between the phenotypic data and the gene expression profile of individual genes inside the true gene sets. Despite these problems, Sub-GSE performs relatively well compared to the other three methods, especially when <italic>PCG </italic>is low. When <italic>PCG </italic>is high, the performances of Sub-GSE are close to those of GSEA and GSA since both GSEA and GSA consider all the genes inside the gene sets. Again, the performances of GSEA and GSA are similar.</p>
      </sec>
    </sec>
    <sec>
      <title>Male Vs. Female Lymphoblastoid Cells</title>
      <p>We also apply Sub-GSE to two real data sets from [<xref ref-type="bibr" rid="B14">14</xref>]. The first data set measured the mRNA expression profiles from lymphoblastoid cells derived from 15 males and 17 females using Affymetrix U133A chip. The gender of the individuals represents the corresponding phenotypic data. The gene sets are chosen as the cytogenetic sets (C1, 319 gene sets) and the functional gene sets (C2, 522 gene sets) defined in [<xref ref-type="bibr" rid="B14">14</xref>]. The cytogenetic sets contain 24 gene sets, one for each of the 24 human chromosomes, and 295 gene sets corresponding to cytogenetic bands along the chromosomes. The functional sets include 472 gene sets containing genes whose products are involved in specific metabolic and signaling pathways, as reported in eight publicly available, manually curated databases, and 50 gene sets containing genes co-expressed in response to genetic and chemical perturbations, as reported in various experimental studies (see supporting text in [<xref ref-type="bibr" rid="B14">14</xref>] for details). We apply Sub-GSE, GSEA, and SigPath to these two types of gene sets independently with the objective of identifying the cytogenetic regions that are differentially expressed between males and females and the functional gene sets related to sex distinction, respectively.</p>
      <p>First, we apply Sub-GSE to investigate the enrichment of cytogenetic gene sets (C1). As expected, the three most significant cytogenetic bands are chrY, chrYp11 and chrYq11 which all have a q-value of 0 and are the only three cytogenetic bands from chromosome Y in gene sets C1. They are also the only three significant gene sets in C1 by GSEA (FDR &lt; 0.2) and SigPath (max q-value &lt; 0.2). Besides these expected bands on chromosome Y, other bands that are ranked as the top 7 among all the gene sets by Sub-GSE, GSEA and SigPath are listed in Table <xref ref-type="table" rid="T1">1</xref>. As seen from the lists, Sub-GSE is sensitive enough to identify cytogenetic bands on both chromosomes X and Y at the q-value threshold of 0.20. On the contrary, neither GSEA nor SigPath is able to detect any bands on chromosome X at the FDR threshold of 0.20. Again, this result shows the sensitivity of Sub-GSE.</p>
      <table-wrap position="float" id="T1">
        <label>Table 1</label>
        <caption>
          <p>Comparison of the top 7 cytogenetic bands related to gender detected by different methods.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="center" colspan="2">Sub-GSE</td>
              <td align="center" colspan="2">GSEA</td>
              <td align="center" colspan="2">sigPath</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">set names</td>
              <td align="left">q-value</td>
              <td align="left">set names</td>
              <td align="left">FDR</td>
              <td align="left">set names</td>
              <td align="left">max q-value</td>
            </tr>
            <tr>
              <td colspan="6">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="left">chrY</td>
              <td align="left">0</td>
              <td align="left">chrY</td>
              <td align="left">0</td>
              <td align="left">chrY</td>
              <td align="left">0</td>
            </tr>
            <tr>
              <td align="left">chrYq11</td>
              <td align="left">0</td>
              <td align="left">chrYq11</td>
              <td align="left">0.000801147</td>
              <td align="left">chrYq11</td>
              <td align="left">0</td>
            </tr>
            <tr>
              <td align="left">chrYp11</td>
              <td align="left">0</td>
              <td align="left">chrYp11</td>
              <td align="left">0.000811309</td>
              <td align="left">chrYp11</td>
              <td align="left">0</td>
            </tr>
            <tr>
              <td align="left">chrXp22</td>
              <td align="left">0.147</td>
              <td align="left">chrYp11_Xp22</td>
              <td align="left">0.25508726</td>
              <td align="left">chrYp11_Xp22</td>
              <td align="left">0.315700257</td>
            </tr>
            <tr>
              <td align="left">chrX</td>
              <td align="left">0.294</td>
              <td align="left">chr11p12</td>
              <td align="left">0.31999215</td>
              <td align="left">chr1q22</td>
              <td align="left">0.990782566</td>
            </tr>
            <tr>
              <td align="left">chrXp11</td>
              <td align="left">0.686</td>
              <td align="left">chr6q24</td>
              <td align="left">0.6108403</td>
              <td align="left">chr20p11</td>
              <td align="left">0.991916264</td>
            </tr>
            <tr>
              <td align="left">chr15q11</td>
              <td align="left">0.924</td>
              <td align="left">chr5p14</td>
              <td align="left">0.6131663</td>
              <td align="left">chr15q21</td>
              <td align="left">0.991916264</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The top 7 gene sets by Sub-GSE, GSEA and sigPath and their corresponding p-values, FDR and max q-values. The cytogenetic bands chrYp11_Xp22 was named chrYp22 in the original gene set data which include 8 genes that are on both chrYp11 and chrXp22.</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Second, we apply Sub-GSE to investigate the enrichment of functional gene sets (C2). Both Sub-GSE and GSEA detect three significant gene sets whose significance levels are listed in Table <xref ref-type="table" rid="T2">2</xref>: testis-related genes, genes that escape X inactivation, and female reproductive tissue-expressed genes. The q-values of all the other gene sets are larger than 0.9 by Sub-GSE. Hence, in this dataset, the results by Sub-GSE are roughly the same as those achieved by GSEA.</p>
      <table-wrap position="float" id="T2">
        <label>Table 2</label>
        <caption>
          <p>Comparison of the significant functional gene sets related to gender by Sub-GSE and GSEA.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">Set Name</td>
              <td align="left">Sub-GSE (q-value)</td>
              <td align="left">GSEA (FDR)</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Testis related genes</td>
              <td align="left">&lt;0.001</td>
              <td align="left">0.012</td>
            </tr>
            <tr>
              <td align="left">Genes that escape X inactivation</td>
              <td align="left">0.165</td>
              <td align="left">&lt;0.001</td>
            </tr>
            <tr>
              <td align="left">Female reproductive tissue expressed genes</td>
              <td align="left">0.165</td>
              <td align="left">0.045</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>The top 3 functional gene sets and their corresponding q-values and FDR rates by Sub-GSE and GSEA.</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
    <sec>
      <title>P53 Status in Cancer Cell Lines</title>
      <p>The second real data set corresponds to the gene expression data and phenotypic data related to p53 mutation status from [<xref ref-type="bibr" rid="B14">14</xref>]. The objective of this study is to identify novel targets of the transcription factor p53. The p53 mutation status gene expression data examined the gene expression patterns from the NCI-60 collection of cancer cell lines. The expression profiles were measured using Affymetrix U95Av2 chips. The mutational status of the p53 gene had been reported for 50 of the NCI-60 cell lines, with 17 being classified as normal and 33 as carrying mutations in the gene. We take the gene expression profiles of these 50 cell lines as the expression data and the vector of binary indicators of the mutational patterns (normal or mutated) as the corresponding phenotypic data. For the gene set data, we only use the functional sets (C2, 522 gene sets) in [<xref ref-type="bibr" rid="B14">14</xref>], which was already described in the application noted above. Functional sets that have a q-value smaller than or equal to 0.03 by Sub-GSE are extracted and listed in Table <xref ref-type="table" rid="T3">3</xref> together with their q-values. Comparing the list of significant gene sets by Sub-GSE and GSEA [<xref ref-type="bibr" rid="B14">14</xref>], we can see that Sub-GSE obtains more significant gene sets than GSEA does, which again shows the sensitivity of Sub-GSE. The relationship between the identified gene sets by Sub-GSE (Table <xref ref-type="table" rid="T3">3</xref>) and p53 is illustrated in Figure <xref ref-type="fig" rid="F7">7</xref>. Basically, all these gene sets are significantly enriched in genes that are differentially expressed in p53 mutants versus those without p53 mutations. Therefore, the identified gene sets by Sub-GSE are potentially those regulated by p53. According to the definitions of these gene sets, as shown in Figure <xref ref-type="fig" rid="F7">7</xref>, we can roughly divide them into three groups.</p>
      <table-wrap position="float" id="T3">
        <label>Table 3</label>
        <caption>
          <p>Significant functional gene sets related to p53 mutational status by Sub-GSE.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <td align="left">Set Name</td>
              <td align="left">q-value</td>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">Hypoxia and p53 in the Cardiovascular system</td>
              <td align="left">&lt;0.001</td>
            </tr>
            <tr>
              <td align="left">G1 and S Phases of the Cell Cycle</td>
              <td align="left">&lt;0.001</td>
            </tr>
            <tr>
              <td align="left">p53 Signaling Pathway (p53 Pathway)</td>
              <td align="left">0.022</td>
            </tr>
            <tr>
              <td align="left">TrkA Signaling Pathway</td>
              <td align="left">0.022</td>
            </tr>
            <tr>
              <td align="left">P53 Upregulated Genes</td>
              <td align="left">0.022</td>
            </tr>
            <tr>
              <td align="left">p53 Signaling Pathway Genes(p53_signalling)</td>
              <td align="left">0.029</td>
            </tr>
            <tr>
              <td align="left">Cell Cycle: G2/M Checkpoint</td>
              <td align="left">0.029</td>
            </tr>
            <tr>
              <td align="left">G2 and M Phases of the Cell Cycle</td>
              <td align="left">0.029</td>
            </tr>
            <tr>
              <td align="left">Programmed Cell Death</td>
              <td align="left">0.029</td>
            </tr>
            <tr>
              <td align="left">DNA Damage Signaling Pathway</td>
              <td align="left">0.029</td>
            </tr>
            <tr>
              <td align="left">Radiation Sensitivity Genes</td>
              <td align="left">0.029</td>
            </tr>
            <tr>
              <td align="left">Cell Cycle Regulator Genes</td>
              <td align="left">0.029</td>
            </tr>
            <tr>
              <td align="left">ATM Signaling Pathway</td>
              <td align="left">0.029</td>
            </tr>
            <tr>
              <td align="left">Ceramide Signaling Pathway</td>
              <td align="left">0.029</td>
            </tr>
            <tr>
              <td align="left">Drug Resistance and Metabolism Genes</td>
              <td align="left">0.029</td>
            </tr>
            <tr>
              <td align="left">Stress Induction of HSP Regulation</td>
              <td align="left">0.029</td>
            </tr>
            <tr>
              <td align="left">Multi-step Regulation of Transcription by Pitx2</td>
              <td align="left">0.029</td>
            </tr>
            <tr>
              <td align="left">Fas Signaling Pathway</td>
              <td align="left">0.029</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Significant functional gene sets (q-value ≤ 0.03) detected in 50 of the NCI-60 cell lines. The q-values are calculated by Sub-GSE.</p>
        </table-wrap-foot>
      </table-wrap>
      <fig position="float" id="F7">
        <label>Figure 7</label>
        <caption>
          <p><bold>Relationship between the significant gene sets and p53</bold>. Relationship between significant gene sets and p53. Solid arrows describe the interactions between p53 and different biological processes or genes. Dashed arrows show the definition of those gene sets in the corresponding dashed rectangle. The solid arrows are constructed based on previous works in [<xref ref-type="bibr" rid="B35">35</xref>-<xref ref-type="bibr" rid="B40">40</xref>].</p>
        </caption>
        <graphic xlink:href="1471-2105-9-362-7"/>
      </fig>
      <p>The first group includes gene sets that are directly regulated or affected by p53, including the "p53 signaling pathway", "p53 signaling pathway genes", and "p53 upregulated genes". This group of gene sets was detected by both Sub-GSE and GSEA [<xref ref-type="bibr" rid="B14">14</xref>] (FDR &lt; 0.015).</p>
      <p>The second group contains gene sets that are "downstream" of p53. These gene sets can either be induced or inhibited by p53 [<xref ref-type="bibr" rid="B35">35</xref>-<xref ref-type="bibr" rid="B38">38</xref>]. For example, it is well known that p53 induces cell cycle arrest during the G1/S phase and the G2/M phase checkpoint [<xref ref-type="bibr" rid="B36">36</xref>]. By itself, p53 can activate an important death receptor, Fas, which triggers the "Fas Signaling Pathway" and thus leads to apoptosis [<xref ref-type="bibr" rid="B38">38</xref>]. It is also well known that p53 functions "upstream" of ceramide in response to genotoxic stress [<xref ref-type="bibr" rid="B37">37</xref>].</p>
      <p>The third group includes gene sets related to the "upstream" biological processes or genes for p53. These "upstream" biological processes, such as DNA damage caused by radiation or chemical carcinogens, for example, pass the DNA damage signal down to p53 and further induce some of the "downstream" pathways. Two genes, TrkA and Pitx2, are known to affect apoptosis through regulation of p53 [<xref ref-type="bibr" rid="B39">39</xref>,<xref ref-type="bibr" rid="B40">40</xref>]. The gene sets related to these "upstream" biological processes actually include genes related to those "downstream" biological processes in the second group.</p>
      <p>In this dataset, Sub-GSE not only detects the gene sets identified by GSEA [<xref ref-type="bibr" rid="B14">14</xref>], but also detects more novel gene sets related to p53. Previous studies from the literature support the findings in that all the significant gene sets identified by Sub-GSE are related to p53, as shown in Figure <xref ref-type="fig" rid="F7">7</xref>.</p>
    </sec>
  </sec>
  <sec>
    <title>Conclusion</title>
    <p>To summarize, we have developed a method, called Sub-GSE, to identify gene sets that are associated with a phenotype by testing the association between the strict subsets of genes and the phenotype. In many applications, it is very likely that only a subset of genes in a gene set of interest is associated with the phenotype. However, since currently available methods for gene set enrichment analysis usually test the association of all the genes in a gene set with the phenotype, the power of these methods is correspondingly reduced. In contrast, Sub-GSE is based on the idea of set-association approach first proposed by [<xref ref-type="bibr" rid="B32">32</xref>] and it incrementally tests the association of "strict subsets" with the phenotype. The strict subsets contain the genes having the top association strength of individual genes with the phenotype. We first study the performance of Sub-GSE and compare it with three widely used methods for gene set enrichment analysis: GSEA, GSA, and SigPath. Our simulations show that Sub-GSE outperforms GSEA, GSA, and SigPath in prioritizing gene sets associated with a phenotype when the fraction of genes associated with the phenotype is relatively small. On the other hand, these four methods all achieve similar results when the fraction of associated genes is large. When applied to two real data sets, Sub-GSE is shown to detect more biologically meaningful gene sets than GSEA. For example, Sub-GSE identified cytogenetic band Xp22 as significantly associated with gender (q-value &lt; 0.20), while neither GSEA nor SigPath identified them as significant at a FDR &lt; 0.20. Similarly, Sub-GSE identified many gene sets including, for instance, DNA damage genes, cell cycle checkpoints genes and programmed cell death genes, as significantly associated with p53 mutation status. These were not identified by GSEA. This evidence supports the high sensitivity of Sub-GSE. Most of the detected gene sets have supports from previous studies for the association between them and the p53 mutations.</p>
    <p>Usually a large number of sets will be detected as significant for most tests of gene enrichment analysis. Since Sub-GSE is more sensitive in detecting significant gene sets than other tests for gene set enrichment analysis, we expect that many more gene sets will be identified as significant. This may reflect biological reality instead of statistical artifacts. For example, cancer can affect a large number of genes and gene categories. By studying the GO relationship among the significant gene sets, the more specific significant GO categories may represent the real underlying affected function categories.</p>
    <p>The advantages of Sub-GSE over other approaches for testing gene set enrichment are most evident when only a fraction of the genes in the gene set of interest are associated with the phenotype. If we believe that most genes in a gene set of interest are associated with the phenotype, other approaches, including GSEA, GSA, and SigPath, may perform better than Sub-GSE. Under this scenario, the use of the minimum p-value across all the strict subsets as a test statistic, which is done in Sub-GSE, would result in the introduction of more noise. It is possible that the minimal p-value may be achieved for some subsets of the gene set of interest, making Sub-GSE less powerful. The results of our simulations are consistent with this observation. On the other hand, our simulations also showed that the performance of Sub-GSE is only marginally worse than the other approaches under the conditions noted above. We do not claim that Sub-GSE is always better than GSEA, GSA, or SigPath. Instead, Sub-GSE complements other approaches for gene set enrichment analysis when the fraction of associated genes is relatively small.</p>
    <p>The speed of Sub-GSE is determined by the number of gene sets and the number of genes inside each gene set. To give an example of the running time, we download the gene expression data with accession number GSE5081 from NCBI <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/"/> which hybridized total RNAs from gastric biopsy specimens of patients with Helicobacter pylori positive (HP+) and Helicobacter pylori negative (HP-) antrum erosions (ER+), and the corresponding, adjacent normal mucosae (ER-). The gene expression data includes 54675 probes and 32 samples. HP+ and HP- are treated as the phenotype. Mappings between the probes and GO categories are from the R package <ext-link ext-link-type="uri" xlink:href="http://www.r-project.org/"/> named "hgu133plus2". All the probes are mapped to 8310 GO categories in total. We run Sub-GSE on this data set using a computer with Pentium 4 CPU 3.60 GHz/3.59 GHz, 1.00 GB of RAM. It took 12.7 hours when 1000 permutations are required and the strict set size threshold is 1.</p>
    <p>Usually we need to simultaneously test the association of a large number of gene sets with the phenotype. For each gene set, we can use Sub-GSE to test the association of the gene set with the phenotype to obtain a p-value. We have shown in the "Results" section that the p-value is uniformly distributed under the null hypothesis that no subset is associated with the phenotype. When we test for a large number of gene sets, the issue of multiple testing is of concern. To solve this problem, conventional methods such as Bonferroni correction can be used. However, Bonferroni correction is too conservative in most situations. Another currently widely used method dealing with multiple testing is to control false discovery rate (FDR) as implemented in the software package QVALUE [<xref ref-type="bibr" rid="B34">34</xref>]. For the QVALUE package to work well, the p-values for all the gene sets need to be weakly dependent. When the sizes of the gene sets are relatively small compared to the total number of genes, we expect that the p-values to be weakly dependent since the genes usually form modules and genes from different modules are more likely to be independent. When these assumptions are in doubt, we can use the p-values obtained from Sub-GSE to indicate the statistical significance of the gene sets.</p>
    <p>There are two options in Sub-GSE: the minimal size for the strict sets and the statistic to measure the association strength between gene expression profiles and the phenotype. We set the tuning parameter <italic>c </italic>to be the minimal size of the strict subsets on which to test. Parameter <italic>c </italic>can control the sensitivity and the specificity of Sub-GSE, thus having a significant effect on its performance. Generally, the sensitivity of Sub-GSE decreases and the specificity increases as <italic>c </italic>increases. Therefore, the choice of <italic>c </italic>should depend on the balance between sensitivity and specificity. Although we set <italic>c </italic>= 5 in this paper, which restricts the minimal size for the strict sets, we can, instead, require that the minimal size of the strict sets depend on the size of the gene set of interest. For example, one could consider the subsets of genes that cover at least 10% of the given genes inside each gene set. Since the minimal set size of the subset may be different for different gene sets, the effects of this type of restriction need to be further studied. The other Sub-GSE option involves the statistic used to measure the association strength between gene expression profiles and the phenotype. In this paper, we use t-statistics, Kruskal-Wallis statistics, and Pearson's correlation to evaluate the association strength between the gene expression profiles and discrete, categorical, and quantitative phenotypes, respectively. Other statistics can also be applied. The power of Sub-GSE to detect enriched gene sets for different types of statistics also needs to be further studied.</p>
    <p>It is well known that genes in the same pathway or complex tend to be correlated. A natural question is whether it is better first to do principal component analysis (PCA) and then apply Sub-GSE to the principal components. We implemented this idea and found the approach less powerful than the method implemented in this paper. A potential explanation is that the expression profiles of the genes in the gene sets among the cases and controls do not satisfy the normality assumption making the PCA approach less powerful. More studies are needed to see under what conditions the combination of PCA and Sub-GSE is more powerful than Sub-GSE alone.</p>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>Association strength measures for individual genes</title>
      <p>For a given gene, suppose the gene expression levels measured in the experiment are (<italic>e</italic><sub>1</sub>, <italic>e</italic><sub>2</sub>, ⋯, <italic>e</italic><sub><italic>m</italic></sub>), where <italic>m </italic>is the number of samples. The corresponding phenotypic data for the <italic>m </italic>samples are denoted as <italic>C </italic>= (<italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>,⋯, <italic>c</italic><sub><italic>m</italic></sub>). Depending on the measurement levels of <italic>C</italic>, we measure the association strength between the gene expression and phenotype by the absolute value of t-statistic, Kruskal-Wallis statistic or Pearson correlation coefficient for binary, discrete or continuous phenotypic data, respectively.</p>
    </sec>
    <sec>
      <title>Local association statistic for each strict subset and the global statistic for the gene set</title>
      <p>Suppose the given gene set has a total of <italic>s </italic>genes and the sorted association strength measures are <italic>a</italic><sub>1 </sub>≥ <italic>a</italic><sub>2 </sub>≥ ⋯ ≥ <italic>a</italic><sub><italic>s</italic></sub>. According to the definition of the strict subsets, the <italic>i</italic>-th strict subset include genes that correspond to (<italic>a</italic><sub>1</sub>, <italic>a</italic><sub>2</sub>,⋯, <italic>a</italic><sub><italic>i</italic></sub>). The local association statistic for the strict subset <italic>i </italic>is defined as</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M2" name="1471-2105-9-362-i2" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>T</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mstyle displaystyle="true">
                      <mml:msubsup>
                        <mml:mo>∑</mml:mo>
                        <mml:mrow>
                          <mml:mi>j</mml:mi>
                          <mml:mo>=</mml:mo>
                          <mml:mn>1</mml:mn>
                        </mml:mrow>
                        <mml:mi>i</mml:mi>
                      </mml:msubsup>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mi>a</mml:mi>
                          <mml:mi>j</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                    </mml:mstyle>
                  </mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mfrac>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>We use the permutation test described below to define a p-value, <italic>p</italic><sub><italic>i </italic></sub>for the <italic>i</italic>-th strict set. The statistic for the given gene set is the minimum p-value over all the strict sets, i.e.</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M3" name="1471-2105-9-362-i3" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>P</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                    <mml:mi>n</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:munderover>
                  <mml:mrow>
                    <mml:mi>min</mml:mi>
                    <mml:mo>⁡</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mi>c</mml:mi>
                  </mml:mrow>
                  <mml:mi>s</mml:mi>
                </mml:munderover>
                <mml:msub>
                  <mml:mi>p</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
    </sec>
    <sec>
      <title>Permutation test</title>
      <p>We employ the algorithm in [<xref ref-type="bibr" rid="B41">41</xref>] to assess the significance of the given gene set. The algorithm permutes the phenotypic data <italic>C </italic>= (<italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>,⋯, <italic>c</italic><sub><italic>m</italic></sub>) for <italic>N </italic>times and keep the gene expression data intact. After each permutation, the association strength measures are re-calculated using the permuted phenotypic data and the "strict subsets" are re-defined. Suppose that the statistics <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M4" name="1471-2105-9-362-i4" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>T</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> for the <italic>n</italic>-th permutation and the <italic>i</italic>-th strict subset are organized as</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M5" name="1471-2105-9-362-i5" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mrow>
                  <mml:mo>(</mml:mo>
                  <mml:mrow>
                    <mml:mtable>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>T</mml:mi>
                              <mml:mi>c</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mn>0</mml:mn>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>T</mml:mi>
                              <mml:mrow>
                                <mml:mi>c</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mn>0</mml:mn>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mo>⋯</mml:mo>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>T</mml:mi>
                              <mml:mi>s</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mn>0</mml:mn>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>T</mml:mi>
                              <mml:mi>c</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>T</mml:mi>
                              <mml:mrow>
                                <mml:mi>c</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mo>⋯</mml:mo>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>T</mml:mi>
                              <mml:mi>s</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mn>1</mml:mn>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mo>⋯</mml:mo>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mo>⋯</mml:mo>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mo>⋯</mml:mo>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mo>⋯</mml:mo>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>T</mml:mi>
                              <mml:mi>c</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>N</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>T</mml:mi>
                              <mml:mrow>
                                <mml:mi>c</mml:mi>
                                <mml:mo>+</mml:mo>
                                <mml:mn>1</mml:mn>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>N</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mo>⋯</mml:mo>
                        </mml:mtd>
                        <mml:mtd>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mi>T</mml:mi>
                              <mml:mi>s</mml:mi>
                              <mml:mrow>
                                <mml:mo stretchy="false">(</mml:mo>
                                <mml:mi>N</mml:mi>
                                <mml:mo stretchy="false">)</mml:mo>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                        </mml:mtd>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                  <mml:mo>)</mml:mo>
                </mml:mrow>
                <mml:mo>,</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>c </italic>is the minimum number of genes in the strict sets. Here we take the observed data as the permutation 0.</p>
      <p>Based on the data matrix, we calculate the raw p-value for the <italic>i</italic>-th strict set of the observed data as</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M6" name="1471-2105-9-362-i6" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msub>
                  <mml:mi>p</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:msub>
                <mml:mo>=</mml:mo>
                <mml:msubsup>
                  <mml:mi>p</mml:mi>
                  <mml:mi>i</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mn>0</mml:mn>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mo>#</mml:mo>
                    <mml:mo>{</mml:mo>
                    <mml:mi>n</mml:mi>
                    <mml:mo>&gt;</mml:mo>
                    <mml:mn>0</mml:mn>
                    <mml:mo>:</mml:mo>
                    <mml:msubsup>
                      <mml:mi>T</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>n</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>≥</mml:mo>
                    <mml:msubsup>
                      <mml:mi>T</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>}</mml:mo>
                  </mml:mrow>
                  <mml:mi>N</mml:mi>
                </mml:mfrac>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>The testing statistic for the gene set is <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M7" name="1471-2105-9-362-i7" overflow="scroll"><mml:semantics><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula>.</p>
      <p>To estimate the distribution of <italic>P</italic><sub><italic>min </italic></sub>under the null hypothesis, we replace the observed "strict subset" statistics with the permuted ones. The permuted raw p-values for the <italic>n</italic>-th permutation and <italic>i</italic>-th strict subset are calculated by</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M8" name="1471-2105-9-362-i8" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>p</mml:mi>
                  <mml:mi>i</mml:mi>
                  <mml:mrow>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mi>n</mml:mi>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mo>#</mml:mo>
                    <mml:mo>{</mml:mo>
                    <mml:mi>l</mml:mi>
                    <mml:mo>≥</mml:mo>
                    <mml:mn>0</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>l</mml:mi>
                    <mml:mo>≠</mml:mo>
                    <mml:mi>n</mml:mi>
                    <mml:mo>:</mml:mo>
                    <mml:msubsup>
                      <mml:mi>T</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>l</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>≥</mml:mo>
                    <mml:msubsup>
                      <mml:mi>T</mml:mi>
                      <mml:mi>i</mml:mi>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>n</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>}</mml:mo>
                  </mml:mrow>
                  <mml:mi>N</mml:mi>
                </mml:mfrac>
                <mml:mo>.</mml:mo>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
      <p>The minimum p-value <inline-formula><mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M9" name="1471-2105-9-362-i9" overflow="scroll"><mml:semantics><mml:mrow><mml:msubsup><mml:mi>P</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mrow><mml:mi>min</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:msubsup><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:semantics></mml:math></inline-formula> is taken as one of the random sample from the distribution of <italic>P</italic><sub><italic>min </italic></sub>under the null hypothesis. Finally the significance of the gene set is calculated as</p>
      <p>
        <disp-formula>
          <mml:math xmlns:mml="http://www.w3.org/1998/Math/MathML" id="M10" name="1471-2105-9-362-i10" overflow="scroll">
            <mml:semantics>
              <mml:mrow>
                <mml:mi>p</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mi>v</mml:mi>
                <mml:mi>a</mml:mi>
                <mml:mi>l</mml:mi>
                <mml:mi>u</mml:mi>
                <mml:mi>e</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:mo>#</mml:mo>
                    <mml:mo>{</mml:mo>
                    <mml:mi>n</mml:mi>
                    <mml:mo>≥</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>:</mml:mo>
                    <mml:msubsup>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mi>n</mml:mi>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>≤</mml:mo>
                    <mml:msubsup>
                      <mml:mi>P</mml:mi>
                      <mml:mrow>
                        <mml:mi>m</mml:mi>
                        <mml:mi>i</mml:mi>
                        <mml:mi>n</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mo stretchy="false">(</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mo stretchy="false">)</mml:mo>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:mo>}</mml:mo>
                  </mml:mrow>
                  <mml:mi>N</mml:mi>
                </mml:mfrac>
              </mml:mrow>
            </mml:semantics>
          </mml:math>
        </disp-formula>
      </p>
    </sec>
    <sec>
      <title>Multiple testing correction for multiple gene sets</title>
      <p>In a typical situation, there will be multiple gene sets to be analyzed. After we assess the significance level for each of them according to the procedure described above, q-values of all the given gene sets are calculated using the QVALUE R package [<xref ref-type="bibr" rid="B34">34</xref>] for multiple testing correction.</p>
    </sec>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>XY developed and implemented the algorithm and FS provided the original idea. Both XY and FS contributed to the writing of the manuscript. XY and FS read and approved the final manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Supplementary Materials</bold>. This file contains the descriptions of the simulations that show the ROC curves and the robustness of Sub-GSE.</p>
      </caption>
      <media xlink:href="1471-2105-9-362-S1.pdf" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack>
    <sec>
      <title>Acknowledgements</title>
      <p>We thank Dr. Chao Cheng for substantially useful discussion of the method and the results. This work was partly supported by National Institutes of Health (NIH)/National Science Foundation Joint Mathematical Biology Initiative grant DMS-0241102 and NIH grants P50 HG 002790.</p>
    </sec>
  </ack>
  <ref-list>
    <ref id="B1">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ashburner</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Ball</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Blake</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Botstein</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Butler</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Cherry</surname>
            <given-names>JM</given-names>
          </name>
          <name>
            <surname>Davis</surname>
            <given-names>AP</given-names>
          </name>
          <name>
            <surname>Dolinski</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Dwight</surname>
            <given-names>SS</given-names>
          </name>
          <name>
            <surname>Eppig</surname>
            <given-names>JT</given-names>
          </name>
          <name>
            <surname>Harris</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Hill</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Issel-Tarver</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Kasarskis</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Lewis</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Matese</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Richardson</surname>
            <given-names>JE</given-names>
          </name>
          <name>
            <surname>Ringwald</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Rubin</surname>
            <given-names>GM</given-names>
          </name>
          <name>
            <surname>Sherlock</surname>
            <given-names>G</given-names>
          </name>
        </person-group>
        <article-title>Gene Ontology: tool for the unification of biology</article-title>
        <source>Nature Genetics</source>
        <year>2000</year>
        <volume>25</volume>
        <fpage>25</fpage>
        <lpage>29</lpage>
        <pub-id pub-id-type="pmid">10802651</pub-id>
        <pub-id pub-id-type="doi">10.1038/75556</pub-id>
      </citation>
    </ref>
    <ref id="B2">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ogata</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Goto</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Sato</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Fujibuchi</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Bono</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Kanehisa</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>KEGG: Kyoto Encyclopedia of Genes and Genomes</article-title>
        <source>Nucleic Acids Research</source>
        <year>1999</year>
        <volume>27</volume>
        <fpage>29</fpage>
        <lpage>34</lpage>
        <pub-id pub-id-type="pmid">9847135</pub-id>
        <pub-id pub-id-type="doi">10.1093/nar/27.1.29</pub-id>
      </citation>
    </ref>
    <ref id="B3">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Sonnhammer</surname>
            <given-names>EL</given-names>
          </name>
          <name>
            <surname>Eddy</surname>
            <given-names>SR</given-names>
          </name>
          <name>
            <surname>R</surname>
            <given-names>D</given-names>
          </name>
        </person-group>
        <article-title>Pfam: a comprehensive database of protein domain families based on seed alignments</article-title>
        <source>Proteins</source>
        <year>1997</year>
        <volume>28</volume>
        <fpage>405</fpage>
        <lpage>420</lpage>
        <pub-id pub-id-type="pmid">9223186</pub-id>
        <pub-id pub-id-type="doi">10.1002/(SICI)1097-0134(199707)28:3&lt;405::AID-PROT10&gt;3.0.CO;2-L</pub-id>
      </citation>
    </ref>
    <ref id="B4">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Volsky</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>PAGE: Parametric Analysis of Gene Set Enrichment</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>144</fpage>
        <pub-id pub-id-type="pmid">15941488</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-144</pub-id>
      </citation>
    </ref>
    <ref id="B5">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Berriz</surname>
            <given-names>GF</given-names>
          </name>
          <name>
            <surname>King</surname>
            <given-names>OD</given-names>
          </name>
          <name>
            <surname>Bryant</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Sander</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>P</surname>
            <given-names>RF</given-names>
          </name>
        </person-group>
        <article-title>Characterizing gene sets with FuncAssociate</article-title>
        <source>Bioinformatics</source>
        <year>2003</year>
        <volume>19</volume>
        <fpage>2502</fpage>
        <lpage>2504</lpage>
        <pub-id pub-id-type="pmid">14668247</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg363</pub-id>
      </citation>
    </ref>
    <ref id="B6">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hosack</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Dennis</surname>
            <given-names>GJ</given-names>
          </name>
          <name>
            <surname>Sherman</surname>
            <given-names>BT</given-names>
          </name>
          <name>
            <surname>Lane</surname>
            <given-names>HC</given-names>
          </name>
          <name>
            <surname>Lempicki</surname>
            <given-names>RA</given-names>
          </name>
        </person-group>
        <article-title>Identifying biological themes within lists of genes with EASE</article-title>
        <source>Genome Biology</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>R70</fpage>
        <pub-id pub-id-type="pmid">14519205</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2003-4-10-r70</pub-id>
      </citation>
    </ref>
    <ref id="B7">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Doniger</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Salomonis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Dahlquist</surname>
            <given-names>KD</given-names>
          </name>
          <name>
            <surname>Vranizan</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Lawlor</surname>
            <given-names>SC</given-names>
          </name>
          <name>
            <surname>Conklin</surname>
            <given-names>BR</given-names>
          </name>
        </person-group>
        <article-title>MAPPFinder: using Gene Ontology and GenMAPP to create a global gene-expression profile from microarray data</article-title>
        <source>Genome Biology</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>R7</fpage>
        <pub-id pub-id-type="pmid">12540299</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2003-4-1-r7</pub-id>
      </citation>
    </ref>
    <ref id="B8">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kim</surname>
            <given-names>CC</given-names>
          </name>
          <name>
            <surname>Falkow</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Significance analysis of lexical bias in microarray data</article-title>
        <source>Genome Biology</source>
        <year>2003</year>
        <volume>4</volume>
        <fpage>12</fpage>
        <pub-id pub-id-type="doi">10.1186/gb-2003-4-2-r12</pub-id>
      </citation>
    </ref>
    <ref id="B9">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Drǎghici</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Khatri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Martins</surname>
            <given-names>RP</given-names>
          </name>
          <name>
            <surname>Ostermeier</surname>
            <given-names>GC</given-names>
          </name>
          <name>
            <surname>Krawetz</surname>
            <given-names>SA</given-names>
          </name>
        </person-group>
        <article-title>Global functional profiling of gene expression</article-title>
        <source>Genomics</source>
        <year>2002</year>
        <volume>81</volume>
        <fpage>98</fpage>
        <lpage>104</lpage>
        <pub-id pub-id-type="doi">10.1016/S0888-7543(02)00021-6</pub-id>
      </citation>
    </ref>
    <ref id="B10">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Al-Shahrour</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Díaz-Uriarte</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Dopazo</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>FatiGo: a web tool for finding significant associations of Gene Ontology terms with groups of genes</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>578</fpage>
        <lpage>580</lpage>
        <pub-id pub-id-type="pmid">14990455</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg455</pub-id>
      </citation>
    </ref>
    <ref id="B11">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Beißbarth</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Speed</surname>
            <given-names>TP</given-names>
          </name>
        </person-group>
        <article-title>GOstat: find statistically overrepresented Gene Ontologies within a group of genes</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>1464</fpage>
        <lpage>1465</lpage>
        <pub-id pub-id-type="pmid">14962934</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bth088</pub-id>
      </citation>
    </ref>
    <ref id="B12">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Khatri</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Drǎghici</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Ontologcal analysis of gene expression data: current tools, limitations and open problems</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>3587</fpage>
        <lpage>3595</lpage>
        <pub-id pub-id-type="pmid">15994189</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti565</pub-id>
      </citation>
    </ref>
    <ref id="B13">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Lindgren</surname>
            <given-names>CM</given-names>
          </name>
          <name>
            <surname>Eriksson</surname>
            <given-names>KF</given-names>
          </name>
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Sihag</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Lehar</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Puigserver</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Carlsson</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Ridderstråle</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Laurila</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Houstis</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Daly</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Patterson</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Spiegelman</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Hirschhorn</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>Altshuler</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Groop</surname>
            <given-names>LC</given-names>
          </name>
        </person-group>
        <article-title>PGC-1<italic>α</italic>-responsive genes involved in oxidative phosphorylaton are coordinately downregulated in human diabetes</article-title>
        <source>Nature Genetics</source>
        <year>2003</year>
        <volume>34</volume>
        <fpage>267</fpage>
        <lpage>273</lpage>
        <pub-id pub-id-type="pmid">12808457</pub-id>
        <pub-id pub-id-type="doi">10.1038/ng1180</pub-id>
      </citation>
    </ref>
    <ref id="B14">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Subramanian</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Tamayo</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Mootha</surname>
            <given-names>VK</given-names>
          </name>
          <name>
            <surname>Mukherjee</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ebert</surname>
            <given-names>BL</given-names>
          </name>
          <name>
            <surname>Gillette</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Paulovich</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Pomeroy</surname>
            <given-names>SL</given-names>
          </name>
          <name>
            <surname>Golub</surname>
            <given-names>TR</given-names>
          </name>
          <name>
            <surname>Lander</surname>
            <given-names>ES</given-names>
          </name>
          <name>
            <surname>Mesirov</surname>
            <given-names>JP</given-names>
          </name>
        </person-group>
        <article-title>Gene set enrichment analysis: A knowledge-based approach for interpreting genome-wide expression profiles</article-title>
        <source>Proceedings of the National Academy of Sciences of the United States of America</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>15545</fpage>
        <lpage>15550</lpage>
        <pub-id pub-id-type="pmid">16199517</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.0506580102</pub-id>
      </citation>
    </ref>
    <ref id="B15">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tian</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Greenberg</surname>
            <given-names>SA</given-names>
          </name>
          <name>
            <surname>Kong</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Altschuler</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kohane</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
        </person-group>
        <article-title>Discovering statistically significant pathways in expression profiling studies</article-title>
        <source>Proceedings of the National Academy of Sciences of the United States of America</source>
        <year>2005</year>
        <volume>102</volume>
        <fpage>13544</fpage>
        <lpage>13549</lpage>
        <pub-id pub-id-type="pmid">16174746</pub-id>
        <pub-id pub-id-type="doi">10.1073/pnas.0506577102</pub-id>
      </citation>
    </ref>
    <ref id="B16">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goeman</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Bühlmann</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Analyzing gene expression data in terms of gene sets: methodological issues</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>980</fpage>
        <lpage>987</lpage>
        <pub-id pub-id-type="pmid">17303618</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm051</pub-id>
      </citation>
    </ref>
    <ref id="B17">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Efron</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tibshirani</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>On testing the significance of sets of genes</article-title>
        <source>The Annals of Applied Statistics</source>
        <year>2007</year>
        <volume>1</volume>
        <fpage>107</fpage>
        <lpage>129</lpage>
        <pub-id pub-id-type="doi">10.1214/07-AOAS101</pub-id>
      </citation>
    </ref>
    <ref id="B18">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Pavlidis</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Qin</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Arango</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Mann</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Sibille</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Using the Gene Ontology for Microarray Data Mining: A Comparison of MEthods and Application to Age Effects in Human Prefrontal Cortex</article-title>
        <source>Neurochemical Research</source>
        <year>2004</year>
        <volume>29</volume>
        <fpage>1213</fpage>
        <lpage>1222</lpage>
        <pub-id pub-id-type="pmid">15176478</pub-id>
        <pub-id pub-id-type="doi">10.1023/B:NERE.0000023608.29741.45</pub-id>
      </citation>
    </ref>
    <ref id="B19">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Jiang</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Gentleman</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Extensions to gene set enrichment</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>306</fpage>
        <lpage>313</lpage>
        <pub-id pub-id-type="pmid">17127676</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl599</pub-id>
      </citation>
    </ref>
    <ref id="B20">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Newton</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Quintana</surname>
            <given-names>FA</given-names>
          </name>
          <name>
            <surname>den Boon</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Sengupta</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Ahlquist</surname>
            <given-names>P</given-names>
          </name>
        </person-group>
        <article-title>Random-set methods identify distinct aspects of the enrichment signal in gene-set analysis</article-title>
        <source>The Annals of Applied Statistics</source>
        <year>2007</year>
        <volume>1</volume>
        <fpage>85</fpage>
        <lpage>106</lpage>
        <pub-id pub-id-type="doi">10.1214/07-AOAS104</pub-id>
      </citation>
    </ref>
    <ref id="B21">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Barry</surname>
            <given-names>WT</given-names>
          </name>
          <name>
            <surname>Nobel</surname>
            <given-names>AB</given-names>
          </name>
          <name>
            <surname>Wright</surname>
            <given-names>FA</given-names>
          </name>
        </person-group>
        <article-title>Significance analysis of functional categories in gene expression studies: a structured permutation approach</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>1943</fpage>
        <lpage>1949</lpage>
        <pub-id pub-id-type="pmid">15647293</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti260</pub-id>
      </citation>
    </ref>
    <ref id="B22">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tomfohr</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kepler</surname>
            <given-names>TB</given-names>
          </name>
        </person-group>
        <article-title>Pathway level analysis of gene expression using singular value decomposition</article-title>
        <source>BMC Bioinformatics</source>
        <year>2005</year>
        <volume>6</volume>
        <fpage>225</fpage>
        <pub-id pub-id-type="pmid">16156896</pub-id>
        <pub-id pub-id-type="doi">10.1186/1471-2105-6-225</pub-id>
      </citation>
    </ref>
    <ref id="B23">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goeman</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Geer</surname>
            <given-names>SA van de</given-names>
          </name>
          <name>
            <surname>Kort</surname>
            <given-names>FD</given-names>
          </name>
          <name>
            <surname>van Houwelingen</surname>
            <given-names>HC</given-names>
          </name>
        </person-group>
        <article-title>A global test for groups of genes: testing association with a clinical outcome</article-title>
        <source>Bioinformatics</source>
        <year>2004</year>
        <volume>20</volume>
        <fpage>93</fpage>
        <lpage>99</lpage>
        <pub-id pub-id-type="pmid">14693814</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btg382</pub-id>
      </citation>
    </ref>
    <ref id="B24">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Goeman</surname>
            <given-names>JJ</given-names>
          </name>
          <name>
            <surname>Oosting</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Cleton-Jansen</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Anninga</surname>
            <given-names>JK</given-names>
          </name>
          <name>
            <surname>van Houwelingen</surname>
            <given-names>HC</given-names>
          </name>
        </person-group>
        <article-title>Testing association of a pathway with survival using gene expression data</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <fpage>1950</fpage>
        <lpage>1957</lpage>
        <pub-id pub-id-type="pmid">15657105</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti267</pub-id>
      </citation>
    </ref>
    <ref id="B25">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ye</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Eskin</surname>
            <given-names>E</given-names>
          </name>
        </person-group>
        <article-title>Discovering tightly regulated and differeitially expressed gene sets in whole genome expression data</article-title>
        <source>Bioinformaitcs</source>
        <year>2006</year>
        <volume>23</volume>
        <fpage>e84</fpage>
        <lpage>e90</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btl315</pub-id>
      </citation>
    </ref>
    <ref id="B26">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wei</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>Nonparametric pathway-based regression models for analysis of genomic data</article-title>
        <source>Biostatistics</source>
        <year>2007</year>
        <volume>8</volume>
        <fpage>265</fpage>
        <lpage>284</lpage>
        <pub-id pub-id-type="pmid">16772399</pub-id>
        <pub-id pub-id-type="doi">10.1093/biostatistics/kxl007</pub-id>
      </citation>
    </ref>
    <ref id="B27">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Levine</surname>
            <given-names>DM</given-names>
          </name>
          <name>
            <surname>Haynor</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Castle</surname>
            <given-names>JC</given-names>
          </name>
          <name>
            <surname>Stepaniants</surname>
            <given-names>SB</given-names>
          </name>
          <name>
            <surname>Pellegrini</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Mao</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Johnson</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>PAGE: Parametric Analysis of Gene Set Enrichment</article-title>
        <source>Genome Biology</source>
        <year>2006</year>
        <volume>7</volume>
        <fpage>R93</fpage>
        <pub-id pub-id-type="pmid">17044931</pub-id>
        <pub-id pub-id-type="doi">10.1186/gb-2006-7-10-r93</pub-id>
      </citation>
    </ref>
    <ref id="B28">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wei</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>A Markov random field model for network-based analysis of genomic data</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>1537</fpage>
        <lpage>1544</lpage>
        <pub-id pub-id-type="pmid">17483504</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm129</pub-id>
      </citation>
    </ref>
    <ref id="B29">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Liu</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Liberzon</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kong</surname>
            <given-names>SW</given-names>
          </name>
          <name>
            <surname>Lai</surname>
            <given-names>WR</given-names>
          </name>
          <name>
            <surname>Park</surname>
            <given-names>PJ</given-names>
          </name>
          <name>
            <surname>Kohane</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Kasif</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Network-Based Analysis of Affected Biological Processes in Type 2 Diabetes Models</article-title>
        <source>PLoS Genetics</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>e96</fpage>
        <pub-id pub-id-type="pmid">17571924</pub-id>
        <pub-id pub-id-type="doi">10.1371/journal.pgen.0030096</pub-id>
      </citation>
    </ref>
    <ref id="B30">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rahnenführer</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Domingues</surname>
            <given-names>FS</given-names>
          </name>
          <name>
            <surname>Maydt</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Lengauer</surname>
            <given-names>T</given-names>
          </name>
        </person-group>
        <article-title>Calculating the Statistical Significance of Changes in Pathway Activity From Gene Expression Data</article-title>
        <source>Statistical Applications in Genetics and Molecular Biology</source>
        <year>2004</year>
        <volume>3</volume>
        <fpage>16</fpage>
        <pub-id pub-id-type="doi">10.2202/1544-6115.1055</pub-id>
      </citation>
    </ref>
    <ref id="B31">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nacu</surname>
            <given-names>c</given-names>
          </name>
          <name>
            <surname>Critchley-Thorne</surname>
            <given-names>R</given-names>
          </name>
          <name>
            <surname>Lee</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Holmes</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Gene expression network analysis and applications to immunology</article-title>
        <source>Bioinformatics</source>
        <year>2007</year>
        <volume>23</volume>
        <fpage>850</fpage>
        <lpage>858</lpage>
        <pub-id pub-id-type="pmid">17267429</pub-id>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btm019</pub-id>
      </citation>
    </ref>
    <ref id="B32">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Hoh</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Wille</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Ott</surname>
            <given-names>J</given-names>
          </name>
        </person-group>
        <article-title>Trimming, weighting, and grouping SNPs in human case-control association studies</article-title>
        <source>Genome Research</source>
        <year>2001</year>
        <volume>11</volume>
        <fpage>2115</fpage>
        <lpage>2119</lpage>
        <pub-id pub-id-type="pmid">11731502</pub-id>
        <pub-id pub-id-type="doi">10.1101/gr.204001</pub-id>
      </citation>
    </ref>
    <ref id="B33">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ge</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Dudoit</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>P</surname>
            <given-names>ST</given-names>
          </name>
        </person-group>
        <article-title>Resampling-based multiple testing for microarray data analysis</article-title>
        <source>Test</source>
        <year>2003</year>
        <volume>12</volume>
        <fpage>1</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1007/BF02595811</pub-id>
      </citation>
    </ref>
    <ref id="B34">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Storey</surname>
            <given-names>JD</given-names>
          </name>
        </person-group>
        <article-title>A direct approach to false discovery rates</article-title>
        <source>Journal of the Royal Statistical Society, Series B</source>
        <year>2002</year>
        <volume>64</volume>
        <fpage>479</fpage>
        <lpage>498</lpage>
        <pub-id pub-id-type="doi">10.1111/1467-9868.00346</pub-id>
      </citation>
    </ref>
    <ref id="B35">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vogelstein</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Lane</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Levine</surname>
            <given-names>AJ</given-names>
          </name>
        </person-group>
        <article-title>Surfing the p53 network</article-title>
        <source>Nature</source>
        <year>2002</year>
        <volume>408</volume>
        <fpage>307</fpage>
        <lpage>310</lpage>
        <pub-id pub-id-type="pmid">11099028</pub-id>
        <pub-id pub-id-type="doi">10.1038/35042675</pub-id>
      </citation>
    </ref>
    <ref id="B36">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Giono</surname>
            <given-names>LE</given-names>
          </name>
          <name>
            <surname>Manfredi</surname>
            <given-names>JJ</given-names>
          </name>
        </person-group>
        <article-title>The p53 Tumor Suppressor Participates in Multiple Cell Cycle Checkpoints</article-title>
        <source>Journal of Cellular Physiology</source>
        <year>2006</year>
        <volume>209</volume>
        <fpage>13</fpage>
        <lpage>20</lpage>
        <pub-id pub-id-type="pmid">16741928</pub-id>
        <pub-id pub-id-type="doi">10.1002/jcp.20689</pub-id>
      </citation>
    </ref>
    <ref id="B37">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Dbaibo</surname>
            <given-names>GS</given-names>
          </name>
          <name>
            <surname>Pushkareva</surname>
            <given-names>MY</given-names>
          </name>
          <name>
            <surname>Rachid</surname>
            <given-names>RA</given-names>
          </name>
          <name>
            <surname>Alter</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Smyth</surname>
            <given-names>MJ</given-names>
          </name>
          <name>
            <surname>Obeid</surname>
            <given-names>LM</given-names>
          </name>
          <name>
            <surname>Hannun</surname>
            <given-names>YA</given-names>
          </name>
        </person-group>
        <article-title>p53-dependent Ceramide Response to Genotoxic Stress</article-title>
        <source>The Journal of Clinical Investigation</source>
        <year>1998</year>
        <volume>102</volume>
        <fpage>329</fpage>
        <lpage>339</lpage>
        <pub-id pub-id-type="pmid">9664074</pub-id>
        <pub-id pub-id-type="doi">10.1172/JCI1180</pub-id>
      </citation>
    </ref>
    <ref id="B38">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Raffo</surname>
            <given-names>AJ</given-names>
          </name>
          <name>
            <surname>Drew</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Mao</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Tran</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Petrylak</surname>
            <given-names>DP</given-names>
          </name>
          <name>
            <surname>Fine</surname>
            <given-names>RL</given-names>
          </name>
        </person-group>
        <article-title>Fas-Mediated Apoptosis Is Dependent on Wild-Type p53 Status in Human Cancer Cells Expressing a Temperature-Sensitive p53 Mutant Alanine-143</article-title>
        <source>Cancer Research</source>
        <year>2003</year>
        <volume>63</volume>
        <fpage>1527</fpage>
        <lpage>1533</lpage>
        <pub-id pub-id-type="pmid">12670900</pub-id>
      </citation>
    </ref>
    <ref id="B39">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Aloyz</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Bamji</surname>
            <given-names>SX</given-names>
          </name>
          <name>
            <surname>Pozniak</surname>
            <given-names>CD</given-names>
          </name>
          <name>
            <surname>Toma</surname>
            <given-names>JG</given-names>
          </name>
          <name>
            <surname>Atwal</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Kaplan</surname>
            <given-names>DR</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>FD</given-names>
          </name>
        </person-group>
        <article-title>P53 Is Essential For Developmental Neuron Death as Regulated by the TrkA and p75 Neurotrophin Receptors</article-title>
        <source>The Journal of Cell Biology</source>
        <year>1998</year>
        <volume>143</volume>
        <fpage>1691</fpage>
        <lpage>1703</lpage>
        <pub-id pub-id-type="pmid">9852160</pub-id>
        <pub-id pub-id-type="doi">10.1083/jcb.143.6.1691</pub-id>
      </citation>
    </ref>
    <ref id="B40">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wei</surname>
            <given-names>Q</given-names>
          </name>
        </person-group>
        <article-title>Pitx2a binds to human papillomavirus type 18 E6 protein and inhibits E6-mediated P53 degradation in HeLa cells</article-title>
        <source>The Journal of Biological Chemistry</source>
        <year>2005</year>
        <volume>280</volume>
        <fpage>37790</fpage>
        <lpage>37797</lpage>
        <pub-id pub-id-type="pmid">16129685</pub-id>
        <pub-id pub-id-type="doi">10.1074/jbc.M502974200</pub-id>
      </citation>
    </ref>
    <ref id="B41">
      <citation citation-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Becker</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Knapp</surname>
            <given-names>M</given-names>
          </name>
        </person-group>
        <article-title>A Powerful Strategy to Account for Multiple Testing in the Context of Haplotype Analysis</article-title>
        <source>American Journal of Human Genetics</source>
        <year>2004</year>
        <volume>75</volume>
        <fpage>561</fpage>
        <lpage>570</lpage>
        <pub-id pub-id-type="pmid">15290652</pub-id>
        <pub-id pub-id-type="doi">10.1086/424390</pub-id>
      </citation>
    </ref>
  </ref-list>
</back>
