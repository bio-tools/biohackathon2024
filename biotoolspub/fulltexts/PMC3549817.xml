<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3549817</article-id>
    <article-id pub-id-type="publisher-id">1471-2105-14-S2-S1</article-id>
    <article-id pub-id-type="doi">10.1186/1471-2105-14-S2-S1</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Proceedings</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Shape and secondary structure prediction for ncRNAs including pseudoknots based on linear SVM</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Achawanantakun</surname>
          <given-names>Rujira</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>rujiraa@gmail.com</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A2">
        <name>
          <surname>Sun</surname>
          <given-names>Yanni</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>yannisun@cse.msu.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Computer Science and Engineering, Michigan State University, Michigan, USA</aff>
    <pub-date pub-type="collection">
      <year>2013</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>21</day>
      <month>1</month>
      <year>2013</year>
    </pub-date>
    <volume>14</volume>
    <issue>Suppl 2</issue>
    <supplement>
      <named-content content-type="supplement-title">Selected articles from the Eleventh Asia Pacific Bioinformatics Conference (APBC 2013): Bioinformatics</named-content>
      <named-content content-type="supplement-sponsor">Publication of this supplement was funded by the authors.</named-content>
    </supplement>
    <fpage>S1</fpage>
    <lpage>S1</lpage>
    <permissions>
      <copyright-statement>Copyright ©2013 Achawanantakun and Sun; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2013</copyright-year>
      <copyright-holder>Achawanantakun and Sun; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an open access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1471-2105/14/S2/S1"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Accurate secondary structure prediction provides important information to undefirstafinding the tertiary structures and thus the functions of ncRNAs. However, the accuracy of the native structure derivation of ncRNAs is still not satisfactory, especially on sequences containing pseudoknots. It is recently shown that using the abstract shapes, which retain adjacency and nesting of structural features but disregard the length details of helix and loop regions, can improve the performance of structure prediction. In this work, we use SVM-based feature selection to derive the consensus abstract shape of homologous ncRNAs and apply the predicted shape to structure prediction including pseudoknots.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>Our approach was applied to predict shapes and secondary structures on hundreds of ncRNA data sets with and without psuedoknots. The experimental results show that we can achieve 18% higher accuracy in shape prediction than the state-of-the-art consensus shape prediction tools. Using predicted shapes in structure prediction allows us to achieve approximate 29% higher sensitivity and 10% higher positive predictive value than other pseudoknot prediction tools.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p>Extensive analysis of RNA properties based on SVM allows us to identify important properties of sequences and structures related to their shapes. The combination of mass data analysis and SVM-based feature selection makes our approach a promising method for shape and structure prediction. The implemented tools, Knot Shape and Knot Structure are open source software and can be downloaded at: <ext-link ext-link-type="uri" xlink:href="http://www.cse.msu.edu/~achawana/KnotShape">http://www.cse.msu.edu/~achawana/KnotShape</ext-link>.</p>
      </sec>
    </abstract>
    <conference>
      <conf-date>21-24 January 2013</conf-date>
      <conf-name>The Eleventh Asia Pacific Bioinformatics Conference (APBC 2013)</conf-name>
      <conf-loc>Vancouver, Canada</conf-loc>
    </conference>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Noncoding RNAs (ncRNAs), which are transcribed but not translated into proteins, play diverse and important biological functions in all living organisms [<xref ref-type="bibr" rid="B1">1</xref>]. Many types of ncRNAs perform their functions through both their sequences and secondary structures, which are defined by the interacting base pairs. Of the characterized secondary structures of ncRNAs, Watson-Crick (C-G and A-U) and wobble base p airs (G-U) are most commonly seen. As knowing the secondary structure provides important information to undefirstafinding the tertiary structures and thus the functions of ncRNAs, deriving the secondary structures of ncRNAs remains an important research topic in RNA informatics.</p>
    <p>Pseudoknot is an important structural motif in secondary structures of many types of ncRNAs. Formally, a pseudoknot occurs when an RNA has two base pairs, <italic>i </italic>- <italic>j </italic>and <italic>i' </italic>- <italic>j'</italic>, such that <italic>i </italic>&lt;<italic>i' </italic>&lt;<italic>j </italic>&lt;<italic>j'</italic>. Psuedoknots are known to play important functions in telomerase RNA, tmRNA, rRNA, some riboswitch, some protein-biding RNA, Viral ribosomal frameshifting signals, etc [<xref ref-type="bibr" rid="B2">2</xref>]. There are 26,704 sequences in 71 ncRNA seed families of Rfam 10.0 [<xref ref-type="bibr" rid="B3">3</xref>] containing pseudoknots. With advances in sequencing technologies and structure prediction, more pseudoknot structures are expected to be disclosed.</p>
    <p>Many computational methods have been used to determine the native structure of ncRNAs. A native structure is a structure that forms conformationally folding in native state before forming the tertiary structure. The gap between the free energy of the native state and other non-native structures is often small [<xref ref-type="bibr" rid="B4">4</xref>]. Thus, misfolded conformations can form with high probabilities [<xref ref-type="bibr" rid="B5">5</xref>]. For a review of available tools, please see [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B7">7</xref>].</p>
    <p>Although there is promising progress, finding the native secondary structure is still difficult. In particular, identifying the pseudoknot, an important structural motif in many types of ncRNAs, poses a great challenge for existing methods. Predicting the minimum free energy secondary structure that includes pseudoknots has been proven to be NP-hard [<xref ref-type="bibr" rid="B8">8</xref>]. One recent attempt is to first predict the abstract shapes (or shapes for short), which retain adjacency and nesting of structural features but disregard the length details of helix and loop regions [<xref ref-type="bibr" rid="B9">9</xref>]. The predicted shape will then be used to guide structure prediction. The idea of abstract shapes has long been used to characterize different types of structures. For example, most tRNAs have the clover-leaf structure; most pre-miRNAs have the stem-loop structure; many types of pseudoknots have an H-type structure.</p>
    <p>While the size of the folding space of an RNA sequence increases exponentially with the sequence length [<xref ref-type="bibr" rid="B10">10</xref>], many possible folding only differ in the details of the loop and helix regions and hence have the same abstract shape. Previous analysis shows that the space of the abstract shapes is significantly smaller than the complete folding space [<xref ref-type="bibr" rid="B11">11</xref>]. Knowing the abstract shape can significantly reduce the search space for structure prediction tools and improves the accuracy of structure prediction [<xref ref-type="bibr" rid="B9">9</xref>,<xref ref-type="bibr" rid="B12">12</xref>]. The utilities of abstract shapes have been demonstrated in a number of recent publications. The Giegerich group used abstract shapes in comparative structure prediction in pseudoknot-free sequences [<xref ref-type="bibr" rid="B12">12</xref>]. People use shapes to aid miRNA pre-cursor prediction in large-scale studies [<xref ref-type="bibr" rid="B13">13</xref>,<xref ref-type="bibr" rid="B14">14</xref>]. Furthermore, shapes are used to index fast-expafinding ncRNA families in Rfam [<xref ref-type="bibr" rid="B3">3</xref>] and lead to efficient known ncRNA search [<xref ref-type="bibr" rid="B15">15</xref>].</p>
    <p>Previous work focused on shape derivation and usage for pseudoknot-free ncRNAs. There is a lack of studies of the usage of shapes in pseudoknot structure prediction. In this work, we predict the consensus shape of a group of homologous ncRNAs that may contain pseudoknots. In addition, we develop a program that uses the consensus shape for consensus pseudoknot structure prediction. A majority of existing pseudoknot structure prediction tools often have topology restrictions such as H-type, recursive H-type [<xref ref-type="bibr" rid="B16">16</xref>-<xref ref-type="bibr" rid="B19">19</xref>], kissing hairpin, or complexity levels of pseudoknot using genus numbers [<xref ref-type="bibr" rid="B20">20</xref>]. Therefore, using the predicted abstract shapes of input sequences can help remove the topology restriction and leads to more general and practical pseudoknot structure prediction tools. Compared with existing tools, our tool has the following properties:</p>
    <p>• While most existing shape prediction tools use a single sequence as input, we conduct comparative shape prediction on homologous ncRNAs that might contain pseudoknots. Experiments show that comparative structure or shape prediction, which derives the consensus structure or shape from a group of homologous sequences, can achieve better accuracy than using a single sequence [<xref ref-type="bibr" rid="B6">6</xref>,<xref ref-type="bibr" rid="B12">12</xref>,<xref ref-type="bibr" rid="B21">21</xref>].</p>
    <p>• We can predict the abstract shapes of both pseudoknot-free and pseudoknot-containing sequences.</p>
    <p>• Current tools use the shape probability [<xref ref-type="bibr" rid="B22">22</xref>] or the sum of energies of structures to rank shapes. We use multiple features by combining well-studied feature ranking methods and the support vector machine (SVM) method.</p>
    <p>• We demonstrate the usage of the shape by applying it to pseudoknot structure prediction. The whole software package can be directly used to derive the consensus secondary structure of homologous ncRNAs. The consensus shape prediction tool named KnotShape and the corresponding consensus pseudoknot prediction tool named KnotStructure are publicly available at our website.</p>
    <p>We tested our software on hundreds of RNA sequence sets. The experimental results show that we can achieve 18% higher accuracy than the state-of-the-art consensus shape prediction tools on pseudoknot free sequences. For pseudoknot-containing sequences, we achieve approximate 29% higher sensitivity and 10% higher positive predictive value in structure prediction than similar tools.</p>
    <sec>
      <title>Related work</title>
      <p>Computational structure prediction can be divided into de novo structure prediction and comparative structure prediction, which derive structures from a single sequence and multiple homologous ncRNAs respectively. As our method is to derive the consensus shape and structure of homologous ncRNAs, we briefly introduce related work in comparative ncRNA structure derivation. There are three general approaches for structure derivation from multiple sequences: simultaneously align and fold, align-then-fold, and fold-then-align. It is computationally expensive to simultaneously align and fold pseudoknot structures. The performance of the align-then-fold pseudoknot prediction heavily depends on the quality of the alignment. Usually multiple sequence alignment (MSA) tools such as ClustalW [<xref ref-type="bibr" rid="B23">23</xref>] are used to generate the alignment as the input to the folding tool. However, common structures can be missed due to misalignment between sequences lacking significant similarity [<xref ref-type="bibr" rid="B24">24</xref>]. In this work, we design a pseudoknot prediction tool using the fold-then-align strategy that does not require an alignment as input. Tools based on fold-then-align use a de novo folding tool to construct a small but representative sample of the folding space, which consists of the predicted optimal and sub-optimal structures. Structures from the folding space are chosen to maximize the structural and sequence similarity.</p>
      <p>A number of software packages exist to predict the abstract shape for a single sequence. The sum of energies or the accumulated Boltzmann probabilities of all structures within a shape have been used as main features for shape prediction. The latter is often referred to as the shape probability. Usually the shapes with small sum of energies or high shape probabilities are more likely to be the correct shapes. It is claimed in RapidShapes [<xref ref-type="bibr" rid="B22">22</xref>] that using shape probabilities has superior performance over free energy-based approach because of its independence on sequence length and base composition. However, exact computation of the shape probability incurs exponential computational cost to the sequence length [<xref ref-type="bibr" rid="B22">22</xref>]. Thus, various heuristics or restrictions [<xref ref-type="bibr" rid="B25">25</xref>,<xref ref-type="bibr" rid="B26">26</xref>] have been adopted for fast shape probability computation.</p>
      <p>RNAcast [<xref ref-type="bibr" rid="B12">12</xref>] derives the consensus shape from homologous pseudoknot-free sequences based on the fold-then-align strategy. Structures are grouped based on their shapes and shapes are ranked by sum of free energies of structures within the shape in ascending order. The first-ranked shape is presented as the consensus shape. The consensus structure is derived from the lowest free energy structures of each sequence within the shape.</p>
    </sec>
  </sec>
  <sec sec-type="methods">
    <title>Methods</title>
    <sec>
      <title>RNA structures and their representations</title>
      <sec>
        <title>RNA structures and pseudoknots</title>
        <p>RNA molecules fold into complex three dimensional structures by nitrogenous bases that are connected via hydrogen bonds. The secondary structure of an ncRNA is defined by the interacting base pairs. Some RNA molecules fold into pseudoknot structures by paring bases in loop regions with bases outside the stem loop (Figure <xref ref-type="fig" rid="F1">1a</xref>).</p>
        <fig id="F1" position="float">
          <label>Figure 1</label>
          <caption>
            <p><bold>Structure of an RNA pseudoknot</bold>. (a-c) show the secondary structure, arc-based representation, and dot-bracket notation of mouse mammary tumor virus (MMTV) H-type pseudoknot with PDB code <ext-link ext-link-type="pdb" xlink:href="1RNK">1RNK</ext-link>. The bases in stacking regions are colored with blue while the unpaired bases are colored with black.</p>
          </caption>
          <graphic xlink:href="1471-2105-14-S2-S1-1"/>
        </fig>
        <p>In this work, two types of ncRNA secondary structure representations are used. The first type is the arc-based representation, where nucleotides and hydrogen bonds are represented by vertices and arcs, respectively (Figure <xref ref-type="fig" rid="F1">1b</xref>). For pseudoknot-free secondary structures, all arcs are either nested or in parallel. Crossover arcs indicate pseudoknots. The second type is based on dot-bracket notation, where '.' represents unpaired bases and matching parenthesis '(' and ')' indicate base-pairing nucleotides. Following the annotation of Rfam [<xref ref-type="bibr" rid="B3">3</xref>], we use an extended dot-bracket notation to represent pseudoknot structures. The base-pairing nucleotides forming pseudoknots are represented by upper-lower case character pairs, such as A..a or B..b, as shown in Figure <xref ref-type="fig" rid="F1">1c</xref>.</p>
      </sec>
      <sec>
        <title>Abstract shapes</title>
        <p>Abstract shapes were formally introduced by Giegerich et al. [<xref ref-type="bibr" rid="B9">9</xref>]. The folding space of a given RNA sequence is partitioned into different classes of structures, by means of abstracting from structural details. These classes are called abstract shapes, or shapes for short.</p>
        <p>An RNA secondary structure can be mapped to an abstract shape with different levels of abstraction [<xref ref-type="bibr" rid="B12">12</xref>]. In the abstract shape, details about the lengths of the loop and stacking regions are removed (see Figure <xref ref-type="fig" rid="F1">1</xref> for examples of stacking and loop regions). Stacking regions are represented by pairs of brackets and unpaired regions are represented by underscores.</p>
        <p>Pseudoknots are represented by pairs of upper-lower case characters. Figure <xref ref-type="fig" rid="F2">2</xref> presents examples of the abstract shapes of level 1, 3, and 5 of a pseudoknot-free structure and a pseudoknot. Level 5 represents the strongest abstraction and ignores all bulges, internal loops, and single-stranded regions. Level 3 adds the helix interruptions caused by bulges or internal loops. Level 1 only abstracts from loop and stack lengths while retains all single-stranded regions.</p>
        <fig id="F2" position="float">
          <label>Figure 2</label>
          <caption>
            <p><bold>Examples of abstract shapes in level 1, 3 and 5</bold>. (a) The abstract shapes of a pseudoknot-free structure. (b) The abstract shapes of a structure with a pseudoknot.</p>
          </caption>
          <graphic xlink:href="1471-2105-14-S2-S1-2"/>
        </fig>
      </sec>
    </sec>
    <sec>
      <title>Shape prediction</title>
      <p>In this section we describe KnotShape, a comparative shape prediction tool for homologous ncRNA sequences that allows pseudoknots. The task of shape prediction is to select the best representative shape for given homologous sequences. In order to identify the best shape, various features such as shape probability [<xref ref-type="bibr" rid="B22">22</xref>], sum of energies of all structures in this shape [<xref ref-type="bibr" rid="B12">12</xref>], and the rank sum score [<xref ref-type="bibr" rid="B12">12</xref>] are evaluated to rank shapes. It has not been systematically assessed whether combinations of multiple features can lead to better shape prediction. In this work, we incorporate Support Vector Machine (SVM) [<xref ref-type="bibr" rid="B27">27</xref>] and feature selection techniques to determine important features for shape identification. In addition, we adopted a machine learning-based scoring function to evaluate the qualities of shapes.</p>
      <p>The method contains two important components. The first one is the consensus shape prediction (Knot-Shape) and the second one is structure prediction using predicted shape as input (KnotStructure). We will first describe KnotShape, focusing on the feature construction and selection strategy. Then we will describe how to derive the consensus structure given the consensus shape.</p>
      <sec>
        <title>Notation</title>
        <p>Figure <xref ref-type="fig" rid="F3">3</xref> illustrates the mapping between sequences, structures, and shapes. The input is a set of homologous ncRNAs and the output is the predicted consensus shape. Notations used in this paper correspond to this mapping.</p>
        <fig id="F3" position="float">
          <label>Figure 3</label>
          <caption>
            <p><bold>The relationship between sequences, structures, and shapes</bold>.</p>
          </caption>
          <graphic xlink:href="1471-2105-14-S2-S1-3"/>
        </fig>
        <p>• The <italic>N </italic>homologous ncRNAs constitute the input sequence space. <italic>X<sub>i </sub></italic>represents the <italic>i</italic>th sequence.</p>
        <p>• Each sequence can be folded into different secondary structures. Let <italic>S<sup>i </sup></italic>represent the set of folded structures of the <italic>i</italic>th sequence <italic>X<sub>i</sub></italic>. The set of structures predicted from all <italic>N </italic>input sequences is the union of <italic>S<sup>i</sup></italic>: <italic>S </italic>= <italic>S</italic><sup>1 </sup>∪ <italic>S</italic><sup>2 </sup>∪ . . . ∪ <italic>S<sup>N</sup></italic>.</p>
        <p>• <inline-formula><mml:math id="M1" name="1471-2105-14-S2-S1-i1" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is the <italic>j</italic>th structure in the folding space of <italic>X<sub>i</sub></italic>. Its free energy is denoted by <inline-formula><mml:math id="M2" name="1471-2105-14-S2-S1-i2" overflow="scroll"><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>G</mml:mi><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:math></inline-formula>. For a sequence <italic>X<sub>i</sub></italic>, the minimum free energy MFE(<italic>X<sub>i</sub></italic>) is the lowest free energy among the energies of all predicted structures of <italic>X<sub>i</sub></italic>, i.e. <inline-formula><mml:math id="M3" name="1471-2105-14-S2-S1-i3" overflow="scroll"><mml:mrow><mml:mtext>MFE</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>j</mml:mi><mml:mo>≤</mml:mo><mml:mo>|</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msup><mml:mo>|</mml:mo></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>G</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mi>j</mml:mi><mml:mi>i</mml:mi></mml:msubsup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
        <p>• All structures in <italic>S </italic>can be classified into a set of abstract shapes. For a shape <italic>P</italic>, we record its associated sequences and structures. <italic>P.LX </italic>denotes the set of associated sequences, each of which can fold into a structure with shape <italic>P</italic>. <italic>P.LS </italic>denotes all structures with shape <italic>P</italic>.</p>
        <p>• <inline-formula><mml:math id="M4" name="1471-2105-14-S2-S1-i4" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover></mml:math></inline-formula> is the predicted shape of the given homologous sequences <italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>, .., <italic>X<sub>N</sub></italic>.</p>
        <p>In order to explore the large folding space of multiple homologous sequences, we use a de novo folding tool to output the optimal and sub-optimal structures within a given energy cutoff. This heuristic does not allow us to explore the complete folding space. Given the observation that the correct structure is usually close to the optimal structure, this heuristic works well in practice [<xref ref-type="bibr" rid="B28">28</xref>].</p>
      </sec>
      <sec>
        <title>Feature construction and selection</title>
        <p>Intuitively, the correct shape tends to possess the following properties. The correct shape should have high shape probability, meaning that a large number of structures can be classified into this shape. When we have multiple homologous sequences as input, the correct shape should be well-represented by all or a majority of the input sequences. Also, the ranking of the structure with the correct shape in the folding space of each sequence should be high. In addition, some structures with the correct shape have low thermodynamic energies. For the energy-related properties, various measurements can be introduced. For example, instead of using the sum of the energies of all structures within a shape, one can use the smallest energy. Furthermore, more complicated properties such as the sequence similarity for all sequences associated with a shape <italic>P </italic>and the structural similarity of structures associated with a shape <italic>P </italic>might contribute to the shape prediction too. These similarities can be quantified using different methods such as k-mers profiles, multiple sequence alignment scores, variation of base pairs and so on.</p>
        <p>It is not trivial to decide whether a single property is enough to choose the correct shape. If not, which combination of these properties can lead to the best shape prediction performance? In order to systematically choose a set of features (i.e. properties) for shape prediction, we use F-score [<xref ref-type="bibr" rid="B29">29</xref>] to measure the discrimination between a feature and its label. Given the feature vector <italic>x<sub>k</sub>, k </italic>= 1, .., <italic>m</italic>, the F-score of the <italic>i</italic>th feature is defined as:</p>
        <p>
          <disp-formula>
            <mml:math id="M5" name="1471-2105-14-S2-S1-i5" overflow="scroll">
              <mml:mrow>
                <mml:mi>F</mml:mi>
                <mml:mrow>
                  <mml:mo class="MathClass-open">(</mml:mo>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mo class="MathClass-close">)</mml:mo>
                </mml:mrow>
                <mml:mo class="MathClass-rel">≡</mml:mo>
                <mml:mfrac>
                  <mml:mrow>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">(</mml:mo>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mo class="MathClass-op">¯</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo class="MathClass-open">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mo class="MathClass-bin">+</mml:mo>
                                  </mml:mrow>
                                  <mml:mo class="MathClass-close">)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mo class="MathClass-op">¯</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo class="MathClass-bin">+</mml:mo>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">(</mml:mo>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mo class="MathClass-op">¯</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo class="MathClass-open">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mo class="MathClass-bin">-</mml:mo>
                                  </mml:mrow>
                                  <mml:mo class="MathClass-close">)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:msub>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mo class="MathClass-op">¯</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                            </mml:msub>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo class="MathClass-bin">+</mml:mo>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo class="MathClass-bin">-</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mo mathsize="big"> ∑</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo class="MathClass-rel">=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo class="MathClass-bin">+</mml:mo>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">(</mml:mo>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>¯</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo class="MathClass-punc">,</mml:mo>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo class="MathClass-open">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mo class="MathClass-bin">+</mml:mo>
                                  </mml:mrow>
                                  <mml:mo class="MathClass-close">)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>¯</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo class="MathClass-open">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mo class="MathClass-bin">+</mml:mo>
                                  </mml:mrow>
                                  <mml:mo class="MathClass-close">)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mo class="MathClass-bin">+</mml:mo>
                    <mml:mfrac>
                      <mml:mrow>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                          </mml:mrow>
                        </mml:msub>
                        <mml:mo class="MathClass-bin">-</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                    </mml:mfrac>
                    <mml:msubsup>
                      <mml:mrow>
                        <mml:mo mathsize="big"> ∑</mml:mo>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>i</mml:mi>
                        <mml:mo class="MathClass-rel">=</mml:mo>
                        <mml:mn>1</mml:mn>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:msub>
                          <mml:mrow>
                            <mml:mi>n</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                          </mml:mrow>
                        </mml:msub>
                      </mml:mrow>
                    </mml:msubsup>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">(</mml:mo>
                          <mml:mrow>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>¯</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>k</mml:mi>
                                <mml:mo class="MathClass-punc">,</mml:mo>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo class="MathClass-open">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mo class="MathClass-bin">-</mml:mo>
                                  </mml:mrow>
                                  <mml:mo class="MathClass-close">)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:msubsup>
                            <mml:mo class="MathClass-bin">-</mml:mo>
                            <mml:msubsup>
                              <mml:mrow>
                                <mml:mover accent="true">
                                  <mml:mrow>
                                    <mml:mi>x</mml:mi>
                                  </mml:mrow>
                                  <mml:mo>¯</mml:mo>
                                </mml:mover>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mi>i</mml:mi>
                              </mml:mrow>
                              <mml:mrow>
                                <mml:mrow>
                                  <mml:mo class="MathClass-open">(</mml:mo>
                                  <mml:mrow>
                                    <mml:mo class="MathClass-bin">-</mml:mo>
                                  </mml:mrow>
                                  <mml:mo class="MathClass-close">)</mml:mo>
                                </mml:mrow>
                              </mml:mrow>
                            </mml:msubsup>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">)</mml:mo>
                        </mml:mrow>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mn>2</mml:mn>
                      </mml:mrow>
                    </mml:msup>
                  </mml:mrow>
                </mml:mfrac>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>where <italic>n</italic><sub>+ </sub>and <italic>n</italic><sub>- </sub>are the numbers of positive and negative instances respectively. <inline-formula><mml:math id="M6" name="1471-2105-14-S2-S1-i6" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo class="MathClass-op">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula>, <inline-formula><mml:math id="M7" name="1471-2105-14-S2-S1-i7" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo class="MathClass-op">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mo class="MathClass-bin">+</mml:mo></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula>, and <inline-formula><mml:math id="M8" name="1471-2105-14-S2-S1-i8" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo class="MathClass-op">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> are the average values of the <italic>i</italic>th feature of the whole, positive labeled, and negative labeled data. <inline-formula><mml:math id="M9" name="1471-2105-14-S2-S1-i9" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">+</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M10" name="1471-2105-14-S2-S1-i10" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo class="MathClass-bin">-</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> are the values of <italic>i</italic>th feature of the <italic>k</italic>th positive and negative instances respectively.</p>
        <p>F-score reflects the discrimination of the features. The higher the F-score, the more discriminative the feature is. F-score is known to have a disadvantage in that it does not carry out the mutual information between features as it considers each feature separately. However, F-score is simple and quite effective in practice.</p>
        <p>Feature selection searches for the optimal subset of features [<xref ref-type="bibr" rid="B30">30</xref>]. There exist different methods for feature selection. In this work, we adopt sequential forward search (SFS) [<xref ref-type="bibr" rid="B31">31</xref>] because of its simplicity and effectiveness. Starting with an empty set, we iteratively select one feature at a time and add it to the current feature set. Features are selected in a descending order of the discriminative power determined by the F-score. The feature added is the one that gives the highest accuracy.</p>
        <p>Based on the properties that might be relevant to consensus shape prediction, we construct 17 features (the features are listed at our website) and compute the F-score for each of them. The accuracy is evaluated using a linear SVM method. The standard grid search approach is used to find an optimal SVM parameter. The performance of a feature set is evaluated using 5-fold cross validation. Prediction accuracy is the average value of all cross validation sets. The feature set that achieves the highest accuracy includes the following four features.</p>
        <p>• <italic>F1: </italic><italic>the contribution of sequences</italic>. We capture the contribution of sequences using the number of sequences mapped to the shape. This feature reveals how the shape is shared among the homologous sequences. <italic>F</italic>1 = |<italic>P.LX</italic>|.</p>
        <p>• <italic>F2: </italic><italic>the contribution of structures</italic>. This feature represents the abundance of structures mapped to the shape. <italic>F</italic>2 = |<italic>P.LS</italic>|.</p>
        <p>• <italic>F3: </italic><italic>the average free energy</italic>. Energy model is commonly used to determine the stability of predicted structures. The basic idea behind this feature is that a stable shape is expected to be derived from a group of stable structures. <inline-formula><mml:math id="M11" name="1471-2105-14-S2-S1-i11" overflow="scroll"><mml:mi>F</mml:mi><mml:mn>3</mml:mn><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo class="MathClass-op">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mo class="MathClass-rel">∈</mml:mo><mml:mi>P</mml:mi><mml:mi>.</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal">Δ</mml:mi><mml:mi>G</mml:mi><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo class="MathClass-rel">|</mml:mo><mml:mi>P</mml:mi><mml:mi>.</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo class="MathClass-rel">|</mml:mo></mml:mrow></mml:mfrac></mml:math></inline-formula>.</p>
        <p>• <italic>F4: the average of minimal free energy</italic>. This feature is different from <italic>F</italic>3 in that it considers only the minimal free energy among all predicted structures of each sequence. <inline-formula><mml:math id="M12" name="1471-2105-14-S2-S1-i12" overflow="scroll"><mml:mi>F</mml:mi><mml:mn>4</mml:mn><mml:mo class="MathClass-rel">=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mo class="MathClass-op">∑</mml:mo></mml:mrow><mml:mrow><mml:mi>X</mml:mi><mml:mo class="MathClass-rel">∈</mml:mo><mml:mi>P</mml:mi><mml:mi>.</mml:mi><mml:mi>L</mml:mi><mml:mi>X</mml:mi></mml:mrow></mml:msub><mml:mi>M</mml:mi><mml:mi>F</mml:mi><mml:mi>E</mml:mi><mml:mrow><mml:mo class="MathClass-open">(</mml:mo><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mo class="MathClass-close">)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo class="MathClass-rel">|</mml:mo><mml:mi>P</mml:mi><mml:mi>.</mml:mi><mml:mi>L</mml:mi><mml:mi>X</mml:mi><mml:mo class="MathClass-rel">|</mml:mo></mml:mrow></mml:mfrac></mml:math></inline-formula>.</p>
      </sec>
      <sec>
        <title>Shape ranking using a simple scoring function</title>
        <p>Once the features are determined, they are used together with a trained linear SVM for shape labeling. Multiple shapes might be labeled as "true". In order to rank these candidate shapes for the final shape selection, we evaluate each candidate shape using a score named <italic>sc</italic>, which is proportional to the signed distance between the candidate shape to the classification hyperplane [<xref ref-type="bibr" rid="B32">32</xref>]. Specifically, <italic>sc </italic>= <italic>w </italic>· <italic>x </italic>+ <italic>b</italic>, where · denotes the dot product, <italic>w </italic>is the weight vector, and <italic>x </italic>is the instance vector. <italic>w </italic>is trained on the optimization function in the linear SVM. The larger |<italic>w<sub>j</sub></italic>| is, the more important the <italic>j</italic>th feature is. This is restricted to <italic>w </italic>in a linear SVM model.</p>
      </sec>
      <sec>
        <title>Time complexity of shape prediction</title>
        <p>For <italic>N </italic>input sequences, there are S predicted structures. These structure can be grouped into <italic>P' </italic>shapes. As we use the de novo folding tools to output near-optimal structures within a given energy range (e.g. 5%), we found that <italic>N</italic>: <italic>S</italic>: <italic>P' </italic>≈ 1: 10: 1:375. Mapping structures to shapes takes <italic>O</italic>(<italic>SL</italic>), where <italic>L </italic>is the sequence length. As sorting shapes according to their features takes <italic>P'log</italic>(<italic>P'</italic>) and <italic>P' </italic>≤ 2<italic>N </italic>and <italic>S </italic>≤ 11<italic>N</italic>, the procedure of shape prediction has time complexity <italic>O</italic>(<italic>NL </italic>+ <italic>NlogN</italic>).</p>
      </sec>
    </sec>
    <sec>
      <title>Consensus structure prediction given a shape</title>
      <p>Once we determine the shape, we will predict the structure in the shape class for the given homologous ncRNAs. Structures corresponding to the same shape can differ significantly in the details of the loop and stacking regions. A strategy is needed to choose the correct structure inside the shape class for each input sequence. The simplest strategy is to output the MFE structure for the chosen shape, which has been used in previous work [<xref ref-type="bibr" rid="B12">12</xref>]. However, the MFE structure in a shape may not be the native structure. In particular, the accuracy of the MFE prediction for ncRNAs containing pseudoknots is low.</p>
      <p>In this section we describe KnotStructure, a comparative structure prediction method for homologous sequences given the shape. The rationale behind comparative structure prediction is that the secondary structures and sequences are conserved during evolution. Thus, finding the structures to maximize both the sequence and the secondary structure similarity among homologous ncRNAs provides the basis for comparative structure prediction. Various methods for evaluating structural and sequence similarity exist. The major challenge is to efficiently select <inline-formula><mml:math id="M13" name="1471-2105-14-S2-S1-i13" overflow="scroll"><mml:mo class="MathClass-rel">|</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover><mml:mi>.</mml:mi><mml:mi>L</mml:mi><mml:mi>X</mml:mi><mml:mo class="MathClass-rel">|</mml:mo></mml:math></inline-formula> representative structures to achieve the highest structural and sequence similarity.</p>
      <p>As we already derived the consensus shape <inline-formula><mml:math id="M14" name="1471-2105-14-S2-S1-i4" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover></mml:math></inline-formula> using KnotShape, only structures with shape <inline-formula><mml:math id="M15" name="1471-2105-14-S2-S1-i4" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover></mml:math></inline-formula> will be allowed. In addition, for each sequence <inline-formula><mml:math id="M16" name="1471-2105-14-S2-S1-i14" overflow="scroll"><mml:msub><mml:mrow><mml:mi>X</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo class="MathClass-rel">∈</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover><mml:mi>.</mml:mi><mml:mi>L</mml:mi><mml:mi>X</mml:mi></mml:math></inline-formula>, only one structure with shape <inline-formula><mml:math id="M17" name="1471-2105-14-S2-S1-i4" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover></mml:math></inline-formula> can be selected. The total number of combinations of structures for measuring the similarity is thus <inline-formula><mml:math id="M18" name="1471-2105-14-S2-S1-i15" overflow="scroll"><mml:msub><mml:mrow><mml:mo class="MathClass-op">∏</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn><mml:mspace class="thinspace" width="0.3em"/><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mspace class="thinspace" width="0.3em"/><mml:mo class="MathClass-rel">|</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover><mml:mi>.</mml:mi><mml:mi>L</mml:mi><mml:mi>X</mml:mi><mml:mo class="MathClass-rel">|</mml:mo></mml:mrow></mml:msub><mml:mo class="MathClass-rel">|</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover><mml:mi>.</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo class="MathClass-bin">∩</mml:mo><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup><mml:mo class="MathClass-rel">|</mml:mo></mml:math></inline-formula>, where <inline-formula><mml:math id="M19" name="1471-2105-14-S2-S1-i16" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover><mml:mi>.</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi><mml:mo class="MathClass-bin">∩</mml:mo><mml:msup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> contains structures with shape <inline-formula><mml:math id="M20" name="1471-2105-14-S2-S1-i4" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover></mml:math></inline-formula> for a sequence <italic>X<sub>i</sub></italic>. Although efficient heuristics exist to measure the similarity among multiple structures and sequences, the sheer amount of combinations poses a great computational challenge.</p>
      <p><bold>Procedure 1 </bold>Representative structures selection</p>
      <p><bold>Input: </bold><inline-formula><mml:math id="M21" name="1471-2105-14-S2-S1-i4" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover></mml:math></inline-formula>, <inline-formula><mml:math id="M22" name="1471-2105-14-S2-S1-i4" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover></mml:math></inline-formula>.<italic>LX</italic>, <inline-formula><mml:math id="M23" name="1471-2105-14-S2-S1-i4" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover></mml:math></inline-formula>.<italic>LS</italic></p>
      <p><bold>Output: </bold>The representative structures</p>
      <p>  1. Initialization</p>
      <p>  <bold>for </bold>Every two structures <inline-formula><mml:math id="M24" name="1471-2105-14-S2-S1-i17" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M25" name="1471-2105-14-S2-S1-i18" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula><bold>do</bold></p>
      <p>    //only evaluate similarity of structures from different sequences</p>
      <p>    <bold>if </bold><italic>x </italic>≠ <italic>y </italic><bold>then</bold></p>
      <p>      Evaluate the similarity of <inline-formula><mml:math id="M26" name="1471-2105-14-S2-S1-i17" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M27" name="1471-2105-14-S2-S1-i18" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></p>
      <p>    <bold>else</bold></p>
      <p>      <inline-formula><mml:math id="M28" name="1471-2105-14-S2-S1-i17" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M29" name="1471-2105-14-S2-S1-i18" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>y</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> has similarity -∞</p>
      <p>    <bold>end if</bold></p>
      <p>  <bold>end for</bold></p>
      <p>  2. Select the set of representative structures using hierarchical clustering</p>
      <p>  //Each structure is a cluster by itself</p>
      <p>  <bold>repeat</bold></p>
      <p>    Combine a pair of clusters with the highest similarity</p>
      <p>    For any structure <inline-formula><mml:math id="M30" name="1471-2105-14-S2-S1-i17" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> added to the cluster, remove all other structures <inline-formula><mml:math id="M31" name="1471-2105-14-S2-S1-i19" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> for <italic>j </italic>≠ <italic>i</italic></p>
      <p>    Re-evaluate the similarity between clusters</p>
      <p>  <bold>until </bold>the cluster has size <inline-formula><mml:math id="M32" name="1471-2105-14-S2-S1-i23" overflow="scroll"><mml:mo class="MathClass-rel">|</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover><mml:mi>.</mml:mi><mml:mstyle class="text"><mml:mtext class="textsf" mathvariant="sans-serif">LX</mml:mtext></mml:mstyle><mml:mo class="MathClass-rel">|</mml:mo></mml:math></inline-formula></p>
      <p>In order to efficiently select representative structures, we use a similar method to Unweighted Pair Group Method with Arithmetic Mean (UPGMA), an agglomerative hierarchical clustering technique [<xref ref-type="bibr" rid="B33">33</xref>]. Each object (i.e. secondary structure) starts in its own cluster. The closest pair of clusters is selected and merged into a single cluster as one moves up the hierarchy. The distance between clusters is measured using arithmetic mean defined in UPGMA. Compared to the standard clustering procedure, we have constraints on the objects that can be selected into the same cluster. Given the shape, only structures that have shape <inline-formula><mml:math id="M33" name="1471-2105-14-S2-S1-i4" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover></mml:math></inline-formula> and come from different ncRNAs can be combined in the same cluster. The detailed clustering process is described in Procedure 1.</p>
      <p>During clustering, the structural and sequence similarity is evaluated using grammar string-based approach [<xref ref-type="bibr" rid="B34">34</xref>,<xref ref-type="bibr" rid="B35">35</xref>]. Grammar strings encode both secondary structure and sequence information for an ncRNA sequence. Grammar string alignment score can accurately quantify the structural and sequence similarity of two ncRNAs. In addition, grammar string can encode pseudoknot structures [<xref ref-type="bibr" rid="B34">34</xref>,<xref ref-type="bibr" rid="B35">35</xref>]. For a sequence <italic>X<sub>i </sub></italic>and one structure <inline-formula><mml:math id="M34" name="1471-2105-14-S2-S1-i1" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> in the folding space of <italic>X<sub>i</sub>, X<sub>i </sub></italic>and <inline-formula><mml:math id="M35" name="1471-2105-14-S2-S1-i1" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> are encoded in a grammar string <inline-formula><mml:math id="M36" name="1471-2105-14-S2-S1-i20" overflow="scroll"><mml:mi>g</mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. We measure the similarity between any two grammar strings using the normalized grammar string-based alignment score over the alignment length. The similarity between groups of grammar strings is measured by arithmetic mean in UPGMA.</p>
      <p>Figure <xref ref-type="fig" rid="F4">4</xref> sketches the representative structure selection based on clustering procedure. Let <inline-formula><mml:math id="M37" name="1471-2105-14-S2-S1-i20" overflow="scroll"><mml:mi>g</mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> be a grammar string converted from <italic>X<sub>i </sub></italic>and <inline-formula><mml:math id="M38" name="1471-2105-14-S2-S1-i1" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>, <italic>X<sub>i </sub></italic>∈ <italic>P.LX</italic>. Once <inline-formula><mml:math id="M39" name="1471-2105-14-S2-S1-i20" overflow="scroll"><mml:mi>g</mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is selected, all the other grammar strings derived from the folding space of <italic>X<sub>i </sub></italic>will be removed from further processing.</p>
      <fig id="F4" position="float">
        <label>Figure 4</label>
        <caption>
          <p><bold>An example of structure selection based on hierarchical clustering</bold>. For each structure <inline-formula><mml:math id="M40" name="1471-2105-14-S2-S1-i1" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> in the folding space of sequence <italic>X<sub>i</sub></italic>, the grammar string encoding the structure and the sequence is denoted as <inline-formula><mml:math id="M41" name="1471-2105-14-S2-S1-i20" overflow="scroll"><mml:mi>g</mml:mi><mml:msubsup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. All sequences and their associated structures are converted into grammar strings before clustering. The highlighted rectangles indicate grammar strings that are selected as representative structures.</p>
        </caption>
        <graphic xlink:href="1471-2105-14-S2-S1-4"/>
      </fig>
      <p>The progressive MSA is performed on the set of representative structures using the clustering path as a guide tree. We then derive the consensus secondary structure from the alignment. The consensus structure can be mapped to each aligned sequence to accomplish the predicted structure of an individual sequence.</p>
      <sec>
        <title>Running time of structure prediction</title>
        <p>Converting a sequence and an associated secondary structure into a GS (grammar string) takes <italic>O</italic>(<italic>L</italic><sup>2</sup>), where <italic>L </italic>is the length of the sequence. Let the number of structures in <inline-formula><mml:math id="M42" name="1471-2105-14-S2-S1-i21" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover><mml:mi>.</mml:mi><mml:mi>L</mml:mi><mml:mi>S</mml:mi></mml:math></inline-formula> be <italic>m</italic>. It takes <italic>O</italic>(<italic>L</italic><sup>2</sup><italic>m</italic>) to encode all structures with shape <inline-formula><mml:math id="M43" name="1471-2105-14-S2-S1-i4" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mo class="MathClass-op"> ^</mml:mo></mml:mover></mml:math></inline-formula>. In the first step of hierarchical clustering, we measure the similarity between GSs of different ncRNAs by conducting all-against-all comparison. Conducting pairwise GS alignment takes <italic>O</italic>(<italic>l</italic><sup>2</sup>), where <italic>l </italic>is the length of the GS sequence and <italic>l </italic>≤ <italic>L</italic>. By using the default energy cutoff (5%) for sub-optimal structure generation, we observed that <italic>m </italic>≤ 11<italic>N</italic>. Thus, the all-against-all similarity measure has time complexity <italic>O</italic>(<italic>L</italic><sup>2</sup><italic>N</italic><sup>2</sup>). The guide tree generated using the clustering procedure contains at most <italic>N </italic>representative structures. Thus, the total running time for clustering is <italic>O</italic>(<italic>L</italic><sup>2</sup><italic>N</italic><sup>3</sup>), which is the leading time complexity term for the consensus structure prediction algorithm.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Experimental results</title>
    <sec>
      <title>Data sets</title>
      <p>The training data set is the <italic>K10 </italic>from BraliBASE [<xref ref-type="bibr" rid="B36">36</xref>]. It contains 845 sequence sets, each of which has 10 homologous ncRNAs. There are two test data sets. The first one is the <italic>K15 </italic>from BraliBASE. <italic>K15 </italic>contains 503 sequence sets, each of which has 15 homologous ncRNAs. As existing shape prediction tools are not designed for handling pseudoknots, we use the pseudoknot-free sequence sets in <italic>K15 </italic>to compare the performance of shape prediction. After removing the sets containing pseudoknots, we have 452 sequence sets left. To test the performance of pseudoknot prediction, we constructed the second test set <italic>R15 </italic>from psuedoknot families of Rfam [<xref ref-type="bibr" rid="B3">3</xref>]. In Rfam 10.0, there are 71 families containing pseudoknots. 25 of them have published structures. Of the 25 families, only families with at least 15 seed sequences are used for testing our tools. For each chosen family, sets of 15 sequences are chosen randomly to construct the test sets. Finally <italic>R15 </italic>contains 160 test sets. The average pairwise sequence identities range from 60-93%. For all sequence sets, the reference shapes were derived from Rfam [<xref ref-type="bibr" rid="B3">3</xref>].</p>
    </sec>
    <sec>
      <title>SVM training</title>
      <p>For both the training and testing data sets, we need to apply de novo folding tools to the sequences. We choose a folding tool using the following criteria. First, this tool is able to output both the optimal and sub-optimal structures. Second, this tool has high accuracy and can be efficiently applied to a large number of ncRNAs. Finally, if the target sequences contain pseudoknots, this tool should be able to output pseudoknot structures. As a result, we chose TT2NE [<xref ref-type="bibr" rid="B20">20</xref>]. Different from many other pseudoknot prediction tools that have constraints on the type of the pseudoknot, TT2NE is more exible about the types of the target sequences. However, when it was applied to <italic>K10</italic>, TT2NE failed to output structures for some sequences due to the length limit (200 nt) and also existence of IUPAC characters in some sequences. Thus, for the training data set <italic>K10</italic>, we applied quikfold [<xref ref-type="bibr" rid="B37">37</xref>] because <italic>K10 </italic>rarely contains pseudoknots. Although it is ideal to use the same folding tool to the training and testing data set to achieve optimal classification performance, the complexity of the training and test data sets together with the performance of de novo folding tools lead to the current combination. In the Discussion section we will briefly discuss how de novo folding tools affect the performance.</p>
      <p>We employed the SVM model implemented by LIBSVM tool [<xref ref-type="bibr" rid="B38">38</xref>] for classification. For each sequence in <italic>K10</italic>, we applied quikfold with the energy range 5% to obtain both optimal and sub-optimal structures of each sequence. The predicted structures were grouped based on their corresponding shapes. Associated features were extracted and enclosed with each shape. We normalized feature values to fit the different properties of test sets to the same scale.</p>
      <p>To label shapes, we used the shapes extracted from the consensus structures in Rfam [<xref ref-type="bibr" rid="B3">3</xref>] as the reference. Shapes are labeled according to their correctness. We label a shape as 1 if it is as same as the reference shape. Otherwise, it is labeled as -1.</p>
    </sec>
    <sec>
      <title>Shape prediction comparison</title>
      <p>We compared KnotShape with RNAcast [<xref ref-type="bibr" rid="B12">12</xref>], which is part of RNAshapes package [<xref ref-type="bibr" rid="B25">25</xref>]. RNAcast takes the sequences as the input and predicts the consensus shape shared by all sequences. As it is not designed for pseudoknot structures, we only applied RNAcast to 452 test sets of <italic>K15</italic>, which are pseudoknot-free. TT2NE is applied to the test set using the default parameters. For each sequence, the optimal structure and 10 sub-optimal structures are kept as the sample of the folding space for each sequence. We compared our predicted shapes and the first-ranked shapes output by RNAcast with the reference shapes derived from Rfam [<xref ref-type="bibr" rid="B3">3</xref>]. The comparison is presented in Table <xref ref-type="table" rid="T1">1</xref>. Note that RNAcast cannot output the shapes containing pseudoknots and thus is left blank for <italic>R15 </italic>in Table <xref ref-type="table" rid="T1">1</xref>. The accuracy of KnotShape is 18% higher than RNAshapes.</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Accuracy of shape predictions</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th/>
              <th align="center" colspan="3">
                <italic>K15</italic>
              </th>
              <th align="center" colspan="3">
                <italic>R15</italic>
              </th>
            </tr>
            <tr>
              <th/>
              <th align="center">Testset</th>
              <th align="center">Correct shapes</th>
              <th align="center">%Accuracy</th>
              <th align="center">Testset</th>
              <th align="center">Correct shapes</th>
              <th align="center">%Accuracy</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">KnotShape</td>
              <td align="center">452</td>
              <td align="center">311</td>
              <td align="center">68.81</td>
              <td align="center">160</td>
              <td align="center">107</td>
              <td align="center">66.88</td>
            </tr>
            <tr>
              <td align="left">RNAcast</td>
              <td align="center">452</td>
              <td align="center">232</td>
              <td align="center">51.33</td>
              <td align="center">-</td>
              <td align="center">-</td>
              <td align="center">-</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec>
      <title>Structure prediction comparison</title>
      <p>We applied the predicted shapes to pseudoknot structure prediction and compared the structure prediction performance with IPknot [<xref ref-type="bibr" rid="B19">19</xref>], HxMatch [<xref ref-type="bibr" rid="B39">39</xref>], and TurboKnot [<xref ref-type="bibr" rid="B21">21</xref>], which are chosen because of their popularity, availability, and easy usage on large number of sequences. Sequence alignments were generated using ClustalW and entered as the input to IPknot and HxMatch. For IPknot, we chose the appropriate levels of prediction according to the test sets. We ran Hxmatch with the default parameters. We used the parameters suggested in [<xref ref-type="bibr" rid="B21">21</xref>] to run TurboKnot. Sensitivity and the Positive Predicted Value (PPV) are used to evaluate the performance:</p>
      <p>
        <disp-formula>
          <mml:math id="M44" name="1471-2105-14-S2-S1-i22" overflow="scroll">
            <mml:mrow>
              <mml:mi>S</mml:mi>
              <mml:mi>e</mml:mi>
              <mml:mi>n</mml:mi>
              <mml:mi>s</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>t</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>v</mml:mi>
              <mml:mi>i</mml:mi>
              <mml:mi>t</mml:mi>
              <mml:mi>y</mml:mi>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>T</mml:mi>
                  <mml:mi>P</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>T</mml:mi>
                  <mml:mi>P</mml:mi>
                  <mml:mo class="MathClass-bin">+</mml:mo>
                  <mml:mi>F</mml:mi>
                  <mml:mi>N</mml:mi>
                </mml:mrow>
              </mml:mfrac>
              <mml:mo class="MathClass-punc">,</mml:mo>
              <mml:mspace class="thinspace" width="0.3em"/>
              <mml:mi>P</mml:mi>
              <mml:mi>P</mml:mi>
              <mml:mi>V</mml:mi>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mfrac>
                <mml:mrow>
                  <mml:mi>T</mml:mi>
                  <mml:mi>P</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>T</mml:mi>
                  <mml:mi>P</mml:mi>
                  <mml:mo class="MathClass-bin">+</mml:mo>
                  <mml:mi>F</mml:mi>
                  <mml:mi>P</mml:mi>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p><italic>TP </italic>is the number of correctly predicted base pairs. <italic>FN </italic>is the number of base pairs that are in the reference structure but not in the predicted structure. <italic>FP </italic>is the number of base pairs that are in the predicted structure but not in the reference structure. Figure <xref ref-type="fig" rid="F5">5</xref> is the boxplot of the sensitivity and PPV over all 160 test sets. KnotStructure has the best overall performance on the whole data set. The median values of sensitivity and PPV are 54.55% and 46.15% for KnotStructure. Hxmatch has the next highest sensitivity and PPV (42.11% and 42.86% respectively). The abstract shapes of these families are shown in Table <xref ref-type="table" rid="T2">2</xref>. Three families contain simple H-type pseudoknots while the other three families contain more complicated pseudoknots. In order to show the effect of shape prediction in structure prediction, we predicted the structures of <italic>R15 </italic>using 10 randomly selected shapes. The average sensitivity and PPV of predicted structures with the predicted shapes are higher than those using random shapes as shown in Table <xref ref-type="table" rid="T3">3</xref>. Table <xref ref-type="table" rid="T4">4</xref> shows the average sensitivity and PPV over all sequences of each family compared to other tools. The average running time of KnotStructure on each family compared to other tools is shown in Table <xref ref-type="table" rid="T5">5</xref>.</p>
      <fig id="F5" position="float">
        <label>Figure 5</label>
        <caption>
          <p><bold>Comparison of the sensitivity and PPV of different tools</bold>.</p>
        </caption>
        <graphic xlink:href="1471-2105-14-S2-S1-5"/>
      </fig>
      <table-wrap id="T2" position="float">
        <label>Table 2</label>
        <caption>
          <p>Abstract shapes of ncRNA families in R15</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">RNA Type</th>
              <th align="left">Shape Level 5</th>
              <th align="left">Shape Level 3</th>
              <th align="left">RNA Type</th>
              <th align="left">Shape Level 5</th>
              <th align="left">Shape Level 3</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">HDV _ribozyme</td>
              <td align="left">[A[B]]b[]a</td>
              <td align="left">[AA[B]]b[[[[[[]]]]]]aa</td>
              <td align="left">Alpha_RBS</td>
              <td align="left">[ABC]bac</td>
              <td align="left">[[[ABC]]]bac</td>
            </tr>
            <tr>
              <td align="left">Tombus_3_IV</td>
              <td align="left">[[]A][][]a</td>
              <td align="left">[[[]A]][][]a</td>
              <td align="left">Tymo_tRNA-like</td>
              <td align="left">[][][]A[a]</td>
              <td align="left">[][][[]]AA[aa]</td>
            </tr>
            <tr>
              <td align="left">Corona_FSE</td>
              <td align="left">[A]a</td>
              <td align="left">[AA]aa</td>
              <td align="left">Prion_pknot</td>
              <td align="left">[A]a</td>
              <td align="left">[A]a</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap id="T3" position="float">
        <label>Table 3</label>
        <caption>
          <p>Sensitivity and PPV of predicted structures using the predicted shapes and randomly selected shapes</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th/>
              <th align="left">Predicted shape</th>
              <th align="center" colspan="10">Randomly selected shape</th>
            </tr>
            <tr>
              <th/>
              <th/>
              <th align="center">1</th>
              <th align="center">2</th>
              <th align="center">3</th>
              <th align="center">4</th>
              <th align="center">5</th>
              <th align="center">6</th>
              <th align="center">7</th>
              <th align="center">8</th>
              <th align="center">9</th>
              <th align="center">10</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">SEN</td>
              <td align="left">79.00</td>
              <td align="center">45.68</td>
              <td align="center">58.41</td>
              <td align="center">53.09</td>
              <td align="center">58.06</td>
              <td align="center">55.74</td>
              <td align="center">45.88</td>
              <td align="center">44.75</td>
              <td align="center">56.12</td>
              <td align="center">61.08</td>
              <td align="center">46.54</td>
            </tr>
            <tr>
              <td align="left">PPV</td>
              <td align="left">67.10</td>
              <td align="center">38.81</td>
              <td align="center">50.92</td>
              <td align="center">42.82</td>
              <td align="center">49.15</td>
              <td align="center">46.24</td>
              <td align="center">40.29</td>
              <td align="center">36.33</td>
              <td align="center">45.75</td>
              <td align="center">52.80</td>
              <td align="center">38.53</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <table-wrap id="T4" position="float">
        <label>Table 4</label>
        <caption>
          <p>Sensitivity and PPV for different ncRNA families</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th/>
              <th/>
              <th/>
              <th align="center" colspan="4">Sensitivity</th>
              <th align="center" colspan="4">PPV</th>
            </tr>
            <tr>
              <th align="center">RNA Type</th>
              <th align="center">Len<sup>⊕</sup></th>
              <th align="center">TS*</th>
              <th align="center">Knot-Structure</th>
              <th align="center">IP-knot</th>
              <th align="center">Turbo-Knot</th>
              <th align="center">Hx-match</th>
              <th align="center">Knot-Structure</th>
              <th align="center">IP-knot</th>
              <th align="center">Turbo-Knot</th>
              <th align="center">Hx-match</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">HDV_ribozyme</td>
              <td align="center">89.70</td>
              <td align="center">12</td>
              <td align="center">
                <bold>82.52</bold>
              </td>
              <td align="center">
                <underline>50.66</underline>
              </td>
              <td align="center">36.47</td>
              <td align="center">23.51</td>
              <td align="center">
                <bold>80.13</bold>
              </td>
              <td align="center">
                <underline>59.24</underline>
              </td>
              <td align="center">39.28</td>
              <td align="center">39.77</td>
            </tr>
            <tr>
              <td align="center">Alpha_RBS</td>
              <td align="center">110.99</td>
              <td align="center">18</td>
              <td align="center">
                <bold>74.36</bold>
              </td>
              <td align="center">
                <underline>46.59</underline>
              </td>
              <td align="center">46.24</td>
              <td align="center">24.49</td>
              <td align="center">
                <bold>40.59</bold>
              </td>
              <td align="center">
                <underline>25.34</underline>
              </td>
              <td align="center">23.70</td>
              <td align="center">22.19</td>
            </tr>
            <tr>
              <td align="center">Tombus_3_IV</td>
              <td align="center">91.61</td>
              <td align="center">4</td>
              <td align="center">
                <bold>84.00</bold>
              </td>
              <td align="center">65.91</td>
              <td align="center">72.00</td>
              <td align="center">
                <underline>80.00</underline>
              </td>
              <td align="center">
                <underline>83.14</underline>
              </td>
              <td align="center">78.02</td>
              <td align="center">73.47</td>
              <td align="center">
                <bold>90.91</bold>
              </td>
            </tr>
            <tr>
              <td align="center">Tymo_tRNA-like</td>
              <td align="center">85.12</td>
              <td align="center">3</td>
              <td align="center">
                <bold>96.79</bold>
              </td>
              <td align="center">76.41</td>
              <td align="center">
                <underline>83.52</underline>
              </td>
              <td align="center">75.09</td>
              <td align="center">
                <bold>90.25</bold>
              </td>
              <td align="center">73.62</td>
              <td align="center">86.85</td>
              <td align="center">
                <underline>90.11</underline>
              </td>
            </tr>
            <tr>
              <td align="center">Corona_FSE</td>
              <td align="center">82.91</td>
              <td align="center">9</td>
              <td align="center">
                <bold>96.14</bold>
              </td>
              <td align="center">56.55</td>
              <td align="center">56.55</td>
              <td align="center">
                <underline>73.27</underline>
              </td>
              <td align="center">
                <underline>75.65</underline>
              </td>
              <td align="center">60.51</td>
              <td align="center">42.19</td>
              <td align="center">
                <bold>92.30</bold>
              </td>
            </tr>
            <tr>
              <td align="center">Prion_pknot</td>
              <td align="center">40.46</td>
              <td align="center">114</td>
              <td align="center">
                <bold>40.17</bold>
              </td>
              <td align="center">13.70</td>
              <td align="center">2.96</td>
              <td align="center">
                <underline>30.26</underline>
              </td>
              <td align="center">
                <bold>32.85</bold>
              </td>
              <td align="center">15.71</td>
              <td align="center">3.03</td>
              <td align="center">
                <underline>28.86</underline>
              </td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Bold number and underlined number indicate the highest and the second highest sensitivity or PPV for each family. <sup>⊕ </sup>Average sequence length. * The number of test sets.</p>
        </table-wrap-foot>
      </table-wrap>
      <table-wrap id="T5" position="float">
        <label>Table 5</label>
        <caption>
          <p>Running time for different ncRNA families (seconds)</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="left">RNA Type</th>
              <th align="left">Knot-Structure</th>
              <th align="left">IP-knot</th>
              <th align="left">Turbo-Knot</th>
              <th align="left">Hx-match</th>
              <th align="left">RNA Type</th>
              <th align="left">Knot-Structure</th>
              <th align="left">IP-knot</th>
              <th align="left">Turbo-Knot</th>
              <th align="left">Hx-match</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="left">HDV_ribozyme</td>
              <td align="left">1.55</td>
              <td align="left">0.35</td>
              <td align="left">28.22</td>
              <td align="left">0.41</td>
              <td align="left">Tymo_tRNA-like</td>
              <td align="left">1.78</td>
              <td align="left">0.24</td>
              <td align="left">12.24</td>
              <td align="left">0.28</td>
            </tr>
            <tr>
              <td align="left">Alpha_RBS</td>
              <td align="left">1.93</td>
              <td align="left">0.49</td>
              <td align="left">37.25</td>
              <td align="left">0.55</td>
              <td align="left">Corona_FSE</td>
              <td align="left">1.51</td>
              <td align="left">0.30</td>
              <td align="left">12.75</td>
              <td align="left">0.35</td>
            </tr>
            <tr>
              <td align="left">Tombus_3_IV</td>
              <td align="left">1.80</td>
              <td align="left">0.37</td>
              <td align="left">13.66</td>
              <td align="left">0.42</td>
              <td align="left">Prion_pknot</td>
              <td align="left">1.07</td>
              <td align="left">0.10</td>
              <td align="left">4.23</td>
              <td align="left">0.12</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>Discussion and conclusion</title>
    <p>Based on the fold-then-align strategy, choice of folding tools can play an important role in the performance of the shape and structure prediction. For the test set, we tested two folding tools: HotKnots [<xref ref-type="bibr" rid="B40">40</xref>] and TT2NE. We used them in three different ways: Hotknots, TT2NE, and both of them. We ran HotKnots and TT2NE with default parameters. The experimental results show that using TT2NE alone achieves the best performance in consensus structure prediction. It is likely that other folding tools exist to yield better performance than TT2NE. However, as the performance of those tools also depends on the input data and the parameters, a systematic study is needed to choose the best tool.</p>
    <p>For TT2NE, we currently only use 10 sub-optimal structures. Increasing this number moderately does not affect the performance significantly. It indicates that the correct structures have high rankings in the folding space. However, there are a few sequence sets for which the correct structures are not near-optimal. Thus, enlarging the sample folding space will likely increase the sensitivity. However, using a large number of sub-optimal structures can increase the computational cost. Thus, a better algorithm is needed to achieve a better tradeoff between sensitivity and running time. This is an important part of our future work.</p>
    <p>There are more pseudoknot-free structures available than pseudoknot-containing structures. To achieve a reliable SVM model, more training data is desired. We used <italic>K10 </italic>for feature selection. This may cause KnotShape to have slightly lower predictive performance on pseudoknot-containing than pseudoknot-free sequences. Nonetheless, the features used in KnotShape does not heavily rely on the free energy value, which is different between pseudoknot-free and pseudoknot-containing structures. Instead, the feature set is based on multiple RNA properties shared among homologous sequences.</p>
    <p>Extensive analysis of RNA properties based on SVM allows us to identify important features related to abstract shapes. The combination of mass data analysis and SVM-based feature ranking makes KnotShape a promising tool for shape prediction. By combining the predicted shapes and the multiple structural alignment strategy, KnotStructure demonstrates higher accuracy in pseudoknot structure prediction.</p>
  </sec>
  <sec>
    <title>Competing interests</title>
    <p>The authors declare that there are no competing interests.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>YS initiated the project and participated in its design and coordination. RA designed the shape prediction algorithm, developed both KnotShape and KnotStructure, and conducted the experiments. RA and YS are both responsible for writing the manuscript.</p>
  </sec>
  <sec>
    <title>Declarations</title>
    <p>The publication costs for this article were funded by NSF DBI-0953738 and IOS-1126998.</p>
    <p>This article has been published as part of <italic>BMC Bioinformatics </italic>Volume 14 Supplement 2, 2013: Selected articles from the Eleventh Asia Pacific Bioinformatics Conference (APBC 2013): Bioinformatics. The full contents of the supplement are available online at <ext-link ext-link-type="uri" xlink:href="http://www.biomedcentral.com/bmcbioinformatics/supplements/14/S2">http://www.biomedcentral.com/bmcbioinformatics/supplements/14/S2</ext-link>.</p>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements</title>
    <p>This work was supported by the NSF CAREER Grant DBI-0953738 and NSF IOS-1126998.</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gorodkin</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Hofacker</surname>
          <given-names>IL</given-names>
        </name>
        <name>
          <surname>Torarinsson</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>Yao</surname>
          <given-names>Z</given-names>
        </name>
        <name>
          <surname>Havgaard</surname>
          <given-names>JH</given-names>
        </name>
        <name>
          <surname>Ruzzo</surname>
          <given-names>WL</given-names>
        </name>
        <article-title>De novo prediction of structured RNAs from genomic sequences</article-title>
        <source>Trends in biotechnology</source>
        <year>2010</year>
        <volume>28</volume>
        <fpage>9</fpage>
        <lpage>19</lpage>
        <pub-id pub-id-type="doi">10.1016/j.tibtech.2009.09.006</pub-id>
        <pub-id pub-id-type="pmid">19942311</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Staple</surname>
          <given-names>DW</given-names>
        </name>
        <name>
          <surname>Butcher</surname>
          <given-names>SE</given-names>
        </name>
        <article-title>Pseudoknots: RNA Structures with Diverse Functions</article-title>
        <source>PLoS Biol</source>
        <year>2005</year>
        <volume>3</volume>
        <issue>6</issue>
        <fpage>e213</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pbio.0030213</pub-id>
        <pub-id pub-id-type="pmid">15941360</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gardner</surname>
          <given-names>PP</given-names>
        </name>
        <name>
          <surname>Daub</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Tate</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Moore</surname>
          <given-names>BL</given-names>
        </name>
        <name>
          <surname>Osuch</surname>
          <given-names>IH</given-names>
        </name>
        <name>
          <surname>Griffiths-Jones</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Finn</surname>
          <given-names>RD</given-names>
        </name>
        <name>
          <surname>Nawrocki</surname>
          <given-names>EP</given-names>
        </name>
        <name>
          <surname>Kolbe</surname>
          <given-names>DL</given-names>
        </name>
        <name>
          <surname>Eddy</surname>
          <given-names>SR</given-names>
        </name>
        <etal/>
        <article-title>Rfam: Wikipedia, clans and the "decimal" release</article-title>
        <source>Nucleic Acids Research</source>
        <year>2011</year>
        <volume>39</volume>
        <fpage>D141</fpage>
        <lpage>D145</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq1129</pub-id>
        <pub-id pub-id-type="pmid">21062808</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Treiber</surname>
          <given-names>DK</given-names>
        </name>
        <name>
          <surname>Williamson</surname>
          <given-names>JR</given-names>
        </name>
        <article-title>Exposing the kinetic traps in RNA folding</article-title>
        <source>Curr Opin Struct Biol</source>
        <year>1999</year>
        <volume>9</volume>
        <issue>3</issue>
        <fpage>339</fpage>
        <lpage>45</lpage>
        <pub-id pub-id-type="doi">10.1016/S0959-440X(99)80045-1</pub-id>
        <pub-id pub-id-type="pmid">10361090</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Adams</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Lindahl</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Fresco</surname>
          <given-names>JR</given-names>
        </name>
        <article-title>Conformational differences between the biologically active and inactive forms of a transfer ribonucleic acid</article-title>
        <source>Proc Natl Acad Sci USA</source>
        <year>1967</year>
        <volume>57</volume>
        <issue>6</issue>
        <fpage>1684</fpage>
        <lpage>91</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.57.6.1684</pub-id>
        <pub-id pub-id-type="pmid">5231404</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gardner</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Giegerich</surname>
          <given-names>R</given-names>
        </name>
        <article-title>A comprehensive comparison of comparative RNA structure prediction approaches</article-title>
        <source>BMC Bioinformatics</source>
        <year>2004</year>
        <volume>5</volume>
        <fpage>140</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-5-140</pub-id>
        <pub-id pub-id-type="pmid">15458580</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bernhart</surname>
          <given-names>SH</given-names>
        </name>
        <name>
          <surname>Hofacker</surname>
          <given-names>IL</given-names>
        </name>
        <article-title>From consensus structure prediction to RNA gene finding</article-title>
        <source>Briefings in functional genomics &amp; proteomics</source>
        <year>2009</year>
        <volume>8</volume>
        <issue>6</issue>
        <fpage>461</fpage>
        <lpage>471</lpage>
        <pub-id pub-id-type="doi">10.1093/bfgp/elp043</pub-id>
        <pub-id pub-id-type="pmid">19833701</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lyngs∅</surname>
          <given-names>RB</given-names>
        </name>
        <name>
          <surname>Pedersen</surname>
          <given-names>CN</given-names>
        </name>
        <article-title>RNA Pseudoknot Prediction in Energy-Based Modelss</article-title>
        <source>Journal of Computational Biology</source>
        <year>2000</year>
        <volume>7</volume>
        <issue>3-4</issue>
        <fpage>409</fpage>
        <lpage>427</lpage>
        <pub-id pub-id-type="doi">10.1089/106652700750050862</pub-id>
        <pub-id pub-id-type="pmid">11108471</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Giegerich</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Voß</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Rehmsmeier</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Abstract shapes of RNA</article-title>
        <source>Nucleic Acids Research</source>
        <year>2004</year>
        <volume>32</volume>
        <issue>16</issue>
        <fpage>4843</fpage>
        <lpage>4851</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkh779</pub-id>
        <pub-id pub-id-type="pmid">15371549</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schuster</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Fontana</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Stadler</surname>
          <given-names>PF</given-names>
        </name>
        <name>
          <surname>Hofacker</surname>
          <given-names>IL</given-names>
        </name>
        <article-title>From sequences to shapes and back: a case study in RNA secondary structures</article-title>
        <source>Proceedings of the Royal Society: Biological Sciences, Series B</source>
        <year>1994</year>
        <volume>255</volume>
        <issue>1344</issue>
        <fpage>279</fpage>
        <lpage>284</lpage>
        <pub-id pub-id-type="doi">10.1098/rspb.1994.0040</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Scheid</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Nebel</surname>
          <given-names>M</given-names>
        </name>
        <article-title>On abstract shapes of RNA</article-title>
        <source>Tech Rep</source>
        <year>2008</year>
        <volume>368</volume>
        <comment>Informatik</comment>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Reeder</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Giegerich</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Consensus shapes: an alternative to the Sankoff algorithm for RNA consensus structure prediction</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>17</issue>
        <fpage>3516</fpage>
        <lpage>3523</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti577</pub-id>
        <pub-id pub-id-type="pmid">16020472</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Berezikov</surname>
          <given-names>E</given-names>
        </name>
        <name>
          <surname>van Tetering</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Verheul</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>van de Belt</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>van Laake</surname>
          <given-names>L</given-names>
        </name>
        <name>
          <surname>Vos</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Verloop</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>van de Wetering</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Guryev</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Takada</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>van Zonneveld</surname>
          <given-names>AJ</given-names>
        </name>
        <name>
          <surname>Mano</surname>
          <given-names>H</given-names>
        </name>
        <name>
          <surname>Plasterk</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Cuppen</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Many novel mammalian microRNA candidates identified by extensive cloning and RAKE analysis</article-title>
        <source>Genome Res</source>
        <year>2006</year>
        <volume>16</volume>
        <issue>10</issue>
        <fpage>1289</fpage>
        <lpage>98</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.5159906</pub-id>
        <pub-id pub-id-type="pmid">16954537</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lu</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Shen</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Wu</surname>
          <given-names>Q</given-names>
        </name>
        <name>
          <surname>Kumar</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>He</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Shi</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Carthew</surname>
          <given-names>RW</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>SM</given-names>
        </name>
        <name>
          <surname>Wu</surname>
          <given-names>CI</given-names>
        </name>
        <article-title>The birth and death of microRNA genes in Drosophila</article-title>
        <source>Nat Genet</source>
        <year>2008</year>
        <volume>40</volume>
        <issue>3</issue>
        <fpage>351</fpage>
        <lpage>5</lpage>
        <pub-id pub-id-type="doi">10.1038/ng.73</pub-id>
        <pub-id pub-id-type="pmid">18278047</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Janssen</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Reeder</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Giegerich</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Shape based indexing for faster search of RNA family databases</article-title>
        <source>BMC Bioinformatics</source>
        <year>2008</year>
        <volume>9</volume>
        <fpage>131</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-9-131</pub-id>
        <pub-id pub-id-type="pmid">18312625</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Huang</surname>
          <given-names>CH</given-names>
        </name>
        <name>
          <surname>Lu</surname>
          <given-names>CL</given-names>
        </name>
        <name>
          <surname>Chiu</surname>
          <given-names>HT</given-names>
        </name>
        <article-title>A heuristic approach for detecting RNA H-type pseudoknots</article-title>
        <source>Bioinformatics</source>
        <year>2005</year>
        <volume>21</volume>
        <issue>17</issue>
        <fpage>3501</fpage>
        <lpage>3508</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bti568</pub-id>
        <pub-id pub-id-type="pmid">15994188</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Cao</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Chen</surname>
          <given-names>SJ</given-names>
        </name>
        <article-title>Predicting structures and stabilities for H-type pseudoknots with interhelix loops</article-title>
        <source>RNA</source>
        <year>2009</year>
        <volume>15</volume>
        <fpage>696</fpage>
        <lpage>706</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.1429009</pub-id>
        <pub-id pub-id-type="pmid">19237463</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sperschneider</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Datta</surname>
          <given-names>A</given-names>
        </name>
        <article-title>DotKnot: pseudoknot prediction using the probability dot plot under a refined energy model</article-title>
        <source>Nucleic Acids Research</source>
        <year>2010</year>
        <volume>38</volume>
        <issue>7</issue>
        <fpage>e103</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkq021</pub-id>
        <pub-id pub-id-type="pmid">20123730</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Sato</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Kato</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Hamada</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Akutsu</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Asai</surname>
          <given-names>K</given-names>
        </name>
        <article-title>IPknot: fast and accurate prediction of RNA secondary structures with pseudoknots using integer programming</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>13</issue>
        <fpage>i85</fpage>
        <lpage>i93</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr215</pub-id>
        <pub-id pub-id-type="pmid">21685106</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bon</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Orland</surname>
          <given-names>H</given-names>
        </name>
        <article-title>TT2NE: a novel algorithm to predict RNA secondary structures with pseudoknots</article-title>
        <source>Nucleic Acids Research</source>
        <year>2011</year>
        <volume>39</volume>
        <issue>14</issue>
        <fpage>e93</fpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkr240</pub-id>
        <pub-id pub-id-type="pmid">21593129</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Seetin</surname>
          <given-names>MG</given-names>
        </name>
        <name>
          <surname>Mathews</surname>
          <given-names>DH</given-names>
        </name>
        <article-title>TurboKnot: rapid prediction of conserved RNA secondary structures including pseudoknots</article-title>
        <source>Bioinformatics</source>
        <year>2012</year>
        <volume>28</volume>
        <issue>6</issue>
        <fpage>792</fpage>
        <lpage>798</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bts044</pub-id>
        <pub-id pub-id-type="pmid">22285566</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Janssen</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Giegerich</surname>
          <given-names>R</given-names>
        </name>
        <article-title>Faster computation of exact RNA shape probabilities</article-title>
        <source>Bioinformatics</source>
        <year>2010</year>
        <volume>26</volume>
        <issue>5</issue>
        <fpage>632</fpage>
        <lpage>639</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq014</pub-id>
        <pub-id pub-id-type="pmid">20080511</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Thompson</surname>
          <given-names>JD</given-names>
        </name>
        <name>
          <surname>Higgins</surname>
          <given-names>DG</given-names>
        </name>
        <name>
          <surname>Gibson</surname>
          <given-names>TJ</given-names>
        </name>
        <article-title>CLUSTAL W: improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice</article-title>
        <source>Nucleic Acids Research</source>
        <year>1994</year>
        <volume>22</volume>
        <issue>22</issue>
        <fpage>4673</fpage>
        <lpage>4680</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/22.22.4673</pub-id>
        <pub-id pub-id-type="pmid">7984417</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Wilm</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Mainz</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Steger</surname>
          <given-names>G</given-names>
        </name>
        <article-title>An enhanced RNA alignment benchmark for sequence alignment programs</article-title>
        <source>Algorithms for Molecular Biology</source>
        <year>2006</year>
        <volume>1</volume>
        <fpage>19</fpage>
        <pub-id pub-id-type="doi">10.1186/1748-7188-1-19</pub-id>
        <pub-id pub-id-type="pmid">17062125</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Steffen</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Voß</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Rehmsmeier</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Reeder</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Giegerich</surname>
          <given-names>R</given-names>
        </name>
        <article-title>RNAshapes: an integrated RNA analysis package based on abstract shapes</article-title>
        <source>Bioinformatics</source>
        <year>2006</year>
        <volume>22</volume>
        <issue>4</issue>
        <fpage>500</fpage>
        <lpage>503</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btk010</pub-id>
        <pub-id pub-id-type="pmid">16357029</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Voss</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Giegerich</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Rehmsmeier</surname>
          <given-names>M</given-names>
        </name>
        <article-title>Complete probabilistic analysis of RNA shapes</article-title>
        <source>BMC biology</source>
        <year>2006</year>
        <volume>4</volume>
        <fpage>5</fpage>
        <pub-id pub-id-type="doi">10.1186/1741-7007-4-5</pub-id>
        <pub-id pub-id-type="pmid">16480488</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="book">
        <name>
          <surname>Boser</surname>
          <given-names>BE</given-names>
        </name>
        <name>
          <surname>Guyon</surname>
          <given-names>IM</given-names>
        </name>
        <name>
          <surname>Vapnik</surname>
          <given-names>VN</given-names>
        </name>
        <article-title>A training algorithm for optimal margin classifiers</article-title>
        <source>Proceedings of the fifth annual workshop on Computational learning theory</source>
        <year>1992</year>
        <publisher-name>New York, USA</publisher-name>
        <fpage>144</fpage>
        <lpage>152</lpage>
        <comment>COLT '92</comment>
      </mixed-citation>
    </ref>
    <ref id="B28">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mathews</surname>
          <given-names>DH</given-names>
        </name>
        <name>
          <surname>Sabina</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Zuker</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Turner</surname>
          <given-names>DH</given-names>
        </name>
        <article-title>Expanded sequence dependence of thermodynamic parameters improves prediction of RNA secondary structure</article-title>
        <source>Journal of molecular biology</source>
        <year>1999</year>
        <volume>288</volume>
        <issue>5</issue>
        <fpage>911</fpage>
        <lpage>940</lpage>
        <pub-id pub-id-type="doi">10.1006/jmbi.1999.2700</pub-id>
        <pub-id pub-id-type="pmid">10329189</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B29">
      <mixed-citation publication-type="book">
        <name>
          <surname>Chen</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>Combining SVMs with various feature selection strategies</article-title>
        <source>Feature Extraction: Foundations and Applications (Studies in Fuzziness and Soft Computing)</source>
        <year>2005</year>
        <publisher-name>Springer-Verlag</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B30">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mao</surname>
          <given-names>KZ</given-names>
        </name>
        <article-title>Fast orthogonal forward selection algorithm for feature subset selection</article-title>
        <source>IEEE Transactions on Neural Networks</source>
        <year>2002</year>
        <volume>13</volume>
        <issue>5</issue>
        <fpage>1218</fpage>
        <lpage>1224</lpage>
        <pub-id pub-id-type="doi">10.1109/TNN.2002.1031954</pub-id>
        <pub-id pub-id-type="pmid">18244519</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B31">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Marill</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Green</surname>
          <given-names>D</given-names>
        </name>
        <article-title>On the effectiveness of receptors in recognition systems</article-title>
        <source>Information Theory, IEEE Transactions on</source>
        <year>1963</year>
        <volume>9</volume>
        <fpage>11</fpage>
        <lpage>17</lpage>
        <pub-id pub-id-type="doi">10.1109/TIT.1963.1057810</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B32">
      <mixed-citation publication-type="book">
        <name>
          <surname>Zhang</surname>
          <given-names>T</given-names>
        </name>
        <source>Fundamental Statistical Techniques, Chapter in Handbook of Natural Language Processing</source>
        <year>2010</year>
        <publisher-name>Chapman and Hall</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B33">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Johnson</surname>
          <given-names>S</given-names>
        </name>
        <article-title>Hierarchical clustering schemes</article-title>
        <source>Psychometrika</source>
        <year>1967</year>
        <volume>32</volume>
        <issue>3</issue>
        <fpage>241</fpage>
        <lpage>254</lpage>
        <pub-id pub-id-type="doi">10.1007/BF02289588</pub-id>
        <pub-id pub-id-type="pmid">5234703</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B34">
      <mixed-citation publication-type="other">
        <name>
          <surname>Achawanantakun</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Takyar</surname>
          <given-names>SS</given-names>
        </name>
        <name>
          <surname>Sun</surname>
          <given-names>Y</given-names>
        </name>
        <article-title>Grammar string: a novel ncRNA secondary structure representation</article-title>
        <source>lifesciences society org</source>
        <year>2010</year>
        <fpage>2</fpage>
        <lpage>13</lpage>
      </mixed-citation>
    </ref>
    <ref id="B35">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Achawanantakun</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Sun</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Takyar</surname>
          <given-names>SS</given-names>
        </name>
        <article-title>ncRNA consensus secondary structure derivation using grammar strings</article-title>
        <source>J Bioinformatics and Computational Biology</source>
        <year>2011</year>
        <volume>9</volume>
        <issue>2</issue>
        <fpage>317</fpage>
        <lpage>337</lpage>
        <pub-id pub-id-type="doi">10.1142/S0219720011005501</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B36">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Bai</surname>
          <given-names>F</given-names>
        </name>
        <name>
          <surname>Li</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Wang</surname>
          <given-names>T</given-names>
        </name>
        <article-title>A new mapping rule for RNA secondary structures with its applications</article-title>
        <source>J Math Chem</source>
        <year>2008</year>
        <volume>43</volume>
        <fpage>932</fpage>
        <lpage>943</lpage>
        <pub-id pub-id-type="doi">10.1007/s10910-007-9303-1</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B37">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Zuker</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Stiegler</surname>
          <given-names>P</given-names>
        </name>
        <article-title>Optimal computer folding of large RNA sequences using thermodynamics and auxiliary information</article-title>
        <source>Nucl Acids Res</source>
        <year>1981</year>
        <volume>9</volume>
        <fpage>133</fpage>
        <lpage>148</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/9.1.133</pub-id>
        <pub-id pub-id-type="pmid">6163133</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B38">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Chang</surname>
          <given-names>CC</given-names>
        </name>
        <name>
          <surname>Lin</surname>
          <given-names>CJ</given-names>
        </name>
        <article-title>LIBSVM: A library for support vector machines</article-title>
        <source>ACM Transactions on Intelligent Systems and Technology</source>
        <year>2011</year>
        <volume>2</volume>
        <fpage>27:1</fpage>
        <lpage>27:27</lpage>
      </mixed-citation>
    </ref>
    <ref id="B39">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Witwer</surname>
          <given-names>C</given-names>
        </name>
        <name>
          <surname>Hofacker</surname>
          <given-names>IL</given-names>
        </name>
        <name>
          <surname>Stadler</surname>
          <given-names>PF</given-names>
        </name>
        <article-title>Prediction of consensus RNA secondary structures including pseudoknots</article-title>
        <source>IEEE/ACM Transactions on Computational Biology and Bioinformatics (TCBB)</source>
        <year>2004</year>
        <volume>1</volume>
        <issue>2</issue>
        <fpage>66</fpage>
        <lpage>77</lpage>
        <pub-id pub-id-type="doi">10.1109/TCBB.2004.22</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B40">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Ren</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Rastegari</surname>
          <given-names>B</given-names>
        </name>
        <name>
          <surname>Condon</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Hoos</surname>
          <given-names>HH</given-names>
        </name>
        <article-title>HotKnots: heuristic prediction of RNA secondary structures including pseudoknots</article-title>
        <source>RNA</source>
        <year>2005</year>
        <volume>11</volume>
        <fpage>1494</fpage>
        <lpage>1504</lpage>
        <pub-id pub-id-type="doi">10.1261/rna.7284905</pub-id>
        <pub-id pub-id-type="pmid">16199760</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
