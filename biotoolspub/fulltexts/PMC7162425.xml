<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7162425</article-id>
    <article-id pub-id-type="pmid">31626286</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btz788</article-id>
    <article-id pub-id-type="publisher-id">btz788</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Papers</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Bioimage Informatics</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Topological data analysis quantifies biological nano-structure from single molecule localization microscopy</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0003-4163-0335</contrib-id>
        <name>
          <surname>Pike</surname>
          <given-names>Jeremy A</given-names>
        </name>
        <xref ref-type="aff" rid="btz788-aff1">1</xref>
        <xref ref-type="aff" rid="btz788-aff2">2</xref>
        <xref ref-type="corresp" rid="btz788-cor1"/>
        <!--<email>j.a.pike@bham.ac.uk</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Khan</surname>
          <given-names>Abdullah O</given-names>
        </name>
        <xref ref-type="aff" rid="btz788-aff1">1</xref>
        <xref ref-type="aff" rid="btz788-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pallini</surname>
          <given-names>Chiara</given-names>
        </name>
        <xref ref-type="aff" rid="btz788-aff1">1</xref>
        <xref ref-type="aff" rid="btz788-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-8733-7842</contrib-id>
        <name>
          <surname>Thomas</surname>
          <given-names>Steven G</given-names>
        </name>
        <xref ref-type="aff" rid="btz788-aff1">1</xref>
        <xref ref-type="aff" rid="btz788-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Mund</surname>
          <given-names>Markus</given-names>
        </name>
        <xref ref-type="aff" rid="btz788-aff3">3</xref>
        <xref ref-type="aff" rid="btz788-aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ries</surname>
          <given-names>Jonas</given-names>
        </name>
        <xref ref-type="aff" rid="btz788-aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Poulter</surname>
          <given-names>Natalie S</given-names>
        </name>
        <xref ref-type="aff" rid="btz788-aff1">1</xref>
        <xref ref-type="aff" rid="btz788-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Styles</surname>
          <given-names>Iain B</given-names>
        </name>
        <xref ref-type="aff" rid="btz788-aff1">1</xref>
        <xref ref-type="aff" rid="btz788-aff5">5</xref>
        <xref ref-type="corresp" rid="btz788-cor1"/>
        <!--<email>i.b.styles@bham.ac.uk</email>-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Murphy</surname>
          <given-names>Robert</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btz788-aff1"><label>1</label><institution>Centre of Membrane Proteins and Receptors (COMPARE), Universities of Birmingham and Nottingham</institution>, Midlands, <country country="GB">UK</country></aff>
    <aff id="btz788-aff2"><label>2</label><institution>Institute of Cardiovascular Sciences, College of Medical and Dental Sciences, University of Birmingham</institution>, Birmingham B15 2TT, <country country="GB">UK</country></aff>
    <aff id="btz788-aff3"><label>3</label><institution>Cell Biology and Biophysics Unit, European Molecular Biology Laboratory (EMBL)</institution>, Heidelberg 69117, <country country="DE">Germany</country></aff>
    <aff id="btz788-aff4"><label>4</label><institution>Department of Biochemistry, University of Geneva</institution>, 1211 Geneva 4, <country country="CH">Switzerland</country></aff>
    <aff id="btz788-aff5"><label>5</label><institution>School of Computer Science, University of Birmingham</institution>, Birmingham B15 2TT, <country country="GB">UK</country></aff>
    <author-notes>
      <corresp id="btz788-cor1">To whom correspondence should be addressed. E-mail: <email>j.a.pike@bham.ac.uk</email> or <email>i.b.styles@bham.ac.uk</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <month>3</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-10-18">
      <day>18</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>18</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>36</volume>
    <issue>5</issue>
    <fpage>1614</fpage>
    <lpage>1621</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>12</month>
        <year>2018</year>
      </date>
      <date date-type="rev-recd">
        <day>03</day>
        <month>9</month>
        <year>2019</year>
      </date>
      <date date-type="accepted">
        <day>17</day>
        <month>10</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license license-type="cc-by" xlink:href="http://creativecommons.org/licenses/by/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btz788.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Localization microscopy data is represented by a set of spatial coordinates, each corresponding to a single detection, that form a point cloud. This can be analyzed either by rendering an image from these coordinates, or by analyzing the point cloud directly. Analysis of this type has focused on clustering detections into distinct groups which produces measurements such as cluster area, but has limited capacity to quantify complex molecular organization and nano-structure.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present a segmentation protocol which, through the application of persistence-based clustering, is capable of probing densely packed structures which vary in scale. An increase in segmentation performance over state-of-the-art methods is demonstrated. Moreover we employ persistent homology to move beyond clustering, and quantify the topological structure within data. This provides new information about the preserved shapes formed by molecular architecture. Our methods are flexible and we demonstrate this by applying them to receptor clustering in platelets, nuclear pore components, endocytic proteins and microtubule networks. Both 2D and 3D implementations are provided within RSMLM, an R package for pointillist-based analysis and batch processing of localization microscopy data.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>RSMLM has been released under the GNU General Public License v3.0 and is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/JeremyPike/RSMLM">https://github.com/JeremyPike/RSMLM</ext-link>. Tutorials for this library implemented as Binder ready Jupyter notebooks are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/JeremyPike/RSMLM-tutorials">https://github.com/JeremyPike/RSMLM-tutorials</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at <italic>Bioinformatics</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Centre of Membrane Proteins and Receptors</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>COMPARE</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Universities of Birmingham and Nottingham</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>British Heart Foundation</institution>
            <institution-id institution-id-type="DOI">10.13039/501100000274</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>CH0/03/003</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction </title>
    <p>Single molecule localization microscopy (SMLM) is a super-resolution fluorescence imaging technique capable of localizing individual molecules to approximately 20 nm. Since its introduction (<xref rid="btz788-B6" ref-type="bibr">Betzig <italic>et al.</italic>, 2006</xref>; <xref rid="btz788-B16" ref-type="bibr">Hess <italic>et al.</italic>, 2006</xref>; <xref rid="btz788-B36" ref-type="bibr">Rust <italic>et al.</italic>, 2006</xref>), SMLM has matured as a technology and is now routinely used to probe biological nano-structure and processes for a range of biological applications (<xref rid="btz788-B22" ref-type="bibr">Leterrier <italic>et al.</italic>, 2015</xref>; <xref rid="btz788-B28" ref-type="bibr">Mund <italic>et al.</italic>, 2018</xref>). After performing localization, the data from a SMLM experiment is represented by a set of spatial coordinates, each corresponding to a single detection, that form a point cloud. This can be analyzed either by rendering an image from these coordinates and using image-based analysis methods, or by analyzing the point cloud directly. Strategies for the latter have focused on the concept of clustering, either by analyzing the spatial statistics of the point cloud to confirm the presence of clustered molecules (<xref rid="btz788-B30" ref-type="bibr">Owen <italic>et al.</italic>, 2010</xref>; <xref rid="btz788-B37" ref-type="bibr">Sengupta <italic>et al.</italic>, 2011</xref>; <xref rid="btz788-B39" ref-type="bibr">Veatch <italic>et al.</italic>, 2012</xref>), or by grouping individual detections into distinct clusters (<xref rid="btz788-B2" ref-type="bibr">Andronov <italic>et al.</italic>, 2016</xref>; <xref rid="btz788-B23" ref-type="bibr">Levet <italic>et al.</italic>, 2015</xref>; <xref rid="btz788-B30" ref-type="bibr">Owen <italic>et al.</italic>, 2010</xref>). This latter approach allows per-cluster statistics such as area and detection density to be calculated.</p>
    <p>Clustering strategies commonly used for SMLM datasets estimate local detection density and construct clusters from the detections with density above a specified threshold. DBSCAN and Ripley’s K-based clustering estimate density using the number of neighbouring detections within a specified distance (<xref rid="btz788-B11" ref-type="bibr">Ester <italic>et al.</italic>, 1996</xref>; <xref rid="btz788-B30" ref-type="bibr">Owen <italic>et al.</italic>, 2010</xref>), whereas Voronoï diagram-based clustering uses the area of the tiles in the associated tessellation (<xref rid="btz788-B2" ref-type="bibr">Andronov <italic>et al.</italic>, 2016</xref>; <xref rid="btz788-B23" ref-type="bibr">Levet <italic>et al.</italic>, 2015</xref>). The free parameters, a density threshold and sometimes a distance scale, can be set manually or automatically using mean cluster density (<xref rid="btz788-B23" ref-type="bibr">Levet <italic>et al.</italic>, 2015</xref>) or Monte-Carlo simulations (<xref rid="btz788-B2" ref-type="bibr">Andronov <italic>et al.</italic>, 2016</xref>). If assumptions can be made about the distribution and shape of the clusters, a Bayesian engine can be used to set parameters (<xref rid="btz788-B35" ref-type="bibr">Rubin-Delanchy <italic>et al.</italic>, 2015</xref>). However, biological data is complex, often containing structures of significantly varying density. For such data a single density threshold is not sufficient and a multi-scale approach is required. Clustering algorithms can be repeated, using different parameter values, to segment structures at different densities, for example cells, organelles and protein clusters (<xref rid="btz788-B23" ref-type="bibr">Levet <italic>et al.</italic>, 2015</xref>). An alternative approach to density thresholding is to identify clusters based on persistence, or topographic prominence (<xref rid="btz788-B7" ref-type="bibr">Chazal <italic>et al.</italic>, 2013</xref>). This strategy has shown promise for SMLM datasets in the context of Ripley’s K-based clustering (<xref rid="btz788-B14" ref-type="bibr">Griffié <italic>et al.</italic>, 2015</xref>, <xref rid="btz788-B15" ref-type="bibr">2017</xref>).</p>
    <p>A further limitation of current clustering approaches is that topological information and higher order structure is not considered. Topological data analysis (TDA) provides a robust mathematical framework for probing the topology, or shape, of a point cloud. In this work we employ, and extend, methods from TDA, specifically persistence-based clustering (<xref rid="btz788-B7" ref-type="bibr">Chazal <italic>et al.</italic>, 2013</xref>) and persistent homology (<xref rid="btz788-B10" ref-type="bibr">Edelsbrunner <italic>et al.</italic>, 2002</xref>; <xref rid="btz788-B13" ref-type="bibr">Ghrist, 2007</xref>; <xref rid="btz788-B40" ref-type="bibr">Zomorodian and Carlsson, 2005</xref>), to quantify clustering and topological structure within SMLM datasets at a range of scales and densities. We demonstrate their ability to outperform existing methods and reveal new insight into biological nano-structure. Our clustering workflow is used to show a decrease in the area of platelet integrin <inline-formula id="IE1"><mml:math id="IM1"><mml:mrow><mml:mo>α</mml:mo><mml:mn>2</mml:mn><mml:mo>β</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> clusters when the tyrosine kinase Syk is inhibited. Additionally our persistent homology methodology is used to quantify topological structure for endocytic proteins and nuclear pore complex components. The tools are made available to the community as an R package.</p>
  </sec>
  <sec>
    <title>2 System and results</title>
    <sec>
      <title>2.1 Persistence-based clustering outperforms existing approaches</title>
      <p>In common with many existing approaches, the first step in persistence-based clustering is the calculation of an underlying density estimate, <italic>f</italic> (<xref rid="btz788-B7" ref-type="bibr">Chazal <italic>et al.</italic>, 2013</xref>). Detections are assigned to local maxima within the density estimate by following the gradient of the density along a specified graph, a collection of points (detections) and lines linking pairs of points. This approach is known as mode seeking and facilitates the separation of clusters in close proximity (<xref rid="btz788-B20" ref-type="bibr">Koontz <italic>et al.</italic>, 1976</xref>). Mode seeking produces a collection of candidate clusters, or density modes. The maximum detection density within each candidate defines the birth density, <italic>f<sub>b</sub></italic>, and the saddle point at which the candidate connects to a neighbouring candidate with higher birth density defines the death density, <italic>f<sub>d</sub></italic> (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>). For each candidate the persistence is defined as the difference between the birth density and the death density; <inline-formula id="IE2"><mml:math id="IM2"><mml:mrow><mml:mi>P</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>b</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mi>d</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
      <p>Finally a persistence threshold, <italic>τ</italic>, is specified and candidate clusters with <inline-formula id="IE3"><mml:math id="IM3"><mml:mrow><mml:mi>P</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>τ</mml:mo></mml:mrow></mml:math></inline-formula> are merged to a neighbouring candidate with <inline-formula id="IE4"><mml:math id="IM4"><mml:mrow><mml:mi>P</mml:mi><mml:mo>≥</mml:mo><mml:mo>τ</mml:mo></mml:mrow></mml:math></inline-formula>. Candidate clusters with <inline-formula id="IE5"><mml:math id="IM5"><mml:mrow><mml:mi>P</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>τ</mml:mo></mml:mrow></mml:math></inline-formula> which cannot be linked to a candidate with <inline-formula id="IE6"><mml:math id="IM6"><mml:mrow><mml:mi>P</mml:mi><mml:mo>≥</mml:mo><mml:mo>τ</mml:mo></mml:mrow></mml:math></inline-formula> are considered to be noise. This clustering scheme is named the Topological Mode Analysis Tool (ToMATo) and is analogous to local thresholding of the density estimate (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S1 and S2</xref>). Further algorithmic details can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref> and the original publication (<xref rid="btz788-B7" ref-type="bibr">Chazal <italic>et al.</italic>, 2013</xref>). A key advantage of ToMATo is the ability to segment clusters which are close together even if they vary in density.</p>
      <p>To evaluate ToMATo on SMLM data we generated realistic simulated dSTORM datasets of Gaussian clusters. Low, high and mixed (a mixture of high and low) density clusters were generated, either in close proximity or well separated (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S3</xref>). Local detection density was estimated by counting the number of detections within a fixed radius, and candidate clusters were constructed from the graph linking all detections within the same search radius (<xref ref-type="fig" rid="btz788-F1">Fig. 1a and b</xref>). With our implementation of ToMATo there are two free parameters; the search radius and the persistence threshold, <italic>τ</italic>. To enable the selection of a suitable persistence threshold a scatter plot of the death and birth densities for each candidate cluster can be plotted, this is known as a ToMATo (persistence) diagram (<xref ref-type="fig" rid="btz788-F1">Fig. 1c</xref>). Further guidance on parameter selection can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>.</p>
      <fig id="btz788-F1" orientation="portrait" position="float">
        <label>Fig. 1.</label>
        <caption>
          <p>Persistence-based clustering for SMLM data. (<bold>a</bold>) 2D dSTORM simulation of four Gaussian clusters in close proximity with unequal variance (mixed density). The first step in the ToMATo algorithm is the calculation of detection density which is estimated by counting the number of neighboring detections within a fixed search radius, here set to the optimal value of 19 nm. Scale-bar 50 nm. (<bold>b</bold>) Detections are assigned to local maxima in the density estimate using a mode seeking approach. These density modes form candidate clusters. (<bold>c</bold>) ToMATo diagram showing the birth and death density for each candidate cluster. The birth density corresponds to the maximum detection density within the candidate, and the death density is the level at which the candidate merges to a stronger neighbouring cluster. The difference between the birth and death density defines the persistence of the candidate cluster and is represented on the diagram as the vertical distance from the diagonal. A persistence threshold is chosen below which clusters are merged (dotted line). Here this is set to the optimal value of 6 detections. The highest peak in each connected component resides at death density <inline-formula id="IE7"><mml:math id="IM7"><mml:mrow><mml:mo>−</mml:mo><mml:mo>∞</mml:mo></mml:mrow></mml:math></inline-formula>. The colour bar represents the number of candidate clusters at a specified birth: death density, this is needed if more than more candidate is located at the same position on the diagram. (<bold>d</bold>) Final ToMATo clustering results after cluster merging. Noise detections, shown in black, are assigned when detections cannot be merged to a cluster above the persistence threshold. (<bold>e</bold>) Performance of clustering algorithms was quantified as the percentage of correctly assigned detections. Six different scenarios were simulated: low, mixed and high density clusters either in close proximity, or well separated (Sep.). For each scenario twenty simulations were analyzed and the maximal performance (averaged across simulations) for all parameter sets is shown. (<bold>f</bold>) Performance of ToMATo and DBSCAN across all tested parameters for the mixed density dataset</p>
        </caption>
        <graphic xlink:href="btz788f1"/>
      </fig>
      <p>We compared persistence-based clustering to existing routinely used approaches, specifically DBSCAN (<xref rid="btz788-B11" ref-type="bibr">Ester <italic>et al.</italic>, 1996</xref>), Ripley’s K-based clustering (<xref rid="btz788-B30" ref-type="bibr">Owen <italic>et al.</italic>, 2010</xref>; <xref rid="btz788-B35" ref-type="bibr">Rubin-Delanchy <italic>et al.</italic>, 2015</xref>) and Voronoï tessellation (<xref rid="btz788-B2" ref-type="bibr">Andronov <italic>et al.</italic>, 2016</xref>; <xref rid="btz788-B23" ref-type="bibr">Levet <italic>et al.</italic>, 2015</xref>). A range of free parameters were used for each simulation scenario and algorithm. Performance was quantified as the percentage of correctly assigned detections and averaged over repeated simulations (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S4</xref>). ToMATo significantly outperforms these existing approaches in challenging scenarios when clusters are close together (<xref ref-type="fig" rid="btz788-F1">Fig. 1e</xref>). For the easier simulations where clusters are well separated it performs equally well. Moreover ToMATo is less sensitive to small changes in the choice of free parameters (<xref ref-type="fig" rid="btz788-F1">Fig. 1f</xref>).</p>
      <p>In biological applications it is common to have structures which are close together. These results demonstrate that persistence-based clustering is the highest performing and most stable of the tested algorithms for SMLM cluster analysis under these conditions. To better understand the sources of error for the ToMATo approach we classified detection assignment errors as either false positives, false negatives or incorrect cluster assignments (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>). For scenarios where clusters were well separated the prevalent source of error was noise detections being assigned to clusters (false positives). This is because the overall error rate is low and randomly positioned noise detections which lie within the vicinity of clusters are not easily identified. As expected, when clusters are close together the prevalent source of error was incorrect cluster assignment.</p>
      <p>To better understand the benefits and limitations of ToMATo clustering for SMLM data further simulations were performed where either the cluster separation, density, or signal to noise ratio (SNR) was varied (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S5–S7</xref>). In the latter two cases clusters were well separated. For each algorithm a range of parameters were tested but fixed for the variations in cluster separation, density or SNR. When cluster separation was varied ToMATo outperformed the other tested algorithms with a large maximal performance increase of 36% at 60 nm cluster separation. When cluster density was varied ToMATo performed at least as well as the other tested algorithms. When the SNR was varied Ripley’s K-based clustering was the highest performing algorithm with a small maximal performance increase of 3.2% over ToMATo. This highlights a limitation of the ToMATo approach. If the SNR varies significantly within your data we recommend optimizing experimental conditions to reduce variation and pre-filtering detections based on density (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S7</xref>).</p>
      <p>Persistence-based clustering is not limited to a particular structure, or shape, and is capable of segmenting non-circular objects such as microtubules, or even whole cells (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S8</xref>). However when working with fibrous structures specialized techniques such as those developed by <xref rid="btz788-B31" ref-type="bibr">Peters <italic>et al.</italic> (2017)</xref> should be considered.</p>
    </sec>
    <sec>
      <title>2.2 Syk inhibition reduces the area of integrin α2β1 clusters in platelets</title>
      <p>To demonstrate the use of persistence-based clustering on real SMLM datasets we segment nano-structures of integrin <inline-formula id="IE9"><mml:math id="IM8"><mml:mrow><mml:mo>α</mml:mo><mml:mn>2</mml:mn><mml:mo>β</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> in platelets seeded on collagen fibres (<xref ref-type="fig" rid="btz788-F2">Fig. 2a and b</xref>). Integrin <inline-formula id="IE10"><mml:math id="IM9"><mml:mrow><mml:mo>α</mml:mo><mml:mn>2</mml:mn><mml:mo>β</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, a platelet collagen receptor, accumulates at collagen fibres in spread platelets as shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S9</xref> (<xref rid="btz788-B33" ref-type="bibr">Poulter <italic>et al.</italic>, 2017</xref>). Within a single platelet there are areas with sparse or tightly packed <inline-formula id="IE11"><mml:math id="IM10"><mml:mrow><mml:mo>α</mml:mo><mml:mn>2</mml:mn><mml:mo>β</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> clusters due to differences in the underlying collagen distribution. This therefore represents a difficult multi-density segmentation problem. Stable platelet adhesion to collagen via <inline-formula id="IE12"><mml:math id="IM11"><mml:mrow><mml:mo>α</mml:mo><mml:mn>2</mml:mn><mml:mo>β</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> under flow conditions is dependent on the presence of the cytoskeletal adapter protein talin, which links integrins to the actin cytoskeleton (<xref rid="btz788-B3" ref-type="bibr">Beckerle <italic>et al.</italic>, 1989</xref>; <xref rid="btz788-B32" ref-type="bibr">Petrich <italic>et al.</italic>, 2007</xref>). We disrupted the cortical actin organization using the tyrosine kinase Syk inhibitor PRT060318 (<xref rid="btz788-B18" ref-type="bibr">Jaumouillé <italic>et al.</italic>, 2014</xref>; <xref rid="btz788-B34" ref-type="bibr">Reilly <italic>et al.</italic>, 2011</xref>), which we hypothesized would interfere with <inline-formula id="IE13"><mml:math id="IM12"><mml:mrow><mml:mo>α</mml:mo><mml:mn>2</mml:mn><mml:mo>β</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> clustering on collagen fibres. Syk inhibition results in a significant reduction in mean cluster area, however, no significant difference in cluster density was observed (<xref ref-type="fig" rid="btz788-F2">Fig. 2c</xref>). A visual comparison with other segmentation methods is shown in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S10</xref> and computational time is compared in <xref ref-type="supplementary-material" rid="sup1">Supplementary Table S2</xref>.</p>
      <fig id="btz788-F2" orientation="portrait" position="float">
        <label>Fig. 2.</label>
        <caption>
          <p>Syk inhibition reduces the mean area of integrin <inline-formula id="IE14"><mml:math id="IM13"><mml:mrow><mml:mo>α</mml:mo><mml:mn>2</mml:mn><mml:mo>β</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> clusters. (<bold>a</bold>) Platelets were seeded onto collagen fibres and treated with either the Syk inhibitor PRT060318, or a DMSO control. The sample was immunolabelled for integrin <inline-formula id="IE15"><mml:math id="IM14"><mml:mrow><mml:mo>α</mml:mo><mml:mn>2</mml:mn><mml:mo>β</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, secondary labelled with AlexaFluor647 and imaged using dSTORM. Persistence-based clustering (ToMATo) was used to segment integrin <inline-formula id="IE16"><mml:math id="IM15"><mml:mrow><mml:mo>α</mml:mo><mml:mn>2</mml:mn><mml:mo>β</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> nano-structures. Representative dSTORM image reconstructions, density estimates and clustering results (noise not shown). The search radius for the calculation of the density estimate and linking graph was set to 20 nm. Scale-bar 500 nm. (<bold>b</bold>) ToMATo diagrams showing the birth and death density for each candidate cluster. Dotted line shows the chosen persistence threshold for merging of clusters (10 detections). (<bold>c</bold>) Mean cluster area and cluster density. N = 3, four fields of view per replicate. The entire field of view was analyzed and mean cluster statistics were computed for all clusters in a replicate. Comparisons by two-sample <italic>t</italic>-test (*<italic>P </italic>&lt;<italic> </italic>0.05), error bars are mean ± SD</p>
        </caption>
        <graphic xlink:href="btz788f2"/>
      </fig>
    </sec>
    <sec>
      <title>2.3 Persistent homology quantifies topological nano-structure</title>
      <p>SMLM data is information rich and contains more structural insight than is available through cluster analysis alone. Here we use persistent homology to extract complementary topological information from the data (<xref rid="btz788-B10" ref-type="bibr">Edelsbrunner <italic>et al.</italic>, 2002</xref>; <xref rid="btz788-B13" ref-type="bibr">Ghrist, 2007</xref>; <xref rid="btz788-B40" ref-type="bibr">Zomorodian and Carlsson, 2005</xref>). The concept of a graph can be extended to a higher dimensional structure, known as a simplicial complex. A simplicial complex is constructed from points, lines, triangles, tetrahedrons and equivalent higher order structures, collectively known as simplices. For SMLM data we build the simplicial complex on top of the point cloud formed by the detection list. There are a variety of methods for building complexes but this work focuses on the Rips complex, an abstract simplicial complex chosen for its efficient computation and storage. If each point within a candidate simplex (two points for a line and three for a triangle) is within a search distance of every other point, then the simplex is included in the complex. From the Rips complex the topological features of the underlying point cloud can be computed as a function of search distance, or scale. We will refer to this collection of features as the topological configuration. First order features correspond to the number of connected components in the complex, second order to the number of <italic>holes</italic> or <italic>loops</italic>. When working with 3D datasets, the third order features are enclosed <italic>voids</italic>.</p>
      <p>Computing the topological structure within the data at a single scale is not very informative; any given feature could be unstable due to small variations in scale and it is not possible to capture multi-scale structure. To overcome this the Rips complex is computed for a range of scales, a process known as a filtration (<xref ref-type="supplementary-material" rid="sup1">Supplementary Video S1</xref> and <xref ref-type="fig" rid="btz788-F3">Fig. 3a and b</xref>). The birth scale of a feature is defined as the scale at which the feature forms in the filtration. Similarly, the death scale is defined as the scale at which the feature closes, or ceases. To summarize the information present in a filtration, the death scale and birth scale of each topological feature is plotted in a persistence diagram (<xref ref-type="fig" rid="btz788-F3">Fig. 3c</xref>). The persistence of a feature is defined as the difference between the death and birth scales. The more robust a feature is to changes in scale, the greater it’s persistence, and the greater the distance from the diagonal of the diagram. Fragile features, typically noise, will have low persistence and be located close to the diagonal. Therefore thresholding features by persistence selects only the most robust, a procedure known as persistent homology (<xref rid="btz788-B10" ref-type="bibr">Edelsbrunner <italic>et al.</italic>, 2002</xref>; <xref rid="btz788-B13" ref-type="bibr">Ghrist, 2007</xref>; <xref rid="btz788-B40" ref-type="bibr">Zomorodian and Carlsson, 2005</xref>).</p>
      <fig id="btz788-F3" orientation="portrait" position="float">
        <label>Fig. 3.</label>
        <caption>
          <p>Persistent homology for topological analysis of clusters in SMLM datasets. (<bold>a</bold>) Illustrative example where detections are spaced evenly on the circumference of two circles. Scale-bar 10 arbitrary units (a.u.). (<bold>b</bold>) Building a filtration. Balls of varying diameter were placed at each detection (top) and the Rips complexes (bottom) were determined by the overlap of these balls. The filtration was evaluated for all integer values between 1 and 60 a.u. Without the filtration, it would be difficult to choose a scale which fully encapsulates the clustering and topology of the data. Simplex colour is set by the detection density estimate and is only for display purposes. (<bold>c</bold>) The persistence diagram summarizes structure within the filtration. The birth and death scales for each hole are shown. The persistence threshold is shown as a dotted line and there are two significant holes above this threshold. (<bold>d</bold>) Simulations for randomly distributed molecules, Gaussian clusters and rings with 60 nm radius were segmented using ToMATo. For each cluster a filtration was constructed and the corresponding persistence diagrams are shown. All holes have been grouped into a single persistence diagram per scenario. A persistence threshold of 15 nm was applied to all scenarios (dotted line). Scale-bar 100 nm. (<bold>e</bold>) Mean number of clusters and cluster area. Error bars are mean ± SD (<bold>f</bold>) Percentage of clusters with specified number of holes for each scenario. This was calculated using either the full diagram, the sub-sampled consensus, or the sub-sampled consensus with agreement &gt; 90%. (<bold>g</bold>) Averaged radial distribution for clusters with agreement &gt; 90%. As expected the peak of the profile for the ring simulation lies at 60 nm</p>
        </caption>
        <graphic xlink:href="btz788f3"/>
      </fig>
      <p>Before performing persistent homology it is advantageous to perform a cluster analysis to segment the data into nano-structures (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S11</xref>). This helps with interpretation of the results, and also reduces the computational cost (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S3</xref>). For each cluster a filtration is performed and a persistence diagram calculated. The number of features above the persistence threshold can then be counted for each cluster. SMLM data is inherently noisy and complex; containing labelling artifacts, significant localization uncertainty and substantial false positive rates. Persistent homology is robust to small perturbations in detection localization (<xref rid="btz788-B8" ref-type="bibr">Cohen-Steiner <italic>et al.</italic>, 2007</xref>) but not necessarily to the addition of noisy detections, or removal of true detections. To help overcome this we have developed an extension to the standard persistent homology workflow specific to SMLM. Instead of computing the persistence diagram for all detections within a cluster we sub-sample the cluster detections (with replacement) and repeatedly calculate the topological configuration for a specified persistence threshold. The sample size is set to the number of detections within the cluster. The sampling probability, <italic>p</italic>, can be weighted by detection measurements inherent to SMLM such as localization uncertainty; <inline-formula id="IE17"><mml:math id="IM16"><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mi>e</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mo>μ</mml:mo><mml:mi>w</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math></inline-formula>. <italic>w</italic> is the normalized detection localization uncertainty, scaled between 0 and 1 for all detections within the cluster. <italic>μ</italic> is a constant which throughout this study is set to <inline-formula id="IE18"><mml:math id="IM17"><mml:mrow><mml:mo>μ</mml:mo><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mn>0.1</mml:mn><mml:mo>=</mml:mo><mml:mn>2.3</mml:mn></mml:mrow></mml:math></inline-formula>. This was set such that the detection with the lowest localization uncertainty is ten times more likely to be sampled than the detection with the highest localization uncertainty. The most common configuration, the consensus and an agreement value, <italic>α</italic>, are returned. <italic>α</italic> corresponds to the percentage of sub-sampled clusters which return the consensus result and provides a confidence level for the specified topological configuration.</p>
      <p>To test our persistent homology-based workflow for SMLM data, realistic synthetic datasets were generated. Molecules were distributed according to one of three scenarios; (i) complete spatial randomness (CSR), (ii) Gaussian clusters or (iii) circular rings with molecules evenly distributed on the circumference. We used ToMATo to segment the clusters and subsequently performed our persistent homology workflow to produce persistence diagrams (<xref ref-type="fig" rid="btz788-F3">Fig. 3d and e</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Video S2</xref>). A single persistence threshold was applied to all scenarios and the number of holes for each cluster was calculated using both the full diagrams, and the sub-sampled consensus approach (<xref ref-type="fig" rid="btz788-F3">Fig. 3f</xref>). Guidance for selecting appropriate persistence thresholds can be found in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S12</xref>. The sub-sampled consensus approach produced significantly fewer incorrect classifications. Furthermore, by selecting only clusters with <inline-formula id="IE19"><mml:math id="IM18"><mml:mrow><mml:mo>α</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>90</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> the percentage of incorrect classifications was reduced further. As expected no significant difference in cluster area was found between Gaussian and ring clusters. Therefore for these simulations standard cluster statistics cannot distinguish between Gaussian and ring clusters, whereas persistent homology clearly reveals the key topological difference. Several clusters were found in the CSR scenario due to artifacts such as multiple blinking events. However no CSR clusters with holes and <inline-formula id="IE20"><mml:math id="IM19"><mml:mrow><mml:mo>α</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>90</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> were found demonstrating the robustness of our approach to noise.</p>
      <p>The topology of clusters, as defined by our workflow, can be used to filter clusters for downstream analysis. For example we can select all clusters with a single hole (<inline-formula id="IE21"><mml:math id="IM20"><mml:mrow><mml:mo>α</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>90</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>) and find the average radial distribution as shown for the ring simulations in <xref ref-type="fig" rid="btz788-F3">Figure 3f</xref>. Our workflow can also be applied to 3D SMLM datasets as demonstrated for equivalent simulations in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S13</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Video S3</xref>.</p>
    </sec>
    <sec>
      <title>2.4 Topological analysis of nuclear pore and endocytic proteins</title>
      <p>To evaluate our novel methods on real data we focused on structures for which the topology has already been well characterized through image-based particle averaging. This is appropriate as it facilitates a robust validation of the proposed workflow. Specifically we choose Nup107, a component of the nuclear and cytoplasmic rings of nuclear pore complexes (<xref rid="btz788-B24" ref-type="bibr">Li <italic>et al.</italic>, 2018</xref>; <xref rid="btz788-B29" ref-type="bibr">Otsuka <italic>et al.</italic>, 2016</xref>; <xref rid="btz788-B38" ref-type="bibr">Szymborska <italic>et al.</italic>, 2013</xref>), and three different proteins of the yeast endocytic machinery; Las17, Ede1 and Sla1 (<xref rid="btz788-B28" ref-type="bibr">Mund <italic>et al.</italic>, 2018</xref>).</p>
      <p>Persistence-based clustering was used as a pre-processing step to segment either the nuclear pore complex, or endocytic sites (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S14–S16</xref>). For Nup107 both 2D and 3D dSTORM datasets were analyzed. For the 2D Nup107 dataset the resulting persistence diagram shows a large number of holes above the threshold (<xref ref-type="fig" rid="btz788-F4">Fig. 4a and b</xref>). As expected a large proportion of the clusters have a single hole topology (<xref ref-type="fig" rid="btz788-F4">Fig. 4c</xref>). However even for the sub-sampled approach, with <inline-formula id="IE22"><mml:math id="IM21"><mml:mrow><mml:mo>α</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>90</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> filtering, a significant proportion of clusters (39%) are found to have no holes. These clusters could be a result of many scenarios including clustered molecules not in a pore complex, imaging artifacts, unspecific labelling and variation in pore alignment. Filtering of clusters with a single hole results in an average radial profile with a peak at 50 nm, reproducing the results of imaged-based particle averaging (<xref ref-type="fig" rid="btz788-F4">Fig. 4d</xref>) (<xref rid="btz788-B38" ref-type="bibr">Szymborska <italic>et al.</italic>, 2013</xref>). No radial structure is apparent when clusters with no holes are averaged. This implies these clusters are correctly assigned by the persistent homology workflow.</p>
      <fig id="btz788-F4" orientation="portrait" position="float">
        <label>Fig. 4.</label>
        <caption>
          <p>Persistent homology quantifies the topological configuration of biological nano-structures. (<bold>a</bold>) Topological analysis of Nup107-Snap-AlexaFluor647 imaged using dSTORM. Cropped field of view showing clustering result and example Rips complex evaluated at 50 nm. Scale-bar 100 nm. (<bold>b</bold>) A threshold of 15 nm was chosen for the persistence diagram (dotted line). (<bold>c</bold>) Percentage of Nup107 clusters with specified topological configuration. This was calculated using either the full diagram, the sub-sampled consensus, or the sub-sampled consensus with agreement &gt; 90%. (<bold>d</bold>) Clusters were filtered for consensus agreement &gt; 90% and the averaged radial distribution was plotted for clusters with either one hole, no hole or both. Peak for single hole clusters at 50 nm. (<bold>e</bold>) Topological analysis of the endocytic proteins Las17, Ede1 and Sla1 in yeast. Cropped fields of view showing clustering results and example Rips complexes evaluated at 30 nm. Persistence threshold was set to 15 nm (dotted lines). (<bold>f</bold>) Percentage of clusters with specified topological configuration. (<bold>g</bold>) Mean cluster area and the percentage of clusters with a single hole. Twenty fields of view were analyzed. To assess differences between endocytic proteins a one-way analysis of variance (ANOVA) was performed. If significant (<italic>P </italic>&lt;<italic> </italic>0.05) subsequent pair-wise tests between endocytic proteins were performed using the Student’s <italic>t</italic>-test. <italic>P</italic> values were corrected for multiple comparisons using the Bonferroni method (*<italic>P </italic>&lt;<italic> </italic>0.05, ***<italic>P </italic>&lt;<italic> </italic>0.001). Error bars are mean ± SD (<bold>h</bold>) Averaged radial distributions for all clusters with a single hole and consensus agreement &gt; 90%. Peak at 50 and 40 nm for Las17 and Ede1 respectively</p>
        </caption>
        <graphic xlink:href="btz788f4"/>
      </fig>
      <p>When imaged in 3D both the cytoplasmic and nuclear rings of the complex must be considered. Both rings should have the topology of a cylinder and contain a single hole and no enclosed voids. When our method is applied to 3D data we observe large numbers of structures with no topological features (81%). However a significant number of clusters have single holes (17%) and a small percentage have two holes (1%) (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S16</xref>). No structures had enclosed voids. The quoted percentages are for the sub-sampled approach with <inline-formula id="IE23"><mml:math id="IM22"><mml:mrow><mml:mo>α</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>90</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula> filtering.</p>
      <p>In a recent study the actin nucleation promoting factor Las17, was shown to have a clear ring profile when many endocytic sites are averaged, whereas the coat protein Sla1 does not (<xref rid="btz788-B28" ref-type="bibr">Mund <italic>et al.</italic>, 2018</xref>). It was also shown that Ede1 is recruited to sites in the early stages of endocytosis, and clusters are not uniform in size and shape, hence a ring like topology is not clear from image-based particle averaging without filtering of clusters. We take data from this study, where endocytic proteins in yeast were endogenously labelled with a photoconvertible fluorescent protein and imaged using a homebuilt SMLM system, and apply our novel topological analysis workflow. <xref ref-type="fig" rid="btz788-F4">Figure 4e</xref> shows example cluster results and persistence diagrams for all three proteins. From visual inspection of the diagrams it is clear that both Las17 and Ede1 clusters have large numbers of holes, whereas Sla1 clusters do not. Quantification of the percentage of clusters with holes reveals a significant difference between all three proteins with Las17 having the highest percentage of single hole clusters and Sla1 the lowest (<xref ref-type="fig" rid="btz788-F4">Fig. 4f and g</xref>). The averaged radial profile of single hole clusters (<inline-formula id="IE24"><mml:math id="IM23"><mml:mrow><mml:mo>α</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>90</mml:mn><mml:mo>%</mml:mo></mml:mrow></mml:math></inline-formula>) for Las17 and Ede1 have a clear ring structure with maximum at 50 and 40 nm respectively, confirming the results of imaged-based analysis (<xref ref-type="fig" rid="btz788-F4">Fig. 4h</xref>). Together these results demonstrate that our method is able to accurately and efficiently quantify nano-scale topology in SMLM datasets.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Implementation</title>
    <sec>
      <title>3.1 RSMLM: R package for analysis of SMLM datasets</title>
      <p>To complement this study we have released RSMLM, an R package for the pointillist-based analysis of SMLM data. This package includes the methods described in this paper for persistence-based clustering (ToMATo), alongside DBSCAN, Voronoï tessellation and Ripley’s K-based clustering. Utility methods for persistent homology including the sub-sampling consensus approach are provided. There is also the capacity to simulate dSTORM data. This library will provide an adaptable framework for analysing and batch processing both 2D, and 3D, SMLM datasets. Binder ready Jupyter notebook tutorials are provided to facilitate easy use of the package. The functionality of the library can also be included within KNIME workflows using simple R-snippets (<xref rid="btz788-B5" ref-type="bibr">Berthold <italic>et al.</italic>, 2009</xref>). This enables users without any scripting knowledge to access the core functionality.</p>
    </sec>
    <sec>
      <title>3.2 Persistence-based clustering</title>
      <p>Persistence-based clustering, or ToMATo, was originally developed by (<xref rid="btz788-B7" ref-type="bibr">Chazal <italic>et al.</italic>, 2013</xref>) and implemented for this work as follows. Detection density estimates were calculated by counting the number of other detections within a specified radius. This was implemented using the R package dbscan which uses the C++ library ANN to employ a k-d tree framework for efficient computation. Density modes were calculated using a mode seeking approach and a Rips graph <xref rid="btz788-B20" ref-type="bibr">Koontz <italic>et al.</italic> (1976</xref>). Modes were then merged or designated as noise based on a specified persistence threshold. This was implemented by adapting C++ scripts (GPLv3) described in <xref rid="btz788-B7" ref-type="bibr">Chazal <italic>et al.</italic> (2013)</xref>. C++ functions were incorporated into RSMLM using the R package Rcpp. For algorithm comparison the search radius ranged from 1 to 50 nm, and the persistence threshold from 0 to 50 detections. Further algorithmic details and the implementations of other clustering algorithms are described in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>.</p>
    </sec>
    <sec>
      <title>3.3 Persistent homology</title>
      <p>Rips filtrations and persistence diagrams were computed using the R package TDA which employs the C++ library GUDHI (<xref rid="btz788-B12" ref-type="bibr">Fasy <italic>et al.</italic>, 2014</xref>; <xref rid="btz788-B25" ref-type="bibr">Maria <italic>et al.</italic>, 2014</xref>). When the density of points in a persistence diagram was too high for a simple plot, features were grouped into a joint histogram with 1 nm<sup>2</sup> bins and displayed using a heat-map. Visualizations of Rips complexes were created using plex-viewer (<ext-link ext-link-type="uri" xlink:href="https://github.com/atausz/plex-viewer">https://github.com/atausz/plex-viewer</ext-link>) and the Java library javaPlex (<xref rid="btz788-B1" ref-type="bibr">Adams <italic>et al.</italic>, 2014</xref>). Filtration movies were created using POV-Ray.</p>
    </sec>
    <sec>
      <title>3.4 dSTORM simulations</title>
      <p>Fluorophore blinking characteristics were modelled using a geometric distribution with probability of transition to the dark state set to 0.5 (<xref rid="btz788-B21" ref-type="bibr">Lee <italic>et al.</italic>, 2012</xref>). Simulated molecules were bound to an average of 5 fluorophores, randomly distributed between molecules. The localization uncertainty for each blinking event was determined using a normal distribution centred on the molecule position. Standard deviation for localization uncertainty was set using a log-normal distribution with mean 2.8 and standard deviation 0.28 (experimentally measured parameters for AlexaFluor 647) (<xref rid="btz788-B27" ref-type="bibr">Mollazade <italic>et al.</italic>, 2017</xref>). Detection rate for blinking events was set to 70%. 10% false detections (noise) were added and distributed randomly across the field of view. Further simulation parameters are described in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>.</p>
    </sec>
    <sec>
      <title>3.5 Real datasets</title>
      <p>Methodological details for the dSTORM imaging of integrin <inline-formula id="IE25"><mml:math id="IM24"><mml:mrow><mml:mo>α</mml:mo><mml:mn>2</mml:mn><mml:mo>β</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> in platelets is described in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Methods</xref>. The 2D and 3D SMLM Nup107 data was recently published and described in (<xref rid="btz788-B24" ref-type="bibr">Li <italic>et al.</italic>, 2018</xref>) where Nup107–SNAP Alexa Fluor 647 was imaged using dSTORM in U-2 OS cells. 3D localization was achieved using an experimental PSF model. SMLM datasets for Las17, Ede1 and Sla1 were recently described in (<xref rid="btz788-B28" ref-type="bibr">Mund <italic>et al.</italic>, 2018</xref>). In short endocytic proteins were endogenously tagged with the photoconvertible protein mMaple (<xref rid="btz788-B26" ref-type="bibr">McEvoy <italic>et al.</italic>, 2012</xref>) in budding yeast strains and imaged in high-throughput using a homebuilt SMLM imaging system (<xref rid="btz788-B9" ref-type="bibr">Deschamps <italic>et al.</italic>, 2016</xref>). Image acquisition for <italic>α</italic>-tubulin dSTORM was performed for formalin fixed A549 cells immunofluorescence labelled for <italic>α</italic>-tubulin (Alexa-647 secondary) as previously described in <xref rid="btz788-B19" ref-type="bibr">Khan <italic>et al.</italic> (2017)</xref>. Detections in the integrin <inline-formula id="IE26"><mml:math id="IM25"><mml:mrow><mml:mo>α</mml:mo><mml:mn>2</mml:mn><mml:mo>β</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula>, <italic>α</italic>-tubulin and Nup107 datasets were filtered by intensity with a minimum value of 1000 photons. For all datasets detections that were found in consecutive frames within a distance of 75 nm were grouped into a single detection.</p>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>As single molecule methods for high throughput data acquisition (<xref rid="btz788-B4" ref-type="bibr">Beghin <italic>et al.</italic>, 2017</xref>) and sample labelling (<xref rid="btz788-B19" ref-type="bibr">Khan <italic>et al.</italic>, 2017</xref>) improve, there is a parallel need for automated, robust analytical approaches. The mathematical field of topological data analysis provides a powerful framework for structural analysis of SMLM data. We have introduced tools using both persistence-based clustering (<xref rid="btz788-B7" ref-type="bibr">Chazal <italic>et al.</italic>, 2013</xref>) and persistent homology (<xref rid="btz788-B13" ref-type="bibr">Ghrist, 2007</xref>) to quantify biological nano-structure. Empirical evidence suggests ToMATo provides superior clustering performance over commonly used algorithms for SMLM data when clusters are close together, even if clusters vary in density (<xref rid="btz788-B2" ref-type="bibr">Andronov <italic>et al.</italic>, 2016</xref>; <xref rid="btz788-B11" ref-type="bibr">Ester <italic>et al.</italic>, 1996</xref>; <xref rid="btz788-B23" ref-type="bibr">Levet <italic>et al.</italic>, 2015</xref>; <xref rid="btz788-B30" ref-type="bibr">Owen <italic>et al.</italic>, 2010</xref>). We argue that biological nano-structure is rarely simple and for many applications these conditions will be commonplace, as we show for clustering of collagen receptors in platelets. Moreover selection of free parameters is less sensitive for persistence-based clustering, and can be guided by ToMATo diagrams. Whilst Bayesian approaches (<xref rid="btz788-B35" ref-type="bibr">Rubin-Delanchy <italic>et al.</italic>, 2015</xref>) to parameter setting are very powerful when the underlying nano-structure can be modeled in advance, it is not suitable for exploratory applications where the nano-structure is not known <italic>a priori</italic>.</p>
    <p>A disadvantage of the ToMATo approach when compared to Voronoï tessellation-based clustering is that there are two free parameters to set, whereas tessellation only has one which can be normalized. The core concepts of this work could also be transferred to other clustering approaches which could be extended to threshold on persistence (<xref rid="btz788-B14" ref-type="bibr">Griffié <italic>et al.</italic>, 2015</xref>, <xref rid="btz788-B15" ref-type="bibr">2017</xref>). For example Voronoï tessellation could be used to calculate the density estimate. The dual graph of the tessellation could also be used to link detections resulting in an algorithm with only one free parameter, providing an interesting avenue for further research.</p>
    <p>Persistent homology is designed to reveal topological structure within pointillist datasets and has natural applications for the analysis of SMLM data, as also demonstrated in parallel work (<xref rid="btz788-B17" ref-type="bibr">Hofmann <italic>et al.</italic>, 2018</xref>). Our framework moves beyond per cluster statistics such as area and density to reveal new information about the underlying topological features within segmented nano-structures. Importantly, this is a multi-scale approach, revealing unbiased structural information at a range of distance scales simultaneously. Furthermore we have developed a novel extension of the standard persistent homology workflow which is based on sub-sampling of detections. This extension ensures the method is robust to SMLM artifacts and provides a confidence value for any specific result. Validation of these approaches was performed using nuclear pore and endocytic site proteins. Similar structural information can be gained from SMLM data by image-based particle averaging (<xref rid="btz788-B28" ref-type="bibr">Mund <italic>et al.</italic>, 2018</xref>; <xref rid="btz788-B38" ref-type="bibr">Szymborska <italic>et al.</italic>, 2013</xref>). However persistent homology can be used in cases where particle averaging methods may fail, for example, where the underlying structures vary in shape or size but maintains a constant topology. Persistent homology can also quantify the structure of individual clusters, not just average ensembles, and is suitable for studying smaller datasets. Finally image-based analysis workflows are typically complex with many pre-processing steps specific to the application. Our streamlined workflow requires minimal adaptation for different datasets as demonstrated throughout this study.</p>
    <p>Our methods for persistence-based clustering and persistent homology have been implemented and validated in both 2D and 3D. This framework is applicable for a wide range of problems, revealing new topological information and unprecedented insight into biological nano-structure not attainable from existing tools.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>btz788_Supplementary_Data</label>
      <media xlink:href="btz788_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors gratefully acknowledge the equipment and support provided by Deirdre Kavanagh and the Centre of Membrane Proteins and Receptors (COMPARE), Universities of Birmingham and Nottingham, Midlands, UK. Steve P Watson provided many useful comments and advice.</p>
    <sec>
      <title>Funding</title>
      <p>This work was funded by the Centre of Membrane Proteins and Receptors (COMPARE), Universities of Birmingham and Nottingham, Midlands, UK; and from the British Heart Foundation through the Chair award [CH0/03/003) to Steve P. Watson]. </p>
      <p><italic>Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="btz788-B1">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Adams</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) <chapter-title>JavaPlex: a research software package for persistent (co) homology</chapter-title> In: <source>International Congress on Mathematical Software</source>. pp. <fpage>129</fpage>–<lpage>136</lpage>. 
<publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btz788-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Andronov</surname><given-names>L.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>ClusterViSu, a method for clustering of protein complexes by Voronoi tessellation in super-resolution microscopy</article-title>. <source>Sci. Rep</source>., <volume>6</volume>, <fpage>24084.</fpage><pub-id pub-id-type="pmid">27068792</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Beckerle</surname><given-names>M.C.</given-names></name></person-group><etal>et al</etal> (<year>1989</year>) 
<article-title>Activation-dependent redistribution of the adhesion plaque protein, talin, in intact human platelets</article-title>. <source>J. Cell Biol</source>., <volume>109</volume>, <fpage>3333</fpage>–<lpage>3346</lpage>.<pub-id pub-id-type="pmid">2513330</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Beghin</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Localization-based super-resolution imaging meets high-content screening</article-title>. <source>Nat. Methods</source>, <volume>14</volume>, <fpage>1184.</fpage><pub-id pub-id-type="pmid">29083400</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Berthold</surname><given-names>M.R.</given-names></name></person-group><etal>et al</etal> (<year>2009</year>) 
<article-title>KNIME-the Konstanz information miner: version 2.0 and beyond</article-title>. <source>ACM SIGKDD Explorations Newslett</source>., <volume>11</volume>, <fpage>26</fpage>–<lpage>31</lpage>.</mixed-citation>
    </ref>
    <ref id="btz788-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Betzig</surname><given-names>E.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>Imaging intracellular fluorescent proteins at nanometer resolution</article-title>. <source>Science</source>, <volume>313</volume>, <fpage>1642</fpage>–<lpage>1645</lpage>.<pub-id pub-id-type="pmid">16902090</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Chazal</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Persistence-based clustering in Riemannian manifolds</article-title>. <source>J. ACM</source>, <volume>60</volume>, <fpage>1.</fpage></mixed-citation>
    </ref>
    <ref id="btz788-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cohen-Steiner</surname><given-names>D.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Stability of persistence diagrams</article-title>. <source>Discret. Comput. Geometry</source>, <volume>37</volume>, <fpage>103</fpage>–<lpage>120</lpage>.</mixed-citation>
    </ref>
    <ref id="btz788-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Deschamps</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Efficient homogeneous illumination and optical sectioning for quantitative single-molecule localization microscopy</article-title>. <source>Opt. Express</source>, <volume>24</volume>, <fpage>28080</fpage>–<lpage>28090</lpage>.<pub-id pub-id-type="pmid">27906373</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Edelsbrunner</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2002</year>) 
<article-title>Topological persistence and simplification</article-title>. <source>Discret. Comput. Geometry</source>, <volume>28</volume>, <fpage>511</fpage>–<lpage>533</lpage>.</mixed-citation>
    </ref>
    <ref id="btz788-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ester</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>1996</year>) 
<article-title>A density-based algorithm for discovering clusters in large spatial databases with noise</article-title>. In: <source>KDD</source>. Association for the Advancement of Artificial Intelligence (AAAI), Palo Alto, California. vol. <volume>96</volume>, pp. <fpage>226</fpage>–<lpage>231</lpage>.</mixed-citation>
    </ref>
    <ref id="btz788-B12">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Fasy</surname><given-names>B.T.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) Introduction to the R package TDA. arXiv Preprint arXiv: 1411.1830.</mixed-citation>
    </ref>
    <ref id="btz788-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Ghrist</surname><given-names>R.</given-names></name></person-group> (<year>2007</year>) 
<article-title>Barcodes: the persistent topology of data</article-title>. <source>Bull. Am. Math. Soc</source>., <volume>45</volume>, <fpage>61</fpage>–<lpage>75</lpage>.</mixed-citation>
    </ref>
    <ref id="btz788-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Griffié</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Topographic prominence as a method for cluster identification in single-molecule localisation data</article-title>. <source>J. Biophotonics</source>, <volume>8</volume>, <fpage>925</fpage>–<lpage>934</lpage>.<pub-id pub-id-type="pmid">25663080</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Griffié</surname><given-names>J.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>3D Bayesian cluster analysis of super-resolution data reveals LAT recruitment to the T cell synapse</article-title>. <source>Sci. Rep</source>., <volume>7</volume>, <fpage>4077.</fpage><pub-id pub-id-type="pmid">28642595</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hess</surname><given-names>S.T.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>Ultra-high resolution imaging by fluorescence photoactivation localization microscopy</article-title>. <source>Biophys. J</source>., <volume>91</volume>, <fpage>4258</fpage>–<lpage>4272</lpage>.<pub-id pub-id-type="pmid">16980368</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Hofmann</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Using persistent homology as a new approach for super-resolution localization microscopy data analysis and classification of <italic>γ</italic>H2AX foci/clusters</article-title>. <source>Int. J. Mol. Sci</source>., <volume>19</volume>, <fpage>2263</fpage>.</mixed-citation>
    </ref>
    <ref id="btz788-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jaumouillé</surname><given-names>V.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Actin cytoskeleton reorganization by Syk regulates Fc<italic>γ</italic> receptor responsiveness by increasing its lateral mobility and clustering</article-title>. <source>Dev. Cell</source>, <volume>29</volume>, <fpage>534</fpage>–<lpage>546</lpage>.<pub-id pub-id-type="pmid">24914558</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Khan</surname><given-names>A.O.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>CRISPR-Cas9 mediated labelling allows for single molecule imaging and resolution</article-title>. <source>Sci. Rep</source>., <volume>7</volume>, <fpage>8450.</fpage><pub-id pub-id-type="pmid">28814796</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Koontz</surname><given-names>W.L.G.</given-names></name></person-group><etal>et al</etal> (<year>1976</year>) 
<article-title>A graph-theoretic approach to nonparametric cluster analysis</article-title>. <source>IEEE Trans. Comput</source>., <volume>9</volume>, <fpage>936</fpage>–<lpage>944</lpage>.</mixed-citation>
    </ref>
    <ref id="btz788-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>S.-H.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Counting single photoactivatable fluorescent molecules by photoactivated localization microscopy (PALM)</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>109</volume>, <fpage>17436.</fpage><pub-id pub-id-type="pmid">23045631</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Leterrier</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Nanoscale architecture of the axon initial segment reveals an organized and robust scaffold</article-title>. <source>Cell Rep</source>., <volume>13</volume>, <fpage>2781</fpage>–<lpage>2793</lpage>.<pub-id pub-id-type="pmid">26711344</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Levet</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>SR-Tesseler: a method to segment and quantify localization-based super-resolution microscopy data</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>1065.</fpage><pub-id pub-id-type="pmid">26344046</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Real-time 3D single-molecule localization using experimental point spread functions</article-title>. <source>Nat. Methods</source>, <volume>15</volume>, <fpage>367.</fpage><pub-id pub-id-type="pmid">29630062</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B25">
      <mixed-citation publication-type="book"><person-group person-group-type="author"><name name-style="western"><surname>Maria</surname><given-names>C.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) <chapter-title>The GUDHI library: simplicial complexes and persistent homology</chapter-title> In: <source>International Congress on Mathematical Software</source>. pp. <fpage>167</fpage>–<lpage>174</lpage>. 
<publisher-name>Springer</publisher-name>.</mixed-citation>
    </ref>
    <ref id="btz788-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>McEvoy</surname><given-names>A.L.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>mMaple: a photoconvertible fluorescent protein for use in multiple imaging modalities</article-title>. <source>PLoS One</source>, <volume>7</volume>, <fpage>e51314.</fpage><pub-id pub-id-type="pmid">23240015</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mollazade</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Can single molecule localization microscopy be used to map closely spaced RGD nanodomains?</article-title><source>PLoS One</source>, <volume>12</volume>, <fpage>e0180871.</fpage><pub-id pub-id-type="pmid">28723958</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Mund</surname><given-names>M.</given-names></name></person-group><etal>et al</etal> (<year>2018</year>) 
<article-title>Systematic nanoscale analysis of endocytosis links efficient vesicle formation to patterned actin nucleation</article-title>. <source>Cell</source>, <volume>174</volume>, <fpage>884</fpage>–<lpage>896</lpage>.<pub-id pub-id-type="pmid">30057119</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Otsuka</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2016</year>) 
<article-title>Nuclear pore assembly proceeds by an inside-out extrusion of the nuclear envelope</article-title>. <source>Elife</source>, <volume>5</volume>, <fpage>e19071.</fpage><pub-id pub-id-type="pmid">27630123</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Owen</surname><given-names>D.M.</given-names></name></person-group><etal>et al</etal> (<year>2010</year>) 
<article-title>PALM imaging and cluster analysis of protein heterogeneity at the cell surface</article-title>. <source>J. Biophotonics</source>, <volume>3</volume>, <fpage>446</fpage>–<lpage>454</lpage>.<pub-id pub-id-type="pmid">20148419</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Peters</surname><given-names>R.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Quantification of fibrous spatial point patterns from single-molecule localization microscopy (SMLM) data</article-title>. <source>Bioinformatics</source>, <volume>33</volume>, <fpage>1703</fpage>–<lpage>1711</lpage>.<pub-id pub-id-type="pmid">28108449</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Petrich</surname><given-names>B.G.</given-names></name></person-group><etal>et al</etal> (<year>2007</year>) 
<article-title>Talin is required for integrin-mediated platelet function in hemostasis and thrombosis</article-title>. <source>J. Exp. Med</source>., <volume>204</volume>, <fpage>3103</fpage>–<lpage>3111</lpage>.<pub-id pub-id-type="pmid">18086863</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Poulter</surname><given-names>N.</given-names></name></person-group><etal>et al</etal> (<year>2017</year>) 
<article-title>Clustering of glycoprotein VI (GPVI) dimers upon adhesion to collagen as a mechanism to regulate GPVI signaling in platelets</article-title>. <source>J. Thrombosis Haemostasis</source>, <volume>15</volume>, <fpage>549</fpage>–<lpage>564</lpage>.</mixed-citation>
    </ref>
    <ref id="btz788-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Reilly</surname><given-names>M.P.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>PRT-060318, a novel Syk inhibitor, prevents heparin-induced thrombocytopenia and thrombosis in a transgenic mouse model</article-title>. <source>Blood</source>, <volume>117</volume>, <fpage>2241</fpage>–<lpage>2246</lpage>.<pub-id pub-id-type="pmid">21088136</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rubin-Delanchy</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2015</year>) 
<article-title>Bayesian cluster identification in single-molecule localization microscopy data</article-title>. <source>Nat. Methods</source>, <volume>12</volume>, <fpage>1072.</fpage><pub-id pub-id-type="pmid">26436479</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Rust</surname><given-names>M.J.</given-names></name></person-group><etal>et al</etal> (<year>2006</year>) 
<article-title>Sub-diffraction-limit imaging by stochastic optical reconstruction microscopy (storm)</article-title>. <source>Nat. Methods</source>, <volume>3</volume>, <fpage>793</fpage>–<lpage>796</lpage>.<pub-id pub-id-type="pmid">16896339</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Sengupta</surname><given-names>P.</given-names></name></person-group><etal>et al</etal> (<year>2011</year>) 
<article-title>Probing protein heterogeneity in the plasma membrane using PALM and pair correlation analysis</article-title>. <source>Nat. Methods</source>, <volume>8</volume>, <fpage>969</fpage>–<lpage>975</lpage>.<pub-id pub-id-type="pmid">21926998</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Szymborska</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>Nuclear pore scaffold structure analyzed by super-resolution microscopy and particle averaging</article-title>. <source>Science</source>, <volume>341</volume>, <fpage>655</fpage>–<lpage>658</lpage>.<pub-id pub-id-type="pmid">23845946</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Veatch</surname><given-names>S.L.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Correlation functions quantify super-resolution images and estimate apparent clustering due to over-counting</article-title>. <source>PLoS One</source>, <volume>7</volume>, <fpage>e31457.</fpage><pub-id pub-id-type="pmid">22384026</pub-id></mixed-citation>
    </ref>
    <ref id="btz788-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zomorodian</surname><given-names>A.</given-names></name>, <name name-style="western"><surname>Carlsson</surname><given-names>G.</given-names></name></person-group> (<year>2005</year>) 
<article-title>Computing persistent homology</article-title>. <source>Discrete &amp; Comput. Geometry</source>, <volume>33</volume>, <fpage>249</fpage>–<lpage>274</lpage>.</mixed-citation>
    </ref>
  </ref-list>
</back>
