<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1367-4811</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6030956</article-id>
    <article-id pub-id-type="pmid">29069297</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btx674</article-id>
    <article-id pub-id-type="publisher-id">btx674</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Notes</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Sequence Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SeqBox: RNAseq/ChIPseq reproducible analysis on a consumer game computer</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Beccuti</surname>
          <given-names>Marco</given-names>
        </name>
        <xref ref-type="aff" rid="btx674-aff1">1</xref>
        <xref ref-type="corresp" rid="btx674-cor1"/>
        <!--<email>beccuti@di.unito.it</email>-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Cordero</surname>
          <given-names>Francesca</given-names>
        </name>
        <xref ref-type="aff" rid="btx674-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Arigoni</surname>
          <given-names>Maddalena</given-names>
        </name>
        <xref ref-type="aff" rid="btx674-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Panero</surname>
          <given-names>Riccardo</given-names>
        </name>
        <xref ref-type="aff" rid="btx674-aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Amparore</surname>
          <given-names>Elvio G</given-names>
        </name>
        <xref ref-type="aff" rid="btx674-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Donatelli</surname>
          <given-names>Susanna</given-names>
        </name>
        <xref ref-type="aff" rid="btx674-aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Calogero</surname>
          <given-names>Raffaele A</given-names>
        </name>
        <xref ref-type="aff" rid="btx674-aff2">2</xref>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Birol</surname>
          <given-names>Inanc</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <aff id="btx674-aff1"><label>1</label>Department of Computer Sciences, University of Torino, Turin, Italy</aff>
    <aff id="btx674-aff2"><label>2</label>Department of Molecular Biotechnology and Health Sciences, University of Torino, Turin, Italy</aff>
    <author-notes>
      <corresp id="btx674-cor1">To whom correspondence should be addressed. Email: <email>beccuti@di.unito.it</email></corresp>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>01</day>
      <month>3</month>
      <year>2018</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2017-10-23">
      <day>23</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>23</day>
      <month>10</month>
      <year>2017</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>34</volume>
    <issue>5</issue>
    <fpage>871</fpage>
    <lpage>872</lpage>
    <history>
      <date date-type="received">
        <day>28</day>
        <month>7</month>
        <year>2017</year>
      </date>
      <date date-type="rev-recd">
        <day>12</day>
        <month>10</month>
        <year>2017</year>
      </date>
      <date date-type="accepted">
        <day>19</day>
        <month>10</month>
        <year>2017</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author 2017. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2017</copyright-year>
      <license license-type="cc-by-nc" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="btx674.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Summary</title>
        <p>Short reads sequencing technology has been used for more than a decade now. However, the analysis of RNAseq and ChIPseq data is still computational demanding and the simple access to raw data does not guarantee results reproducibility between laboratories. To address these two aspects, we developed <bold>SeqBox</bold>, a cheap, efficient and reproducible RNAseq/ChIPseq hardware/software solution based on NUC6I7KYK mini-PC (an Intel consumer game computer with a fast processor and a high performance SSD disk), and Docker container platform. In SeqBox the analysis of RNAseq and ChIPseq data is supported by a friendly GUI. This allows access to fast and reproducible analysis also to scientists with/without scripting experience.</p>
      </sec>
      <sec id="s2">
        <title>Availability and implementation</title>
        <p>Docker container images, docker4seq package and the GUI are available at <ext-link ext-link-type="uri" xlink:href="http://www.bioinformatica.unito.it/reproducibile.bioinformatics.html">http://www.bioinformatica.unito.it/reproducibile.bioinformatics.html</ext-link>.</p>
      </sec>
      <sec id="s4">
        <title>Supplementary information</title>
        <p><xref ref-type="supplementary-material" rid="sup1">Supplementary data</xref> are available at Bioinformatics online.</p>
      </sec>
    </abstract>
    <counts>
      <page-count count="2"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>Whole transcriptome sequencing (WTS) and ChIPseq made obsolete the corresponding array hybridization based technologies. Short reads sequencing technology has been used for more than a decade now, and experience shows that the main bottleneck in sequencing workflows is the time spent in analyzing and interpreting data (<xref rid="btx674-B7" ref-type="bibr">Wong <italic>et al.</italic> 2017</xref>).</p>
    <p>The primary analysis of the data, i.e. mapping short read sequences on the reference genome, is still computationally demanding and requires computer performances that are not commonly available in laptops. In particular, WTS requires a significant amount of RAM and multicores processors. The needs of high performance computing infrastructure for the analysis of sequencing data has brought to the development of cloud based analysis tools, e.g. Illumina BaseSpace (<ext-link ext-link-type="uri" xlink:href="https://basespace.illumina.com/home/index">https://basespace.illumina.com/home/index</ext-link>), Galaxy (<ext-link ext-link-type="uri" xlink:href="https://usegalaxy.org">https://usegalaxy.org</ext-link><underline>/</underline>), etc. However, cloud based solutions suffer of some criticalities, e.g. data uploading speed, limited storage space and significant computing and data transfer costs. Moreover, although all available data analysis platforms guarantee a certain level of reproducibility, typically storing the version of the software being used, tracking changes in the system libraries, which might lead to sneaky reproducibility issues, is not provided.</p>
    <p>To combine reproducible data generation with cost effective but efficient hardware we have developed <bold>SeqBox</bold>, a software/hardware ecosystem providing the most common analyses of RNAseq and ChIPseq data (i.e. genomic mapping, experimental power evaluation, differential expression, transcription factors/histone-marks peaks identification, etc.) on a consumer game computer (<xref ref-type="fig" rid="btx674-F1">Fig. 1A</xref>).
</p>
    <fig id="btx674-F1" orientation="portrait" position="float">
      <label>Fig. 1</label>
      <caption>
        <p>(<bold>A</bold>) SeqBox framework: depicting the structure of SeqBox and its functionalities from a user point of view. The analysis flows from left to right. (<bold>B</bold>) Characteristics of the hardware used to evaluate the SeqBox performances</p>
      </caption>
      <graphic xlink:href="btx674f1"/>
    </fig>
  </sec>
  <sec>
    <title>2 Materials and methods</title>
    <p><bold>The SeqBox ecosystem</bold> (<xref ref-type="fig" rid="btx674-F1">Fig. 1A</xref>) is the union of SeqBox software and SeqBox target hardware.</p>
    <p>A user can access the system either through a Java-based graphical interface (GUI, see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>), or through R console (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). Independently of the access type, the user can exploit three different workflows: RNAseq, miRNA and ChipSeq, which are managed by a Controlling Engine written in R (<xref ref-type="fig" rid="btx674-F1">Fig. 1A</xref>). The functions that realize the workflows are either standard analysis algorithms or a set of supporting functions that have been developed and included in Bioconductor packages (e.g. DESeq2, ChIPpeakAnno). The algorithms used for sequencing data analysis include STAR (<xref rid="btx674-B2" ref-type="bibr">Dobin <italic>et al.</italic>, 2013</xref>) for RNAseq genomic mapping, DESeq2 (<xref rid="btx674-B6" ref-type="bibr">Love <italic>et al.</italic>, 2014</xref>) for differential expression analysis, BWA (<xref rid="btx674-B5" ref-type="bibr">Li and Durbin, 2009</xref>) for ChIPseq genomic mapping, MACS (<xref rid="btx674-B9" ref-type="bibr">Zhang <italic>et al.</italic>, 2008</xref>), and SICER (<xref rid="btx674-B8" ref-type="bibr">Xu <italic>et al.</italic>, 2014</xref>) for ChIP peaks detection (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>). All of them are encapsulated into Docker images.</p>
    <p><bold>A Docker image</bold> is a lightweight, stand-alone, executable package that includes everything needed to run a specific software. A runtime instance of an image, called container, runs completely isolated from the host environment except for user-specified host files. The advantage of using Docker images is that the whole environment is fixed, the images are available in the Docker repository, and the identity of the images is the only element needed to reproduce the results. The execution of the Docker images, implementing the workflow chosen by the user, is done by docker4seq, a R package which embeds a set of functions providing the running parameters to the mapping and counting engine.</p>
    <p>SeqBox provides six Docker images: (i) skewer.2017.01, which uses skewer (<xref rid="btx674-B3" ref-type="bibr">Jiang <italic>et al.</italic>, 2014</xref>) for adapter trimming; (ii) rsemstar.2017.01, which uses STAR (<xref rid="btx674-B2" ref-type="bibr">Dobin <italic>et al.</italic>, 2013</xref>) to map short reads mapping on the reference genome and RSEM (<xref rid="btx674-B4" ref-type="bibr">Li and Dewey, 2011</xref>) for gene and isoform-level quantification; (iii) annotate.2017.01, which is used to associate RSEM output id with gene symbols; (iv) mirnaseq.2017.01, which implements the miRNAseq analysis workflow described in (<xref rid="btx674-B1" ref-type="bibr">Cordero, <italic>et al.</italic>, 2012</xref>); (v) r332.2017.01, which allows differential expression analysis via Bioconductor package DESeq2; (vi) chipseq.2017.01, which uses BWA (<xref rid="btx674-B5" ref-type="bibr">Li and Durbin, 2009</xref>) to map short reads on the reference genome, MACS (<xref rid="btx674-B9" ref-type="bibr">Zhang <italic>et al.</italic>, 2008</xref>) to detect transcription factors binding sites, and SICER (<xref rid="btx674-B8" ref-type="bibr">Xu <italic>et al.</italic>, 2014</xref>) to define histone-marks.</p>
    <p><bold>The GUI</bold> provides a graphical access to the docker4seq functions allowing the use of the tools to biologists without scripting experience.</p>
    <p><bold>SeqBox hardware:</bold> The parameters setting of the algorithms (in terms of memory size versus number of assigned cores) is optimized for an execution on the game computer NUC617KYK (<xref ref-type="fig" rid="btx674-F1">Fig. 1A</xref>), which is based on an Intel Core I7, featuring 4 cores running up to eight threads that share a common memory of 32 Gb and a SSD disk of 256 GB.</p>
  </sec>
  <sec>
    <title>3 Results</title>
    <p>We benchmarked SeqBox with respect to a high-end server (SGI UV2000, <xref ref-type="fig" rid="btx674-F1">Fig. 1B</xref>). The performance comparison was done for the three workflows (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S1–S3</xref>). In brief, we compared the workflows using increasing amounts of reads (see <xref ref-type="supplementary-material" rid="sup1">Supplementary Material</xref>) on SeqBox, using eight threads, and on the SGI server increasing the number of threads from 8 to 160 (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S1–S3</xref>). Parallelization provided by the SGI server did not improve very much the overall performances in the RNAseq workflow (<xref ref-type="supplementary-material" rid="sup1">Supplementary Fig. S1</xref>). SeqBox significantly outperformed the server, because of the presence of a SSD with high I/O performance which can cope with the limited parallelism of SeqBox. In the case of miRNA and ChIPseq workflows the parallelization is only available for the reads mapping procedures. The limited parallelization of these two workflows combined with the higher I/O performances of the SSD with respect to the SATA array makes SeqBox extremely effective even with very high number of reads to be processed (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figs S2 and S3</xref>).</p>
  </sec>
  <sec>
    <title>4 Conclusion</title>
    <p>The majority of the algorithms used in the considered bioinformatics workflows is strongly I/O bound and exhibits a limited exploitation of parallelism. Our experiments show that a combination of a consumer computer with a fast storage is able to over-perform a high-end server. The integration of Docker technology within a mini-PC consumer computer such as Intel NUC6I7KYK provides therefore, to small biology laboratories, a solution for Next Generation Sequence (NGS) analysis which is cheap, efficient and reproducible.</p>
  </sec>
  <sec>
    <title>Funding</title>
    <p>This work has been supported by the EPIGEN FLAG PROJECT.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>Supplementary Data</label>
      <media xlink:href="btx674_supplementary_data_revised.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ref-list>
    <title>References</title>
    <ref id="btx674-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Cordero</surname><given-names>F.</given-names></name></person-group><etal>et al</etal> (<year>2012</year>) 
<article-title>Optimizing a massive parallel sequencing workflow for quantitative miRNA expression analysis</article-title>. <source>PLoS One</source>, <volume>7</volume>, <fpage>e31630</fpage>.<pub-id pub-id-type="pmid">22363693</pub-id></mixed-citation>
    </ref>
    <ref id="btx674-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Dobin</surname><given-names>A.</given-names></name></person-group><etal>et al</etal> (<year>2013</year>) 
<article-title>STAR: ultrafast universal RNA-seq aligner</article-title>. <source>Bioinformatics</source>, <volume>29</volume>, <fpage>15</fpage>–<lpage>21</lpage>.<pub-id pub-id-type="pmid">23104886</pub-id></mixed-citation>
    </ref>
    <ref id="btx674-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Jiang</surname><given-names>H.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Skewer: a fast and accurate adapter trimmer for next-generation sequencing paired-end reads</article-title>. <source>BMC Bioinformatics</source>, <volume>15</volume>, <fpage>182</fpage>.<pub-id pub-id-type="pmid">24925680</pub-id></mixed-citation>
    </ref>
    <ref id="btx674-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>B.</given-names></name>, <name name-style="western"><surname>Dewey</surname><given-names>C.N.</given-names></name></person-group> (<year>2011</year>) 
<article-title>RSEM: accurate transcript quantification from RNA-Seq data with or without a reference genome</article-title>. <source>BMC Bioinformatics</source>, <volume>12</volume>, <fpage>323.</fpage><pub-id pub-id-type="pmid">21816040</pub-id></mixed-citation>
    </ref>
    <ref id="btx674-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Li</surname><given-names>H.</given-names></name>, <name name-style="western"><surname>Durbin</surname><given-names>R.</given-names></name></person-group> (<year>2009</year>) 
<article-title>Fast and accurate short read alignment with Burrows-Wheeler transform</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>1754</fpage>–<lpage>1760</lpage>.<pub-id pub-id-type="pmid">19451168</pub-id></mixed-citation>
    </ref>
    <ref id="btx674-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Love</surname><given-names>M.I.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source>., <volume>15</volume>, <fpage>550.</fpage><pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="btx674-B7">
      <mixed-citation publication-type="other"><person-group person-group-type="author"><name name-style="western"><surname>Wong</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (2017) Applied Reconfigurable Computing. In <italic>13th International Symposium ARC 2017</italic>, Delft, The Netherlands, April 3–7, 2017, Lecture Notes in Computer Science, volume 10216.</mixed-citation>
    </ref>
    <ref id="btx674-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Xu</surname><given-names>S.</given-names></name></person-group><etal>et al</etal> (<year>2014</year>) 
<article-title>Spatial clustering for identification of ChIP-enriched regions (SICER) to map regions of histone methylation patterns in embryonic stem cells</article-title>. <source>Methods Mol. Biol</source>., <volume>1150</volume>, <fpage>97</fpage>–<lpage>111</lpage>.<pub-id pub-id-type="pmid">24743992</pub-id></mixed-citation>
    </ref>
    <ref id="btx674-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>Y.</given-names></name></person-group><etal>et al</etal> (<year>2008</year>) 
<article-title>Model-based analysis of ChIP-Seq (MACS)</article-title>. <source>Genome Biol</source>., <volume>9</volume>, <fpage>R137</fpage>.<pub-id pub-id-type="pmid">18798982</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
