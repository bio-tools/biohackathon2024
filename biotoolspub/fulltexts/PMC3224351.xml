<?DTDIdentifier.IdentifierValue article.dtd?>
<?DTDIdentifier.IdentifierType system?>
<?SourceDTD.DTDName article.dtd?>
<?SourceDTD.Version 1.0?>
<?ConverterInfo.XSLTName bmc2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Syst Biol</journal-id>
    <journal-title-group>
      <journal-title>BMC Systems Biology</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1752-0509</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">3224351</article-id>
    <article-id pub-id-type="publisher-id">1752-0509-5-147</article-id>
    <article-id pub-id-type="pmid">21943338</article-id>
    <article-id pub-id-type="doi">10.1186/1752-0509-5-147</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>TIGER: Toolbox for integrating genome-scale metabolic models, expression data, and transcriptional regulatory networks</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" id="A1">
        <name>
          <surname>Jensen</surname>
          <given-names>Paul A</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>paj2s@virginia.edu</email>
      </contrib>
      <contrib contrib-type="author" id="A2">
        <name>
          <surname>Lutz</surname>
          <given-names>Kyla A</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>lutzka@rose-hulman.edu</email>
      </contrib>
      <contrib contrib-type="author" corresp="yes" id="A3">
        <name>
          <surname>Papin</surname>
          <given-names>Jason A</given-names>
        </name>
        <xref ref-type="aff" rid="I1">1</xref>
        <email>papin@virginia.edu</email>
      </contrib>
    </contrib-group>
    <aff id="I1"><label>1</label>Department of Biomedical Engineering, University of Virginia, Charlottesville, VA 22908, USA</aff>
    <pub-date pub-type="collection">
      <year>2011</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>23</day>
      <month>9</month>
      <year>2011</year>
    </pub-date>
    <volume>5</volume>
    <fpage>147</fpage>
    <lpage>147</lpage>
    <history>
      <date date-type="received">
        <day>12</day>
        <month>4</month>
        <year>2011</year>
      </date>
      <date date-type="accepted">
        <day>23</day>
        <month>9</month>
        <year>2011</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>Copyright ©2011 Jensen et al; licensee BioMed Central Ltd.</copyright-statement>
      <copyright-year>2011</copyright-year>
      <copyright-holder>Jensen et al; licensee BioMed Central Ltd.</copyright-holder>
      <license license-type="open-access" xlink:href="http://creativecommons.org/licenses/by/2.0">
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/2.0">http://creativecommons.org/licenses/by/2.0</ext-link>), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="http://www.biomedcentral.com/1752-0509/5/147"/>
    <abstract>
      <sec>
        <title>Background</title>
        <p>Several methods have been developed for analyzing genome-scale models of metabolism and transcriptional regulation. Many of these methods, such as Flux Balance Analysis, use constrained optimization to predict relationships between metabolic flux and the genes that encode and regulate enzyme activity. Recently, mixed integer programming has been used to encode these gene-protein-reaction (GPR) relationships into a single optimization problem, but these techniques are often of limited generality and lack a tool for automating the conversion of rules to a coupled regulatory/metabolic model.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p>We present TIGER, a Toolbox for Integrating Genome-scale Metabolism, Expression, and Regulation. TIGER converts a series of generalized, Boolean or multilevel rules into a set of mixed integer inequalities. The package also includes implementations of existing algorithms to integrate high-throughput expression data with genome-scale models of metabolism and transcriptional regulation. We demonstrate how TIGER automates the coupling of a genome-scale metabolic model with GPR logic and models of transcriptional regulation, thereby serving as a platform for algorithm development and large-scale metabolic analysis. Additionally, we demonstrate how TIGER's algorithms can be used to identify inconsistencies and improve existing models of transcriptional regulation with examples from the reconstructed transcriptional regulatory network of <italic>Saccharomyces cerevisiae</italic>.</p>
      </sec>
      <sec>
        <title>Conclusion</title>
        <p>The TIGER package provides a consistent platform for algorithm development and extending existing genome-scale metabolic models with regulatory networks and high-throughput data.</p>
      </sec>
    </abstract>
  </article-meta>
</front>
<body>
  <sec>
    <title>Background</title>
    <p>Constraint-Based Reconstruction and Analysis (COBRA) methods have allowed the study of metabolism on a genome-wide scale [<xref ref-type="bibr" rid="B1">1</xref>]. These models have been used to understand the interplay between environmental and genetic perturbations and the metabolic capabilities of an organism. Applications of COBRA methods have led to increased understanding in the fields of bioprocess optimization [<xref ref-type="bibr" rid="B2">2</xref>], pathogenicity [<xref ref-type="bibr" rid="B3">3</xref>], symbiosis [<xref ref-type="bibr" rid="B4">4</xref>], biofuel production [<xref ref-type="bibr" rid="B5">5</xref>], and human disease [<xref ref-type="bibr" rid="B6">6</xref>].</p>
    <sec>
      <title>The Gene-Protein-Reaction relationship</title>
      <p>COBRA models often contain two sets of biological information, a matrix of stoichiometric data for metabolic reactions, and a mapping between gene-encoding enzymes and the reactions they catalyze (the gene-protein-reaction, or GPR, relationship). Predicting the metabolic capabilities of a COBRA model is possible with Flux Balance Analysis (FBA), a two-stage mathematical technique based on the observation that metabolic networks often display optimal dynamics [<xref ref-type="bibr" rid="B7">7</xref>]. In the first stage of FBA, genes in the modeled organism are classified as either "on" or "off" to create an <italic>in silico </italic>genetic state. Turning genes "off" can be used to simulate significant reductions in expression levels or complete knockouts. The GPR for each reaction, represented as a binary rule, determines if a sufficient collection of proteins (isozymes, enzymatic subunits, etc.) is present for the reaction to carry flux. All reactions with satisfied GPR rules are collected into a stoichiometric matrix. The second stage of FBA uses linear programming to calculate a thermodynamically-feasible, mass-balanced flux distribution that maximizes the flux through an objective reaction. The objective reactions used in FBA vary among organisms, ranging from ATP maintenance to biomass production [<xref ref-type="bibr" rid="B8">8</xref>]. By assuming that the fluxes through a metabolic network have evolved to maximize an objective, FBA eliminates the need for detailed kinetic information for each of the thousands of reactions in a complete metabolic reconstruction.</p>
      <p>The GPR rules do not always describe a one-to-one mapping between genes and reactions (where one gene encodes a complete enzyme that independently catalyzes one reaction). For example, a COBRA reconstruction for the yeast <italic>Saccharomyces cerevisiae </italic>[<xref ref-type="bibr" rid="B9">9</xref>] contains 1266 metabolic reactions; 231 (18.3%) of these reactions have complex GPR associations. The most complex GPR in this model involves the products of 18 open reading frames. The entire set of GPR rules contains 340 instances of isozyme-like behavior (two proteins both able to fully catalyze a reaction) and 279 different complexes of protein subunits.</p>
      <p>Because of the complexity of the GPR mappings, early extensions to FBA were reaction, rather than gene, centric. For example, the OptKnock [<xref ref-type="bibr" rid="B2">2</xref>] algorithm removed reactions from a FBA model to design a strain of <italic>E. coli </italic>with optimal production of a metabolic byproduct. Ideally, OptKnock would operate by removing genes, not reactions, since it is not straightforward to independently remove reactions from a biological system without genetic manipulations. An optimization using genes as decision variables would require a method for encoding the GPR logic into a set of linear inequalities. This encoding was developed as SR-FBA [<xref ref-type="bibr" rid="B10">10</xref>] using a mixed integer optimization approach for GPR logic and other Boolean regulatory rules. An SR-FBA-based approach was later used to develop OptORF, a method to design microbial strains through gene knockouts and overexpression [<xref ref-type="bibr" rid="B11">11</xref>]. Other gene-centric, FBA-related algorithms have been developed, each using a variation of the SR-FBA method [<xref ref-type="bibr" rid="B12">12</xref>-<xref ref-type="bibr" rid="B14">14</xref>]. However, a general software platform for coupling GPR rules of arbitrary complexity with a COBRA model using mixed integer programming was not available. Such a tool would speed the development of new algorithms by removing the need for researchers to re-implement this complex process.</p>
    </sec>
    <sec>
      <title>Transcriptional regulatory networks</title>
      <p>The accuracy of COBRA models has been improved through the addition of transcriptional regulatory networks (TRNs) [<xref ref-type="bibr" rid="B15">15</xref>,<xref ref-type="bibr" rid="B16">16</xref>]. The TRN is a set of rules that relate the expression states of metabolic genes to various genetic and environmental cues. Because of the paucity of kinetic details available to describe these relationships, genome-scale models often represent gene expression and environmental cues in a binary, "on" or "off" format. This approach allows TRNs to be described with Boolean logic.</p>
      <p>The first genome-scale TRNs were applied to models of <italic>Escherichia coli </italic>[<xref ref-type="bibr" rid="B15">15</xref>] and <italic>Saccharomyces cerevisiae </italic>[<xref ref-type="bibr" rid="B16">16</xref>] metabolism. The rules were written in standard Boolean format, where each Boolean variable is given by an explicit function of the other variables. This method creates two significant problems. First, the TRN uses the absence or presence of metabolites in the extracellular environment to calculate which genes (and, subsequently, reactions) will be active. However, certain metabolic pathways secrete byproducts into the extracellular space, thereby changing the environment. Studies with the <italic>E. coli </italic>and <italic>S. cerevisiae </italic>TRNs used an iterative approach [<xref ref-type="bibr" rid="B17">17</xref>] - applying the TRN to the metabolic network in a starting environment, determining which metabolites would be secreted, and then repeating the process in the new environment until the environment no longer changes between iterations. A more straightforward approach would be to solve the TRN and metabolic networks simultaneously by formulating both problems in a single optimization.</p>
      <p>A second obstacle with TRN integration is that the explicit rule formulation used by previous studies [<xref ref-type="bibr" rid="B17">17</xref>] can over-constrain the metabolic model. (In explicit rules, each gene's state can be calculated unambiguously from the state of all other genes and metabolites.) Consider the following subnetwork of the iMH805 TRN for <italic>S. cerevisiae </italic>[<xref ref-type="bibr" rid="B16">16</xref>]:<disp-formula id="bmcM1"><label>(1)</label><graphic xlink:href="1752-0509-5-147-i1.gif"/></disp-formula></p>
      <p>Transcription factor <italic>mth1 </italic>is repressed by <italic>mig1 </italic>and promotes expression of <italic>rgt1</italic>. Extracellular L-glutamine (gln-L) represses <italic>rgt1 </italic>expression. The original iMH805 study required this set of constraints be described with the following set of explicit rules [<xref ref-type="bibr" rid="B16">16</xref>]:</p>
      <p>
        <disp-formula>
          <mml:math id="M1" name="1752-0509-5-147-i2" overflow="scroll">
            <mml:mtable columnalign="right">
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>not MIG1</mml:mtext>
                  <mml:mo>⇔</mml:mo>
                  <mml:mi>m</mml:mi>
                  <mml:mi>t</mml:mi>
                  <mml:mi>h</mml:mi>
                  <mml:mn>1</mml:mn>
                  <mml:mtext> </mml:mtext>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd>
                  <mml:mtext>MTH1 and (not gln-L)</mml:mtext>
                  <mml:mo>⇔</mml:mo>
                  <mml:mi>r</mml:mi>
                  <mml:mi>g</mml:mi>
                  <mml:mi>t</mml:mi>
                  <mml:mn>1</mml:mn>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>An implicit representation of (1) is</p>
      <p>
        <disp-formula>
          <mml:math id="M2" name="1752-0509-5-147-i3" overflow="scroll">
            <mml:mtable columnalign="left" class="align">
              <mml:mtr>
                <mml:mtd columnalign="right" class="align-odd">
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">MIG1</mml:mtext>
                  </mml:mstyle>
                </mml:mtd>
                <mml:mtd class="align-even">
                  <mml:mo class="MathClass-rel">⇒</mml:mo>
                  <mml:mstyle class="text">
                    <mml:mtext class="texttt" mathvariant="monospace">not </mml:mtext>
                  </mml:mstyle>
                  <mml:mi>m</mml:mi>
                  <mml:mi>t</mml:mi>
                  <mml:mi>h</mml:mi>
                  <mml:mn>1</mml:mn>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd columnalign="right" class="align-label">
                  <mml:mstyle id="x1-2r1" class="label"/>
                  <mml:mstyle class="maketag">
                    <mml:mtext>(1)</mml:mtext>
                  </mml:mstyle>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd columnalign="right" class="align-odd">
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">MTH1</mml:mtext>
                  </mml:mstyle>
                </mml:mtd>
                <mml:mtd class="align-even">
                  <mml:mo class="MathClass-rel">⇒</mml:mo>
                  <mml:mi>r</mml:mi>
                  <mml:mi>g</mml:mi>
                  <mml:mi>t</mml:mi>
                  <mml:mn>1</mml:mn>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd columnalign="right" class="align-label">
                  <mml:mstyle id="x1-3r2" class="label"/>
                  <mml:mstyle class="maketag">
                    <mml:mtext>(2)</mml:mtext>
                  </mml:mstyle>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd columnalign="right" class="align-odd">
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">g</mml:mtext>
                  </mml:mstyle>
                  <mml:mo class="qopname">ln</mml:mo>
                  <mml:mo class="MathClass-bin">-</mml:mo>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">L</mml:mtext>
                  </mml:mstyle>
                </mml:mtd>
                <mml:mtd class="align-even">
                  <mml:mo class="MathClass-rel">⇒</mml:mo>
                  <mml:mstyle class="text">
                    <mml:mtext class="texttt" mathvariant="monospace">not </mml:mtext>
                  </mml:mstyle>
                  <mml:mi>r</mml:mi>
                  <mml:mi>g</mml:mi>
                  <mml:mi>t</mml:mi>
                  <mml:mn>1</mml:mn>
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd columnalign="right" class="align-label">
                  <mml:mstyle id="x1-4r3" class="label"/>
                  <mml:mstyle class="maketag">
                    <mml:mtext>(3)</mml:mtext>
                  </mml:mstyle>
                </mml:mtd>
              </mml:mtr>
              <mml:mtr>
                <mml:mtd columnalign="right" class="align-odd"/>
                <mml:mtd class="align-even">
                  <mml:mspace width="2em"/>
                </mml:mtd>
                <mml:mtd columnalign="right" class="align-label">
                  <mml:mstyle id="x1-5r4" class="label"/>
                  <mml:mstyle class="maketag">
                    <mml:mtext>(4)</mml:mtext>
                  </mml:mstyle>
                </mml:mtd>
              </mml:mtr>
            </mml:mtable>
          </mml:math>
        </disp-formula>
      </p>
      <p>The three transcription factors and one metabolite in these rules can be arranged in 2<sup>4 </sup>= 16 possible states. As shown in Table <xref ref-type="table" rid="T1">1</xref>, only four of the sixteen states are feasible for the explicit rules. The implicit formulation of the same system allows four new states and makes one of the explicit states infeasible. This example illustrates that two mathematical descriptions of the same biological process can lead to distinct model predictions. The model developer should be free to choose the rule formulation that best encompasses the underlying biology. However, implicit rules require simultaneous solution with a metabolic model and are often more difficult to parse into a mixed integer linear program. As a result, previous TRN integration studies have relied solely on explicit rules to describe regulatory interactions [<xref ref-type="bibr" rid="B17">17</xref>]. A software platform that can correctly parse both explicit and implicit rules would ease the development of large TRN models.</p>
      <table-wrap id="T1" position="float">
        <label>Table 1</label>
        <caption>
          <p>Feasible states for explicit and implicit rules</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th align="center" colspan="4">State</th>
              <th align="center" colspan="2">Feasibility</th>
            </tr>
            <tr>
              <th colspan="4">
                <hr/>
              </th>
              <th colspan="2">
                <hr/>
              </th>
            </tr>
            <tr>
              <th align="center">
                <italic>mig1</italic>
              </th>
              <th align="center">
                <italic>mth1</italic>
              </th>
              <th align="center">
                <italic>rgt1</italic>
              </th>
              <th align="center">gln-L</th>
              <th align="center">Explicit</th>
              <th align="center">Implicit</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">0</td>
              <td align="center">0</td>
              <td align="center">0</td>
              <td align="center">0</td>
              <td/>
              <td align="center">•</td>
            </tr>
            <tr>
              <td align="center">0</td>
              <td align="center">0</td>
              <td align="center">0</td>
              <td align="center">1</td>
              <td/>
              <td align="center">•</td>
            </tr>
            <tr>
              <td align="center">0</td>
              <td align="center">0</td>
              <td align="center">1</td>
              <td align="center">0</td>
              <td/>
              <td align="center">•</td>
            </tr>
            <tr>
              <td align="center">0</td>
              <td align="center">0</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="center">0</td>
              <td align="center">1</td>
              <td align="center">0</td>
              <td align="center">0</td>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="center">0</td>
              <td align="center">1</td>
              <td align="center">0</td>
              <td align="center">1</td>
              <td align="center">•</td>
              <td/>
            </tr>
            <tr>
              <td align="center">0</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">0</td>
              <td align="center">•</td>
              <td align="center">•</td>
            </tr>
            <tr>
              <td align="center">0</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="center">1</td>
              <td align="center">0</td>
              <td align="center">0</td>
              <td align="center">0</td>
              <td align="center">•</td>
              <td align="center">•</td>
            </tr>
            <tr>
              <td align="center">1</td>
              <td align="center">0</td>
              <td align="center">0</td>
              <td align="center">1</td>
              <td align="center">•</td>
              <td align="center">•</td>
            </tr>
            <tr>
              <td align="center">1</td>
              <td align="center">0</td>
              <td align="center">1</td>
              <td align="center">0</td>
              <td/>
              <td align="center">•</td>
            </tr>
            <tr>
              <td align="center">1</td>
              <td align="center">0</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">0</td>
              <td align="center">0</td>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">0</td>
              <td align="center">1</td>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">0</td>
              <td/>
              <td/>
            </tr>
            <tr>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td/>
              <td/>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>Feasible states for explicit and implicit rules describing the transcriptional regulatory network (1). Rules are taken from the <italic>S. cerevisiae </italic>regulatory network model iMH805 [<xref ref-type="bibr" rid="B16">16</xref>]</p>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec>
    <title>Objectives</title>
    <p>Software suites have been developed to enable COBRA analyses. Packages such as CellNetAnalyzer [<xref ref-type="bibr" rid="B18">18</xref>], the BioMet Toolbox [<xref ref-type="bibr" rid="B19">19</xref>], and the COBRA Toolbox [<xref ref-type="bibr" rid="B20">20</xref>] implement several useful algorithms for studying COBRA models and TRNs. However, to date, no single software platform has been developed to 1.) convert COBRA models and TRNs into integrated optimization problems, 2.) analyze these integrated models with existing algorithms to incorporate high-throughput expression data, and 3.) allow users to easily develop new algorithms for the integrated models. To overcome these limitations, we present a Toolbox for Integrating Genome-scale metabolism, Expression, and Regulation (<monospace>TIGER</monospace>). <monospace>TIGER</monospace> automatically converts a list of implicit or explicit GPR and TRN rules into a set of linear inequalities; these equations are integrated with an existing COBRA model. The software allows rules to be written in a generalized Boolean format, enabling TRN logic to more accurately reflect the underlying biology. We demonstrate how this increased expressivity can overcome inconsistencies in existing TRN models. We will also show how <monospace>TIGER</monospace> simplifies the development of gene-centric extensions to FBA by improving three algorithms for integrating high-throughput expression data with a COBRA model.</p>
  </sec>
  <sec>
    <title>Implementation</title>
    <p>The primary functions of <monospace>TIGER</monospace> are shown in Figure <xref ref-type="fig" rid="F1">1</xref>. <monospace>TIGER</monospace> converts a GPR and additional regulatory rules into an equivalent mixed integer linear program (MILP). The MILP constraints are added to a COBRA metabolic model to create a <monospace>TIGER</monospace> model that combines metabolism, GPR associations, and transcriptional regulation. This integrated model serves as a platform for applying many gene-centric extensions to FBA, including algorithms that incorporate "omics" data for model refinement. In this section, we describe how the rules parsed by <monospace>TIGER</monospace> are constructed, and how they are converted to an MILP. Sample files depicting a COBRA model, GPR, and TRN are provided in the "<monospace>test/samples</monospace>" directory of the <monospace>TIGER</monospace> distribution.</p>
    <fig id="F1" position="float">
      <label>Figure 1</label>
      <caption>
        <p><bold>TIGER platform overview</bold>. <monospace>TIGER</monospace> converts Boolean rules to MILPs. Rules are first simplified by substitution and converted into a system of linear inequalities. The rules are optionally attached to a COBRA model by coupling indicators of reaction participation (<italic>R<sub>i</sub></italic>) to the reaction flux <italic>v<sub>i</sub></italic>. In addition to serving as a platform for developing new algorithms, <monospace>TIGER</monospace> models can be integrated with high-throughput expression data to generate context-specific models using variations on the GIMME, iMAT, and MADE algorithms.</p>
      </caption>
      <graphic xlink:href="1752-0509-5-147-1"/>
    </fig>
    <sec>
      <title>Creating rules</title>
      <p>The GPR uses Boolean logic to describe the nonlinear relationship among genes, their protein products, and the reactions they catalyze. Examples of GPR relationships appear in Figure <xref ref-type="fig" rid="F2">2</xref>. The majority of metabolic reactions adhere to a one gene, one enzyme, one reaction relationship, as demonstrated by <italic>gene a</italic>, enzyme A, and reaction 1. If <italic>gene a </italic>is expressed, FBA assumes that reaction 1 can carry any physiologically feasible flux. Some enzymes, such as enzyme B, can catalyze two or more separate reactions. Other reactions, such as reaction 4, require two enzymes (C and D) to carry any flux. Enzymes C and D are commonly protein subunits of an enzymatic complex; if either is absent, no substrate conversion is possible. Genes <italic>e </italic>and <italic>f </italic>encode isozymes; either protein can independently catalyze reaction 5.</p>
      <fig id="F2" position="float">
        <label>Figure 2</label>
        <caption>
          <p><bold>The gene-protein-reaction relationship</bold>. Boolean logic is used to describe gene-protein-reaction (GPR) relationships of varying complexity. Reactions can carry flux if and only if a correct combination of genes is expressed. Reaction 1 is catalyzed by a single gene product (reaction 1 ⇔ <italic>gene a</italic>). Reactions 2 and 3 are both catalyzed by the product of <italic>gene b </italic>(reaction 1 ⇔ <italic>gene b</italic>, reaction 2 ⇔ <italic>gene b</italic>). Genes <italic>c </italic>and <italic>d </italic>produce subunits of an enzymatic complex; both proteins are required for reaction 4 to carry flux (reaction 4 ⇔ <italic>gene c </italic><monospace>and</monospace><italic>gene d</italic>). Genes <italic>e </italic>and <italic>f </italic>encode isozymes. Either enzyme can catalyze reaction 5 (reaction 5 ⇔ <italic>gene e </italic>or <italic>gene f </italic>).</p>
        </caption>
        <graphic xlink:href="1752-0509-5-147-2"/>
      </fig>
      <p>These GPR relationships can be described as a Boolean <italic>expression </italic>using the standard operators <monospace>and</monospace> and or. For example, a reaction that is catalyzed by either of two isozymes, the second of which is composed of two subunits, would have a GPR of the form "isozyme<sub>1 </sub><monospace>or</monospace> (isozyme<sub>2a </sub><monospace>and</monospace> isozyme<sub>2b</sub>)". Two expressions are joined with an implication operator (⇒ or ⇔ corresponding to "if" and "if and only if"), to form a <italic>rule</italic>. For GPR associations, rules are formed as "GPR ⇔ <italic>reaction</italic>", where <italic>reaction </italic>is an indicator variable that constrains the flux through a reaction to be zero when the GPR expression is false.</p>
      <p><monospace>TIGER</monospace> expressions allow additional features to describe logical relationships that are more complex than those typically found in GPRs. The <monospace>not</monospace> operator allows logical negation, which is often used to construct rules for transcriptional repression. Expressions can also contain <italic>conditionals </italic>that compare the numerical values of individual variables. If a gene <italic>g </italic>was known to be expressed when glucose uptake is greater than 10 flux units, this relationship could be represented by the rule "glc_ex <italic>&gt;</italic>10 ⇒ <italic>g</italic>", where "glc_ex" is the glucose exchange reaction in the metabolic model. Any two expressions of arbitrary complexity can be combined as a rule and parsed by <monospace>TIGER</monospace>. The grammar used by <monospace>TIGER</monospace> for rules was designed to resemble logical operations in common programming languages and to be compatible with the GPRs of widely-used COBRA models. A complete description of the <monospace>TIGER</monospace> syntax appears in Additional File <xref ref-type="supplementary-material" rid="S1">1</xref>.</p>
      <p>Some transcriptional regulators, such as the response of <italic>crp </italic>to cAMP in <italic>E. coli</italic>, display multiple levels of activity and cannot be easily described with Boolean logic [<xref ref-type="bibr" rid="B15">15</xref>]. Rather than require users to create several variables describing each state of activation, <monospace>TIGER</monospace> allows multilevel variables. If a transcription factor <italic>t </italic>activates target genes <italic>g</italic><sub>low </sub>at low levels of expression and <italic>g</italic><sub>high </sub>at high levels of expression, then this relationship could be described with the rules</p>
      <p>
        <disp-formula id="bmcM2">
          <label>(2)</label>
          <mml:math id="M3" name="1752-0509-5-147-i4" overflow="scroll">
            <mml:mrow>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                  <mml:mo class="MathClass-rel">=</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">⇒</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">ow</mml:mtext>
                  </mml:mstyle>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM3">
          <label>(3)</label>
          <mml:math id="M4" name="1752-0509-5-147-i5" overflow="scroll">
            <mml:mrow>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mi>t</mml:mi>
                  <mml:mo class="MathClass-rel">=</mml:mo>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">⇒</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>g</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">high</mml:mtext>
                  </mml:mstyle>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>t </italic>= 0, 1, and 2 corresponds to no, low, and high expression. Logical operators have a different interpretation when applied to multilevel variables. If proteins <italic>x </italic>and <italic>y </italic>form a promoter complex for expression of gene <italic>z</italic>, then the corresponding rule for <italic>z </italic>expression would be "<italic>x </italic><monospace>and</monospace><italic> y </italic>⇒ <italic>z</italic>", since both <italic>x </italic>and <italic>y </italic>are required for <italic>z </italic>transcription. If <italic>x </italic>and <italic>y </italic>were multilevel, one would assume that <italic>z </italic>expression would be proportional to the promoter subunit in lower abundance, since this species would limit the amount of complete promoter complex that could be formed. Thus, the <monospace>and</monospace> operation often corresponds to a minimization:</p>
      <p>
        <disp-formula id="bmcM4">
          <label>(4)</label>
          <mml:math id="M5" name="1752-0509-5-147-i6" overflow="scroll">
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mstyle class="text">
                <mml:mtext class="texttt" mathvariant="monospace">and</mml:mtext>
              </mml:mstyle>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mi>y</mml:mi>
              <mml:mo class="MathClass-rel">≡</mml:mo>
              <mml:mo class="qopname"> min</mml:mo>
              <mml:mrow>
                <mml:mo class="MathClass-open">{</mml:mo>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:mi>y</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">}</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The <monospace>or</monospace> operation would be used in situations where either factor can independently induce expression. In this situation, the species in higher abundance determines the target gene's transcription level. <monospace>TIGER</monospace> implements the multilevel <monospace>or</monospace> as a maximization:</p>
      <p>
        <disp-formula id="bmcM5">
          <label>(5)</label>
          <mml:math id="M6" name="1752-0509-5-147-i7" overflow="scroll">
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mstyle class="text">
                <mml:mtext class="texttt" mathvariant="monospace">or</mml:mtext>
              </mml:mstyle>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mi>y</mml:mi>
              <mml:mo class="MathClass-rel">≡</mml:mo>
              <mml:mo class="qopname"> max</mml:mo>
              <mml:mrow>
                <mml:mo class="MathClass-open">{</mml:mo>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                  <mml:mo class="MathClass-punc">,</mml:mo>
                  <mml:mi>y</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">}</mml:mo>
              </mml:mrow>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The <monospace>not</monospace> operator can have two interpretations when applied to multilevel variables:</p>
      <p>
        <disp-formula id="bmcM6">
          <label>(6)</label>
          <mml:math id="M7" name="1752-0509-5-147-i8" overflow="scroll">
            <mml:mrow>
              <mml:mstyle class="text">
                <mml:mtext class="texttt" mathvariant="monospace">not</mml:mtext>
              </mml:mstyle>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mi>x</mml:mi>
              <mml:mo class="MathClass-rel">≡</mml:mo>
              <mml:mfenced open="{">
                <mml:mrow>
                  <mml:mtable equalrows="false" columnlines="none none none none none none none none none none none none none none none none none none none" equalcolumns="false" class="array">
                    <mml:mtr>
                      <mml:mtd class="array" columnalign="center">
                        <mml:mi>x</mml:mi>
                        <mml:mo class="MathClass-rel">&gt;</mml:mo>
                        <mml:mn>0</mml:mn>
                        <mml:mspace width="1em" class="quad"/>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">pseudo - binary</mml:mtext>
                        </mml:mstyle>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd class="array" columnalign="center">
                        <mml:mover accent="true">
                          <mml:mrow>
                            <mml:mi>x</mml:mi>
                          </mml:mrow>
                          <mml:mo class="MathClass-op"> ¯</mml:mo>
                        </mml:mover>
                        <mml:mo class="MathClass-bin">-</mml:mo>
                        <mml:mi>x</mml:mi>
                        <mml:mspace width="1em" class="quad"/>
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">inversion</mml:mtext>
                        </mml:mstyle>
                        <mml:mo class="MathClass-punc">,</mml:mo>
                        <mml:mi>x</mml:mi>
                        <mml:mo class="MathClass-rel">∈</mml:mo>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">{</mml:mo>
                          <mml:mrow>
                            <mml:mn>0</mml:mn>
                            <mml:mo class="MathClass-punc">,</mml:mo>
                            <mml:mo class="MathClass-op">…</mml:mo>
                            <mml:mo class="MathClass-punc">,</mml:mo>
                            <mml:mover accent="true">
                              <mml:mrow>
                                <mml:mi>x</mml:mi>
                              </mml:mrow>
                              <mml:mo class="MathClass-op"> ¯</mml:mo>
                            </mml:mover>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">}</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd class="array" columnalign="center"/>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <inline-formula><mml:math id="M8" name="1752-0509-5-147-i9" overflow="scroll"><mml:mi>x</mml:mi><mml:mo class="MathClass-rel">∈</mml:mo><mml:mrow><mml:mo class="MathClass-open">{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mo class="MathClass-op">…</mml:mo><mml:mo class="MathClass-punc">,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo class="MathClass-op">¯</mml:mo></mml:mover></mml:mrow><mml:mo class="MathClass-close">}</mml:mo></mml:mrow></mml:math></inline-formula>. The first case (pseudo-binary) regards any nonzero value as true, regardless of the number of levels the variable may occupy. The second case (inversion) requires that the value of <italic>x </italic>and the quantity <monospace>not</monospace><italic>x </italic>always sum to the maximum value that <italic>x </italic>can occupy. In this case, <monospace>not</monospace><italic>x </italic>is a measure of how far <italic>x </italic>is from its upper bound. Users are able to select the pseudo-binary or inversion representation depending on which interpretation is a better approximation of the biological context. For example, consider a gene/repressor relationship <italic>R </italic>⇒ <monospace>not</monospace><italic> G</italic>, where the repressor <italic>R </italic>can take on three biologically distinct levels - "off," "low," and "high". If both "low" and "high" levels of <italic>R </italic>prevent any expression of <italic>G</italic>, then the pseudo-binary <monospace>not</monospace> operator would be appropriate as <italic>G </italic>is off whenever <italic>R </italic>is not "off". However, if <italic>G </italic>also has the same three levels of expression, then the inversion interpretation of the <monospace>not</monospace> operator is more appropriate. This choice implies that</p>
      <p>
        <disp-formula id="bmcM7">
          <label>(7)</label>
          <mml:math id="M9" name="1752-0509-5-147-i10" overflow="scroll">
            <mml:mrow>
              <mml:mi>R</mml:mi>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mstyle class="text">
                <mml:mtext class="textsf" mathvariant="sans-serif">off</mml:mtext>
              </mml:mstyle>
              <mml:mo class="MathClass-rel">→</mml:mo>
              <mml:mi>G</mml:mi>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mstyle class="text">
                <mml:mtext class="textsf" mathvariant="sans-serif">high</mml:mtext>
              </mml:mstyle>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM8">
          <label>(8)</label>
          <mml:math id="M10" name="1752-0509-5-147-i11" overflow="scroll">
            <mml:mrow>
              <mml:mi>R</mml:mi>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mstyle class="text">
                <mml:mtext class="textsf" mathvariant="sans-serif">low</mml:mtext>
              </mml:mstyle>
              <mml:mo class="MathClass-rel">→</mml:mo>
              <mml:mi>G</mml:mi>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mstyle class="text">
                <mml:mtext class="textsf" mathvariant="sans-serif">low</mml:mtext>
              </mml:mstyle>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM9">
          <label>(9)</label>
          <mml:math id="M11" name="1752-0509-5-147-i12" overflow="scroll">
            <mml:mrow>
              <mml:mi>R</mml:mi>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mstyle class="text">
                <mml:mtext class="textsf" mathvariant="sans-serif">high</mml:mtext>
              </mml:mstyle>
              <mml:mo class="MathClass-rel">→</mml:mo>
              <mml:mi>G</mml:mi>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mstyle class="text">
                <mml:mtext class="textsf" mathvariant="sans-serif">off</mml:mtext>
              </mml:mstyle>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Any variable in a <monospace>TIGER</monospace> model can be declared with multiple levels. Such declarations are made when rules are added to a model using the <monospace>add_rule</monospace> function in two ways: 1.) setting the default upper bound to all variables to any integer greater than one, or 2.) providing a list of variable names and a set of upper and lower bounds.</p>
    </sec>
    <sec>
      <title>Rule simplification</title>
      <p>Simple Boolean rules can be represented by systems of linear inequalities of integer variables [<xref ref-type="bibr" rid="B21">21</xref>]. A general Boolean rule can be converted by the following procedure to a set of simple rules before conversion to an MILP.</p>
      <p>We define an "atomic" expression as either a variable (<italic>x</italic>) or a negated variable (<monospace>not</monospace><italic> x</italic>). If a <monospace>not</monospace> operator appears before an expression that is not atomic, <monospace>TIGER</monospace> applies DeMorgan's laws to move the negation onto atomic expressions (e.g., <monospace>not</monospace> (<italic>x </italic><monospace>and</monospace><italic> y</italic>) becomes the equivalent expression (<monospace>not </monospace><italic>x</italic>) <monospace>or</monospace> (<monospace>not</monospace><italic> y</italic>)). A simple rule then conforms to one of the following patterns</p>
      <p>
        <disp-formula id="bmcM10">
          <label>(10)</label>
          <mml:math id="M12" name="1752-0509-5-147-i13" overflow="scroll">
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mspace width="1em" class="quad"/>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mo class="MathClass-rel">⇒</mml:mo>
                  <mml:mo class="MathClass-rel">|</mml:mo>
                  <mml:mo class="MathClass-rel">⇔</mml:mo>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mspace width="1em" class="quad"/>
              <mml:mi>z</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM11">
          <label>(11)</label>
          <mml:math id="M13" name="1752-0509-5-147-i14" overflow="scroll">
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mspace width="0.3em" class="thinspace"/>
              <mml:mstyle class="text">
                <mml:mtext class="texttt" mathvariant="monospace">and </mml:mtext>
              </mml:mstyle>
              <mml:mi>y</mml:mi>
              <mml:mspace width="1em" class="quad"/>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mo class="MathClass-rel">⇒</mml:mo>
                  <mml:mo class="MathClass-rel">|</mml:mo>
                  <mml:mo class="MathClass-rel">⇔</mml:mo>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mspace width="1em" class="quad"/>
              <mml:mi>z</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM12">
          <label>(12)</label>
          <mml:math id="M14" name="1752-0509-5-147-i15" overflow="scroll">
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mstyle class="text">
                <mml:mtext class="texttt" mathvariant="monospace">or</mml:mtext>
              </mml:mstyle>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mi>y</mml:mi>
              <mml:mspace width="1em" class="quad"/>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mo class="MathClass-rel">⇒</mml:mo>
                  <mml:mo class="MathClass-rel">|</mml:mo>
                  <mml:mo class="MathClass-rel">⇔</mml:mo>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mspace width="1em" class="quad"/>
              <mml:mi>z</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM13">
          <label>(13)</label>
          <mml:math id="M15" name="1752-0509-5-147-i16" overflow="scroll">
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mrow>
                <mml:mo class="MathClass-open">⟨</mml:mo>
                <mml:mrow>
                  <mml:mi>o</mml:mi>
                  <mml:mi>p</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">⟩</mml:mo>
              </mml:mrow>
              <mml:mi>y</mml:mi>
              <mml:mspace width="1em" class="quad"/>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mo class="MathClass-rel">⇒</mml:mo>
                  <mml:mo class="MathClass-rel">|</mml:mo>
                  <mml:mo class="MathClass-rel">⇔</mml:mo>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mspace width="1em" class="quad"/>
              <mml:mi>z</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>x</italic>, <italic>y</italic>, and <italic>z </italic>are atomic, and 〈<italic>op</italic>〉 is a conditional operator (≤, ≥, etc.). Non-simple rules are converted to simple rules through a series of recursive substitutions. For example, the rule</p>
      <p>
        <disp-formula id="bmcM14">
          <label>(14)</label>
          <mml:math id="M16" name="1752-0509-5-147-i17" overflow="scroll">
            <mml:mrow>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mi>x</mml:mi>
                  <mml:mspace width="2.77695pt" class="tmspace"/>
                  <mml:mstyle class="text">
                    <mml:mtext class="texttt" mathvariant="monospace">or</mml:mtext>
                  </mml:mstyle>
                  <mml:mspace width="2.77695pt" class="tmspace"/>
                  <mml:mrow>
                    <mml:mo class="MathClass-open">(</mml:mo>
                    <mml:mrow>
                      <mml:mstyle class="text">
                        <mml:mtext class="texttt" mathvariant="monospace">not </mml:mtext>
                      </mml:mstyle>
                      <mml:mi>y</mml:mi>
                    </mml:mrow>
                    <mml:mo class="MathClass-close">)</mml:mo>
                  </mml:mrow>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mstyle class="text">
                <mml:mtext class="texttt" mathvariant="monospace">and </mml:mtext>
              </mml:mstyle>
              <mml:mi>z</mml:mi>
              <mml:mo class="MathClass-rel">⇒</mml:mo>
              <mml:mi>w</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>is not simple, since the expression <italic>x </italic><monospace>or</monospace> (<monospace>not</monospace><italic> y</italic>) is not atomic. By defining an indicator variable <italic>I</italic>, which is true if and only if the expression <italic>x </italic><monospace>or</monospace> (<monospace>not</monospace><italic> y</italic>) is true, equation (14) can be written as two simple rules:</p>
      <p>
        <disp-formula id="bmcM15">
          <label>(15)</label>
          <mml:math id="M17" name="1752-0509-5-147-i18" overflow="scroll">
            <mml:mrow>
              <mml:mi>x</mml:mi>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mstyle class="text">
                <mml:mtext class="texttt" mathvariant="monospace">or</mml:mtext>
              </mml:mstyle>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mstyle class="text">
                    <mml:mtext class="texttt" mathvariant="monospace">not </mml:mtext>
                  </mml:mstyle>
                  <mml:mi>y</mml:mi>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">⇔</mml:mo>
              <mml:mi>I</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM16">
          <label>(16)</label>
          <mml:math id="M18" name="1752-0509-5-147-i19" overflow="scroll">
            <mml:mrow>
              <mml:mi>I</mml:mi>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mstyle class="text">
                <mml:mtext class="texttt" mathvariant="monospace">and </mml:mtext>
              </mml:mstyle>
              <mml:mi>z</mml:mi>
              <mml:mo class="MathClass-rel">⇒</mml:mo>
              <mml:mi>w</mml:mi>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The bounds of <italic>I </italic>are determined by the bounds of <italic>x </italic>and <italic>y</italic>. If <inline-formula><mml:math id="M19" name="1752-0509-5-147-i20" overflow="scroll"><mml:mi>x</mml:mi><mml:mo class="MathClass-rel">∈</mml:mo><mml:mrow><mml:mo class="MathClass-open">{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mo class="MathClass-op">…</mml:mo><mml:mo class="MathClass-punc">,</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo class="MathClass-op">¯</mml:mo></mml:mover></mml:mrow><mml:mo class="MathClass-close">}</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula><mml:math id="M20" name="1752-0509-5-147-i21" overflow="scroll"><mml:mi>y</mml:mi><mml:mo class="MathClass-rel">∈</mml:mo><mml:mrow><mml:mo class="MathClass-open">{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mo class="MathClass-op">…</mml:mo><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>ȳ</mml:mi></mml:mrow><mml:mo class="MathClass-close">}</mml:mo></mml:mrow></mml:math></inline-formula>, then <inline-formula><mml:math id="M21" name="1752-0509-5-147-i22" overflow="scroll"><mml:mi>I</mml:mi><mml:mo class="MathClass-rel">∈</mml:mo><mml:mrow><mml:mo class="MathClass-open">{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo class="MathClass-punc">,</mml:mo><mml:mo class="MathClass-op">…</mml:mo><mml:mo class="MathClass-punc">,</mml:mo><mml:mi>Ī</mml:mi></mml:mrow><mml:mo class="MathClass-close">}</mml:mo></mml:mrow></mml:math></inline-formula>, where</p>
      <p>
        <disp-formula id="bmcM17">
          <label>(17)</label>
          <mml:math id="M22" name="1752-0509-5-147-i23" overflow="scroll">
            <mml:mrow>
              <mml:mi>Ī</mml:mi>
              <mml:mo class="MathClass-rel">=</mml:mo>
              <mml:mfenced open="{">
                <mml:mrow>
                  <mml:mtable equalrows="false" columnlines="none none none none none none none none none none none none none none none none none none none" equalcolumns="false" class="array">
                    <mml:mtr>
                      <mml:mtd class="array" columnalign="center">
                        <mml:mo class="qopname">max</mml:mo>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">{</mml:mo>
                          <mml:mrow>
                            <mml:mover accent="true">
                              <mml:mrow>
                                <mml:mi>x</mml:mi>
                              </mml:mrow>
                              <mml:mo class="qopname">¯</mml:mo>
                            </mml:mover>
                            <mml:mo class="MathClass-punc">,</mml:mo>
                            <mml:mi>ȳ</mml:mi>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">}</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd class="array" columnalign="center">
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">for </mml:mtext>
                        </mml:mstyle>
                        <mml:mi>x</mml:mi>
                        <mml:mspace width="2.77695pt" class="tmspace"/>
                        <mml:mstyle class="text">
                          <mml:mtext class="texttt" mathvariant="monospace">or</mml:mtext>
                        </mml:mstyle>
                        <mml:mspace width="2.77695pt" class="tmspace"/>
                        <mml:mi>y</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd class="array" columnalign="center">
                        <mml:mo class="qopname">min</mml:mo>
                        <mml:mrow>
                          <mml:mo class="MathClass-open">{</mml:mo>
                          <mml:mrow>
                            <mml:mover accent="true">
                              <mml:mrow>
                                <mml:mi>x</mml:mi>
                              </mml:mrow>
                              <mml:mo class="qopname"> ¯</mml:mo>
                            </mml:mover>
                            <mml:mo class="MathClass-punc">,</mml:mo>
                            <mml:mi>ȳ</mml:mi>
                          </mml:mrow>
                          <mml:mo class="MathClass-close">}</mml:mo>
                        </mml:mrow>
                      </mml:mtd>
                      <mml:mtd class="array" columnalign="center">
                        <mml:mstyle class="text">
                          <mml:mtext class="textsf" mathvariant="sans-serif">for </mml:mtext>
                        </mml:mstyle>
                        <mml:mi>x</mml:mi>
                        <mml:mspace width="2.77695pt" class="tmspace"/>
                        <mml:mstyle class="text">
                          <mml:mtext class="texttt" mathvariant="monospace">and</mml:mtext>
                        </mml:mstyle>
                        <mml:mspace width="2.77695pt" class="tmspace"/>
                        <mml:mi>y</mml:mi>
                      </mml:mtd>
                    </mml:mtr>
                    <mml:mtr>
                      <mml:mtd class="array" columnalign="center"/>
                    </mml:mtr>
                  </mml:mtable>
                </mml:mrow>
              </mml:mfenced>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>Thus, if <italic>x </italic>and <italic>y </italic>are binary, <inline-formula><mml:math id="M23" name="1752-0509-5-147-i24" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mo class="MathClass-op">¯</mml:mo></mml:mover><mml:mo class="MathClass-rel">=</mml:mo><mml:mi>ȳ</mml:mi><mml:mo class="MathClass-rel">=</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula>, so <italic>I </italic>is binary as well.</p>
      <p><monospace>TIGER</monospace> applies the above substitutions recursively, creating indicator variables as necessary until all rules are simple. Each simple rule is converted to a set of linear inequalities that are added as constraints to the model structure. If a variable name already appears in the model, <monospace>TIGER</monospace> assumes that these variables represent the same quantity and thus allows new rules to be added to an existing model without recompiling previous rules. At the same time, <monospace>TIGER</monospace> creates variables to substitute for negated variables. For efficiency, <monospace>TIGER</monospace> ensures that only one negated variable is created for each original variable, regardless of the number of times the negated expression appears in the set of simple rules. Details of the conversion between simple rules and inequalities, along with methods for handling conditionals, are provided in Additional File <xref ref-type="supplementary-material" rid="S1">1</xref>.</p>
    </sec>
    <sec>
      <title>Reaction coupling</title>
      <p>If the GPR expression for a reaction is not satisfied, the reaction is not allowed to carry flux. To enforce this relationship during an optimization, a set of discrete variables <italic>R<sub>i </sub></italic>are defined, where <italic>R<sub>i </sub></italic>= 0 if the GPR for reaction <italic>i </italic>is not satisfied, and <italic>R<sub>i </sub>&gt;</italic>0 otherwise. To enforce the GPR's effect on flux, <monospace>TIGER</monospace> adds the constraint</p>
      <p>
        <disp-formula id="bmcM18">
          <label>(18)</label>
          <mml:math id="M24" name="1752-0509-5-147-i25" overflow="scroll">
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>v</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo class="qopname">min</mml:mo>
                </mml:mrow>
              </mml:msubsup>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>R</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo class="MathClass-rel">≤</mml:mo>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>v</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
              </mml:msub>
              <mml:mo class="MathClass-rel">≤</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi>v</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mo class="qopname">max</mml:mo>
                </mml:mrow>
              </mml:msubsup>
              <mml:msub>
                <mml:mrow>
                  <mml:mi>R</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>where <italic>v<sub>i </sub></italic>is the flux through the <italic>i</italic>th reaction, with lower and upper bounds <inline-formula><mml:math id="M25" name="1752-0509-5-147-i26" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo class="qopname">min</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="M26" name="1752-0509-5-147-i27" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi>v</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mo class="qopname">max</mml:mo></mml:mrow></mml:msubsup></mml:math></inline-formula>.</p>
    </sec>
    <sec>
      <title>Model structure</title>
      <p><monospace>TIGER</monospace> models are represented as Matlab structures. The layout of this structure is shown in Figure <xref ref-type="fig" rid="F3">3</xref>. The structure contains fields <monospace>obj, A, b, lb,</monospace> and <monospace>ub</monospace> that correspond to the values in the following MILP problem:</p>
      <fig id="F3" position="float">
        <label>Figure 3</label>
        <caption>
          <p><bold>Structure of TIGER models</bold>. <monospace>TIGER</monospace> models are represented as Matlab structures. Boxes indicate size and orientation of the fields. Black text denotes <monospace>TIGER</monospace> field names. Gray areas contain data from the COBRA model, with white text indicating the relevant COBRA field names. Border color indicates data type: black → double-precision matrix, blue → cell array of strings, red → character array.</p>
        </caption>
        <graphic xlink:href="1752-0509-5-147-3"/>
      </fig>
      <p>
        <disp-formula>
          <mml:math id="M27" name="1752-0509-5-147-i28" overflow="scroll">
            <mml:mrow>
              <mml:mtable class="gathered">
                <mml:mtr>
                  <mml:mtd>
                    <mml:mo class="qopname">min</mml:mo>
                    <mml:mi>o</mml:mi>
                    <mml:mi>b</mml:mi>
                    <mml:msup>
                      <mml:mrow>
                        <mml:mi>j</mml:mi>
                      </mml:mrow>
                      <mml:mrow>
                        <mml:mi>′</mml:mi>
                      </mml:mrow>
                    </mml:msup>
                    <mml:mi>x</mml:mi>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mstyle class="text">
                      <mml:mtext class="textsf" mathvariant="sans-serif">subject to</mml:mtext>
                    </mml:mstyle>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mi>A</mml:mi>
                    <mml:mi>x</mml:mi>
                    <mml:mrow>
                      <mml:mo class="MathClass-open">(</mml:mo>
                      <mml:mrow>
                        <mml:mo class="MathClass-rel">≤</mml:mo>
                        <mml:mo class="MathClass-rel">|</mml:mo>
                        <mml:mo class="MathClass-rel">=</mml:mo>
                        <mml:mo class="MathClass-rel">|</mml:mo>
                        <mml:mo class="MathClass-rel">≥</mml:mo>
                      </mml:mrow>
                      <mml:mo class="MathClass-close">)</mml:mo>
                    </mml:mrow>
                    <mml:mi>b</mml:mi>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mspace width="1em" class="quad"/>
                    <mml:mi>l</mml:mi>
                    <mml:mi>b</mml:mi>
                    <mml:mo class="MathClass-rel">≤</mml:mo>
                    <mml:mi>x</mml:mi>
                    <mml:mo class="MathClass-rel">≤</mml:mo>
                    <mml:mi>u</mml:mi>
                    <mml:mi>b</mml:mi>
                  </mml:mtd>
                </mml:mtr>
                <mml:mtr>
                  <mml:mtd/>
                </mml:mtr>
              </mml:mtable>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The type of (in)equality for each constraint in <monospace>A</monospace> is determined by the character vector <monospace>ctype</monospace>. The type of variable for each entry in <italic>x </italic>is specified by the field <monospace>vartype</monospace>, where '<monospace>c</monospace>', '<monospace>b</monospace>', and '<monospace>i</monospace>' denote continuous, binary, and general integer variables. Reaction fluxes are continuous variables, while all other variables are either binary or integer depending on the corresponding upper bound. The fields <monospace>rownames</monospace> and <monospace>varnames</monospace> contain descriptive names of the constraints and variables, stored as cell arrays of strings. Functions in <monospace>TIGER</monospace> allow variables to be interchangeably referenced by their name, column index, or through Matlab's logical indexing features.</p>
      <p>The format for <monospace>TIGER</monospace> models is designed for compatibility with the model structure for the COBRA Toolbox [<xref ref-type="bibr" rid="B20">20</xref>]. <monospace>TIGER</monospace> can use a COBRA Toolbox model as a starting point for converting a genome-scale reconstruction; therefore, any model in a file format supported by the COBRA Toolbox (SBML, Simpheny, etc.) can be converted to a <monospace>TIGER</monospace> model.</p>
    </sec>
    <sec>
      <title>Accessing the MILP solver</title>
      <p><monospace>TIGER</monospace> uses a custom Matlab class CMPI (Common Mathematical Programming Interface) to create and solve mathematical programming problems. CMPI defines a consistent structure for MILP (and mixed-integer quadratic programming, MIQP) problems, providing independence from the underlying MILP solver software. <monospace>TIGER</monospace> currently supports the CPLEX, Gurobi (via Gurobi MEX), and GLPK (via GLPK Mex) software packages, all of which are freely available for academic use. Porting <monospace>TIGER</monospace> to use a new solver requires modifying only the CMPI method <monospace>solve_mip</monospace> to specify the new interface. CMPI also provides a standardized method for configuring common solver parameters (maximum solution time, optimality and feasibility tolerances, etc.).</p>
      <p>Previous work has indicated that the computation time of some FBA-related algorithms, such as Flux Variability Analysis [<xref ref-type="bibr" rid="B22">22</xref>], can be reduced by saving information about the problem structure between calls to the MILP solver [<xref ref-type="bibr" rid="B23">23</xref>]. CMPI provides a method, <monospace>solve_multiple_milps</monospace>, to preserve the solver state between successive calls to the CPLEX optimizer and reduce runtime in this manner. (Gurobi and GLPK currently do not support this feature in their Matlab interfaces.) If the CPLEX optimizer is not installed, CMPI will automatically make successive calls to the installed optimizer. While this removes the potential speed increase from using solver restarts, it allows <monospace>TIGER</monospace> code to remain solver independent and portable.</p>
    </sec>
    <sec>
      <title>Using TIGER</title>
      <p><monospace>TIGER</monospace> source code and installation instructions are available online at <ext-link ext-link-type="uri" xlink:href="http://bme.virginia.edu/csbl/downloads/">http://bme.virginia.edu/csbl/downloads/</ext-link> or <ext-link ext-link-type="uri" xlink:href="http://csbl.bitbucket.org/tiger">http://csbl.bitbucket.org/tiger</ext-link> The version of <monospace>TIGER</monospace> used for the examples in this study is included as Additional File <xref ref-type="supplementary-material" rid="S2">2</xref>. All functions in the toolbox are documented using Matlab's "help" facilities. Complete documentation and a step-by-step tutorial are also available on the <monospace>TIGER</monospace> website. The software includes a testing suite to verify the installation. These tests contain examples that build a <monospace>TIGER</monospace> structure from a simple COBRA model, add a set of TRN rules, call a MILP solver, and display the solution.</p>
    </sec>
  </sec>
  <sec>
    <title>Results and Discussion</title>
    <sec>
      <title>Refining integrated models for Saccharomyces cerevisiae</title>
      <p><monospace>TIGER</monospace> was used to couple the 1266 reactions in iND750 [<xref ref-type="bibr" rid="B9">9</xref>], a genome-scale model of <italic>Saccharomyces cerevisiae </italic>metabolism, with 750 metabolic genes. The resulting <monospace>TIGER</monospace> model contained 4498 constraints in 3214 variables. A model of <italic>S. cerevisiae </italic>transcriptional regulation, iMH805 [<xref ref-type="bibr" rid="B16">16</xref>], was added. The additional 805 rules contributed 1057 constraints and 562 variables to the <monospace>TIGER</monospace> model. The conversion took 53.66 s for iND750 and 20.31 s to add the TRN using an Intel 3.2 GHz i7-quad core processor running Linux.</p>
      <p>As mentioned above, previous methods for integrating TRNs involve an iterative process, alternating between calculating gene states from a given environment and determining an environment based on metabolic byproducts [<xref ref-type="bibr" rid="B17">17</xref>]. However, the multiple layers of trascriptional regulation may require several iterations of this method to reach a stable gene state. The number of iterations to reach a stable state varies by environment and cannot easily be determined <italic>a priori </italic>[<xref ref-type="bibr" rid="B24">24</xref>]. In fact, some feedback mechanisms in TRNs may lead to a stable cycle of gene activation/inactivation rather than a single gene state. <monospace>TIGER</monospace> solves the TRN and FBA problems simultaneously, so the resulting gene state is always stable (or an optimal state inside a stable cycle).</p>
      <p>Applying large-scale TRNs to COBRA models may result in infeasible models, i.e., models unable to produce any biomass. This is often due to a small number of rules that turn off reactions that are essential for biomass production. Previous work has developed techniques for finding which rules create the model infeasibility [<xref ref-type="bibr" rid="B13">13</xref>]. <monospace>TIGER</monospace> includes the function <monospace>find_infeasible_rules</monospace> to identify rules that prevent feasible solutions to the resulting MILP. Given a model and a set of rules that prevent a feasible solution, <monospace>find_infeasible_rules</monospace> creates a MILP that preserves the logic of the rules but allows each rule to be artificially satisfied. The objective of this MILP is to minimize the number of rules that must be artificially satisfied while finding a feasible solution for the model. (Details of this process are available in Additional File <xref ref-type="supplementary-material" rid="S1">1</xref>.)</p>
      <p>Analysis by <monospace>TIGER</monospace> reported that the combined iND750/iMH805 metabolic and TRN network was unable to produce biomass under aerobic conditions in a glucose minimal media. Since <italic>S. cerevisiae </italic>is well-known to grow in this environment, we used <monospace>TIGER</monospace>'s <monospace>find_infeasible_rules</monospace> function to identify the following three rules that prevented growth:</p>
      <p>
        <disp-formula id="bmcM19">
          <label>(19)</label>
          <mml:math id="M28" name="1752-0509-5-147-i29" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">O</mml:mtext>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mo class="MathClass-open">[</mml:mo>
                <mml:mrow>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">e</mml:mtext>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mo class="MathClass-close">]</mml:mo>
              </mml:mrow>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mstyle class="text">
                <mml:mtext class="texttt" mathvariant="monospace">or</mml:mtext>
              </mml:mstyle>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mstyle class="text">
                    <mml:mtext class="texttt" mathvariant="monospace">not ROX1</mml:mtext>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">⇔</mml:mo>
              <mml:mi>h</mml:mi>
              <mml:mi>a</mml:mi>
              <mml:mi>p</mml:mi>
              <mml:mn>1</mml:mn>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM20">
          <label>(20)</label>
          <mml:math id="M29" name="1752-0509-5-147-i30" overflow="scroll">
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">O</mml:mtext>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mrow>
                  <mml:mn>2</mml:mn>
                </mml:mrow>
              </mml:msub>
              <mml:mrow>
                <mml:mo class="MathClass-open">[</mml:mo>
                <mml:mrow>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">e</mml:mtext>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mo class="MathClass-close">]</mml:mo>
              </mml:mrow>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mstyle class="text">
                <mml:mtext class="texttt" mathvariant="monospace">and</mml:mtext>
              </mml:mstyle>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mstyle class="text">
                <mml:mtext class="textsf" mathvariant="sans-serif">HAP1</mml:mtext>
              </mml:mstyle>
              <mml:mo class="MathClass-rel">⇔</mml:mo>
              <mml:mi>r</mml:mi>
              <mml:mi>o</mml:mi>
              <mml:mi>x</mml:mi>
              <mml:mn>1</mml:mn>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>
        <disp-formula id="bmcM21">
          <label>(21)</label>
          <mml:math id="M30" name="1752-0509-5-147-i31" overflow="scroll">
            <mml:mrow>
              <mml:mstyle class="text">
                <mml:mtext class="textsf" mathvariant="sans-serif">glucose</mml:mtext>
              </mml:mstyle>
              <mml:mrow>
                <mml:mo class="MathClass-open">[</mml:mo>
                <mml:mrow>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">e</mml:mtext>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mo class="MathClass-close">]</mml:mo>
              </mml:mrow>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mstyle class="text">
                <mml:mtext class="texttt" mathvariant="monospace">and</mml:mtext>
              </mml:mstyle>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mstyle class="text">
                <mml:mtext class="textsf" mathvariant="sans-serif">HAP1</mml:mtext>
              </mml:mstyle>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mstyle class="text">
                <mml:mtext class="texttt" mathvariant="monospace">and</mml:mtext>
              </mml:mstyle>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mstyle class="text">
                    <mml:mtext class="texttt" mathvariant="monospace">not </mml:mtext>
                  </mml:mstyle>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">ROX1</mml:mtext>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">⇔</mml:mo>
              <mml:mi>e</mml:mi>
              <mml:mi>r</mml:mi>
              <mml:mi>g</mml:mi>
              <mml:mn>11</mml:mn>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The product of gene <italic>erg11</italic>, lanosterol 14<italic>α</italic>-demethylase, is an essential enzyme for the production of ergosterol, a main sterol in <italic>S. cerevisiae </italic>[<xref ref-type="bibr" rid="B25">25</xref>]. This gene is essential in the iND750 metabolic model and must remain "on" during aerobic growth on glucose. However, the stable gene state for <italic>erg11 </italic>in the above rules is always "off" after three iterations, as described in Table <xref ref-type="table" rid="T2">2</xref>. Because the iMH805 study used the results of the second iteration as the final gene state, this inaccuracy was unnoticed.</p>
      <table-wrap id="T2" position="float">
        <label>Table 2</label>
        <caption>
          <p>Gene states for erg11 regulation</p>
        </caption>
        <table frame="hsides" rules="groups">
          <thead>
            <tr>
              <th/>
              <th/>
              <th align="center" colspan="4">Iteration</th>
              <th/>
            </tr>
            <tr>
              <th/>
              <th/>
              <th colspan="4">
                <hr/>
              </th>
              <th/>
            </tr>
            <tr>
              <th/>
              <th align="center">Start</th>
              <th align="center">1</th>
              <th align="center">2</th>
              <th align="center">3</th>
              <th align="center">4</th>
              <th align="left">Rule</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td align="center">O<sub>2</sub>[e]</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td/>
            </tr>
            <tr>
              <td align="center">glucose [e]</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td/>
            </tr>
            <tr>
              <td align="center">
                <italic>hap1</italic>
              </td>
              <td align="center">0</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="left">O<sub>2</sub>[e] <monospace>or not</monospace> ROX1</td>
            </tr>
            <tr>
              <td align="center">
                <italic>rox1</italic>
              </td>
              <td align="center">0</td>
              <td align="center">0</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="left">O<sub>2</sub>[e] <monospace>and</monospace> HAP1</td>
            </tr>
            <tr>
              <td align="center">
                <italic>erg11</italic>
              </td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">0</td>
              <td align="center">0</td>
              <td align="left">O<sub>2</sub>[e] <monospace>and</monospace> HAP1 <monospace>and</monospace> (<monospace>not</monospace> ROX1)</td>
            </tr>
            <tr>
              <td colspan="7">
                <hr/>
              </td>
            </tr>
            <tr>
              <td align="center">
                <italic>erg11</italic>
              </td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="center">1</td>
              <td align="left">O<sub>2</sub>[e] <monospace>and</monospace> HAP1 <monospace>and</monospace> (high_o2 <monospace>or not</monospace> ROX1)</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <p>To start, all transcription factors are assumed to be "off", and all metabolic genes are "on". The extracellular environment contains only glucose (glucose[e]), oxygen (O<sub>2</sub>[e]), and essential salts and minerals. Each iteration calculates the next gene state based on the current state of metabolites in the environment and transcription factors. After three iterations, expression of <italic>erg11 </italic>turns off, unless a modified rule is used that account for high oxygen uptake. The modified rule (shown below the double line) is more consistent with the results in Turi &amp; Loper [<xref ref-type="bibr" rid="B25">25</xref>] Rules are taken from the <italic>S. cerevisiae </italic>regulatory network model iMH805 [<xref ref-type="bibr" rid="B16">16</xref>]</p>
        </table-wrap-foot>
      </table-wrap>
      <p>Rule (21) was originally derived from Turi &amp; Loper [<xref ref-type="bibr" rid="B25">25</xref>]. Re-examination of this manuscript revealed that while ROX1 represses <italic>erg11</italic>, complete repression is only observed under low oxygen conditions. To incorporate these findings, we create an indicator "high o2" that is true if and only if the cell uptakes more than 10% of the maximum oxygen consumption rate. This relationship is expressed as</p>
      <p>
        <disp-formula id="bmcM22">
          <label>(22)</label>
          <mml:math id="M31" name="1752-0509-5-147-i32" overflow="scroll">
            <mml:mrow>
              <mml:mstyle class="text">
                <mml:mtext class="textsf" mathvariant="sans-serif">high_</mml:mtext>
              </mml:mstyle>
              <mml:mn>02</mml:mn>
              <mml:mo class="MathClass-rel">⇔</mml:mo>
              <mml:mstyle class="text">
                <mml:mtext class="textsf" mathvariant="sans-serif">EX_</mml:mtext>
              </mml:mstyle>
              <mml:mn>02</mml:mn>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">e</mml:mtext>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">&lt;</mml:mo>
              <mml:mo class="MathClass-bin">-</mml:mo>
              <mml:mn>0</mml:mn>
              <mml:mo class="MathClass-punc">.</mml:mo>
              <mml:mn>244</mml:mn>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>where "EX_o2(e)" is the iND750 name for the oxygen exchange reaction, and the maximum oxygen uptake rate for growth on glucose is 2.44 mol/(g dry cell weight)/h (negative flux through exchange reactions indicate uptake by the cell). Rule (21) for <italic>erg11 </italic>expression was re-written to only exhibit ROX1 repression under low oxygen conditions:</p>
      <p>
        <disp-formula id="bmcM23">
          <label>(23)</label>
          <mml:math id="M32" name="1752-0509-5-147-i33" overflow="scroll">
            <mml:mrow>
              <mml:mstyle class="text">
                <mml:mtext class="textsf" mathvariant="sans-serif">glucose</mml:mtext>
              </mml:mstyle>
              <mml:mrow>
                <mml:mo class="MathClass-open">[</mml:mo>
                <mml:mrow>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">e</mml:mtext>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mo class="MathClass-close">]</mml:mo>
              </mml:mrow>
              <mml:mspace width="2.77695pt" class="tmspace"/>
              <mml:mstyle class="text">
                <mml:mtext class="texttt" mathvariant="monospace">and </mml:mtext>
              </mml:mstyle>
              <mml:mstyle class="text">
                <mml:mtext class="textsf" mathvariant="sans-serif">HAP1 </mml:mtext>
              </mml:mstyle>
              <mml:mstyle class="text">
                <mml:mtext class="texttt" mathvariant="monospace">and </mml:mtext>
              </mml:mstyle>
              <mml:mrow>
                <mml:mo class="MathClass-open">(</mml:mo>
                <mml:mrow>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">high_o2 </mml:mtext>
                  </mml:mstyle>
                  <mml:mstyle class="text">
                    <mml:mtext class="texttt" mathvariant="monospace">or not </mml:mtext>
                  </mml:mstyle>
                  <mml:mstyle class="text">
                    <mml:mtext class="textsf" mathvariant="sans-serif">ROX1</mml:mtext>
                  </mml:mstyle>
                </mml:mrow>
                <mml:mo class="MathClass-close">)</mml:mo>
              </mml:mrow>
              <mml:mo class="MathClass-rel">⇔</mml:mo>
              <mml:mi>e</mml:mi>
              <mml:mi>r</mml:mi>
              <mml:mi>g</mml:mi>
              <mml:mn>11</mml:mn>
            </mml:mrow>
          </mml:math>
        </disp-formula>
      </p>
      <p>The set of refined rules (20,21,23) reproduces the correct growth phenotype in aerobic glucose conditions. This example demonstrates a three-step procedure for refining existing TRN models using <monospace>TIGER</monospace>: 1.) apply the existing TRN to a COBRA model, 2.) use the <monospace>find_infeasible_rules</monospace> function to identify rules that cause the model to differ from a known phenotype, and 3.) re-examine the evidence for these rules and make appropriate modifications. As shown in the previous example, new biological information can often be incorporated into existing rules using <monospace>TIGER</monospace>'s support for complex logical expressions.</p>
    </sec>
    <sec>
      <title>Improved methods for expression data</title>
      <p>Coupling the GPR with a metabolic model is a starting point for several algorithms designed to refine metabolic models by integrating high-throughput gene or protein expression data. The <monospace>TIGER</monospace> package contains implementations of three of these methods.</p>
      <sec>
        <title>GIMME</title>
        <p>GIMME was designed to generate context-specific metabolic networks by designating each reaction as "on" or "off" [<xref ref-type="bibr" rid="B26">26</xref>]. Given expression data and a minimum expression threshold, GIMME calculates a normalized gene "score" for each reaction by averaging the expression values of all genes that appear in the GPR for the reaction. Reactions with a score below a cutoff are turned off; only reactions scoring above the cutoff are allowed to carry flux. Because this thresholding does not guarantee a functioning model, an optimization problem is formed to minimize the number of "off" reactions that must carry flux when the model produces a minimum objective flux.</p>
        <p>The GIMME algorithm is an excellent candidate for conversion to a gene-centric approach. Rather than average the gene expression values for each reaction, a simpler approach is to turn genes "on" or "off" if their expression is above or below a threshold. Using an integrated GPR/metabolic model, an optimization problem could re-activate "off" genes to allow the network to produce an objective flux. <monospace>TIGER</monospace> provides a <monospace>gimme</monospace> function that implements this gene-centric approach. Similar to the original algorithm, <monospace>TIGER</monospace>'s GIMME uses the distance below the expression threshold as a weight when selecting genes for re-activation. In addition to removing discrepancies caused by the averaging of gene expression values over each reaction, <monospace>TIGER</monospace>'s integrated approach allows GIMME to identify each gene as either "on" or "off" in the resulting network (GIMME originally reported only the state of each reaction).</p>
        <p>We applied GIMME to the prototypic network shown in Figure <xref ref-type="fig" rid="F4">4a</xref>. In this network, three metabolites, A, C, and F, are transported into the system and undergo chemical transformation into products E and G. The metabolic objective for this system is the production of E. The GPR associations are also shown in Figure <xref ref-type="fig" rid="F4">4a</xref>. Reactions 4 through 8 are gene associated. Reactions 5 and 7 both require two enzymatic subunits to carry flux, and reaction 8 can carry flux through either of two isozymes.</p>
        <fig id="F4" position="float">
          <label>Figure 4</label>
          <caption>
            <p><bold>Integrating expression data with a prototypic network model</bold>. <bold>A</bold>. Prototypic network model. Production of metabolite E is the metabolic objective (reaction 9). Reactions 4 and 6 are catalyzed by a single enzyme. Reactions 5 and 7 require enzymes composed of two necessary subunits. Reaction 8 can be catalyzed by either of two isozymes. <bold>B </bold>- <bold>D </bold>display the results of integrating expression data in Tables 3 - 5. Red indicates that a gene (reaction) is expressed (active).</p>
          </caption>
          <graphic xlink:href="1752-0509-5-147-4"/>
        </fig>
        <p>The expression data applied to this network are shown in Table <xref ref-type="table" rid="T3">3</xref>. Using simple thresholding at a threshold expression level of 10 does not produce a functional model. As shown in Table <xref ref-type="table" rid="T3">3</xref> and Figure <xref ref-type="fig" rid="F4">4b</xref>, GIMME reactivates the genes <italic>g</italic>5a and <italic>g</italic>7b. Because reaction 7 is the only method of producing metabolite E (the metabolic objective), this reaction must be active and both subunits (<italic>g</italic><sub>7a </sub>and <italic>g</italic><sub>7b</sub>) must be expressed. Production of E also requires metabolite B and either reaction 5 or reaction 6. The expression data showed that both genes <italic>g</italic><sub>5a </sub>and <italic>g</italic><sub>6 </sub>were below the expression threshold; GIMME chose to activate <italic>g</italic><sub>5a </sub>since its expression was closer to the threshold.</p>
        <table-wrap id="T3" position="float">
          <label>Table 3</label>
          <caption>
            <p>Expression data for GIMME example</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th align="right">Gene</th>
                <th align="center">Expression</th>
                <th align="center">Simple thresholding</th>
                <th align="center">GIMME</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>4</sub>
                </td>
                <td align="center">13</td>
                <td align="center">1</td>
                <td align="center">1</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>5a</sub>
                </td>
                <td align="center">6</td>
                <td align="center">0</td>
                <td align="center">1</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>5b</sub>
                </td>
                <td align="center">12</td>
                <td align="center">1</td>
                <td align="center">1</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>6</sub>
                </td>
                <td align="center">2</td>
                <td align="center">0</td>
                <td align="center">0</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>7a</sub>
                </td>
                <td align="center">18</td>
                <td align="center">1</td>
                <td align="center">1</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>7b</sub>
                </td>
                <td align="center">6</td>
                <td align="center">0</td>
                <td align="center">1</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>8a</sub>
                </td>
                <td align="center">2</td>
                <td align="center">0</td>
                <td align="center">0</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>8b</sub>
                </td>
                <td align="center">4</td>
                <td align="center">0</td>
                <td align="center">0</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>Expression values for genes of the network shown in Figure 5a. "Simple thresholding" is the gene state after a simple threshold of 10 is applied to the expression values. "GIMME" is the gene state calculated by GIMME that produces a functioning model. All expression values are arbitrary units.</p>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec>
        <title>iMAT</title>
        <p>Shlomi, <italic>et al</italic>. [<xref ref-type="bibr" rid="B27">27</xref>], introduced the iMAT algorithm to create tissue-specific models of mammalian metabolism. Briefly, reactions or genes were classified as having either low, regular, or high activity using information from several databases. An optimization problem was formulated such that</p>
        <p>
          <disp-formula id="bmcM24">
            <label>(24)</label>
            <mml:math id="M33" name="1752-0509-5-147-i34" overflow="scroll">
              <mml:mrow>
                <mml:msub>
                  <mml:mrow>
                    <mml:mi>v</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                </mml:msub>
                <mml:mfenced open="{">
                  <mml:mrow>
                    <mml:mtable equalrows="false" columnlines="none none none none none none none none none none none none none none none none none none none" equalcolumns="false" class="array">
                      <mml:mtr>
                        <mml:mtd class="array" columnalign="center">
                          <mml:mo class="MathClass-rel">≥</mml:mo>
                          <mml:mi>ε</mml:mi>
                          <mml:mspace width="1em" class="quad"/>
                          <mml:mstyle class="text">
                            <mml:mtext class="textsf" mathvariant="sans-serif">if reaction </mml:mtext>
                          </mml:mstyle>
                          <mml:mi>i</mml:mi>
                          <mml:mspace width="2.77695pt" class="tmspace"/>
                          <mml:mstyle class="text">
                            <mml:mtext class="textsf" mathvariant="sans-serif">has high activity</mml:mtext>
                          </mml:mstyle>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd class="array" columnalign="center">
                          <mml:mo class="MathClass-rel">≤</mml:mo>
                          <mml:mi>ε</mml:mi>
                          <mml:mspace width="1em" class="quad"/>
                          <mml:mstyle class="text">
                            <mml:mtext class="textsf" mathvariant="sans-serif">if reaction </mml:mtext>
                          </mml:mstyle>
                          <mml:mi>i</mml:mi>
                          <mml:mspace width="2.77695pt" class="tmspace"/>
                          <mml:mstyle class="text">
                            <mml:mtext class="textsf" mathvariant="sans-serif">has low activity</mml:mtext>
                          </mml:mstyle>
                        </mml:mtd>
                      </mml:mtr>
                      <mml:mtr>
                        <mml:mtd class="array" columnalign="center"/>
                      </mml:mtr>
                    </mml:mtable>
                  </mml:mrow>
                </mml:mfenced>
              </mml:mrow>
            </mml:math>
          </disp-formula>
        </p>
        <p>for each reaction flux <italic>v<sub>i </sub></italic>and some small flux <italic>ε</italic>. The optimization attempted to preserve the reaction classifications while enforcing that the resulting set of reaction fluxes be feasible (mass balanced). The mass-balance approach attempts to yield functional models in multicellular organisms that lack a clearly defined metabolic objective.</p>
        <p><monospace>TIGER</monospace> includes a gene-centric version of the iMAT algorithm. Because <monospace>TIGER</monospace> allows multilevel variables, each gene in the GPR is allowed to occupy a state of low (0), medium (1), or high (2) activity. The multilevel operators in the GPR then combine the gene expression values to create a reaction indicator with the same three levels. Rules are added to enforce the constraints in equation (24). Additionally, if a metabolic objective is available for the organism, the flux through the corresponding objective reaction can be constrained above a minimum value.</p>
        <p>iMAT was used to integrate the activity data in Table <xref ref-type="table" rid="T4">4</xref> with the network model in Figure <xref ref-type="fig" rid="F4">4a</xref>. The results are shown in Figure <xref ref-type="fig" rid="F4">4c</xref>. Notice that the high activity of gene <italic>g</italic><sub>8b </sub>requires that reactions 8 and 10 carry flux. Because production of metabolite G is not a part of the system's metabolic objective, reaction 8 would most likely not carry flux in the FBA flux distribution for this network; the activity seen in this side pathway is enforced by the iMAT constraints.</p>
        <table-wrap id="T4" position="float">
          <label>Table 4</label>
          <caption>
            <p>Activity levels for iMAT example</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th align="right">Gene</th>
                <th align="center">Activity level</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>4</sub>
                </td>
                <td align="center">medium</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>5a</sub>
                </td>
                <td align="center">low</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>5b</sub>
                </td>
                <td align="center">low</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>6</sub>
                </td>
                <td align="center">high</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>7a</sub>
                </td>
                <td align="center">high</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>7b</sub>
                </td>
                <td align="center">high</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>8a</sub>
                </td>
                <td align="center">medium</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>8b</sub>
                </td>
                <td align="center">high</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>Classification of genes according to "low", "medium", or "high" activity for iMAT. Genes correspond to the network shown in Figure 5a. iMAT produces the integrated network shown in Figure 5c.</p>
          </table-wrap-foot>
        </table-wrap>
      </sec>
      <sec>
        <title>MADE</title>
        <p>Metabolic Adjustment by Differential Expression (MADE) removes the need for a pre-defined "on"/"off" threshold when integrating expression data [<xref ref-type="bibr" rid="B12">12</xref>]. Instead, MADE uses the differential expression between two or more conditions to determine which genes or proteins are likely to be "on" or "off". If a gene increases significantly between conditions 1 and 2, MADE attempts to turn the gene "off" in condition 1 and "on" in condition 2. The expression data are mapped while ensuring model functionality in all conditions, and the statistical significance of the expression changes are used to prioritize discrepancies.</p>
        <p>The <monospace>TIGER</monospace> implementation of MADE offers two improvements. First, genes are allowed to be multilevel instead of binary. The user is allowed to define a mapping between the multiple levels of gene expression and the flux constraints for the corresponding reactions. Second, <monospace>TIGER</monospace> MADE allows comparisons among states that do not appear as a linear sequence. The original MADE algorithm used a series of <italic>n </italic>conditions <italic>C</italic><sub>1</sub>, <italic>C</italic><sub>2</sub>, ..., <italic>C<sub>n</sub></italic>, and <italic>n </italic>- 1 sets of expression data describing the changes <italic>C</italic><sub>1 </sub>→ <italic>C</italic><sub>2</sub>, <italic>C</italic><sub>2 </sub>→ <italic>C</italic><sub>3</sub>, ..., C<sub><italic>n</italic>-1 </sub>→ <italic>C<sub>n</sub></italic>. <monospace>TIGER</monospace> MADE allows any number of connections between the <italic>n </italic>states.</p>
        <p>A conceptual example of <monospace>TIGER</monospace> MADE's capabilities is presented in Figure <xref ref-type="fig" rid="F5">5</xref>. The goal in this example is to use expression data from five bacterial strains to develop strain-specific metabolic models. Strains <italic>A </italic>and <italic>B </italic>were evolved from the same parent strain <italic>P</italic>. Strain <italic>A </italic>later gave rise to two additional strains, <italic>A</italic>1 and <italic>A</italic>2. A matrix containing the differential expression between each strain and its predecessor is calculated. A transition matrix <italic>T </italic>is defined as follows: if <italic>T</italic>(<italic>i</italic>, <italic>j</italic>) = <italic>k</italic>, then the <italic>k</italic>th column of the differential expression matrix was calculated between strains <italic>i </italic>and <italic>j</italic>. Values greater than one in this column indicate that expression is higher in strain <italic>j </italic>than in strain <italic>i</italic>. These two matrices are used by <monospace>TIGER</monospace> MADE to create a single optimization problem. The result is a functional gene state for each condition that maximizes the significant changes in gene expression between each strain and its parent.</p>
        <fig id="F5" position="float">
          <label>Figure 5</label>
          <caption>
            <p><bold>Conceptual example using the enhanced MADE algorithm</bold>. Workflow for integrating expression data from evolved bacterial cultures using <monospace>TIGER</monospace>'s enhanced MADE algorithm. Parent strain <italic>P </italic>splits into strains <italic>A </italic>and <italic>B</italic>. Strain <italic>A </italic>further diverges into strains <italic>A</italic>1 and <italic>A</italic>2. Expression data indicates fold change between different strains for each gene. The interaction matrix indicates that the first column of fold changes represents a change from <italic>P </italic>to <italic>A</italic>, the second column from <italic>P </italic>to <italic>B</italic>, etc. The expression data and the interaction matrix are combined to create gene states for each bacterial strain.</p>
          </caption>
          <graphic xlink:href="1752-0509-5-147-5"/>
        </fig>
        <p>Figure <xref ref-type="fig" rid="F4">4d</xref> shows the results of applying MADE on three network models simultaneously. Each resulting model is functional and captures the most significant differences described the fold changes listed in Table <xref ref-type="table" rid="T5">5</xref>. Notice that despite significant changes in enzyme expression for reactions 4 and 7, these reactions remain "on" in all models because they are required to produce metabolite E, the metabolic objective.</p>
        <table-wrap id="T5" position="float">
          <label>Table 5</label>
          <caption>
            <p>Expression data for MADE example</p>
          </caption>
          <table frame="hsides" rules="groups">
            <thead>
              <tr>
                <th/>
                <th align="center" colspan="6">Fold change</th>
                <th align="center" colspan="3">MADE states</th>
              </tr>
              <tr>
                <th/>
                <th colspan="6">
                  <hr/>
                </th>
                <th colspan="3">
                  <hr/>
                </th>
              </tr>
              <tr>
                <th align="right">Gene</th>
                <th align="center">1 → 2</th>
                <th align="center">
                  <italic>P</italic>
                </th>
                <th align="center">2 → 3</th>
                <th align="center">
                  <italic>P</italic>
                </th>
                <th align="center">3 → 1</th>
                <th align="center">
                  <italic>P</italic>
                </th>
                <th align="center">1</th>
                <th align="center">2</th>
                <th align="center">3</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>4</sub>
                </td>
                <td align="center">2.1</td>
                <td align="center">0.68</td>
                <td align="center">3.0</td>
                <td align="center">0.08</td>
                <td align="center">0.7</td>
                <td align="center">0.15</td>
                <td align="center">1</td>
                <td align="center">1</td>
                <td align="center">1</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>5a</sub>
                </td>
                <td align="center">0.5</td>
                <td align="center">0.45</td>
                <td align="center">8.0</td>
                <td align="center">0.44</td>
                <td align="center">0.8</td>
                <td align="center">0.22</td>
                <td align="center">1</td>
                <td align="center">0</td>
                <td align="center">1</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>5b</sub>
                </td>
                <td align="center">1.1</td>
                <td align="center">0.07</td>
                <td align="center">0.1</td>
                <td align="center">0.49</td>
                <td align="center">2.2</td>
                <td align="center">0.03</td>
                <td align="center">1</td>
                <td align="center">1</td>
                <td align="center">0</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>6</sub>
                </td>
                <td align="center">3.6</td>
                <td align="center">0.05</td>
                <td align="center">1.6</td>
                <td align="center">0.22</td>
                <td align="center">0.4</td>
                <td align="center">0.48</td>
                <td align="center">0</td>
                <td align="center">1</td>
                <td align="center">1</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>7a</sub>
                </td>
                <td align="center">1.4</td>
                <td align="center">0.38</td>
                <td align="center">4.2</td>
                <td align="center">0.40</td>
                <td align="center">1.8</td>
                <td align="center">0.43</td>
                <td align="center">1</td>
                <td align="center">1</td>
                <td align="center">1</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>7b</sub>
                </td>
                <td align="center">2.3</td>
                <td align="center">0.04</td>
                <td align="center">0.4</td>
                <td align="center">0.19</td>
                <td align="center">0.3</td>
                <td align="center">0.12</td>
                <td align="center">1</td>
                <td align="center">1</td>
                <td align="center">1</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>8a</sub>
                </td>
                <td align="center">1.3</td>
                <td align="center">0.40</td>
                <td align="center">7.3</td>
                <td align="center">0.21</td>
                <td align="center">0.2</td>
                <td align="center">0.45</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">1</td>
              </tr>
              <tr>
                <td align="right">
                  <italic>g</italic>
                  <sub>8b</sub>
                </td>
                <td align="center">0.9</td>
                <td align="center">0.89</td>
                <td align="center">4.1</td>
                <td align="center">0.83</td>
                <td align="center">0.1</td>
                <td align="center">0.28</td>
                <td align="center">0</td>
                <td align="center">0</td>
                <td align="center">1</td>
              </tr>
            </tbody>
          </table>
          <table-wrap-foot>
            <p>Fold change and <italic>P</italic>-values for the MADE example. Column "1 → 2" and indicates the fold change in expression between conditions 1 and 2; <italic>P </italic>is the <italic>P</italic>-value for this change. "MADE states" are the binary gene states returned by the algorithm. The states maximize the transitions in the expression data while retaining model functionality in each condition. Gene names correspond to the network in Figure 5a. Results are also depicted in Figure 5d.</p>
          </table-wrap-foot>
        </table-wrap>
        <p>Source code for all of the examples in Figure <xref ref-type="fig" rid="F4">4</xref> are available in the file <monospace>test/gimme_imat_made_examples.m</monospace> of the <monospace>TIGER</monospace> distribution.</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>Conclusions</title>
    <p>We have presented <monospace>TIGER</monospace>, a software platform for converting generalized Boolean and multilevel rules to mixed-integer linear programs, and coupling these rules to genome-scale models of metabolism. The flexibility of <monospace>TIGER</monospace>'s generalized rule format allows for a more accurate description of biological processes such as catalysis by isozymes and multi-meric proteins, metabolic flux control, and transcriptional regulation. These features were used to identify and correct inconsistencies within an existing TRN model of <italic>Saccharomyces cerevisiae</italic>. We have also demonstrated how <monospace>TIGER</monospace> can be used as a starting point for implementing and improving existing algorithms for genome-scale analysis.</p>
    <p>In addition to adding implementations of other gene-centric algorithms to <monospace>TIGER</monospace>, we are exploring methods to improve the solution efficiency of the generated MILP. Possible strategies include exploiting indicator constraints, specially-ordered-sets (SOS), and other solver optimizations through CMPI.</p>
  </sec>
  <sec>
    <title>Availability and requirements</title>
    <p>
      <bold>Project name: </bold>
      <monospace>TIGER</monospace>
    </p>
    <p><bold>Project home page: </bold><ext-link ext-link-type="uri" xlink:href="http://bme.virginia.edu/csbl/downloads">http://bme.virginia.edu/csbl/downloads</ext-link> or <ext-link ext-link-type="uri" xlink:href="http://csbl.bitbucket.org/tiger">http://csbl.bitbucket.org/tiger</ext-link></p>
    <p><bold>Operating system: </bold>Platform independent</p>
    <p><bold>Programming language: </bold>Matlab</p>
    <p><bold>Other requirements: </bold>Matlab v7.0 or higher, a Mixed-Integer Linear Programming solver (e.g. CPLEX, Gurobi, or GLPK)</p>
    <p><bold>License: </bold>MIT</p>
    <p><bold>Non-academic use restrictions: </bold>None</p>
  </sec>
  <sec>
    <title>List of abbreviations used</title>
    <p>TIGER: Toolbox for Integrating Genome-scale metabolism, Expression, and Regulation; COBRA: COnstraint-Based Reconstruction and Analysis; FBA: Flux Balance Analysis; GPR: Gene-Protein-Reaction; TRN: Transcriptional Regulatory Network; MILP: Mixed-Integer Linear Program; SR-FBA: Steady-State Regulatory FBA; iND750: Genome-scale model of <italic>Saccharomyces cerevisiae </italic>metabolism; iMH805: Genome-scale transcriptional regulatory network for <italic>Saccharomyces cerevisiae</italic>.; CMPI: Common Mathematical Programming Interface; GIMME: Gene Inactivity Moderated by Metabolism and Expression; iMAT: Integrative Metabolic Analysis Tool; MADE: Metabolic Adjustment by Differential Expression.</p>
  </sec>
  <sec>
    <title>Authors' contributions</title>
    <p>PAJ designed and wrote the <monospace>TIGER</monospace> software and performed the simulations. KAL prepared the TRN validation study and contributed <monospace>TIGER</monospace> functions. The project was conceived by PAJ and JP, and advised by JP. All authors wrote and reviewed the manuscript.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="S1">
      <caption>
        <title>Additional file 1</title>
        <p><bold>Supplementary Methods</bold>. Detailed grammar for <monospace>TIGER</monospace> rules and specifics on the rule to MILP conversion process.</p>
      </caption>
      <media xlink:href="1752-0509-5-147-S1.PDF" mimetype="application" mime-subtype="pdf">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
    <supplementary-material content-type="local-data" id="S2">
      <caption>
        <title>Additional file 2</title>
        <p><bold>TIGER source code</bold>. Source code, documentation, and tutorials are also available online at <ext-link ext-link-type="uri" xlink:href="http://bme.virginia.edu/csbl/downloads/">http://bme.virginia.edu/csbl/downloads/</ext-link> or <ext-link ext-link-type="uri" xlink:href="http://csbl.bitbucket.org/tiger">http://csbl.bitbucket.org/tiger</ext-link>.</p>
      </caption>
      <media xlink:href="1752-0509-5-147-S2.GZ" mimetype="application" mime-subtype="x-zip-compressed">
        <caption>
          <p>Click here for file</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec>
    <title>Acknowledgements and Funding</title>
    <p>We thank the reviewers for their thoughtful suggestions. Charles Haggart tested many of the functions and offered helpful feedback. This work is supported by the NSF (GRF to PAJ, REU to KAL, and CAREER award 0643548 to JP) and the NIH (R01 GM088244 to JP).</p>
  </sec>
  <ref-list>
    <ref id="B1">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Oberhardt</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Palsson</surname>
          <given-names>BØ</given-names>
        </name>
        <name>
          <surname>Papin</surname>
          <given-names>JA</given-names>
        </name>
        <article-title>Applications of genome-scale metabolic reconstructions</article-title>
        <source>Mol Syst Biol</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>320</fpage>
        <pub-id pub-id-type="pmid">19888215</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B2">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Burgard</surname>
          <given-names>AP</given-names>
        </name>
        <name>
          <surname>Pharkya</surname>
          <given-names>P</given-names>
        </name>
        <name>
          <surname>Maranas</surname>
          <given-names>CD</given-names>
        </name>
        <article-title>Optknock: a bilevel programming framework for identifying gene knockout strategies for microbial strain optimization</article-title>
        <source>Biotechnol Bioeng</source>
        <year>2003</year>
        <volume>84</volume>
        <issue>6</issue>
        <fpage>647</fpage>
        <lpage>57</lpage>
        <pub-id pub-id-type="doi">10.1002/bit.10803</pub-id>
        <pub-id pub-id-type="pmid">14595777</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B3">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Oberhardt</surname>
          <given-names>MA</given-names>
        </name>
        <name>
          <surname>Goldberg</surname>
          <given-names>JB</given-names>
        </name>
        <name>
          <surname>Hogardt</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Papin</surname>
          <given-names>JA</given-names>
        </name>
        <article-title>Metabolic network analysis of Pseudomonas aeruginosa during chronic cystic fibrosis lung infection</article-title>
        <source>J Bacteriol</source>
        <year>2010</year>
        <volume>192</volume>
        <issue>20</issue>
        <fpage>5534</fpage>
        <lpage>48</lpage>
        <pub-id pub-id-type="doi">10.1128/JB.00900-10</pub-id>
        <pub-id pub-id-type="pmid">20709898</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B4">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Klitgord</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Segrè</surname>
          <given-names>D</given-names>
        </name>
        <article-title>Environments that induce synthetic microbial ecosystems</article-title>
        <source>PLoS Comput Biol</source>
        <year>2010</year>
        <volume>6</volume>
        <issue>11</issue>
        <fpage>e1001002</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1001002</pub-id>
        <pub-id pub-id-type="pmid">21124952</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B5">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Schmidt</surname>
          <given-names>BJ</given-names>
        </name>
        <name>
          <surname>Lin-Schmidt</surname>
          <given-names>X</given-names>
        </name>
        <name>
          <surname>Chamberlin</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Salehi-Ashtiani</surname>
          <given-names>K</given-names>
        </name>
        <name>
          <surname>Papin</surname>
          <given-names>JA</given-names>
        </name>
        <article-title>Metabolic systems analysis to advance algal biotechnology</article-title>
        <source>Biotechnol J</source>
        <year>2010</year>
        <volume>5</volume>
        <issue>7</issue>
        <fpage>660</fpage>
        <lpage>70</lpage>
        <pub-id pub-id-type="doi">10.1002/biot.201000129</pub-id>
        <pub-id pub-id-type="pmid">20665641</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B6">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Lewis</surname>
          <given-names>NE</given-names>
        </name>
        <name>
          <surname>Schramm</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Bordbar</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Schellenberger</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Andersen</surname>
          <given-names>MP</given-names>
        </name>
        <name>
          <surname>Cheng</surname>
          <given-names>JK</given-names>
        </name>
        <name>
          <surname>Patel</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Yee</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Lewis</surname>
          <given-names>RA</given-names>
        </name>
        <name>
          <surname>Eils</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>König</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Palsson</surname>
          <given-names>BØ</given-names>
        </name>
        <article-title>Large-scale in silico modeling of metabolic interactions between cell types in the human brain</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <issue>12</issue>
        <fpage>1279</fpage>
        <lpage>85</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1711</pub-id>
        <pub-id pub-id-type="pmid">21102456</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B7">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Orth</surname>
          <given-names>JD</given-names>
        </name>
        <name>
          <surname>Thiele</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Palsson</surname>
          <given-names>BØ</given-names>
        </name>
        <article-title>What is flux balance analysis?</article-title>
        <source>Nat Biotechnol</source>
        <year>2010</year>
        <volume>28</volume>
        <issue>3</issue>
        <fpage>245</fpage>
        <lpage>8</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1614</pub-id>
        <pub-id pub-id-type="pmid">20212490</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B8">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Feist</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Palsson</surname>
          <given-names>BO</given-names>
        </name>
        <article-title>The biomass objective function</article-title>
        <source>Curr Opin Microbiol</source>
        <year>2010</year>
        <volume>13</volume>
        <issue>3</issue>
        <fpage>344</fpage>
        <lpage>349</lpage>
        <pub-id pub-id-type="doi">10.1016/j.mib.2010.03.003</pub-id>
        <pub-id pub-id-type="pmid">20430689</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B9">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Duarte</surname>
          <given-names>NC</given-names>
        </name>
        <name>
          <surname>Herrgård</surname>
          <given-names>MJ</given-names>
        </name>
        <name>
          <surname>Palsson</surname>
          <given-names>BØ</given-names>
        </name>
        <article-title>Reconstruction and validation of Saccharomyces cerevisiae iND750, a fully compartmentalized genome-scale metabolic model</article-title>
        <source>Genome Res</source>
        <year>2004</year>
        <volume>14</volume>
        <issue>7</issue>
        <fpage>1298</fpage>
        <lpage>309</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.2250904</pub-id>
        <pub-id pub-id-type="pmid">15197165</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B10">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Shlomi</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Eisenberg</surname>
          <given-names>Y</given-names>
        </name>
        <name>
          <surname>Sharan</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Ruppin</surname>
          <given-names>E</given-names>
        </name>
        <article-title>A genome-scale computational study of the interplay between transcriptional regulation and metabolism</article-title>
        <source>Mol Syst Biol</source>
        <year>2007</year>
        <volume>3</volume>
        <fpage>101</fpage>
        <pub-id pub-id-type="pmid">17437026</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B11">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Kim</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Reed</surname>
          <given-names>JL</given-names>
        </name>
        <article-title>OptORF: Optimal metabolic and regulatory perturbations for metabolic engineering of microbial strains</article-title>
        <source>BMC Syst Biol</source>
        <year>2010</year>
        <volume>4</volume>
        <fpage>53</fpage>
        <pub-id pub-id-type="doi">10.1186/1752-0509-4-53</pub-id>
        <pub-id pub-id-type="pmid">20426856</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B12">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Jensen</surname>
          <given-names>PA</given-names>
        </name>
        <name>
          <surname>Papin</surname>
          <given-names>JA</given-names>
        </name>
        <article-title>Functional integration of a metabolic network model and expression data without arbitrary thresholding</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>4</issue>
        <fpage>541</fpage>
        <lpage>7</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btq702</pub-id>
        <pub-id pub-id-type="pmid">21172910</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B13">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Barua</surname>
          <given-names>D</given-names>
        </name>
        <name>
          <surname>Kim</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Reed</surname>
          <given-names>JL</given-names>
        </name>
        <article-title>An automated phenotype-driven approach (GeneForce) for refining metabolic and regulatory models</article-title>
        <source>PLoS Comput Biol</source>
        <year>2010</year>
        <volume>6</volume>
        <issue>10</issue>
        <fpage>e1000970</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000970</pub-id>
        <pub-id pub-id-type="pmid">21060853</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B14">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Suthers</surname>
          <given-names>PF</given-names>
        </name>
        <name>
          <surname>Zomorrodi</surname>
          <given-names>A</given-names>
        </name>
        <name>
          <surname>Maranas</surname>
          <given-names>CD</given-names>
        </name>
        <article-title>Genome-scale gene/reaction essentiality and synthetic lethality analysis</article-title>
        <source>Mol Syst Biol</source>
        <year>2009</year>
        <volume>5</volume>
        <fpage>301</fpage>
        <pub-id pub-id-type="pmid">19690570</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B15">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Covert</surname>
          <given-names>MW</given-names>
        </name>
        <name>
          <surname>Knight</surname>
          <given-names>EM</given-names>
        </name>
        <name>
          <surname>Reed</surname>
          <given-names>JL</given-names>
        </name>
        <name>
          <surname>Herrgard</surname>
          <given-names>MJ</given-names>
        </name>
        <name>
          <surname>Palsson</surname>
          <given-names>BO</given-names>
        </name>
        <article-title>Integrating high-throughput and computational data elucidates bacterial networks</article-title>
        <source>Nature</source>
        <year>2004</year>
        <volume>429</volume>
        <issue>6987</issue>
        <fpage>92</fpage>
        <lpage>6</lpage>
        <pub-id pub-id-type="doi">10.1038/nature02456</pub-id>
        <pub-id pub-id-type="pmid">15129285</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B16">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Herrgård</surname>
          <given-names>MJ</given-names>
        </name>
        <name>
          <surname>Lee</surname>
          <given-names>BS</given-names>
        </name>
        <name>
          <surname>Portnoy</surname>
          <given-names>V</given-names>
        </name>
        <name>
          <surname>Palsson</surname>
          <given-names>BØ</given-names>
        </name>
        <article-title>Integrated analysis of regulatory and metabolic networks reveals novel regulatory mechanisms in Saccharomyces cerevisiae</article-title>
        <source>Genome Res</source>
        <year>2006</year>
        <volume>16</volume>
        <issue>5</issue>
        <fpage>627</fpage>
        <lpage>35</lpage>
        <pub-id pub-id-type="doi">10.1101/gr.4083206</pub-id>
        <pub-id pub-id-type="pmid">16606697</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B17">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Covert</surname>
          <given-names>MW</given-names>
        </name>
        <name>
          <surname>Schilling</surname>
          <given-names>CH</given-names>
        </name>
        <name>
          <surname>Palsson</surname>
          <given-names>B</given-names>
        </name>
        <article-title>Regulation of gene expression in flux balance models of metabolism</article-title>
        <source>J Theor Biol</source>
        <year>2001</year>
        <volume>213</volume>
        <fpage>73</fpage>
        <lpage>88</lpage>
        <pub-id pub-id-type="doi">10.1006/jtbi.2001.2405</pub-id>
        <pub-id pub-id-type="pmid">11708855</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B18">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Klamt</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Saez-Rodriguez</surname>
          <given-names>J</given-names>
        </name>
        <name>
          <surname>Gilles</surname>
          <given-names>ED</given-names>
        </name>
        <article-title>Structural and functional analysis of cellular networks with CellNetAnalyzer</article-title>
        <source>BMC Syst Biol</source>
        <year>2007</year>
        <volume>1</volume>
        <fpage>2</fpage>
        <pub-id pub-id-type="doi">10.1186/1752-0509-1-2</pub-id>
        <pub-id pub-id-type="pmid">17408509</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B19">
      <mixed-citation publication-type="other">
        <name>
          <surname>Cvijovic</surname>
          <given-names>M</given-names>
        </name>
        <name>
          <surname>Olivares-Hernández</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Agren</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Dahr</surname>
          <given-names>N</given-names>
        </name>
        <name>
          <surname>Vongsangnak</surname>
          <given-names>W</given-names>
        </name>
        <name>
          <surname>Nookaew</surname>
          <given-names>I</given-names>
        </name>
        <name>
          <surname>Patil</surname>
          <given-names>KR</given-names>
        </name>
        <name>
          <surname>Nielsen</surname>
          <given-names>J</given-names>
        </name>
        <article-title>BioMet Toolbox: genome-wide analysis of metabolism</article-title>
        <source>Nucleic Acids Res</source>
        <year>2010</year>
        <issue>38 Web Server</issue>
        <fpage>W144</fpage>
        <lpage>W149</lpage>
      </mixed-citation>
    </ref>
    <ref id="B20">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Becker</surname>
          <given-names>SA</given-names>
        </name>
        <name>
          <surname>Feist</surname>
          <given-names>AM</given-names>
        </name>
        <name>
          <surname>Mo</surname>
          <given-names>ML</given-names>
        </name>
        <name>
          <surname>Hannum</surname>
          <given-names>G</given-names>
        </name>
        <name>
          <surname>Palsson</surname>
          <given-names>BØ</given-names>
        </name>
        <name>
          <surname>Herrgard</surname>
          <given-names>MJ</given-names>
        </name>
        <article-title>Quantitative prediction of cellular metabolism with constraint-based models: the COBRA Toolbox</article-title>
        <source>Nat Protoc</source>
        <year>2007</year>
        <volume>2</volume>
        <issue>3</issue>
        <fpage>727</fpage>
        <lpage>38</lpage>
        <pub-id pub-id-type="doi">10.1038/nprot.2007.99</pub-id>
        <pub-id pub-id-type="pmid">17406635</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B21">
      <mixed-citation publication-type="book">
        <name>
          <surname>Kuhn</surname>
          <given-names>HW</given-names>
        </name>
        <name>
          <surname>Tucker</surname>
          <given-names>AW</given-names>
        </name>
        <name>
          <surname>Dantzig</surname>
          <given-names>GB</given-names>
        </name>
        <source>Linear inequalities and related systems</source>
        <year>1956</year>
        <volume>38</volume>
        <publisher-name>Princeton: Princeton University Press</publisher-name>
      </mixed-citation>
    </ref>
    <ref id="B22">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Mahadevan</surname>
          <given-names>R</given-names>
        </name>
        <name>
          <surname>Schilling</surname>
          <given-names>CH</given-names>
        </name>
        <article-title>The effects of alternate optimal solutions in constraint-based genome-scale metabolic models</article-title>
        <source>Metab Eng</source>
        <year>2003</year>
        <volume>5</volume>
        <issue>4</issue>
        <fpage>264</fpage>
        <lpage>276</lpage>
        <pub-id pub-id-type="doi">10.1016/j.ymben.2003.09.002</pub-id>
        <pub-id pub-id-type="pmid">14642354</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B23">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gudmundsson</surname>
          <given-names>S</given-names>
        </name>
        <name>
          <surname>Thiele</surname>
          <given-names>I</given-names>
        </name>
        <article-title>Computationally efficient flux variability analysis</article-title>
        <source>BMC Bioinformatics</source>
        <year>2010</year>
        <volume>11</volume>
        <fpage>489</fpage>
        <pub-id pub-id-type="doi">10.1186/1471-2105-11-489</pub-id>
        <pub-id pub-id-type="pmid">20920235</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B24">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Gianchandani</surname>
          <given-names>EP</given-names>
        </name>
        <name>
          <surname>Papin</surname>
          <given-names>JA</given-names>
        </name>
        <name>
          <surname>Price</surname>
          <given-names>ND</given-names>
        </name>
        <name>
          <surname>Joyce</surname>
          <given-names>AR</given-names>
        </name>
        <name>
          <surname>Palsson</surname>
          <given-names>BO</given-names>
        </name>
        <article-title>Matrix formalism to describe functional states of transcriptional regulatory systems</article-title>
        <source>PLoS Comput Biol</source>
        <year>2006</year>
        <volume>2</volume>
        <issue>8</issue>
        <fpage>e101</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.0020101</pub-id>
        <pub-id pub-id-type="pmid">16895435</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B25">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Turi</surname>
          <given-names>TG</given-names>
        </name>
        <name>
          <surname>Loper</surname>
          <given-names>JC</given-names>
        </name>
        <article-title>Multiple regulatory elements control expression of the gene encoding the Saccharomyces cerevisiae cytochrome P450, lanosterol 14 alpha-demethylase (ERG11)</article-title>
        <source>J Biol Chem</source>
        <year>1992</year>
        <volume>267</volume>
        <issue>3</issue>
        <fpage>2046</fpage>
        <lpage>2056</lpage>
        <pub-id pub-id-type="pmid">1730736</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B26">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Becker</surname>
          <given-names>SA</given-names>
        </name>
        <name>
          <surname>Palsson</surname>
          <given-names>BO</given-names>
        </name>
        <article-title>Context-specific metabolic networks are consistent with experiments</article-title>
        <source>PLoS Comput Biol</source>
        <year>2008</year>
        <volume>4</volume>
        <issue>5</issue>
        <fpage>e1000082</fpage>
        <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000082</pub-id>
        <pub-id pub-id-type="pmid">18483554</pub-id>
      </mixed-citation>
    </ref>
    <ref id="B27">
      <mixed-citation publication-type="journal">
        <name>
          <surname>Shlomi</surname>
          <given-names>T</given-names>
        </name>
        <name>
          <surname>Cabili</surname>
          <given-names>MN</given-names>
        </name>
        <name>
          <surname>Herrgård</surname>
          <given-names>MJ</given-names>
        </name>
        <name>
          <surname>Palsson</surname>
          <given-names>BØ</given-names>
        </name>
        <name>
          <surname>Ruppin</surname>
          <given-names>E</given-names>
        </name>
        <article-title>Network-based prediction of human tissue-specific metabolism</article-title>
        <source>Nat Biotechnol</source>
        <year>2008</year>
        <volume>26</volume>
        <issue>9</issue>
        <fpage>1003</fpage>
        <lpage>10</lpage>
        <pub-id pub-id-type="doi">10.1038/nbt.1487</pub-id>
        <pub-id pub-id-type="pmid">18711341</pub-id>
      </mixed-citation>
    </ref>
  </ref-list>
</back>
