<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinform Adv</journal-id>
    <journal-id journal-id-type="iso-abbrev">Bioinform Adv</journal-id>
    <journal-id journal-id-type="publisher-id">bioadv</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics Advances</journal-title>
    </journal-title-group>
    <issn pub-type="epub">2635-0041</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">9744439</article-id>
    <article-id pub-id-type="doi">10.1093/bioadv/vbac092</article-id>
    <article-id pub-id-type="publisher-id">vbac092</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Original Paper</subject>
        <subj-group subj-group-type="category-toc-heading">
          <subject>Systems Biology</subject>
        </subj-group>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01060</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>MAST: a hybrid Multi-Agent Spatio-Temporal model of tumor microenvironment informed using a data-driven approach</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-7971-963X</contrib-id>
        <name>
          <surname>Cesaro</surname>
          <given-names>Giulia</given-names>
        </name>
        <aff><institution>Department of Information Engineering, University of Padova</institution>, 35131 Padova, <country country="IT">Italy</country></aff>
        <xref rid="vbac092-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-2386-5475</contrib-id>
        <name>
          <surname>Milia</surname>
          <given-names>Mikele</given-names>
        </name>
        <aff><institution>Department of Information Engineering, University of Padova</institution>, 35131 Padova, <country country="IT">Italy</country></aff>
        <xref rid="vbac092-FM1" ref-type="author-notes"/>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-6129-5007</contrib-id>
        <name>
          <surname>Baruzzo</surname>
          <given-names>Giacomo</given-names>
        </name>
        <aff><institution>Department of Information Engineering, University of Padova</institution>, 35131 Padova, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0002-1218-1924</contrib-id>
        <name>
          <surname>Finco</surname>
          <given-names>Giovanni</given-names>
        </name>
        <aff><institution>Department of Information Engineering, University of Padova</institution>, 35131 Padova, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0003-1040-8539</contrib-id>
        <name>
          <surname>Morandini</surname>
          <given-names>Francesco</given-names>
        </name>
        <aff><institution>Department of Information Engineering, University of Padova</institution>, 35131 Padova, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Lazzarini</surname>
          <given-names>Alessio</given-names>
        </name>
        <aff><institution>Department of Information Engineering, University of Padova</institution>, 35131 Padova, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Alotto</surname>
          <given-names>Piergiorgio</given-names>
        </name>
        <aff><institution>Department of Industrial Engineering, University of Padova</institution>, 35131 Padova, <country country="IT">Italy</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>da Cunha Carvalho de Miranda</surname>
          <given-names>Noel Filipe</given-names>
        </name>
        <aff><institution>Department of Pathology, Leiden University Medical Center</institution>, 2300 RC Leiden, <country country="NL">The Netherlands</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Trajanoski</surname>
          <given-names>Zlatko</given-names>
        </name>
        <aff><institution>Biocenter, Institute of Bioinformatics, Medical University of Innsbruck</institution>, 6020 Innsbruck, <country country="AT">Austria</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Finotello</surname>
          <given-names>Francesca</given-names>
        </name>
        <aff><institution>Biocenter, Institute of Bioinformatics, Medical University of Innsbruck</institution>, 6020 Innsbruck, <country country="AT">Austria</country></aff>
        <aff><institution>Institute of Molecular Biology, University Innsbruck</institution>, 6020 Innsbruck, <country country="AT">Austria</country></aff>
        <aff><institution>Digital Science Center (DiSC), University Innsbruck</institution>, 6020 Innsbruck, <country country="AT">Austria</country></aff>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid" authenticated="false">https://orcid.org/0000-0001-8415-4688</contrib-id>
        <name>
          <surname>Di Camillo</surname>
          <given-names>Barbara</given-names>
        </name>
        <aff><institution>Department of Information Engineering, University of Padova</institution>, 35131 Padova, <country country="IT">Italy</country></aff>
        <aff><institution>Department of Comparative Biomedicine and Food Science, University of Padova</institution>, 35020 Padova, <country country="IT">Italy</country></aff>
        <xref rid="vbac092-cor1" ref-type="corresp"/>
        <!--barbara.dicamillo@unipd.it-->
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Lengauer</surname>
          <given-names>Thomas</given-names>
        </name>
        <role>Associate Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="vbac092-cor1">To whom correspondence should be addressed. <email>barbara.dicamillo@unipd.it</email></corresp>
      <fn id="vbac092-FM1">
        <p>The authors wish it to be known that, in their opinion, Giulia Cesaro and Mikele Milia should be regarded as Joint First Authors.</p>
      </fn>
    </author-notes>
    <pub-date pub-type="collection">
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2022-12-05">
      <day>05</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>05</day>
      <month>12</month>
      <year>2022</year>
    </pub-date>
    <volume>2</volume>
    <issue>1</issue>
    <elocation-id>vbac092</elocation-id>
    <history>
      <date date-type="received">
        <day>03</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="editorial-decision">
        <day>23</day>
        <month>11</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>03</day>
        <month>12</month>
        <year>2022</year>
      </date>
      <date date-type="corrected-typeset">
        <day>12</day>
        <month>12</month>
        <year>2022</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2022. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2022</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="vbac092.pdf"/>
    <abstract>
      <title>Abstract</title>
      <sec id="s1">
        <title>Motivation</title>
        <p>Recently, several computational modeling approaches, such as agent-based models, have been applied to study the interaction dynamics between immune and tumor cells in human cancer. However, each tumor is characterized by a specific and unique tumor microenvironment, emphasizing the need for specialized and personalized studies of each cancer scenario.</p>
      </sec>
      <sec id="s2">
        <title>Results</title>
        <p>We present MAST, a hybrid Multi-Agent Spatio-Temporal model which can be informed using a data-driven approach to simulate unique tumor subtypes and tumor–immune dynamics starting from high-throughput sequencing data. It captures essential components of the tumor microenvironment by coupling a discrete agent-based model with a continuous partial differential equations-based model.</p>
        <p>The application to real data of human colorectal cancer tissue investigating the spatio-temporal evolution and emergent properties of four simulated human colorectal cancer subtypes, along with their agreement with current biological knowledge of tumors and clinical outcome endpoints in a patient cohort, endorse the validity of our approach.</p>
      </sec>
      <sec id="s3">
        <title>Availability and implementation</title>
        <p>MAST, implemented in Python language, is freely available with an open-source license through GitLab (<ext-link xlink:href="https://gitlab.com/sysbiobig/mast" ext-link-type="uri">https://gitlab.com/sysbiobig/mast</ext-link>), and a Docker image is provided to ease its deployment. The submitted software version and test data are available in Zenodo at <ext-link xlink:href="https://dx.doi.org/10.5281/zenodo.7267745" ext-link-type="uri">https://dx.doi.org/10.5281/zenodo.7267745</ext-link>.</p>
      </sec>
      <sec id="s5">
        <title>Supplementary information</title>
        <p><xref rid="sup1" ref-type="supplementary-material">Supplementary data</xref> are available at <italic toggle="yes">Bioinformatics Advances</italic> online.</p>
      </sec>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution> PROACTIVE 2017</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Department of Information Engineering, University of Padova</institution>
          </institution-wrap>
        </funding-source>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="8"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec>
    <title>1 Introduction</title>
    <p>The tumor microenvironment (TME) is composed of multiple interacting cells, including cancer cells, infiltrated immune cells [e.g. T cells, natural killer (NK) cells, dendritic cells (DCs) and macrophages (Ms)], mesenchymal stromal cells or fibroblasts (<xref rid="vbac092-B32" ref-type="bibr">Plava <italic toggle="yes">et al.</italic>, 2019</xref>). The composition of the TME is specific and unique for each cancer and evolves in time and space in response to resources, stresses and (epi)genetic mutations. Indeed, the TME is made up of different cell types and cell states that correspond to distinct activation or metabolic profiles. These entities communicate with each other through physical interactions or by releasing specific molecular signals (<xref rid="vbac092-B3" ref-type="bibr">Baruzzo <italic toggle="yes">et al.</italic>, 2022</xref>) that can induce cell motility, proliferation, death, etc. As a consequence, the composition and organization (e.g. tumor core versus Periphery) of the TME at the initial, middle or late stages of tumor progression can significantly differ.</p>
    <p>Cell–cell interactions in the TME alter cell biology, ultimately influencing disease progression to the point that various heterologous interactions in the TME are now considered hallmarks of cancer biology (<xref rid="vbac092-B19" ref-type="bibr">Hanahan and Coussens, 2012</xref>). In this context, it is of paramount importance to characterize different TME properties and how they affect tumor progression. Integrative and quantitative modeling of the TME, although simplifying many aspects of reality, represents a means toward a better understanding of the dynamics of cancer development, the phenotypes characterizing different TMEs and even generates future outcome prediction to design therapies based on <italic toggle="yes">in silico</italic> observations (<xref rid="vbac092-B31" ref-type="bibr">Peskov <italic toggle="yes">et al.</italic>, 2019</xref>).</p>
    <p>In the literature, there are two main simulation approaches (<xref rid="vbac092-B30" ref-type="bibr">Norton <italic toggle="yes">et al.</italic>, 2019</xref>). The top-down modeling approaches, such as temporal ordinary differential equations or spatio-temporal partial differential equations (PDEs), are meant to model nutrient or signaling molecules concentrations, without focusing on the behavior of each single entity. However, the complex interactions among communication molecules and the details about metabolisms are far to be completely understood in biology and, therefore, only a few system components can be characterized (<xref rid="vbac092-B10" ref-type="bibr">Clarke and Fisher, 2020</xref>; <xref rid="vbac092-B40" ref-type="bibr">Thomas <italic toggle="yes">et al.</italic>, 2016</xref>).</p>
    <p>In contrast, the bottom-up approach focuses on single-cell entities and their individual interactions with the aim of identifying which emergent properties may result from their collective behavior. For example, agent-based models (ABMs) are discrete models where heterogenous entities, i.e. agents, are defined, as well as their behaviors, attributes and interactions following predefined rules (<xref rid="vbac092-B5" ref-type="bibr">Bonabeau, 2002</xref>). Such models better reflect the stochastic, spatial-dependent and heterogenous nature of biology but require more computational power relative to top-down approaches.</p>
    <p>The hybrid approach represents a powerful way to combine the above strategies allowing to describe the different level and scale of biological systems choosing the most suitable modeling approach, at the cost of increasing computational and methodological complexity while integrating such approaches. The combination of the two modeling frameworks might help describing the physical reality at both cellular and communication/metabolism molecules level in the context of TME.</p>
    <p>In the recent years, several quantitative models of increasing complexity have been developed to represent different mechanisms of tumor–immune microenvironment, such as tumor mechanobiology, vasculature, lymphatics and immunotherapy (<xref rid="vbac092-B30" ref-type="bibr">Norton <italic toggle="yes">et al.</italic>, 2019</xref>). For example, <xref rid="vbac092-B14" ref-type="bibr">Frascoli <italic toggle="yes">et al.</italic> (2017)</xref> suggested a stochastic ABM coupled with delay differential equations to mimic cell mobility and cellular adhesion to the extracellular matrix in tumor site. <xref rid="vbac092-B29" ref-type="bibr">Norton <italic toggle="yes">et al.</italic> (2018)</xref> combined three ABMs of tumor–immune system, angiogenesis and tumor-associated stroma to investigate the stroma cell influence on tumor progression. Other ABMs and hybrid models focused on modeling immune escape mechanisms: (i) loss of antigenicity by avoiding immune recognition through antigen presentation thereby reducing tumor-specific immune response; (ii) loss of immunogenicity by expressing inhibitory immune checkpoint molecules, such as PD-L1; and (iii) inducing an immunosuppressive microenvironment (<xref rid="vbac092-B4" ref-type="bibr">Beatty and Gladney, 2015</xref>). In this context, <xref rid="vbac092-B24" ref-type="bibr">Kather <italic toggle="yes">et al.</italic> (2017)</xref> presented a stochastic ABM of immune–tumor–stromal interactions in human colorectal cancer (CRC) to simulate different immunological phenotypes, while <xref rid="vbac092-B16" ref-type="bibr">Gong <italic toggle="yes">et al.</italic> (2017)</xref> proposed a hybrid model of tumor–immune interaction to simulate tumor growth and immune checkpoint inhibitor treatments, targeting the PD-1/PD-L1 axis.</p>
    <p>In this work, we developed MAST, a hybrid Multi-Agent Spatio-Temporal model of human solid tumor tissue that includes an ABM, simulating tumor and immune cell interactions, and a PDE-based model to simulate nutrients diffusion from blood vessels through the tumor tissue (see <xref rid="vbac092-F1" ref-type="fig">Fig. 1</xref>). The use of the two modeling frameworks allows to couple discrete and continuous modeling and capture essential elements of the TME, i.e. cells interaction and nutrients availability. With respect to previous works, MAST introduces three main contributions: (i) it models nutrient diffusion from vessels and cell dynamics in response to nutrient availability; (ii) it models immune escape mechanisms through the accumulation of mutations during the disease course, leading to spatial and temporal heterogeneity of tumor subpopulations; and (iii) it introduces a data-driven approach to inform model parameters, thus simulating specific characteristics of a real TME, from high-throughput data.</p>
    <fig position="float" id="vbac092-F1">
      <label>Fig. 1.</label>
      <caption>
        <p>Schematic representation of MAST, a hybrid multi-ABM of tumor–immune system. (<bold>A</bold>) MAST can be informed through a data-driven approach using several sources of information to model unique characteristics of the TME in a tumor. (<bold>B</bold>) It couples a discrete ABM, which simulates tumor–immune system dynamics in the TME, and a continuous PDEs-based model to simulate nutrient diffusion from vessels. (<bold>C</bold>) MAST provides tabular and graphical outputs in order to analyze spatio-temporal evolution of <italic toggle="yes">in silico</italic> tumor growth simulation</p>
      </caption>
      <graphic xlink:href="vbac092f1" position="float"/>
    </fig>
    <p>In particular, we informed MAST with literature data, as well as genomics and transcriptomics data from bulk and single-cell sequencing technologies, yielding knowledge on tumor mutation rate (<xref rid="vbac092-B22" ref-type="bibr">Huang and Lee, 2022</xref>), percentage of cell types in the TME (<xref rid="vbac092-B37" ref-type="bibr">Sturm <italic toggle="yes">et al.</italic>, 2019</xref>) and loss of immunogenicity, to model the TME of human CRC. The model faithfully recapitulates emergent behavior and predicts tumor progression in four subtypes of CRC tissue, i.e. Consensus Molecular Subtypes (CMS) (<xref rid="vbac092-B18" ref-type="bibr">Guinney <italic toggle="yes">et al.</italic>, 2015</xref>). The model was then used to investigate the effect of different tumor conditions on colorectal tumor growth.</p>
  </sec>
  <sec>
    <title>2 Methods</title>
    <p>MAST allows modeling interactions among tumor cells, necrotic cells, cancer-associated fibroblasts (CAFs), NKs, cytotoxic T lymphocytes (CTLs), regulatory T cells (Tregs) and DCs. It simulates tumor-cell mutations and acquisition of new properties and antigens, toward which the CTLs specialize, including: changes in proliferation/survival fitness (<xref rid="vbac092-B36" ref-type="bibr">Stratton <italic toggle="yes">et al.</italic>, 2009</xref>; <xref rid="vbac092-B43" ref-type="bibr">Vicens and Posada, 2018</xref>); loss/acquisition of antigenicity; loss of immunogenicity; and ability to shape immunosuppressive microenvironment (cancer cells might evade the immune system (IS) by releasing signaling molecules that locally repel IS cells) (<xref rid="vbac092-B4" ref-type="bibr">Beatty and Gladney, 2015</xref>; <xref rid="vbac092-B39" ref-type="bibr">Tang <italic toggle="yes">et al.</italic>, 2020</xref>). Moreover, MAST models nutrient availability in the tissue which drives proliferation and migration in the TME.</p>
    <sec>
      <title>2.1 Model design and implementation</title>
      <p>In the ABM, each agent: (i) autonomously controls its actions; (ii) lives in a physical space, i.e. a 2D grid representing the tissue, where it interacts in a timely and probabilistic manner with other agents and the surrounding environment; and (iii) is characterized by a specific metabolism, i.e. nutrients consumption, and thus competes for nutrients.</p>
      <p>The neighborhood that allows an agent to sense surrounding changes is defined according to Moore’s definition on a 2D lattice as composed of the agent itself and the eight closest, surrounding cells. Two classes of agents, namely cancer-related and immune-related, representing the main categories of cells in TME are modeled. For simplicity, we use agent and cell as synonyms.</p>
      <sec>
        <title>2.1.1 Cancer-related agents</title>
        <p>Cancer is a disease characterized by dysfunctional apoptosis, abnormal cell division and accumulation of mutations that give rise to TME heterogeneity, both in terms of spatial properties and temporal evolution (<xref rid="vbac092-B11" ref-type="bibr">Dagogo-Jack and Shaw, 2018</xref>). During disease, tumor cells accumulate mutations that might result in different subpopulations of malignant cells with distinct mutational profiles and different abilities to survive.</p>
        <p>TME also contains tumor stromal cells, which include fibroblasts and mesenchymal stromal cells. In this environment, CAFs can differentiate and promote tumor growth, angiogenesis and shape an immunosuppressive environment (<xref rid="vbac092-B32" ref-type="bibr">Plava <italic toggle="yes">et al.</italic>, 2019</xref>). In MAST, we simulated CAFs and cancer cells with different mutational burden, also modeling cell division, cell death and cell movement.</p>
        <p><italic toggle="yes">Cell division</italic>: We assume cancer cell duplication probability depends on nutrient concentration and on cancer cell mutation fitness parameter. The probability of a cell to duplicate is computed as:
<disp-formula id="E1"><label>(1)</label><mml:math id="M1" display="block" overflow="scroll"><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="italic">dupl</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mfenced separators="|"><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:msub><mml:mo>θ</mml:mo><mml:mi mathvariant="italic">dupl</mml:mi></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mo>#</mml:mo><mml:mi>neighbCAFs</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>·</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mo>θ</mml:mo><mml:msub><mml:mi mathvariant="italic">dupl</mml:mi><mml:mi mathvariant="italic">stroma</mml:mi></mml:msub></mml:msub></mml:mrow></mml:mfrac></mml:mfrac></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math></disp-formula>
where <inline-formula id="IE1"><mml:math id="IM1" display="inline" overflow="scroll"><mml:mi>N</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> represents the concentration of substances useful for cell duplication (e.g. glucose) in grid position <inline-formula id="IE2"><mml:math id="IM2" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> and <inline-formula id="IE3"><mml:math id="IM3" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">dupl</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is a parameter related to the mutational status of the cell, so that there might be cells duplicating at higher rate than others at the same nutrient concentrations, depending on the cell fitness. To mimic promotion of cancer cell duplication by CAFs, parameter <inline-formula id="IE4"><mml:math id="IM4" display="inline" overflow="scroll"><mml:mo>θ</mml:mo></mml:math></inline-formula><sub><italic toggle="yes">dupl</italic></sub> in <xref rid="E1" ref-type="disp-formula">Equation (1)</xref> is divided by 1 plus the number of CAFs cells in the Moore neighborhood multiplied by parameter <inline-formula id="IE5"><mml:math id="IM5" display="inline" overflow="scroll"><mml:mo>θ</mml:mo></mml:math></inline-formula><sub><italic toggle="yes">dupl_stroma</italic></sub>. When dividing, daughter cancer cells inherit all the mutations of the original cell.</p>
        <p><italic toggle="yes">Cell death</italic>: Cancer cell agents can die by IS attack, as described below, or by lack of nutrients. Even in this latter case, the probability of death depends on both nutrient concentration and mutational status of the cell as follow:
<disp-formula id="E2"><label>(2)</label><mml:math id="M2" display="block" overflow="scroll"><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="italic">necr</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="normal">exp</mml:mi></mml:mrow><mml:mo>⁡</mml:mo><mml:mrow><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mrow><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>M</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mo>θ</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="italic">necr</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfenced></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:math></disp-formula></p>
        <p>where <inline-formula id="IE6"><mml:math id="IM6" display="inline" overflow="scroll"><mml:mi>M</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> represents the concentration of substances useful for cell maintenance (e.g. oxygen) and <inline-formula id="IE7"><mml:math id="IM7" display="inline" overflow="scroll"><mml:mo>θ</mml:mo></mml:math></inline-formula><sub><italic toggle="yes">necr</italic></sub> is a parameter related to the mutational status of the cell, so that there might be cells that survive easily than other in an environment poor of these substances, depending on the cell fitness. To mimic immunogenic cell death, molecules enhancing immune cell recruitment in the area are released after cancer cell death (<xref rid="vbac092-B15" ref-type="bibr">Fucikova <italic toggle="yes">et al.</italic>, 2020</xref>). If cancer cells die by lack of nutrients, they become necrotic remaining in the environment for a certain time and being able to recruit DC agents (<xref rid="vbac092-B35" ref-type="bibr">Sauter <italic toggle="yes">et al.</italic>, 2000</xref>). We did not explicitly model apoptosis.</p>
        <p><italic toggle="yes">Mutation</italic>: If a mutation occurs, it can be of different types, each with a certain rate depending on the tumor type. Here, we are interested in modeling (epi)genetic mutations that can give rise to: (1) loss or acquisition of antigenicity, i.e. new tumor antigens (proteins capable of inducing a tumor-specific immune response); (2) loss of immunogenicity by expressing inhibitory immune checkpoint molecules, such as PD-L1 molecule; (3) release signaling molecules that locally repel immune cells; and (4) increased or decreased duplication/survival fitness which is mimicked by different values of parameters <inline-formula id="IE8"><mml:math id="IM8" display="inline" overflow="scroll"><mml:mo>θ</mml:mo></mml:math></inline-formula><sub><italic toggle="yes">dupl</italic></sub> and <inline-formula id="IE9"><mml:math id="IM9" display="inline" overflow="scroll"><mml:mo>θ</mml:mo></mml:math></inline-formula><sub><italic toggle="yes">necr</italic></sub> in <xref rid="E1" ref-type="disp-formula">Equations (1)</xref> and <xref rid="E2" ref-type="disp-formula">(2)</xref>. In our simulation, if a cancer cell undergoes a mutation of Type (1), a new antigen is randomly sampled from a set of possible mutations, and its mutational status is updated; thus, the cell lineage accumulates mutations during the simulation. To mimic different TME properties, Types (1)–(4) mutations can occur at different probabilities (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref>).</p>
        <p><italic toggle="yes">Movement</italic>: In MAST, cancer cells can move to a position in the Moore neighborhood with the following probability.
<disp-formula id="E3"><label>(3)</label><mml:math id="M3" display="block" overflow="scroll"><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="italic">move</mml:mi></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>-</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mo>-</mml:mo><mml:msup><mml:mfenced separators="|"><mml:mfrac><mml:mrow><mml:mi>M</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:msub><mml:mo>θ</mml:mo><mml:mi mathvariant="italic">move</mml:mi></mml:msub><mml:mrow><mml:mn>1</mml:mn><mml:mi mathvariant="normal"> </mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mo>#</mml:mo><mml:mi>neighbCAFs</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mfrac></mml:mfenced><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula></p>
        <p>We assume that cancer cells have low migration probability which depends on both <inline-formula id="IE10"><mml:math id="IM10" display="inline" overflow="scroll"><mml:mo>θ</mml:mo></mml:math></inline-formula><sub><italic toggle="yes">move</italic></sub> parameter and on nutrient concentration <inline-formula id="IE11"><mml:math id="IM11" display="inline" overflow="scroll"><mml:mi>M</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. We implement this feature to allow simulating different settings depending on the tumor type. Moreover, to mimic promotion of cancer cell diffusion by CAFs, parameter <inline-formula id="IE12"><mml:math id="IM12" display="inline" overflow="scroll"><mml:mo>θ</mml:mo></mml:math></inline-formula><sub><italic toggle="yes">move</italic></sub> in <xref rid="E3" ref-type="disp-formula">Equation (3)</xref> is divided by 1 plus the number of CAFs cells in the Moore neighborhood.</p>
        <p><italic toggle="yes">CAFs differentiation</italic>: CAFs are thought to differentiate from normal tissue, and appear in the simulation after a long-lasting inflammation. CAF agent is modeled so to promote tumor growth by augmenting proliferation of the cancer cells, and tumor diffusion by augmenting tumor-cell movement, as described in <xref rid="E1" ref-type="disp-formula">Equations (1)</xref> and <xref rid="E3" ref-type="disp-formula">(3)</xref> (<xref rid="vbac092-B23" ref-type="bibr">Joshi <italic toggle="yes">et al.</italic>, 2021</xref>). To allow different biological scenarios to be modeled, CAFs may allow a different degree of permeability, behaving as obstacles or promoters of movement for tumor cells. In addition, CAF agents are modeled as immunosuppressive cells by inhibiting immune cell recruitment as explained in the next paragraph. They can die by lack of nutrients with the same probability of a cancer cell [see <xref rid="E2" ref-type="disp-formula">Equation (2)]</xref>.</p>
      </sec>
      <sec>
        <title>2.1.2 Immune system agents</title>
        <p>IS constitutes a strong defense against cancer development, catching and eliminating cells that undergo malignant transformation. The way the IS acts to provide immune surveillance is wide and complex; we refer to proper literature to describe it (<xref rid="vbac092-B20" ref-type="bibr">Hawse and Morel, 2014</xref>; <xref rid="vbac092-B28" ref-type="bibr">Martínez-Lostao <italic toggle="yes">et al.</italic>, 2015</xref>). However, only for the purpose of introducing cell agents in MAST, we summarize here its main mechanisms.</p>
        <p>Immune response rises from a coordinated action of multiple cell types and molecules. NKs, DCs and Ms are initially recruited in the TME and release cytokines and chemokines that initiate the inflammation. DCs and Ms are also called antigen presenting cells because they phagocyte cellular material including cancer cells, process and present their antigens, within the lymph nodes, to T cells that eventually get primed against tumor antigens.</p>
        <p>T cells maturate in different types. CTLs can mount a strong immune response by killing their tumor-cell targets through antigen recognition, while Treg cells have an immunosuppressive function, that maintains tolerance to self-antigens and prevent autoimmunity when inflammation is long-lasting.</p>
        <p>Within MAST, NKs, DCs, CTLs and Tregs are explicitly modeled and can be recruited, move, attack, die or disappear from the grid space.</p>
        <p><italic toggle="yes">Recruitment</italic>: In MAST, immune cells are recruited in the tissue with probability increasing with the adjuvanticity signal:
<disp-formula id="E4"><label>(4)</label><mml:math id="M4" display="block" overflow="scroll"><mml:msub><mml:mi>p</mml:mi><mml:mi mathvariant="italic">recruit</mml:mi></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mo>-</mml:mo><mml:mfenced separators="|"><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>adjuvanticity</mml:mi><mml:mi mathvariant="italic">neigh</mml:mi></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math></disp-formula>
where <inline-formula id="IE13"><mml:math id="IM13" display="inline" overflow="scroll"><mml:msub><mml:mi>adjuvanticity</mml:mi><mml:mrow><mml:mi mathvariant="italic">neigh</mml:mi><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> represents the sum of adjuvanticity signals in the Moore neighborhood of cell <inline-formula id="IE14"><mml:math id="IM14" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula>. In particular, adjuvanticity is defined as a proxy of the global IS enhancing signal, resulting from the release of molecules promoting immune recruitment (e.g. chemokine) and molecules release by cancer cells and promoting immune suppression. In particular, adjuvanticity signal is increased when a cancer cell dies by lack of nutrients or by IS attack, while it is decreased when cancer cells acquire mutations of Type (3) or immunosuppressive cells (i.e. Tregs and CAFs) are in the neighborhood.</p>
        <p>The probability of recruiting specifically NKs, DCs and CTLs is obtained by multiplying <italic toggle="yes">p<sub>recruit</sub></italic> in <xref rid="E4" ref-type="disp-formula">Equation (4)</xref> by a specific parameter, which reflects their proportions with respect to the total number of IS cells. Differently from other IS cells and consistently with the observation that Tregs are attracted in the domain when the inflammation is long-lasting (<xref rid="vbac092-B17" ref-type="bibr">Greten and Grivennikov, 2019</xref>), Treg agents are first recruited when a CTL becomes inactive after a certain number of attacks, with probability <inline-formula id="IE15"><mml:math id="IM15" display="inline" overflow="scroll"><mml:mi>TREG</mml:mi><mml:mo>_</mml:mo><mml:mi>reclut</mml:mi><mml:mo>_</mml:mo><mml:mi>par</mml:mi></mml:math></inline-formula>, and act as support agents promoting the recruitment of other Tregs and CAFs with probability described in <xref rid="E5" ref-type="disp-formula">Equations (5)</xref> and <xref rid="E6" ref-type="disp-formula">(6)</xref>. Differently from <xref rid="E4" ref-type="disp-formula">Equation (4)</xref>, Tregs and CAFs recruitment depends on both the number of Tregs and CAFs in the Moore neighborhood (i.e. <inline-formula id="IE16"><mml:math id="IM16" display="inline" overflow="scroll"><mml:msub><mml:mi>inhibitory</mml:mi><mml:mi mathvariant="italic">neigh</mml:mi></mml:msub></mml:math></inline-formula> parameter) and their corresponding recruitment parameters (i.e. inhib_TREG_recruit_par and inhib_CAF_recruit_par).
<disp-formula id="E5"><label>(5)</label><mml:math id="M5" display="block" overflow="scroll"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>T</mml:mi><mml:mi>R</mml:mi><mml:mi>E</mml:mi><mml:msub><mml:mi>G</mml:mi><mml:mi mathvariant="italic">recruit</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mo>-</mml:mo><mml:mfenced separators="|"><mml:mfrac><mml:mrow><mml:mi>inhib</mml:mi><mml:mo>_</mml:mo><mml:mi>TREG</mml:mi><mml:mo>_</mml:mo><mml:mi>recruit</mml:mi><mml:mo>_</mml:mo><mml:mi>par</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>inhibitory</mml:mi><mml:mi mathvariant="italic">neigh</mml:mi></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="normal"> </mml:mi></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula><disp-formula id="E6"><label>(6)</label><mml:math id="M6" display="block" overflow="scroll"><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>C</mml:mi><mml:mi>A</mml:mi><mml:msub><mml:mi>F</mml:mi><mml:mi mathvariant="italic">recruit</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mo>⁡</mml:mo><mml:mfenced open="[" close="]" separators="|"><mml:mrow><mml:mo>-</mml:mo><mml:mfenced separators="|"><mml:mfrac><mml:mrow><mml:mi>inhib</mml:mi><mml:mo>_</mml:mo><mml:mi>CAF</mml:mi><mml:mo>_</mml:mo><mml:mi>recruit</mml:mi><mml:mo>_</mml:mo><mml:mi>par</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>inhibitory</mml:mi><mml:mi mathvariant="italic">neigh</mml:mi></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mo>(</mml:mo><mml:mi mathvariant="normal">i</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:mi mathvariant="normal">j</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mfenced></mml:mrow></mml:mfenced><mml:mo>.</mml:mo></mml:math></disp-formula></p>
        <p><italic toggle="yes">Movement</italic>: When cancer cells are not in the neighborhood, immune cells can move to new positions with probability proportional to the adjuvanticity signal. To mimic the fact that T cells and NKs are small and tend to move quickly (<xref rid="vbac092-B42" ref-type="bibr">Vesperini <italic toggle="yes">et al.</italic>, 2021</xref>), we allow them to move in a neighborhood with a bigger radius at each iteration.</p>
        <p><italic toggle="yes">Attack</italic>: When cancer cells are in the neighborhood, DCs process cancer cell antigens and promote the recruitment of antigen-specific T cells in the domain. CTLs attack only when specific antigens are recognized and not many Treg cells are in their neighborhood. Specifically, CTLs have a different killing probability depending on cancer cell mutational status (e.g. PD-L1+/−). In particular, when PD-L1-like mutation is acquired by a tumor cell, the killing probability drops to mimic inhibitory regulation through immune checkpoint molecules (<xref rid="vbac092-B21" ref-type="bibr">Huang <italic toggle="yes">et al.</italic>, 2019</xref>). Consistently with the biological knowledge, CTLs can kill multiple target cells (<xref rid="vbac092-B45" ref-type="bibr">Wiedemann <italic toggle="yes">et al.</italic>, 2006</xref>). After a certain number of attacks, they become inactive and, as explained above, can recruit Treg in their position at this stage, modeling a long-lasting inflammation. Differently from CTLs, NKs are not antigen-specific, and, in MAST, they always attack cancer cells in the neighborhood with a probability of killing which is lower (<xref rid="vbac092-B9" ref-type="bibr">Cerignoli <italic toggle="yes">et al.</italic>, 2018</xref>). If they succeed, then they die and the adjuvanticity signal is locally increased, attracting other immune cells.</p>
        <p><italic toggle="yes">Antigen specificity of CTLs</italic>: If a cancer cell is killed by an NK cell or encounter a DC, then the cancer cell-specific antigens are processed. If the antigen was previously met, antigen-specific T cells are immediately recruited in the environment. Otherwise, antigen-specific T-cell activation is promoted and they will be recruited in the environment with a certain delay, so to mimic their activation in the lymph nodes.</p>
      </sec>
      <sec>
        <title>2.1.3 PDE model</title>
        <p>PDEs are used to model nutrient diffusion from their source (vessels) and to model nutrient consumption within the TME environment. The nutrient concentration <inline-formula id="IE17"><mml:math id="IM17" display="inline" overflow="scroll"><mml:mi>C</mml:mi></mml:math></inline-formula> in a certain time instant <inline-formula id="IE18"><mml:math id="IM18" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> in a certain position of the 2D grid <inline-formula id="IE19"><mml:math id="IM19" display="inline" overflow="scroll"><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>)</mml:mo></mml:math></inline-formula> is computed by solving the following equation at steady state:
<disp-formula id="E7"><label>(7)</label><mml:math id="M7" display="block" overflow="scroll"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>C</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:msup><mml:mrow><mml:mo>∇</mml:mo></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mi>C</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mi>I</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mi>C</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>-</mml:mo><mml:mi mathvariant="normal"> </mml:mi><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mi mathvariant="normal"> </mml:mi><mml:mi>T</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mi mathvariant="normal"> </mml:mi><mml:mi>C</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo>,</mml:mo></mml:math></disp-formula>
where <inline-formula id="IE20"><mml:math id="IM20" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> is the nutrient diffusion coefficient, <inline-formula id="IE21"><mml:math id="IM21" display="inline" overflow="scroll"><mml:mi>I</mml:mi><mml:mfenced open="(" close=")" separators="|"><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:mfenced><mml:mo> </mml:mo><mml:mi mathvariant="normal">and</mml:mi><mml:mo> </mml:mo><mml:mi>T</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>y</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mi mathvariant="normal"> </mml:mi></mml:math></inline-formula>are the spatial distributions at time <italic toggle="yes">t</italic> of IS and cancer-related agents, respectively, and <inline-formula id="IE22"><mml:math id="IM22" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula id="IE23"><mml:math id="IM23" display="inline" overflow="scroll"><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></inline-formula> are the corresponding consumption rates. We consider two main types of nutrients: those that are essential for cell division (denoted as <italic toggle="yes">N</italic>), and those that are essential for cell survival (denoted as <italic toggle="yes">M</italic>). For nutrients, we use the average glucose diffusion coefficient in tissues (∼1 mm<sup>2</sup>/s) <xref rid="vbac092-B8" ref-type="bibr">(Carvalho <italic toggle="yes">et al.</italic>, 2017</xref>), and thus resolve PDE at a steady state. Since other substances important for cell survival are faster, solution at a steady state is appropriate also for this latter. Normalized nutrient concentrations at blood vessels are assumed equal to 1 arbitrary unit (au).</p>
      </sec>
      <sec>
        <title>2.1.4 Mast simulation cycle</title>
        <p>Initially, a 2D grid of dimension <inline-formula id="IE24"><mml:math id="IM24" display="inline" overflow="scroll"><mml:mi>W</mml:mi><mml:mo>×</mml:mo><mml:mi>H</mml:mi></mml:math></inline-formula> is defined together with the type of cells occupying each grid position, based on the user-specified parameters. Considering the average grid cell size of ∼14.9 µm (<xref rid="vbac092-B24" ref-type="bibr">Kather <italic toggle="yes">et al.</italic>, 2017</xref>), a lattice of 200 × 200 cells can be used to mimic around 0.09 cm<sup>2</sup> of tissue corresponding to 40 000 cells. Blood vessels are positioned upstream and downstream of the domain (first and last row of the grid).</p>
        <p>At the beginning of the simulation, a fixed number of monoclonal tumor cells are placed in the center of the grid so that a specific and unique antigen setting initially characterizes cancer cells, whereas a fixed percentage of NKs and DCs with respect to the total number of cells are placed in random positions. Upon initialization, at each time-step, MAST first updates the concentrations of nutrients (using the PDE model) and then lets agents act (using the ABM model), sampling for each agent in the grid the action to be done (see <xref rid="vbac092-F1" ref-type="fig">Fig. 1</xref>), performing a random grid scanning. One time-step <inline-formula id="IE25"><mml:math id="IM25" display="inline" overflow="scroll"><mml:mi>t</mml:mi></mml:math></inline-formula> in the simulation corresponds to 6 h, that is the average time for immune cell death (<xref rid="vbac092-B7" ref-type="bibr">Breart <italic toggle="yes">et al.</italic>, 2008</xref>) and we considered cells to divide in ∼24 h (i.e. 4 time-steps) (<xref rid="vbac092-B24" ref-type="bibr">Kather <italic toggle="yes">et al.</italic>, 2017</xref>).</p>
        <p>Additional information about model implementation, input and output is provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1, Figures S1–S4</xref> and <xref rid="sup1" ref-type="supplementary-material">Tables S1 and S2</xref>.</p>
      </sec>
    </sec>
    <sec>
      <title>2.2 Data-driven strategy to inform and assess MAST</title>
      <p>To assess the predictions of the model, we emulate the analysis workflow performed in <xref rid="vbac092-B24" ref-type="bibr">Kather <italic toggle="yes">et al.</italic> (2017)</xref>. First, we showed that our model can reproduce key features of real-case biological scenarios of human CRC. Model outcomes in the CRC scenarios were validated using clinical data of the TCGA patient cohort and available biological knowledge on CRC CMS. Specifically, four different TMEs were simulated based on CMS classification: CMS1 (microsatellite instability immune), CMS2 (canonical), CMS3 (metabolic) and CMS4 (mesenchymal) (<xref rid="vbac092-B18" ref-type="bibr">Guinney <italic toggle="yes">et al.</italic>, 2015</xref>). A brief characterization of CMS is provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S2</xref> and <xref rid="sup1" ref-type="supplementary-material">Figure S5</xref>. Second, we investigated the effect of varying different tumor conditions on tumor progression, analyzing the characteristics of resulting TMEs and their agreement with current literature. While some parameters do not change in different TMEs, others can be specified to model unique characteristics of the TME.</p>
      <p>CMS simulation scenarios were defined exploiting the data-driven approach that characterizes MAST (see <xref rid="vbac092-F1" ref-type="fig">Fig. 1A</xref>), i.e. setting some simulation parameters based on high-throughput sequencing data (see <xref rid="vbac092-T1" ref-type="table">Table 1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Table S3</xref>). In detail, tumor mutational burden (TMB) can be derived from bulk whole-genome sequencing experiments (bulk DNA-seq), while cell fraction and expression levels of inhibitory immune checkpoint genes can be estimated from bulk and single-cell RNA sequencing (scRNA-seq) data. Here, we informed our model using CRC publicly available data from TCGA database and Samsung Medical Center (SMC) dataset of <xref rid="vbac092-B26" ref-type="bibr">Lee <italic toggle="yes">et al.</italic> (2020)</xref>, as explained in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3</xref> and <xref rid="sup1" ref-type="supplementary-material">Figure S6</xref>.</p>
      <table-wrap position="float" id="vbac092-T1">
        <label>Table 1.</label>
        <caption>
          <p>Data-driven setting of some MAST parameters across CMS</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th rowspan="1" colspan="1">Parameter</th>
              <th rowspan="1" colspan="1">CMS1</th>
              <th rowspan="1" colspan="1">CMS2</th>
              <th rowspan="1" colspan="1">CMS3</th>
              <th rowspan="1" colspan="1">CMS4</th>
              <th rowspan="1" colspan="1">Source</th>
              <th rowspan="1" colspan="1">Index</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">tum_newantigen_rate</td>
              <td rowspan="1" colspan="1">High</td>
              <td rowspan="1" colspan="1">Low</td>
              <td rowspan="1" colspan="1">Low</td>
              <td rowspan="1" colspan="1">Low</td>
              <td rowspan="1" colspan="1">DNA-seq</td>
              <td rowspan="1" colspan="1">TMB</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">tum_pdlp_rate</td>
              <td rowspan="1" colspan="1">High</td>
              <td rowspan="1" colspan="1">Low</td>
              <td rowspan="1" colspan="1">High</td>
              <td rowspan="1" colspan="1">High</td>
              <td rowspan="1" colspan="1">scRNA-seq</td>
              <td rowspan="1" colspan="1">Gene expression</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">tum_adjchange_rate</td>
              <td rowspan="1" colspan="1">Low</td>
              <td rowspan="1" colspan="1">High</td>
              <td rowspan="1" colspan="1">Mid</td>
              <td rowspan="1" colspan="1">Low</td>
              <td rowspan="1" colspan="1">RNA-seq</td>
              <td rowspan="1" colspan="1">Cell fraction</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">inhib_TREG_recruit_par</td>
              <td rowspan="1" colspan="1">High</td>
              <td rowspan="1" colspan="1">High</td>
              <td rowspan="1" colspan="1">High</td>
              <td rowspan="1" colspan="1">Low</td>
              <td rowspan="1" colspan="1">RNA-seq</td>
              <td rowspan="1" colspan="1">Cell fraction</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">inhib_CAF_recruit_par</td>
              <td rowspan="1" colspan="1">High</td>
              <td rowspan="1" colspan="1">High</td>
              <td rowspan="1" colspan="1">High</td>
              <td rowspan="1" colspan="1">Low</td>
              <td rowspan="1" colspan="1">RNA-seq</td>
              <td rowspan="1" colspan="1">Cell fraction</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">tum_ncons</td>
              <td rowspan="1" colspan="1">Low</td>
              <td rowspan="1" colspan="1">Low</td>
              <td rowspan="1" colspan="1">High</td>
              <td rowspan="1" colspan="1">Low</td>
              <td rowspan="1" colspan="1">literature</td>
              <td rowspan="1" colspan="1">/</td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
      <p><italic toggle="yes">Bulk whole-genome sequencing</italic>: TMB measures the total number of nonsynonymous mutations per coding area of a sample genome (Mut/Mb) and was estimated for each TCGA patient analyzing bulk whole-genome data (<xref rid="vbac092-B41" ref-type="bibr">Thorsson <italic toggle="yes">et al.</italic>, 2018</xref>). Given the mutational potential to generate neoantigens (<xref rid="vbac092-B6" ref-type="bibr">Braun <italic toggle="yes">et al.</italic>, 2016</xref>), TMB index was used to set the mutational probability related to loss/acquisition of antigenicity (parameter tum_newantigen_rate set <italic toggle="yes">high</italic> or <italic toggle="yes">low</italic> in <xref rid="vbac092-T1" ref-type="table">Table 1</xref>) following the trend of TMB distribution in the data across CMS (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S7</xref>), also confirmed by literature (<xref rid="vbac092-B25" ref-type="bibr">Kather <italic toggle="yes">et al.</italic>, 2018</xref>).</p>
      <p><italic toggle="yes">Bulk RNA sequencing</italic>: Cell fractions were estimated from TCGA bulk RNA-seq data using a bioinformatics approach based on EPIC (<xref rid="vbac092-B34" ref-type="bibr">Racle <italic toggle="yes">et al.</italic>, 2017</xref>) and quanTIseq (<xref rid="vbac092-B13" ref-type="bibr">Finotello <italic toggle="yes">et al.</italic>, 2019</xref>), further refined leveraging a consensus of several deconvolution methods accessible through the immunedeconv R package (<xref rid="vbac092-B37" ref-type="bibr">Sturm <italic toggle="yes">et al.</italic>, 2019</xref>), as explained in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3</xref> and <xref rid="sup1" ref-type="supplementary-material">Figure S6</xref>. CAF and Treg cell proportion estimates were used to tune recruitment probabilities of the two cell types, i.e. <xref rid="E5" ref-type="disp-formula">Equations (5)</xref> and <xref rid="E6" ref-type="disp-formula">(6)</xref> (parameters inhib_CAF_recruit_par and inhib_TREG_recruit_par in <xref rid="vbac092-T1" ref-type="table">Table 1</xref>). Moreover, immune cell proportion, computed as the sum of all immune-related cell type fractions, was used to set parameter tum_adjchange_rate, as higher values of immune cell proportions mean a lower probability of cancer cells of creating an immunosuppressive environment and thus locally repel the IS cells. The setting of these parameters to different levels across the CMS, reported in <xref rid="vbac092-T1" ref-type="table">Table 1</xref>, aims to mimic the trend of cell fraction proportions showed by CRC TCGA data (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S8 and S9</xref>).</p>
      <p><italic toggle="yes">Single-cell RNA sequencing</italic>: The average expression level of inhibitory immune checkpoint genes, i.e. <italic toggle="yes">CD274</italic> (PD-L1)-like genes (complete list of genes is available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S3</xref>), known to be upregulated in cancer cell able to evade the immune response, was used to tune parameter tum_pdlp_mut, i.e. mutational probability related to loss of immunogenicity. The relative distribution of mean gene expression level in scRNA-seq data from SMC dataset (GSE132465) (<xref rid="vbac092-B26" ref-type="bibr">Lee <italic toggle="yes">et al.</italic>, 2020</xref>) is used, as illustrated in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S10</xref>, to set the parameter as <italic toggle="yes">high</italic> in CMS1, CMS3 and CMS4 and <italic toggle="yes">low</italic> in CMS2 (see <xref rid="vbac092-T1" ref-type="table">Table 1</xref>).</p>
      <p><italic toggle="yes">Literature</italic>: It is known that CMS3 tumor has an impaired metabolic regulation (<xref rid="vbac092-B25" ref-type="bibr">Kather <italic toggle="yes">et al.</italic>, 2018</xref>). Thus, the parameter related to tumor consumption of nutrient <italic toggle="yes">N</italic>, i.e. tum_ncons parameter, is set at a higher rate in CMS3 with respect to the other subtype rates.</p>
      <p>Additional information about high-throughput data, bioinformatics analyses and CMS-specific parameters setting are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Sections S3 and S4</xref>.</p>
    </sec>
  </sec>
  <sec>
    <title>3 Results</title>
    <sec>
      <title>3.1 CMS simulation: emergent properties and outcome</title>
      <p>We simulated four TME scenarios representing the four molecular subtypes, i.e. CMSs (see <xref rid="vbac092-T1" ref-type="table">Table 1</xref>). For each CMS, 100 <italic toggle="yes">in silico</italic> tumor-growth simulations were performed for a fixed number of iterations (around 150 days) and their execution times are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S1</xref> and <xref rid="sup1" ref-type="supplementary-material">Table S2</xref>. Our model was able to reproduce emergent properties of each subtype of the TME as shown in <xref rid="vbac092-F2" ref-type="fig">Figure 2</xref>.</p>
      <fig position="float" id="vbac092-F2">
        <label>Fig. 2.</label>
        <caption>
          <p><italic toggle="yes">In silico</italic> simulation of the four CMS. Left panels (<bold>A</bold>, <bold>C</bold>, <bold>E</bold> and <bold>G</bold>) provide information on the temporal evolution of 100 simulations. In particular, in the upper subgraph, the number of not completely tumor-free (NTF) simulations in a determined instant (day), i.e. simulations having at least one cancer agent in the domain, is showed for each CMS. In the below subgraph, the time course of agent counts across NTF simulations in log10-scale is showed: continuous line represents the average count, and the shaded area represents its variability (±standard deviation). Right panels (<bold>B</bold>, <bold>D</bold>, <bold>F</bold> and <bold>H</bold>) display the spatio-temporal evolution of one simulation for each CMS. From left to right, tumor progression on Days 60, 90, 120 and 150 are represented. Legend represents color-agent association related to above representations. All graphical representations are generated using MAST</p>
        </caption>
        <graphic xlink:href="vbac092f2" position="float"/>
      </fig>
      <p>First, we observed that all tumors are characterized by the exponential growth of cancer cells (see <xref rid="vbac092-F2" ref-type="fig">Fig. 2A, C, E and G</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S11</xref>), even though CMS3 growth was significantly slower, suggesting that the metabolic subtype is a slow-proliferating tumor. As shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Figure S12</xref>, the number of specialized CTLs in the simulated tissue in CMS1 over time was higher with respect to the other CMS, indicating a stronger immune response activation. Moreover, CTLs appeared to be infiltrated inside the tumor mass in our simulations (see <xref rid="vbac092-F2" ref-type="fig">Fig. 2B</xref>). These results are in line with the distinct feature of CMS1, i.e. strong immune infiltration (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S2</xref> and <xref rid="sup1" ref-type="supplementary-material">Fig. S5</xref>). We also observe a different number of CAFs across the different subtypes (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S13</xref>) emerging spontaneously over time. In particular, the growth rate was significantly faster in CMS4 compared to the others. Spatially, CMS4 was characterized by high stromal component (see <xref rid="vbac092-F2" ref-type="fig">Fig. 2H</xref>), a well-known emergent property of this tumor subtype.</p>
      <p>Simulation outcomes were classified into complete tumor remission, when <italic toggle="yes">in silico</italic> simulation was tumor-cell free. Histogram bar height in <xref rid="vbac092-F2" ref-type="fig">Figure 2A, C, E and G</xref> represents the number of simulations not completely tumor-free at different time points. In particular, CMS1 and CMS4 subgroups resulted in a high-proliferating tumor in the majority of simulations although CMS1 is characterized by higher IS cells infiltration and lower CAFs. In contrast, the canonical and metabolic subtypes, i.e. CMS2 and CMS3, were characterized by a higher tumor eradication rate. These predictions were validated using clinical outcome endpoints of progression-free interval of a 303 colorectal patient cohort from TCGA database (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S14</xref>) and are in line with current clinical knowledge on CMS (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. S5</xref>). Additional results on simulations and clinical data analysis are available in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S5</xref>.</p>
    </sec>
    <sec>
      <title>3.2 Effect of specific parameters on TME</title>
      <p>To better highlight the emergent properties of the different tumor–immune dynamics and further validate the proposed model, the collective behavior of tumors under different tumor conditions was investigated for each CMS. Additional information about these simulations is provided in <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S6</xref>.</p>
      <sec>
        <title>3.2.1 Effect of antigenicity</title>
        <p>The loss of antigenicity is one of the immune escape mechanism cancer cells use to avoid elimination and increase tumorigenesis. It is expected that the higher the tumor antigenicity, the more likely the immune recognition through antigen presentation occurs, thus inducing a higher immune response (<xref rid="vbac092-B4" ref-type="bibr">Beatty and Gladney, 2015</xref>; <xref rid="vbac092-B12" ref-type="bibr">de Charette <italic toggle="yes">et al.</italic>, 2016</xref>). To investigate the effect of loss/acquisition of antigenicity on tumor–immune dynamics, the antigenicity rate tum_newantigen_rate was varied between 1- and 16-fold from the default value. As expected, the increasing number of antigens elicited the number of CTLs suggesting, in turn, an elicited antigen-specific immune response (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S15–S22</xref>).</p>
      </sec>
      <sec>
        <title>3.2.2 Effect of immunogenicity</title>
        <p>Tumors can escape immune elimination by decreasing immunogenicity, i.e. upregulating inhibitory immune checkpoint genes such as PD-L1 molecules. <xref rid="vbac092-B27" ref-type="bibr">Li <italic toggle="yes">et al.</italic> (2019)</xref> showed that PD-L1 expression in tumor cells was significantly associated with poor prognostic outcomes in CRC patients. To determine the effect of immunogenicity on tumor progression, we increased the probability of PD-L1-like genes acquisition, i.e. tum_pdlp_rate, from 1- to 16-fold from the default value (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S23–S30</xref>). In accordance with Li <italic toggle="yes">et al.</italic>, the increasing probability of expressing PD-L1-like genes resulted in higher rate of tumor-cell survival.</p>
      </sec>
      <sec>
        <title>3.2.3 Effect of nutrient consumption</title>
        <p>Tumor survival and proliferation require the availability of nutrients in the environment. However, nutrient availability may be limited by the combined effect of nutrient demand, i.e. consumption rate of other cells, and accessibility of nutrients through vasculature (<xref rid="vbac092-B38" ref-type="bibr">Sullivan and Vander Heiden, 2019</xref>). To observe the effect of nutrient consumption on tumor progression, we increase the tumor nutrient requirement for duplication, i.e. tum_ncons parameter, from 1- to 150-fold from the default value of non-tumor cell. As highlighted by the decreasing number of tumor cells and in accordance with Sullivan and Vander Heiden study (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S31–S38</xref>), a high nutrient demand limited tumor proliferation in a context of unchanged nutrient accessibility, i.e. unchanged modeled vasculature.</p>
      </sec>
      <sec>
        <title>3.2.4 Effect of CAFs recruitment</title>
        <p>CAFs are known to enhance tumor proliferation and migration in many cancers, including CRC (<xref rid="vbac092-B1" ref-type="bibr">Aizawa <italic toggle="yes">et al.</italic>, 2018</xref>). To analyze the CAFs effect on tumor progression, we decreased the probability of cell type recruitment by increasing inhib_CAF_reclut_par parameter from 1- to 30-fold from the default value. As expected, the cardinality of CAFs varied with the parameter, and tumor proliferation was promoted in response to increased CAF recruitment (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Figs S39–S46</xref>).</p>
      </sec>
    </sec>
  </sec>
  <sec>
    <title>4 Discussion</title>
    <p>In this work, we have presented MAST, a hybrid multi-ABM to investigate how IS and tumor cells interact within TME, assessing which emergent properties arise. MAST couples a discrete and stochastic ABM, which simulates interactions and dynamics of immune and cancer cells in the TME, and a continuous, deterministic PDE-based model to simulate nutrient diffusion from vessels. Furthermore, MAST provides a wide range of graphical outputs allowing an in-depth analysis of the spatio-temporal evolution of each simulated TMEs.</p>
    <p>It specifically models immune recognition and escape mechanisms through the acquisition of mutations, and spatio-temporal dynamics of cells in response to nutrient availability. Model parameters can be informed in a data-driven way using different sources, such as literature or high-throughput sequencing data, in order to simulate specific and unique immune–cancer microenvironment of a tumor type.</p>
    <p>We informed MAST by coupling bulk and single-cell sequencing data of human CRC samples in order to simulate tumor progression in four heterogeneous and specific TME scenarios, i.e. CMS. To validate our model, we use different strategies. First, we assessed the ability of MAST to reproduce known emergent biological properties of the four CMS scenarios, such as a stronger immune response and stromal infiltration in CMS1 and CMS4, respectively. Then, we investigated the effect of different mutational, metabolic and stromal plasticity conditions in cancer development and tumor–immune dynamics, achieving a good agreement with current biological knowledge of tumor. Lastly, we used clinical endpoints’ real data from TCGA database to compare simulated and real tumor outcomes of corresponding CMS scenarios.</p>
    <p>Given the data-driven approach to inform the simulator, we also tested the effect of considering different data sources on simulating real case scenarios (see <xref rid="sup1" ref-type="supplementary-material">Supplementary Section S7</xref>, <xref rid="sup1" ref-type="supplementary-material">Figs S47–S52</xref> and <xref rid="sup1" ref-type="supplementary-material">Tables S4 and S5</xref>). In particular, we used TCGA or SMC dataset separately to simulate the four CRC CMSs. Although a slight change in some parameter settings was observed, different data sources provided the same distinct biological collective behavior of a tumor, while including specific and personalized features of the TME of the patient cohort.</p>
    <p>In general, our model, like other existing ABMs, may suffer from some limitations. MAST models the TME in a ‘slice’ of tissue, considering the possibility that IS cells appear and disappear from outside (i.e. upstream and downstream) but computing nutrient diffusion in a 2D rather than 3D space. This simplification, however, allows for limiting the computational burden. One of the main factors limiting a wider application of quantitative systems modeling is its demand for rich experimental data or literature for a precise parameter estimation. Therefore, MAST is a simplification of the real mechanisms occurring in the TME. In future studies, it would be of interest to integrate other sources of information complementary to bulk and single-cell experiments to inform our model, for example imaging data or spatial transcriptomics for the spatial distribution of cells, also adding vasculature modeling. In terms of model assessment, MAST and the great majority of proposed ABMs in literature (<xref rid="vbac092-B2" ref-type="bibr">Alfonso <italic toggle="yes">et al.</italic>, 2016</xref>; <xref rid="vbac092-B14" ref-type="bibr">Frascoli <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="vbac092-B24" ref-type="bibr">Kather <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="vbac092-B33" ref-type="bibr">Pourhasanzade <italic toggle="yes">et al.</italic>, 2017</xref>; <xref rid="vbac092-B44" ref-type="bibr">Wang <italic toggle="yes">et al.</italic>, 2009</xref>) are validated in a qualitatively way through the analysis of biological plausibility of simulated outcomes with known tumors characteristics, and comparison between simulated and real clinical endpoints. Further validation through image-derived data is difficult, given the limited availability of a complete and comprehensive image repository of data from individual patients or cohort of patients, and the lack of temporal data. Nevertheless, our simulations mimic the characteristic patterns of real images such as those shown by <xref rid="vbac092-B24" ref-type="bibr">Kather <italic toggle="yes">et al.</italic> (2017)</xref>.</p>
    <p>We believe that MAST can be a useful tool to better understand tumor–immune cell dynamics that drive tumor progression in specific and unique TMEs. We think that a data-driven way to generate simulation settings could be a powerful tool in the way toward specialized and personalized studies of the TME. Ideally, the availability of patient-specific data and the ability to inform model from them can allow the modeling of patient-specific tumor–immune system dynamics.</p>
    <p>Although some simple immunotherapy modeling has been investigated (<xref rid="sup1" ref-type="supplementary-material">Supplementary Table S1</xref> and <xref rid="sup1" ref-type="supplementary-material">Section S8</xref>), implementation of other therapies could be incorporated in the future to investigate their combined effect on tumor progression and to test how different time-schedule affects their efficacy. Moreover, tumor mutational evolution that leads to a selective advantage related to survival and duplication fitness will be further investigated.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>vbac092_Supplementary_Data</label>
      <media xlink:href="vbac092_supplementary_data.pdf">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ack1">
    <title>Acknowledgements</title>
    <p>The authors acknowledge the computational resources granted by the CAPRI HPC System (University of Padova Strategic Research Infrastructure Grant 2017: ‘CAPRI: Calcolo ad Alte Prestazioni per la Ricerca e l’Innovazione’). The results shown here are in whole or part based upon data generated by the TCGA Research Network: <ext-link xlink:href="https://www.cancer.gov/tcga" ext-link-type="uri">https://www.cancer.gov/tcga</ext-link>.</p>
    <sec>
      <title>Funding</title>
      <p>This work was supported by PROACTIVE 2017 ‘From Single-Cell to Multi-Cells Information Systems Analysis’ [C92F17003530005] from Department of Information Engineering, University of Padova; Italian Minister for Education (MIUR) under the initiative ‘Departments of Excellence’ (Law 232/2016); the Austrian Science Fund (FWF) [T 974-B30 to F.F.]; the Oesterreichische Nationalbank (OeNB) [18496 to F.F.]; and Department of Information Engineering, University of Padova, under the initiative ‘Research Grant (type B)-B senior initiative’ to G.B.</p>
      <p><italic toggle="yes">Conflict of Interest</italic>: none declared.</p>
    </sec>
  </ack>
  <sec sec-type="data-availability">
    <title>Data Availability</title>
    <p>The model described in this article is implemented in Python language and it is freely available with an open-source license through GitLab (<ext-link xlink:href="https://gitlab.com/sysbiobig/mast" ext-link-type="uri">https://gitlab.com/sysbiobig/mast</ext-link>). MAST is also released through the Docker Registry (<ext-link xlink:href="https://registry.gitlab.com/sysbiobig/mast/" ext-link-type="uri">https://registry.gitlab.com/sysbiobig/mast/</ext-link>) to facilitate its distribution. The submitted software version and test data are available in Zenodo at <ext-link xlink:href="https://dx.doi.org/10.5281/zenodo.7267745" ext-link-type="uri">https://dx.doi.org/10.5281/zenodo.7267745</ext-link>.</p>
  </sec>
  <ref-list id="ref1">
    <title>References</title>
    <ref id="vbac092-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aizawa</surname><given-names>T.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Molecular characterization of cancer associated fibroblasts in colorectal cancer</article-title>. <source>Ann. Oncol</source>., <volume>29</volume>, <fpage>ix42</fpage>.</mixed-citation>
    </ref>
    <ref id="vbac092-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alfonso</surname><given-names>J.C.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title><italic toggle="yes">In-silico</italic> insights on the prognostic potential of immune cell infiltration patterns in the breast lobular epithelium</article-title>. <source>Sci. Rep</source>., <volume>6</volume>, <fpage>33322</fpage>.<pub-id pub-id-type="pmid">27659691</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baruzzo</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> (<year>2022</year>) <article-title>Identify, quantify and characterize cellular communication from single-cell RNA sequencing data with scSeqComm</article-title>. <source>Bioinformatics</source>, <volume>38</volume>, <fpage>1920</fpage>–<lpage>1929</lpage>.</mixed-citation>
    </ref>
    <ref id="vbac092-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beatty</surname><given-names>G.L.</given-names></string-name>, <string-name><surname>Gladney</surname><given-names>W.L.</given-names></string-name></person-group> (<year>2015</year>) <article-title>Immune escape mechanisms as a guide for cancer immunotherapy</article-title>. <source>Clin. Cancer Res</source>., <volume>21</volume>, <fpage>687</fpage>–<lpage>692</lpage>.<pub-id pub-id-type="pmid">25501578</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonabeau</surname><given-names>E.</given-names></string-name></person-group> (<year>2002</year>) <article-title>Agent-based modeling: methods and techniques for simulating human systems</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>99</volume>, <fpage>7280</fpage>–<lpage>7287</lpage>.<pub-id pub-id-type="pmid">12011407</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Braun</surname><given-names>D.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Genomic approaches to understanding response and resistance to immunotherapy</article-title>. <source>Clin. Cancer Res</source>., <volume>22</volume>, <fpage>5642</fpage>–<lpage>5650</lpage>.<pub-id pub-id-type="pmid">27698000</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Breart</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2008</year>) <article-title>Two-photon imaging of intratumoral CD8+ T cell cytotoxic activity during adoptive T cell therapy in mice</article-title>. <source>J. Clin. Invest</source>., <volume>118</volume>, <fpage>1390</fpage>–<lpage>1397</lpage>.<pub-id pub-id-type="pmid">18357341</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carvalho</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Glucose diffusion in colorectal mucosa—a comparative study between normal and cancer tissues</article-title>. <source>J. Biomed. Opt</source>., <volume>22</volume>, <fpage>91506</fpage>.<pub-id pub-id-type="pmid">28241323</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cerignoli</surname><given-names>F.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title><italic toggle="yes">In vitro</italic> immunotherapy potency assays using real-time cell analysis</article-title>. <source>PLoS One</source>, <volume>13</volume>, <fpage>e0193498</fpage>.<pub-id pub-id-type="pmid">29499048</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Clarke</surname><given-names>M.A.</given-names></string-name>, <string-name><surname>Fisher</surname><given-names>J.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Executable cancer models: successes and challenges</article-title>. <source>Nat. Rev. Cancer</source>, <volume>20</volume>, <fpage>343</fpage>–<lpage>354</lpage>.<pub-id pub-id-type="pmid">32341552</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dagogo-Jack</surname><given-names>I.</given-names></string-name>, <string-name><surname>Shaw</surname><given-names>A.T.</given-names></string-name></person-group> (<year>2018</year>) <article-title>Tumour heterogeneity and resistance to cancer therapies</article-title>. <source>Nat. Rev. Clin. Oncol</source>., <volume>15</volume>, <fpage>81</fpage>–<lpage>94</lpage>.<pub-id pub-id-type="pmid">29115304</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Charette</surname><given-names>M.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Turning tumour cells into antigen presenting cells: the next step to improve cancer immunotherapy?</article-title><source>Eur. J. Cancer</source>, <volume>68</volume>, <fpage>134</fpage>–<lpage>147</lpage>.<pub-id pub-id-type="pmid">27755997</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Finotello</surname><given-names>F.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Molecular and pharmacological modulators of the tumor immune contexture revealed by deconvolution of RNA-seq data</article-title>. <source>Genome Med</source>., <volume>11</volume>, <fpage>1</fpage>–<lpage>20</lpage>.<pub-id pub-id-type="pmid">30609936</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frascoli</surname><given-names>F.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>A model of the effects of cancer cell motility and cellular adhesion properties on tumour-immune dynamics</article-title>. <source>Math. Med. Biol</source>., <volume>34</volume>, <fpage>215</fpage>–<lpage>240</lpage>.<pub-id pub-id-type="pmid">27094601</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fucikova</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Detection of immunogenic cell death and its relevance for cancer therapy</article-title>. <source>Cell Death Dis</source>., <volume>11</volume>, <fpage>1</fpage>–<lpage>13</lpage>.<pub-id pub-id-type="pmid">31911576</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gong</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>A computational multiscale agent-based model for simulating spatio-temporal tumour immune response to PD1 and PDL1 inhibition</article-title>. <source>J. R. Soc. Interface</source>, <volume>14</volume>, <fpage>20170320</fpage>.<pub-id pub-id-type="pmid">28931635</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Greten</surname><given-names>F.R.</given-names></string-name>, <string-name><surname>Grivennikov</surname><given-names>S.I.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Inflammation and cancer: triggers, mechanisms, and consequences</article-title>. <source>Immunity</source>, <volume>51</volume>, <fpage>27</fpage>–<lpage>41</lpage>.<pub-id pub-id-type="pmid">31315034</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guinney</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>The consensus molecular subtypes of colorectal cancer</article-title>. <source>Nat. Med</source>., <volume>21</volume>, <fpage>1350</fpage>–<lpage>1356</lpage>.<pub-id pub-id-type="pmid">26457759</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hanahan</surname><given-names>D.</given-names></string-name>, <string-name><surname>Coussens</surname><given-names>L.M.</given-names></string-name></person-group> (<year>2012</year>) <article-title>Accessories to the crime: functions of cells recruited to the tumor microenvironment</article-title>. <source>Cancer Cell</source>, <volume>21</volume>, <fpage>309</fpage>–<lpage>322</lpage>.<pub-id pub-id-type="pmid">22439926</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B20">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hawse</surname><given-names>W.F.</given-names></string-name>, <string-name><surname>Morel</surname><given-names>P.A.</given-names></string-name></person-group> (<year>2014</year>) <article-title>An immunology primer for computational modelers</article-title>. <source>J. Pharmacokinet. Pharmacodyn</source>., <volume>41</volume>, <fpage>389</fpage>–<lpage>399</lpage>.<pub-id pub-id-type="pmid">25238901</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>C.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Immune checkpoint molecules. Possible future therapeutic implications in autoimmune diseases</article-title>. <source>J. Autoimmun</source>., <volume>104</volume>, <fpage>102333</fpage>.<pub-id pub-id-type="pmid">31564474</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>A.Y.</given-names></string-name>, <string-name><surname>Lee</surname><given-names>E.A.</given-names></string-name></person-group> (<year>2022</year>) <article-title>Identification of somatic mutations from bulk and single-cell sequencing data</article-title>. <source>Front. Aging</source>, <volume>2</volume>, <fpage>800380</fpage>.<pub-id pub-id-type="pmid">35822012</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Joshi</surname><given-names>R.S.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>The role of cancer-associated fibroblasts in tumor progression</article-title>. <source>Cancers (Basel)</source>, <volume>13</volume>, <fpage>1399</fpage>–<lpage>1327</lpage>.<pub-id pub-id-type="pmid">33808627</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kather</surname><given-names>J.N.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title><italic toggle="yes">In silico</italic> modeling of immunotherapy and stroma-targeting therapies in human colorectal cancer</article-title>. <source>Cancer Res</source>., <volume>77</volume>, <fpage>6442</fpage>–<lpage>6452</lpage>.<pub-id pub-id-type="pmid">28923860</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kather</surname><given-names>J.N.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Genomics and emerging biomarkers for immunotherapy of colorectal cancer</article-title>. <source>Semin. Cancer Biol</source>., <volume>52</volume>, <fpage>189</fpage>–<lpage>197</lpage>.<pub-id pub-id-type="pmid">29501787</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname><given-names>H.O.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Lineage-dependent gene expression programs influence the immune landscape of colorectal cancer</article-title>. <source>Nat. Genet</source>., <volume>52</volume>, <fpage>594</fpage>–<lpage>603</lpage>.<pub-id pub-id-type="pmid">32451460</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname><given-names>Y.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>The prognostic and clinicopathological roles of PD-L1 expression in colorectal cancer: a systematic review and meta-analysis</article-title>. <source>Front. Pharmacol</source>., <volume>10</volume>, <fpage>139</fpage>.<pub-id pub-id-type="pmid">30873025</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Martínez-Lostao</surname><given-names>L.</given-names></string-name></person-group><etal>et al</etal> (<year>2015</year>) <article-title>How do cytotoxic lymphocytes kill cancer cells?</article-title><source>Clin. Cancer Res</source>., <volume>21</volume>, <fpage>5047</fpage>–<lpage>5056</lpage>.<pub-id pub-id-type="pmid">26567364</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Norton</surname><given-names>K.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2018</year>) <article-title>Modeling triple-negative breast cancer heterogeneity: effects of stromal macrophages, fibroblasts and tumor vasculature</article-title>. <source>J. Theor. Biol</source>., <volume>452</volume>, <fpage>56</fpage>–<lpage>68</lpage>.<pub-id pub-id-type="pmid">29750999</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Norton</surname><given-names>K.A.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Multiscale agent-based and hybrid modeling of the tumor immune microenvironment</article-title>. <source>Processes (Basel)</source>, <volume>7</volume>, <fpage>37</fpage>.<pub-id pub-id-type="pmid">30701168</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peskov</surname><given-names>K.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Quantitative mechanistic modeling in support of pharmacological therapeutics development in immuno-oncology</article-title>. <source>Front. Immunol</source>., <volume>10</volume>, <fpage>924</fpage>.<pub-id pub-id-type="pmid">31134058</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Plava</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Recent advances in understanding tumor stroma-mediated chemoresistance in breast cancer</article-title>. <source>Mol. Cancer</source>, <volume>18</volume>, <fpage>1</fpage>–<lpage>10</lpage>.<pub-id pub-id-type="pmid">30609930</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pourhasanzade</surname><given-names>F.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>An agent-based model of avascular tumor growth: Immune response tendency to prevent cancer development</article-title>. <italic toggle="yes">Simulation</italic>, <volume>93</volume>, <fpage>641</fpage>–<lpage>657</lpage>. doi:<pub-id pub-id-type="doi">10.1177/0037549717699072</pub-id>.</mixed-citation>
    </ref>
    <ref id="vbac092-B34">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Racle</surname><given-names>J.</given-names></string-name></person-group><etal>et al</etal> (<year>2017</year>) <article-title>Simultaneous enumeration of cancer and immune cell types from bulk tumor gene expression data</article-title>. <source>Elife</source>, <volume>6</volume>, <fpage>e26476</fpage>.<pub-id pub-id-type="pmid">29130882</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B35">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sauter</surname><given-names>B.</given-names></string-name></person-group><etal>et al</etal> (<year>2000</year>) <article-title>Consequences of cell death: exposure to necrotic tumor cells, but not primary tissue cells or apoptotic cells, induces the maturation of immunostimulatory dendritic cells</article-title>. <source>J. Exp. Med</source>., <volume>191</volume>, <fpage>423</fpage>–<lpage>434</lpage>.<pub-id pub-id-type="pmid">10662788</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B36">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stratton</surname><given-names>M.R.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>The cancer genome</article-title>. <source>Nature</source>, <volume>458</volume>, <fpage>719</fpage>–<lpage>724</lpage>.<pub-id pub-id-type="pmid">19360079</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B37">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sturm</surname><given-names>G.</given-names></string-name></person-group><etal>et al</etal> (<year>2019</year>) <article-title>Comprehensive evaluation of transcriptome-based cell-type quantification methods for immuno-oncology</article-title>. <source>Bioinformatics</source>, <volume>35</volume>, <fpage>i436</fpage>–<lpage>i445</lpage>.<pub-id pub-id-type="pmid">31510660</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B38">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sullivan</surname><given-names>M.R.</given-names></string-name>, <string-name><surname>Vander Heiden</surname><given-names>M.G.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Determinants of nutrient limitation in cancer</article-title>. <source>Crit. Rev. Biochem. Mol. Biol</source>., <volume>54</volume>, <fpage>193</fpage>–<lpage>207</lpage>.<pub-id pub-id-type="pmid">31162937</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B39">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname><given-names>S.</given-names></string-name></person-group><etal>et al</etal> (<year>2020</year>) <article-title>Mechanisms of immune escape in the cancer immune cycle</article-title>. <source>Int. Immunopharmacol</source>., <volume>86</volume>, <fpage>106700</fpage>.<pub-id pub-id-type="pmid">32590316</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B40">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thomas</surname><given-names>R.M.</given-names></string-name></person-group><etal>et al</etal> (<year>2016</year>) <article-title>Concepts in cancer modeling: a brief history</article-title>. <source>Cancer Res</source>., <volume>76</volume>, <fpage>5921</fpage>–<lpage>5925</lpage>.<pub-id pub-id-type="pmid">27694601</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B41">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thorsson</surname><given-names>V.</given-names></string-name></person-group><etal>et al</etal>; <collab>Cancer Genome Atlas Research Network</collab>. (<year>2018</year>) <article-title>The immune landscape of cancer</article-title>. <source>Immunity</source>, <volume>48</volume>, <fpage>812</fpage>–<lpage>830.e14</lpage>.<pub-id pub-id-type="pmid">29628290</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B42">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vesperini</surname><given-names>D.</given-names></string-name></person-group><etal>et al</etal> (<year>2021</year>) <article-title>Characterization of immune cell migration using microfabrication</article-title>. <source>Biophys. Rev</source>., <volume>13</volume>, <fpage>185</fpage>–<lpage>202</lpage>.<pub-id pub-id-type="pmid">34290841</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B43">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vicens</surname><given-names>A.</given-names></string-name>, <string-name><surname>Posada</surname><given-names>D.</given-names></string-name></person-group> (<year>2018</year>) <article-title>Selective pressures on human cancer genes along the evolution of mammals</article-title>. <source>Genes (Basel)</source>, <volume>9</volume>, <fpage>582</fpage>.<pub-id pub-id-type="pmid">30487452</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B44">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname><given-names>Z.</given-names></string-name></person-group><etal>et al</etal> (<year>2009</year>) <article-title>Cross-scale, cross-pathway evaluation using an agent-based non-small cell lung cancer model</article-title>. <source>Bioinformatics</source>, <volume>25</volume>, <fpage>2389</fpage>–<lpage>2396</lpage>.<pub-id pub-id-type="pmid">19578172</pub-id></mixed-citation>
    </ref>
    <ref id="vbac092-B45">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wiedemann</surname><given-names>A.</given-names></string-name></person-group><etal>et al</etal> (<year>2006</year>) <article-title>Cytotoxic T lymphocytes kill multiple targets simultaneously via spatiotemporal uncoupling of lytic and stimulatory synapses</article-title>. <source>Proc. Natl. Acad. Sci. USA</source>, <volume>103</volume>, <fpage>10985</fpage>–<lpage>10990</lpage>.<pub-id pub-id-type="pmid">16832064</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
