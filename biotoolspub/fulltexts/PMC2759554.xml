<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD Journal Publishing DTD v2.2 20060430//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName journalpublishing.dtd?>
<?SourceDTD.Version 2.2?>
<?ConverterInfo.XSLTName jp2nlmx2.xsl?>
<?ConverterInfo.Version 2?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Bioinformatics</journal-id>
    <journal-id journal-id-type="publisher-id">bioinformatics</journal-id>
    <journal-id journal-id-type="hwp">bioinfo</journal-id>
    <journal-title-group>
      <journal-title>Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1367-4803</issn>
    <issn pub-type="epub">1460-2059</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">2759554</article-id>
    <article-id pub-id-type="doi">10.1093/bioinformatics/btp488</article-id>
    <article-id pub-id-type="publisher-id">btp488</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Applications Note</subject>
        <subj-group>
          <subject>Genome Analysis</subject>
        </subj-group>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>SnoopCGH: software for visualizing comparative genomic hybridization data</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Almagro-Garcia</surname>
          <given-names>Jacob</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Manske</surname>
          <given-names>Magnus</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Carret</surname>
          <given-names>Celine</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Campino</surname>
          <given-names>Susana</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Auburn</surname>
          <given-names>Sarah</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>MacInnis</surname>
          <given-names>Bronwyn L</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Maslen</surname>
          <given-names>Gareth</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Pain</surname>
          <given-names>Arnab</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Newbold</surname>
          <given-names>Christopher I</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>2</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Kwiatkowski</surname>
          <given-names>Dominic P</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Clark</surname>
          <given-names>Taane G</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">
          <sup>1</sup>
        </xref>
        <xref ref-type="aff" rid="AFF1">
          <sup>3</sup>
        </xref>
        <xref ref-type="corresp" rid="COR1">*</xref>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><sup>1</sup> Wellcome Trust Sanger Institute, Hinxton, <sup>2</sup> The Weatherall Institute of Molecular Medicine and <sup>3</sup> Wellcome Trust Centre for Human Genetics, University of Oxford, Oxford, UK</aff>
    <author-notes>
      <corresp id="COR1">* To whom correspondence should be addressed.</corresp>
      <fn>
        <p>Associate Editor: John Quackenbush</p>
      </fn>
    </author-notes>
    <pub-date pub-type="ppub">
      <day>15</day>
      <month>10</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>8</month>
      <year>2009</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the
							<pub-date pub-type="epub"/>. -->
    <volume>25</volume>
    <issue>20</issue>
    <fpage>2732</fpage>
    <lpage>2733</lpage>
    <history>
      <date date-type="received">
        <day>29</day>
        <month>5</month>
        <year>2009</year>
      </date>
      <date date-type="rev-recd">
        <day>9</day>
        <month>8</month>
        <year>2009</year>
      </date>
      <date date-type="accepted">
        <day>11</day>
        <month>8</month>
        <year>2009</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2009. Published by Oxford University Press.</copyright-statement>
      <copyright-year>2009</copyright-year>
      <license license-type="creative-commons" xlink:href="http://creativecommons.org/licenses/by-nc/2.0/uk/">
        <license-p><!--CREATIVE COMMONS-->This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by-nc/2.5/uk/">http://creativecommons.org/licenses/by-nc/2.5/uk/</ext-link>) which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <abstract>
      <p><bold>Summary:</bold> Array-based comparative genomic hybridization (CGH) technology is used to discover and validate genomic structural variation, including copy number variants, insertions, deletions and other structural variants (SVs). The visualization and summarization of the array CGH data outputs, potentially across many samples, is an important process in the identification and analysis of SVs. We have developed a software tool for SV analysis using data from array CGH technologies, which is also amenable to short-read sequence data.</p>
      <p><bold>Availability and implementation:</bold> SnoopCGH is written in java and is available from <ext-link ext-link-type="uri" xlink:href="http://snoopcgh.sourceforge.net/">http://snoopcgh.sourceforge.net/</ext-link></p>
      <p><bold>Contact:</bold><email>jg10@sanger.ac.uk</email>; <email>tc5@sanger.ac.uk</email></p>
    </abstract>
  </article-meta>
</front>
<body>
  <sec id="SEC1">
    <title>1 BACKGROUND</title>
    <p>Genomic structural variants (SVs), including copy number variants (CNVs), can have important and pleiotropic effects on phenotype variation, increasingly being regarded as a significant type of genetic risk factor for monogenic and complex diseases (O'Donovan <italic>et al.</italic>, <xref ref-type="bibr" rid="B4">2008</xref>). However, detecting and analyzing structural variation remains challenging. Array comparative genomic hybridization (CGH) is a powerful tool for identifying copy number variation between DNA samples. In a typical array CGH experiment, DNA samples being compared (e.g. disease versus control) are differentially fluorescently labeled, pooled and hybridized to oligo probes spanning the genome of interest printed on a glass slide. The data outputs are log ratios of normalized fluorescence intensities reflecting the relative hybridization levels, and hence relative copy number levels between the samples at a given location in the genome. Thus, concentrated high or low log ratios of fluorescence intensities represent genomic regions of interest for CNVs. These regions can be very small, which makes the identification of biologically relevant events challenging. There is a growing catalog of software tools for determining and plotting CNV locations and breakpoints [see Wang <italic>et al.</italic>, (<xref ref-type="bibr" rid="B7">2009</xref>) for a review and methodology]. However, there is a dearth of tools for interactive visualization of multiple samples with CGH data at varying degrees of resolution, with the ability to display genome annotation data, informative genomic tracks (e.g. GC content) and the results of SV break point analyses. Here, we present SnoopCGH, a software tool that facilitates the rapid analysis of normalized array CGH data. Its functionality includes assessment of data quality and normalization, detection of SVs and integration of useful annotation of features. We demonstrate SnoopCGH functionality using array CGH data comparing five laboratory-adapted strains of the human malaria species, <italic>Plasmodium falciparum</italic>.</p>
  </sec>
  <sec id="SEC2">
    <title>2 FEATURES OF SNOOPCGH</title>
    <p>SnoopCGH is a java-based standalone application that inputs CGH data in tab-, space- or comma-delimited format, containing columns with: chromosome number, probe name, probe starting and end positions, and a series of log intensity values corresponding to one or more comparisons or samples. It is possible to load more than one data file. The use of multiple window layers facilitates the visualization of subsets of data, with the ability to zoom in and out of regions of interest. SV breakpoint analysis methods are implemented and enable the rapid visualization and dissection of putative SV regions. In particular, data are smoothed using an algorithm based on Haar wavelets (Ben-Yaacov and Eldar, <xref ref-type="bibr" rid="B1">2008</xref>), and islands of potential SVs are estimated using a Smith–Waterman algorithm (Price <italic>et al.</italic>, <xref ref-type="bibr" rid="B6">2005</xref>). The Haar wavelet approach has two smoothing parameters, namely start and end levels, that influence the sensitivity to the size of segments and trends, respectively. The default settings in SnoopCGH are based on suggested values in Ben-Yaacov and Eldar (<xref ref-type="bibr" rid="B1">2008</xref>). The breakpoint algorithms estimate levels of statistical significance and robustness of putative SVs using permutations. Prior to their application we may remove outliers to improve robustness using thresholds based on median absolute deviation statistics. The quantification of putative SVs leads to an ability to rank the regions of interest. We have also implemented a rank-based algorithm that considers differences in SVs between (groups of) samples (Laframboise <italic>et al.</italic>, <xref ref-type="bibr" rid="B2">2009</xref>). This extension may assist those working on association studies or multiple population studies considering differences in genetic variation. The strength of SnoopCGH is its ability to interface with downloadable annotation files (e.g. embl and gff formats) from genomic browsers, that include information on gene names and genomic features (e.g. GC content). It is also possible to read in other useful information, such as the results from breakpoint analyses run externally.</p>
  </sec>
  <sec id="SEC3">
    <title>3 APPLICATION TO A PARASITE CGH ARRAY</title>
    <p><italic>Plasmodium falciparum</italic> (<italic>Pf</italic>) malaria has an enormous morbidity and mortality burden in sub-Saharan Africa. The <italic>Pf</italic> genome is AT rich (80%), and contains some CNVs associated with drug resistance and erythrocyte invasion (Nair <italic>et al.</italic>, <xref ref-type="bibr" rid="B3">2008</xref>). The <italic>Pf</italic> CGH array was designed at the Wellcome Trust Sanger Institute and consists of ∼2 million 25 bp probes (many overlapping, but all mapping uniquely). It is being applied in an ongoing SV discovery study involving five <italic>Pf</italic> laboratory strains: 3D7 (the reference, African), DD2 (Indonesian), HB3 (Honduran), IT (South American or South East Asian) and PFCLIN (Ghanaian). We demonstrate the usefulness of SnoopCGH using screenshots of chromosome 5 data. <xref ref-type="fig" rid="F1">Figure 1</xref>A shows the log<sub>2</sub> intensities in a ∼600 kb region normalized using an average of all five strains. A separate window layer highlights a region of the IT genome that could contain increased copy number variation. This region includes coding sequence (CDS). Gene information (e.g. name, ontology, GC content) uploaded into SnoopCGH (<xref ref-type="fig" rid="F1">Fig. 1</xref>B) indicates that this region contains the multi-drug resistance CNV (PfMDR1); (Price <italic>et al.</italic>, <xref ref-type="bibr" rid="B5">2004</xref>). Applying the Smith–Waterman algorithm to the IT data, highlighted (only) the region containing PfMDR1 as being both highly statistically significant (<italic>P</italic> &lt;0.0001) and robust to a sensitivity analysis (<xref ref-type="fig" rid="F1">Fig. 1</xref>A). It is possible to change the analysis settings and methods, and move the resulting window layers across the genome. Changing the resolution of the frame also facilitates rapid dissection of data quality and analysis results. For example, <xref ref-type="fig" rid="F1">Figure 1</xref>C presents the Haar wavelet smooth for the intensities from a subset of 23 probes within the PfMDR1, part of a (4 kb) region with every smoothed value in excess of zero, indicative of a putative CNV.
<fig id="F1" position="float"><label>Fig. 1.</label><caption><p>(<bold>A</bold>) The log<sub>2</sub> intensities of the five strains for ∼600 kb of chromosome 5, with a separate window highlighting the IT data (blue), and a subregion (pink) that is both statistically significant (<italic>P</italic> &lt;0.0001) and &gt; 90% robust in a sensitivity analysis. Annotation tracks are presented at the bottom, and (<bold>B</bold>) shows the annotation navigator window for the PfMDR1 gene located in the subregion; (<bold>C</bold>) shows the Haar wavelet smoothed values for part of the PfMDR1 gene.</p></caption><graphic xlink:href="btp488f1"/></fig></p>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>4 DISCUSSION</title>
    <p>SnoopCGH enables the visual assessment of genomes for SVs, with an estimation of their locations and statistical significance, as well as the ability to cross-check with external information (e.g. sequence annotation). Although we have implemented several fast breakpoint analytical methods, more sophisticated and computationally expensive approaches are being developed. These may be incorporated into a SnoopCGH analysis by either reading in the results from file or incorporating the method itself into our flexible software architecture. Ongoing work involves implementing new breakpoint detection methods, and incorporating tools to highlight the concordance of results from alternative SV detection methods. SVs may be detected using data from new sequencing technologies by considering differences in nucleotide coverage between target and reference genomes. It is possible to use SnoopCGH on such data, where (log transformed) ratios of normalized coverage (within or between samples) substitute for log ratios of normalized fluorescence intensities. However, sufficient consideration should be given to issues in the preprocessing steps, such as the uniqueness of read mappings, sequencing and assembly errors, and normalization accounting for GC content. In conclusion, SnoopCGH is a powerful visualization and analysis tool for those analyzing CGH data and discovering SVs genomewide, and has potential utility for those using new sequencing technologies for the same purpose.</p>
    <p><italic>Funding</italic>: Bill and Melinda Gates Foundation; Wellcome Trust; Medical Research Council UK.</p>
    <p><italic>Conflict of Interest</italic>: none declared.</p>
  </sec>
</body>
<back>
  <ref-list>
    <title>REFERENCES</title>
    <ref id="B1">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ben-Yaacov</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Eldar</surname>
            <given-names>YC</given-names>
          </name>
        </person-group>
        <article-title>A fast and flexible method for the segmentation of ACGH data</article-title>
        <source>Bioinformatics</source>
        <year>2008</year>
        <volume>24</volume>
        <fpage>1139</fpage>
        <lpage>1145</lpage>
      </element-citation>
    </ref>
    <ref id="B2">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Laframboise</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A flexible rank-based framework for detecting copy number aberrations from array data</article-title>
        <source>Bioinformatics</source>
        <year>2009</year>
        <volume>25</volume>
        <fpage>722</fpage>
        <lpage>728</lpage>
        <pub-id pub-id-type="pmid">19176555</pub-id>
      </element-citation>
    </ref>
    <ref id="B3">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Nair</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Adaptive copy number evolution in malaria parasites</article-title>
        <source>PLoS Genet.</source>
        <year>2008</year>
        <volume>4</volume>
        <fpage>e1000243</fpage>
        <pub-id pub-id-type="pmid">18974876</pub-id>
      </element-citation>
    </ref>
    <ref id="B4">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>O'Donovan</surname>
            <given-names>MC</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Phenotypic variations on the theme of CNVs</article-title>
        <source>Nat. Genet.</source>
        <year>2008</year>
        <volume>40</volume>
        <fpage>1392</fpage>
        <lpage>1393</lpage>
        <pub-id pub-id-type="pmid">19029974</pub-id>
      </element-citation>
    </ref>
    <ref id="B5">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>RN</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mefloquine resistance in Plasmodium falciparum and increased pfmdr1 gene copy number</article-title>
        <source>Lancet</source>
        <year>2004</year>
        <volume>364</volume>
        <fpage>438</fpage>
        <lpage>447</lpage>
        <pub-id pub-id-type="pmid">15288742</pub-id>
      </element-citation>
    </ref>
    <ref id="B6">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Price</surname>
            <given-names>TS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SW-ARRAY: a dynamic programming solution for the identification of copy-number changes in genomic DNA using array comparative genome hybridization data</article-title>
        <source>Nucleic Acids Res.</source>
        <year>2005</year>
        <volume>33</volume>
        <fpage>3455</fpage>
        <lpage>3464</lpage>
        <pub-id pub-id-type="pmid">15961730</pub-id>
      </element-citation>
    </ref>
    <ref id="B7">
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wang</surname>
            <given-names>LY</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>MSB: a mean-shift-based approach for the analysis of structural variation in the genome</article-title>
        <source>Genome Res.</source>
        <year>2009</year>
        <volume>19</volume>
        <fpage>106</fpage>
        <lpage>117</lpage>
        <pub-id pub-id-type="pmid">19037015</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
