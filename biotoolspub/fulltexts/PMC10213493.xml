<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genetics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genetics</journal-id>
    <journal-id journal-id-type="publisher-id">genetics</journal-id>
    <journal-title-group>
      <journal-title>Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0016-6731</issn>
    <issn pub-type="epub">1943-2631</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>US</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10213493</article-id>
    <article-id pub-id-type="pmid">36988327</article-id>
    <article-id pub-id-type="doi">10.1093/genetics/iyad055</article-id>
    <article-id pub-id-type="publisher-id">iyad055</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Investigation</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01180</subject>
        <subject>AcademicSubjects/SCI01140</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GBScleanR: robust genotyping error correction using a hidden Markov model with error pattern recognition</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Furuta</surname>
          <given-names>Tomoyuki</given-names>
        </name>
        <aff><institution>Institute of Plant Science and Resources, Okayama University</institution>, <addr-line>Chu-oh 2-20-1, Kurashiki, Okayama 710-0046</addr-line>, <country country="JP">Japan</country></aff>
        <xref rid="iyad055-cor1" ref-type="corresp"/>
        <!--f.tomoyuki@okayama-u.ac.jp-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yamamoto</surname>
          <given-names>Toshio</given-names>
        </name>
        <aff><institution>Institute of Plant Science and Resources, Okayama University</institution>, <addr-line>Chu-oh 2-20-1, Kurashiki, Okayama 710-0046</addr-line>, <country country="JP">Japan</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ashikari</surname>
          <given-names>Motoyuki</given-names>
        </name>
        <aff><institution>Bioscience and Biotechnology Center, Nagoya University</institution>, <addr-line>Furo-cho, Chikusa, Nagoya, Aichi 464-8601</addr-line>, <country country="JP">Japan</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Endelman</surname>
          <given-names>J</given-names>
        </name>
        <role>Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="iyad055-cor1">Corresponding author: Institute of Plant Science and Resources, Okayama University, Chu-oh 2-20-1, Kurashiki, Okayama, 710-0046, Japan. Email: <email>f.tomoyuki@okayama-u.ac.jp</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-03-29">
      <day>29</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <volume>224</volume>
    <issue>2</issue>
    <elocation-id>iyad055</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>15</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of The Genetics Society of America.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="iyad055.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Reduced-representation sequencing (RRS) provides cost-effective and time-saving genotyping platforms. Despite the outstanding advantage of RRS in throughput, the obtained genotype data usually contain a large number of errors. Several error correction methods employing the hidden Markov model (HMM) have been developed to overcome these issues. These methods assume that markers have a uniform error rate with no bias in the allele read ratio. However, bias does occur because of uneven amplification of genomic fragments and read mismapping. In this paper, we introduce an error correction tool, GBScleanR, which enables robust and precise error correction for noisy RRS-based genotype data by incorporating marker-specific error rates into the HMM. The results indicate that GBScleanR improves the accuracy by more than 25 percentage points at maximum compared to the existing tools in simulation data sets and achieves the most reliable genotype estimation in real data even with error-prone markers.</p>
    </abstract>
    <kwd-group>
      <kwd>reduced-representation sequencing</kwd>
      <kwd>error correction</kwd>
      <kwd>imputation</kwd>
      <kwd>hidden Markov model</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Japan Science and Technology Agency</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002241</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Ministry of Education, Culture, Sports, Science and Technology of Japan</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001700</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>JP20H05912</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="iyad055-s0">
    <title>Introduction</title>
    <p>Reduced-representation sequencing (RRS) is a sequencing technique using next-generation sequencing (NGS) with reducing sequence targets by taking reads only from a limited portion of a genome (<xref rid="iyad055-B26" ref-type="bibr">Scheben <italic toggle="yes">et al.</italic> 2017</xref>). To meet the demands for cost-effective genotyping systems with dense markers, many different RRS-based genotyping methods have been introduced, including restriction site-associated DNA sequencing (RAD-seq) and genotyping-by-sequencing (GBS) (<xref rid="iyad055-B2" ref-type="bibr">Baird <italic toggle="yes">et al.</italic> 2008</xref>; <xref rid="iyad055-B8" ref-type="bibr">Elshire <italic toggle="yes">et al.</italic> 2011</xref>). The reduction in the number of sequence targets allows us for highly multiplexed sequencing to obtain genotype data of a large population such as a hybrid population for genetic mapping and breeding. However, a larger number of samples per NGS run result in genotype data with a lower read coverage per sample (<xref rid="iyad055-B21" ref-type="bibr">Poland and Rife 2012</xref>). Since sequence reads that can be retrieved via NGS are highly stochastic, the limited number of reads can result in the undercalling of heterozygotes, in which recovering only 1 allele at a heterozygous site leads to its incorrect identification as a homozygote. The lack of reads also generates a substantial number of missing genotype calls.</p>
    <p>Several error correction tools have been developed to overcome these disadvantages. The method to fill up missing calls and correct the undercalling of heterozygotes was first published in 2009, which determines genotypes based on the allele read ratio within a sliding window (<xref rid="iyad055-B15" ref-type="bibr">Huang <italic toggle="yes">et al.</italic> 2009</xref>). Genotype-Corrector is also an example of the tool using a sliding window method for error correction (<xref rid="iyad055-B20" ref-type="bibr">Miao <italic toggle="yes">et al.</italic> 2018</xref>). Recent publications have introduced statistically sophisticated methods using hidden Markov models (HMMs), such as FSFHap, TIGER, LB-Impute, and magicImpute (<xref rid="iyad055-B27" ref-type="bibr">Swarts <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="iyad055-B25" ref-type="bibr">Rowan <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="iyad055-B9" ref-type="bibr">Fragoso <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyad055-B31" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2018</xref>). The existing methods, however, assume constant error rates for all markers. For example, those assume a 50:50 probability that a read could be obtained for 1 of 2 possible alleles at a heterozygous site. Although this assumption is true in an ideal situation, in practice, genotype data contain a significant number of error-prone markers that show skewed probabilities in allele read acquisition as a result of actual biological unevenness (<xref rid="iyad055-B7" ref-type="bibr">Davey <italic toggle="yes">et al.</italic> 2013</xref>; <xref rid="iyad055-B28" ref-type="bibr">Wijnker <italic toggle="yes">et al.</italic> 2013</xref>; <xref rid="iyad055-B6" ref-type="bibr">DaCosta and Sorenson 2014</xref>). Variations in genome sequences change the fragmentation patterns of the genomes. Even if 2 independent reads are mapped at the same locus, the sequences of the genomic fragments from which each of the 2 reads originated can vary in terms of GC content and length and sometimes include large insertions or deletions in the unsequenced region of the fragments. Since the GC contents and the lengths of the restriction fragments are known to affect the amplification efficiency, the probability of observing a read for either allele may differ. These biases are likely to be more prominent in a polymorphism-rich population, for example, that derived from a cross between distant relatives. Hence, mismatches occur between the real data, which shows marker-specific error rates, and the models that assume a uniform error rate, resulting in biased genotype estimation and poor error correction accuracy.</p>
    <p>Here, we introduce the R package “GBScleanR,” which implements an HMM-based error correction algorithm. Our algorithm estimates an allele read bias and mismapping rate for each marker and incorporates those into the HMM as parameters to capture the skewed probabilities in allele read acquisitions. This paper demonstrates a comparison of GBScleanR and 2 well-established error correction tools: LB-Impute and magicImpute (<xref rid="iyad055-B9" ref-type="bibr">Fragoso <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyad055-B31" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2018</xref>). While LB-Impute accepts only biparental populations derived from inbred founders, magicImpute can work on biparental and multiparental populations derived from both inbred and outbred founders. The magicImpute algorithm is also able to estimate founder genotypes simultaneously with the offspring genotypes. Similar to magicImpute, GBScleanR supports simultaneous estimation of founder and offspring genotypes in a biparental and multiparental population. We first show simulation studies to present the accuracy and robustness of GBScleanR using simulation data sets that have severe allele read biases at error-prone markers. The simulation assumes 3 scenarios: a biparental <italic toggle="yes">F</italic><sub>2</sub> population (homoP2_F2), an outbred <italic toggle="yes">F</italic><sub>1</sub> population (hetP2_F1), and 8-way recombinant inbred lines (homoP8_RIL). We then demonstrate the reliability and robustness of GBScleanR using real data derived from a cross between distant relatives of rice, which potentially contains many error-prone markers.</p>
  </sec>
  <sec sec-type="methods" id="iyad055-s1">
    <title>Methods</title>
    <sec id="iyad055-s1.1">
      <title>Modeling for error correction</title>
      <p>Our modeling basically follows the model implemented in magicImpute that has been introduced in <xref rid="iyad055-B31" ref-type="bibr">Zheng <italic toggle="yes">et al</italic>. (2018)</xref>. The error correction algorithm of GBScleanR employs the HMM and treats the observed allele read counts for each SNP marker along a chromosome as outputs from a sequence of latent true genotypes. Our model supposes that a population of <inline-formula><mml:math id="IM1" display="inline" overflow="scroll"><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> offspring is originally derived from crosses between <inline-formula><mml:math id="IM2" display="inline" overflow="scroll"><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.25em"/></mml:math></inline-formula> founder individuals. The founders can be inbred lines with homozygotes at all markers or outbred lines in which markers would be heterozygous. Only 1 chromosome is considered for modeling due to the independence of chromosomes. Let <inline-formula><mml:math id="IM3" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> denote the observed allele read counts at marker <italic toggle="yes">m</italic> in offspring <italic toggle="yes">i</italic>. The element <inline-formula><mml:math id="IM4" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> consists of 2 values, <inline-formula><mml:math id="IM5" display="inline" overflow="scroll"><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="IM6" display="inline" overflow="scroll"><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula>, which represent the reference read count and the alternative read count, respectively. Similarly, the observed allele read counts at marker <italic toggle="yes">m</italic> in founder <italic toggle="yes">j</italic> are represented by <inline-formula><mml:math id="IM7" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula>. The matrices for hidden true offspring genotypes and hidden true founder genotypes are represented by <inline-formula><mml:math id="IM8" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM9" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula>, respectively. The element <inline-formula><mml:math id="IM10" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> takes a value of 0, 1, or 2 to indicate the reference homozygote, heterozygote, and alternative homozygote genotype without phasing information. Unlike the offspring genotype matrix, the founder genotype <inline-formula><mml:math id="IM11" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> stores the phased genotype as <inline-formula><mml:math id="IM12" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, where <inline-formula><mml:math id="IM13" display="inline" overflow="scroll"><mml:msup><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mspace width="0.25em"/></mml:math></inline-formula> and <inline-formula><mml:math id="IM14" display="inline" overflow="scroll"><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> indicate alleles at marker <italic toggle="yes">m</italic> on one of the diploid chromosomes and another in founder <italic toggle="yes">j</italic>, respectively. The reference allele is represented by 0, while 1 denotes the alternative. Considering the linkage between the markers and the independence of the founder genotypes, we can assume that the sequence of the descendent genotypes from founders does not follow a Markov process, while the sequence of the descendent haplotypes <inline-formula><mml:math id="IM15" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> does. To enable our estimation problem to be solved in the HMM framework, <inline-formula><mml:math id="IM16" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> is introduced to represent the matrix of the phased descendent haplotypes. The element <inline-formula><mml:math id="IM17" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> denotes a pair of descendent haplotypes <inline-formula><mml:math id="IM18" display="inline" overflow="scroll"><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> at marker <italic toggle="yes">m</italic> in offspring <italic toggle="yes">i</italic>. Therefore, <inline-formula><mml:math id="IM19" display="inline" overflow="scroll"><mml:msup><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="IM20" display="inline" overflow="scroll"><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> each take one of the natural numbers that are <inline-formula><mml:math id="IM21" display="inline" overflow="scroll"><mml:mo>≤</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> if all founders are inbred or <inline-formula><mml:math id="IM22" display="inline" overflow="scroll"><mml:mo>≤</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> if outbred to indicate the origins of the descendent haplotypes.</p>
      <p>The algorithm estimates <inline-formula><mml:math id="IM23" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="IM24" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> based on <inline-formula><mml:math id="IM25" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="IM26" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> by maximizing the joint probability <inline-formula><mml:math id="IM27" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. We assume the independence of the offspring and the founders and the independence of each founder genotype at each marker. Therefore, our algorithm tries to maximize the following joint probability:</p>
      <disp-formula id="UM0001">
        <mml:math id="UM1" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">H</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">X</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munderover>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mi>N</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:munderover>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mrow>
            <mml:mo>{</mml:mo>
            <mml:mrow>
              <mml:mstyle displaystyle="true">
                <mml:munderover>
                  <mml:mrow>
                    <mml:mo movablelimits="false">∏</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mi>M</mml:mi>
                </mml:munderover>
              </mml:mstyle>
              <mml:mspace width="0.2em"/>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>y</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo fence="false" stretchy="false">|</mml:mo>
                </mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>,</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mstyle displaystyle="true">
                <mml:munderover>
                  <mml:mrow>
                    <mml:mo movablelimits="false">∏</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                  <mml:mi>M</mml:mi>
                </mml:munderover>
              </mml:mstyle>
              <mml:mspace width="0.2em"/>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo fence="false" stretchy="false">|</mml:mo>
                </mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>,</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo fence="false" stretchy="false">|</mml:mo>
                </mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
            <mml:mo>}</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0002">
        <mml:math id="UM2" display="block" overflow="scroll">
          <mml:mspace width="-10pc"/>
          <mml:mo>×</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munderover>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mi>M</mml:mi>
            </mml:munderover>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">y</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM28" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, and <inline-formula><mml:math id="IM30" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> correspond to the emission probability, the transition probability, and the initial probability of the HMM, respectively. <inline-formula><mml:math id="IM31" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the probability of observing read counts for the founders at marker <italic toggle="yes">m</italic> when the combination of the true genotypes of the founders is <inline-formula><mml:math id="IM32" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. The details to derive the equation shown above are available in the <italic toggle="yes">Joint probability derivation</italic> section in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>. We assume that <inline-formula><mml:math id="IM33" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> follows a discrete uniform probability for all possible combinations of the founder genotypes while omitting cases in which all founders have a same genotype.</p>
    </sec>
    <sec id="iyad055-s1.2">
      <title>Emission probability</title>
      <p>To obtain the emission probability <inline-formula><mml:math id="IM34" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, 3 additional probabilities are introduced: <inline-formula><mml:math id="IM35" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="IM36" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, and <inline-formula><mml:math id="IM37" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. The first 2 probabilities incorporate the effect of read mismapping that would make true genotype unobservable. <inline-formula><mml:math id="IM38" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the probability that the observable genotype is <inline-formula><mml:math id="IM39" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when read mismapping occurred at marker <italic toggle="yes">m</italic> of <italic toggle="yes">i</italic>th offspring that has the true genotype <inline-formula><mml:math id="IM40" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. <inline-formula><mml:math id="IM41" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> represents the probability to observe the reads <inline-formula><mml:math id="IM42" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when the observable genotype is <inline-formula><mml:math id="IM43" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. <inline-formula><mml:math id="IM44" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the probability to observe the genotype <inline-formula><mml:math id="IM45" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when the haplotype <inline-formula><mml:math id="IM46" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> was descendent from the founders having the genotype <inline-formula><mml:math id="IM47" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. We then rewrite the emission probability as <inline-formula><mml:math id="IM48" display="inline" overflow="scroll"><mml:msubsup><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, and it holds that</p>
      <disp-formula id="UM0003">
        <mml:math id="UM3" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>x</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mi>e</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">map</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0004">
        <mml:math id="UM4" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mi>e</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">map</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>x</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">′</mml:mi>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mi>e</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">map</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM49" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> equals 1 for the possible genotype under the constraint of the descendent haplotypes and founder genotypes in sample <italic toggle="yes">i</italic> and 0 for the other genotypes. For example, if sample 1 has <inline-formula><mml:math id="IM50" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mn>4</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> at marker 1, indicating that the haplotypes descended from the first chromosome of founder 1 and the second chromosome of founder 2, and if the founder genotypes are <inline-formula><mml:math id="IM51" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="IM52" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, the genotype can only be heterozygotic . The parameter <inline-formula><mml:math id="IM53" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> represents the global sequencing error rate that an unexpected allele read can be observed when the true genotype is either homozygote. We only assume that the sequencing error generates a read representing an opposite allele of the true allele. All markers are considered to have a same <inline-formula><mml:math id="IM54" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> value. The parameters <inline-formula><mml:math id="IM55" display="inline" overflow="scroll"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM56" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> are the marker-specific allele read bias and mismapping rate at marker <italic toggle="yes">m</italic>. These are the key parameters that make GBScleanR differ from the other algorithms including magicImpute in which no allele read bias and a constant mismapping rate are assumed. <inline-formula><mml:math id="IM57" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> indicates the observable genotype that results from accounting for the mismapping with <inline-formula><mml:math id="IM58" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula>. We assume that <inline-formula><mml:math id="IM59" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> takes 2 values <inline-formula><mml:math id="IM60" display="inline" overflow="scroll"><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. <inline-formula><mml:math id="IM61" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mspace width="0.25em"/></mml:math></inline-formula> indicates the probability of incorrectly observing an alternative allele due to mismapped alternative reads when the true genotype is a reference homozygote. Similarly, <inline-formula><mml:math id="IM62" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> represents the probability of incorrectly observing a reference allele due to mismapped reference reads when the true genotype is an alternative homozygote. In the calculation of <inline-formula><mml:math id="IM63" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, we do not consider the undercalling of heterozygotes and missing calls for which <inline-formula><mml:math id="IM64" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> accounts. Therefore, when the true genotype <inline-formula><mml:math id="IM65" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is heterozygous, we can expect to observe that both alleles and an additional incorrect observation of either allele due to mismapping do not change the observable genotype <inline-formula><mml:math id="IM66" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> that is heterozygous. On the other hand, for example, the incorrectly observed reference allele due to mismapping of reference reads at an alternative homozygous site makes the site can be observed as heterozygous. Thus, the probability <inline-formula><mml:math id="IM67" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> takes the values listed in <xref rid="iyad055-T1" ref-type="table">Table 1</xref>. The observed read counts <inline-formula><mml:math id="IM68" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo></mml:math></inline-formula> follow binomial distribution</p>
      <disp-formula id="UM0005">
        <mml:math id="UM5" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mspace width="0.25em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:mn>0</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>∝</mml:mo>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:mn>1</mml:mn>
            <mml:mo>−</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">ref</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">alt</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0006">
        <mml:math id="UM6" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mspace width="0.25em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:mn>1</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>∝</mml:mo>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:mn>1</mml:mn>
            <mml:mo>−</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">ref</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">alt</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0007">
        <mml:math id="UM7" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mspace width="0.25em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:mn>2</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>∝</mml:mo>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">ref</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:mn>1</mml:mn>
            <mml:mo>−</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">alt</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>given the observable genotype <inline-formula><mml:math id="IM69" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. To reduce the negative impact of overrepresented mismapping reads that can make the probabilities of less probable genotypes being 0, we add 0.005 to the probabilities for the 3 possible genotypes if any of <inline-formula><mml:math id="IM70" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> gave <inline-formula><mml:math id="IM71" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn></mml:math></inline-formula>. The normalization constant for <inline-formula><mml:math id="IM72" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is not shown in the equation above. Similarly, the emission probability for founders can be obtained by</p>
      <disp-formula id="UM0008">
        <mml:math id="UM8" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mrow>
              <mml:mi mathvariant="bold-italic">l</mml:mi>
            </mml:mrow>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo>∝</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munderover>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mi>j</mml:mi>
              <mml:mrow>
                <mml:msup>
                  <mml:mi>N</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:munderover>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mi>e</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">map</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where the normalization constant for <inline-formula><mml:math id="IM73" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is not shown. To omit the less probable founder genotypes, the probability <inline-formula><mml:math id="IM74" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is set to 0 if the result is &lt;0.01.</p>
      <table-wrap position="float" id="iyad055-T1">
        <label>Table 1.</label>
        <caption>
          <p>Probabilities associated with mismapping.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1"/>
              <th colspan="3" align="center" rowspan="1">Observable genotype <inline-formula><mml:math id="IM75" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="bold">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1">0</th>
              <th align="center" rowspan="1" colspan="1">1</th>
              <th align="center" rowspan="1" colspan="1">2</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="3" colspan="1">True genotype <inline-formula><mml:math id="IM76" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <mml:math id="IM77" display="inline" overflow="scroll">
                    <mml:mspace width="-3pt"/>
                    <mml:mn>1</mml:mn>
                    <mml:mo>−</mml:mo>
                    <mml:msup>
                      <mml:mi>e</mml:mi>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">ref</mml:mi>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <mml:math id="IM78" display="inline" overflow="scroll">
                    <mml:msup>
                      <mml:mi>e</mml:mi>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">ref</mml:mi>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <mml:math id="IM79" display="inline" overflow="scroll">
                    <mml:msup>
                      <mml:mi>e</mml:mi>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">alt</mml:mi>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <mml:math id="IM80" display="inline" overflow="scroll">
                    <mml:mn>1</mml:mn>
                    <mml:mo>−</mml:mo>
                    <mml:msup>
                      <mml:mi>e</mml:mi>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">alt</mml:mi>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="iyad055-s1.3">
      <title>Transition probability</title>
      <p>The transition probability <inline-formula><mml:math id="IM81" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is used to describe the probability that a crossover occurs between adjacent markers. The sequence of the descendent haplotypes is modeled using a continuous-time Markov chain, as described previously (<xref rid="iyad055-B29" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2014</xref>, <xref rid="iyad055-B30" ref-type="bibr">2015</xref>). The probability that the haplotype state transitions from <inline-formula><mml:math id="IM82" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> to <inline-formula><mml:math id="IM83" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> between the markers can be obtained using</p>
      <disp-formula id="UM0009">
        <mml:math id="UM9" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msup>
            <mml:mi>e</mml:mi>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">Q</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>d</mml:mi>
                    <mml:mi>m</mml:mi>
                  </mml:msub>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:msup>
          <mml:mo>,</mml:mo>
          <mml:mi>m</mml:mi>
          <mml:mo>≠</mml:mo>
          <mml:mn>1</mml:mn>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow></mml:math></inline-formula> denotes the transition rate matrix that defines the rates at which a state transition occurs per unit of time. The matrix exponential is obtained by Higham's algorithm, which is implemented in the “expm” package of R (<ext-link xlink:href="http://cran.r-project.org/web/packages/expm/index.html" ext-link-type="uri">http://cran.r-project.org/web/packages/expm/index.html</ext-link>). To obtain transition rates that are proportional to the distances between adjacent markers, <inline-formula><mml:math id="IM85" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow></mml:math></inline-formula> is multiplied by the genetic distance between markers <italic toggle="yes">m</italic> and <italic toggle="yes">m</italic> − 1 in Morgan <italic toggle="yes">d<sub>m</sub></italic>. While our algorithm requires genetic distances between markers, genotype data obtained via NGS generally provide only information about the physical distances. Therefore, <italic toggle="yes">d<sub>m</sub></italic> is calculated based on the physical distance and the expected genetic distance:</p>
      <disp-formula id="UM0010">
        <mml:math id="UM10" display="block" overflow="scroll">
          <mml:msub>
            <mml:mi>d</mml:mi>
            <mml:mi>m</mml:mi>
          </mml:msub>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msup>
            <mml:mn>10</mml:mn>
            <mml:mrow>
              <mml:mo>−</mml:mo>
              <mml:mn>6</mml:mn>
            </mml:mrow>
          </mml:msup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:mspace width=".1em"/>
            <mml:msub>
              <mml:mi>p</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
            <mml:mo>−</mml:mo>
            <mml:msub>
              <mml:mi>p</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:msup>
            <mml:mrow>
              <mml:mi mathvariant="normal">E</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">d</mml:mi>
            </mml:mrow>
          </mml:msup>
          <mml:mo>,</mml:mo>
          <mml:mi>m</mml:mi>
          <mml:mo>≠</mml:mo>
          <mml:mn>1</mml:mn>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <italic toggle="yes">p<sub>m</sub></italic> represents the physical position of marker <italic toggle="yes">m</italic> and E<sup>d</sup> is the expected genetic distance per megabase pair that should be specified as the input parameter. For <italic toggle="yes">m</italic> = 1, the initial probability <inline-formula><mml:math id="IM86" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is required and specified by the stationary distribution of the Markov process that can be obtained by normalizing the first eigenvector of the transposed transition probability matrix for a marker interval.</p>
    </sec>
    <sec id="iyad055-s1.4">
      <title>Estimation of the best haplotype and genotype sequences</title>
      <p>Together with the definitions described in the sections above, the joint probability to maximize can be rewritten as shown below:</p>
      <disp-formula id="UM0011">
        <mml:math id="UM11" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">H</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">X</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mrow>
            <mml:mo>{</mml:mo>
            <mml:mrow>
              <mml:mstyle displaystyle="true">
                <mml:munder>
                  <mml:mrow>
                    <mml:mo movablelimits="false">∏</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:munder>
              </mml:mstyle>
              <mml:mspace width="0.2em"/>
              <mml:msubsup>
                <mml:mi>l</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mstyle displaystyle="true">
                <mml:munder>
                  <mml:mrow>
                    <mml:mo movablelimits="false">∏</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:munder>
              </mml:mstyle>
              <mml:mspace width="0.2em"/>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo fence="false" stretchy="false">|</mml:mo>
                </mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>,</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo fence="false" stretchy="false">|</mml:mo>
                </mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
            <mml:mo>}</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>The Viterbi algorithm is used to maximize the joint probability and estimate the most likely haplotype sequences (<xref rid="iyad055-B23" ref-type="bibr">Rabiner 1989</xref>). Considering that the sequence of founder genotypes itself does not follow the Markov process while the offspring haplotypes depend on the founder genotypes, the most likely founder genotypes at marker <italic toggle="yes">m</italic> can be estimated based on the scores (probabilities) and the states of the Viterbi trellises that were calculated for the offspring genotype from markers 1 to <italic toggle="yes">m</italic>. Therefore, our algorithm recursively calculates the Viterbi scores for offspring <inline-formula><mml:math id="IM87" display="inline" overflow="scroll"><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and founders <inline-formula><mml:math id="IM88" display="inline" overflow="scroll"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and records the Viterbi paths for the sequences of offspring haplotypes <inline-formula><mml:math id="IM89" display="inline" overflow="scroll"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and founder genotypes <inline-formula><mml:math id="IM90" display="inline" overflow="scroll"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, respectively. The recursive calculation of the integrated Viterbi algorithm proceeds as follows.</p>
      <p>Initialization at <italic toggle="yes">m</italic> = 1:</p>
      <p>The initialization starts with simply calculating the probability of having <inline-formula><mml:math id="IM91" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when the combination of the founder genotypes <inline-formula><mml:math id="IM92" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is given.</p>
      <disp-formula id="UM0012">
        <mml:math id="UM12" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mrow>
              <mml:mn>1</mml:mn>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mn>1</mml:mn>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mn>1</mml:mn>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mrow>
              <mml:mn>1</mml:mn>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mn>1</mml:mn>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mn>1</mml:mn>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM93" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the initial probability that the <italic toggle="yes">i</italic>th offspring has the combination of haplotypes <inline-formula><mml:math id="IM94" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> at the first marker.</p>
      <p>Recursion at <inline-formula><mml:math id="IM95" display="inline" overflow="scroll"><mml:mn>2</mml:mn><mml:mo>≤</mml:mo><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:math></inline-formula>:</p>
      <p>The algorithm calculates the probabilities of state transitions from marker <italic toggle="yes">m</italic> − 1 to <italic toggle="yes">m</italic> as shown below:</p>
      <disp-formula id="UM0013">
        <mml:math id="UM13" display="block" overflow="scroll">
          <mml:msub>
            <mml:mi>τ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0014">
        <mml:math id="UM14" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>τ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">′</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo form="prefix">max</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msub>
              <mml:mi>τ</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mi>h</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mrow>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
              </mml:mrow>
              <mml:msubsup>
                <mml:mi>h</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo>,</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM96" display="inline" overflow="scroll"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is a matrix, each element of which indicates the probability of observing the transition from <inline-formula><mml:math id="IM97" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> to <inline-formula><mml:math id="IM98" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when <inline-formula><mml:math id="IM99" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="IM100" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> are given, while <inline-formula><mml:math id="IM101" display="inline" overflow="scroll"><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> indicates the probabilities of observing <inline-formula><mml:math id="IM102" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when the most likely transition from <inline-formula><mml:math id="IM103" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> to <inline-formula><mml:math id="IM104" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> occurs with given <inline-formula><mml:math id="IM105" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="IM106" display="inline" overflow="scroll"><mml:mrow><mml:mspace width="0.25em"/></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:math></inline-formula></p>
      <p>Then, calculate the Viterbi scores and the Viterbi paths for founders as</p>
      <disp-formula id="UM0015">
        <mml:math id="UM15" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mn>1</mml:mn>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:msubsup>
            <mml:mi>τ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">′</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0016">
        <mml:math id="UM16" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>ψ</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mspace width="0.25em"/>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mi>arg</mml:mi>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo form="prefix">max</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>v</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mrow>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
              </mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Using <inline-formula><mml:math id="IM107" display="inline" overflow="scroll"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, which stores the most likely combination of founder genotypes at marker <italic toggle="yes">m</italic> − 1 when <inline-formula><mml:math id="IM108" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is given, we can obtain the Viterbi scores and the Viterbi paths for offspring as follows:</p>
      <disp-formula id="UM0017">
        <mml:math id="UM17" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>ψ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mi>arg</mml:mi>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo form="prefix">max</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msub>
              <mml:mi>τ</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mi>h</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mrow>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
              </mml:mrow>
              <mml:msubsup>
                <mml:mi>h</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo>,</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo>=</mml:mo>
              <mml:mspace width="0.25em"/>
              <mml:msubsup>
                <mml:mi>ψ</mml:mi>
                <mml:mi>m</mml:mi>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0018">
        <mml:math id="UM18" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msubsup>
            <mml:mi>τ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">′</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:msubsup>
              <mml:mi>ψ</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Termination at <italic toggle="yes">m</italic> = <italic toggle="yes">M</italic>:</p>
      <p>Finally, we obtain the probability of observing <inline-formula><mml:math id="IM109" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and the most likely combination of founder genotypes at marker <italic toggle="yes">M</italic> via the following calculation:</p>
      <disp-formula id="UM0019">
        <mml:math id="UM19" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mi>M</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">′</mml:mi>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mi>M</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0020">
        <mml:math id="UM20" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mrow>
              <mml:mover>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mo stretchy="false">^</mml:mo>
              </mml:mover>
            </mml:mrow>
            <mml:mi>M</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mi>arg</mml:mi>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo form="prefix">max</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mi>M</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>v</mml:mi>
              <mml:mi>M</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Once <inline-formula><mml:math id="IM110" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is determined, we can also obtain the most likely offspring haplotypes at marker <italic toggle="yes">M</italic>:</p>
      <disp-formula id="UM0021">
        <mml:math id="UM21" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mrow>
              <mml:mover>
                <mml:mi>h</mml:mi>
                <mml:mo stretchy="false">^</mml:mo>
              </mml:mover>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mi>arg</mml:mi>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo form="prefix">max</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>v</mml:mi>
              <mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mi>h</mml:mi>
                <mml:mrow>
                  <mml:mi>M</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mrow>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
              </mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mover>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">x</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">^</mml:mo>
                  </mml:mover>
                </mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Backtracking from <italic toggle="yes">M</italic> − 1 to 1:</p>
      <p>To retrieve the most likely sequences of founder genotypes and offspring haplotypes, we trace the Viterbi paths as shown below:</p>
      <disp-formula id="UM0022">
        <mml:math id="UM22" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mrow>
              <mml:mover>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mo stretchy="false">^</mml:mo>
              </mml:mover>
            </mml:mrow>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msubsup>
            <mml:mi>ψ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mn>1</mml:mn>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mover>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">^</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0023">
        <mml:math id="UM23" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mrow>
              <mml:mover>
                <mml:mi>h</mml:mi>
                <mml:mo stretchy="false">^</mml:mo>
              </mml:mover>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msubsup>
            <mml:mi>ψ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mover>
                  <mml:mi>h</mml:mi>
                  <mml:mo stretchy="false">^</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mover>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">^</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>If multiple arguments have the same maximum score, one of them is randomly selected. To increase the accuracy, our algorithm executes 2 rounds of estimation: 1 from marker 1 to <italic toggle="yes">M</italic> and another in the reverse direction. The reverse direction round starts from the last marker <italic toggle="yes">M</italic> and uses the estimated founder genotypes <inline-formula><mml:math id="IM111" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> from the forward round as the only possible founder genotypes at marker <italic toggle="yes">M</italic>. The results from both rounds are then merged by combining the first half of the estimated genotypes <inline-formula><mml:math id="IM112" display="inline" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>&lt;</mml:mo><mml:mrow><mml:mfrac><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> from the reversed direction round with the last half from the forward direction round.</p>
      <p>The estimated genotype at each marker in each sample <inline-formula><mml:math id="IM113" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> can now be obtained based on <inline-formula><mml:math id="IM114" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mi>h</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="IM115" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. To evaluate the reliability of the estimated genotypes, the marginal probability is also calculated:</p>
      <disp-formula id="UM0024">
        <mml:math id="UM24" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">X</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">^</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mover>
                      <mml:mi>h</mml:mi>
                      <mml:mo stretchy="false">^</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mi>o</mml:mi>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">X</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">^</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">X</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">^</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM116" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> can be obtained using the forward–backward algorithm (<xref rid="iyad055-B23" ref-type="bibr">Rabiner 1989</xref>). The estimated genotype <inline-formula><mml:math id="IM117" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is set as missing if <inline-formula><mml:math id="IM118" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is smaller than a user specified threshold <italic toggle="yes">P</italic><sub>call</sub>, with 0.9 as the default.</p>
    </sec>
    <sec id="iyad055-s1.5">
      <title>Estimation of allele read biases and mismapping rates</title>
      <p>GBScleanR requires 4 parameters E<sup>d</sup>, <inline-formula><mml:math id="IM119" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="IM120" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula>, and <inline-formula><mml:math id="IM121" display="inline" overflow="scroll"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula>. The expected genetic distance per megabase pair E<sup>d</sup> and sequencing error rate <inline-formula><mml:math id="IM122" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> take a single positive number that should arbitrarily be specified as input parameters, while the mismapping rates <inline-formula><mml:math id="IM123" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> and the allele read biases <inline-formula><mml:math id="IM124" display="inline" overflow="scroll"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> can be estimated via iterative parameter optimization (IPO). IPO is achieved by repeating the genotype estimation step and the parameter estimation step using the estimated genotype data. For the first cycle of the genotype estimation, <inline-formula><mml:math id="IM125" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="IM126" display="inline" overflow="scroll"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> are initialized to <inline-formula><mml:math id="IM127" display="inline" overflow="scroll"><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0.005</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>0.005</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and 0.5 for all markers, respectively. Thus, the first iteration does not consider marker-specific allele read biases and mismapping rates. The parameter estimation proceeds as described below. With the estimated genotypes from the first cycle, we can obtain the number of allele reads for each estimated genotype. Let <inline-formula><mml:math id="IM128" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="IM129" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> be the number of reference reads and alternative reads at marker <italic toggle="yes">m</italic> in sample <italic toggle="yes">i</italic>, including both offspring and founders. The allele read bias at marker <italic toggle="yes">m</italic> is estimated by the following:</p>
      <disp-formula id="UM0025">
        <mml:math id="UM25" display="block" overflow="scroll">
          <mml:msub>
            <mml:mi>w</mml:mi>
            <mml:mi>m</mml:mi>
          </mml:msub>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>E</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">ref</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>E</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">ref</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:msubsup>
                    <mml:mi>E</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">alt</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0026">
        <mml:math id="UM26" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>E</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">ref</mml:mi>
              </mml:mrow>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>r</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">ref</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msubsup>
                    <mml:mi>r</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">ref</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mi>m</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mi>m</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0027">
        <mml:math id="UM27" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>E</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">alt</mml:mi>
              </mml:mrow>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>r</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">alt</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>2</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msubsup>
                    <mml:mi>r</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">alt</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mi>m</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>2</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mi>m</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0028">
        <mml:math id="UM28" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>r</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">x</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mi>g</mml:mi>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mi>x</mml:mi>
            </mml:msubsup>
            <mml:mi>δ</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mi>x</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mspace width="0.25em"/>
              <mml:mo>=</mml:mo>
              <mml:mspace width="0.25em"/>
              <mml:mi>g</mml:mi>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>,</mml:mo>
          <mml:mrow>
            <mml:mspace width="0.25em"/>
            <mml:mi mathvariant="normal">x</mml:mi>
          </mml:mrow>
          <mml:mo>∈</mml:mo>
          <mml:mo fence="false" stretchy="false">{</mml:mo>
          <mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">ref</mml:mi>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:mspace width="0.25em"/>
              <mml:mi mathvariant="normal">alt</mml:mi>
            </mml:mrow>
          </mml:mrow>
          <mml:mo fence="false" stretchy="false">}</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0029">
        <mml:math id="UM29" display="block" overflow="scroll">
          <mml:msub>
            <mml:mi>n</mml:mi>
            <mml:mi>m</mml:mi>
          </mml:msub>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mi>g</mml:mi>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msup>
            <mml:mn>2</mml:mn>
            <mml:mrow>
              <mml:mi>δ</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:mi>g</mml:mi>
                <mml:mo>≠</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
          </mml:msup>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:mi>δ</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mi>x</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mspace width="0.25em"/>
              <mml:mo>=</mml:mo>
              <mml:mspace width="0.25em"/>
              <mml:mi>g</mml:mi>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <italic toggle="yes">g</italic> is 0, 1, or 2 and indicates the genotype, <inline-formula><mml:math id="IM130" display="inline" overflow="scroll"><mml:msubsup><mml:mi>E</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> represents the expected number of reference allele reads observed if 1 reference allele is on the chromosome, and <inline-formula><mml:math id="IM131" display="inline" overflow="scroll"><mml:msubsup><mml:mi>E</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> represents the expected number of alternative allele reads if 1 alternative allele is on the chromosome. On the other hand, the mismapping rate at marker <italic toggle="yes">m</italic> can be obtained by calculating</p>
      <disp-formula id="UM0030">
        <mml:math id="UM30" display="block" overflow="scroll">
          <mml:msup>
            <mml:mi>e</mml:mi>
            <mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">ref</mml:mi>
              </mml:mrow>
            </mml:mrow>
          </mml:msup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo movablelimits="false">∑</mml:mo>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mspace width="0.2em"/>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mrow>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>y</mml:mi>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">o</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mrow>
                          <mml:mo fence="false" stretchy="false">|</mml:mo>
                        </mml:mrow>
                        <mml:msubsup>
                          <mml:mi>x</mml:mi>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">′</mml:mi>
                            <mml:mi mathvariant="normal">o</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mspace width="0.25em"/>
                        <mml:mo>=</mml:mo>
                        <mml:mspace width="0.25em"/>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:msup>
                          <mml:mi>e</mml:mi>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">seq</mml:mi>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mi>w</mml:mi>
                          <mml:mi>m</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>&gt;</mml:mo>
                      <mml:mn>0.99</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">o</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mspace width="0.25em"/>
                      <mml:mo>=</mml:mo>
                      <mml:mspace width="0.25em"/>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">]</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo movablelimits="false">∑</mml:mo>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mspace width="0.2em"/>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mrow>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">o</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mspace width="0.25em"/>
                      <mml:mo>=</mml:mo>
                      <mml:mspace width="0.25em"/>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">]</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0031">
        <mml:math id="UM31" display="block" overflow="scroll">
          <mml:msup>
            <mml:mi>e</mml:mi>
            <mml:mrow>
              <mml:mi>a</mml:mi>
              <mml:mi>l</mml:mi>
              <mml:mi>t</mml:mi>
            </mml:mrow>
          </mml:msup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo movablelimits="false">∑</mml:mo>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mspace width="0.2em"/>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mrow>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>y</mml:mi>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">o</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mrow>
                          <mml:mo fence="false" stretchy="false">|</mml:mo>
                        </mml:mrow>
                        <mml:msubsup>
                          <mml:mi>x</mml:mi>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">′</mml:mi>
                            <mml:mi mathvariant="normal">o</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mspace width="0.25em"/>
                        <mml:mo>=</mml:mo>
                        <mml:mspace width="0.25em"/>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:msup>
                          <mml:mi>e</mml:mi>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">seq</mml:mi>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mi>w</mml:mi>
                          <mml:mi>m</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>&gt;</mml:mo>
                      <mml:mn>0.99</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">o</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mspace width="0.25em"/>
                      <mml:mo>=</mml:mo>
                      <mml:mspace width="0.25em"/>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">]</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo movablelimits="false">∑</mml:mo>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mspace width="0.2em"/>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mrow>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">o</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mspace width="0.25em"/>
                      <mml:mo>=</mml:mo>
                      <mml:mspace width="0.25em"/>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">]</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM132" display="inline" overflow="scroll"><mml:mi>δ</mml:mi></mml:math></inline-formula> is an indicator function that is equal to 1 if the argument is true and 0 if it is false. <inline-formula><mml:math id="IM133" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the genotype probability to call a heterozygote and can be obtained as described in the <italic toggle="yes">Emission probability</italic> section. We counted the number of mismapping-induced erroneous genotype calls at which the genotype probability to be heterozygous based on the observed reads is more than 0.99 but the estimated genotype via the HMM is homozygous. The rates of those erroneous heterozygous calls at HMM-estimated homozygous calls are assumed to represent the mismapping rates at markers.</p>
    </sec>
    <sec id="iyad055-s1.6">
      <title>Preparation of real data</title>
      <p>As real data, we used the genotype data obtained from the <italic toggle="yes">F</italic><sub>2</sub> population that has been derived from a cross between <italic toggle="yes">Oryza sativa</italic> and <italic toggle="yes">Oryza longistaminata</italic> and reported in the previous study (<xref rid="iyad055-B10" ref-type="bibr">Furuta <italic toggle="yes">et al.</italic> 2017</xref>). In brief, GBS was performed with a <italic toggle="yes">Kpn</italic>I–<italic toggle="yes">Msp</italic>I restriction enzyme pair using MiSeq with 75-bp paired-end sequencing and generated an average of <inline-formula><mml:math id="IM134" display="inline" overflow="scroll"><mml:mn>134</mml:mn><mml:mo>,</mml:mo><mml:mn>447</mml:mn><mml:mo>±</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>788</mml:mn></mml:math></inline-formula> reads per sample. We obtained a total of 2,539,459 and 3,481,218 reads for <italic toggle="yes">O. sativa</italic> and <italic toggle="yes">O. longistaminata</italic> from the independent runs, respectively. The obtained reads were then processed via the TASSEL-GBS pipeline v2 by following the instructions in the manual with the default parameters (<ext-link xlink:href="https://bitbucket.org/tasseladmin/tassel-5-source/wiki/Tassel5GBSv2Pipeline" ext-link-type="uri">https://bitbucket.org/tasseladmin/tassel-5-source/wiki/Tassel5GBSv2Pipeline</ext-link>) (<xref rid="iyad055-B12" ref-type="bibr">Glaubitz <italic toggle="yes">et al.</italic> 2014</xref>). The obtained SNP markers were then filtered to retain only those markers that were homozygous in each founder but biallelic between founders. Only the first SNP was selected if multiple SNPs were present within a 75-bp stretch. To filter out the erroneous genotype calls that were caused by overrepresented mismapping reads, read counts were set to 0 for genotype calls at which reads of either allele were mapped more than a threshold. The threshold was set at the 90th percentile of observed read counts at the obtained markers for each allele of each sample. Thus, this filtering was applied to each sample with the sample-specific thresholds for the reference and alternative reads. The resulting genotype data had 5,035 SNP markers for 814 <italic toggle="yes">F</italic><sub>2</sub> individuals with an average read depth of 0.85×.</p>
    </sec>
    <sec id="iyad055-s1.7">
      <title>Generation of simulation data</title>
      <p>The simulation data sets were generated by mimicking the real data of chromosome 7, which showed relatively severe biases (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref>). Each data set was therefore simulated to consist of 620 markers on a diploid chromosome with a physical length of 50 Mb and a genetic length of 2 Morgans. Genotype data sets were simulated for 3 scenarios: a 2-way <italic toggle="yes">F</italic><sub>2</sub> population from inbred founders (homoP2_F2), a 2-way <italic toggle="yes">F</italic><sub>1</sub> population from outbred founders (hetP2_F1), and 8-way recombinant inbred lines (RILs) from inbred founders (homoP8_RIL). For each scenario, we simulated populations that had 10, 100, and 1,000 individuals. The genotype of each individual was simulated as described in the <italic toggle="yes">Genotype data simulation</italic> section of the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>.</p>
      <p>Based on the simulated genotype data, read counts were assigned to each marker of each individual, mimicking the allele read biases observed in the real data. The details are available in the <italic toggle="yes">Read count data simulation</italic> section of the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>. The expected offspring read depths were set to 0.1×, 0.25×, 0.5×, 0.75×, 1×, 2×, 3×, 10×, and 20×. The founder read depth was set to 5× for all data sets because founders are usually sequenced relatively deep even in low-coverage GBS studies. Since a typical genotyping pipeline filters out markers at which no read was observed in either of founders, we allocated at least 1 read to all markers of founders and then allocated the remaining reads (“nonzero” data sets). In addition, we also simulated data sets in which founders have no read at some markers and missing genotypes (“allowzero” data sets). Simulation data sets without assuming any allele read biases and mismapping reads were also generated with the same settings for the other parameters to generate genotype and read count data.</p>
    </sec>
    <sec id="iyad055-s1.8">
      <title>Evaluation of algorithms</title>
      <p>GBScleanR was tested and compared with LB-Impute and magicImpute. The input parameter settings are described in the <italic toggle="yes">Input parameter</italic> section of the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>. Each algorithm was evaluated by calculating the proportions of correctly estimated genotypes (correct call rate), incorrectly estimated genotypes (miscall rate), and missing genotype calls (missing call rate) for each offspring in the simulated data sets. The proportion of correct calls over nonmissing calls was also calculated as estimation accuracy. The means and standard deviations of these values were then obtained for each data set processed by each algorithm. The resultant scores are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 1</xref>. To conduct an evaluation based on the concordance rate for the real data, we first selected relatively reliable genotype calls supported by more than 6 reads at markers that had less than a 20% missing rate and more than a 40% minor allele frequency. The read counts of the selected genotype calls were then set to 0. These masked real data were subjected to genotype estimation. The resultant estimated genotype data were evaluated based on the concordance rate, which is the proportion of estimated genotype calls matching the raw genotype calls at the masked genotype calls. Furthermore, we also calculated the averages of the missing rate, the number of recombinations, and the segregation distortion level in each chromosome. The segregation distortion level at each marker was obtained by dividing the chi-square value, which was calculated based on the assumption of a 1:2:1 genotype ratio for 3 possible genotypes, by the number of nonmissing genotype calls. The segregation distortion level of each chromosome was then obtained by summing up the segregation distortion levels of all markers in each chromosome. To identify recombination breakpoints of genome segments in the estimated genotype data, we searched the markers that showed genotypes switched between adjacent nonmissing markers. The middle points of those markers were considered recombination breakpoints.</p>
      <p>We also compared the running time of the 3 algorithms using the “nonzero” simulation data sets in the homoP2_F2, hetP2_F1, and homoP8_RIL scenarios. GBScleanR that has been implemented in R requires loading genotype data into the R environment and executing functions for genotype estimation step by step, while magicImpute and LB-Impute that were written in Mathematica and Java directly process input files and generate output files. Therefore, the overall process of GBScleanR including data loading, mating design specification, genotype estimation, and output data generation was measured as the running time of GBScleanR. The running time of magicImpute and LB-Impute was measured from the start to the end of the process. All computation was executed on a workstation with an AMD Ryzen Threadripper 2990WX CPU having 32 cores/64 threads and 64 Gb of RAM. Since magicImpute automatically tries to use half the number of threads for parallel computation, we also let GBScleanR use 32 threads for a fair comparison of running time. As LB-Impute does not support parallel computation and the main target of the running time comparison was GBScleanR versus magicImpute, LB-Impute was executed on a single thread.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="iyad055-s2">
    <title>Results</title>
    <sec id="iyad055-s2.1">
      <title>Evaluation using simulation data sets</title>
      <p>We first evaluated the 3 algorithms using the simulation data sets in the homoP2_F2, hetP2_F1, and homoP8_RIL scenarios (<xref rid="iyad055-F1" ref-type="fig">Fig. 1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 1</xref>). The superiority of GBScleanR lies in the IPO in which allele read biases and mismapping rates of markers are iteratively estimated. Thus, we also tested GBScleanR without IPO to demonstrate the effect of IPO on genotype estimation. In the homoP2_F2 scenario, GBScleanR with IPO scored the best correct call rates for almost all data sets (<xref rid="iyad055-F1" ref-type="fig">Fig. 1a–c</xref>). When the simulation data sets were generated without allowance to have no read at any markers in founders (indicated as “nonzero” in <xref rid="iyad055-F1" ref-type="fig">Fig. 1</xref>), LB-Impute showed the highest correct call rates for the data sets with a 0.1× offspring read depth. However, LB-Impute also scored the highest miscall rates for those data sets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 3a–c</xref>). These increases in miscall rates resulted in the reduction of the estimation accuracy that was measured as the proportion of correct calls over nonmissing calls (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4a–c</xref>). A reduction in accuracy was observed in all of the tested algorithms when no reads at some markers were allowed for founders (shown as “allowzero” in <xref rid="iyad055-F1" ref-type="fig">Fig. 1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4</xref>). Nevertheless, GBScleanR was less affected by the markers with 0 reads in founders and outperformed the other algorithms. In addition, GBScleanR with IPO only increased the correct call rate as offspring read depth increased, while the other algorithms showed a plateau at 0.5–20× in the results for the “nonzero” data sets (<xref rid="iyad055-F1" ref-type="fig">Fig. 1a–c</xref>). The difference in the correct call rate between GBScleanR with IPO and the other algorithms reached more than 25 percentage points at maximum in the data with a 20× offspring read depth. On the other hand, the algorithms except for GBScleanR with IPO showed an increase in the miscall rate as the read depth increased (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 3a–c</xref>). The increase in the miscall rate resulted in the reduction of the estimation accuracy as the read depth increased (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4a–c</xref>).</p>
      <fig position="float" id="iyad055-F1" fig-type="figure">
        <label>Fig. 1.</label>
        <caption>
          <p>Offspring genotype estimation accuracies for the simulation data. The plots show correct call rates for the data sets with given read depths for offspring (<italic toggle="yes">x</italic>-axis) in the homoP2_F2 (a–c), hetP2_F1 (d–f), and homoP8_RIL (g–i) scenarios. The rows of the panels indicate the differences in the number of samples in the simulated data, as shown in the strips on the right. Solid lines and dashed lines represent the results for the data sets with (allowzero) or without (nonzero) missing founder reads. “GBSR” and “GBSR_noIPO” represent GBScleanR with and without IPO. “LB” and “Magic” indicate LB-Impute and magicImpute, respectively.</p>
        </caption>
        <graphic xlink:href="iyad055f1" position="float"/>
      </fig>
      <p>Similar to the results in homoP2_F2, GBScleanR showed the best correct call rates in almost all data sets of hetP2_F1, and the difference between the algorithms reached more than 25 percentage points at maximum (<xref rid="iyad055-F1" ref-type="fig">Fig. 1d–f</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4d–f</xref>). Unlike the homoP2_F2 data sets, the genotype estimation accuracy for the hetP2_F1 data sets was highly affected by the number of samples. The increase in the correct call rate between the data sets with 10 and 1,000 samples reached ∼26 percentage points at maximum in the hetP2_F1 data sets with a 3× offspring read depth, whereas the maximum increase in the score in the homoP2_F2 data sets was ∼14 percentage points (<xref rid="sup1" ref-type="supplementary-material">Supplementary Data 1</xref>).</p>
      <p>Unlike the F2 data sets, we could not find any remarkable difference in the accuracy of genotype estimation for the homoP8_RIL data sets (<xref rid="iyad055-F1" ref-type="fig">Fig. 1g–i</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4g–i</xref>). This result seems to have reflected the higher homozygosity in the simulated genotypes. Since the offspring in the homoP8_RIL data sets had homozygotes at almost all markers due to repeated self-fertilization, only the reads of either allele representing the true genotype could be observed at any markers.</p>
      <p>To compare the performance of the algorithms in the cases where no allele read bias and mismapping exist in data, we simulated data sets without assuming allele read bias and mismapping for generating read count data. All 3 algorithms scored almost the same estimation accuracy for the nonerror data sets and did not show any reduction of the accuracy even if read depth increased in any scenarios (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 5</xref> and <xref rid="sup1" ref-type="supplementary-material">Data 2</xref>).</p>
      <p>GBScleanR and magicImpute have been designed to simultaneously estimate the genotypes of both founders and offspring. In addition, both algorithms provide phasing information for the offspring genotypes. As expected from the estimation accuracy for offspring, GBScleanR also outperformed magicImpute in the estimation of founder genotypes and phased offspring genotypes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs. 6 and 7</xref>). The details were described in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Results</xref>.</p>
    </sec>
    <sec id="iyad055-s2.2">
      <title>Less biased estimation by GBScleanR</title>
      <p>We further evaluated the quality of the estimated genotypes by visualizing the estimated genotype ratio at each marker. This visual inspection employed the “nonzero” homoP2_F2 data sets that have 1,000 offspring with offspring read depths at 0.5×, 3×, and 20×. In an <italic toggle="yes">F</italic><sub>2</sub> population derived from inbred parents, we can expect a 1:2:1 genotype ratio in offspring if no segregation distortion occurs. As shown in <xref rid="iyad055-F2" ref-type="fig">Fig. 2</xref>, the estimations by GBScleanR showed 1:2:1 segregation at almost all markers, which nearly completely overlapped with the true genotype ratio throughout the chromosome, except for the data set with 0.5× offspring reads (<xref rid="iyad055-F2" ref-type="fig">Fig. 2a–c</xref>). In addition, miscalls were distributed almost uniformly throughout the entire chromosome, with a very small amount per marker. In contrast, LB-Impute showed severely biased genotype ratios with high miscall rates clustered at several loci on the chromosome (<xref rid="iyad055-F2" ref-type="fig">Fig. 2d–f</xref>). The increase in offspring read depth made biased genotype estimation more severe and increased miscall rates, as also shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 3</xref>. Similar results were observed in the case of magicImpute (<xref rid="iyad055-F2" ref-type="fig">Fig. 2g–i</xref>). Even though fewer miscalls were generated in magicImpute compared to LB-Impute, many regions showed a biased estimation of reference homozygotes particularly in the data set with 0.5× offspring read depth (<xref rid="iyad055-F2" ref-type="fig">Fig. 2g</xref>). The loci showing higher miscall rates overlapped between the plots for LB-Impute and magicImpute. Thus, these miscalls and biased genotype estimations might be caused by error-prone markers. Similar results were observed in the data sets with 10 and 100 offspring (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs. 8 and 9</xref>). Although the true genotypes did not show a 1:2:1 ratio due to the small population size in the data sets with 10 offspring, GBScleanR showed the estimated genotype ratios that highly overlapped with the true ratios (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 8a–c</xref>). These results demonstrated the robustness of genotype estimation by GBScleanR even at error-prone markers.</p>
      <fig position="float" id="iyad055-F2" fig-type="figure">
        <label>Fig. 2.</label>
        <caption>
          <p>Genotype ratios at markers ordered along a simulated chromosome. The plots show genotype ratios calculated from the estimated genotype data for the homoP2_F2 data set with 1,000 offspring and 620 markers with offspring read depths at 0.5×, 3×, and 20× without allowance of no reads in founders. “GBSR” (a–c), “LB” (d–f), and “Magic” (g–i) indicate genotypes estimated by GBScleanR, LB-Impute, and magicImpute, respectively. Proportions of reference homozygous, heterozygous, and alternative homozygous genotypes are represented by green, magenta, and blue lines, respectively. Orange lines indicate miscall rates at markers. True genotype ratios are indicated by transparent lines in the panels for GBScleanR (a–c).</p>
        </caption>
        <graphic xlink:href="iyad055f2" position="float"/>
      </fig>
    </sec>
    <sec id="iyad055-s2.3">
      <title>Evaluation using real data</title>
      <p>We finally evaluated the algorithms using real data containing error-prone markers. First, we measured the concordance rate of the estimated genotype calls using the masked genotype data created from the real data. GBScleanR scored the best concordance rate in all chromosomes except for chromosome 11 in comparison with LB-Impute and magicImpute (<xref rid="iyad055-F3" ref-type="fig">Fig. 3a</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 5</xref>). Relatively large differences were observed in chromosomes 7, 8, and 10, in which GBScleanR scored 10.5, 12.5, and 12.0 percentage points higher concordance rates than magicImpute, respectively. On the other hand, chromosome 5 showed only a 1.7 percentage point difference between GBScleanR and magicImpute. Relatively low concordance rates were observed in the chromosomes with more severe allele read biases, which were chromosomes 7–12, than those in the other chromosomes (<xref rid="iyad055-F3" ref-type="fig">Fig. 3a</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref>).</p>
      <fig position="float" id="iyad055-F3" fig-type="figure">
        <label>Fig. 3.</label>
        <caption>
          <p>Evaluation of genotype estimation accuracy using the real data. a) Concordance rates of true genotype calls and estimated genotype calls at masked genotype calls are shown for each chromosome. The averages of the missing rate (b), the number of recombinations (c), and the segregation distortion level (d) are also visualized as bar plots for each chromosome. Blue, gray, and magenta bars indicate the values of GBScleanR (GBSR), LB-Impute (LB), and magicImpute (Magic), respectively.</p>
        </caption>
        <graphic xlink:href="iyad055f3" position="float"/>
      </fig>
      <p>Even though GBScleanR showed better concordance rates than the others, the genotype concordance does not directly mean higher accuracy because we cannot know the true genotype of the real data, and there is no evidence of whether the genotype calls selected for masking were truly reliable or contained a large number of erroneous genotype calls. To further evaluate the performance of the algorithms, we then calculated the average missing rate and the number of recombinations in each chromosome. In the case of the missing rate, the highest values were scored by magicImpute for all chromosomes, while GBScleanR and LB-Impute showed similar scores in a majority of chromosomes (<xref rid="iyad055-F3" ref-type="fig">Fig. 3b</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 5</xref>). Similar to the concordance rate, chromosomes with more severe allele read biases showed higher missing rates. A clear difference between the algorithms was observed in the number of recombinations (<xref rid="iyad055-F3" ref-type="fig">Fig. 3c</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 5</xref>). LB-Impute always estimated the most frequent recombinations, followed by magicImpute, whereas GBScleanR showed the fewest numbers of recombinations on all chromosomes. To further evaluate the recombination events, we measured the genomic segment lengths between the recombination breakpoints in chromosomes (<xref rid="iyad055-T2" ref-type="table">Table 2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 6</xref>). We found that LB-Impute estimated many more short segments. The genotype data estimated by GBScleanR had 116 and 430 segments in the ranges of 0–1 and 1–2 Mb, respectively (<xref rid="iyad055-T2" ref-type="table">Table 2</xref>). On the other hand, LB-Impute estimated the genotype data with 2,164 and 4,166 segments ranging 0-1 and 1-2 Mb, respectively. The magicImpute algorithm generated fewer short segments than LB-Impute but a larger number than GBScleanR, which were 627 and 1,716, respectively. In addition, GBScleanR, magicImpute, and LB-Impute estimated 14, 235, and 948 segments ranging 0-1 Mb that were heterozygous and flanked by the same homozygous genotypes at both sides, which indicated double crossovers within 1-Mb stretches (<xref rid="iyad055-T2" ref-type="table">Table 2</xref>). The probability of a double crossover within 1 Mb is ∼0.08% when 1 Mb equals 4 cM in an <italic toggle="yes">F</italic><sub>2</sub> population. Thus, the expected number of double crossovers is &lt; 2 in the population with 814 individuals derived from 1,628 gametes. Even though the 14 double crossovers within 1-Mb stretches generated by GBScleanR were too frequent for an ideal <italic toggle="yes">F</italic><sub>2</sub> population, considering the distant cross to generate the given population, these results suggested that GBScleanR estimated more probable and acceptable numbers of recombinations. The excess crossovers over short distances seemed to artificially push up the numbers of recombinations in the estimated genotype data of LB-Impute and magicImpute.</p>
      <table-wrap position="float" id="iyad055-T2">
        <label>Table 2.</label>
        <caption>
          <p>The number of genome segments.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1"/>
              <th colspan="2" align="center" rowspan="1">Segment length</th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1">0–1 Mb</th>
              <th align="center" rowspan="1" colspan="1">1–2 Mb</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="3" colspan="1">Total<italic toggle="yes"><sup><xref rid="iyad055-tblfn1" ref-type="table-fn">a</xref></sup></italic></td>
              <td rowspan="1" colspan="1">GBScleanR</td>
              <td rowspan="1" colspan="1">116</td>
              <td rowspan="1" colspan="1">430</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">magicImpute</td>
              <td rowspan="1" colspan="1">627</td>
              <td rowspan="1" colspan="1">1,716</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">LB-Impute</td>
              <td rowspan="1" colspan="1">2,164</td>
              <td rowspan="1" colspan="1">4,166</td>
            </tr>
            <tr>
              <td rowspan="3" colspan="1">Double crossovers<italic toggle="yes"><sup><xref rid="iyad055-tblfn2" ref-type="table-fn">b</xref></sup></italic></td>
              <td rowspan="1" colspan="1">GBScleanR</td>
              <td rowspan="1" colspan="1">14</td>
              <td rowspan="1" colspan="1">40</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">magicImpute</td>
              <td rowspan="1" colspan="1">235</td>
              <td rowspan="1" colspan="1">558</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">LB-Impute</td>
              <td rowspan="1" colspan="1">948</td>
              <td rowspan="1" colspan="1">1,395</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="iyad055-tblfn1">
            <p>The total number of genome segments that have a same genotype continuously with the length of 0–1 or 1–2 Mb.</p>
          </fn>
          <fn id="iyad055-tblfn2">
            <p>The number of genome segments that have a heterozygous genotype continuously with the length of 0–1 or 1–2 Mb and flanked by homozygous segments of a same allele.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Finally, we measured the segregation distortion level (<xref rid="iyad055-F3" ref-type="fig">Fig. 3d</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 5</xref>). A relatively low distortion level was observed in the genotype data estimated via GBScleanR compared with those estimated by LB-Impute and magicImpute (<xref rid="iyad055-F3" ref-type="fig">Fig. 3d</xref>). Chromosome 1 was the most distorted in the genotype data estimated by GBScleanR, while the other algorithms also showed similar distortion levels in this chromosome. On the other hand, the highest distortion level was observed in chromosome 7 in the cases of LB-Impute and magicImpute (<xref rid="iyad055-F3" ref-type="fig">Fig. 3d</xref>). Unlike chromosome 1, GBScleanR showed a much smaller distortion level that was approximately half of the levels scored by the other algorithms. In contrast, the 3 algorithms all resulted in the mildest distortion in chromosome 3 (<xref rid="iyad055-F3" ref-type="fig">Fig. 3d</xref>). To visually inspect the segregation distortion levels, we created line plots of the estimated genotype ratios for chromosomes 1, 3, and 7 (<xref rid="iyad055-F4" ref-type="fig">Fig. 4</xref>). The line plots indicated that all of the algorithms estimated quite similar genotypes for chromosomes 1 and 3, while clearer differences were observed in the plots for chromosome 7. As fewer markers on chromosomes 1 and 3 showed severe allele read biases, these chromosomes might have fewer error-prone markers (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref>). Therefore, all of the algorithms resulted in similar estimations (<xref rid="iyad055-F4" ref-type="fig">Fig. 4a–f</xref>). Since all algorithms showed similar distortion patterns around 30 Mb of chromosome 1, the distortion on chromosome 1 was likely to be the true genetic characteristic of this population but not due to the misestimation (<xref rid="iyad055-F4" ref-type="fig">Fig. 4a–c</xref>). On the other hand, slight distortions at 5, 10, and 35 Mb of chromosome 3 that were observed in the genotypes estimated by LB-Impute and magicImpute, but not by GBScleanR, might be artifacts produced by biased estimations at error-prone markers (<xref rid="iyad055-F4" ref-type="fig">Fig. 4d–f</xref>). In the case of chromosome 7, LB-Impute and magiImpute obviously failed to estimate the genotypes and produced artificially distorted genotype ratio patterns (<xref rid="iyad055-F4" ref-type="fig">Fig. 4g–i</xref>). In contrast, GBScleanR showed a smooth and less fluctuating change in the genotype ratio, which was an acceptable pattern as the genotype ratio of an <italic toggle="yes">F</italic><sub>2</sub> population, throughout the chromosome, although severe distortion was observed, probably due to the true segregation distortion (<xref rid="iyad055-F4" ref-type="fig">Fig. 4i</xref>). The other chromosomes also exhibited similar results to those observed for chromosomes 1, 3, and 7 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 10</xref>). LB-Impute and magicImpute always resulted in highly biased genotype estimations at many loci and fluctuated genotype ratios throughout the chromosomes. In clear contrast to those results, GBScleanR showed relatively smooth and gradual changes in the genotype ratios throughout the chromosomes. Even though some loci showed distorted genotype ratios, the majority of chromosomal regions had ratios relatively close to 1:2:1 in almost all chromosomes in the GBScleanR results compared with those of the other algorithms. Overall, the performance evaluation on the real data demonstrated the superiority and robustness of GBScleanR against error-prone markers.</p>
      <fig position="float" id="iyad055-F4" fig-type="figure">
        <label>Fig. 4.</label>
        <caption>
          <p>Genotype ratio of estimated offspring genotypes in the real data. Genotype ratios at markers along chromosomes 1 (a–c), 3 (d–f), and 7 (g–i) in the real data are shown as line plots. “LB,” “Magic,” and “GBSR” indicate LB-Impute, magicImpute, and GBScleanR, respectively. Proportions of the reference homozygous, heterozygous, and alternative homozygous genotypes are represented by green, magenta, and blue lines, respectively.</p>
        </caption>
        <graphic xlink:href="iyad055f4" position="float"/>
      </fig>
    </sec>
    <sec id="iyad055-s2.4">
      <title>Effect of the iterative optimization for allele read biases and mismapping rates</title>
      <p>In addition to demonstrating the superiority of GBScleanR, we tested the effect of IPO on genotype estimation by switching on and off the iterative calculations for either or both of allele read biases and mismapping rates. As already shown, GBScleanR with no IPO (noIPO) led to a reduction in the estimation accuracy for the simulation data sets of homoP2_F2 and hetP2_F1 compared with GBScleanR with IPO (withIPO) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F1" ref-type="fig">1</xref>). On the other hand, when only the iterative optimization for the marker-specific mismapping rate was turned off (fixMismap), no remarkable difference was observed. Interestingly, only turning off the iterative optimization of marker-specific allele read bias (fixBias) resulted in even worse accuracy than noIPO. The reduction of accuracy by the fixBias setting might be caused by misestimation of the mismapping rates that were inferred based on genotype data containing miscalls generated due to the assumption of the fixed allele read bias. Similar to the comparison between GBScleanR and magicImpute, the homoP8_RIL showed no remarkable difference even with or without IPO (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F1" ref-type="fig">1</xref>).</p>
      <p>Unlike the cases in the simulation data sets, the real data showed that not only the fixBias and noIPO settings but also the fixMismap setting might result in less accurate estimation (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F2" ref-type="fig">2</xref> and <xref rid="sup1" ref-type="supplementary-material">Data 7</xref>). Although we cannot know the true genotype of the real data, the fixMismap showed lesser smooth lines in the plots and more severe genotype distortions than the withIPO setting (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F2" ref-type="fig">2</xref>). All of the metrics including the concordance rate and the recombination rate indicated the superiority of the withIPO setting over the other settings (<xref rid="sup1" ref-type="supplementary-material">Supplementary Data 7</xref>). These results indicated that the real data may have a nonrandom pattern of the mismapping-prone marker distribution, and the iterative optimizations for both allele read biases and mismapping rates are required for proper genotype estimation. GBScleanR with IPO showed robustness against both types of errors.</p>
    </sec>
    <sec id="iyad055-s2.5">
      <title>Comparing running time</title>
      <p>We also compared running times using the simulation data sets. As shown in <xref rid="iyad055-T3" ref-type="table">Table 3</xref>, GBScleanR completed all processes of genotype estimation faster than LB-Impute and magicImpute for the simulation data sets of biparental populations, including homoP2_F2 and hetP2_F1. In the case of the largest homoP2_F2 data set that consists of 1,000 samples, GBScleanR took only 17 s even with 4 cycles of IPO, while magicImpute and LB-Impute consumed 6.4 and 122.7 times as long. On the other hand, a 2.1-times longer calculation at the maximum was observed in GBScleanR with 4 cycles of IPO compared to magicImpute for the homoP8_RIL data sets (<xref rid="iyad055-T3" ref-type="table">Table 3</xref>). Nevertheless, IPO was not required for RIL populations, as shown in <xref rid="iyad055-F1" ref-type="fig">Fig. 1</xref>, and GBScleanR without IPO could finish the calculations 48% faster than magicImpute even in the homoP8_RIL data set with 1,000 samples.</p>
      <table-wrap position="float" id="iyad055-T3">
        <label>Table 3.</label>
        <caption>
          <p>Running time.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Data set</th>
              <th align="center" rowspan="1" colspan="1">No. of samples</th>
              <th align="center" rowspan="1" colspan="1">GBScleanR<italic toggle="yes"><sup><xref rid="iyad055-tblfn4" ref-type="table-fn">a</xref></sup></italic></th>
              <th align="center" rowspan="1" colspan="1">magicImpute</th>
              <th align="center" rowspan="1" colspan="1">LB-Impute</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">homoP2_F2</td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">2 (1)</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">23</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">homoP2_F2</td>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">3 (1)</td>
              <td rowspan="1" colspan="1">14</td>
              <td rowspan="1" colspan="1">211</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">homoP2_F2</td>
              <td rowspan="1" colspan="1">1,000</td>
              <td rowspan="1" colspan="1">17 (8)</td>
              <td rowspan="1" colspan="1">108</td>
              <td rowspan="1" colspan="1">2,086</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">hetP2_F1</td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">4 (2)</td>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">hetP2_F1</td>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">11 (4)</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">hetP2_F1</td>
              <td rowspan="1" colspan="1">1,000</td>
              <td rowspan="1" colspan="1">81 (24)</td>
              <td rowspan="1" colspan="1">170</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">homoP8_RIL</td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">36 (9)</td>
              <td rowspan="1" colspan="1">98</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">homoP8_RIL</td>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">205 (50)</td>
              <td rowspan="1" colspan="1">336</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">homoP8_RIL</td>
              <td rowspan="1" colspan="1">1,000</td>
              <td rowspan="1" colspan="1">1,736 (432)</td>
              <td rowspan="1" colspan="1">829</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="iyad055-tblfn3">
            <p>Running times in seconds for each data set are shown.</p>
          </fn>
          <fn id="iyad055-tblfn4">
            <p>The numbers in parenthesis indicate the running times of GBScleanR without the IPO.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="discussion" id="iyad055-s3">
    <title>Discussion</title>
    <p>GBScleanR is an R package and consists of a main tool that conducts error correction and utility functions that handle genotype data in the variant call format (VCF). <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 13</xref> presents the data analysis workflow and the related functions that are implemented in GBScleanR. The algorithm is designed to estimate the true genotype calls along chromosomes from the given allele read counts in a VCF file that is generated by SNP callers such as GATK and TASSEL-GBS (<xref rid="iyad055-B19" ref-type="bibr">McKenna <italic toggle="yes">et al.</italic> 2010</xref>; <xref rid="iyad055-B12" ref-type="bibr">Glaubitz <italic toggle="yes">et al.</italic> 2014</xref>). The current implementation supports genotypic data for mapping populations that are derived from 2 or more diploid founders followed by selfings, sibling crosses, or random crosses, for example, <italic toggle="yes">F</italic><sub>2</sub>- and 8-way RILs. Our method assumes that markers are biallelic and ordered along the chromosomes and the reads are mapped onto a reference genome sequence. To access the large amounts of genotype data required, an input VCF file is first converted into a genomic data structure (GDS) file (<xref rid="iyad055-B33" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2012</xref>). This conversion automatically filters out nonbiallelic markers. GBScleanR provides functions for data visualization, filtering, and loading/writing a VCF file. Furthermore, the data structure of the GDS file created via this package is compatible with that used in the SeqArray package and can be further converted to a derivative GDS format used in the SNPRelate, GWASTools, and GENESIS packages, which are designed to handle large amounts of variant data and conduct regression analysis (<xref rid="iyad055-B13" ref-type="bibr">Gogarten <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="iyad055-B14" ref-type="bibr">2019</xref>; <xref rid="iyad055-B33" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="iyad055-B32" ref-type="bibr">2017</xref>). Therefore, GBScleanR can be built in a pipeline for a genetic study that allows us smooth access to the given large genotype data for visualization, filtering, error correction, and regression analysis without the requirement for extra data format conversion steps.</p>
    <p>The present study introduced an algorithm to provide robust error correction on genotype data with error-prone markers. Any genotype data derived from GBS or other RRS-based genotyping techniques have the chance to contain such error-prone markers even after trying to filter out erroneous markers. Particularly, a population derived from a cross between distant relatives, as in our case in which a cultivated rice <italic toggle="yes">O. sativa</italic> and a wild rice <italic toggle="yes">O. longistaminata</italic> were crossed, may potentially have a relatively high proportion of error-prone markers. If a model uniformly assumes a 50% chance of obtaining a read for either allele for all markers at a heterozygous site, any HMM-based methods and sliding window methods can theoretically be deceived by the error-prone markers. In addition, erroneous genotype calls induced by mismapping easily mess up genotype data and lead to unexpected detection of heterozygous genotypes and overrepresented recombination events. Since we could not distinguish which reads were mismapped reads in the real data and had no clue to estimate the true pattern of mismappings, we assumed a random distribution of mismapping-prone markers in the data simulation. Those randomly distributed mismapping-prone markers did not show any remarkable effect on the estimation accuracy even with the fixMismap setting (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F1" ref-type="fig">1</xref>). On the other hand, mimicked marker-specific allele read biases caused the reduction in the estimation accuracy with the fixBias and noIPO settings (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F1" ref-type="fig">1</xref>). However, the fixMismap setting resulted in less reliable genotype estimation than the withIPO setting for the real data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F2" ref-type="fig">2</xref> and <xref rid="sup1" ref-type="supplementary-material">Data 7</xref>). These results indicate that real data seem to have a specific pattern of error-prone marker distribution that interferes with proper genotype estimation. The distribution of error-prone markers would be different between given populations and affected by actual biological variations that exist in given genomes. Our study indicated the importance to incorporate marker-specific error patterns in the HMM for accurate genotype estimation and demonstrated the superiority and robustness of GBScleanR. The distortion level and the recombination frequency have large effects on downstream genetic analyses, and those values themselves are research targets. Any genetic and genomic study relies on the given genotype data, and the accuracy of genotyping has a crucial effect on the quality of such research. The accuracy of genotyping can be evaluated by 3 criteria: correct calls, miscalls, and missing calls. Usually, miscalls have a more destructive effect on post-genotyping analyses than missing calls because post-genotyping analyses regularly suppose all genotype calls to be true even if those include miscalls and potentially generate misleading results. Furthermore, if the wrongly genotyped markers are clustered in a particular region, all statistical calculations for that region will be unreliable. Our study also demonstrated the reliability of GBScleanR as a support tool for genetic studies that handle genotype data even with or without error-prone markers.</p>
    <p>In this study, we conducted filtering based on a quantile of read counts for the real data to filter out genotype calls supported by overrepresented sequences that are possibly derived from paralogous and repetitive sequences. A large number of overrepresented mismapped reads do not increase the reliability of genotype calls but rather cause misestimation of homozygotes as heterozygotes. Although GBScleanR tries to detect mismapped reads, we recommend filtering out overrepresented reads to reduce their negative impact on estimation. Nevertheless, GBScleanR accepts error-prone markers and recognizes the error pattern via IPO. Therefore, no strict filtering based on allele frequency and the missing rate is required, which is regularly performed for RRS-based genotyping data (<xref rid="iyad055-B16" ref-type="bibr">Kim <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyad055-B26" ref-type="bibr">Scheben <italic toggle="yes">et al.</italic> 2017</xref>). These filtering steps usually remove a large number of the detected SNP markers (<xref rid="iyad055-B11" ref-type="bibr">Gardner <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="iyad055-B22" ref-type="bibr">Pootakham <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="iyad055-B5" ref-type="bibr">Celik <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyad055-B3" ref-type="bibr">Boyles <italic toggle="yes">et al.</italic> 2017</xref>). In the case of our real data, filtering to remove possible error-prone markers based on, for example, minor allele frequency &lt;5% and missing rate &gt;20%, left only 162 out of 5,035 SNPs. Markers that would be filtered out may contain partial information about the true genotypes. GBScleanR can integrate those less informative markers into the error correction process by tweaking the HMM. Since there is no clear guideline for filtering strength, which should differ depending on the data set used, filtering criteria are left in the hands of researchers. GBScleanR allows users to skip such an arbitrary step and improves the cost efficiency of the RRS-based genotyping system by reducing the number of unused reads obtained via costly NGS.</p>
    <p>As GBScleanR requires the SNP markers ordered along chromosomes, reference genome sequences are a fundamental resource. The recent remarkable development of the third-generation sequencers, named Sequel by Pacific Bioscience and MinION by Oxford Nanopore Technologies, enables us to obtain high-quality genome sequences at a reasonable cost (<xref rid="iyad055-B24" ref-type="bibr">Rhoads and Au 2015</xref>; <xref rid="iyad055-B18" ref-type="bibr">Lu <italic toggle="yes">et al.</italic> 2016</xref>). Reference genome information for any organism is expected to become available soon. Thus, RRS-based genotyping systems underpinned by a flexible robust error correction tool such as GBScleanR will become practical platforms for use in breeding programs requiring a prompt and efficient scheme under limited periods and budgets. Distant relatives, including the ancestral wild species of domesticated species, are important genetic resources, particularly in plant breeding, that can improve abiotic and biotic stress resistance (<xref rid="iyad055-B1" ref-type="bibr">Atwell <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="iyad055-B17" ref-type="bibr">Kole <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="iyad055-B4" ref-type="bibr">Brozynska <italic toggle="yes">et al.</italic> 2016</xref>). For such genetic studies and breeding projects using wild species, GBScleanR could be the first choice as a fundamental tool for genotype identification coupled with an RRS-based genotyping system.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>iyad055_Supplementary_Data</label>
      <media xlink:href="iyad055_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec sec-type="data-availability" id="iyad055-s4">
    <title>Data availability</title>
    <p>The stable version of GBScleanR is available on Bioconductor (<ext-link xlink:href="https://bioconductor.org/packages/GBScleanR/" ext-link-type="uri">https://bioconductor.org/packages/GBScleanR/</ext-link>). The latest developmental version is available on GitHub (<ext-link xlink:href="https://github.com/tomoyukif/GBScleanR" ext-link-type="uri">https://github.com/tomoyukif/GBScleanR</ext-link>). This package and the source code are distributed under GNU General Public License version 3. The vcf file of the real data and R scripts for the data analyses performed in this study are also available on GitHub (<ext-link xlink:href="https://github.com/tomoyukif/GBSR_SupFiles" ext-link-type="uri">https://github.com/tomoyukif/GBSR_SupFiles</ext-link>). Further description of the sequencing reads for the real data can be found in <xref rid="iyad055-B10" ref-type="bibr">Furuta <italic toggle="yes">et al.</italic> (2017)</xref>.</p>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplemental material</xref> available at <italic toggle="yes">GENETICS</italic> online.</p>
  </sec>
  <sec id="iyad055-s5">
    <title>Funding</title>
    <p>This work was supported by the CREST program of the Japan Science and Technology Agency (JPMJCR13B1 to M.A.); the SATREPS program in collaboration with the Japan Science and Technology Agency and the Japan International Cooperation Agency (JPMJSA1706 to T.F. and M.A.); KAKENHI of the Ministry of Education, Culture, Sports, Science and Technology of Japan (JP20H05912 to M.A.); and KAKENHI of Japan Society for the Promotion of Science (JP20K15503 to T.F. and JP20H02958 to T.Y.).</p>
  </sec>
  <sec sec-type="COI-statement" id="iyad055-s6">
    <title>Conflicts of interest statement</title>
    <p>The author(s) declare no conflict of interest.</p>
  </sec>
  <sec id="iyad055-s7">
    <title>Author contributions</title>
    <p>T.F. conceived and designed the study. T.F. also developed the R package, conducted bioinformatics analysis, and drafted the manuscript. M.A. and T.Y. supervised the study. All authors read and approved the final version of the manuscript.</p>
  </sec>
  <ref-list id="ref1">
    <title>Literature cited</title>
    <ref id="iyad055-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Atwell</surname><given-names>BJ</given-names></string-name>, <string-name><surname>Wang</surname><given-names>H</given-names></string-name>, <string-name><surname>Scafaro</surname><given-names>AP</given-names></string-name></person-group>. <article-title>Could abiotic stress tolerance in wild relatives of rice be used to improve <italic toggle="yes">Oryza sativa</italic>?</article-title><source>Plant Sci</source>. <year>2014</year>;<volume>215–216</volume>:<fpage>48</fpage>–<lpage>58</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.plantsci.2013.10.007</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baird</surname><given-names>NA</given-names></string-name>, <string-name><surname>Etter</surname><given-names>PD</given-names></string-name>, <string-name><surname>Atwood</surname><given-names>TS</given-names></string-name>, <string-name><surname>Currey</surname><given-names>MC</given-names></string-name>, <string-name><surname>Shiver</surname><given-names>AL</given-names></string-name>, <string-name><surname>Lewis</surname><given-names>ZA</given-names></string-name>, <string-name><surname>Selker</surname><given-names>EU</given-names></string-name>, <string-name><surname>Cresko</surname><given-names>WA</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>EA</given-names></string-name></person-group>. <article-title>Rapid SNP discovery and genetic mapping using sequenced RAD markers</article-title>. <source>PLoS One</source><year>2008</year>;<volume>3</volume>(<issue>10</issue>):<comment>e3376</comment>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0003376</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boyles</surname><given-names>RE</given-names></string-name>, <string-name><surname>Pfeiffer</surname><given-names>BK</given-names></string-name>, <string-name><surname>Cooper</surname><given-names>EA</given-names></string-name>, <string-name><surname>Zielinski</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Myers</surname><given-names>MT</given-names></string-name>, <string-name><surname>Rooney</surname><given-names>WL</given-names></string-name>, <string-name><surname>Kresovich</surname><given-names>S</given-names></string-name></person-group>. <article-title>Quantitative trait loci mapping of agronomic and yield traits in two grain Sorghum biparental families</article-title>. <source>Crop Sci</source>. <year>2017</year>;<volume>57</volume>(<issue>5</issue>):<fpage>2443</fpage>–<lpage>2456</lpage>. doi:<pub-id pub-id-type="doi">10.2135/cropsci2016.12.0988</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brozynska</surname><given-names>M</given-names></string-name>, <string-name><surname>Furtado</surname><given-names>A</given-names></string-name>, <string-name><surname>Henry</surname><given-names>RJ</given-names></string-name></person-group>. <article-title>Genomics of crop wild relatives: expanding the gene pool for crop improvement</article-title>. <source>Plant Biotechnol J</source>. <year>2016</year>;<volume>14</volume>(<issue>4</issue>):<fpage>1070</fpage>–<lpage>1085</lpage>. doi:<pub-id pub-id-type="doi">10.1111/pbi.12454</pub-id>.<pub-id pub-id-type="pmid">26311018</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Celik</surname><given-names>I</given-names></string-name>, <string-name><surname>Bodur</surname><given-names>S</given-names></string-name>, <string-name><surname>Frary</surname><given-names>A</given-names></string-name>, <string-name><surname>Doganlar</surname><given-names>S</given-names></string-name></person-group>. <article-title>Genome-wide SNP discovery and genetic linkage map construction in sunflower (<italic toggle="yes">Helianthus annuus</italic> L.) using a genotyping by sequencing (GBS) approach</article-title>. <source>Mol Breeding</source><year>2016</year>;<volume>36</volume>(<issue>9</issue>):<fpage>1</fpage>–<lpage>9</lpage>. doi:<pub-id pub-id-type="doi">10.1007/s11032-016-0558-8</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DaCosta</surname><given-names>JM</given-names></string-name>, <string-name><surname>Sorenson</surname><given-names>MD</given-names></string-name></person-group>. <article-title>Amplification biases and consistent recovery of loci in a double-digest RAD-seq protocol</article-title>. <source>PLoS One</source><year>2014</year>;<volume>9</volume>(<issue>9</issue>):<comment>e106713</comment>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0106713</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davey</surname><given-names>JW</given-names></string-name>, <string-name><surname>Cezard</surname><given-names>T</given-names></string-name>, <string-name><surname>Fuentes-Utrilla</surname><given-names>P</given-names></string-name>, <string-name><surname>Eland</surname><given-names>C</given-names></string-name>, <string-name><surname>Gharbi</surname><given-names>K</given-names></string-name>, <string-name><surname>Blaxter</surname><given-names>ML</given-names></string-name></person-group>. <article-title>Special features of RAD sequencing data: implications for genotyping</article-title>. <source>Mol Ecol</source>. <year>2013</year>;<volume>22</volume>(<issue>11</issue>):<fpage>3151</fpage>–<lpage>3164</lpage>. doi:<pub-id pub-id-type="doi">10.1111/mec.12084</pub-id>.<pub-id pub-id-type="pmid">23110438</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elshire</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Glaubitz</surname><given-names>JC</given-names></string-name>, <string-name><surname>Sun</surname><given-names>Q</given-names></string-name>, <string-name><surname>Poland</surname><given-names>JA</given-names></string-name>, <string-name><surname>Kawamoto</surname><given-names>K</given-names></string-name>, <string-name><surname>Buckler</surname><given-names>ES</given-names></string-name>, <string-name><surname>Mitchell</surname><given-names>SE</given-names></string-name></person-group>. <article-title>A robust, simple genotyping-by-sequencing (GBS) approach for high diversity species</article-title>. <source>PLoS One</source><year>2011</year>;<volume>6</volume>(<issue>5</issue>):<comment>e19379</comment>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0019379</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fragoso</surname><given-names>CA</given-names></string-name>, <string-name><surname>Heffelfinger</surname><given-names>C</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>H</given-names></string-name>, <string-name><surname>Dellaporta</surname><given-names>SL</given-names></string-name></person-group>. <article-title>Imputing genotypes in biallelic populations from low-coverage sequence data</article-title>. <source>Genetics</source><year>2016</year>;<volume>202</volume>(<issue>2</issue>):<fpage>487</fpage>–<lpage>495</lpage>. doi:<pub-id pub-id-type="doi">10.1534/genetics.115.182071</pub-id>.<pub-id pub-id-type="pmid">26715670</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Furuta</surname><given-names>T</given-names></string-name>, <string-name><surname>Ashikari</surname><given-names>M</given-names></string-name>, <string-name><surname>Jena</surname><given-names>KK</given-names></string-name>, <string-name><surname>Doi</surname><given-names>K</given-names></string-name>, <string-name><surname>Reuscher</surname><given-names>S</given-names></string-name></person-group>. <article-title>Adapting genotyping-by-sequencing for rice F2 populations</article-title>. <source>G3 (Bethesda)</source><year>2017</year>;<volume>7</volume>(<issue>3</issue>):<fpage>881</fpage>–<lpage>893</lpage>. doi:<pub-id pub-id-type="doi">10.1534/g3.116.038190</pub-id>.<pub-id pub-id-type="pmid">28082325</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gardner</surname><given-names>KM</given-names></string-name>, <string-name><surname>Brown</surname><given-names>P</given-names></string-name>, <string-name><surname>Cooke</surname><given-names>TF</given-names></string-name>, <string-name><surname>Cann</surname><given-names>S</given-names></string-name>, <string-name><surname>Costa</surname><given-names>F</given-names></string-name>, <string-name><surname>Bustamante</surname><given-names>C</given-names></string-name>, <string-name><surname>Velasco</surname><given-names>R</given-names></string-name>, <string-name><surname>Troggio</surname><given-names>M</given-names></string-name>, <string-name><surname>Myles</surname><given-names>S</given-names></string-name></person-group>. <article-title>Fast and cost-effective genetic mapping in apple using next-generation sequencing</article-title>. <source>G3 (Bethesda)</source><year>2014</year>;<volume>4</volume>(<issue>9</issue>):<fpage>1681</fpage>–<lpage>1687</lpage>. doi:<pub-id pub-id-type="doi">10.1534/g3.114.011023</pub-id>.<pub-id pub-id-type="pmid">25031181</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Glaubitz</surname><given-names>JC</given-names></string-name>, <string-name><surname>Casstevens</surname><given-names>TM</given-names></string-name>, <string-name><surname>Lu</surname><given-names>F</given-names></string-name>, <string-name><surname>Harriman</surname><given-names>J</given-names></string-name>, <string-name><surname>Elshire</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Sun</surname><given-names>Q</given-names></string-name>, <string-name><surname>Buckler</surname><given-names>ES</given-names></string-name></person-group>. <article-title>TASSEL-GBS: a high capacity genotyping by sequencing analysis pipeline</article-title>. <source>PLoS One</source><year>2014</year>;<volume>9</volume>(<issue>2</issue>):<comment>e90346</comment>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0090346</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gogarten</surname><given-names>SM</given-names></string-name>, <string-name><surname>Bhangale</surname><given-names>T</given-names></string-name>, <string-name><surname>Conomos</surname><given-names>MP</given-names></string-name>, <string-name><surname>Laurie</surname><given-names>CA</given-names></string-name>, <string-name><surname>McHugh</surname><given-names>CP</given-names></string-name>, <string-name><surname>Painter</surname><given-names>I</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name><surname>Crosslin</surname><given-names>DR</given-names></string-name>, <string-name><surname>Levine</surname><given-names>D</given-names></string-name>, <string-name><surname>Lumley</surname><given-names>T</given-names></string-name>, <etal>et al</etal></person-group><article-title>GWASTools: an R/Bioconductor package for quality control and analysis of genome-wide association studies</article-title>. <source>Bioinformatics</source><year>2012</year>;<volume>28</volume>(<issue>24</issue>):<fpage>3329</fpage>–<lpage>3331</lpage>. doi:<pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTS610</pub-id>.<pub-id pub-id-type="pmid">23052040</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gogarten</surname><given-names>SM</given-names></string-name>, <string-name><surname>Sofer</surname><given-names>T</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H</given-names></string-name>, <string-name><surname>Yu</surname><given-names>C</given-names></string-name>, <string-name><surname>Brody</surname><given-names>JA</given-names></string-name>, <string-name><surname>Thornton</surname><given-names>TA</given-names></string-name>, <string-name><surname>Rice</surname><given-names>KM</given-names></string-name>, <string-name><surname>Conomos</surname><given-names>MP</given-names></string-name></person-group>. <article-title>Genetic association testing using the GENESIS R/Bioconductor package</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>(<issue>24</issue>):<fpage>5346</fpage>–<lpage>5348</lpage>. <pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTZ567</pub-id><pub-id pub-id-type="pmid">31329242</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>X</given-names></string-name>, <string-name><surname>Feng</surname><given-names>Q</given-names></string-name>, <string-name><surname>Qian</surname><given-names>Q</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>Q</given-names></string-name>, <string-name><surname>Wang</surname><given-names>L</given-names></string-name>, <string-name><surname>Wang</surname><given-names>A</given-names></string-name>, <string-name><surname>Guan</surname><given-names>J</given-names></string-name>, <string-name><surname>Fan</surname><given-names>D</given-names></string-name>, <string-name><surname>Weng</surname><given-names>Q</given-names></string-name>, <string-name><surname>Huang</surname><given-names>T</given-names></string-name>, <etal>et al</etal></person-group><article-title>High-throughput genotyping by whole-genome resequencing</article-title>. <source>Genome Res</source>. <year>2009</year>;<volume>19</volume>(<issue>6</issue>):<fpage>1068</fpage>–<lpage>1076</lpage>. doi:<pub-id pub-id-type="doi">10.1101/gr.089516.108</pub-id>.<pub-id pub-id-type="pmid">19420380</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>C</given-names></string-name>, <string-name><surname>Guo</surname><given-names>H</given-names></string-name>, <string-name><surname>Kong</surname><given-names>W</given-names></string-name>, <string-name><surname>Chandnani</surname><given-names>R</given-names></string-name>, <string-name><surname>Shuang</surname><given-names>L-S</given-names></string-name>, <string-name><surname>Paterson</surname><given-names>AH</given-names></string-name></person-group>. <article-title>Application of genotyping by sequencing technology to a variety of crop breeding programs</article-title>. <source>Plant Sci</source>. <year>2016</year>;<volume>242</volume>:<fpage>14</fpage>–<lpage>22</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.plantsci.2015.04.016</pub-id>.<pub-id pub-id-type="pmid">26566821</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kole</surname><given-names>C</given-names></string-name>, <string-name><surname>Muthamilarasan</surname><given-names>M</given-names></string-name>, <string-name><surname>Henry</surname><given-names>R</given-names></string-name>, <string-name><surname>Edwards</surname><given-names>D</given-names></string-name>, <string-name><surname>Sharma</surname><given-names>R</given-names></string-name>, <string-name><surname>Abberton</surname><given-names>M</given-names></string-name>, <string-name><surname>Batley</surname><given-names>J</given-names></string-name>, <string-name><surname>Bentley</surname><given-names>A</given-names></string-name>, <string-name><surname>Blakeney</surname><given-names>M</given-names></string-name>, <string-name><surname>Bryant</surname><given-names>J</given-names></string-name>, <etal>et al</etal></person-group><article-title>Application of genomics-assisted breeding for generation of climate resilient crops: progress and prospects</article-title>. <source>Front Plant Sci</source>. <year>2015</year>;<volume>6</volume>:<fpage>563</fpage>. doi:<pub-id pub-id-type="doi">10.3389/fpls.2015.00563</pub-id>.<pub-id pub-id-type="pmid">26322050</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lu</surname><given-names>H</given-names></string-name>, <string-name><surname>Giordano</surname><given-names>F</given-names></string-name>, <string-name><surname>Ning</surname><given-names>Z</given-names></string-name></person-group>. <article-title>Oxford nanopore MinION sequencing and genome assembly</article-title>. <source>Genomics Proteomics Bioinformatics</source><year>2016</year>;<volume>14</volume>(<issue>5</issue>):<fpage>265</fpage>–<lpage>279</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.gpb.2016.05.004</pub-id>.<pub-id pub-id-type="pmid">27646134</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKenna</surname><given-names>A</given-names></string-name>, <string-name><surname>Hanna</surname><given-names>M</given-names></string-name>, <string-name><surname>Banks</surname><given-names>E</given-names></string-name>, <string-name><surname>Sivachenko</surname><given-names>A</given-names></string-name>, <string-name><surname>Cibulskis</surname><given-names>K</given-names></string-name>, <string-name><surname>Kernytsky</surname><given-names>A</given-names></string-name>, <string-name><surname>Garimella</surname><given-names>K</given-names></string-name>, <string-name><surname>Altshuler</surname><given-names>D</given-names></string-name>, <string-name><surname>Gabriel</surname><given-names>S</given-names></string-name>, <string-name><surname>Daly</surname><given-names>M</given-names></string-name>, <etal>et al</etal></person-group><article-title>The genome analysis toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source>. <year>2010</year>;<volume>20</volume>(<issue>9</issue>):<fpage>1297</fpage>–<lpage>1303</lpage>. doi:<pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B20">
      <mixed-citation publication-type="journal">Miao C, Fang J, Li D, Liang P, Zhang X, Yang J, Schnable JC, Tang H. Genotype-Corrector: improved genotype calls for genetic mapping in F2 and RIL populations. Sci Rep. 2018;8(1). doi:<pub-id pub-id-type="doi">10.1038/s41598-018-28294-0</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Poland</surname><given-names>JA</given-names></string-name>, <string-name><surname>Rife</surname><given-names>TW</given-names></string-name></person-group>. <article-title>Genotyping-by-sequencing for plant breeding and genetics</article-title>. <source>Plant Genome</source><year>2012</year>;<volume>5</volume>(<issue>3</issue>):<comment>plantgenome2012.05.0005</comment>. doi:<pub-id pub-id-type="doi">10.3835/plantgenome2012.05.0005</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pootakham</surname><given-names>W</given-names></string-name>, <string-name><surname>Jomchai</surname><given-names>N</given-names></string-name>, <string-name><surname>Ruang-areerate</surname><given-names>P</given-names></string-name>, <string-name><surname>Shearman</surname><given-names>JR</given-names></string-name>, <string-name><surname>Sonthirod</surname><given-names>C</given-names></string-name>, <string-name><surname>Sangsrakru</surname><given-names>D</given-names></string-name>, <string-name><surname>Tragoonrung</surname><given-names>S</given-names></string-name>, <string-name><surname>Tangphatsornruang</surname><given-names>S</given-names></string-name></person-group>. <article-title>Genome-wide SNP discovery and identification of QTL associated with agronomic traits in oil palm using genotyping-by-sequencing (GBS)</article-title>. <source>Genomics</source><year>2015</year>;<volume>105</volume>(<issue>5-6</issue>):<fpage>288</fpage>–<lpage>295</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.ygeno.2015.02.002</pub-id>.<pub-id pub-id-type="pmid">25702931</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rabiner</surname><given-names>LR</given-names></string-name></person-group>. <article-title>A tutorial on hidden Markov models and selected applications in speech recognition</article-title>. <source>Proc IEEE</source>. <year>1989</year>;<volume>77</volume>(<issue>2</issue>):<fpage>257</fpage>–<lpage>286</lpage>. doi:<pub-id pub-id-type="doi">10.1109/5.18626</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rhoads</surname><given-names>A</given-names></string-name>, <string-name><surname>Au</surname><given-names>KF</given-names></string-name></person-group>. <article-title>Pacbio sequencing and its applications</article-title>. <source>Genomics Proteomics Bioinformatics</source><year>2015</year>;<volume>13</volume>(<issue>5</issue>):<fpage>278</fpage>–<lpage>289</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.gpb.2015.08.002</pub-id>.<pub-id pub-id-type="pmid">26542840</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rowan</surname><given-names>BA</given-names></string-name>, <string-name><surname>Patel</surname><given-names>V</given-names></string-name>, <string-name><surname>Weigel</surname><given-names>D</given-names></string-name>, <string-name><surname>Schneeberger</surname><given-names>K</given-names></string-name></person-group>. <article-title>Rapid and inexpensive whole-genome genotyping-by-sequencing for crossover localization and fine-scale genetic mapping</article-title>. <source>G3 (Bethesda)</source><year>2015</year>;<volume>5</volume>(<issue>3</issue>):<fpage>385</fpage>–<lpage>398</lpage>. doi:<pub-id pub-id-type="doi">10.1534/g3.114.016501</pub-id>.<pub-id pub-id-type="pmid">25585881</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scheben</surname><given-names>A</given-names></string-name>, <string-name><surname>Batley</surname><given-names>J</given-names></string-name>, <string-name><surname>Edwards</surname><given-names>D</given-names></string-name></person-group>. <article-title>Genotyping-by-sequencing approaches to characterize crop genomes: choosing the right tool for the right application</article-title>. <source>Plant Biotechnol J</source>. <year>2017</year>;<volume>15</volume>(<issue>2</issue>):<fpage>149</fpage>–<lpage>161</lpage>. doi:<pub-id pub-id-type="doi">10.1111/PBI.12645</pub-id>.<pub-id pub-id-type="pmid">27696619</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Swarts</surname><given-names>K</given-names></string-name>, <string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Romero Navarro</surname><given-names>JA</given-names></string-name>, <string-name><surname>An</surname><given-names>D</given-names></string-name>, <string-name><surname>Romay</surname><given-names>MC</given-names></string-name>, <string-name><surname>Hearne</surname><given-names>S</given-names></string-name>, <string-name><surname>Acharya</surname><given-names>C</given-names></string-name>, <string-name><surname>Glaubitz</surname><given-names>JC</given-names></string-name>, <string-name><surname>Mitchell</surname><given-names>S</given-names></string-name>, <string-name><surname>Elshire</surname><given-names>RJ</given-names></string-name>, <etal>et al</etal></person-group><article-title>Novel methods to optimize genotypic imputation for low-coverage, next-generation sequence data in crop plants</article-title>. <source>Plant Genome</source><year>2014</year>;<volume>7</volume>(<issue>3</issue>):<comment>plantgenome2014.05.0023</comment>. doi:<pub-id pub-id-type="doi">10.3835/plantgenome2014.05.0023</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wijnker</surname><given-names>E</given-names></string-name>, <string-name><surname>James</surname><given-names>GV</given-names></string-name>, <string-name><surname>Ding</surname><given-names>J</given-names></string-name>, <string-name><surname>Becker</surname><given-names>F</given-names></string-name>, <string-name><surname>Klasen</surname><given-names>JR</given-names></string-name>, <string-name><surname>Rawat</surname><given-names>V</given-names></string-name>, <string-name><surname>Rowan</surname><given-names>BA</given-names></string-name>, <string-name><surname>de Jong</surname><given-names>DF</given-names></string-name>, <string-name><surname>de Snoo</surname><given-names>CB</given-names></string-name>, <string-name><surname>Zapata</surname><given-names>L</given-names></string-name>, <etal>et al</etal></person-group><article-title>The genomic landscape of meiotic crossovers and gene conversions in <italic toggle="yes">Arabidopsis thaliana</italic></article-title>. <source>Elife</source><year>2013</year>;<volume>2</volume>:<comment>e01426</comment>. doi:<pub-id pub-id-type="doi">10.7554/eLife.01426</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>C</given-names></string-name>, <string-name><surname>Boer</surname><given-names>MP</given-names></string-name>, <string-name><surname>van Eeuwijk</surname><given-names>FA</given-names></string-name></person-group>. <article-title>A general modeling framework for genome ancestral origins in multiparental populations</article-title>. <source>Genetics</source><year>2014</year>;<volume>198</volume>(<issue>1</issue>):<fpage>87</fpage>–<lpage>101</lpage>. doi:<pub-id pub-id-type="doi">10.1534/genetics.114.163006</pub-id>.<pub-id pub-id-type="pmid">25236451</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>C</given-names></string-name>, <string-name><surname>Boer</surname><given-names>MP</given-names></string-name>, <string-name><surname>van Eeuwijk</surname><given-names>FA</given-names></string-name></person-group>. <article-title>Reconstruction of genome ancestry blocks in multiparental populations</article-title>. <source>Genetics</source><year>2015</year>;<volume>200</volume>(<issue>4</issue>):<fpage>1073</fpage>–<lpage>1087</lpage>. doi:<pub-id pub-id-type="doi">10.1534/genetics.115.177873</pub-id>.<pub-id pub-id-type="pmid">26048018</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>C</given-names></string-name>, <string-name><surname>Boer</surname><given-names>MP</given-names></string-name>, <string-name><surname>van Eeuwijk</surname><given-names>FA</given-names></string-name></person-group>. <article-title>Accurate genotype imputation in multiparental populations from low-coverage sequence</article-title>. <source>Genetics</source><year>2018</year>;<volume>210</volume>(<issue>1</issue>):<fpage>71</fpage>–<lpage>82</lpage>. doi:<pub-id pub-id-type="doi">10.1534/genetics.118.300885</pub-id>.<pub-id pub-id-type="pmid">30045858</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name><surname>Gogarten</surname><given-names>SM</given-names></string-name>, <string-name><surname>Lawrence</surname><given-names>M</given-names></string-name>, <string-name><surname>Stilp</surname><given-names>A</given-names></string-name>, <string-name><surname>Conomos</surname><given-names>MP</given-names></string-name>, <string-name><surname>Weir</surname><given-names>BS</given-names></string-name>, <string-name><surname>Laurie</surname><given-names>C</given-names></string-name>, <string-name><surname>Levine</surname><given-names>D</given-names></string-name></person-group>. <article-title>Seqarray—a storage-efficient high-performance data format for WGS variant calls</article-title>. <source>Bioinformatics</source><year>2017</year>;<volume>33</volume>(<issue>15</issue>):<fpage>2251</fpage>–<lpage>2257</lpage>. doi:<pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTX145</pub-id>.<pub-id pub-id-type="pmid">28334390</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name><surname>Levine</surname><given-names>D</given-names></string-name>, <string-name><surname>Shen</surname><given-names>J</given-names></string-name>, <string-name><surname>Gogarten</surname><given-names>SM</given-names></string-name>, <string-name><surname>Laurie</surname><given-names>C</given-names></string-name>, <string-name><surname>Weir</surname><given-names>BS</given-names></string-name></person-group>. <article-title>A high-performance computing toolset for relatedness and principal component analysis of SNP data</article-title>. <source>Bioinformatics</source><year>2012</year>;<volume>28</volume>(<issue>24</issue>):<fpage>3326</fpage>–<lpage>3328</lpage>. doi:<pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTS606</pub-id>.<pub-id pub-id-type="pmid">23060615</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genetics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genetics</journal-id>
    <journal-id journal-id-type="publisher-id">genetics</journal-id>
    <journal-title-group>
      <journal-title>Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0016-6731</issn>
    <issn pub-type="epub">1943-2631</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>US</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10213493</article-id>
    <article-id pub-id-type="pmid">36988327</article-id>
    <article-id pub-id-type="doi">10.1093/genetics/iyad055</article-id>
    <article-id pub-id-type="publisher-id">iyad055</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Investigation</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01180</subject>
        <subject>AcademicSubjects/SCI01140</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GBScleanR: robust genotyping error correction using a hidden Markov model with error pattern recognition</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Furuta</surname>
          <given-names>Tomoyuki</given-names>
        </name>
        <aff><institution>Institute of Plant Science and Resources, Okayama University</institution>, <addr-line>Chu-oh 2-20-1, Kurashiki, Okayama 710-0046</addr-line>, <country country="JP">Japan</country></aff>
        <xref rid="iyad055-cor1" ref-type="corresp"/>
        <!--f.tomoyuki@okayama-u.ac.jp-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yamamoto</surname>
          <given-names>Toshio</given-names>
        </name>
        <aff><institution>Institute of Plant Science and Resources, Okayama University</institution>, <addr-line>Chu-oh 2-20-1, Kurashiki, Okayama 710-0046</addr-line>, <country country="JP">Japan</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ashikari</surname>
          <given-names>Motoyuki</given-names>
        </name>
        <aff><institution>Bioscience and Biotechnology Center, Nagoya University</institution>, <addr-line>Furo-cho, Chikusa, Nagoya, Aichi 464-8601</addr-line>, <country country="JP">Japan</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Endelman</surname>
          <given-names>J</given-names>
        </name>
        <role>Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="iyad055-cor1">Corresponding author: Institute of Plant Science and Resources, Okayama University, Chu-oh 2-20-1, Kurashiki, Okayama, 710-0046, Japan. Email: <email>f.tomoyuki@okayama-u.ac.jp</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-03-29">
      <day>29</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <volume>224</volume>
    <issue>2</issue>
    <elocation-id>iyad055</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>15</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of The Genetics Society of America.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="iyad055.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Reduced-representation sequencing (RRS) provides cost-effective and time-saving genotyping platforms. Despite the outstanding advantage of RRS in throughput, the obtained genotype data usually contain a large number of errors. Several error correction methods employing the hidden Markov model (HMM) have been developed to overcome these issues. These methods assume that markers have a uniform error rate with no bias in the allele read ratio. However, bias does occur because of uneven amplification of genomic fragments and read mismapping. In this paper, we introduce an error correction tool, GBScleanR, which enables robust and precise error correction for noisy RRS-based genotype data by incorporating marker-specific error rates into the HMM. The results indicate that GBScleanR improves the accuracy by more than 25 percentage points at maximum compared to the existing tools in simulation data sets and achieves the most reliable genotype estimation in real data even with error-prone markers.</p>
    </abstract>
    <kwd-group>
      <kwd>reduced-representation sequencing</kwd>
      <kwd>error correction</kwd>
      <kwd>imputation</kwd>
      <kwd>hidden Markov model</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Japan Science and Technology Agency</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002241</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Ministry of Education, Culture, Sports, Science and Technology of Japan</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001700</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>JP20H05912</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="iyad055-s0">
    <title>Introduction</title>
    <p>Reduced-representation sequencing (RRS) is a sequencing technique using next-generation sequencing (NGS) with reducing sequence targets by taking reads only from a limited portion of a genome (<xref rid="iyad055-B26" ref-type="bibr">Scheben <italic toggle="yes">et al.</italic> 2017</xref>). To meet the demands for cost-effective genotyping systems with dense markers, many different RRS-based genotyping methods have been introduced, including restriction site-associated DNA sequencing (RAD-seq) and genotyping-by-sequencing (GBS) (<xref rid="iyad055-B2" ref-type="bibr">Baird <italic toggle="yes">et al.</italic> 2008</xref>; <xref rid="iyad055-B8" ref-type="bibr">Elshire <italic toggle="yes">et al.</italic> 2011</xref>). The reduction in the number of sequence targets allows us for highly multiplexed sequencing to obtain genotype data of a large population such as a hybrid population for genetic mapping and breeding. However, a larger number of samples per NGS run result in genotype data with a lower read coverage per sample (<xref rid="iyad055-B21" ref-type="bibr">Poland and Rife 2012</xref>). Since sequence reads that can be retrieved via NGS are highly stochastic, the limited number of reads can result in the undercalling of heterozygotes, in which recovering only 1 allele at a heterozygous site leads to its incorrect identification as a homozygote. The lack of reads also generates a substantial number of missing genotype calls.</p>
    <p>Several error correction tools have been developed to overcome these disadvantages. The method to fill up missing calls and correct the undercalling of heterozygotes was first published in 2009, which determines genotypes based on the allele read ratio within a sliding window (<xref rid="iyad055-B15" ref-type="bibr">Huang <italic toggle="yes">et al.</italic> 2009</xref>). Genotype-Corrector is also an example of the tool using a sliding window method for error correction (<xref rid="iyad055-B20" ref-type="bibr">Miao <italic toggle="yes">et al.</italic> 2018</xref>). Recent publications have introduced statistically sophisticated methods using hidden Markov models (HMMs), such as FSFHap, TIGER, LB-Impute, and magicImpute (<xref rid="iyad055-B27" ref-type="bibr">Swarts <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="iyad055-B25" ref-type="bibr">Rowan <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="iyad055-B9" ref-type="bibr">Fragoso <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyad055-B31" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2018</xref>). The existing methods, however, assume constant error rates for all markers. For example, those assume a 50:50 probability that a read could be obtained for 1 of 2 possible alleles at a heterozygous site. Although this assumption is true in an ideal situation, in practice, genotype data contain a significant number of error-prone markers that show skewed probabilities in allele read acquisition as a result of actual biological unevenness (<xref rid="iyad055-B7" ref-type="bibr">Davey <italic toggle="yes">et al.</italic> 2013</xref>; <xref rid="iyad055-B28" ref-type="bibr">Wijnker <italic toggle="yes">et al.</italic> 2013</xref>; <xref rid="iyad055-B6" ref-type="bibr">DaCosta and Sorenson 2014</xref>). Variations in genome sequences change the fragmentation patterns of the genomes. Even if 2 independent reads are mapped at the same locus, the sequences of the genomic fragments from which each of the 2 reads originated can vary in terms of GC content and length and sometimes include large insertions or deletions in the unsequenced region of the fragments. Since the GC contents and the lengths of the restriction fragments are known to affect the amplification efficiency, the probability of observing a read for either allele may differ. These biases are likely to be more prominent in a polymorphism-rich population, for example, that derived from a cross between distant relatives. Hence, mismatches occur between the real data, which shows marker-specific error rates, and the models that assume a uniform error rate, resulting in biased genotype estimation and poor error correction accuracy.</p>
    <p>Here, we introduce the R package “GBScleanR,” which implements an HMM-based error correction algorithm. Our algorithm estimates an allele read bias and mismapping rate for each marker and incorporates those into the HMM as parameters to capture the skewed probabilities in allele read acquisitions. This paper demonstrates a comparison of GBScleanR and 2 well-established error correction tools: LB-Impute and magicImpute (<xref rid="iyad055-B9" ref-type="bibr">Fragoso <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyad055-B31" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2018</xref>). While LB-Impute accepts only biparental populations derived from inbred founders, magicImpute can work on biparental and multiparental populations derived from both inbred and outbred founders. The magicImpute algorithm is also able to estimate founder genotypes simultaneously with the offspring genotypes. Similar to magicImpute, GBScleanR supports simultaneous estimation of founder and offspring genotypes in a biparental and multiparental population. We first show simulation studies to present the accuracy and robustness of GBScleanR using simulation data sets that have severe allele read biases at error-prone markers. The simulation assumes 3 scenarios: a biparental <italic toggle="yes">F</italic><sub>2</sub> population (homoP2_F2), an outbred <italic toggle="yes">F</italic><sub>1</sub> population (hetP2_F1), and 8-way recombinant inbred lines (homoP8_RIL). We then demonstrate the reliability and robustness of GBScleanR using real data derived from a cross between distant relatives of rice, which potentially contains many error-prone markers.</p>
  </sec>
  <sec sec-type="methods" id="iyad055-s1">
    <title>Methods</title>
    <sec id="iyad055-s1.1">
      <title>Modeling for error correction</title>
      <p>Our modeling basically follows the model implemented in magicImpute that has been introduced in <xref rid="iyad055-B31" ref-type="bibr">Zheng <italic toggle="yes">et al</italic>. (2018)</xref>. The error correction algorithm of GBScleanR employs the HMM and treats the observed allele read counts for each SNP marker along a chromosome as outputs from a sequence of latent true genotypes. Our model supposes that a population of <inline-formula><mml:math id="IM1" display="inline" overflow="scroll"><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> offspring is originally derived from crosses between <inline-formula><mml:math id="IM2" display="inline" overflow="scroll"><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.25em"/></mml:math></inline-formula> founder individuals. The founders can be inbred lines with homozygotes at all markers or outbred lines in which markers would be heterozygous. Only 1 chromosome is considered for modeling due to the independence of chromosomes. Let <inline-formula><mml:math id="IM3" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> denote the observed allele read counts at marker <italic toggle="yes">m</italic> in offspring <italic toggle="yes">i</italic>. The element <inline-formula><mml:math id="IM4" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> consists of 2 values, <inline-formula><mml:math id="IM5" display="inline" overflow="scroll"><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="IM6" display="inline" overflow="scroll"><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula>, which represent the reference read count and the alternative read count, respectively. Similarly, the observed allele read counts at marker <italic toggle="yes">m</italic> in founder <italic toggle="yes">j</italic> are represented by <inline-formula><mml:math id="IM7" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula>. The matrices for hidden true offspring genotypes and hidden true founder genotypes are represented by <inline-formula><mml:math id="IM8" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM9" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula>, respectively. The element <inline-formula><mml:math id="IM10" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> takes a value of 0, 1, or 2 to indicate the reference homozygote, heterozygote, and alternative homozygote genotype without phasing information. Unlike the offspring genotype matrix, the founder genotype <inline-formula><mml:math id="IM11" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> stores the phased genotype as <inline-formula><mml:math id="IM12" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, where <inline-formula><mml:math id="IM13" display="inline" overflow="scroll"><mml:msup><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mspace width="0.25em"/></mml:math></inline-formula> and <inline-formula><mml:math id="IM14" display="inline" overflow="scroll"><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> indicate alleles at marker <italic toggle="yes">m</italic> on one of the diploid chromosomes and another in founder <italic toggle="yes">j</italic>, respectively. The reference allele is represented by 0, while 1 denotes the alternative. Considering the linkage between the markers and the independence of the founder genotypes, we can assume that the sequence of the descendent genotypes from founders does not follow a Markov process, while the sequence of the descendent haplotypes <inline-formula><mml:math id="IM15" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> does. To enable our estimation problem to be solved in the HMM framework, <inline-formula><mml:math id="IM16" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> is introduced to represent the matrix of the phased descendent haplotypes. The element <inline-formula><mml:math id="IM17" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> denotes a pair of descendent haplotypes <inline-formula><mml:math id="IM18" display="inline" overflow="scroll"><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> at marker <italic toggle="yes">m</italic> in offspring <italic toggle="yes">i</italic>. Therefore, <inline-formula><mml:math id="IM19" display="inline" overflow="scroll"><mml:msup><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="IM20" display="inline" overflow="scroll"><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> each take one of the natural numbers that are <inline-formula><mml:math id="IM21" display="inline" overflow="scroll"><mml:mo>≤</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> if all founders are inbred or <inline-formula><mml:math id="IM22" display="inline" overflow="scroll"><mml:mo>≤</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> if outbred to indicate the origins of the descendent haplotypes.</p>
      <p>The algorithm estimates <inline-formula><mml:math id="IM23" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="IM24" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> based on <inline-formula><mml:math id="IM25" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="IM26" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> by maximizing the joint probability <inline-formula><mml:math id="IM27" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. We assume the independence of the offspring and the founders and the independence of each founder genotype at each marker. Therefore, our algorithm tries to maximize the following joint probability:</p>
      <disp-formula id="UM0001">
        <mml:math id="UM1" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">H</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">X</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munderover>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mi>N</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:munderover>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mrow>
            <mml:mo>{</mml:mo>
            <mml:mrow>
              <mml:mstyle displaystyle="true">
                <mml:munderover>
                  <mml:mrow>
                    <mml:mo movablelimits="false">∏</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mi>M</mml:mi>
                </mml:munderover>
              </mml:mstyle>
              <mml:mspace width="0.2em"/>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>y</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo fence="false" stretchy="false">|</mml:mo>
                </mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>,</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mstyle displaystyle="true">
                <mml:munderover>
                  <mml:mrow>
                    <mml:mo movablelimits="false">∏</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                  <mml:mi>M</mml:mi>
                </mml:munderover>
              </mml:mstyle>
              <mml:mspace width="0.2em"/>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo fence="false" stretchy="false">|</mml:mo>
                </mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>,</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo fence="false" stretchy="false">|</mml:mo>
                </mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
            <mml:mo>}</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0002">
        <mml:math id="UM2" display="block" overflow="scroll">
          <mml:mspace width="-10pc"/>
          <mml:mo>×</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munderover>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mi>M</mml:mi>
            </mml:munderover>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">y</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM28" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, and <inline-formula><mml:math id="IM30" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> correspond to the emission probability, the transition probability, and the initial probability of the HMM, respectively. <inline-formula><mml:math id="IM31" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the probability of observing read counts for the founders at marker <italic toggle="yes">m</italic> when the combination of the true genotypes of the founders is <inline-formula><mml:math id="IM32" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. The details to derive the equation shown above are available in the <italic toggle="yes">Joint probability derivation</italic> section in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>. We assume that <inline-formula><mml:math id="IM33" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> follows a discrete uniform probability for all possible combinations of the founder genotypes while omitting cases in which all founders have a same genotype.</p>
    </sec>
    <sec id="iyad055-s1.2">
      <title>Emission probability</title>
      <p>To obtain the emission probability <inline-formula><mml:math id="IM34" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, 3 additional probabilities are introduced: <inline-formula><mml:math id="IM35" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="IM36" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, and <inline-formula><mml:math id="IM37" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. The first 2 probabilities incorporate the effect of read mismapping that would make true genotype unobservable. <inline-formula><mml:math id="IM38" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the probability that the observable genotype is <inline-formula><mml:math id="IM39" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when read mismapping occurred at marker <italic toggle="yes">m</italic> of <italic toggle="yes">i</italic>th offspring that has the true genotype <inline-formula><mml:math id="IM40" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. <inline-formula><mml:math id="IM41" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> represents the probability to observe the reads <inline-formula><mml:math id="IM42" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when the observable genotype is <inline-formula><mml:math id="IM43" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. <inline-formula><mml:math id="IM44" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the probability to observe the genotype <inline-formula><mml:math id="IM45" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when the haplotype <inline-formula><mml:math id="IM46" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> was descendent from the founders having the genotype <inline-formula><mml:math id="IM47" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. We then rewrite the emission probability as <inline-formula><mml:math id="IM48" display="inline" overflow="scroll"><mml:msubsup><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, and it holds that</p>
      <disp-formula id="UM0003">
        <mml:math id="UM3" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>x</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mi>e</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">map</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0004">
        <mml:math id="UM4" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mi>e</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">map</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>x</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">′</mml:mi>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mi>e</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">map</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM49" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> equals 1 for the possible genotype under the constraint of the descendent haplotypes and founder genotypes in sample <italic toggle="yes">i</italic> and 0 for the other genotypes. For example, if sample 1 has <inline-formula><mml:math id="IM50" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mn>4</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> at marker 1, indicating that the haplotypes descended from the first chromosome of founder 1 and the second chromosome of founder 2, and if the founder genotypes are <inline-formula><mml:math id="IM51" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="IM52" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, the genotype can only be heterozygotic . The parameter <inline-formula><mml:math id="IM53" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> represents the global sequencing error rate that an unexpected allele read can be observed when the true genotype is either homozygote. We only assume that the sequencing error generates a read representing an opposite allele of the true allele. All markers are considered to have a same <inline-formula><mml:math id="IM54" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> value. The parameters <inline-formula><mml:math id="IM55" display="inline" overflow="scroll"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM56" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> are the marker-specific allele read bias and mismapping rate at marker <italic toggle="yes">m</italic>. These are the key parameters that make GBScleanR differ from the other algorithms including magicImpute in which no allele read bias and a constant mismapping rate are assumed. <inline-formula><mml:math id="IM57" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> indicates the observable genotype that results from accounting for the mismapping with <inline-formula><mml:math id="IM58" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula>. We assume that <inline-formula><mml:math id="IM59" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> takes 2 values <inline-formula><mml:math id="IM60" display="inline" overflow="scroll"><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. <inline-formula><mml:math id="IM61" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mspace width="0.25em"/></mml:math></inline-formula> indicates the probability of incorrectly observing an alternative allele due to mismapped alternative reads when the true genotype is a reference homozygote. Similarly, <inline-formula><mml:math id="IM62" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> represents the probability of incorrectly observing a reference allele due to mismapped reference reads when the true genotype is an alternative homozygote. In the calculation of <inline-formula><mml:math id="IM63" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, we do not consider the undercalling of heterozygotes and missing calls for which <inline-formula><mml:math id="IM64" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> accounts. Therefore, when the true genotype <inline-formula><mml:math id="IM65" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is heterozygous, we can expect to observe that both alleles and an additional incorrect observation of either allele due to mismapping do not change the observable genotype <inline-formula><mml:math id="IM66" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> that is heterozygous. On the other hand, for example, the incorrectly observed reference allele due to mismapping of reference reads at an alternative homozygous site makes the site can be observed as heterozygous. Thus, the probability <inline-formula><mml:math id="IM67" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> takes the values listed in <xref rid="iyad055-T1" ref-type="table">Table 1</xref>. The observed read counts <inline-formula><mml:math id="IM68" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo></mml:math></inline-formula> follow binomial distribution</p>
      <disp-formula id="UM0005">
        <mml:math id="UM5" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mspace width="0.25em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:mn>0</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>∝</mml:mo>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:mn>1</mml:mn>
            <mml:mo>−</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">ref</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">alt</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0006">
        <mml:math id="UM6" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mspace width="0.25em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:mn>1</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>∝</mml:mo>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:mn>1</mml:mn>
            <mml:mo>−</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">ref</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">alt</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0007">
        <mml:math id="UM7" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mspace width="0.25em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:mn>2</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>∝</mml:mo>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">ref</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:mn>1</mml:mn>
            <mml:mo>−</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">alt</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>given the observable genotype <inline-formula><mml:math id="IM69" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. To reduce the negative impact of overrepresented mismapping reads that can make the probabilities of less probable genotypes being 0, we add 0.005 to the probabilities for the 3 possible genotypes if any of <inline-formula><mml:math id="IM70" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> gave <inline-formula><mml:math id="IM71" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn></mml:math></inline-formula>. The normalization constant for <inline-formula><mml:math id="IM72" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is not shown in the equation above. Similarly, the emission probability for founders can be obtained by</p>
      <disp-formula id="UM0008">
        <mml:math id="UM8" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mrow>
              <mml:mi mathvariant="bold-italic">l</mml:mi>
            </mml:mrow>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo>∝</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munderover>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mi>j</mml:mi>
              <mml:mrow>
                <mml:msup>
                  <mml:mi>N</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:munderover>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mi>e</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">map</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where the normalization constant for <inline-formula><mml:math id="IM73" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is not shown. To omit the less probable founder genotypes, the probability <inline-formula><mml:math id="IM74" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is set to 0 if the result is &lt;0.01.</p>
      <table-wrap position="float" id="iyad055-T1">
        <label>Table 1.</label>
        <caption>
          <p>Probabilities associated with mismapping.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1"/>
              <th colspan="3" align="center" rowspan="1">Observable genotype <inline-formula><mml:math id="IM75" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="bold">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1">0</th>
              <th align="center" rowspan="1" colspan="1">1</th>
              <th align="center" rowspan="1" colspan="1">2</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="3" colspan="1">True genotype <inline-formula><mml:math id="IM76" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <mml:math id="IM77" display="inline" overflow="scroll">
                    <mml:mspace width="-3pt"/>
                    <mml:mn>1</mml:mn>
                    <mml:mo>−</mml:mo>
                    <mml:msup>
                      <mml:mi>e</mml:mi>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">ref</mml:mi>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <mml:math id="IM78" display="inline" overflow="scroll">
                    <mml:msup>
                      <mml:mi>e</mml:mi>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">ref</mml:mi>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <mml:math id="IM79" display="inline" overflow="scroll">
                    <mml:msup>
                      <mml:mi>e</mml:mi>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">alt</mml:mi>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <mml:math id="IM80" display="inline" overflow="scroll">
                    <mml:mn>1</mml:mn>
                    <mml:mo>−</mml:mo>
                    <mml:msup>
                      <mml:mi>e</mml:mi>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">alt</mml:mi>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="iyad055-s1.3">
      <title>Transition probability</title>
      <p>The transition probability <inline-formula><mml:math id="IM81" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is used to describe the probability that a crossover occurs between adjacent markers. The sequence of the descendent haplotypes is modeled using a continuous-time Markov chain, as described previously (<xref rid="iyad055-B29" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2014</xref>, <xref rid="iyad055-B30" ref-type="bibr">2015</xref>). The probability that the haplotype state transitions from <inline-formula><mml:math id="IM82" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> to <inline-formula><mml:math id="IM83" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> between the markers can be obtained using</p>
      <disp-formula id="UM0009">
        <mml:math id="UM9" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msup>
            <mml:mi>e</mml:mi>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">Q</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>d</mml:mi>
                    <mml:mi>m</mml:mi>
                  </mml:msub>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:msup>
          <mml:mo>,</mml:mo>
          <mml:mi>m</mml:mi>
          <mml:mo>≠</mml:mo>
          <mml:mn>1</mml:mn>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow></mml:math></inline-formula> denotes the transition rate matrix that defines the rates at which a state transition occurs per unit of time. The matrix exponential is obtained by Higham's algorithm, which is implemented in the “expm” package of R (<ext-link xlink:href="http://cran.r-project.org/web/packages/expm/index.html" ext-link-type="uri">http://cran.r-project.org/web/packages/expm/index.html</ext-link>). To obtain transition rates that are proportional to the distances between adjacent markers, <inline-formula><mml:math id="IM85" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow></mml:math></inline-formula> is multiplied by the genetic distance between markers <italic toggle="yes">m</italic> and <italic toggle="yes">m</italic> − 1 in Morgan <italic toggle="yes">d<sub>m</sub></italic>. While our algorithm requires genetic distances between markers, genotype data obtained via NGS generally provide only information about the physical distances. Therefore, <italic toggle="yes">d<sub>m</sub></italic> is calculated based on the physical distance and the expected genetic distance:</p>
      <disp-formula id="UM0010">
        <mml:math id="UM10" display="block" overflow="scroll">
          <mml:msub>
            <mml:mi>d</mml:mi>
            <mml:mi>m</mml:mi>
          </mml:msub>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msup>
            <mml:mn>10</mml:mn>
            <mml:mrow>
              <mml:mo>−</mml:mo>
              <mml:mn>6</mml:mn>
            </mml:mrow>
          </mml:msup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:mspace width=".1em"/>
            <mml:msub>
              <mml:mi>p</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
            <mml:mo>−</mml:mo>
            <mml:msub>
              <mml:mi>p</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:msup>
            <mml:mrow>
              <mml:mi mathvariant="normal">E</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">d</mml:mi>
            </mml:mrow>
          </mml:msup>
          <mml:mo>,</mml:mo>
          <mml:mi>m</mml:mi>
          <mml:mo>≠</mml:mo>
          <mml:mn>1</mml:mn>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <italic toggle="yes">p<sub>m</sub></italic> represents the physical position of marker <italic toggle="yes">m</italic> and E<sup>d</sup> is the expected genetic distance per megabase pair that should be specified as the input parameter. For <italic toggle="yes">m</italic> = 1, the initial probability <inline-formula><mml:math id="IM86" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is required and specified by the stationary distribution of the Markov process that can be obtained by normalizing the first eigenvector of the transposed transition probability matrix for a marker interval.</p>
    </sec>
    <sec id="iyad055-s1.4">
      <title>Estimation of the best haplotype and genotype sequences</title>
      <p>Together with the definitions described in the sections above, the joint probability to maximize can be rewritten as shown below:</p>
      <disp-formula id="UM0011">
        <mml:math id="UM11" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">H</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">X</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mrow>
            <mml:mo>{</mml:mo>
            <mml:mrow>
              <mml:mstyle displaystyle="true">
                <mml:munder>
                  <mml:mrow>
                    <mml:mo movablelimits="false">∏</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:munder>
              </mml:mstyle>
              <mml:mspace width="0.2em"/>
              <mml:msubsup>
                <mml:mi>l</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mstyle displaystyle="true">
                <mml:munder>
                  <mml:mrow>
                    <mml:mo movablelimits="false">∏</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:munder>
              </mml:mstyle>
              <mml:mspace width="0.2em"/>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo fence="false" stretchy="false">|</mml:mo>
                </mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>,</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo fence="false" stretchy="false">|</mml:mo>
                </mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
            <mml:mo>}</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>The Viterbi algorithm is used to maximize the joint probability and estimate the most likely haplotype sequences (<xref rid="iyad055-B23" ref-type="bibr">Rabiner 1989</xref>). Considering that the sequence of founder genotypes itself does not follow the Markov process while the offspring haplotypes depend on the founder genotypes, the most likely founder genotypes at marker <italic toggle="yes">m</italic> can be estimated based on the scores (probabilities) and the states of the Viterbi trellises that were calculated for the offspring genotype from markers 1 to <italic toggle="yes">m</italic>. Therefore, our algorithm recursively calculates the Viterbi scores for offspring <inline-formula><mml:math id="IM87" display="inline" overflow="scroll"><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and founders <inline-formula><mml:math id="IM88" display="inline" overflow="scroll"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and records the Viterbi paths for the sequences of offspring haplotypes <inline-formula><mml:math id="IM89" display="inline" overflow="scroll"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and founder genotypes <inline-formula><mml:math id="IM90" display="inline" overflow="scroll"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, respectively. The recursive calculation of the integrated Viterbi algorithm proceeds as follows.</p>
      <p>Initialization at <italic toggle="yes">m</italic> = 1:</p>
      <p>The initialization starts with simply calculating the probability of having <inline-formula><mml:math id="IM91" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when the combination of the founder genotypes <inline-formula><mml:math id="IM92" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is given.</p>
      <disp-formula id="UM0012">
        <mml:math id="UM12" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mrow>
              <mml:mn>1</mml:mn>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mn>1</mml:mn>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mn>1</mml:mn>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mrow>
              <mml:mn>1</mml:mn>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mn>1</mml:mn>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mn>1</mml:mn>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM93" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the initial probability that the <italic toggle="yes">i</italic>th offspring has the combination of haplotypes <inline-formula><mml:math id="IM94" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> at the first marker.</p>
      <p>Recursion at <inline-formula><mml:math id="IM95" display="inline" overflow="scroll"><mml:mn>2</mml:mn><mml:mo>≤</mml:mo><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:math></inline-formula>:</p>
      <p>The algorithm calculates the probabilities of state transitions from marker <italic toggle="yes">m</italic> − 1 to <italic toggle="yes">m</italic> as shown below:</p>
      <disp-formula id="UM0013">
        <mml:math id="UM13" display="block" overflow="scroll">
          <mml:msub>
            <mml:mi>τ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0014">
        <mml:math id="UM14" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>τ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">′</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo form="prefix">max</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msub>
              <mml:mi>τ</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mi>h</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mrow>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
              </mml:mrow>
              <mml:msubsup>
                <mml:mi>h</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo>,</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM96" display="inline" overflow="scroll"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is a matrix, each element of which indicates the probability of observing the transition from <inline-formula><mml:math id="IM97" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> to <inline-formula><mml:math id="IM98" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when <inline-formula><mml:math id="IM99" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="IM100" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> are given, while <inline-formula><mml:math id="IM101" display="inline" overflow="scroll"><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> indicates the probabilities of observing <inline-formula><mml:math id="IM102" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when the most likely transition from <inline-formula><mml:math id="IM103" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> to <inline-formula><mml:math id="IM104" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> occurs with given <inline-formula><mml:math id="IM105" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="IM106" display="inline" overflow="scroll"><mml:mrow><mml:mspace width="0.25em"/></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:math></inline-formula></p>
      <p>Then, calculate the Viterbi scores and the Viterbi paths for founders as</p>
      <disp-formula id="UM0015">
        <mml:math id="UM15" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mn>1</mml:mn>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:msubsup>
            <mml:mi>τ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">′</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0016">
        <mml:math id="UM16" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>ψ</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mspace width="0.25em"/>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mi>arg</mml:mi>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo form="prefix">max</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>v</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mrow>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
              </mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Using <inline-formula><mml:math id="IM107" display="inline" overflow="scroll"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, which stores the most likely combination of founder genotypes at marker <italic toggle="yes">m</italic> − 1 when <inline-formula><mml:math id="IM108" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is given, we can obtain the Viterbi scores and the Viterbi paths for offspring as follows:</p>
      <disp-formula id="UM0017">
        <mml:math id="UM17" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>ψ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mi>arg</mml:mi>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo form="prefix">max</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msub>
              <mml:mi>τ</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mi>h</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mrow>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
              </mml:mrow>
              <mml:msubsup>
                <mml:mi>h</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo>,</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo>=</mml:mo>
              <mml:mspace width="0.25em"/>
              <mml:msubsup>
                <mml:mi>ψ</mml:mi>
                <mml:mi>m</mml:mi>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0018">
        <mml:math id="UM18" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msubsup>
            <mml:mi>τ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">′</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:msubsup>
              <mml:mi>ψ</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Termination at <italic toggle="yes">m</italic> = <italic toggle="yes">M</italic>:</p>
      <p>Finally, we obtain the probability of observing <inline-formula><mml:math id="IM109" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and the most likely combination of founder genotypes at marker <italic toggle="yes">M</italic> via the following calculation:</p>
      <disp-formula id="UM0019">
        <mml:math id="UM19" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mi>M</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">′</mml:mi>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mi>M</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0020">
        <mml:math id="UM20" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mrow>
              <mml:mover>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mo stretchy="false">^</mml:mo>
              </mml:mover>
            </mml:mrow>
            <mml:mi>M</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mi>arg</mml:mi>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo form="prefix">max</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mi>M</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>v</mml:mi>
              <mml:mi>M</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Once <inline-formula><mml:math id="IM110" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is determined, we can also obtain the most likely offspring haplotypes at marker <italic toggle="yes">M</italic>:</p>
      <disp-formula id="UM0021">
        <mml:math id="UM21" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mrow>
              <mml:mover>
                <mml:mi>h</mml:mi>
                <mml:mo stretchy="false">^</mml:mo>
              </mml:mover>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mi>arg</mml:mi>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo form="prefix">max</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>v</mml:mi>
              <mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mi>h</mml:mi>
                <mml:mrow>
                  <mml:mi>M</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mrow>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
              </mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mover>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">x</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">^</mml:mo>
                  </mml:mover>
                </mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Backtracking from <italic toggle="yes">M</italic> − 1 to 1:</p>
      <p>To retrieve the most likely sequences of founder genotypes and offspring haplotypes, we trace the Viterbi paths as shown below:</p>
      <disp-formula id="UM0022">
        <mml:math id="UM22" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mrow>
              <mml:mover>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mo stretchy="false">^</mml:mo>
              </mml:mover>
            </mml:mrow>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msubsup>
            <mml:mi>ψ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mn>1</mml:mn>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mover>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">^</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0023">
        <mml:math id="UM23" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mrow>
              <mml:mover>
                <mml:mi>h</mml:mi>
                <mml:mo stretchy="false">^</mml:mo>
              </mml:mover>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msubsup>
            <mml:mi>ψ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mover>
                  <mml:mi>h</mml:mi>
                  <mml:mo stretchy="false">^</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mover>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">^</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>If multiple arguments have the same maximum score, one of them is randomly selected. To increase the accuracy, our algorithm executes 2 rounds of estimation: 1 from marker 1 to <italic toggle="yes">M</italic> and another in the reverse direction. The reverse direction round starts from the last marker <italic toggle="yes">M</italic> and uses the estimated founder genotypes <inline-formula><mml:math id="IM111" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> from the forward round as the only possible founder genotypes at marker <italic toggle="yes">M</italic>. The results from both rounds are then merged by combining the first half of the estimated genotypes <inline-formula><mml:math id="IM112" display="inline" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>&lt;</mml:mo><mml:mrow><mml:mfrac><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> from the reversed direction round with the last half from the forward direction round.</p>
      <p>The estimated genotype at each marker in each sample <inline-formula><mml:math id="IM113" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> can now be obtained based on <inline-formula><mml:math id="IM114" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mi>h</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="IM115" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. To evaluate the reliability of the estimated genotypes, the marginal probability is also calculated:</p>
      <disp-formula id="UM0024">
        <mml:math id="UM24" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">X</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">^</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mover>
                      <mml:mi>h</mml:mi>
                      <mml:mo stretchy="false">^</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mi>o</mml:mi>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">X</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">^</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">X</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">^</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM116" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> can be obtained using the forward–backward algorithm (<xref rid="iyad055-B23" ref-type="bibr">Rabiner 1989</xref>). The estimated genotype <inline-formula><mml:math id="IM117" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is set as missing if <inline-formula><mml:math id="IM118" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is smaller than a user specified threshold <italic toggle="yes">P</italic><sub>call</sub>, with 0.9 as the default.</p>
    </sec>
    <sec id="iyad055-s1.5">
      <title>Estimation of allele read biases and mismapping rates</title>
      <p>GBScleanR requires 4 parameters E<sup>d</sup>, <inline-formula><mml:math id="IM119" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="IM120" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula>, and <inline-formula><mml:math id="IM121" display="inline" overflow="scroll"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula>. The expected genetic distance per megabase pair E<sup>d</sup> and sequencing error rate <inline-formula><mml:math id="IM122" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> take a single positive number that should arbitrarily be specified as input parameters, while the mismapping rates <inline-formula><mml:math id="IM123" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> and the allele read biases <inline-formula><mml:math id="IM124" display="inline" overflow="scroll"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> can be estimated via iterative parameter optimization (IPO). IPO is achieved by repeating the genotype estimation step and the parameter estimation step using the estimated genotype data. For the first cycle of the genotype estimation, <inline-formula><mml:math id="IM125" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="IM126" display="inline" overflow="scroll"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> are initialized to <inline-formula><mml:math id="IM127" display="inline" overflow="scroll"><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0.005</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>0.005</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and 0.5 for all markers, respectively. Thus, the first iteration does not consider marker-specific allele read biases and mismapping rates. The parameter estimation proceeds as described below. With the estimated genotypes from the first cycle, we can obtain the number of allele reads for each estimated genotype. Let <inline-formula><mml:math id="IM128" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="IM129" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> be the number of reference reads and alternative reads at marker <italic toggle="yes">m</italic> in sample <italic toggle="yes">i</italic>, including both offspring and founders. The allele read bias at marker <italic toggle="yes">m</italic> is estimated by the following:</p>
      <disp-formula id="UM0025">
        <mml:math id="UM25" display="block" overflow="scroll">
          <mml:msub>
            <mml:mi>w</mml:mi>
            <mml:mi>m</mml:mi>
          </mml:msub>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>E</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">ref</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>E</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">ref</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:msubsup>
                    <mml:mi>E</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">alt</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0026">
        <mml:math id="UM26" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>E</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">ref</mml:mi>
              </mml:mrow>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>r</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">ref</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msubsup>
                    <mml:mi>r</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">ref</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mi>m</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mi>m</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0027">
        <mml:math id="UM27" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>E</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">alt</mml:mi>
              </mml:mrow>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>r</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">alt</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>2</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msubsup>
                    <mml:mi>r</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">alt</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mi>m</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>2</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mi>m</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0028">
        <mml:math id="UM28" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>r</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">x</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mi>g</mml:mi>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mi>x</mml:mi>
            </mml:msubsup>
            <mml:mi>δ</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mi>x</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mspace width="0.25em"/>
              <mml:mo>=</mml:mo>
              <mml:mspace width="0.25em"/>
              <mml:mi>g</mml:mi>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>,</mml:mo>
          <mml:mrow>
            <mml:mspace width="0.25em"/>
            <mml:mi mathvariant="normal">x</mml:mi>
          </mml:mrow>
          <mml:mo>∈</mml:mo>
          <mml:mo fence="false" stretchy="false">{</mml:mo>
          <mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">ref</mml:mi>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:mspace width="0.25em"/>
              <mml:mi mathvariant="normal">alt</mml:mi>
            </mml:mrow>
          </mml:mrow>
          <mml:mo fence="false" stretchy="false">}</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0029">
        <mml:math id="UM29" display="block" overflow="scroll">
          <mml:msub>
            <mml:mi>n</mml:mi>
            <mml:mi>m</mml:mi>
          </mml:msub>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mi>g</mml:mi>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msup>
            <mml:mn>2</mml:mn>
            <mml:mrow>
              <mml:mi>δ</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:mi>g</mml:mi>
                <mml:mo>≠</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
          </mml:msup>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:mi>δ</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mi>x</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mspace width="0.25em"/>
              <mml:mo>=</mml:mo>
              <mml:mspace width="0.25em"/>
              <mml:mi>g</mml:mi>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <italic toggle="yes">g</italic> is 0, 1, or 2 and indicates the genotype, <inline-formula><mml:math id="IM130" display="inline" overflow="scroll"><mml:msubsup><mml:mi>E</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> represents the expected number of reference allele reads observed if 1 reference allele is on the chromosome, and <inline-formula><mml:math id="IM131" display="inline" overflow="scroll"><mml:msubsup><mml:mi>E</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> represents the expected number of alternative allele reads if 1 alternative allele is on the chromosome. On the other hand, the mismapping rate at marker <italic toggle="yes">m</italic> can be obtained by calculating</p>
      <disp-formula id="UM0030">
        <mml:math id="UM30" display="block" overflow="scroll">
          <mml:msup>
            <mml:mi>e</mml:mi>
            <mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">ref</mml:mi>
              </mml:mrow>
            </mml:mrow>
          </mml:msup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo movablelimits="false">∑</mml:mo>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mspace width="0.2em"/>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mrow>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>y</mml:mi>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">o</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mrow>
                          <mml:mo fence="false" stretchy="false">|</mml:mo>
                        </mml:mrow>
                        <mml:msubsup>
                          <mml:mi>x</mml:mi>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">′</mml:mi>
                            <mml:mi mathvariant="normal">o</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mspace width="0.25em"/>
                        <mml:mo>=</mml:mo>
                        <mml:mspace width="0.25em"/>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:msup>
                          <mml:mi>e</mml:mi>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">seq</mml:mi>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mi>w</mml:mi>
                          <mml:mi>m</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>&gt;</mml:mo>
                      <mml:mn>0.99</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">o</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mspace width="0.25em"/>
                      <mml:mo>=</mml:mo>
                      <mml:mspace width="0.25em"/>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">]</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo movablelimits="false">∑</mml:mo>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mspace width="0.2em"/>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mrow>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">o</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mspace width="0.25em"/>
                      <mml:mo>=</mml:mo>
                      <mml:mspace width="0.25em"/>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">]</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0031">
        <mml:math id="UM31" display="block" overflow="scroll">
          <mml:msup>
            <mml:mi>e</mml:mi>
            <mml:mrow>
              <mml:mi>a</mml:mi>
              <mml:mi>l</mml:mi>
              <mml:mi>t</mml:mi>
            </mml:mrow>
          </mml:msup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo movablelimits="false">∑</mml:mo>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mspace width="0.2em"/>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mrow>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>y</mml:mi>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">o</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mrow>
                          <mml:mo fence="false" stretchy="false">|</mml:mo>
                        </mml:mrow>
                        <mml:msubsup>
                          <mml:mi>x</mml:mi>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">′</mml:mi>
                            <mml:mi mathvariant="normal">o</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mspace width="0.25em"/>
                        <mml:mo>=</mml:mo>
                        <mml:mspace width="0.25em"/>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:msup>
                          <mml:mi>e</mml:mi>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">seq</mml:mi>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mi>w</mml:mi>
                          <mml:mi>m</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>&gt;</mml:mo>
                      <mml:mn>0.99</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">o</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mspace width="0.25em"/>
                      <mml:mo>=</mml:mo>
                      <mml:mspace width="0.25em"/>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">]</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo movablelimits="false">∑</mml:mo>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mspace width="0.2em"/>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mrow>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">o</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mspace width="0.25em"/>
                      <mml:mo>=</mml:mo>
                      <mml:mspace width="0.25em"/>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">]</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM132" display="inline" overflow="scroll"><mml:mi>δ</mml:mi></mml:math></inline-formula> is an indicator function that is equal to 1 if the argument is true and 0 if it is false. <inline-formula><mml:math id="IM133" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the genotype probability to call a heterozygote and can be obtained as described in the <italic toggle="yes">Emission probability</italic> section. We counted the number of mismapping-induced erroneous genotype calls at which the genotype probability to be heterozygous based on the observed reads is more than 0.99 but the estimated genotype via the HMM is homozygous. The rates of those erroneous heterozygous calls at HMM-estimated homozygous calls are assumed to represent the mismapping rates at markers.</p>
    </sec>
    <sec id="iyad055-s1.6">
      <title>Preparation of real data</title>
      <p>As real data, we used the genotype data obtained from the <italic toggle="yes">F</italic><sub>2</sub> population that has been derived from a cross between <italic toggle="yes">Oryza sativa</italic> and <italic toggle="yes">Oryza longistaminata</italic> and reported in the previous study (<xref rid="iyad055-B10" ref-type="bibr">Furuta <italic toggle="yes">et al.</italic> 2017</xref>). In brief, GBS was performed with a <italic toggle="yes">Kpn</italic>I–<italic toggle="yes">Msp</italic>I restriction enzyme pair using MiSeq with 75-bp paired-end sequencing and generated an average of <inline-formula><mml:math id="IM134" display="inline" overflow="scroll"><mml:mn>134</mml:mn><mml:mo>,</mml:mo><mml:mn>447</mml:mn><mml:mo>±</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>788</mml:mn></mml:math></inline-formula> reads per sample. We obtained a total of 2,539,459 and 3,481,218 reads for <italic toggle="yes">O. sativa</italic> and <italic toggle="yes">O. longistaminata</italic> from the independent runs, respectively. The obtained reads were then processed via the TASSEL-GBS pipeline v2 by following the instructions in the manual with the default parameters (<ext-link xlink:href="https://bitbucket.org/tasseladmin/tassel-5-source/wiki/Tassel5GBSv2Pipeline" ext-link-type="uri">https://bitbucket.org/tasseladmin/tassel-5-source/wiki/Tassel5GBSv2Pipeline</ext-link>) (<xref rid="iyad055-B12" ref-type="bibr">Glaubitz <italic toggle="yes">et al.</italic> 2014</xref>). The obtained SNP markers were then filtered to retain only those markers that were homozygous in each founder but biallelic between founders. Only the first SNP was selected if multiple SNPs were present within a 75-bp stretch. To filter out the erroneous genotype calls that were caused by overrepresented mismapping reads, read counts were set to 0 for genotype calls at which reads of either allele were mapped more than a threshold. The threshold was set at the 90th percentile of observed read counts at the obtained markers for each allele of each sample. Thus, this filtering was applied to each sample with the sample-specific thresholds for the reference and alternative reads. The resulting genotype data had 5,035 SNP markers for 814 <italic toggle="yes">F</italic><sub>2</sub> individuals with an average read depth of 0.85×.</p>
    </sec>
    <sec id="iyad055-s1.7">
      <title>Generation of simulation data</title>
      <p>The simulation data sets were generated by mimicking the real data of chromosome 7, which showed relatively severe biases (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref>). Each data set was therefore simulated to consist of 620 markers on a diploid chromosome with a physical length of 50 Mb and a genetic length of 2 Morgans. Genotype data sets were simulated for 3 scenarios: a 2-way <italic toggle="yes">F</italic><sub>2</sub> population from inbred founders (homoP2_F2), a 2-way <italic toggle="yes">F</italic><sub>1</sub> population from outbred founders (hetP2_F1), and 8-way recombinant inbred lines (RILs) from inbred founders (homoP8_RIL). For each scenario, we simulated populations that had 10, 100, and 1,000 individuals. The genotype of each individual was simulated as described in the <italic toggle="yes">Genotype data simulation</italic> section of the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>.</p>
      <p>Based on the simulated genotype data, read counts were assigned to each marker of each individual, mimicking the allele read biases observed in the real data. The details are available in the <italic toggle="yes">Read count data simulation</italic> section of the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>. The expected offspring read depths were set to 0.1×, 0.25×, 0.5×, 0.75×, 1×, 2×, 3×, 10×, and 20×. The founder read depth was set to 5× for all data sets because founders are usually sequenced relatively deep even in low-coverage GBS studies. Since a typical genotyping pipeline filters out markers at which no read was observed in either of founders, we allocated at least 1 read to all markers of founders and then allocated the remaining reads (“nonzero” data sets). In addition, we also simulated data sets in which founders have no read at some markers and missing genotypes (“allowzero” data sets). Simulation data sets without assuming any allele read biases and mismapping reads were also generated with the same settings for the other parameters to generate genotype and read count data.</p>
    </sec>
    <sec id="iyad055-s1.8">
      <title>Evaluation of algorithms</title>
      <p>GBScleanR was tested and compared with LB-Impute and magicImpute. The input parameter settings are described in the <italic toggle="yes">Input parameter</italic> section of the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>. Each algorithm was evaluated by calculating the proportions of correctly estimated genotypes (correct call rate), incorrectly estimated genotypes (miscall rate), and missing genotype calls (missing call rate) for each offspring in the simulated data sets. The proportion of correct calls over nonmissing calls was also calculated as estimation accuracy. The means and standard deviations of these values were then obtained for each data set processed by each algorithm. The resultant scores are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 1</xref>. To conduct an evaluation based on the concordance rate for the real data, we first selected relatively reliable genotype calls supported by more than 6 reads at markers that had less than a 20% missing rate and more than a 40% minor allele frequency. The read counts of the selected genotype calls were then set to 0. These masked real data were subjected to genotype estimation. The resultant estimated genotype data were evaluated based on the concordance rate, which is the proportion of estimated genotype calls matching the raw genotype calls at the masked genotype calls. Furthermore, we also calculated the averages of the missing rate, the number of recombinations, and the segregation distortion level in each chromosome. The segregation distortion level at each marker was obtained by dividing the chi-square value, which was calculated based on the assumption of a 1:2:1 genotype ratio for 3 possible genotypes, by the number of nonmissing genotype calls. The segregation distortion level of each chromosome was then obtained by summing up the segregation distortion levels of all markers in each chromosome. To identify recombination breakpoints of genome segments in the estimated genotype data, we searched the markers that showed genotypes switched between adjacent nonmissing markers. The middle points of those markers were considered recombination breakpoints.</p>
      <p>We also compared the running time of the 3 algorithms using the “nonzero” simulation data sets in the homoP2_F2, hetP2_F1, and homoP8_RIL scenarios. GBScleanR that has been implemented in R requires loading genotype data into the R environment and executing functions for genotype estimation step by step, while magicImpute and LB-Impute that were written in Mathematica and Java directly process input files and generate output files. Therefore, the overall process of GBScleanR including data loading, mating design specification, genotype estimation, and output data generation was measured as the running time of GBScleanR. The running time of magicImpute and LB-Impute was measured from the start to the end of the process. All computation was executed on a workstation with an AMD Ryzen Threadripper 2990WX CPU having 32 cores/64 threads and 64 Gb of RAM. Since magicImpute automatically tries to use half the number of threads for parallel computation, we also let GBScleanR use 32 threads for a fair comparison of running time. As LB-Impute does not support parallel computation and the main target of the running time comparison was GBScleanR versus magicImpute, LB-Impute was executed on a single thread.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="iyad055-s2">
    <title>Results</title>
    <sec id="iyad055-s2.1">
      <title>Evaluation using simulation data sets</title>
      <p>We first evaluated the 3 algorithms using the simulation data sets in the homoP2_F2, hetP2_F1, and homoP8_RIL scenarios (<xref rid="iyad055-F1" ref-type="fig">Fig. 1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 1</xref>). The superiority of GBScleanR lies in the IPO in which allele read biases and mismapping rates of markers are iteratively estimated. Thus, we also tested GBScleanR without IPO to demonstrate the effect of IPO on genotype estimation. In the homoP2_F2 scenario, GBScleanR with IPO scored the best correct call rates for almost all data sets (<xref rid="iyad055-F1" ref-type="fig">Fig. 1a–c</xref>). When the simulation data sets were generated without allowance to have no read at any markers in founders (indicated as “nonzero” in <xref rid="iyad055-F1" ref-type="fig">Fig. 1</xref>), LB-Impute showed the highest correct call rates for the data sets with a 0.1× offspring read depth. However, LB-Impute also scored the highest miscall rates for those data sets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 3a–c</xref>). These increases in miscall rates resulted in the reduction of the estimation accuracy that was measured as the proportion of correct calls over nonmissing calls (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4a–c</xref>). A reduction in accuracy was observed in all of the tested algorithms when no reads at some markers were allowed for founders (shown as “allowzero” in <xref rid="iyad055-F1" ref-type="fig">Fig. 1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4</xref>). Nevertheless, GBScleanR was less affected by the markers with 0 reads in founders and outperformed the other algorithms. In addition, GBScleanR with IPO only increased the correct call rate as offspring read depth increased, while the other algorithms showed a plateau at 0.5–20× in the results for the “nonzero” data sets (<xref rid="iyad055-F1" ref-type="fig">Fig. 1a–c</xref>). The difference in the correct call rate between GBScleanR with IPO and the other algorithms reached more than 25 percentage points at maximum in the data with a 20× offspring read depth. On the other hand, the algorithms except for GBScleanR with IPO showed an increase in the miscall rate as the read depth increased (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 3a–c</xref>). The increase in the miscall rate resulted in the reduction of the estimation accuracy as the read depth increased (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4a–c</xref>).</p>
      <fig position="float" id="iyad055-F1" fig-type="figure">
        <label>Fig. 1.</label>
        <caption>
          <p>Offspring genotype estimation accuracies for the simulation data. The plots show correct call rates for the data sets with given read depths for offspring (<italic toggle="yes">x</italic>-axis) in the homoP2_F2 (a–c), hetP2_F1 (d–f), and homoP8_RIL (g–i) scenarios. The rows of the panels indicate the differences in the number of samples in the simulated data, as shown in the strips on the right. Solid lines and dashed lines represent the results for the data sets with (allowzero) or without (nonzero) missing founder reads. “GBSR” and “GBSR_noIPO” represent GBScleanR with and without IPO. “LB” and “Magic” indicate LB-Impute and magicImpute, respectively.</p>
        </caption>
        <graphic xlink:href="iyad055f1" position="float"/>
      </fig>
      <p>Similar to the results in homoP2_F2, GBScleanR showed the best correct call rates in almost all data sets of hetP2_F1, and the difference between the algorithms reached more than 25 percentage points at maximum (<xref rid="iyad055-F1" ref-type="fig">Fig. 1d–f</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4d–f</xref>). Unlike the homoP2_F2 data sets, the genotype estimation accuracy for the hetP2_F1 data sets was highly affected by the number of samples. The increase in the correct call rate between the data sets with 10 and 1,000 samples reached ∼26 percentage points at maximum in the hetP2_F1 data sets with a 3× offspring read depth, whereas the maximum increase in the score in the homoP2_F2 data sets was ∼14 percentage points (<xref rid="sup1" ref-type="supplementary-material">Supplementary Data 1</xref>).</p>
      <p>Unlike the F2 data sets, we could not find any remarkable difference in the accuracy of genotype estimation for the homoP8_RIL data sets (<xref rid="iyad055-F1" ref-type="fig">Fig. 1g–i</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4g–i</xref>). This result seems to have reflected the higher homozygosity in the simulated genotypes. Since the offspring in the homoP8_RIL data sets had homozygotes at almost all markers due to repeated self-fertilization, only the reads of either allele representing the true genotype could be observed at any markers.</p>
      <p>To compare the performance of the algorithms in the cases where no allele read bias and mismapping exist in data, we simulated data sets without assuming allele read bias and mismapping for generating read count data. All 3 algorithms scored almost the same estimation accuracy for the nonerror data sets and did not show any reduction of the accuracy even if read depth increased in any scenarios (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 5</xref> and <xref rid="sup1" ref-type="supplementary-material">Data 2</xref>).</p>
      <p>GBScleanR and magicImpute have been designed to simultaneously estimate the genotypes of both founders and offspring. In addition, both algorithms provide phasing information for the offspring genotypes. As expected from the estimation accuracy for offspring, GBScleanR also outperformed magicImpute in the estimation of founder genotypes and phased offspring genotypes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs. 6 and 7</xref>). The details were described in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Results</xref>.</p>
    </sec>
    <sec id="iyad055-s2.2">
      <title>Less biased estimation by GBScleanR</title>
      <p>We further evaluated the quality of the estimated genotypes by visualizing the estimated genotype ratio at each marker. This visual inspection employed the “nonzero” homoP2_F2 data sets that have 1,000 offspring with offspring read depths at 0.5×, 3×, and 20×. In an <italic toggle="yes">F</italic><sub>2</sub> population derived from inbred parents, we can expect a 1:2:1 genotype ratio in offspring if no segregation distortion occurs. As shown in <xref rid="iyad055-F2" ref-type="fig">Fig. 2</xref>, the estimations by GBScleanR showed 1:2:1 segregation at almost all markers, which nearly completely overlapped with the true genotype ratio throughout the chromosome, except for the data set with 0.5× offspring reads (<xref rid="iyad055-F2" ref-type="fig">Fig. 2a–c</xref>). In addition, miscalls were distributed almost uniformly throughout the entire chromosome, with a very small amount per marker. In contrast, LB-Impute showed severely biased genotype ratios with high miscall rates clustered at several loci on the chromosome (<xref rid="iyad055-F2" ref-type="fig">Fig. 2d–f</xref>). The increase in offspring read depth made biased genotype estimation more severe and increased miscall rates, as also shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 3</xref>. Similar results were observed in the case of magicImpute (<xref rid="iyad055-F2" ref-type="fig">Fig. 2g–i</xref>). Even though fewer miscalls were generated in magicImpute compared to LB-Impute, many regions showed a biased estimation of reference homozygotes particularly in the data set with 0.5× offspring read depth (<xref rid="iyad055-F2" ref-type="fig">Fig. 2g</xref>). The loci showing higher miscall rates overlapped between the plots for LB-Impute and magicImpute. Thus, these miscalls and biased genotype estimations might be caused by error-prone markers. Similar results were observed in the data sets with 10 and 100 offspring (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs. 8 and 9</xref>). Although the true genotypes did not show a 1:2:1 ratio due to the small population size in the data sets with 10 offspring, GBScleanR showed the estimated genotype ratios that highly overlapped with the true ratios (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 8a–c</xref>). These results demonstrated the robustness of genotype estimation by GBScleanR even at error-prone markers.</p>
      <fig position="float" id="iyad055-F2" fig-type="figure">
        <label>Fig. 2.</label>
        <caption>
          <p>Genotype ratios at markers ordered along a simulated chromosome. The plots show genotype ratios calculated from the estimated genotype data for the homoP2_F2 data set with 1,000 offspring and 620 markers with offspring read depths at 0.5×, 3×, and 20× without allowance of no reads in founders. “GBSR” (a–c), “LB” (d–f), and “Magic” (g–i) indicate genotypes estimated by GBScleanR, LB-Impute, and magicImpute, respectively. Proportions of reference homozygous, heterozygous, and alternative homozygous genotypes are represented by green, magenta, and blue lines, respectively. Orange lines indicate miscall rates at markers. True genotype ratios are indicated by transparent lines in the panels for GBScleanR (a–c).</p>
        </caption>
        <graphic xlink:href="iyad055f2" position="float"/>
      </fig>
    </sec>
    <sec id="iyad055-s2.3">
      <title>Evaluation using real data</title>
      <p>We finally evaluated the algorithms using real data containing error-prone markers. First, we measured the concordance rate of the estimated genotype calls using the masked genotype data created from the real data. GBScleanR scored the best concordance rate in all chromosomes except for chromosome 11 in comparison with LB-Impute and magicImpute (<xref rid="iyad055-F3" ref-type="fig">Fig. 3a</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 5</xref>). Relatively large differences were observed in chromosomes 7, 8, and 10, in which GBScleanR scored 10.5, 12.5, and 12.0 percentage points higher concordance rates than magicImpute, respectively. On the other hand, chromosome 5 showed only a 1.7 percentage point difference between GBScleanR and magicImpute. Relatively low concordance rates were observed in the chromosomes with more severe allele read biases, which were chromosomes 7–12, than those in the other chromosomes (<xref rid="iyad055-F3" ref-type="fig">Fig. 3a</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref>).</p>
      <fig position="float" id="iyad055-F3" fig-type="figure">
        <label>Fig. 3.</label>
        <caption>
          <p>Evaluation of genotype estimation accuracy using the real data. a) Concordance rates of true genotype calls and estimated genotype calls at masked genotype calls are shown for each chromosome. The averages of the missing rate (b), the number of recombinations (c), and the segregation distortion level (d) are also visualized as bar plots for each chromosome. Blue, gray, and magenta bars indicate the values of GBScleanR (GBSR), LB-Impute (LB), and magicImpute (Magic), respectively.</p>
        </caption>
        <graphic xlink:href="iyad055f3" position="float"/>
      </fig>
      <p>Even though GBScleanR showed better concordance rates than the others, the genotype concordance does not directly mean higher accuracy because we cannot know the true genotype of the real data, and there is no evidence of whether the genotype calls selected for masking were truly reliable or contained a large number of erroneous genotype calls. To further evaluate the performance of the algorithms, we then calculated the average missing rate and the number of recombinations in each chromosome. In the case of the missing rate, the highest values were scored by magicImpute for all chromosomes, while GBScleanR and LB-Impute showed similar scores in a majority of chromosomes (<xref rid="iyad055-F3" ref-type="fig">Fig. 3b</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 5</xref>). Similar to the concordance rate, chromosomes with more severe allele read biases showed higher missing rates. A clear difference between the algorithms was observed in the number of recombinations (<xref rid="iyad055-F3" ref-type="fig">Fig. 3c</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 5</xref>). LB-Impute always estimated the most frequent recombinations, followed by magicImpute, whereas GBScleanR showed the fewest numbers of recombinations on all chromosomes. To further evaluate the recombination events, we measured the genomic segment lengths between the recombination breakpoints in chromosomes (<xref rid="iyad055-T2" ref-type="table">Table 2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 6</xref>). We found that LB-Impute estimated many more short segments. The genotype data estimated by GBScleanR had 116 and 430 segments in the ranges of 0–1 and 1–2 Mb, respectively (<xref rid="iyad055-T2" ref-type="table">Table 2</xref>). On the other hand, LB-Impute estimated the genotype data with 2,164 and 4,166 segments ranging 0-1 and 1-2 Mb, respectively. The magicImpute algorithm generated fewer short segments than LB-Impute but a larger number than GBScleanR, which were 627 and 1,716, respectively. In addition, GBScleanR, magicImpute, and LB-Impute estimated 14, 235, and 948 segments ranging 0-1 Mb that were heterozygous and flanked by the same homozygous genotypes at both sides, which indicated double crossovers within 1-Mb stretches (<xref rid="iyad055-T2" ref-type="table">Table 2</xref>). The probability of a double crossover within 1 Mb is ∼0.08% when 1 Mb equals 4 cM in an <italic toggle="yes">F</italic><sub>2</sub> population. Thus, the expected number of double crossovers is &lt; 2 in the population with 814 individuals derived from 1,628 gametes. Even though the 14 double crossovers within 1-Mb stretches generated by GBScleanR were too frequent for an ideal <italic toggle="yes">F</italic><sub>2</sub> population, considering the distant cross to generate the given population, these results suggested that GBScleanR estimated more probable and acceptable numbers of recombinations. The excess crossovers over short distances seemed to artificially push up the numbers of recombinations in the estimated genotype data of LB-Impute and magicImpute.</p>
      <table-wrap position="float" id="iyad055-T2">
        <label>Table 2.</label>
        <caption>
          <p>The number of genome segments.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1"/>
              <th colspan="2" align="center" rowspan="1">Segment length</th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1">0–1 Mb</th>
              <th align="center" rowspan="1" colspan="1">1–2 Mb</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="3" colspan="1">Total<italic toggle="yes"><sup><xref rid="iyad055-tblfn1" ref-type="table-fn">a</xref></sup></italic></td>
              <td rowspan="1" colspan="1">GBScleanR</td>
              <td rowspan="1" colspan="1">116</td>
              <td rowspan="1" colspan="1">430</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">magicImpute</td>
              <td rowspan="1" colspan="1">627</td>
              <td rowspan="1" colspan="1">1,716</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">LB-Impute</td>
              <td rowspan="1" colspan="1">2,164</td>
              <td rowspan="1" colspan="1">4,166</td>
            </tr>
            <tr>
              <td rowspan="3" colspan="1">Double crossovers<italic toggle="yes"><sup><xref rid="iyad055-tblfn2" ref-type="table-fn">b</xref></sup></italic></td>
              <td rowspan="1" colspan="1">GBScleanR</td>
              <td rowspan="1" colspan="1">14</td>
              <td rowspan="1" colspan="1">40</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">magicImpute</td>
              <td rowspan="1" colspan="1">235</td>
              <td rowspan="1" colspan="1">558</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">LB-Impute</td>
              <td rowspan="1" colspan="1">948</td>
              <td rowspan="1" colspan="1">1,395</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="iyad055-tblfn1">
            <p>The total number of genome segments that have a same genotype continuously with the length of 0–1 or 1–2 Mb.</p>
          </fn>
          <fn id="iyad055-tblfn2">
            <p>The number of genome segments that have a heterozygous genotype continuously with the length of 0–1 or 1–2 Mb and flanked by homozygous segments of a same allele.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Finally, we measured the segregation distortion level (<xref rid="iyad055-F3" ref-type="fig">Fig. 3d</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 5</xref>). A relatively low distortion level was observed in the genotype data estimated via GBScleanR compared with those estimated by LB-Impute and magicImpute (<xref rid="iyad055-F3" ref-type="fig">Fig. 3d</xref>). Chromosome 1 was the most distorted in the genotype data estimated by GBScleanR, while the other algorithms also showed similar distortion levels in this chromosome. On the other hand, the highest distortion level was observed in chromosome 7 in the cases of LB-Impute and magicImpute (<xref rid="iyad055-F3" ref-type="fig">Fig. 3d</xref>). Unlike chromosome 1, GBScleanR showed a much smaller distortion level that was approximately half of the levels scored by the other algorithms. In contrast, the 3 algorithms all resulted in the mildest distortion in chromosome 3 (<xref rid="iyad055-F3" ref-type="fig">Fig. 3d</xref>). To visually inspect the segregation distortion levels, we created line plots of the estimated genotype ratios for chromosomes 1, 3, and 7 (<xref rid="iyad055-F4" ref-type="fig">Fig. 4</xref>). The line plots indicated that all of the algorithms estimated quite similar genotypes for chromosomes 1 and 3, while clearer differences were observed in the plots for chromosome 7. As fewer markers on chromosomes 1 and 3 showed severe allele read biases, these chromosomes might have fewer error-prone markers (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref>). Therefore, all of the algorithms resulted in similar estimations (<xref rid="iyad055-F4" ref-type="fig">Fig. 4a–f</xref>). Since all algorithms showed similar distortion patterns around 30 Mb of chromosome 1, the distortion on chromosome 1 was likely to be the true genetic characteristic of this population but not due to the misestimation (<xref rid="iyad055-F4" ref-type="fig">Fig. 4a–c</xref>). On the other hand, slight distortions at 5, 10, and 35 Mb of chromosome 3 that were observed in the genotypes estimated by LB-Impute and magicImpute, but not by GBScleanR, might be artifacts produced by biased estimations at error-prone markers (<xref rid="iyad055-F4" ref-type="fig">Fig. 4d–f</xref>). In the case of chromosome 7, LB-Impute and magiImpute obviously failed to estimate the genotypes and produced artificially distorted genotype ratio patterns (<xref rid="iyad055-F4" ref-type="fig">Fig. 4g–i</xref>). In contrast, GBScleanR showed a smooth and less fluctuating change in the genotype ratio, which was an acceptable pattern as the genotype ratio of an <italic toggle="yes">F</italic><sub>2</sub> population, throughout the chromosome, although severe distortion was observed, probably due to the true segregation distortion (<xref rid="iyad055-F4" ref-type="fig">Fig. 4i</xref>). The other chromosomes also exhibited similar results to those observed for chromosomes 1, 3, and 7 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 10</xref>). LB-Impute and magicImpute always resulted in highly biased genotype estimations at many loci and fluctuated genotype ratios throughout the chromosomes. In clear contrast to those results, GBScleanR showed relatively smooth and gradual changes in the genotype ratios throughout the chromosomes. Even though some loci showed distorted genotype ratios, the majority of chromosomal regions had ratios relatively close to 1:2:1 in almost all chromosomes in the GBScleanR results compared with those of the other algorithms. Overall, the performance evaluation on the real data demonstrated the superiority and robustness of GBScleanR against error-prone markers.</p>
      <fig position="float" id="iyad055-F4" fig-type="figure">
        <label>Fig. 4.</label>
        <caption>
          <p>Genotype ratio of estimated offspring genotypes in the real data. Genotype ratios at markers along chromosomes 1 (a–c), 3 (d–f), and 7 (g–i) in the real data are shown as line plots. “LB,” “Magic,” and “GBSR” indicate LB-Impute, magicImpute, and GBScleanR, respectively. Proportions of the reference homozygous, heterozygous, and alternative homozygous genotypes are represented by green, magenta, and blue lines, respectively.</p>
        </caption>
        <graphic xlink:href="iyad055f4" position="float"/>
      </fig>
    </sec>
    <sec id="iyad055-s2.4">
      <title>Effect of the iterative optimization for allele read biases and mismapping rates</title>
      <p>In addition to demonstrating the superiority of GBScleanR, we tested the effect of IPO on genotype estimation by switching on and off the iterative calculations for either or both of allele read biases and mismapping rates. As already shown, GBScleanR with no IPO (noIPO) led to a reduction in the estimation accuracy for the simulation data sets of homoP2_F2 and hetP2_F1 compared with GBScleanR with IPO (withIPO) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F1" ref-type="fig">1</xref>). On the other hand, when only the iterative optimization for the marker-specific mismapping rate was turned off (fixMismap), no remarkable difference was observed. Interestingly, only turning off the iterative optimization of marker-specific allele read bias (fixBias) resulted in even worse accuracy than noIPO. The reduction of accuracy by the fixBias setting might be caused by misestimation of the mismapping rates that were inferred based on genotype data containing miscalls generated due to the assumption of the fixed allele read bias. Similar to the comparison between GBScleanR and magicImpute, the homoP8_RIL showed no remarkable difference even with or without IPO (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F1" ref-type="fig">1</xref>).</p>
      <p>Unlike the cases in the simulation data sets, the real data showed that not only the fixBias and noIPO settings but also the fixMismap setting might result in less accurate estimation (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F2" ref-type="fig">2</xref> and <xref rid="sup1" ref-type="supplementary-material">Data 7</xref>). Although we cannot know the true genotype of the real data, the fixMismap showed lesser smooth lines in the plots and more severe genotype distortions than the withIPO setting (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F2" ref-type="fig">2</xref>). All of the metrics including the concordance rate and the recombination rate indicated the superiority of the withIPO setting over the other settings (<xref rid="sup1" ref-type="supplementary-material">Supplementary Data 7</xref>). These results indicated that the real data may have a nonrandom pattern of the mismapping-prone marker distribution, and the iterative optimizations for both allele read biases and mismapping rates are required for proper genotype estimation. GBScleanR with IPO showed robustness against both types of errors.</p>
    </sec>
    <sec id="iyad055-s2.5">
      <title>Comparing running time</title>
      <p>We also compared running times using the simulation data sets. As shown in <xref rid="iyad055-T3" ref-type="table">Table 3</xref>, GBScleanR completed all processes of genotype estimation faster than LB-Impute and magicImpute for the simulation data sets of biparental populations, including homoP2_F2 and hetP2_F1. In the case of the largest homoP2_F2 data set that consists of 1,000 samples, GBScleanR took only 17 s even with 4 cycles of IPO, while magicImpute and LB-Impute consumed 6.4 and 122.7 times as long. On the other hand, a 2.1-times longer calculation at the maximum was observed in GBScleanR with 4 cycles of IPO compared to magicImpute for the homoP8_RIL data sets (<xref rid="iyad055-T3" ref-type="table">Table 3</xref>). Nevertheless, IPO was not required for RIL populations, as shown in <xref rid="iyad055-F1" ref-type="fig">Fig. 1</xref>, and GBScleanR without IPO could finish the calculations 48% faster than magicImpute even in the homoP8_RIL data set with 1,000 samples.</p>
      <table-wrap position="float" id="iyad055-T3">
        <label>Table 3.</label>
        <caption>
          <p>Running time.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Data set</th>
              <th align="center" rowspan="1" colspan="1">No. of samples</th>
              <th align="center" rowspan="1" colspan="1">GBScleanR<italic toggle="yes"><sup><xref rid="iyad055-tblfn4" ref-type="table-fn">a</xref></sup></italic></th>
              <th align="center" rowspan="1" colspan="1">magicImpute</th>
              <th align="center" rowspan="1" colspan="1">LB-Impute</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">homoP2_F2</td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">2 (1)</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">23</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">homoP2_F2</td>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">3 (1)</td>
              <td rowspan="1" colspan="1">14</td>
              <td rowspan="1" colspan="1">211</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">homoP2_F2</td>
              <td rowspan="1" colspan="1">1,000</td>
              <td rowspan="1" colspan="1">17 (8)</td>
              <td rowspan="1" colspan="1">108</td>
              <td rowspan="1" colspan="1">2,086</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">hetP2_F1</td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">4 (2)</td>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">hetP2_F1</td>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">11 (4)</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">hetP2_F1</td>
              <td rowspan="1" colspan="1">1,000</td>
              <td rowspan="1" colspan="1">81 (24)</td>
              <td rowspan="1" colspan="1">170</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">homoP8_RIL</td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">36 (9)</td>
              <td rowspan="1" colspan="1">98</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">homoP8_RIL</td>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">205 (50)</td>
              <td rowspan="1" colspan="1">336</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">homoP8_RIL</td>
              <td rowspan="1" colspan="1">1,000</td>
              <td rowspan="1" colspan="1">1,736 (432)</td>
              <td rowspan="1" colspan="1">829</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="iyad055-tblfn3">
            <p>Running times in seconds for each data set are shown.</p>
          </fn>
          <fn id="iyad055-tblfn4">
            <p>The numbers in parenthesis indicate the running times of GBScleanR without the IPO.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="discussion" id="iyad055-s3">
    <title>Discussion</title>
    <p>GBScleanR is an R package and consists of a main tool that conducts error correction and utility functions that handle genotype data in the variant call format (VCF). <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 13</xref> presents the data analysis workflow and the related functions that are implemented in GBScleanR. The algorithm is designed to estimate the true genotype calls along chromosomes from the given allele read counts in a VCF file that is generated by SNP callers such as GATK and TASSEL-GBS (<xref rid="iyad055-B19" ref-type="bibr">McKenna <italic toggle="yes">et al.</italic> 2010</xref>; <xref rid="iyad055-B12" ref-type="bibr">Glaubitz <italic toggle="yes">et al.</italic> 2014</xref>). The current implementation supports genotypic data for mapping populations that are derived from 2 or more diploid founders followed by selfings, sibling crosses, or random crosses, for example, <italic toggle="yes">F</italic><sub>2</sub>- and 8-way RILs. Our method assumes that markers are biallelic and ordered along the chromosomes and the reads are mapped onto a reference genome sequence. To access the large amounts of genotype data required, an input VCF file is first converted into a genomic data structure (GDS) file (<xref rid="iyad055-B33" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2012</xref>). This conversion automatically filters out nonbiallelic markers. GBScleanR provides functions for data visualization, filtering, and loading/writing a VCF file. Furthermore, the data structure of the GDS file created via this package is compatible with that used in the SeqArray package and can be further converted to a derivative GDS format used in the SNPRelate, GWASTools, and GENESIS packages, which are designed to handle large amounts of variant data and conduct regression analysis (<xref rid="iyad055-B13" ref-type="bibr">Gogarten <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="iyad055-B14" ref-type="bibr">2019</xref>; <xref rid="iyad055-B33" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="iyad055-B32" ref-type="bibr">2017</xref>). Therefore, GBScleanR can be built in a pipeline for a genetic study that allows us smooth access to the given large genotype data for visualization, filtering, error correction, and regression analysis without the requirement for extra data format conversion steps.</p>
    <p>The present study introduced an algorithm to provide robust error correction on genotype data with error-prone markers. Any genotype data derived from GBS or other RRS-based genotyping techniques have the chance to contain such error-prone markers even after trying to filter out erroneous markers. Particularly, a population derived from a cross between distant relatives, as in our case in which a cultivated rice <italic toggle="yes">O. sativa</italic> and a wild rice <italic toggle="yes">O. longistaminata</italic> were crossed, may potentially have a relatively high proportion of error-prone markers. If a model uniformly assumes a 50% chance of obtaining a read for either allele for all markers at a heterozygous site, any HMM-based methods and sliding window methods can theoretically be deceived by the error-prone markers. In addition, erroneous genotype calls induced by mismapping easily mess up genotype data and lead to unexpected detection of heterozygous genotypes and overrepresented recombination events. Since we could not distinguish which reads were mismapped reads in the real data and had no clue to estimate the true pattern of mismappings, we assumed a random distribution of mismapping-prone markers in the data simulation. Those randomly distributed mismapping-prone markers did not show any remarkable effect on the estimation accuracy even with the fixMismap setting (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F1" ref-type="fig">1</xref>). On the other hand, mimicked marker-specific allele read biases caused the reduction in the estimation accuracy with the fixBias and noIPO settings (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F1" ref-type="fig">1</xref>). However, the fixMismap setting resulted in less reliable genotype estimation than the withIPO setting for the real data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F2" ref-type="fig">2</xref> and <xref rid="sup1" ref-type="supplementary-material">Data 7</xref>). These results indicate that real data seem to have a specific pattern of error-prone marker distribution that interferes with proper genotype estimation. The distribution of error-prone markers would be different between given populations and affected by actual biological variations that exist in given genomes. Our study indicated the importance to incorporate marker-specific error patterns in the HMM for accurate genotype estimation and demonstrated the superiority and robustness of GBScleanR. The distortion level and the recombination frequency have large effects on downstream genetic analyses, and those values themselves are research targets. Any genetic and genomic study relies on the given genotype data, and the accuracy of genotyping has a crucial effect on the quality of such research. The accuracy of genotyping can be evaluated by 3 criteria: correct calls, miscalls, and missing calls. Usually, miscalls have a more destructive effect on post-genotyping analyses than missing calls because post-genotyping analyses regularly suppose all genotype calls to be true even if those include miscalls and potentially generate misleading results. Furthermore, if the wrongly genotyped markers are clustered in a particular region, all statistical calculations for that region will be unreliable. Our study also demonstrated the reliability of GBScleanR as a support tool for genetic studies that handle genotype data even with or without error-prone markers.</p>
    <p>In this study, we conducted filtering based on a quantile of read counts for the real data to filter out genotype calls supported by overrepresented sequences that are possibly derived from paralogous and repetitive sequences. A large number of overrepresented mismapped reads do not increase the reliability of genotype calls but rather cause misestimation of homozygotes as heterozygotes. Although GBScleanR tries to detect mismapped reads, we recommend filtering out overrepresented reads to reduce their negative impact on estimation. Nevertheless, GBScleanR accepts error-prone markers and recognizes the error pattern via IPO. Therefore, no strict filtering based on allele frequency and the missing rate is required, which is regularly performed for RRS-based genotyping data (<xref rid="iyad055-B16" ref-type="bibr">Kim <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyad055-B26" ref-type="bibr">Scheben <italic toggle="yes">et al.</italic> 2017</xref>). These filtering steps usually remove a large number of the detected SNP markers (<xref rid="iyad055-B11" ref-type="bibr">Gardner <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="iyad055-B22" ref-type="bibr">Pootakham <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="iyad055-B5" ref-type="bibr">Celik <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyad055-B3" ref-type="bibr">Boyles <italic toggle="yes">et al.</italic> 2017</xref>). In the case of our real data, filtering to remove possible error-prone markers based on, for example, minor allele frequency &lt;5% and missing rate &gt;20%, left only 162 out of 5,035 SNPs. Markers that would be filtered out may contain partial information about the true genotypes. GBScleanR can integrate those less informative markers into the error correction process by tweaking the HMM. Since there is no clear guideline for filtering strength, which should differ depending on the data set used, filtering criteria are left in the hands of researchers. GBScleanR allows users to skip such an arbitrary step and improves the cost efficiency of the RRS-based genotyping system by reducing the number of unused reads obtained via costly NGS.</p>
    <p>As GBScleanR requires the SNP markers ordered along chromosomes, reference genome sequences are a fundamental resource. The recent remarkable development of the third-generation sequencers, named Sequel by Pacific Bioscience and MinION by Oxford Nanopore Technologies, enables us to obtain high-quality genome sequences at a reasonable cost (<xref rid="iyad055-B24" ref-type="bibr">Rhoads and Au 2015</xref>; <xref rid="iyad055-B18" ref-type="bibr">Lu <italic toggle="yes">et al.</italic> 2016</xref>). Reference genome information for any organism is expected to become available soon. Thus, RRS-based genotyping systems underpinned by a flexible robust error correction tool such as GBScleanR will become practical platforms for use in breeding programs requiring a prompt and efficient scheme under limited periods and budgets. Distant relatives, including the ancestral wild species of domesticated species, are important genetic resources, particularly in plant breeding, that can improve abiotic and biotic stress resistance (<xref rid="iyad055-B1" ref-type="bibr">Atwell <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="iyad055-B17" ref-type="bibr">Kole <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="iyad055-B4" ref-type="bibr">Brozynska <italic toggle="yes">et al.</italic> 2016</xref>). For such genetic studies and breeding projects using wild species, GBScleanR could be the first choice as a fundamental tool for genotype identification coupled with an RRS-based genotyping system.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>iyad055_Supplementary_Data</label>
      <media xlink:href="iyad055_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec sec-type="data-availability" id="iyad055-s4">
    <title>Data availability</title>
    <p>The stable version of GBScleanR is available on Bioconductor (<ext-link xlink:href="https://bioconductor.org/packages/GBScleanR/" ext-link-type="uri">https://bioconductor.org/packages/GBScleanR/</ext-link>). The latest developmental version is available on GitHub (<ext-link xlink:href="https://github.com/tomoyukif/GBScleanR" ext-link-type="uri">https://github.com/tomoyukif/GBScleanR</ext-link>). This package and the source code are distributed under GNU General Public License version 3. The vcf file of the real data and R scripts for the data analyses performed in this study are also available on GitHub (<ext-link xlink:href="https://github.com/tomoyukif/GBSR_SupFiles" ext-link-type="uri">https://github.com/tomoyukif/GBSR_SupFiles</ext-link>). Further description of the sequencing reads for the real data can be found in <xref rid="iyad055-B10" ref-type="bibr">Furuta <italic toggle="yes">et al.</italic> (2017)</xref>.</p>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplemental material</xref> available at <italic toggle="yes">GENETICS</italic> online.</p>
  </sec>
  <sec id="iyad055-s5">
    <title>Funding</title>
    <p>This work was supported by the CREST program of the Japan Science and Technology Agency (JPMJCR13B1 to M.A.); the SATREPS program in collaboration with the Japan Science and Technology Agency and the Japan International Cooperation Agency (JPMJSA1706 to T.F. and M.A.); KAKENHI of the Ministry of Education, Culture, Sports, Science and Technology of Japan (JP20H05912 to M.A.); and KAKENHI of Japan Society for the Promotion of Science (JP20K15503 to T.F. and JP20H02958 to T.Y.).</p>
  </sec>
  <sec sec-type="COI-statement" id="iyad055-s6">
    <title>Conflicts of interest statement</title>
    <p>The author(s) declare no conflict of interest.</p>
  </sec>
  <sec id="iyad055-s7">
    <title>Author contributions</title>
    <p>T.F. conceived and designed the study. T.F. also developed the R package, conducted bioinformatics analysis, and drafted the manuscript. M.A. and T.Y. supervised the study. All authors read and approved the final version of the manuscript.</p>
  </sec>
  <ref-list id="ref1">
    <title>Literature cited</title>
    <ref id="iyad055-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Atwell</surname><given-names>BJ</given-names></string-name>, <string-name><surname>Wang</surname><given-names>H</given-names></string-name>, <string-name><surname>Scafaro</surname><given-names>AP</given-names></string-name></person-group>. <article-title>Could abiotic stress tolerance in wild relatives of rice be used to improve <italic toggle="yes">Oryza sativa</italic>?</article-title><source>Plant Sci</source>. <year>2014</year>;<volume>215–216</volume>:<fpage>48</fpage>–<lpage>58</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.plantsci.2013.10.007</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baird</surname><given-names>NA</given-names></string-name>, <string-name><surname>Etter</surname><given-names>PD</given-names></string-name>, <string-name><surname>Atwood</surname><given-names>TS</given-names></string-name>, <string-name><surname>Currey</surname><given-names>MC</given-names></string-name>, <string-name><surname>Shiver</surname><given-names>AL</given-names></string-name>, <string-name><surname>Lewis</surname><given-names>ZA</given-names></string-name>, <string-name><surname>Selker</surname><given-names>EU</given-names></string-name>, <string-name><surname>Cresko</surname><given-names>WA</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>EA</given-names></string-name></person-group>. <article-title>Rapid SNP discovery and genetic mapping using sequenced RAD markers</article-title>. <source>PLoS One</source><year>2008</year>;<volume>3</volume>(<issue>10</issue>):<comment>e3376</comment>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0003376</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boyles</surname><given-names>RE</given-names></string-name>, <string-name><surname>Pfeiffer</surname><given-names>BK</given-names></string-name>, <string-name><surname>Cooper</surname><given-names>EA</given-names></string-name>, <string-name><surname>Zielinski</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Myers</surname><given-names>MT</given-names></string-name>, <string-name><surname>Rooney</surname><given-names>WL</given-names></string-name>, <string-name><surname>Kresovich</surname><given-names>S</given-names></string-name></person-group>. <article-title>Quantitative trait loci mapping of agronomic and yield traits in two grain Sorghum biparental families</article-title>. <source>Crop Sci</source>. <year>2017</year>;<volume>57</volume>(<issue>5</issue>):<fpage>2443</fpage>–<lpage>2456</lpage>. doi:<pub-id pub-id-type="doi">10.2135/cropsci2016.12.0988</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brozynska</surname><given-names>M</given-names></string-name>, <string-name><surname>Furtado</surname><given-names>A</given-names></string-name>, <string-name><surname>Henry</surname><given-names>RJ</given-names></string-name></person-group>. <article-title>Genomics of crop wild relatives: expanding the gene pool for crop improvement</article-title>. <source>Plant Biotechnol J</source>. <year>2016</year>;<volume>14</volume>(<issue>4</issue>):<fpage>1070</fpage>–<lpage>1085</lpage>. doi:<pub-id pub-id-type="doi">10.1111/pbi.12454</pub-id>.<pub-id pub-id-type="pmid">26311018</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Celik</surname><given-names>I</given-names></string-name>, <string-name><surname>Bodur</surname><given-names>S</given-names></string-name>, <string-name><surname>Frary</surname><given-names>A</given-names></string-name>, <string-name><surname>Doganlar</surname><given-names>S</given-names></string-name></person-group>. <article-title>Genome-wide SNP discovery and genetic linkage map construction in sunflower (<italic toggle="yes">Helianthus annuus</italic> L.) using a genotyping by sequencing (GBS) approach</article-title>. <source>Mol Breeding</source><year>2016</year>;<volume>36</volume>(<issue>9</issue>):<fpage>1</fpage>–<lpage>9</lpage>. doi:<pub-id pub-id-type="doi">10.1007/s11032-016-0558-8</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DaCosta</surname><given-names>JM</given-names></string-name>, <string-name><surname>Sorenson</surname><given-names>MD</given-names></string-name></person-group>. <article-title>Amplification biases and consistent recovery of loci in a double-digest RAD-seq protocol</article-title>. <source>PLoS One</source><year>2014</year>;<volume>9</volume>(<issue>9</issue>):<comment>e106713</comment>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0106713</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davey</surname><given-names>JW</given-names></string-name>, <string-name><surname>Cezard</surname><given-names>T</given-names></string-name>, <string-name><surname>Fuentes-Utrilla</surname><given-names>P</given-names></string-name>, <string-name><surname>Eland</surname><given-names>C</given-names></string-name>, <string-name><surname>Gharbi</surname><given-names>K</given-names></string-name>, <string-name><surname>Blaxter</surname><given-names>ML</given-names></string-name></person-group>. <article-title>Special features of RAD sequencing data: implications for genotyping</article-title>. <source>Mol Ecol</source>. <year>2013</year>;<volume>22</volume>(<issue>11</issue>):<fpage>3151</fpage>–<lpage>3164</lpage>. doi:<pub-id pub-id-type="doi">10.1111/mec.12084</pub-id>.<pub-id pub-id-type="pmid">23110438</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elshire</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Glaubitz</surname><given-names>JC</given-names></string-name>, <string-name><surname>Sun</surname><given-names>Q</given-names></string-name>, <string-name><surname>Poland</surname><given-names>JA</given-names></string-name>, <string-name><surname>Kawamoto</surname><given-names>K</given-names></string-name>, <string-name><surname>Buckler</surname><given-names>ES</given-names></string-name>, <string-name><surname>Mitchell</surname><given-names>SE</given-names></string-name></person-group>. <article-title>A robust, simple genotyping-by-sequencing (GBS) approach for high diversity species</article-title>. <source>PLoS One</source><year>2011</year>;<volume>6</volume>(<issue>5</issue>):<comment>e19379</comment>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0019379</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fragoso</surname><given-names>CA</given-names></string-name>, <string-name><surname>Heffelfinger</surname><given-names>C</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>H</given-names></string-name>, <string-name><surname>Dellaporta</surname><given-names>SL</given-names></string-name></person-group>. <article-title>Imputing genotypes in biallelic populations from low-coverage sequence data</article-title>. <source>Genetics</source><year>2016</year>;<volume>202</volume>(<issue>2</issue>):<fpage>487</fpage>–<lpage>495</lpage>. doi:<pub-id pub-id-type="doi">10.1534/genetics.115.182071</pub-id>.<pub-id pub-id-type="pmid">26715670</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Furuta</surname><given-names>T</given-names></string-name>, <string-name><surname>Ashikari</surname><given-names>M</given-names></string-name>, <string-name><surname>Jena</surname><given-names>KK</given-names></string-name>, <string-name><surname>Doi</surname><given-names>K</given-names></string-name>, <string-name><surname>Reuscher</surname><given-names>S</given-names></string-name></person-group>. <article-title>Adapting genotyping-by-sequencing for rice F2 populations</article-title>. <source>G3 (Bethesda)</source><year>2017</year>;<volume>7</volume>(<issue>3</issue>):<fpage>881</fpage>–<lpage>893</lpage>. doi:<pub-id pub-id-type="doi">10.1534/g3.116.038190</pub-id>.<pub-id pub-id-type="pmid">28082325</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gardner</surname><given-names>KM</given-names></string-name>, <string-name><surname>Brown</surname><given-names>P</given-names></string-name>, <string-name><surname>Cooke</surname><given-names>TF</given-names></string-name>, <string-name><surname>Cann</surname><given-names>S</given-names></string-name>, <string-name><surname>Costa</surname><given-names>F</given-names></string-name>, <string-name><surname>Bustamante</surname><given-names>C</given-names></string-name>, <string-name><surname>Velasco</surname><given-names>R</given-names></string-name>, <string-name><surname>Troggio</surname><given-names>M</given-names></string-name>, <string-name><surname>Myles</surname><given-names>S</given-names></string-name></person-group>. <article-title>Fast and cost-effective genetic mapping in apple using next-generation sequencing</article-title>. <source>G3 (Bethesda)</source><year>2014</year>;<volume>4</volume>(<issue>9</issue>):<fpage>1681</fpage>–<lpage>1687</lpage>. doi:<pub-id pub-id-type="doi">10.1534/g3.114.011023</pub-id>.<pub-id pub-id-type="pmid">25031181</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Glaubitz</surname><given-names>JC</given-names></string-name>, <string-name><surname>Casstevens</surname><given-names>TM</given-names></string-name>, <string-name><surname>Lu</surname><given-names>F</given-names></string-name>, <string-name><surname>Harriman</surname><given-names>J</given-names></string-name>, <string-name><surname>Elshire</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Sun</surname><given-names>Q</given-names></string-name>, <string-name><surname>Buckler</surname><given-names>ES</given-names></string-name></person-group>. <article-title>TASSEL-GBS: a high capacity genotyping by sequencing analysis pipeline</article-title>. <source>PLoS One</source><year>2014</year>;<volume>9</volume>(<issue>2</issue>):<comment>e90346</comment>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0090346</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gogarten</surname><given-names>SM</given-names></string-name>, <string-name><surname>Bhangale</surname><given-names>T</given-names></string-name>, <string-name><surname>Conomos</surname><given-names>MP</given-names></string-name>, <string-name><surname>Laurie</surname><given-names>CA</given-names></string-name>, <string-name><surname>McHugh</surname><given-names>CP</given-names></string-name>, <string-name><surname>Painter</surname><given-names>I</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name><surname>Crosslin</surname><given-names>DR</given-names></string-name>, <string-name><surname>Levine</surname><given-names>D</given-names></string-name>, <string-name><surname>Lumley</surname><given-names>T</given-names></string-name>, <etal>et al</etal></person-group><article-title>GWASTools: an R/Bioconductor package for quality control and analysis of genome-wide association studies</article-title>. <source>Bioinformatics</source><year>2012</year>;<volume>28</volume>(<issue>24</issue>):<fpage>3329</fpage>–<lpage>3331</lpage>. doi:<pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTS610</pub-id>.<pub-id pub-id-type="pmid">23052040</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gogarten</surname><given-names>SM</given-names></string-name>, <string-name><surname>Sofer</surname><given-names>T</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H</given-names></string-name>, <string-name><surname>Yu</surname><given-names>C</given-names></string-name>, <string-name><surname>Brody</surname><given-names>JA</given-names></string-name>, <string-name><surname>Thornton</surname><given-names>TA</given-names></string-name>, <string-name><surname>Rice</surname><given-names>KM</given-names></string-name>, <string-name><surname>Conomos</surname><given-names>MP</given-names></string-name></person-group>. <article-title>Genetic association testing using the GENESIS R/Bioconductor package</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>(<issue>24</issue>):<fpage>5346</fpage>–<lpage>5348</lpage>. <pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTZ567</pub-id><pub-id pub-id-type="pmid">31329242</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>X</given-names></string-name>, <string-name><surname>Feng</surname><given-names>Q</given-names></string-name>, <string-name><surname>Qian</surname><given-names>Q</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>Q</given-names></string-name>, <string-name><surname>Wang</surname><given-names>L</given-names></string-name>, <string-name><surname>Wang</surname><given-names>A</given-names></string-name>, <string-name><surname>Guan</surname><given-names>J</given-names></string-name>, <string-name><surname>Fan</surname><given-names>D</given-names></string-name>, <string-name><surname>Weng</surname><given-names>Q</given-names></string-name>, <string-name><surname>Huang</surname><given-names>T</given-names></string-name>, <etal>et al</etal></person-group><article-title>High-throughput genotyping by whole-genome resequencing</article-title>. <source>Genome Res</source>. <year>2009</year>;<volume>19</volume>(<issue>6</issue>):<fpage>1068</fpage>–<lpage>1076</lpage>. doi:<pub-id pub-id-type="doi">10.1101/gr.089516.108</pub-id>.<pub-id pub-id-type="pmid">19420380</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>C</given-names></string-name>, <string-name><surname>Guo</surname><given-names>H</given-names></string-name>, <string-name><surname>Kong</surname><given-names>W</given-names></string-name>, <string-name><surname>Chandnani</surname><given-names>R</given-names></string-name>, <string-name><surname>Shuang</surname><given-names>L-S</given-names></string-name>, <string-name><surname>Paterson</surname><given-names>AH</given-names></string-name></person-group>. <article-title>Application of genotyping by sequencing technology to a variety of crop breeding programs</article-title>. <source>Plant Sci</source>. <year>2016</year>;<volume>242</volume>:<fpage>14</fpage>–<lpage>22</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.plantsci.2015.04.016</pub-id>.<pub-id pub-id-type="pmid">26566821</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kole</surname><given-names>C</given-names></string-name>, <string-name><surname>Muthamilarasan</surname><given-names>M</given-names></string-name>, <string-name><surname>Henry</surname><given-names>R</given-names></string-name>, <string-name><surname>Edwards</surname><given-names>D</given-names></string-name>, <string-name><surname>Sharma</surname><given-names>R</given-names></string-name>, <string-name><surname>Abberton</surname><given-names>M</given-names></string-name>, <string-name><surname>Batley</surname><given-names>J</given-names></string-name>, <string-name><surname>Bentley</surname><given-names>A</given-names></string-name>, <string-name><surname>Blakeney</surname><given-names>M</given-names></string-name>, <string-name><surname>Bryant</surname><given-names>J</given-names></string-name>, <etal>et al</etal></person-group><article-title>Application of genomics-assisted breeding for generation of climate resilient crops: progress and prospects</article-title>. <source>Front Plant Sci</source>. <year>2015</year>;<volume>6</volume>:<fpage>563</fpage>. doi:<pub-id pub-id-type="doi">10.3389/fpls.2015.00563</pub-id>.<pub-id pub-id-type="pmid">26322050</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lu</surname><given-names>H</given-names></string-name>, <string-name><surname>Giordano</surname><given-names>F</given-names></string-name>, <string-name><surname>Ning</surname><given-names>Z</given-names></string-name></person-group>. <article-title>Oxford nanopore MinION sequencing and genome assembly</article-title>. <source>Genomics Proteomics Bioinformatics</source><year>2016</year>;<volume>14</volume>(<issue>5</issue>):<fpage>265</fpage>–<lpage>279</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.gpb.2016.05.004</pub-id>.<pub-id pub-id-type="pmid">27646134</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKenna</surname><given-names>A</given-names></string-name>, <string-name><surname>Hanna</surname><given-names>M</given-names></string-name>, <string-name><surname>Banks</surname><given-names>E</given-names></string-name>, <string-name><surname>Sivachenko</surname><given-names>A</given-names></string-name>, <string-name><surname>Cibulskis</surname><given-names>K</given-names></string-name>, <string-name><surname>Kernytsky</surname><given-names>A</given-names></string-name>, <string-name><surname>Garimella</surname><given-names>K</given-names></string-name>, <string-name><surname>Altshuler</surname><given-names>D</given-names></string-name>, <string-name><surname>Gabriel</surname><given-names>S</given-names></string-name>, <string-name><surname>Daly</surname><given-names>M</given-names></string-name>, <etal>et al</etal></person-group><article-title>The genome analysis toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source>. <year>2010</year>;<volume>20</volume>(<issue>9</issue>):<fpage>1297</fpage>–<lpage>1303</lpage>. doi:<pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B20">
      <mixed-citation publication-type="journal">Miao C, Fang J, Li D, Liang P, Zhang X, Yang J, Schnable JC, Tang H. Genotype-Corrector: improved genotype calls for genetic mapping in F2 and RIL populations. Sci Rep. 2018;8(1). doi:<pub-id pub-id-type="doi">10.1038/s41598-018-28294-0</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Poland</surname><given-names>JA</given-names></string-name>, <string-name><surname>Rife</surname><given-names>TW</given-names></string-name></person-group>. <article-title>Genotyping-by-sequencing for plant breeding and genetics</article-title>. <source>Plant Genome</source><year>2012</year>;<volume>5</volume>(<issue>3</issue>):<comment>plantgenome2012.05.0005</comment>. doi:<pub-id pub-id-type="doi">10.3835/plantgenome2012.05.0005</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pootakham</surname><given-names>W</given-names></string-name>, <string-name><surname>Jomchai</surname><given-names>N</given-names></string-name>, <string-name><surname>Ruang-areerate</surname><given-names>P</given-names></string-name>, <string-name><surname>Shearman</surname><given-names>JR</given-names></string-name>, <string-name><surname>Sonthirod</surname><given-names>C</given-names></string-name>, <string-name><surname>Sangsrakru</surname><given-names>D</given-names></string-name>, <string-name><surname>Tragoonrung</surname><given-names>S</given-names></string-name>, <string-name><surname>Tangphatsornruang</surname><given-names>S</given-names></string-name></person-group>. <article-title>Genome-wide SNP discovery and identification of QTL associated with agronomic traits in oil palm using genotyping-by-sequencing (GBS)</article-title>. <source>Genomics</source><year>2015</year>;<volume>105</volume>(<issue>5-6</issue>):<fpage>288</fpage>–<lpage>295</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.ygeno.2015.02.002</pub-id>.<pub-id pub-id-type="pmid">25702931</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rabiner</surname><given-names>LR</given-names></string-name></person-group>. <article-title>A tutorial on hidden Markov models and selected applications in speech recognition</article-title>. <source>Proc IEEE</source>. <year>1989</year>;<volume>77</volume>(<issue>2</issue>):<fpage>257</fpage>–<lpage>286</lpage>. doi:<pub-id pub-id-type="doi">10.1109/5.18626</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rhoads</surname><given-names>A</given-names></string-name>, <string-name><surname>Au</surname><given-names>KF</given-names></string-name></person-group>. <article-title>Pacbio sequencing and its applications</article-title>. <source>Genomics Proteomics Bioinformatics</source><year>2015</year>;<volume>13</volume>(<issue>5</issue>):<fpage>278</fpage>–<lpage>289</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.gpb.2015.08.002</pub-id>.<pub-id pub-id-type="pmid">26542840</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rowan</surname><given-names>BA</given-names></string-name>, <string-name><surname>Patel</surname><given-names>V</given-names></string-name>, <string-name><surname>Weigel</surname><given-names>D</given-names></string-name>, <string-name><surname>Schneeberger</surname><given-names>K</given-names></string-name></person-group>. <article-title>Rapid and inexpensive whole-genome genotyping-by-sequencing for crossover localization and fine-scale genetic mapping</article-title>. <source>G3 (Bethesda)</source><year>2015</year>;<volume>5</volume>(<issue>3</issue>):<fpage>385</fpage>–<lpage>398</lpage>. doi:<pub-id pub-id-type="doi">10.1534/g3.114.016501</pub-id>.<pub-id pub-id-type="pmid">25585881</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scheben</surname><given-names>A</given-names></string-name>, <string-name><surname>Batley</surname><given-names>J</given-names></string-name>, <string-name><surname>Edwards</surname><given-names>D</given-names></string-name></person-group>. <article-title>Genotyping-by-sequencing approaches to characterize crop genomes: choosing the right tool for the right application</article-title>. <source>Plant Biotechnol J</source>. <year>2017</year>;<volume>15</volume>(<issue>2</issue>):<fpage>149</fpage>–<lpage>161</lpage>. doi:<pub-id pub-id-type="doi">10.1111/PBI.12645</pub-id>.<pub-id pub-id-type="pmid">27696619</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Swarts</surname><given-names>K</given-names></string-name>, <string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Romero Navarro</surname><given-names>JA</given-names></string-name>, <string-name><surname>An</surname><given-names>D</given-names></string-name>, <string-name><surname>Romay</surname><given-names>MC</given-names></string-name>, <string-name><surname>Hearne</surname><given-names>S</given-names></string-name>, <string-name><surname>Acharya</surname><given-names>C</given-names></string-name>, <string-name><surname>Glaubitz</surname><given-names>JC</given-names></string-name>, <string-name><surname>Mitchell</surname><given-names>S</given-names></string-name>, <string-name><surname>Elshire</surname><given-names>RJ</given-names></string-name>, <etal>et al</etal></person-group><article-title>Novel methods to optimize genotypic imputation for low-coverage, next-generation sequence data in crop plants</article-title>. <source>Plant Genome</source><year>2014</year>;<volume>7</volume>(<issue>3</issue>):<comment>plantgenome2014.05.0023</comment>. doi:<pub-id pub-id-type="doi">10.3835/plantgenome2014.05.0023</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wijnker</surname><given-names>E</given-names></string-name>, <string-name><surname>James</surname><given-names>GV</given-names></string-name>, <string-name><surname>Ding</surname><given-names>J</given-names></string-name>, <string-name><surname>Becker</surname><given-names>F</given-names></string-name>, <string-name><surname>Klasen</surname><given-names>JR</given-names></string-name>, <string-name><surname>Rawat</surname><given-names>V</given-names></string-name>, <string-name><surname>Rowan</surname><given-names>BA</given-names></string-name>, <string-name><surname>de Jong</surname><given-names>DF</given-names></string-name>, <string-name><surname>de Snoo</surname><given-names>CB</given-names></string-name>, <string-name><surname>Zapata</surname><given-names>L</given-names></string-name>, <etal>et al</etal></person-group><article-title>The genomic landscape of meiotic crossovers and gene conversions in <italic toggle="yes">Arabidopsis thaliana</italic></article-title>. <source>Elife</source><year>2013</year>;<volume>2</volume>:<comment>e01426</comment>. doi:<pub-id pub-id-type="doi">10.7554/eLife.01426</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>C</given-names></string-name>, <string-name><surname>Boer</surname><given-names>MP</given-names></string-name>, <string-name><surname>van Eeuwijk</surname><given-names>FA</given-names></string-name></person-group>. <article-title>A general modeling framework for genome ancestral origins in multiparental populations</article-title>. <source>Genetics</source><year>2014</year>;<volume>198</volume>(<issue>1</issue>):<fpage>87</fpage>–<lpage>101</lpage>. doi:<pub-id pub-id-type="doi">10.1534/genetics.114.163006</pub-id>.<pub-id pub-id-type="pmid">25236451</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>C</given-names></string-name>, <string-name><surname>Boer</surname><given-names>MP</given-names></string-name>, <string-name><surname>van Eeuwijk</surname><given-names>FA</given-names></string-name></person-group>. <article-title>Reconstruction of genome ancestry blocks in multiparental populations</article-title>. <source>Genetics</source><year>2015</year>;<volume>200</volume>(<issue>4</issue>):<fpage>1073</fpage>–<lpage>1087</lpage>. doi:<pub-id pub-id-type="doi">10.1534/genetics.115.177873</pub-id>.<pub-id pub-id-type="pmid">26048018</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>C</given-names></string-name>, <string-name><surname>Boer</surname><given-names>MP</given-names></string-name>, <string-name><surname>van Eeuwijk</surname><given-names>FA</given-names></string-name></person-group>. <article-title>Accurate genotype imputation in multiparental populations from low-coverage sequence</article-title>. <source>Genetics</source><year>2018</year>;<volume>210</volume>(<issue>1</issue>):<fpage>71</fpage>–<lpage>82</lpage>. doi:<pub-id pub-id-type="doi">10.1534/genetics.118.300885</pub-id>.<pub-id pub-id-type="pmid">30045858</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name><surname>Gogarten</surname><given-names>SM</given-names></string-name>, <string-name><surname>Lawrence</surname><given-names>M</given-names></string-name>, <string-name><surname>Stilp</surname><given-names>A</given-names></string-name>, <string-name><surname>Conomos</surname><given-names>MP</given-names></string-name>, <string-name><surname>Weir</surname><given-names>BS</given-names></string-name>, <string-name><surname>Laurie</surname><given-names>C</given-names></string-name>, <string-name><surname>Levine</surname><given-names>D</given-names></string-name></person-group>. <article-title>Seqarray—a storage-efficient high-performance data format for WGS variant calls</article-title>. <source>Bioinformatics</source><year>2017</year>;<volume>33</volume>(<issue>15</issue>):<fpage>2251</fpage>–<lpage>2257</lpage>. doi:<pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTX145</pub-id>.<pub-id pub-id-type="pmid">28334390</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name><surname>Levine</surname><given-names>D</given-names></string-name>, <string-name><surname>Shen</surname><given-names>J</given-names></string-name>, <string-name><surname>Gogarten</surname><given-names>SM</given-names></string-name>, <string-name><surname>Laurie</surname><given-names>C</given-names></string-name>, <string-name><surname>Weir</surname><given-names>BS</given-names></string-name></person-group>. <article-title>A high-performance computing toolset for relatedness and principal component analysis of SNP data</article-title>. <source>Bioinformatics</source><year>2012</year>;<volume>28</volume>(<issue>24</issue>):<fpage>3326</fpage>–<lpage>3328</lpage>. doi:<pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTS606</pub-id>.<pub-id pub-id-type="pmid">23060615</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.2 20190208//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.2?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<?properties open_access?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genetics</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genetics</journal-id>
    <journal-id journal-id-type="publisher-id">genetics</journal-id>
    <journal-title-group>
      <journal-title>Genetics</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0016-6731</issn>
    <issn pub-type="epub">1943-2631</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
      <publisher-loc>US</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10213493</article-id>
    <article-id pub-id-type="pmid">36988327</article-id>
    <article-id pub-id-type="doi">10.1093/genetics/iyad055</article-id>
    <article-id pub-id-type="publisher-id">iyad055</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Investigation</subject>
      </subj-group>
      <subj-group subj-group-type="category-taxonomy-collection">
        <subject>AcademicSubjects/SCI01180</subject>
        <subject>AcademicSubjects/SCI01140</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GBScleanR: robust genotyping error correction using a hidden Markov model with error pattern recognition</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author" corresp="yes">
        <name>
          <surname>Furuta</surname>
          <given-names>Tomoyuki</given-names>
        </name>
        <aff><institution>Institute of Plant Science and Resources, Okayama University</institution>, <addr-line>Chu-oh 2-20-1, Kurashiki, Okayama 710-0046</addr-line>, <country country="JP">Japan</country></aff>
        <xref rid="iyad055-cor1" ref-type="corresp"/>
        <!--f.tomoyuki@okayama-u.ac.jp-->
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yamamoto</surname>
          <given-names>Toshio</given-names>
        </name>
        <aff><institution>Institute of Plant Science and Resources, Okayama University</institution>, <addr-line>Chu-oh 2-20-1, Kurashiki, Okayama 710-0046</addr-line>, <country country="JP">Japan</country></aff>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ashikari</surname>
          <given-names>Motoyuki</given-names>
        </name>
        <aff><institution>Bioscience and Biotechnology Center, Nagoya University</institution>, <addr-line>Furo-cho, Chikusa, Nagoya, Aichi 464-8601</addr-line>, <country country="JP">Japan</country></aff>
      </contrib>
    </contrib-group>
    <contrib-group>
      <contrib contrib-type="editor">
        <name>
          <surname>Endelman</surname>
          <given-names>J</given-names>
        </name>
        <role>Editor</role>
      </contrib>
    </contrib-group>
    <author-notes>
      <corresp id="iyad055-cor1">Corresponding author: Institute of Plant Science and Resources, Okayama University, Chu-oh 2-20-1, Kurashiki, Okayama, 710-0046, Japan. Email: <email>f.tomoyuki@okayama-u.ac.jp</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <month>6</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2023-03-29">
      <day>29</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>29</day>
      <month>3</month>
      <year>2023</year>
    </pub-date>
    <volume>224</volume>
    <issue>2</issue>
    <elocation-id>iyad055</elocation-id>
    <history>
      <date date-type="received">
        <day>21</day>
        <month>2</month>
        <year>2023</year>
      </date>
      <date date-type="accepted">
        <day>21</day>
        <month>3</month>
        <year>2023</year>
      </date>
      <date date-type="corrected-typeset">
        <day>15</day>
        <month>4</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023. Published by Oxford University Press on behalf of The Genetics Society of America.</copyright-statement>
      <copyright-year>2023</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</ext-link>), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p>
      </license>
    </permissions>
    <self-uri xlink:href="iyad055.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>Reduced-representation sequencing (RRS) provides cost-effective and time-saving genotyping platforms. Despite the outstanding advantage of RRS in throughput, the obtained genotype data usually contain a large number of errors. Several error correction methods employing the hidden Markov model (HMM) have been developed to overcome these issues. These methods assume that markers have a uniform error rate with no bias in the allele read ratio. However, bias does occur because of uneven amplification of genomic fragments and read mismapping. In this paper, we introduce an error correction tool, GBScleanR, which enables robust and precise error correction for noisy RRS-based genotype data by incorporating marker-specific error rates into the HMM. The results indicate that GBScleanR improves the accuracy by more than 25 percentage points at maximum compared to the existing tools in simulation data sets and achieves the most reliable genotype estimation in real data even with error-prone markers.</p>
    </abstract>
    <kwd-group>
      <kwd>reduced-representation sequencing</kwd>
      <kwd>error correction</kwd>
      <kwd>imputation</kwd>
      <kwd>hidden Markov model</kwd>
    </kwd-group>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Japan Science and Technology Agency</institution>
            <institution-id institution-id-type="DOI">10.13039/501100002241</institution-id>
          </institution-wrap>
        </funding-source>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <institution-wrap>
            <institution>Ministry of Education, Culture, Sports, Science and Technology of Japan</institution>
            <institution-id institution-id-type="DOI">10.13039/501100001700</institution-id>
          </institution-wrap>
        </funding-source>
        <award-id>JP20H05912</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="iyad055-s0">
    <title>Introduction</title>
    <p>Reduced-representation sequencing (RRS) is a sequencing technique using next-generation sequencing (NGS) with reducing sequence targets by taking reads only from a limited portion of a genome (<xref rid="iyad055-B26" ref-type="bibr">Scheben <italic toggle="yes">et al.</italic> 2017</xref>). To meet the demands for cost-effective genotyping systems with dense markers, many different RRS-based genotyping methods have been introduced, including restriction site-associated DNA sequencing (RAD-seq) and genotyping-by-sequencing (GBS) (<xref rid="iyad055-B2" ref-type="bibr">Baird <italic toggle="yes">et al.</italic> 2008</xref>; <xref rid="iyad055-B8" ref-type="bibr">Elshire <italic toggle="yes">et al.</italic> 2011</xref>). The reduction in the number of sequence targets allows us for highly multiplexed sequencing to obtain genotype data of a large population such as a hybrid population for genetic mapping and breeding. However, a larger number of samples per NGS run result in genotype data with a lower read coverage per sample (<xref rid="iyad055-B21" ref-type="bibr">Poland and Rife 2012</xref>). Since sequence reads that can be retrieved via NGS are highly stochastic, the limited number of reads can result in the undercalling of heterozygotes, in which recovering only 1 allele at a heterozygous site leads to its incorrect identification as a homozygote. The lack of reads also generates a substantial number of missing genotype calls.</p>
    <p>Several error correction tools have been developed to overcome these disadvantages. The method to fill up missing calls and correct the undercalling of heterozygotes was first published in 2009, which determines genotypes based on the allele read ratio within a sliding window (<xref rid="iyad055-B15" ref-type="bibr">Huang <italic toggle="yes">et al.</italic> 2009</xref>). Genotype-Corrector is also an example of the tool using a sliding window method for error correction (<xref rid="iyad055-B20" ref-type="bibr">Miao <italic toggle="yes">et al.</italic> 2018</xref>). Recent publications have introduced statistically sophisticated methods using hidden Markov models (HMMs), such as FSFHap, TIGER, LB-Impute, and magicImpute (<xref rid="iyad055-B27" ref-type="bibr">Swarts <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="iyad055-B25" ref-type="bibr">Rowan <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="iyad055-B9" ref-type="bibr">Fragoso <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyad055-B31" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2018</xref>). The existing methods, however, assume constant error rates for all markers. For example, those assume a 50:50 probability that a read could be obtained for 1 of 2 possible alleles at a heterozygous site. Although this assumption is true in an ideal situation, in practice, genotype data contain a significant number of error-prone markers that show skewed probabilities in allele read acquisition as a result of actual biological unevenness (<xref rid="iyad055-B7" ref-type="bibr">Davey <italic toggle="yes">et al.</italic> 2013</xref>; <xref rid="iyad055-B28" ref-type="bibr">Wijnker <italic toggle="yes">et al.</italic> 2013</xref>; <xref rid="iyad055-B6" ref-type="bibr">DaCosta and Sorenson 2014</xref>). Variations in genome sequences change the fragmentation patterns of the genomes. Even if 2 independent reads are mapped at the same locus, the sequences of the genomic fragments from which each of the 2 reads originated can vary in terms of GC content and length and sometimes include large insertions or deletions in the unsequenced region of the fragments. Since the GC contents and the lengths of the restriction fragments are known to affect the amplification efficiency, the probability of observing a read for either allele may differ. These biases are likely to be more prominent in a polymorphism-rich population, for example, that derived from a cross between distant relatives. Hence, mismatches occur between the real data, which shows marker-specific error rates, and the models that assume a uniform error rate, resulting in biased genotype estimation and poor error correction accuracy.</p>
    <p>Here, we introduce the R package “GBScleanR,” which implements an HMM-based error correction algorithm. Our algorithm estimates an allele read bias and mismapping rate for each marker and incorporates those into the HMM as parameters to capture the skewed probabilities in allele read acquisitions. This paper demonstrates a comparison of GBScleanR and 2 well-established error correction tools: LB-Impute and magicImpute (<xref rid="iyad055-B9" ref-type="bibr">Fragoso <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyad055-B31" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2018</xref>). While LB-Impute accepts only biparental populations derived from inbred founders, magicImpute can work on biparental and multiparental populations derived from both inbred and outbred founders. The magicImpute algorithm is also able to estimate founder genotypes simultaneously with the offspring genotypes. Similar to magicImpute, GBScleanR supports simultaneous estimation of founder and offspring genotypes in a biparental and multiparental population. We first show simulation studies to present the accuracy and robustness of GBScleanR using simulation data sets that have severe allele read biases at error-prone markers. The simulation assumes 3 scenarios: a biparental <italic toggle="yes">F</italic><sub>2</sub> population (homoP2_F2), an outbred <italic toggle="yes">F</italic><sub>1</sub> population (hetP2_F1), and 8-way recombinant inbred lines (homoP8_RIL). We then demonstrate the reliability and robustness of GBScleanR using real data derived from a cross between distant relatives of rice, which potentially contains many error-prone markers.</p>
  </sec>
  <sec sec-type="methods" id="iyad055-s1">
    <title>Methods</title>
    <sec id="iyad055-s1.1">
      <title>Modeling for error correction</title>
      <p>Our modeling basically follows the model implemented in magicImpute that has been introduced in <xref rid="iyad055-B31" ref-type="bibr">Zheng <italic toggle="yes">et al</italic>. (2018)</xref>. The error correction algorithm of GBScleanR employs the HMM and treats the observed allele read counts for each SNP marker along a chromosome as outputs from a sequence of latent true genotypes. Our model supposes that a population of <inline-formula><mml:math id="IM1" display="inline" overflow="scroll"><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:math></inline-formula> offspring is originally derived from crosses between <inline-formula><mml:math id="IM2" display="inline" overflow="scroll"><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup><mml:mo>≥</mml:mo><mml:mn>2</mml:mn><mml:mspace width="0.25em"/></mml:math></inline-formula> founder individuals. The founders can be inbred lines with homozygotes at all markers or outbred lines in which markers would be heterozygous. Only 1 chromosome is considered for modeling due to the independence of chromosomes. Let <inline-formula><mml:math id="IM3" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> denote the observed allele read counts at marker <italic toggle="yes">m</italic> in offspring <italic toggle="yes">i</italic>. The element <inline-formula><mml:math id="IM4" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> consists of 2 values, <inline-formula><mml:math id="IM5" display="inline" overflow="scroll"><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="IM6" display="inline" overflow="scroll"><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula>, which represent the reference read count and the alternative read count, respectively. Similarly, the observed allele read counts at marker <italic toggle="yes">m</italic> in founder <italic toggle="yes">j</italic> are represented by <inline-formula><mml:math id="IM7" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula>. The matrices for hidden true offspring genotypes and hidden true founder genotypes are represented by <inline-formula><mml:math id="IM8" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM9" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula>, respectively. The element <inline-formula><mml:math id="IM10" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> takes a value of 0, 1, or 2 to indicate the reference homozygote, heterozygote, and alternative homozygote genotype without phasing information. Unlike the offspring genotype matrix, the founder genotype <inline-formula><mml:math id="IM11" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> stores the phased genotype as <inline-formula><mml:math id="IM12" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, where <inline-formula><mml:math id="IM13" display="inline" overflow="scroll"><mml:msup><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mspace width="0.25em"/></mml:math></inline-formula> and <inline-formula><mml:math id="IM14" display="inline" overflow="scroll"><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> indicate alleles at marker <italic toggle="yes">m</italic> on one of the diploid chromosomes and another in founder <italic toggle="yes">j</italic>, respectively. The reference allele is represented by 0, while 1 denotes the alternative. Considering the linkage between the markers and the independence of the founder genotypes, we can assume that the sequence of the descendent genotypes from founders does not follow a Markov process, while the sequence of the descendent haplotypes <inline-formula><mml:math id="IM15" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> does. To enable our estimation problem to be solved in the HMM framework, <inline-formula><mml:math id="IM16" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:msub><mml:mo fence="false" stretchy="false">}</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>…</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:msub></mml:math></inline-formula> is introduced to represent the matrix of the phased descendent haplotypes. The element <inline-formula><mml:math id="IM17" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> denotes a pair of descendent haplotypes <inline-formula><mml:math id="IM18" display="inline" overflow="scroll"><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> at marker <italic toggle="yes">m</italic> in offspring <italic toggle="yes">i</italic>. Therefore, <inline-formula><mml:math id="IM19" display="inline" overflow="scroll"><mml:msup><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="IM20" display="inline" overflow="scroll"><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math></inline-formula> each take one of the natural numbers that are <inline-formula><mml:math id="IM21" display="inline" overflow="scroll"><mml:mo>≤</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> if all founders are inbred or <inline-formula><mml:math id="IM22" display="inline" overflow="scroll"><mml:mo>≤</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> if outbred to indicate the origins of the descendent haplotypes.</p>
      <p>The algorithm estimates <inline-formula><mml:math id="IM23" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="IM24" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> based on <inline-formula><mml:math id="IM25" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> and <inline-formula><mml:math id="IM26" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:math></inline-formula> by maximizing the joint probability <inline-formula><mml:math id="IM27" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">H</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. We assume the independence of the offspring and the founders and the independence of each founder genotype at each marker. Therefore, our algorithm tries to maximize the following joint probability:</p>
      <disp-formula id="UM0001">
        <mml:math id="UM1" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">H</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">X</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munderover>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:msup>
                  <mml:mi>N</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:munderover>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mrow>
            <mml:mo>{</mml:mo>
            <mml:mrow>
              <mml:mstyle displaystyle="true">
                <mml:munderover>
                  <mml:mrow>
                    <mml:mo movablelimits="false">∏</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mi>M</mml:mi>
                </mml:munderover>
              </mml:mstyle>
              <mml:mspace width="0.2em"/>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>y</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo fence="false" stretchy="false">|</mml:mo>
                </mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>,</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mstyle displaystyle="true">
                <mml:munderover>
                  <mml:mrow>
                    <mml:mo movablelimits="false">∏</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                  <mml:mi>M</mml:mi>
                </mml:munderover>
              </mml:mstyle>
              <mml:mspace width="0.2em"/>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo fence="false" stretchy="false">|</mml:mo>
                </mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>,</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo fence="false" stretchy="false">|</mml:mo>
                </mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
            <mml:mo>}</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0002">
        <mml:math id="UM2" display="block" overflow="scroll">
          <mml:mspace width="-10pc"/>
          <mml:mo>×</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munderover>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mi>M</mml:mi>
            </mml:munderover>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">y</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM28" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="IM29" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, and <inline-formula><mml:math id="IM30" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> correspond to the emission probability, the transition probability, and the initial probability of the HMM, respectively. <inline-formula><mml:math id="IM31" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the probability of observing read counts for the founders at marker <italic toggle="yes">m</italic> when the combination of the true genotypes of the founders is <inline-formula><mml:math id="IM32" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. The details to derive the equation shown above are available in the <italic toggle="yes">Joint probability derivation</italic> section in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>. We assume that <inline-formula><mml:math id="IM33" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> follows a discrete uniform probability for all possible combinations of the founder genotypes while omitting cases in which all founders have a same genotype.</p>
    </sec>
    <sec id="iyad055-s1.2">
      <title>Emission probability</title>
      <p>To obtain the emission probability <inline-formula><mml:math id="IM34" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, 3 additional probabilities are introduced: <inline-formula><mml:math id="IM35" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, <inline-formula><mml:math id="IM36" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, and <inline-formula><mml:math id="IM37" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. The first 2 probabilities incorporate the effect of read mismapping that would make true genotype unobservable. <inline-formula><mml:math id="IM38" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the probability that the observable genotype is <inline-formula><mml:math id="IM39" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when read mismapping occurred at marker <italic toggle="yes">m</italic> of <italic toggle="yes">i</italic>th offspring that has the true genotype <inline-formula><mml:math id="IM40" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. <inline-formula><mml:math id="IM41" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> represents the probability to observe the reads <inline-formula><mml:math id="IM42" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when the observable genotype is <inline-formula><mml:math id="IM43" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. <inline-formula><mml:math id="IM44" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the probability to observe the genotype <inline-formula><mml:math id="IM45" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when the haplotype <inline-formula><mml:math id="IM46" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> was descendent from the founders having the genotype <inline-formula><mml:math id="IM47" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. We then rewrite the emission probability as <inline-formula><mml:math id="IM48" display="inline" overflow="scroll"><mml:msubsup><mml:mi>l</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, and it holds that</p>
      <disp-formula id="UM0003">
        <mml:math id="UM3" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>x</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mi>e</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">map</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0004">
        <mml:math id="UM4" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mi>e</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">map</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>x</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">′</mml:mi>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mi>e</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">map</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM49" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> equals 1 for the possible genotype under the constraint of the descendent haplotypes and founder genotypes in sample <italic toggle="yes">i</italic> and 0 for the other genotypes. For example, if sample 1 has <inline-formula><mml:math id="IM50" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mn>4</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> at marker 1, indicating that the haplotypes descended from the first chromosome of founder 1 and the second chromosome of founder 2, and if the founder genotypes are <inline-formula><mml:math id="IM51" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="IM52" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, the genotype can only be heterozygotic . The parameter <inline-formula><mml:math id="IM53" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> represents the global sequencing error rate that an unexpected allele read can be observed when the true genotype is either homozygote. We only assume that the sequencing error generates a read representing an opposite allele of the true allele. All markers are considered to have a same <inline-formula><mml:math id="IM54" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> value. The parameters <inline-formula><mml:math id="IM55" display="inline" overflow="scroll"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> and <inline-formula><mml:math id="IM56" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> are the marker-specific allele read bias and mismapping rate at marker <italic toggle="yes">m</italic>. These are the key parameters that make GBScleanR differ from the other algorithms including magicImpute in which no allele read bias and a constant mismapping rate are assumed. <inline-formula><mml:math id="IM57" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> indicates the observable genotype that results from accounting for the mismapping with <inline-formula><mml:math id="IM58" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula>. We assume that <inline-formula><mml:math id="IM59" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> takes 2 values <inline-formula><mml:math id="IM60" display="inline" overflow="scroll"><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>. <inline-formula><mml:math id="IM61" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mspace width="0.25em"/></mml:math></inline-formula> indicates the probability of incorrectly observing an alternative allele due to mismapped alternative reads when the true genotype is a reference homozygote. Similarly, <inline-formula><mml:math id="IM62" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> represents the probability of incorrectly observing a reference allele due to mismapped reference reads when the true genotype is an alternative homozygote. In the calculation of <inline-formula><mml:math id="IM63" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, we do not consider the undercalling of heterozygotes and missing calls for which <inline-formula><mml:math id="IM64" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> accounts. Therefore, when the true genotype <inline-formula><mml:math id="IM65" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is heterozygous, we can expect to observe that both alleles and an additional incorrect observation of either allele due to mismapping do not change the observable genotype <inline-formula><mml:math id="IM66" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> that is heterozygous. On the other hand, for example, the incorrectly observed reference allele due to mismapping of reference reads at an alternative homozygous site makes the site can be observed as heterozygous. Thus, the probability <inline-formula><mml:math id="IM67" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> takes the values listed in <xref rid="iyad055-T1" ref-type="table">Table 1</xref>. The observed read counts <inline-formula><mml:math id="IM68" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo fence="false" stretchy="false">{</mml:mo><mml:mrow><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>y</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo fence="false" stretchy="false">}</mml:mo></mml:math></inline-formula> follow binomial distribution</p>
      <disp-formula id="UM0005">
        <mml:math id="UM5" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mspace width="0.25em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:mn>0</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>∝</mml:mo>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:mn>1</mml:mn>
            <mml:mo>−</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">ref</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">alt</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0006">
        <mml:math id="UM6" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mspace width="0.25em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:mn>1</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>∝</mml:mo>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:mn>1</mml:mn>
            <mml:mo>−</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">ref</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">alt</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0007">
        <mml:math id="UM7" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mspace width="0.25em"/>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:mn>2</mml:mn>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>∝</mml:mo>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">ref</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:mn>1</mml:mn>
            <mml:mo>−</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:msup>
            <mml:mo stretchy="false">)</mml:mo>
            <mml:mrow>
              <mml:msup>
                <mml:mi>y</mml:mi>
                <mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">alt</mml:mi>
                  </mml:mrow>
                </mml:mrow>
              </mml:msup>
            </mml:mrow>
          </mml:msup>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>given the observable genotype <inline-formula><mml:math id="IM69" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. To reduce the negative impact of overrepresented mismapping reads that can make the probabilities of less probable genotypes being 0, we add 0.005 to the probabilities for the 3 possible genotypes if any of <inline-formula><mml:math id="IM70" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> gave <inline-formula><mml:math id="IM71" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mn>0</mml:mn></mml:math></inline-formula>. The normalization constant for <inline-formula><mml:math id="IM72" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is not shown in the equation above. Similarly, the emission probability for founders can be obtained by</p>
      <disp-formula id="UM0008">
        <mml:math id="UM8" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mrow>
              <mml:mi mathvariant="bold-italic">l</mml:mi>
            </mml:mrow>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo>∝</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munderover>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mi>j</mml:mi>
              <mml:mrow>
                <mml:msup>
                  <mml:mi>N</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msup>
              </mml:mrow>
            </mml:munderover>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>j</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mi>e</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">map</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mi>e</mml:mi>
              <mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">seq</mml:mi>
                </mml:mrow>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msub>
              <mml:mi>w</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where the normalization constant for <inline-formula><mml:math id="IM73" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">l</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is not shown. To omit the less probable founder genotypes, the probability <inline-formula><mml:math id="IM74" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is set to 0 if the result is &lt;0.01.</p>
      <table-wrap position="float" id="iyad055-T1">
        <label>Table 1.</label>
        <caption>
          <p>Probabilities associated with mismapping.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1"/>
              <th colspan="3" align="center" rowspan="1">Observable genotype <inline-formula><mml:math id="IM75" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold">x</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="bold">m</mml:mi><mml:mi mathvariant="bold">i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="bold">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1">0</th>
              <th align="center" rowspan="1" colspan="1">1</th>
              <th align="center" rowspan="1" colspan="1">2</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="3" colspan="1">True genotype <inline-formula><mml:math id="IM76" display="inline" overflow="scroll"><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula></td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <mml:math id="IM77" display="inline" overflow="scroll">
                    <mml:mspace width="-3pt"/>
                    <mml:mn>1</mml:mn>
                    <mml:mo>−</mml:mo>
                    <mml:msup>
                      <mml:mi>e</mml:mi>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">ref</mml:mi>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <mml:math id="IM78" display="inline" overflow="scroll">
                    <mml:msup>
                      <mml:mi>e</mml:mi>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">ref</mml:mi>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">1</td>
              <td rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">2</td>
              <td rowspan="1" colspan="1">0</td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <mml:math id="IM79" display="inline" overflow="scroll">
                    <mml:msup>
                      <mml:mi>e</mml:mi>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">alt</mml:mi>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:math>
                </inline-formula>
              </td>
              <td rowspan="1" colspan="1">
                <inline-formula>
                  <mml:math id="IM80" display="inline" overflow="scroll">
                    <mml:mn>1</mml:mn>
                    <mml:mo>−</mml:mo>
                    <mml:msup>
                      <mml:mi>e</mml:mi>
                      <mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">alt</mml:mi>
                        </mml:mrow>
                      </mml:mrow>
                    </mml:msup>
                  </mml:math>
                </inline-formula>
              </td>
            </tr>
          </tbody>
        </table>
      </table-wrap>
    </sec>
    <sec id="iyad055-s1.3">
      <title>Transition probability</title>
      <p>The transition probability <inline-formula><mml:math id="IM81" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is used to describe the probability that a crossover occurs between adjacent markers. The sequence of the descendent haplotypes is modeled using a continuous-time Markov chain, as described previously (<xref rid="iyad055-B29" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2014</xref>, <xref rid="iyad055-B30" ref-type="bibr">2015</xref>). The probability that the haplotype state transitions from <inline-formula><mml:math id="IM82" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> to <inline-formula><mml:math id="IM83" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> between the markers can be obtained using</p>
      <disp-formula id="UM0009">
        <mml:math id="UM9" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msup>
            <mml:mi>e</mml:mi>
            <mml:mrow>
              <mml:msub>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">Q</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>d</mml:mi>
                    <mml:mi>m</mml:mi>
                  </mml:msub>
                </mml:mrow>
              </mml:msub>
            </mml:mrow>
          </mml:msup>
          <mml:mo>,</mml:mo>
          <mml:mi>m</mml:mi>
          <mml:mo>≠</mml:mo>
          <mml:mn>1</mml:mn>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM84" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow></mml:math></inline-formula> denotes the transition rate matrix that defines the rates at which a state transition occurs per unit of time. The matrix exponential is obtained by Higham's algorithm, which is implemented in the “expm” package of R (<ext-link xlink:href="http://cran.r-project.org/web/packages/expm/index.html" ext-link-type="uri">http://cran.r-project.org/web/packages/expm/index.html</ext-link>). To obtain transition rates that are proportional to the distances between adjacent markers, <inline-formula><mml:math id="IM85" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="bold">Q</mml:mi></mml:mrow></mml:math></inline-formula> is multiplied by the genetic distance between markers <italic toggle="yes">m</italic> and <italic toggle="yes">m</italic> − 1 in Morgan <italic toggle="yes">d<sub>m</sub></italic>. While our algorithm requires genetic distances between markers, genotype data obtained via NGS generally provide only information about the physical distances. Therefore, <italic toggle="yes">d<sub>m</sub></italic> is calculated based on the physical distance and the expected genetic distance:</p>
      <disp-formula id="UM0010">
        <mml:math id="UM10" display="block" overflow="scroll">
          <mml:msub>
            <mml:mi>d</mml:mi>
            <mml:mi>m</mml:mi>
          </mml:msub>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msup>
            <mml:mn>10</mml:mn>
            <mml:mrow>
              <mml:mo>−</mml:mo>
              <mml:mn>6</mml:mn>
            </mml:mrow>
          </mml:msup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:mspace width=".1em"/>
            <mml:msub>
              <mml:mi>p</mml:mi>
              <mml:mi>m</mml:mi>
            </mml:msub>
            <mml:mo>−</mml:mo>
            <mml:msub>
              <mml:mi>p</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:msub>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:msup>
            <mml:mrow>
              <mml:mi mathvariant="normal">E</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">d</mml:mi>
            </mml:mrow>
          </mml:msup>
          <mml:mo>,</mml:mo>
          <mml:mi>m</mml:mi>
          <mml:mo>≠</mml:mo>
          <mml:mn>1</mml:mn>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <italic toggle="yes">p<sub>m</sub></italic> represents the physical position of marker <italic toggle="yes">m</italic> and E<sup>d</sup> is the expected genetic distance per megabase pair that should be specified as the input parameter. For <italic toggle="yes">m</italic> = 1, the initial probability <inline-formula><mml:math id="IM86" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is required and specified by the stationary distribution of the Markov process that can be obtained by normalizing the first eigenvector of the transposed transition probability matrix for a marker interval.</p>
    </sec>
    <sec id="iyad055-s1.4">
      <title>Estimation of the best haplotype and genotype sequences</title>
      <p>Together with the definitions described in the sections above, the joint probability to maximize can be rewritten as shown below:</p>
      <disp-formula id="UM0011">
        <mml:math id="UM11" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">H</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">X</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>i</mml:mi>
                <mml:mo>=</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mrow>
            <mml:mo>{</mml:mo>
            <mml:mrow>
              <mml:mstyle displaystyle="true">
                <mml:munder>
                  <mml:mrow>
                    <mml:mo movablelimits="false">∏</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                </mml:munder>
              </mml:mstyle>
              <mml:mspace width="0.2em"/>
              <mml:msubsup>
                <mml:mi>l</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mstyle displaystyle="true">
                <mml:munder>
                  <mml:mrow>
                    <mml:mo movablelimits="false">∏</mml:mo>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>=</mml:mo>
                    <mml:mn>2</mml:mn>
                  </mml:mrow>
                </mml:munder>
              </mml:mstyle>
              <mml:mspace width="0.2em"/>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo fence="false" stretchy="false">|</mml:mo>
                </mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mo>,</mml:mo>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
              <mml:mi>P</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mn>1</mml:mn>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
                <mml:mrow>
                  <mml:mo fence="false" stretchy="false">|</mml:mo>
                </mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mn>1</mml:mn>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
            <mml:mo>}</mml:mo>
          </mml:mrow>
        </mml:math>
      </disp-formula>
      <p>The Viterbi algorithm is used to maximize the joint probability and estimate the most likely haplotype sequences (<xref rid="iyad055-B23" ref-type="bibr">Rabiner 1989</xref>). Considering that the sequence of founder genotypes itself does not follow the Markov process while the offspring haplotypes depend on the founder genotypes, the most likely founder genotypes at marker <italic toggle="yes">m</italic> can be estimated based on the scores (probabilities) and the states of the Viterbi trellises that were calculated for the offspring genotype from markers 1 to <italic toggle="yes">m</italic>. Therefore, our algorithm recursively calculates the Viterbi scores for offspring <inline-formula><mml:math id="IM87" display="inline" overflow="scroll"><mml:msubsup><mml:mi>v</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and founders <inline-formula><mml:math id="IM88" display="inline" overflow="scroll"><mml:msubsup><mml:mi>v</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and records the Viterbi paths for the sequences of offspring haplotypes <inline-formula><mml:math id="IM89" display="inline" overflow="scroll"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and founder genotypes <inline-formula><mml:math id="IM90" display="inline" overflow="scroll"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, respectively. The recursive calculation of the integrated Viterbi algorithm proceeds as follows.</p>
      <p>Initialization at <italic toggle="yes">m</italic> = 1:</p>
      <p>The initialization starts with simply calculating the probability of having <inline-formula><mml:math id="IM91" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when the combination of the founder genotypes <inline-formula><mml:math id="IM92" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is given.</p>
      <disp-formula id="UM0012">
        <mml:math id="UM12" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mrow>
              <mml:mn>1</mml:mn>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mn>1</mml:mn>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mn>1</mml:mn>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mrow>
              <mml:mn>1</mml:mn>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mn>1</mml:mn>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mn>1</mml:mn>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM93" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the initial probability that the <italic toggle="yes">i</italic>th offspring has the combination of haplotypes <inline-formula><mml:math id="IM94" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>h</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>h</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> at the first marker.</p>
      <p>Recursion at <inline-formula><mml:math id="IM95" display="inline" overflow="scroll"><mml:mn>2</mml:mn><mml:mo>≤</mml:mo><mml:mrow><mml:mi mathvariant="normal">m</mml:mi></mml:mrow><mml:mo>≤</mml:mo><mml:mrow><mml:mi mathvariant="normal">M</mml:mi></mml:mrow></mml:math></inline-formula>:</p>
      <p>The algorithm calculates the probabilities of state transitions from marker <italic toggle="yes">m</italic> − 1 to <italic toggle="yes">m</italic> as shown below:</p>
      <disp-formula id="UM0013">
        <mml:math id="UM13" display="block" overflow="scroll">
          <mml:msub>
            <mml:mi>τ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
          </mml:msub>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0014">
        <mml:math id="UM14" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>τ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">′</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo form="prefix">max</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msub>
              <mml:mi>τ</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mi>h</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mrow>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
              </mml:mrow>
              <mml:msubsup>
                <mml:mi>h</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo>,</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM96" display="inline" overflow="scroll"><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is a matrix, each element of which indicates the probability of observing the transition from <inline-formula><mml:math id="IM97" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> to <inline-formula><mml:math id="IM98" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when <inline-formula><mml:math id="IM99" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="IM100" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> are given, while <inline-formula><mml:math id="IM101" display="inline" overflow="scroll"><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> indicates the probabilities of observing <inline-formula><mml:math id="IM102" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> when the most likely transition from <inline-formula><mml:math id="IM103" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> to <inline-formula><mml:math id="IM104" display="inline" overflow="scroll"><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> occurs with given <inline-formula><mml:math id="IM105" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="IM106" display="inline" overflow="scroll"><mml:mrow><mml:mspace width="0.25em"/></mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:math></inline-formula></p>
      <p>Then, calculate the Viterbi scores and the Viterbi paths for founders as</p>
      <disp-formula id="UM0015">
        <mml:math id="UM15" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mo>−</mml:mo>
              <mml:mn>1</mml:mn>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:msubsup>
            <mml:mi>τ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">′</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0016">
        <mml:math id="UM16" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>ψ</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mspace width="0.25em"/>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mi>arg</mml:mi>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo form="prefix">max</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>v</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mrow>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
              </mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Using <inline-formula><mml:math id="IM107" display="inline" overflow="scroll"><mml:msubsup><mml:mi>ψ</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula>, which stores the most likely combination of founder genotypes at marker <italic toggle="yes">m</italic> − 1 when <inline-formula><mml:math id="IM108" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is given, we can obtain the Viterbi scores and the Viterbi paths for offspring as follows:</p>
      <disp-formula id="UM0017">
        <mml:math id="UM17" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>ψ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mi>arg</mml:mi>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo form="prefix">max</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mo>−</mml:mo>
                    <mml:mn>1</mml:mn>
                    <mml:mo>,</mml:mo>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msub>
              <mml:mi>τ</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
            </mml:msub>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mi>h</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mrow>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
              </mml:mrow>
              <mml:msubsup>
                <mml:mi>h</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo>,</mml:mo>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo>,</mml:mo>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mo>−</mml:mo>
                  <mml:mn>1</mml:mn>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo>=</mml:mo>
              <mml:mspace width="0.25em"/>
              <mml:msubsup>
                <mml:mi>ψ</mml:mi>
                <mml:mi>m</mml:mi>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0018">
        <mml:math id="UM18" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msubsup>
            <mml:mi>τ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">′</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>−</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>=</mml:mo>
            <mml:mspace width="0.25em"/>
            <mml:msubsup>
              <mml:mi>ψ</mml:mi>
              <mml:mi>m</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Termination at <italic toggle="yes">m</italic> = <italic toggle="yes">M</italic>:</p>
      <p>Finally, we obtain the probability of observing <inline-formula><mml:math id="IM109" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and the most likely combination of founder genotypes at marker <italic toggle="yes">M</italic> via the following calculation:</p>
      <disp-formula id="UM0019">
        <mml:math id="UM19" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mi>M</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">′</mml:mi>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:msubsup>
            <mml:mi>l</mml:mi>
            <mml:mi>M</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∏</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:msubsup>
            <mml:mi>v</mml:mi>
            <mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">x</mml:mi>
              </mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0020">
        <mml:math id="UM20" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mrow>
              <mml:mover>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mo stretchy="false">^</mml:mo>
              </mml:mover>
            </mml:mrow>
            <mml:mi>M</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mi>arg</mml:mi>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo form="prefix">max</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mi>M</mml:mi>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">f</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>v</mml:mi>
              <mml:mi>M</mml:mi>
              <mml:mrow>
                <mml:mi mathvariant="normal">′</mml:mi>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Once <inline-formula><mml:math id="IM110" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is determined, we can also obtain the most likely offspring haplotypes at marker <italic toggle="yes">M</italic>:</p>
      <disp-formula id="UM0021">
        <mml:math id="UM21" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mrow>
              <mml:mover>
                <mml:mi>h</mml:mi>
                <mml:mo stretchy="false">^</mml:mo>
              </mml:mover>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>M</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mi>arg</mml:mi>
          <mml:mspace width="0.2em"/>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo form="prefix">max</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mi>h</mml:mi>
                  <mml:mrow>
                    <mml:mi>M</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi mathvariant="normal">o</mml:mi>
                  </mml:mrow>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>v</mml:mi>
              <mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mi>h</mml:mi>
                <mml:mrow>
                  <mml:mi>M</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mrow>
                <mml:mo fence="false" stretchy="false">|</mml:mo>
              </mml:mrow>
              <mml:msubsup>
                <mml:mrow>
                  <mml:mover>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">x</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">^</mml:mo>
                  </mml:mover>
                </mml:mrow>
                <mml:mi>M</mml:mi>
                <mml:mrow>
                  <mml:mi mathvariant="normal">f</mml:mi>
                </mml:mrow>
              </mml:msubsup>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>Backtracking from <italic toggle="yes">M</italic> − 1 to 1:</p>
      <p>To retrieve the most likely sequences of founder genotypes and offspring haplotypes, we trace the Viterbi paths as shown below:</p>
      <disp-formula id="UM0022">
        <mml:math id="UM22" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mrow>
              <mml:mover>
                <mml:mrow>
                  <mml:mi mathvariant="bold-italic">x</mml:mi>
                </mml:mrow>
                <mml:mo stretchy="false">^</mml:mo>
              </mml:mover>
            </mml:mrow>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msubsup>
            <mml:mi>ψ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mn>1</mml:mn>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">f</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mover>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">^</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0023">
        <mml:math id="UM23" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mrow>
              <mml:mover>
                <mml:mi>h</mml:mi>
                <mml:mo stretchy="false">^</mml:mo>
              </mml:mover>
            </mml:mrow>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msubsup>
            <mml:mi>ψ</mml:mi>
            <mml:mrow>
              <mml:mi>m</mml:mi>
              <mml:mo>+</mml:mo>
              <mml:mn>1</mml:mn>
              <mml:mo>,</mml:mo>
              <mml:mi>i</mml:mi>
            </mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">o</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mover>
                  <mml:mi>h</mml:mi>
                  <mml:mo stretchy="false">^</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
                <mml:mo>,</mml:mo>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mrow>
                <mml:mover>
                  <mml:mrow>
                    <mml:mi mathvariant="bold-italic">x</mml:mi>
                  </mml:mrow>
                  <mml:mo stretchy="false">^</mml:mo>
                </mml:mover>
              </mml:mrow>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mo>+</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msubsup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>.</mml:mo>
        </mml:math>
      </disp-formula>
      <p>If multiple arguments have the same maximum score, one of them is randomly selected. To increase the accuracy, our algorithm executes 2 rounds of estimation: 1 from marker 1 to <italic toggle="yes">M</italic> and another in the reverse direction. The reverse direction round starts from the last marker <italic toggle="yes">M</italic> and uses the estimated founder genotypes <inline-formula><mml:math id="IM111" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>M</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> from the forward round as the only possible founder genotypes at marker <italic toggle="yes">M</italic>. The results from both rounds are then merged by combining the first half of the estimated genotypes <inline-formula><mml:math id="IM112" display="inline" overflow="scroll"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>&lt;</mml:mo><mml:mrow><mml:mfrac><mml:mi>M</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math></inline-formula> from the reversed direction round with the last half from the forward direction round.</p>
      <p>The estimated genotype at each marker in each sample <inline-formula><mml:math id="IM113" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> can now be obtained based on <inline-formula><mml:math id="IM114" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mi>h</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="IM115" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula>. To evaluate the reliability of the estimated genotypes, the marginal probability is also calculated:</p>
      <disp-formula id="UM0024">
        <mml:math id="UM24" display="block" overflow="scroll">
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">X</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">^</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mrow>
                <mml:msubsup>
                  <mml:mrow>
                    <mml:mover>
                      <mml:mi>h</mml:mi>
                      <mml:mo stretchy="false">^</mml:mo>
                    </mml:mover>
                  </mml:mrow>
                  <mml:mrow>
                    <mml:mi>m</mml:mi>
                    <mml:mi>i</mml:mi>
                  </mml:mrow>
                  <mml:mi>o</mml:mi>
                </mml:msubsup>
              </mml:mrow>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>x</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">X</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">^</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mi>P</mml:mi>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>h</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msubsup>
            <mml:mrow>
              <mml:mo fence="false" stretchy="false">|</mml:mo>
            </mml:mrow>
            <mml:msup>
              <mml:mrow>
                <mml:mi mathvariant="bold-italic">Y</mml:mi>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">o</mml:mi>
              </mml:mrow>
            </mml:msup>
            <mml:mo>,</mml:mo>
            <mml:msup>
              <mml:mrow>
                <mml:mrow>
                  <mml:mover>
                    <mml:mrow>
                      <mml:mi mathvariant="bold-italic">X</mml:mi>
                    </mml:mrow>
                    <mml:mo stretchy="false">^</mml:mo>
                  </mml:mover>
                </mml:mrow>
              </mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">f</mml:mi>
              </mml:mrow>
            </mml:msup>
          </mml:mrow>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM116" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> can be obtained using the forward–backward algorithm (<xref rid="iyad055-B23" ref-type="bibr">Rabiner 1989</xref>). The estimated genotype <inline-formula><mml:math id="IM117" display="inline" overflow="scroll"><mml:msubsup><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup></mml:math></inline-formula> is set as missing if <inline-formula><mml:math id="IM118" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mrow><mml:mover><mml:mi>x</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">Y</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">X</mml:mi></mml:mrow><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">f</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is smaller than a user specified threshold <italic toggle="yes">P</italic><sub>call</sub>, with 0.9 as the default.</p>
    </sec>
    <sec id="iyad055-s1.5">
      <title>Estimation of allele read biases and mismapping rates</title>
      <p>GBScleanR requires 4 parameters E<sup>d</sup>, <inline-formula><mml:math id="IM119" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula>, <inline-formula><mml:math id="IM120" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula>, and <inline-formula><mml:math id="IM121" display="inline" overflow="scroll"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula>. The expected genetic distance per megabase pair E<sup>d</sup> and sequencing error rate <inline-formula><mml:math id="IM122" display="inline" overflow="scroll"><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:math></inline-formula> take a single positive number that should arbitrarily be specified as input parameters, while the mismapping rates <inline-formula><mml:math id="IM123" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> and the allele read biases <inline-formula><mml:math id="IM124" display="inline" overflow="scroll"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> can be estimated via iterative parameter optimization (IPO). IPO is achieved by repeating the genotype estimation step and the parameter estimation step using the estimated genotype data. For the first cycle of the genotype estimation, <inline-formula><mml:math id="IM125" display="inline" overflow="scroll"><mml:msubsup><mml:mi>e</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">map</mml:mi></mml:mrow></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and <inline-formula><mml:math id="IM126" display="inline" overflow="scroll"><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:math></inline-formula> are initialized to <inline-formula><mml:math id="IM127" display="inline" overflow="scroll"><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mn>0.005</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mn>0.005</mml:mn></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> and 0.5 for all markers, respectively. Thus, the first iteration does not consider marker-specific allele read biases and mismapping rates. The parameter estimation proceeds as described below. With the estimated genotypes from the first cycle, we can obtain the number of allele reads for each estimated genotype. Let <inline-formula><mml:math id="IM128" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> and <inline-formula><mml:math id="IM129" display="inline" overflow="scroll"><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> be the number of reference reads and alternative reads at marker <italic toggle="yes">m</italic> in sample <italic toggle="yes">i</italic>, including both offspring and founders. The allele read bias at marker <italic toggle="yes">m</italic> is estimated by the following:</p>
      <disp-formula id="UM0025">
        <mml:math id="UM25" display="block" overflow="scroll">
          <mml:msub>
            <mml:mi>w</mml:mi>
            <mml:mi>m</mml:mi>
          </mml:msub>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>E</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">ref</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>E</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">ref</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo>+</mml:mo>
                  <mml:msubsup>
                    <mml:mi>E</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">alt</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0026">
        <mml:math id="UM26" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>E</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">ref</mml:mi>
              </mml:mrow>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>r</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">ref</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msubsup>
                    <mml:mi>r</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">ref</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mi>m</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>0</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mi>m</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0027">
        <mml:math id="UM27" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>E</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">alt</mml:mi>
              </mml:mrow>
            </mml:mrow>
          </mml:msubsup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msubsup>
                    <mml:mi>r</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">alt</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>2</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msubsup>
                    <mml:mi>r</mml:mi>
                    <mml:mi>m</mml:mi>
                    <mml:mrow>
                      <mml:mrow>
                        <mml:mi mathvariant="normal">alt</mml:mi>
                      </mml:mrow>
                    </mml:mrow>
                  </mml:msubsup>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mi>m</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>2</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                  <mml:mo>+</mml:mo>
                  <mml:msub>
                    <mml:mi>n</mml:mi>
                    <mml:mi>m</mml:mi>
                  </mml:msub>
                  <mml:mo stretchy="false">(</mml:mo>
                  <mml:mn>1</mml:mn>
                  <mml:mo stretchy="false">)</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0028">
        <mml:math id="UM28" display="block" overflow="scroll">
          <mml:msubsup>
            <mml:mi>r</mml:mi>
            <mml:mi>m</mml:mi>
            <mml:mrow>
              <mml:mi mathvariant="normal">x</mml:mi>
            </mml:mrow>
          </mml:msubsup>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mi>g</mml:mi>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:msubsup>
              <mml:mi>y</mml:mi>
              <mml:mrow>
                <mml:mi>m</mml:mi>
                <mml:mi>i</mml:mi>
              </mml:mrow>
              <mml:mi>x</mml:mi>
            </mml:msubsup>
            <mml:mi>δ</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mi>x</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mspace width="0.25em"/>
              <mml:mo>=</mml:mo>
              <mml:mspace width="0.25em"/>
              <mml:mi>g</mml:mi>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>,</mml:mo>
          <mml:mrow>
            <mml:mspace width="0.25em"/>
            <mml:mi mathvariant="normal">x</mml:mi>
          </mml:mrow>
          <mml:mo>∈</mml:mo>
          <mml:mo fence="false" stretchy="false">{</mml:mo>
          <mml:mrow>
            <mml:mrow>
              <mml:mi mathvariant="normal">ref</mml:mi>
            </mml:mrow>
            <mml:mo>,</mml:mo>
            <mml:mrow>
              <mml:mspace width="0.25em"/>
              <mml:mi mathvariant="normal">alt</mml:mi>
            </mml:mrow>
          </mml:mrow>
          <mml:mo fence="false" stretchy="false">}</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0029">
        <mml:math id="UM29" display="block" overflow="scroll">
          <mml:msub>
            <mml:mi>n</mml:mi>
            <mml:mi>m</mml:mi>
          </mml:msub>
          <mml:mo stretchy="false">(</mml:mo>
          <mml:mi>g</mml:mi>
          <mml:mo stretchy="false">)</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:msup>
            <mml:mn>2</mml:mn>
            <mml:mrow>
              <mml:mi>δ</mml:mi>
              <mml:mo stretchy="false">(</mml:mo>
              <mml:mrow>
                <mml:mi>g</mml:mi>
                <mml:mo>≠</mml:mo>
                <mml:mn>1</mml:mn>
              </mml:mrow>
              <mml:mo stretchy="false">)</mml:mo>
            </mml:mrow>
          </mml:msup>
          <mml:mstyle displaystyle="true">
            <mml:munder>
              <mml:mrow>
                <mml:mo movablelimits="false">∑</mml:mo>
              </mml:mrow>
              <mml:mi>i</mml:mi>
            </mml:munder>
          </mml:mstyle>
          <mml:mspace width="0.2em"/>
          <mml:mo stretchy="false">[</mml:mo>
          <mml:mrow>
            <mml:mi>δ</mml:mi>
            <mml:mo stretchy="false">(</mml:mo>
            <mml:mrow>
              <mml:msubsup>
                <mml:mi>x</mml:mi>
                <mml:mrow>
                  <mml:mi>m</mml:mi>
                  <mml:mi>i</mml:mi>
                </mml:mrow>
                <mml:mrow>
                  <mml:mi mathvariant="normal">o</mml:mi>
                </mml:mrow>
              </mml:msubsup>
              <mml:mspace width="0.25em"/>
              <mml:mo>=</mml:mo>
              <mml:mspace width="0.25em"/>
              <mml:mi>g</mml:mi>
            </mml:mrow>
            <mml:mo stretchy="false">)</mml:mo>
          </mml:mrow>
          <mml:mo stretchy="false">]</mml:mo>
          <mml:mo>,</mml:mo>
        </mml:math>
      </disp-formula>
      <p>where <italic toggle="yes">g</italic> is 0, 1, or 2 and indicates the genotype, <inline-formula><mml:math id="IM130" display="inline" overflow="scroll"><mml:msubsup><mml:mi>E</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">ref</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> represents the expected number of reference allele reads observed if 1 reference allele is on the chromosome, and <inline-formula><mml:math id="IM131" display="inline" overflow="scroll"><mml:msubsup><mml:mi>E</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">alt</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:math></inline-formula> represents the expected number of alternative allele reads if 1 alternative allele is on the chromosome. On the other hand, the mismapping rate at marker <italic toggle="yes">m</italic> can be obtained by calculating</p>
      <disp-formula id="UM0030">
        <mml:math id="UM30" display="block" overflow="scroll">
          <mml:msup>
            <mml:mi>e</mml:mi>
            <mml:mrow>
              <mml:mrow>
                <mml:mi mathvariant="normal">ref</mml:mi>
              </mml:mrow>
            </mml:mrow>
          </mml:msup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo movablelimits="false">∑</mml:mo>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mspace width="0.2em"/>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mrow>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>y</mml:mi>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">o</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mrow>
                          <mml:mo fence="false" stretchy="false">|</mml:mo>
                        </mml:mrow>
                        <mml:msubsup>
                          <mml:mi>x</mml:mi>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">′</mml:mi>
                            <mml:mi mathvariant="normal">o</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mspace width="0.25em"/>
                        <mml:mo>=</mml:mo>
                        <mml:mspace width="0.25em"/>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:msup>
                          <mml:mi>e</mml:mi>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">seq</mml:mi>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mi>w</mml:mi>
                          <mml:mi>m</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>&gt;</mml:mo>
                      <mml:mn>0.99</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">o</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mspace width="0.25em"/>
                      <mml:mo>=</mml:mo>
                      <mml:mspace width="0.25em"/>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">]</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo movablelimits="false">∑</mml:mo>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mspace width="0.2em"/>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mrow>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">o</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mspace width="0.25em"/>
                      <mml:mo>=</mml:mo>
                      <mml:mspace width="0.25em"/>
                      <mml:mn>0</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">]</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <disp-formula id="UM0031">
        <mml:math id="UM31" display="block" overflow="scroll">
          <mml:msup>
            <mml:mi>e</mml:mi>
            <mml:mrow>
              <mml:mi>a</mml:mi>
              <mml:mi>l</mml:mi>
              <mml:mi>t</mml:mi>
            </mml:mrow>
          </mml:msup>
          <mml:mspace width="0.25em"/>
          <mml:mo>=</mml:mo>
          <mml:mspace width="0.25em"/>
          <mml:mstyle displaystyle="true" scriptlevel="0">
            <mml:mrow>
              <mml:mfrac>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo movablelimits="false">∑</mml:mo>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mspace width="0.2em"/>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mrow>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:mi>P</mml:mi>
                      <mml:mo stretchy="false">(</mml:mo>
                      <mml:mrow>
                        <mml:msubsup>
                          <mml:mi>y</mml:mi>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">o</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mrow>
                          <mml:mo fence="false" stretchy="false">|</mml:mo>
                        </mml:mrow>
                        <mml:msubsup>
                          <mml:mi>x</mml:mi>
                          <mml:mrow>
                            <mml:mi>m</mml:mi>
                            <mml:mi>i</mml:mi>
                          </mml:mrow>
                          <mml:mrow>
                            <mml:mi mathvariant="normal">′</mml:mi>
                            <mml:mi mathvariant="normal">o</mml:mi>
                          </mml:mrow>
                        </mml:msubsup>
                        <mml:mspace width="0.25em"/>
                        <mml:mo>=</mml:mo>
                        <mml:mspace width="0.25em"/>
                        <mml:mn>1</mml:mn>
                        <mml:mo>,</mml:mo>
                        <mml:msup>
                          <mml:mi>e</mml:mi>
                          <mml:mrow>
                            <mml:mrow>
                              <mml:mi mathvariant="normal">seq</mml:mi>
                            </mml:mrow>
                          </mml:mrow>
                        </mml:msup>
                        <mml:mo>,</mml:mo>
                        <mml:msub>
                          <mml:mi>w</mml:mi>
                          <mml:mi>m</mml:mi>
                        </mml:msub>
                      </mml:mrow>
                      <mml:mo stretchy="false">)</mml:mo>
                      <mml:mo>&gt;</mml:mo>
                      <mml:mn>0.99</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">o</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mspace width="0.25em"/>
                      <mml:mo>=</mml:mo>
                      <mml:mspace width="0.25em"/>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">]</mml:mo>
                </mml:mrow>
                <mml:mrow>
                  <mml:msub>
                    <mml:mrow>
                      <mml:mo movablelimits="false">∑</mml:mo>
                    </mml:mrow>
                    <mml:mi>i</mml:mi>
                  </mml:msub>
                  <mml:mspace width="0.2em"/>
                  <mml:mo stretchy="false">[</mml:mo>
                  <mml:mrow>
                    <mml:mi>δ</mml:mi>
                    <mml:mo stretchy="false">(</mml:mo>
                    <mml:mrow>
                      <mml:msubsup>
                        <mml:mi>x</mml:mi>
                        <mml:mrow>
                          <mml:mi>m</mml:mi>
                          <mml:mi>i</mml:mi>
                        </mml:mrow>
                        <mml:mrow>
                          <mml:mi mathvariant="normal">o</mml:mi>
                        </mml:mrow>
                      </mml:msubsup>
                      <mml:mspace width="0.25em"/>
                      <mml:mo>=</mml:mo>
                      <mml:mspace width="0.25em"/>
                      <mml:mn>2</mml:mn>
                    </mml:mrow>
                    <mml:mo stretchy="false">)</mml:mo>
                  </mml:mrow>
                  <mml:mo stretchy="false">]</mml:mo>
                </mml:mrow>
              </mml:mfrac>
            </mml:mrow>
            <mml:mo>,</mml:mo>
          </mml:mstyle>
        </mml:math>
      </disp-formula>
      <p>where <inline-formula><mml:math id="IM132" display="inline" overflow="scroll"><mml:mi>δ</mml:mi></mml:math></inline-formula> is an indicator function that is equal to 1 if the argument is true and 0 if it is false. <inline-formula><mml:math id="IM133" display="inline" overflow="scroll"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:msubsup><mml:mi>y</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mo fence="false" stretchy="false">|</mml:mo></mml:mrow><mml:msubsup><mml:mi>x</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:mrow></mml:msubsup><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mi mathvariant="normal">seq</mml:mi></mml:mrow></mml:mrow></mml:msup><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:math></inline-formula> is the genotype probability to call a heterozygote and can be obtained as described in the <italic toggle="yes">Emission probability</italic> section. We counted the number of mismapping-induced erroneous genotype calls at which the genotype probability to be heterozygous based on the observed reads is more than 0.99 but the estimated genotype via the HMM is homozygous. The rates of those erroneous heterozygous calls at HMM-estimated homozygous calls are assumed to represent the mismapping rates at markers.</p>
    </sec>
    <sec id="iyad055-s1.6">
      <title>Preparation of real data</title>
      <p>As real data, we used the genotype data obtained from the <italic toggle="yes">F</italic><sub>2</sub> population that has been derived from a cross between <italic toggle="yes">Oryza sativa</italic> and <italic toggle="yes">Oryza longistaminata</italic> and reported in the previous study (<xref rid="iyad055-B10" ref-type="bibr">Furuta <italic toggle="yes">et al.</italic> 2017</xref>). In brief, GBS was performed with a <italic toggle="yes">Kpn</italic>I–<italic toggle="yes">Msp</italic>I restriction enzyme pair using MiSeq with 75-bp paired-end sequencing and generated an average of <inline-formula><mml:math id="IM134" display="inline" overflow="scroll"><mml:mn>134</mml:mn><mml:mo>,</mml:mo><mml:mn>447</mml:mn><mml:mo>±</mml:mo><mml:mn>50</mml:mn><mml:mo>,</mml:mo><mml:mn>788</mml:mn></mml:math></inline-formula> reads per sample. We obtained a total of 2,539,459 and 3,481,218 reads for <italic toggle="yes">O. sativa</italic> and <italic toggle="yes">O. longistaminata</italic> from the independent runs, respectively. The obtained reads were then processed via the TASSEL-GBS pipeline v2 by following the instructions in the manual with the default parameters (<ext-link xlink:href="https://bitbucket.org/tasseladmin/tassel-5-source/wiki/Tassel5GBSv2Pipeline" ext-link-type="uri">https://bitbucket.org/tasseladmin/tassel-5-source/wiki/Tassel5GBSv2Pipeline</ext-link>) (<xref rid="iyad055-B12" ref-type="bibr">Glaubitz <italic toggle="yes">et al.</italic> 2014</xref>). The obtained SNP markers were then filtered to retain only those markers that were homozygous in each founder but biallelic between founders. Only the first SNP was selected if multiple SNPs were present within a 75-bp stretch. To filter out the erroneous genotype calls that were caused by overrepresented mismapping reads, read counts were set to 0 for genotype calls at which reads of either allele were mapped more than a threshold. The threshold was set at the 90th percentile of observed read counts at the obtained markers for each allele of each sample. Thus, this filtering was applied to each sample with the sample-specific thresholds for the reference and alternative reads. The resulting genotype data had 5,035 SNP markers for 814 <italic toggle="yes">F</italic><sub>2</sub> individuals with an average read depth of 0.85×.</p>
    </sec>
    <sec id="iyad055-s1.7">
      <title>Generation of simulation data</title>
      <p>The simulation data sets were generated by mimicking the real data of chromosome 7, which showed relatively severe biases (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref>). Each data set was therefore simulated to consist of 620 markers on a diploid chromosome with a physical length of 50 Mb and a genetic length of 2 Morgans. Genotype data sets were simulated for 3 scenarios: a 2-way <italic toggle="yes">F</italic><sub>2</sub> population from inbred founders (homoP2_F2), a 2-way <italic toggle="yes">F</italic><sub>1</sub> population from outbred founders (hetP2_F1), and 8-way recombinant inbred lines (RILs) from inbred founders (homoP8_RIL). For each scenario, we simulated populations that had 10, 100, and 1,000 individuals. The genotype of each individual was simulated as described in the <italic toggle="yes">Genotype data simulation</italic> section of the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>.</p>
      <p>Based on the simulated genotype data, read counts were assigned to each marker of each individual, mimicking the allele read biases observed in the real data. The details are available in the <italic toggle="yes">Read count data simulation</italic> section of the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>. The expected offspring read depths were set to 0.1×, 0.25×, 0.5×, 0.75×, 1×, 2×, 3×, 10×, and 20×. The founder read depth was set to 5× for all data sets because founders are usually sequenced relatively deep even in low-coverage GBS studies. Since a typical genotyping pipeline filters out markers at which no read was observed in either of founders, we allocated at least 1 read to all markers of founders and then allocated the remaining reads (“nonzero” data sets). In addition, we also simulated data sets in which founders have no read at some markers and missing genotypes (“allowzero” data sets). Simulation data sets without assuming any allele read biases and mismapping reads were also generated with the same settings for the other parameters to generate genotype and read count data.</p>
    </sec>
    <sec id="iyad055-s1.8">
      <title>Evaluation of algorithms</title>
      <p>GBScleanR was tested and compared with LB-Impute and magicImpute. The input parameter settings are described in the <italic toggle="yes">Input parameter</italic> section of the <xref rid="sup1" ref-type="supplementary-material">Supplementary Methods</xref>. Each algorithm was evaluated by calculating the proportions of correctly estimated genotypes (correct call rate), incorrectly estimated genotypes (miscall rate), and missing genotype calls (missing call rate) for each offspring in the simulated data sets. The proportion of correct calls over nonmissing calls was also calculated as estimation accuracy. The means and standard deviations of these values were then obtained for each data set processed by each algorithm. The resultant scores are shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 1</xref>. To conduct an evaluation based on the concordance rate for the real data, we first selected relatively reliable genotype calls supported by more than 6 reads at markers that had less than a 20% missing rate and more than a 40% minor allele frequency. The read counts of the selected genotype calls were then set to 0. These masked real data were subjected to genotype estimation. The resultant estimated genotype data were evaluated based on the concordance rate, which is the proportion of estimated genotype calls matching the raw genotype calls at the masked genotype calls. Furthermore, we also calculated the averages of the missing rate, the number of recombinations, and the segregation distortion level in each chromosome. The segregation distortion level at each marker was obtained by dividing the chi-square value, which was calculated based on the assumption of a 1:2:1 genotype ratio for 3 possible genotypes, by the number of nonmissing genotype calls. The segregation distortion level of each chromosome was then obtained by summing up the segregation distortion levels of all markers in each chromosome. To identify recombination breakpoints of genome segments in the estimated genotype data, we searched the markers that showed genotypes switched between adjacent nonmissing markers. The middle points of those markers were considered recombination breakpoints.</p>
      <p>We also compared the running time of the 3 algorithms using the “nonzero” simulation data sets in the homoP2_F2, hetP2_F1, and homoP8_RIL scenarios. GBScleanR that has been implemented in R requires loading genotype data into the R environment and executing functions for genotype estimation step by step, while magicImpute and LB-Impute that were written in Mathematica and Java directly process input files and generate output files. Therefore, the overall process of GBScleanR including data loading, mating design specification, genotype estimation, and output data generation was measured as the running time of GBScleanR. The running time of magicImpute and LB-Impute was measured from the start to the end of the process. All computation was executed on a workstation with an AMD Ryzen Threadripper 2990WX CPU having 32 cores/64 threads and 64 Gb of RAM. Since magicImpute automatically tries to use half the number of threads for parallel computation, we also let GBScleanR use 32 threads for a fair comparison of running time. As LB-Impute does not support parallel computation and the main target of the running time comparison was GBScleanR versus magicImpute, LB-Impute was executed on a single thread.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="iyad055-s2">
    <title>Results</title>
    <sec id="iyad055-s2.1">
      <title>Evaluation using simulation data sets</title>
      <p>We first evaluated the 3 algorithms using the simulation data sets in the homoP2_F2, hetP2_F1, and homoP8_RIL scenarios (<xref rid="iyad055-F1" ref-type="fig">Fig. 1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 1</xref>). The superiority of GBScleanR lies in the IPO in which allele read biases and mismapping rates of markers are iteratively estimated. Thus, we also tested GBScleanR without IPO to demonstrate the effect of IPO on genotype estimation. In the homoP2_F2 scenario, GBScleanR with IPO scored the best correct call rates for almost all data sets (<xref rid="iyad055-F1" ref-type="fig">Fig. 1a–c</xref>). When the simulation data sets were generated without allowance to have no read at any markers in founders (indicated as “nonzero” in <xref rid="iyad055-F1" ref-type="fig">Fig. 1</xref>), LB-Impute showed the highest correct call rates for the data sets with a 0.1× offspring read depth. However, LB-Impute also scored the highest miscall rates for those data sets (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 3a–c</xref>). These increases in miscall rates resulted in the reduction of the estimation accuracy that was measured as the proportion of correct calls over nonmissing calls (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4a–c</xref>). A reduction in accuracy was observed in all of the tested algorithms when no reads at some markers were allowed for founders (shown as “allowzero” in <xref rid="iyad055-F1" ref-type="fig">Fig. 1</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4</xref>). Nevertheless, GBScleanR was less affected by the markers with 0 reads in founders and outperformed the other algorithms. In addition, GBScleanR with IPO only increased the correct call rate as offspring read depth increased, while the other algorithms showed a plateau at 0.5–20× in the results for the “nonzero” data sets (<xref rid="iyad055-F1" ref-type="fig">Fig. 1a–c</xref>). The difference in the correct call rate between GBScleanR with IPO and the other algorithms reached more than 25 percentage points at maximum in the data with a 20× offspring read depth. On the other hand, the algorithms except for GBScleanR with IPO showed an increase in the miscall rate as the read depth increased (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 3a–c</xref>). The increase in the miscall rate resulted in the reduction of the estimation accuracy as the read depth increased (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4a–c</xref>).</p>
      <fig position="float" id="iyad055-F1" fig-type="figure">
        <label>Fig. 1.</label>
        <caption>
          <p>Offspring genotype estimation accuracies for the simulation data. The plots show correct call rates for the data sets with given read depths for offspring (<italic toggle="yes">x</italic>-axis) in the homoP2_F2 (a–c), hetP2_F1 (d–f), and homoP8_RIL (g–i) scenarios. The rows of the panels indicate the differences in the number of samples in the simulated data, as shown in the strips on the right. Solid lines and dashed lines represent the results for the data sets with (allowzero) or without (nonzero) missing founder reads. “GBSR” and “GBSR_noIPO” represent GBScleanR with and without IPO. “LB” and “Magic” indicate LB-Impute and magicImpute, respectively.</p>
        </caption>
        <graphic xlink:href="iyad055f1" position="float"/>
      </fig>
      <p>Similar to the results in homoP2_F2, GBScleanR showed the best correct call rates in almost all data sets of hetP2_F1, and the difference between the algorithms reached more than 25 percentage points at maximum (<xref rid="iyad055-F1" ref-type="fig">Fig. 1d–f</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4d–f</xref>). Unlike the homoP2_F2 data sets, the genotype estimation accuracy for the hetP2_F1 data sets was highly affected by the number of samples. The increase in the correct call rate between the data sets with 10 and 1,000 samples reached ∼26 percentage points at maximum in the hetP2_F1 data sets with a 3× offspring read depth, whereas the maximum increase in the score in the homoP2_F2 data sets was ∼14 percentage points (<xref rid="sup1" ref-type="supplementary-material">Supplementary Data 1</xref>).</p>
      <p>Unlike the F2 data sets, we could not find any remarkable difference in the accuracy of genotype estimation for the homoP8_RIL data sets (<xref rid="iyad055-F1" ref-type="fig">Fig. 1g–i</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 4g–i</xref>). This result seems to have reflected the higher homozygosity in the simulated genotypes. Since the offspring in the homoP8_RIL data sets had homozygotes at almost all markers due to repeated self-fertilization, only the reads of either allele representing the true genotype could be observed at any markers.</p>
      <p>To compare the performance of the algorithms in the cases where no allele read bias and mismapping exist in data, we simulated data sets without assuming allele read bias and mismapping for generating read count data. All 3 algorithms scored almost the same estimation accuracy for the nonerror data sets and did not show any reduction of the accuracy even if read depth increased in any scenarios (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 5</xref> and <xref rid="sup1" ref-type="supplementary-material">Data 2</xref>).</p>
      <p>GBScleanR and magicImpute have been designed to simultaneously estimate the genotypes of both founders and offspring. In addition, both algorithms provide phasing information for the offspring genotypes. As expected from the estimation accuracy for offspring, GBScleanR also outperformed magicImpute in the estimation of founder genotypes and phased offspring genotypes (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs. 6 and 7</xref>). The details were described in the <xref rid="sup1" ref-type="supplementary-material">Supplementary Results</xref>.</p>
    </sec>
    <sec id="iyad055-s2.2">
      <title>Less biased estimation by GBScleanR</title>
      <p>We further evaluated the quality of the estimated genotypes by visualizing the estimated genotype ratio at each marker. This visual inspection employed the “nonzero” homoP2_F2 data sets that have 1,000 offspring with offspring read depths at 0.5×, 3×, and 20×. In an <italic toggle="yes">F</italic><sub>2</sub> population derived from inbred parents, we can expect a 1:2:1 genotype ratio in offspring if no segregation distortion occurs. As shown in <xref rid="iyad055-F2" ref-type="fig">Fig. 2</xref>, the estimations by GBScleanR showed 1:2:1 segregation at almost all markers, which nearly completely overlapped with the true genotype ratio throughout the chromosome, except for the data set with 0.5× offspring reads (<xref rid="iyad055-F2" ref-type="fig">Fig. 2a–c</xref>). In addition, miscalls were distributed almost uniformly throughout the entire chromosome, with a very small amount per marker. In contrast, LB-Impute showed severely biased genotype ratios with high miscall rates clustered at several loci on the chromosome (<xref rid="iyad055-F2" ref-type="fig">Fig. 2d–f</xref>). The increase in offspring read depth made biased genotype estimation more severe and increased miscall rates, as also shown in <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 3</xref>. Similar results were observed in the case of magicImpute (<xref rid="iyad055-F2" ref-type="fig">Fig. 2g–i</xref>). Even though fewer miscalls were generated in magicImpute compared to LB-Impute, many regions showed a biased estimation of reference homozygotes particularly in the data set with 0.5× offspring read depth (<xref rid="iyad055-F2" ref-type="fig">Fig. 2g</xref>). The loci showing higher miscall rates overlapped between the plots for LB-Impute and magicImpute. Thus, these miscalls and biased genotype estimations might be caused by error-prone markers. Similar results were observed in the data sets with 10 and 100 offspring (<xref rid="sup1" ref-type="supplementary-material">Supplementary Figs. 8 and 9</xref>). Although the true genotypes did not show a 1:2:1 ratio due to the small population size in the data sets with 10 offspring, GBScleanR showed the estimated genotype ratios that highly overlapped with the true ratios (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 8a–c</xref>). These results demonstrated the robustness of genotype estimation by GBScleanR even at error-prone markers.</p>
      <fig position="float" id="iyad055-F2" fig-type="figure">
        <label>Fig. 2.</label>
        <caption>
          <p>Genotype ratios at markers ordered along a simulated chromosome. The plots show genotype ratios calculated from the estimated genotype data for the homoP2_F2 data set with 1,000 offspring and 620 markers with offspring read depths at 0.5×, 3×, and 20× without allowance of no reads in founders. “GBSR” (a–c), “LB” (d–f), and “Magic” (g–i) indicate genotypes estimated by GBScleanR, LB-Impute, and magicImpute, respectively. Proportions of reference homozygous, heterozygous, and alternative homozygous genotypes are represented by green, magenta, and blue lines, respectively. Orange lines indicate miscall rates at markers. True genotype ratios are indicated by transparent lines in the panels for GBScleanR (a–c).</p>
        </caption>
        <graphic xlink:href="iyad055f2" position="float"/>
      </fig>
    </sec>
    <sec id="iyad055-s2.3">
      <title>Evaluation using real data</title>
      <p>We finally evaluated the algorithms using real data containing error-prone markers. First, we measured the concordance rate of the estimated genotype calls using the masked genotype data created from the real data. GBScleanR scored the best concordance rate in all chromosomes except for chromosome 11 in comparison with LB-Impute and magicImpute (<xref rid="iyad055-F3" ref-type="fig">Fig. 3a</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 5</xref>). Relatively large differences were observed in chromosomes 7, 8, and 10, in which GBScleanR scored 10.5, 12.5, and 12.0 percentage points higher concordance rates than magicImpute, respectively. On the other hand, chromosome 5 showed only a 1.7 percentage point difference between GBScleanR and magicImpute. Relatively low concordance rates were observed in the chromosomes with more severe allele read biases, which were chromosomes 7–12, than those in the other chromosomes (<xref rid="iyad055-F3" ref-type="fig">Fig. 3a</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref>).</p>
      <fig position="float" id="iyad055-F3" fig-type="figure">
        <label>Fig. 3.</label>
        <caption>
          <p>Evaluation of genotype estimation accuracy using the real data. a) Concordance rates of true genotype calls and estimated genotype calls at masked genotype calls are shown for each chromosome. The averages of the missing rate (b), the number of recombinations (c), and the segregation distortion level (d) are also visualized as bar plots for each chromosome. Blue, gray, and magenta bars indicate the values of GBScleanR (GBSR), LB-Impute (LB), and magicImpute (Magic), respectively.</p>
        </caption>
        <graphic xlink:href="iyad055f3" position="float"/>
      </fig>
      <p>Even though GBScleanR showed better concordance rates than the others, the genotype concordance does not directly mean higher accuracy because we cannot know the true genotype of the real data, and there is no evidence of whether the genotype calls selected for masking were truly reliable or contained a large number of erroneous genotype calls. To further evaluate the performance of the algorithms, we then calculated the average missing rate and the number of recombinations in each chromosome. In the case of the missing rate, the highest values were scored by magicImpute for all chromosomes, while GBScleanR and LB-Impute showed similar scores in a majority of chromosomes (<xref rid="iyad055-F3" ref-type="fig">Fig. 3b</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 5</xref>). Similar to the concordance rate, chromosomes with more severe allele read biases showed higher missing rates. A clear difference between the algorithms was observed in the number of recombinations (<xref rid="iyad055-F3" ref-type="fig">Fig. 3c</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 5</xref>). LB-Impute always estimated the most frequent recombinations, followed by magicImpute, whereas GBScleanR showed the fewest numbers of recombinations on all chromosomes. To further evaluate the recombination events, we measured the genomic segment lengths between the recombination breakpoints in chromosomes (<xref rid="iyad055-T2" ref-type="table">Table 2</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 6</xref>). We found that LB-Impute estimated many more short segments. The genotype data estimated by GBScleanR had 116 and 430 segments in the ranges of 0–1 and 1–2 Mb, respectively (<xref rid="iyad055-T2" ref-type="table">Table 2</xref>). On the other hand, LB-Impute estimated the genotype data with 2,164 and 4,166 segments ranging 0-1 and 1-2 Mb, respectively. The magicImpute algorithm generated fewer short segments than LB-Impute but a larger number than GBScleanR, which were 627 and 1,716, respectively. In addition, GBScleanR, magicImpute, and LB-Impute estimated 14, 235, and 948 segments ranging 0-1 Mb that were heterozygous and flanked by the same homozygous genotypes at both sides, which indicated double crossovers within 1-Mb stretches (<xref rid="iyad055-T2" ref-type="table">Table 2</xref>). The probability of a double crossover within 1 Mb is ∼0.08% when 1 Mb equals 4 cM in an <italic toggle="yes">F</italic><sub>2</sub> population. Thus, the expected number of double crossovers is &lt; 2 in the population with 814 individuals derived from 1,628 gametes. Even though the 14 double crossovers within 1-Mb stretches generated by GBScleanR were too frequent for an ideal <italic toggle="yes">F</italic><sub>2</sub> population, considering the distant cross to generate the given population, these results suggested that GBScleanR estimated more probable and acceptable numbers of recombinations. The excess crossovers over short distances seemed to artificially push up the numbers of recombinations in the estimated genotype data of LB-Impute and magicImpute.</p>
      <table-wrap position="float" id="iyad055-T2">
        <label>Table 2.</label>
        <caption>
          <p>The number of genome segments.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1"/>
              <th colspan="2" align="center" rowspan="1">Segment length</th>
            </tr>
            <tr>
              <th align="left" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1"/>
              <th align="center" rowspan="1" colspan="1">0–1 Mb</th>
              <th align="center" rowspan="1" colspan="1">1–2 Mb</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="3" colspan="1">Total<italic toggle="yes"><sup><xref rid="iyad055-tblfn1" ref-type="table-fn">a</xref></sup></italic></td>
              <td rowspan="1" colspan="1">GBScleanR</td>
              <td rowspan="1" colspan="1">116</td>
              <td rowspan="1" colspan="1">430</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">magicImpute</td>
              <td rowspan="1" colspan="1">627</td>
              <td rowspan="1" colspan="1">1,716</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">LB-Impute</td>
              <td rowspan="1" colspan="1">2,164</td>
              <td rowspan="1" colspan="1">4,166</td>
            </tr>
            <tr>
              <td rowspan="3" colspan="1">Double crossovers<italic toggle="yes"><sup><xref rid="iyad055-tblfn2" ref-type="table-fn">b</xref></sup></italic></td>
              <td rowspan="1" colspan="1">GBScleanR</td>
              <td rowspan="1" colspan="1">14</td>
              <td rowspan="1" colspan="1">40</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">magicImpute</td>
              <td rowspan="1" colspan="1">235</td>
              <td rowspan="1" colspan="1">558</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">LB-Impute</td>
              <td rowspan="1" colspan="1">948</td>
              <td rowspan="1" colspan="1">1,395</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="iyad055-tblfn1">
            <p>The total number of genome segments that have a same genotype continuously with the length of 0–1 or 1–2 Mb.</p>
          </fn>
          <fn id="iyad055-tblfn2">
            <p>The number of genome segments that have a heterozygous genotype continuously with the length of 0–1 or 1–2 Mb and flanked by homozygous segments of a same allele.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
      <p>Finally, we measured the segregation distortion level (<xref rid="iyad055-F3" ref-type="fig">Fig. 3d</xref> and <xref rid="sup1" ref-type="supplementary-material">Supplementary Data 5</xref>). A relatively low distortion level was observed in the genotype data estimated via GBScleanR compared with those estimated by LB-Impute and magicImpute (<xref rid="iyad055-F3" ref-type="fig">Fig. 3d</xref>). Chromosome 1 was the most distorted in the genotype data estimated by GBScleanR, while the other algorithms also showed similar distortion levels in this chromosome. On the other hand, the highest distortion level was observed in chromosome 7 in the cases of LB-Impute and magicImpute (<xref rid="iyad055-F3" ref-type="fig">Fig. 3d</xref>). Unlike chromosome 1, GBScleanR showed a much smaller distortion level that was approximately half of the levels scored by the other algorithms. In contrast, the 3 algorithms all resulted in the mildest distortion in chromosome 3 (<xref rid="iyad055-F3" ref-type="fig">Fig. 3d</xref>). To visually inspect the segregation distortion levels, we created line plots of the estimated genotype ratios for chromosomes 1, 3, and 7 (<xref rid="iyad055-F4" ref-type="fig">Fig. 4</xref>). The line plots indicated that all of the algorithms estimated quite similar genotypes for chromosomes 1 and 3, while clearer differences were observed in the plots for chromosome 7. As fewer markers on chromosomes 1 and 3 showed severe allele read biases, these chromosomes might have fewer error-prone markers (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref>). Therefore, all of the algorithms resulted in similar estimations (<xref rid="iyad055-F4" ref-type="fig">Fig. 4a–f</xref>). Since all algorithms showed similar distortion patterns around 30 Mb of chromosome 1, the distortion on chromosome 1 was likely to be the true genetic characteristic of this population but not due to the misestimation (<xref rid="iyad055-F4" ref-type="fig">Fig. 4a–c</xref>). On the other hand, slight distortions at 5, 10, and 35 Mb of chromosome 3 that were observed in the genotypes estimated by LB-Impute and magicImpute, but not by GBScleanR, might be artifacts produced by biased estimations at error-prone markers (<xref rid="iyad055-F4" ref-type="fig">Fig. 4d–f</xref>). In the case of chromosome 7, LB-Impute and magiImpute obviously failed to estimate the genotypes and produced artificially distorted genotype ratio patterns (<xref rid="iyad055-F4" ref-type="fig">Fig. 4g–i</xref>). In contrast, GBScleanR showed a smooth and less fluctuating change in the genotype ratio, which was an acceptable pattern as the genotype ratio of an <italic toggle="yes">F</italic><sub>2</sub> population, throughout the chromosome, although severe distortion was observed, probably due to the true segregation distortion (<xref rid="iyad055-F4" ref-type="fig">Fig. 4i</xref>). The other chromosomes also exhibited similar results to those observed for chromosomes 1, 3, and 7 (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 10</xref>). LB-Impute and magicImpute always resulted in highly biased genotype estimations at many loci and fluctuated genotype ratios throughout the chromosomes. In clear contrast to those results, GBScleanR showed relatively smooth and gradual changes in the genotype ratios throughout the chromosomes. Even though some loci showed distorted genotype ratios, the majority of chromosomal regions had ratios relatively close to 1:2:1 in almost all chromosomes in the GBScleanR results compared with those of the other algorithms. Overall, the performance evaluation on the real data demonstrated the superiority and robustness of GBScleanR against error-prone markers.</p>
      <fig position="float" id="iyad055-F4" fig-type="figure">
        <label>Fig. 4.</label>
        <caption>
          <p>Genotype ratio of estimated offspring genotypes in the real data. Genotype ratios at markers along chromosomes 1 (a–c), 3 (d–f), and 7 (g–i) in the real data are shown as line plots. “LB,” “Magic,” and “GBSR” indicate LB-Impute, magicImpute, and GBScleanR, respectively. Proportions of the reference homozygous, heterozygous, and alternative homozygous genotypes are represented by green, magenta, and blue lines, respectively.</p>
        </caption>
        <graphic xlink:href="iyad055f4" position="float"/>
      </fig>
    </sec>
    <sec id="iyad055-s2.4">
      <title>Effect of the iterative optimization for allele read biases and mismapping rates</title>
      <p>In addition to demonstrating the superiority of GBScleanR, we tested the effect of IPO on genotype estimation by switching on and off the iterative calculations for either or both of allele read biases and mismapping rates. As already shown, GBScleanR with no IPO (noIPO) led to a reduction in the estimation accuracy for the simulation data sets of homoP2_F2 and hetP2_F1 compared with GBScleanR with IPO (withIPO) (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F1" ref-type="fig">1</xref>). On the other hand, when only the iterative optimization for the marker-specific mismapping rate was turned off (fixMismap), no remarkable difference was observed. Interestingly, only turning off the iterative optimization of marker-specific allele read bias (fixBias) resulted in even worse accuracy than noIPO. The reduction of accuracy by the fixBias setting might be caused by misestimation of the mismapping rates that were inferred based on genotype data containing miscalls generated due to the assumption of the fixed allele read bias. Similar to the comparison between GBScleanR and magicImpute, the homoP8_RIL showed no remarkable difference even with or without IPO (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F1" ref-type="fig">1</xref>).</p>
      <p>Unlike the cases in the simulation data sets, the real data showed that not only the fixBias and noIPO settings but also the fixMismap setting might result in less accurate estimation (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F2" ref-type="fig">2</xref> and <xref rid="sup1" ref-type="supplementary-material">Data 7</xref>). Although we cannot know the true genotype of the real data, the fixMismap showed lesser smooth lines in the plots and more severe genotype distortions than the withIPO setting (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F2" ref-type="fig">2</xref>). All of the metrics including the concordance rate and the recombination rate indicated the superiority of the withIPO setting over the other settings (<xref rid="sup1" ref-type="supplementary-material">Supplementary Data 7</xref>). These results indicated that the real data may have a nonrandom pattern of the mismapping-prone marker distribution, and the iterative optimizations for both allele read biases and mismapping rates are required for proper genotype estimation. GBScleanR with IPO showed robustness against both types of errors.</p>
    </sec>
    <sec id="iyad055-s2.5">
      <title>Comparing running time</title>
      <p>We also compared running times using the simulation data sets. As shown in <xref rid="iyad055-T3" ref-type="table">Table 3</xref>, GBScleanR completed all processes of genotype estimation faster than LB-Impute and magicImpute for the simulation data sets of biparental populations, including homoP2_F2 and hetP2_F1. In the case of the largest homoP2_F2 data set that consists of 1,000 samples, GBScleanR took only 17 s even with 4 cycles of IPO, while magicImpute and LB-Impute consumed 6.4 and 122.7 times as long. On the other hand, a 2.1-times longer calculation at the maximum was observed in GBScleanR with 4 cycles of IPO compared to magicImpute for the homoP8_RIL data sets (<xref rid="iyad055-T3" ref-type="table">Table 3</xref>). Nevertheless, IPO was not required for RIL populations, as shown in <xref rid="iyad055-F1" ref-type="fig">Fig. 1</xref>, and GBScleanR without IPO could finish the calculations 48% faster than magicImpute even in the homoP8_RIL data set with 1,000 samples.</p>
      <table-wrap position="float" id="iyad055-T3">
        <label>Table 3.</label>
        <caption>
          <p>Running time.</p>
        </caption>
        <table frame="hsides" rules="groups">
          <colgroup span="1">
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
            <col valign="top" align="left" span="1"/>
          </colgroup>
          <thead>
            <tr>
              <th align="left" rowspan="1" colspan="1">Data set</th>
              <th align="center" rowspan="1" colspan="1">No. of samples</th>
              <th align="center" rowspan="1" colspan="1">GBScleanR<italic toggle="yes"><sup><xref rid="iyad055-tblfn4" ref-type="table-fn">a</xref></sup></italic></th>
              <th align="center" rowspan="1" colspan="1">magicImpute</th>
              <th align="center" rowspan="1" colspan="1">LB-Impute</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td rowspan="1" colspan="1">homoP2_F2</td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">2 (1)</td>
              <td rowspan="1" colspan="1">3</td>
              <td rowspan="1" colspan="1">23</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">homoP2_F2</td>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">3 (1)</td>
              <td rowspan="1" colspan="1">14</td>
              <td rowspan="1" colspan="1">211</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">homoP2_F2</td>
              <td rowspan="1" colspan="1">1,000</td>
              <td rowspan="1" colspan="1">17 (8)</td>
              <td rowspan="1" colspan="1">108</td>
              <td rowspan="1" colspan="1">2,086</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">hetP2_F1</td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">4 (2)</td>
              <td rowspan="1" colspan="1">4</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">hetP2_F1</td>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">11 (4)</td>
              <td rowspan="1" colspan="1">20</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">hetP2_F1</td>
              <td rowspan="1" colspan="1">1,000</td>
              <td rowspan="1" colspan="1">81 (24)</td>
              <td rowspan="1" colspan="1">170</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">homoP8_RIL</td>
              <td rowspan="1" colspan="1">10</td>
              <td rowspan="1" colspan="1">36 (9)</td>
              <td rowspan="1" colspan="1">98</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">homoP8_RIL</td>
              <td rowspan="1" colspan="1">100</td>
              <td rowspan="1" colspan="1">205 (50)</td>
              <td rowspan="1" colspan="1">336</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
            <tr>
              <td rowspan="1" colspan="1">homoP8_RIL</td>
              <td rowspan="1" colspan="1">1,000</td>
              <td rowspan="1" colspan="1">1,736 (432)</td>
              <td rowspan="1" colspan="1">829</td>
              <td rowspan="1" colspan="1">NA</td>
            </tr>
          </tbody>
        </table>
        <table-wrap-foot>
          <fn id="iyad055-tblfn3">
            <p>Running times in seconds for each data set are shown.</p>
          </fn>
          <fn id="iyad055-tblfn4">
            <p>The numbers in parenthesis indicate the running times of GBScleanR without the IPO.</p>
          </fn>
        </table-wrap-foot>
      </table-wrap>
    </sec>
  </sec>
  <sec sec-type="discussion" id="iyad055-s3">
    <title>Discussion</title>
    <p>GBScleanR is an R package and consists of a main tool that conducts error correction and utility functions that handle genotype data in the variant call format (VCF). <xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 13</xref> presents the data analysis workflow and the related functions that are implemented in GBScleanR. The algorithm is designed to estimate the true genotype calls along chromosomes from the given allele read counts in a VCF file that is generated by SNP callers such as GATK and TASSEL-GBS (<xref rid="iyad055-B19" ref-type="bibr">McKenna <italic toggle="yes">et al.</italic> 2010</xref>; <xref rid="iyad055-B12" ref-type="bibr">Glaubitz <italic toggle="yes">et al.</italic> 2014</xref>). The current implementation supports genotypic data for mapping populations that are derived from 2 or more diploid founders followed by selfings, sibling crosses, or random crosses, for example, <italic toggle="yes">F</italic><sub>2</sub>- and 8-way RILs. Our method assumes that markers are biallelic and ordered along the chromosomes and the reads are mapped onto a reference genome sequence. To access the large amounts of genotype data required, an input VCF file is first converted into a genomic data structure (GDS) file (<xref rid="iyad055-B33" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2012</xref>). This conversion automatically filters out nonbiallelic markers. GBScleanR provides functions for data visualization, filtering, and loading/writing a VCF file. Furthermore, the data structure of the GDS file created via this package is compatible with that used in the SeqArray package and can be further converted to a derivative GDS format used in the SNPRelate, GWASTools, and GENESIS packages, which are designed to handle large amounts of variant data and conduct regression analysis (<xref rid="iyad055-B13" ref-type="bibr">Gogarten <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="iyad055-B14" ref-type="bibr">2019</xref>; <xref rid="iyad055-B33" ref-type="bibr">Zheng <italic toggle="yes">et al.</italic> 2012</xref>, <xref rid="iyad055-B32" ref-type="bibr">2017</xref>). Therefore, GBScleanR can be built in a pipeline for a genetic study that allows us smooth access to the given large genotype data for visualization, filtering, error correction, and regression analysis without the requirement for extra data format conversion steps.</p>
    <p>The present study introduced an algorithm to provide robust error correction on genotype data with error-prone markers. Any genotype data derived from GBS or other RRS-based genotyping techniques have the chance to contain such error-prone markers even after trying to filter out erroneous markers. Particularly, a population derived from a cross between distant relatives, as in our case in which a cultivated rice <italic toggle="yes">O. sativa</italic> and a wild rice <italic toggle="yes">O. longistaminata</italic> were crossed, may potentially have a relatively high proportion of error-prone markers. If a model uniformly assumes a 50% chance of obtaining a read for either allele for all markers at a heterozygous site, any HMM-based methods and sliding window methods can theoretically be deceived by the error-prone markers. In addition, erroneous genotype calls induced by mismapping easily mess up genotype data and lead to unexpected detection of heterozygous genotypes and overrepresented recombination events. Since we could not distinguish which reads were mismapped reads in the real data and had no clue to estimate the true pattern of mismappings, we assumed a random distribution of mismapping-prone markers in the data simulation. Those randomly distributed mismapping-prone markers did not show any remarkable effect on the estimation accuracy even with the fixMismap setting (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F1" ref-type="fig">1</xref>). On the other hand, mimicked marker-specific allele read biases caused the reduction in the estimation accuracy with the fixBias and noIPO settings (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F1" ref-type="fig">1</xref>). However, the fixMismap setting resulted in less reliable genotype estimation than the withIPO setting for the real data (<xref rid="sup1" ref-type="supplementary-material">Supplementary Fig. 1</xref><xref rid="iyad055-F2" ref-type="fig">2</xref> and <xref rid="sup1" ref-type="supplementary-material">Data 7</xref>). These results indicate that real data seem to have a specific pattern of error-prone marker distribution that interferes with proper genotype estimation. The distribution of error-prone markers would be different between given populations and affected by actual biological variations that exist in given genomes. Our study indicated the importance to incorporate marker-specific error patterns in the HMM for accurate genotype estimation and demonstrated the superiority and robustness of GBScleanR. The distortion level and the recombination frequency have large effects on downstream genetic analyses, and those values themselves are research targets. Any genetic and genomic study relies on the given genotype data, and the accuracy of genotyping has a crucial effect on the quality of such research. The accuracy of genotyping can be evaluated by 3 criteria: correct calls, miscalls, and missing calls. Usually, miscalls have a more destructive effect on post-genotyping analyses than missing calls because post-genotyping analyses regularly suppose all genotype calls to be true even if those include miscalls and potentially generate misleading results. Furthermore, if the wrongly genotyped markers are clustered in a particular region, all statistical calculations for that region will be unreliable. Our study also demonstrated the reliability of GBScleanR as a support tool for genetic studies that handle genotype data even with or without error-prone markers.</p>
    <p>In this study, we conducted filtering based on a quantile of read counts for the real data to filter out genotype calls supported by overrepresented sequences that are possibly derived from paralogous and repetitive sequences. A large number of overrepresented mismapped reads do not increase the reliability of genotype calls but rather cause misestimation of homozygotes as heterozygotes. Although GBScleanR tries to detect mismapped reads, we recommend filtering out overrepresented reads to reduce their negative impact on estimation. Nevertheless, GBScleanR accepts error-prone markers and recognizes the error pattern via IPO. Therefore, no strict filtering based on allele frequency and the missing rate is required, which is regularly performed for RRS-based genotyping data (<xref rid="iyad055-B16" ref-type="bibr">Kim <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyad055-B26" ref-type="bibr">Scheben <italic toggle="yes">et al.</italic> 2017</xref>). These filtering steps usually remove a large number of the detected SNP markers (<xref rid="iyad055-B11" ref-type="bibr">Gardner <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="iyad055-B22" ref-type="bibr">Pootakham <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="iyad055-B5" ref-type="bibr">Celik <italic toggle="yes">et al.</italic> 2016</xref>; <xref rid="iyad055-B3" ref-type="bibr">Boyles <italic toggle="yes">et al.</italic> 2017</xref>). In the case of our real data, filtering to remove possible error-prone markers based on, for example, minor allele frequency &lt;5% and missing rate &gt;20%, left only 162 out of 5,035 SNPs. Markers that would be filtered out may contain partial information about the true genotypes. GBScleanR can integrate those less informative markers into the error correction process by tweaking the HMM. Since there is no clear guideline for filtering strength, which should differ depending on the data set used, filtering criteria are left in the hands of researchers. GBScleanR allows users to skip such an arbitrary step and improves the cost efficiency of the RRS-based genotyping system by reducing the number of unused reads obtained via costly NGS.</p>
    <p>As GBScleanR requires the SNP markers ordered along chromosomes, reference genome sequences are a fundamental resource. The recent remarkable development of the third-generation sequencers, named Sequel by Pacific Bioscience and MinION by Oxford Nanopore Technologies, enables us to obtain high-quality genome sequences at a reasonable cost (<xref rid="iyad055-B24" ref-type="bibr">Rhoads and Au 2015</xref>; <xref rid="iyad055-B18" ref-type="bibr">Lu <italic toggle="yes">et al.</italic> 2016</xref>). Reference genome information for any organism is expected to become available soon. Thus, RRS-based genotyping systems underpinned by a flexible robust error correction tool such as GBScleanR will become practical platforms for use in breeding programs requiring a prompt and efficient scheme under limited periods and budgets. Distant relatives, including the ancestral wild species of domesticated species, are important genetic resources, particularly in plant breeding, that can improve abiotic and biotic stress resistance (<xref rid="iyad055-B1" ref-type="bibr">Atwell <italic toggle="yes">et al.</italic> 2014</xref>; <xref rid="iyad055-B17" ref-type="bibr">Kole <italic toggle="yes">et al.</italic> 2015</xref>; <xref rid="iyad055-B4" ref-type="bibr">Brozynska <italic toggle="yes">et al.</italic> 2016</xref>). For such genetic studies and breeding projects using wild species, GBScleanR could be the first choice as a fundamental tool for genotype identification coupled with an RRS-based genotyping system.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material id="sup1" position="float" content-type="local-data">
      <label>iyad055_Supplementary_Data</label>
      <media xlink:href="iyad055_supplementary_data.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <sec sec-type="data-availability" id="iyad055-s4">
    <title>Data availability</title>
    <p>The stable version of GBScleanR is available on Bioconductor (<ext-link xlink:href="https://bioconductor.org/packages/GBScleanR/" ext-link-type="uri">https://bioconductor.org/packages/GBScleanR/</ext-link>). The latest developmental version is available on GitHub (<ext-link xlink:href="https://github.com/tomoyukif/GBScleanR" ext-link-type="uri">https://github.com/tomoyukif/GBScleanR</ext-link>). This package and the source code are distributed under GNU General Public License version 3. The vcf file of the real data and R scripts for the data analyses performed in this study are also available on GitHub (<ext-link xlink:href="https://github.com/tomoyukif/GBSR_SupFiles" ext-link-type="uri">https://github.com/tomoyukif/GBSR_SupFiles</ext-link>). Further description of the sequencing reads for the real data can be found in <xref rid="iyad055-B10" ref-type="bibr">Furuta <italic toggle="yes">et al.</italic> (2017)</xref>.</p>
    <p><xref rid="sup1" ref-type="supplementary-material">Supplemental material</xref> available at <italic toggle="yes">GENETICS</italic> online.</p>
  </sec>
  <sec id="iyad055-s5">
    <title>Funding</title>
    <p>This work was supported by the CREST program of the Japan Science and Technology Agency (JPMJCR13B1 to M.A.); the SATREPS program in collaboration with the Japan Science and Technology Agency and the Japan International Cooperation Agency (JPMJSA1706 to T.F. and M.A.); KAKENHI of the Ministry of Education, Culture, Sports, Science and Technology of Japan (JP20H05912 to M.A.); and KAKENHI of Japan Society for the Promotion of Science (JP20K15503 to T.F. and JP20H02958 to T.Y.).</p>
  </sec>
  <sec sec-type="COI-statement" id="iyad055-s6">
    <title>Conflicts of interest statement</title>
    <p>The author(s) declare no conflict of interest.</p>
  </sec>
  <sec id="iyad055-s7">
    <title>Author contributions</title>
    <p>T.F. conceived and designed the study. T.F. also developed the R package, conducted bioinformatics analysis, and drafted the manuscript. M.A. and T.Y. supervised the study. All authors read and approved the final version of the manuscript.</p>
  </sec>
  <ref-list id="ref1">
    <title>Literature cited</title>
    <ref id="iyad055-B1">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Atwell</surname><given-names>BJ</given-names></string-name>, <string-name><surname>Wang</surname><given-names>H</given-names></string-name>, <string-name><surname>Scafaro</surname><given-names>AP</given-names></string-name></person-group>. <article-title>Could abiotic stress tolerance in wild relatives of rice be used to improve <italic toggle="yes">Oryza sativa</italic>?</article-title><source>Plant Sci</source>. <year>2014</year>;<volume>215–216</volume>:<fpage>48</fpage>–<lpage>58</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.plantsci.2013.10.007</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B2">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baird</surname><given-names>NA</given-names></string-name>, <string-name><surname>Etter</surname><given-names>PD</given-names></string-name>, <string-name><surname>Atwood</surname><given-names>TS</given-names></string-name>, <string-name><surname>Currey</surname><given-names>MC</given-names></string-name>, <string-name><surname>Shiver</surname><given-names>AL</given-names></string-name>, <string-name><surname>Lewis</surname><given-names>ZA</given-names></string-name>, <string-name><surname>Selker</surname><given-names>EU</given-names></string-name>, <string-name><surname>Cresko</surname><given-names>WA</given-names></string-name>, <string-name><surname>Johnson</surname><given-names>EA</given-names></string-name></person-group>. <article-title>Rapid SNP discovery and genetic mapping using sequenced RAD markers</article-title>. <source>PLoS One</source><year>2008</year>;<volume>3</volume>(<issue>10</issue>):<comment>e3376</comment>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0003376</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B3">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boyles</surname><given-names>RE</given-names></string-name>, <string-name><surname>Pfeiffer</surname><given-names>BK</given-names></string-name>, <string-name><surname>Cooper</surname><given-names>EA</given-names></string-name>, <string-name><surname>Zielinski</surname><given-names>KJ</given-names></string-name>, <string-name><surname>Myers</surname><given-names>MT</given-names></string-name>, <string-name><surname>Rooney</surname><given-names>WL</given-names></string-name>, <string-name><surname>Kresovich</surname><given-names>S</given-names></string-name></person-group>. <article-title>Quantitative trait loci mapping of agronomic and yield traits in two grain Sorghum biparental families</article-title>. <source>Crop Sci</source>. <year>2017</year>;<volume>57</volume>(<issue>5</issue>):<fpage>2443</fpage>–<lpage>2456</lpage>. doi:<pub-id pub-id-type="doi">10.2135/cropsci2016.12.0988</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B4">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brozynska</surname><given-names>M</given-names></string-name>, <string-name><surname>Furtado</surname><given-names>A</given-names></string-name>, <string-name><surname>Henry</surname><given-names>RJ</given-names></string-name></person-group>. <article-title>Genomics of crop wild relatives: expanding the gene pool for crop improvement</article-title>. <source>Plant Biotechnol J</source>. <year>2016</year>;<volume>14</volume>(<issue>4</issue>):<fpage>1070</fpage>–<lpage>1085</lpage>. doi:<pub-id pub-id-type="doi">10.1111/pbi.12454</pub-id>.<pub-id pub-id-type="pmid">26311018</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B5">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Celik</surname><given-names>I</given-names></string-name>, <string-name><surname>Bodur</surname><given-names>S</given-names></string-name>, <string-name><surname>Frary</surname><given-names>A</given-names></string-name>, <string-name><surname>Doganlar</surname><given-names>S</given-names></string-name></person-group>. <article-title>Genome-wide SNP discovery and genetic linkage map construction in sunflower (<italic toggle="yes">Helianthus annuus</italic> L.) using a genotyping by sequencing (GBS) approach</article-title>. <source>Mol Breeding</source><year>2016</year>;<volume>36</volume>(<issue>9</issue>):<fpage>1</fpage>–<lpage>9</lpage>. doi:<pub-id pub-id-type="doi">10.1007/s11032-016-0558-8</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B6">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DaCosta</surname><given-names>JM</given-names></string-name>, <string-name><surname>Sorenson</surname><given-names>MD</given-names></string-name></person-group>. <article-title>Amplification biases and consistent recovery of loci in a double-digest RAD-seq protocol</article-title>. <source>PLoS One</source><year>2014</year>;<volume>9</volume>(<issue>9</issue>):<comment>e106713</comment>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0106713</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B7">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davey</surname><given-names>JW</given-names></string-name>, <string-name><surname>Cezard</surname><given-names>T</given-names></string-name>, <string-name><surname>Fuentes-Utrilla</surname><given-names>P</given-names></string-name>, <string-name><surname>Eland</surname><given-names>C</given-names></string-name>, <string-name><surname>Gharbi</surname><given-names>K</given-names></string-name>, <string-name><surname>Blaxter</surname><given-names>ML</given-names></string-name></person-group>. <article-title>Special features of RAD sequencing data: implications for genotyping</article-title>. <source>Mol Ecol</source>. <year>2013</year>;<volume>22</volume>(<issue>11</issue>):<fpage>3151</fpage>–<lpage>3164</lpage>. doi:<pub-id pub-id-type="doi">10.1111/mec.12084</pub-id>.<pub-id pub-id-type="pmid">23110438</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B8">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elshire</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Glaubitz</surname><given-names>JC</given-names></string-name>, <string-name><surname>Sun</surname><given-names>Q</given-names></string-name>, <string-name><surname>Poland</surname><given-names>JA</given-names></string-name>, <string-name><surname>Kawamoto</surname><given-names>K</given-names></string-name>, <string-name><surname>Buckler</surname><given-names>ES</given-names></string-name>, <string-name><surname>Mitchell</surname><given-names>SE</given-names></string-name></person-group>. <article-title>A robust, simple genotyping-by-sequencing (GBS) approach for high diversity species</article-title>. <source>PLoS One</source><year>2011</year>;<volume>6</volume>(<issue>5</issue>):<comment>e19379</comment>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0019379</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B9">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fragoso</surname><given-names>CA</given-names></string-name>, <string-name><surname>Heffelfinger</surname><given-names>C</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>H</given-names></string-name>, <string-name><surname>Dellaporta</surname><given-names>SL</given-names></string-name></person-group>. <article-title>Imputing genotypes in biallelic populations from low-coverage sequence data</article-title>. <source>Genetics</source><year>2016</year>;<volume>202</volume>(<issue>2</issue>):<fpage>487</fpage>–<lpage>495</lpage>. doi:<pub-id pub-id-type="doi">10.1534/genetics.115.182071</pub-id>.<pub-id pub-id-type="pmid">26715670</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B10">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Furuta</surname><given-names>T</given-names></string-name>, <string-name><surname>Ashikari</surname><given-names>M</given-names></string-name>, <string-name><surname>Jena</surname><given-names>KK</given-names></string-name>, <string-name><surname>Doi</surname><given-names>K</given-names></string-name>, <string-name><surname>Reuscher</surname><given-names>S</given-names></string-name></person-group>. <article-title>Adapting genotyping-by-sequencing for rice F2 populations</article-title>. <source>G3 (Bethesda)</source><year>2017</year>;<volume>7</volume>(<issue>3</issue>):<fpage>881</fpage>–<lpage>893</lpage>. doi:<pub-id pub-id-type="doi">10.1534/g3.116.038190</pub-id>.<pub-id pub-id-type="pmid">28082325</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B11">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gardner</surname><given-names>KM</given-names></string-name>, <string-name><surname>Brown</surname><given-names>P</given-names></string-name>, <string-name><surname>Cooke</surname><given-names>TF</given-names></string-name>, <string-name><surname>Cann</surname><given-names>S</given-names></string-name>, <string-name><surname>Costa</surname><given-names>F</given-names></string-name>, <string-name><surname>Bustamante</surname><given-names>C</given-names></string-name>, <string-name><surname>Velasco</surname><given-names>R</given-names></string-name>, <string-name><surname>Troggio</surname><given-names>M</given-names></string-name>, <string-name><surname>Myles</surname><given-names>S</given-names></string-name></person-group>. <article-title>Fast and cost-effective genetic mapping in apple using next-generation sequencing</article-title>. <source>G3 (Bethesda)</source><year>2014</year>;<volume>4</volume>(<issue>9</issue>):<fpage>1681</fpage>–<lpage>1687</lpage>. doi:<pub-id pub-id-type="doi">10.1534/g3.114.011023</pub-id>.<pub-id pub-id-type="pmid">25031181</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B12">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Glaubitz</surname><given-names>JC</given-names></string-name>, <string-name><surname>Casstevens</surname><given-names>TM</given-names></string-name>, <string-name><surname>Lu</surname><given-names>F</given-names></string-name>, <string-name><surname>Harriman</surname><given-names>J</given-names></string-name>, <string-name><surname>Elshire</surname><given-names>RJ</given-names></string-name>, <string-name><surname>Sun</surname><given-names>Q</given-names></string-name>, <string-name><surname>Buckler</surname><given-names>ES</given-names></string-name></person-group>. <article-title>TASSEL-GBS: a high capacity genotyping by sequencing analysis pipeline</article-title>. <source>PLoS One</source><year>2014</year>;<volume>9</volume>(<issue>2</issue>):<comment>e90346</comment>. doi:<pub-id pub-id-type="doi">10.1371/journal.pone.0090346</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B13">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gogarten</surname><given-names>SM</given-names></string-name>, <string-name><surname>Bhangale</surname><given-names>T</given-names></string-name>, <string-name><surname>Conomos</surname><given-names>MP</given-names></string-name>, <string-name><surname>Laurie</surname><given-names>CA</given-names></string-name>, <string-name><surname>McHugh</surname><given-names>CP</given-names></string-name>, <string-name><surname>Painter</surname><given-names>I</given-names></string-name>, <string-name><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name><surname>Crosslin</surname><given-names>DR</given-names></string-name>, <string-name><surname>Levine</surname><given-names>D</given-names></string-name>, <string-name><surname>Lumley</surname><given-names>T</given-names></string-name>, <etal>et al</etal></person-group><article-title>GWASTools: an R/Bioconductor package for quality control and analysis of genome-wide association studies</article-title>. <source>Bioinformatics</source><year>2012</year>;<volume>28</volume>(<issue>24</issue>):<fpage>3329</fpage>–<lpage>3331</lpage>. doi:<pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTS610</pub-id>.<pub-id pub-id-type="pmid">23052040</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B14">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gogarten</surname><given-names>SM</given-names></string-name>, <string-name><surname>Sofer</surname><given-names>T</given-names></string-name>, <string-name><surname>Chen</surname><given-names>H</given-names></string-name>, <string-name><surname>Yu</surname><given-names>C</given-names></string-name>, <string-name><surname>Brody</surname><given-names>JA</given-names></string-name>, <string-name><surname>Thornton</surname><given-names>TA</given-names></string-name>, <string-name><surname>Rice</surname><given-names>KM</given-names></string-name>, <string-name><surname>Conomos</surname><given-names>MP</given-names></string-name></person-group>. <article-title>Genetic association testing using the GENESIS R/Bioconductor package</article-title>. <source>Bioinformatics</source><year>2019</year>;<volume>35</volume>(<issue>24</issue>):<fpage>5346</fpage>–<lpage>5348</lpage>. <pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTZ567</pub-id><pub-id pub-id-type="pmid">31329242</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B15">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname><given-names>X</given-names></string-name>, <string-name><surname>Feng</surname><given-names>Q</given-names></string-name>, <string-name><surname>Qian</surname><given-names>Q</given-names></string-name>, <string-name><surname>Zhao</surname><given-names>Q</given-names></string-name>, <string-name><surname>Wang</surname><given-names>L</given-names></string-name>, <string-name><surname>Wang</surname><given-names>A</given-names></string-name>, <string-name><surname>Guan</surname><given-names>J</given-names></string-name>, <string-name><surname>Fan</surname><given-names>D</given-names></string-name>, <string-name><surname>Weng</surname><given-names>Q</given-names></string-name>, <string-name><surname>Huang</surname><given-names>T</given-names></string-name>, <etal>et al</etal></person-group><article-title>High-throughput genotyping by whole-genome resequencing</article-title>. <source>Genome Res</source>. <year>2009</year>;<volume>19</volume>(<issue>6</issue>):<fpage>1068</fpage>–<lpage>1076</lpage>. doi:<pub-id pub-id-type="doi">10.1101/gr.089516.108</pub-id>.<pub-id pub-id-type="pmid">19420380</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B16">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname><given-names>C</given-names></string-name>, <string-name><surname>Guo</surname><given-names>H</given-names></string-name>, <string-name><surname>Kong</surname><given-names>W</given-names></string-name>, <string-name><surname>Chandnani</surname><given-names>R</given-names></string-name>, <string-name><surname>Shuang</surname><given-names>L-S</given-names></string-name>, <string-name><surname>Paterson</surname><given-names>AH</given-names></string-name></person-group>. <article-title>Application of genotyping by sequencing technology to a variety of crop breeding programs</article-title>. <source>Plant Sci</source>. <year>2016</year>;<volume>242</volume>:<fpage>14</fpage>–<lpage>22</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.plantsci.2015.04.016</pub-id>.<pub-id pub-id-type="pmid">26566821</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B17">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kole</surname><given-names>C</given-names></string-name>, <string-name><surname>Muthamilarasan</surname><given-names>M</given-names></string-name>, <string-name><surname>Henry</surname><given-names>R</given-names></string-name>, <string-name><surname>Edwards</surname><given-names>D</given-names></string-name>, <string-name><surname>Sharma</surname><given-names>R</given-names></string-name>, <string-name><surname>Abberton</surname><given-names>M</given-names></string-name>, <string-name><surname>Batley</surname><given-names>J</given-names></string-name>, <string-name><surname>Bentley</surname><given-names>A</given-names></string-name>, <string-name><surname>Blakeney</surname><given-names>M</given-names></string-name>, <string-name><surname>Bryant</surname><given-names>J</given-names></string-name>, <etal>et al</etal></person-group><article-title>Application of genomics-assisted breeding for generation of climate resilient crops: progress and prospects</article-title>. <source>Front Plant Sci</source>. <year>2015</year>;<volume>6</volume>:<fpage>563</fpage>. doi:<pub-id pub-id-type="doi">10.3389/fpls.2015.00563</pub-id>.<pub-id pub-id-type="pmid">26322050</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B18">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lu</surname><given-names>H</given-names></string-name>, <string-name><surname>Giordano</surname><given-names>F</given-names></string-name>, <string-name><surname>Ning</surname><given-names>Z</given-names></string-name></person-group>. <article-title>Oxford nanopore MinION sequencing and genome assembly</article-title>. <source>Genomics Proteomics Bioinformatics</source><year>2016</year>;<volume>14</volume>(<issue>5</issue>):<fpage>265</fpage>–<lpage>279</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.gpb.2016.05.004</pub-id>.<pub-id pub-id-type="pmid">27646134</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B19">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McKenna</surname><given-names>A</given-names></string-name>, <string-name><surname>Hanna</surname><given-names>M</given-names></string-name>, <string-name><surname>Banks</surname><given-names>E</given-names></string-name>, <string-name><surname>Sivachenko</surname><given-names>A</given-names></string-name>, <string-name><surname>Cibulskis</surname><given-names>K</given-names></string-name>, <string-name><surname>Kernytsky</surname><given-names>A</given-names></string-name>, <string-name><surname>Garimella</surname><given-names>K</given-names></string-name>, <string-name><surname>Altshuler</surname><given-names>D</given-names></string-name>, <string-name><surname>Gabriel</surname><given-names>S</given-names></string-name>, <string-name><surname>Daly</surname><given-names>M</given-names></string-name>, <etal>et al</etal></person-group><article-title>The genome analysis toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data</article-title>. <source>Genome Res</source>. <year>2010</year>;<volume>20</volume>(<issue>9</issue>):<fpage>1297</fpage>–<lpage>1303</lpage>. doi:<pub-id pub-id-type="doi">10.1101/gr.107524.110</pub-id>.<pub-id pub-id-type="pmid">20644199</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B20">
      <mixed-citation publication-type="journal">Miao C, Fang J, Li D, Liang P, Zhang X, Yang J, Schnable JC, Tang H. Genotype-Corrector: improved genotype calls for genetic mapping in F2 and RIL populations. Sci Rep. 2018;8(1). doi:<pub-id pub-id-type="doi">10.1038/s41598-018-28294-0</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B21">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Poland</surname><given-names>JA</given-names></string-name>, <string-name><surname>Rife</surname><given-names>TW</given-names></string-name></person-group>. <article-title>Genotyping-by-sequencing for plant breeding and genetics</article-title>. <source>Plant Genome</source><year>2012</year>;<volume>5</volume>(<issue>3</issue>):<comment>plantgenome2012.05.0005</comment>. doi:<pub-id pub-id-type="doi">10.3835/plantgenome2012.05.0005</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B22">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pootakham</surname><given-names>W</given-names></string-name>, <string-name><surname>Jomchai</surname><given-names>N</given-names></string-name>, <string-name><surname>Ruang-areerate</surname><given-names>P</given-names></string-name>, <string-name><surname>Shearman</surname><given-names>JR</given-names></string-name>, <string-name><surname>Sonthirod</surname><given-names>C</given-names></string-name>, <string-name><surname>Sangsrakru</surname><given-names>D</given-names></string-name>, <string-name><surname>Tragoonrung</surname><given-names>S</given-names></string-name>, <string-name><surname>Tangphatsornruang</surname><given-names>S</given-names></string-name></person-group>. <article-title>Genome-wide SNP discovery and identification of QTL associated with agronomic traits in oil palm using genotyping-by-sequencing (GBS)</article-title>. <source>Genomics</source><year>2015</year>;<volume>105</volume>(<issue>5-6</issue>):<fpage>288</fpage>–<lpage>295</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.ygeno.2015.02.002</pub-id>.<pub-id pub-id-type="pmid">25702931</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B23">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rabiner</surname><given-names>LR</given-names></string-name></person-group>. <article-title>A tutorial on hidden Markov models and selected applications in speech recognition</article-title>. <source>Proc IEEE</source>. <year>1989</year>;<volume>77</volume>(<issue>2</issue>):<fpage>257</fpage>–<lpage>286</lpage>. doi:<pub-id pub-id-type="doi">10.1109/5.18626</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B24">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rhoads</surname><given-names>A</given-names></string-name>, <string-name><surname>Au</surname><given-names>KF</given-names></string-name></person-group>. <article-title>Pacbio sequencing and its applications</article-title>. <source>Genomics Proteomics Bioinformatics</source><year>2015</year>;<volume>13</volume>(<issue>5</issue>):<fpage>278</fpage>–<lpage>289</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.gpb.2015.08.002</pub-id>.<pub-id pub-id-type="pmid">26542840</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B25">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rowan</surname><given-names>BA</given-names></string-name>, <string-name><surname>Patel</surname><given-names>V</given-names></string-name>, <string-name><surname>Weigel</surname><given-names>D</given-names></string-name>, <string-name><surname>Schneeberger</surname><given-names>K</given-names></string-name></person-group>. <article-title>Rapid and inexpensive whole-genome genotyping-by-sequencing for crossover localization and fine-scale genetic mapping</article-title>. <source>G3 (Bethesda)</source><year>2015</year>;<volume>5</volume>(<issue>3</issue>):<fpage>385</fpage>–<lpage>398</lpage>. doi:<pub-id pub-id-type="doi">10.1534/g3.114.016501</pub-id>.<pub-id pub-id-type="pmid">25585881</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B26">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scheben</surname><given-names>A</given-names></string-name>, <string-name><surname>Batley</surname><given-names>J</given-names></string-name>, <string-name><surname>Edwards</surname><given-names>D</given-names></string-name></person-group>. <article-title>Genotyping-by-sequencing approaches to characterize crop genomes: choosing the right tool for the right application</article-title>. <source>Plant Biotechnol J</source>. <year>2017</year>;<volume>15</volume>(<issue>2</issue>):<fpage>149</fpage>–<lpage>161</lpage>. doi:<pub-id pub-id-type="doi">10.1111/PBI.12645</pub-id>.<pub-id pub-id-type="pmid">27696619</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B27">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Swarts</surname><given-names>K</given-names></string-name>, <string-name><surname>Li</surname><given-names>H</given-names></string-name>, <string-name><surname>Romero Navarro</surname><given-names>JA</given-names></string-name>, <string-name><surname>An</surname><given-names>D</given-names></string-name>, <string-name><surname>Romay</surname><given-names>MC</given-names></string-name>, <string-name><surname>Hearne</surname><given-names>S</given-names></string-name>, <string-name><surname>Acharya</surname><given-names>C</given-names></string-name>, <string-name><surname>Glaubitz</surname><given-names>JC</given-names></string-name>, <string-name><surname>Mitchell</surname><given-names>S</given-names></string-name>, <string-name><surname>Elshire</surname><given-names>RJ</given-names></string-name>, <etal>et al</etal></person-group><article-title>Novel methods to optimize genotypic imputation for low-coverage, next-generation sequence data in crop plants</article-title>. <source>Plant Genome</source><year>2014</year>;<volume>7</volume>(<issue>3</issue>):<comment>plantgenome2014.05.0023</comment>. doi:<pub-id pub-id-type="doi">10.3835/plantgenome2014.05.0023</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B28">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wijnker</surname><given-names>E</given-names></string-name>, <string-name><surname>James</surname><given-names>GV</given-names></string-name>, <string-name><surname>Ding</surname><given-names>J</given-names></string-name>, <string-name><surname>Becker</surname><given-names>F</given-names></string-name>, <string-name><surname>Klasen</surname><given-names>JR</given-names></string-name>, <string-name><surname>Rawat</surname><given-names>V</given-names></string-name>, <string-name><surname>Rowan</surname><given-names>BA</given-names></string-name>, <string-name><surname>de Jong</surname><given-names>DF</given-names></string-name>, <string-name><surname>de Snoo</surname><given-names>CB</given-names></string-name>, <string-name><surname>Zapata</surname><given-names>L</given-names></string-name>, <etal>et al</etal></person-group><article-title>The genomic landscape of meiotic crossovers and gene conversions in <italic toggle="yes">Arabidopsis thaliana</italic></article-title>. <source>Elife</source><year>2013</year>;<volume>2</volume>:<comment>e01426</comment>. doi:<pub-id pub-id-type="doi">10.7554/eLife.01426</pub-id>.</mixed-citation>
    </ref>
    <ref id="iyad055-B29">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>C</given-names></string-name>, <string-name><surname>Boer</surname><given-names>MP</given-names></string-name>, <string-name><surname>van Eeuwijk</surname><given-names>FA</given-names></string-name></person-group>. <article-title>A general modeling framework for genome ancestral origins in multiparental populations</article-title>. <source>Genetics</source><year>2014</year>;<volume>198</volume>(<issue>1</issue>):<fpage>87</fpage>–<lpage>101</lpage>. doi:<pub-id pub-id-type="doi">10.1534/genetics.114.163006</pub-id>.<pub-id pub-id-type="pmid">25236451</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B30">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>C</given-names></string-name>, <string-name><surname>Boer</surname><given-names>MP</given-names></string-name>, <string-name><surname>van Eeuwijk</surname><given-names>FA</given-names></string-name></person-group>. <article-title>Reconstruction of genome ancestry blocks in multiparental populations</article-title>. <source>Genetics</source><year>2015</year>;<volume>200</volume>(<issue>4</issue>):<fpage>1073</fpage>–<lpage>1087</lpage>. doi:<pub-id pub-id-type="doi">10.1534/genetics.115.177873</pub-id>.<pub-id pub-id-type="pmid">26048018</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B31">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>C</given-names></string-name>, <string-name><surname>Boer</surname><given-names>MP</given-names></string-name>, <string-name><surname>van Eeuwijk</surname><given-names>FA</given-names></string-name></person-group>. <article-title>Accurate genotype imputation in multiparental populations from low-coverage sequence</article-title>. <source>Genetics</source><year>2018</year>;<volume>210</volume>(<issue>1</issue>):<fpage>71</fpage>–<lpage>82</lpage>. doi:<pub-id pub-id-type="doi">10.1534/genetics.118.300885</pub-id>.<pub-id pub-id-type="pmid">30045858</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B32">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name><surname>Gogarten</surname><given-names>SM</given-names></string-name>, <string-name><surname>Lawrence</surname><given-names>M</given-names></string-name>, <string-name><surname>Stilp</surname><given-names>A</given-names></string-name>, <string-name><surname>Conomos</surname><given-names>MP</given-names></string-name>, <string-name><surname>Weir</surname><given-names>BS</given-names></string-name>, <string-name><surname>Laurie</surname><given-names>C</given-names></string-name>, <string-name><surname>Levine</surname><given-names>D</given-names></string-name></person-group>. <article-title>Seqarray—a storage-efficient high-performance data format for WGS variant calls</article-title>. <source>Bioinformatics</source><year>2017</year>;<volume>33</volume>(<issue>15</issue>):<fpage>2251</fpage>–<lpage>2257</lpage>. doi:<pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTX145</pub-id>.<pub-id pub-id-type="pmid">28334390</pub-id></mixed-citation>
    </ref>
    <ref id="iyad055-B33">
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname><given-names>X</given-names></string-name>, <string-name><surname>Levine</surname><given-names>D</given-names></string-name>, <string-name><surname>Shen</surname><given-names>J</given-names></string-name>, <string-name><surname>Gogarten</surname><given-names>SM</given-names></string-name>, <string-name><surname>Laurie</surname><given-names>C</given-names></string-name>, <string-name><surname>Weir</surname><given-names>BS</given-names></string-name></person-group>. <article-title>A high-performance computing toolset for relatedness and principal component analysis of SNP data</article-title>. <source>Bioinformatics</source><year>2012</year>;<volume>28</volume>(<issue>24</issue>):<fpage>3326</fpage>–<lpage>3328</lpage>. doi:<pub-id pub-id-type="doi">10.1093/BIOINFORMATICS/BTS606</pub-id>.<pub-id pub-id-type="pmid">23060615</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
