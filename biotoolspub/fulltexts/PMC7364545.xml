<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">BMC Bioinformatics</journal-id>
    <journal-id journal-id-type="iso-abbrev">BMC Bioinformatics</journal-id>
    <journal-title-group>
      <journal-title>BMC Bioinformatics</journal-title>
    </journal-title-group>
    <issn pub-type="epub">1471-2105</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">7364545</article-id>
    <article-id pub-id-type="publisher-id">3649</article-id>
    <article-id pub-id-type="doi">10.1186/s12859-020-03649-5</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Software</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>PyIR: a scalable wrapper for processing billions of immunoglobulin and T cell receptor sequences using IgBLAST</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Soto</surname>
          <given-names>Cinque</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Finn</surname>
          <given-names>Jessica A.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Willis</surname>
          <given-names>Jordan R.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Day</surname>
          <given-names>Samuel B.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Sinkovits</surname>
          <given-names>Robert S.</given-names>
        </name>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Jones</surname>
          <given-names>Taylor</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Schmitz</surname>
          <given-names>Samuel</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Meiler</surname>
          <given-names>Jens</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Branchizio</surname>
          <given-names>Andre</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0049-1079</contrib-id>
        <name>
          <surname>Crowe</surname>
          <given-names>James E.</given-names>
          <suffix>Jr</suffix>
        </name>
        <address>
          <email>james.crowe@vumc.org</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.412807.8</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 9916</institution-id><institution>Vanderbilt Vaccine Center, </institution><institution>Vanderbilt University Medical Center, </institution></institution-wrap>Nashville, TN 37232 USA </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.412807.8</institution-id><institution-id institution-id-type="ISNI">0000 0004 1936 9916</institution-id><institution>Department of Pediatrics, </institution><institution>Vanderbilt University Medical Center, </institution></institution-wrap>Nashville, TN 37232 USA </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.152326.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2264 7217</institution-id><institution>Department of Pathology, Microbiology, and Immunology, </institution><institution>Vanderbilt University, </institution></institution-wrap>Nashville, TN 37232 USA </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.266100.3</institution-id><institution-id institution-id-type="ISNI">0000 0001 2107 4242</institution-id><institution>San Diego Supercomputer Center, </institution><institution>University of California, San Diego, </institution></institution-wrap>La Jolla, CA 92093 USA </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.152326.1</institution-id><institution-id institution-id-type="ISNI">0000 0001 2264 7217</institution-id><institution>Department of Chemistry, </institution><institution>Vanderbilt University, </institution></institution-wrap>Nashville, TN 37212 USA </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>16</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>16</day>
      <month>7</month>
      <year>2020</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2020</year>
    </pub-date>
    <volume>21</volume>
    <elocation-id>314</elocation-id>
    <history>
      <date date-type="received">
        <day>23</day>
        <month>2</month>
        <year>2020</year>
      </date>
      <date date-type="accepted">
        <day>9</day>
        <month>7</month>
        <year>2020</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2020</copyright-statement>
      <license license-type="OpenAccess">
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <sec>
        <title>Background</title>
        <p id="Par1">Recent advances in DNA sequencing technologies have enabled significant leaps in capacity to generate large volumes of DNA sequence data, which has spurred a rapid growth in the use of bioinformatics as a means of interrogating antibody variable gene repertoires. Common tools used for annotation of antibody sequences are often limited in functionality, modularity and usability.</p>
      </sec>
      <sec>
        <title>Results</title>
        <p id="Par2">We have developed PyIR, a Python wrapper and library for IgBLAST, which offers a minimal setup CLI and API, FASTQ support, file chunking for large sequence files, JSON and Python dictionary output, and built-in sequence filtering.</p>
      </sec>
      <sec>
        <title>Conclusions</title>
        <p id="Par3">PyIR offers improved processing speed over multithreaded IgBLAST (version 1.14) when spawning more than 16 processes on a single computer system. Its customizable filtering and data encapsulation allow it to be adapted to a wide range of computing environments. The API allows for IgBLAST to be used in customized bioinformatics workflows.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Immune repertoires</kwd>
      <kwd>Antibody</kwd>
      <kwd>Illumina</kwd>
      <kwd>CDR3</kwd>
      <kwd>IgBLAST</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000060</institution-id>
            <institution>National Institute of Allergy and Infectious Diseases</institution>
          </institution-wrap>
        </funding-source>
        <award-id>U19 AI117905</award-id>
        <award-id>HHSN272201400024C</award-id>
      </award-group>
    </funding-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution>Human Vaccines Project</institution>
        </funding-source>
        <award-id>NA</award-id>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2020</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background</title>
    <p id="Par11">The diverse population of rearranged immunoglobulin and T cell receptor (TCR) variable gene sequences within an individual is referred to as their adaptive immune repertoire and is responsible for recognition and neutralization of a potentially unlimited number of pathogenic targets. Next-generation sequencing (NGS) technology has become the ideal method for probing diversity in adaptive immune repertoires [<xref ref-type="bibr" rid="CR1">1</xref>–<xref ref-type="bibr" rid="CR5">5</xref>]. With continued advances in NGS technology yielding more sequence reads in less time and at lower cost, the number of researchers interested in analyzing adaptive immune repertoires using different bioinformatics processing pipelines continues to grow [<xref ref-type="bibr" rid="CR6">6</xref>]. Thus, the demand for efficient and easy-to-use bioinformatics tools for processing and analyzing NGS data from immune repertoire sequencing has never been higher.</p>
    <p id="Par12">Two popular programs for processing immune repertoire sequencing data are IgBLAST [<xref ref-type="bibr" rid="CR7">7</xref>] and IMGT/HighV-QUEST [<xref ref-type="bibr" rid="CR8">8</xref>]. IgBLAST is used by several bioinformatic pipelines [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR12">12</xref>]. IMGT/HighV-QUEST is a web utility and is part of the international ImMunoGeneTics (IMGT) information system [<xref ref-type="bibr" rid="CR13">13</xref>], which provides several web-based tools for immunogenetic analysis. Both tools use template-based nucleotide alignments between curated sets of germline genes and sequencing reads to infer the most plausible recombined germline gene sequences encoding the antibody and to delineate the complementarity-determining regions (CDRs) of the immunoglobulin or T cell receptor (TCR) sequence.</p>
    <p id="Par13">IgBLAST is derived from the well-known BLAST [<xref ref-type="bibr" rid="CR14">14</xref>] family of sequence alignment and search tools and is available as both a web-based service and a downloadable executable. While the web-based service for IgBLAST is limited by the number of sequences that can be processed at one time, the executable could in principle be used to process millions of sequences. However, the exact number of sequences that can processed is limited by the capacity of the computer hardware used for the task. This limitation is usually not an issue for high-performance computing clusters, but for more conventional workstations, this factor can introduce a barrier to processing data sets with millions of sequences efficiently.</p>
    <p id="Par14">IMGT/HighV-QUEST provides a web-based interface only and accepts a maximum of up to 500,000 sequences per submission. The submission size, although large, can limit the study of very large adaptive immune repertoire sequencing datasets, which are increasingly common. For those cases in which immune repertoire sequences are processed using this tool, results are made available for download in a tab-separated value (TSV) format. IMGT/HighV-QUEST distinguishes itself from all the other adaptive immune repertoire sequencing tools by providing a wealth of information about each processed sequence. However, when processing very large datasets such as sequence sets produced in a single run on current generation NovaSEQ instruments (Illumina), analysis using the IMGT/HighV-QUEST web-portal becomes impractical.</p>
    <p id="Par15">To address the need for processing very large data sets containing immunoglobulin or TCR sequences, we developed a software tool that we call PyIR. The software is a minimally dependent Python3 wrapper and library for IgBLAST [<xref ref-type="bibr" rid="CR7">7</xref>] and can scale to process up to 1 billion sequences. Its basic functionality splits the input FASTX (FASTQ or FASTA file) file and performs batch execution on chunks of sequences. This approach avoids having to read all data in memory at once, allowing efficient processing of very large data sets on modest size workstations with multiple CPUs. PyIR parses all of the IgBLAST-generated fields from the web-based file format into fields that comply with Adaptive Immune Receptor Repertoire (AIRR) recommendations [<xref ref-type="bibr" rid="CR15">15</xref>] and then outputs the results into a JSON file format. PyIR also provides options for sequence quality filtering that can be invoked from the command line. These sequence filters allow the user to remove poor quality data after IgBLAST processing. We also have included an application programming interface (API) with PyIR that allows users to incorporate this tool directly into their own Python scripts. PyIR will be a useful computational tool for the AIRR community [<xref ref-type="bibr" rid="CR15">15</xref>] by allowing those researchers with minimal Python programming experience to easily interface with IgBLAST.</p>
  </sec>
  <sec id="Sec2">
    <title>Implementation</title>
    <p id="Par16">PyIR is available for Linux or OSX (Darwin) environments running Python 3.6 or higher. Installation is managed by the Python pip3 module, which also installs PyIR dependencies as needed. PyIR ships with IgBLAST (version 1.14) and users implement the software with their own executable and germline gene databases. We provide current germline genes from IMGT in this distribution, but we recommend that users download the most up-to-date version of the germline genes from IMGT at: <ext-link ext-link-type="uri" xlink:href="http://www.imgt.org">http://www.imgt.org</ext-link>.</p>
    <p id="Par17">PyIR will run on machines with modest processing power and memory. For example, we have used a MacBook Pro with a 2.7GHz 2 core/4 thread i5 CPU and 8GB RAM (Apple) for this type of analysis. However, some consideration must be made for disk space, since PyIR stores runtime data as temporary files. Output files generated when running PyIR using standard options are expected to be 4 to 5 times larger than the input FASTX files.</p>
  </sec>
  <sec id="Sec3">
    <title>Results and discussion</title>
    <sec id="Sec4">
      <title>PyIR processing time</title>
      <p id="Par18">The critical enhancement in PyIR versus multithreaded IgBLAST (version 1.14) is the addition of file chunking. At the beginning of execution, PyIR estimates the number of input sequences based on the FASTX file size and then splits the file into ‘chunks’ that are stored as temporary files on disk. The default PyIR behavior is to balance the number of sequences per chunk with the number of CPU threads available and the size of the input file, but the user also can manually override this option to set a specified chunk size. PyIR then distributes chunks continuously to available processors for IgBLAST to process.</p>
      <p id="Par19">To test the processing efficiency of PyIR, we processed 1 million synthetic immunoglobulin sequences [<xref ref-type="bibr" rid="CR1">1</xref>] using PyIR and multithreaded IgBLAST (version 1.14) on a workstation with 4 hyperthreaded 8-core Opteron 6278 processors. Both PyIR and multithreaded IgBLAST (version 1.14) showed linear scaling out to 16 processes (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). However, when more than 16 processes are spawned only PyIR maintains this linear scaling out to 64 processes (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). We also looked at speedup, defined here as the performance gained by spawning additional processes. We computed speedup by normalizing the time in hours to process 1 million (or 1 billion) sequences by the time it takes to process 1 million (or 1 billion) sequences using two processes. Both PyIR and multithreaded IgBLAST (version 1.14) show linear speedups out to 16 processes, but when more than 16 processes were spawned, IgBLAST did not show speedup (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). Thus, PyIR maintains linear scaling beyond 16 processes using all of the threads available from the hardware.
<fig id="Fig1"><label>Fig. 1</label><caption><p>Multiprocessing performance for PyIR and multithreaded IgBLAST (version 1.14). <bold>a</bold> One million synthetic immunoglobulin sequences were used to time PyIR (dark grey, ♦) against multithreaded IgBLAST (version 1.14) (grey, ■) as a function of the number of processes. Idealized timings are shown as a black dashed line. Average timings were measured over the three trial runs for 1 million sequences and computed separately for both IgBLAST and PyIR. Standard deviations appear as error bars for both methods. X and Y axes are in log<sub>2</sub> space. <bold>b</bold> The speedup of PyIR relative to multithreaded IgBLAST (version 1.14) as a function of the number of simultaneous processes. Timings were done on a workstation equipped with 4 Opteron 6278 hyper-threaded 8-core processors for a total of 64 CPU threads using the average timings from (<bold>a</bold>). The X and Y axes are in log<sub>2</sub> space. <bold>c</bold> One billion synthetic immunoglobulin sequences were used to determine the speedup PyIR achieved over multithreaded IgBLAST (version 1.14) as a function of the number of sequences. Idealized speedups are shown as a black dashed line. Timings were done on a workstation equipped 4 Xeon Platinum 8280 hyperthreaded 28-core processors for a total of 224 CPU threads. X and Y axes are in log<sub>10</sub> space</p></caption><graphic xlink:href="12859_2020_3649_Fig1_HTML" id="MO1"/></fig></p>
      <p id="Par20">We also tested the ability of PyIR to process very large data sets (i.e., cDNA sequence data sets from analysis on a NovaSEQ instrument) using file chunking. We ran a separate set of trials on a workstation with 4 hyperthreaded 28-core Xeon Platinum 8280 processors, clocking the total time required to analyze a series of FASTA files containing from 1 thousand to 1 billion synthetic immunoglobulin sequences. Multithreaded IgBLAST (version 1.14) failed at around 70 million sequences, while PyIR ran to completion (Fig. <xref rid="Fig1" ref-type="fig">1</xref>c). These results demonstrate the efficiency of PyIR and the underlying file chunking method to process very large data sets.</p>
      <p id="Par21">PyIR also contains options for sequence filtering, allowing users to remove sequences with stop codons or those that are out-of-frame according to IgBLAST. For example, we typically filter out sequences that: 1) fail to meet our minimum V and J gene assignment expectation value (E-value) threshold of 1.0E-6, 2) contain a stop codon in the translated nucleotide sequence, 3) are out-of-frame, or 4) lack a complementarity-determining region 3 (CDR3) region. These sequence filters can be enabled or disabled individually and any non-boolean filters (i.e., E-value filter) can be set directly by the user. We also have included a Phred score filter that can be applied to the CDR3 region of a sequence. This filter removes any sequence with a nucleotide in the CDR3 region with a Phred score below some user-defined threshold. The filtering options can be extended by users directly within PyIR or through the application programming interface (API).</p>
    </sec>
    <sec id="Sec5">
      <title>PyIR application programming interface (API)</title>
      <p id="Par22">The API interface of PyIR can be used to call PyIR functions from within a Python script. This feature allows users to extend the functionality of PyIR or to use PyIR within a user’s own adaptive immune repertoire processing pipeline. Several published methods for processing immune repertoire data lack an accessible API, which is limiting for some experimental immunologists who may be new to scripting in Python. An example of how one would incorporate PyIR within a Python script is given directly below:</p>
      <p id="Par23">
        <bold>from pyir import PyIR</bold>
      </p>
      <p id="Par24">
        <bold>FILE = 'test.fasta'</bold>
      </p>
      <p id="Par25">
        <bold>pyir = PyIR (query=FILE)</bold>
      </p>
      <p id="Par26">
        <bold>result = pyir.run()</bold>
      </p>
      <p id="Par27">
        <bold>print (result)</bold>
      </p>
      <p id="Par28">In this example, PyIR is imported directly into Python and used to process a FASTA formatted file called <italic>test.fasta</italic>. The Python object in the variable <italic>result</italic> is a Python dictionary containing all the parsed fields from the web-based output of IgBLAST. We provide five examples showing how one could make use of PyIR directly within a Python script (see <ext-link ext-link-type="uri" xlink:href="http://github.com/crowelab/PyIR">http://github.com/crowelab/PyIR</ext-link>). The fifth example shows how one could use the PyIR API to generate a histogram of CDR3 lengths (see Additional file <xref rid="MOESM1" ref-type="media">1</xref>).</p>
    </sec>
    <sec id="Sec6">
      <title>PyIR output</title>
      <p id="Par29">After processing and sequence filtering, PyIR can return a zipped JSON file, a tab separated value file (TSV) or a Python dictionary (if PyIR is used as an API). We do note that the JSON output file can be large since PyIR stores the parsed results from the three best alignments. The user has the option of storing only the single best alignment, which reduces the size of the JSON file. Our primary focus for using JSON as the preferred output format was to allow for easy insertion into a MongoDB database. Several recent studies have been published that contain large adaptive immune repertoire sequencing datasets [<xref ref-type="bibr" rid="CR1">1</xref>, <xref ref-type="bibr" rid="CR2">2</xref>, <xref ref-type="bibr" rid="CR16">16</xref>]. Facilitating the ability to process and store these data sets locally into an industry standard database such as MongoDB or MariaDB motivated use of the JSON format.</p>
    </sec>
  </sec>
  <sec id="Sec7">
    <title>Conclusion</title>
    <p id="Par30">PyIR was designed to extend the functionality of IgBLAST to allow for processing of very large datasets (&gt; 100 million antibody or TCR recombined variable gene sequences). In terms of processing efficiency, we found that PyIR scaled linearly with the number of processes out to 1 billion sequences. Multithreaded IgBLAST (version 1.14) also scaled linearly but failed at around 70 million sequences. Our benchmarks suggest that PyIR can process about 2 million sequences per hour on a modest 64-core server and can process roughly 10 million sequences per hour on a 112-core machine that sits on the premium end of enterprise hardware. The API provides novice Python programmers with the ability to interface directly with IgBLAST and to explore using this tool in their own bioinformatics workflows. We do note that PyIR is not the only method for processing immune repertoire sequencing [<xref ref-type="bibr" rid="CR17">17</xref>]. However, PyIR is easily adaptable and uses IgBLAST which has been extensively benchmarked against other methods [<xref ref-type="bibr" rid="CR18">18</xref>]. We expect that PyIR will find use among the Adaptive Immune Receptor Repertoire (AIRR) Community.</p>
    <sec id="Sec8">
      <title>Availability and requirements</title>
      <p id="Par31">Project name: PyIR</p>
      <p id="Par32">
        <bold>Project homepage:</bold>
        <ext-link ext-link-type="uri" xlink:href="http://github.com/crowelab/PyIR">http://github.com/crowelab/PyIR</ext-link>
      </p>
      <p id="Par33"><bold>Archived version:</bold>10.5281/zenodo.3862746</p>
      <p id="Par34"><bold>Operating systems:</bold> Linux, UNIX, OSX (Darwin)</p>
      <p id="Par35"><bold>Programming languages</bold>: Python</p>
      <p id="Par36"><bold>Other requirements</bold>: None</p>
      <p id="Par37"><bold>License:</bold> Free to academics</p>
      <p id="Par38"><bold>Any restrictions to use by non-academics:</bold> Yes; non academics should contact the author for permission to use the software or license options for incorporation into software that is being sold for profit.</p>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary information</title>
    <sec id="Sec9">
      <supplementary-material content-type="local-data" id="MOESM1">
        <media xlink:href="12859_2020_3649_MOESM1_ESM.pdf">
          <caption>
            <p><bold>Additional file 1.</bold> Generating CDR3 length distributions with the PyIR API. Synthetic sequence data from Briney et al., was used to demonstrate the use of PyIRs API in generating a CDR3 length distribution.</p>
          </caption>
        </media>
      </supplementary-material>
    </sec>
  </sec>
</body>
<back>
  <glossary>
    <title>Abbreviations</title>
    <def-list>
      <def-item>
        <term>NGS</term>
        <def>
          <p id="Par4">Next-generation sequencing</p>
        </def>
      </def-item>
      <def-item>
        <term>CDR3</term>
        <def>
          <p id="Par5">Complementarity-determining region 3</p>
        </def>
      </def-item>
      <def-item>
        <term>JSON</term>
        <def>
          <p id="Par6">JavaScript Object Notation</p>
        </def>
      </def-item>
      <def-item>
        <term>API</term>
        <def>
          <p id="Par7">Application Programming Interface</p>
        </def>
      </def-item>
      <def-item>
        <term>CLI</term>
        <def>
          <p id="Par8">Command-line interface</p>
        </def>
      </def-item>
      <def-item>
        <term>FASTA</term>
        <def>
          <p id="Par9">File format for representing nucleotide sequence</p>
        </def>
      </def-item>
      <def-item>
        <term>FASTQ</term>
        <def>
          <p id="Par10">File format for storing nucleotide sequence and quality scores</p>
        </def>
      </def-item>
    </def-list>
  </glossary>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher’s Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <sec>
    <title>Supplementary information</title>
    <p><bold>Supplementary information</bold> accompanies this paper at 10.1186/s12859-020-03649-5.</p>
  </sec>
  <ack>
    <title>Acknowledgements</title>
    <p>The authors thank Robin G. Bombardi, M. Luke Myers, Gopal Sapparapu and Andrew I. Flyak for helpful discussions and input on design.</p>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>JAF, JRW, AB and JEC conceived of the idea, AB, SBD, TJ, SS and JAF developed the package, and SBD and RSS tested and benchmarked the package and CS, SBD, JM and JEC wrote the paper. All authors edited the paper and approved the final version.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was supported by grants and contracts from the National Institutes of Health [the grant U19 AI117905 and the contract HHSN272201400024C] and a grant from the Human Vaccines Project. The NIH and HVP funding bodies had no role in the design of the study; collection, analysis, and interpretation of data; or in writing the manuscript.</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>The datasets and source code supporting the conclusions of this article are available in the GitHub repository, <ext-link ext-link-type="uri" xlink:href="http://github.com/crowelab/PyIR">http://github.com/crowelab/PyIR</ext-link>.</p>
  </notes>
  <notes id="FPar1">
    <title>Ethics approval and consent to participate</title>
    <p id="Par39">Not applicable.</p>
  </notes>
  <notes id="FPar2">
    <title>Consent for publication</title>
    <p id="Par40">Not applicable.</p>
  </notes>
  <notes id="FPar3" notes-type="COI-statement">
    <title>Competing interests</title>
    <p id="Par41">The authors declare they have no competing interests.</p>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Soto</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Bombardi</surname>
            <given-names>RG</given-names>
          </name>
          <name>
            <surname>Branchizio</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Kose</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Matta</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Sevy</surname>
            <given-names>AM</given-names>
          </name>
          <name>
            <surname>Sinkovits</surname>
            <given-names>RS</given-names>
          </name>
          <name>
            <surname>Gilchuk</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Finn</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Crowe</surname>
            <given-names>JE</given-names>
            <suffix>Jr</suffix>
          </name>
        </person-group>
        <article-title>High frequency of shared clonotypes in human B cell receptor repertoires</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>566</volume>
        <issue>7744</issue>
        <fpage>398</fpage>
        <lpage>402</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-0934-8</pub-id>
        <pub-id pub-id-type="pmid">30760926</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Briney</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Inderbitzin</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Joyce</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Burton</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Commonality despite exceptional diversity in the baseline human antibody repertoire</article-title>
        <source>Nature</source>
        <year>2019</year>
        <volume>566</volume>
        <issue>7744</issue>
        <fpage>393</fpage>
        <lpage>397</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-019-0879-y</pub-id>
        <pub-id pub-id-type="pmid">30664748</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Weinstein</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Jiang</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>White</surname>
            <given-names>RA</given-names>
            <suffix>3rd</suffix>
          </name>
          <name>
            <surname>Fisher</surname>
            <given-names>DS</given-names>
          </name>
          <name>
            <surname>Quake</surname>
            <given-names>SR</given-names>
          </name>
        </person-group>
        <article-title>High-throughput sequencing of the zebrafish antibody repertoire</article-title>
        <source>Science</source>
        <year>2009</year>
        <volume>324</volume>
        <issue>5928</issue>
        <fpage>807</fpage>
        <lpage>810</lpage>
        <pub-id pub-id-type="doi">10.1126/science.1170020</pub-id>
        <pub-id pub-id-type="pmid">19423829</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Briney</surname>
            <given-names>BS</given-names>
          </name>
          <name>
            <surname>Willis</surname>
            <given-names>JR</given-names>
          </name>
          <name>
            <surname>Crowe</surname>
            <given-names>JE</given-names>
            <suffix>Jr</suffix>
          </name>
        </person-group>
        <article-title>Location and length distribution of somatic hypermutation-associated DNA insertions and deletions reveals regions of antibody structural plasticity</article-title>
        <source>Genes Immun</source>
        <year>2012</year>
        <volume>13</volume>
        <issue>7</issue>
        <fpage>523</fpage>
        <lpage>529</lpage>
        <pub-id pub-id-type="doi">10.1038/gene.2012.28</pub-id>
        <pub-id pub-id-type="pmid">22717702</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ofek</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Louder</surname>
            <given-names>MK</given-names>
          </name>
          <name>
            <surname>Lu</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>McKee</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Pancera</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Skinner</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Zhang</surname>
            <given-names>Z</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Mining the antibodyome for HIV-1-neutralizing antibodies with next-generation sequencing and phylogenetic pairing of heavy/light chains</article-title>
        <source>Proc Natl Acad Sci U S A</source>
        <year>2013</year>
        <volume>110</volume>
        <issue>16</issue>
        <fpage>6470</fpage>
        <lpage>6475</lpage>
        <pub-id pub-id-type="doi">10.1073/pnas.1219320110</pub-id>
        <pub-id pub-id-type="pmid">23536288</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <mixed-citation publication-type="other">Smakaj E, Babrak L, Ohlin M, Shugay M, Briney B, Tosoni D, Galli C, Grobelsek V, D'Angelo I, Olson B, et al. Benchmarking immunoinformatic tools for the analysis of antibody repertoire sequences. Bioinformatics. 2020;36(6):1731-39.</mixed-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Ye</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Ma</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Madden</surname>
            <given-names>TL</given-names>
          </name>
          <name>
            <surname>Ostell</surname>
            <given-names>JM</given-names>
          </name>
        </person-group>
        <article-title>IgBLAST: an immunoglobulin variable domain sequence analysis tool</article-title>
        <source>Nucleic Acids Res</source>
        <year>2013</year>
        <volume>41</volume>
        <issue>Web Server issue</issue>
        <fpage>W34</fpage>
        <lpage>W40</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gkt382</pub-id>
        <pub-id pub-id-type="pmid">23671333</pub-id>
      </element-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Alamyar</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Duroux</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Lefranc</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Giudicelli</surname>
            <given-names>V</given-names>
          </name>
        </person-group>
        <article-title>IMGT((R)) tools for the nucleotide analysis of immunoglobulin (IG) and T cell receptor (TR) V-(D)-J repertoires, polymorphisms, and IG mutations: IMGT/V-QUEST and IMGT/HighV-QUEST for NGS</article-title>
        <source>Methods Mol Biol</source>
        <year>2012</year>
        <volume>882</volume>
        <fpage>569</fpage>
        <lpage>604</lpage>
        <pub-id pub-id-type="doi">10.1007/978-1-61779-842-9_32</pub-id>
        <pub-id pub-id-type="pmid">22665256</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Briney</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Le</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Zhu</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Burton</surname>
            <given-names>DR</given-names>
          </name>
        </person-group>
        <article-title>Clonify: unseeded antibody lineage assignment from next-generation sequencing data</article-title>
        <source>Sci Rep</source>
        <year>2016</year>
        <volume>6</volume>
        <fpage>23901</fpage>
        <pub-id pub-id-type="doi">10.1038/srep23901</pub-id>
        <pub-id pub-id-type="pmid">27102563</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Vander Heiden</surname>
            <given-names>JA</given-names>
          </name>
          <name>
            <surname>Yaari</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Uduman</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Stern</surname>
            <given-names>JN</given-names>
          </name>
          <name>
            <surname>O'Connor</surname>
            <given-names>KC</given-names>
          </name>
          <name>
            <surname>Hafler</surname>
            <given-names>DA</given-names>
          </name>
          <name>
            <surname>Vigneault</surname>
            <given-names>F</given-names>
          </name>
          <name>
            <surname>Kleinstein</surname>
            <given-names>SH</given-names>
          </name>
        </person-group>
        <article-title>pRESTO: a toolkit for processing high-throughput sequencing raw reads of lymphocyte receptor repertoires</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>13</issue>
        <fpage>1930</fpage>
        <lpage>1932</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu138</pub-id>
        <pub-id pub-id-type="pmid">24618469</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Kwong</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Chuang</surname>
            <given-names>GY</given-names>
          </name>
          <name>
            <surname>DeKosky</surname>
            <given-names>BJ</given-names>
          </name>
          <name>
            <surname>Gindin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Georgiev</surname>
            <given-names>IS</given-names>
          </name>
          <name>
            <surname>Lemmin</surname>
            <given-names>T</given-names>
          </name>
          <name>
            <surname>Schramm</surname>
            <given-names>CA</given-names>
          </name>
          <name>
            <surname>Sheng</surname>
            <given-names>Z</given-names>
          </name>
          <name>
            <surname>Soto</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Yang</surname>
            <given-names>AS</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Antibodyomics: bioinformatics technologies for understanding B-cell immunity to HIV-1</article-title>
        <source>Immunol Rev</source>
        <year>2017</year>
        <volume>275</volume>
        <issue>1</issue>
        <fpage>108</fpage>
        <lpage>128</lpage>
        <pub-id pub-id-type="doi">10.1111/imr.12480</pub-id>
        <pub-id pub-id-type="pmid">28133812</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Corcoran</surname>
            <given-names>MM</given-names>
          </name>
          <name>
            <surname>Phad</surname>
            <given-names>GE</given-names>
          </name>
          <name>
            <surname>Vazquez Bernat</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Stahl-Hennig</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Sumida</surname>
            <given-names>N</given-names>
          </name>
          <name>
            <surname>Persson</surname>
            <given-names>MA</given-names>
          </name>
          <name>
            <surname>Martin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Karlsson Hedestam</surname>
            <given-names>GB</given-names>
          </name>
        </person-group>
        <article-title>Production of individualized V gene databases reveals high levels of immunoglobulin genetic diversity</article-title>
        <source>Nat Commun</source>
        <year>2016</year>
        <volume>7</volume>
        <fpage>13642</fpage>
        <pub-id pub-id-type="doi">10.1038/ncomms13642</pub-id>
        <pub-id pub-id-type="pmid">27995928</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lefranc</surname>
            <given-names>MP</given-names>
          </name>
          <name>
            <surname>Giudicelli</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>Duroux</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Jabado-Michaloud</surname>
            <given-names>J</given-names>
          </name>
          <name>
            <surname>Folch</surname>
            <given-names>G</given-names>
          </name>
          <name>
            <surname>Aouinti</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Carillon</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Duvergey</surname>
            <given-names>H</given-names>
          </name>
          <name>
            <surname>Houles</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Paysan-Lafosse</surname>
            <given-names>T</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>IMGT(R), the international ImMunoGeneTics information system(R) 25 years on</article-title>
        <source>Nucleic Acids Res</source>
        <year>2015</year>
        <volume>43</volume>
        <issue>Database issue</issue>
        <fpage>D413</fpage>
        <lpage>D422</lpage>
        <pub-id pub-id-type="doi">10.1093/nar/gku1056</pub-id>
        <pub-id pub-id-type="pmid">25378316</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Altschul</surname>
            <given-names>SF</given-names>
          </name>
          <name>
            <surname>Gish</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Miller</surname>
            <given-names>W</given-names>
          </name>
          <name>
            <surname>Myers</surname>
            <given-names>EW</given-names>
          </name>
          <name>
            <surname>Lipman</surname>
            <given-names>DJ</given-names>
          </name>
        </person-group>
        <article-title>Basic local alignment search tool</article-title>
        <source>J Mol Biol</source>
        <year>1990</year>
        <volume>215</volume>
        <issue>3</issue>
        <fpage>403</fpage>
        <lpage>410</lpage>
        <pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id>
        <pub-id pub-id-type="pmid">2231712</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <mixed-citation publication-type="other">Adaptive Immune Receptor Repertoire (AIRR) Community of the Antibody Society. <ext-link ext-link-type="uri" xlink:href="http://docs.airr-community.org/en/latest/">http://docs.airr-community.org/en/latest/</ext-link>. Accessed 27 Jan 2020.</mixed-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Guo</surname>
            <given-names>Y</given-names>
          </name>
          <name>
            <surname>Chen</surname>
            <given-names>K</given-names>
          </name>
          <name>
            <surname>Kwong</surname>
            <given-names>PD</given-names>
          </name>
          <name>
            <surname>Shapiro</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Sheng</surname>
            <given-names>Z</given-names>
          </name>
        </person-group>
        <article-title>cAb-rep: a database of curated antibody repertoires for exploring antibody diversity and predicting antibody prevalence</article-title>
        <source>Front Immunol</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>2365</fpage>
        <pub-id pub-id-type="doi">10.3389/fimmu.2019.02365</pub-id>
        <pub-id pub-id-type="pmid">31649674</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>López-Santibáñez-Jácome</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Eréndira Avendaño-Vázquez</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Flores-Jasso</surname>
            <given-names>CF</given-names>
          </name>
        </person-group>
        <article-title>The pipeline repertoire for Ig-Seq analysis</article-title>
        <source>Front Immunol</source>
        <year>2019</year>
        <volume>10</volume>
        <fpage>899</fpage>
        <pub-id pub-id-type="doi">10.3389/fimmu.2019.00899</pub-id>
        <pub-id pub-id-type="pmid">31114573</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Smakaj</surname>
            <given-names>E</given-names>
          </name>
          <name>
            <surname>Babrak</surname>
            <given-names>L</given-names>
          </name>
          <name>
            <surname>Ohlin</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Shugay</surname>
            <given-names>M</given-names>
          </name>
          <name>
            <surname>Briney</surname>
            <given-names>B</given-names>
          </name>
          <name>
            <surname>Tosoni</surname>
            <given-names>D</given-names>
          </name>
          <name>
            <surname>Galli</surname>
            <given-names>C</given-names>
          </name>
          <name>
            <surname>Grobelsek</surname>
            <given-names>V</given-names>
          </name>
          <name>
            <surname>D’Angelo</surname>
            <given-names>I</given-names>
          </name>
          <name>
            <surname>Olson</surname>
            <given-names>B</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Benchmarking immunoinformatic tools for the analysis of antibody repertoire sequences</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>6</issue>
        <fpage>1731</fpage>
        <lpage>1739</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz845</pub-id>
        <pub-id pub-id-type="pmid">31873728</pub-id>
      </element-citation>
    </ref>
  </ref-list>
</back>
