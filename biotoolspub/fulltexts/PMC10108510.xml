<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//Springer-Verlag//DTD A++ V2.4//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName A++V2.4.dtd?>
<?SourceDTD.Version 2.4?>
<?ConverterInfo.XSLTName springer2nlmx2.xsl?>
<?ConverterInfo.Version 1?>
<processing-meta base-tagset="archiving" mathml-version="3.0" table-model="xhtml" tagset-family="jats">
  <restricted-by>pmc</restricted-by>
</processing-meta>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Genome Biol</journal-id>
    <journal-id journal-id-type="iso-abbrev">Genome Biol</journal-id>
    <journal-title-group>
      <journal-title>Genome Biology</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">1474-7596</issn>
    <issn pub-type="epub">1474-760X</issn>
    <publisher>
      <publisher-name>BioMed Central</publisher-name>
      <publisher-loc>London</publisher-loc>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">10108510</article-id>
    <article-id pub-id-type="publisher-id">2906</article-id>
    <article-id pub-id-type="doi">10.1186/s13059-023-02906-z</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Method</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>GBC: a parallel toolkit based on highly addressable byte-encoding blocks for extremely large-scale genotypes of species</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhang</surname>
          <given-names>Liubin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Yuan</surname>
          <given-names>Yangyang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff4">4</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Peng</surname>
          <given-names>Wenjie</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Tang</surname>
          <given-names>Bin</given-names>
        </name>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Li</surname>
          <given-names>Mulin Jun</given-names>
        </name>
        <xref ref-type="aff" rid="Aff5">5</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Gui</surname>
          <given-names>Hongsheng</given-names>
        </name>
        <xref ref-type="aff" rid="Aff6">6</xref>
        <xref ref-type="aff" rid="Aff7">7</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Wang</surname>
          <given-names>Qiang</given-names>
        </name>
        <xref ref-type="aff" rid="Aff8">8</xref>
      </contrib>
      <contrib contrib-type="author" corresp="yes">
        <contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4733-0109</contrib-id>
        <name>
          <surname>Li</surname>
          <given-names>Miaoxin</given-names>
        </name>
        <address>
          <email>limiaoxin@mail.sysu.edu.cn</email>
        </address>
        <xref ref-type="aff" rid="Aff1">1</xref>
        <xref ref-type="aff" rid="Aff2">2</xref>
        <xref ref-type="aff" rid="Aff3">3</xref>
        <xref ref-type="aff" rid="Aff9">9</xref>
        <xref ref-type="aff" rid="Aff10">10</xref>
      </contrib>
      <aff id="Aff1"><label>1</label><institution-wrap><institution-id institution-id-type="GRID">grid.12981.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2360 039X</institution-id><institution>Program in Bioinformatics, Zhongshan School of Medicine and The Fifth Affiliated Hospital, </institution><institution>Sun Yat-Sen University, </institution></institution-wrap>Guangzhou, 510080 China </aff>
      <aff id="Aff2"><label>2</label><institution-wrap><institution-id institution-id-type="GRID">grid.12981.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2360 039X</institution-id><institution>Center for Precision Medicine, </institution><institution>Sun Yat-Sen University, </institution></institution-wrap>Guangzhou, China </aff>
      <aff id="Aff3"><label>3</label><institution-wrap><institution-id institution-id-type="GRID">grid.12981.33</institution-id><institution-id institution-id-type="ISNI">0000 0001 2360 039X</institution-id><institution>Center for Disease Genome Research, </institution><institution>Sun Yat-Sen University, </institution></institution-wrap>Guangzhou, China </aff>
      <aff id="Aff4"><label>4</label><institution-wrap><institution-id institution-id-type="GRID">grid.268505.c</institution-id><institution-id institution-id-type="ISNI">0000 0000 8744 8924</institution-id><institution>School of Medical Technology and Information Engineering, </institution><institution>Zhejiang Chinese Medical University, </institution></institution-wrap>Hangzhou, China </aff>
      <aff id="Aff5"><label>5</label><institution-wrap><institution-id institution-id-type="GRID">grid.265021.2</institution-id><institution-id institution-id-type="ISNI">0000 0000 9792 1228</institution-id><institution>The Province and Ministry Co-Sponsored Collaborative Innovation Center for Medical Epigenetics, </institution><institution>Tianjin Medical University, </institution></institution-wrap>Tianjin, China </aff>
      <aff id="Aff6"><label>6</label><institution-wrap><institution-id institution-id-type="GRID">grid.427930.b</institution-id><institution-id institution-id-type="ISNI">0000 0004 4903 9942</institution-id><institution>Behavioral Health Services, Henry Ford Health, </institution></institution-wrap>Detroit, MI USA </aff>
      <aff id="Aff7"><label>7</label><institution-wrap><institution-id institution-id-type="GRID">grid.446722.1</institution-id><institution-id institution-id-type="ISNI">0000 0004 0635 5208</institution-id><institution>Center for Health Policy &amp; Health Services Research, Henry Ford Health, </institution></institution-wrap>Detroit, MI USA </aff>
      <aff id="Aff8"><label>8</label><institution-wrap><institution-id institution-id-type="GRID">grid.412901.f</institution-id><institution-id institution-id-type="ISNI">0000 0004 1770 1022</institution-id><institution>Mental Health Center, West China Hospital, Sichuan University, </institution></institution-wrap>Chengdu, China </aff>
      <aff id="Aff9"><label>9</label><institution-wrap><institution-id institution-id-type="GRID">grid.419897.a</institution-id><institution-id institution-id-type="ISNI">0000 0004 0369 313X</institution-id><institution>Key Laboratory of Tropical Disease Control (SYSU), Ministry of Education, </institution></institution-wrap>Guangzhou, 510080 China </aff>
      <aff id="Aff10"><label>10</label><institution-wrap><institution-id institution-id-type="GRID">grid.452859.7</institution-id><institution-id institution-id-type="ISNI">0000 0004 6006 3273</institution-id><institution>Guangdong Provincial Key Laboratory of Biomedical Imaging and Guangdong Provincial Engineering Research Center of Molecular Imaging, </institution><institution>The Fifth Affiliated Hospital, Sun Yat-sen University, </institution></institution-wrap>Zhuhai, China </aff>
    </contrib-group>
    <pub-date pub-type="epub">
      <day>17</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>17</day>
      <month>4</month>
      <year>2023</year>
    </pub-date>
    <pub-date pub-type="collection">
      <year>2023</year>
    </pub-date>
    <volume>24</volume>
    <elocation-id>76</elocation-id>
    <history>
      <date date-type="received">
        <day>15</day>
        <month>4</month>
        <year>2022</year>
      </date>
      <date date-type="accepted">
        <day>22</day>
        <month>3</month>
        <year>2023</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2023</copyright-statement>
      <license>
        <ali:license_ref specific-use="textmining" content-type="ccbylicense">https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
        <license-p><bold>Open Access</bold>This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">http://creativecommons.org/licenses/by/4.0/</ext-link>. The Creative Commons Public Domain Dedication waiver (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/">http://creativecommons.org/publicdomain/zero/1.0/</ext-link>) applies to the data made available in this article, unless otherwise stated in a credit line to the data.</license-p>
      </license>
    </permissions>
    <abstract id="Abs1">
      <p id="Par1">Whole
-genome sequencing projects of millions of subjects contain enormous genotypes, entailing a huge memory burden and time for computation. Here, we present GBC, a toolkit for rapidly compressing large-scale genotypes into highly addressable byte-encoding blocks under an optimized parallel framework. We demonstrate that GBC is up to 1000 times faster than state-of-the-art methods to access and manage compressed large-scale genotypes while maintaining a competitive compression ratio. We also showed that conventional analysis would be substantially sped up if built on GBC to access genotypes of a large population. GBC’s data structure and algorithms are valuable for accelerating large-scale genomic research.</p>
      <sec>
        <title>Supplementary Information</title>
        <p>The online version contains supplementary material available at 10.1186/s13059-023-02906-z.</p>
      </sec>
    </abstract>
    <kwd-group xml:lang="en">
      <title>Keywords</title>
      <kwd>Large-scale genotypes</kwd>
      <kwd>Genotype compression</kwd>
      <kwd>Highly addressable genotype blocks</kwd>
      <kwd>Byte-encoding genotypes</kwd>
      <kwd>Genotype management</kwd>
      <kwd>Parallelization algorithm</kwd>
      <kwd>Cloud computation</kwd>
    </kwd-group>
    <funding-group>
      <award-group>
        <funding-source>
          <institution-wrap>
            <institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/501100001809</institution-id>
            <institution>National Natural Science Foundation of China</institution>
          </institution-wrap>
        </funding-source>
        <award-id>31771401</award-id>
        <award-id>31970650</award-id>
        <principal-award-recipient>
          <name>
            <surname>Li</surname>
            <given-names>Miaoxin</given-names>
          </name>
        </principal-award-recipient>
      </award-group>
    </funding-group>
    <custom-meta-group>
      <custom-meta>
        <meta-name>issue-copyright-statement</meta-name>
        <meta-value>© The Author(s) 2023</meta-value>
      </custom-meta>
    </custom-meta-group>
  </article-meta>
</front>
<body>
  <sec id="Sec1">
    <title>Background
</title>
    <p id="Par2">Interrogating the full genetic spectrum underlying phenotypes in species requires large samples. With the dramatic decrease in sequencing costs and advancements in precision medicine, genome-wide genotypes of millions of subjects will soon become routinely available. However, the storage and computational demands of managing large-scale genotypes have become increasingly challenging. The Variant Call Format (VCF) [<xref ref-type="bibr" rid="CR1">1</xref>] is a widely used framework to store the aggregate information of genotypes for genome sequencing projects, and it has become the standard format for genetic and genomic studies. However, the easy-to-read text format of VCF files occupies much redundant storage space and is not specifically designed for large-scale genotype data. Access to large-scale genotypes in VCF for analyses will impose a huge computational burden, usually due to data overload. While a binary format by PLINK was proposed to store large-scale genotypes efficiently and speed up genome-wide association studies (GWASs) [<xref ref-type="bibr" rid="CR2">2</xref>], it loses information for multi-allele genotypes and has no further compression and addressing strategies besides binary encoding. Thus, there is an urgent need for a more efficient data format and high-performance utilities to meet the demands of large genetics and genomics projects, such as the UK Biobank (UKBB) [<xref ref-type="bibr" rid="CR3">3</xref>].</p>
    <p id="Par3">Multiple methods have been proposed to compress genotypes to facilitate the transfer and storage of large-scale genotype data, e.g., TGC [<xref ref-type="bibr" rid="CR4">4</xref>], GTShark [<xref ref-type="bibr" rid="CR5">5</xref>], Genozip [<xref ref-type="bibr" rid="CR6">6</xref>], and VCFShark [<xref ref-type="bibr" rid="CR7">7</xref>]. However, these methods did not support rapid and flexible queries for the compressed data, which is important for analyses. Thus, block-based methods for compressing genotypes into rapidly accessible formats were developed subsequently, including BCFTools [<xref ref-type="bibr" rid="CR8">8</xref>], PBWT [<xref ref-type="bibr" rid="CR9">9</xref>], BGT [<xref ref-type="bibr" rid="CR10">10</xref>], GQT [<xref ref-type="bibr" rid="CR11">11</xref>], and GTC [<xref ref-type="bibr" rid="CR12">12</xref>]. Unfortunately, the block-based methods are still generally inefficient for extremely large-scale genotypes (say, whole-genome genotypes of millions of subjects) due to a lack of efficient structures and algorithms. Methods for such large-scale genotypes should have at least four major technical advantages. First, memory and time overhead usage should grow linearly or keep steady when compressing and accessing a larger scale of genotypes. Second, it should have a robust framework for massive parallelization in reading, analyzing, and outputting genotypes. Third, it should efficiently manage the compressed genotypes (e.g., merging, splitting, and sorting by coordinates of variants). Finally, it should be equipped with versatile data query and output functions, say, query by specified variants or subjects, the output of phased or unphased genotypes with various formats (e.g., text, binary, byte, or other specified formats). Note that some advantages may conflict with each other in performance. For example, memory usage and disk input-output (I/O) efficiency may become inefficient when there are many parallel tasks, entailing a robust design to achieve these advantages simultaneously.</p>
    <p id="Par4">In the present study, we first proposed a unified data structure, Genotype Block (GTB) format, to store large-scale genotypes into many highly addressable byte-encoding compression blocks. Then, multiple advanced algorithms and a parallel computing framework were developed for efficient compression, decompression, access, management, and analyses based on the GTBs. Finally, the format and algorithms were implemented into a user-friendly Genotype Block Compressor (GBC) toolkit. We demonstrated that GBC is much faster than alternative methods to access and manage genotypes in GTB. GBC follows the GA4GH [<xref ref-type="bibr" rid="CR13">13</xref>] application program interface (API) specification (<ext-link ext-link-type="uri" xlink:href="https://ga4gh-schemas.readthedocs.io/en/latest/schemas/variants.proto.html">https://ga4gh-schemas.readthedocs.io/en/latest/schemas/variants.proto.html</ext-link>) for the design of Java structures for genetic variants. The GBC software package and API functions are publicly available at <ext-link ext-link-type="uri" xlink:href="https://pmglab.top/gbc">https://pmglab.top/gbc</ext-link>, which can be easily integrated into other tools and applied to various genomics projects.</p>
  </sec>
  <sec id="Sec2">
    <title>Results</title>
    <sec id="Sec3">
      <title>Overview of the GBC procedure</title>
      <p id="Par5">We first designed a novel GTB format for compressing and storing large-scale genotype data of haploid or diploid species with various allele numbers, chromosome numbers, and phased or unphased genotypes (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a). To begin the compression process, the input genotype file (in VCF format) is partitioned into several chunks and subsequently processed in parallel by multiple threads. In each parallel task, every chunk is further divided into multiple smaller indexable blocks. Here, a block is the smallest unit of compression, in which the number of variants is balanced with the sample size given the maximal array length <inline-formula id="IEq1"><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${2}^{31} -1(\approx 2\mathrm{GB})$$\end{document}</tex-math><mml:math id="M2"><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>31</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mo>≈</mml:mo><mml:mn>2</mml:mn><mml:mi mathvariant="normal">GB</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq1.gif"/></alternatives></inline-formula> (Fig. <xref rid="Fig2" ref-type="fig">2</xref>a). Then, the genotypes of the variants are encoded into byte codes (Figs. <xref rid="Fig1" ref-type="fig">1</xref>b and <xref rid="Fig2" ref-type="fig">2</xref>b). For biallelic variants, their byte codes are further merged into one-byte codes by combining three phased or four unphased consecutive genotypes (Fig. <xref rid="Fig2" ref-type="fig">2</xref>c). Next, the approximate minimum discrepancy ordering (AMDO) algorithm is applied on the variant level (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d) to sort the variants with similar genotype distributions for improving the compression ratio. The ZSTD algorithm is then adopted to compress the sorted data in each block (Fig. <xref rid="Fig2" ref-type="fig">2</xref>e). Finally, all the compressed blocks and metadata are written into a single GTB file (Fig. <xref rid="Fig2" ref-type="fig">2</xref>f). The procedure has a linear time complexity regarding the number of subjects and variants with small memory usage (less than 4 GB). It provides the fastest compression speed with a competitive compression ratio to date.<fig id="Fig1"><label>Fig. 1</label><caption><p>Structure of Genotype Block (GTB) and byte-encoded table of genotype (BEG) implemented in GBC. <bold>a</bold> Magic code: the first two bytes are used to store the compressed parameters. Block numbers: the total number of blocks contained in the compressed file, which also indicates that the “block abstract information” at the end of the file has (25*numbers) bytes of memory. Meta information: the meta information in the header of the VCF file. Subjects information: list of subjects. Block entity data: the compressed data is combined according to the order of the abstract block information. Abstract block information: abstract information of the GTB nodes for building the first-level fast index table. <bold>b</bold> The byte-encoding table of genotype (BEG)</p></caption><graphic xlink:href="13059_2023_2906_Fig1_HTML" id="MO1"/></fig><fig id="Fig2"><label>Fig. 2</label><caption><p>The workflow of building a GTB file in the GBC framework. <bold>a</bold> Slice (one or more) inputs into several chunks according to the specified number of parallel threads, and then each chunk is divided into several blocks for compression. <bold>b</bold> Code genotypes of each variant with byte-encoded genotype (BEG). <bold>c</bold> Combine multiple BEG of each biallelic variant into maximized byte-encoded genotype (MBEG). <bold>d</bold> Sort variants by approximate minimum discrepancy ordering (AMDO) to improve compression ratio. The sample graph is produced from the first 4000 biallelic variants of assoc.hg19.vcf.gz (download from <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7737556">https://doi.org/10.5281/zenodo.7737556</ext-link>). Genotype 0|0 is filled with white, 0|1 or 1|0 is filled with gray, and 1|1 is filled with black. <bold>e</bold> Compress the position, genotype, and allele data with an advanced compressor separately. Then, the compressed data (entity data) is concatenated into a long array and written into the disk, while the abstract information is recorded in the memory. <bold>f</bold> Store the compressed data in Genotype Block (GTB) format</p></caption><graphic xlink:href="13059_2023_2906_Fig2_HTML" id="MO2"/></fig></p>
      <p id="Par6">Besides, various advanced algorithms have been developed for rapid access and management of large-scale genotypes in GTB format. First, a tree structure (i.e., GTBTree) containing chromosome, block start, and end positions is designed for fast localization of and access to the indexable blocks and variants. Thus, data retrieval and editing in a large GTB file can be quickly accomplished only in involved blocks without decompressing the entire file. Second, an MBEG-based address conversion algorithm is developed for fast localization (especially for access by subjects) of a subject’s genotype at a variant, which enhances the speed of per-column access by more than 20 times (single thread, compared with BCFTools). Third, a unique sorting algorithm based on GTBTree makes it easy to sort variants of various sizes and degrees of disorder in less than 4 GB of memory by coordinates and without external disk space. Fourth, a file merging algorithm based on the minimum heap of sample sizes can quickly merge multiple large-scale genotypes in GTB format. Finally, we designed a cyclic locking model (CLM) for parallel decompression and downstream analysis, which can help users to design and perform parallelized computing efficiently. Thanks to the data structure and algorithms, GBC performs well for extracting, concatenating, merging, and splitting large-scale genotypes.</p>
    </sec>
    <sec id="Sec4">
      <title>Efficient compression of large-scale genotypes by GBC</title>
      <p id="Par7">A series of experiments were carried out to investigate the performance of the algorithms of GBC systematically. We first compared the compression ratio of the GBC with the other four widely used block-based methods for fast-accessing genotypes, including BCFTools, BGT, PBWT, and GTC. According to Danek et al. [<xref ref-type="bibr" rid="CR12">12</xref>], GTC had the largest compression ratio among the four methods. However, Fig. <xref rid="Fig3" ref-type="fig">3</xref>a and b showed that GBC had the best compression ratio on the typical public datasets (UKBB, 1000GP3, and SG10K), over 10% higher than GTC. For example, GBC only needed 631.03 MB of disk space to store the UKBB dataset with 469,835 subjects and 70,581 variants, while GTC needed 701.45 MB. Besides, we also compared GBC to the other two genotype compression methods for data archiving (GTShark, Genozip). The two methods’ compression ratios were around 1.7 to 1.27 times higher than that of GBC for unphased genotypes (in UKBB exome chr4 dataset: GBC: 0.62 GB, GTShark: 0.51 GB, Genozip: 0.49 GB; in 1000GP3 and SG10K datasets: GBC: 3.68 GB, GTShark: 2.51 GB, Genozip: 2.54 GB, see details in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1). However, accessing the compressed genotypes by the two methods is much slower than GBC (see details in the section about data-access performance). In sum, GBC provided a competitive compression ratio, although its primary goal is not to save the storage space of archived genotypes.<fig id="Fig3"><label>Fig. 3</label><caption><p>The performance comparison among GBC and alternative methods (details in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Tables S1-S5). <bold>a</bold> The basic performance of different methods on the UKBB exome chr4 dataset. The “standardized performance ratio” was obtained by scaling the GBC’s result to 1 and all other results against the GBC’s result. <bold>b</bold> The basic performance of different methods on the 1000GP3 and SG10K. <bold>c</bold> The compression speed (upper region) and decompression speed (lower region) of GBC and other alternative methods with the increase of sample size on simulated datasets. <bold>d</bold> The significant improvement of compression and decompression speed under multi-threads on the 1000GP3 dataset. <bold>e</bold> Retrieved the genotypes of random variants for all the subjects on the SG10K dataset. The option of accessing genotypes of variants in multiple regions at a time is only provided by BCFtools, GBC, and Genozip. Thus, the time cost was estimated by the access time of individual sites for methods including GTC, PBWT, and BGT. Genozip throws an exception when accessing 994,485 and 9,944,848 variants. <bold>f</bold> Retrieved a range of continuous variants for all the subjects on the Simulation 5000 K and SG10K-chr2 (the genotypes on chromosome 2 of the SG10K dataset) datasets. BGT, PBWT, GTC, and Genozip failed to compress the simulation 5000 K dataset. <bold>g</bold> Retrieved all the variants for a specified subset of subjects on the SG10K-chr2 dataset. <bold>h</bold> Retrieved all the variants for a specified subset of subjects on the Simulation 500 K dataset. <bold>i</bold> Filtered out the variants by alternative allele frequency on the SG10K-chr2 dataset. <bold>j</bold> Retrieved continuous variants and random variants in ordered and unordered SG10K dataset separately. <bold>k</bold> The comparison of LD coefficients computational speed between GBC and other popular tools on the 1000GP3 and SG10K datasets. <bold>l</bold> GBC speeds up follow-up computation (calculating the pair-wise linkage disequilibrium coefficients as an example) through I/O optimization. <bold>m</bold> Concatenate the chromosome-separated files within each dataset. <bold>n</bold> Split compressed archives by chromosome. <bold>o</bold> Merge multiple compressed archives with non-overlapping subjects. <bold>p</bold> Retrieve all the genotypes for a specified subset of subjects and rebuild the compressed archives. We tested the time cost of fetching different sizes of subject subsets on the simulation 500 K dataset. <bold>q</bold> Sort the variants by coordinate. We used several disordered simulated data with 100,000 subjects for evaluating the time cost and measured the range of speed ratio of GBC to BCFtools according to the disordered degree of datasets</p></caption><graphic xlink:href="13059_2023_2906_Fig3_HTML" id="MO3"/></fig></p>
      <p id="Par8">Then, we investigated the compression and decompression speed of the GBC using simulated and real genotypes. Figure <xref rid="Fig3" ref-type="fig">3</xref>c shows the compression and decompression speeds of GBC, as well as those of the alternative tools, on simulated datasets. We found that the GBC was much faster than GTC, which had the highest compression ratio among the four block-based genotype compression tools. The speed ratio of GBC to GTC grew exponentially as the sample size increased. For instance, GBC was over 1000 times faster than GTC in a simulated sample with 500,000 subjects. GBC took 0.80 min and 3.87 min to compress the genotype datasets with 30,000 variants of 100,000 and 500,000 subjects, respectively, while GTC spent 180 min and 4964.19 min doing this. In the real dataset testing, GBC was 454.73 times faster than GTC in compressing the UKBB [<xref ref-type="bibr" rid="CR3">3</xref>] genotypes of 32,626 variants on chromosome 10 of 487,409 subjects. Besides, for the imputed genotypes of 4,562,904 variants on chromosome 10 of 487,409 UKBB subjects, GBC took 549.02 min (single-thread model) for the compression, while CTC failed after 3 weeks of running. Note that PBWT had memory overflow (&gt; 100 GB memory), GTC had timeout (&gt; 1 week) when compressing more than 500,000 subjects, and Genozip threw an exception when processing the datasets with 5,000,000 subjects. Compared to the two data-archiving methods (GTShark, Genozip), GBC was 2 to 5 times faster in compressing the testing datasets. This comparison showed that GBC had the superior speed to compress large-scale genotype datasets. Moreover, in terms of decompression speed, GBC was also approximately 1.8 times faster than others when decompressing the data to be BGZ format (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c, lower region). Note that it is more reasonable to describe the speed difference in decompression with BGZ format, as it reduces the influence of the slow disk output speed. Finally, GBC can be several times faster under multi-threads for compression and decompression (Fig. <xref rid="Fig3" ref-type="fig">3</xref>d).</p>
    </sec>
    <sec id="Sec5">
      <title>Rapid accessing of the compressed genotypes by GBC</title>
      <p id="Par9">The time cost of accessing the compressed genotypes is very important for subsequent analyses. GTB format and GBC functions were primarily proposed to facilitate fast and flexible access to compressed genotypes. First, we compared the genotype access time of several alternative methods in extracting 0.01%, 0.1%, 1%, and 10% of the variants from the SG10K [<xref ref-type="bibr" rid="CR14">14</xref>] dataset. We found that GBC was more than one order of magnitude times faster than others (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e). Note that when retrieving multiple sporadic variants in a GTB file, GBC only needs to scan the file once, while PBWT, BGT, and GTC can only retrieve one variant in a file scan. Second, GBC was 2.07 times faster than the best of the other peer methods (i.e., BGT) when accessing a set of consecutive variants on the same chromosome (Fig. <xref rid="Fig3" ref-type="fig">3</xref>f). Moreover, GBC can also quickly retrieve the genotype data given a set of subjects. Its superior speed over other methods became increasingly striking as the sample size in compressed datasets increased. For example, when extracting genotypes in a single subject, GBC was 1.59 times faster than GTC on small-scale datasets, while it was 5.16 times faster on large-scale datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>g, h). We indicated that all forms of data access would eventually approach the speed of decompressing all data as the number of genotypes to be extracted increases. However, GBC was still 1.8 times faster than the fastest method (GTC) on large sample sizes (Fig. <xref rid="Fig3" ref-type="fig">3</xref>c, lower region). Besides, GBC was also 1.25 times as fast as other methods when filtering out variants within a specified allele frequency range (Fig. <xref rid="Fig3" ref-type="fig">3</xref>i). We noted that Genozip and GTShark were much slower than GBC. For example, GTShark took 47,377.98 s to extract genotypes of a subject from a simulated genotype dataset of 100,000 variants of 5 million subjects, while GBC only needed 135.10 s. While GTShark only supports extracting genotypes of a single subject from the compressed dataset, Genozip can extract genotypes of multiple subjects or genotypes in multiple genomic regions from compressed datasets. However, in a simulated genotype dataset with 500,000 subjects and 30,000 variants, Genozip was 845.89 times slower than GBC in accessing the genotypes of a single subject (Fig. <xref rid="Fig3" ref-type="fig">3</xref>g, h, GBC’s 5.34 s vs Genozip’s 4518.75 s). Genozip was even 4576.7 times slower than GBC in accessing 9948 out of 99,448,478 variants in a dataset with 4810 real subjects in a test (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e, GBC’s 10.27 s vs Genozip’s 46,998.60 s). Especially, GBC is by far the only method that enables fast retrieval in datasets with unsorted variants (while others only work for ordered variants). The time cost on the unordered datasets was similar to that of the ordered datasets (Fig. <xref rid="Fig3" ref-type="fig">3</xref>j). Last but not least, GBC is the tool that supports querying data in parallel. The query speed of GBC under multiple threads could be several times faster than that of a single thread (Fig. <xref rid="Fig3" ref-type="fig">3</xref>e-i), which suggests the great potential of GBC to accelerate parallel calculations.</p>
    </sec>
    <sec id="Sec6">
      <title>Significant improvement in the performance of downstream computation by GTB format</title>
      <p id="Par10">The genotype access and calculation can be carried out quickly and efficiently based on the GTB format, which speeds up follow-up analyses based on genotypes. Here, we showed the advantage of calculating the pair-wise linkage disequilibrium (LD) coefficients with GTB format. At the algorithmic level, GBC used bitwise operations to maximize computational speed, which is similar to PLINK [<xref ref-type="bibr" rid="CR2">2</xref>] and KGGSeq [<xref ref-type="bibr" rid="CR15">15</xref>]. However, GBC accessed genotypes for computation based on the GTB format rather than the vcf.gz format like other tools (such as PLINK, VCFtools [<xref ref-type="bibr" rid="CR1">1</xref>], PopLDdecay [<xref ref-type="bibr" rid="CR16">16</xref>]). Taking the 1000GP3 and SG10K datasets as an example, the results (Fig. <xref rid="Fig3" ref-type="fig">3</xref>k) showed that GBC was 3.75 times faster than PLINK(V1.9) in calculating LD from GTB data and compressed VCF data under a single thread, respectively. Especially, GBC was even 20.3 times faster than PLINK(V1.9) when both tools used eight threads. Here, we emphasized that the speed advantage of GBC is largely due to the faster genotype retrieving process and the cyclic-locked parallelization. Although the latest research indicated that GPU-based computing could significantly improve the speed of LD calculation [<xref ref-type="bibr" rid="CR17">17</xref>], GBC mainly focused on optimizing the computational speed at the I/O level (Fig. <xref rid="Fig3" ref-type="fig">3</xref>l). The GTB format and GBC functions have largely relieved the limitation of I/O by optimizing the I/O frequency and load in genotype blocks. Therefore, we believe that many tools would perform better if they were built on GBC to access and parse large-scale genotype data.</p>
    </sec>
    <sec id="Sec7">
      <title>Convenient management of large-scale compressed files by GBC</title>
      <p id="Par11">Convenient management of large-scale compressed files is also critical for genetic and genomic studies. We compared GBC with the current popular tool BCFtools [<xref ref-type="bibr" rid="CR8">8</xref>] for managing compressed genotype data (PBWT, BGT, and GTC do not support these functions). BCFtools handles compressed BCF in BGZ formats, while GBC manages compressed GTBs. When concatenating genotype files with the same number of subjects, we found that GBC was 2421.3 times (Fig. <xref rid="Fig3" ref-type="fig">3</xref>m) faster than BCFtools. When splitting genotypes by chromosome, it was 4157.6 times (Fig. <xref rid="Fig3" ref-type="fig">3</xref>n) as fast as BCFtools. Besides, GBC was 4.87 times faster than BCFtools on merging genotypes files with non-overlapping subjects under four threads (Fig. <xref rid="Fig3" ref-type="fig">3</xref>o). For retrieving the genotypes of 500,000 subjects, the speed of GBC was further increased by 5.8 times because of the advanced GTB structure (Fig. <xref rid="Fig3" ref-type="fig">3</xref>p) compared to the BGZ format (Fig. <xref rid="Fig3" ref-type="fig">3</xref>h). In terms of the sorting speed, GBC was always approximately 3 to 9 times faster than BCFtools for 100,000 subjects under a single thread (Fig. <xref rid="Fig3" ref-type="fig">3</xref>q). The less disordered the data, the better performance the GBC would have. Particularly, GBC can accomplish the sorting directly in 4 GB of memory, while the BCFtools may need large external disk space (Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1). For instance, BCFTools cannot sort larger datasets (e.g., 100,000 subjects and 1,000,000 variants) in 64 GB of memory. Similar to the data access performance, we believe that the speed difference between GBC and BCFtools will be more pronounced as sample sizes increase. These results illustrated that the GTB structure could also facilitate fast management of large-scale genotypes.</p>
    </sec>
  </sec>
  <sec id="Sec8">
    <title>Discussion</title>
    <p id="Par12">In recent years, numerous genome-wide genotypes of large-scale samples for dissecting genetic mechanisms of phenotypes have grown explosively, raising a heavy computational burden. Many methods were developed to address this issue by advanced algorithms compressing large-scale genotypes. However, efficient usage of large-scale genotype data is far more than compression. In the present study, we proposed a comprehensive solution for the management and computation of large-scale genotypes. First, we designed a unified data structure, GTB, to store any type of genotype data flexibly (phased or not, biallelic or multiallelic, human or non-human) into highly addressable byte-encoding blocks in a single file. We showed that the novel blocking structure facilitated rapid access to compressed genotypes compared to the existing genotype compression methods [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR12">12</xref>]. The single-file strategy also solved the management inefficiency of the multi-file strategy adopted by most compression methods [<xref ref-type="bibr" rid="CR9">9</xref>–<xref ref-type="bibr" rid="CR12">12</xref>]. Moreover, we developed multiple advanced algorithms based on the GTB format to improve the speed and save RAM for genotypes’ computation and management. All of them are implemented in our integrated software toolkit, GBC. To our knowledge, GBC may be the only tool that can compress and manage whole-genome genotypes of millions of human subjects in an ordinary computer with around 4 GB RAM. Furthermore, its I/O optimized framework for different types of parallel tasks (e.g., I/O intensive tasks and computing-intensive tasks) processing genotype blocks also enhance the efficiency of large-scale genotypes. Two commonly used and user-friendly interfaces are also provided, a command line tool (installation-free) and a Java-API library. Thus, GBC is suitable for a wide range of users, enabling professional researchers and amateurs to use it even on personal laptops easily.</p>
    <p id="Par13">The success of GBC showed that compression and rapid access of genotype data could be well balanced with subtle data structure and advanced algorithms. The data compression ratio and access speed interfere with each other. GBC does not aim to improve the compression ratio exclusively. Therefore, GBC may have a lower compression ratio than the methods for a frozen compression of genotypes which would be very inefficient for genotype access in subsequent analysis (e.g., GTShark [<xref ref-type="bibr" rid="CR5">5</xref>], Genozip [<xref ref-type="bibr" rid="CR6">6</xref>], VCFShark [<xref ref-type="bibr" rid="CR7">7</xref>]). Besides the storage space, the speed of access and analysis is also critical for analyses with large-scale genotype data (e.g., UKBB [<xref ref-type="bibr" rid="CR3">3</xref>] and TOPMed project [<xref ref-type="bibr" rid="CR18">18</xref>]). GBC aims to improve both in a balanced way. While GBC achieves the fastest compression, decompression, query, and manipulation of compressed data among the tools that support fast retrieval, it also has a highly competitive compression ratio to the compared tools in real testing datasets. For example, among the four compared tools, GTC, the tool with the closest compression ratio to GBC, is much slower (more than 1283 times than GBC in compressing large-scale datasets with ~ 500,000 subjects). While some other tools are much faster than GTC, they are inferior to GBC in compression ratio. The GTB format and GBC functions have largely overcome the limitation of I/O by the I/O optimization. These are particularly beneficial for developing and applying genomic tools or platforms that analyze large-scale genotype data. For instance, sequential access to genotypes in GTB files is 5.78 times faster than that in vcf.gz format on 1000GP3, while random access to genotypes of a variant is estimated to be more than 71.56 times faster. Furthermore, the LD calculation speed has been improved by 20.3 times under eight threads due to the efficient I/O, compared to PLINK(V1.9).</p>
    <p id="Par14">It should be noted that the GTB format is not intended to replace VCF. VCF’s text format that denotes genotypes with various attributes is human-readable and convenient, making it widely used in the genetic and genomic community. Despite being inefficient for computing large-scale genotypes, VCF remains essential for sharing and exchanging called variants in the community. Nevertheless, GBC provides efficient functions to transform VCF to the GTB format, which has a much more efficient design to optimize access and computation of large-scale genotypes. GBC also includes a complete quality control procedure to ensure high-quality genotypes are compressed, with those failing to meet quality criteria being set as missing values. In the performance comparison of this paper, we removed all quality metrics to make a fair comparison with similar tools (which cannot store the quality metrics of genotypes, e.g., BGT [<xref ref-type="bibr" rid="CR10">10</xref>] and GTC [<xref ref-type="bibr" rid="CR12">12</xref>]). However, the flexible structure of GTB allows it to store extra data directly, including ID, INFO, and Genotype Metrics in VCF. This flexibility meets the general analysis requirements of a large-scale genotype dataset, which may include other data.</p>
  </sec>
  <sec id="Sec9">
    <title>Conclusions</title>
    <p id="Par15">Here, we developed a new toolkit, GBC, for efficient storage, access, management, and computation of extremely large-scale genotypes and verified its validity by various scales of genotypes. Most existing tools had no fast-accessible compression format and no efficient usage of RAM or I/O-optimized parallel computing for large-scale genotype data. In contrast, GBC provides a novel GTB data structure, speed-raising algorithms, and an I/O-optimized parallel framework with reusable RAM. The computing burden of GBC is so substantially reduced that whole-genome genotypes of millions of subjects can be rapidly compressed and accessed in small RAM under a fully parallelized model. We also showed that many commonly used software tools were very slow or required too much RAM to process the same amount of large-scale genotypes. Several extensions to GBC are under consideration for further development, including more efficient functions for large-scale genomic computations (e.g., the population PCA [<xref ref-type="bibr" rid="CR19">19</xref>]) based on its parallelization and low memory consumption advantages. The ability of fast access to genotypes with low RAM consumption under the optimized parallel framework also makes GTB and GBC attractive for cloud computation. In sum, GTB and GBC will benefit genetics and precision medicine studies, whose genotype resources are growing dramatically.</p>
  </sec>
  <sec id="Sec10">
    <title>Methods</title>
    <sec id="Sec11">
      <title>Compress genotypes into a highly addressable Genotype Block (GTB) format</title>
      <sec id="Sec12">
        <title>The structure of GTB</title>
        <p id="Par16">We designed a novel Genotype Block (GTB) format to store the compressed large-scale genotypes in a file. GTB consisted of 6 main decoupled parts (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a, Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Note 1). The first part is the magic code, which stores the software parameters for building the current GTB file using 2 bytes, including the maximum size of each block after decompression (for pre-allocated memory when decompressing blocks), whether the file is ordered or not, the specified compressor, the state of genotype (phased or unphased), the maximum number of sites per block, and the compression level. The second part is the block numbers, which stores the number of sub-blocks in the current GTB file as a 3-byte integer. The third part is the version of the reference genome for variants positions and so on (i.e., the meta-information in VCF). As an extension, other necessary comment fields in the VCF can be concatenated using an intermediate separator (e.g., “\t”) and stored in this part. The fourth section is the sample information, which contains the sample sequence length and the sample data. The fifth part is the genotype sub-blocks. Each sub-block contains three compulsory sub-parts, including genotype data, position data, and allele data. In addition, other fields from VCF can also be concatenated as optional sub-parts. Finally, the sixth part is the abstract block information, which contains the parameters necessary to access the genotype sub-blocks quickly (i.e., index information).</p>
        <p id="Par17">Here is a typical process for generating a GTB file. GBC first writes 5 bytes of placeholder information for magic code and block numbers at the beginning of compression. The meta information and subject information are added subsequently. Next, the data entity and abstract information for each block are written to the disk and memory synchronously to ensure that the order of records in memory is the same as those written to the file in the hard disk. After all the blocks are compressed, their abstract information in the memory is written to the end of the GTB file. Finally, the file pointer returns to the head of the file, and GTB modifies the placeholder information according to the compression results, including block size, compressor parameters, the state of genotype (phased or unphased), and whether the file is in order (whether all the block-coordinates in current GTB file are non-overlap). In brief, a GTB file is essentially made up of highly addressable and independent blocks of compressed genotypes.</p>
      </sec>
      <sec id="Sec13">
        <title>Chunking inputs and splitting each chunk into blocks</title>
        <p id="Par18">The processed VCF file is sliced into <inline-formula id="IEq2"><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M4"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq2.gif"/></alternatives></inline-formula> chunks (if the multi-threading mode is enabled and <inline-formula id="IEq3"><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t$$\end{document}</tex-math><mml:math id="M6"><mml:mi>t</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq3.gif"/></alternatives></inline-formula> threads are specified) with approximately even physical sizes. Under each thread, the read-in variants of each chunk are divided into multiple blocks of consecutive entries. Briefly, the block construction is terminated if (a) the number of variants in the block reaches the maximum size, (b) a different chromosome occurs, and (c) it reaches the end of the file. The maximum size of variants <inline-formula id="IEq4"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M8"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq4.gif"/></alternatives></inline-formula> in each block is set automatically, which is mainly dependent on the sample size <inline-formula id="IEq5"><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M10"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq5.gif"/></alternatives></inline-formula> as <inline-formula id="IEq6"><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N\in \{{2}^{n}|{2}^{n}\times M\le {2}^{31}-2, 7\le n\le 14\enspace \mathrm{and}\enspace n\in {\mathbb{N}}^{*}\}$$\end{document}</tex-math><mml:math id="M12"><mml:mrow><mml:mi>N</mml:mi><mml:mo>∈</mml:mo><mml:mo stretchy="false">{</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msup><mml:mo stretchy="false">|</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msup><mml:mo>×</mml:mo><mml:mi>M</mml:mi><mml:mo>≤</mml:mo><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>31</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn><mml:mo>≤</mml:mo><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:mn>14</mml:mn><mml:mspace width="5.0pt"/><mml:mi mathvariant="normal">and</mml:mi><mml:mspace width="5.0pt"/><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow><mml:mrow><mml:mrow/><mml:mo>∗</mml:mo></mml:mrow></mml:msup><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq6.gif"/></alternatives></inline-formula>. GBC can store 128 variants of 16,777,215 subjects or 16,384 variants of 131,071 subjects in each block at most. This strategy allows the personal laptop to deal with large datasets conveniently because a block always occupies small memory during the analysis. The blocks from different chunks are parallelly processed independently under the multi-threaded mode, improving compression speed. Besides, we have adopted nine commonly used quality control strategies (described in KGGSeq [<xref ref-type="bibr" rid="CR15">15</xref>]) in GBC to filter out genotypes and variants with poor quality. The quality control (QC) is executed by default after read-in, and only genotypes and variants that pass the QC are stored in the blocks. The blocks also allow the decompressing algorithm only to process a small fraction of all the data for queries (fast access to the compressed data).</p>
      </sec>
      <sec id="Sec14">
        <title>Maximized byte-encoded of genotype (MBEG)</title>
        <p id="Par19">Conventional genotype array storage in text format (e.g., 0|1) takes up much redundant information space. Therefore, a more efficient and compatible strategy is needed to encode the genotypes with less space to enhance the information density (containing as much information as possible in the same byte length). Here, we propose a novel byte-based lossless encoding strategy to store genotypes, which helps reduce memory burden and accelerate the compression process. It has two steps, and step 2 is specifically designed for biallelic genotypes.</p>
        <sec id="FPar1">
          <title>Step 1</title>
          <p id="Par20">A byte-based encoding strategy of genotype (byte-encoded genotype, BEG, Fig. <xref rid="Fig1" ref-type="fig">1</xref>b) is proposed to encode genotypes. Let a variant <inline-formula id="IEq7"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$v$$\end{document}</tex-math><mml:math id="M14"><mml:mi>v</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq7.gif"/></alternatives></inline-formula> has <inline-formula id="IEq8"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{v}$$\end{document}</tex-math><mml:math id="M16"><mml:msub><mml:mi>n</mml:mi><mml:mi>v</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq8.gif"/></alternatives></inline-formula> different alleles <inline-formula id="IEq9"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}_{v}\in [2, 15]$$\end{document}</tex-math><mml:math id="M18"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>v</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>15</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq9.gif"/></alternatives></inline-formula>. The byte codes of a genotype of the variant can be calculated. The non-missing phased genotype “<inline-formula id="IEq10"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a\mid b$$\end{document}</tex-math><mml:math id="M20"><mml:mrow><mml:mi>a</mml:mi><mml:mo>∣</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq10.gif"/></alternatives></inline-formula>” (<inline-formula id="IEq11"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a, b \ge 0$$\end{document}</tex-math><mml:math id="M22"><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo>≥</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq11.gif"/></alternatives></inline-formula>) will be encoded as:<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}a\mid b\to \left\{\begin{array}{ll}{\left(a+1\right)}^{2}-b &amp;,a\ge b\\ {b}^{2}+a+1&amp;,a&lt;b\end{array}\right.\end{array}$$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>a</mml:mi><mml:mo>∣</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">→</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>≥</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msup><mml:mrow><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mi>a</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2906_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p>
          <p id="Par21">The missing genotype “<inline-formula id="IEq12"><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$.|.$$\end{document}</tex-math><mml:math id="M26"><mml:mrow><mml:mo>.</mml:mo><mml:mo stretchy="false">|</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq12.gif"/></alternatives></inline-formula>”, is encoded to 0. For an unphased genotype “<inline-formula id="IEq13"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a/b$$\end{document}</tex-math><mml:math id="M28"><mml:mrow><mml:mi>a</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq13.gif"/></alternatives></inline-formula>”, it is also encoded formula (<xref rid="Equ1" ref-type="disp-formula">1</xref>) after being transformed to “<inline-formula id="IEq14"><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{min}\{a, b\}\mid \mathrm{max}\{a, b\}$$\end{document}</tex-math><mml:math id="M30"><mml:mrow><mml:mi mathvariant="normal">min</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">}</mml:mo><mml:mo>∣</mml:mo><mml:mi mathvariant="normal">max</mml:mi><mml:mo stretchy="false">{</mml:mo><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq14.gif"/></alternatives></inline-formula>”. For the sake of unification, a genotype “<inline-formula id="IEq15"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a$$\end{document}</tex-math><mml:math id="M32"><mml:mi>a</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq15.gif"/></alternatives></inline-formula>” of a variant in a male’s chromosome X and Y is converted into “<inline-formula id="IEq16"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a\mid a$$\end{document}</tex-math><mml:math id="M34"><mml:mrow><mml:mi>a</mml:mi><mml:mo>∣</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq16.gif"/></alternatives></inline-formula>” and is encoded by the above formula. Note that the strategy ensures coherent genotype encoding values of variants with different allele numbers.</p>
        </sec>
        <sec id="FPar2">
          <title>Step 2</title>
          <p id="Par22">However, the BEG array (BEGs) still has unused information space and may reduce the compression efficiency in a project with large samples. Because a biallelic variant has 4 (unphased) ~ 5 (phased) possible genotypes and the majority of variants in human genomes are biallelic, we further combine 3 (phased) ~ 4 (unphased) consecutive BEG codes into a single byte for biallelic variants as follow:<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}\left[\!{\begin{array}{c}\text{BEG}\end{array}\!}_{0},{\begin{array}{c}\text{BEG}\end{array}\!}_{1},{\begin{array}{c}\text{BEG}\end{array}\!}_{2}\right]\to {5}^{2}\cdot {\begin{array}{c}\text{BEG}\end{array}\!}_{0}+5\cdot {\begin{array}{c}\text{BEG}\end{array}\!}_{1}+{\begin{array}{c}\text{BEG}\end{array}\!}_{2}\end{array}$$\end{document}</tex-math><mml:math id="M36" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfenced close="]" open="["><mml:mspace width="-0.166667em"/><mml:msub><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="-0.166667em"/></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="-0.166667em"/></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="-0.166667em"/></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mfenced><mml:mo stretchy="false">→</mml:mo><mml:msup><mml:mrow><mml:mn>5</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="-0.166667em"/></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>5</mml:mn><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="-0.166667em"/></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="-0.166667em"/></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2906_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}\left[\!{\begin{array}{c}\text{BEG}\end{array}\!}_{0},{\begin{array}{c}\text{BEG}\end{array}\!}_{1},{\begin{array}{c}\text{BEG}\end{array}\!}_{2},{\begin{array}{c}\text{BEG}\end{array}\!}_{3}\right]\to {4}^{3}\cdot {\begin{array}{c}\text{BEG}\end{array}\!}_{0}+{4}^{2}\cdot {\begin{array}{c}\text{BEG}\end{array}\!}_{1}+4\cdot {\begin{array}{c}\text{BEG}\end{array}\!}_{2}+{\begin{array}{c}\text{BEG}\end{array}\!}_{3} \end{array}$$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mfenced close="]" open="["><mml:mspace width="-0.166667em"/><mml:msub><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="-0.166667em"/></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="-0.166667em"/></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="-0.166667em"/></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="-0.166667em"/></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mfenced><mml:mo stretchy="false">→</mml:mo><mml:msup><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mn>3</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="-0.166667em"/></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mn>4</mml:mn></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="-0.166667em"/></mml:mrow><mml:mn>1</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>4</mml:mn><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="-0.166667em"/></mml:mrow><mml:mn>2</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mspace width="-0.166667em"/></mml:mrow><mml:mn>3</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2906_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula></p>
          <p id="Par23">Conversions (2) and (3) are designed for phased and unphased BEGs, respectively. If the number of BEG for a variant is not enough to make a group of three or four, the inadequate part is called incomplete MBEG (e.g., one variant of 1000 subjects with phased genotypes will form 334 groups, and two nulls to make up the last group), and the null <inline-formula id="IEq17"><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\begin{array}{c}\text{BEG}\end{array}}_{i}$$\end{document}</tex-math><mml:math id="M40"><mml:msub><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq17.gif"/></alternatives></inline-formula> will be set to the same as the previous one according to <inline-formula id="IEq18"><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\begin{array}{c}\text{BEG}\end{array}}_{i}={\begin{array}{c}\text{BEG}\end{array}}_{i-1}$$\end{document}</tex-math><mml:math id="M42"><mml:mrow><mml:msub><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>BEG</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq18.gif"/></alternatives></inline-formula> (if <inline-formula id="IEq19"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i\ge 1$$\end{document}</tex-math><mml:math id="M44"><mml:mrow><mml:mi>i</mml:mi><mml:mo>≥</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq19.gif"/></alternatives></inline-formula>). In human genomes, the storage space with the maximized byte-encoded genotype array (MBEGs) will be reduced by nearly 11/12 or 15/16, compared to the common text format in VCF. Finally, BEG and MBEG can be pre-calculated and stored in an encoding table with <inline-formula id="IEq20"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o(1)$$\end{document}</tex-math><mml:math id="M46"><mml:mrow><mml:mi>o</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq20.gif"/></alternatives></inline-formula> access time. The encoding table can be loaded in memory for fast encoding or decoding by direct mapping without computing. For instance, the encoding value of genotype <inline-formula id="IEq21"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a\mid b$$\end{document}</tex-math><mml:math id="M48"><mml:mrow><mml:mi>a</mml:mi><mml:mo>∣</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq21.gif"/></alternatives></inline-formula> is the element in row <inline-formula id="IEq22"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$a$$\end{document}</tex-math><mml:math id="M50"><mml:mi>a</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq22.gif"/></alternatives></inline-formula> and column <inline-formula id="IEq23"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$b$$\end{document}</tex-math><mml:math id="M52"><mml:mi>b</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq23.gif"/></alternatives></inline-formula> of the encoding table (Fig. <xref rid="Fig1" ref-type="fig">1</xref>b). The complete coding table of BEG and MBEG can be found in Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S6.</p>
        </sec>
      </sec>
      <sec id="Sec15">
        <title>Approximate minimum discrepancy ordering of variants (AMDO)</title>
        <p id="Par24">The diverse genotype of different variants in a block (especially for the non-conservative region) will result in dispersive genotype distributions (Fig. <xref rid="Fig2" ref-type="fig">2</xref>d), harming the genotype compression ratio. Thus, we propose an algorithm named approximate minimum discrepancy ordering (AMDO) to sort all variants within a block based on both the allele frequency and genotype distribution. AMDO provides an <inline-formula id="IEq24"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o(nm)$$\end{document}</tex-math><mml:math id="M54"><mml:mrow><mml:mi>o</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq24.gif"/></alternatives></inline-formula> time complexity in the fast sorting process (compared to GTC with at least <inline-formula id="IEq25"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$o(n{m}^{2})$$\end{document}</tex-math><mml:math id="M56"><mml:mrow><mml:mi>o</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq25.gif"/></alternatives></inline-formula> time complexity), and significantly improves the compression ratio.</p>
        <p id="Par25">AMDO starts with extracting the genotype accumulated down-sampling features. Supposing that each block contains <inline-formula id="IEq26"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M58"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq26.gif"/></alternatives></inline-formula> variants and <inline-formula id="IEq27"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M60"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq27.gif"/></alternatives></inline-formula> subjects, a zero-count matrix is denoted as <inline-formula id="IEq28"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$C = {\left[{c}_{mn}\right]}_{M\times N}$$\end{document}</tex-math><mml:math id="M62"><mml:mrow><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mfenced close="]" open="["><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">mn</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mrow><mml:mi>M</mml:mi><mml:mo>×</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq28.gif"/></alternatives></inline-formula>, where <inline-formula id="IEq29"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${c}_{mn}$$\end{document}</tex-math><mml:math id="M64"><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">mn</mml:mi></mml:mrow></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq29.gif"/></alternatives></inline-formula> is the count of reference alleles (namely 0 alleles) of the <inline-formula id="IEq30"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M66"><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq30.gif"/></alternatives></inline-formula> variant for the <inline-formula id="IEq31"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M68"><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq31.gif"/></alternatives></inline-formula> subject. Then, the genotype vector of a variant <inline-formula id="IEq32"><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$m$$\end{document}</tex-math><mml:math id="M70"><mml:mi>m</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq32.gif"/></alternatives></inline-formula>
<inline-formula id="IEq33"><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{m}=[{c}_{m0}, {c}_{m1}, \cdots , {c}_{m\left(N-1\right)}]$$\end{document}</tex-math><mml:math id="M72"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mfenced close=")" open="("><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq33.gif"/></alternatives></inline-formula> is merged into a shorter <inline-formula id="IEq34"><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M74"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq34.gif"/></alternatives></inline-formula>-element vector,<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}{C}_{m}^{\left(l\right)}=\left[{C}_{m,0}^{\left(l\right)},{C}_{m,1}^{\left(l\right)},\cdots , {C}_{m,s-1}^{\left(l\right)}\right] \end{array}$$\end{document}</tex-math><mml:math id="M76" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:mfenced close="]" open="["><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2906_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq35"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{m,i}^{\left(l\right)}$$\end{document}</tex-math><mml:math id="M78"><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq35.gif"/></alternatives></inline-formula> covers a maximum of <italic>l</italic> = ⎡<italic>N/s</italic>⎤ consecutive genotypes, and <inline-formula id="IEq36"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M80"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq36.gif"/></alternatives></inline-formula> is 24 by default. Each element <inline-formula id="IEq37"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{m,i}^{\left(l\right)}$$\end{document}</tex-math><mml:math id="M82"><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq37.gif"/></alternatives></inline-formula> in the vector is defined as an accumulated count, i.e.:<disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{l}C_{m,i}^{\left(l\right)}=\sum\limits_{j=1.l}^{\min\;\left\{N\;-1,\;\left(i+1\right)l-1\right\}}\sum\limits_{k=i.l}^jc_{mk}=\left\{\begin{array}{ll}\sum\limits_{j=i\cdot l}^{\left(i+1\right)l-1}\left(\left(i+1\right)l-j\right)c_{mj}&amp;,i&lt; s-1\\ \sum\limits_{j=i\cdot l}^{N-1}\left(N-j\right)c_{mj}&amp;,i=s-1\end{array}\right.\end{array}$$\end{document}</tex-math><mml:math id="M84" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mo movablelimits="true">min</mml:mo><mml:mspace width="0.277778em"/><mml:mfenced close="}" open="{"><mml:mi>N</mml:mi><mml:mspace width="0.277778em"/><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.277778em"/><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:munderover><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>.</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mi>j</mml:mi></mml:munderover><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">mk</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>·</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mfenced close=")" open="("><mml:mfenced close=")" open="("><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mi>l</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi></mml:mfenced><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">mj</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:munderover><mml:mo movablelimits="false">∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mo>·</mml:mo><mml:mi>l</mml:mi></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munderover><mml:mfenced close=")" open="("><mml:mi>N</mml:mi><mml:mo>-</mml:mo><mml:mi>j</mml:mi></mml:mfenced><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi mathvariant="italic">mj</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2906_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par26">The accumulation helps discriminate genotype distribution effectively. For example, according to (5), two zero-count vectors [0,1,1,2] and [2,1,1,0] have different accumulated counts, 7 and 9, respectively, although they have the same alternative allele counts.</p>
        <p id="Par27">All the variants in a block are divided into two groups, i.e., the biallelic and the multiallelic groups. In the biallelic variants group, the order of the variant <inline-formula id="IEq38"><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{i}$$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq38.gif"/></alternatives></inline-formula> and the biallelic variant <inline-formula id="IEq39"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{j}$$\end{document}</tex-math><mml:math id="M88"><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq39.gif"/></alternatives></inline-formula> is defined as the dictionary order of <inline-formula id="IEq40"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{i}^{\left(l\right)}$$\end{document}</tex-math><mml:math id="M90"><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq40.gif"/></alternatives></inline-formula> and <inline-formula id="IEq41"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{j}^{\left(l\right)}$$\end{document}</tex-math><mml:math id="M92"><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq41.gif"/></alternatives></inline-formula>, which are described below:<list list-type="bullet"><list-item><p id="Par28">If <inline-formula id="IEq42"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\exists {k}_{0}\in \left[0,s-1\right], \forall k\in \left[0,{k}_{0}-1\right]$$\end{document}</tex-math><mml:math id="M94"><mml:mrow><mml:mo>∃</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close="]" open="["><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="]" open="["><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq42.gif"/></alternatives></inline-formula>, such that <inline-formula id="IEq43"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{i, {k}_{0}}^{\left(l\right)} &lt; {C}_{j, {k}_{0}}^{\left(l\right)}$$\end{document}</tex-math><mml:math id="M96"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq43.gif"/></alternatives></inline-formula>, <inline-formula id="IEq44"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{i, k}^{\left(l\right)}={C}_{j, k}^{\left(l\right)}$$\end{document}</tex-math><mml:math id="M98"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq44.gif"/></alternatives></inline-formula>, then <inline-formula id="IEq45"><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{i}&gt;{v}_{j}$$\end{document}</tex-math><mml:math id="M100"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq45.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par29">If <inline-formula id="IEq46"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\exists {k}_{0}\in \left[0,s-1\right], \forall k\in \left[0,{k}_{0}-1\right]$$\end{document}</tex-math><mml:math id="M102"><mml:mrow><mml:mo>∃</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>∈</mml:mo><mml:mfenced close="]" open="["><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>,</mml:mo><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="]" open="["><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq46.gif"/></alternatives></inline-formula>, such that <inline-formula id="IEq47"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{i, {k}_{0}}^{\left(l\right)}&gt; {C}_{j, {k}_{0}}^{\left(l\right)}$$\end{document}</tex-math><mml:math id="M104"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup><mml:mo>&gt;</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq47.gif"/></alternatives></inline-formula>, <inline-formula id="IEq48"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{i, k}^{\left(l\right)}={C}_{j, k}^{\left(l\right)}$$\end{document}</tex-math><mml:math id="M106"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq48.gif"/></alternatives></inline-formula>, then <inline-formula id="IEq49"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{i}&lt;{v}_{j}$$\end{document}</tex-math><mml:math id="M108"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq49.gif"/></alternatives></inline-formula>;</p></list-item><list-item><p id="Par30">If <inline-formula id="IEq50"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\forall k\in \left[0,s-1\right]$$\end{document}</tex-math><mml:math id="M110"><mml:mrow><mml:mo>∀</mml:mo><mml:mi>k</mml:mi><mml:mo>∈</mml:mo><mml:mfenced close="]" open="["><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq50.gif"/></alternatives></inline-formula>, such that <inline-formula id="IEq51"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${C}_{i, k}^{\left(l\right)}={C}_{j, k}^{\left(l\right)}$$\end{document}</tex-math><mml:math id="M112"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mfenced close=")" open="("><mml:mi>l</mml:mi></mml:mfenced></mml:msubsup></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq51.gif"/></alternatives></inline-formula>, then <inline-formula id="IEq52"><alternatives><tex-math id="M113">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{i}={v}_{j}$$\end{document}</tex-math><mml:math id="M114"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq52.gif"/></alternatives></inline-formula>.</p></list-item></list></p>
        <p id="Par31">On the contrary, the order will be inverted for multiallelic variants, which helps maximize the length of similar genotype vectors. Finally, the corresponding information of positions, alleles, and MBEGs for variants are sorted according to the ordered variants (<inline-formula id="IEq53"><alternatives><tex-math id="M115">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$I=[{m}_{0}, {m}_{1}, \cdots , {m}_{M-1}]$$\end{document}</tex-math><mml:math id="M116"><mml:mrow><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq53.gif"/></alternatives></inline-formula>).</p>
      </sec>
    </sec>
    <sec id="Sec16">
      <title>Merge data stream after compressing with advanced compressors</title>
      <p id="Par32">All the sorted MBEG and BEG codes in each block are further compressed by advanced compressors. Popular compression algorithms (e.g., Gzip, LZMA, and zlib) can achieve a compression ratio of 100 or more on genotypes. By default, we chose the ZSTD (short for Zstandard [<xref ref-type="bibr" rid="CR20">20</xref>], <ext-link ext-link-type="uri" xlink:href="https://github.com/facebook/zstd">https://github.com/facebook/zstd</ext-link>) because it provides the fastest speed with a similar compression ratio among the widely used compression algorithms. In detail, the byte codes of each variant are concatenated into a byte array <inline-formula id="IEq54"><alternatives><tex-math id="M117">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${B}_{1}$$\end{document}</tex-math><mml:math id="M118"><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq54.gif"/></alternatives></inline-formula> directly. Next, the position of each variant is converted into 4 bytes, and then all variants’ positions are concatenated into a byte array <inline-formula id="IEq55"><alternatives><tex-math id="M119">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${B}_{2}$$\end{document}</tex-math><mml:math id="M120"><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq55.gif"/></alternatives></inline-formula>. Finally, the alleles of all variants are concatenated into another byte array <inline-formula id="IEq56"><alternatives><tex-math id="M121">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${B}_{3}$$\end{document}</tex-math><mml:math id="M122"><mml:msub><mml:mi>B</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq56.gif"/></alternatives></inline-formula> with a “/” delimiter. Then, these concatenated data <inline-formula id="IEq57"><alternatives><tex-math id="M123">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${B}_{1}, {B}_{2}$$\end{document}</tex-math><mml:math id="M124"><mml:mrow><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq57.gif"/></alternatives></inline-formula> and <inline-formula id="IEq58"><alternatives><tex-math id="M125">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${B}_{3}$$\end{document}</tex-math><mml:math id="M126"><mml:msub><mml:mi>B</mml:mi><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq58.gif"/></alternatives></inline-formula> are compressed by the latest ZSTD to produce <inline-formula id="IEq59"><alternatives><tex-math id="M127">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{B}}_{1},{\widehat{B}}_{2}$$\end{document}</tex-math><mml:math id="M128"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq59.gif"/></alternatives></inline-formula> and <inline-formula id="IEq60"><alternatives><tex-math id="M129">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{B}}_{3}$$\end{document}</tex-math><mml:math id="M130"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq60.gif"/></alternatives></inline-formula>, respectively. The data entity is a long vector composed of three sections of compressed data, including encoded genotypes, positions, and alleles. Two types of information of each packed block, including abstract information and data entity, are subsequently written to the GTB file. The abstract information includes the chromosome number (1 byte), minimum and maximum positions (4 bytes each), number of biallelic variants (2 bytes each), number of multiallelic variants (2 bytes), length of <inline-formula id="IEq61"><alternatives><tex-math id="M131">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{B}}_{1}$$\end{document}</tex-math><mml:math id="M132"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq61.gif"/></alternatives></inline-formula> (4 bytes), length of <inline-formula id="IEq62"><alternatives><tex-math id="M133">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{B}}_{2}$$\end{document}</tex-math><mml:math id="M134"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq62.gif"/></alternatives></inline-formula> (3 bytes), length of <inline-formula id="IEq63"><alternatives><tex-math id="M135">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\widehat{B}}_{3}$$\end{document}</tex-math><mml:math id="M136"><mml:msub><mml:mover accent="true"><mml:mi>B</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mn>3</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq63.gif"/></alternatives></inline-formula> (4 bytes), and magic code (1 byte) in a block. For other fields at the variant level (e.g., ID, INFO, Genotype Metrics), they are concatenated and compressed in the same way, then stored in the optional fields (Fig. <xref rid="Fig1" ref-type="fig">1</xref>a).</p>
      <p id="Par33">GBC can be integrated with different compression algorithms. ZSTD and LZMA algorithms have been embedded to compress each genotype block. We also reserve two types of compressors for developers to extend in the future.</p>
    </sec>
    <sec id="Sec17">
      <title>Memory control benefits to the efficiency of GBC on large-scale data</title>
      <p id="Par34">Saving memory is critical for large-scale projects, determining whether a user can easily compress the genotype data on ordinary desktops or servers. GBC overcomes the high memory load in processing large-scale datasets through three strategies. First, it has sufficient reusable buffers (also called context structures). Once the buffers are created, they can be re-used throughout the whole process of the task. Second, it adaptively adjusts the variant counts per block. The number of variants (<inline-formula id="IEq64"><alternatives><tex-math id="M137">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M138"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq64.gif"/></alternatives></inline-formula>) contained in each block is set according to the subject size (<inline-formula id="IEq65"><alternatives><tex-math id="M139">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$M$$\end{document}</tex-math><mml:math id="M140"><mml:mi>M</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq65.gif"/></alternatives></inline-formula>) automatically, as a block can store <inline-formula id="IEq66"><alternatives><tex-math id="M141">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${2}^{31}-2$$\end{document}</tex-math><mml:math id="M142"><mml:mrow><mml:msup><mml:mrow><mml:mn>2</mml:mn></mml:mrow><mml:mn>31</mml:mn></mml:msup><mml:mo>-</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq66.gif"/></alternatives></inline-formula> genotypes (approximately 2 GB size) at most. Third, it estimates memory usage during compression. The memory required is estimated based on the compression boundary estimation model (see details below).</p>
      <p id="Par35">Supposing a byte array of length <inline-formula id="IEq67"><alternatives><tex-math id="M143">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$s$$\end{document}</tex-math><mml:math id="M144"><mml:mi>s</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq67.gif"/></alternatives></inline-formula>, whose original and estimated compressed sizes are <inline-formula id="IEq68"><alternatives><tex-math id="M145">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${R}_{s}$$\end{document}</tex-math><mml:math id="M146"><mml:msub><mml:mi>R</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq68.gif"/></alternatives></inline-formula> and <inline-formula id="IEq69"><alternatives><tex-math id="M147">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${E}_{s}$$\end{document}</tex-math><mml:math id="M148"><mml:msub><mml:mi>E</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq69.gif"/></alternatives></inline-formula> respectively. For small-scale data (length &lt; 4 kB), the file’s head information (e.g., hash code, magic code, etc.) is larger than the genotype data in the compressed data. Thus, we set a fixed upper boundary <inline-formula id="IEq70"><alternatives><tex-math id="M149">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M150"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq70.gif"/></alternatives></inline-formula>, which indicates the minimum memory required for compression. For large-scale data, the genotypes are the main part of the compressed data. Therefore, a good compression algorithm should ensure that the size of the compressed data will not exceed <inline-formula id="IEq71"><alternatives><tex-math id="M151">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha (&lt;\mathrm{inf })$$\end{document}</tex-math><mml:math id="M152"><mml:mrow><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mo>&lt;</mml:mo><mml:mi mathvariant="normal">inf</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq71.gif"/></alternatives></inline-formula> times of the original size. Here, the <inline-formula id="IEq72"><alternatives><tex-math id="M153">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha$$\end{document}</tex-math><mml:math id="M154"><mml:mi>α</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq72.gif"/></alternatives></inline-formula> is the main factor in the compression efficiency of large-scale data, which is estimated as:<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M155">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}{E}_{s}=\mathrm{max}\left\{\widehat{\alpha }\cdot s,\widehat{\beta }\right\}\end{array}$$\end{document}</tex-math><mml:math id="M156" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="normal">max</mml:mi><mml:mfenced close="}" open="{"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>·</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2906_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par36">In practice, we estimated <inline-formula id="IEq73"><alternatives><tex-math id="M157">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\alpha ,\beta$$\end{document}</tex-math><mml:math id="M158"><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq73.gif"/></alternatives></inline-formula> by large-scale random data simulation experiments as follows because the real values are unknown:<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M159">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\underset{\widehat{\alpha}, \widehat{\beta}}{\arg \min } \mathbb{I}\left(E_S&lt; R_S\right)+\hat{\alpha}+\frac{\hat{\beta}}{10 \times 1024^2}$$\end{document}</tex-math><mml:math id="M160" display="block"><mml:mrow><mml:munder><mml:mrow><mml:mo>arg</mml:mo><mml:mo movablelimits="true">min</mml:mo></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:mrow></mml:munder><mml:mi mathvariant="double-struck">I</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>E</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mfrac><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mrow><mml:mn>10</mml:mn><mml:mo>×</mml:mo><mml:msup><mml:mn>1024</mml:mn><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:math><graphic xlink:href="13059_2023_2906_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p>
      <p id="Par37">For large-scale data, <inline-formula id="IEq74"><alternatives><tex-math id="M161">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\beta$$\end{document}</tex-math><mml:math id="M162"><mml:mi>β</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq74.gif"/></alternatives></inline-formula> can often be omitted. Thus, we defined <inline-formula id="IEq75"><alternatives><tex-math id="M163">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\beta }=512, 1024, 1536,\cdots$$\end{document}</tex-math><mml:math id="M164"><mml:mrow><mml:mover accent="true"><mml:mi>β</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mn>512</mml:mn><mml:mo>,</mml:mo><mml:mn>1024</mml:mn><mml:mo>,</mml:mo><mml:mn>1536</mml:mn><mml:mo>,</mml:mo><mml:mo>⋯</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq75.gif"/></alternatives></inline-formula>, and the minimum <inline-formula id="IEq76"><alternatives><tex-math id="M165">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\widehat{\alpha }$$\end{document}</tex-math><mml:math id="M166"><mml:mover accent="true"><mml:mi>α</mml:mi><mml:mo stretchy="false">^</mml:mo></mml:mover></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq76.gif"/></alternatives></inline-formula> is obtained through grid search. By the estimation and calculation of our GBC, the compression boundary estimation model of ZSTD is <inline-formula id="IEq77"><alternatives><tex-math id="M167">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${E}_{s}^{\mathrm{ZSTD}}=\mathrm{max}\{1.0014\cdot s,7168\}$$\end{document}</tex-math><mml:math id="M168"><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mi mathvariant="normal">ZSTD</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">max</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1.0014</mml:mn><mml:mo>·</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mn>7168</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq77.gif"/></alternatives></inline-formula>, while LZMA is <inline-formula id="IEq78"><alternatives><tex-math id="M169">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${E}_{\mathrm{s}}^{\mathrm{LZMA}}=\mathrm{max}\{1.0167\cdot s, 7680\}$$\end{document}</tex-math><mml:math id="M170"><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mi mathvariant="normal">LZMA</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">max</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1.0167</mml:mn><mml:mo>·</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mn>7680</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq78.gif"/></alternatives></inline-formula>, and Gzip is <inline-formula id="IEq79"><alternatives><tex-math id="M171">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${E}_{\mathrm{s}}^{\mathrm{Gzip}}=\mathrm{max}\{1.0031\cdot s,7680\}.$$\end{document}</tex-math><mml:math id="M172"><mml:mrow><mml:msubsup><mml:mi>E</mml:mi><mml:mrow><mml:mi mathvariant="normal">s</mml:mi></mml:mrow><mml:mi mathvariant="normal">Gzip</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi mathvariant="normal">max</mml:mi><mml:mrow><mml:mo stretchy="false">{</mml:mo><mml:mn>1.0031</mml:mn><mml:mo>·</mml:mo><mml:mi>s</mml:mi><mml:mo>,</mml:mo><mml:mn>7680</mml:mn><mml:mo stretchy="false">}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq79.gif"/></alternatives></inline-formula> Among the three algorithms, ZSTD takes the least amount of time in boundary estimation, indicating that ZSTD has a fairly fast compression speed, which enables GBC to rapidly create GTB files for downstream analyses.</p>
      <sec id="Sec18">
        <title>Specify contig file to support non-human species genome compression</title>
        <p id="Par38">By default, GBC supports the genotype compression of human beings. It can also encode and compress genotypes of other haplotypic and diploid species. For non-human genomes, GBC only requires a different contig file(see Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Note 3) to declare the label of the assigned chromosome (e.g., chrX, chrY, chrMT) and its ploidy. A contig file has “#chromosome,ploidy,length” as the header line, and then each line represents one chromosome. The option “--contig &lt; file &gt; ” is used as parameter input when compressing. Since only 1 byte is reserved for storing chromosome numbers in GTB format, we require that the number of chromosomes in the input contig file does not exceed 256.</p>
      </sec>
      <sec id="Sec19">
        <title>Input multiple VCF files for compression</title>
        <p id="Par39">One or multiple VCF files can be merged into a single GTB file. For a single input file, GBC reads the file directly. For an input of multiple files, GBC first treats the file with the largest sample size as the major file and uses it to build the sample primary indexes. Other input files will be handled in turns after matching the sample indexes of the major file. In the matching process, the genotypes of missing subjects will be set as “.|.” subsequently to ensure that all the input files can be compressed together consistently in subsequent steps.</p>
      </sec>
    </sec>
    <sec id="Sec20">
      <title>Fast access and manage genotypes in the highly addressable GTB format</title>
      <sec id="Sec21">
        <title>Parse GTB file and create an index table for fast access</title>
        <p id="Par40">When one accesses or manages a GTB file, all data except the block entity data is instantly loaded into the memory to construct a GTBManager. The GTBManager contains subject information, meta information, the basic status of the GTB (e.g., block size, compressor parameters), and the GTBTree (an index table for fast access, built from block abstract information). Throughout the program’s lifetime, the GTBManager of the read-in GTB files is always in the cache, which helps speed up multiple accesses to the data from the same files.</p>
        <p id="Par41">Here is the creation process of GTBTree. First, a GTBNode is built from the abstract information and the range of entity positions of a block (calculated by accumulating original lengths of compressed positions, alleles, and genotypes data). Then, all GTBNodes of the same chromosome are grouped. Finally, the GTBNodes of all chromosomes are collected to form the GTBTree. Because the compressed blocks may be out of order, we sort the GTBTree according to the minimum and maximum positions of each block’s chromosome. Then, the address of a variant is determined jointly by three indexes: the GTB file’s ID (if multiple GTB datasets were input), GTBNode, and the index within the block. Therefore, searching for a variant with a given position can be done by looking up the GTBNode(s) based on the boundary coordinates of the blocks at first. Then, the candidate GTBNode(s) can decompress the position data to verify its location within a block. Noticeably, the index table enables fast data access even if the original file is out of order.</p>
      </sec>
      <sec id="Sec22">
        <title>The addressing algorithm to access location-specific genotypes</title>
        <p id="Par42">Accessing genotypes by column (i.e., subjects) is usually slower than by row (i.e., sites) because decompression involves all blocks. An addressing algorithm is developed to help quickly access a genotype from the MBEGs directly, which is implemented in two steps:</p>
        <sec id="Sec23">
          <title>Step 1: Locating the start pointer of the <inline-formula id="IEq80"><alternatives><tex-math id="M173">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M174"><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq80.gif"/></alternatives></inline-formula> variant</title>
          <p id="Par43">In the MBEGs of a decompressed GTB block <inline-formula id="IEq81"><alternatives><tex-math id="M175">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$i$$\end{document}</tex-math><mml:math id="M176"><mml:mi>i</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq81.gif"/></alternatives></inline-formula>, which contains <inline-formula id="IEq82"><alternatives><tex-math id="M177">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${b}_{i}^{\mathrm{biallelic}}$$\end{document}</tex-math><mml:math id="M178"><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi mathvariant="normal">biallelic</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq82.gif"/></alternatives></inline-formula> biallelic variants and <inline-formula id="IEq83"><alternatives><tex-math id="M179">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${b}_{i}^{\mathrm{multiallelic}}$$\end{document}</tex-math><mml:math id="M180"><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi mathvariant="normal">multiallelic</mml:mi></mml:msubsup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq83.gif"/></alternatives></inline-formula> multiallelic variants, the start pointer of the <inline-formula id="IEq84"><alternatives><tex-math id="M181">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M182"><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq84.gif"/></alternatives></inline-formula> variant in the MBEGs is calculated as:<disp-formula id="Equ8"><label>8</label><alternatives><tex-math id="M183">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}{P}_{m}=\left\{\begin{array}{ll}m\cdot \lceil\frac{N}{l}\rceil&amp;,m&lt;{b}_{i}^{\mathrm{biallelic}}\\ {b}_{i}^{\mathrm{biallelic}}\cdot \lceil\frac{N}{l}\rceil+\left(m-{b}_{i}^{\mathrm{biallelic}}\right)\cdot N &amp;,else\end{array}\right.\end{array}$$\end{document}</tex-math><mml:math id="M184" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced open="{"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>m</mml:mi><mml:mo>·</mml:mo><mml:mo>⌈</mml:mo><mml:mfrac><mml:mi>N</mml:mi><mml:mi>l</mml:mi></mml:mfrac><mml:mo>⌉</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>,</mml:mo><mml:mi>m</mml:mi><mml:mo>&lt;</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi mathvariant="normal">biallelic</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow/><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi mathvariant="normal">biallelic</mml:mi></mml:msubsup><mml:mo>·</mml:mo><mml:mrow><mml:mo>⌈</mml:mo><mml:mfrac><mml:mi>N</mml:mi><mml:mi>l</mml:mi></mml:mfrac><mml:mo>⌉</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mi>m</mml:mi><mml:mo>-</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi mathvariant="normal">biallelic</mml:mi></mml:msubsup></mml:mfenced><mml:mo>·</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>,</mml:mo><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>s</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2906_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq85"><alternatives><tex-math id="M185">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l$$\end{document}</tex-math><mml:math id="M186"><mml:mi>l</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq85.gif"/></alternatives></inline-formula> is determined by the state of genotypes (phased: <inline-formula id="IEq86"><alternatives><tex-math id="M187">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l=3$$\end{document}</tex-math><mml:math id="M188"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>3</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq86.gif"/></alternatives></inline-formula>; unphased: <inline-formula id="IEq87"><alternatives><tex-math id="M189">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$l=4$$\end{document}</tex-math><mml:math id="M190"><mml:mrow><mml:mi>l</mml:mi><mml:mo>=</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq87.gif"/></alternatives></inline-formula>), and <inline-formula id="IEq88"><alternatives><tex-math id="M191">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$N$$\end{document}</tex-math><mml:math id="M192"><mml:mi>N</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq88.gif"/></alternatives></inline-formula> is the number of subjects.</p>
          <p id="Par44">The address of the <inline-formula id="IEq89"><alternatives><tex-math id="M193">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M194"><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq89.gif"/></alternatives></inline-formula> subject in the multiallelic encoding sequence is <inline-formula id="IEq90"><alternatives><tex-math id="M195">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M196"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq90.gif"/></alternatives></inline-formula>, whereas in the biallelic encoding sequence, which is retrieved by triples (index, groupIndex, codeIndex), where:<list list-type="bullet"><list-item><p id="Par45">• index: The index of the <inline-formula id="IEq91"><alternatives><tex-math id="M197">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M198"><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq91.gif"/></alternatives></inline-formula> subject in the GTB subject information, that is <inline-formula id="IEq92"><alternatives><tex-math id="M199">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M200"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq92.gif"/></alternatives></inline-formula>.</p></list-item><list-item><p id="Par46">• groupIndex: The index of the MBEG code containing the genotype of <inline-formula id="IEq93"><alternatives><tex-math id="M201">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M202"><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq93.gif"/></alternatives></inline-formula> subject in the whole encoding sequence, calculated as ⎣<italic>n/l</italic>⎦.</p></list-item><list-item><p id="Par47">• codeIndex: The index of the <inline-formula id="IEq94"><alternatives><tex-math id="M203">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M204"><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq94.gif"/></alternatives></inline-formula> subject in the MBEG code containing the genotype of <inline-formula id="IEq95"><alternatives><tex-math id="M205">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M206"><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq95.gif"/></alternatives></inline-formula> subject, calculated as <inline-formula id="IEq96"><alternatives><tex-math id="M207">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n \% l$$\end{document}</tex-math><mml:math id="M208"><mml:mrow><mml:mi>n</mml:mi><mml:mo>%</mml:mo><mml:mi>l</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq96.gif"/></alternatives></inline-formula>.</p></list-item></list></p>
        </sec>
        <sec id="Sec24">
          <title>Step 2: Decoding the genotype of the <inline-formula id="IEq97"><alternatives><tex-math id="M209">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M210"><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq97.gif"/></alternatives></inline-formula> subject</title>
          <p id="Par48">The biallelic genotype for the <inline-formula id="IEq98"><alternatives><tex-math id="M211">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M212"><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq98.gif"/></alternatives></inline-formula> variant of the <inline-formula id="IEq99"><alternatives><tex-math id="M213">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M214"><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq99.gif"/></alternatives></inline-formula> subject is stored in the <inline-formula id="IEq100"><alternatives><tex-math id="M215">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}{\mathrm{codeIndex}}^{\mathrm{th}}\end{array}$$\end{document}</tex-math><mml:math id="M216"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mi mathvariant="normal">codeIndex</mml:mi></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq100.gif"/></alternatives></inline-formula> BEG of the <inline-formula id="IEq101"><alternatives><tex-math id="M217">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left({P}_{m}+\begin{array}{c}\text{groupIndex}\end{array}\right)}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M218"><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>groupIndex</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mfenced></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq101.gif"/></alternatives></inline-formula>
<inline-formula id="IEq102"><alternatives><tex-math id="M219">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{MBEG}$$\end{document}</tex-math><mml:math id="M220"><mml:mi mathvariant="normal">MBEG</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq102.gif"/></alternatives></inline-formula>, and the multiallelic genotype for the <inline-formula id="IEq103"><alternatives><tex-math id="M221">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${m}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M222"><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq103.gif"/></alternatives></inline-formula> variant of the <inline-formula id="IEq104"><alternatives><tex-math id="M223">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${n}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M224"><mml:msup><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq104.gif"/></alternatives></inline-formula> subject is stored in the <inline-formula id="IEq105"><alternatives><tex-math id="M225">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${\left({P}_{m} + n\right)}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M226"><mml:msup><mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mi>P</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>n</mml:mi></mml:mfenced></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq105.gif"/></alternatives></inline-formula> BEG.</p>
        </sec>
      </sec>
      <sec id="Sec25">
        <title>The I/O optimized parallel framework for reading through GTB</title>
        <p id="Par49">While compression based on the GTB structure can facilitate parallel computing, the common bottleneck (often neglected) is disk I/O. Hard disks can have high bandwidth when reading or writing sequentially, but the addressing time (latency) is expensive. In many cases, multiple threads will not fasten the disk I/O and even make it worse (e.g., reading/writing a single 4-GB file to disk is much faster than multiple files with a total size of 4 GB). Based on the GTB structure, we used the producer/consumer model to coordinate the reading threads in GBC (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1a). The producer is responsible for mapping the requested variants onto GTB nodes and then adding involved GTB nodes into a task queue (a thread-safe collection in which multiple threads are added and data are updated concurrently). The consumers are the threads that read the tasks from the task queue, then load block entity data separately from the file and process the data (e.g., decompression). The model enables GBC to speed up analyses in two ways. First, the threads can be started before users process the file, which saves the time overhead of threads creating and recycling. Second, users can instantiate multiple consumers (i.e., number of threads) if the mapping speed of the producer is faster than the processing speed of the consumer(s). In addition, because the GTB structure packs genotypes of multiple variants into one block with remarkable compression ratios, it requires fewer I/O requests when retrieving multiple variants through multiple reading threads.</p>
      </sec>
      <sec id="Sec26">
        <title>The cyclic locking model-based parallel algorithms to optimize decompression</title>
        <p id="Par50">Computing large-scale genotype data (such as decompression and LD calculation) often generates significant output data using multiple threads. Maintaining the order of the output data is a critical issue for massively parallel processing. The most common way to keep the order is using temporary files to store data and finally splice them into a single file. However, it usually takes up extra space and extra I/O costs, affecting the efficiency of parallel computing. Therefore, we propose an algorithm for parallel output and derive a theory for optimization.</p>
        <p id="Par51">The order problem in multiple threads is solved by a cyclic locking model (CLM, see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1b and Fig. S1c) for decompression in which the current thread holds the lock of the next thread sequentially. When a reusable thread finishes decompression, it stays in memory to wait to write genotypes into disks until the previous thread has released its lock. The thread releases the lock of the next thread once it finishes writing the current data to disk. In detail, in a parallel decompression process with <italic>t</italic> threads, thread#0 holds the lock of thread#1, thread#1 holds the lock of thread#2, …, and thread#(<inline-formula id="IEq106"><alternatives><tex-math id="M227">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$t-1$$\end{document}</tex-math><mml:math id="M228"><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq106.gif"/></alternatives></inline-formula>) holds the lock of thread#0. Only the lock of thread#0 is released at the beginning of decompression. Any other thread cannot write to the disk because their previous threads do not release the lock. After thread#0 finishes the writing, it releases the lock of thread#1. The program continues this loop to decompress all the data. Therefore, CLM ensures that the decompressed data are output in the order of the GTB nodes.</p>
        <p id="Par52">It is known that the actual efficiency of parallelism usually depends on the device’s computing resources (such as memory, CPU cores, CPU clock speed, and I/O speed). Here, we estimate the theoretical processing time of parallel computation for CLM to derive an optimal number of threads. Assume that the source file (the file size is <inline-formula id="IEq107"><alternatives><tex-math id="M229">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S$$\end{document}</tex-math><mml:math id="M230"><mml:mi>S</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq107.gif"/></alternatives></inline-formula>) is split into <inline-formula id="IEq108"><alternatives><tex-math id="M231">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M232"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq108.gif"/></alternatives></inline-formula> tasks with approximately the same time overhead (the <inline-formula id="IEq109"><alternatives><tex-math id="M233">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M234"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq109.gif"/></alternatives></inline-formula> depends on the available memory). Denote the average output time of each task as <inline-formula id="IEq110"><alternatives><tex-math id="M235">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{\mathrm{o}}$$\end{document}</tex-math><mml:math id="M236"><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq110.gif"/></alternatives></inline-formula>, and the average processing time as <inline-formula id="IEq111"><alternatives><tex-math id="M237">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{\mathrm{p}}$$\end{document}</tex-math><mml:math id="M238"><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq111.gif"/></alternatives></inline-formula>. The time required to complete the task under <italic>n</italic> threads in parallel can be calculated as:<disp-formula id="Equ9"><label>9</label><alternatives><tex-math id="M239">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}t_{\mathrm{total}}^n=\lceil\frac kn\rceil\left(t_{\mathrm o}+t_{\mathrm p}\right)+\left(\left(k-1\right)\mod\;n\right)t_{\mathrm o}+\max\left\{\left(\left(n-1\right)t_{\mathrm o}-t_{\mathrm p}\right),0\right\}\left(\lceil\frac kn\rceil-1\right)+knt_\varepsilon\end{array}$$\end{document}</tex-math><mml:math id="M240" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">total</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>⌈</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:mfrac><mml:mo>⌉</mml:mo></mml:mrow><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mfenced close=")" open="("><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mspace width="3.33333pt"/><mml:mo>mod</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mi>n</mml:mi></mml:mfenced><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mo movablelimits="true">max</mml:mo><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="("><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mfenced><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mfenced><mml:mfenced close=")" open="("><mml:mo>⌈</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:mfrac><mml:mo>⌉</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mi>n</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>ε</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2906_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq112"><alternatives><tex-math id="M241">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{\varepsilon }$$\end{document}</tex-math><mml:math id="M242"><mml:msub><mml:mi>t</mml:mi><mml:mi>ε</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq112.gif"/></alternatives></inline-formula> is the time cost of thread switching (unavoidable); <inline-formula id="IEq113"><alternatives><tex-math id="M243">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{\mathrm{o}}$$\end{document}</tex-math><mml:math id="M244"><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq113.gif"/></alternatives></inline-formula> and <inline-formula id="IEq114"><alternatives><tex-math id="M245">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{\mathrm{p}}$$\end{document}</tex-math><mml:math id="M246"><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq114.gif"/></alternatives></inline-formula> depend on <inline-formula id="IEq115"><alternatives><tex-math id="M247">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M248"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq115.gif"/></alternatives></inline-formula> and the processing speed of the device. Thus, we can replace <inline-formula id="IEq116"><alternatives><tex-math id="M249">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{\mathrm{o}}=\frac{1}{{v}_{\mathrm{o}}}\cdot \frac{S}{k}$$\end{document}</tex-math><mml:math id="M250"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub></mml:mfrac><mml:mo>·</mml:mo><mml:mfrac><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq116.gif"/></alternatives></inline-formula> and <inline-formula id="IEq117"><alternatives><tex-math id="M251">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${t}_{\mathrm{p}}=\frac{1}{{v}_{\mathrm{p}}}\cdot \frac{S}{k}$$\end{document}</tex-math><mml:math id="M252"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mfrac><mml:mo>·</mml:mo><mml:mfrac><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:mfrac></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq117.gif"/></alternatives></inline-formula> in the above equation:<disp-formula id="Equ10"><label>10</label><alternatives><tex-math id="M253">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}t_{\mathrm{total}}^n=\lceil\frac kn\rceil\left(\frac1{v_{\mathrm o}}+\frac1{v_{\mathrm p}}\right)\frac Sk+\left(\left(k-1\right)\mod\;n\right)\frac S{kv_{\mathrm o}}+\max\left\{\left(\frac{\left(n-1\right)S}{{kv}_{\mathrm o}}-\frac S{{kv}_{\mathrm p}}\right),0\right\}\left(\lceil\frac kn\rceil-1\right)+knt_\varepsilon\end{array}$$\end{document}</tex-math><mml:math id="M254" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">total</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>⌈</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:mfrac><mml:mo>⌉</mml:mo></mml:mrow><mml:mfenced close=")" open="("><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mfrac><mml:mi>S</mml:mi><mml:mi>k</mml:mi></mml:mfrac><mml:mo>+</mml:mo><mml:mfenced close=")" open="("><mml:mfenced close=")" open="("><mml:mi>k</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mspace width="3.33333pt"/><mml:mo>mod</mml:mo><mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mi>n</mml:mi></mml:mfenced><mml:mfrac><mml:mi>S</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:msub><mml:mi>v</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mo movablelimits="true">max</mml:mo><mml:mfenced close="}" open="{"><mml:mfenced close=")" open="("><mml:mfrac><mml:mrow><mml:mfenced close=")" open="("><mml:mi>n</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mi>S</mml:mi></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="italic">kv</mml:mi></mml:mrow><mml:mi mathvariant="normal">o</mml:mi></mml:msub></mml:mfrac><mml:mo>-</mml:mo><mml:mfrac><mml:mi>S</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="italic">kv</mml:mi></mml:mrow><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo><mml:mn>0</mml:mn></mml:mfenced><mml:mfenced close=")" open="("><mml:mo>⌈</mml:mo><mml:mfrac><mml:mi>k</mml:mi><mml:mi>n</mml:mi></mml:mfrac><mml:mo>⌉</mml:mo><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mfenced><mml:mo>+</mml:mo><mml:mi>k</mml:mi><mml:mi>n</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>ε</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2906_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par53">Here, <inline-formula id="IEq118"><alternatives><tex-math id="M255">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{o}$$\end{document}</tex-math><mml:math id="M256"><mml:msub><mml:mi>v</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq118.gif"/></alternatives></inline-formula> and <inline-formula id="IEq119"><alternatives><tex-math id="M257">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${v}_{p}$$\end{document}</tex-math><mml:math id="M258"><mml:msub><mml:mi>v</mml:mi><mml:mi>p</mml:mi></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq119.gif"/></alternatives></inline-formula> denotes the output speed and computation speed when processing unit files (<inline-formula id="IEq120"><alternatives><tex-math id="M259">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$S/k$$\end{document}</tex-math><mml:math id="M260"><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy="false">/</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq120.gif"/></alternatives></inline-formula>), and they can be estimated by the parameters of the benchmark device. Next, we use the overall efficiency of multi-threading to measure the benefits of multi-threading as:<disp-formula id="Equ11"><label>11</label><alternatives><tex-math id="M261">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\begin{array}{c}{E}_{n}=\frac{k\left({t}_{\mathrm{o}}+{t}_{\mathrm{p}}\right)}{{t}_{\mathrm{total}}^{n}}\end{array}$$\end{document}</tex-math><mml:math id="M262" display="block"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>k</mml:mi><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub></mml:mfenced></mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi mathvariant="normal">total</mml:mi></mml:mrow><mml:mi>n</mml:mi></mml:msubsup></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math><graphic xlink:href="13059_2023_2906_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula></p>
        <p id="Par54">Generally, the parallelism will be efficient when <inline-formula id="IEq121"><alternatives><tex-math id="M263">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n\in N=\left\{n|n\le \lceil\frac{{t}_{\mathrm{p}}}{{t}_{\mathrm{o}}}\rceil+1\right\}$$\end{document}</tex-math><mml:math id="M264"><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{"><mml:mi>n</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>n</mml:mi><mml:mo>≤</mml:mo><mml:mo>⌈</mml:mo><mml:mfrac><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">p</mml:mi></mml:msub><mml:msub><mml:mi>t</mml:mi><mml:mi mathvariant="normal">o</mml:mi></mml:msub></mml:mfrac><mml:mo>⌉</mml:mo><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mfenced></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq121.gif"/></alternatives></inline-formula>, while it is inefficient when <inline-formula id="IEq122"><alternatives><tex-math id="M265">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n&gt;\mathrm{max}N$$\end{document}</tex-math><mml:math id="M266"><mml:mrow><mml:mi>n</mml:mi><mml:mo>&gt;</mml:mo><mml:mi mathvariant="normal">max</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq122.gif"/></alternatives></inline-formula>. Being inefficient means that thread switching and resource contention will increase time overhead. We showed multiple cases in Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1b and Fig. S1c and in Additional file <xref rid="MOESM3" ref-type="media">3</xref> (I/O intensive task and computing-intensive task). The result indicated that the CLM algorithm is efficient for all parallel computing scenarios that require output data because <inline-formula id="IEq123"><alternatives><tex-math id="M267">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\mathrm{max}N\ge 2$$\end{document}</tex-math><mml:math id="M268"><mml:mrow><mml:mi mathvariant="normal">max</mml:mi><mml:mi>N</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq123.gif"/></alternatives></inline-formula> (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S1d ~ Fig. S1g). Therefore, given the memory and CPU cores, the CLM theoretical estimation can help find the best file-splitting task number (<inline-formula id="IEq124"><alternatives><tex-math id="M269">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$k$$\end{document}</tex-math><mml:math id="M270"><mml:mi>k</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq124.gif"/></alternatives></inline-formula>) and thread number <inline-formula id="IEq125"><alternatives><tex-math id="M271">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$n$$\end{document}</tex-math><mml:math id="M272"><mml:mi>n</mml:mi></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq125.gif"/></alternatives></inline-formula> on a device.</p>
        <p id="Par55">In addition, because the slow disk I/O speed will limit the ability of the parallel decompression algorithm, GBC also provides a way to directly decompress the data to BGZ format. Based on CLM, we have also developed a Java version of the parallel-bgzip compression algorithm, which has now been integrated into GBC as an auxiliary function.</p>
      </sec>
      <sec id="Sec27">
        <title>Sort GTB by variants’ coordinates using a two-level index table</title>
        <p id="Par56">Large-scale genotype files (number of subjects and sites) are difficult to load into memory for directly sorting by variants’ coordinates. It is typical to use the temporary disk/memory space for sorting (e.g., BCFtools). In detail, the whole file is split into several chunks, and each chunk is sorted separately before being combined. However, BCFTools cannot sort very large datasets (e.g., VCF with 100,000 subjects and 1,000,000 variants) in 64 GB of memory. Thus, We propose a novel GTB-based sorting method to direct sort arbitrary scale genotype files within 4 GB of memory. The following is the sorting procedure on a chromosome (see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2a):<disp-quote><p id="Par57"><italic>Step 1</italic>: Construct a two-level index table of variants within the chromosome. The index table contains the positions and indexes of variants (chromosome position, GTBNode index, index within the block).</p><p id="Par58"><italic>Step 2</italic>: Sort the index table by position.</p><p id="Par59"><italic>Step 3</italic>: Move consecutive variants into a new GTB (balanced with the sample size) and sort the variants within the new block according to the GTBNode Index.</p><p id="Par60"><italic>Step 4</italic>: The old blocks are decompressed sequentially by GBC, and the genotype data are expanded into BEGs by order of the variants in the new block.</p><p id="Par61"><italic>Step 5</italic>: Perform compression (see the procedure in Fig. <xref rid="Fig2" ref-type="fig">2</xref>c~f) when all the genotypes of a new block have been added.</p></disp-quote></p>
        <p id="Par62">The purpose of sorting GTBNode Index (i.e., step 3) is to ensure that each old block will be decompressed at most once in the new block. The required memory is only equal to the size of each block because all threads share a single decompressor. We have shown that this algorithm makes the GBC 3 ~ 9 times faster (the “<xref rid="Sec2" ref-type="sec">Results</xref>” section) than BCFtools under a single thread with no requirement for external disk space. Furthermore, the independence among the GTBs makes parallel sorting possible.</p>
      </sec>
      <sec id="Sec28">
        <title>Merge multiple GTBs and identify inconsistent allele labels</title>
        <p id="Par63">Merging multiple genotype files is performed by recursively merging two files in a queue of length <inline-formula id="IEq126"><alternatives><tex-math id="M273">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L (L\ge 2)$$\end{document}</tex-math><mml:math id="M274"><mml:mrow><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>L</mml:mi><mml:mo>≥</mml:mo><mml:mn>2</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq126.gif"/></alternatives></inline-formula>. A file that is merged at the <inline-formula id="IEq127"><alternatives><tex-math id="M275">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${i}^{\mathrm{th}}$$\end{document}</tex-math><mml:math id="M276"><mml:msup><mml:mrow><mml:mi>i</mml:mi></mml:mrow><mml:mi mathvariant="normal">th</mml:mi></mml:msup></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq127.gif"/></alternatives></inline-formula> time is decompressed and recompressed <inline-formula id="IEq128"><alternatives><tex-math id="M277">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$L-i$$\end{document}</tex-math><mml:math id="M278"><mml:mrow><mml:mi>L</mml:mi><mml:mo>-</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq128.gif"/></alternatives></inline-formula> times. Thus, files containing more subjects should be placed at the back of the queue whenever possible. The minimum heap is used to optimize the merging process, and the node weights are the number of subjects in the file. The two files with the smallest weights in a heap are merged at first, and the merged file is added to the minimal heap. The process is repeated until only one file remains in the minimum heap (e.g., see Additional file <xref rid="MOESM2" ref-type="media">2</xref>: Fig. S2b).</p>
        <p id="Par64">The labeling of mismatched alleles can become a critical issue when merging genotypes from different batches. Therefore, GBC designs three functions to identify inconsistent allele labels:<list list-type="bullet"><list-item><p id="Par65">Check for allele frequency: the difference between the allele frequency of variant 1 and the allele frequency of variant 2 is less than the threshold (i.e., <inline-formula id="IEq129"><alternatives><tex-math id="M279">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$\left|{\mathrm{AF}}_{1}-{\mathrm{AF}}_{2}\right|&lt;0.1$$\end{document}</tex-math><mml:math id="M280"><mml:mrow><mml:mfenced close="|" open="|"><mml:msub><mml:mi mathvariant="normal">AF</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>-</mml:mo><mml:msub><mml:mi mathvariant="normal">AF</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mfenced><mml:mo>&lt;</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq129.gif"/></alternatives></inline-formula>). This will work for variants with minor allele frequencies much less than 0.5.</p></list-item><list-item><p id="Par66">Check for allele count: 2 × 2 column tables are constructed using the number of reference alleles at a variant of two batches to be merged. The chi-square tests are performed. If the hypothesis test rejects the <inline-formula id="IEq130"><alternatives><tex-math id="M281">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$${H}_{0}$$\end{document}</tex-math><mml:math id="M282"><mml:msub><mml:mi>H</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="13059_2023_2906_Article_IEq130.gif"/></alternatives></inline-formula> hypothesis (i.e., the allele frequencies of the two variants are identical), then the variants in different batches cannot be considered potentially identical. Note that this will not be suitable for the scenario in that the two batches are used for cases and controls, respectively.</p></list-item><list-item><p id="Par67">Check for LD pattern: we first collect nearby variants of a given variant in which the absolute value of the genotypic correlation is over a threshold (say, 0.8) in two batches separately. Then, the positive signs of the correlation coefficients are counted in the two batches. If the numbers of signs are very different between the two batches, the allele labels should be flipped; otherwise, the allele labels are not flipped. This function can be used for variants with minor allele frequencies close to 0.5.</p></list-item></list></p>
      </sec>
      <sec id="Sec29">
        <title>Evaluation and comparison</title>
        <p id="Par68">Three publicly available datasets were used for performance testing in this study, 1000GP3 [<xref ref-type="bibr" rid="CR21">21</xref>], SG10K [<xref ref-type="bibr" rid="CR14">14</xref>], and UKBB [<xref ref-type="bibr" rid="CR3">3</xref>]. Besides, simulated datasets with various sample sizes (see Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Note 2 and Additional file <xref rid="MOESM1" ref-type="media">1</xref>: Table S1) were also used to investigate the tools’ speed systematically. Note that the execution (compression, decompression, access) time is usually positively correlated with the scale of data. We excluded the non-genotype data in the VCF format to make a fair comparison. The compression ratio and speed of genotypes in phased and unphased were similar. So, in large-scale datasets like UKBB, we only tested each data set in one phasing state (phased or unphased).</p>
        <p id="Par69">We mainly compared GBC with PBWT [<xref ref-type="bibr" rid="CR9">9</xref>], BGT [<xref ref-type="bibr" rid="CR10">10</xref>], and GTC [<xref ref-type="bibr" rid="CR12">12</xref>] because they were designed for a similar purpose to GBC—compressing genotypes into a fast-accessible format. GBC does not aim to exclusively achieve the highest compression ratio but an efficiently accessible compression. These tools have had different genotype formats, and “compression” refers to the conversion of genotypes to the formats designed by these tools. Another well-known tool, GQT [<xref ref-type="bibr" rid="CR11">11</xref>], was excluded from the comparison tools due to its poor compression performance and inability to retrieve the specified variant and subject [<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR22">22</xref>]. Besides, we also excluded SeqArray [<xref ref-type="bibr" rid="CR22">22</xref>] and GTRAC [<xref ref-type="bibr" rid="CR23">23</xref>] from the list of comparison tools because SeqArray [<xref ref-type="bibr" rid="CR22">22</xref>] is an R Library that does not provide standard command-line tools, and the output format of GTRAC [<xref ref-type="bibr" rid="CR23">23</xref>] does not contain the standard VCF format. BCFTools [<xref ref-type="bibr" rid="CR8">8</xref>], a popular method for fast accessing genotypes, is included in our comparison tool list. Although some latest studies argued that the access performance of BCFTools is poor [<xref ref-type="bibr" rid="CR10">10</xref>–<xref ref-type="bibr" rid="CR12">12</xref>], it offers almost the most comprehensive genotype management functions by far (which other tools do not have). Finally, GTShark [<xref ref-type="bibr" rid="CR5">5</xref>] and Genozip [<xref ref-type="bibr" rid="CR6">6</xref>], which provide a high compression ratio for genotype archiving, were also used to demonstrate the performance difference between fast-accessing and data-archiving methods. The versions and operating parameters of all software are shown in Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Note 4.</p>
        <p id="Par70">The evaluation metrics for comparing basic compression performance include compression ratio, compression speed, and decompression speed with different sample sizes. For the comparison of accessing the compressed genotypes, the evaluation metrics included the speed of subject extraction and variant extraction (accessing random and contiguous variants, filtering by allele frequency). Then, for the performance of managing files, both GBC and BCFtools were used for compressed datasets, which avoided the interference of decompression and re-compression. Finally, GBC was compared with PLINK for the time overhead of population LD computation. Since both tools used bitwise operations, the time overhead of LD computation was linearly related to the sample size, which meaned that the performance in small-scale data can approximate the performance difference of LD computation in any sample scale.</p>
      </sec>
    </sec>
    <sec id="Sec30">
      <title>Additional information</title>
      <sec id="Sec31">
        <title>System requirements</title>
        <p id="Par71">GBC was developed based on Oracle JDK 8. It is available on any computer device that supports or is compatible with Oracle JDK 8. Users are required to download and install the Oracle JDK or Open JDK firstly.</p>
      </sec>
      <sec id="Sec32">
        <title>Computing environment</title>
        <p id="Par72">Experiments for UKBB datasets were run on the following configuration: 106 GB memory, Intel(R) Xeon(R) CPU X5560 @ 2.80 GHz 16 cores, and an SSD with sequential write speeds of up to 111 MB/s and sequential read speeds of up to 115 MB/s. All Other experiments were run on the following configuration: 32 GB 2933 MHz DDR4, Intel Core i7-10,700 2.9 GHz 8 cores, and a NvMe SSD with sequential write speeds of up to 1950 MB/s and sequential read speeds of up to 2400 MB/s.</p>
      </sec>
    </sec>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Information</title>
    <sec id="Sec33">
      <p>
        <supplementary-material content-type="local-data" id="MOESM1">
          <media xlink:href="13059_2023_2906_MOESM1_ESM.xlsx">
            <caption>
              <p><bold>Additional file 1: Table S1.</bold> The basic compression performance comparison between GBC and alternative tools. <bold>Table S2.</bold> The comparison of GBC’s compression and decompression speed under multiple threads in the 1000GP3 dataset. <bold>Table S3.</bold> The data query performance comparison between GBC and alternative tools. <bold>Table S4.</bold> The comparison of LD calculation speed between GBC and alternative tools in the 1000GP3 and SG10K datasets. <bold>Table S5.</bold> The file management performance comparison between GBC and alternative tools. <bold>Table S6.</bold> BEG and MBEG coding tables for genotypes of diploid species.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM2">
          <media xlink:href="13059_2023_2906_MOESM2_ESM.docx">
            <caption>
              <p><bold>Additional file 2: Fig. S1.</bold> Using CLM algorithm to achieve ordered output during parallel computation of large-scale data. <bold>Fig. S2.</bold> Optimized file management (sorting and merging) based on GTB.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM3">
          <media xlink:href="13059_2023_2906_MOESM3_ESM.docx">
            <caption>
              <p><bold>Additional file 3: Note 1.</bold> A detailed description of GTB file. <bold>Note 2.</bold> The generation method of simulation genotypes. <bold>Note 3.</bold> The format of the contig file. <bold>Note 4.</bold> Examined programs.</p>
            </caption>
          </media>
        </supplementary-material>
        <supplementary-material content-type="local-data" id="MOESM4">
          <media xlink:href="13059_2023_2906_MOESM4_ESM.docx">
            <caption>
              <p><bold>Additional file 4.</bold> Review history.</p>
            </caption>
          </media>
        </supplementary-material>
      </p>
    </sec>
  </sec>
</body>
<back>
  <fn-group>
    <fn>
      <p>
        <bold>Publisher's Note</bold>
      </p>
      <p>Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.</p>
    </fn>
  </fn-group>
  <ack>
    <title>Acknowledgements</title>
    <p>Not applicable.</p>
    <sec id="FPar3">
      <title>Peer review information</title>
      <p id="Par73">Anahita Bishop and Stephanie McClelland were the primary editors of this article and managed its editorial process and peer review in collaborati3.on with the rest of the editorial team.</p>
    </sec>
    <sec id="FPar4">
      <title>Review history</title>
      <p id="Par74">The review history is available as Additional file <xref rid="MOESM4" ref-type="media">4</xref>.</p>
    </sec>
    <sec id="FPar5">
      <title>Availability of code and software</title>
      <p id="Par75">All the algorithms presented in the paper have been effectively implemented in Java, and the source code for the GBC (v1.2, the version for publication) [<xref ref-type="bibr" rid="CR24">24</xref>] can be publicly accessed on Zenodo (10.5281/zenodo.7737556) under a BSD 3-Clause License. Additionally, the latest GBC software package, equipped with API functions and a user manual, is freely available to the public at https://pmglab.top/gbc and can be conveniently integrated into various tools and sequencing projects.</p>
    </sec>
  </ack>
  <notes notes-type="author-contribution">
    <title>Authors’ contributions</title>
    <p>M. L. and L. Z. conceived this project. M. L. supervised this research and provided hardware support. M. L., L. Z., and Y. Y. designed the detailed implementations. L. Z., W. P., and B. T. developed and optimized the java code of GBC. L. Z., J. L., H. G., and Q. W. conducted the experiments. M. L. and L. Z. directed the experiments and data analysis. L. Z. and Y. Y. wrote the user manual of GBC. M. L., L. Z., and Y. Y. wrote the manuscript. All authors read and provided feedback on the final manuscript.</p>
  </notes>
  <notes notes-type="funding-information">
    <title>Funding</title>
    <p>This work was funded by the National Natural Science Foundation of China (31970650 and 32170637), National Key R&amp;D Program of China (2018YFC0910500), Science and Technology Program of Guangzhou (201803010116), and Guangdong Project (2017GC010644).</p>
  </notes>
  <notes notes-type="data-availability">
    <title>Availability of data and materials</title>
    <p>In this study, partial genotype data from the UK Biobank was accessed through a collaboration with applications no.86920. Data are available for bona fide researchers upon application to the UK Biobank, and the high-coverage whole-genome sequencing data of SG10K is available on <ext-link ext-link-type="uri" xlink:href="https://ega-archive.org">https://ega-archive.org</ext-link> with accession number EGAS00001003875 (14). The 1000GP3 dataset (22) in this paper is shown in <ext-link ext-link-type="uri" xlink:href="https://pmglab.top/genotypes">https://pmglab.top/genotypes</ext-link> (dataset is also available on the FTP site at <ext-link ext-link-type="uri" xlink:href="http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/">http://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/</ext-link>), which do not require access rights. Lastly, all simulation data used in this study were generated using the method described in Additional file <xref rid="MOESM3" ref-type="media">3</xref>: Note 2, and this method has been implemented in the VCFGenerator.java, which is available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.7737556">https://doi.org/10.5281/zenodo.7737556</ext-link>.</p>
  </notes>
  <notes>
    <title>Declarations</title>
    <notes id="FPar6">
      <title>Ethics approval and consent to participate</title>
      <p id="Par76">Not applicable.</p>
    </notes>
    <notes id="FPar7">
      <title>Consent for publication</title>
      <p id="Par77">Not applicable.</p>
    </notes>
    <notes id="FPar8" notes-type="COI-statement">
      <title>Competing interests</title>
      <p id="Par78">The authors declare that they have no competing interests.</p>
    </notes>
  </notes>
  <ref-list id="Bib1">
    <title>References</title>
    <ref id="CR1">
      <label>1.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danecek</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The variant call format and VCFtools</article-title>
        <source>Bioinformatics</source>
        <year>2011</year>
        <volume>27</volume>
        <issue>15</issue>
        <fpage>2156</fpage>
        <lpage>2158</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btr330</pub-id>
        <?supplied-pmid 21653522?>
        <pub-id pub-id-type="pmid">21653522</pub-id>
      </element-citation>
    </ref>
    <ref id="CR2">
      <label>2.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Purcell</surname>
            <given-names>S</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PLINK: a tool set for whole-genome association and population-based linkage analyses</article-title>
        <source>Am J Hum Genet</source>
        <year>2007</year>
        <volume>81</volume>
        <issue>3</issue>
        <fpage>559</fpage>
        <lpage>575</lpage>
        <pub-id pub-id-type="doi">10.1086/519795</pub-id>
        <?supplied-pmid 17701901?>
        <pub-id pub-id-type="pmid">17701901</pub-id>
      </element-citation>
    </ref>
    <ref id="CR3">
      <label>3.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Bycroft</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>The UK Biobank resource with deep phenotyping and genomic data</article-title>
        <source>Nature</source>
        <year>2018</year>
        <volume>562</volume>
        <issue>7726</issue>
        <fpage>203</fpage>
        <lpage>209</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-018-0579-z</pub-id>
        <?supplied-pmid 30305743?>
        <pub-id pub-id-type="pmid">30305743</pub-id>
      </element-citation>
    </ref>
    <ref id="CR4">
      <label>4.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Danek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Grabowski</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>Genome compression: a novel approach for large collections</article-title>
        <source>Bioinformatics</source>
        <year>2013</year>
        <volume>29</volume>
        <issue>20</issue>
        <fpage>2572</fpage>
        <lpage>2578</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btt460</pub-id>
        <?supplied-pmid 23969136?>
        <pub-id pub-id-type="pmid">23969136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR5">
      <label>5.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
          <name>
            <surname>Danek</surname>
            <given-names>A</given-names>
          </name>
        </person-group>
        <article-title>GTShark: genotype compression in large projects</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>22</issue>
        <fpage>4791</fpage>
        <lpage>4793</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btz508</pub-id>
        <?supplied-pmid 31225861?>
        <pub-id pub-id-type="pmid">31225861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR6">
      <label>6.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Lan</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>genozip: a fast and efficient compression tool for VCF files</article-title>
        <source>Bioinformatics</source>
        <year>2020</year>
        <volume>36</volume>
        <issue>13</issue>
        <fpage>4091</fpage>
        <lpage>4092</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btaa290</pub-id>
        <?supplied-pmid 32407471?>
        <pub-id pub-id-type="pmid">32407471</pub-id>
      </element-citation>
    </ref>
    <ref id="CR7">
      <label>7.</label>
      <mixed-citation publication-type="other">Deorowicz S, Danek A, Kokot M. VCFShark: how to squeeze a VCF file. Bioinformatics. 2021.</mixed-citation>
    </ref>
    <ref id="CR8">
      <label>8.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danecek</surname>
            <given-names>P</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Twelve years of SAMtools and BCFtools</article-title>
        <source>Gigascience</source>
        <year>2021</year>
        <volume>10</volume>
        <issue>2</issue>
        <fpage>giab008</fpage>
        <pub-id pub-id-type="doi">10.1093/gigascience/giab008</pub-id>
        <?supplied-pmid 33590861?>
        <pub-id pub-id-type="pmid">33590861</pub-id>
      </element-citation>
    </ref>
    <ref id="CR9">
      <label>9.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Durbin</surname>
            <given-names>R</given-names>
          </name>
        </person-group>
        <article-title>Efficient haplotype matching and storage using the positional Burrows-Wheeler transform (PBWT)</article-title>
        <source>Bioinformatics</source>
        <year>2014</year>
        <volume>30</volume>
        <issue>9</issue>
        <fpage>1266</fpage>
        <lpage>1272</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btu014</pub-id>
        <?supplied-pmid 24413527?>
        <pub-id pub-id-type="pmid">24413527</pub-id>
      </element-citation>
    </ref>
    <ref id="CR10">
      <label>10.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>H</given-names>
          </name>
        </person-group>
        <article-title>BGT: efficient and flexible genotype query across many samples</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>4</issue>
        <fpage>590</fpage>
        <lpage>592</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btv613</pub-id>
        <?supplied-pmid 26500154?>
        <pub-id pub-id-type="pmid">26500154</pub-id>
      </element-citation>
    </ref>
    <ref id="CR11">
      <label>11.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Layer</surname>
            <given-names>RM</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Efficient genotype compression and analysis of large genetic-variation data sets</article-title>
        <source>Nat Methods</source>
        <year>2016</year>
        <volume>13</volume>
        <issue>1</issue>
        <fpage>63</fpage>
        <lpage>65</lpage>
        <pub-id pub-id-type="doi">10.1038/nmeth.3654</pub-id>
        <?supplied-pmid 26550772?>
        <pub-id pub-id-type="pmid">26550772</pub-id>
      </element-citation>
    </ref>
    <ref id="CR12">
      <label>12.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Danek</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Deorowicz</surname>
            <given-names>S</given-names>
          </name>
        </person-group>
        <article-title>GTC: how to maintain huge genotype collections in a compressed form</article-title>
        <source>Bioinformatics</source>
        <year>2018</year>
        <volume>34</volume>
        <issue>11</issue>
        <fpage>1834</fpage>
        <lpage>1840</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty023</pub-id>
        <?supplied-pmid 29351600?>
        <pub-id pub-id-type="pmid">29351600</pub-id>
      </element-citation>
    </ref>
    <ref id="CR13">
      <label>13.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Rehm</surname>
            <given-names>HL</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GA4GH: international policies and standards for data sharing across genomic research and healthcare</article-title>
        <source>Cell Genom</source>
        <year>2021</year>
        <volume>1</volume>
        <issue>2</issue>
        <fpage>100029</fpage>
        <pub-id pub-id-type="doi">10.1016/j.xgen.2021.100029</pub-id>
        <?supplied-pmid 35072136?>
        <pub-id pub-id-type="pmid">35072136</pub-id>
      </element-citation>
    </ref>
    <ref id="CR14">
      <label>14.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Wu</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Large-scale whole-genome sequencing of three diverse Asian populations in Singapore</article-title>
        <source>Cell</source>
        <year>2019</year>
        <volume>179</volume>
        <issue>3</issue>
        <fpage>736</fpage>
        <lpage>749.e15</lpage>
        <pub-id pub-id-type="doi">10.1016/j.cell.2019.09.019</pub-id>
        <?supplied-pmid 31626772?>
        <pub-id pub-id-type="pmid">31626772</pub-id>
      </element-citation>
    </ref>
    <ref id="CR15">
      <label>15.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Li</surname>
            <given-names>M</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Robust and rapid algorithms facilitate large-scale whole genome sequencing downstream analysis in an integrative framework</article-title>
        <source>Nucleic Acids Res</source>
        <year>2017</year>
        <volume>45</volume>
        <issue>9</issue>
        <fpage>e75</fpage>
        <?supplied-pmid 28115622?>
        <pub-id pub-id-type="pmid">28115622</pub-id>
      </element-citation>
    </ref>
    <ref id="CR16">
      <label>16.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zhang</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>PopLDdecay: a fast and effective tool for linkage disequilibrium decay analysis based on variant call format files</article-title>
        <source>Bioinformatics</source>
        <year>2019</year>
        <volume>35</volume>
        <issue>10</issue>
        <fpage>1786</fpage>
        <lpage>1788</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/bty875</pub-id>
        <?supplied-pmid 30321304?>
        <pub-id pub-id-type="pmid">30321304</pub-id>
      </element-citation>
    </ref>
    <ref id="CR17">
      <label>17.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Theodoris</surname>
            <given-names>C</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>quickLD: an efficient software for linkage disequilibrium analyses</article-title>
        <source>Mol Ecol Resour</source>
        <year>2021</year>
        <volume>21</volume>
        <issue>7</issue>
        <fpage>2580</fpage>
        <lpage>2587</lpage>
        <pub-id pub-id-type="doi">10.1111/1755-0998.13438</pub-id>
        <?supplied-pmid 34062051?>
        <pub-id pub-id-type="pmid">34062051</pub-id>
      </element-citation>
    </ref>
    <ref id="CR18">
      <label>18.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Taliun</surname>
            <given-names>D</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>Sequencing of 53,831 diverse genomes from the NHLBI TOPMed Program</article-title>
        <source>Nature</source>
        <year>2021</year>
        <volume>590</volume>
        <issue>7845</issue>
        <fpage>290</fpage>
        <lpage>299</lpage>
        <pub-id pub-id-type="doi">10.1038/s41586-021-03205-y</pub-id>
        <?supplied-pmid 33568819?>
        <pub-id pub-id-type="pmid">33568819</pub-id>
      </element-citation>
    </ref>
    <ref id="CR19">
      <label>19.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Menozzi</surname>
            <given-names>P</given-names>
          </name>
          <name>
            <surname>Piazza</surname>
            <given-names>A</given-names>
          </name>
          <name>
            <surname>Cavalli-Sforza</surname>
            <given-names>L</given-names>
          </name>
        </person-group>
        <article-title>Synthetic maps of human gene frequencies in Europeans</article-title>
        <source>Science</source>
        <year>1978</year>
        <volume>201</volume>
        <issue>4358</issue>
        <fpage>786</fpage>
        <lpage>792</lpage>
        <pub-id pub-id-type="doi">10.1126/science.356262</pub-id>
        <?supplied-pmid 356262?>
        <pub-id pub-id-type="pmid">356262</pub-id>
      </element-citation>
    </ref>
    <ref id="CR20">
      <label>20.</label>
      <mixed-citation publication-type="other">Collet YTC. Smaller and faster data compression with Zstandard. 2016.</mixed-citation>
    </ref>
    <ref id="CR21">
      <label>21.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Auton</surname>
            <given-names>A</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>A global reference for human genetic variation</article-title>
        <source>Nature</source>
        <year>2015</year>
        <volume>526</volume>
        <issue>7571</issue>
        <fpage>68</fpage>
        <lpage>74</lpage>
        <pub-id pub-id-type="doi">10.1038/nature15393</pub-id>
        <?supplied-pmid 26432245?>
        <pub-id pub-id-type="pmid">26432245</pub-id>
      </element-citation>
    </ref>
    <ref id="CR22">
      <label>22.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Zheng</surname>
            <given-names>X</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>SeqArray-a storage-efficient high-performance data format for WGS variant calls</article-title>
        <source>Bioinformatics</source>
        <year>2017</year>
        <volume>33</volume>
        <issue>15</issue>
        <fpage>2251</fpage>
        <lpage>2257</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btx145</pub-id>
        <?supplied-pmid 28334390?>
        <pub-id pub-id-type="pmid">28334390</pub-id>
      </element-citation>
    </ref>
    <ref id="CR23">
      <label>23.</label>
      <element-citation publication-type="journal">
        <person-group person-group-type="author">
          <name>
            <surname>Tatwawadi</surname>
            <given-names>K</given-names>
          </name>
          <etal/>
        </person-group>
        <article-title>GTRAC: fast retrieval from compressed collections of genomic variants</article-title>
        <source>Bioinformatics</source>
        <year>2016</year>
        <volume>32</volume>
        <issue>17</issue>
        <fpage>i479</fpage>
        <lpage>i486</lpage>
        <pub-id pub-id-type="doi">10.1093/bioinformatics/btw437</pub-id>
        <?supplied-pmid 27587665?>
        <pub-id pub-id-type="pmid">27587665</pub-id>
      </element-citation>
    </ref>
    <ref id="CR24">
      <label>24.</label>
      <mixed-citation publication-type="other">Zhang L, Miaoxin L. Source code for GBC (v1.2, the version for publication) (release).  2023. Zenodo. 10.5281/zenodo.7737556</mixed-citation>
    </ref>
  </ref-list>
</back>
