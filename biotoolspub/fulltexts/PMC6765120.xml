<?properties open_access?>
<?DTDIdentifier.IdentifierValue -//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1 20151215//EN?>
<?DTDIdentifier.IdentifierType public?>
<?SourceDTD.DTDName JATS-journalpublishing1.dtd?>
<?SourceDTD.Version 1.1?>
<?ConverterInfo.XSLTName jats2jats3.xsl?>
<?ConverterInfo.Version 1?>
<front>
  <journal-meta>
    <journal-id journal-id-type="nlm-ta">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="iso-abbrev">Nucleic Acids Res</journal-id>
    <journal-id journal-id-type="publisher-id">nar</journal-id>
    <journal-title-group>
      <journal-title>Nucleic Acids Research</journal-title>
    </journal-title-group>
    <issn pub-type="ppub">0305-1048</issn>
    <issn pub-type="epub">1362-4962</issn>
    <publisher>
      <publisher-name>Oxford University Press</publisher-name>
    </publisher>
  </journal-meta>
  <article-meta>
    <article-id pub-id-type="pmcid">6765120</article-id>
    <article-id pub-id-type="pmid">31372651</article-id>
    <article-id pub-id-type="doi">10.1093/nar/gkz622</article-id>
    <article-id pub-id-type="publisher-id">gkz622</article-id>
    <article-categories>
      <subj-group subj-group-type="heading">
        <subject>Methods Online</subject>
      </subj-group>
    </article-categories>
    <title-group>
      <article-title>Nonparametric expression analysis using inferential replicate counts</article-title>
    </title-group>
    <contrib-group>
      <contrib contrib-type="author">
        <name>
          <surname>Zhu</surname>
          <given-names>Anqi</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Srivastava</surname>
          <given-names>Avi</given-names>
        </name>
        <xref ref-type="aff" rid="AFF2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Ibrahim</surname>
          <given-names>Joseph G</given-names>
        </name>
        <xref ref-type="aff" rid="AFF1">1</xref>
      </contrib>
      <contrib contrib-type="author">
        <name>
          <surname>Patro</surname>
          <given-names>Rob</given-names>
        </name>
        <xref ref-type="aff" rid="AFF2">2</xref>
      </contrib>
      <contrib contrib-type="author">
        <contrib-id contrib-id-type="orcid" authenticated="false">http://orcid.org/0000-0001-8401-0545</contrib-id>
        <name>
          <surname>Love</surname>
          <given-names>Michael I</given-names>
        </name>
        <!--<email>michaelisaiahlove@gmail.com</email>-->
        <xref ref-type="aff" rid="AFF1">1</xref>
        <xref ref-type="aff" rid="AFF3">3</xref>
        <xref ref-type="corresp" rid="COR1"/>
      </contrib>
    </contrib-group>
    <aff id="AFF1"><label>1</label><institution>Department of Biostatistics, University of North Carolina-Chapel Hill</institution>, 135 Dauer Drive, Chapel Hill, NC 27599, <country country="US">USA</country></aff>
    <aff id="AFF2"><label>2</label><institution>Department of Computer Science, Stony Brook University</institution>, Computer Science Building, Engineering Dr, Stony Brook, NY 11794, <country country="US">USA</country></aff>
    <aff id="AFF3"><label>3</label><institution>Department of Genetics, University of North Carolina-Chapel Hill</institution>, 120 Mason Farm Rd, Chapel Hill, NC 27514, <country country="US">USA</country></aff>
    <author-notes>
      <corresp id="COR1">To whom correspondence should be addressed. Tel: +1 919 966-7266; Email: <email>michaelisaiahlove@gmail.com</email></corresp>
    </author-notes>
    <pub-date pub-type="collection">
      <day>10</day>
      <month>10</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="epub" iso-8601-date="2019-08-02">
      <day>02</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <pub-date pub-type="pmc-release">
      <day>02</day>
      <month>8</month>
      <year>2019</year>
    </pub-date>
    <!-- PMC Release delay is 0 months and 0 days and was based on the <pub-date pub-type="epub"/>. -->
    <volume>47</volume>
    <issue>18</issue>
    <fpage>e105</fpage>
    <lpage>e105</lpage>
    <history>
      <date date-type="accepted">
        <day>11</day>
        <month>7</month>
        <year>2019</year>
      </date>
      <date date-type="rev-recd">
        <day>11</day>
        <month>6</month>
        <year>2019</year>
      </date>
      <date date-type="received">
        <day>01</day>
        <month>5</month>
        <year>2019</year>
      </date>
    </history>
    <permissions>
      <copyright-statement>© The Author(s) 2019. Published by Oxford University Press on behalf of Nucleic Acids Research.</copyright-statement>
      <copyright-year>2019</copyright-year>
      <license>
        <ali:license_ref xmlns:ali="http://www.niso.org/schemas/ali/1.0/" specific-use="textmining" content-type="ccbynclicense">https://creativecommons.org/licenses/by-nc/4.0/</ali:license_ref>
        <license-p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (<ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/">http://creativecommons.org/licenses/by-nc/4.0/</ext-link>), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact <email>journals.permissions@oup.com</email></license-p>
      </license>
    </permissions>
    <self-uri xlink:href="gkz622.pdf"/>
    <abstract>
      <title>Abstract</title>
      <p>A primary challenge in the analysis of RNA-seq data is to identify differentially expressed genes or transcripts while controlling for technical biases. Ideally, a statistical testing procedure should incorporate the inherent uncertainty of the abundance estimates arising from the quantification step. Most popular methods for RNA-seq differential expression analysis fit a parametric model to the counts for each gene or transcript, and a subset of methods can incorporate uncertainty. Previous work has shown that nonparametric models for RNA-seq differential expression may have better control of the false discovery rate, and adapt well to new data types without requiring reformulation of a parametric model. Existing nonparametric models do not take into account inferential uncertainty, leading to an inflated false discovery rate, in particular at the transcript level. We propose a nonparametric model for differential expression analysis using inferential replicate counts, extending the existing SAMseq method to account for inferential uncertainty. We compare our method, Swish, with popular differential expression analysis methods. Swish has improved control of the false discovery rate, in particular for transcripts with high inferential uncertainty. We apply Swish to a single-cell RNA-seq dataset, assessing differential expression between sub-populations of cells, and compare its performance to the Wilcoxon test.</p>
    </abstract>
    <funding-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">M.I.L.</named-content>
        </funding-source>
        <award-id>R01 HG009937</award-id>
        <award-id>R01 MH118349</award-id>
        <award-id>P01 CA142538</award-id>
        <award-id>P30 ES010126</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">J.G.I., A.Z.</named-content>
        </funding-source>
        <award-id>R01 GM070335</award-id>
        <award-id>P01 CA142538</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">A.S., R.P.</named-content>
        </funding-source>
        <award-id>R01 HG009937</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Science Foundation</named-content>
          <named-content content-type="funder-identifier">10.13039/100000001</named-content>
        </funding-source>
        <award-id>CCF-1750472</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">Silicon Valley Community Foundation</named-content>
          <named-content content-type="funder-identifier">10.13039/100000923</named-content>
        </funding-source>
        <award-id>2018-182752</award-id>
      </award-group>
      <award-group award-type="grant">
        <funding-source>
          <named-content content-type="funder-name">National Human Genome Research Institute</named-content>
          <named-content content-type="funder-identifier">10.13039/100000051</named-content>
        </funding-source>
        <award-id>HG009937</award-id>
      </award-group>
    </funding-group>
    <counts>
      <page-count count="12"/>
    </counts>
  </article-meta>
</front>
<body>
  <sec sec-type="intro" id="SEC1">
    <title>INTRODUCTION</title>
    <p>Quantification uncertainty in RNA-seq arises from fragments that are consistent with expression of one or more transcripts within a gene, or fragments which map to multiple genes. Abundance estimation algorithms probabilistically assign fragments to transcripts, and may simultaneously estimate technical bias parameters, providing a point estimate of transcript abundance. Transcript abundance can be compared across samples directly, or transcript abundances can be summarized within a gene to provide gene-level comparisons across samples. However, incorporating the uncertainty of the quantification step into statistical testing of abundance differences across samples is challenging, but nevertheless critical, as the inferential uncertainty is not equal across transcripts or genes, but is higher for genes with many similar transcripts (transcript-level uncertainty) or genes that belong to large families with high level of sequence homology (gene-level uncertainty).</p>
    <p>Methods designed for transcript-level differential expression (DE) analysis include <italic>BitSeq</italic> (<xref rid="B1" ref-type="bibr">1</xref>), <italic>EBSeq</italic> (<xref rid="B2" ref-type="bibr">2</xref>), <italic>Cuffdiff2</italic> (<xref rid="B3" ref-type="bibr">3</xref>), <italic>IsoDE</italic> (<xref rid="B4" ref-type="bibr">4</xref>) and <italic>sleuth</italic> (<xref rid="B5" ref-type="bibr">5</xref>). <italic>BitSeq</italic> uses MCMC samples from the posterior distribution during abundance estimation of each sample, to build a model of technical noise when comparing abundance across samples. A parametric Bayesian model is specified with the distribution for the abundance in a single sample being conjugate, such that the posterior inference comparing across samples is exact. <italic>EBSeq</italic> takes into account the number of transcripts within a gene when performing dispersion estimation, while <italic>Cuffdiff2</italic> models biological variability across replicates through over-dispersion, as well as the uncertainty of assigning counts to transcripts within a gene, using the beta negative binomial mixture distribution. <italic>IsoDE</italic> and <italic>sleuth</italic> leverage a measurement of quantification uncertainty from bootstrapping reads when performing DE analysis. These methods therefore may offer better control of FDR for transcripts or genes with high uncertainty of the abundance. <italic>BitSeq, EBSeq, Cuffdiff2</italic> and <italic>sleuth</italic> incorporate biological variance and inferential uncertainty into a parametric model of gene or transcript expression, while <italic>IsoDE</italic> focuses on comparisons of bootstrap distributions for two samples at a time, aggregating over random pairs or all pairs of samples in two groups in the case of biological replicates. Another method, <italic>RATs</italic> (<xref rid="B6" ref-type="bibr">6</xref>), provides a test for differential transcript usage (DTU). <italic>RATs</italic> takes inferential uncertainty into account by repeating the statistical testing procedure across inferential replicates (posterior samples or bootstrap replicates), and then offers a filter on the fraction of replicate analyses which achieved statistical significance. In this study, we focus on differential transcript expression (DTE) and differential gene expression (DGE), the latter defined as a change in the total expression of a gene across all of its transcripts.</p>
    <p><italic>BitSeq, EBSeq, Cuffdiff2</italic> and <italic>sleuth</italic> rely on parametric models of the transcript or gene abundance, assuming underlying distributions for the data and sometimes also for the parameters in the context of a Bayesian model. The distributions are typically chosen for being robust across many experiments and for efficient inference. In a recent simulation benchmark of DTE and DGE, <italic>EBSeq</italic> and <italic>sleuth</italic> did have improved performance for detecting DTE compared to methods designed for gene-level analysis, for <italic>EBSeq</italic> when sample size was large (<italic>n</italic> ≥ 6) and for <italic>sleuth</italic> when the sample size was low to moderate (<italic>n</italic> ∈ [3, 6]) (<xref rid="B7" ref-type="bibr">7</xref>), lending support for these models specialized for transcript-level inference. In this simulation benchmark, <italic>EBSeq</italic> and <italic>sleuth</italic> performed similarly to methods designed for detecting DGE, where uncertainty in abundance estimation is greatly reduced as described by Soneson <italic>et al.</italic> (<xref rid="B8" ref-type="bibr">8</xref>).</p>
    <p>Previous studies have shown that nonparametric methods for differential expression analysis may be more robust compared to parametric models when the data for certain genes or transcripts deviates from distributional assumptions of the model (<xref rid="B9" ref-type="bibr">9</xref>). Li and Tibshirani (<xref rid="B9" ref-type="bibr">9</xref>) proposed <italic>SAMseq</italic>, which has high sensitivity and good control of FDR at the gene-level, when the sample size is 4 per group or higher (<xref rid="B7" ref-type="bibr">7</xref>,<xref rid="B10" ref-type="bibr">10</xref>,<xref rid="B11" ref-type="bibr">11</xref>). <italic>SAMseq</italic> uses a multiple re-sampling procedure to account for differences in library size across samples, and then averages a rank-based test statistic over the re-sampled datasets to produce a single score per gene. We considered whether the <italic>SAMseq</italic> model could be extended to account for inferential uncertainty during abundance estimation, as well as batch effects and sample pairing.</p>
    <p>Further, we investigated whether a nonparametric method for comparison of counts, which accounts for inferential uncertainty, would provide benefit for new types of data exhibiting different distributions compared to bulk RNA-seq experiments. Single cell RNA-seq (scRNA-seq) provides researchers with high-dimensional transcriptomic profiles of single cells (<xref rid="B12" ref-type="bibr">12</xref>), revealing inter-cell heterogeneity and in particular sub-populations of cells that may be obscured in bulk datasets. Due to the limited amount of RNA material in a single cell and the low capture efficiency, all current protocols for scRNA-seq experiments use amplification techniques. To reduce the amplification bias, it is common to use Unique Molecular Identifiers (UMIs), short random sequences that are attached to the cDNA molecules per cell (<xref rid="B13" ref-type="bibr">13</xref>). Ideally, by counting the total number of distinct UMIs per gene and per cell, one obtains a direct count of cDNA molecules, reducing bias from amplification.</p>
    <p>Among the multiple different types of assays available for UMI-tagged scRNA-seq, droplet-based protocols have been of particular importance because of their relatively low cost, higher capture rate, robustness and accuracy in gene-count estimation. However, current dscRNA-seq (droplet-based single-cell RNA sequencing) protocols are limited in their resolution, as they only sequence the 3′ end of the mRNA molecule. This complicates full transcript-level quantification, and in fact such quantification is not possible for collections of transcripts that are not disambiguated within a sequenced fragment’s length of the 3′ end. Moreover, since dscRNA-seq protocols typically rely on considerable amplification of genomic material, the UMI sequences designed to help identify duplicate fragments are often subject to errors during amplification and sequencing. Most dscRNA-seq quantification pipelines (<xref rid="B14" ref-type="bibr">14–17</xref>) thus include some method for de-duplicating similar UMIs (i.e. UMIs within some small edit distance) attached to reads that align to the same gene. These dscRNA-seq quantification pipelines (<xref rid="B14" ref-type="bibr">14–17</xref>) simplify the problem of gene-level count estimation by discarding the gene-ambiguous reads, which represent a considerable portion of the data (12-23% as reported by Srivastava <italic>et al.</italic> (<xref rid="B18" ref-type="bibr">18</xref>)). <italic>Alevin</italic> (<xref rid="B18" ref-type="bibr">18</xref>) is the first tool to propose a method to account for sequencing and amplification errors in cellular barcodes (CB) and UMIs while also taking into account gene multi-mapping reads during quantification. To resolve gene ambiguity, <italic>Alevin</italic> first uses the Parsimonious UMI Graph (PUG) resolution algorithm. In the case that parsimony fails to distinguish a single best gene, abundance is estimated by utilizing the proportion of uniquely-mapping reads per gene to distribute ambiguous counts by an expectation-maximization procedure. <italic>Alevin</italic> also can produce inferential replicates in the form of multiple matrices of estimated counts, via bootstrapping of the counts in their PUG model. We assessed how incorporation of this inferential uncertainty using <italic>Swish</italic> resulted in different sets of DE genes compared to those called by a rank-based test ignoring uncertainty, in the context of calling DE genes between sub-populations of cells detected in scRNA-seq.</p>
    <p>We describe a nonparametric method for gene- or transcript-level differential expression analysis, ‘SAMseq With Inferential Samples Helps’, or <italic>Swish</italic>, that propagates quantification uncertainty from Gibbs posterior samples generated by the <italic>Salmon</italic> (<xref rid="B19" ref-type="bibr">19</xref>) method for transcript quantification. In addition to the incorporation of uncertainty in the counts, <italic>Swish</italic> also extends the two group comparison in <italic>SAMseq</italic> by handling experiments with discrete batches or sample pairing. We show through simulation studies that the proposed method has better control of FDR and better sensitivity for DTE, compared to existing methods designed for transcript-level or gene-level analysis. For DGE, <italic>Swish</italic> tends to perform as well as existing methods designed for gene-level analysis, with better control of FDR than <italic>SAMseq</italic> for genes with high inferential uncertainty. We also compare <italic>Swish</italic>, leveraging estimation uncertainty, with a Wilcoxon test on gene expression in scRNA-seq sub-populations of cells in the developing mouse brain. <italic>Swish</italic> is available within the <monospace>fishpond</monospace> R/Bioconductor (<xref rid="B20" ref-type="bibr">20</xref>) package: <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/fishpond">https://bioconductor.org/packages/fishpond</ext-link>.</p>
  </sec>
  <sec sec-type="materials|methods" id="SEC2">
    <title>MATERIALS AND METHODS</title>
    <sec id="SEC2-1">
      <title>Median-ratio scaled counts</title>
      <p>In order to apply nonparametric rank-based methods to estimated counts per gene or transcript, we first remove biases on the counts due to library size differences or changes in the effective length of the gene or transcript across samples (<xref rid="B19" ref-type="bibr">19</xref>). For 3′-tagged datasets, where we do not expect counts to be proportional to length, we correct only for library size but not for effective length, which is not computed. <italic>scaledTPM</italic> counts are generated which are roughly on the scale of original estimated counts, but are adjusted to account for technical biases with respect to effective transcript or gene length (<xref rid="B8" ref-type="bibr">8</xref>). We perform median-ratio normalization (<xref rid="B21" ref-type="bibr">21</xref>) of the <italic>scaledTPM</italic>, to remove any residual differences in <italic>scaledTPM</italic> across samples due to library size differences. The resulting scaled counts can then be directly compared across samples.</p>
      <p>Suppose a matrix <italic>Y</italic><sup>0</sup> of estimated counts from <italic>Salmon</italic>. The rows of the matrix represents genes or transcripts, (<italic>g</italic> = 1, …, <italic>G</italic>), and columns represent samples, (<italic>i</italic> = 1, …, <italic>m</italic>). Let <inline-formula><tex-math id="M7">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Y_{gi}^0$\end{document}</tex-math></inline-formula> denote the count of RNA-seq fragments assigned to gene <italic>g</italic> in sample <italic>i</italic>. The estimated counts <inline-formula><tex-math id="M8">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Y^0_{gi}$\end{document}</tex-math></inline-formula> are divided by a bias term accounting for the sample-specific effective length of the gene or transcript, denoted as <italic>l</italic><sub><italic>gi</italic></sub> (<xref rid="B8" ref-type="bibr">8</xref>,<xref rid="B22" ref-type="bibr">22</xref>). We first scale the <italic>l</italic><sub><italic>gi</italic></sub> by the geometric mean over <italic>i</italic>, giving a bias correction term <italic>b</italic><sub><italic>gi</italic></sub> centered around 1:<disp-formula><tex-math id="M9">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} b_{gi} = l_{gi} / \big ( \prod _{j=1}^m l_{gj} \big )^{\frac{1}{m}}. \end{equation*}$$\end{document}</tex-math></disp-formula>Then we divide the <italic>b</italic><sub><italic>gi</italic></sub> from the estimated counts:<disp-formula><tex-math id="M10">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} Y^*_{gi} = \dfrac{Y^0_{gi}}{b_{gi}}. \end{equation*}$$\end{document}</tex-math></disp-formula>Again, for 3′-tagged data, we set <italic>l</italic><sub><italic>gi</italic></sub> = <italic>b</italic><sub><italic>gi</italic></sub> = 1 in the above. The <inline-formula><tex-math id="M11">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Y^*_{gi}$\end{document}</tex-math></inline-formula> are scaled to the geometric mean of sequencing depth, by<disp-formula><tex-math id="M12">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} Y^{**}_{gi} = \dfrac{Y^*_{gi}}{\sum _{g=1}^{G}Y^*_{gi}} \times \big (\prod _{j=1}^{m} \sum _{g=1}^{G}Y^0_{gj}\big )^{\frac{1}{m}}. \end{equation*}$$\end{document}</tex-math></disp-formula>For each sample <italic>i</italic> a median-ratio size factor is computed as<disp-formula id="M1"><label>(1)</label><tex-math id="M13">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \hat{s}_i = \textrm{median}_g\dfrac{Y^{**}_{gi}}{\big (\prod _{j=1}^{m} Y^{**}_{gj}\big )^{\frac{1}{m}}}, \end{equation*}$$\end{document}</tex-math></disp-formula>where the median is taken over <italic>g</italic> where the numerator and denominator are both greater than zero. For scRNA-seq data, an alternative size factor estimate is used, as described in a later section. Lastly, the scaled count used for nonparametric methods is given by:<disp-formula id="M2"><label>(2)</label><tex-math id="M14">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} Y_{gi} = \frac{Y^{**}_{gi}}{\hat{s}_i} . \end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>After scaling, we filter features (genes or transcripts) with low scaled counts and therefore low power: for bulk RNA-seq, we recommend keeping features with an estimated count of at least 10 across a minimal number of samples, and here we set the minimal number of samples to 3. For UMI de-duplicated scRNA-seq data, we lowered the minimum count to 3 and require at least 5 cells, as described in a later section.</p>
      <p>We scale all of <italic>Salmon</italic>’s Gibbs sampled estimated count matrices using the above procedure. For posterior sampling, <italic>Salmon</italic> adopts a similar approach to <italic>MMSEQ</italic> (<xref rid="B23" ref-type="bibr">23</xref>) to perform Gibbs sampling on abundance estimates, alternating between (i) Multinomial sampling of fragment allocation to equivalence classes of transcripts and (ii) conditioning on these fragment allocations, Gamma sampling of the transcript abundance, as described in further detail in the <xref ref-type="supplementary-material" rid="sup1">Supplementary Note 2</xref> of Patro <italic>et al.</italic> (<xref rid="B19" ref-type="bibr">19</xref>). The Gibbs samples are thinned every 16th iteration to reduce auto-correlation (<italic>Salmon</italic>’s default setting), and 20 thinned Gibbs samples are used as the posterior samples in the following methods.</p>
    </sec>
    <sec id="SEC2-2">
      <title>Inferential relative variance</title>
      <p>For each gene (or transcript) from each sample, <italic>S</italic> Gibbs sampled estimated counts are generated using <italic>Salmon</italic>. Estimated counts are then scaled and filtered as described above.</p>
      <p>We define the <italic>inferential relative variance</italic> (InfRV), per gene and per sample, as<disp-formula><tex-math id="M15">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} \textrm{InfRV} = \dfrac{\max (s^2 - \mu , 0)}{\mu }, \end{equation*}$$\end{document}</tex-math></disp-formula>where <italic>s</italic><sup>2</sup> is the sample variance of scaled counts over Gibbs samples, and μ is the mean scaled count over Gibbs samples. In practice, we also add a pseudocount of 5 to the denominator and add 0.01 overall, in order to stabilize the statistic and make it strictly positive for log transformation. InfRV is therefore a measure of the uncertainty of the estimated counts, which is roughly stabilized with respect to μ (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S1</xref>). The larger the InfRV, the higher the uncertainty in quantification for that gene or transcript in that sample relative to other genes with the same mean. Note that InfRV is not used in the <italic>Swish</italic> statistical testing procedure, but only used in this work for visualization purposes, to categorize genes or transcripts by their inferential uncertainty, in a way that is roughly independent of the range of counts for the feature.</p>
    </sec>
    <sec id="SEC2-3">
      <title>Test statistic over Gibbs samples</title>
      <p>In <italic>Swish</italic>, we consider experiments with samples across two conditions of interest. We additionally allow for two or more batches to be adjusted for, or comparisons of paired data, described below. We first consider an experiment with two conditions and no batches. Let <italic>m</italic><sub><italic>k</italic></sub> denote the sample size in condition <italic>k, k</italic> = 1, 2, and <italic>m</italic><sub>1</sub> + <italic>m</italic><sub>2</sub> = <italic>m</italic>. Let <italic>C</italic><sub><italic>k</italic></sub> denote the collection of samples that are from condition <italic>k</italic>.</p>
      <p>For the following, consider a single matrix <inline-formula><tex-math id="M16">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Y_{gi}^s$\end{document}</tex-math></inline-formula> of scaled counts from one of the Gibbs samples, (<italic>s</italic> = 1, ⋅⋅⋅, <italic>S</italic>). For gene <italic>g</italic>, the scaled counts <inline-formula><tex-math id="M17">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Y_{gi}^s$\end{document}</tex-math></inline-formula> estimated from (<xref ref-type="disp-formula" rid="M2">2</xref>) are ranked over <italic>i</italic>. To break ties in <inline-formula><tex-math id="M18">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Y_{gi}^s$\end{document}</tex-math></inline-formula> over the <italic>m</italic> biological samples, a small random value is draw from Uniform(0, 0.1) and added before computing the ranks, as in Li and Tibshirani (<xref rid="B9" ref-type="bibr">9</xref>). Let <inline-formula><tex-math id="M19">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$R_{gi}^s$\end{document}</tex-math></inline-formula> denote the rank of sample <italic>i</italic> among <italic>m</italic> biological samples for gene <italic>g</italic>. As in Li and Tibshirani (<xref rid="B9" ref-type="bibr">9</xref>), for a two group comparison we use the Mann–Whitney Wilcoxon test statistic (<xref rid="B24" ref-type="bibr">24</xref>) for gene <italic>g</italic>:<disp-formula id="M3"><label>(3)</label><tex-math id="M20">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} W_g^s = \sum \limits _{i \in C_2} R^s_{gi} - \dfrac{m_2(m+1)}{2}. \end{equation*}$$\end{document}</tex-math></disp-formula>Under the null hypothesis that gene <italic>g</italic> is not differentially expressed, <inline-formula><tex-math id="M21">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$W_g^s$\end{document}</tex-math></inline-formula> has expectation zero.</p>
      <p>For every gene <italic>g</italic> = 1, ⋅⋅⋅, <italic>G</italic>, we calculate <inline-formula><tex-math id="M22">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$W_g^s$\end{document}</tex-math></inline-formula> for all Gibbs sampled scaled count matrices (<italic>s</italic> = 1, ⋅⋅⋅, <italic>S</italic>). As in Li and Tibshirani (<xref rid="B9" ref-type="bibr">9</xref>), we compute the mean over imputed count matrices as the final test statistic for gene <italic>g</italic>:<disp-formula id="M4"><label>(4)</label><tex-math id="M23">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} T_g = \frac{1}{S} \sum _{s=1}^S W_g^s . \end{equation*}$$\end{document}</tex-math></disp-formula></p>
      <p>The main difference between <italic>Swish</italic> and <italic>SAMseq</italic> is the use of inferential replicate count matrices from an upstream quantification method as input to the Mann–Whitney Wilcoxon test, as opposed to Poisson down-sampled count matrices. Additionally, <italic>Swish</italic> extends <italic>SAMseq</italic> for various other experimental designs, described below.</p>
    </sec>
    <sec id="SEC2-4">
      <title>Stratified test statistic</title>
      <p>In experiments with two or more batches, the above test statistic can be generalized to a stratified test statistic as described in van Elteren (<xref rid="B25" ref-type="bibr">25</xref>). We use the following to produce a summarized test statistic:<list list-type="order"><list-item><p>Stratify the samples by the nuisance covariate (e.g. batch). Suppose we have <italic>J</italic> strata. In stratum <italic>j</italic> the sample size for condition <italic>k</italic> is <italic>m</italic><sub><italic>j, k</italic></sub> and the total sample size is <italic>m</italic><sub><italic>j</italic></sub>, i.e. <italic>m</italic><sub><italic>j</italic>, 1</sub> + <italic>m</italic><sub><italic>j</italic>, 2</sub> = <italic>m</italic><sub><italic>j</italic></sub>.</p></list-item><list-item><p>For stratum <italic>j</italic>, compute the test statistic <inline-formula><tex-math id="M24">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T^j_g$\end{document}</tex-math></inline-formula>.</p></list-item><list-item><p>The final test statistic is calculated as the weighted combination of <inline-formula><tex-math id="M25">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$T^j_g$\end{document}</tex-math></inline-formula> over <italic>J</italic> strata<disp-formula id="M5"><label>(5)</label><tex-math id="M26">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} T^{\textrm{strat}}_g = \sum _{j=1}^{J}\omega _j T^j_g, \end{equation*}$$\end{document}</tex-math></disp-formula></p><p>where <inline-formula><tex-math id="M27">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\omega _j = \dfrac{1}{m_j+1}$\end{document}</tex-math></inline-formula> is the weight assigned to strata <italic>j</italic>.</p></list-item></list></p>
      <p>When the difference in expression for gene <italic>g</italic> is consistent across batches, the weighted test statistic maximizes the power of test (<xref rid="B26" ref-type="bibr">26</xref>).</p>
    </sec>
    <sec id="SEC2-5">
      <title>Signed-rank statistic for paired data</title>
      <p>In experiments with paired samples, e.g. before and after treatment, we use a Wilcoxon signed-rank test statistic (<xref rid="B24" ref-type="bibr">24</xref>) in (<xref ref-type="disp-formula" rid="M4">4</xref>) in lieu of the Mann-Whitney Wilcoxon statistic (<xref ref-type="disp-formula" rid="M3">3</xref>). For pair index <italic>p</italic> = 1, …, <italic>m</italic>/2:<disp-formula id="M6"><label>(6)</label><tex-math id="M28">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$$\begin{equation*} W_g^s = \sum _{p} \textrm{sign}(\Delta ^s_{gp}) R^s_{gp} \end{equation*}$$\end{document}</tex-math></disp-formula>where <inline-formula><tex-math id="M29">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\Delta _{gp}^s$\end{document}</tex-math></inline-formula> is the difference in <inline-formula><tex-math id="M30">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$Y_{gi}^s$\end{document}</tex-math></inline-formula> for the two samples in pair <italic>p</italic>, and <inline-formula><tex-math id="M31">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$R^s_{gp}$\end{document}</tex-math></inline-formula> is the rank over pairs of <inline-formula><tex-math id="M32">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$|\Delta _{gp}^s|$\end{document}</tex-math></inline-formula>.</p>
      <p>Unlike the Mann–Whitney Wilcoxon and stratified version described previously, the signed-rank statistic is not necessarily identical after transformation of the data by a monotonic function, e.g. by the square root or shifted logarithm. We choose to keep the data as scaled counts when computing the signed-rank statistic, and not to perform the square root or other transformation, so as to promote the association of higher ranks to matched samples with higher scaled counts for a given gene or transcript.</p>
    </sec>
    <sec id="SEC2-6">
      <title>Mann–Whitney Wilcoxon for differences across two groups</title>
      <p>In experiments with two groups of paired samples, e.g. before and after treatment, with pairs of samples divided across two treatments, one may be interested in testing if the effect of treatment is the same across the two groups. Here, we use a Mann–Whitney Wilcoxon test statistic on the log fold changes computed on the pairs, again taking the mean of this statistic over inferential replicates. This test will reject the null hypothesis for genes or transcripts where the multiplicative effect on counts differs across the two treatments, while controlling for any differences at baseline. It is analogous to testing an interaction term in linear model. The log fold change is chosen here, as opposed to the difference in count for the signed-rank statistic chosen above, as the latter would be sensitive to differences of the baseline counts across the two treatments, which is not desired.</p>
    </sec>
    <sec id="SEC2-7">
      <title>Permutation for estimation of FDR</title>
      <p>Under the null hypothesis that gene <italic>g</italic> is not differentially expressed, the distribution of test statistic <italic>T</italic><sub><italic>g</italic></sub> in (<xref ref-type="disp-formula" rid="M4">4</xref>)-(<xref ref-type="disp-formula" rid="M6">6</xref>) is not known. Instead, following the approach in <italic>SAMseq</italic> (<xref rid="B9" ref-type="bibr">9</xref>) we use permutation tests to construct the null distribution for <italic>T</italic><sub><italic>g</italic></sub> (by default 30 permutations). In the case of stratified data, we perform permutations independently within strata and calculate a weighted test statistic as in (<xref ref-type="disp-formula" rid="M5">5</xref>). For paired data, we randomly permute condition labels within pairs. Finally we use the permutation plug-in method (<xref rid="B27" ref-type="bibr">27</xref>) to estimate the <italic>q</italic>-value for each gene <italic>g</italic>, leveraging functions in the R package <italic>qvalue</italic> (<xref rid="B27" ref-type="bibr">27</xref>). We provide the option to estimate π<sub>0</sub>, the proportion of nulls, from the observed test statistics and the permutation null distribution, but by default we set <inline-formula><tex-math id="M33">\documentclass[12pt]{minimal}
\usepackage{amsmath}
\usepackage{wasysym} 
\usepackage{amsfonts} 
\usepackage{amssymb} 
\usepackage{amsbsy}
\usepackage{upgreek}
\usepackage{mathrsfs}
\setlength{\oddsidemargin}{-69pt}
\begin{document}
}{}$\hat{\pi }_0=1$\end{document}</tex-math></inline-formula>, which reduces to the method of Benjamini–Hochberg (<xref rid="B28" ref-type="bibr">28</xref>) for FDR control. In practice, 4 samples per group is sufficient for the permutation method to have sensitivity to detect differential expression (<xref rid="B9" ref-type="bibr">9</xref>,<xref rid="B11" ref-type="bibr">11</xref>).</p>
    </sec>
    <sec id="SEC2-8">
      <title>Simulation of bulk RNA-seq</title>
      <p>In order to evaluate <italic>Swish</italic> and other methods, we make use of a previously published simulated RNA-seq dataset (<xref rid="B7" ref-type="bibr">7</xref>), which we briefly describe here. <italic>polyester</italic> (<xref rid="B29" ref-type="bibr">29</xref>) was used to simulate paired-end RNA-seq reads across four groups of samples: two condition groups with various differential expression patterns described below, which were balanced across two batches. One batch demonstrated realistic fragment GC bias, and one batch demonstrated approximately uniform coverage. The fragment GC bias was derived via <italic>alpine</italic> (<xref rid="B30" ref-type="bibr">30</xref>) from GEUVADIS samples (<xref rid="B31" ref-type="bibr">31</xref>). Likewise, the baseline transcript expression was derived from a GEUVADIS sample. Each condition group had 12 samples in total, equally split among the two batches, giving 24 samples in all. Fragments were simulated from 46 933 expressed transcripts belonging to 15 017 genes (Gencode (<xref rid="B32" ref-type="bibr">32</xref>) release 28 human reference transcripts).</p>
      <p>70% of the genes were simulated with no differential expression across condition, while 10% of the genes had all of their transcripts differentially expressed with the same fold change, 10% of the genes had a single transcript differentially expressed, and 10% of the genes had shifts in expression among two of their transcript isoforms which resulted in no change in total expression. For the purpose of gene-level differential expression, 20% of the genes were non-null due to changes in total expression. For transcript-level differential expression, all transcripts expressed in the first category were differentially expressed, as well as one transcript per gene from the second category, and two transcripts per gene from the third category.</p>
      <p>Transcripts were quantified using <italic>Salmon</italic> v0.11.3 and <italic>kallisto</italic> (<xref rid="B33" ref-type="bibr">33</xref>) v0.44.0, with bias correction enabled for both methods, and generating 20 Gibbs samples for <italic>Salmon</italic> and 20 bootstrap samples for <italic>kallisto</italic>. The scripts used to generate the simulation are provided in the Code Availability section, and links to the raw reads and quantification files are listed in the Data Availability section.</p>
    </sec>
    <sec id="SEC2-9">
      <title>Simulation evaluation</title>
      <p>We evaluated methods across four settings:<list list-type="order"><list-item><p>DGE analysis with one batch of samples (fragment GC bias), six samples in each of the two conditions,</p></list-item><list-item><p>DGE analysis with two balanced batches of samples, 12 samples in each of the two conditions,</p></list-item><list-item><p>DTE analysis with one batch of samples (fragment GC bias), six samples in each of the two conditions,</p></list-item><list-item><p>DTE analysis with two balanced batches of samples, 12 samples in each of the two conditions.</p></list-item></list></p>
      <p>To evaluate the performance of methods on DGE and DTE, we use the iCOBRA package (<xref rid="B34" ref-type="bibr">34</xref>) to construct plots of the true positive rate (TPR) over the false discovery rate (FDR) at three nominal FDR thresholds: 1%, 5% and 10%. The methods compared include <italic>Swish, DESeq2</italic> (<xref rid="B11" ref-type="bibr">11</xref>), <italic>EBSeq</italic> (<xref rid="B2" ref-type="bibr">2</xref>), <italic>limma</italic> with <italic>voom</italic> transformation (<xref rid="B35" ref-type="bibr">35</xref>), <italic>SAMseq</italic> (<xref rid="B9" ref-type="bibr">9</xref>), and <italic>sleuth</italic> (<xref rid="B5" ref-type="bibr">5</xref>). We chose a set a methods to represent popular choices among classes of approaches. We note that <italic>edgeR</italic> (<xref rid="B36" ref-type="bibr">36</xref>) and <italic>edgeR</italic> with quasi-likelihood (<xref rid="B37" ref-type="bibr">37</xref>) performed well in a previous benchmark of this dataset (<xref rid="B7" ref-type="bibr">7</xref>), with both performing similarly to <italic>limma</italic>. <italic>EBSeq</italic> and <italic>sleuth</italic> are designed for DTE or DGE analysis taking the inferential uncertainty of quantification into account, while <italic>SAMseq, DESeq2</italic>, and <italic>limma</italic> are designed for gene-level analysis, but have been shown nevertheless to be able to recover DTE when supplied with transcript-level estimated counts (<xref rid="B7" ref-type="bibr">7</xref>). We provided minimal filtering across all methods, removing transcript or genes without an estimated count of 10 or more across at least 3 samples. We also used the default recommended filtering functions <monospace>filterByExpr</monospace> and <monospace>sleuth_prep</monospace> for <italic>limma</italic> and <italic>sleuth</italic>, respectively.</p>
      <p>For <italic>DESeq2, EBSeq, limma</italic> and <italic>SAMseq</italic>, we provided the methods with counts on the gene- or transcript-level generated by the <italic>tximport</italic> package (<xref rid="B8" ref-type="bibr">8</xref>), using the <italic>lengthScaledTPM</italic> method. For the two balanced batches experiment, we provided all methods with the batch variable, except <italic>EBSeq</italic> and <italic>SAMseq</italic> which do not have such an option. For <italic>EBSeq</italic> and<italic>SAMseq</italic>, for the two batch experiment, we first adjusted the counts using the known batch variable and the <monospace>removeBatchEffect</monospace> function in the <italic>limma</italic> (<xref rid="B38" ref-type="bibr">38</xref>) package, which improved the two methods' performance. For <italic>sleuth</italic> we directly provided <italic>kallisto</italic> quantification files to the method, and for detection of DGE, changes in the total expression of all the transcripts of a gene across condition, we used the count summarization option.</p>
      <p>Nonparametric methods have the advantage of being robust to outliers in sequencing data. To evaluate the robustness of our method, we introduced outliers into the counts of three randomly chosen transcripts that were not differentially expressed in the simulation. For each of these transcripts, we randomly selected one sample among the 12 total samples, and multiplied the estimated counts and the Gibbs samples by 1000. We compared the <italic>q</italic>-values or adjusted <italic>P</italic>-values of these three transcripts from <italic>Swish, limma, DESeq2</italic> and <italic>EBSeq</italic> (<italic>Swish</italic>, compared to three parametric methods that can take as input the modified count matrices). For <italic>DESeq2</italic>, we turned off the Cook’s-distance-based filtering procedure, to demonstrate the sensitivity of the un-filtered test results to outliers.</p>
    </sec>
    <sec id="SEC2-10">
      <title>Highly replicated RNA-seq datasets</title>
      <p>To assess the performance of <italic>Swish</italic> on real bulk RNA-seq datasets, in particular its control of the target FDR, we downloaded two datasets that contain a large number of biological replicates, which make them useful for benchmarking statistical methods for differential expression analysis. The first dataset includes 43 high quality biological replicates of wild type <italic>Saccharomyces cerevisiae</italic> (<xref rid="B39" ref-type="bibr">39</xref>). Random sets of 10, 20, 30 and 40 samples were chosen from the total of 43 samples, and randomly split into two groups to form test datasets. For each sample size, we repeat the resampling process 100 times. The second dataset includes 16 high quality biological replicates of wild type <italic>Arabidopsis thaliana</italic> (<xref rid="B40" ref-type="bibr">40</xref>). Again, random sets of 10 samples, or the entire dataset of 16 samples was chosen, and randomly split into two groups. Partitions of the data were chosen to balance the number of samples from batch 1, as we found this batch to separate from batches 2 and 3 in exploratory data analysis (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S2</xref>). Again for each sample size, we repeated the resampling process 100 times. For the yeast dataset, we focused on gene expression, while for the <italic>Arabidopsis</italic> dataset, we investigated both gene and transcript expression. As the samples in all cases were from the same experimental condition, and were chosen to balance with respect to technical variation when present, we do not expect any genes or transcripts to be reported as differentially expressed. We focused on <italic>Swish, SAMseq</italic> and <italic>limma</italic> for this analysis, as <italic>limma</italic> had strong control of the FDR in many cases in the simulated data, and because <italic>Swish</italic> is an extension of the <italic>SAMseq</italic> method. For each method, on each random null dataset we recorded the proportion of genes or transcripts reported in an FDR set for a 5% target, which can be interpreted as a false positive rate (FPR).</p>
    </sec>
    <sec id="SEC2-11">
      <title>Single cell RNA-seq simulation</title>
      <p>In order to assess the ability of <italic>Swish</italic> to make use of uncertainty information contained in inferential replicates for single cell RNA-seq, we constructed a simulation combining the <italic>splatter</italic> (<xref rid="B41" ref-type="bibr">41</xref>) and <italic>polyester</italic> (<xref rid="B29" ref-type="bibr">29</xref>) Bioconductor packages. We used the human reference cDNA transcripts from Ensembl release 95, and simulated gene expression for 35 583 genes. Read counts were simulated for 40 cells in two groups using <italic>splatter</italic> with <italic>DE factor location</italic> of 3 on the log<sub>2</sub> scale, and <italic>DE factor scale</italic> of 1 on the log2 scale. 10% of genes were chosen to be differentially expressed. Stranded single-end reads of length 100 bp were generated using <italic>polyester</italic>, drawing from the 400 bp closest to the 3′ end of one of the transcripts per gene, unless the transcript was shorter than 400 bp in which fragments were drawn from the entire transcript. This aspect of the simulation was chosen to best reflect 3′-tagged scRNA-seq data, in which there is more uncertainty in assigning reads to genes, compared to full-length RNA-seq data. Gene-level expression was estimated by running <italic>Salmon</italic> using the Ensembl full length cDNA reference transcripts as the index, without length correction (as recommended for 3′-tagged reads) and summarizing counts to the gene level with <italic>tximport</italic>.</p>
    </sec>
    <sec id="SEC2-12">
      <title>Single cell RNA-seq of mouse neurons</title>
      <p>We downloaded a dataset of scRNA-seq of the developing mouse brain in order to evaluate the performance of <italic>Swish</italic> on RNA-seq counts with a different distribution and with more gene-level inferential uncertainty than bulk RNA-seq. In this dataset, cells from the cortex, hippocampus and ventricular zone of a embryonic (E18) mouse were dissociated and sequenced on the 10x chromium pipeline. scRNA-seq data was quantified by <italic>Alevin</italic> (<xref rid="B18" ref-type="bibr">18</xref>) v0.13.0 with the default command line parameters along with <monospace>–numCellBootstraps 30</monospace> to generate 30 bootstrap estimated count matrices. The total number of cells was 931, and the number of genes was 52,325 (Gencode (<xref rid="B32" ref-type="bibr">32</xref>) release M16 mouse reference transcripts).</p>
      <p>In a comprehensive benchmark, Soneson and Robinson (<xref rid="B42" ref-type="bibr">42</xref>) compared DE methods designed for both scRNA-seq and bulk RNA-seq, and found that the Mann–Whitney Wilcoxon test (<xref rid="B24" ref-type="bibr">24</xref>) had favorable performance compared to numerous other methods in detection of DE genes across cells. However, the Wilcoxon test was listed as having the downside of not accommodating complex designs (e.g. covariate control, sample pairing or interaction terms). We therefore compared <italic>Swish</italic> to the Wilcoxon test statistic in detection of genes differentially expressed across clusters.</p>
      <p><italic>Seurat</italic> (<xref rid="B43" ref-type="bibr">43</xref>) was used to cluster the cells in the dataset. First, cells with low quality were removed, based on quality control plots (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S3</xref>). Those cells having &lt;1500 or &gt;6500 genes expressed were removed based on the quality control plots. Additionally, those cells with &gt;4% of mitochondrial genes detected were removed. These filters resulted in 835 cells remaining in the dataset. For <italic>Seurat</italic> clustering, gene counts were then normalized by their total count, multiplied by 10 000, and the shifted logarithm was applied, with a shift of 1 to preserve zeros.</p>
      <p>Only highly variable genes were used for clustering by <italic>Seurat</italic>, which was determined by calculating the mean expression of scaled counts and dispersion for each gene, binning genes by mean expression into 20 bins, and calculating <italic>z</italic>-scores for <italic>s</italic><sup>2</sup>/μ, (the sample variance over the sample mean) within each bin. The highly variable genes were defined as those with mean expression between 0.0125 and 3 on the natural log scale and <italic>z</italic>-score of 0.5 or larger. A linear model was fit to the log scaled counts, to further remove any technical artifacts associated with the total number of UMIs detected per cell and with the percent of mitochondrial genes detected. The top 10 principal components of residuals of highly variable genes were used to cluster the cells, using <italic>Seurat</italic>’s graph-based unsupervised clustering method.</p>
      <p>After defining clusters using the highly variable genes, we returned to the matrix of estimated counts and attempted to find genes which were differentially expressed across two specific clusters. The clusters were chosen based on expression of neural differentiation marker genes reported by a previous study (<xref rid="B44" ref-type="bibr">44</xref>). We applied both <italic>Swish</italic> and a standard two-sample Wilcoxon test to the scaled counts of cells in the two clusters. We scaled the counts using size factors estimated with the setting <monospace>type = 'poscounts'</monospace> in the <italic>DESeq2</italic> package (<xref rid="B11" ref-type="bibr">11</xref>), as recommended for scRNA-seq differential expression analysis (<xref rid="B45" ref-type="bibr">45</xref>). Genes without a count of three or more in five or more cells were removed prior to the DE analysis across clusters. <italic>Swish</italic> produces a <italic>q</italic>-value, while the <italic>P</italic>-values from the Wilcoxon test were adjusted using the Benjamini-Hochberg (<xref rid="B28" ref-type="bibr">28</xref>) method to produce nominal FDR bounded sets.</p>
      <p>To assess the performance of <italic>Swish</italic> compared to the two-sample Wilcoxon test on real scRNA-seq data, we sought an independent dataset that we could regard as a pseudo-gold-standard. As scRNA-seq may have its own systematic biases, we focused for validation on a bulk RNA-seq dataset also of embryonic (E14.5) mouse brain, which employed laser-capture microdissection in order to isolate various regions of the brain (<xref rid="B46" ref-type="bibr">46</xref>). We downloaded and quantified five samples from the ventricular zone (VZ) and five samples of the cortical plate (CP) using <italic>Salmon</italic>, and then analyzed the bulk RNA-seq data on the gene-level using <italic>tximport</italic> followed by <italic>DESeq2</italic>.</p>
    </sec>
  </sec>
  <sec sec-type="results" id="SEC3">
    <title>RESULTS</title>
    <sec id="SEC3-1">
      <title>Simulation of bulk RNA-seq</title>
      <p>We evaluated the InfRV in the simulated bulk RNA-seq dataset at the gene and transcript level. At the transcript level, there are two main sources of abundance uncertainty: (i) among different transcripts within a gene and (ii) due to homologous sequence of transcripts across genes. At the gene level, we observed substantially less abundance uncertainty, as expected (Figure <xref ref-type="fig" rid="F1">1</xref>). At the gene level, the uncertainty among transcripts within a gene has been collapsed, and only the latter source of uncertainty remains, also noted by Soneson <italic>et al.</italic> (<xref rid="B8" ref-type="bibr">8</xref>).</p>
      <fig id="F1" orientation="portrait" position="float">
        <label>Figure 1.</label>
        <caption>
          <p>Mean of InfRV over samples for genes and transcripts in the simulation studies (log10 scale). InfRV is binned by increments of 0.1, so that 10 bins span an order of magnitude. (<bold>A</bold>) Gene level for the single batch experiment. (<bold>B</bold>) Transcript level for the single batch experiment.</p>
        </caption>
        <graphic xlink:href="gkz622fig1"/>
      </fig>
      <p>At the gene level, where there was less quantification uncertainty, <italic>Swish</italic> had similar performance as DGE methods overall (Figure <xref ref-type="fig" rid="F2">2</xref>). For the experiment with a single batch, <italic>Swish</italic> had similar TPR and FDR to <italic>EBSeq, limma, SAMseq</italic> and <italic>sleuth</italic>, and better control of FDR compared to <italic>DESeq2</italic>. <italic>Swish</italic> had improved FDR control compared to <italic>SAMseq</italic>, but only slightly so, and this minor performance difference was expected as there was relatively low InfRV compared to transcript-level analysis. For the experiment with two batches, <italic>Swish, limma</italic>, and <italic>EBSeq</italic> showed the best performance, with good sensitivity and control of FDR. <italic>Swish</italic> had tight control of FDR for the 5% and 10% target while <italic>SAMseq</italic> had observed FDR of 10% for the 5% target, and observed FDR of 18% for the 10% target (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S4</xref>). <italic>sleuth</italic> exhibited loss of control of the FDR for the 5% and 10% target in the two batch experiment (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S5</xref>).</p>
      <fig id="F2" orientation="portrait" position="float">
        <label>Figure 2.</label>
        <caption>
          <p>True positive rate (y-axis) over false discovery rate (x-axis) for DGE analysis with only one batch of samples, with six samples in each of the two conditions. The first panel depicts overall performance, while the subsequent three panels depict the genes stratified into thirds by InfRV averaged over samples. For this and all following iCOBRA plots, the three circles per method indicate performance at nominal FDR cutoffs of 1%, 5% and 10%, with the x-axis providing the observed FDR and the three FDR cutoffs indicated with black vertical dashed lines. A filled circle indicates observed FDR less than or equal to nominal FDR, while an open circle indicates greater than nominal FDR.</p>
        </caption>
        <graphic xlink:href="gkz622fig2"/>
      </fig>
      <p>At the transcript level, <italic>Swish</italic> had consistently high sensitivity and good control of FDR, where other methods either had low sensitivity or loss of FDR control in some setting. <italic>Swish</italic> controlled FDR for all nominal FDR targets (1%, 5%, and 10%), while <italic>SAMseq</italic> tended to exceed the 5% and 10% target for transcripts with medium-to-high InfRV, both for the single batch experiment (Figure <xref ref-type="fig" rid="F3">3</xref>), and the two batch experiment (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S6</xref>). As opposed to gene-level analysis where there is relatively low InfRV, at the transcript level the performance difference between <italic>Swish</italic> and <italic>SAMseq</italic> is most obvious for the transcripts with the most quantification uncertainty, as expected. This can be seen in the bottom right panels of Figure <xref ref-type="fig" rid="F3">3</xref> and <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S6</xref>, which show the top third of transcripts in the dataset by InfRV. <italic>limma</italic> had reduced sensitivity for all InfRV categories, for both experiments, due to filtering of DTE transcripts by <monospace>filterByExpr</monospace> (<xref rid="B47" ref-type="bibr">47</xref>). With a less stringent filtering rule, <italic>limma</italic> showed improved sensitivity compared to its default settings, but still &gt;10% below the sensitivity of other methods controlling the target FDR including <italic>Swish</italic> (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S7</xref>). <italic>EBSeq</italic> had high sensitivity but loss of FDR control for the transcripts with high InfRV. <italic>sleuth</italic> performed well in the single batch experiment, but lost control of FDR for the 5% and 10% target in the two batch experiment (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S8</xref>).</p>
      <fig id="F3" orientation="portrait" position="float">
        <label>Figure 3.</label>
        <caption>
          <p>True positive rate (y-axis) over false discovery rate (x-axis) for DTE analysis with only one batch of samples, with six samples in each of the two conditions. As in Figure <xref ref-type="fig" rid="F2">2</xref>, the first panel depicts overall performance, while the subsequent three panels depict the transcripts stratified into thirds by InfRV averaged over samples.</p>
        </caption>
        <graphic xlink:href="gkz622fig3"/>
      </fig>
      <p>We assessed the Mann–Whitney–Wilcoxon test on scaled counts, with linear-model-based removal of batch effect for the two batch experiment, followed by multiple test correction with the method of Benjamini–Hochberg (<xref rid="B28" ref-type="bibr">28</xref>) to control FDR. In the gene-level and transcript-level experiments, for both one and two batch experiments, use of the Mann–Whitney–Wilcoxon test performed similarly to <italic>SAMseq</italic> (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figures S9–S12</xref>).</p>
      <p>We examined how the methods performed on the simulation across a finer grid of sample sizes. We focused on transcript-level analysis, and on the one batch experiment, and varied the per-group sample size over the range, <italic>n</italic> ∈ {3, 4, 5, 9, 12, 15, 18, 20}. At sample sizes 3 and 4, <italic>Swish</italic> returned the same set of transcripts for the 1%, 5% and 10% target FDR, which controlled at 10% FDR for n=3, and controlled at 1%, 5% and 10% for <italic>n</italic> = 4 (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figures S13 and S14</xref>). In contrast, <italic>SAMseq</italic> returned no transcripts for any target FDR at n=3, and no transcripts for the 1% target FDR at n=4. The n=5 experiment (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S15</xref>) had similar results to <italic>n</italic> = 6 (Figure <xref ref-type="fig" rid="F3">3</xref>), but with lower sensitivity for <italic>SAMseq</italic> for the 1% target. In the experiments from <italic>n</italic> = 9 to <italic>n</italic> = 20, the top third transcripts by InfRV revealed a difference between <italic>Swish</italic> and <italic>SAMseq</italic>, where the latter exceeds the 5% and 10% FDR targets. In these higher sample size experiments, <italic>sleuth</italic> did not control FDR for the 5% and 10% target, or the 1% target for <italic>n</italic> starting at 15 (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figures S16-S25</xref>).</p>
      <p>When the count for a single sample for a null transcript was modified to be an extreme outlier, <italic>Swish</italic> did not call this transcript as differentially expressed, with <italic>q</italic>-value close to one, as did <italic>limma</italic> with its adjusted <italic>P</italic>-values (<xref ref-type="supplementary-material" rid="sup1">Supplementary Table S1</xref>). <italic>DESeq2</italic> with its outlier flagging procedure turned off and <italic>EBSeq</italic> with default settings returned very small adjusted <italic>P</italic>-values for these genes with inserted outliers. This case demonstrated another benefit of nonparametric models in their robustness to model mis-specification or outliers, also demonstrated by Li and Tibshirani (<xref rid="B9" ref-type="bibr">9</xref>).</p>
      <p>Overall, <italic>Swish</italic> performed well at the gene level, out-performing the method <italic>SAMseq</italic>, which it is based upon, in the two batch experiment in terms of FDR control. <italic>Swish</italic> out-performed other methods at the transcript level, both for the single and two batch experiments, where other methods either had reduced sensitivity or loss of FDR in some setting.</p>
    </sec>
    <sec id="SEC3-2">
      <title>Highly replicated RNA-seq datasets</title>
      <p>In the two highly replicated bulk RNA-seq datasets <italic>Swish</italic> had lower false positive rate compared to <italic>SAMseq</italic>, and similar to <italic>limma</italic>. In both datasets, in which no features should be detected as differentially expressed by construction, <italic>Swish</italic> in particular had fewer random partitions in which &gt;5% of the features were called differentially expressed. In the yeast dataset <italic>Swish</italic> rarely called &gt;5% of the features as differentially expressed, while <italic>SAMseq</italic> had more such iterations where &gt;5% or even up to 40% of the features would be called differentially expressed (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figures S26-S29</xref>). Overall <italic>limma</italic> tended to call very few genes as differentially expressed in the null comparisons. Similar relative performance could be seen in the <italic>Arabidopsis</italic> dataset, though overall there were fewer iterations with high rates of false positive calls for any method, compared to the yeast dataset. At the transcript level, there were rarely any false positive calls for any method (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S30 and S31</xref>). At the gene level, there were still few calls, but <italic>SAMseq</italic> tended to have more iterations with nonzero false positive rate, compared to the other two methods (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S32 and S33</xref>).</p>
    </sec>
    <sec id="SEC3-3">
      <title>scRNA-seq simulation</title>
      <p>The global performance of <italic>Swish</italic> and the Wilcoxon test was similar on the <italic>splatter-polyester</italic> simulation. Still, we identified a number of individual null genes in which the Wilcoxon test followed by Benjamini-Hochberg adjustment resulted in a very low adjusted <italic>P</italic>-value, while <italic>Swish</italic> did not detect these genes at a 5% nominal FDR target. After simulating scRNA-seq counts for two groups of 20 cells each, and testing at a target 5% FDR, <italic>Swish</italic> had 91.7% sensitivity and an observed FDR of 5.3%, while the Wilcoxon test had 92.4% sensitivity and an observed FDR of 5.7%. However, we detected a number of null genes with spurious expression values in an MA-plot of the dataset (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S34</xref>). These null genes were assigned non-zero estimates of expression—and differentially so across the two simulated groups of cells — due to sequence homology with other genes which were simulated as differentially expressed. We focused on 14 genes that could be identified in this MA plot, which had a total count across cells &gt;5, had a <italic>t</italic>-statistic &gt;5, and had InfRV &gt;0.2. For all of these 14 genes, <italic>Swish</italic> gave a greatly increased <italic>q</italic>-value (less significant) compared to the adjusted <italic>P</italic>-value from the Wilcoxon test (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S35</xref>), such that 9 of the genes were not detected in a 5% nominal FDR set. Plotting the inferential replicates for all of the 40 cells for these genes revealed that there was extensive inferential uncertainty for the non-zero counts for these genes (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S36</xref>). While examining only a point estimate of the expression may lead a method to infer differential expression for such null genes, taking the inferential uncertainty into account during the statistical testing lead to more correct results for these genes, while not affecting the overall sensitivity of the method for truly differentially expressed genes.</p>
    </sec>
    <sec id="SEC3-4">
      <title>scRNA-seq of mouse neurons</title>
      <p>We evaluated the extent to which inclusion of uncertainty in the gene-level abundance would affect differential expression in an scRNA-seq dataset. As described in the Materials and Methods, <italic>Seurat</italic> was used to identify clusters in a dataset of 835 cells from embryonic mouse brain. <italic>Seurat</italic> identified a total of nine clusters, visualized in <xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S37</xref>. Expression level of known cell-type markers for developing mouse brain, as reported by Loo <italic>et al.</italic> (<xref rid="B44" ref-type="bibr">44</xref>), was overlaid on the t-Distributed Stochastic Neighbor Embedding (tSNE) (<xref rid="B48" ref-type="bibr">48</xref>) plot. <italic>Eomes</italic>, a gene expressed in neural progenitor cells, was highly expressed in cluster 7, while <italic>Neurod2</italic>, a marker of differentiated neurons, was highly expressed in cluster 5 (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S38</xref>). We compared the test results of a two-sample Mann-Whitney Wilcoxon (<xref rid="B24" ref-type="bibr">24</xref>) test to <italic>Swish</italic> across groups of cells from cluster 5 and cluster 7. We defined sets of genes which were called by <italic>Swish</italic> or the Wilcoxon test at a 5% threshold.</p>
      <p>We used an independent bulk RNA-seq dataset as a pseudo-gold-standard, to validate the calls of <italic>Swish</italic> and the Wilcoxon test (<xref rid="B46" ref-type="bibr">46</xref>). This dataset contains bulk RNA-seq of five samples from the ventricular zone (VZ) and five samples from the cortical plate (CP) of mice embryos of a similar age (E14.5) to the mice embryos in the scRNA-seq data (E18). The brain regions were isolated using laser-capture microdissection. We chose the VZ and CP regions from the Fietz <italic>et al.</italic> (<xref rid="B46" ref-type="bibr">46</xref>) dataset to have highest correlation with clusters 7 and 5 from the scRNA-seq dataset: the VZ is enriched with progenitor cells marked by <italic>Eomes</italic>, while the CP is enriched with differentiated neurons marked by <italic>Neurod2</italic>. We refer to the bulk RNA-seq dataset as a ‘pseudo-gold-standard’, as the regions produced by microdissection contain various cell types, and so the comparison of bulk with <italic>in silico</italic> sorted single cells is not exact. Nevertheless, a Pearson correlation of 0.61 was obtained when comparing the log<sub>2</sub> fold changes from the scRNA-seq, cluster 7 versus cluster 5, with the log2 fold changes from the bulk RNA-seq, VZ versus CP, so the pseudo-gold-standard should therefore be useful for assessing method performance.</p>
      <p>Comparing random subsets of 20 cells each (40 cells total) from cluster 7 and cluster 5 did not reveal large differences in performance between <italic>Swish</italic> and Wilcoxon on this particular dataset, in contrast to the clear enrichment of false positives seen in the <italic>splatter-polyester</italic> scRNA-seq simulation. However, when randomly selecting subsets of 10 cells each (20 cells total) from the two clusters, <italic>Swish</italic> had a clear advantage over Wilcoxon tests in terms of number of genes recovered at the same observed FDR level (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S39</xref>). For the 5% and 10% target FDR, <italic>Swish</italic> was able to call 50 more genes than the Wilcoxon test, at comparable observed FDR, increasing the number of reported genes by more than half at 5% target FDR and by more than one third at 10% target FDR. Both <italic>Swish</italic> and Wilcoxon test were close to hitting their 5% and 10% FDR targets on the dataset of 20 cells total, while they both tended to exceed the targets on the dataset with 40 cells total. Some excess may be attributable to the fact that the VZ and CP brain regions comprise more than the individual cell populations isolated in clusters 7 and 5 from the scRNA-seq analysis.</p>
    </sec>
  </sec>
  <sec sec-type="discussion" id="SEC4">
    <title>DISCUSSION</title>
    <p>Many parametric models have been proposed to include quantification uncertainty into statistical testing procedures when evaluating differential transcript or gene expression. We extended an existing nonparametric framework, <italic>SAMseq</italic>, through the incorporation of inferential replicate count matrices, so that the test statistic better reflects the uncertainty of the estimated counts. We show that this extension recovers control of FDR in particular for transcripts with high inferential relative variance. We used posterior samples generated by a Gibbs sampler with thinning to reduce autocorrelation, although bootstrapping of reads to generate inferential replicates is also compatible with our proposed method. <italic>Swish</italic> additionally extends <italic>SAMseq</italic> by allowing for control of discrete batches using the stratified Wilcoxon test, and allowing for analysis of paired samples using the Wilcoxon signed-rank test. We note that <italic>Swish</italic> makes use of inferential replicates that provide information about uncertainty due to the assignment of reads. Other sources of uncertainty, such as experimental uncertainty, may not be captured by the inferential replicates. A simple example is the uncertainty of expression for genes which receive no reads from a lowly sequenced sample. Nevertheless, previous work has shown that in some cases, correct quantification can be recovered despite missing fragments due to common technical biases in sequencing data, to the degree that the bias can be modeled (<xref rid="B19" ref-type="bibr">19</xref>,<xref rid="B30" ref-type="bibr">30</xref>).</p>
    <p><italic>Swish</italic> has the greatest advantage over other competing methods at the transcript level, while it performs similarly to other methods at the gene level. We additionally demonstrated the use of <italic>Swish</italic> on scRNA-seq counts generated by the <italic>Alevin</italic> method, making use of bootstrap inferential replicates at the gene level. On simulated scRNA-seq data, we found clear evidence of false positives which would be called by a standard rank-based method, which are appropriately not called as differentially expressed by <italic>Swish</italic> due to its reliance on inferential replicates in the testing procedure. On the mouse neurons dataset, we found that <italic>Swish</italic> outperformed the Wilcoxon test for comparisons of small numbers of cells (e.g. 20 cells total), but performed similar for larger sets of cells, at least in so far as we could detect using a pseudo-gold-standard dataset for validation.</p>
    <p>We note that, although we assessed the method on a real dataset from the 10x chromium pipeline, <italic>Alevin</italic> followed by <italic>Swish</italic> on inferential replicates could likewise be performed on other platforms such as Fluidigm—though <italic>Alevin</italic>’s bias model could be further optimized for alternate platforms. We anticipate that taking into account uncertainty from inferential replicates for scRNA-seq will be equally valuable for gene-level differential expression for any 3′-tagged protocol, and for transcript-level differential expression for any full length protocol. In this scRNA-seq analysis, we did not take into account that we first clustered the data based on highly variable genes, and then performed differential analysis using those and other genes, which may generate anti-conservative inference as noted recently by Zhang <italic>et al.</italic> (<xref rid="B49" ref-type="bibr">49</xref>). We are interested in extensions which may alleviate this problem and in general help to avoid comparisons across unstable clusters (<xref rid="B50" ref-type="bibr">50–53</xref>).</p>
    <p>Some of the limitations of our proposed work include the types of experiments that it can be used to analyze. Because it relies on permutation of samples to generate a null distribution over all transcripts or genes, <italic>SAMseq</italic> and <italic>Swish</italic> in practice do not necessarily have sufficient power to detect differential expression when the sample size is &lt;4 per group. Additionally, certain terms which can be included in linear models, such as controlling for continuous variables, cannot be easily incorporated into the nonparametric framework. We focused on inference across a discrete nuisance covariate, for example sample preparation batches, which motivated the stratified test statistic, as well as inference across a discrete secondary covariate of interest, for example a secondary treatment, which motivated the difference-across-two-groups method. However, we cannot yet accommodate more continuous measures of batch, such as those estimated by <italic>RUVSeq</italic> (<xref rid="B54" ref-type="bibr">54</xref>) or <italic>svaseq</italic> (<xref rid="B55" ref-type="bibr">55</xref>), unless such factors of unwanted variation could be discretized without substantial loss of information. Currently, <italic>Swish</italic> supports two group comparisons, with discrete covariate correction, sample pairing, and comparison of condition effects across a secondary covariate, although we could extend to other analysis types already supported by <italic>SAMseq</italic>, including multi-group comparisons via the Kruskal-Wallis statistic, quantitative association via the Spearman correlation, or survival analysis via the Cox proportional hazards model.</p>
  </sec>
  <sec id="SEC5">
    <title>CODE AVAILABILITY</title>
    <p>The <monospace>swish</monospace> function is available in the <italic>fishpond</italic> R/Bioconductor (<xref rid="B20" ref-type="bibr">20</xref>) package at <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/fishpond">https://bioconductor.org/packages/fishpond</ext-link>. The implementation is efficient, with vectorized code for row-wise ranking calculation via the <italic>matrixStats</italic> package. The software runs in comparable or faster time to <italic>DESeq2</italic>, taking 1-2 s per 1000 genes for small datasets, e.g. total <italic>n</italic> ∈ [10−20]. For larger datasets (total <italic>n</italic> &gt; 100), <italic>Swish</italic> scales better than <italic>DESeq2</italic> (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S40</xref>). The default number of inferential replicate samples (20) and permutations (30) was used for timing.</p>
    <p>The package contains a detailed vignette with live code examples, showing how to import <italic>Salmon</italic> quantification files using the <italic>tximeta</italic> package, perform differential transcript or gene expression analysis with <monospace>swish</monospace>, and visualize results for each transcript or gene. The package vignette includes an example of a paired RNA-seq analysis, both a two group example and a differences across groups example. The software vignette leverages a subset of the RNA-seq data from a recent publication on human macrophage immune response (<xref rid="B56" ref-type="bibr">56</xref>) (<xref ref-type="supplementary-material" rid="sup1">Supplementary Figure S41</xref>).</p>
    <p>The scripts used to generate the Love <italic>et al.</italic> (<xref rid="B7" ref-type="bibr">7</xref>) simulation data are available at the following link: <ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.1410443">https://dx.doi.org/10.5281/zenodo.1410443</ext-link>. The scripts used in evaluating the methods here, and in analyzing the scRNA-seq dataset have been posted at the following link: <ext-link ext-link-type="uri" xlink:href="https://github.com/azhu513/swishPaper">https://github.com/azhu513/swishPaper</ext-link>.</p>
    <p>The versions of software used in the paper are: <italic>fishpond</italic> (<italic>Swish</italic> method): 0.99.32, <italic>samr</italic> (<italic>SAMseq</italic> method): 2.0, <italic>qvalue</italic>: 2.14.1, <italic>Salmon</italic>: 0.11.3, <italic>Alevin</italic>: 0.13.0, <italic>tximport</italic>: 1.10.1, <italic>kallisto</italic>: 0.44.0, <italic>sleuth</italic>: 0.30.0, <italic>DESeq2</italic>: 1.22.2, <italic>EBSeq</italic>: 1.22.1, <italic>limma</italic>: 3.38.3, <italic>Seurat</italic>: 2.3.4</p>
  </sec>
  <sec sec-type="data-availability" id="SEC6">
    <title>DATA AVAILABILITY</title>
    <p>The simulated data used to evaluate the methods is published in Love <italic>et al.</italic> (<xref rid="B7" ref-type="bibr">7</xref>). The raw read files can be accessed at the following links: <ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.1291375">https://doi.org/10.5281/zenodo.1291375</ext-link>, <ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.1291404">https://doi.org/10.5281/zenodo.1291404</ext-link>, <ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.2564176">https://doi.org/10.5281/zenodo.2564176</ext-link>, <ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.2564261">https://doi.org/10.5281/zenodo.2564261</ext-link>. The processed simulation quantification files can be accessed at the following link: <ext-link ext-link-type="doi" xlink:href="10.5281/zenodo.2564115">https://doi.org/10.5281/zenodo.2564115</ext-link>. The mouse neurons scRNA-seq dataset is available under the heading <italic>Chromium Demonstration (v2 Chemistry)</italic> &gt;<italic>Cell Ranger 2.1.0</italic> &gt;<italic>1k Brain Cells from an E18 Mouse</italic>, from <ext-link ext-link-type="uri" xlink:href="https://support.10xgenomics.com/single-cell-gene-expression/datasets">https://support.10xgenomics.com/single-cell-gene-expression/datasets</ext-link>. The mouse brain isolated bulk tissue RNA-seq data are available from the Gene Expression Omnibus with the accession number GSE38805.</p>
  </sec>
  <sec sec-type="supplementary-material">
    <title>Supplementary Material</title>
    <supplementary-material content-type="local-data" id="sup1">
      <label>gkz622_Supplemental_Files</label>
      <media xlink:href="gkz622_supplemental_files.zip">
        <caption>
          <p>Click here for additional data file.</p>
        </caption>
      </media>
    </supplementary-material>
  </sec>
</body>
<back>
  <ack id="ACK1">
    <title>ACKNOWLEDGEMENTS</title>
    <p>We thank Naim Rashid, Scott Van Buren, Yun Li, Jason Stein, Jeremy Simon and Frank Konietschke for useful discussions.</p>
  </ack>
  <sec id="SEC7">
    <title>SUPPLEMENTARY DATA</title>
    <p><ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/nar/article-lookup/doi/10.1093/nar/gkz622#supplementary-data">Supplementary Data</ext-link> are available at NAR Online.</p>
  </sec>
  <sec id="SEC9">
    <title>FUNDING</title>
    <p>M.I.L. is supported by R01 HG009937, R01 MH118349, P01 CA142538 and P30 ES010126. J.G.I. and A.Z. are supported by R01 GM070335 and P01 CA142538. A.S. and R.P. are supported by R01 HG009937; National Science Foundation award [CCF-1750472]; Chan Zuckerberg Initiative DAF, an advised fund of Silicon Valley Community Foundation [2018-182752]. Funding for open access charge: NHGRI [HG009937].</p>
    <p><italic>Conflict of interest statement</italic>. None declared.</p>
  </sec>
  <ref-list id="REF1">
    <title>REFERENCES</title>
    <ref id="B1">
      <label>1.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Glaus</surname>
 <given-names>P.</given-names></string-name>, <string-name><surname>Honkela</surname><given-names>A.</given-names></string-name>, <string-name><surname>Rattray</surname><given-names>M.</given-names></string-name></person-group>
 <article-title>Identifying differentially expressed transcripts from RNA-seq data with biological variation</article-title>. <source>Bioinformatics</source>. <year>2012</year>; <volume>28</volume>:<fpage>1721</fpage>–<lpage>1728</lpage>.<pub-id pub-id-type="pmid">22563066</pub-id></mixed-citation>
    </ref>
    <ref id="B2">
      <label>2.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leng</surname>
 <given-names>N.</given-names></string-name>, <string-name><surname>Dawson</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Thomson</surname><given-names>J.A.</given-names></string-name>, <string-name><surname>Ruotti</surname><given-names>V.</given-names></string-name>, <string-name><surname>Rissman</surname><given-names>A.I.</given-names></string-name>, <string-name><surname>Smits</surname><given-names>B.M.G.</given-names></string-name>, <string-name><surname>Haag</surname><given-names>J.D.</given-names></string-name>, <string-name><surname>Gould</surname><given-names>M.N.</given-names></string-name>, <string-name><surname>Stewart</surname><given-names>R.M.</given-names></string-name>, <string-name><surname>Kendziorski</surname><given-names>C.</given-names></string-name></person-group>
 <article-title>EBSeq: an empirical Bayes hierarchical model for inference in RNA-seq experiments</article-title>. <source>Bioinformatics</source>. <year>2013</year>; <volume>29</volume>:<fpage>1035</fpage>–<lpage>1043</lpage>.<pub-id pub-id-type="pmid">23428641</pub-id></mixed-citation>
    </ref>
    <ref id="B3">
      <label>3.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trapnell</surname>
 <given-names>C.</given-names></string-name>, <string-name><surname>Roberts</surname><given-names>A.</given-names></string-name>, <string-name><surname>Goff</surname><given-names>L.</given-names></string-name>, <string-name><surname>Pertea</surname><given-names>G.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>D.</given-names></string-name>, <string-name><surname>Kelley</surname><given-names>D.R.</given-names></string-name>, <string-name><surname>Pimentel</surname><given-names>H.</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>S.L.</given-names></string-name>, <string-name><surname>Rinn</surname><given-names>J.L.</given-names></string-name>, <string-name><surname>Pachter</surname><given-names>L.</given-names></string-name></person-group>
 <article-title>Differential gene and transcript expression analysis of RNA-seq experiments with TopHat and Cufflinks</article-title>. <source>Nat. Protoc.</source><year>2012</year>; <volume>7</volume>:<fpage>562</fpage>.<pub-id pub-id-type="pmid">22383036</pub-id></mixed-citation>
    </ref>
    <ref id="B4">
      <label>4.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Al Seesi</surname>
 <given-names>S.</given-names></string-name>, <string-name><surname>Temate-Tiagueu</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Zelikovsky</surname><given-names>A.</given-names></string-name>, <string-name><surname>Măndoiu</surname><given-names>I.I.</given-names></string-name></person-group>
 <article-title>Bootstrap-based differential gene expression analysis for RNA-Seq data with and without replicates</article-title>. <source>BMC Genomics</source>. <year>2012</year>; <volume>15</volume>:<fpage>S2</fpage>.</mixed-citation>
    </ref>
    <ref id="B5">
      <label>5.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pimentel</surname>
 <given-names>H.</given-names></string-name>, <string-name><surname>Bray</surname><given-names>N.L.</given-names></string-name>, <string-name><surname>Puente</surname><given-names>S.</given-names></string-name>, <string-name><surname>Melsted</surname><given-names>P.</given-names></string-name>, <string-name><surname>Pachter</surname><given-names>L.</given-names></string-name></person-group>
 <article-title>Differential analysis of RNA-seq incorporating quantification uncertainty</article-title>. <source>Nat. Methods</source>. <year>2017</year>; <volume>14</volume>:<fpage>687</fpage>–<lpage>690</lpage>.<pub-id pub-id-type="pmid">28581496</pub-id></mixed-citation>
    </ref>
    <ref id="B6">
      <label>6.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Froussios</surname>
 <given-names>K.</given-names></string-name>, <string-name><surname>Mourão</surname><given-names>K.</given-names></string-name>, <string-name><surname>Simpson</surname><given-names>G.</given-names></string-name>, <string-name><surname>Barton</surname><given-names>G.</given-names></string-name>, <string-name><surname>Schurch</surname><given-names>N.</given-names></string-name></person-group>
 <article-title>Relative abundance of transcripts (RATs): identifying differential isoform abundance from RNA-seq [version 1; referees: awaiting peer review]</article-title>. <source>F1000Research</source>. <year>2019</year>; <volume>8</volume>:<fpage>213</fpage>.<pub-id pub-id-type="pmid">30906538</pub-id></mixed-citation>
    </ref>
    <ref id="B7">
      <label>7.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Love</surname>
 <given-names>M.I.</given-names></string-name>, <string-name><surname>Soneson</surname><given-names>C.</given-names></string-name>, <string-name><surname>Patro</surname><given-names>R.</given-names></string-name></person-group>
 <article-title>Swimming downstream: statistical analysis of differential transcript usage following Salmon quantification [version 3; referees: 3 approved]</article-title>. <source>F1000Research</source>. <year>2018</year>; <volume>7</volume>:<fpage>952</fpage>.<pub-id pub-id-type="pmid">30356428</pub-id></mixed-citation>
    </ref>
    <ref id="B8">
      <label>8.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Soneson</surname>
 <given-names>C.</given-names></string-name>, <string-name><surname>Love</surname><given-names>M.I.</given-names></string-name>, <string-name><surname>Robinson</surname><given-names>M.D.</given-names></string-name></person-group>
 <article-title>Differential analyses for RNA-seq: transcript-level estimates improve gene-level inferences [version 2; referees: 2 approved]</article-title>. <source>F1000Research</source>. <year>2016</year>; <volume>4</volume>:<fpage>1521</fpage>.</mixed-citation>
    </ref>
    <ref id="B9">
      <label>9.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>
 <given-names>J.</given-names></string-name>, <string-name><surname>Tibshirani</surname><given-names>R.</given-names></string-name></person-group>
 <article-title>Finding consistent patterns: a nonparametric approach for identifying differential expression in RNA-Seq data</article-title>. <source>Stat. Methods Med. Res.</source><year>2013</year>; <volume>22</volume>:<fpage>519</fpage>–<lpage>536</lpage>.<pub-id pub-id-type="pmid">22127579</pub-id></mixed-citation>
    </ref>
    <ref id="B10">
      <label>10.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Soneson</surname>
 <given-names>C.</given-names></string-name>, <string-name><surname>Delorenzi</surname><given-names>M.</given-names></string-name></person-group>
 <article-title>A comparison of methods for differential expression analysis of RNA-seq data</article-title>. <source>BMC Bioinformatics</source>. <year>2013</year>; <volume>14</volume>:<fpage>91</fpage>.<pub-id pub-id-type="pmid">23497356</pub-id></mixed-citation>
    </ref>
    <ref id="B11">
      <label>11.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Love</surname>
 <given-names>M.I.</given-names></string-name>, <string-name><surname>Huber</surname><given-names>W.</given-names></string-name>, <string-name><surname>Anders</surname><given-names>S.</given-names></string-name></person-group>
 <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol.</source><year>2014</year>; <volume>15</volume>:<fpage>550</fpage>.<pub-id pub-id-type="pmid">25516281</pub-id></mixed-citation>
    </ref>
    <ref id="B12">
      <label>12.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kolodziejczyk</surname>
 <given-names>A.A.</given-names></string-name>, <string-name><surname>Kim</surname><given-names>J.K.</given-names></string-name>, <string-name><surname>Svensson</surname><given-names>V.</given-names></string-name>, <string-name><surname>Marioni</surname><given-names>J.C.</given-names></string-name>, <string-name><surname>Teichmann</surname><given-names>S.A.</given-names></string-name></person-group>
 <article-title>The technology and biology of single-cell RNA sequencing</article-title>. <source>Mol. Cell</source>. <year>2015</year>; <volume>58</volume>:<fpage>610</fpage>–<lpage>620</lpage>.<pub-id pub-id-type="pmid">26000846</pub-id></mixed-citation>
    </ref>
    <ref id="B13">
      <label>13.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Islam</surname>
 <given-names>S.</given-names></string-name>, <string-name><surname>Zeisel</surname><given-names>A.</given-names></string-name>, <string-name><surname>Joost</surname><given-names>S.</given-names></string-name>, <string-name><surname>La Manno</surname><given-names>G.</given-names></string-name>, <string-name><surname>Zajac</surname><given-names>P.</given-names></string-name>, <string-name><surname>Kasper</surname><given-names>M.</given-names></string-name>, <string-name><surname>Lönnerberg</surname><given-names>P.</given-names></string-name>, <string-name><surname>Linnarsson</surname><given-names>S.</given-names></string-name></person-group>
 <article-title>Quantitative single-cell RNA-seq with unique molecular identifiers</article-title>. <source>Nat. Methods</source>. <year>2014</year>; <volume>11</volume>:<fpage>163</fpage>.<pub-id pub-id-type="pmid">24363023</pub-id></mixed-citation>
    </ref>
    <ref id="B14">
      <label>14.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname>
 <given-names>G.X.</given-names></string-name>, <string-name><surname>Terry</surname><given-names>J.M.</given-names></string-name>, <string-name><surname>Belgrader</surname><given-names>P.</given-names></string-name>, <string-name><surname>Ryvkin</surname><given-names>P.</given-names></string-name>, <string-name><surname>Bent</surname><given-names>Z.W.</given-names></string-name>, <string-name><surname>Wilson</surname><given-names>R.</given-names></string-name>, <string-name><surname>Ziraldo</surname><given-names>S.B.</given-names></string-name>, <string-name><surname>Wheeler</surname><given-names>T.D.</given-names></string-name>, <string-name><surname>McDermott</surname><given-names>G.P.</given-names></string-name>, <string-name><surname>Zhu</surname><given-names>J.</given-names></string-name><etal>et al</etal>.</person-group>
 <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat. Commun.</source><year>2017</year>; <volume>8</volume>:<fpage>14049</fpage>.<pub-id pub-id-type="pmid">28091601</pub-id></mixed-citation>
    </ref>
    <ref id="B15">
      <label>15.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Macosko</surname>
 <given-names>E.Z.</given-names></string-name>, <string-name><surname>Basu</surname><given-names>A.</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R.</given-names></string-name>, <string-name><surname>Nemesh</surname><given-names>J.</given-names></string-name>, <string-name><surname>Shekhar</surname><given-names>K.</given-names></string-name>, <string-name><surname>Goldman</surname><given-names>M.</given-names></string-name>, <string-name><surname>Tirosh</surname><given-names>I.</given-names></string-name>, <string-name><surname>Bialas</surname><given-names>A.R.</given-names></string-name>, <string-name><surname>Kamitaki</surname><given-names>N.</given-names></string-name>, <string-name><surname>Martersteck</surname><given-names>E.M.</given-names></string-name><etal>et al</etal>.</person-group>
 <article-title>Highly parallel genome-wide expression profiling of individual cells using nanoliter droplets</article-title>. <source>Cell</source>. <year>2015</year>; <volume>161</volume>:<fpage>1202</fpage>–<lpage>1214</lpage>.<pub-id pub-id-type="pmid">26000488</pub-id></mixed-citation>
    </ref>
    <ref id="B16">
      <label>16.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klein</surname>
 <given-names>A.M.</given-names></string-name>, <string-name><surname>Mazutis</surname><given-names>L.</given-names></string-name>, <string-name><surname>Akartuna</surname><given-names>I.</given-names></string-name>, <string-name><surname>Tallapragada</surname><given-names>N.</given-names></string-name>, <string-name><surname>Veres</surname><given-names>A.</given-names></string-name>, <string-name><surname>Li</surname><given-names>V.</given-names></string-name>, <string-name><surname>Peshkin</surname><given-names>L.</given-names></string-name>, <string-name><surname>Weitz</surname><given-names>D.A.</given-names></string-name>, <string-name><surname>Kirschner</surname><given-names>M.W.</given-names></string-name></person-group>
 <article-title>Droplet barcoding for single-cell transcriptomics applied to embryonic stem cells</article-title>. <source>Cell</source>. <year>2015</year>; <volume>161</volume>:<fpage>1187</fpage>–<lpage>1201</lpage>.<pub-id pub-id-type="pmid">26000487</pub-id></mixed-citation>
    </ref>
    <ref id="B17">
      <label>17.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smith</surname>
 <given-names>T.</given-names></string-name>, <string-name><surname>Heger</surname><given-names>A.</given-names></string-name>, <string-name><surname>Sudbery</surname><given-names>I.</given-names></string-name></person-group>
 <article-title>UMI-tools: modeling sequencing errors in unique molecular identifiers to improve quantification accuracy</article-title>. <source>Genome Res.</source><year>2017</year>; <volume>27</volume>:<fpage>491</fpage>–<lpage>499</lpage>.<pub-id pub-id-type="pmid">28100584</pub-id></mixed-citation>
    </ref>
    <ref id="B18">
      <label>18.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Srivastava</surname>
 <given-names>A.</given-names></string-name>, <string-name><surname>Malik</surname><given-names>L.</given-names></string-name>, <string-name><surname>Smith</surname><given-names>T.S.</given-names></string-name>, <string-name><surname>Sudbery</surname><given-names>I.</given-names></string-name>, <string-name><surname>Patro</surname><given-names>R.</given-names></string-name></person-group>
 <article-title>Alevin efficiently estimates accurate gene abundances from dscRNA-seq data</article-title>. <source>Genome Biol.</source><year>2019</year>; <volume>20</volume>:<fpage>65</fpage>.<pub-id pub-id-type="pmid">30917859</pub-id></mixed-citation>
    </ref>
    <ref id="B19">
      <label>19.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patro</surname>
 <given-names>R.</given-names></string-name>, <string-name><surname>Duggal</surname><given-names>G.</given-names></string-name>, <string-name><surname>Love</surname><given-names>M.I.</given-names></string-name>, <string-name><surname>Irizarry</surname><given-names>R.A.</given-names></string-name>, <string-name><surname>Kingsford</surname><given-names>C.</given-names></string-name></person-group>
 <article-title>Salmon provides fast and bias-aware quantification of transcript expression</article-title>. <source>Nat. Methods</source>. <year>2017</year>; <volume>14</volume>:<fpage>417</fpage>–<lpage>419</lpage>.<pub-id pub-id-type="pmid">28263959</pub-id></mixed-citation>
    </ref>
    <ref id="B20">
      <label>20.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huber</surname>
 <given-names>W.</given-names></string-name>, <string-name><surname>Carey</surname><given-names>V.J.</given-names></string-name>, <string-name><surname>Gentleman</surname><given-names>R.</given-names></string-name>, <string-name><surname>Anders</surname><given-names>S.</given-names></string-name>, <string-name><surname>Carlson</surname><given-names>M.</given-names></string-name>, <string-name><surname>Carvalho</surname><given-names>B.S.</given-names></string-name>, <string-name><surname>Bravo</surname><given-names>H.C.</given-names></string-name>, <string-name><surname>Davis</surname><given-names>S.</given-names></string-name>, <string-name><surname>Gatto</surname><given-names>L.</given-names></string-name>, <string-name><surname>Girke</surname><given-names>T.</given-names></string-name><etal>et al</etal>.</person-group>
 <article-title>Orchestrating high-throughput genomic analysis with Bioconductor</article-title>. <source>Nat. Methods</source>. <year>2015</year>; <volume>12</volume>:<fpage>115</fpage>.<pub-id pub-id-type="pmid">25633503</pub-id></mixed-citation>
    </ref>
    <ref id="B21">
      <label>21.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Anders</surname>
 <given-names>S.</given-names></string-name>, <string-name><surname>Huber</surname><given-names>W.</given-names></string-name></person-group>
 <article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biol.</source><year>2010</year>; <volume>11</volume>:<fpage>R106</fpage>.<pub-id pub-id-type="pmid">20979621</pub-id></mixed-citation>
    </ref>
    <ref id="B22">
      <label>22.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Trapnell</surname>
 <given-names>C.</given-names></string-name>, <string-name><surname>Williams</surname><given-names>B.A.</given-names></string-name>, <string-name><surname>Pertea</surname><given-names>G.</given-names></string-name>, <string-name><surname>Mortazavi</surname><given-names>A.</given-names></string-name>, <string-name><surname>Kwan</surname><given-names>G.</given-names></string-name>, <string-name><surname>Van Baren</surname><given-names>M.J.</given-names></string-name>, <string-name><surname>Salzberg</surname><given-names>S.L.</given-names></string-name>, <string-name><surname>Wold</surname><given-names>B.J.</given-names></string-name>, <string-name><surname>Pachter</surname><given-names>L.</given-names></string-name></person-group>
 <article-title>Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</article-title>. <source>Nat. Biotechnol.</source><year>2010</year>; <volume>28</volume>:<fpage>511</fpage>.<pub-id pub-id-type="pmid">20436464</pub-id></mixed-citation>
    </ref>
    <ref id="B23">
      <label>23.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Turro</surname>
 <given-names>E.</given-names></string-name>, <string-name><surname>Su</surname><given-names>S.-Y.</given-names></string-name>, <string-name><surname>Gonçalves</surname><given-names>Â.</given-names></string-name>, <string-name><surname>Coin</surname><given-names>L.J.M.</given-names></string-name>, <string-name><surname>Richardson</surname><given-names>S.</given-names></string-name>, <string-name><surname>Lewin</surname><given-names>A.</given-names></string-name></person-group>
 <article-title>Haplotype and isoform specific expression estimation using multi-mapping RNA-seq reads</article-title>. <source>Genome Biol.</source><year>2011</year>; <volume>12</volume>:<fpage>R13</fpage>.<pub-id pub-id-type="pmid">21310039</pub-id></mixed-citation>
    </ref>
    <ref id="B24">
      <label>24.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wilcoxon</surname>
 <given-names>F.</given-names></string-name></person-group>
 <article-title>Individual comparisons by ranking methods</article-title>. <source>Biometrics Bull.</source><year>1945</year>; <volume>1</volume>:<fpage>80</fpage>–<lpage>83</lpage>.</mixed-citation>
    </ref>
    <ref id="B25">
      <label>25.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Elteren</surname>
 <given-names>P.H.</given-names></string-name></person-group>
 <article-title>On the Combination of Independent Two-Sample Tests of Wilcoxon</article-title>. <source>Bull. Int. Stat. Inst.</source><year>1960</year>; <volume>37</volume>:<fpage>351</fpage>–<lpage>361</lpage>.</mixed-citation>
    </ref>
    <ref id="B26">
      <label>26.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mehrotra</surname>
 <given-names>D.V.</given-names></string-name>, <string-name><surname>Lu</surname><given-names>X.</given-names></string-name>, <string-name><surname>Li</surname><given-names>X.</given-names></string-name></person-group>
 <article-title>Rank-based analyses of stratified experiments: alternatives to the van Elteren test</article-title>. <source>Am Stat</source>. <year>2010</year>; <volume>64</volume>:<fpage>121</fpage>–<lpage>130</lpage>.</mixed-citation>
    </ref>
    <ref id="B27">
      <label>27.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Storey</surname>
 <given-names>J.D.</given-names></string-name>, <string-name><surname>Tibshirani</surname><given-names>R.</given-names></string-name></person-group>
 <article-title>Statistical significance for genomewide studies</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><year>2003</year>; <volume>100</volume>:<fpage>9440</fpage>–<lpage>9445</lpage>.<pub-id pub-id-type="pmid">12883005</pub-id></mixed-citation>
    </ref>
    <ref id="B28">
      <label>28.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benjamini</surname>
 <given-names>Y.</given-names></string-name>, <string-name><surname>Hochberg</surname><given-names>Y.</given-names></string-name></person-group>
 <article-title>Controlling the false discovery rate: A practical and powerful approach to multiple testing</article-title>. <source>J. R. Stat. Soc. Ser. B Methodol.</source><year>1995</year>; <volume>57</volume>:<fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
    </ref>
    <ref id="B29">
      <label>29.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frazee</surname>
 <given-names>A.C.</given-names></string-name>, <string-name><surname>Jaffe</surname><given-names>A.E.</given-names></string-name>, <string-name><surname>Langmead</surname><given-names>B.</given-names></string-name>, <string-name><surname>Leek</surname><given-names>J.T.</given-names></string-name></person-group>
 <article-title>Polyester: simulating RNA-seq datasets with differential transcript expression</article-title>. <source>Bioinformatics</source>. <year>2015</year>; <volume>31</volume>:<fpage>2778</fpage>–<lpage>2784</lpage>.<pub-id pub-id-type="pmid">25926345</pub-id></mixed-citation>
    </ref>
    <ref id="B30">
      <label>30.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Love</surname>
 <given-names>M.I.</given-names></string-name>, <string-name><surname>Hogenesch</surname><given-names>J.B.</given-names></string-name>, <string-name><surname>Irizarry</surname><given-names>R.A.</given-names></string-name></person-group>
 <article-title>Modeling of RNA-seq fragment sequence bias reduces systematic errors in transcript abundance estimation</article-title>. <source>Nat. Biotechnol.</source><year>2016</year>; <volume>34</volume>:<fpage>1287</fpage>–<lpage>1291</lpage>.<pub-id pub-id-type="pmid">27669167</pub-id></mixed-citation>
    </ref>
    <ref id="B31">
      <label>31.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lappalainen</surname>
 <given-names>T.</given-names></string-name>, <string-name><surname>Sammeth</surname><given-names>M.</given-names></string-name>, <string-name><surname>Friedländer</surname><given-names>M.R.</given-names></string-name>, <string-name><surname>Hoen</surname><given-names>P.A.C.</given-names></string-name>, <string-name><surname>Monlong</surname><given-names>J.</given-names></string-name>, <string-name><surname>Rivas</surname><given-names>M.A.</given-names></string-name>, <string-name><surname>Gonzalez-Porta</surname><given-names>M.</given-names></string-name>, <string-name><surname>Kurbatova</surname><given-names>N.</given-names></string-name>, <string-name><surname>Griebel</surname><given-names>T.</given-names></string-name>, <string-name><surname>Ferreira</surname><given-names>P.G.</given-names></string-name><etal>et al</etal>.</person-group>
 <article-title>Transcriptome and genome sequencing uncovers functional variation in humans</article-title>. <source>Nature</source>. <year>2013</year>; <volume>501</volume>:<fpage>506</fpage>.<pub-id pub-id-type="pmid">24037378</pub-id></mixed-citation>
    </ref>
    <ref id="B32">
      <label>32.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frankish</surname>
 <given-names>A.</given-names></string-name>, <string-name><surname>Bignell</surname><given-names>A.</given-names></string-name>, <string-name><surname>Berry</surname><given-names>A.</given-names></string-name>, <string-name><surname>Yates</surname><given-names>A.</given-names></string-name>, <string-name><surname>Parker</surname><given-names>A.</given-names></string-name>, <string-name><surname>Schmitt</surname><given-names>B.M.</given-names></string-name>, <string-name><surname>Aken</surname><given-names>B.</given-names></string-name>, <string-name><surname>Garca Girn</surname><given-names>C.</given-names></string-name>, <string-name><surname>Zerbino</surname><given-names>D.</given-names></string-name>, <string-name><surname>Stapleton</surname><given-names>E.</given-names></string-name><etal>et al</etal>.</person-group>
 <article-title>GENCODE reference annotation for the human and mouse genomes</article-title>. <source>Nucleic Acids Res.</source><year>2018</year>; <volume>47</volume>:<fpage>D766</fpage>–<lpage>D773</lpage>.</mixed-citation>
    </ref>
    <ref id="B33">
      <label>33.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bray</surname>
 <given-names>N.L.</given-names></string-name>, <string-name><surname>Pimentel</surname><given-names>H.</given-names></string-name>, <string-name><surname>Melsted</surname><given-names>P.</given-names></string-name>, <string-name><surname>Pachter</surname><given-names>L.</given-names></string-name></person-group>
 <article-title>Near-optimal probabilistic RNA-seq quantification</article-title>. <source>Nat. Biotechnol</source>. <year>2016</year>; <volume>34</volume>:<fpage>525</fpage>.<pub-id pub-id-type="pmid">27043002</pub-id></mixed-citation>
    </ref>
    <ref id="B34">
      <label>34.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Soneson</surname>
 <given-names>C.</given-names></string-name>, <string-name><surname>Robinson</surname><given-names>M.D.</given-names></string-name></person-group>
 <article-title>iCOBRA: open, reproducible, standardized and live method benchmarking</article-title>. <source>Nat. Methods</source>. <year>2016</year>; <volume>13</volume>:<fpage>283</fpage>.<pub-id pub-id-type="pmid">27027585</pub-id></mixed-citation>
    </ref>
    <ref id="B35">
      <label>35.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Law</surname>
 <given-names>C.W.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Shi</surname><given-names>W.</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>G.K.</given-names></string-name></person-group>
 <article-title>Voom: precision weights unlock linear model analysis tools for RNA-seq read counts</article-title>. <source>Genome Biol.</source><year>2014</year>; <volume>15</volume>:<fpage>R29</fpage>.<pub-id pub-id-type="pmid">24485249</pub-id></mixed-citation>
    </ref>
    <ref id="B36">
      <label>36.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McCarthy</surname>
 <given-names>D.J.</given-names></string-name>, <string-name><surname>Chen</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>G.K.</given-names></string-name></person-group>
 <article-title>Differential expression analysis of multifactor RNA-Seq experiments with respect to biological variation</article-title>. <source>Nucleic Acids Res.</source><year>2012</year>; <volume>40</volume>:<fpage>4288</fpage>–<lpage>4297</lpage>.<pub-id pub-id-type="pmid">22287627</pub-id></mixed-citation>
    </ref>
    <ref id="B37">
      <label>37.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lund</surname>
 <given-names>S.P.</given-names></string-name>, <string-name><surname>Nettleton</surname><given-names>D.</given-names></string-name>, <string-name><surname>McCarthy</surname><given-names>D.J.</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>G.K.</given-names></string-name></person-group>
 <article-title>Detecting differential expression in RNA-sequence data using quasi-likelihood with shrunken dispersion estimates</article-title>. <source>Stat. Appl. Genet. Mol. Biol.</source><year>2012</year>; <volume>11</volume>:<fpage>5</fpage>.<pub-id pub-id-type="pmid">23079517</pub-id></mixed-citation>
    </ref>
    <ref id="B38">
      <label>38.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smyth</surname>
 <given-names>G.K.</given-names></string-name></person-group>
 <article-title>Linear models and empirical bayes methods for assessing differential expression in microarray experiments</article-title>. <source>Stat. Appl. Genet. Mol. Biol.</source><year>2004</year>; <volume>3</volume>:<fpage>1</fpage>–<lpage>25</lpage>.</mixed-citation>
    </ref>
    <ref id="B39">
      <label>39.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schurch</surname>
 <given-names>N.J.</given-names></string-name>, <string-name><surname>Schofield</surname><given-names>P.</given-names></string-name>, <string-name><surname>Gierliński</surname><given-names>M.</given-names></string-name>, <string-name><surname>Cole</surname><given-names>C.</given-names></string-name>, <string-name><surname>Sherstnev</surname><given-names>A.</given-names></string-name>, <string-name><surname>Singh</surname><given-names>V.</given-names></string-name>, <string-name><surname>Wrobel</surname><given-names>N.</given-names></string-name>, <string-name><surname>Gharbi</surname><given-names>K.</given-names></string-name>, <string-name><surname>Simpson</surname><given-names>G.G.</given-names></string-name>, <string-name><surname>Owen-Hughes</surname><given-names>T.</given-names></string-name>, <string-name><surname>et</surname><given-names>al</given-names></string-name></person-group>
 <article-title>How many biological replicates are needed in an RNA-seq experiment and which differential expression tool should you use</article-title>. <source>RNA</source>. <year>2016</year>; <volume>22</volume>:<fpage>839</fpage>–<lpage>851</lpage>.<pub-id pub-id-type="pmid">27022035</pub-id></mixed-citation>
    </ref>
    <ref id="B40">
      <label>40.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Froussios</surname>
 <given-names>K.</given-names></string-name>, <string-name><surname>Schurch</surname><given-names>N.J.</given-names></string-name>, <string-name><surname>Mackinnon</surname><given-names>K.</given-names></string-name>, <string-name><surname>Gierliński</surname><given-names>M.</given-names></string-name>, <string-name><surname>Duc</surname><given-names>C.</given-names></string-name>, <string-name><surname>Simpson</surname><given-names>G.G.</given-names></string-name>, <string-name><surname>Barton</surname><given-names>G.J.</given-names></string-name></person-group>
 <article-title>How well do RNA-Seq differential gene expression tools perform in a complex eukaryote? A case study in A. thaliana</article-title>. <source>Bioinformatics</source>. <year>2019b</year>; <volume>1</volume>:<fpage>6</fpage>.</mixed-citation>
    </ref>
    <ref id="B41">
      <label>41.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zappia</surname>
 <given-names>L.</given-names></string-name>, <string-name><surname>Phipson</surname><given-names>B.</given-names></string-name>, <string-name><surname>Oshlack</surname><given-names>A.</given-names></string-name></person-group>
 <article-title>Splatter: simulation of single-cell RNA sequencing data</article-title>. <source>Genome Biol.</source><year>2017</year>; <volume>18</volume>:<fpage>174</fpage>.<pub-id pub-id-type="pmid">28899397</pub-id></mixed-citation>
    </ref>
    <ref id="B42">
      <label>42.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Soneson</surname>
 <given-names>C.</given-names></string-name>, <string-name><surname>Robinson</surname><given-names>M.D.</given-names></string-name></person-group>
 <article-title>Bias, robustness and scalability in single-cell differential expression analysis</article-title>. <source>Nat. Methods</source>. <year>2018</year>; <volume>15</volume>:<fpage>255</fpage>.<pub-id pub-id-type="pmid">29481549</pub-id></mixed-citation>
    </ref>
    <ref id="B43">
      <label>43.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname>
 <given-names>A.</given-names></string-name>, <string-name><surname>Hoffman</surname><given-names>P.</given-names></string-name>, <string-name><surname>Smibert</surname><given-names>P.</given-names></string-name>, <string-name><surname>Papalexi</surname><given-names>E.</given-names></string-name>, <string-name><surname>Satija</surname><given-names>R.</given-names></string-name></person-group>
 <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat. Biotechnol.</source><year>2018</year>; <volume>36</volume>:<fpage>411</fpage>.<pub-id pub-id-type="pmid">29608179</pub-id></mixed-citation>
    </ref>
    <ref id="B44">
      <label>44.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Loo</surname>
 <given-names>L.</given-names></string-name>, <string-name><surname>Simon</surname><given-names>J.M.</given-names></string-name>, <string-name><surname>Xing</surname><given-names>L.</given-names></string-name>, <string-name><surname>McCoy</surname><given-names>E.S.</given-names></string-name>, <string-name><surname>Niehaus</surname><given-names>J.K.</given-names></string-name>, <string-name><surname>Guo</surname><given-names>J.</given-names></string-name>, <string-name><surname>Anton</surname><given-names>E.S.</given-names></string-name>, <string-name><surname>Zylka</surname><given-names>M.J.</given-names></string-name></person-group>
 <article-title>Single-cell transcriptomic analysis of mouse neocortical development</article-title>. <source>Nat. Commun.</source><year>2019</year>; <volume>10</volume>:<fpage>134</fpage>.<pub-id pub-id-type="pmid">30635555</pub-id></mixed-citation>
    </ref>
    <ref id="B45">
      <label>45.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van den Berge</surname>
 <given-names>K.</given-names></string-name>, <string-name><surname>Perraudeau</surname><given-names>F.</given-names></string-name>, <string-name><surname>Soneson</surname><given-names>C.</given-names></string-name>, <string-name><surname>Love</surname><given-names>M.I.</given-names></string-name>, <string-name><surname>Risso</surname><given-names>D.</given-names></string-name>, <string-name><surname>Vert</surname><given-names>J.-P.</given-names></string-name>, <string-name><surname>Robinson</surname><given-names>M.D.</given-names></string-name>, <string-name><surname>Dudoit</surname><given-names>S.</given-names></string-name>, <string-name><surname>Clement</surname><given-names>L.</given-names></string-name></person-group>
 <article-title>Observation weights unlock bulk rna-seq tools for zero inflation and single-cell applications</article-title>. <source>Genome Biol.</source><year>2010</year>; <volume>19</volume>:<fpage>24</fpage>.</mixed-citation>
    </ref>
    <ref id="B46">
      <label>46.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fietz</surname>
 <given-names>S.A.</given-names></string-name>, <string-name><surname>Lachmann</surname><given-names>R.</given-names></string-name>, <string-name><surname>Brandl</surname><given-names>H.</given-names></string-name>, <string-name><surname>Kircher</surname><given-names>M.</given-names></string-name>, <string-name><surname>Samusik</surname><given-names>N.</given-names></string-name>, <string-name><surname>Schröder</surname><given-names>R.</given-names></string-name>, <string-name><surname>Lakshmanaperumal</surname><given-names>N.</given-names></string-name>, <string-name><surname>Henry</surname><given-names>I.</given-names></string-name>, <string-name><surname>Vogt</surname><given-names>J.</given-names></string-name>, <string-name><surname>Riehn</surname><given-names>A.</given-names></string-name><etal>et al</etal>.</person-group>
 <article-title>Transcriptomes of germinal zones of human and mouse fetal neocortex suggest a role of extracellular matrix in progenitor self-renewal</article-title>. <source>Proc. Natl. Acad. Sci. U.S.A.</source><year>2012</year>; <volume>109</volume>:<fpage>11836</fpage>–<lpage>11841</lpage>.<pub-id pub-id-type="pmid">22753484</pub-id></mixed-citation>
    </ref>
    <ref id="B47">
      <label>47.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname>
 <given-names>Y.</given-names></string-name>, <string-name><surname>Lun</surname><given-names>A.T.</given-names></string-name>, <string-name><surname>Smyth</surname><given-names>G.K.</given-names></string-name></person-group>
 <article-title>From reads to genes to pathways: differential expression analysis of RNA-Seq experiments using Rsubread and the edgeR quasi-likelihood pipeline [version 2; peer review: 5 approved]</article-title>. <source>F1000Research</source>. <year>2016</year>; <volume>5</volume>:<fpage>1438</fpage>.<pub-id pub-id-type="pmid">27508061</pub-id></mixed-citation>
    </ref>
    <ref id="B48">
      <label>48.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van der Maaten</surname>
 <given-names>L.</given-names></string-name>, <string-name><surname>Hinton</surname><given-names>G.</given-names></string-name></person-group>
 <article-title>Visualizing data using t-SNE</article-title>. <source>J Mach. Learn Res.</source><year>2008</year>; <volume>9</volume>:<fpage>2579</fpage>–<lpage>2605</lpage>.</mixed-citation>
    </ref>
    <ref id="B49">
      <label>49.</label>
      <mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><surname>Zhang</surname>
 <given-names>J.M.</given-names></string-name>, <string-name><surname>Kamath</surname><given-names>G.M.</given-names></string-name>, <string-name><surname>Tse</surname><given-names>D.N.</given-names></string-name></person-group>
 <article-title>Valid post-clustering differential analysis for single-cell RNA-Seq</article-title>. <year>2019</year>; <comment>bioRxiv doi:</comment><comment>26 June 2019, pre-print: not peer-reviewed</comment><pub-id pub-id-type="doi">10.1101/463265</pub-id>.</mixed-citation>
    </ref>
    <ref id="B50">
      <label>50.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kiselev</surname>
 <given-names>V.Y.</given-names></string-name>, <string-name><surname>Kirschner</surname><given-names>K.</given-names></string-name>, <string-name><surname>Schaub</surname><given-names>M.T.</given-names></string-name>, <string-name><surname>Andrews</surname><given-names>T.</given-names></string-name>, <string-name><surname>Yiu</surname><given-names>A.</given-names></string-name>, <string-name><surname>Chandra</surname><given-names>T.</given-names></string-name>, <string-name><surname>Natarajan</surname><given-names>K.N.</given-names></string-name>, <string-name><surname>Reik</surname><given-names>W.</given-names></string-name>, <string-name><surname>Barahona</surname><given-names>M.</given-names></string-name>, <string-name><surname>Green</surname><given-names>A.R.</given-names></string-name><etal>et al</etal>.</person-group>
 <article-title>SC3: consensus clustering of single-cell RNA-seq data</article-title>. <source>Nat. Methods</source>. <year>2017</year>; <volume>14</volume>:<fpage>483</fpage>.<pub-id pub-id-type="pmid">28346451</pub-id></mixed-citation>
    </ref>
    <ref id="B51">
      <label>51.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname>
 <given-names>P.</given-names></string-name>, <string-name><surname>Troup</surname><given-names>M.</given-names></string-name>, <string-name><surname>Ho</surname><given-names>J.W.K.</given-names></string-name></person-group>
 <article-title>CIDR: Ultrafast and accurate clustering through imputation for single-cell RNA-seq data</article-title>. <source>Genome Biol.</source><year>2017</year>; <volume>18</volume>:<fpage>59</fpage>.<pub-id pub-id-type="pmid">28351406</pub-id></mixed-citation>
    </ref>
    <ref id="B52">
      <label>52.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Freytag</surname>
 <given-names>S.</given-names></string-name>, <string-name><surname>Tian</surname><given-names>L.</given-names></string-name>, <string-name><surname>Lönnstedt</surname><given-names>I.</given-names></string-name>, <string-name><surname>Ng</surname><given-names>M.</given-names></string-name>, <string-name><surname>Bahlo</surname><given-names>M.</given-names></string-name></person-group>
 <article-title>Comparison of clustering tools in R for medium-sized 10x Genomics single-cell RNA-sequencing data [version 2; referees: 3 approved]</article-title>. <source>F1000Research</source>. <year>2018</year>; <volume>7</volume>:<fpage>1297</fpage>.<pub-id pub-id-type="pmid">30228881</pub-id></mixed-citation>
    </ref>
    <ref id="B53">
      <label>53.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname>
 <given-names>Y.</given-names></string-name>, <string-name><surname>Huh</surname><given-names>R.</given-names></string-name>, <string-name><surname>Culpepper</surname><given-names>H.W.</given-names></string-name>, <string-name><surname>Lin</surname><given-names>Y.</given-names></string-name>, <string-name><surname>Love</surname><given-names>M.I.</given-names></string-name>, <string-name><surname>Yun</surname><given-names>Li</given-names></string-name></person-group>
 <article-title>SAFE-clustering: single-cell Aggregated (from Ensemble) clustering for single-cell RNA-seq data</article-title>. <source>Bioinformatics</source>. <year>2018</year>; <volume>35</volume>:<fpage>1269</fpage>–<lpage>1277</lpage>.</mixed-citation>
    </ref>
    <ref id="B54">
      <label>54.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Risso</surname>
 <given-names>D.</given-names></string-name>, <string-name><surname>Ngai</surname><given-names>J.</given-names></string-name>, <string-name><surname>Speed</surname><given-names>T.P.</given-names></string-name>, <string-name><surname>Dudoit</surname><given-names>S.</given-names></string-name></person-group>
 <article-title>Normalization of RNA-seq data using factor analysis of control genes or samples</article-title>. <source>Nat. Biotechnol.</source><year>2014</year>; <volume>32</volume>:<fpage>896</fpage>.<pub-id pub-id-type="pmid">25150836</pub-id></mixed-citation>
    </ref>
    <ref id="B55">
      <label>55.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leek</surname>
 <given-names>J.T.</given-names></string-name></person-group>
 <article-title>svaseq: removing batch effects and other unwanted noise from sequencing data</article-title>. <source>Nucleic Acids Res.</source><year>2014</year>; <volume>42</volume>:<fpage>e161</fpage>.</mixed-citation>
    </ref>
    <ref id="B56">
      <label>56.</label>
      <mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alasoo</surname>
 <given-names>K.</given-names></string-name>, <string-name><surname>Rodrigues</surname><given-names>J.</given-names></string-name>, <string-name><surname>Mukhopadhyay</surname><given-names>S.</given-names></string-name>, <string-name><surname>Knights</surname><given-names>A.J.</given-names></string-name>, <string-name><surname>Mann</surname><given-names>A.L.</given-names></string-name>, <string-name><surname>Kundu</surname><given-names>K.</given-names></string-name>, <string-name><surname>Hale</surname><given-names>C.</given-names></string-name>, <string-name><surname>Dougan</surname><given-names>G.</given-names></string-name>, <string-name><surname>Gaffney</surname><given-names>D.J.</given-names></string-name><collab>HIPSCI Consortium</collab></person-group>
 <article-title>Shared genetic effects on chromatin and gene expression indicate a role for enhancer priming in immune response</article-title>. <source>Nat. Genet.</source><year>2018</year>; <volume>50</volume>:<fpage>424</fpage>–<lpage>431</lpage>.<pub-id pub-id-type="pmid">29379200</pub-id></mixed-citation>
    </ref>
  </ref-list>
</back>
